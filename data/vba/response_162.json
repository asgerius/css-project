[{"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 1151075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a045036028a1c39c83bfeef45af9654a?s=128&d=identicon&r=PG", "display_name": "Tim Gilbertson", "link": "https://stackoverflow.com/users/1151075/tim-gilbertson"}, "edited": false, "score": 0, "creation_date": 1518653667, "post_id": 48797955, "comment_id": 84599167, "body": "Yes! It was that extra &amp; that I was missing. Thanks so much."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1518657077, "post_id": 48797955, "comment_id": 84600082, "body": "Nooo. Don&#39;t do string math. Better use <code>Range(Range(&quot;A1&quot;).Cell(j,1),Range(&quot;S1&quot;).Cell(k,1))</code> or better yet, use relative addressing <code>Range(&quot;A1&quot;).Offset(j-1,0).Resize(k-j+1,19)</code>. The <i>OP</i> may not know better, but someone with 70k reputation should demostrate best practices in answers."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1518657211, "post_id": 48797955, "comment_id": 84600113, "body": "@ja72 if you are going to use Cells(), better to use sbn&#39;s answer below.  And it will be quicker than mine, I just answered the question.  sbn&#39;s answer is the best and quickest."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1518651328, "creation_date": 1518651328, "answer_id": 48797955, "question_id": 48797934, "link": "https://stackoverflow.com/questions/48797934/vba-cell-location-reference-with-2-variables/48797955#48797955", "title": "VBA Cell location reference with 2 variables", "body": "<p>The address is just a string that is concatenated together:</p>\n\n<pre><code>\"A\" &amp; j &amp; \":S\" &amp; k\n</code></pre>\n\n<p>So</p>\n\n<pre><code>ActiveSheet.Range(\"A\" &amp; j &amp; \":S\" &amp; k)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 8827816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c85d73ebb63ed379772d02aed9f77ec?s=128&d=identicon&r=PG&f=1", "display_name": "sbn", "link": "https://stackoverflow.com/users/8827816/sbn"}, "is_accepted": true, "score": 3, "last_activity_date": 1518652809, "creation_date": 1518652809, "answer_id": 48798182, "question_id": 48797934, "link": "https://stackoverflow.com/questions/48797934/vba-cell-location-reference-with-2-variables/48798182#48798182", "title": "VBA Cell location reference with 2 variables", "body": "<p>or you can use 'cells' with numbers instead of usung letters and concatenation:</p>\n\n<pre><code>Sub SelectRangeUsingCells()\nDim j As Long, k As Long\nDim ws As Worksheet\n  Set ws = ActiveSheet   'ws will be active worksheet\n  j = 2                  'example 2. row\n  k = 5                  'example 5. row\n\n  With ws\n    .Range(.Cells(j, 1), .Cells(k, 19)).Select  'selection of range\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1518658493, "creation_date": 1518658493, "answer_id": 48798873, "question_id": 48797934, "link": "https://stackoverflow.com/questions/48797934/vba-cell-location-reference-with-2-variables/48798873#48798873", "title": "VBA Cell location reference with 2 variables", "body": "<p>There are many ways to do want you are doing. Let's say you want to pick items 5, 6 and 7 from the example below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5ydpj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5ydpj.png\" alt=\"ex1\"></a></p>\n\n<pre><code>Public Sub TableSelectionDemo()\n\n    Dim r As Range\n    Dim i As Long, j As Long\n    i = 5: j = 7 ' Range of rows for selection\n\n    Set r = Range(\"E\" &amp; i + 7 &amp; \":H\" &amp; j + 7)\n    Debug.Print r.Address\n\n    Set r = Range(Range(\"E8\").Cells(i, 1), Range(\"H8\").Cells(j, 1))\n    Debug.Print r.Address\n\n    Set r = Range(\"E7\").Offset(i, 0).Resize(j - i + 1, 4)\n    Debug.Print r.Address\n\n\nEnd Sub\n</code></pre>\n\n<p>All three ways produce the same range address: <code>$E$12:$H$14</code>.</p>\n\n<p>Now consider what you can do with this range. Consider creating an array in memory and accessing the contents of the range using array operations. For example:</p>\n\n<pre><code>Dim vals() As Variant\nvals = r.Value      ' Read table values into memory\n\nDim total_cost As Single\ntotal_cost = 0!\n\nFor i = 1 To r.Rows.Count\n    ' Multiply 3rd column with 4th column\n    total_cost = total_cost + vals(i, 3) * vals(i, 4)\nNext i\n\nDebug.Print \"Total Cost=\" &amp; total_cost\n</code></pre>\n\n<p>This type of operation is extremely fast because, a) It uses floating point math, b) It does not convert from strings to values and back, c) it does not update the screen and d) it does not use the clipboard.</p>\n"}], "owner": {"reputation": 25, "user_id": 1151075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a045036028a1c39c83bfeef45af9654a?s=128&d=identicon&r=PG", "display_name": "Tim Gilbertson", "link": "https://stackoverflow.com/users/1151075/tim-gilbertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1842, "favorite_count": 0, "accepted_answer_id": 48798182, "answer_count": 3, "score": -1, "last_activity_date": 1518658493, "creation_date": 1518651105, "last_edit_date": 1531164843, "question_id": 48797934, "link": "https://stackoverflow.com/questions/48797934/vba-cell-location-reference-with-2-variables", "title": "VBA Cell location reference with 2 variables", "body": "<p>I'm trying to select a range using 2 different variables. I know how to do it with 1 variable <code>ActiveSheet.Range(\"$A$1:$S\" &amp; k)</code> but I'd like to make the range go from $A &amp; j to $S &amp; k and I'm unsure of the proper syntax for that. </p>\n"}, {"tags": ["excel", "vba", "controls"], "answers": [{"comments": [{"owner": {"reputation": 3204, "user_id": 823527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/929e65e0cfa1e3f11ba630abe6316e6c?s=128&d=identicon&r=PG", "display_name": "user823527", "link": "https://stackoverflow.com/users/823527/user823527"}, "edited": false, "score": 0, "creation_date": 1518655953, "post_id": 48798417, "comment_id": 84599778, "body": "As the title says, that&#39;s the frame I added. But the only way to add controls to that frame is as I described. But these controls are only visible in Design Mode."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 3204, "user_id": 823527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/929e65e0cfa1e3f11ba630abe6316e6c?s=128&d=identicon&r=PG", "display_name": "user823527", "link": "https://stackoverflow.com/users/823527/user823527"}, "edited": false, "score": 0, "creation_date": 1518656138, "post_id": 48798417, "comment_id": 84599851, "body": "Is there a chance that your Group Policy and/or Excel security settings are preventing ActiveX controls from being usable on sheets?"}, {"owner": {"reputation": 3204, "user_id": 823527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/929e65e0cfa1e3f11ba630abe6316e6c?s=128&d=identicon&r=PG", "display_name": "user823527", "link": "https://stackoverflow.com/users/823527/user823527"}, "edited": false, "score": 0, "creation_date": 1518743960, "post_id": 48798417, "comment_id": 84641520, "body": "Controls are usable. The problem again is that the only way to use the Forms 2.0 frame is to right mouse click and add controls. The ones on the Insert ActiveX Controls won&#39;t show."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1518654541, "creation_date": 1518654541, "answer_id": 48798417, "question_id": 48797701, "link": "https://stackoverflow.com/questions/48797701/accessing-microsoft-forms-2-0-frame-controls-in-vba/48798417#48798417", "title": "Accessing Microsoft Forms 2.0 Frame Controls in VBA", "body": "<p>It's unclear whether you added a Form Frame or an ActiveX Frame.</p>\n\n<p>Form Frames are insertable, by default, from the Insert menu:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rcw7U.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rcw7U.jpg\" alt=\"Insert Menu\"></a></p>\n\n<p>In order to be able to handle control events in VBA, you need to use the ActiveX form of the Frame control... But by default, the Frame ActiveX control isn't visible on the Insert menu. You'll need to press the More Controls button:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ovdot.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ovdot.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And then choose Microsoft Forms 2.0 Frame Control from the list of controls:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2BjS9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2BjS9.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You'll then need to ensure that you add the ActiveX form of the Option Buttons and other controls... All of the controls (and their events), including the Frame and the Option Buttons will then appear in the Worksheet's event drop-down.</p>\n"}], "owner": {"reputation": 3204, "user_id": 823527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/929e65e0cfa1e3f11ba630abe6316e6c?s=128&d=identicon&r=PG", "display_name": "user823527", "link": "https://stackoverflow.com/users/823527/user823527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1396, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544893539, "creation_date": 1518649497, "question_id": 48797701, "link": "https://stackoverflow.com/questions/48797701/accessing-microsoft-forms-2-0-frame-controls-in-vba", "title": "Accessing Microsoft Forms 2.0 Frame Controls in VBA", "body": "<p>I found out that the only way to have controls be visible in a Frame in Excel is to add them with right-mouse-click Edit. But when I do this the controls are not listed in VBA.</p>\n\n<p>These are the controls on the worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/olOR8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/olOR8.png\" alt=\"Controls\"></a></p>\n\n<p>The first option button is optToday, the first textbox txtToday, the second option button optDate, the second textbox txtDate. The frame is groupDate, the button cmdGetWeek, the third textbox is txtWeekofMonth.</p>\n\n<p>But this is all that comes up in VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IYqlc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IYqlc.png\" alt=\"Controls Missing\"></a></p>\n\n<p>I am looking to call a function to calculate week of month when the user clicks on the button. If the user selected today this is the date that will be sent to the function. If the user selected a different date that will will be sent instead.</p>\n\n<p>What I have so far for the code is this:</p>\n\n<pre><code>Private Sub cmdGetWeek_Click()\nDim selectedDate As Date\nDim calcWeekNum\n\nIf (optToday.Value = True) Then\n    selectedDate = txtToday.Value\nElse:\n    selectedDate = txtDate.Value\nEnd If\nMsgBox (\"Selected: \" &amp; selectedDate)\ncalcWeekNum = WeekOfMonth(selectedDate) End Sub \n</code></pre>\n\n<p>I get a Run-Time Error '424' for \"If (optToday.Value = True) Then\".</p>\n\n<p>What is the correct way of accessing the frame controls?</p>\n"}, {"tags": ["excel", "vba", "formatting", "conditional"], "comments": [{"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1518651338, "post_id": 48797254, "comment_id": 84598554, "body": "Can you please provide an image of your data as well as your expected result? That may help others in understanding how everything works and what you&#39;re looking for."}, {"owner": {"reputation": 1, "user_id": 9362285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b44f48da49e409f5b437e8ea5029bed?s=128&d=identicon&r=PG&f=1", "display_name": "billiamthe2nd", "link": "https://stackoverflow.com/users/9362285/billiamthe2nd"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1518652502, "post_id": 48797254, "comment_id": 84598835, "body": "I uploaded a screenshot but I can&#39;t embed the picture due to a my reputation being too low"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1518652760, "post_id": 48797254, "comment_id": 84598914, "body": "I went ahead and edited it for you. Once my edit is approved you should see it embedded. Welcome to the site!"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1518659014, "post_id": 48797254, "comment_id": 84600536, "body": "Why do you want to do that on every selection change? Shouldn&#39;t it be <code>Worksheet_Change</code>? Since the cells in col F doesn&#39;t change automatically."}, {"owner": {"reputation": 1, "user_id": 9362285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b44f48da49e409f5b437e8ea5029bed?s=128&d=identicon&r=PG&f=1", "display_name": "billiamthe2nd", "link": "https://stackoverflow.com/users/9362285/billiamthe2nd"}, "edited": false, "score": 0, "creation_date": 1518674671, "post_id": 48797254, "comment_id": 84604323, "body": "The excel spreadsheet is an output of a database so I wanted to be able to copy the vba script to each spreadsheet so it would run once when I changed the selection. That way I make sure I don\u2019t change a cell value to get it to run."}], "answers": [{"tags": [], "owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518650476, "creation_date": 1518650476, "answer_id": 48797842, "question_id": 48797254, "link": "https://stackoverflow.com/questions/48797254/formatting-based-on-cell-value-and-surrounding-rows/48797842#48797842", "title": "Formatting based on cell value and surrounding rows", "body": "<p>Please check to see if the cell value is NULL as well as \"\"</p>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1518650767, "creation_date": 1518650767, "answer_id": 48797884, "question_id": 48797254, "link": "https://stackoverflow.com/questions/48797254/formatting-based-on-cell-value-and-surrounding-rows/48797884#48797884", "title": "Formatting based on cell value and surrounding rows", "body": "<p>You need to set the row height to zero to hide it</p>\n\n<pre><code>cell.EntireRow.RowHeight = 0\n</code></pre>\n\n<p>But don't forget to reset it in the other two cases</p>\n\n<pre><code> cell.EntireRow.AutoFit\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9362285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b44f48da49e409f5b437e8ea5029bed?s=128&d=identicon&r=PG&f=1", "display_name": "billiamthe2nd", "link": "https://stackoverflow.com/users/9362285/billiamthe2nd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518672612, "creation_date": 1518647172, "last_edit_date": 1518672612, "question_id": 48797254, "link": "https://stackoverflow.com/questions/48797254/formatting-based-on-cell-value-and-surrounding-rows", "title": "Formatting based on cell value and surrounding rows", "body": "<p>I have an excel spreadsheet of a BOM that I'm trying to conditionally format.  The data is laid out such that column A is the item number. Since the BOM has alternates, there are repeated numbers.  I want to go through the spreadsheet and for each item number, find the item with \"Active\" in column F and highlight them green and hide the alternates on the other rows. If there is no \"active\" item, I want to highlight the items as yellow and keep them displayed.  I have the current vba script which does the highlighting. If you look at the example data I basically want a single line for each item number which shows the active part, but if there is no active part, to show the historical or discontinued parts in yellow </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim icolor As Integer\nDim lastrow As Long\nDim i As Integer\nDim cell As Range\nDim sheetname As String\nsheetname = Application.ActiveSheet.Name\nWith Worksheets(sheetname)\n    lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\nApplication.ScreenUpdating = False\n\n\nFor Each cell In Range(\"F1:F\" &amp; lastrow)\n    Select Case cell.Value\n        Case Is = \"Active\"\n            cell.EntireRow.Interior.ColorIndex = 10\n        Case Is = \"Status\"\n            cell.EntireRow.Interior.ColorIndex = 15\n        Case Is = \"\"\n            cell.EntireRow.Interior.ColorIndex = 2\n            cell.EntireRow.Hidden = True\n        Case Else\n            cell.EntireRow.Interior.ColorIndex = 6\n    End Select\nNext cell\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Here's a screenshot of some sample data:</strong>\n<a href=\"https://i.stack.imgur.com/Vsnue.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vsnue.jpg\" alt=\"Data Sample\"></a></p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1518647070, "post_id": 48797208, "comment_id": 84596954, "body": "I also tried putting the userform name instead of me, but no luck"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1518652952, "post_id": 48797208, "comment_id": 84598972, "body": "The <i>reason</i> your code fails is <code>Dim lstbox as listbox</code> should be <code>Dim lstbox as MSForms.ListBox</code>.  <code>ListBox</code> and <code>MSForms.ListBox</code> are not the same type"}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1518700154, "post_id": 48797208, "comment_id": 84618982, "body": "Thanks, Chris you catch the point."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1518651820, "creation_date": 1518651820, "answer_id": 48798022, "question_id": 48797208, "link": "https://stackoverflow.com/questions/48797208/how-to-update-a-listbox-by-using-a-sub-procedure/48798022#48798022", "title": "How to update a listbox by using a sub procedure", "body": "<p>First, you have to (make sure) access the <code>ListBox</code> at runtime.<br>\nMeaning the <code>Userform</code> is already loaded when you call the <code>Sub</code>.<br></p>\n\n<p>Another suggestion in your <code>Sub</code>, instead of passing <code>ListBox</code> as <code>String</code>, pass it as <code>MSForms.ListBox</code> Object. Something like this:</p>\n\n<pre><code>Public Sub memoadd(ByVal txt As String, _\n                   ByVal tablename As String, _\n                   ByVal listbox As MSForms.ListBox) \n\nlistbox.AddItem txt &amp; \" @ \" &amp; Format(Time, \"hh:mm\"), \"0\"\n'/* no need to set lobj here, you can use listbox directly */\n'/* rest of your code */\n\nEnd Sub\n</code></pre>\n\n<p>I hope this gets you going, you didn't mention other specifics regarding your code.<br> And so I didn't check and assumed it should work.</p>\n"}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 48798022, "answer_count": 1, "score": 1, "last_activity_date": 1518652147, "creation_date": 1518646960, "last_edit_date": 1531164843, "question_id": 48797208, "link": "https://stackoverflow.com/questions/48797208/how-to-update-a-listbox-by-using-a-sub-procedure", "title": "How to update a listbox by using a sub procedure", "body": "<p>I have a user form and a listbox on that, I am using the listbox as activity memo, I developed a sub for updating that listbox and also a listobject in a sheet as its bank. (the listbox just have the current session logs, but list object have all the records). I can't pass the listbox control to the sub. I tried it in a module and also in the userform code section, but I can't refer listbox name (not as a string nor as a listbox control). Do you have any idea or sollution for this? \nHere is my code. </p>\n\n<pre><code>Public Sub memoadd(ByVal txt As String, ByVal tablename As String, ByVal listbox As String)\n    Dim lrow As ListRow, lobj As ListObject, lstbox As listbox\n\n    Set lobj = log.ListObjects(tablename)\n    Set lrow = lobj.ListRows.Add(1, True)\n    Set lstbox = Me.Controls(listbox)\n    lstbox.AddItem txt &amp; \" @ \" &amp; Format(Time, \"hh:mm\"), \"0\"\n\n    With lrow\n       lrow.Range(1, 1) = lobj.ListRows.Count\n       lrow.Range(1, 2) = Now\n       lrow.Range(1, 3) = lstbox.List(0)\n       lrow.Range(1, 4) = Environ$(\"Computername\")\n       lrow.Range(1, 5) = Environ$(\"username\")\n    End With\n\n    lstbox.ListIndex = 0\nEnd Sub\n</code></pre>\n\n<p>Here is how I am using that in my procedures. </p>\n\n<pre><code>memoadd \"master file of A/C: \" &amp; ac &amp; \" is opened\", \"Logs\", \"ListBox2\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "web"], "comments": [{"owner": {"reputation": 418, "user_id": 9358196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e7a5c646b53369db8322d67a87f79e?s=128&d=identicon&r=PG&f=1", "display_name": "Noctsol", "link": "https://stackoverflow.com/users/9358196/noctsol"}, "edited": false, "score": 0, "creation_date": 1518646797, "post_id": 48797081, "comment_id": 84596837, "body": "Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)     IE.Visible = True     IE.Navigate &quot;<a href=\"https://ww3.loweslink.com/VendorPortal/processWO.do?action=openwo&amp;userId=dgibsd\" rel=\"nofollow noreferrer\">ww3.loweslink.com/VendorPortal/&hellip;</a>&quot;&#39;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518647433, "post_id": 48797081, "comment_id": 84597131, "body": "Do a <code>getElementsByTagName(&quot;img&quot;)</code> then loop over the collection until you find an element where the <code>src</code> contains &quot;dpsrun_out.gif&quot;, then click that element."}, {"owner": {"reputation": 418, "user_id": 9358196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e7a5c646b53369db8322d67a87f79e?s=128&d=identicon&r=PG&f=1", "display_name": "Noctsol", "link": "https://stackoverflow.com/users/9358196/noctsol"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519757582, "post_id": 48797081, "comment_id": 85036696, "body": "Thanks Tim. i didn&#39;t use it for this one, but I did do something similar for another element."}], "answers": [{"tags": [], "owner": {"reputation": 418, "user_id": 9358196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e7a5c646b53369db8322d67a87f79e?s=128&d=identicon&r=PG&f=1", "display_name": "Noctsol", "link": "https://stackoverflow.com/users/9358196/noctsol"}, "is_accepted": true, "score": 0, "last_activity_date": 1519761717, "last_edit_date": 1519761717, "creation_date": 1519757480, "answer_id": 49015937, "question_id": 48797081, "link": "https://stackoverflow.com/questions/48797081/getelementclicking-a-button-with-no-id-tag-name-class-value-siblings/49015937#49015937", "title": "(GetElement)Clicking a button with no ID, TAG, NAME, CLASS, VALUE, SIBLINGS", "body": "<p>OP here. Sorry for the terrible formatting of the question, it was the first time. To help others in the future.....</p>\n\n<p>This is what I did at first. It was my band aid fix.</p>\n\n<pre><code>ie.document.getelementByID(\"filtervalue\").select\n\"SendKeys{ENTER}\"\n</code></pre>\n\n<p>This highlighted my input value and just pressed enter. If you are new to VBA and need something to be immediately functional, just use .select and SendKeys and come back to it later.</p>\n\n<p>then, 1 week later, I figured out</p>\n\n<pre><code>Call ie.document.parentWindow.execScript(\"setUserIDAndRunDataspy();\", \"JavaScript\")\n</code></pre>\n\n<p>This, on the other hand just literally runs the event itself and is more reliable.\nIn case you run into any issues, the first iterations I tried were something like</p>\n\n<pre><code>Call ie.parentWindow.execScript(\"setUserIDAndRunDataspy();\", \"JavaScript\")\nCall ie.document.execScript(\"setUserIDAndRunDataspy();\", \"JavaScript\")\n</code></pre>\n\n<p>They didn't work for me, but worked for other scripts i checked. I'm not sure why though.</p>\n\n<p>Another solution you could try to though I haven't tested it is what Tim Williams suggested. It would go something like this:</p>\n\n<pre><code>For Each ele In ie.document.getelementsbytagname(\"img\")\n              If InStr(ele.Value, \"./images/dsprun_out.gif\") &gt; 0 Then ele.Click\nNext\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 9358196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e7a5c646b53369db8322d67a87f79e?s=128&d=identicon&r=PG&f=1", "display_name": "Noctsol", "link": "https://stackoverflow.com/users/9358196/noctsol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 49015937, "answer_count": 1, "score": -5, "last_activity_date": 1540405301, "creation_date": 1518646253, "last_edit_date": 1540405301, "question_id": 48797081, "link": "https://stackoverflow.com/questions/48797081/getelementclicking-a-button-with-no-id-tag-name-class-value-siblings", "title": "(GetElement)Clicking a button with no ID, TAG, NAME, CLASS, VALUE, SIBLINGS", "body": "<p>I'm trying to automate a web entry process. I need to get this button to click, but as the title says, it has nothing for me to go off of. This is literally what I'm working with. Anyone have any suggestions? </p>\n\n<p><a href=\"https://i.stack.imgur.com/2RMWx.png\" rel=\"nofollow noreferrer\">Button</a></p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\n\nIE.Navigate \"https://ww3.somewebsite.com/somePortal/processItem.do?action=openItem&amp;userId=someUser\"\n\nIE.document.getElementById(\"filterfields\").Value = \"EVT_CODE\"\n\nIE.document.getElementById(\"filtervalue\").Value = \"9477474\" \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 1, "creation_date": 1518644874, "post_id": 48796735, "comment_id": 84596017, "body": "Please define perfect."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518645216, "post_id": 48796735, "comment_id": 84596175, "body": "What does it do differently the second time?"}, {"owner": {"reputation": 1, "user_id": 9362239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215ae1a6e53086c4d2d7a2f326ea5ff1?s=128&d=identicon&r=PG&f=1", "display_name": "Gibson", "link": "https://stackoverflow.com/users/9362239/gibson"}, "edited": false, "score": 0, "creation_date": 1518645997, "post_id": 48796735, "comment_id": 84596513, "body": "The first time I run it, about half of the desired values are put into place. For some reason when I run it twice, all of my desired values are put into place. The top comment here with a counter and a DoAgain, works."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1518668446, "post_id": 48796735, "comment_id": 84602548, "body": "You need to do a google search for &quot;Dimension&quot; and learn how to use &quot;Variable Types&quot; . Also, search for how not to use &quot;Select&quot;.  The first part of your code copies the range A1 thru B5 on worksheet &quot;Type Data Here&quot;, then moves 2 columns to the right and paste the copied range over and over every 2 columns for 89 times into the same sheet.  Search for how to use activecell; when you copied your range in &quot;Type Data Here&quot; you made A1 the activecell, These are just the issues in the first 11 lines. Clean up your code and then use F8 to step through it to see what each line of code is doing."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 2770315, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e2bad2deecff0e19225f55d903956e5f?s=128&d=identicon&r=PG&f=1", "display_name": "VKid", "link": "https://stackoverflow.com/users/2770315/vkid"}, "is_accepted": true, "score": -1, "last_activity_date": 1518644991, "creation_date": 1518644991, "answer_id": 48796824, "question_id": 48796735, "link": "https://stackoverflow.com/questions/48796735/i-have-to-run-my-macro-twice-how-to-fix/48796824#48796824", "title": "I have to run my macro twice, how to fix?", "body": "<p>Try this, it will run your code twice using a counter:</p>\n\n<pre><code>Sub WellLogAutomator()\n\nDim i As Integer\nDim n As Integer\nDim x As Integer\nDim y As Integer\nDim counter as Integer\n\ncounter = 0\n\nDoAgain:\nn = Worksheets(\"Info\").Range(\"C10:C100\").Cells.SpecialCells(xlCellTypeConstants).Count\n\nSheets(\"Type Data Here\").Select\nRange(\"A1:B5\").Select\nSelection.Copy\n\nFor i = 1 To n - 1\n    ActiveCell.Offset(rowOffset:=0, columnOffset:=2).Activate\n    ActiveSheet.Paste\nNext i\n\nSheets(\"Info\").Select\nCells(10, 3).Select\n\nFor x = 0 To n - 1\n    Sheets(\"Data\").Select\n    Cells(2, 11).Select\n    ActiveCell.Offset(rowOffset:=x, columnOffset:=0).Activate\n    Selection.Copy\n    Sheets(\"Type Data Here\").Select\n    Cells(1, 2).Select\n    ActiveCell.Offset(rowOffset:=0, columnOffset:=2 * x).Activate\n    ActiveCell.PasteSpecial Paste:=xlPasteValues\n    'ActiveSheet.PasteSpecial Paste:=xlPasteValues\nNext x\n\nSheets(\"Data\").Select\nRange(\"H2:H65\").Select\nSelection.Copy\nSheets(\"Data\").Select\nRange(\"I2:I65\").Select\nActiveCell.PasteSpecial Paste:=xlPasteValues\n\nWith Selection\n    .NumberFormat = \"General\"\n    .Value = .Value\nEnd With\n\nIf counter = 0 then\n    counter = counter + 1\n    goto DoAgain\nelse\n    exit sub\nend if\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9362239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215ae1a6e53086c4d2d7a2f326ea5ff1?s=128&d=identicon&r=PG&f=1", "display_name": "Gibson", "link": "https://stackoverflow.com/users/9362239/gibson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 48796824, "answer_count": 1, "score": -1, "last_activity_date": 1518644991, "creation_date": 1518644646, "last_edit_date": 1531164843, "question_id": 48796735, "link": "https://stackoverflow.com/questions/48796735/i-have-to-run-my-macro-twice-how-to-fix", "title": "I have to run my macro twice, how to fix?", "body": "<p>I have a vba code that copy/paste values into a format I use for homework. It all works as intended, but I have to run it twice for it to be perfect. </p>\n\n<p>how do I fix this and just run it once to work?</p>\n\n<pre><code>Sub WellLogAutomator()\n\nDim i As Integer\nDim n As Integer\nDim x As Integer\nDim y As Integer\n\nn = Worksheets(\"Info\").Range(\"C10:C100\").Cells.SpecialCells(xlCellTypeConstants).Count\n\nSheets(\"Type Data Here\").Select\nRange(\"A1:B5\").Select\nSelection.Copy\n\nFor i = 1 To n - 1\n    ActiveCell.Offset(rowOffset:=0, columnOffset:=2).Activate\n    ActiveSheet.Paste\nNext i\n\nSheets(\"Info\").Select\nCells(10, 3).Select\n\nFor x = 0 To n - 1\n    Sheets(\"Data\").Select\n    Cells(2, 11).Select\n    ActiveCell.Offset(rowOffset:=x, columnOffset:=0).Activate\n    Selection.Copy\n    Sheets(\"Type Data Here\").Select\n    Cells(1, 2).Select\n    ActiveCell.Offset(rowOffset:=0, columnOffset:=2 * x).Activate\n    ActiveCell.PasteSpecial Paste:=xlPasteValues\n    'ActiveSheet.PasteSpecial Paste:=xlPasteValues\nNext x\n\nSheets(\"Data\").Select\nRange(\"H2:H65\").Select\nSelection.Copy\nSheets(\"Data\").Select\nRange(\"I2:I65\").Select\nActiveCell.PasteSpecial Paste:=xlPasteValues\n\nWith Selection\n    .NumberFormat = \"General\"\n    .Value = .Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-office", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "edited": false, "score": 0, "creation_date": 1518783724, "post_id": 48815133, "comment_id": 84656893, "body": "Hi and thanks for replying. I was able to reproduce and get the image in the header with the <code>Tag</code> property. But it is essentially the same as typing the full path to the image.&lt;br&gt; Like this  <code>&quot;&amp;P&quot;&quot;[My Documents] \\Image.gif&quot;&quot;</code>. If the user don&#39;t have this file on his hard drive in addition to the .mpp file, it wont show. I was more in the business of doing something like <a href=\"https://danny.fyi/embedding-and-accessing-a-file-in-excel-with-vba-and-ole-objects-4d4e7863cfff\" rel=\"nofollow noreferrer\">this (link)</a>. But it refers too much to Excel VBA that don&#39;t exist in Project."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1518724009, "creation_date": 1518724009, "answer_id": 48815133, "question_id": 48796659, "link": "https://stackoverflow.com/questions/48796659/show-picture-image-from-userform-in-print-header-vba-ms-project/48815133#48815133", "title": "Show picture/image from userform in print header, VBA MS Project", "body": "<p><code>UserForm1.Image1.Picture</code> is a picture <strong><em>object</em></strong>, not the path to the original source file. Once a picture is loaded into an image control, it is embedded and its original path is not stored. </p>\n\n<p>Store the path the the picture so that you can reference it later (e.g. using the <code>Tag</code> property of the Image control). See <a href=\"https://stackoverflow.com/questions/25873268/vba-userform-get-filename\">Stack Overflow: VBA UserForm Get Filename</a> for more details. (FYI: Excel and Project use the same UserForm object, so this is applicable.)</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "is_accepted": false, "score": 1, "last_activity_date": 1518796988, "creation_date": 1518796988, "answer_id": 48830552, "question_id": 48796659, "link": "https://stackoverflow.com/questions/48796659/show-picture-image-from-userform-in-print-header-vba-ms-project/48830552#48830552", "title": "Show picture/image from userform in print header, VBA MS Project", "body": "<p>I gave up on saving the logo inside the Project file itself.</p>\n\n<p>Instead I check if the logo exists inside <code>\"C:\\CompanyLogo\"</code>, if does not, create that direcotry and download it from imgur.</p>\n"}], "owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518796988, "creation_date": 1518644276, "question_id": 48796659, "link": "https://stackoverflow.com/questions/48796659/show-picture-image-from-userform-in-print-header-vba-ms-project", "title": "Show picture/image from userform in print header, VBA MS Project", "body": "<p>I am making a template and thought to store our logo.jpg inside a userform. Then I'll call this userform and insert the logo in the print header for each \"macro activated\" print. </p>\n\n<p>So far I have managed to print the image only as numbers. Bits and bytes probably(?). I might be missing some conversion of the picture before printing:</p>\n\n<pre><code>FilePageSetupHeader Alignment:=pjLeft, Text:=\"&amp;P\" &amp; UserForm1.Image1.Picture &amp; \" \"\n</code></pre>\n\n<p>This prints as: <code>1-670746914</code> in the top left header.</p>\n\n<p>What am I missing? </p>\n\n<p><br></p>\n\n<p>The syntax I found on <a href=\"https://msdn.microsoft.com/en-us/vba/project-vba/articles/application-filepagesetupheader-method-project\" rel=\"nofollow noreferrer\">MSDN</a> gives the following parameters for inserting a picture:</p>\n\n<p><ul> &amp;;P\"\"path\"\"</ul>   <ul>Inserts the specified image. An example would be &amp;;P\"\" [My Documents] \\Image.gif\"\". The term [My Documents] represents the full path to your My Documents folder.</ul> </p>\n\n<p>My code makes a copy of the current view, make changes to the view settings, headers etc, before exporting to PDF and deleting the view again.   </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8845206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6R7cXlNbaC4/AAAAAAAAAAI/AAAAAAAAAJQ/hw37yO8Dgvs/photo.jpg?sz=128", "display_name": "Jim Stevens", "link": "https://stackoverflow.com/users/8845206/jim-stevens"}, "edited": false, "score": 0, "creation_date": 1518650969, "post_id": 48796721, "comment_id": 84598440, "body": "Thanks!  I still don&#39;t understand what was causing it, but this provided a workable solution."}], "tags": [], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "is_accepted": true, "score": 0, "last_activity_date": 1518651387, "last_edit_date": 1518651387, "creation_date": 1518644562, "answer_id": 48796721, "question_id": 48796490, "link": "https://stackoverflow.com/questions/48796490/active-workbook-reverting-to-thisworkbook-without-prompt/48796721#48796721", "title": "Active workbook reverting to &quot;thisworkbook&quot; without prompt", "body": "<p>Not sure what is calling up the other WB into focus. But it is best practice to explicitly define references to workbooks</p>\n\n<pre><code>Sub SheetCode()\n    Dim wbOne As Workbook\n    Dim RwCnt As Long\n\n    Set wbOne = Workbooks(\"The One Sheet\")\n    wbOne.Activate\n    RwCnt = wbOne.ActiveSheet.Range(\"A\" &amp; wbOne.ActiveSheet.Rows.Count).End(xlUp).Row\n\n    MsgBox \"The last row is \" &amp; RwCnt\nEnd Sub\n</code></pre>\n\n<p>Hope that helps, Caleeco</p>\n"}], "owner": {"reputation": 15, "user_id": 8845206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6R7cXlNbaC4/AAAAAAAAAAI/AAAAAAAAAJQ/hw37yO8Dgvs/photo.jpg?sz=128", "display_name": "Jim Stevens", "link": "https://stackoverflow.com/users/8845206/jim-stevens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 48796721, "answer_count": 1, "score": 0, "last_activity_date": 1518651387, "creation_date": 1518643535, "question_id": 48796490, "link": "https://stackoverflow.com/questions/48796490/active-workbook-reverting-to-thisworkbook-without-prompt", "title": "Active workbook reverting to &quot;thisworkbook&quot; without prompt", "body": "<pre><code>Workbooks(\"The One Sheet.xlsx\").Activate\nMsgBox ActiveWorkbook.Name  'Returns \"The One Sheet.xlsx\"\nWorksheets(\"One Sheet\").Activate\n\nMsgBox ActiveWorkbook.Name 'Returns \"The One Sheet.xlsx\"\nRwCnt = Application.WorksheetFunction.CountA(Range(\"A:A\"))\nMsgBox ActiveWorkbook.Name 'Returns the sheet that contains the code\n</code></pre>\n\n<p>Does anyone know what could be calling the other workbook into focus?</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518644086, "post_id": 48796301, "comment_id": 84595678, "body": "You&#39;re talking about 2 variables in 2 cells, but the only variables I&#39;m seeing are <code>objExcel</code>, <code>objWorkbook</code>, and <code>filepath</code>, with only <code>objExcel</code> being actually declared. Stick <code>Option Explicit</code> at the top of your module, declare every variable you&#39;re using. Now, I&#39;ve no idea what you&#39;re asking. If you don&#39;t know the name of the worksheet, its codename, index, or anything, then you can&#39;t grab a reference to any specific sheet. Use explicit references: <code>Cells(1,1)</code> is implicitly referring to whatever worksheet is currently active, which is very error-prone."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518644161, "post_id": 48796301, "comment_id": 84595715, "body": "Why do you open two different Excel instances? Can\u2019t you open the second workbook in the same Excel instance that opened the first workbook?"}, {"owner": {"reputation": 19, "user_id": 3456612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53465d568615052029f9e7ca218bd173?s=128&d=identicon&r=PG&f=1", "display_name": "user3456612", "link": "https://stackoverflow.com/users/3456612/user3456612"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519056143, "post_id": 48796301, "comment_id": 84743412, "body": "@Mat&#39;sMug, the code that i showed is only the code to open the other workbook. The first workbook will get its own filepath and file name and insert them into 2 cells on sheet1 then open WB 2. WB2 will then reach into WB1 and read those 2 cells and insert those into variables in WB2. my question is, how do i reach from WB2 into WB1 to read cells"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519056303, "post_id": 48796301, "comment_id": 84743501, "body": "Maybe reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> will help you structure things more clearly."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 3456612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53465d568615052029f9e7ca218bd173?s=128&d=identicon&r=PG&f=1", "display_name": "user3456612", "link": "https://stackoverflow.com/users/3456612/user3456612"}, "edited": false, "score": 0, "creation_date": 1519057075, "post_id": 48798072, "comment_id": 84743972, "body": "That did exactly what I was looking for, thank you very much!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1518652147, "creation_date": 1518652147, "answer_id": 48798072, "question_id": 48796301, "link": "https://stackoverflow.com/questions/48796301/passing-variables-from-multiple-workbooks-to-one-workbook/48798072#48798072", "title": "passing variables from multiple workbooks to one workbook", "body": "<p>Your code is in Workbook1, and opens Workbook2. So it's Workbook1 that does everything - so \" I cant get the second file to read the things I need\" is not meaningful. </p>\n\n<pre><code>  Sub Demo(filepath as string)\n  ThisWorkbook.Worksheets(1).cells(1,1).text = \"This is written by initial Workook\"      \n  Dim Wb as Workbook\n  Set Wb = Workbooks.Open(filepath)\n  Wb.Sheets(1).cells(1,2) = \"So is this, even though it's in a different workbook\"\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 3456612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53465d568615052029f9e7ca218bd173?s=128&d=identicon&r=PG&f=1", "display_name": "user3456612", "link": "https://stackoverflow.com/users/3456612/user3456612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 48798072, "answer_count": 1, "score": 0, "last_activity_date": 1518652147, "creation_date": 1518642728, "question_id": 48796301, "link": "https://stackoverflow.com/questions/48796301/passing-variables-from-multiple-workbooks-to-one-workbook", "title": "passing variables from multiple workbooks to one workbook", "body": "<p>I am using Visual basic from excel to open a different workbook and pass some things from one to another. I have the second file opening fine however I cant get the second file to read the things I need. </p>\n\n<pre><code>Sub createExcel()\nCells(1, 1).Text = \"va02\"\nDim objExcel\n    Set objExcel = CreateObject(\"Excel.Application\")\n    objExcel.Visible = True\n    Set objWorkbook = objExcel.Workbooks.Open(filepath)\n    End Sub\n</code></pre>\n\n<p>this is my code to open the second application. I have 2 variables in 2 cells in the first workbook. How would one go about getting the variables. the problem i have encountered is; the second workbook can be called from any file, in any folder.</p>\n\n<p>i would try\n    variable = Workbooks(firstWorkbook.xlsm).worksheets(sheet1)...\nhowever the worksheets dont have the same names either. please help</p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "cell", "history"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1518642664, "post_id": 48796172, "comment_id": 84594993, "body": "Add a check to nNewRow and only perform the <code>sData.Cells(nNewRow...</code> operation if it&#39;s less than N rows"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1518642699, "post_id": 48796172, "comment_id": 84595015, "body": "For example: <code>If nNewRow &lt; 100 Then</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1518643158, "post_id": 48796172, "comment_id": 84595266, "body": "Also, as a note, you have Dim <i>sDate</i>, but then you Set <i>sData</i>, looks like a typo.  May want to Dim it as <i>sData</i> so that it all matches and the variable is declared properly.  You can avoid these kind of typo errors by turning on <a href=\"http://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a>"}, {"owner": {"reputation": 1, "user_id": 9362090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b661b47ad0812e5a81f6bf859bd4b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P", "link": "https://stackoverflow.com/users/9362090/dave-p"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1518643202, "post_id": 48796172, "comment_id": 84595285, "body": "I&#39;m new to using VBA so I might be misunderstanding something fundamental but I&#39;m not able to get the if/then check to work. No errors are reported in the code but when I continued to generate values the cell history continued to record beyond the specified limit."}, {"owner": {"reputation": 1, "user_id": 9362090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b661b47ad0812e5a81f6bf859bd4b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P", "link": "https://stackoverflow.com/users/9362090/dave-p"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1518643304, "post_id": 48796172, "comment_id": 84595334, "body": "I simply added: If nNewRow &lt; 10 then above nNewRow=sData.Cell(Row..) and added Else End If underneath the following line"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1518643821, "creation_date": 1518643821, "answer_id": 48796565, "question_id": 48796172, "link": "https://stackoverflow.com/questions/48796172/recording-cell-history-stop-recording-cell-history-if-record-exceeds-n-rows/48796565#48796565", "title": "Recording cell history, stop recording cell history if record exceeds N rows", "body": "<p>Something like this should work for you.  Note that you don't have to define the sheet, the passed <code>Sh</code> object variable does that for you, just specify which sheet to check.</p>\n\n<pre><code>Private Sub Workbook_SheetCalculate(ByVal Sh As Object)\n\n    Dim nNewRow As Long\n\n    'Disable events to prevent infinite loops\n    Application.enableevents = False\n\n    'Verify we are working with Sheet1\n    If LCase(Sh.Name) = \"sheet1\" Then\n        'Check the value of nNewRow\n        nNewRow = Sh.Cells(Sh.Rows.Count, 1).End(xlUp).Row + 1\n        If nNewRow &lt;= 10 Then\n            'Within threshold, record value\n            Sh.Cells(nNewRow, 1).Value = Sh.Range(\"A1\").Value\n        End If\n    End If\n\n    'Turn events back on\n    Application.enableevents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9362090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b661b47ad0812e5a81f6bf859bd4b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P", "link": "https://stackoverflow.com/users/9362090/dave-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518652683, "creation_date": 1518642237, "last_edit_date": 1518652683, "question_id": 48796172, "link": "https://stackoverflow.com/questions/48796172/recording-cell-history-stop-recording-cell-history-if-record-exceeds-n-rows", "title": "Recording cell history, stop recording cell history if record exceeds N rows", "body": "<p>So far I have the code needed to write the cell history to a new row, but am missing what is needed to stop writing cell history once I have gathered the desired amount of values. I would like for the macro to stop recording cell history once it has stored 100 or 1000 values</p>\n\n<pre><code>Private Sub Workbook_SheetCalculate(ByVal Sh As Object)\nDim sDate As Worksheet\nDim nNewRow As Long\n\nSet sData = Worksheets(\"sheet1\")\nnNewRow = sData.Cells(Rows.Count, 1).End(xlUp).Row + 1\nsData.Cells(nNewRow, 1).Value = sData.Range(\"A1\").Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8953891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f9561bca4917264d36bb46723a03fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Z", "link": "https://stackoverflow.com/users/8953891/ali-z"}, "edited": false, "score": 0, "creation_date": 1519746953, "post_id": 48796329, "comment_id": 85030267, "body": "In the end I resorted to querying the database first in Excel and using formulas to determine whether the item should be saved. It works. Your solution gave me the idea to get there."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1518642877, "creation_date": 1518642877, "answer_id": 48796329, "question_id": 48796034, "link": "https://stackoverflow.com/questions/48796034/avoid-duplicates-before-they-are-stored-in-access/48796329#48796329", "title": "Avoid duplicates before they are stored in Access", "body": "<p>You can use a query to check for duplicates, and import all non-duplicate data.</p>\n\n<p><a href=\"https://stackoverflow.com/a/48793149/7296893\">This answer</a> outlines a general way to construct a query to import Excel data into Access. We can add a <code>NOT EXISTS</code> clause and check if a duplicate already exists</p>\n\n<pre><code>strSQL = \"INSERT INTO WDATA([Date], SKU_Rep, Vendor_Parts, [other], [fields]) \" &amp; _\n\"SELECT F1, F2, F3, etc \" &amp; _\n\"FROM [Excel 12.0 Macro; HDR=No;Database=\" &amp; ActiveWorkbook.FullName &amp; \"].[Product Hierarchy$A2:G\" &amp; Sheets(\"Product Hierarchy\").Cells(Rows.Count, 4).End(xlUp).Row &amp; \"]\" &amp; _\n\"WHERE NOT EXISTS (SELECT 1 FROM WDATA WHERE [Date] = F1 AND SKU_Rep = F2 And etc)\"\ndb.Execute strSQL\ndb.Close\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8953891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f9561bca4917264d36bb46723a03fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Z", "link": "https://stackoverflow.com/users/8953891/ali-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518642877, "creation_date": 1518641769, "last_edit_date": 1531164843, "question_id": 48796034, "link": "https://stackoverflow.com/questions/48796034/avoid-duplicates-before-they-are-stored-in-access", "title": "Avoid duplicates before they are stored in Access", "body": "<p>I have an Excel file that stores freshly produced data into Access (before save event), then cleans the Excel. What I want to do is to find out if the macro is going to store a duplicate based on column 4, named 'Vendor_Parts' and skip the Access export for that item (which already exists in Access), then continue exporting. I have the following code running up smoothly:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nDim DB As DAO.Database\nDim RS As DAO.Recordset\nDim erow As Integer\n\n' open database\nSet DB = DAO.OpenDatabase(\"my companies' database path\")\n\n' open table as a recordset\nSet RS = DB.OpenRecordset(\"WDATA\")\n\n'set last empty row\nerow = Sheets(\"Product Hierarchy\").Cells(Rows.Count, 4).End(xlUp).Row\n\n'iterate through each cell and fill values in Access\n\n      With RS\n      For erow = 2 To erow\n            .AddNew\n            !Date = Cells(erow, 1)\n            !SKU_Rep = Cells(erow, 2)\n            !Vendor_Parts = Cells(erow, 4)\n            !PH = Cells(erow, 5)\n            !GM = Cells(erow, 6)\n            ' add more fields here\n          .Update\n       Next erow\n\n    End With\n\n'cleanup database\nRS.Close\n\n' close the database to avoid lockdown\nDB.Close\n\nSet RS = Nothing\nSet DB = Nothing\n\n'Clean information already sent to access\nRange(\"A2:F1000000\").ClearContents\n\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas for calling a duplicate checker that avoids export? Thank you</p>\n"}, {"tags": ["oracle", "excel", "odbc", "vba"], "comments": [{"owner": {"reputation": 1122, "user_id": 1474528, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bc9db0fbd2e254351aff8e754d8eb5f?s=128&d=identicon&r=PG", "display_name": "akhil", "link": "https://stackoverflow.com/users/1474528/akhil"}, "edited": false, "score": 0, "creation_date": 1518647118, "post_id": 48795965, "comment_id": 84596976, "body": "Installing Oracle Instant client should solve your problem. <a href=\"http://www.oracle.com/technetwork/topics/winsoft-085727.html\" rel=\"nofollow noreferrer\">oracle.com/technetwork/topics/winsoft-085727.html</a>."}, {"owner": {"reputation": 219, "user_id": 7915605, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/75SYC.jpg?s=128&g=1", "display_name": "Mike Shanahan", "link": "https://stackoverflow.com/users/7915605/mike-shanahan"}, "reply_to_user": {"reputation": 1122, "user_id": 1474528, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bc9db0fbd2e254351aff8e754d8eb5f?s=128&d=identicon&r=PG", "display_name": "akhil", "link": "https://stackoverflow.com/users/1474528/akhil"}, "edited": false, "score": 0, "creation_date": 1518703314, "post_id": 48795965, "comment_id": 84621278, "body": "Thank you for the suggestion akhil.  I have edited my question to reflect."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1518707102, "post_id": 48795965, "comment_id": 84623902, "body": "Why can you not install the Instant Client?  Their binaries are part of ANY Oracle installation."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1518707348, "post_id": 48795965, "comment_id": 84624086, "body": "Check the Oracle download page for ODBC Instant Client (or similar) Ensure to install the 32-bit version"}], "answers": [{"comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 1, "creation_date": 1518979432, "post_id": 48815045, "comment_id": 84713984, "body": "The 64-bit Client does not work with 32-bit Excel. Also there is no reason to download and install the full client."}, {"owner": {"reputation": 129, "user_id": 5568173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWu4WtMdDys/AAAAAAAAAAI/AAAAAAAABV8/JrBKsGK5K1k/photo.jpg?sz=128", "display_name": "Younes El-karama", "link": "https://stackoverflow.com/users/5568173/younes-el-karama"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520603823, "post_id": 48815045, "comment_id": 85395479, "body": "Since the instant client is not an option, the only alternative is the full Oracle Client installer, associated with a response file to only install the required ODBC support + required dependencies...  In addition, the other advantage of the full installer is that it takes care of all the configurations (no more manual registry and/or dll registrations)"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520605387, "post_id": 48815045, "comment_id": 85396452, "body": "Just a note, recently I installed Oracle 12.2 Client. Unlike earlier releases it did not register ODP.NET (<code>Oracle.DataAccess.dll</code> and <code>Oracle.ManagedDataAccess.dll</code>) into GAC anymore. I had to do it manually. Nevertheless, the ODBC driver was installed properly."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 1, "creation_date": 1520605827, "post_id": 48815045, "comment_id": 85396703, "body": "Another note, actually &quot;Oracle Net&quot; (<code>oracle.network.client</code>) would not be required. But due to a bug in Oracle 12 (12.1 and 12.2) you have to include it, see <a href=\"https://support.oracle.com/epmos/faces/DocumentDisplay?id=1589205.1\" rel=\"nofollow noreferrer\">Oracle Client 12.1.0.1.0 Custom Install Type Does Not Include ORACLSCE12.DLL (Doc ID 1589205.1)</a>"}, {"owner": {"reputation": 129, "user_id": 5568173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWu4WtMdDys/AAAAAAAAAAI/AAAAAAAABV8/JrBKsGK5K1k/photo.jpg?sz=128", "display_name": "Younes El-karama", "link": "https://stackoverflow.com/users/5568173/younes-el-karama"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520610641, "post_id": 48815045, "comment_id": 85399741, "body": "That&#39;s why I included it on my response file, because I already run into this issue..."}], "tags": [], "owner": {"reputation": 129, "user_id": 5568173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWu4WtMdDys/AAAAAAAAAAI/AAAAAAAABV8/JrBKsGK5K1k/photo.jpg?sz=128", "display_name": "Younes El-karama", "link": "https://stackoverflow.com/users/5568173/younes-el-karama"}, "is_accepted": false, "score": 0, "last_activity_date": 1520603690, "last_edit_date": 1520603690, "creation_date": 1518723628, "answer_id": 48815045, "question_id": 48795965, "link": "https://stackoverflow.com/questions/48795965/proper-oracle-odbc-driver-installation-on-32-bit-windows-7/48815045#48815045", "title": "Proper Oracle ODBC Driver Installation on 32 bit Windows 7", "body": "<p>Get the full <strong>32-bit</strong> Oracle client installer (not the ODAC) from here:</p>\n\n<pre><code>http://download.oracle.com/otn/nt/oracle12c/122010/win32_12201_client.zip\n</code></pre>\n\n<p>Do an silent install using this reponse file (edit as needed and save as <strong>client_install_32.rsp</strong> in the same directory as setup.exe)</p>\n\n<p><a href=\"https://pastebin.com/Vf8bsT9L\" rel=\"nofollow noreferrer\">Response file</a></p>\n\n<pre><code>setup.exe\" ORACLE_HOME_NAME=OracleClient12201x32 -waitforcompletion -nowait -silent -responseFile client_install_32.rsp \n</code></pre>\n\n<p>The key config entry is this:</p>\n\n<pre><code>oracle.install.client.customComponents=\"oracle.rdbms.oci:12.2.0.1.0\",\"oracle.network.client:12.2.0.1.0\",\"oracle.odbc:12.2.0.1.0\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219, "user_id": 7915605, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/75SYC.jpg?s=128&g=1", "display_name": "Mike Shanahan", "link": "https://stackoverflow.com/users/7915605/mike-shanahan"}, "edited": false, "score": 0, "creation_date": 1519066996, "post_id": 48855350, "comment_id": 84749023, "body": "Thank you Mr. Domscheit.  I have been pulled off this assignment to fight a fire, but will attempt to implement your advice soon.  I will return with the results!"}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": true, "score": 1, "last_activity_date": 1518979823, "creation_date": 1518979823, "answer_id": 48855350, "question_id": 48795965, "link": "https://stackoverflow.com/questions/48795965/proper-oracle-odbc-driver-installation-on-32-bit-windows-7/48855350#48855350", "title": "Proper Oracle ODBC Driver Installation on 32 bit Windows 7", "body": "<p>The smallest solution is to download the </p>\n\n<p><strong>Instant Client Package - ODBC: Additional libraries for enabling ODBC applications</strong> (instantclient-odbc-nt-12.2.0.1.0-2.zip)</p>\n\n<p>from <a href=\"http://www.oracle.com/technetwork/topics/winsoft-085727.html\" rel=\"nofollow noreferrer\">Instant Client Downloads for Microsoft Windows 32-bit</a></p>\n\n<p>You can also download the <strong>ODAC with Oracle Developer Tools for Visual Studio</strong> from <a href=\"http://www.oracle.com/technetwork/topics/dotnet/downloads/odacdev-4242174.html\" rel=\"nofollow noreferrer\">ODAC Developer Downloads - Oracle Universal Installer</a></p>\n"}], "owner": {"reputation": 219, "user_id": 7915605, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/75SYC.jpg?s=128&g=1", "display_name": "Mike Shanahan", "link": "https://stackoverflow.com/users/7915605/mike-shanahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1514, "favorite_count": 0, "accepted_answer_id": 48855350, "answer_count": 2, "score": 0, "last_activity_date": 1520603690, "creation_date": 1518641503, "last_edit_date": 1531164843, "question_id": 48795965, "link": "https://stackoverflow.com/questions/48795965/proper-oracle-odbc-driver-installation-on-32-bit-windows-7", "title": "Proper Oracle ODBC Driver Installation on 32 bit Windows 7", "body": "<p>I am using an Excel VBA application to connect to an Oracle 12c database.<br>\nExcel is 2010, 32 bit, in Windows 7.</p>\n\n<p>Many have advised Oracle Instant Client, but this has not worked for me.  The installation requires a number of configuration steps that I cannot perform due to administrative restrictions on my workstation.</p>\n\n<p>However, I have installed the ODAC 12.2c Release 1 and Oracle Developer Tools for Visual Studio (12.2.0.1.0), available <a href=\"http://www.oracle.com/technetwork/topics/dotnet/utilsoft-086879.html\" rel=\"nofollow noreferrer\">HERE</a>.  This package includes the Oracle ODBC driver which works for my application.  However, it contains several other components that I do not need, and throws some errors during installation that are disconcerting.  </p>\n\n<p>Can anyone tell me which of the following components I actually need to select in order to get the ODBC Driver?</p>\n\n<p><a href=\"https://i.stack.imgur.com/D2o4e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D2o4e.png\" alt=\"ODAC Options\"></a></p>\n\n<p>Since I cannot get InstantClient to work with my companies restrictions, I'm now aiming to use this package, but hopefully to slim it down to just the component I need.  I'm doing trial and error, but it's messy.  The installation takes a long time and there's no uninstaller, so I have to manually delete the files after installation.</p>\n\n<p>Thanks for any help you can provide!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 3023486, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e99b1cb3ea6b3a4724a64a9d4e80d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "A.P.", "link": "https://stackoverflow.com/users/3023486/a-p"}, "edited": false, "score": 0, "creation_date": 1518641796, "post_id": 48795911, "comment_id": 84594538, "body": "Exactly what I was looking for."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1518641245, "creation_date": 1518641245, "answer_id": 48795911, "question_id": 48795819, "link": "https://stackoverflow.com/questions/48795819/excel-column-autofill-increment-by-two-steps-instead-of-one/48795911#48795911", "title": "Excel column autofill increment by two steps instead of one", "body": "<p>Use the non Volatile INDEX()</p>\n\n<pre><code>=VLOOKUP($A2,INDEX(Sheet1!$A:$HZZ,1,(COLUMN(A:A)-1)*2+1):INDEX(Sheet1!$A:$HZZ,1040000,(COLUMN(A:A)-1)*2+2),2,FALSE)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1518688750, "creation_date": 1518688750, "answer_id": 48804357, "question_id": 48795819, "link": "https://stackoverflow.com/questions/48795819/excel-column-autofill-increment-by-two-steps-instead-of-one/48804357#48804357", "title": "Excel column autofill increment by two steps instead of one", "body": "<p>You can use <code>OFFSET</code> for this:</p>\n\n<pre><code>=VLOOKUP($A2, OFFSET(Sheet1!$A:$B, 0, 2*(Column()-2)), 2, FALSE)\n</code></pre>\n\n<p>This will start with the target range <code>$A:$B</code>, then move it down <code>0</code> rows and across <code>2*(Column()-2)</code> columns.  For B/C/D this will be 0/2/4 columns</p>\n"}], "owner": {"reputation": 371, "user_id": 3023486, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e99b1cb3ea6b3a4724a64a9d4e80d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "A.P.", "link": "https://stackoverflow.com/users/3023486/a-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 48804357, "answer_count": 2, "score": 1, "last_activity_date": 1518688750, "creation_date": 1518640876, "last_edit_date": 1531161705, "question_id": 48795819, "link": "https://stackoverflow.com/questions/48795819/excel-column-autofill-increment-by-two-steps-instead-of-one", "title": "Excel column autofill increment by two steps instead of one", "body": "<p>In cell B2, I have the following formula </p>\n\n<pre><code>=VLOOKUP($A2,Sheet1!A:B,2,0)\n</code></pre>\n\n<p>Now if I autofill to the right in cell C2, the formula becomes</p>\n\n<pre><code>=VLOOKUP($A2,Sheet1!B:C,2,0)\n</code></pre>\n\n<p>but I would like it to become</p>\n\n<pre><code>=VLOOKUP($A2,Sheet1!C:D,2,0) i.e. C:D instead of B:C (two step increment)\n</code></pre>\n\n<p>and so forth with </p>\n\n<pre><code>=VLOOKUP($A2,Sheet1!E:F,2,0)\n</code></pre>\n\n<p>in cell D2 and etcetera up to more or less 3000 columns.</p>\n\n<p>How could this be achieved? A VBA macro would be fine, but I'd prefer not to use a macro if possible.</p>\n"}, {"tags": ["excel", "vba", "loops", "copy"], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1518640981, "creation_date": 1518640981, "answer_id": 48795850, "question_id": 48795767, "link": "https://stackoverflow.com/questions/48795767/copy-cell-value-to-defined-sheet-cell-reference-loop/48795850#48795850", "title": "Copy Cell Value To Defined Sheet &amp; Cell Reference (Loop)", "body": "<p>You were almost there</p>\n\n<pre><code>Sub CopyValues()\n\nDim SheetName\nDim CellRef\nDim Value\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    For i = 1 to 200\n        SheetName = Range(\"A\" &amp; i).Value\n        CellRef = Range(\"B\" &amp; i).Value\n        Value = Range(\"C\" &amp; i).Value\n        ThisWorkbook.Sheets(SheetName).Range(CellRef).Value = Value\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518641908, "creation_date": 1518641908, "answer_id": 48796077, "question_id": 48795767, "link": "https://stackoverflow.com/questions/48795767/copy-cell-value-to-defined-sheet-cell-reference-loop/48796077#48796077", "title": "Copy Cell Value To Defined Sheet &amp; Cell Reference (Loop)", "body": "<pre><code>Sub CopyValues()\n    With ThisWorkbook.WorkSheets(\"Sheet1\")\n        For Each cell in .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp))\n            ThisWorkbook.Sheets(cell.Value).Range(cell.Offset(,1).Formula = cell.Offset(,2).Formula\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9361984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac93280fc74e3a0da48501457e88dfe?s=128&d=identicon&r=PG&f=1", "display_name": "mjayna270", "link": "https://stackoverflow.com/users/9361984/mjayna270"}, "is_accepted": false, "score": 0, "last_activity_date": 1518643016, "creation_date": 1518643016, "answer_id": 48796365, "question_id": 48795767, "link": "https://stackoverflow.com/questions/48795767/copy-cell-value-to-defined-sheet-cell-reference-loop/48796365#48796365", "title": "Copy Cell Value To Defined Sheet &amp; Cell Reference (Loop)", "body": "<p>Thank you both!\nI settled on the below which solved my problem.</p>\n\n<pre><code>Sub CopyValues()\n\nDim SheetName\nDim CellRef\nDim Value\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    For i = Range(\"SheetNameRange\").Row To Range(\"SheetNameRange\").Row + Range(\"SheetNameRange\").Rows.Count - 1\n        SheetName = Range(\"A\" &amp; i).Value\n        CellRef = Range(\"B\" &amp; i).Value\n        Value = Range(\"C\" &amp; i).Value\n        ThisWorkbook.Sheets(SheetName).Range(CellRef).Value = Value\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9361984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac93280fc74e3a0da48501457e88dfe?s=128&d=identicon&r=PG&f=1", "display_name": "mjayna270", "link": "https://stackoverflow.com/users/9361984/mjayna270"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1518652723, "creation_date": 1518640597, "last_edit_date": 1518652723, "question_id": 48795767, "link": "https://stackoverflow.com/questions/48795767/copy-cell-value-to-defined-sheet-cell-reference-loop", "title": "Copy Cell Value To Defined Sheet &amp; Cell Reference (Loop)", "body": "<p>I'm trying to copy values from a range based on a user defined sheet and cell reference. For example in A1 I have defined the Sheet Name to be copied to, B1 is the cell reference to be copied to &amp; C1 is the value to be copied. The below code completes this for row 1 only, but I require to loop this for all rows in a defined range (i.e. named range A1:C200) or until the row is blank.</p>\n\n<p>Preferably I would have an option to copy the cell value in the range (e.g. C1 as above) or the formula that exists in the range.</p>\n\n<pre><code>Sub CopyValues()\n\nDim SheetName\nDim CellRef\nDim Value\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\nSheetName = Range(\"A1\").Value\nCellRef = Range(\"B1\").Value\nValue = Range(\"C1\").Value\nEnd With\n\nThisWorkbook.Sheets(SheetName).Range(CellRef).Value = Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "loops", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9361957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccbf3dd61c1ba6f9b2c382409d7435d?s=128&d=identicon&r=PG&f=1", "display_name": "A. H.", "link": "https://stackoverflow.com/users/9361957/a-h"}, "edited": false, "score": 0, "creation_date": 1518640356, "post_id": 48795640, "comment_id": 84593830, "body": "Oh! I got you. Thanks!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1518640420, "last_edit_date": 1518640420, "creation_date": 1518640019, "answer_id": 48795640, "question_id": 48795523, "link": "https://stackoverflow.com/questions/48795523/looping-different-ranges-of-cell-in-excel-using-macros/48795640#48795640", "title": "Looping different ranges of cell in Excel using macros", "body": "<p>Currently you are adding every cell in Rng12 to every cell in rng11.  We want to loop once through one of the ranges and refer to the corresponding cell in the other.</p>\n\n<pre><code>Sub auto_updateTest()\nDim rng11 As Range, rng12 As Range\nDim i As Long, j As Long\n\nWith Worksheets(\"Sheet1\") 'change to your sheet\n    Set rng11 = .Range(\"E3:F4\")\n    Set rng12 = .Range(\"A3:B4\")\n    For i = 1 To rng11.Rows.Count\n        For j = 1 To rng11.Columns.Count\n            rng11.Cells(i, j).Value = rng11.Cells(i, j).Value + rng12.Cells(i, j).Value\n\n        Next j\n    Next i\nEnd with\n\nEnd Sub\n</code></pre>\n\n<p>Now with this small of a range it will be quick but as the ranges get larger, consider moving everything to memory arrays.  This will limit the number of call to the worksheet and speed up larger number sets:</p>\n\n<pre><code>Sub auto_updateTest()\nDim rng11 As Variant, rng12 As Variant\nDim i As Long, j As Long\n\nWith Worksheets(\"Sheet1\") 'change to your sheet\n    rng11 = .Range(\"E3:F4\").Value\n    rng12 = .Range(\"A3:B4\").Value\n    If UBound(rng11, 1) &lt;&gt; UBound(rng12, 1) Or UBound(rng11, 2) &lt;&gt; UBound(rng12, 2) Then\n        MsgBox \"Ranges not the same size\"\n        Exit Sub\n    End If\n    For i = LBound(rng11, 1) To UBound(rng11, 1)\n        For j = LBound(rng11, 2) To UBound(rng11, 2)\n            rng11(i, j) = rng11(i, j) + rng12(i, j)\n\n        Next j\n    Next i\n    .Range(\"E3:F4\").Value = rng11\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": false, "score": 0, "last_activity_date": 1518640344, "creation_date": 1518640344, "answer_id": 48795710, "question_id": 48795523, "link": "https://stackoverflow.com/questions/48795523/looping-different-ranges-of-cell-in-excel-using-macros/48795710#48795710", "title": "Looping different ranges of cell in Excel using macros", "body": "<p>Your inner loop (cell11) adds 1 to each value in rng11, and then the outer loop increments and the inner loop repeats.  I calculate that E3 ends up as 17.  Try using a single loop, and use offsets.</p>\n"}], "owner": {"reputation": 5, "user_id": 9361957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccbf3dd61c1ba6f9b2c382409d7435d?s=128&d=identicon&r=PG&f=1", "display_name": "A. H.", "link": "https://stackoverflow.com/users/9361957/a-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 48795640, "answer_count": 2, "score": 0, "last_activity_date": 1518640420, "creation_date": 1518639533, "last_edit_date": 1531161705, "question_id": 48795523, "link": "https://stackoverflow.com/questions/48795523/looping-different-ranges-of-cell-in-excel-using-macros", "title": "Looping different ranges of cell in Excel using macros", "body": "<p>I am trying to loop a different set of ranges on an excel sheet. This is my sheet - <a href=\"https://i.stack.imgur.com/AZKvx.png\" rel=\"nofollow noreferrer\">Example sheet</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/AZKvx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AZKvx.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I run the macro, I want it to show up 4,6,12 and 14 in column E and F. This is my code. </p>\n\n<pre><code>Sub auto_updateTest()\nDim rng11 As Range, cell11 As Range\nDim rng12 As Range, cell12 As Range\n\n    Set rng11 = Range(\"E3:F4\")\n    Set rng12 = Range(\"A3:B4\")\n    For Each cell12 In rng12\n        For Each cell11 In rng11\n    cell11.Value = cell11.Value + cell12.Value\n\n    Next cell11\n    Next cell12\n\n\nEnd Sub\n</code></pre>\n\n<p>What is the mistake here?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1518640261, "post_id": 48795461, "comment_id": 84593777, "body": "Sound to me like you didnt copy/paste the right things. Is your <code>For</code> line still in there? or did you replace it?"}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1518641475, "post_id": 48795461, "comment_id": 84594402, "body": "Yes, that line is still there. Without that line how the code will know where the email addresses are? Can you show me the complete code?"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1518639290, "creation_date": 1518639290, "answer_id": 48795461, "question_id": 48795439, "link": "https://stackoverflow.com/questions/48795439/processs-cells-with-values-only-in-a-hardcoded-range/48795461#48795461", "title": "Processs cells with values only in a hardcoded range", "body": "<p>Put a check on <code>Cell</code> to see if it's nothing before trying to use it.</p>\n\n<pre><code>If Not cell Is Nothing Then\n  If cell.Value &lt;&gt; \"\" Then\n    Set objMail = objOutlook.CreateItem(0)\n    With objMail\n        .To = cell.Value\n        .Subject = \"This is the test subject\"\n        .Body = \"This is the test email body\"\n        .Send\n    End With\n  End If\nEnd IF\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1518661552, "creation_date": 1518661552, "answer_id": 48799173, "question_id": 48795439, "link": "https://stackoverflow.com/questions/48795439/processs-cells-with-values-only-in-a-hardcoded-range/48799173#48799173", "title": "Processs cells with values only in a hardcoded range", "body": "<p><em>Or simply use <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/range-end-property-excel\" rel=\"nofollow noreferrer\">Range.End Property (Excel)</a></em></p>\n\n<pre><code>Dim rCell As Range\nFor Each rCell In Ws.Range(\"G2\", Ws.Range(\"G100\").End(xlUp))\n     'code here \nNext rCell\n</code></pre>\n\n<hr>\n\n<p><em>Full Example</em></p>\n\n<pre><code>Option Explicit\nSub Send_Bulk_Mail()\n    Dim objOutlook As Object\n    Dim objMail As Object\n    Dim Ws As Worksheet\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set Ws = ActiveSheet\n\n    Dim rCell As Range\n    For Each rCell In Ws.Range(\"G2\", Ws.Range(\"G100\").End(xlUp))\n        Debug.Print rCell.Address\n        Set objMail = objOutlook.CreateItem(0)\n\n        With objMail\n            .To = rCell.Value\n            .Subject = \"This is the test subject\"\n            .Body = \"This is the test email body\"\n            .Send\n        End With\n\n    Next rCell\n\n    Set objMail = Nothing\n    Set Ws = Nothing\n    Set objOutlook = Nothing\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>See more Examples here <a href=\"https://stackoverflow.com/a/48497589/4539709\">https://stackoverflow.com/a/48497589/4539709</a></em></p>\n"}], "owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 48799173, "answer_count": 2, "score": 1, "last_activity_date": 1524310640, "creation_date": 1518639123, "last_edit_date": 1524310640, "question_id": 48795439, "link": "https://stackoverflow.com/questions/48795439/processs-cells-with-values-only-in-a-hardcoded-range", "title": "Processs cells with values only in a hardcoded range", "body": "<p>I have code to draft emails to all the recipient in column 'G'.</p>\n\n<pre><code>    Sub Send_Bulk_Mail()\n\n    Dim objOutlook As Object\n    Dim objMail As Object\n    Dim ws As Worksheet\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set ws = ActiveSheet\n\n  For Each cell In ws.Range(\"G2:G100\")\n\n    Set objMail = objOutlook.CreateItem(0)\n\n        With objMail\n            .To = cell.Value\n            .Subject = \"This is the test subject\"\n            .Body = \"This is the test email body\"\n            .Send\n        End With\n\n        Set objMail = Nothing\n    Next cell\n\n    Set ws = Nothing\n    Set objOutlook = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>When there are fewer rows than 100 in column G, there is an error after drafting all the emails.</p>\n\n<p>How can I stop automatically after the last email?</p>\n\n<p>Here is the link to sample <a href=\"https://drive.google.com/file/d/1rH3kWgAgIMnS9SkZILUk4aNwz2BGhVVH/view?usp=sharing\" rel=\"nofollow noreferrer\">Click here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1518638274, "post_id": 48795203, "comment_id": 84592789, "body": "Can you just sort it after moving it?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518639987, "post_id": 48795353, "comment_id": 84593611, "body": "Its working as intended but I now realize I explained myself poorly as I also need this filter to be working everytime someone adds data down the copy range, is there a way for this filter to be active at all times?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518641895, "post_id": 48795353, "comment_id": 84594594, "body": "@JonhDoe See updated answer, make sure you use a header column (it will reduce a lot of headache if cell S1 is a header, and actual data starts in cell S2) and make sure you put the code in the appropriate sheet&#39;s code module (this will not work if it&#39;s in a standard module)."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1518641834, "last_edit_date": 1518641834, "creation_date": 1518638780, "answer_id": 48795353, "question_id": 48795203, "link": "https://stackoverflow.com/questions/48795203/sort-and-remove-duplicates-vba/48795353#48795353", "title": "Sort and remove duplicates VBA", "body": "<p>For this solution, it is <em>highly</em> recommended that cell S1 be a header instead of data.  As for getting the filter and sort to happen anytime a change is made, use the Worksheet_Change event. Be sure to put this code in a Sheet Module, not a standard module.  To get into a Sheet Module, double-click the desired sheet name on the left-hand side of the Visual Basic Editor and that will open that sheet's code module.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rData As Range\n    Dim rDest As Range\n\n    'Adjust these as necessary\n    Set rData = Me.Range(\"S1\", Me.Cells(Me.Rows.Count, \"S\").End(xlUp))\n    Set rDest = Me.Range(\"T1\")\n\n    'Disable events to prevent infinite loops\n    Application.enableevents = False\n\n    'Clear previous results\n    rDest.EntireColumn.ClearContents\n\n    'Make sure a change was made in column S\n    If Not Intersect(rData, Target) Is Nothing Then\n        'Change in column S found, make sure that there is more than 1 cell populated in column S\n        If rData.Cells.Count &gt; 1 Then\n            'Extract unique values\n            rData.AdvancedFilter xlFilterCopy, , rDest, True\n\n            'Sort unique values high to low\n            With Me.Range(rDest, Me.Cells(Me.Rows.Count, rDest.Column).End(xlUp))\n                .Sort .Cells, xlDescending, Header:=xlYes\n            End With\n        End If\n    End If\n\n    'Re-enable events\n    Application.enableevents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2062, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518641834, "creation_date": 1518638172, "last_edit_date": 1531161705, "question_id": 48795203, "link": "https://stackoverflow.com/questions/48795203/sort-and-remove-duplicates-vba", "title": "Sort and remove duplicates VBA", "body": "<p>I want to move values from range <code>S1:S6</code> to range <code>T1</code> remove duplicates and sort them from high to low.</p>\n\n<p>Im already able to filter the data and move it to the desired range but i cant figure out how to sort it on the destination range.</p>\n\n<p>Heres what im using to move and filter the data:</p>\n\n<pre><code>Range(\"S1:S6\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"T1\"), Unique:=True\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qM5Jp.jpg\" rel=\"nofollow noreferrer\">Filter Result</a></p>\n\n<p>What can i had to this line to sort the data?</p>\n\n<p>Thanks for your time,</p>\n\n<p><em>Jonhdoe</em></p>\n"}, {"tags": ["vba", "excel", "delete-operator", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9339959, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d9f9748de2dc5ce85955863bf0724738?s=128&d=identicon&r=PG&f=1", "display_name": "Will Parker", "link": "https://stackoverflow.com/users/9339959/will-parker"}, "edited": false, "score": 0, "creation_date": 1518638239, "post_id": 48795155, "comment_id": 84592775, "body": "I ran it and it deletes all the worksheets in the workbook, my if statement is not working."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 3, "user_id": 9339959, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d9f9748de2dc5ce85955863bf0724738?s=128&d=identicon&r=PG&f=1", "display_name": "Will Parker", "link": "https://stackoverflow.com/users/9339959/will-parker"}, "edited": false, "score": 1, "creation_date": 1518638395, "post_id": 48795155, "comment_id": 84592853, "body": "Use AND instead of OR"}, {"owner": {"reputation": 3, "user_id": 9339959, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d9f9748de2dc5ce85955863bf0724738?s=128&d=identicon&r=PG&f=1", "display_name": "Will Parker", "link": "https://stackoverflow.com/users/9339959/will-parker"}, "edited": false, "score": 0, "creation_date": 1518640059, "post_id": 48795155, "comment_id": 84593656, "body": "Thank you, using AND helped. My code now runs properly:"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1518638879, "last_edit_date": 1518638879, "creation_date": 1518638025, "answer_id": 48795155, "question_id": 48795118, "link": "https://stackoverflow.com/questions/48795118/deleting-specific-worksheets/48795155#48795155", "title": "Deleting Specific Worksheets", "body": "<p>Change this line:</p>\n\n<pre><code>ActiveWindow.SelectedSheets.Delete\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>ws.Delete\n</code></pre>\n\n<p>to fix your If statement</p>\n\n<p>Use <code>And</code> in your <code>If</code>, not <code>Or</code></p>\n\n<p>and keep in mind that capitalization and extra spaces both matter too in a comparison like that.</p>\n\n<p>I would use something more like this:</p>\n\n<pre><code>If Trim$(UCase$(ws.Name)) &lt;&gt; Trim$(UCase$(mySheet)) And _\nTrim$(UCase$(ws.Name)) &lt;&gt; Trim$(UCase$(mySheet2)) Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1518640328, "creation_date": 1518640328, "answer_id": 48795707, "question_id": 48795118, "link": "https://stackoverflow.com/questions/48795118/deleting-specific-worksheets/48795707#48795707", "title": "Deleting Specific Worksheets", "body": "<p>You could also go like this:</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nPublic Sub DeleteWS()\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n        If InStr(ws.Name, \u201cmain,Dataset\u201d) = 0 Then ws. Delete\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9339959, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d9f9748de2dc5ce85955863bf0724738?s=128&d=identicon&r=PG&f=1", "display_name": "Will Parker", "link": "https://stackoverflow.com/users/9339959/will-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518640328, "creation_date": 1518637842, "last_edit_date": 1531164843, "question_id": 48795118, "link": "https://stackoverflow.com/questions/48795118/deleting-specific-worksheets", "title": "Deleting Specific Worksheets", "body": "<p>I am attempting to delete all worksheets in my workbook except for the two titled: \"main\" and \"dataset\". My current code seems to simply delete the last two worksheets.</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nPublic Sub DeleteWS()\n    Dim mySheet As String, mySheet2 As String, ws As Worksheet\n    mySheet = \"main\"\n    mySheet2 = \"Dataset\"\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; mySheet Or ws.Name &lt;&gt; mySheet2 Then\n           ActiveWindow.SelectedSheets.Delete\n        Else\n            Exit Sub\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1518644821, "creation_date": 1518644821, "answer_id": 48796779, "question_id": 48794607, "link": "https://stackoverflow.com/questions/48794607/including-a-notes-column-in-an-excel-query/48796779#48796779", "title": "Including a notes column in an excel query", "body": "<p>Here's your code refactored to expand the ListObject by one column, and not change the number of rows.  Also tidies up the code, removing the unnecessary Selects etc, and resizes the header row regardless of what row it's on</p>\n\n<pre><code>Sub IncludeNotes()\n    Dim lo As ListObject\n    Application.CutCopyMode = False\n    Set lo = ActiveSheet.ListObjects(\"Table_query\")\n    lo.Resize lo.Range.Resize(, lo.Range.Columns.Count + 1)\n    lo.HeaderRowRange.RowHeight = 65\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9205849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/098d200f387dc25d9e27fb641601c90a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/9205849/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48796779, "answer_count": 1, "score": 0, "last_activity_date": 1518644821, "creation_date": 1518635701, "question_id": 48794607, "link": "https://stackoverflow.com/questions/48794607/including-a-notes-column-in-an-excel-query", "title": "Including a notes column in an excel query", "body": "<p>I'm looking to include a notes column next to a query from an incident management site and to also make sure that the header row stays the same size. </p>\n\n<p>Here's what I have so far. When I run it, it includes the notes in the table so they will refresh and follow the different incident statuses without losing the notes, but the way I wrote it doesn't allow for new rows.</p>\n\n<p>The header row sizing isn't super essential, but that isn't working at all.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<pre><code>Sub IncludeNotes()\n'\n' IncludeNotes Macro\n'\n\n'\n    Application.CutCopyMode = False\n    ActiveSheet.ListObjects(\"Table_query\").Resize Range(\"$A$1:$X$506\")\n    Range(\"Table_query[[#Headers],[ID]]\").Select\n    ActiveWindow.ScrollColumn = 1\n    Rows(\"1:1\").Select\n    Selection.RowHeight = 65\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518645585, "post_id": 48794596, "comment_id": 84596334, "body": "The type in the safe array probably remains a variant when <code>ReDim Preserve S(9)</code> is called. The issue doesn&#39;t occur with <code>ReDim S(9)</code>. You could simply use <code>Split(Empty)</code> to get an empty array of strings. For the other types I would call <code>SafeArrayRedim</code>."}, {"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518769130, "post_id": 48794596, "comment_id": 84648575, "body": "@Florent B. I tried to use <code>SafeArrayRedim</code>, but I couldn&#39;t get it to work. Can you share a working example?"}], "owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1150, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1518636267, "creation_date": 1518635629, "last_edit_date": 1518636267, "question_id": 48794596, "link": "https://stackoverflow.com/questions/48794596/creating-an-empty-array", "title": "Creating an empty array", "body": "<p>Inspired by the answer to <a href=\"https://stackoverflow.com/questions/21289970/how-to-empty-an-array-in-vba\">this question</a> I created a <em>factory</em> for empty arrays. It usually works, but sometimes it doesn't. The array created with the technique described in that post, after being <code>ReDim</code>-ed and a few values assigned to its elements, appears broken from some points of view and appears correct from other points of view.</p>\n\n<p>For example in my real code I see all the correct values in its elements in the Locals window, I see <code>&lt;Variable uses an Automation type not supported in Visual Basic&gt;</code> on the Watch window, I see the correct values on all the elements on some functions and I see only a few correct values on other functions. For example if <code>F1()</code> creates the array and passes it to <code>F2()</code>, <code>F1</code> sees all the values, but <code>F2</code> sees only a few of them, while the others appear to be empty (string in this case).</p>\n\n<p>I was not able to reproduce the same exact same behavior in a small snippet, but I reproduced something similar in the code below. Here the bad behavior is the opposite of what I have described above: it works on the code and it doesn't on the Locals window.</p>\n\n<p>I think that a fix for this problem will also fix the real application.</p>\n\n<p>The output of the Immediate window is correct:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OL7YG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OL7YG.png\" alt=\"enter image description here\"></a></p>\n\n<p>The output of the Watch window fails:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZQT6j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZQT6j.png\" alt=\"enter image description here\"></a></p>\n\n<p>The output of the Locals window is wrong:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MjeUx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MjeUx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Declare Sub GetMem2 Lib \"msvbvm60\" (src As Any, dest As Any)\n\nSub Test()\n  Dim S() As String, I As Integer\n  S = NewArrayString\n  ReDim Preserve S(9)\n  For I = 0 To 9\n    S(I) = String(I + 1, \"x\")\n  Next I\n  For I = 0 To 9\n    Debug.Print I; S(I)\n  Next I\n  Stop\nEnd Sub\n\nFunction NewArrayString() As String()\n  Dim V As Variant, NewTypeCode As Integer\n  V = Array()\n  NewTypeCode = vbArray Or vbString\n  GetMem2 NewTypeCode, V\n  NewArrayString = V\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518635590, "post_id": 48794508, "comment_id": 84591361, "body": "<code>On Error Resume Next</code> is not line specific.  It will turn of the error catching till you put <code>On Error Goto 0</code>.  You only need one and then the second after the lines you want to skip on the error check.  Also it would be better to do your own checks with <code>If</code> statements and skip the whole <code>On Error ...</code> so you do not inadvertently cover an error that would help figure out the problem."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1518639952, "post_id": 48794508, "comment_id": 84593595, "body": "I wrote a short routine to call your code and produced 1000 PDFs with no errors.  Two changes I made were I changed the function to a sub, since you&#39;re not returning a value anyway, and I skipped all the sub folder creation part because I didn&#39;t want to be bothered creating all that false data.  The code itself works.  I would guess that the problem is in how it&#39;s called."}, {"owner": {"reputation": 51, "user_id": 4917542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1068175789878394/picture?type=large", "display_name": "Chris Atkeson", "link": "https://stackoverflow.com/users/4917542/chris-atkeson"}, "edited": false, "score": 0, "creation_date": 1518642116, "post_id": 48794508, "comment_id": 84594687, "body": "Thanks Scott.  I removed the On Errors and replaced them with Ifs.  Hopefully when it breaks it will throw a useful error.  Thanks Hrothgar.  It is very strange because commenting out the export line fixes everything suggesting that the pdf creation is where the error occurs."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1518642133, "post_id": 48794508, "comment_id": 84594698, "body": "Might be better to consistently use <code>&amp;</code> for string concatenation than <code>+</code>. I would use defensive <code>If</code> statements to avoid errors (instead of <code>On Error Resume Next</code>). Also, test if <code>mysht</code> as returned by <code>RemoveSpecialChars</code> is a valid filename before attempting to export. Might be an idea to stick a <code>DoEvents</code> (at least whilst testing) after exporting."}, {"owner": {"reputation": 51, "user_id": 4917542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1068175789878394/picture?type=large", "display_name": "Chris Atkeson", "link": "https://stackoverflow.com/users/4917542/chris-atkeson"}, "edited": false, "score": 0, "creation_date": 1518646096, "post_id": 48794508, "comment_id": 84596544, "body": "By Going through the program one line at a time when it gets close to the 150 PDF mark, I have found a clue for what is happening right before the program breaks.  My two linked images suddenly do not load and an X icon comes up with the text: &quot;The picture can&#39;t be displayed.&quot;.  It seems the act of creating the pdfs somehow creates a memory leak that eventually crashes the program.  No idea why this is happening."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518658133, "post_id": 48794508, "comment_id": 84600336, "body": "<a href=\"https://downloadmoreram.com/\" rel=\"nofollow noreferrer\">downloadmoreram.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1518652762, "post_id": 48797841, "comment_id": 84598916, "body": "rather than a memory leak, could it be that each export creates handles for the graphic objects that aren&#39;t released ? Use Task Manager to see the Handles count as your code runs with the graphics in the export. You may be able to manually call a garbage collector to release the resources."}, {"owner": {"reputation": 51, "user_id": 4917542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1068175789878394/picture?type=large", "display_name": "Chris Atkeson", "link": "https://stackoverflow.com/users/4917542/chris-atkeson"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1518655001, "post_id": 48797841, "comment_id": 84599508, "body": "Good idea.  Can&#39;t seem to notice any increase in handles while the program executes but I added a part of my macro to delete and recreate the images on every iteration.  Maybe that will delete any handles on the images."}], "tags": [], "owner": {"reputation": 51, "user_id": 4917542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1068175789878394/picture?type=large", "display_name": "Chris Atkeson", "link": "https://stackoverflow.com/users/4917542/chris-atkeson"}, "is_accepted": false, "score": 0, "last_activity_date": 1518656704, "last_edit_date": 1518656704, "creation_date": 1518650456, "answer_id": 48797841, "question_id": 48794508, "link": "https://stackoverflow.com/questions/48794508/memory-error-when-exporting-multiple-pdfs/48797841#48797841", "title": "Memory Error when exporting multiple PDFs", "body": "<p>Removing all linked images from the print area prevents the program from breaking.  Seems like exporting images causes some memory leak.  I've generated 600 PDFs successfully without a breakdown yet but I am going to run the program over and over again to see if something else might be contributing to the leak as well.  </p>\n\n<p>By deleting and recreating every image in the print area on every iteration, pausing my program every 50 iterations, and throwing in a DoEvents after the pause, the problem has now been fixed.  No clear answer as to why the error occurred in the first place.  </p>\n"}], "owner": {"reputation": 51, "user_id": 4917542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1068175789878394/picture?type=large", "display_name": "Chris Atkeson", "link": "https://stackoverflow.com/users/4917542/chris-atkeson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543869389, "creation_date": 1518635212, "last_edit_date": 1518636738, "question_id": 48794508, "link": "https://stackoverflow.com/questions/48794508/memory-error-when-exporting-multiple-pdfs", "title": "Memory Error when exporting multiple PDFs", "body": "<p>I have a macro which generates hundreds of PDFs by exporting a range of cells from a sheet in my workbook. The way the program works is that the program changes a couple values on the sheet, formulas then fill in cells, and then the sheet is exported as a PDF. After the program generates about 150 pdfs, Excel crashes and displays </p>\n\n<blockquote>\n  <p>memory errors like \"not enough resources to complete action\"</p>\n</blockquote>\n\n<p>If I comment out the line of code that exports the pdf, I can run the program over and over again with no issues. If I change the exported file type to an excel workbook, I can also run the program with no issues. Here is the print function I use to export pdfs.</p>\n\n<pre><code>Function Prnt(print_area As Range)\n\nDim myDir As String, mySht As String\nDim supplier As String\nDoEvents\nsupplier = Range(\"F4\").Value\nmyDir = Range(\"y2\").Value\nmySht = Range(\"y1\").Value\nmySht = RemoveSpecialChars(mySht)\nOn Error Resume Next\nMkDir myDir\nOn Error Resume Next\nmyDir = myDir + \"\\\" + Range(\"z1\").Value\nOn Error Resume Next\nMkDir myDir\nOn Error Resume Next\nsupplier = RemoveSpecialChars(supplier)\nmyDir = myDir &amp; \"\\\" &amp; supplier\nOn Error Resume Next\nMkDir myDir\n\nprint_area.ExportAsFixedFormat Type:=xlTypePDF, _\nFilename:=myDir &amp; \"\\\" &amp; mySht, _\nQuality:=xlQualityStandard, _\nIncludeDocProperties:=True, _\nIgnorePrintAreas:=False, _\nOpenAfterPublish:=False\n\nSet print_area = Nothing\nApplication.CutCopyMode = False\nEnd Function\n</code></pre>\n\n<p>The line that I comment out or change to prevent the error is the line that starts with \"print_area.Exportas...\". My print area consists of a couple linked images and cells with formulas in them. I noticed that removing the linked images caused the program to crash after about 250 pdfs were generated which was a slight improvement. I can't imagine why the error is occurring and any help would be appreciated.  I really need the files to be in pdf format and am open to any suggestions or alternative ways to achieve this.  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9333890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/004ff731415bbd09fa8dc9ccc3adbb92?s=128&d=identicon&r=PG&f=1", "display_name": "NewProgrammer", "link": "https://stackoverflow.com/users/9333890/newprogrammer"}, "edited": false, "score": 0, "creation_date": 1518790929, "post_id": 48800329, "comment_id": 84661296, "body": "Good idea. I will give that a try"}], "tags": [], "owner": {"reputation": 11, "user_id": 9361326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e9f82c6b84e041b6d6f3c91b75e789b?s=128&d=identicon&r=PG&f=1", "display_name": "Excel Sigma", "link": "https://stackoverflow.com/users/9361326/excel-sigma"}, "is_accepted": false, "score": 0, "last_activity_date": 1518671595, "creation_date": 1518671595, "answer_id": 48800329, "question_id": 48794480, "link": "https://stackoverflow.com/questions/48794480/update-excel-pivot-table-fields/48800329#48800329", "title": "Update Excel Pivot Table Fields", "body": "<p>Why dont you put a flag in the database/ data of origin that marks with 1 or 0 each line depending if the date is within the range you want or not? Then you can leave the 1 or the 0 selected in the pivot table's filter field and the relevant data would show automatically every time you refresh.</p>\n"}], "owner": {"reputation": 13, "user_id": 9333890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/004ff731415bbd09fa8dc9ccc3adbb92?s=128&d=identicon&r=PG&f=1", "display_name": "NewProgrammer", "link": "https://stackoverflow.com/users/9333890/newprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518671595, "creation_date": 1518635124, "last_edit_date": 1518636023, "question_id": 48794480, "link": "https://stackoverflow.com/questions/48794480/update-excel-pivot-table-fields", "title": "Update Excel Pivot Table Fields", "body": "<p>I compile morning reports every day using a workbook with a number of different sheets and pivot tables.  So far, I have been able to somewhat automate the data retrieval process, and getting the pivot table data to refresh was very simple.  What I would like to do now is get the pivot table field filters to change automatically to include the data entries for thirty days prior up to and including today's date.  I have seen some things out there that let you select just one date, but I need to select a range.  I have tried using a relatively recorded macro, but it gives me this</p>\n\n<pre><code>Sub Update()\n\n    Sheets(\"Doorline Month\").Select\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveSheet.PivotTables(-1).PivotFields(\"Date\").CurrentPage = \"(All)\"\n    With ActiveChart.PivotLayout.PivotTable.PivotFields(\"Date\")\n        .PivotItems(\"1/14/2018\").Visible = False\n        .PivotItems(\"2/15/2018\").Visible = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>I believe that this would only deselect 1/14/2018 and make 2/15/18 visible.  I want this code to work automatically every morning, so if I come in on 2/16/2018 it deselects 1/15/2018 and selects 2/16/2018.  I have tried replacing the dates in the recorded macro with \"ActiveCell\" but to no avail. Any help is greatly appreciated. If it helps, the data for my pivot tables is in sheet 1 and the dates specifically are in column A. Unfortunately, the number of data entries per day is not consistent so I don't know if that complicates things or not. </p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518637017, "post_id": 48794310, "comment_id": 84592103, "body": "You could adapt <a href=\"https://stackoverflow.com/a/48793149/7296893\">this recent answer</a> by Brad for an alternate way to import Excel files, which gives you more control over exactly how it&#39;s imported"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518642661, "post_id": 48794310, "comment_id": 84594991, "body": "Thanks, but I wouldn&#39;t know how to use it, if you can help me modify the one I have I would really appreciate it."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518643060, "post_id": 48794310, "comment_id": 84595210, "body": "Sorry, but you&#39;re not providing the information necessary for me to do that. I&#39;d need to know the names of all columns in your Access table."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1518692561, "post_id": 48794310, "comment_id": 84613987, "body": "Please add the code of <code>SaveAsFile()</code>."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1518703276, "post_id": 48794310, "comment_id": 84621243, "body": "@  Erik von Asmuth; columns names are: DIM_ID,Project_id,Project_Name,Project_code,Project_Descript&zwnj;&#8203;ion"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1518703391, "post_id": 48794310, "comment_id": 84621336, "body": "@ Andre: I added the save as code in edit"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1518722756, "post_id": 48794310, "comment_id": 84633348, "body": "I am able to link to a text file having fields of more than 250 characters and no truncation."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1518769517, "last_edit_date": 1518769517, "creation_date": 1518685834, "answer_id": 48803488, "question_id": 48794310, "link": "https://stackoverflow.com/questions/48794310/docmd-transferspreadsheet-acimport-error-external-table-is-not-in-the-expected/48803488#48803488", "title": "DoCmd.TransferSpreadsheet acImport error &quot;External table is not in the expected format&quot;", "body": "<p>If you really cannot link to the text file without truncation (I could) and since simple Open doesn't work, do an import of the text file to Excel then SaveAs an Excel workbook. I used Excel macro recorder to generate some code and adapted to an Access procedure. </p>\n\n<pre><code>Sub TextToExcel1(currpath As String, newpath As String)\nDim xlx As Excel.Application, xlw As Excel.Workbook, xls As Excel.Worksheet\nDim blnEXCEL As Boolean\nIf Dir(newpath) &lt;&gt; \"\" Then Kill newPath\nblnEXCEL = False\nOn Error Resume Next\nSet xlx = GetObject(, \"Excel.Application\")\nIf Err.Number &lt;&gt; 0 Then\n    Set xlx = CreateObject(\"Excel.Application\")\n    blnEXCEL = True\nEnd If\nErr.Clear\nxlx.Visible = False\nSet xlw = xlx.Workbooks.Add\nSet xls = xlw.Worksheets(\"Sheet1\")\nWith xls.QueryTables.Add(\"TEXT;\" &amp; currPath, Range(\"$A$1\"))\n    .Name = \"Test\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = True\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = True\n    .TextFileColumnDataTypes = Array(1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nxlw.SaveAs newPath\nSet xls = Nothing\nxlw.Close False\nSet xlw = Nothing\nIf blnEXCEL = True Then xlx.Quit\nSet xlx = Nothing\nEnd Sub\n</code></pre>\n\n<p>And then this version:</p>\n\n<pre><code>Sub TextToExcel2(currpath As String, newpath As String)\nDim xlx As Excel.Application\nDim blnEXCEL As Boolean\nIf Dir(newpath) &lt;&gt; \"\" Then Kill newPath\nblnEXCEL = False\nOn Error Resume Next\nSet xlx = GetObject(, \"Excel.Application\")\nIf Err.Number &lt;&gt; 0 Then\n    Set xlx = CreateObject(\"Excel.Application\")\n    blnEXCEL = True\nEnd If\nErr.Clear\nxlx.Visible = False\nxlx.Workbooks.OpenText filename:=currPath, Origin:=437, StartRow:=1, _\n    DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n    ConsecutiveDelimiter:=True, Tab:=False, Semicolon:=False, \n    Comma:=False, Space:=True, Other:=False, FieldInfo:=Array(Array(1, 1), _\n    Array(2, 1)), TrailingMinusNumbers:=True\nxlx.ActiveWorkbook.SaveAs filename:=newPath, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nIf blnEXCEL = True Then xlx.Quit\nSet xlx = Nothing\nEnd Sub\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>Sub TextToExcel3(currpath As String, newpath As String)\nDim xlx As Excel.Application\nDim blnEXCEL As Boolean\nIf Dir(newpath) &lt;&gt; \"\" Then Kill newPath\nblnEXCEL = False\nOn Error Resume Next\nSet xlx = GetObject(, \"Excel.Application\")\nIf Err.Number &lt;&gt; 0 Then\n    Set xlx = CreateObject(\"Excel.Application\")\n    blnEXCEL = True\nEnd If\nErr.Clear\nxlx.Workbooks.Open (currpath)\nColumns(\"A:A\").Select\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\nxlx.Visible = False\nxlx.ActiveWorkbook.SaveAs filename:=newPath, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nIf blnEXCEL = True Then xlx.Quit\nSet xlx = Nothing\nEnd Sub\n</code></pre>\n\n<p>I am having issue getting version 1 to replicate consistently. Versions 2 and 3 both seem reliable.</p>\n"}], "owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518769517, "creation_date": 1518634513, "last_edit_date": 1531164843, "question_id": 48794310, "link": "https://stackoverflow.com/questions/48794310/docmd-transferspreadsheet-acimport-error-external-table-is-not-in-the-expected", "title": "DoCmd.TransferSpreadsheet acImport error &quot;External table is not in the expected format&quot;", "body": "<p>Hi I am getting this error  </p>\n\n<blockquote>\n  <p>\"External table is not in the expected format\"</p>\n</blockquote>\n\n<p>...when i try to transfer excel data to a access Table. I have data in text file that has a description field. In order to avoid truncation at 250 character limit, I convert the text file to EXCEL and then transfer excel to access database. But I get this error.... I have both excel 2010 and 2016 on my machine installed. thanks all in advance.</p>\n\n<pre><code>Sub ImportPPDE_v2()\n\nDim fDialog As Office.FileDialog\nDim strNewPath As String\n\nOn Error GoTo GameOver\n\nSet fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n'Set up the fDialog variable\n'Set the Title, add a filter for text files, and set the initial filepath we want to look at, we are defaulting to the Clarity Extract folder\nfDialog.Filters.Clear\nfDialog.Title = \"Select Latest Project Portfolio Data Extract File\"\nfDialog.Filters.Add \"*.txt\", \"*.txt\"\nfDialog.InitialFileName = \"G:\\Clarity EPPM Extracts\\\"\nfDialog.AllowMultiSelect = False\nfDialog.Show\n\n'turn off warnings, we don't need to see this\nDoCmd.SetWarnings False\n\n'Check to make sure a file has been selected, and if so that the Project Portfolio Data Extract file has been selected\nIf fDialog.SelectedItems.Count = 0 Then\n    MsgBox \"No File has been selected. Load actions have been cancelled.\", , \"No File Selected\"\n    GoTo GameOver\nElseIf InStr(1, fDialog.SelectedItems(1), \"Project Portfolio Data extract_\") = 0 Then\n    MsgBox \"The file selected appears to be incorrect. It should be the   Data Extract file.  Load actions have been cancelled.\", , \"ERROR OCCURRED IN DATA LOAD\"\n    GoTo GameOver\nEnd If\n\n'First delete everything currently in the table\nDoCmd.RunSQL \"Delete * from tbl_Project_Portfolio_Data_Load\"\n\n\n'DoCmd.TransferText , \"Spec_PPDE\", \"tbl_Project_Portfolio_Data_Load\", fDialog.SelectedItems(1)\n\n'First isolate the file name from the selected path, then change the file extension to .xls\nstrNewPath = Right(fDialog.SelectedItems(1), Len(fDialog.SelectedItems(1)) - InStrRev(fDialog.SelectedItems(1), \"\\\"))\nstrNewPath = \"C:\\\" &amp; Left(strNewPath, Len(strNewPath) - 4) &amp; \".xlsx\"\n\n'Copy the Portfolio data extract file to the user's C: drive as a .xls file\nCall SaveAsFile(CStr(fDialog.SelectedItems(1)), strNewPath)\n\n'Now import the new data as selected above\nDoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12Xml, \"tbl_Project_Portfolio_Data_Load\", strNewPath, True\n\n'Now update the Load_Date to be today\nDoCmd.RunSQL \"Update tbl_Project_Portfolio_Data_Load set [Load Date] = #\" &amp; Date &amp; \"# Where [Load Date] IS NULL\"\n\n'Let the user know the process finished successfully\nMsgBox \"Project Portfolio Data Extract Data has been uploaded\", , \"Victory!\"\n\nGameOver:\n\n'Turn our warnings back on\nDoCmd.SetWarnings True\n\n'Set this back to nothing\nSet fDialog = Nothing\n\n'Check if an error occurred that would prevent the expected data from being loaded\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox Err.Description\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>I get this erorr when my code try to transfer excel sheet into the empty table</strong></p>\n\n<p>here is save as code </p>\n\n<pre><code>Sub SaveAsFile(currpath As String, newpath As String)\n\nDim wb As Workbook, strWB As String\nDim NewWB As String\n\n'The purpose of this module is to copy a file from a given filepath to a user's C: Drive.\n'It is also converting the file from .txt to a .xls format\n'This is originally intended to be used with the Project Portfolio Data Extract load\n\n'Delete any existing workbook that is there now with the same name\nOn Error Resume Next\nKill newpath\nOn Error GoTo GameOver\n\n'Open the current file\nSet wb = Workbooks.Open(currpath)\n\n'MsgBox wb.FileFormat\n'Application.DisplayAlerts = False\n\n'Save it as a .xls file\nwb.SaveAs newpath, xlNormal\n\n'Application.DisplayAlerts = True\n'MsgBox wb.FileFormat\n\n'Close the workbook\nwb.Close False\n\nGameOver:\n\nSet wb = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "shell", "spotfire"], "comments": [{"owner": {"reputation": 3913, "user_id": 4419423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TUAaT.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/4419423/niko"}, "edited": false, "score": 0, "creation_date": 1518638020, "post_id": 48794302, "comment_id": 84592661, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20917355/how-do-you-run-a-exe-with-parameters-using-vbas-shell\">How do you run a .exe with parameters using vba&#39;s shell()?</a>"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 3913, "user_id": 4419423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TUAaT.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/4419423/niko"}, "edited": false, "score": 0, "creation_date": 1518640008, "post_id": 48794302, "comment_id": 84593626, "body": "I don&#39;t think so. I read the possible solution thoroughly but I do not think that can be an answer."}, {"owner": {"reputation": 3913, "user_id": 4419423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TUAaT.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/4419423/niko"}, "edited": false, "score": 0, "creation_date": 1518640073, "post_id": 48794302, "comment_id": 84593661, "body": "are you able to run this from the command line without any issues?"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 3913, "user_id": 4419423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TUAaT.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/4419423/niko"}, "edited": false, "score": 0, "creation_date": 1518640415, "post_id": 48794302, "comment_id": 84593862, "body": "partially yes. It launches spotfire application. But it launches it with the default servername, username and password and not the one which I provided through command line  and gives error in message box at the end &quot;Unable to load file. Could not find the specified file : -s&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 3913, "user_id": 4419423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TUAaT.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/4419423/niko"}, "is_accepted": true, "score": 1, "last_activity_date": 1518640720, "creation_date": 1518640720, "answer_id": 48795786, "question_id": 48794302, "link": "https://stackoverflow.com/questions/48794302/shell-command-to-launch-application-with-parameters/48795786#48795786", "title": "Shell Command to launch application with parameters", "body": "<p>after checking our support db, I found a few references to / notation instead of -. so the following command should work:</p>\n\n<p><code>c:\\path\\Spotfire.Dxp.exe /server:http://localhost:8080/ /username:user /password:pass</code></p>\n"}], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 48795786, "answer_count": 1, "score": 1, "last_activity_date": 1518640720, "creation_date": 1518634499, "last_edit_date": 1518634560, "question_id": 48794302, "link": "https://stackoverflow.com/questions/48794302/shell-command-to-launch-application-with-parameters", "title": "Shell Command to launch application with parameters", "body": "<p>I am trying to launch spotfire application from VBA like following</p>\n\n<pre><code>Dim retval As Double\nretval = Shell(\"Path\\Spotfire.Dxp.exe\", vbNormalFocus)\n</code></pre>\n\n<p>It works. It launches spotfire with the default servername,username and password</p>\n\n<p>But I want to launch the application by giving the servername, username and password as parameters in the script. How do I do it?</p>\n\n<p>I tried this</p>\n\n<pre><code>retval = Shell(\"Path\\Spotfire.Dxp.exe -s http://spotfire.abcd.com -u ABCD\\A7 -p ABC\", vbNormalFocus)\n</code></pre>\n\n<p>But it launched the application with default parameters and gives error at the end \"Unable to load file. Could not find the specified file : -s\"</p>\n\n<p>Please suggest the possible solution.</p>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1518634674, "post_id": 48794262, "comment_id": 84590877, "body": "I think the solution here is to format paint down from cell H4 to your <code>Rows.Count</code> cell"}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1518643404, "post_id": 48794262, "comment_id": 84595391, "body": "That is an excellent idea! I will do some testing and mark as solved if I can get it to work. Many Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "is_accepted": false, "score": 0, "last_activity_date": 1518643992, "creation_date": 1518643992, "answer_id": 48796601, "question_id": 48794262, "link": "https://stackoverflow.com/questions/48794262/modify-conditional-formatting-appliesto-range/48796601#48796601", "title": "Modify Conditional Formatting &#39;AppliesTo&#39; Range", "body": "<p>Thanks @dwirony. The code below works, posting in case future readers may wish to employ the same method. Feel free to post your own answer and I will mark yours as the solution.</p>\n\n<pre><code>Sub FillDown()\n'// Fill down formatting to apply CF to entire range\n    With Sheets(\"Sheet1\")\n        .Range(\"H4\").Copy\n        .Range(\"H4:H\" &amp; .Range(\"H\" &amp; Rows.Count).End(xlUp).Row).PasteSpecial Paste:=xlPasteFormats\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 941, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518643992, "creation_date": 1518634345, "question_id": 48794262, "link": "https://stackoverflow.com/questions/48794262/modify-conditional-formatting-appliesto-range", "title": "Modify Conditional Formatting &#39;AppliesTo&#39; Range", "body": "<p>I have a sheet (lets call it <code>Sheet1</code>) which has two existing Conditional Formatting rules. Which apply to a range in column H. The data in <code>Sheet1</code> is deleted and new data is input via a database connection. This deletion and retrieval of data means the <code>RANGE</code> that the conditional formatting applies to changes. Is there a way I can update the CF formatting <code>RANGE</code> (in the <code>Applies to</code> box) without deleting it and recreating it in code?</p>\n\n<p>pseudo-code would be something like</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n.Cells.FormatConditions(1).AppliesTo = \"H4:H\" &amp; .Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n.Cells.FormatConditions(2).AppliesTo = \"H4:H\" &amp; .Range(\"H\" &amp; Rows.Count).End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>Any help would be appreciated, \nMany Thanks\nCaleeco</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1518633871, "post_id": 48794138, "comment_id": 84590433, "body": "You cannot redim preserve any dimension but the last one."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1518633884, "post_id": 48794138, "comment_id": 84590440, "body": "You can only <code>ReDim</code> the last dimension of the array. You are trying to do it to the first dimension."}, {"owner": {"reputation": 53, "user_id": 8924904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863ab13dfe81df36b2c392675ee8d5ce?s=128&d=identicon&r=PG&f=1", "display_name": "JJB", "link": "https://stackoverflow.com/users/8924904/jjb"}, "edited": false, "score": 0, "creation_date": 1518634020, "post_id": 48794138, "comment_id": 84590513, "body": "Sorry, I am not understanding.  I am trying to go from array(1 to 150, 1 to 3) to array(1 to 159, 1 to 3).  This is not possible?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1518634213, "post_id": 48794138, "comment_id": 84590628, "body": "NO. do it like from array(1 to 3, 1 to 150) to array(1 to 3, 1 to 159) and then in the end transpose. You cannot change rows in an array."}, {"owner": {"reputation": 53, "user_id": 8924904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863ab13dfe81df36b2c392675ee8d5ce?s=128&d=identicon&r=PG&f=1", "display_name": "JJB", "link": "https://stackoverflow.com/users/8924904/jjb"}, "edited": false, "score": 0, "creation_date": 1518639307, "post_id": 48794138, "comment_id": 84593258, "body": "OK.  That makes sense.  Thanks to you all."}], "owner": {"reputation": 53, "user_id": 8924904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863ab13dfe81df36b2c392675ee8d5ce?s=128&d=identicon&r=PG&f=1", "display_name": "JJB", "link": "https://stackoverflow.com/users/8924904/jjb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518634506, "creation_date": 1518633768, "last_edit_date": 1518634506, "question_id": 48794138, "link": "https://stackoverflow.com/questions/48794138/redim-preserve-a-2d-array-from-excel-table", "title": "Redim Preserve a 2D Array from Excel Table", "body": "<p>Try as I might I cannot correct a \"Subscript out of Range\" error that the code below is throwing on the last line of code below when I try to expand the size of an array with Redim Preserve.  Any ideas as to what might be wrong?</p>\n\n<pre><code>Sub Demo()\n\n'Set Excel variables\n    Dim wb As Workbook:                 Set wb = ActiveWorkbook\n    Dim wsCluster As Worksheet:         Set wsCluster = wb.Worksheets(\"Cluster\")\n    Dim initialK As ListObject:         Set initialK = wsCluster.ListObjects(\"k\")\n\n'Set Array variables\n    Dim kArray() As Variant\n        ReDim kArray(1 To initialK.DataBodyRange.Rows.Count, 1 To initialK.DataBodyRange.Columns.Count)\n            kArray = initialK.DataBodyRange\n\n'Set Other variables\n    Dim coordResults As Variant, kResults As Variant, addKs As Variant, dupeArray As Variant\n    Dim transferLat As Double, transferLong As Double, potDupeCount As Long, expandK As Long, nextAvailK As Long\n\n'Run the assignment function once, then loop through average/assign functions\n    coordResults = Assign(coordArray, kArray)\n        For i = 1 To 3\n            kResults = Average(coordArray, kArray, coordResults)\n            coordResults = Assign(coordArray, kArray)\n        Next i\n\n'Run the radius function\naddKs = AdjustForRadius(coordArray, kResults, coordResults)\n\n'Add the new, deduped centroid data to the kResults array\n    expandK = UBound(addKs, 1) + UBound(kArray, 1)\n    ReDim Preserve kArray(1 To expandK, 1 To 3)\n\nEnd Sub\n</code></pre>\n\n<p>The functions are working properly.  The \"expand\" variable is good.</p>\n\n<p>I have tested everything I know.</p>\n\n<p>Jake</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1518633152, "post_id": 48793961, "comment_id": 84590055, "body": "You need another <code>&amp;</code> after <code>(row_number)</code>"}, {"owner": {"reputation": 1, "user_id": 9361562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6a2111cc2956de79fe40d67189a6b66?s=128&d=identicon&r=PG&f=1", "display_name": "RSilvasy", "link": "https://stackoverflow.com/users/9361562/rsilvasy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518634690, "post_id": 48793961, "comment_id": 84590888, "body": "I&#39;m now getting a subscript out of range after I added the &amp;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518634850, "post_id": 48793961, "comment_id": 84590973, "body": "Using <a href=\"https://stackoverflow.com/posts/48793961/edit\">edit</a>, please update the original post with the corrected code line, so we can see exactly what you did."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518635188, "post_id": 48793961, "comment_id": 84591144, "body": "If you are getting that on this line then there is a spelling error on the worksheet name.  Double check that there is not a space where there should not.  For example: all your other references has <code>_</code> instead of a space between the words."}, {"owner": {"reputation": 1, "user_id": 9361562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6a2111cc2956de79fe40d67189a6b66?s=128&d=identicon&r=PG&f=1", "display_name": "RSilvasy", "link": "https://stackoverflow.com/users/9361562/rsilvasy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518635321, "post_id": 48793961, "comment_id": 84591232, "body": "Works now!  Thank you. Yes I misspelled my sheet name.  Thank you for the quick responses."}], "owner": {"reputation": 1, "user_id": 9361562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6a2111cc2956de79fe40d67189a6b66?s=128&d=identicon&r=PG&f=1", "display_name": "RSilvasy", "link": "https://stackoverflow.com/users/9361562/rsilvasy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518635074, "creation_date": 1518633028, "last_edit_date": 1531164843, "question_id": 48793961, "link": "https://stackoverflow.com/questions/48793961/vba-dynamic-range-vlookup", "title": "VBA Dynamic Range VLOOKUP", "body": "<p>I'm new to VBA and need get some help with a VLOOKUP?</p>\n\n<p>I keep getting Compile error for Expected: end of statement</p>\n\n<p>This is the line that is giving me problems.</p>\n\n<p>I added the &amp; sign after (row_number) and am now getting a run-time error '9':  Subscript out of range error.</p>\n\n<pre><code>Sheets(\"WIP Count\").Range(\"G\" &amp; (row_number)).Formula = \"=VLOOKUP(C\" &amp; (row_number) &amp; \",PRISM!L:T,8,FALSE)\"\n</code></pre>\n\n<p>Here is the rest of the code.</p>\n\n<pre><code>Sub CommandButton1_Click()\nq1_answer = Sheets(\"Tracker\").Range(\"F8\")\nq2_answer = Sheets(\"Tracker\").Range(\"F9\")\nq3_answer = Sheets(\"Tracker\").Range(\"F10\")\nq4_answer = Sheets(\"Tracker\").Range(\"F11\")\n\n    If q1_answer = \"\" Then\n        MsgBox \"Fill in Name\"\n        Exit Sub\n    End If\n\n     If q2_answer = \"\" Then\n        MsgBox \"Fill in Serial Number\"\n        Exit Sub\n    End If\n\n     If q3_answer = \"\" Then\n        MsgBox \"Fill in Part Number\"\n        Exit Sub\n    End If\n\n     If q4_answer = \"\" Then\n        MsgBox \"Fill in Quantity\"\n        Exit Sub\n    End If\n\n\nrow_number = 1\nDo\nDoEvents\nrow_number = row_number + 1\n    item_in_review = Sheets(\"WIP_Count\").Range(\"A\" &amp; row_number)\n\nLoop Until item_in_review = \"\"\n\nlast_transaction_id = Sheets(\"WIP_Count\").Range(\"A\" &amp; (row_number - 1))\n\nDim next_transaction_id As Integer\nnext_transaction_id = last_transaction_id + 1\n\nSheets(\"WIP_Count\").Range(\"A\" &amp; (row_number)) = next_transaction_id\nSheets(\"WIP_Count\").Range(\"B\" &amp; (row_number)) = q1_answer\nSheets(\"WIP_Count\").Range(\"C\" &amp; (row_number)) = q2_answer\nSheets(\"WIP_Count\").Range(\"D\" &amp; (row_number)) = q3_answer\nSheets(\"WIP_Count\").Range(\"E\" &amp; (row_number)) = q4_answer\nSheets(\"WIP_Count\").Range(\"F\" &amp; (row_number)).Value = Date\nSheets(\"WIP Count\").Range(\"G\" &amp; (row_number)).Formula = \"=VLOOKUP(C\" &amp; (row_number) &amp; \",PRISM!L:T,8,FALSE)\"\n\nSheets(\"Tracker\").Range(\"F8\") = \"\"\nSheets(\"Tracker\").Range(\"F9\") = \"\"\nSheets(\"Tracker\").Range(\"F10\") = \"\"\nSheets(\"Tracker\").Range(\"F11\") = \"\"\n\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "find", "match"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518634156, "post_id": 48793679, "comment_id": 84590590, "body": "I think you could do the matching bit at least with a COUNTIFS formula. Then you just store the row numbers in an array or a collection/dictionary. What specifically didn&#39;t work?"}, {"owner": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518693053, "post_id": 48793679, "comment_id": 84614302, "body": "@SJR Thanks for the reply. None of the bit where I&#39;m trying to match them and make a list works but I think it&#39;s more a case of I can&#39;t figure out what to write for what I&#39;m trying to do, rather than a specific line not working."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "edited": false, "score": 0, "creation_date": 1518690626, "post_id": 48794831, "comment_id": 84612690, "body": "Hi, Thanks for your help. It looks really promising, except I&#39;m getting a Type Mismatch error on the line  <code>lNumResults = Evaluate(&quot;SUMPRODUCT(COUNTIFS(&quot; &amp; sCritRange1 &amp; &quot;,&quot; &amp; sCriteria1 &amp; &quot;,&quot; &amp; sCritRange2 &amp; &quot;,&quot; &amp; sCriteria2 &amp; &quot;))&quot;)</code>"}, {"owner": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "edited": false, "score": 0, "creation_date": 1518699739, "post_id": 48794831, "comment_id": 84618694, "body": "Ok, so I managed to get around that error by putting a loop in so it goes through each row in rData separately and then using <code>Range(sCriteria1).Value</code> for the criteria. But now it&#39;s returning <code>lNumResults = 0</code> when I know that the two values it&#39;s looking up are in the specified ranges and are spelled exactly the same with no extra spaces or anything."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "edited": false, "score": 0, "creation_date": 1518702649, "post_id": 48794831, "comment_id": 84620742, "body": "@S.Chivers The assignment to the criteria range and criteria variables were my best guesses based on your description and provided code.  For it to be accurate, please edit your original post to include sample data representative of your actual data layout as well as expected results."}, {"owner": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "edited": false, "score": 0, "creation_date": 1518703355, "post_id": 48794831, "comment_id": 84621312, "body": "Nevermind, I managed to modify it so it works. Thanks so much for your help! I&#39;ll accept your post as the answer and then maybe I&#39;ll post underneath it with the small modifications I made to it."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1518636730, "creation_date": 1518636730, "answer_id": 48794831, "question_id": 48793679, "link": "https://stackoverflow.com/questions/48793679/matching-multiple-criteria-and-returning-multiple-values/48794831#48794831", "title": "Matching Multiple Criteria and Returning Multiple Values", "body": "<p>Something like this should work for you.  I tried to comment the code for clarity.</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rData As Range\n    Dim wbTemp As Workbook\n    Dim wsTemp As Worksheet\n    Dim rTempData As Range\n    Dim aData() As Variant\n    Dim aTempData() As Variant\n    Dim aResults() As Variant\n    Dim lNumResults As Long\n    Dim DataIndex As Long, TempIndex As Long, ResultIndex As Long, j As Long\n    Dim sCritRange1 As String, sCritRange2 As String\n    Dim sCriteria1 As String, sCriteria2 As String\n\n    Set wb = ActiveWorkbook\n\n    'Adjust these two as necessary\n    Set ws = wb.Sheets(1)\n    Set rData = ws.Range(\"B3\", ws.Cells(ws.Rows.Count, \"B\").End(xlUp))\n\n    'Select wbTemp file\n    On Error Resume Next\n    Set wbTemp = Workbooks.Open(Application.GetOpenFilename(\"Excel Files, *.xls*\"))\n    On Error GoTo 0\n    If wbTemp Is Nothing Then Exit Sub  'Pressed cancel\n\n    'Adjust these two as necessary\n    Set wsTemp = wbTemp.Sheets(1)\n    Set rTempData = wsTemp.Range(\"A1\", wsTemp.Cells(wsTemp.Rows.Count, \"A\").End(xlUp))\n\n    sCritRange1 = rTempData.EntireColumn.Address(external:=True)\n    sCritRange2 = rTempData.Offset(, 1).EntireColumn.Address(external:=True)\n    sCriteria1 = rData.Address(external:=True)\n    sCriteria2 = rData.Offset(, 1).Address(external:=True)\n    lNumResults = Evaluate(\"SUMPRODUCT(COUNTIFS(\" &amp; sCritRange1 &amp; \",\" &amp; sCriteria1 &amp; \",\" &amp; sCritRange2 &amp; \",\" &amp; sCriteria2 &amp; \"))\")\n    If lNumResults = 0 Then Exit Sub    'No matches\n    ReDim aResults(1 To lNumResults, 1 To 3)\n    aData = rData.Resize(, 2).Value\n    aTempData = rTempData.Resize(, 2).Value\n\n    'Loop through both data ranges\n    For DataIndex = LBound(aData, 1) To UBound(aData, 1)\n        For TempIndex = LBound(aTempData, 1) To UBound(aTempData, 1)\n\n            'Find where both criteria matches\n            If aTempData(TempIndex, 1) = aData(DataIndex, 1) And aTempData(TempIndex, 2) = aData(DataIndex, 2) Then\n                'Match found, add to results and collect the row index\n                ResultIndex = ResultIndex + 1\n                aResults(ResultIndex, 1) = aData(DataIndex, 1)\n                aResults(ResultIndex, 2) = aData(DataIndex, 2)\n                aResults(ResultIndex, 3) = \"Row: \" &amp; TempIndex + rTempData.Row - 1   'This is the row index from wsTemp of the found match\n            End If\n\n        Next TempIndex\n    Next DataIndex\n\n    'Row index results gathered\n    'Do what you want with the results\n    'In this example it is just providing msgboxes displaying the results\n    For ResultIndex = LBound(aResults, 1) To UBound(aResults, 1)\n        MsgBox \"Location: \" &amp; aResults(ResultIndex, 1) &amp; Chr(10) &amp; _\n               \"Feature:  \" &amp; aResults(ResultIndex, 2) &amp; Chr(10) &amp; _\n               \"RowIndex: \" &amp; aResults(ResultIndex, 3)\n    Next ResultIndex\n\n    'Close wbTemp\n    wbTemp.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "is_accepted": false, "score": 0, "last_activity_date": 1518703826, "creation_date": 1518703826, "answer_id": 48809255, "question_id": 48793679, "link": "https://stackoverflow.com/questions/48793679/matching-multiple-criteria-and-returning-multiple-values/48809255#48809255", "title": "Matching Multiple Criteria and Returning Multiple Values", "body": "<p>I made some minor modifications to tigeravatar's answer to get it to work with my data:</p>\n\n<ul>\n<li>Mainly creating a loop which cycled through each row in <code>wb</code> so that the criteria used with <code>CountIfs</code> was a single value and not a range of values.</li>\n<li>I swapped the <code>Evaluate(\"SUMPRODUCT(COUNTIFS(\" &amp; sCritRange1 &amp; \",\" &amp; sCriteria1 &amp; \",\" &amp; sCritRange2 &amp; \",\" &amp; sCriteria2 &amp; \"))\")</code> for <code>Application.WorksheetFunction.CountIfs(Range(sCritRange1), Range(sCriteria1).Value, Range(sCritRange2), Range(sCriteria2).Value)</code></li>\n</ul>\n\n<p>I would like to thank tigeravatar for their help.</p>\n\n<pre><code>LR = ws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nLC = ws.Cells(1, Columns.Count).End(xlToLeft).Column   \n\nFor r = 3 To LR\n\nsCritRange1 = rTempData.EntireColumn.Address(external:=True)\nsCritRange2 = rTempData.Offset(, 1).EntireColumn.Address(external:=True)\nsCriteria1 = rData(r, 1).Address(external:=True)\nsCriteria2 = rData(r, 1).Offset(, 1).Address(external:=True)\nlNumResults = Application.WorksheetFunction.CountIfs(Range(sCritRange1), Range(sCriteria1).Value, Range(sCritRange2), Range(sCriteria2).Value)\nIf lNumResults = 0 Then Exit Sub    'No matches\nReDim aResults(1 To lNumResults, 1 To 3)\naData = rData(r, 1).Resize(, 2).Value\naTempData = rTempData.Resize(, 2).Value\n\n'Loop through both data ranges\nFor DataIndex = LBound(aData, 1) To UBound(aData, 1)\n    For TempIndex = LBound(aTempData, 1) To UBound(aTempData, 1)\n\n        'Find where both criteria matches\n        If Not IsEmpty(aTempData(TempIndex, 1)) Then\n            If aTempData(TempIndex, 1) = aData(DataIndex, 1) And aTempData(TempIndex, 2) = aData(DataIndex, 2) Then\n                'Match found, add to results and collect the row index\n                ResultIndex = ResultIndex + 1\n                aResults(ResultIndex, 1) = aData(DataIndex, 1)\n                aResults(ResultIndex, 2) = aData(DataIndex, 2)\n                aResults(ResultIndex, 3) = \"Row: \" &amp; TempIndex + rTempData.Row - 1   'This is the row index from wsTemp of the found match\n            End If\n        End If\n\n    Next TempIndex\nNext DataIndex\n\n\n\nNext r\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9301406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed3fdbe027d4f775666c059f0a8828ee?s=128&d=identicon&r=PG&f=1", "display_name": "S.Chivers", "link": "https://stackoverflow.com/users/9301406/s-chivers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "accepted_answer_id": 48794831, "answer_count": 2, "score": 0, "last_activity_date": 1518703826, "creation_date": 1518631897, "last_edit_date": 1518632138, "question_id": 48793679, "link": "https://stackoverflow.com/questions/48793679/matching-multiple-criteria-and-returning-multiple-values", "title": "Matching Multiple Criteria and Returning Multiple Values", "body": "<p>I have two spreadsheets (<code>wb</code> and <code>wbtemp</code>); both have a column for location and a column for feature type. In VBA, I want to find all of the rows on the second sheet where the two columns are the same as the two columns on a row in the first sheet and get a list or a range made up of the row numbers/indices.</p>\n\n<p>I then want to use this range to pull out values from a different column and find the highest object in it, but I think I will probably be able to do that if I can get this range sorted.</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nDim Features() As Variant\nDim Activity() As Variant\nDim Benthic As Variant\nDim wbtemp As Workbook\nDim BenSenFeatures() As Variant\nDim BenSenActivity() As Variant\nDim LR As Long\nDim LC As Long\nDim r As Long\nDim c As Long\nDim WhatToFind1 As Variant\nDim WhatToFind2 As Variant\nDim rngFound1 As Range\nDim rngFound2 As Range\nDim rng1 As Variant\nDim rng2 As Variant\nDim rngFound As Range\nDim iLoop As Long\nDim colFound As Range\n\nSet wb = ActiveWorkbook\nSet ws = wb.ActiveSheet\n\nFeatures = ws.Range(\"B:C\").Value\nActivity = ws.Rows(1).Value\n\nBenthic = InputBox(\"Filename goes here...\")\nSet wbtemp = Workbooks.Open(Benthic, True, True)\n\nWith wbtemp\n    BenSenFeatures = .Sheets(1).Range(\"A:B\").Value\n    BenSenActivity = .Sheets(1).Rows(1).Value\nEnd With\n\nLR = ws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nLC = ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor r = 3 To LR\n\n    If Not IsEmpty(Features(r, 2)) Then\n        If IsInArray(Features(r, 2), BenSenFeatures, 2) Then\n        'If WorksheetFunction.Match(Features(r, 2), BenSenFeatures(0, 2), 0) Then   &lt;---I tried to use the arrays originally\n            WhatToFind1 = Features(r, 1)\n            WhatToFind2 = Features(r, 2)\n            Set rngFound1 = wbtemp.Sheets(1).Columns(1).Cells(wbtemp.Sheets(1).Columns(1).Cells.Count)\n            Set rngFound2 = wbtemp.Sheets(1).Columns(2).Cells(wbtemp.Sheets(1).Columns(2).Cells.Count)\n            For iLoop = 1 To WorksheetFunction.CountIf(wbtemp.Sheets(1).Columns(1), WhatToFind1)\n                Set rngFound1 = wbtemp.Sheets(1).Columns(1).Cells.Find(WhatToFind1, After:=rngFound1)\n                rng1(iLoop) = rngFound1.Row\n            'WorksheetFunction.Index(wbtemp.Sheets(1).Range(\"A:B\").Value,_\n               WorksheetFunction.Match(WhatToFind1 &amp; WhatToFind2,_\n               wbtemp.Sheets(1).Columns(1) &amp; wbtemp.Sheets(1).Columns(2),_\n               0), 1)     &lt;---originally tried to use match to search for the multiple criteria but couldn't find a way to create a list of indices\n                Set rngFound2 = wbtemp.Sheets(1).Columns(2).Cells.Find(WhatToFind2, After:=rngFound2)\n                rng2(iLoop) = rngFound2.Row\n            Next iLoop\n            For Each cell In rng1\n                If Not Application.CountIf(rng2, cell.Value) = 0 Then\n                    rngFound.Cells(Cells(Rows.Count, 1).End(xlUp) + 1) = cell.Value\n                End If\n            Next\n</code></pre>\n\n<p>I originally tried to use <code>.Match</code> to find the multiple criteria, but I couldn't figure out how to create a range of indices from it. Then I tried using <code>.Find</code> to create two list of indices but I can't figure out how to get that to work. I keep getting </p>\n\n<blockquote>\n  <p>Type Mismatch</p>\n</blockquote>\n\n<p>errors. </p>\n\n<p>I realise this sounds confusing, so let me know if anything needs clarifying.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518631410, "post_id": 48793522, "comment_id": 84589175, "body": "Looks like you are concatenating <code>s</code> to its previous value, which is already a full filename. I dont think that&#39;s what your intention was."}, {"owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518631780, "post_id": 48793522, "comment_id": 84589356, "body": "Are you referring to this line? s = s &amp; &quot;\\DummyQueryTested.xlsx&quot; I just ran a MsgBox(s) after that line and it was the directory and path I wanted....are you suggesting that I just open without that filepath? I would think I need to specify a location."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518631968, "post_id": 48793522, "comment_id": 84589462, "body": "Try replacing the %20 with just a regular space. You should only need to convert spaces to %20 when it&#39;s part of a URL."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518632053, "post_id": 48793522, "comment_id": 84589501, "body": "if <code>Me.Check9.Value</code> is False then you set <code>s = CurrentPath &amp; &quot;\\OurFile.xlsx&quot;</code>. But then you set <code>s = s &amp; &quot;\\DummyQueryTested.xlsx&quot;</code>, i.e. you append another file name. Which should fail"}, {"owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "edited": false, "score": 0, "creation_date": 1518632592, "post_id": 48793522, "comment_id": 84589800, "body": "I tried removing the %20 with a space but that just caused the Dir() to fail, so those were necessary. I am still unclear why the concatenation which just provides the full path to the actual file would fail. I looked at the Workbook.Open() function to be sure, and it seems you need the full path."}, {"owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "edited": false, "score": 0, "creation_date": 1518633012, "post_id": 48793522, "comment_id": 84589996, "body": "Sorry, I should have made clear that I have been testing with Me.Check9.Value being True.....hope that helps....still same error"}, {"owner": {"reputation": 403, "user_id": 7692763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p00vG.jpg?s=128&g=1", "display_name": "shmicah", "link": "https://stackoverflow.com/users/7692763/shmicah"}, "edited": false, "score": 0, "creation_date": 1518633545, "post_id": 48793522, "comment_id": 84590273, "body": "Do you get the same error if you point it at some dummy .xlsx you create on your desktop or somewhere else?"}, {"owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "edited": false, "score": 0, "creation_date": 1518633942, "post_id": 48793522, "comment_id": 84590471, "body": "When I moved a file to the desktop, the Dir() function showed that wasn&#39;t valid......or it returned a blank."}, {"owner": {"reputation": 403, "user_id": 7692763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p00vG.jpg?s=128&g=1", "display_name": "shmicah", "link": "https://stackoverflow.com/users/7692763/shmicah"}, "edited": false, "score": 0, "creation_date": 1518639120, "post_id": 48793522, "comment_id": 84593170, "body": "Does it work if you define wb as excel.workbook rather than excel.application?  It works for me with a desktop file, but strangely I have to set the file Read-Only first before I can set as ReadWrite. But, MSDN shows ChangeFileAccess operates on a workbook object."}, {"owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "edited": false, "score": 0, "creation_date": 1518640083, "post_id": 48793522, "comment_id": 84593664, "body": "Unfortunately, that still resulted in the same error message. Good thought though!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518644666, "post_id": 48793522, "comment_id": 84595927, "body": "Are you running macro from Excel application or what?"}, {"owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "edited": false, "score": 0, "creation_date": 1518652802, "post_id": 48793522, "comment_id": 84598928, "body": "Running it from Access....but the Access file refers to a linked Excel file which sometimes gets tied up if others are using it. We are trying to temporarily change permissions just so reporting can go through."}], "owner": {"reputation": 47, "user_id": 7433748, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d1730fff5c8527aac72d66a809356b59?s=128&d=identicon&r=PG", "display_name": "DeCodened", "link": "https://stackoverflow.com/users/7433748/decodened"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 526, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594637548, "creation_date": 1518631285, "last_edit_date": 1594637548, "question_id": 48793522, "link": "https://stackoverflow.com/questions/48793522/cannot-find-filepath-that-clearly-exists-disabled-macros-and-verified-direc", "title": "Cannot find filepath that clearly exists.... Disabled macros, and verified directory", "body": "<p>I have checked similar issues, but the solutions I have seen don't really address this problem. I am trying to temporarily <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223811(v=office.11).aspx\" rel=\"nofollow noreferrer\">change the file access</a> of a linked Excel sheet for a supervisor on a network drive. After doing some testing, I was able to validate that 2 directories I was testing are recognized. However, when trying to set a workbook object to a particular .xlsx file in those folders, I kept getting an error indicating Excel couldn't find the file (note the exact Excel name was copied and pasted in). Here is a sample of the code:</p>\n\n<pre><code> Dim wb As Excel.Application\nDim s As String\nIf Me.Check9.Value = False Then\n    s = CurrentPath &amp; \"\\OurFile.xlsx\"\nElse\n    s = \"\\\\--UserProfile---Data\\My%20Documents\\Access%20Database%20Work\"\nEnd If\nIf Dir(s, vbDirectory) = \"\" Then\n    MsgBox (\"Good\")\n    Excel.Application.EnableEvents = False\n    s = s &amp; \"\\DummyQueryTested.xlsx\"\n    '*** Here is where the error is; we disabled macros above ***'\n    Set wb = Workbooks.Open(s)\n    wb.ChangeFileAccess Mode:=xlReadWrite\nElse\n    MsgBox (\"Bad\")\n    Set wb = Workbooks.Open(s)\nEnd If\nExcel.Application.EnableEvents = True\n</code></pre>\n\n<p>A few last notes:</p>\n\n<ul>\n<li>There are On_Open macros, so that is why I tried using the EnableEvents=False command. The thought was those were preventing the files from opening</li>\n<li>I can't just move the file to another location because this is a file that is opened by an Access database as a link, and the company needs these files to be in the locations they are currently residing in. </li>\n<li>Finally, you can see I tested the network as well as local file paths and that is what the \"Check9.Value\" test was for...to test 2 different filepaths.</li>\n</ul>\n\n<p>Any help would be appreciated. I have seen similar issues, but not exactly like this one. Is there any way to test further if there is some permission, or some setting these files have that might be causing problems? </p>\n"}, {"tags": ["json", "vba", "parsing"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518631279, "post_id": 48793486, "comment_id": 84589123, "body": "Have you tried stepping thru it using F8 to see where your logic is breaking down?"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518639139, "post_id": 48793486, "comment_id": 84593181, "body": "@braX the code is working fine without the part \u201cdim findy...set cell\u201d. However once I put this lookup part including the IF statement, CELL is returning nothing."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1518641303, "post_id": 48793486, "comment_id": 84594317, "body": "Try <code>LookIn:=xlValues</code>"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518809929, "post_id": 48793486, "comment_id": 84671845, "body": "@TimWilliams ok so i added a lastrow property that detect the rows count and then append the missing values after the last row. Now it\u2019s working perfectly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1518810652, "post_id": 48793486, "comment_id": 84672175, "body": "Good to hear you got it working."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1520802397, "post_id": 48793486, "comment_id": 85453812, "body": "@Leb_Broth Could you please post an answer then and accept it, just to make the solution clear?"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1520802571, "post_id": 48793486, "comment_id": 85453864, "body": "@omegastripes sure I\u2019ll do it in the morning as I\u2019m away from the code but thanks for reminding me"}], "owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518631180, "creation_date": 1518631180, "question_id": 48793486, "link": "https://stackoverflow.com/questions/48793486/finding-new-elements-in-json-array-and-update-spreadsheet", "title": "Finding new elements in JSON array and update spreadsheet", "body": "<p>I am parsing my JSON list everyday to my Excel spreadsheet. It is a list of around 400-500 user info and everyday it is being updated. Now because i don't want to parse the same list everyday, i just need to locate the new objects that are added to the JSON and comparing it with the existing parsed list in Excel. New objects will be added if not found. This is my code below:</p>\n\n<pre><code>Private Sub populate_Click()\n\nDim http As Object, JSON As Object, Item As Variant\nDim i As Integer\n\nSet http = CreateObject(\"MSXML2.XMLHTTP\")\nhttp.Open \"GET\", \"http://controlpanel.verio/rest/reports?errorMessages=null\", False\nhttp.send\n\nDim jsnStr As Object\nSet jsnStr = ParseJson(http.responseText)\n'Fetching data\ni = 3\nFor Each Item In jsnStr(\"results\")(1)(\"results\")\n\n    Dim findy As Variant\n    findy = Item(4)\n    Columns(\"B:B\").Select\n    Set cell = Selection.Find(What:=findy, After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n\n    If cell Is Nothing Then\n    'do it something\n    Sheets(1).Cells(i, 1).Value = Item(3)\n   Sheets(1).Cells(i, 2).Value = Item(4)\n   Sheets(1).Cells(i, 5).Value = Item(18)\n   Sheets(1).Cells(i, 6).Value = Item(6)\n   Sheets(1).Cells(i, 7).Value = Item(7)\n   Sheets(1).Cells(i, 8).Value = Item(8)\n   Sheets(1).Cells(i, 9).Value = Item(5)\n   Sheets(1).Cells(i, 11).Value = Item(20)\n\n    i = i + 1\n    Else\n    'do it another thing\n    End If\n\nNext\nSet JSON = Nothing\nSet http = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I am not receiving any error but nothing is changed or updated from the excel list. </p>\n\n<p><strong>What should I correct in the below code?</strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1518630962, "creation_date": 1518630962, "answer_id": 48793440, "question_id": 48793332, "link": "https://stackoverflow.com/questions/48793332/how-to-a-apply-a-macro-thats-for-one-cell-to-multiple-cells/48793440#48793440", "title": "How to a apply a macro that&#39;s for one cell to multiple cells", "body": "<p>If you want the cells added separately, you could cycle through an array, viz</p>\n\n<pre><code>Sub Addem()\n\nDim ws As Worksheet, x() As Long, v, i As Long\n\nv = Array(\"G12\", \"H12\", \"N12\", \"H33\", \"N33\") 'amend to suit\nReDim x(UBound(v))\n\nFor Each ws In Worksheets\n    If ws.Name Like \"*Fvar\" Then\n        For i = LBound(v) To UBound(v)\n            x(i) = x(i) + ws.Range(v(i)).Value\n        Next i\n    End If\nNext ws\n\nFor i = LBound(v) To UBound(v)\n    Sheets(\"Summary-Fvar2\").Range(v(i)).Value = x(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518634881, "post_id": 48794108, "comment_id": 84590986, "body": "Hey thanks for your response but I think your misconstrue my question, I don&#39;t want to add the all the (G12,H12, N12, etc) together I want to the do the process separately.   Add on the G12 replace G12 than add all the H12 and replace H12.  Is there a way to tweak your code for this."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518635284, "post_id": 48794108, "comment_id": 84591205, "body": "Just to make sure I got you right: The AddCell is correct and you want to apply AddCell for G12, H12, N12 etc separately?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518635514, "post_id": 48794108, "comment_id": 84591330, "body": "Yes, I don&#39;t want to total of them all in one cell I want the totals in the respective cells.  Add all sheets with the sheet name criteria for G12, and put it in the summary than do the same for H12 and N12 etc.  Thanks for you help"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518635726, "post_id": 48794108, "comment_id": 84591452, "body": "I edited the post and added another Sub which should fulfill your request"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518636377, "post_id": 48794108, "comment_id": 84591775, "body": "I get an error and it highlights Addcell in your code"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518636462, "post_id": 48794108, "comment_id": 84591812, "body": "You have the code for AddCell and AddCellMultiple in your Module? What is the error message saying?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1518637769, "post_id": 48794108, "comment_id": 84592511, "body": "Thanks so much I didn&#39;t have Add Cell in the module"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1518636081, "last_edit_date": 1518636081, "creation_date": 1518633638, "answer_id": 48794108, "question_id": 48793332, "link": "https://stackoverflow.com/questions/48793332/how-to-a-apply-a-macro-thats-for-one-cell-to-multiple-cells/48794108#48794108", "title": "How to a apply a macro that&#39;s for one cell to multiple cells", "body": "<p>I would apply a formula like that. This code replaces your Sub Addem</p>\n\n<pre><code>Sub AddCell(ByVal myCell As String, ByVal target As Range, ByVal pattern As String)\n\n    Dim ws As Worksheet\n    Dim myFormula As String\n\n        For Each ws In Worksheets\n            If ws.Name Like pattern Then\n                myFormula = myFormula &amp; ws.Name &amp; \"!\" &amp; myCell &amp; \",\"\n            End If\n        Next\n\n        myFormula = Left(myFormula, Len(myFormula) - 1)\n        target.Formula = \"=SUM(\" &amp; myFormula &amp; \")\"\n\nEnd Sub\n\nSub TestIt()\n     AddCell \"G12\", Sheets(\"Summary-Fvar2\").Range(\"G12\"), \"Fav*\"    \nEnd Sub\n</code></pre>\n\n<p>The next code is for an array of cells</p>\n\n<pre><code>Sub AddCellV(ByVal vCell As Variant, ByVal target As Range, ByVal pattern As String)\n            Dim ws As Worksheet\n\n        Dim myFormula As String\n        Dim i As Long\n            For i = LBound(vCell) To UBound(vCell)\n                For Each ws In Worksheets\n                    If ws.Name Like pattern Then\n                        myFormula = myFormula &amp; ws.Name &amp; \"!\" &amp; vCell(i) &amp; \",\"\n                    End If\n                Next\n            Next\n\n            myFormula = Left(myFormula, Len(myFormula) - 1)\n            target.Formula = \"=SUM(\" &amp; myFormula &amp; \")\"\n\nEnd Sub\n\nSub TestIt()                \n      AddCellV Array(\"G12\", \"H12\", \"N12\", \"H33\", \"N33\"), Sheets(\"Summary-Fvar2\").Range(\"G12\"), \"Fav*\"                \nEnd Sub\n</code></pre>\n\n<p>By the comment of the TO AddCell needs to applied multiple times like that</p>\n\n<pre><code>Sub AddCellMultiple(ByVal vCell As Variant, _\n                            ByVal targetSh As Worksheet, _\n                            ByVal pattern As String)\n\n    Dim i As Long\n    For i = LBound(vCell) To UBound(vCell)\n        AddCell vCell(i), targetSh.Range(vCell(i)), pattern\n    Next\n\nEnd Sub\n\n\nSub TestMultiple()\n    AddCellMultiple Array(\"G12\", \"H12\", \"N12\", \"H33\", \"N33\"), Sheets(\"Summary-Fvar2\"), \"Fav*\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "accepted_answer_id": 48794108, "answer_count": 2, "score": 0, "last_activity_date": 1518636081, "creation_date": 1518630514, "last_edit_date": 1531161705, "question_id": 48793332, "link": "https://stackoverflow.com/questions/48793332/how-to-a-apply-a-macro-thats-for-one-cell-to-multiple-cells", "title": "How to a apply a macro that&#39;s for one cell to multiple cells", "body": "<p>I have the following code that add the same cell based on the worksheet name, here's the code:</p>\n\n<pre><code>Sub Addem()\nDim ws As Worksheet\nx = 0\nFor Each ws In Worksheets\nIf ws.Name Like \"*Fvar\" Then\n    x = x + ws.Range(\"G12\").Value\nEnd If\nNext ws\nSheets(\"Summary-Fvar2\").Range(\"G12\").Value = x\nEnd Sub\n</code></pre>\n\n<p>How can I format this macro to apply it to several cells location separately? (H12, N12, H33, N33 etc...)</p>\n\n<p>When I tried defining the range name and adding all the cell locations I wanted to apply it to it sum every cell in the range.</p>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518631239, "post_id": 48793249, "comment_id": 84589104, "body": "See <a href=\"http://www.cpearson.com/excel/ReturningErrors.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/ReturningErrors.aspx</a> (as per @DisplayName&#39;s answer)."}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518982313, "post_id": 48793480, "comment_id": 84714901, "body": "@shwetaagnihotri, any feedback?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 2, "last_activity_date": 1518631788, "last_edit_date": 1518631788, "creation_date": 1518631149, "answer_id": 48793480, "question_id": 48793249, "link": "https://stackoverflow.com/questions/48793249/div-0-error-and-replace-it-with-zero/48793480#48793480", "title": "#DIV/0! error and replace it with zero", "body": "<p>seem like you have to check for <code>cell.Value</code> being an error before comparing it to an error value</p>\n\n<pre><code>If IsError(Cell.Value) Then If Cell.Value = CVErr(xlErrDiv0) Then Cell.Value = 0\n</code></pre>\n\n<p>so your code becomes</p>\n\n<pre><code>Sub mm()\n    Dim Cell As Range\n    Dim iSheet As Worksheet\n    For Each iSheet In Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\"))\n        With iSheet\n            For Each Cell In .UsedRange\n                If IsError(Cell.Value) Then If Cell.Value = CVErr(xlErrDiv0) Then Cell.Value = 0\n            Next Cell\n        End With\n    Next iSheet\nEnd Sub\n</code></pre>\n\n<p>another possibility, which limits the cell loop, is the following</p>\n\n<pre><code>Sub mm()\n    Dim Cell As Range\n    Dim iSheet As Worksheet\n\n    For Each iSheet In Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\"))\n        With iSheet\n            If WorksheetFunction.CountIf(.UsedRange, \"#DIV/0!\") Then ' if any Division error found in current sheet used range cells\n                For Each Cell In .UsedRange.SpecialCells(xlCellTypeFormulas, xlErrors) 'loop through error cells only\n                    If Cell.Value = CVErr(xlErrDiv0) Then Cell.Value = 0\n                Next\n            End If\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9283113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef71f70d65feaafdfc88d488de5e11d?s=128&d=identicon&r=PG&f=1", "display_name": "shweta agnihotri", "link": "https://stackoverflow.com/users/9283113/shweta-agnihotri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518631788, "creation_date": 1518630194, "last_edit_date": 1518630229, "question_id": 48793249, "link": "https://stackoverflow.com/questions/48793249/div-0-error-and-replace-it-with-zero", "title": "#DIV/0! error and replace it with zero", "body": "<p>I am trying the below code to detect DIV/0 error and replace it with Zero or empty cell. but ** line is throwing me error</p>\n\n<pre><code>Dim Cell As Range\nDim iSheet as Worksheet\nFor Each iSheet In sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\"))\n    With iSheet\n        For Each Cell In .UsedRange\n            **If Cell.Value = CVErr(xlErrDiv0) Then Cell.Value = 0**\n        Next Cell\n    End With\nNext iSheet\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "bi-publisher"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518630345, "post_id": 48792894, "comment_id": 84588647, "body": "I wanted to insert your pictures, but they&#39;re not in a supported format. Please try to upload *.png - with your rep you won&#39;t be able to, but we can."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518630498, "post_id": 48792894, "comment_id": 84588719, "body": "It&#39;s not clear exactly what you need, but: A Word table <i>must</i> have an empty paragraph mark following the table. Some of the table structures are stored in that paragraph mark. (If you&#39;re not displaying non-printing characters you won&#39;t see the paragraph mark, but it&#39;s not &quot;a blank space&quot;.) If it&#39;s too much space, select the paragraph and apply a smaller font size. You can type in the font size box in the Ribbon; the smallest number it accepts is 1. Or you can format it as &quot;Hidden&quot; using the font formatting dialog box."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1518655524, "post_id": 48792894, "comment_id": 84599659, "body": "For one, &quot;Allow row to break across pages&quot; has no effect on the table as a whole. If you want to ensure that it is on one page format the paragraphs within the table as &quot;Keep with next&quot;. Provided that the table actually fits on one page that should dispense with your need for a PageBreak."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1518655648, "post_id": 48792894, "comment_id": 84599701, "body": "Assuming that you are talking about a vertical space, the PageBreak doesn&#39;t generate such a space. Instead, the &quot;logic&quot; is that one should have the PageBreak after the text that preceeds it which usually means that the PageBreak is in a new paragraph, and that is the one that generates a space. Format it as Cindy has suggested, or add the PageBreak at the end of the preceeding paragraph, not in a paragraph of its own."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1518678552, "creation_date": 1518678552, "answer_id": 48801657, "question_id": 48792894, "link": "https://stackoverflow.com/questions/48792894/replace-a-blank-before-a-table-page-break-word-vba/48801657#48801657", "title": "Replace a blank before a table page break Word VBA", "body": "<p>What you could do is insert a page-size table into a textbox in the page header and format the body text with a white background. The table will thus be hidden behind any text on the page, but not otherwise (provided you don't pad unused space with empty paragraphs, etc.).</p>\n"}], "owner": {"reputation": 1, "user_id": 9324442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31408be39afeb0867e4420c69dced51a?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Analytics ETL BI", "link": "https://stackoverflow.com/users/9324442/juan-analytics-etl-bi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593888943, "creation_date": 1518628804, "last_edit_date": 1593888943, "question_id": 48792894, "link": "https://stackoverflow.com/questions/48792894/replace-a-blank-before-a-table-page-break-word-vba", "title": "Replace a blank before a table page break Word VBA", "body": "<p>I uncheck \"Allow row to break across pages\" for a table's properties So, the table is shown on a new page to ensure that all the content is on one page, this works fine. But Word generates a blank space before the page break, I need to replace it with some text for a legal reason. I can't use a watermark or shapes because un Oracle BI Publisher only prints it on PDF and I need to export it to a docx.</p>\n\n<p>The data is dynamic, so sometimes the text before the table and the text inside the table may change.</p>\n\n<p>Current Version <a href=\"https://imgur.com/a/FTx0q\" rel=\"nofollow noreferrer\">https://imgur.com/a/FTx0q</a>\nI need some like this <a href=\"https://imgur.com/a/ySitL\" rel=\"nofollow noreferrer\">https://imgur.com/a/ySitL</a> </p>\n\n<p>MS Office support told me that it can't be done with Word...\nMaybe with VBA code?</p>\n\n<p>Update</p>\n\n<p>Thanks Cindy for your help.</p>\n\n<p>I have a table into another table many paragraphs, checkbox etc and they are fitting on a new page. It's working.</p>\n\n<p>I understand there isn't a page break.\nIt's Paragraph mark.\nBut what I need to do is insert a kind of mark, a text like XXXX,-----------,  Instead of leaving \"free space\",</p>\n\n<p>It's a requirement not change the font size or another text format. \nFor a legal requirement, some paragraph must fit on a new page and \"blank spaces\" replaced by a kind of mark.\nI can't hard code it because in several cases not all the paragraphs or section in a page will be shown and I don't know by default when a new page is needed.\n I am available to use macros or anything.</p>\n"}, {"tags": ["excel", "vba", "constants"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1518629356, "last_edit_date": 1518629356, "creation_date": 1518628300, "answer_id": 48792734, "question_id": 48792685, "link": "https://stackoverflow.com/questions/48792685/set-date-with-current-year-as-public-const/48792734#48792734", "title": "set date with current year as public const", "body": "<p>Constants cannot have variables in them, and in VBA, you cannot Dim a variable and assign it's value at the same time like you are doing (You can in VB.NET tho).</p>\n\n<p>It would be written more like this:</p>\n\n<pre><code>Public gen1 As Long \ngen1 = CLng(#1/1/year(date)#)\n</code></pre>\n\n<p>But that's going to give you an error too...</p>\n\n<p>If you are trying to assign the value of gen1 to be the current year, all you need is this:</p>\n\n<pre><code>gen1 = Year(Date)\n</code></pre>\n\n<p>If you want January 1 of the current year as a Date (not a Long) then you can do it like this:</p>\n\n<pre><code>Dim gen1 as Date\ngen1 = CVDate(\"1/1/\" &amp; Year(Date))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1518628609, "creation_date": 1518628609, "answer_id": 48792842, "question_id": 48792685, "link": "https://stackoverflow.com/questions/48792685/set-date-with-current-year-as-public-const/48792842#48792842", "title": "set date with current year as public const", "body": "<p>A public property should also be just fine:</p>\n\n<pre><code>Public Property Get TheDate() As Date\n    TheDate = DateSerial(Year(Date), 1, 1)\nEnd Property\n</code></pre>\n\n<p>Then just call it:</p>\n\n<pre><code>Debug.Print TheDate\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518629356, "creation_date": 1518628134, "question_id": 48792685, "link": "https://stackoverflow.com/questions/48792685/set-date-with-current-year-as-public-const", "title": "set date with current year as public const", "body": "<p>i wish to set a date with fixed dd and mm but but current year, for eg 01/01/2018 or 31/01/2018, 05/08/2018 (in us dd and mm are reversed) and so on.\nhello guys, i wish to set a date with fixed dd and mm but but current year, for eg 01/01/2018 or 31/01/2018, 05/08/2018 (in us dd and mm are reversed) and so on.\ni know only number and string can be set as public const; </p>\n\n<p>thereby i tried so far:</p>\n\n<pre><code>Public Const gen1 As Long = CLng(#1/1/year(date)#)\n</code></pre>\n\n<p>but is not working\nany tip please?\nthanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1518628556, "post_id": 48792498, "comment_id": 84587761, "body": "If you are not familiar with VBA it will be difficult to get any answers here because practically we have to write the code for you. I recommend that you study a bit online and learn basics and come up with a simple code and then we help you to better it and do whatever you want to do"}, {"owner": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1518703378, "post_id": 48792498, "comment_id": 84621330, "body": "Definitely, I know some vba and can definitely understand what has been provided but a starting point was largely what i was looking for. I&#39;m working to learn in parallel with getting a timely way to organize this data made for easy viewing but not quite handy for any kind of analysis"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "edited": false, "score": 0, "creation_date": 1518703290, "post_id": 48793066, "comment_id": 84621260, "body": "This worked great. There are cases in my dataset that the level is not marked by an x and it creates blanks in column b for the group but I will try to loop through the multiple sheets and address the blanks when no x is found. Thanks for the valuable input!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "edited": false, "score": 0, "creation_date": 1518703429, "post_id": 48793066, "comment_id": 84621365, "body": "I&#39;ve updated my answer so instead of looking for an x, it will check to see which cell is not empty, thus any symbol should work now... :)"}, {"owner": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "edited": false, "score": 0, "creation_date": 1518705353, "post_id": 48793066, "comment_id": 84622665, "body": "Thanks, i found one other thing in the data set where the groupid is blank there is actually a trailing space in some cells which throws off the not empty &quot;&quot; comparison to grab groupids. I&#39;m trying out the trim function to see if it sorts that out."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "edited": false, "score": 0, "creation_date": 1518705446, "post_id": 48793066, "comment_id": 84622730, "body": "@Oliver I&#39;ve updated the answer to trim the contents of the cell before doing the comparison..."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1518705419, "last_edit_date": 1518705419, "creation_date": 1518629516, "answer_id": 48793066, "question_id": 48792498, "link": "https://stackoverflow.com/questions/48792498/looping-and-copy-data-to-a-new-sheet/48793066#48793066", "title": "Looping and Copy Data to a new sheet", "body": "<p>The following will do what you expect:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nDim wsResult As Worksheet: Set wsResult = Sheets(\"Sheet2\")\nLastRow = ws.Cells(ws.Rows.Count, \"J\").End(xlUp).Row\n'get the last row with data on Column J\n\nFor i = 2 To LastRow\n    NextRow = wsResult.Cells(wsResult.Rows.Count, \"D\").End(xlUp).Row + 1\n    ws.Range(\"H\" &amp; i &amp; \":J\" &amp; i).Copy Destination:=wsResult.Range(\"D\" &amp; NextRow)\n    wsResult.Range(\"A\" &amp; NextRow).Value = \"Title\"\n    If ws.Cells(i, 1) &lt;&gt; \"\" Then 'if GroupID is not empty\n        wsResult.Range(\"B\" &amp; NextRow).Value = ws.Cells(i, 1) 'grab that GroupID\n    Else\n        x = i\n        Do While Trim(ws.Cells(x, 1)) = \"\"\n            x = x - 1\n            Group = ws.Cells(x, 1) 'get the GroupID of the Row above\n        Loop\n        wsResult.Range(\"B\" &amp; NextRow).Value = Group\n    End If\n\n    For y = 2 To 7\n        If ws.Cells(i, y) &lt;&gt; \"\" Then\n            Level = ws.Cells(1, y).Value\n            Exit For\n        End If\n    Next y\n    wsResult.Cells(NextRow, 3) = Level\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1518631199, "creation_date": 1518631199, "answer_id": 48793493, "question_id": 48792498, "link": "https://stackoverflow.com/questions/48792498/looping-and-copy-data-to-a-new-sheet/48793493#48793493", "title": "Looping and Copy Data to a new sheet", "body": "<p>Try this:</p>\n\n<pre><code>Sub BuildTable()\n    Dim data(), i As Integer, j As Integer\n\n    data = Worksheets(\"Sheet1\").Range(\"A2:J5\").Value\n\n    For i = 1 To UBound(data)\n        With Worksheets(\"Sheet2\")\n            .Range(\"A\" &amp; i) = \"Title\"\n            .Range(\"D\" &amp; i) = data(i, 8)\n            .Range(\"E\" &amp; i) = data(i, 9)\n            .Range(\"F\" &amp; i) = data(i, 10)\n\n            If i &gt; 1 Then\n                .Range(\"B\" &amp; i) = IIf(data(i, 1) &lt;&gt; \"\", data(i, 1), .Range(\"B\" &amp; i - 1))\n            Else\n                .Range(\"B\" &amp; i) = data(i, 1)\n            End If\n\n            For j = 2 To 7\n                If data(i, j) = \"x\" Then\n                    .Range(\"C\" &amp; i) = \"Level\" &amp; j - 1\n                End If\n            Next j\n\n        End With\n    Next i \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "edited": false, "score": 0, "creation_date": 1518703447, "post_id": 48793967, "comment_id": 84621375, "body": "I had not seen power query before i&#39;ll check it out as well. It looks like a solid tool to have on hand."}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "reply_to_user": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "edited": false, "score": 0, "creation_date": 1518703740, "post_id": 48793967, "comment_id": 84621573, "body": "It is absolutely, this is the answer of Microsoft Office for Big Data and Business Intelligence."}], "tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 0, "last_activity_date": 1518633044, "creation_date": 1518633044, "answer_id": 48793967, "question_id": 48792498, "link": "https://stackoverflow.com/questions/48792498/looping-and-copy-data-to-a-new-sheet/48793967#48793967", "title": "Looping and Copy Data to a new sheet", "body": "<p>You can use <strong>Power Query</strong> Excel 2010+ you can download and activate easily or by default in 2016 version. There you can transform your data and put it as a table or a pivot table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hJd8l.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hJd8l.gif\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9360620, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oliver", "link": "https://stackoverflow.com/users/9360620/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 48793066, "answer_count": 3, "score": -3, "last_activity_date": 1518705419, "creation_date": 1518627575, "last_edit_date": 1518628244, "question_id": 48792498, "link": "https://stackoverflow.com/questions/48792498/looping-and-copy-data-to-a-new-sheet", "title": "Looping and Copy Data to a new sheet", "body": "<p>This is my first post, but I have an excel workbook with multiple tabs formatted like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9MAWi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9MAWi.png\" alt=\"current screenshot\"></a></p>\n\n<p>I'm learning vba but don't know the excel functions well enough yet to loop through the rows and copy the data reformatted to a new sheet into this format: </p>\n\n<p><a href=\"https://i.stack.imgur.com/Uy6aD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uy6aD.png\" alt=\"expected result\"></a></p>\n\n<p>Specifically I think i need to<br>\n- Initialize the range of worksheets</p>\n\n<ul>\n<li><p>loop through them</p></li>\n<li><p>store column headers for b through G into a variable so when the x is found it can be concatenated or copied over</p></li>\n<li><p>handle the blank spaces so that the last value is used for each one</p></li>\n</ul>\n\n<p>Any help appreciated. Thanks!</p>\n"}, {"tags": ["vba", "gradient", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1518797795, "creation_date": 1518797795, "answer_id": 48830770, "question_id": 48792241, "link": "https://stackoverflow.com/questions/48792241/two-color-gradient-in-powerpoint-macro-second-color-stays-white/48830770#48830770", "title": "Two color gradient in Powerpoint macro/ second color stays white", "body": "<p>Set the gradient fill first, then set the colors:</p>\n\n<pre><code>Shp.Fill.TwoColorGradient msoGradientHorizontal, 2\nShp.Fill.ForeColor.RGB = RGB(18, 115, 57)\nShp.Fill.BackColor.RGB = RGB(72, 166, 105)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9361146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837528a5d4860a17923da22f04e2c8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/9361146/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518797795, "creation_date": 1518626828, "last_edit_date": 1518678924, "question_id": 48792241, "link": "https://stackoverflow.com/questions/48792241/two-color-gradient-in-powerpoint-macro-second-color-stays-white", "title": "Two color gradient in Powerpoint macro/ second color stays white", "body": "<p>Trying to create a 2 color gradient in a powerpoint macro. The second color keeps showing up as white. I saw another question on here about the same problem but the answer didn't work for me. Can anyone spot my issue? Thanks in advance!</p>\n\n<pre><code>Dim Sld As Slide\nDim Shp As Shape\n\nSet Sld = Application.ActiveWindow.View.Slide\n\n'TIMELINE BOX\n    Set Shp = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n        Left:=-5, Top:=0, Width:=365, Height:=50)\n\n    'Shape Name\n        Shp.Name = \"DateBox1\"\n    'No Shape Border\n        Shp.Line.Visible = msoTrue\n        Shp.Line.Weight = 2\n        Shp.Line.ForeColor.RGB = RGB(255, 255, 255)\n    'Shape Fill Color\n        Shp.Fill.Visible = msoTrue\n        Shp.Fill.ForeColor.RGB = RGB(18, 115, 57)\n        Shp.Fill.BackColor.RGB = RGB(72, 166, 105)\n        Shp.Fill.TwoColorGradient msoGradientHorizontal, 2\n        'Shp.Fill.GradientStops.Item(1).Position = 50\n        Shp.Fill.RotateWithObject = msoTrue\n\n    'Shape Text Color\n        Shp.TextFrame.TextRange.Font.Color.RGB = RGB(255, 255, 255)\n    'Text inside Shape\n        Shp.TextFrame.TextRange.Characters.Text = \"DATE\"\n    'Center Align Text\n        Shp.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter\n    'Vertically Align Text to Middle\n        Shp.TextFrame2.VerticalAnchor = msoAnchorMiddle\n    'Adjust Font Size\n        Shp.TextFrame2.TextRange.Font.Size = 22\n        Shp.TextFrame2.TextRange.Font.Name = \"Myriad Pro\"\n        Shp.TextFrame2.TextRange.Font.Bold = True\n        Shp.TextFrame2.TextRange.Font.Shadow.Type = msoShadow1\n        Shp.TextFrame2.TextRange.Font.Shadow.OffsetX = 10\n        Shp.TextFrame2.TextRange.Font.Shadow.OffsetY = 10\n        Shp.TextFrame2.TextRange.Font.Shadow.Size = 1\n        Shp.TextFrame2.TextRange.Font.Shadow.Blur = 4\n        Shp.TextFrame2.TextRange.Font.Shadow.Transparency = 0.5\n        Shp.TextFrame2.TextRange.Font.Shadow.Visible = True\n  'Shadow\n    Shp.Shadow.Type = msoShadow1\n    Shp.Shadow.ForeColor.RGB = RGB(0, 0, 0)\n    Shp.Shadow.Transparency = 0.7\n    Shp.Shadow.OffsetX = 2\n    Shp.Shadow.OffsetY = 2\n    Shp.Shadow.Blur = 60\n</code></pre>\n"}, {"tags": ["vba", "excel", "matrix"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1518626835, "post_id": 48792156, "comment_id": 84586678, "body": "Use VBA to reposition (copy) the cells as you want them to be."}, {"owner": {"reputation": 1, "user_id": 9360731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92830436eb7bb2ed940258c76228af06?s=128&d=identicon&r=PG&f=1", "display_name": "Brossi", "link": "https://stackoverflow.com/users/9360731/brossi"}, "edited": false, "score": 0, "creation_date": 1518627329, "post_id": 48792156, "comment_id": 84587039, "body": "Thanks! Is there another way where you can avoid copying all the cells?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1518627840, "post_id": 48792156, "comment_id": 84587349, "body": "Yes, write a VBA function"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518627932, "creation_date": 1518627932, "answer_id": 48792616, "question_id": 48792156, "link": "https://stackoverflow.com/questions/48792156/create-matrix-from-predefined-cells/48792616#48792616", "title": "Create matrix from predefined cells", "body": "<p>to fill an array with range values you simply go like follows:</p>\n\n<pre><code>Dim eigenvalueMatrix As Variant\n\neigenvalueMatrix = Range(\"A1:C3\").Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9360731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92830436eb7bb2ed940258c76228af06?s=128&d=identicon&r=PG&f=1", "display_name": "Brossi", "link": "https://stackoverflow.com/users/9360731/brossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1518629368, "creation_date": 1518626528, "last_edit_date": 1518629368, "question_id": 48792156, "link": "https://stackoverflow.com/questions/48792156/create-matrix-from-predefined-cells", "title": "Create matrix from predefined cells", "body": "<p>Good afternoon,</p>\n\n<p>I'm quite new to VBA and Excel and i'm having the following problem.\nI have a function that requires a symmetric matrix as input to calculate the eigenvalue <code>[=MEigenvalueMax (A1: C3)]</code>. However, I have the data for the matrix in different cells. My question is therefore whether there is a function with which I can define predefined cells as a matrix, e. g. <code>=MEigenvalMax ({A1, A2, A3; B1, B2, B3; C1, C2, C3})</code>.\nThank you for the answers! </p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1518625516, "post_id": 48791808, "comment_id": 84585739, "body": "If you add the function in a <code>Module</code> and make it public, you can use it in the Excel formulas, you can also pass parameters to it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1518625731, "post_id": 48791808, "comment_id": 84585912, "body": "<code>Range(&quot;A2&quot;).FormulaR1C1 = &quot;=countblank(&#39;[Test.xlsx]Sheet1 test&#39;!C1:C&quot; &amp; bottom &amp; &quot;)&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 9361028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c901c52d30d783a4d87acc09231cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Atanas", "link": "https://stackoverflow.com/users/9361028/atanas"}, "edited": false, "score": 0, "creation_date": 1518626141, "post_id": 48791808, "comment_id": 84586196, "body": "Yes, I tried that but I had an extra &quot; at the end. Thank you, it worked. Range(&quot;A2&quot;).Formula = &quot;=countblank(&#39;[Test.xlsx]Sheet1 test&#39;!A1:A&quot; &amp; bottom &amp; &quot;)&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518626764, "post_id": 48791808, "comment_id": 84586609, "body": "The general consensus is that fixing a quoted string to be inserted as a cell&#39;s formula via VBA is <b>not</b> an <a href=\"https://stackoverflow.com/questions/tagged/excel-formula\">excel-formula</a> problem."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1518627139, "creation_date": 1518627139, "answer_id": 48792358, "question_id": 48791808, "link": "https://stackoverflow.com/questions/48791808/use-a-macro-in-a-range-reference/48792358#48792358", "title": "Use a macro in a range reference", "body": "<p>The title of <em>Use a macro in a range reference</em> is a bit misleading.  </p>\n\n<p>From the title I'd suggest using this code:  </p>\n\n<pre><code>Public Function MyRange() As Range\n\n    Dim rng_bottom As Range\n    With ThisWorkbook.Worksheets(\"Sheet1 Test\")\n        Set rng_bottom = .Cells(.Rows.Count, 1).End(xlUp)\n        Set MyRange = .Range(.Cells(1, 3), rng_bottom.Offset(, 2))\n    End With\n\nEnd Function\n</code></pre>\n\n<p>You can then enter directly into a cell: <code>=COUNTBLANK(MyRange())</code> which would use a macro as a range reference.  </p>\n\n<p>From your sample code it looks more like you want one of these three solutions:  </p>\n\n<pre><code>Public Sub Test()\n\n    Dim rng_bottom As Range\n    With ThisWorkbook.Worksheets(\"Sheet1 Test\")\n        'Return a reference to the last cell in column A.\n        Set rng_bottom = .Cells(.Rows.Count, 1).End(xlUp)\n\n        '****SOLUTION 1:****\n        'Add the formula using R1C1 formatting.  Offset rng_bottom by 2 columns to return reference to column C.\n        ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").FormulaR1C1 = _\n            \"=COUNTBLANK('Sheet1 Test'!R1C3:\" &amp; rng_bottom.Offset(, 2).Address(, , xlR1C1) &amp; \")\"\n    End With\n\n    Dim lng_bottom As Long\n    With ThisWorkbook.Worksheets(\"Sheet1 Test\")\n        'Return last row number in column A.\n        lng_bottom = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        '****SOLUTION 2:****\n        'Add the formula using R1C1 formatting.\n        ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\").FormulaR1C1 = _\n            \"=COUNTBLANK('Sheet1 Test'!R1C3:R\" &amp; lng_bottom &amp; \"C3)\"\n\n        '****SOLUTION 3:****\n        'Add the formula using A1 formatting.\n        ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A3\").Formula = _\n            \"=COUNTBLANK('Sheet1 Test'!$C$1:$C$\" &amp; lng_bottom &amp; \")\"\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1518667434, "creation_date": 1518667434, "answer_id": 48799791, "question_id": 48791808, "link": "https://stackoverflow.com/questions/48791808/use-a-macro-in-a-range-reference/48799791#48799791", "title": "Use a macro in a range reference", "body": "<p>Here is a UDF that returns the used range in a column</p>\n\n<pre><code>Function UsedRange(r As Range, Optional FromRowOne As Boolean = True) As Range\n    Dim rTop As Range\n    Dim rEnd As Range\n    With r.Worksheet\n        Set rTop = r.EntireColumn.Cells(1, 1)\n        If Not FromRowOne Then\n            If IsEmpty(rTop) Then\n                Set rTop = rTop.End(xlDown)\n            End If\n        End If\n        Set rEnd = r.EntireColumn.Cells(.Rows.Count, 1)\n        If IsEmpty(rEnd) Then\n            Set rEnd = rEnd.End(xlUp)\n        End If\n        If rTop.Row &lt; rEnd.Row Then\n            Set UsedRange = .Range(rTop, rEnd)\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>To count the number of empty cells in column A use it like this</p>\n\n<pre><code>=COUNTBLANK((UsedRange(A:A)))\n</code></pre>\n\n<p>Optional parameter <code>FromRowOne</code> can be used to ignore blanks from row 1 down to the first used row, like this</p>\n\n<pre><code>=COUNTBLANK((UsedRange(A:A, FALSE)))\n</code></pre>\n\n<p>If it is passed an empty column, it returns <code>Nothing</code></p>\n\n<p>It also accounts for the possibilty that data extends to the last row in the sheet</p>\n"}], "owner": {"reputation": 13, "user_id": 9361028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c901c52d30d783a4d87acc09231cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Atanas", "link": "https://stackoverflow.com/users/9361028/atanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518667434, "creation_date": 1518625425, "last_edit_date": 1518626795, "question_id": 48791808, "link": "https://stackoverflow.com/questions/48791808/use-a-macro-in-a-range-reference", "title": "Use a macro in a range reference", "body": "<pre><code>bottom = Cells(Rows.Count, 1).End(xlUp).Row\nRange(\"A2\").FormulaR1C1 = \"=countblank('[Test.xlsx]Sheet1 test'!C1:C1)\"\n</code></pre>\n\n<p>I am trying to use the \"bottom\" value in my range !C1:C1). I want to be able to count the value of missing cells in a column. I tried several combinations but I couldn't find a way of making it work. \nFor example if bottom is 10, I want it to count the missing values in column 1 up to row 10.</p>\n"}, {"tags": ["css", "excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1518628138, "creation_date": 1518628138, "answer_id": 48792688, "question_id": 48791790, "link": "https://stackoverflow.com/questions/48791790/cells-alignment-in-a-vba-created-html-outlook-message/48792688#48792688", "title": "Cells alignment in a vba created html outlook message", "body": "<p>Add this to your style (CSS)</p>\n\n<pre><code>td {text-align:right;}\n</code></pre>\n\n<p>So it would look like this:</p>\n\n<pre><code>str = str &amp; \"&lt;head&gt;&lt;style&gt;table, th, td {border: 1px solid black; border-collapse:collapse;} td {text-align:right;} &lt;/style&gt;&lt;/head&gt;&lt;body&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518628193, "creation_date": 1518625368, "last_edit_date": 1518628193, "question_id": 48791790, "link": "https://stackoverflow.com/questions/48791790/cells-alignment-in-a-vba-created-html-outlook-message", "title": "Cells alignment in a vba created html outlook message", "body": "<p>I have to generate an email every day and I have to copy excel cells to the e-mail (only two columns but many rows). I'm using this function:</p>\n\n<pre><code>str = \"&lt;table&gt;\"\nstr = str &amp; \"&lt;head&gt;&lt;style&gt;table, th, td {border: 1px solid black; border-collapse:\" &amp;  \"collapse;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\"\ngetdata = str\n</code></pre>\n\n<p>I'm generating the email in this way:</p>\n\n<pre><code>With emailpod\n    .BodyFormat = 3\n    .display\n    .To = Sheets(\"email\").Range(\"H1\").Value\n    .cc = Sheets(\"email\").Range(\"H2\").Value\n    .Subject = Sheets(\"email\").Range(\"H3\").Value &amp; Sheets(\"email\").Range(\"H6\")\n    .HTMLBody = Sheets(\"email\").Range(\"H4\") &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; Sheets(\"email\").Range(\"H5\") &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n        getdata &amp; \"&lt;br&gt;\" &amp; \"Regards\" &amp; .HTMLBody &amp; \"&lt;/body&gt;\"\n\nEnd With\n</code></pre>\n\n<p>I have borders for the cells but I also need align the cells to right inside the border. Any one knows how to do this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9256601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b18fdbf024b6ca067282b49c950f4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/9256601/guillermo"}, "edited": false, "score": 0, "creation_date": 1518626023, "post_id": 48791686, "comment_id": 84586126, "body": "It does not worked for me, I didnt get anything on the target.. I will try to modify it, thanks"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1, "user_id": 9256601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b18fdbf024b6ca067282b49c950f4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/9256601/guillermo"}, "edited": false, "score": 1, "creation_date": 1518627220, "post_id": 48791686, "comment_id": 84586969, "body": "While in VBA IDE, step through the code by pressing F8 while placing the cursor in any statement of the code. At any step you can check in the Immediate Window (CTRL-G to pop it out) the values of any relevant variable by typing <code>?not_object_variable_name</code> or <code>?object_variable_name.property</code> (e.g.: <code>ActiveWorkbook.Name</code> or the likes) and see if it fits expectation. You can also switch between VBA IDE and Excel UI to see what&#39;s happening in relevant sheets/ranges"}, {"owner": {"reputation": 1, "user_id": 9256601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b18fdbf024b6ca067282b49c950f4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/9256601/guillermo"}, "edited": false, "score": 0, "creation_date": 1518630763, "post_id": 48791686, "comment_id": 84588843, "body": "Im new in VBA, so im not able to get what I want doing this, I cant understand it.. Sorry and thanks anyway"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518625010, "creation_date": 1518625010, "answer_id": 48791686, "question_id": 48791451, "link": "https://stackoverflow.com/questions/48791451/copy-specific-cells-of-same-row-in-another-worksheet-if-text-found/48791686#48791686", "title": "Copy specific cells of same row in another worksheet if text found", "body": "<p>you could use <code>AutoFilter()</code> method of <code>Range</code> object, like follows (not tested, explanations in comments):</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim Target As Worksheet\n\n    Set Target = ActiveWorkbook.Worksheets(\"Check\")\n\n    With ActiveWorkbook.Worksheets(\"Sumas y Saldos\")\n        With .Range(\"G8:K\" &amp; .Cells(.Rows.Count, \"H\").End(xlUp).Row) 'reference its columns G:K cells from row 8 down to last not empty one in column \"H\"\n            .AutoFilter field:=2, Criteria1:=\"REVISAR\" ' filter referenced cells on 2nd column \"REVISAR\" content\n            If Application.WorksheetFunction.Subtotal(103, .Columns(2)) &gt; 0 Then .SpecialCells(xlCellTypeVisible).Copy Destination:=Target.Range(\"A8:D8\")              ' if any filtered cell then get their underlying cells\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9256601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b18fdbf024b6ca067282b49c950f4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/9256601/guillermo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518628022, "creation_date": 1518624327, "last_edit_date": 1518628022, "question_id": 48791451, "link": "https://stackoverflow.com/questions/48791451/copy-specific-cells-of-same-row-in-another-worksheet-if-text-found", "title": "Copy specific cells of same row in another worksheet if text found", "body": "<p>I need to copy specific cells of a row, to another worksheet in same bock, if determined Text appears in a \"H\" column. I\u00b4m alredy able to copy the entire column, but I\u00b4m not able to copy just the cells of the row I really want.</p>\n\n<pre><code>Dim rango As Range\nDim i As Integer\nDim Source As Worksheet\nDim Target As Worksheet\n\nSet Source = ActiveWorkbook.Worksheets(\"Sumas y Saldos\")\nSet Target = ActiveWorkbook.Worksheets(\"Check\")\n\nnfil = Source.Range(\"H9\").End(xlDown).Row\ni = 9\nFor Each rango In Source.Range(\"H8:H\" &amp; nfil)\n    If rango = \"REVISAR\" Then\n       Source.Rows(rango.Row).Copy Target.Rows(i)\n       i = i + 1\n    End If\nNext rango\n'2 second try of the code, this is what I try to do in the If to copy just that cells.\nIf rango = \"REVISAR\" Then\nSource.Rows(rango.Column).Copy Target.Column(i)\nSource.Range(\"G9:G\" &amp; nfil).Copy Destination:=Target.Range(\"A8:A\" &amp; nfil)\nSource.Range(\"H9:H\" &amp; nfil).Copy Destination:=Target.Range(\"B8:B\" &amp; nfil)\nSource.Range(\"I9:I\" &amp; nfil).Copy Destination:=Target.Range(\"C8:C\" &amp; nfil)\nSource.Range(\"J9:J\" &amp; nfil).Copy Destination:=Target.Range(\"D8:D\" &amp; nfil)\nSource.Range(\"K9:K\" &amp; nfil).Copy Destination:=Target.Range(\"E8:E\" &amp; nfil)\nSource.Rows(rango.Row).Copy Target.Rows(i)\ni = i + 1\nEnd If\n</code></pre>\n\n<p>Hope someone can help me... Thanks</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "edited": false, "score": 0, "creation_date": 1518627975, "post_id": 48792315, "comment_id": 84587435, "body": "This works perfectly. Thank you! Side question - Assuming they do add something after that last dot, how would I go about pulling that information separately until the next dot? Example: they type 1234.12.123.123456 which of course your function will convert it to 01234.00012.123 as intended, but if I need that 123456 in a separate cell how would I go about doing that (only if they add it)"}, {"owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "edited": false, "score": 0, "creation_date": 1518628796, "post_id": 48792315, "comment_id": 84587890, "body": "Sorry @CLR I editted my comment. Please assist if you can :)"}, {"owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "edited": false, "score": 0, "creation_date": 1518631794, "post_id": 48792315, "comment_id": 84589365, "body": "Looks like =IF(LEN(A2) &lt; 17, &quot;&quot;, TRIM(RIGHT(SUBSTITUTE(A2,&quot;.&quot;,REPT(&quot; &quot;,99)),99))) will work for me for my second question."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "edited": false, "score": 1, "creation_date": 1518687431, "post_id": 48792315, "comment_id": 84610518, "body": "That does work, it&#39;s certainly an interesting way of doing it too. If you want to &#39;Find&#39; the fourth section without risking mistakes - try the following: <code>=IF(LEN(A2)-LEN(SUBSTITUTE(A2,&quot;.&quot;,&quot;&quot;))&gt;=3,MID(A2,FIND(&quot;.&quot;,A2&zwnj;&#8203;,FIND(&quot;.&quot;,A2,FIND(&quot;.&zwnj;&#8203;&quot;,A2)+1)+1)+1,99),&quot;&quot;&zwnj;&#8203;)</code>"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "edited": false, "score": 0, "creation_date": 1518687469, "post_id": 48792315, "comment_id": 84610544, "body": "This method checks that there are at least 3 <code>.</code> present and then finds the 3rd and presents the next 99 characters after that."}, {"owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "edited": false, "score": 0, "creation_date": 1518702987, "post_id": 48792315, "comment_id": 84621000, "body": "Thanks! That works pretty well as well as a safeguard. Appreciate it. I&#39;ll use that instead."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1518627008, "creation_date": 1518627008, "answer_id": 48792315, "question_id": 48791377, "link": "https://stackoverflow.com/questions/48791377/split-cell-with-specific-formatting/48792315#48792315", "title": "Split cell with specific formatting", "body": "<p>I think the following would give you what you need. </p>\n\n<pre><code>=TEXT(LEFT(A2,FIND(\".\",A2)-1),\"00000\")&amp;\".\"&amp;TEXT(MID(A2,FIND(\".\",A2)+1,FIND(\".\",A2,FIND(\".\",A2)+1)-FIND(\".\",A2)-1),\"000000\")&amp;\".\"&amp;TEXT(MID(A2,FIND(\".\",A2,FIND(\".\",A2)+1)+1,3),\"000\")\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 48792315, "answer_count": 1, "score": 0, "last_activity_date": 1518627008, "creation_date": 1518624092, "last_edit_date": 1531161705, "question_id": 48791377, "link": "https://stackoverflow.com/questions/48791377/split-cell-with-specific-formatting", "title": "Split cell with specific formatting", "body": "<p>I am trying to find and split an input in cell A2, and it needs to output in a specific format up to 3 digits after the second period and not outputting anything after if it finds a 3rd period.</p>\n\n<p>I'm currently using:</p>\n\n<pre><code>=IF(A2=\"\",\"\",TEXT(LEFT(A2,SEARCH(\".\",A2,1)-1),\"00000\")&amp;\".\"&amp;TEXT(MID(A2,SEARCH(\".\",A2)+1,SEARCH(\".\",A2,SEARCH(\".\",A2)+1)-SEARCH(\".\",A2)-1),\"000000\")&amp;\".\"&amp;TEXT(RIGHT(A2,LEN(A2)-SEARCH(\".\",A2,SEARCH(\".\",A2)+1)),\"000\"))\n</code></pre>\n\n<p>however this pulls ALL data after the 2nd period. As you can see from the formula I need the first numbers to output in 5 digits, the next numbers after the first period output in 6 digits, and the ones after the 2nd should output in 3 digits</p>\n\n<p>In short the output SHOULD look like 00000.000000.000 even if someone puts 0.0.0.0.0.0.0.0; HOWEVER, it's currently capturing everything after the 2nd period so in reality it actually looks like 00000.000000.0.0.0.0.0.0 </p>\n\n<p>Is there anything I can add to make it cut off the output once it reaches a third period? I would use a regular split function, but when people are inputting data sometimes they put 0000.000000.000.0.0.0.0.0 sometimes they put 00000.000000.000.0.0.0.0 sometimes they put 0000.000000.000. many different combinations, but the separation point is always the period and the end result always needs to be 5digits.6digits.3digits</p>\n\n<p>Let me know if I need to clarify any further.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1518627913, "post_id": 48791265, "comment_id": 84587395, "body": "Just unpivot the above data using the following explanation: <a href=\"https://wessexbi.wordpress.com/2014/02/27/unpivot-nested-headings-with-power-query/\" rel=\"nofollow noreferrer\">wessexbi.wordpress.com/2014/02/27/&hellip;</a> Afterwards, you can use the raw data whichever way you want to (including your suggested pivot table reports). Here is a somewhat related / similar solution I posted not too long ago: <a href=\"https://stackoverflow.com/questions/47283811/combining-different-fees-columns-to-create-pivottable-income-statement/47286415#47286415\" title=\"combining different fees columns to create pivottable income statement\">stackoverflow.com/questions/47283811/&hellip;</a> Still, let me know if you have any questions."}], "answers": [{"tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": true, "score": 2, "last_activity_date": 1518633056, "last_edit_date": 1518633056, "creation_date": 1518631950, "answer_id": 48793691, "question_id": 48791265, "link": "https://stackoverflow.com/questions/48791265/displaying-rows-based-on-column-label-in-excel-for-a-pivot-table/48793691#48793691", "title": "Displaying rows based on column label in Excel for a Pivot Table", "body": "<p>You can use <strong>Power Query</strong> Excel 2010+ you can download and activate easily or by default in 2016 version. There you can keep this format for your users and a pivot table for control.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gYC9M.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gYC9M.gif\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 151, "user_id": 4296134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab308e6d29318f35213e217e8429c333?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/4296134/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 48793691, "answer_count": 1, "score": -1, "last_activity_date": 1518633056, "creation_date": 1518623730, "question_id": 48791265, "link": "https://stackoverflow.com/questions/48791265/displaying-rows-based-on-column-label-in-excel-for-a-pivot-table", "title": "Displaying rows based on column label in Excel for a Pivot Table", "body": "<p>I'm facing the following problem. I have a very large excel sheet in the format attached as a picture. For reasons beyond my control the basic formatting of this sheet needs to be maintained as people with no skill want to be able to edit this. </p>\n\n<p>However, I need to work with the content and as it is quite large, it is really unreadable. So what I wanted to do is to be able to find the tasks belonging to different departments and the different people. My approach was to create two  pivot tables where I want a dropdown list with either the department or the person to be able to filter on the tasks that that belong to each of them. I have found how to filter on a dropdown menu, however this is for column entries. What I want to do is to filter on the column labels and then display the tasks for which the column I selected is non empty.</p>\n\n<p>I need some help on the direction in which I need to search for the answer to this problem as I'm currently lost in solutions that have nothing to do with this problem. </p>\n\n<p>Thanks in advance</p>\n\n<p><a href=\"https://i.stack.imgur.com/wfoRb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wfoRb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 1, "creation_date": 1518623636, "post_id": 48791063, "comment_id": 84584384, "body": "&quot;Somehow it is not working&quot;. Maybe share those details?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518628321, "post_id": 48791063, "comment_id": 84587643, "body": "what are those <code>Worksheet_activated</code> and <code>Worksheet_activated</code> subs? They sound like <code>Worksheet_Activate</code> and <code>Worksheet_Deactivate</code> event handler..."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1518629281, "post_id": 48791063, "comment_id": 84588126, "body": "This post may give some pointers:  <a href=\"https://stackoverflow.com/questions/11153995/is-there-any-event-that-fires-when-keys-are-pressed-when-editing-a-cell\">is-there-any-event-that-fires-when-keys-are-pressed-when-edi&zwnj;&#8203;ting-a-cell</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9360853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Francoise Eric", "link": "https://stackoverflow.com/users/9360853/francoise-eric"}, "edited": false, "score": 0, "creation_date": 1518690708, "post_id": 48801566, "comment_id": 84612768, "body": "i dont understand what does the &quot;.Me Codename&quot; does? it appears to me that it doesnt make any difference(after running it)? well i think my qustion is how to write the specific code that count the times of the event, i didnt manage to write it, so i am looking for help on that..."}, {"owner": {"reputation": 1, "user_id": 9360853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Francoise Eric", "link": "https://stackoverflow.com/users/9360853/francoise-eric"}, "edited": false, "score": 0, "creation_date": 1518690708, "post_id": 48801566, "comment_id": 84612769, "body": "i dont understand what does the &quot;.Me Codename&quot; does? it appears to me that it doesnt make any difference(after running it)? well i think my qustion is how to write the specific code that count the times of the event, i didnt manage to write it, so i am looking for help on that..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 9360853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Francoise Eric", "link": "https://stackoverflow.com/users/9360853/francoise-eric"}, "edited": false, "score": 0, "creation_date": 1518709561, "post_id": 48801566, "comment_id": 84625556, "body": "CodeName is just so that Excel can locate the CountDT sub (since it&#39;s in the sheet module not in a regular module).  Where do you want to put the count of key presses?"}, {"owner": {"reputation": 1, "user_id": 9360853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Francoise Eric", "link": "https://stackoverflow.com/users/9360853/francoise-eric"}, "edited": false, "score": 0, "creation_date": 1518718258, "post_id": 48801566, "comment_id": 84631006, "body": "yeah you are right! whatever works i guess! because i seem to need to use a loop ? i dont know if i should try writing on the sheet or the module....my idea was to tried to count the event but it was obviously wrong. sorry i am a beginner"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1518678193, "creation_date": 1518678193, "answer_id": 48801566, "question_id": 48791063, "link": "https://stackoverflow.com/questions/48791063/count-and-record-number-of-times-i-press-the-enter-key/48801566#48801566", "title": "count and record number of times i press the enter key", "body": "<p>In the worksheet code module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Activate()\n    Application.OnKey \"~\", Me.CodeName &amp; \".CountDT\"\nEnd Sub\n\nPrivate Sub Worksheet_Deactivate()\n   Application.OnKey \"~\"\nEnd Sub\n\n\nSub CountDT()\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.Value = ActiveCell.Value &amp; \" \" &amp; Date &amp; \" \" &amp; Time\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9360853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Francoise Eric", "link": "https://stackoverflow.com/users/9360853/francoise-eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593675403, "creation_date": 1518623110, "last_edit_date": 1593675403, "question_id": 48791063, "link": "https://stackoverflow.com/questions/48791063/count-and-record-number-of-times-i-press-the-enter-key", "title": "count and record number of times i press the enter key", "body": "<p>i want to create a sub that records in a list how many times you pressed the return key in the current session (it should write on a new line each time you reopen the file)\nheres are my attempts:\nsomehow it's not working</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_activated(ByVal target As Range)\n  Target.Value = target.Value + 1\n  Application.OnKey \"~\", \"CountDT\"\nEnd Sub\n\nPrivate Sub worksheet_deactivated()\n   Application.OnKey \"~\"\nEnd Sub\n\nOption Explicit\nSub CountDT()\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.Value = ActiveCell.Value &amp; \" \" &amp; Date &amp; \" \" &amp; Time\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "logic"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1518622982, "post_id": 48790948, "comment_id": 84583937, "body": "You would have cleaner code if you used a <code>Select Case</code> instead."}, {"owner": {"reputation": 11645, "user_id": 766911, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28bfb2b67070309ba998d4a355d66593?s=128&d=identicon&r=PG", "display_name": "gdbj", "link": "https://stackoverflow.com/users/766911/gdbj"}, "edited": false, "score": 0, "creation_date": 1518623010, "post_id": 48790948, "comment_id": 84583961, "body": "what are bpmm and bphg for the test?  Ideally, you would be passing those values in as parameters to your method.  The code looks fine at first glance.  If the logic is stopping, it&#39;s due to the values of these global vars."}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518623076, "post_id": 48790948, "comment_id": 84584000, "body": "bpmm and bphg are text boxes the user completes"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518623150, "post_id": 48790948, "comment_id": 84584039, "body": "Code works fine for me. What about the code you&#39;re not showing us? IMO <code>If...ElseIf...</code> is fine"}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518623472, "post_id": 48790948, "comment_id": 84584276, "body": "that was the whole sub other than the form."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518623615, "post_id": 48790948, "comment_id": 84584367, "body": "the form? so where is <code>bpcomment</code> declared and where are you getting the values of <code>bpmm</code> and <code>bphg</code> from?"}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518623770, "post_id": 48790948, "comment_id": 84584458, "body": "ok so, bpcomment is a text box that will show the outcome if you like. bpmm and bphg are the blood pressure values the tech enters and after tabbing off bphg the bpcomment updates. i hope that make sense."}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518624110, "post_id": 48790948, "comment_id": 84584687, "body": "when the code runs, the if statement would go with the first right answer it found and then display the result and finish, without checking the rest of the options."}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518624248, "post_id": 48790948, "comment_id": 84584798, "body": "so basically with blood pressure, out of the 2 figures your doctor gives you, either can determine if your bp is ok or not. so when we enter a bp into the form say 200/80(you would prob never get this but im being through) it would find that the first figure is high and the second is normal.my script however is finding the second figure being normal first without checking the rest of the option for the first figure, so it just displays &quot;normal&quot; when in fact its high"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518624828, "post_id": 48790948, "comment_id": 84585237, "body": "Use AND instead of OR. With AND both criteria must be met. With OR only one needs to be true for the IF to evaluate as true."}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518625177, "post_id": 48790948, "comment_id": 84585502, "body": "the &quot;and&quot; instead of &quot;or&quot; seems to have fixed it.Thank you."}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518625258, "post_id": 48790948, "comment_id": 84585552, "body": "thank you all for your comments and help. i come here a lot looking for advise and you all seem very helpful to everybody. thank you all again."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518623849, "post_id": 48791047, "comment_id": 84584507, "body": "@JamesFenwick - just make sure that you order the conditions correctly - if the first condition is TRUE, the check does not go further."}, {"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518624664, "post_id": 48791047, "comment_id": 84585118, "body": "so i have tried this out and added the rest in and its still giving me the same issue. test values are bpmm = 240 and bphg = 80. its finds the 80 displays the answer and then ends."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1518625155, "last_edit_date": 1518625155, "creation_date": 1518623058, "answer_id": 48791047, "question_id": 48790948, "link": "https://stackoverflow.com/questions/48790948/elseif-statement-skipped-when-it-shouldnt-be-with-or/48791047#48791047", "title": "ElseIf statement skipped when it shouldn&#39;t be with &quot;or&quot;", "body": "<p><code>Select Case</code> would be a better way to deal with the blood pressure issues:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim bpmm        As Long\n    Dim bphg        As Long\n\n    bpmm = 100   'assign these two somehow. E.g.-&gt; bpmm = ActiveSheet.Range(\"A1\")\n    bphg = 100\n\n    Select Case True\n        Case bpmm &lt;= 100 Or bphg &lt;= 60\n            Debug.Print \"LOW! - Seek Advice\"\n        Case bpmm &lt; 140 Or bphg &lt; 90\n            Debug.Print \"Normal BP\"\n        Case bpmm &lt; 180 Or bphg &lt; 100\n            Debug.Print \"High!\"\n        Case Else\n            Debug.Print \"URGENT! - Review required\"\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>Instead of <code>Debug.Print</code>, you may put your business logic there. Just make sure that you order the conditions correctly - if the first condition is evaluated to <code>TRUE</code>, the check does not go further. </p>\n\n<p>There is a tiny performance advantage of <code>Select Case</code> - <a href=\"https://stackoverflow.com/questions/11640413/which-way-is-faster-if-elseif-or-select-case\">Which way is faster? If elseif or select case</a></p>\n\n<p><strong>Edit:</strong> If your logic is, that all the criteria should be checked separately and independently, then take a look at this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim bpmm        As Long\n    Dim bphg        As Long\n\n    bpmm = 100   'assign these two somehow. E.g.-&gt; bpmm = ActiveSheet.Range(\"A1\")\n    bphg = 100\n\n    If bpmm &lt;= 100 Or bphg &lt;= 60 Then\n        Debug.Print \"LOW! - Seek Advice\"\n    End If\n    If bpmm &lt; 140 Or bphg &lt; 90 Then\n        Debug.Print \"Normal BP\"\n    End If\n    If bpmm &lt; 180 Or bphg &lt; 100 Then\n        Debug.Print \"High!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "edited": false, "score": 0, "creation_date": 1518626137, "post_id": 48791811, "comment_id": 84586195, "body": "thank you, kinda makes sense actually, will test it out."}], "tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518625445, "creation_date": 1518625445, "answer_id": 48791811, "question_id": 48790948, "link": "https://stackoverflow.com/questions/48790948/elseif-statement-skipped-when-it-shouldnt-be-with-or/48791811#48791811", "title": "ElseIf statement skipped when it shouldn&#39;t be with &quot;or&quot;", "body": "<p>From your description, it looks like you want to return the result of the highest one of the two criteria. In this case, you will need to reverse the order of the checks:</p>\n\n<pre><code>If bpmm &gt;= 230 Or bphg &gt;= 120 Then\n    bpcomment.Value = \"URGENT! - Review required\"\nElseIf bpmm &gt;= 200 Then\n    bpcomment.Value = \"High! - To high for Spiro &amp; Temp Driving Resitricion MPE/FLT\"\nElseIf bpmm &gt;= 180 Or bphg &gt;= 100 Then\n    bpcomment.Value = \"High! - Temp restriction to driving MPE/FLT\"\nElseIf bpmm &gt;= 140 Or bphg &gt;= 90 Then\n    bpcomment.Value = \"High! - GP Review\"\nElseIf bpmm &gt;= 120 Or bphg &gt;= 70 Then\n    bpcomment.Value = \"Normal BP\"\nElse\n    bpcomment.Value = \"LOW! - Seek Advice\"\nEnd If\n</code></pre>\n\n<p>However, it's not clear from the instructions (that you have at the top of your function) what to do in the case it is between 100/60 and 120/70. The code above considers it LOW. If you want to consider it NORMAL instead, then change the last <code>ElseIf</code> from:</p>\n\n<pre><code>ElseIf bpmm &gt;= 120 Or bphg &gt;= 70 Then\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>ElseIf bpmm &gt;= 100 Or bphg &gt;= 60 Then\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9360834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WhJq27FkUhE/AAAAAAAAAAI/AAAAAAAAAAA/sJGlOqcc89c/photo.jpg?sz=128", "display_name": "James Fenwick", "link": "https://stackoverflow.com/users/9360834/james-fenwick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1518625764, "creation_date": 1518622766, "last_edit_date": 1518625764, "question_id": 48790948, "link": "https://stackoverflow.com/questions/48790948/elseif-statement-skipped-when-it-shouldnt-be-with-or", "title": "ElseIf statement skipped when it shouldn&#39;t be with &quot;or&quot;", "body": "<p>I'm building a little program to help out with some data imports and for our techs when out on sites.</p>\n\n<p>The bit I'm struggling with is the bp check, see code below:</p>\n\n<pre><code>Private Sub bphg_afterupdate()\n\n'blood pressure values\n'below 100/60 - low\n'120/70 - normal\n'140/90 - high, gp review\n'180/100 - high, cut off for fitness for driving\n'200/100 - high, cut off for driving/spiro\n'230/120 - urgent review required\n\n\n    If bpmm &lt;= 100 Or bphg &lt;= 60 Then\n        bpcomment.Value = \"LOW! - Seek Advice\"\n    ElseIf bpmm &lt; 140 Or bphg &lt; 90 Then\n        bpcomment.Value = \"Normal BP\"\n    ElseIf bpmm &lt; 180 Or bphg &lt; 100 Then\n        bpcomment.Value = \"High! - GP Review\"\n    ElseIf bpmm &lt; 200 Then\n        bpcomment.Value = \"High! - Temp restriction to driving MPE/FLT\"\n    ElseIf bpmm &lt; 230 Or bphg &lt; 120 Then\n        bpcomment.Value = \"High! - To high for Spiro &amp; Temp Driving Resitricion MPE/FLT\"\n    Else\n        bpcomment.Value = \"URGENT! - Review required\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>What it's doing is finding the first value that fits in either the values specified and then stopping. It should be continuing to check other criteria.</p>\n\n<p>So basically with blood pressure, out of the 2 figures your doctor gives you, either can determine if your bp is ok or not. So when we enter a bp into the form say 200/80 (you would probably never get this but I'm being through), it would find that the first figure is high and the second is normal. My script however is finding the second figure being normal first without checking the first figure, so it just displays \"normal\" when in fact it's \"high\".</p>\n"}, {"tags": ["excel", "vba", "credentials", "winhttprequest"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518678515, "post_id": 48790551, "comment_id": 84605810, "body": "That should already be using the user&#39;s credentials?  You should use <code>False</code> as the last argument to <code>Open</code> though, or your code will not wait for a response.  And use HEAD not GET since you only need to know if there&#39;s an image there or not - no need to download it for that."}, {"owner": {"reputation": 13, "user_id": 4022362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447f8aeaa96a353837f313b073ce39e1?s=128&d=identicon&r=PG&f=1", "display_name": "Kev Williams", "link": "https://stackoverflow.com/users/4022362/kev-williams"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518684784, "post_id": 48790551, "comment_id": 84609000, "body": "Thanks Tim. I made the changes you suggested but I&#39;m still getting the same problem. I think it may be an Active Directory issue rather than an excel one. The sheet pulls in the AwaitingImage.jpg which is in the same directory as the images I want but the ResponseStatus variable is always &quot;Unauthorized&quot;. Thanks for your help. I&#39;ll do some more investigating."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518709613, "post_id": 48790551, "comment_id": 84625586, "body": "Maybe try xmlhttp instead of Winhttp."}], "owner": {"reputation": 13, "user_id": 4022362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447f8aeaa96a353837f313b073ce39e1?s=128&d=identicon&r=PG&f=1", "display_name": "Kev Williams", "link": "https://stackoverflow.com/users/4022362/kev-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518621654, "creation_date": 1518621558, "last_edit_date": 1518621654, "question_id": 48790551, "link": "https://stackoverflow.com/questions/48790551/winhttprequest-using-users-own-activedirectory-credentials", "title": "WinHttpRequest using users own ActiveDirectory credentials", "body": "<p>I'm using the following code to grab an image (of a part held on a SharePoint site) to display in an excel sheet. I'd like to use the user's own Active Directory credentials to access the url. The code I've got so far is:</p>\n\n<pre><code>Dim Request As Object\nDim ResponseStatus As Variant\nDim ImgURL As String\nImgURL = \"https://someValidURL/\" &amp; ExtraPartNo &amp; \".jpg\"\n\n    Set Request = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\n    With Request\n        .Open \"GET\", ImgURL, True\n        .Send\n        .WaitForResponse\n        ResponseStatus = .StatusText\n    End With\n    Set Request = Nothing\n\n    If ResponseStatus = \"OK\" Then\n        ImgURL = \"https://someValidURL/\" &amp; ExrtaPartNo &amp; \".jpg\"\n    Else\n        SetterImgURL = \"https://someValidURL/AwaitingImage.jpg\"\n    End If\n</code></pre>\n\n<p>The idea is to display an image of a part if it exists but if it doesn't then display the AwaitingImage.jpg</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518621753, "post_id": 48790546, "comment_id": 84583164, "body": "Has code indentation become uncool?"}, {"owner": {"reputation": 1255, "user_id": 4842504, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/db303b8e370d567c99d98aa8151455d9?s=128&d=identicon&r=PG", "display_name": "Sirmyself", "link": "https://stackoverflow.com/users/4842504/sirmyself"}, "edited": false, "score": 0, "creation_date": 1518621880, "post_id": 48790546, "comment_id": 84583256, "body": "by &quot;row&quot; do you mean columns? in excel, rows are numbers and columns are letters"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518622085, "post_id": 48790678, "comment_id": 84583381, "body": "I think the Cells(i, 4).Copy and Cells(i, 5).Copy lines were wrong to begin with."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1518622249, "post_id": 48790678, "comment_id": 84583477, "body": "@Jeeped, probably, but as this is a follow up question to a previously answered one, I thought I would continue the OPs vernacular and simply show him how to copy range A to E for that specific row, I&#39;m sure the other two Cells(i, 4) &amp; 5 can easily be amended if he lets us know which columns contain the desired data..."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1518623197, "post_id": 48790678, "comment_id": 84584079, "body": "@Jeeped, of course you are right, I&#39;ve amended my answer to reflect your comment.. :)"}, {"owner": {"reputation": 5, "user_id": 9350959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b328bf58bbe6b7eaea120291372fbf7?s=128&d=identicon&r=PG&f=1", "display_name": "Numb3ers", "link": "https://stackoverflow.com/users/9350959/numb3ers"}, "edited": false, "score": 0, "creation_date": 1518623700, "post_id": 48790678, "comment_id": 84584416, "body": "This code is still only copying over the first 2 columns"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 9350959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b328bf58bbe6b7eaea120291372fbf7?s=128&d=identicon&r=PG&f=1", "display_name": "Numb3ers", "link": "https://stackoverflow.com/users/9350959/numb3ers"}, "edited": false, "score": 1, "creation_date": 1518623906, "post_id": 48790678, "comment_id": 84584550, "body": "@Numb3ers it should be copying the Cells from A:E on the row which had &quot;FLAG&quot; on column 8 (H). As the line <code>ws.Range(&quot;A&quot; &amp; i &amp; &quot;:E&quot; &amp; i).Copy</code> suggests."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1518623195, "last_edit_date": 1518623195, "creation_date": 1518621966, "answer_id": 48790678, "question_id": 48790546, "link": "https://stackoverflow.com/questions/48790546/find-a-specific-word-in-a-cell-and-copy-the-rows-next-to-it-to-another-worksheet/48790678#48790678", "title": "Find a specific word in a cell and copy the rows next to it to another worksheet", "body": "<p>If you want to alter the copying from A to C to A to E, then this will do that:</p>\n\n<pre><code>Sub foo()\n\nDim ws As Worksheet: Set ws = Sheets(\"Duration\")\nDim wsResult As Worksheet: Set wsResult = Sheets(\"Report\")\n\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nFor i = 3 To LastRow\n        If ws.Cells(i, 8) = \"FLAG\" Then\n            NextFreeRow = wsResult.Cells(wsResult.Rows.Count, \"A\").End(xlUp).Row + 1\n            ws.Range(\"A\" &amp; i &amp; \":E\" &amp; i).Copy Destination:=wsResult.Range(\"A\" &amp; NextFreeRow)\n            'the code below will have to be amended if you changed your table's layout and you also want some other cells copied as well as A to E\n            'ws.Cells(i, 4).Copy\n            'wsResult.Cells(NextFreeRow, 6).PasteSpecial xlPasteAll\n            'ws.Cells(i, 5).Copy\n            'wsResult.Cells(NextFreeRow, 7).PasteSpecial xlPasteAll\n        End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519224410, "post_id": 48793207, "comment_id": 84823434, "body": "@Numb3ers, any feedback?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518630034, "creation_date": 1518630034, "answer_id": 48793207, "question_id": 48790546, "link": "https://stackoverflow.com/questions/48790546/find-a-specific-word-in-a-cell-and-copy-the-rows-next-to-it-to-another-worksheet/48793207#48793207", "title": "Find a specific word in a cell and copy the rows next to it to another worksheet", "body": "<p>if you have to copy worksheet \"Duration\" columns A-E rows whose corresponding column H cell value is \"Flag\" and paste them to worksheet \"Report\" columns A-E starting form last not empty cell in column A, then go like this (explanations in comments):</p>\n\n<pre><code>Option Explicit\n\nSub foo()\n    Dim wsResult As Worksheet: Set wsResult = Sheets(\"Report\")\n\n    With Worksheets(\"Duration\")\n        With .Range(\"A2:H\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row) 'reference its columns A:H cells from row 2 (header) down to last not empty one in column \"A\"\n            .AutoFilter field:=8, Criteria1:=\"FLAG\" ' filter referenced cells on 8thd column \"FLAG\" content\n            If Application.WorksheetFunction.Subtotal(103, .Columns(8)) &gt; 1 Then .Offset(1).Resize(.Rows.Count - 1, 5).SpecialCells(xlCellTypeVisible).Copy Destination:=wsResult.Cells(wsResult.Rows.Count, \"A\").End(xlUp).Offset(1) ' if any filtered cell other than the header then copy their first five columns and paste to 'wsResult' sheet starting from its column A last not empty cell\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9350959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b328bf58bbe6b7eaea120291372fbf7?s=128&d=identicon&r=PG&f=1", "display_name": "Numb3ers", "link": "https://stackoverflow.com/users/9350959/numb3ers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518630034, "creation_date": 1518621536, "last_edit_date": 1518622446, "question_id": 48790546, "link": "https://stackoverflow.com/questions/48790546/find-a-specific-word-in-a-cell-and-copy-the-rows-next-to-it-to-another-worksheet", "title": "Find a specific word in a cell and copy the rows next to it to another worksheet", "body": "<p>I would like to copy rows A-E whenever the word FLAG is found in row H and I want to skip all rows where Flag is not found. Below is  example of the table I am working with and what I would want my result table to look like. </p>\n\n<p>This is the code I have, however it is not copying the rows A-E that have Flag it is just copying the first three rows to the new sheet. </p>\n\n<pre><code>Sub foo()\n    Dim ws As Worksheet: Set ws = Sheets(\"Duration\")\n    Dim wsResult As Worksheet: Set wsResult = Sheets(\"Report\")\n\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n    For i = 3 To LastRow \n        For x = 8 To 8 \n            If ws.Cells(i, x) = \"FLAG\" Then \n                NextFreeRow = wsResult.Cells(wsResult.Rows.Count, \"A\").End(xlUp).Row + 1\n                ws.Range(\"A\" &amp; i &amp; \":C\" &amp; i).Copy  \n                wsResult.Range(\"A\" &amp; NextFreeRow).PasteSpecial xlPasteAll \n                ws.Cells(i, x - 4).Copy \n                wsResult.Cells(NextFreeRow, 4).PasteSpecial xlPasteAll\n                ws.Cells(i,x-3).Copy\n                wsResult.Cells(NextFreeRow, 5).PasteSpecial xlPasteAll\n            End If\n        Next x\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated! </p>\n"}, {"tags": ["excel", "speech", "vba"], "comments": [{"owner": {"reputation": 1143, "user_id": 8759952, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d8e784fa5cd3e5a2dfe13b405fc1de1?s=128&d=identicon&r=PG&f=1", "display_name": "Liora Haydont", "link": "https://stackoverflow.com/users/8759952/liora-haydont"}, "edited": false, "score": 2, "creation_date": 1518621261, "post_id": 48790329, "comment_id": 84582817, "body": "What happends if you create you string in a variable and then use it ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518621660, "post_id": 48790329, "comment_id": 84583098, "body": "This looks like an odd bug, all 3 should be the same result. Try <code>Application.Speech.Speak CStr(&quot;It is &quot; &amp; &quot;11&quot; &amp; &quot; hours and &quot; &amp; &quot;11&quot; &amp; &quot; minutes&quot;)</code>"}, {"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518623631, "post_id": 48790329, "comment_id": 84584376, "body": "@P\u1d07\u029c It says the same: &quot;ONE ONE&quot; hours and &quot;eleven&quot; minutes"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518624297, "post_id": 48790329, "comment_id": 84584848, "body": "@LuizVaughan That&#39;s very strange, I cannot do any further tests because my voice is german and does it correctly. What about if you write it in a variable first <code>MyText = &quot;It is &quot; &amp; &quot;11&quot; &amp; &quot; hours and &quot; &amp; &quot;11&quot; &amp; &quot; minutes&quot;</code> and then <code>Application.Speech.Speak MyText</code>? Which local (language) version of Office and Windows are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518623740, "post_id": 48790950, "comment_id": 84584437, "body": "If the OP says the output of <code>Application.Speech.Speak &quot;It is &quot; &amp; &quot;11&quot; &amp; &quot; hours and &quot; &amp; &quot;11&quot; &amp; &quot; minutes&quot;</code> is &quot;<i>ONE ONE hours and ELEVEN minutes</i>&quot; this answer doesn&#39;t help, right? What you say sounds logic and we would expect exactly this (and is exactly what my german voice does). But completely contrary to the effect that the OP described."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518624353, "post_id": 48790950, "comment_id": 84584882, "body": "@P\u1d07\u029c  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518624425, "post_id": 48790950, "comment_id": 84584939, "body": "just for my personal interest did you get the same odd effect of the OP if you speak it directly without concatenating via variable first?"}, {"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 0, "creation_date": 1518625169, "post_id": 48790950, "comment_id": 84585491, "body": "@Gary&#39;s-Student Your answer didn&#180;t work as expected in the Portuguese idiom. In English, it works fine. However, you gave me some insight and I thank you for your time to evaluate this problem."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 0, "creation_date": 1518625351, "post_id": 48790950, "comment_id": 84585622, "body": "@LuizVaughan  Thank YOU for the question!  I did not consider <i>Locale</i> effects on the code."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1518687636, "post_id": 48790950, "comment_id": 84610632, "body": "@Gary&#39;sStudent Just as a contribution to the <code>Speech.Speak</code> issue: my approach via <b><code>SpeakXML</code> argument</b> seems to override the problem :-)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1518695443, "post_id": 48790950, "comment_id": 84615799, "body": "@T.M.  I will try it today"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 5, "last_activity_date": 1518624328, "last_edit_date": 1518624328, "creation_date": 1518622772, "answer_id": 48790950, "question_id": 48790329, "link": "https://stackoverflow.com/questions/48790329/why-does-application-speech-speak-read-some-numbers-individually-rather-than-put/48790950#48790950", "title": "Why does Application.Speech.Speak read some numbers individually rather than put them together?", "body": "<p>You need to create/modify the string to produce the results you want.</p>\n\n<pre><code>Sub dural()\n    Application.Speech.Speak \"11\"\n    Application.Speech.Speak \"eleven\"\nEnd Sub\n</code></pre>\n\n<p>will repeat the same thing.</p>\n\n<pre><code>Sub dural()\n    Application.Speech.Speak \"1 1\"\n    Application.Speech.Speak \"one one\"\nEnd Sub\n</code></pre>\n\n<p>will do the same.  Once you have decided what you want the computer to say, you can format/re-format the string to produce that result.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>On my computer this:</p>\n\n<pre><code>Sub dmral()\n    Dim s As String\n    s = \"It is \" &amp; \"11\" &amp; \" hours and \" &amp; \"11\" &amp; \" minutes\"\n    MsgBox s\n    Application.Speech.Speak s\nEnd Sub\n</code></pre>\n\n<p>also works as expected.</p>\n\n<p>It looks like the concatenation needs to be performed first.</p>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537474515, "post_id": 48791412, "comment_id": 91808983, "body": "Any links or further information on using the <code>SpeakXML</code> setting?  (Are there other tags?)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1537475399, "post_id": 48791412, "comment_id": 91809354, "body": "actually I found what I needed <a href=\"https://docs.microsoft.com/previous-versions/windows/desktop/ms717077(v=vs.85)\" rel=\"nofollow noreferrer\"><b>here</b></a> ... I didn&#39;t realize the built in TTS was so flexible..."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537521399, "post_id": 48791412, "comment_id": 91823629, "body": "@ashleedawg - as it&#39;s not so easy to find something about the MS Speech API this SO link might interest you, too <a href=\"https://stackoverflow.com/questions/46285454/vba-save-sapi-speech-to-a-given-file-tye\">Save SAPI speech to a given file type</a> - <i>BTW Always appreciate your outstanding helpful hints and answers :-)</i>"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1518624174, "creation_date": 1518624174, "answer_id": 48791412, "question_id": 48790329, "link": "https://stackoverflow.com/questions/48790329/why-does-application-speech-speak-read-some-numbers-individually-rather-than-put/48791412#48791412", "title": "Why does Application.Speech.Speak read some numbers individually rather than put them together?", "body": "<p><strong>Approach via SpeakXML argument</strong></p>\n\n<p><strong>Syntax</strong></p>\n\n<blockquote>\n  <p><code>.Speak</code>(Text, SpeakAsync, <strong>SpeakXML</strong>, Purge)</p>\n</blockquote>\n\n<p>If you set the 3rd argument <code>SpeakXML</code> to <em>True</em>, you can use XML tags in your text string.</p>\n\n<p>The XML <code>&lt;spell&gt;</code> tag forces the voice to spell out all text, rather than using its default word and sentence breaking rules. All characters should be expanded to corresponding words (including punctuation, numbers, and so forth).\nNote that the <code>&lt;spell&gt;</code> tag mustn't be empty and don't forget the closing tag <code>&lt;/spell&gt;</code>.</p>\n\n<p>Try to use the following with both variants of <code>11</code>:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub TEST()\n  Application.Speech.Speak \"It is \" &amp; \"&lt;spell&gt;11&lt;/spell&gt;\" &amp; \" hours and \" &amp; \"11\" &amp; \" minutes\", False, SpeakXML:=True\nEnd Sub\n</code></pre>\n\n<p><strong>Note/caveat</strong></p>\n\n<p>I'm using a central European language Version and your example did'nt speak out ONE ONE in my case, so maybe there is another local setting issue.</p>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1518625797, "post_id": 48791787, "comment_id": 84585966, "body": "I would be personally interested if you could try my approach via <code>SpeakXML</code> argument and if it showed 2 different spellings. BTW I mentioned a possible local settings issue, too."}, {"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1518626467, "post_id": 48791787, "comment_id": 84586396, "body": "@T.M. As you anticipated, by using the via SpeakXML approach, the words are spelled differently. Firstly &quot;ONE ONE&quot; and then &quot;ELEVEN&quot;."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1518626722, "post_id": 48791787, "comment_id": 84586579, "body": "Appreciate your fast reply as it confirms my alternative approach."}], "tags": [], "owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "is_accepted": false, "score": 1, "last_activity_date": 1518625362, "creation_date": 1518625362, "answer_id": 48791787, "question_id": 48790329, "link": "https://stackoverflow.com/questions/48790329/why-does-application-speech-speak-read-some-numbers-individually-rather-than-put/48791787#48791787", "title": "Why does Application.Speech.Speak read some numbers individually rather than put them together?", "body": "<p>The Portuguese language has some interesting pronunciation challenges. We have, among other, the nasal \"-\u00e3o\" termination for words as in S\u00e3o Paulo. The -\u00e3o is pronounced almost like the -ow in \"sow\" and it means that while you pronounce the vowels, the air should come out partly from your nose. That being said ...</p>\n\n<p><code>Application.Speech.Speak \"J\u00e1 s\u00e3o\" &amp; Hour(Now()) &amp; \"horas e 11 minutos\"</code> --> reads \"It is ONE ONE hours and ELEVEN minutes\"</p>\n\n<p><code>Application.Speech.Speak \"11\"</code> --> reads \"ELEVEN\"</p>\n\n<p><code>Application.Speech.Speak \"J\u00e1 s\u00e3o\" &amp; \"11\" &amp; \"horas\"</code> --> reads \"It is ONE ONE hours\"</p>\n\n<p><code>Application.Speech.Speak \"J\u00e1 sao\" &amp; Hour(Now())</code> --> reads \"It is ELEVEN hours\". Notice that the nasal -\"\u00e3o\" was removed in this case. So, the number pronunciation is in words</p>\n\n<p><code>Application.Speech.Speak \"J\u00e1 s\u00e3o^\" &amp; Hour(Now())</code> --> reads \"It is ELEVEN hours\". Notice that the nasal -\"\u00e3o\" is now present and also there is a \"^\" sign positioned just afterwards </p>\n\n<p><em>I don\u00b4t know why Excel behaves like that.</em> But, <strong>problem solved</strong> :) </p>\n"}], "owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 1, "accepted_answer_id": 48790950, "answer_count": 3, "score": 4, "last_activity_date": 1532575058, "creation_date": 1518620857, "last_edit_date": 1531164843, "question_id": 48790329, "link": "https://stackoverflow.com/questions/48790329/why-does-application-speech-speak-read-some-numbers-individually-rather-than-put", "title": "Why does Application.Speech.Speak read some numbers individually rather than put them together?", "body": "<p>Let's suppose now it is 11h11min. It reads \"ONE ONE\" hours and \"eleven\" minutes, as in:</p>\n\n<pre><code>Sub TEST1() \n  Application.Speech.Speak \"It is \" &amp; Hour(Now()) &amp; \" hours and \" &amp; Minute(Now()) &amp; \" minutes\"\nEnd Sub\n</code></pre>\n\n<p>However, the following reads \"eleven\" hours and \"eleven\" minutes </p>\n\n<pre><code>Sub TEST2() \n  Application.Speech.Speak \"It is 11 hours and 11 minutes\"\nEnd Sub\n</code></pre>\n\n<p>On the contrary, it reads \"ONE ONE\" hours and \"eleven\" minutes, as in:</p>\n\n<pre><code>Sub TEST3() \n  Application.Speech.Speak \"It is \" &amp; \"11\" &amp; \" hours and \" &amp; \"11\" &amp; \" minutes\"\nEnd Sub\n</code></pre>\n\n<p>How can I get it to read these numbers as words?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1518620567, "post_id": 48790207, "comment_id": 84582363, "body": "You need to look into <code>Instr()</code> in vba."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518621034, "post_id": 48790207, "comment_id": 84582670, "body": "wadr, whatever you are trying to do I can only see you doing it inefficiently and most likely wrong. Can you expand your narrative sans debris and provide a better description along with some sample data together with expected results? <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1518621268, "post_id": 48790207, "comment_id": 84582819, "body": "need to step back and take a look at this."}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 0, "creation_date": 1518621501, "post_id": 48790207, "comment_id": 84582991, "body": "I&#39;ve changed WorksheetFunction.Search to Instr. I&#39;ll comment the code in the first post to give you insight on what I had in mind."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1518622079, "post_id": 48790207, "comment_id": 84583379, "body": "In VBA you can use <code>ISNUMERIC()</code> without <code>Worksheetfunction</code>, FYI."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1518622844, "post_id": 48790207, "comment_id": 84583849, "body": "Inst will always return a number.  If not found it will return 0."}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 0, "creation_date": 1518623401, "post_id": 48790207, "comment_id": 84584227, "body": "Indeed, by changing the condition to &quot;&gt;0&quot; it works. Thanks."}], "owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518621929, "creation_date": 1518620462, "last_edit_date": 1518621929, "question_id": 48790207, "link": "https://stackoverflow.com/questions/48790207/error-1004-in-elseif-condition", "title": "Error 1004 in Elseif condition", "body": "<p>I have an excel sheet that looks like this : </p>\n\n<p><a href=\"https://i.stack.imgur.com/Eba38.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Eba38.png\" alt=\"excel sheet\"></a></p>\n\n<p>For each cell, I want to find the latitude and longitude of the row and column header (the \"Obj\") that are in separate worksheets (1 worksheet per \"Obj\" type). I've put my code underneath.</p>\n\n<p>At the moment, it works fine for the first row, until it reaches \"ObjB1\". When I run it in \"debug mode\", it reaches \n<code>If WorksheetFunction.IsNumber(WorksheetFunction.Search(\"ObjA\", Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j))) = True Then</code> before stopping </p>\n\n<blockquote>\n  <p>Error 1004</p>\n</blockquote>\n\n<p>without ever going into the \"Elseif\" condition. </p>\n\n<p>Sub Distances()\n    Dim i As Long\n    Dim j As Long\n    Dim Lat1 As Variant\n    Dim Lat2 As Variant\n    Dim Long1 As Variant\n    Dim Long2 As Variant\n    Dim Dist As Variant</p>\n\n<pre><code>'Going through the empty cells\n    For i = 2 To Sheets(\"Distancier\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\n    For j = 2 To Sheets(\"Distancier\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\n\n    ' If ObjA is part of the string in the row header (Column A), then lat1 and long1 take the values of the latitude and longitude of the text in the row header\n\n        If WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1), \"ObjA\", vbTextCompare)) = True Then\n            Lat1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsA\").Range(\"A2:P2000\"), 3, False)\n            Long1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsA\").Range(\"A2:P2000\"), 4, False)\n        ' Same here but ObjB is part of the string\n        ElseIf WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1), \"ObjB\", vbTextCompare)) = True Then\n            Lat1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsB\").Range(\"A2:P2000\"), 3, False)\n            Long1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsB\").Range(\"A2:P2000\"), 4, False)\n\n        ElseIf WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1), \"ObjC\", vbTextCompare)) = True Then\n            Lat1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsC\").Range(\"A2:P2000\"), 3, False)\n            Long1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsC\").Range(\"A2:P2000\"), 4, False)\n\n        ElseIf WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1), \"ObjD\", vbTextCompare)) = True Then\n            Lat1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsD\").Range(\"A2:P2000\"), 3, False)\n            Long1 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, 1).Text, Sheets(\"ObjetsD\").Range(\"A2:P2000\"), 4, False)\n        Else:\n            Lat1 = 0\n            Long1 = 0\n        End If\n\n        ' This block does the same thing as the first block but looks through the column headers (row 1)\n        If WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j), \"ObjA\", vbTextCompare)) = True Then\n            Lat2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsA\").Range(\"A2:P2000\"), 3, False)\n            Long2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsA\").Range(\"A2:P2000\"), 4, False)\n\n        ElseIf WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j), \"ObjB\", vbTextCompare)) = True Then\n            Lat2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsB\").Range(\"A2:P2000\"), 3, False)\n            Long2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsB\").Range(\"A2:P2000\"), 4, False)\n\n        ElseIf WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j), \"ObjC\", vbTextCompare)) = True Then\n            Lat2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsC\").Range(\"A2:P2000\"), 3, False)\n            Long2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsC\").Range(\"A2:P2000\"), 4, False)\n\n        ElseIf WorksheetFunction.IsNumber(InStr(1, Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j), \"ObjD\", vbTextCompare)) = True Then\n            Lat2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsD\").Range(\"A2:P2000\"), 3, False)\n            Long2 = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(1, j).Text, Sheets(\"ObjetsD\").Range(\"A2:P2000\"), 4, False)\n         Else:\n            Lat1 = 0\n            Long1 = 0\n        End If\n\n        ' If the latitudes and longitudes are numbers, then the distance between the two points is calculated.\n\n        If WorksheetFunction.And(WorksheetFunction.IsNumber(Lat1), WorksheetFunction.IsNumber(Lat2), WorksheetFunction.IsNumber(Long1), WorksheetFunction.IsNumber(Long2)) Then\n            Dist = WorksheetFunction.IfError(WorksheetFunction.Acos(Sin((3.14 / 180) * Lat1) * Sin((3.14 / 180) * Lat2) + Cos((3.14 / 180) * Lat1) * Cos((3.14 / 180) * Lat2) * Cos((3.14 / 180) * (Long2 - Long1))) * 6371, 0) * 1.3\n        End If\n        Sheets(\"Distancier\").Range(\"A1:P20000\").Cells(i, j).Value = Dist\n    Next\nNext\n</code></pre>\n\n<p>End Sub</p>\n\n<p>All the help is welcome as I cannot figure out why it doesn't work !</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1519382786, "post_id": 48789994, "comment_id": 84898398, "body": "Please read the following link: <a href=\"https://stackoverflow.com/questions/40724085/repeating-script-that-goes-from-sap-to-excel-and-back-again/40743029#40743029\" title=\"repeating script that goes from sap to excel and back again\">stackoverflow.com/questions/40724085/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1518621578, "creation_date": 1518621578, "answer_id": 48790559, "question_id": 48789994, "link": "https://stackoverflow.com/questions/48789994/macro-cant-recognize-exported-workbook-from-sap-via-vba/48790559#48790559", "title": "Macro can&#39;t recognize exported workbook from SAP via VBA", "body": "<p>This has probably nothing to do with SAP. You probably activated the option to ignore remote requests.</p>\n\n<p>Just run this in the immediate window</p>\n\n<pre><code>Application.IgnoreRemoteRequests = False\n</code></pre>\n\n<p>BTW, you could improve your code by using </p>\n\n<pre><code>With objSess\n   .FindById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nfbl5n\"\n\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9360538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5c26983d9ec7fe66ac30a5e61d3fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/9360538/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1756, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552398319, "creation_date": 1518619796, "last_edit_date": 1518622789, "question_id": 48789994, "link": "https://stackoverflow.com/questions/48789994/macro-cant-recognize-exported-workbook-from-sap-via-vba", "title": "Macro can&#39;t recognize exported workbook from SAP via VBA", "body": "<p>I have been working on SAP GUI scripting to set up automatic reports. In my macro I'm running SAP transactions, exporting them to excel (which opens a \"Workbook in basis(1)\") and then copy some info from that file into my \"Macro workbook\". However, sometimes it works and sometimes it doesn't. The problem is that the excel workbook that is created from SAP is in a different instance, so my macro is unable to use it. </p>\n\n<p>Is there any way in which I can ensure that the excel generated by SAP is always in the same instance? or get my macro to recognize workbooks in other instances?</p>\n\n<p>This is the code I'm using (WB_Macro is the workbook that has the macro itself and WB_SAP is the worbook generated by SAP):</p>\n\n<pre><code>Dim WB_SAP As Workbook\n\n'Save input in variables\ncountryCode = Sheets(\"FBL5N\").Cells(2, 10).Value\nsalesOrganization = Sheets(\"FBL5N\").Cells(2, 11)\n\n\n'Run SAP transaction\nobjSess.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"fbl5n\"\nobjSess.findById(\"wnd[0]/tbar[0]/btn[0]\").press\nobjSess.findById(\"wnd[0]/usr/ctxtDD_BUKRS-LOW\").Text = countryCode\nobjSess.findById(\"wnd[0]/usr/ctxtDD_BUKRS-LOW\").SetFocus\nobjSess.findById(\"wnd[0]/usr/ctxtDD_BUKRS-LOW\").caretPosition = 4\nobjSess.findById(\"wnd[0]/usr/btn%_DD_KUNNR_%_APP_%-VALU_PUSH\").press\nFor i = 1 To size\n    objSess.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssubSCREEN_HEADER:SAPLALDB:3010/tblSAPLALDBSINGLE/ctxtRSCSEL_255-SLOW_I[1,\" &amp; i - 1 &amp; \"]\").Text = customerCodes(i)\n    Next i\nobjSess.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssubSCREEN_HEADER:SAPLALDB:3010/tblSAPLALDBSINGLE/ctxtRSCSEL_255-SLOW_I[1,1]\").caretPosition = 6\nobjSess.findById(\"wnd[1]/tbar[0]/btn[8]\").press\n\nobjSess.findById(\"wnd[0]/usr/ctxtPA_VARI\").Text = \"/liber auto\"\nobjSess.findById(\"wnd[0]/usr/ctxtPA_VARI\").SetFocus\nobjSess.findById(\"wnd[0]/usr/ctxtPA_VARI\").caretPosition = 12\nobjSess.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nobjSess.findById(\"wnd[0]/mbar/menu[0]/menu[3]/menu[1]\").Select\nobjSess.findById(\"wnd[1]/usr/cmbG_LISTBOX\").Key = \"08\"\nobjSess.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nobjSess.findById(\"wnd[1]/usr/subSUBSCREEN_STEPLOOP:SAPLSPO5:0150/sub:SAPLSPO5:0150/radSPOPLI-SELFLAG[0,0]\").Select\nobjSess.findById(\"wnd[1]/usr/subSUBSCREEN_STEPLOOP:SAPLSPO5:0150/sub:SAPLSPO5:0150/radSPOPLI-SELFLAG[0,0]\").SetFocus\nobjSess.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nobjSess.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n\n'Activate and Capture SAP generated workbook\nWorkbooks(\"Worksheet in Basis (1)\").Activate\nSet WB_SAP = ActiveWorkbook\nDebug.Print WB_SAP.Name\n\nWB_SAP.Sheets(1).Range(\"A2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\nobjSess.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n\n\nWB_Macro.Activate\nSheets(\"FBL5N\").Select\nRange(\"Table11[[   CoCd]]\").Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["excel", "vba", "variables", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1518620182, "post_id": 48789971, "comment_id": 84582077, "body": "Hi Vityata- unfortunately, no luck. When I lay it out like that it highlights the QueryTable line red."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1518620812, "post_id": 48789971, "comment_id": 84582528, "body": "Hi Vityata- I figured it out by recording a manual version. I was missing this: &quot;Text;&quot; &amp; User_File_Path &amp; User_File_Name ... otherwise, my formatting works. Thanks for your help!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1518621040, "last_edit_date": 1518621040, "creation_date": 1518619727, "answer_id": 48789971, "question_id": 48789906, "link": "https://stackoverflow.com/questions/48789906/run-time-error-5-invalid-procedure-call-or-argument/48789971#48789971", "title": "Run Time Error 5: Invalid Procedure Call or Argument", "body": "<p>Try like this:</p>\n\n<pre><code>With ActiveSheet\n      Dim someTable As QueryTable\n      Set someTable = .QueryTables.Add(Connection:=User_File_Path, _\n                                          Destination:=Range(\"$A$1\"))\nEnd With\n</code></pre>\n\n<p>Here is the MSDN article for the <code>QueryTables.Add()</code> method:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/querytables-add-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/querytables-add-method-excel</a></p>\n\n<p>This works, if your connection is to a local csv file:</p>\n\n<pre><code>Public Sub TestMe()   \n\n    Dim someTable As QueryTable\n    Set someTable = ActiveSheet.QueryTables.Add(Connection:= _\n                    \"TEXT;C:\\MyText.csv\", _\n                    Destination:=Range(\"$A$1\"))\n\n    someTable.Refresh\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "is_accepted": false, "score": 0, "last_activity_date": 1518621106, "last_edit_date": 1518621106, "creation_date": 1518620851, "answer_id": 48790324, "question_id": 48789906, "link": "https://stackoverflow.com/questions/48789906/run-time-error-5-invalid-procedure-call-or-argument/48790324#48790324", "title": "Run Time Error 5: Invalid Procedure Call or Argument", "body": "<p><strong>SOLUTION:</strong></p>\n\n<p><code>\"Text;\" &amp; User_File_Path &amp; User_File_Name</code></p>\n\n<p>i.e.</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=\"Text;\" &amp; User_File_Path &amp; User_File_Name, Destination:=Range(\"$A$1\"))\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1857, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1518621106, "creation_date": 1518619518, "last_edit_date": 1518619871, "question_id": 48789906, "link": "https://stackoverflow.com/questions/48789906/run-time-error-5-invalid-procedure-call-or-argument", "title": "Run Time Error 5: Invalid Procedure Call or Argument", "body": "<p>I am getting the </p>\n\n<blockquote>\n  <p>Run Time Error 5: Invalid Procedure Call or Argument</p>\n</blockquote>\n\n<p>on this line:</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=User_File_Path, Destination:=Range(\"$A$1\"))\n</code></pre>\n\n<p>I have a message box right before that line that tells me the User_File_Path, which is populating, and when I hover over the Connection:=User_File_Path it does display the file path as well... not sure how to fix this. Any help is appreciated!!</p>\n"}, {"tags": ["json", "xml", "vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1518680005, "post_id": 48801890, "comment_id": 84606520, "body": "Thanks, yea i&#39;m not sure is my JSON well documented but you understand me what i mean. I&#39;ll test it and feedback. Thanks again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1518683924, "post_id": 48801890, "comment_id": 84608536, "body": "I test dude it works as you said i should mapped in the code :/"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1518679488, "creation_date": 1518679488, "answer_id": 48801890, "question_id": 48789885, "link": "https://stackoverflow.com/questions/48789885/mapping-json-xml-data-to-excel-cell-in-vba/48801890#48801890", "title": "Mapping JSON/XML data to Excel cell in VBA?", "body": "<p>You can use this library </p>\n\n<p><a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-JSON</a></p>\n\n<p>to parse JSON in VBA, but you'll need to do the mapping in code: there's no built-in configuration/wizard for this.</p>\n\n<pre><code>Sub Tester()\n\n    Dim j As Object, json As String, v\n\n    'read from file\n    json = CreateObject(\"scripting.filesystemobject\").OpenTextFile( _\n                          ThisWorkbook.Path &amp; \"\\example.txt\").ReadAll()\n\n    'import module from: https://github.com/VBA-tools/VBA-JSON\n    Set j = JsonConverter.ParseJson(json)\n\n    Set v = j(\"vehicle1\")\n\n    'some attributes...\n    Debug.Print v(\"title\")\n    Debug.Print v(\"weight\")\n    Debug.Print v(\"vehicle1-center_of_gravity\")(1)(\"x\")\n\nEnd Sub\n</code></pre>\n\n<p>PS there are a few syntax errors in your JSON sample.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 48801890, "answer_count": 1, "score": 0, "last_activity_date": 1518679488, "creation_date": 1518619461, "last_edit_date": 1531164843, "question_id": 48789885, "link": "https://stackoverflow.com/questions/48789885/mapping-json-xml-data-to-excel-cell-in-vba", "title": "Mapping JSON/XML data to Excel cell in VBA?", "body": "<p>I'm asking this after some researchs on internet. There's a way to JSON type or XML type files to import Excel sheet but there's no clear descriptions found for my case. I would like to what is my goal;</p>\n\n<p>I have a some type of string data like .txt file like this;</p>\n\n<p>Example Data:</p>\n\n<pre><code>{\"vehicle1\": {\n  \"title\": \"A super red vehicle\",\n  \"weight\": \"1500 kg\",\n  \"height\": \"2 m\",\n    \"vehicle1-center_of_gravity\": [\n      {\"x\": \"2 m\"},\n      {\"y\": \"-0.5 m\"},\n      {\"z\": \"1.5 m\"}\n     \"vehicle1-passenger_weights\": [\n     {\"p1\": \"2 m\"},\n     {\"p2\": \"-0.5 m\"},\n     {\"p3\": \"1.5 m\"}\n    \"color\": \"red\",\n    ]\n  }\n}}\n</code></pre>\n\n<p>I would like to select this file with file dialog and then click to read button now my question comes in here. Is it possible to link/map them with cells for example i have cell named <code>vehicle_title</code> and i want to map this cell with .txt file's <code>\"title\": \"A super red vehicle\"</code>.</p>\n\n<p>Do you have any experience or idea how can i implement that to my macro.</p>\n\n<p>Regards.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1518625899, "post_id": 48789601, "comment_id": 84586037, "body": "You can find the EntryID of any folder with <code>ActiveExplorer.CurrentFolder.EntryID</code>"}, {"owner": {"reputation": 67, "user_id": 5148451, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44b79c23dd8ee101f5bba14f3010db98?s=128&d=identicon&r=PG&f=1", "display_name": "thetemplar", "link": "https://stackoverflow.com/users/5148451/thetemplar"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1518771988, "post_id": 48789601, "comment_id": 84649926, "body": "Thanks, but VBA throws an error: &#39;Object Required&#39;, although the CurrentFolder Object is found, but just says &#39;Calendar&#39;"}, {"owner": {"reputation": 67, "user_id": 5148451, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44b79c23dd8ee101f5bba14f3010db98?s=128&d=identicon&r=PG&f=1", "display_name": "thetemplar", "link": "https://stackoverflow.com/users/5148451/thetemplar"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1518772451, "post_id": 48789601, "comment_id": 84650158, "body": "I also picked the folder by hand with Namespace.PickFolder and get a folder object, but cannot get the ID due to the exception &#39;Object Required&#39;"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1518780208, "post_id": 48789601, "comment_id": 84654917, "body": "Edit the question to add the PickFolder code you tried."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1518816512, "post_id": 48789601, "comment_id": 84674886, "body": "You can ask a new question about the permission error so it is separate from the original entryID question."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1518816415, "creation_date": 1518816415, "answer_id": 48835100, "question_id": 48789601, "link": "https://stackoverflow.com/questions/48789601/how-to-find-calendar-id/48835100#48835100", "title": "How to find Calendar ID", "body": "<p>This demonstrates how to get the EntryID of a folder.</p>\n\n<pre><code>Option Explicit\n\nSub entryIDFromActiveExplorer()\n\nDim entryIDStr As String\n\nDim uPrompt As String\nDim uTitle As String\nDim uDefault As String\nDim msg As String\n\n' Select a folder in the folder view\n' Do not use the calendar view\n\nentryIDStr = ActiveExplorer.CurrentFolder.entryID\n\nuPrompt = \"To hardcode the entryID of the \" &amp; _\n          Session.GetFolderFromID(entryIDStr) &amp; _\n          \" folder, copy this ID\"\n\n' Copy from the immediate pane\nDebug.Print uPrompt\nDebug.Print entryIDStr\n\nuTitle = Session.GetFolderFromID(entryIDStr)\nuDefault = entryIDStr\n\nmsg = InputBox(Prompt:=uPrompt, Title:=uTitle, Default:=uDefault)\n\nEnd Sub\n\n\nSub entryIDFromPickfolder()\n\n' If you do not want to select a folder\n'  in the normal way, from the GUI\n\nDim oFolderPicked As folder\n\nDim entryIDStr As String\n\nDim uPrompt As String\nDim uTitle As String\nDim uDefault As String\nDim msg As String\n\nSet oFolderPicked = Session.PickFolder\n\nIf Not oFolderPicked Is Nothing Then\n\n    entryIDStr = oFolderPicked.entryID\n\n    uPrompt = \"To hardcode the entryID of the \" &amp; _\n              Session.GetFolderFromID(entryIDStr) &amp; _\n              \" folder, copy this ID\"\n\n    ' Copy from the immediate pane\n    Debug.Print uPrompt\n    Debug.Print entryIDStr\n\n    Set ActiveExplorer.CurrentFolder = Session.GetFolderFromID(entryIDStr)\n    DoEvents\n\n    uTitle = Session.GetFolderFromID(entryIDStr)\n    uDefault = entryIDStr\n\n    msg = InputBox(Prompt:=uPrompt, Title:=uTitle, Default:=uDefault)\n\nEnd If\n\nExitRoutine:\n    Set oFolderPicked = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9889461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/np6t9.jpg?s=128&g=1", "display_name": "Nomad Trader", "link": "https://stackoverflow.com/users/9889461/nomad-trader"}, "is_accepted": false, "score": 1, "last_activity_date": 1580103735, "creation_date": 1580103735, "answer_id": 59925635, "question_id": 48789601, "link": "https://stackoverflow.com/questions/48789601/how-to-find-calendar-id/59925635#59925635", "title": "How to find Calendar ID", "body": "<p>Open Outlook -> Goto Calendar of choice -> Alt F11 -> Immediate Window -> Type the following and hit enter. </p>\n\n<p>? ActiveExplorer.CurrentFolder.EntryID </p>\n"}], "owner": {"reputation": 67, "user_id": 5148451, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44b79c23dd8ee101f5bba14f3010db98?s=128&d=identicon&r=PG&f=1", "display_name": "thetemplar", "link": "https://stackoverflow.com/users/5148451/thetemplar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5095, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592723195, "creation_date": 1518618565, "last_edit_date": 1592723195, "question_id": 48789601, "link": "https://stackoverflow.com/questions/48789601/how-to-find-calendar-id", "title": "How to find Calendar ID", "body": "<p>I need to find the ID of a Outlook Calendar. It is a public calendar with many contributors/users, but not listed as \"shared\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/OHP8V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OHP8V.png\" alt=\"Outlook Calendars\"></a> </p>\n\n<p>I want to automatically export selected calendars to an *.ics.\nCurrently I only can export my default folder with:</p>\n\n<pre><code> Set oNamespace = Application.GetNamespace(\"MAPI\")\n Set oFolder = oNamespace.GetDefaultFolder(olFolderCalendar) \n Set oCalendarSharing = oFolder.GetCalendarExporter\n oCalendarSharing.SaveAsICal \"C:\\calendar.ics\"\n</code></pre>\n\n<p>I need to add the \"ThisOne\" to the export.\nThe properties do not have a location:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oZKIR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oZKIR.png\" alt=\"ThisOne-Properties\"></a></p>\n\n<p>How to I find the ID, so I can use it with \"GetFolderFromID()\"? Or are there better ways to include the Calendar in the export or export it on its own?</p>\n\n<p>Edit:\nNow I think I got the Calendar-ID by using </p>\n\n<pre><code>Set oNamespace = Application.GetNamespace(\"MAPI\")\nSet oFolderPicked = oNamespace.PickFolder\nSet oFolder = oNamespace.GetFolderFromID(oFolderPicked.EntryID, oFolderPicked.StoreID)\nSet oCalendarSharing = oFolder.GetCalendarExporter\n</code></pre>\n\n<p>but this throws a exception at the last line (GetCalendarExporter):</p>\n\n<p><a href=\"https://i.stack.imgur.com/HTwoJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HTwoJ.png\" alt=\"Exception\"></a></p>\n\n<p>If I export in the GUI (File -> Save), it works without a problem...</p>\n\n<p>(Later I dont want to use PickFolder and just hard-code the EntryID to the script)</p>\n"}, {"tags": ["html", "vba", "excel", "rtf"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1518619469, "post_id": 48789526, "comment_id": 84581578, "body": "I think it&#39;s pretty hard to write a parser that converts cell formatting into HTML (and too broad to ask here). This is just not what Excel is thought to be used for. Excel is not a database it is for calculating tables that&#39;s its strength. What you try is to abuse Excel for other things. But have a look if <code>PublishObjects</code> is something you can use: <code>ThisWorkbook.PublishObjects.Add(xlSourceRange, &quot;C:\\temp\\test.html&quot;, &quot;Sheet1&quot;, &quot;A1&quot;, xlHtmlStatic).Publish</code> this publishes cell A1 of Sheet1 as <code>test.html</code> (probably not exactly what you want."}, {"owner": {"reputation": 133, "user_id": 5034724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dae312dc35e5b816b924342d4463ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Middle", "link": "https://stackoverflow.com/users/5034724/middle"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518630433, "post_id": 48789526, "comment_id": 84588691, "body": "@P\u1d07\u029c I am stuck with data sitting in excel files sadly, but this is potentially useful for other situations, so thank you for posting it. I could copy the HTML code back into excel from the webpage. Doubt it will cut down calculation time, but I guess it&#39;s worth a shot."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1518678444, "post_id": 48789526, "comment_id": 84605786, "body": "I doubt that copying the HTML code back would work, because it is using CSS for formatting color etc not just simple HTML. If this is something that has not to be done automatically but only once in a while consider using a third party tool like <a href=\"https://www.extendoffice.com/documents/excel/3593-excel-convert-cells-to-html-table.html\" rel=\"nofollow noreferrer\">ExtendOffice</a> (there are several others) so you don&#39;t need to re-invent the wheel."}], "owner": {"reputation": 133, "user_id": 5034724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dae312dc35e5b816b924342d4463ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Middle", "link": "https://stackoverflow.com/users/5034724/middle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518619105, "creation_date": 1518618368, "last_edit_date": 1518619105, "question_id": 48789526, "link": "https://stackoverflow.com/questions/48789526/converting-partial-bolding-in-rtf-to-html-format", "title": "Converting partial bolding in RTF to HTML format", "body": "<p>I'm still very new to Stack Overflow and Vba.</p>\n\n<p>I'm trying to convert RTF formatted cells to HTML format using a macro, but ran into problem with execution time. The current method is based on looping through all characters in each cell is particularly slow. </p>\n\n<p>The partial \"Bold\" formatted text are very problematic for manual conversion, since I don't know any other way of getting properties of them other than looping through all the characters.</p>\n\n<p>Also, the strings stored are usually pretty long, causing long loops if multiple cells are selected at the same time. </p>\n\n<p>Is there another quicker way to either get the style properties of a cell or convert the whole cell into HTML quickly? </p>\n\n<p>Data pattern of bold text do not stay the same:\n<a href=\"https://i.stack.imgur.com/trie5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/trie5.png\" alt=\"Data Sample\"></a></p>\n\n<p>Code for current method(UDF Function found from another thread.)</p>\n\n<pre><code>Function fnConvert2HTML(myCell As Range) As String\n    Dim bldTagOn, itlTagOn, ulnTagOn, colTagOn As Boolean\n    Dim i, chrCount As Integer\n    Dim chrCol, chrLastCol, htmlTxt, htmlEnd As String\n\n    bldTagOn = False\n    itlTagOn = False\n    ulnTagOn = False\n    colTagOn = False\n    chrCol = \"NONE\"\n    'htmlTxt = \"&lt;html&gt;\"\n    htmlTxt = \"\"\n    chrCount = myCell.Characters.Count\n\n    For i = 1 To chrCount\n    htmlEnd = \"\"\n        With myCell.Characters(i, 1)\n            If (.Font.Color) Then\n                chrCol = fnGetCol(.Font.Color)\n                If Not colTagOn Then\n                    htmlTxt = htmlTxt &amp; \"&lt;font color=#\" &amp; chrCol &amp; \"&gt;\"\n                    colTagOn = True\n                Else\n                    If chrCol &lt;&gt; chrLastCol Then htmlTxt = htmlTxt &amp; \"&lt;/font&gt;&lt;font color=#\" &amp; chrCol &amp; \"&gt;\"\n                End If\n            Else\n                chrCol = \"NONE\"\n                If colTagOn Then\n                    htmlEnd = \"&lt;/font&gt;\" &amp; htmlEnd\n                    'htmlTxt = htmlTxt &amp; \"&lt;/font&gt;\"\n                    colTagOn = False\n                End If\n            End If\n            chrLastCol = chrCol\n\n            If .Font.Bold = True Then\n                If Not bldTagOn Then\n                    htmlTxt = htmlTxt &amp; \"&lt;b&gt;\"\n                    bldTagOn = True\n                End If\n            Else\n                If bldTagOn Then\n                    'htmlTxt = htmlTxt &amp; \"&lt;/b&gt;\"\n                    htmlEnd = \"&lt;/b&gt;\" &amp; htmlEnd\n                    bldTagOn = False\n                End If\n            End If\n\n            If .Font.Italic = True Then\n                If Not itlTagOn Then\n                    htmlTxt = htmlTxt &amp; \"&lt;i&gt;\"\n                    itlTagOn = True\n                End If\n            Else\n                If itlTagOn Then\n                    'htmlTxt = htmlTxt &amp; \"&lt;/i&gt;\"\n                    htmlEnd = \"&lt;/i&gt;\" &amp; htmlEnd\n                    itlTagOn = False\n                End If\n            End If\n\n            If .Font.Underline &gt; 0 Then\n                If Not ulnTagOn Then\n                    htmlTxt = htmlTxt &amp; \"&lt;u&gt;\"\n                    ulnTagOn = True\n                End If\n            Else\n                If ulnTagOn Then\n                    'htmlTxt = htmlTxt &amp; \"&lt;/u&gt;\"\n                    htmlEnd = \"&lt;/u&gt;\" &amp; htmlEnd\n                    ulnTagOn = False\n                End If\n            End If\n\n            If (Asc(.Text) = 10) Then\n                htmlTxt = htmlTxt &amp; htmlEnd &amp; \"&lt;br&gt;\"\n            Else\n                htmlTxt = htmlTxt &amp; htmlEnd &amp; .Text\n            End If\n\n        End With\n    Next\n\n    If colTagOn Then\n        htmlTxt = htmlTxt &amp; \"&lt;/font&gt;\"\n        colTagOn = False\n    End If\n    If bldTagOn Then\n        htmlTxt = htmlTxt &amp; \"&lt;/b&gt;\"\n        bldTagOn = False\n    End If\n    If itlTagOn Then\n        htmlTxt = htmlTxt &amp; \"&lt;/i&gt;\"\n        itlTagOn = False\n    End If\n    If ulnTagOn Then\n        htmlTxt = htmlTxt &amp; \"&lt;/u&gt;\"\n        ulnTagOn = False\n    End If\n    'htmlTxt = htmlTxt &amp; \"&lt;/html&gt;\"\n    fnConvert2HTML = htmlTxt\n\n    htmlTxt = \"\"\nEnd Function\n\nFunction fnGetCol(strCol As String) As String\n    Dim rVal, gVal, bVal As String\n    strCol = Right(\"000000\" &amp; Hex(strCol), 6)\n    bVal = Left(strCol, 2)\n    gVal = Mid(strCol, 3, 2)\n    rVal = Right(strCol, 2)\n    fnGetCol = rVal &amp; gVal &amp; bVal\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 6, "creation_date": 1518618023, "post_id": 48789224, "comment_id": 84580502, "body": "<code>Dir</code> doesn&#39;t work with file names with Unicode characters. You can use <code>FileSystemObject</code>"}], "owner": {"reputation": 713, "user_id": 4715656, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/6wq0Q.jpg?s=128&g=1", "display_name": "Gowire", "link": "https://stackoverflow.com/users/4715656/gowire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518618390, "creation_date": 1518617408, "last_edit_date": 1518618390, "question_id": 48789224, "link": "https://stackoverflow.com/questions/48789224/managing-problematic-formatted-international-characters-in-filename", "title": "Managing problematic formatted international characters in filename", "body": "<p>I have some files in a folder that seems to be formatted in a strange way when accessing them in VBA.</p>\n\n<p>The code below is a simple test. It scans the Excel-files in a folder and simply opens and closing them again (just to test the problem). It works fine even if the filename contains Swedish characters such as \u00e5,\u00e4,\u00f6.</p>\n\n<pre><code>Sub ScanFiles()\n    Dim ExcelFile As String\n    Dim WB As Workbook\n\n    ExcelFile = Dir(\"c:\\Somepath\\*.xlsx\")\n    Do While ExcelFile &lt;&gt; \"\"\n        Set WB = Workbooks.Open(ExcelFile)\n        WB.Close False\n    Loop\n    ExcelFile = Dir()\nEnd Sub\n</code></pre>\n\n<p>This works fine... <em>until</em>... this happens:</p>\n\n<ul>\n<li>One filename is listed as \"S\u00f6mething.xlsx\". Even if I take a detailed look in the file properties. It <em>is</em> really \"S\u00f6mething.xlsx\"! </li>\n<li>But the variable <code>ExcelFile</code> stores \"So\u00a8mething.xlsx\". The <code>Workbooks.Open</code> command fails since the file with that name can't be found</li>\n</ul>\n\n<p>It seems that the specific file has been saved in an Apple environment. </p>\n\n<p>Why is this happening and how do I manage it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 73, "user_id": 8931717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a66ac648f4c79fcdff3f71ebd65bddbd?s=128&d=identicon&r=PG&f=1", "display_name": "SenthamilVM", "link": "https://stackoverflow.com/users/8931717/senthamilvm"}, "edited": false, "score": 0, "creation_date": 1518617375, "post_id": 48789192, "comment_id": 84580053, "body": "I am checking if CustRelPO exists and then proceed with sorting... I have problem with specifying range while sorting."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1518617586, "post_id": 48789192, "comment_id": 84580207, "body": "Describe your results a bit more.  Are the column headers on row 2?  If you step through (F8) does it get to the line of code that sorts?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518620240, "post_id": 48789192, "comment_id": 84582118, "body": "Just guessing - can you change <code>ActiveSheet.UsedRange</code> with <code>Selection</code> and try?"}], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1518622712, "creation_date": 1518622712, "answer_id": 48790922, "question_id": 48789192, "link": "https://stackoverflow.com/questions/48789192/why-isnt-my-vba-sorting-my-column-data-correctly/48790922#48790922", "title": "Why isn&#39;t my VBA sorting my column data correctly?", "body": "<p><code>Key:=ActiveSheet.UsedRange</code> is a complete misunderstanding of the sort method. (Usedrange covers the whole used area on the sheet - often \"empty\" cells, too.) The same applies to <code>.SetRange ActiveSheet.UsedRange</code>. It is not bad just needless. <code>SetRange</code> is needed when you want to limit the area to be sorted. If you want to sort on only one key (column), then change this </p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"BACKORDER\").Sort.SortFields.Add Key:=ActiveSheet.UsedRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"BACKORDER\").Sort\n    .SetRange ActiveSheet.UsedRange\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>With ActiveWorkbook.Worksheets(\"BACKORDER\").Sort\n    .Key rngcustrelpo\n    .Header = xlYes\n    .MatchCase = False\n    .Order:=xlAscending\n    .Orientation = xlTopToBottom\n    .SortOn:=xlSortOnValues\n    .DataOption:= xlSortTextAsNumbers\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>And you can find more info here: <a href=\"https://stackoverflow.com/questions/24352229/excel-sortfields-add-then-sort\">Excel SortFields add then sort</a> and here: <a href=\"https://stackoverflow.com/questions/26349980/most-efficient-way-to-sort-and-sort-syntax-vba\">Most efficient way to sort and sort syntax VBA</a></p>\n"}], "owner": {"reputation": 73, "user_id": 8931717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a66ac648f4c79fcdff3f71ebd65bddbd?s=128&d=identicon&r=PG&f=1", "display_name": "SenthamilVM", "link": "https://stackoverflow.com/users/8931717/senthamilvm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518624072, "creation_date": 1518617320, "last_edit_date": 1518624072, "question_id": 48789192, "link": "https://stackoverflow.com/questions/48789192/why-isnt-my-vba-sorting-my-column-data-correctly", "title": "Why isn&#39;t my VBA sorting my column data correctly?", "body": "<p>I am trying to delete the first row of the Excel sheet and sort a specific column using its name \"CUST_RELPO\". I am using the column header name since the name may change.</p>\n\n<p>Sorting and copying the column from the second row since I do need to copy the column header.</p>\n\n<pre><code>Sub ClearFirstRow()\n'\n' ClearFirstRow Macro\n'\n\n'\nRows(\"1:1\").Select\n    Selection.Delete Shift:=xlUp\n    Cells.Select\n  Dim rngcustrelpo As Range\n  xindex = Application.ActiveCell.Column\n  Set rngcustrelpo = ActiveSheet.UsedRange.Find(\"CUST_RELPO\")\n  If rngcustrelpo Is Nothing Then\n    MsgBox \"CUST_RELPO column was not found.\"\n    Exit Sub\n    End If\n    'Cells.Select\n    Range(rngcustrelpo, rngcustrelpo.End(xlDown)).Select\n    ActiveWorkbook.Worksheets(\"BACKORDER\").Sort.SortFields.Add Key:=ActiveSheet.UsedRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveWorkbook.Worksheets(\"BACKORDER\").Sort\n        .SetRange ActiveSheet.UsedRange\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Set rngcustrelpo1 = rngcustrelpo.Offset(1, 0)\n    Range(rngcustrelpo1, rngcustrelpo1.End(xlDown)).Select\n    Selection.Copy\nEnd Sub\n</code></pre>\n\n<p>However, it is not sorting the data like I am expecting. I am not sure what I am missing here.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518617354, "post_id": 48789168, "comment_id": 84580037, "body": "what is <code>AMPaste</code> is it the name of the sheet, the code name of the sheet, or a public worksheet variable?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1518617357, "post_id": 48789168, "comment_id": 84580039, "body": "You didn&#39;t declare the AMPaste as a worksheet, same with AMCurrent.."}, {"owner": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "edited": false, "score": 0, "creation_date": 1518617532, "post_id": 48789168, "comment_id": 84580161, "body": "I am working off of someone else&#39;s code and new to it.  They had &quot;Sheet1&quot; in place of &quot;AMCurrent&quot; and &quot;Sheet2&quot; in place of &quot;AMPaste&quot;.  They are the names of the worksheets."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518617730, "post_id": 48789168, "comment_id": 84580294, "body": "When they were using <code>Sheet1</code> and <code>Sheet2</code> they were using the code name of the sheets and not the actual name of the sheets.  I will bet the code name is still something like <code>Sheet1</code> and <code>Sheet2</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518617784, "post_id": 48789168, "comment_id": 84580317, "body": "Google <code>Worksheet Code name VBA</code> and you will find many articles on the difference, and how to use in code."}, {"owner": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "edited": false, "score": 0, "creation_date": 1518617802, "post_id": 48789168, "comment_id": 84580329, "body": "That makes sense.  Thanks a ton!  I thought that it changed it completely.  Lots to learn."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1518617898, "post_id": 48789168, "comment_id": 84580401, "body": "See <a href=\"https://stackoverflow.com/questions/48727089/cant-access-a-different-sheet-getting-value-error/48727117#48727117\">cant access a different sheet getting #VALUE! error</a>."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1518617946, "post_id": 48789168, "comment_id": 84580439, "body": "Using Range without preceding it with a worksheet reference, as in <code>AMCurrent.Range(&quot;A&quot; &amp; ...</code> may be why it&#39;s not finding the object originally.  Especially if your Activated worksheet changes"}, {"owner": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "edited": false, "score": 0, "creation_date": 1518618163, "post_id": 48789168, "comment_id": 84580597, "body": "Excellent resources and information.  Thanks everyone."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "edited": false, "score": 0, "creation_date": 1518617918, "post_id": 48789303, "comment_id": 84580420, "body": "Amazing!  Thank you so much!  This worked perfectly.  Excited to pick it apart and learn it."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "edited": false, "score": 0, "creation_date": 1518617957, "post_id": 48789303, "comment_id": 84580447, "body": "@Heather, please could you mark my response as an answer, if it has helped? Thanks :)"}, {"owner": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "edited": false, "score": 0, "creation_date": 1518618015, "post_id": 48789303, "comment_id": 84580493, "body": "I&#39;ve got to wait a few minutes but definitely will do.  Thanks!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1518617664, "creation_date": 1518617664, "answer_id": 48789303, "question_id": 48789168, "link": "https://stackoverflow.com/questions/48789168/range-object-required/48789303#48789303", "title": "Range &quot;Object Required&quot;", "body": "<p>I'm assuming you didn't declare your Worksheets, and that you used their name instead of Sheets(\"SheetName\"), but I believe this could be your solution:</p>\n\n<pre><code> Sub Paste1()\n    Dim NextRow As Long\n    Dim wsPaste As Worksheet: Set wsPaste = Sheets(\"AMPaste\")\n    Dim wsCurrent As Worksheet: Set wsCurrent = Sheets(\"AMCurrent\")\n\n    NextRow = wsCurrent.Cells(wsCurrent.Rows.Count, \"A\").End(xlUp).Row + 1\n    wsPaste.Range(\"A3:F3\").Copy\n    wsCurrent.Range(\"A\" &amp; NextRow).PasteSpecial Paste:=xlValues, Transpose:=False\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38, "user_id": 9565263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a864725106c791298b134e18c5c10c12?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9565263/aaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1602785199, "creation_date": 1602785199, "answer_id": 64377390, "question_id": 48789168, "link": "https://stackoverflow.com/questions/48789168/range-object-required/64377390#64377390", "title": "Range &quot;Object Required&quot;", "body": "<p>I had the same problem. My worksheet was named &quot;tagsListSheet&quot; and in my script I had a Worksheet variable also named &quot;tagsListSheet&quot;. My line of code that produced your error looked like:</p>\n<pre><code>Set wwTags = Range(tagsListSheet.Cells(2, 2), tagsListSheet.Cells(lastTagRow, 2))\n</code></pre>\n<p>and when I changed the name of the worksheet variable, it worked.</p>\n<pre><code>Set wwTags = Range(tagSheet.Cells(2, 2), tagSheet.Cells(lastTagRow, 2))\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9300650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed77510949129e920e0ecec2b0fa3ede?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/9300650/heather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2383, "favorite_count": 0, "accepted_answer_id": 48789303, "answer_count": 2, "score": 1, "last_activity_date": 1602786782, "creation_date": 1518617207, "last_edit_date": 1602786782, "question_id": 48789168, "link": "https://stackoverflow.com/questions/48789168/range-object-required", "title": "Range &quot;Object Required&quot;", "body": "<p>I can't figure this out.</p>\n<pre><code>Sub Paste1()\n    Dim NextRow As Range\n    Set NextRow = Range(&quot;A&quot; &amp; Sheets(&quot;AMCurrent&quot;).UsedRange.Rows.Count + 1)\n    AMPaste.Range(&quot;A3:F3&quot;).Copy\n    AMCurrent.Activate\n    NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n    Application.CutCopyMode = False\n    Set NextRow = Nothing\nEnd Sub\n</code></pre>\n<p>I get an &quot;object error&quot; on row 4, <code>AMPaste.Range(&quot;A3:F3&quot;).Copy</code>.</p>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518618916, "post_id": 48789138, "comment_id": 84581168, "body": "Remove all <code>On Error Resume Next</code> statements and check if there are any errors in part 2."}, {"owner": {"reputation": 28, "user_id": 9355079, "user_type": "registered", "profile_image": "https://graph.facebook.com/1839334456285949/picture?type=large", "display_name": "Sviat Lavrinchuk", "link": "https://stackoverflow.com/users/9355079/sviat-lavrinchuk"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518619597, "post_id": 48789138, "comment_id": 84581650, "body": "@omegastripes, you were right! But I still don&#39;t understand it. If I delete only &quot;On Error&quot; in part 2 - nothing changes (macro skips part 2), but if I remove &quot;On error&quot; in part 1, I get a Run-time error &#39;91&#39; (Object variable or With block variable not set) on the line &quot;aaEle.Click&quot; (last line of the macro). I suppose it is because aaEle variable is assigned to nothing, but I see no relation between this and On Error in Part 1."}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1518619839, "post_id": 48789138, "comment_id": 84581826, "body": "@SviatLavrinchuk Once you set <code>On Error Resume Next</code>, you will have to set <code>On Error GoTo 0</code> so VBA will then raise errors. This directive suppresses all errors until told otherwise."}, {"owner": {"reputation": 28, "user_id": 9355079, "user_type": "registered", "profile_image": "https://graph.facebook.com/1839334456285949/picture?type=large", "display_name": "Sviat Lavrinchuk", "link": "https://stackoverflow.com/users/9355079/sviat-lavrinchuk"}, "reply_to_user": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1518620132, "post_id": 48789138, "comment_id": 84582037, "body": "@Brownish Monster, anyway, it only showed the problem: aaEle variable in Part 2 does not get assigned to a HTMLelement that I want it to (as I understand, because &quot;getElementsByClassName&quot; simply does not find elements with such class, although at least one is present there for sure."}, {"owner": {"reputation": 28, "user_id": 9355079, "user_type": "registered", "profile_image": "https://graph.facebook.com/1839334456285949/picture?type=large", "display_name": "Sviat Lavrinchuk", "link": "https://stackoverflow.com/users/9355079/sviat-lavrinchuk"}, "edited": false, "score": 0, "creation_date": 1518620783, "post_id": 48789138, "comment_id": 84582511, "body": "And what I just cannot understand, that if I run Part 1 and Part 2 separately - everything is ok, I run them together but with f8 - again ok, together with f5 - in most cases it doesn&#39;t work (and rarely works! with the same code)"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1518625239, "post_id": 48789138, "comment_id": 84585541, "body": "@SviatLavrinchuk Most of the times when this happens, it is because it hasn&#39;t loaded. Try <code>DoEvents</code> after <code>Sleep 3000</code> (and uncomment the sleep). In my experience, I have found IE automation is easy to implement but isn&#39;t very reliable. On the other hand, <code>WinHttp.WinHttpRequest</code> might be more reliable but is harder to get to the correct destination. That said, whenever I have got <code>WinHttpRequest</code> to work, I found it worth the effort and much faster. Looking at your sample, if JavaScript is present then it might be out of the question, depending on what your aim is."}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1518625409, "post_id": 48789138, "comment_id": 84585664, "body": "@SviatLavrinchuk If you go the IE automation route, you can check if an element exists, if not then <code>Sleep 3000 : DoEvents</code> until it does or for a maximum  number of times."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518630862, "post_id": 48789138, "comment_id": 84588895, "body": "Then don&#39;t use <code>Sleep</code>, never. Make a check which relied on certain element presense or quantity of elements on the webpage, like <code>If objIE.document.getElementsByClassName(&quot;article-title&quot;).lengt&zwnj;&#8203;h &gt;= N Then Exit Do</code>, or <code>If Not IsNull(objIE.document.getElementById(&quot;nodeId&quot;)) Then Exit Do</code>, etc."}, {"owner": {"reputation": 28, "user_id": 9355079, "user_type": "registered", "profile_image": "https://graph.facebook.com/1839334456285949/picture?type=large", "display_name": "Sviat Lavrinchuk", "link": "https://stackoverflow.com/users/9355079/sviat-lavrinchuk"}, "edited": false, "score": 0, "creation_date": 1518694060, "post_id": 48789138, "comment_id": 84614919, "body": "@ omegastripes, I tried adding right after DoEvents line at the end of Part 1     such line &quot;Cells(1, 2).Value = objIE.LocationURL&quot; (it copies the URL of the page to the Cell) and it copies the first page I navigate to, not the one that loads after I use aEle.Click in Part 1. Does that mean something?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518731104, "post_id": 48789138, "comment_id": 84637516, "body": "@SviatLavrinchuk That means that the page have not been loaded at the moment you tried to process it. After <code>.Navigate</code> you have to wait for IE is ready, then for document, and target node(s) is accessible, check <code>Do ... Loop</code>s in first code block for IE in <a href=\"https://stackoverflow.com/a/43969543/2165759\">this answer</a>, and in my comment above."}], "owner": {"reputation": 28, "user_id": 9355079, "user_type": "registered", "profile_image": "https://graph.facebook.com/1839334456285949/picture?type=large", "display_name": "Sviat Lavrinchuk", "link": "https://stackoverflow.com/users/9355079/sviat-lavrinchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1518617145, "creation_date": 1518617145, "question_id": 48789138, "link": "https://stackoverflow.com/questions/48789138/excel-vba-html-automation-using-getelementsbyclassname-sometimes-works-and-somet", "title": "Excel VBA HTML automation using getElementsByClassName sometimes works and sometimes don&#39;t", "body": "<p>I've made a macro that opens Internet Explorer, navigates to a particular web-page with a list of articles (each article has the same class, but different innertext), and clicks a particular article. So far everything works perfectly well (Part 1 in a code below). However, when I try to do exactly the same operation (but with different class and innertext) again (Part 2 in a code below) it either works or not absolutely (as I see it) randomly. Maybe someone can give me a clue what may make it run smoothly every time?</p>\n\n<p>Moreover, it always works when I run it by steps (F8).</p>\n\n<p>HTML codes for\nPart 1:</p>\n\n<pre><code> &lt;div class=\"article-title\"&gt;Some text in russian&lt;/div&gt;\n</code></pre>\n\n<p>Part 2:</p>\n\n<pre><code> &lt;a href=\"javascript:void(0);\" class=\"js-popup-open\" data-\n popup=\"callback\"&gt;Some text in russian 2&lt;/a&gt;\n</code></pre>\n\n<p>Here is what i made so far:</p>\n\n<pre><code>Private Declare PtrSafe Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds \nAs Long)\nPrivate Declare PtrSafe Function ShowWindow Lib \"user32\" (ByVal hwnd As \nLong, ByVal nCmdShow As Long) As Long\nPrivate Const SW_SHOWMAXIMIZED = 3\n\nSub sup()\n\nDim aEle As HTMLLinkElement\nDim aaEle As HTMLLinkElement\n\nDim objIE As Object\n\nDim hwnd As Long\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\nobjIE.Visible = True\n\n\n  objIE.navigate \"http://www.spark-interfax.ru/ru/services\"\n\nShowWindow objIE.hwnd, SW_SHOWMAXIMIZED\n  Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n'Sleep (3000) (tried both variants, doesnt help)\n\n'Part 1\n\n For Each aEle In objIE.document.getElementsByClassName(\"article-title\")\n\n    Debug.Print aEle.innerText\n     On Error Resume Next\n\n    If aEle.innerText = \"Some text in russian\" Then Exit For\n    Next aEle\n\n   aEle.Click\n\n   Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n'  Sleep (3000) (again, tried both)\n\n  'Part 2\n   For Each aaEle In objIE.document.getElementsByClassName(\"js-popup-open\")\n\n    Debug.Print aaEle.innerText\n     On Error Resume Next\n\n    If aaEle.innerText = \"some text in russian 2\" Then  Exit For\n    Next aaEle\n    aaEle.Click\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518619165, "creation_date": 1518619165, "answer_id": 48789801, "question_id": 48788698, "link": "https://stackoverflow.com/questions/48788698/appending-new-positions-to-a-form-listbox/48789801#48789801", "title": "Appending new positions to a form listbox", "body": "<p>Try this</p>\n\n<pre><code>Option Explicit\n\n\n    Dim Form As HistoryFRM, ARR() As Variant, ArrHistory() As Variant\n    Dim i As Long, j As Long\n    ....\n    Set Form = New HistoryFRM\n    With Form\n        .Show vbModeless\n        With .LBHistory\n            .ColumnCount = 6\n            For i = 0 To UBound(ARR)\n                ArrHistory = SQL_Editor(\"SELECT * FROM [Table] WHERE [ID]='\" &amp; ARR(i) &amp; \"';\")\n                For j = LBound(ArrHistory) To UBound(ArrHistory)\n                    .AddItem ArrHistory(j)\n                Next\n            Next\n        End With\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1518621765, "creation_date": 1518621765, "answer_id": 48790616, "question_id": 48788698, "link": "https://stackoverflow.com/questions/48788698/appending-new-positions-to-a-form-listbox/48790616#48790616", "title": "Appending new positions to a form listbox", "body": "<p>If I understand you correctly, you want to fill six columns with the array you're getting from the data base. Both the <code>List</code> and <code>Count</code>properties replace the content of their lists when an array is assigned. The <code>AddItem</code> method allows you to append new items to the list, but in one dimension, only.</p>\n\n<p>In order to append a new array of items, I believe you first need to read the current list into an array, append the new items to that array, then write the entirety back to the ListBox. Here's an example:</p>\n\n<pre><code>Dim arr()\nDim lb As ListBox\nDim numCols As Long\nDim rowCount As Long, colCount As Long\nDim numNewRecs As Long, newRecCount As Long\n\nSet lb = Me.ListBox1\n'You need to know how many new records are coming in\n'Substitute this determination here:\nnumNewRecs = 2\nnumCols = lb.ColumnCount - 1\n\n'Dimension the array for the current list plus the new records\nReDim arr(lb.ListCount - 1 + numNewRecs, numCols)\n'Get the current list\nFor rowCount = 0 To lb.ListCount - 1\n    For colCount = 0 To numCols\n        arr(rowCount, colCount) = lb.List(rowCount, colCount)\n    Next\nNext\n'Append the new records\nFor newRecCount = rowCount To rowCount + numNewRecs - 1\n    For colCount = 0 To numCols\n        arr(newRecCount, colCount) = \"New data\" &amp; CStr(newRecCount)\n    Next\nNext\n'Populate the ListBox\nlb.List = arr()\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9360086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6748adeca4daa6dfd1d12e88a620f2e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/9360086/andrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 48790616, "answer_count": 2, "score": 0, "last_activity_date": 1518621765, "creation_date": 1518615874, "last_edit_date": 1531164843, "question_id": 48788698, "link": "https://stackoverflow.com/questions/48788698/appending-new-positions-to-a-form-listbox", "title": "Appending new positions to a form listbox", "body": "<p>I have a UserForm in Excel with a ListBox, which must show the result of a computation. The problem is when I try to fill the Listbox using a recursive loop the information which was there earlier is replaced with new data. How can I append new information to the content in the ListBox and not lose earlier information?</p>\n\n<p>My current code:</p>\n\n<pre><code>Dim Form As HistoryFRM, ARR(), i,  ArrHistory()\n.....\nSet Form = New HistoryFRM\nWith Form\n    .Show vbModeless\n    .LBHistory.ColumnCount = 6\n    For i = 0 To UBound(ARR)\n        ArrHistory = SQL_Editor(\"SELECT * FROM [Table] WHERE [ID]='\" &amp; ARR(i) &amp; \"';\")\n        .LBHistory.Column = ArrHistory\n    Next i\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518617211, "post_id": 48788706, "comment_id": 84579920, "body": "I&#39;m getting a &quot;compile error - expected end with&quot; I need to include all of column G also - the above doesn&#39;t seem to work"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518617394, "post_id": 48788706, "comment_id": 84580064, "body": "@SIRO1 - compile errors are the best ones you can get in VBA. (no irony - they are the easiest &amp; quickest to solve in debugging). Give it a few tries, you probably are missing <code>End With</code> at the end or something."}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518617839, "post_id": 48788706, "comment_id": 84580366, "body": "Ah Yes End With was the problem - which brings me back to setting the ranges which is still the big issue? any thoughts? appreciate you input!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518617972, "post_id": 48788706, "comment_id": 84580464, "body": "@SIRO1 - have you tried the code under the <b>Edit</b>? Does it still throw errors?"}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518618111, "post_id": 48788706, "comment_id": 84580565, "body": "!GUID = Range(&quot;G:G&quot;).Value I would of thought this would work but it doesn&#39;t"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518618203, "post_id": 48788706, "comment_id": 84580635, "body": "@SIRO1 - yes, it does not work - you should refer one row per recordset. Thus <code>!GUID = Range(&quot;g2&quot;).Value</code> is what should be working."}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518618316, "post_id": 48788706, "comment_id": 84580706, "body": "how do I return all the records than? is there a dynamic way? the record number will be different per week"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518618544, "post_id": 48788706, "comment_id": 84580863, "body": "@SIRO1 - with a loop through all rows."}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518618688, "post_id": 48788706, "comment_id": 84580985, "body": "Great! would you have to have code for that?  I am fairly new to Macros"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518618751, "post_id": 48788706, "comment_id": 84581034, "body": "@SIRO1 - here you go - <a href=\"https://stackoverflow.com/questions/1463236/loop-through-each-row-of-a-range-in-excel\" title=\"loop through each row of a range in excel\">stackoverflow.com/questions/1463236/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1518617694, "last_edit_date": 1592644375, "creation_date": 1518615895, "answer_id": 48788706, "question_id": 48788609, "link": "https://stackoverflow.com/questions/48788609/importing-excel-worksheet-range-to-ms-access-table/48788706#48788706", "title": "Importing Excel worksheet range to Ms Access Table", "body": "<p>Change the <code>rs</code> section to this one:</p>\n<pre><code>With rs\n    .addnew\n    !GUID = Range(&quot;g2&quot;).Value\n    !StageID = Range(&quot;h2&quot;).Value\n    '...etc\n    .Update\nEnd With\n</code></pre>\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff845624.aspx\" rel=\"nofollow noreferrer\">MSDN source</a></p>\n<blockquote>\n<p>Use the AddNew method to create and add a new record in the Recordset object named by recordset. This method sets the fields to default values, and if no default values are specified, it sets the fields to Null (the default values specified for a table-type Recordset).</p>\n<p>After you modify the new record, use the Update method to save the changes and add the record to the Recordset. No changes occur in the database until you use the Update method.</p>\n</blockquote>\n<p>Edit:\nThis is how your code should look like, when you change the <code>rs</code> section with the code above:</p>\n<pre><code>Sub AccessCode()\n\n    Application.ScreenUpdating = False\n\n    Dim db As Database\n    Dim rs As DAO.Recordset\n\n    Set db = OpenDatabase(&quot;C:\\Users\\user\\Desktop\\Test Copy.accdb&quot;)\n    Set rs = db.OpenRecordset(&quot;Fact Table&quot;, dbOpenTable)\n    \n    With rs\n        .addnew\n        !GUID = Range(&quot;g2&quot;).Value\n        !StageID = Range(&quot;h2&quot;).Value\n        '...etc\n        .Update\n        .Close\n    End With\n\n    Application.ScreenUpdating = True\n    MsgBox &quot; Upload To PMO Database Successful.&quot;\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1518623437, "post_id": 48790369, "comment_id": 84584254, "body": "The <code>FROM</code> clause should have Excel sheet name with range, <code>SheetName$[G:M]</code>. First time I ever seen <code>IN</code> used with Excel workbooks. But with double/single quote mix, I would use <code>FROM [Excel 12.0 Xml;HDR=No;Database=C:\\Path\\To\\Workbook.xlsx].[SheetName$G:M&zwnj;&#8203;]</code>. But adding this to my notes."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1518623805, "post_id": 48790369, "comment_id": 84584483, "body": "Yes, the quote mix is a bit weird. I&#39;ve adopted it to avoid Access from casting two single quotes to a literal double quote in the SQL, and to not have a <i>lot</i> of quotes to account for that. The non-IN clause syntax is much more clear (I&#39;m a bit less familiar with it). Specifying the sheet name is only necessary when there are multiple sheets, but a nice addition. I&#39;ve edited into my answer."}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518626948, "post_id": 48790369, "comment_id": 84586769, "body": "Thanks for the response! agreed a trigger from access would be easier but I&#39;m developing this for someone that doesn&#39;t want to use access only excel sheets. I am now getting an error 3127 - my table names are correct but its saying that there an unknown field - anything obvious I&#39;m missing?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518627543, "post_id": 48790369, "comment_id": 84587175, "body": "Have you replaced the <code>etc</code> with all the other fields? That&#39;s short for <a href=\"https://en.wikipedia.org/wiki/Et_cetera\" rel=\"nofollow noreferrer\">et cetera</a>"}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518690044, "post_id": 48790369, "comment_id": 84612301, "body": "Yep sure have - &quot;INSERT INTO [Fact Table] ([GUID],[StageID],[EDB Sync Date],[Forecast HP],[Owner Id],[Recent Modified Flag],[Upload Date]) &quot; &amp; _     &quot;SELECT * FROM [EDITS$G:M] &quot; &amp; _     &quot;IN &quot;&quot;&quot; &amp; ActiveWorkbook.FullName &amp; &quot;&quot;&quot;&#39;Excel 12.0 Macro;HDR=No;&#39;&quot; - I&#39;ve tried using underscores, exclamation marks thinking that is was something stupid. is there anything in the above that sticks out as a problem? would the spaces be causing the problem?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518690649, "post_id": 48790369, "comment_id": 84612718, "body": "Eh, that certainly is strange. You could use <code>SELECT F1, F2, F3, F4, F5, F6, F7</code> instead of <code>SELECT *</code> to make the fields from the lower part explicit. Spaces shouldn&#39;t be a problem if you&#39;re properly using brackets, which you are as far as I can see."}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518692770, "post_id": 48790369, "comment_id": 84614130, "body": "Select F1 etc. worked perfectly! thanks for your help Erik!! much appreciated!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 4, "last_activity_date": 1518623953, "last_edit_date": 1518623953, "creation_date": 1518621027, "answer_id": 48790369, "question_id": 48788609, "link": "https://stackoverflow.com/questions/48788609/importing-excel-worksheet-range-to-ms-access-table/48790369#48790369", "title": "Importing Excel worksheet range to Ms Access Table", "body": "<p>You can use a query instead of iterating through a recordset:</p>\n\n<pre><code>Sub AccessCode()\n    Application.ScreenUpdating = False\n    Dim db As Database\n    Dim rs As DAO.Recordset\n\n    Set db = OpenDatabase(\"C:\\Users\\user\\Desktop\\Test Copy.accdb\")\n    db.Execute \"INSERT INTO [Fact Table] ([GUID], [StageID], etc) \" &amp; _\n    \"SELECT * FROM [SheetName$G:M] \" &amp; _\n    \"IN \"\"\" &amp; ActiveWorkbook.FullName &amp; \"\"\"'Excel 12.0 Macro;HDR=No;'\"\nEnd Sub\n</code></pre>\n\n<p>This has numerous advantages, such as often being faster because you don't have to iterate through all the fields.</p>\n\n<p>If you would trigger the import from Access instead of Excel, you wouldn't even need VBA to execute the query.</p>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518629953, "post_id": 48793149, "comment_id": 84588444, "body": "That&#39;s certainly more nicely wrapped, full-featured solution, but what&#39;s with the <code>ADODB.Connection</code> and <code>ADODB.Recordset</code>? Also, you&#39;re assuming row 1 contains headings (which it probably should, but that hasn&#39;t been specified)"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518633812, "post_id": 48793149, "comment_id": 84590404, "body": "@ErikvonAsmuth Ah you&#39;re so right. I was using this in a different way before. I guess I didn&#39;t totally clean it up. And you&#39;re right about the column headers. I guess You could modify the <code>strCon</code> string/have that be an input parameter."}, {"owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518690146, "post_id": 48793149, "comment_id": 84612367, "body": "Looks great! but this would be importing from access? i am trying to ( and failing so far) to do this from excel into access"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "edited": false, "score": 0, "creation_date": 1518690710, "post_id": 48793149, "comment_id": 84612771, "body": "@SIRO1 if you use your <code>db.</code> instead of <code>CurrentDb</code>, you can run this from Excel"}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1518633860, "last_edit_date": 1518633860, "creation_date": 1518629796, "answer_id": 48793149, "question_id": 48788609, "link": "https://stackoverflow.com/questions/48788609/importing-excel-worksheet-range-to-ms-access-table/48793149#48793149", "title": "Importing Excel worksheet range to Ms Access Table", "body": "<p>Just thought I'd add in an alternative to @Erik von Asmuth's excellent answer. I use something like this in a real project. It's a little more robust for importing a dynamic range.</p>\n\n<pre><code>Public Sub ImportFromWorksheet(sht As Worksheet)\n\n    Dim strFile As String, strCon As String\n\n    strFile = sht.Parent.FullName\n\n    strCon = \"Excel 12.0;HDR=Yes;Database=\" &amp; strFile\n\n    Dim strSql As String, sqlTransferFromExcel As String\n\n    Dim row As Long\n    row = sht.Range(\"A3\").End(xlDown).row\n    Dim rng As Range\n\n    sqlTransferFromExcel = \" Insert into YourTable( \" &amp; _\n                \" [GUID] \" &amp; _\n                \" ,StageID \" &amp; _\n                \" ,[sync Date] \" &amp; _\n                \" ,[etc...] \" &amp; _\n                \" ) \" &amp; _\n                \" SELECT [GUID] \" &amp; _\n                \" ,StageID \" &amp; _\n                \" ,[sync Date] \" &amp; _\n                 \" ,[etc...] \" &amp; _\n                \" FROM [{{connString}}].[{{sheetName}}$G2:M{{lastRow}}]\"\n\n    sqlTransferFromExcel = Replace(sqlTransferFromExcel, \"{{lastRow}}\", row)\n    sqlTransferFromExcel = Replace(sqlTransferFromExcel, \"{{connString}}\", strCon)\n    sqlTransferFromExcel = Replace(sqlTransferFromExcel, \"{{sheetName}}\", sht.Name)\n\n    CurrentDb.Execute sqlTransferFromExcel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9360236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6741c3ec32054bc19c2d2fb8b9bdd16?s=128&d=identicon&r=PG&f=1", "display_name": "SIRO1", "link": "https://stackoverflow.com/users/9360236/siro1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3384, "favorite_count": 0, "accepted_answer_id": 48790369, "answer_count": 3, "score": 2, "last_activity_date": 1518633860, "creation_date": 1518615577, "last_edit_date": 1518623498, "question_id": 48788609, "link": "https://stackoverflow.com/questions/48788609/importing-excel-worksheet-range-to-ms-access-table", "title": "Importing Excel worksheet range to Ms Access Table", "body": "<p>Good Afternoon,</p>\n\n<p>I have created a Macro that uploads data to a access database ( both on my desktop). The problem is it I keep getting errors when I try to expand the range. </p>\n\n<p>I presumed it would be something simple but seems to be something I am overlooking.</p>\n\n<p>here is the code - basically I would like to include the column or set it to a dynamic range? can you please help? </p>\n\n<pre><code>Sub AccessCode()\n\n    Application.ScreenUpdating = False\n\n    Dim db As Database\n    Dim rs As DAO.Recordset\n\n    Set db = OpenDatabase(\"C:\\Users\\user\\Desktop\\Test Copy.accdb\")\n    Set rs = db.OpenRecordset(\"Fact Table\", dbOpenTable)\n\n    rs.AddNew\n    rs.Fields(\"GUID\") = Range(\"g2\").Value\n    rs.Fields(\"StageID\") = Range(\"h2\").Value\n    rs.Fields(\"Sync Date\") = Range(\"i2\").Value\n    rs.Fields(\"Forecast HP\") = Range(\"j2\").Value\n    rs.Fields(\"Owner Id\") = Range(\"k2\").Value\n    rs.Fields(\"Recent Modified Flag\") = Range(\"L2\").Value\n    rs.Fields(\"Upload Date\") = Range(\"M2\").Value\n\n    rs.Update\n    rs.Close\n    db.Close\n\n    Application.ScreenUpdating = True\n    MsgBox \" Upload To PMO Database Successful.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9360102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8N1wc.jpg?s=128&g=1", "display_name": "Amanda", "link": "https://stackoverflow.com/users/9360102/amanda"}, "edited": false, "score": 0, "creation_date": 1518618533, "post_id": 48789016, "comment_id": 84580853, "body": "Hi Xabier, Thank you for your reply.  I gave the code a try but it isn&#39;t quite achieving what I&#39;m looking for.  Instead of it pasting to a new sheet, I&#39;m hoping to have it paste into the same sheet &#39;clean_report&#39; in a set column let&#39;s say column &#39;PB&#39; for example.   But, I only want it to paste into the visible cells.  That way the rows are still matched up in order.  The data filter starts at column OM so the data  needs to be in corresponding row as A - OL.  Hope that makes sense."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 17, "user_id": 9360102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8N1wc.jpg?s=128&g=1", "display_name": "Amanda", "link": "https://stackoverflow.com/users/9360102/amanda"}, "edited": false, "score": 0, "creation_date": 1518619857, "post_id": 48789016, "comment_id": 84581841, "body": "@Amanda, I&#39;ve updated my answer to reflect your comments, please could you also mark my response as an answer, if it has helped? Thanks."}, {"owner": {"reputation": 17, "user_id": 9360102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8N1wc.jpg?s=128&g=1", "display_name": "Amanda", "link": "https://stackoverflow.com/users/9360102/amanda"}, "edited": false, "score": 0, "creation_date": 1518621084, "post_id": 48789016, "comment_id": 84582698, "body": "Thank you!  I just have to make a couple additions but this got me to what I needed."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1518620156, "last_edit_date": 1518620156, "creation_date": 1518616785, "answer_id": 48789016, "question_id": 48788414, "link": "https://stackoverflow.com/questions/48788414/looping-filter-copy-paste-over-multiple-columns/48789016#48789016", "title": "Looping filter copy paste over multiple columns", "body": "<p>I believe the following code will help you achieve your desired result, it will loop through every 7 columns starting at A until your last Column with data, it will filter that given column with criteria \"Dog\", copy all visible cells and paste into another sheet, in the case below sheet result:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"clean_report\")\n'declare and set your worksheet, amend as required\nDim wsResult As Worksheet: Set wsResult = Sheets(\"result\")\n'declare and set your worksheet, amend as required\nDim LastRow As Long, LastCol As Long, i As Long, ResultRow As Long\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on Column A\nLastcol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n'get the last column with data on Row 1\n\nFor i = 1 To Lastcol Step 7 'go through columns A then H in 7 column intervals\n    ws.Range(ws.Cells(1, 1), ws.Cells(LastRow, Lastcol)).AutoFilter Field:=i, Criteria1:=\"*Dog*\", Operator:=xlAnd\n    'filter by \"Dog\"\n    ws.Range(ws.Cells(2, 1), ws.Cells(LastRow, Lastcol)).SpecialCells(xlCellTypeVisible).Copy\n    'copy all visible cells from A2 to LastRow on LastCol\n    ResultRow = wsResult.Cells(wsResult.Rows.Count, \"A\").End(xlUp).Row + 1\n    'find next free row on result sheet\n    wsResult.Range(\"A\" &amp; ResultRow).PasteSpecial xlPasteAll\n    'paste in free row\n    ws.ShowAllData\n    'remove filter for next iteration of loop\nNext i\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>As per your comment, please find the updated version below, this will loop from column A to OI (in 7 column intervals) and filter for the word \"Dog\" and paste the visible cells to the next available empty row on Column PB:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"clean_report\")\n'declare and set your worksheet, amend as required\nDim wsResult As Worksheet: Set wsResult = Sheets(\"result\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on Column A\n\nFor i = 1 To 399 Step 7 'go through columns A to OI in 7 column intervals\n    ws.Range(ws.Cells(1, 1), ws.Cells(LastRow, 402)).AutoFilter Field:=i, Criteria1:=\"*Dog*\", Operator:=xlAnd\n    'filter by \"Dog\"\n    ws.Range(ws.Cells(2, 1), ws.Cells(LastRow, 402)).SpecialCells(xlCellTypeVisible).Copy\n    'copy all visible cells from A2 to LastRow on LastCol\n    ResultRow = ws.Cells(ws.Rows.Count, \"PB\").End(xlUp).Row + 1\n    'find next free row on result sheet\n    ws.Range(\"PB\" &amp; ResultRow).PasteSpecial xlPasteAll\n    'paste in free row\n    ws.ShowAllData\n    'remove filter for next iteration of loop\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9360102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8N1wc.jpg?s=128&g=1", "display_name": "Amanda", "link": "https://stackoverflow.com/users/9360102/amanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 48789016, "answer_count": 1, "score": 0, "last_activity_date": 1528813154, "creation_date": 1518614908, "last_edit_date": 1531161705, "question_id": 48788414, "link": "https://stackoverflow.com/questions/48788414/looping-filter-copy-paste-over-multiple-columns", "title": "Looping filter copy paste over multiple columns", "body": "<p>I have a large file that comes in as dirty data and needs to be cleaned up.  Some of the data is blended so an advanced filter is needed to show only \"Dog\" then copy visible cells only (range of columns), paste those to a specified column (on the first visible blank cell below header) clear the filter and repeat on the next column.  These columns that need to be searched for \"Dog\" occur every 7 columns.  i.e., A1, H1, O1, etc.  I have this below script that I've been working with to try to get the result I'm looking for.  </p>\n\n<p>2 problems:\n1) when it performs the filter for column 410 it should be copying just visible cells, but after it pastes it's actually including hidden cells when the whole table is unfiltered.\n2) If this script was doing what was expected, Since this action needs to be performed on 50 columns, using select this many times will be extremely slow. </p>\n\n<p>Any help is appreciated!\nThanks </p>\n\n<pre><code>Sub CopyPaste()\n\n    ActiveSheet.Range(\"$A$1:$API$65536\").AutoFilter Field:=403, Criteria1:= _\n    \"=*Dog*\", Operator:=xlAnd\n    Range(\"OM2:ABP65536\").SpecialCells(xlCellTypeVisible).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Cut\n\n    Dim Rng As Variant\n\n    Range(\"ABQ1\").Offset(1, 0).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.SpecialCells(xlCellTypeVisible).Cells(1).Select\n    ActiveSheet.Paste\n    ActiveWorkbook.Worksheets(\"clean_report\").AutoFilter.Sort.SortFields.Clear\n    ActiveSheet.ShowAllData \n    ActiveSheet.Range(\"$A$1:$API$65536\").AutoFilter Field:=410, Criteria1:= _\n    \"=*Dog*\", Operator:=xlAnd\n    Range(\"OT2:ABP65536\").SpecialCells(xlCellTypeVisible).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Cut\n    Range(\"ABQ1\").Offset(1, 0).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.SpecialCells(xlCellTypeVisible).Cells(1).Select\n    ActiveSheet.Paste\n    ActiveWorkbook.Worksheets(\"clean_report\").AutoFilter.Sort.SortFields.Clear\n    ActiveSheet.ShowAllData\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1518615030, "post_id": 48788335, "comment_id": 84578412, "body": "Note: If you use <code>With ActiveSheet</code> then it is completely useless until you start something with a <code>.</code> like <code>.Range(&quot;A1:A&quot; &amp; lastRow).Value2 =</code> otherwise the <code>With</code> statement won&#39;t take effect."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518616060, "post_id": 48788540, "comment_id": 84579100, "body": "Why use <code>Value2</code> at all? You might lose formatting in these kinds of examples"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518616379, "post_id": 48788540, "comment_id": 84579363, "body": "@CallumDA - the OP is using it, thus I assume he has some reason to do so."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518616467, "post_id": 48788540, "comment_id": 84579428, "body": "They also used <code>Value</code> so perhaps they aren&#39;t sure which one to use :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1518616964, "post_id": 48788540, "comment_id": 84579747, "body": "@CallumDA - yup, the usage of <code>.Value2 = .Value</code> is most probably a mistake."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1518615362, "creation_date": 1518615362, "answer_id": 48788540, "question_id": 48788335, "link": "https://stackoverflow.com/questions/48788335/only-copy-visible-range-in-vba/48788540#48788540", "title": "Only copy visible range in VBA?", "body": "<p>To define whether a cell is visible or not, both its column and row should be visible. This means, that the <code>.Hidden</code> property of the column and the row should be set to <code>False</code>. </p>\n\n<p>Here is some sample code of how to copy only the visible ranges between two worksheets.</p>\n\n<p>Imagine that you have an input like this in Worksheets(1):</p>\n\n<p><a href=\"https://i.stack.imgur.com/MRiw5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MRiw5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you manually hide column <code>B</code> and you want to get in <code>Worksheets(2)</code> every cell from the <code>Range(A1:C4)</code>, without the ones in column <code>B</code>. Like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fXbUe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fXbUe.png\" alt=\"enter image description here\"></a></p>\n\n<p>To do this, you should check each cell in the range, whether its column or row is visible or not.\nA possible solution is this one:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim myCell  As Range\n    For Each myCell In Worksheets(1).Range(\"A1:C4\")\n        If (Not Rows(myCell.Row).Hidden) And (Not Columns(myCell.Column).Hidden) Then\n            Dim newCell As Range\n            Set newCell = Worksheets(2).Cells(myCell.Row, myCell.Column)\n            newCell.Value2 = myCell.Value2\n        End If\n    Next myCell    \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Just a general advise - whenever you use something like this <code>Range(\"A1\").Value2 = Range(\"A1\").Value2</code> make sure that both are the same and not the left is <code>Value2</code> and the right is <code>.Value</code>. It probably will not bring what you are expecting.</p>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1518619266, "post_id": 48788641, "comment_id": 84581426, "body": "lots of <code>ActiveSheet</code> and <code>ActiveWorkbook</code> here... ;-)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518620466, "post_id": 48788641, "comment_id": 84582298, "body": "@DisplayName correct even I have lazy moments, but I added a better practice version. Thanks for pointing out."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1518620685, "last_edit_date": 1518620685, "creation_date": 1518615681, "answer_id": 48788641, "question_id": 48788335, "link": "https://stackoverflow.com/questions/48788335/only-copy-visible-range-in-vba/48788641#48788641", "title": "Only copy visible range in VBA?", "body": "<p>Something like <code>.Value2 = .Value</code> doesn't work on special cells of type visible, because \u2026</p>\n\n<p>\u2026 e.g. if <code>lastRow = 50</code> and there are <code>hiddenRows = 10</code> then \u2026</p>\n\n<ul>\n<li>your source <code>Range(\"H1:H\" &amp; lastRow).SpecialCells(xlCellTypeVisible)</code><br>\nhas <code>lastRow - hiddenRows = 40</code> rows </li>\n<li>but your destination <code>Range(\"A1:A\" &amp; lastRow).Value2</code><br>\nhas <code>lastRow = 50</code> rows.</li>\n</ul>\n\n<p>On the first you subtract the visible rows, so they are different in size. Therefore <code>.Value2 = .Value</code> doesn't work, because you cannot fill 50 rows with only 40 source rows.</p>\n\n<p>But what you can do is <code>Copy</code> and <code>SpecialPaste</code></p>\n\n<pre><code>Option Explicit\n\nSub Importe()\n    Dim lastRow As Long\n\n    lastRow = Worksheets(\"Sheet1\").Cells(1, 1).SpecialCells(xlCellTypeVisible).End(xlDown).Row\n\n    Worksheets.Add\n\n    With ActiveSheet\n       ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"H1:H\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Copy\n       .Range(\"A1\").PasteSpecial xlPasteValues\n\n       ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"E1:E\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Copy\n       .Range(\"B1\").PasteSpecial xlPasteValues\n    End With\nEnd Sub\n</code></pre>\n\n<p>Nevertheless I recommend to avoid <code>ActiveSheet</code> or <code>ActiveWorkbook</code> if this is possible and reference a workbook eg by <code>ThisWorkbook</code>. My suggestion:</p>\n\n<pre><code>Option Explicit\n\nSub Importe()\n    Dim SourceWs As Worksheet\n    Set SourceWs = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim DestinationWs As Worksheet\n    Set DestinationWs = ThisWorkbook.Worksheets.Add\n\n    Dim lastRow As Long\n    lastRow = SourceWs.Cells(1, 1).SpecialCells(xlCellTypeVisible).End(xlDown).Row\n\n    SourceWs.Range(\"H1:H\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Copy\n    DestinationWs.Range(\"A1\").PasteSpecial xlPasteValues\n\n    SourceWs.Range(\"E1:E\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Copy\n    DestinationWs.Range(\"B1\").PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1518617370, "last_edit_date": 1518617370, "creation_date": 1518616157, "answer_id": 48788789, "question_id": 48788335, "link": "https://stackoverflow.com/questions/48788335/only-copy-visible-range-in-vba/48788789#48788789", "title": "Only copy visible range in VBA?", "body": "<p>You cannot perform a direct value transfer without cycling though the areas of the SpecialCells(xlCellTypeVisible) collection.</p>\n\n<p>Sometimes it is easier to copy everything and get rid of what you don't want.</p>\n\n<pre><code>Sub Importe()\n    Dim lr As Long\n\n    Worksheets(\"Sheet1\").Copy after:=Worksheets(\"Sheet1\")\n    With ActiveSheet\n        .Name = \"xyz\"\n        .Cells(1, 1).CurrentRegion = .Cells(1, 1).CurrentRegion.Value2\n        For lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 1 Step -1\n            If .Cells(lr, \"A\").EntireRow.Hidden Then\n                .Cells(lr, \"A\").EntireRow.Delete\n            End If\n        Next lr\n        lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        .Cells(1, 1).CurrentRegion.Resize(lr, 1) = .Cells(1, 1).CurrentRegion.Resize(lr, 1).Offset(0, 7).Value2\n        .Cells(1, 1).CurrentRegion.Offset(0, 1).Resize(lr, 1) = .Cells(1, 1).CurrentRegion.Resize(lr, 1).Offset(0, 4).Value2\n        .Columns(\"C:XFD\").EntireColumn.Delete\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518620867, "creation_date": 1518620867, "answer_id": 48790332, "question_id": 48788335, "link": "https://stackoverflow.com/questions/48788335/only-copy-visible-range-in-vba/48790332#48790332", "title": "Only copy visible range in VBA?", "body": "<p>just to throw in an alternative version:</p>\n\n<pre><code>Sub Importe()\n    Dim sht1Rng As Range, sht1VisibleRng As Range\n\n    With Worksheets(\"Sheet1\")\n        Set sht1Rng = .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp))\n    End With\n    Set sht1VisibleRng = sht1Rng.SpecialCells(xlCellTypeVisible)\n\n    With Worksheets.Add\n        .Range(\"A1\").Resize(sht1Rng.Rows.Count).Value2 = sht1Rng.Offset(, 7).Value2\n        .Range(\"B1\").Resize(sht1Rng.Rows.Count).Value2 = sht1Rng.Offset(, 4).Value2\n        .UsedRange.EntireRow.Hidden = True\n        .Range(sht1VisibleRng.Address(False, False)).EntireRow.Hidden = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>which may have the drawback of <code>Address()</code> maximum \"capacity \"</p>\n"}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6300, "favorite_count": 1, "accepted_answer_id": 48788641, "answer_count": 4, "score": 3, "last_activity_date": 1518620867, "creation_date": 1518614675, "question_id": 48788335, "link": "https://stackoverflow.com/questions/48788335/only-copy-visible-range-in-vba", "title": "Only copy visible range in VBA?", "body": "<p>I'm running into an issue where I'm unable to copy only visible cells to a new sheet. I'm able to get the lastrow, but I get #N/A on every cell except the first for each column. I want to just copy the visible cells. I'd also like to only put information on visible rows too, if possible?</p>\n\n<p>Please see my code below:</p>\n\n<pre><code>Sub Importe()\nlastRow = Worksheets(\"Sheet1\").Cells(1, 1).SpecialCells(xlCellTypeVisible).End(xlDown).Row\n\nWorksheets.Add\n\nWith ActiveSheet\n  Range(\"A1:A\" &amp; lastRow).Value2 = _\n  ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"H1:H\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Value\n  Range(\"B1:B\" &amp; lastRow).Value2 = _\n  ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"E1:E\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "add", "ip-address", "vba"], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1518615585, "post_id": 48788469, "comment_id": 84578772, "body": "Thanks for trying to help. Unfortunately it doesn&#180;t seems to do anything. I still get the same IP Address as in the other sheet."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1518615895, "post_id": 48788469, "comment_id": 84578990, "body": "Worked when I tested it with a single cell. Have you stepped through the code to check what is happening?"}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 2, "creation_date": 1518684364, "post_id": 48788469, "comment_id": 84608786, "body": "My bad, I was looking in wrong column. It works as intended. Thanks for your support!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1518615079, "creation_date": 1518615079, "answer_id": 48788469, "question_id": 48788327, "link": "https://stackoverflow.com/questions/48788327/add-2-on-last-octet-in-ip-address/48788469#48788469", "title": "Add 2 on last octet in IP-Address", "body": "<p>Here is one approach (which assumes the values between the dots are numeric and that there are four elements, so might need some error trapping).</p>\n\n<pre><code>For Each c In w1.Range(\"D2\", w1.Range(\"D\" &amp; Rows.Count).End(xlUp))\n    FR = Application.Match(c, w2.Columns(\"A\"), 0)\n    If IsNumeric(FR) Then\n        v = Split(w2.Range(\"N\" &amp; FR).Value, \".\")\n        v(3) = v(3) + 2\n        c.Offset(, 13).Value = Join(v, \".\")\n    End If\nNext c\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 48788469, "answer_count": 1, "score": 0, "last_activity_date": 1518615079, "creation_date": 1518614660, "last_edit_date": 1531164843, "question_id": 48788327, "link": "https://stackoverflow.com/questions/48788327/add-2-on-last-octet-in-ip-address", "title": "Add 2 on last octet in IP-Address", "body": "<p>I use following code to retreive IP-Addresses from one sheet to another.</p>\n\n<pre><code>  For Each c In w1.Range(\"D2\", w1.Range(\"D\" &amp; Rows.Count).End(xlUp))\n  FR = Application.Match(c, w2.Columns(\"A\"), 0)\n  If IsNumeric(FR) Then c.Offset(, 13).Value = w2.Range(\"N\" &amp; FR).Value\n  Next c\n</code></pre>\n\n<p>Is it possible to add 2 (+2) to the last octet at the same time?</p>\n\n<p>Eg. 192.168.0.1 will be 192.168.0.3</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "edited": false, "score": 0, "creation_date": 1518617845, "post_id": 48788548, "comment_id": 84580369, "body": "Thankyou very much @Chronocidal! Any chance you can provide an idea as to why this is needed? Is it simply the case that whilst it is in the buttonclick sub CSV files wont open? <b>Note to others</b>, this didn&#39;t work unless the continuedownloadmacro was in a separate module."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "edited": false, "score": 0, "creation_date": 1518618799, "post_id": 48788548, "comment_id": 84581076, "body": "While the Macro is running, Excel is not accepting &quot;external&quot; instructions (such as from Windows Explorer or Internet Explorer).  You can test this with a very quick macro - <code>Beep</code>, wait for 10 seconds, then <code>Beep</code> again.  After the first <code>Beep</code>, double click on an Excel file to open it up - it won&#39;t open until after the second <code>Beep</code>.  On the other hand, if your Macro was doing &quot;Save As&quot; instead of &quot;Open&quot; then you could use <code>Workbooks.Open</code> to open the CSV file without having to End the Sub first"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1518615388, "creation_date": 1518615388, "answer_id": 48788548, "question_id": 48787790, "link": "https://stackoverflow.com/questions/48787790/when-using-vba-to-open-a-csv-file-directly-from-internet-explorer-i-cant-then-i/48788548#48788548", "title": "When using VBA to open a CSV file directly from internet explorer, I cant then Interact with the file.", "body": "<p>You can split the macro in two by using <code>Application.OnTime</code> - this will let you finish the macro (so that the CSV file can open) and then have a new macro scheduled to start a couple of seconds later:</p>\n\n<pre><code>    'This is the end of CommandButton1_Click\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n    SendKeys \"%(o)\"\n     Dim wb As Workbook\n     DoEvents\n\n    Application.OnTime Now()+TimeSerial(0,0,15), \"ContinueDownloadMacro\"\n    'In 15 seconds the \"ContinueDownloadMacro\" Sub will start\nEnd Sub\n\nPublic Sub ContinueDownloadMacro()\n    Dim wb As Workbook, ws As Worksheet\n\n    Set wb = GetWB\n    Set ws = wb.ActiveSheet\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 48788548, "answer_count": 1, "score": 0, "last_activity_date": 1518615388, "creation_date": 1518612969, "last_edit_date": 1531164843, "question_id": 48787790, "link": "https://stackoverflow.com/questions/48787790/when-using-vba-to-open-a-csv-file-directly-from-internet-explorer-i-cant-then-i", "title": "When using VBA to open a CSV file directly from internet explorer, I cant then Interact with the file.", "body": "<p>So I have written some code to download analytic data from twitter by simulating a button click. It's not pretty code but its all I can find to work for now.</p>\n\n<p>I am successfully managing to click the file download, after which a 'frame notification bar' appears with the open, save options. I am successfully clicking open twice, however this is where I run into problems. The problem being that I then want to interact with the data in the CSV file which I have just chosen to open, however the CSV file doesn't come into existence until after the code finishes running. I know there must be a simple solution to this but I just don't know what to search for.</p>\n\n<p>I have tried to play with Wait and DoEvents to see if that helps but no luck so far. Here is my code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nUserForm1.Hide\nDim appIE As Object\nSet appIE = CreateObject(\"internetexplorer.application\")\n\n\nWith appIE\n    .Navigate \"https://analytics.twitter.com/user/QinetiQ/tweets\"\n    .Visible = True\nEnd With\nDo While appIE.Busy\n    DoEvents\nLoop\nApplication.Wait (Now + TimeValue(\"0:00:04\"))\n\nSet HTMLDoc = appIE.document\n    Set btn = HTMLDoc.getElementsByClassName(\"btn btn-default ladda-button\")(0)\n    btn.Click\n    Application.Wait (Now + TimeValue(\"0:00:07\"))\n    Application.SendKeys \"%{S}\"\n\nDim o As IUIAutomation\n    Dim e As IUIAutomationElement\n    Set o = New CUIAutomation\n    Dim h As Long\n    h = appIE.Hwnd\n    h = FindWindowEx(h, 0, \"Frame Notification Bar\", vbNullString)\n    If h = 0 Then Exit Sub\n    Set e = o.ElementFromHandle(ByVal h)\n    Dim iCnd As IUIAutomationCondition\n    Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, \"Open\")\n    Dim Button As IUIAutomationElement\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n    SendKeys \"%(o)\"\n    Dim wb As Workbook\n    DoEvents\n\n    Application.Wait (Now + TimeValue(\"0:00:15\"))\n    Set wb = GetWB\n    Dim ws As Worksheet\n    Set ws = wb.ActiveSheet\n\nEnd Sub\n\nFunction GetWB() As Workbook\n    Dim wb As Workbook\n wbName = \"tweet\"\n\n    For Each wb In Application.Workbooks\n        If wb.Name Like wbName &amp; \"*\" Then\n            Set GetWB = wb\n            MsgBox (\"Found it\")\n            Exit Function\n        End If\n    Next wb\n    MsgBox (\"failed to find worksheet\")\nEnd Function\n</code></pre>\n\n<p>I know I have used some really bad techniques and apologies for that. Please can anyone help, thankyou.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1518613203, "creation_date": 1518613203, "answer_id": 48787865, "question_id": 48787789, "link": "https://stackoverflow.com/questions/48787789/using-vba-if-then-statement-to-copy-and-paste-data-to-another-workbook/48787865#48787865", "title": "Using VBA If then statement to copy and paste data to another workbook", "body": "<p>Try a loop like this, this will iterate over each cell in define range :</p>\n\n<pre><code>For Each cell In .Range(\"A30:A82\").Cells\n    if cell.Value &gt; 0 Then\n       //your code\n    end if\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9345039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/404efcf3a42b6b56d50b00d560e81632?s=128&d=identicon&r=PG&f=1", "display_name": "Munir", "link": "https://stackoverflow.com/users/9345039/munir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518613203, "creation_date": 1518612968, "last_edit_date": 1531164843, "question_id": 48787789, "link": "https://stackoverflow.com/questions/48787789/using-vba-if-then-statement-to-copy-and-paste-data-to-another-workbook", "title": "Using VBA If then statement to copy and paste data to another workbook", "body": "<p>I am very new to VBA, I need to post all PO data to another workbook with if condition, if condition on column A, from A30 to A82 if any value is greater than Zero on the said cell, then copy the data to another sheet.</p>\n\n<p>Please see my code below. I need help to write the IF condition.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Set wb = Workbooks.Open(\"C:\\Users\\XXX\\DSR\\LPO Auto\\lpodata.xlsx\")\n    Worksheets(\"Food\").Unprotect Password:=\"XXXXXX\"\n\n    NR = wb.Sheets(\"Food\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    With ThisWorkbook.Sheets(\"PO\")\n        'If ActiveSheet.Range(\"A30\").Value &gt; 1 Then\n        Range(\"A30:W83\").Copy\n        wb.Sheets(\"Food\").Range(\"A\" &amp; NR).PasteSpecial xlPasteValues\n        Worksheets(\"Food\").Protect Password:=\"XXXXX\"\n        ActiveWorkbook.Save\n        ThisWorkbook.Activate\n        Worksheets(\"PO\").Range(\"B30:C82\").Select\n        Worksheets(\"PO\").Range(\"B30:C82\").ClearContents\n        Worksheets(\"PO\").Range(\"H30:H82\").Select\n        Worksheets(\"PO\").Range(\"H30:H82\").ClearContents\n        ActiveWorkbook.Save\n\n    End With\n\n\n    'wb.Close savechanges:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "powerpoint", "office-interop"], "comments": [{"owner": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1518612987, "post_id": 48787592, "comment_id": 84577111, "body": "@mjwills I have tried number of solutions but I cant get one to work, Like Copy Paste Solution, Text Work fine but I really want to do it for Charts and Tables that are ranges in Excel"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "edited": false, "score": 0, "creation_date": 1518691879, "post_id": 48791238, "comment_id": 84613544, "body": "Thank you for the answer, But how is the content of the already existing chart in Excel added to the Slide Shape?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "edited": false, "score": 0, "creation_date": 1518704315, "post_id": 48791238, "comment_id": 84621966, "body": "It was not clear from your question that you want to insert content from an existing Excel file... This can certainly be done. Do you need a dynamic link or a static snapshot?"}, {"owner": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "edited": false, "score": 0, "creation_date": 1518705353, "post_id": 48791238, "comment_id": 84622664, "body": "I would like both as dynamic Link would be great help for some task I need to do."}, {"owner": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "edited": false, "score": 0, "creation_date": 1518717630, "post_id": 48791238, "comment_id": 84630637, "body": "I really appreciate your help, this code doesn&#39;t put an already existing chart in excel into a powerpoint slide, Maybe comment will help."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "edited": false, "score": 0, "creation_date": 1518718010, "post_id": 48791238, "comment_id": 84630860, "body": "@AnwarAl-fathli: What does happen? As I mentioned, only the first Sheet in the workbook will show up..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1518709771, "last_edit_date": 1518709771, "creation_date": 1518623670, "answer_id": 48791238, "question_id": 48787592, "link": "https://stackoverflow.com/questions/48787592/excel-listobject-insert-into-powerpoint-shape-in-c/48791238#48791238", "title": "Excel.ListObject insert into PowerPoint.Shape in c#", "body": "<p>Since you post with a VBA tag, here's VBA code that inserts a Chart into PowerPoint. Note that in order to use <code>Excel.Chart</code> or workbook you need a reference to the Excel object model (PIAs) in your solution. Otherwise use the generic <code>object</code>, but then you won't have any Intellisense.</p>\n\n<p>The <code>AddOleObject</code> method is the key for importing something from an OLE Server. Through <code>OLEFormat</code> you get basic information about the object; <code>OLEFormat.Object</code> gives you access to the object, itself. Note that as far as PowerPoint is concerned, this is a Shape object. </p>\n\n<p><strong>Edit</strong>: The lines commented out in the code below create a new object and show how to access the underlying Excel objects.</p>\n\n<p>In order to bring in and link to an existing workbook you need to specify the file name (but not the OLE class!) and that it should be linked. Only the \"top-most\" Sheet in the Workbook will be displayed. Note that the linked object cannot be manipulated like the independent object - the actual file must be opened in Excel. The user can do this by double-clicking the object; code can do it using <code>shp.OLEFormat.DoVerb 1</code>.</p>\n\n<pre><code>Sub InsertExcelChart()\n    Dim p As Presentation\n    Dim s As Slide\n    Dim shp As Shape\n    Dim wb As Excel.Workbook 'Object\n    Dim chart As Excel.chart 'object\n\n    Set p = ActivePresentation\n    Set s = p.Slides(1)\n    Set shp = s.Shapes.AddOLEObject( _\n        FileName:=\"C:\\Users\\Cindy Meister\\Documents\\SampleChart.xlsx\", _\n        Link:=msoTrue, DisplayAsIcon:=msoFalse)\n\n    'Set shp = s.Shapes.AddOLEObject(10, 10, 600, 200, \"Excel.Chart\")\n    'Debug.Print shp.OLEFormat.ProgID, shp.OLEFormat.Object.Name\n\n    'Set wb = shp.OLEFormat.Object\n    'Set chart = wb.Charts(1)\n    'Debug.Print wb.Name\n    'Debug.Print chart.ChartType\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7622465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sw6gNX3bUUg/AAAAAAAAAAI/AAAAAAAAABA/tNvK9WlL0sI/photo.jpg?sz=128", "display_name": "Anwar Al-fathli", "link": "https://stackoverflow.com/users/7622465/anwar-al-fathli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518719323, "creation_date": 1518612328, "last_edit_date": 1518719323, "question_id": 48787592, "link": "https://stackoverflow.com/questions/48787592/excel-listobject-insert-into-powerpoint-shape-in-c", "title": "Excel.ListObject insert into PowerPoint.Shape in c#", "body": "<pre><code> PowerPoint.Shape shapeObject = slide.Shapes(0);\n Excel.ListObject listObject = reader.GetListObject(tableName);\n\n  //code to insert the able into the powerpoint shape.\n</code></pre>\n\n<p>So I would like to put the ListObject, ChartObject from Excel into a Shape in powerpoint, is this possible?</p>\n\n<p><a href=\"https://i.stack.imgur.com/lOcht.png\" rel=\"nofollow noreferrer\">this chart and many other chart will be going into the powerpoint</a>\nSo I know how to pick a Excel.ChartObject from excel sheet or table, but how do I put it as a chart with same content into a slide.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518611645, "post_id": 48787228, "comment_id": 84576175, "body": "what do yo mean by &quot;<i>staticly</i>&quot;?"}, {"owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518611738, "post_id": 48787228, "comment_id": 84576237, "body": "@P\u1d07\u029c I would like to add it as a control object (like refedit or textbox)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518611875, "post_id": 48787228, "comment_id": 84576335, "body": "You can&#39;t add it. It is a stand alone input box like a message box."}, {"owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518611994, "post_id": 48787228, "comment_id": 84576431, "body": "@P\u1d07\u029c ok.. do you know a textbox solution where the user also can select cells, like in inputbox?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518612203, "post_id": 48787228, "comment_id": 84576571, "body": "yes therefore the RefEdit was made. Have a look at <a href=\"http://shutupdean.com/blog/2015/01/08/refedit-control-alternative/\" rel=\"nofollow noreferrer\">RefEdit Control Alternative</a> or Google for &quot;RefEdit Alternative&quot; there are several out there. I guess you will find one that suits your needs."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1518612359, "post_id": 48787228, "comment_id": 84576676, "body": "Or you call the Application.Inputbox when a user clicks on a textbox in your userform and return the result to your textbox. PS Xabier was a little bit faster than I"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1518612379, "creation_date": 1518612379, "answer_id": 48787611, "question_id": 48787228, "link": "https://stackoverflow.com/questions/48787228/how-to-use-application-inputbox-static-in-a-userform/48787611#48787611", "title": "How to use Application.Inputbox &quot;static&quot; in a Userform", "body": "<p>Not sure I understand correctly, but why not do something like below, this will bring up the Input for the range and then add the address details to a Textbox:</p>\n\n<pre><code>Sub foo()\nDim myRange As Range\n    Set myRange = Application.InputBox(prompt:=\"Sample\", Type:=8)\n    TextBox1.Text = myRange.Address\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518612379, "creation_date": 1518611247, "last_edit_date": 1531164843, "question_id": 48787228, "link": "https://stackoverflow.com/questions/48787228/how-to-use-application-inputbox-static-in-a-userform", "title": "How to use Application.Inputbox &quot;static&quot; in a Userform", "body": "<p>I worked with RefEdit but it gives incredibly inconsistent results (<a href=\"https://peltiertech.com/using-refedit-controls-in-excel-dialogs/\" rel=\"nofollow noreferrer\">listed here</a>). I like the Application.Inputbox solution:  </p>\n\n<pre><code>Set myRange = Application.InputBox(prompt:=\"Sample\", Type:=8)\n</code></pre>\n\n<p>Since you can input Text or select cells while it is open. How can I use this versatile Inputbox \"staticly\" in a Userform? I couldn't find it in \"Additional Controls\"...<br>\nI tried a RefEdit a thousand times and it breaks 999times... so I would like to avoid it - thx</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1518611132, "post_id": 48787090, "comment_id": 84575806, "body": "&quot;I&#39;m using the &#39;call&#39; way&quot; -- why? <code>Call replaceColumns</code> is equivalent to <code>replaceColumns</code>. The keyword <code>Call</code> is legacy cruft. Also, replacing <code>&quot;2&quot;</code> by <code>&quot;2&quot;</code> is unmotivated to say the least. If you want to trigger a calculation, just use <code>Application.Calculate</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1518611273, "post_id": 48787090, "comment_id": 84575909, "body": "Replace <code>ActiveWorkbook</code> with <code>ThisWorkbook</code> and avoid using  <code>.Select</code> and <code>Selection.</code> (there are many tutorials on Google how to avoid them)."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518611452, "post_id": 48787090, "comment_id": 84576040, "body": "See this for more on <code>Call</code>: <a href=\"https://stackoverflow.com/q/479891/4996248\">stackoverflow.com/q/479891/4996248</a>"}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518611616, "post_id": 48787090, "comment_id": 84576154, "body": "without the call part, still not working. I&#39;ve already tried."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518611783, "post_id": 48787090, "comment_id": 84576273, "body": "I&#39;ve tried almost everything. That&#39;s how I discovered that with a breakpoint, yeah it stops in that line and executes it, but without it, it just skip the method called"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518612185, "post_id": 48787090, "comment_id": 84576555, "body": "How do you tell if &quot;2&quot; isn&#39;t being replaced by &quot;2&quot;?"}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518612289, "post_id": 48787090, "comment_id": 84576627, "body": "@JohnColeman The replacing is a bad &quot;solution&quot;, but the formula are inside a table, so it calculates automatically. I discovered that if I want to callculate, I had to enter into the cell where I get a number and the go to another cell, and it calculate. So I made that line to replace a number that will be ALWAYS in the cell to calculate the formula"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1518612293, "post_id": 48787090, "comment_id": 84576632, "body": "Replacing 2 with 2 in one column may be so fast that you may not notice it. Insert a <code>debug.print something</code> in the replaceColumns and you can see if the macro runs."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518612333, "post_id": 48787090, "comment_id": 84576652, "body": "Why not just use <code>Application.Calculate</code>? This is equivalent to pressing <code>F9</code> on the user interface."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518612667, "post_id": 48787090, "comment_id": 84576905, "body": "Application.Calculate is not working in this case, I tried it before doing that lines. until I don&#39;t &quot;change&quot; the data in the row that I&#39;m taking for the formula, the formula doesn&#39;t calculate"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1518613373, "post_id": 48787090, "comment_id": 84577360, "body": "What do you mean Application.Calculate is &quot;not working&quot;? How do you know? And how do you know the &quot;Call replaceColumns&quot; is not working? Add a line like &quot;MsgBox &#39;In replaceColumns&#39;&quot; to the replaceColumns sub to see if it gets called or not. I bet you it does get called, you only think it doesn&#39;t."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518613516, "post_id": 48787090, "comment_id": 84577456, "body": "<i>What</i> isn&#39;t calculating? If a dependent cell changes (or any dependent cell is volatile) then <code>Application.Calculate</code> should work. Is it a VBA function used as a UDF which isn&#39;t calculating? In that case, add <code>Application.Volatile</code> to the definition of the function. Without seeing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it is hard to do anything more than guess."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518620913, "post_id": 48787090, "comment_id": 84582592, "body": "Sorry for the confusion with the application.calculate is not working. It IS working, BUT in my case is not the solution. I&#39;m gonna try to explain it in a few comments. First I should explain you the structure of excel to make you understand what is happening. 2 sheets: sheet1: I have 3 columns, id and status(only ok or ko),and another column(there are the formula). sheet2: all the id that are ok. In the sheet1, I get data from a sql database as a table."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518621279, "post_id": 48787090, "comment_id": 84582831, "body": "The formula is(in the first row): = IF.ERROR(VLOOKUP(A2;tabConfluence;2;FALSE);&quot;KO&quot;) Which means that I look for my id in the other sheet, and it returns me the ok(if the id is in the second sheet) OR put KO in case it is not. In ALL the rows, I get KO, because the excel can&#39;t look for the id. What is the solution I found? replace a number(it always starts with the same number) for the same number, and ta daah! it works! Ok but now, I need to do this in a macro. When I call the macro, it does not change. That&#39;s why I have a problem."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518621450, "post_id": 48787090, "comment_id": 84582960, "body": "Is possible that excel doesn&#39;t wait until the refresh is done and it execute the replaceColumns before the sheet RFS has been refreshed? I forgot to explain you that I have more sheets to refresh, that&#39;s why I suppose it could be the problem"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518616241, "post_id": 48788752, "comment_id": 84579252, "body": "This seems more like a comment than an answer. If this was the issue, the attempt to call it from outside its scope would raise an error, which is <i>not</i> the problem that OP describes."}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518616293, "post_id": 48788752, "comment_id": 84579296, "body": "It doesn&#39;t let me comment in the block above because I don&#39;t have 50 oints yet, sorry."}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518616812, "post_id": 48788752, "comment_id": 84579652, "body": "I&#39;m not trying to get 50 point, I thought my suggestion could help and I dind&#39;t have any other option. Sorry."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518621667, "post_id": 48788752, "comment_id": 84583103, "body": "Thank you, That&#39;s what I thought coming back home. May be the problem is that excel is not waiting till the refresh finishes to do the replaceColumns, and it is doing it before the RFS sheet refreshes, so I lose the replacement. Still don&#39;t know how is possible that if I put a breakpoint it works perfect, and does the replaceColumns at the end"}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "edited": false, "score": 0, "creation_date": 1518623014, "post_id": 48788752, "comment_id": 84583965, "body": "Did you try putting a &quot;Sleep 2000&quot; after RefreshAll? I updated my response!"}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518624149, "post_id": 48788752, "comment_id": 84584712, "body": "Not yet, tomorrow morning I\u2019ll try. I\u2019m at home right now, but I\u2019m pretty sure that it isn\u2019t waiting till refreshing ends. Why? Because I put a message box inside the replaceColumns macro, and it shows before the refreshing ends, so the replaceColumns is working but it dissapears when refreshing RFS happens"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518624284, "post_id": 48788752, "comment_id": 84584833, "body": "You have added enough to your original answer so that it is now much more than a comment. +1"}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 1, "creation_date": 1518624931, "post_id": 48788752, "comment_id": 84585328, "body": "Thanks JohnColeman :) I have 50+points now. Won&#39;t Answer instead of commenting anymore.  @arnauinfantepin&#243;s Let us know. This is probably why with the breakpoint works, by stopping there you are giving Excel chance to refresh."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518625033, "post_id": 48788752, "comment_id": 84585399, "body": "@AlexMartinez I hope that you now answer in addition to (rather than instead of) commenting."}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518682022, "post_id": 48788752, "comment_id": 84607503, "body": "@AlexMartinez Still not working. The Sleep 2000 stops the whole macro, even the refreshing. I&#39;ve tried with more time(20 seconds) but still not working. It&#39;s crazy how it works, it stops the refreshing to continue with the next line and then keeps refreshing"}, {"owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1518682775, "post_id": 48788752, "comment_id": 84607922, "body": "Got it! I had to disable the checkbox in all my querytables properties that says: Enable background refresh. Now it refresh and then continue with the next line. Thank you so much for the help"}], "tags": [], "owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "is_accepted": true, "score": 1, "last_activity_date": 1518623298, "last_edit_date": 1518623298, "creation_date": 1518616017, "answer_id": 48788752, "question_id": 48787090, "link": "https://stackoverflow.com/questions/48787090/call-sub-in-vba-excel-not-working-properly/48788752#48788752", "title": "Call sub in vba excel not working properly", "body": "<p>Did you try making the Sub Public. Like:</p>\n\n<pre><code>Public Sub replaceColumns()    \n   With ThisWorkbook.Sheets(\"RFS\")\n       .Columns(\"A\").Replace _\n          What:=\"2\", Replacement:=\"2\", _\n          SearchOrder:=xlByColumns, MatchCase:=True\n   End With\nEnd Sub\n</code></pre>\n\n<p>Also, for the first procedure, try to put a Sleep command to ensure you wait until Excel finishes refreshing. </p>\n\n<pre><code>Sub actualizarDatos()   \n     Sheets(\"DATOS CITAS\").Select\n     Range(\"A1\").Select\n     Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n\n     ActiveWorkbook.RefreshAll\n     Sleep 2000\n     Call replaceColumns\n\n     Sheets(\"Resumen\").Activate\nEnd Sub\n</code></pre>\n\n<p>And put this code in the top of module:</p>\n\n<pre><code>#If VBA7 Then\n  Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#Else\n   Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#End If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7915011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a2b9e6daf39f1fe21e363db942b77b?s=128&d=identicon&r=PG&f=1", "display_name": "arnau infante pin&#243;s", "link": "https://stackoverflow.com/users/7915011/arnau-infante-pin%c3%b3s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4588, "favorite_count": 0, "accepted_answer_id": 48788752, "answer_count": 1, "score": 1, "last_activity_date": 1518683720, "creation_date": 1518610819, "last_edit_date": 1518683720, "question_id": 48787090, "link": "https://stackoverflow.com/questions/48787090/call-sub-in-vba-excel-not-working-properly", "title": "Call sub in vba excel not working properly", "body": "<p>I need to call a macro from another macro and I'm using the 'call' way. I don't understand why it doesn't work properly, unless you put a breakpoint in the call line. </p>\n\n<p>See. I have this: </p>\n\n<pre><code>Sub actualizarDatos()   \n     Sheets(\"DATOS CITAS\").Select\n     Range(\"A1\").Select\n     Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n\n     ActiveWorkbook.RefreshAll\n\n     Call replaceColumns\n\n     Sheets(\"Resumen\").Activate\nEnd Sub\n</code></pre>\n\n<p>The first part is written like this because I had some problems with a large sheet. It made my excel stop.</p>\n\n<p>The macro that I'm calling looks like this:</p>\n\n<pre><code> Sub replaceColumns()    \n   With ThisWorkbook.Sheets(\"RFS\")\n       .Columns(\"A\").Replace _\n          What:=\"2\", Replacement:=\"2\", _\n          SearchOrder:=xlByColumns, MatchCase:=True\n   End With\nEnd Sub\n</code></pre>\n\n<p>Why do I need the second macro? Because a column with formula didn't update automatically, so this macro \"modify\" a cell which is been used in the formula.</p>\n\n<p>But let's go with the important part and the main q\u00fcestion: </p>\n\n<p>Why the call part is not working?\n-if I execute the first macro in RFS sheet(The sheet in the second macro) it works! But I have to update it from a button in another sheet, so it isn't the answer.\n- if I put a breakpoint and execute the first macro from in a random sheet, it works. </p>\n\n<p>I've also tried with the macro name directly, not using 'Call'. Not working. And even writing the macro content directly inside the first macro, where the call line is written, it doesn't work!!\nFor some reason it misses that line. Does anyone know why? </p>\n\n<p>Thank you!</p>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>SOLVED</p>\n\n<p>I had to do something in the configuration of my tables. If someone have the same problem with the refreshing, just to the next:</p>\n\n<p>For each table you will refresh in RefreshAll, select it and go to Design in the top menu. Now go to properties and uncheck the checkbox that says: Enable backgroud refresh. \nThis is how it looks:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ly9tj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ly9tj.png\" alt=\"properties window to change the refresh settings of a table\"></a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1518613379, "post_id": 48787011, "comment_id": 84577365, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45573460/how-to-make-a-vba-code-in-a-form-that-show-hides-query-columns-ms-access\">How to make a vba code in a form that show/hides query columns? ( MS- Access)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "edited": false, "score": 0, "creation_date": 1518614728, "post_id": 48787584, "comment_id": 84578200, "body": "Thanks for the reply. Is it possible to do only through SQL query without using VBA"}, {"owner": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "edited": false, "score": 0, "creation_date": 1518626005, "post_id": 48787584, "comment_id": 84586112, "body": "It seems that this may work. I will try. If I replace monthname with reference to the text box on the form where user will select month than the result will be correct. Thanks."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1518636929, "post_id": 48787584, "comment_id": 84592052, "body": "You could use <code>switch</code> instead of nesting 12 <code>IIF</code>s.This looks needlesly complex, unless you really like parentheses."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1518618149, "last_edit_date": 1518618149, "creation_date": 1518612311, "answer_id": 48787584, "question_id": 48787011, "link": "https://stackoverflow.com/questions/48787011/selecting-columns-for-display-based-on-user-criterion-in-msaccess/48787584#48787584", "title": "Selecting columns for display based on user criterion in MSAccess", "body": "<p>Create a query where you set the SQL dynamically:</p>\n\n<pre><code>Dim qd As DAO.QueryDef\nDim SQL As String\nDim MonthName As String\n\nMonthName = \"Feb\"  ' Month to search.\n\nSet qd = CurrentDb.QueryDefs(\"YourQuery\")\nSQL = \"Select [GL Code], [year], [\" &amp; MonthName &amp; \"] As Amount From YourTable\"\nqd.SQL = SQL    \n</code></pre>\n\n<p>Now, open the query or open a recordset using the query as source.</p>\n\n<p><strong>SQL only</strong>:</p>\n\n<pre><code>Select \n    [GL Code], \n    [year], \n    IIf(MonthName = 'Jan', [Jan],\n    IIf(MonthName = 'Feb', [Feb],\n    IIf(MonthName = 'Mar', [Mar],\n    IIf(MonthName = 'Apr', [Apr],\n    IIf(MonthName = 'May', [May],\n    IIf(MonthName = 'Jun', [Jun],\n    IIf(MonthName = 'Jul', [Jul],\n    IIf(MonthName = 'Aug', [Aug],\n    IIf(MonthName = 'Sep', [Sep],\n    IIf(MonthName = 'Oct', [Oct],\n    IIf(MonthName = 'Nov', [Nov],\n    IIf(MonthName = 'Dec', [Dec])))))))))))) As Amount\nFrom \n    YourTable\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 48787584, "answer_count": 1, "score": 0, "last_activity_date": 1518618149, "creation_date": 1518610531, "question_id": 48787011, "link": "https://stackoverflow.com/questions/48787011/selecting-columns-for-display-based-on-user-criterion-in-msaccess", "title": "Selecting columns for display based on user criterion in MSAccess", "body": "<p>I have an access table with columns</p>\n\n<p>Account Id, account description, GL Code, year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec. The months columns holds the amount.</p>\n\n<p>I want if user selects Jan on Form than Account Id, account description, Gl code,year and Jan gets displayed. Similarly if user selects Feb than Account Id account description, gl code, year and Feb gets displayed. Similarly for other months.</p>\n\n<p>Have no idea on how to do this. To my knowledge we can filter rows but not the columns.</p>\n\n<p>Please suggest if any possible solution. Please note that I cannot change the database design as the data is getting downloaded from ERP package.</p>\n"}, {"tags": ["vba", "excel", "find", "wildcard"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1518609914, "post_id": 48786750, "comment_id": 84574978, "body": "Are your sentences made of words separated by <i>space</i> characters??"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1518609991, "post_id": 48786750, "comment_id": 84575032, "body": "Yes they are, I hope the images are available to you? The sentence examples are in the column B and C image (Sheet 2)"}, {"owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "edited": false, "score": 0, "creation_date": 1518610022, "post_id": 48786750, "comment_id": 84575053, "body": "How about the &#39;InStr&#39; Function? <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/instr-function\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1518610089, "post_id": 48786750, "comment_id": 84575097, "body": "Or <code>Split</code> and loop."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "edited": false, "score": 0, "creation_date": 1518610154, "post_id": 48786750, "comment_id": 84575146, "body": "Hey @sporc, thanks for the reply! I have been researching for days on what to do, but just hoped there was a simpler way. I am by no way good at VBA and have tried everything to get it to compare / researched. Any advice would be helpful :)"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518610346, "post_id": 48786750, "comment_id": 84575267, "body": "Hi @SJR, I couldn&#39;t find much information on the split function - well enough for an amateur to understand. Any tips on simplifying the function? If there was a way to get a wild card on the &quot;ActiveCell.Value&quot; I feel that would work but I tried everything and nothing helped."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1518610370, "post_id": 48786750, "comment_id": 84575280, "body": "Try doing things the other way round - rather than trying to look up part of <code>i</code> in <code>FML</code>, loop through <code>FML</code> and try and find those values within <code>i</code> ."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1518610638, "post_id": 48786750, "comment_id": 84575469, "body": "Hi @bobajob, I considered that option, but I guess the underlying problem is that I am too out of my depth with coding such comparisons? I tried using Strcomp etc but since I am learning as I am doing I failed miserably. Is this change a simple change that I am missing ?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1518610993, "post_id": 48786750, "comment_id": 84575713, "body": "Split will turn your string into an array of words and then you can loop through each to see if any of them match the column A entries, and @bobajob&#39;s approach is better."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518611239, "post_id": 48786750, "comment_id": 84575888, "body": "@SJR so if I referenced my activecell, will it split the sentence using the space characters? I will give it a go here, but it may take me a while lol. Yes I will see what I can do with bobajob&#39;s advice also. Thanks"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518611386, "post_id": 48786750, "comment_id": 84575982, "body": "Yes, <code>Split(&quot;The quick brown fox&quot;)</code> returns an array of four elements each containing one word. You can specify a delimiter but by default it is a space so you need not include it. If you get stuck, post back with the code you&#39;ve tried."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518612481, "post_id": 48786750, "comment_id": 84576771, "body": "Hi @SJR, just one last pointer, once I split the activecell up, how do I reference each of the words within the split so that I can get each one to loop through? This is particularly difficult for the countIf part. The code I have attempted will foloow"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1518612500, "post_id": 48786750, "comment_id": 84576783, "body": "Do Until ActiveCell.value = &quot;&quot; Set i = ActiveCell WrdArray() = Split(i, , , vbTextCompare) Set Splitsentence = WrdArray.value  count = Application.WorksheetFunction.CountIf(FML, Splitsentence)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518612824, "post_id": 48786750, "comment_id": 84577001, "body": "Can you add the code to your question please as it&#39;s hard to read in a comment. You have an array so array(0), array(1) etc where array is the whatever variable name you assign to the split. I&#39;ll post some code in a bit. Can you explain why you have repeated items in column A? And what is the ultimate desired result of the code?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1518614874, "post_id": 48786750, "comment_id": 84578301, "body": "I have repeated items in column A as for that specific word eg &quot;charge&quot; there are a certain number of associated terms with it (which are found in the same sheet in column B). I repeated the word to make it easier to find all of the associated terms with that specific word, as if there were spaces the code wouldn&#39;t be able to search all of Column A that is used? The ultimate desired result of the code is long - I will post in another comment"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1518615028, "post_id": 48786750, "comment_id": 84578411, "body": "The ultimate desired result is to compare activecell Column B Sheet (2) with column A Sheet(1). Then count how many matches there are to the word e.g. &quot;charge&quot;, input the number of rows into sheet(2) below the activecell = number of matches. Then once inserted, find the matches and copy the column B in sheet (1) beside the matches, to sheet (2) in column C (column and cells beside the activecell in sheet(2)). - I have got it to do everything but being able to find key words out of the sentences. Otherwise everything else works well."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519052667, "post_id": 48786750, "comment_id": 84741285, "body": "@SJR Any further advice that you have possibly? Stumped at this one to be honest."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519052934, "post_id": 48786750, "comment_id": 84741443, "body": "Forgot about this one. In terms of the output can you add to your screenshot what you would expect the code to produce because I&#39;m not 100% clear currently? For &quot;Charge the desired substance&quot; would you expect B3 to B7 to be copied alongside?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519053543, "post_id": 48786750, "comment_id": 84741839, "body": "Hey @SJR, I added the final output in the question - could someone please make it visible as I don&#39;t have that option as yet. Yes you are correct, it is to copy the column B (sheet 1) values for each match into sheet 2 (column C). Hope this makes it clearer"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519053890, "post_id": 48786750, "comment_id": 84742050, "body": "OK, but atm you have two consecutive entries in column B on sheet2 but in your output each of them would need to be repeated (5 and 3 times respectively) so are you ok to just move rows down to accommodate these extra rows? Would it be easier to put the results in a third sheet?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519054085, "post_id": 48786750, "comment_id": 84742164, "body": "Yes I need the sentences to be copied down once the rows are added if that makes sense? To give the answer I put up above. Thanks"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519055853, "post_id": 48786750, "comment_id": 84743240, "body": "See suggested answer below."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519055935, "post_id": 48869627, "comment_id": 84743295, "body": "Hi @SJR, this works for the first one, but stops at that?. Is it possible that it doesn&#39;t delete the entire column B in sheet 2 as this will be filled maybe down to 500 rows? Is there anyway for it to continue down through the whole range in column B until no more sentences are left."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519056098, "post_id": 48869627, "comment_id": 84743387, "body": "Sorry forgot to mention that the document always starts on row 3 for sheet 2? I changed that in the code during my trial but I couldn&#39;t get the code to work through more than one sentence within column B"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519058295, "post_id": 48869627, "comment_id": 84744664, "body": "Can you do as I suggested above and try the code on a workbook set out just as you have done in your screenshots? I think the problems are artefacts of how your actual data are laid out - I can&#39;t see why it would stop after one unless it doesn&#39;t find any matches."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519059265, "post_id": 48869627, "comment_id": 84745199, "body": "Hi, I inputted it into my workbook, and it stops after the first charge example. I then put &quot;Hold&quot; into cell B3 and it comes up &quot;Type Mismatch&quot; error. The clear contents means that it will stop on itself, as it clears it and then tries to compare against nothing? In my code I got it to compare and count the number in sheet 1, and then insert the number of rows -1 equal to that count."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519059377, "post_id": 48869627, "comment_id": 84745261, "body": "It puts the data in an array and based on that so deleting the cells doesn&#39;t affect it. I don&#39;t really understand what you are doing differently - it works for me. When you say &quot;stops&quot;, what exactly do you mean? Do you get any results, an error message...?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519059556, "post_id": 48869627, "comment_id": 84745358, "body": "It doesn&#39;t seem to work for any other key word (eg &quot;hold&quot; from sheet 1 column A) except &quot;charge&quot;. It clears the column and will only ever generate 5 x &quot;charge the desired substance.&quot; It also brings up a run-time error for any other word except charge?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519059822, "post_id": 48869627, "comment_id": 84745489, "body": "We&#39;re going round in circles here. I don&#39;t know if you tested as I suggested. Also step through the code to check what it&#39;s doing, observe the values of variables etc, see if you can find the problem."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519061703, "post_id": 48869627, "comment_id": 84746405, "body": "Ok so I went through the local window, testing as you said. I tried two &quot;Charge the desired substance&quot; and one &quot;Hold for NLT 15 hrs&quot;. It returned only the &quot;charge&quot; values and deleted the &quot;Hold&quot; sentence - which I put in the row between each &quot;Charge the desired substance&quot; rows. It only seems to be able to account for the word charge and I couldn&#39;t tell why from the locals window? Also, is it possible that it doesn&#39;t delete the sentence that it doesn&#39;t recognize?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519063005, "post_id": 48869627, "comment_id": 84747046, "body": "Do you have any gaps in the data in sheet1?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519064519, "post_id": 48869627, "comment_id": 84747864, "body": "No I don&#39;t, the locals window is reading through 47 as well, which is how many rows are filled. I really can&#39;t understand why it only works for charge :/"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519065492, "post_id": 48869627, "comment_id": 84748338, "body": "I&#39;m baffled too. See if you can see my test file <a href=\"http://www.filedropper.com/book2_5\" rel=\"nofollow noreferrer\">filedropper.com/book2_5</a>"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519065842, "post_id": 48869627, "comment_id": 84748524, "body": "I will set up an account and see if I can see your test file. Can I ask if you return the correct values and number of values for your test file when you use inert / hold for example, rather than charge?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519065894, "post_id": 48869627, "comment_id": 84748550, "body": "I don&#39;t think you need to sign up, just download it?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519068122, "post_id": 48869627, "comment_id": 84749491, "body": "This is really strange.. It works on one laptop of mine and not the other? Is the split / compare function sensitive to any formatting at all?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519070632, "post_id": 48869627, "comment_id": 84750619, "body": "I think I have found the problem.. The code you supplied works really well for the list I gave you. If however, I make one change to column A in sheet 1, or column B in sheet 2, the code does not take account for it? Is this because it is an array?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519071294, "post_id": 48869627, "comment_id": 84750885, "body": "Oops, something I forgot was that it is case sensitive. Easily remedied but could that account for your problems?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519071442, "post_id": 48869627, "comment_id": 84750940, "body": "That could be part of the reason, no idea how that slots in though? It is odd because if I mix up any of order for &quot;charge&quot;, &quot;hold&quot; and &quot;inert&quot; it will solve it. If I add in another row to the list, it doesn&#39;t account for it? Is there any way that you can have a code that will always take account of the full column A and B from sheet 1 i.e. the currentregion gets larger or smaller, if in the future I wanted to added more key words for instance?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519071518, "post_id": 48869627, "comment_id": 84750967, "body": "I&#39;ve made a change to handle the case thing. Currentregion automatically contracts and expands as you change data."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519071645, "post_id": 48869627, "comment_id": 84751026, "body": "See that is what I have found from my research but it doesn&#39;t seem to be doing it - I have tried it on your workbook and I can&#39;t seem to get it to take account of any changes?"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519072087, "post_id": 48869627, "comment_id": 84751215, "body": "Lower case addition hasn&#39;t made any difference to the problem :("}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519072393, "post_id": 48869627, "comment_id": 84751354, "body": "I don&#39;t understand. I can add items to column A/B in sheet1 or column B in sheet2 and it works. You&#39;ll have to provide a specific example of what you&#39;re doing and what is not working."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519073000, "post_id": 48869627, "comment_id": 84751613, "body": "I added &quot;Temperature Ramp&quot; to Column A in Sheet1 and &quot;money&quot; to ColB, and &quot;Temperature Ramp for 1 hour&quot; to Column B in sheet 2 - it did not take account for it when I ran the code. I also added an additional &quot;Hold&quot; in column A in sheet 1 and got no accountability for it either :/. I reset the code each time I make a change and nothing else happens everytime? Does the version of excel matter? I just can&#39;t understand how mine isn&#39;t working and I am using your workbook? All I need to do is hit the reset button? It isn&#39;t working on either laptops I have. I have excel 2010 if that changes anything"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519073882, "post_id": 48869627, "comment_id": 84751972, "body": "Ah, some light has dawned. The code currently assumes the value in col A of sheet 1 is a single word."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519074307, "post_id": 48869627, "comment_id": 84752148, "body": "That would explain a lot. I&#39;ve got it to work for additional single words added to column A, but strangely if I add another &quot;Hold&quot; it doesn&#39;t take account of the 4th one? It only ever outputs the same initial 3 as per the question? This is the same for &quot;charge&quot;, and for &quot;Inert.&quot; Hopefully some light is shed on these ones lol"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519161515, "post_id": 48869627, "comment_id": 84794581, "body": "Would the code need a split function in at the start for col A in sheet1 to account for more than one word?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519211107, "post_id": 48869627, "comment_id": 84814087, "body": "Well it&#39;s more complicated than that because you have to match multiple words presumably in the right order and presumably adjacent. Might need a re-think and a new question building on this one but enumerating the various possibilities."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1519596155, "post_id": 48869627, "comment_id": 84962911, "body": "Hi @SJR, I would really appreciate any help that you could give! :)"}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1520001007, "post_id": 48869627, "comment_id": 85147550, "body": "Hi @SJR, shall I make another post regarding the updated problem at hand?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 0, "creation_date": 1520068828, "post_id": 48869627, "comment_id": 85170443, "body": "Well I suggested it some days ago so I should say so. Also, you don&#39;t have to accept my answer if it hasn&#39;t solved your problem, but don&#39;t be afraid to show your appreciation of help received here. It&#39;s how the site works."}, {"owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "edited": false, "score": 1, "creation_date": 1520204429, "post_id": 48869627, "comment_id": 85208080, "body": "Hi @SJR, apologies for the delayed appreciation. Thoroughly appreciate all the help and guidance you have offered so far on the question i posed! I accepted the answer as you answered what I initially put up, so hats off! Thanks again! I have posed another question to address the additional problem at -hand."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1519071491, "last_edit_date": 1519071491, "creation_date": 1519055396, "answer_id": 48869627, "question_id": 48786750, "link": "https://stackoverflow.com/questions/48786750/excel-find-function-to-find-whole-words-from-an-active-cell-containing-sentences/48869627#48869627", "title": "Excel find function to find whole words from an active cell containing sentences, and not individual characters", "body": "<p>I have assumed data as outlined in the comments so you may have to amend sheet names and ranges. Also depending on what other data you have in your sheet it may need some adjustment for the output, but if you mock up an example based on your screenshots it should work as desired.</p>\n\n<pre><code>Sub x()\n\nDim v, vOut(), i As Long, j As Long, k As Long, va, r As Range, r1 As Long\n\n'Assumes list of words in A1/B1 and down on \"Sheet1\"\nSet r =Sheets(\"Sheet1\").Range(\"A1\").CurrentRegion\n\nWith Sheets(\"Sheet2\") 'Assumes phrases in B1 and down on \"Sheet2\"\n    v = .Range(\"B1\", .Range(\"B\" &amp; Rows.Count).End(xlUp)).Value\n    .Columns(2).ClearContents\nEnd With\n\nReDim vOut(1 To UBound(v) * r.Rows.Count, 1 To 2)\n\nFor i = LBound(v, 1) To UBound(v, 1)\n    va = Split(v(i, 1))\n    For j = LBound(va) To UBound(va)\n       For r1 = 1 To r.Rows.Count\n          If LCase(Application.Trim(va(j))) = LCase(r.Cells(r1, 1)) Then\n             k = k + 1\n             vOut(k, 1) = v(i, 1)\n             vOut(k, 2) = r.Cells(r1, 2)\n          End If\n       Next r1\n    Next j\nNext i\n\nSheets(\"Sheet2\").Range(\"B1\").Resize(k, 2) = vOut 'Puts results in B1/C1 and down on \"Sheet2\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 48869627, "answer_count": 1, "score": 0, "last_activity_date": 1519071491, "creation_date": 1518609651, "last_edit_date": 1531164843, "question_id": 48786750, "link": "https://stackoverflow.com/questions/48786750/excel-find-function-to-find-whole-words-from-an-active-cell-containing-sentences", "title": "Excel find function to find whole words from an active cell containing sentences, and not individual characters", "body": "<p>Attached is my code so far. My issue is that I can't seem to get the macro to compare only whole words sheet(2) column B activecell (which contains more than one word within the cell) to the range (column A) in sheet(1) - which is a list of whole words (pictured below). Everything else in the code works fine but at present it only works for exact matches? </p>\n\n<p>I have tried using the wildcard approach but it seems to match any characters whereas I need it to compare whole words from the sentences (which are varying each time in the active cell). </p>\n\n<p>Any tips on what I can add so that the countif function finds whole words instead of characters etc? The same problem is for the Find function, where it will only find the exact match and return errors if it doesn't find exactly that. </p>\n\n<pre><code>    Sub FMEATest1()\n\nDim count As Integer\nDim count2 As Integer\nDim n As Integer\nDim m As Integer\nDim FML As Range\nDim i As Range\n'Dim m As Integer\nDim a As Range\nDim b As Integer\nDim FML2 As Range\nDim WrdArray() As String\nDim k As Range\nDim j As Range\nDim Splitsentence As Range\nWorksheets(1).Activate\n\n\nRange((\"A1\"), Range(\"A1\").End(xlDown)).Select\n\nSet FML = Selection\n\nWorksheets(2).Activate\n\nRange(\"B3\").Activate\n\nDo Until ActiveCell.value = \"\"\nSet i = ActiveCell\nWrdArray() = Split(i, , , vbTextCompare)\nSet Splitsentence = WrdArray().value\n\ncount = Application.WorksheetFunction.CountIf(FML, Splitsentence)\n\n     'm = (ActiveCell.Row) + count - 1\n\n    n = Selection.Rows.count\n\n    Do Until n = (count)\n\n     ActiveCell.Offset(1, 0).EntireRow.Insert\n     Set a = Selection.Offset(1, 0)\n        ActiveCell.COPY\n        ActiveCell.Offset(1, 0).value = ActiveCell.value\n        ActiveCell.PasteSpecial\n     Range(i, a).Select\n\n    n = Selection.Rows.count\n    Loop\n\n    'Copying Failure Modes for each Keyword\n         Lookfor = ActiveCell.value &amp; \"*\"\n         Worksheets(1).Activate\n         Cells.Find(What:=Lookfor, After:=ActiveCell, LookIn:=xlValues, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False).Select\n\n        Set FML2 = Selection\n        Set j = ActiveCell\n     count2 = Application.WorksheetFunction.CountIf(FML2, j)\n     m = Selection.Rows.count\n     Do Until m = (count)\n\n    Set k = Selection.Offset(1, 0)\n        Range(j, k).Select\n        m = Selection.Rows.count\n    Loop\n\n    Selection.Offset(0, 1).COPY\n    Worksheets(2).Activate\n    ActiveCell.Offset(0, 1).PasteSpecial\n\n\n    ActiveCell.Offset(n, -1).Activate\n\n    Loop\n\n    End Sub\n</code></pre>\n\n<p>The difficulty is that the activecell contains a sentence and this sentence varies each time as in the example below, but I need the macro to match whole key words from column B in sheet(2) to Column A in sheet (1). </p>\n\n<p>Can someone please make my images publically visible please? </p>\n\n<p><img src=\"https://i.stack.imgur.com/ZhzWR.png\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/GB3mc.png\" alt=\"enter image description here\"></p>\n\n<p>So I would be looking for the code to be able to find the word \"charge\" from cell B3 out of the whole sentence (and get it to find it in column A of sheet(1)). And the word \"Hold\" from B4 from the whole sentence. These can change so much so I can't manually input them into the find function I need to reference the activecell. </p>\n\n<p>The final solution of the code should give the following result (I've given two examples for \"charge\" and \"hold\"):</p>\n\n<p><img src=\"https://i.stack.imgur.com/czryk.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9359819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de3ec8b597176215e9888e1c4c06896?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9359819/rob"}, "edited": false, "score": 0, "creation_date": 1518609720, "post_id": 48786664, "comment_id": 84574837, "body": "CallumDA - they do work, # is a wildcard for a numeric, both that and ? were returning results when I tried Debug.print ws.name"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1518609429, "creation_date": 1518609429, "answer_id": 48786664, "question_id": 48786604, "link": "https://stackoverflow.com/questions/48786604/vba-for-loop-only-altering-one-sheet/48786664#48786664", "title": "VBA For Loop Only Altering One Sheet", "body": "<p>Try this. Your <code>r</code> was defined only in terms of one sheet so needs to be brought inside the loop.</p>\n\n<pre><code>Public Sub periodclear()\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n    If ws.Name Like (\"P#W#\") Or ws.Name Like (\"P##W#\") Then\n        ws.Range(\"c10:i30\").ClearContents\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9359819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de3ec8b597176215e9888e1c4c06896?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9359819/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 48786664, "answer_count": 1, "score": 1, "last_activity_date": 1518609429, "creation_date": 1518609238, "question_id": 48786604, "link": "https://stackoverflow.com/questions/48786604/vba-for-loop-only-altering-one-sheet", "title": "VBA For Loop Only Altering One Sheet", "body": "<p>I'm trying to alter the values in a range of cells for specifically named worksheets only.</p>\n\n<p>The workbook I am editing has around 95 sheets, and I only want to change the sheets with the period actual information (named P1W1, P1W2 etc, up to P12W5).</p>\n\n<p>When i execute the below it only alters the first sheet and then exits the macro. </p>\n\n<p>Any help is much appreciated</p>\n\n<pre><code>    Option Explicit\n\nPublic Sub periodclear()\n\nDim ws As Worksheet\nDim r As Range\n\nOn Error Resume Next\n\nSet r = Range(\"c10:i30\")\n\nFor Each ws In Worksheets\n    If ws.Name Like (\"P#W#\") Or ws.Name Like (\"P##W#\") Then\n\n       r.Value = \"\"\n\n    End If\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "google-chrome", "sendkeys"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518608747, "post_id": 48786236, "comment_id": 84574167, "body": "Are you using sendkeys sent to a chrome browser?"}, {"owner": {"reputation": 153, "user_id": 9359733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Xenox Dissanayake", "link": "https://stackoverflow.com/users/9359733/xenox-dissanayake"}, "edited": false, "score": 0, "creation_date": 1518610695, "post_id": 48786236, "comment_id": 84575505, "body": "Yes, I&#39;m using SendKeys"}, {"owner": {"reputation": 153, "user_id": 9359733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Xenox Dissanayake", "link": "https://stackoverflow.com/users/9359733/xenox-dissanayake"}, "edited": false, "score": 0, "creation_date": 1518611463, "post_id": 48786236, "comment_id": 84576048, "body": "That&#39;s my code, should it matter. I&#39;m quite new to this so might not be the best formatting <a href=\"https://gist.github.com/rxenox/832997e6c181be0f101acaa175ea0baf\" rel=\"nofollow noreferrer\">gist.github.com/rxenox/832997e6c181be0f101acaa175ea0baf</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1518615722, "post_id": 48786236, "comment_id": 84578878, "body": "This might help: <a href=\"https://www.makeuseof.com/tag/how-to-automate-firefox-or-chrome-with-vba-and-selenium/\" rel=\"nofollow noreferrer\">makeuseof.com/tag/&hellip;</a>"}, {"owner": {"reputation": 153, "user_id": 9359733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Xenox Dissanayake", "link": "https://stackoverflow.com/users/9359733/xenox-dissanayake"}, "edited": false, "score": 0, "creation_date": 1518616784, "post_id": 48786236, "comment_id": 84579622, "body": "I&#39;ve come across that already, it appears to have compatibility issues with excel 2003 and I&#39;m yet unable to see a function which can pause the code until the webpage has loaded :/"}], "owner": {"reputation": 153, "user_id": 9359733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Xenox Dissanayake", "link": "https://stackoverflow.com/users/9359733/xenox-dissanayake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1518624107, "creation_date": 1518608100, "last_edit_date": 1518624107, "question_id": 48786236, "link": "https://stackoverflow.com/questions/48786236/pause-execution-till-chrome-is-done-loading", "title": "Pause execution till Chrome is done loading", "body": "<p>I'm currently in the process of developing a file which is used to fill in a form based on the data from the sheet. The issue I'm facing is that the page gets refreshed for each entered field for one section of the code. The refresh time varies based on the computer.</p>\n\n<p>My current solution is to induce a wait of approximately 5-6 seconds which can be inefficient based on the terminal used. Is there a way that the execution can be paused simply till the page is done loading? Also, there are two versions of Excel that are in use, essentially 2013 and 2003. Not sure if that's relevant but I've had to sort out numerous compatibility issues.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1518610513, "last_edit_date": 1518610513, "creation_date": 1518609420, "answer_id": 48786661, "question_id": 48786193, "link": "https://stackoverflow.com/questions/48786193/using-the-value-of-a-textbox-in-a-userform-to-activate-another-textbox-on-a-work/48786661#48786661", "title": "Using the value of a textbox in a userform to activate another textbox on a worksheet", "body": "<p>Concerning the name of your Sub - <code>Private Sub CommandButton1_Click</code>, I assume that the button is in a form and the TextBox is in a worksheet. In general, there are two types of TextBoxes in Excel - ActiveX control or a Form control and they are handled differently:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15455179/what-is-the-difference-between-form-controls-and-activex-control-in-excel-20\">What is the difference between &quot;Form Controls&quot; and &quot;ActiveX Control&quot; in Excel 2010?</a></p>\n\n<p>If you are not sure whether the TextBox is an ActiveX control or a ControlElement, then the following would work. Somehow.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    On Error Resume Next\n\n    Dim NameOfTextBox As String\n\n    NameOfTextBox = UserForm2.TextBox2.Value\n    Worksheets(1).OLEObjects(NameOfTextBox).Activate\n    Worksheets(1).Shapes(NameOfTextBox).Select\n\n    Unload Me\n\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p><strong>Caution:</strong> This is a good example of a \"quick and dirty\" code, consider only using it for learning reasons.</p>\n\n<p>In production, it is really a good idea to use the Forms as they are supposed to be used (see <a href=\"https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form\">https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form</a>) and try to avoid <code>On Error Resume Next</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9359706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/9359706/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 0, "accepted_answer_id": 48786661, "answer_count": 1, "score": 1, "last_activity_date": 1518610513, "creation_date": 1518607959, "last_edit_date": 1531164843, "question_id": 48786193, "link": "https://stackoverflow.com/questions/48786193/using-the-value-of-a-textbox-in-a-userform-to-activate-another-textbox-on-a-work", "title": "Using the value of a textbox in a userform to activate another textbox on a worksheet", "body": "<p>Firstly, I am as beginner as beginner gets.\nI am trying to take the value from a text box embedded in a user form and then using it in another line of code to activate another text box on a worksheet.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nUserForm2.Hide\n\nDim FieldName As String\nFieldName = UserForm2.TextBox1.Value\n\nWorksheets(\"Quote\").FieldName.Activate\nEnd Sub\n</code></pre>\n\n<p>I hope you can see what I'm attempting from this code. The error is \"Run-time error '438': Object doesn't support this property or method\".\nThe value obtained from the textbox is identical to the name of the other one and has been tested to see if it can be retrieved or not. </p>\n\n<p>If someone could tell me the correct functions to use, it'd be much obliged.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1518607729, "post_id": 48786025, "comment_id": 84573474, "body": "I think with normal Excel is not possible, but with VBA indeed. Try checking <a href=\"https://stackoverflow.com/questions/36445182/excel-vba-to-make-hyperlink-for-active-cell\">Excel VBA to make hyperlink for active cell</a> and maybe you can get on the road to what you want"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1518607811, "post_id": 48786025, "comment_id": 84573525, "body": "Would something like what&#39;s described here be similar to what you want to do? <a href=\"https://superuser.com/questions/489089/can-excel-use-formula-input-data-for-cell-references\" title=\"can excel use formula input data for cell references\">superuser.com/questions/489089/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 5679931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae9e204382d5ba0709081d134cacad5?s=128&d=identicon&r=PG&f=1", "display_name": "antonioplacerda", "link": "https://stackoverflow.com/users/5679931/antonioplacerda"}, "reply_to_user": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "edited": false, "score": 0, "creation_date": 1518608409, "post_id": 48786175, "comment_id": 84573926, "body": "I tried on my excel and I got it working. Did you copy my function? And could it be the excel version? I am still using 2010..."}, {"owner": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "edited": false, "score": 0, "creation_date": 1518609752, "post_id": 48786175, "comment_id": 84574860, "body": "I am using 2013. I can&#39;t seem to figure out why it isn&#39;t working"}, {"owner": {"reputation": 119, "user_id": 5679931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae9e204382d5ba0709081d134cacad5?s=128&d=identicon&r=PG&f=1", "display_name": "antonioplacerda", "link": "https://stackoverflow.com/users/5679931/antonioplacerda"}, "reply_to_user": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "edited": false, "score": 0, "creation_date": 1518610016, "post_id": 48786175, "comment_id": 84575047, "body": "What is on your cell A2? Is it the text &#39;Paris&#39;? if you set a cell content to <code>=A2</code> what do you get? And then another to <code>=CD89</code> . Probably the problem is on those cells and not on the formula. And maybe you can try <code>CONCATENATE</code>"}], "tags": [], "owner": {"reputation": 119, "user_id": 5679931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae9e204382d5ba0709081d134cacad5?s=128&d=identicon&r=PG&f=1", "display_name": "antonioplacerda", "link": "https://stackoverflow.com/users/5679931/antonioplacerda"}, "is_accepted": false, "score": 0, "last_activity_date": 1518607898, "creation_date": 1518607898, "answer_id": 48786175, "question_id": 48786025, "link": "https://stackoverflow.com/questions/48786025/how-do-i-create-a-link-in-excel-with-a-formula-in-it-to-another-workbook/48786175#48786175", "title": "How do I create a link in Excel, with a formula in it, to another Workbook?", "body": "<p>I am not sure if you can use <code>HYPERLINK</code>.</p>\n\n<p>Like this:</p>\n\n<pre><code>=HYPERLINK(\"G:\\Hotels\\\"&amp;A2&amp;\"\\\"&amp;A2&amp;\" - Monthly\\[\"&amp;A2&amp;\"_summary_2018.xlsm]Feb!\"&amp;$CD$89)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "edited": false, "score": 0, "creation_date": 1518620241, "post_id": 48786990, "comment_id": 84582119, "body": "This works great! However, how can I get the macro to move on if it can&#39;t find the external workbook? I tried On error resume after For Each but it didn&#39;t work, any ideas?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "edited": false, "score": 0, "creation_date": 1518769262, "post_id": 48786990, "comment_id": 84648629, "body": "@Sorath I added the easiest solution to my answer. Note that this will skip all errors, so if something unexpected happens you may not get to learn about it. I&#39;d advise more robust error handling, but without knowing more about your exact situation, I don&#39;t want to go into any more detail."}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 0, "last_activity_date": 1518769162, "last_edit_date": 1518769162, "creation_date": 1518610454, "answer_id": 48786990, "question_id": 48786025, "link": "https://stackoverflow.com/questions/48786025/how-do-i-create-a-link-in-excel-with-a-formula-in-it-to-another-workbook/48786990#48786990", "title": "How do I create a link in Excel, with a formula in it, to another Workbook?", "body": "<p>As long as you don't mind using VBA, you can easily generate the links with something like this:</p>\n\n<pre><code>Sub generate_hotel_links()\n    Dim r As Range, c As Range\n    Dim s As String\n    ' This is the range which all the hotel-locations are in\n    Set r = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A10\")\n    On Error Resume Next\n    For Each c In r\n        ' Generate the formula based on the current cell we are in\n        s = \"=\" &amp; Chr(39) &amp; \"G:\\Hotels\\\" &amp; CStr(c) &amp; \"\\\" &amp; CStr(c) &amp; \" - Monthly\\[\" &amp; CStr(c) &amp; \"_summary_2018.xlsm]Feb\" &amp; Chr(39) &amp; \"!$CD$89\"\n        ' ...and put it in the neighbouring cell\n        c.Offset(0, 1).Formula = s\n    Next c\n    On Error Goto 0\nEnd Sub\n</code></pre>\n\n<p><code>On Error Resume Next</code> will make the macro continue no matter what error pops up - the ideal case would be some more robust error handling, or a check for if the workbook / sheet actually exists before attempting to write the formula, but I'll leave it to you to attempt to write this if you feel the need improve the macro.</p>\n\n<p>If you want to just use generic Excel formulas, I'd advice having a look at the question and answers I posted in the comments to your question.</p>\n"}], "owner": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48786990, "answer_count": 2, "score": 0, "last_activity_date": 1518769162, "creation_date": 1518607470, "last_edit_date": 1531161705, "question_id": 48786025, "link": "https://stackoverflow.com/questions/48786025/how-do-i-create-a-link-in-excel-with-a-formula-in-it-to-another-workbook", "title": "How do I create a link in Excel, with a formula in it, to another Workbook?", "body": "<p>I'm not sure if this is even possible in Excel but this is what I need to do:</p>\n\n<p>I have a column with a list of hotels and then another column which needs to pull data from each individual hotel's excel file. For example, cell A2 will have the name \"Paris\" for the hotel and then cell B2 will have the link:</p>\n\n<pre><code>  ='G:\\Hotels\\Paris\\Paris - Monthly\\[Paris_summary_2018.xlsm]Feb'!$CD$89\n</code></pre>\n\n<p>I have lots of hotels I need to do this for in different sheets. So I need the link to dynamically refer to whatever hotel is in column A and the title of the sheet, for example could I do something like this?</p>\n\n<pre><code>=''G:\\Hotels\\A2\\A2 - Monthly\\[A2_summary_2018.xlsm]Feb'!$CD$89\n</code></pre>\n\n<p>where A2 has the string \"Paris\". Also is there a way to dynamically refer to \"Feb\" depending on what sheet I am in the month will be the title</p>\n\n<p>I am also open to using VBA for this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1518607495, "post_id": 48785970, "comment_id": 84573329, "body": "<code>Set activateFXSheet = Sheet1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1518607564, "creation_date": 1518607564, "answer_id": 48786049, "question_id": 48785970, "link": "https://stackoverflow.com/questions/48785970/type-mismatch-macro-for-external-data/48786049#48786049", "title": "Type mismatch macro for external data", "body": "<p>Here you go for the <code>ActiveSheet</code>:</p>\n\n<pre><code>Sub fxRate()\n    Sheet1.Activate\n    Set activateFXSheet = ActiveSheet\nEnd Sub\n</code></pre>\n\n<p>But using <code>ActiveSheet</code> and etc is not a good idea in VBA:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1518607723, "creation_date": 1518607723, "answer_id": 48786109, "question_id": 48785970, "link": "https://stackoverflow.com/questions/48785970/type-mismatch-macro-for-external-data/48786109#48786109", "title": "Type mismatch macro for external data", "body": "<p>You don't need to select or activate a worksheet in order to reference or modify/update it.</p>\n\n<pre><code>Sub fxRate()\n    With Sheet1.QueryTables.Add(Connection:=\"URL;http://www.x-rates.com/table/?from=USD&amp;amount=1\", Destination:=Range(\"$C$4:$E$14\"))\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"1\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7115229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c738c1891631fac8ef1ea768e427460?s=128&d=identicon&r=PG&f=1", "display_name": "Ross Anderson", "link": "https://stackoverflow.com/users/7115229/ross-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1518612064, "creation_date": 1518607289, "last_edit_date": 1518612064, "question_id": 48785970, "link": "https://stackoverflow.com/questions/48785970/type-mismatch-macro-for-external-data", "title": "Type mismatch macro for external data", "body": "<p>Hello need some help with the below code but an explanation in what I am needing might help you.</p>\n\n<p>I am creating a macro that takes external data( FX rates) and places them down in a specified range on sheet1. sheet2 has just a little sum conversion using the FX rate from sheet1 to give GBP rate. This will live conversions when people fill in expenses for me on a project.</p>\n\n<p>My issue is making the macro select the correct sheet.\nI have come up with the below however. i'm now getting a runtime error 13.type mismatch.</p>\n\n<p>before it just selected the activesheet and not the sheet I wanted.</p>\n\n<p>hope you guys can help.\nAll new to VBA and i cannot find right answer when researching.\nso any help will be greatly appreciated.</p>\n\n<p>regards.\nRoss</p>\n\n<pre><code>Sub fxRate()\n    '\n    ' fxRate Macro\n    '\n\n    '\n    Set activateFXSheet = Sheet1.Activate\n    Set FXSheet = activateFXSheet.QueryTables.Add(Connection:= _\n        \"URL;http://www.x-rates.com/table/?from=USD&amp;amount=1\",   Destination:=Range( _\n        \"$C$4:$E$14\"))\n\n    With FXSheet\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"1\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1518606050, "post_id": 48785296, "comment_id": 84572427, "body": "what <b>exactly</b> do you mean by <i>&#39;refresh&#39;</i>? query tables? calculation? pivot caches?"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518609125, "post_id": 48785296, "comment_id": 84574415, "body": "All the data in the pivot table should be refrreshed?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518608340, "post_id": 48785589, "comment_id": 84573873, "body": "Again the order is getting changed in this sheet, please check the picture i have uploaded just few seconds ago"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518608684, "post_id": 48785589, "comment_id": 84574122, "body": "@VenusJain - I do not see any picture."}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518609276, "post_id": 48785589, "comment_id": 84574537, "body": "Its under Peer review. Is there any option to attach file here?"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518622254, "post_id": 48785589, "comment_id": 84583482, "body": "could you please check now"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518622633, "post_id": 48785589, "comment_id": 84583711, "body": "@VenusJain - what do you do in order to change these the order of the columns? The <code>.RefreshTable</code> should not have any impact on them (AFAIK)"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518624384, "post_id": 48785589, "comment_id": 84584903, "body": "I recorded a macro to rearrange the column"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518624390, "post_id": 48785589, "comment_id": 84584907, "body": "Sub RearrangeColumn() &#39; &#39; RearrangeColumn Macro &#39;     Sheets(&quot;Sorted Data&quot;).Select     Columns(&quot;F:G&quot;).Select     Selection.Cut     Columns(&quot;A:A&quot;).Select     Selection.Insert Shift:=xlToRight     Columns(&quot;I:J&quot;).Select     Selection.Cut     Columns(&quot;G:G&quot;).Select     Selection.Insert Shift:=xlToRight     Columns(&quot;J:J&quot;).Select     Selection.Cut     Columns(&quot;I:I&quot;).Select     Selection.Insert Shift:=xlToRight     Columns(&quot;L:N&quot;).Select     Selection.Cut     Columns(&quot;K:K&quot;).Select     Selection.Insert Shift:=xlToRight End Sub"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1518938872, "post_id": 48785589, "comment_id": 84702393, "body": "is there anything wrong with the above Macro for rearrange?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1518606144, "creation_date": 1518606144, "answer_id": 48785589, "question_id": 48785296, "link": "https://stackoverflow.com/questions/48785296/vba-to-refresh-all-sheets-in-a-workbook-excluding-only-one-sheet/48785589#48785589", "title": "VBA to refresh all sheets in a workbook excluding only one Sheet", "body": "<p>This is a possible way to exclude one sheet:</p>\n\n<pre><code>Sub RefreshAllPivotTables()\n\n    Dim PT As PivotTable\n    Dim WS As Worksheet\n\n    For Each WS In ThisWorkbook.Worksheets\n        If WS.Name &lt;&gt; \"Sorted\" Then\n            For Each PT In WS.PivotTables\n                PT.RefreshTable\n            Next PT\n        End If\n    Next WS\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1500, "favorite_count": 0, "accepted_answer_id": 48785589, "answer_count": 1, "score": 1, "last_activity_date": 1518622200, "creation_date": 1518605353, "last_edit_date": 1531164843, "question_id": 48785296, "link": "https://stackoverflow.com/questions/48785296/vba-to-refresh-all-sheets-in-a-workbook-excluding-only-one-sheet", "title": "VBA to refresh all sheets in a workbook excluding only one Sheet", "body": "<p><a href=\"https://i.stack.imgur.com/K6Coj.jpg\" rel=\"nofollow noreferrer\">Sample Heading </a>Hello I have pivot tables in 6 sheets of my workbook out of 9 and one sheet (Sorted) has columns arranged in a particular order but it doesn't have pivot tables. I want to refresh sheets with Pivot only. I have used the below VBA but it rearranges the columns in the Sorted worksheet. Below is the code</p>\n\n<pre><code>Sub RefreshAllPivotTables()\n    Dim PT As PivotTable\n    Dim WS As Worksheet\n\n    For Each WS In ThisWorkbook.Worksheets\n        For Each PT In WS.PivotTables\n            PT.RefreshTable\n        Next PT\n    Next WS\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 10342044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad456fe4d2df75f4a3a46d737748813?s=128&d=identicon&r=PG&f=1", "display_name": "Krupal Patel", "link": "https://stackoverflow.com/users/10342044/krupal-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1536750847, "creation_date": 1536750847, "answer_id": 52293826, "question_id": 48785182, "link": "https://stackoverflow.com/questions/48785182/excel-vba-to-copy-slides-to-an-existing-powerpoint-presentation/52293826#52293826", "title": "Excel vba to copy slides to an existing powerpoint presentation", "body": "<p>Shape must be activated to perform any operation on it</p>\n\n<p>Below is the code that I have created to copy charts from Excel and paste into existing PPT template (in picture format)</p>\n\n<p>You can also use <em>for</em> loop to go through charts in each sheet. I could not do it beacuse chart names were not same in each sheet</p>\n\n<pre><code>Sub create_ppt()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nDim wb1 As Workbook\nDim wb1_path As String\nDim ppt_app_1 As Object\nDim ppt_1 As PowerPoint.Presentation\nDim ppt_sld As PowerPoint.Slide\nDim ppt_path As String\nDim month_name As String\nDim year_num As String\nDim month_full As String\nDim year_full As String\n\nmonth_name = Range(\"Output!C5\")\nyear_num = Range(\"Output!C8\")\nmonth_full = Range(\"Output!C9\")\nyear_full = Range(\"Output!C7\")\n\n\n''opening target excel\n\nwb1_path = ThisWorkbook.Path &amp; \"\\Report\\Acquisition_Summary_\" &amp; month_name &amp; \"_\" &amp; year_num &amp; \".xlsx\"\nSet wb1 = Workbooks.Open(wb1_path)\n\n\n''opening target ppt\n\nSet ppt_app_1 = CreateObject(\"Powerpoint.Application\")\nSet ppt_1 = ppt_app_1.Presentations.Open(ThisWorkbook.Path &amp; \"\\Template.pptx\")\n\n''slide 1\n\n    ppt_1.Slides(1).Shapes(2).TextFrame.TextRange.Text = \"Small Business\" &amp; vbCrLf &amp; \"( \" &amp; month_full &amp; \" - \" &amp; year_full &amp; \" )\"\n\n''slide 2\n\n    wb1.Sheets(\"Sheet1\").Select\n    Set ppt_sld = ppt_1.Slides(2)\n\n    ActiveSheet.ChartObjects(\"Chart 33\").Activate\n    ActiveSheet.Shapes(\"Chart 33\").Height = 198\n    ActiveSheet.Shapes(\"Chart 33\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76   ''1 inch = 72 macro units\n\n\n    ActiveSheet.ChartObjects(\"Chart 19\").Activate\n    ActiveSheet.Shapes(\"Chart 19\").Height = 198\n    ActiveSheet.Shapes(\"Chart 19\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 20\").Activate\n    ActiveSheet.Shapes(\"Chart 20\").Height = 198\n    ActiveSheet.Shapes(\"Chart 20\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 15\").Activate\n    ActiveSheet.Shapes(\"Chart 15\").Height = 198\n    ActiveSheet.Shapes(\"Chart 15\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 26\").Activate\n    ActiveSheet.Shapes(\"Chart 26\").Height = 198\n    ActiveSheet.Shapes(\"Chart 26\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n\n''slide 3\n\n    Set ppt_sld = ppt_1.Slides(3)\n\n    ActiveSheet.ChartObjects(\"Chart 14\").Activate\n    ActiveSheet.Shapes(\"Chart 14\").Height = 198\n    ActiveSheet.Shapes(\"Chart 14\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76   ''1 inch = 72 macro units\n\n\n    ActiveSheet.ChartObjects(\"Chart 23\").Activate\n    ActiveSheet.Shapes(\"Chart 23\").Height = 198\n    ActiveSheet.Shapes(\"Chart 23\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 25\").Activate\n    ActiveSheet.Shapes(\"Chart 25\").Height = 198\n    ActiveSheet.Shapes(\"Chart 25\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 27\").Activate\n    ActiveSheet.Shapes(\"Chart 27\").Height = 198\n    ActiveSheet.Shapes(\"Chart 27\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 28\").Activate\n    ActiveSheet.Shapes(\"Chart 28\").Height = 198\n    ActiveSheet.Shapes(\"Chart 28\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n\n''slide 4\n\n\n    wb1.Sheets(\"Sheet2\").Select\n    Set ppt_sld = ppt_1.Slides(4)\n\n    ActiveSheet.ChartObjects(\"Chart 16\").Activate\n    ActiveSheet.Shapes(\"Chart 16\").Height = 198\n    ActiveSheet.Shapes(\"Chart 16\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 18\").Activate\n    ActiveSheet.Shapes(\"Chart 18\").Height = 198\n    ActiveSheet.Shapes(\"Chart 18\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 17\").Activate\n    ActiveSheet.Shapes(\"Chart 17\").Height = 198\n    ActiveSheet.Shapes(\"Chart 17\").Width = 198\n      ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 3\").Activate\n    ActiveSheet.Shapes(\"Chart 3\").Height = 198\n    ActiveSheet.Shapes(\"Chart 3\").Width = 247\n   ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 4\").Activate\n    ActiveSheet.Shapes(\"Chart 4\").Height = 198\n    ActiveSheet.Shapes(\"Chart 4\").Width = 247\n   ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    '' slide 5\n     Set ppt_sld = ppt_1.Slides(5)\n\n    ActiveSheet.ChartObjects(\"Chart 19\").Activate\n    ActiveSheet.Shapes(\"Chart 19\").Height = 198\n    ActiveSheet.Shapes(\"Chart 19\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 21\").Activate\n    ActiveSheet.Shapes(\"Chart 21\").Height = 198\n    ActiveSheet.Shapes(\"Chart 21\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 20\").Activate\n    ActiveSheet.Shapes(\"Chart 20\").Height = 198\n    ActiveSheet.Shapes(\"Chart 20\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 24\").Activate\n    ActiveSheet.Shapes(\"Chart 24\").Height = 198\n    ActiveSheet.Shapes(\"Chart 24\").Width = 247\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 25\").Activate\n    ActiveSheet.Shapes(\"Chart 25\").Height = 198\n    ActiveSheet.Shapes(\"Chart 25\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    ''slide 6\n\n    wb1.Sheets(\"Sheet3\").Select\n    Set ppt_sld = ppt_1.Slides(6)\n\n    ActiveSheet.ChartObjects(\"Chart 4\").Activate\n    ActiveSheet.Shapes(\"Chart 4\").Height = 198\n    ActiveSheet.Shapes(\"Chart 4\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 6\").Activate\n    ActiveSheet.Shapes(\"Chart 6\").Height = 198\n    ActiveSheet.Shapes(\"Chart 6\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 5\").Activate\n    ActiveSheet.Shapes(\"Chart 5\").Height = 198\n    ActiveSheet.Shapes(\"Chart 5\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveSheet.Shapes(\"Chart 1\").Height = 198\n    ActiveSheet.Shapes(\"Chart 1\").Width = 247\n   ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 2\").Activate\n    ActiveSheet.Shapes(\"Chart 2\").Height = 198\n    ActiveSheet.Shapes(\"Chart 2\").Width = 247\n   ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    ''slide 7\n\n    Set ppt_sld = ppt_1.Slides(7)\n\n    ActiveSheet.ChartObjects(\"Chart 7\").Activate\n    ActiveSheet.Shapes(\"Chart 7\").Height = 198\n    ActiveSheet.Shapes(\"Chart 7\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 9\").Activate\n    ActiveSheet.Shapes(\"Chart 9\").Height = 198\n    ActiveSheet.Shapes(\"Chart 9\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 8\").Activate\n    ActiveSheet.Shapes(\"Chart 8\").Height = 198\n    ActiveSheet.Shapes(\"Chart 8\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 12\").Activate\n    ActiveSheet.Shapes(\"Chart 12\").Height = 198\n    ActiveSheet.Shapes(\"Chart 12\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 13\").Activate\n    ActiveSheet.Shapes(\"Chart 13\").Height = 198\n    ActiveSheet.Shapes(\"Chart 13\").Width = 247\n   ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    ''slide 8\n\n    wb1.Sheets(\"Sheet4\").Select\n    Set ppt_sld = ppt_1.Slides(8)\n\n\n    ActiveSheet.ChartObjects(\"Chart 4\").Activate\n    ActiveSheet.Shapes(\"Chart 4\").Height = 198\n    ActiveSheet.Shapes(\"Chart 4\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 6\").Activate\n    ActiveSheet.Shapes(\"Chart 6\").Height = 198\n    ActiveSheet.Shapes(\"Chart 6\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 5\").Activate\n    ActiveSheet.Shapes(\"Chart 5\").Height = 198\n    ActiveSheet.Shapes(\"Chart 5\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveSheet.Shapes(\"Chart 1\").Height = 198\n    ActiveSheet.Shapes(\"Chart 1\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 2\").Activate\n    ActiveSheet.Shapes(\"Chart 2\").Height = 198\n    ActiveSheet.Shapes(\"Chart 2\").Width = 247\n  ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    ''slide 9\n    Set ppt_sld = ppt_1.Slides(9)\n\n    ActiveSheet.ChartObjects(\"Chart 7\").Activate\n    ActiveSheet.Shapes(\"Chart 7\").Height = 198\n    ActiveSheet.Shapes(\"Chart 7\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 9\").Activate\n    ActiveSheet.Shapes(\"Chart 9\").Height = 198\n    ActiveSheet.Shapes(\"Chart 9\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 8\").Activate\n    ActiveSheet.Shapes(\"Chart 8\").Height = 198\n    ActiveSheet.Shapes(\"Chart 8\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 12\").Activate\n    ActiveSheet.Shapes(\"Chart 12\").Height = 198\n    ActiveSheet.Shapes(\"Chart 12\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 13\").Activate\n    ActiveSheet.Shapes(\"Chart 13\").Height = 198\n    ActiveSheet.Shapes(\"Chart 13\").Width = 247\n   ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    ''slide 10\n\n    wb1.Sheets(\"Sheet5\").Select\n    Set ppt_sld = ppt_1.Slides(10)\n\n\n    ActiveSheet.ChartObjects(\"Chart 4\").Activate\n    ActiveSheet.Shapes(\"Chart 4\").Height = 198\n    ActiveSheet.Shapes(\"Chart 4\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 6\").Activate\n    ActiveSheet.Shapes(\"Chart 6\").Height = 198\n    ActiveSheet.Shapes(\"Chart 6\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 5\").Activate\n    ActiveSheet.Shapes(\"Chart 5\").Height = 198\n    ActiveSheet.Shapes(\"Chart 5\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveSheet.Shapes(\"Chart 1\").Height = 198\n    ActiveSheet.Shapes(\"Chart 1\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.246\n\n    ActiveSheet.ChartObjects(\"Chart 2\").Activate\n    ActiveSheet.Shapes(\"Chart 2\").Height = 198\n    ActiveSheet.Shapes(\"Chart 2\").Width = 247\n  ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n    ''slide 11\n    Set ppt_sld = ppt_1.Slides(11)\n\n    ActiveSheet.ChartObjects(\"Chart 7\").Activate\n    ActiveSheet.Shapes(\"Chart 7\").Height = 198\n    ActiveSheet.Shapes(\"Chart 7\").Width = 500.4\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 7.2\n    ppt_sld.Shapes(3).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 9\").Activate\n    ActiveSheet.Shapes(\"Chart 9\").Height = 198\n    ActiveSheet.Shapes(\"Chart 9\").Width = 198\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 516.24\n    ppt_sld.Shapes(4).Top = 59.76\n\n    ActiveSheet.ChartObjects(\"Chart 8\").Activate\n    ActiveSheet.Shapes(\"Chart 8\").Height = 198\n    ActiveSheet.Shapes(\"Chart 8\").Width = 198\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(5).Left = 516.24\n    ppt_sld.Shapes(5).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 12\").Activate\n    ActiveSheet.Shapes(\"Chart 12\").Height = 198\n    ActiveSheet.Shapes(\"Chart 12\").Width = 247\n     ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(6).Left = 7.2\n    ppt_sld.Shapes(6).Top = 264.24\n\n    ActiveSheet.ChartObjects(\"Chart 13\").Activate\n    ActiveSheet.Shapes(\"Chart 13\").Height = 198\n    ActiveSheet.Shapes(\"Chart 13\").Width = 247\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(7).Left = 261.36\n    ppt_sld.Shapes(7).Top = 264.24\n\n\n    ''credilt line charts\n    ''slide 13\n\n    wb1.Sheets(\"Sheet1\").Select\n    Set ppt_sld = ppt_1.Slides(13)\n\n    ActiveSheet.ChartObjects(\"Chart 21\").Activate\n    ActiveSheet.Shapes(\"Chart 21\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 21\").Width = 653.76\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 33.12\n    ppt_sld.Shapes(3).Top = 59.04\n\n    ActiveSheet.ChartObjects(\"Chart 29\").Activate\n    ActiveSheet.Shapes(\"Chart 29\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 29\").Width = 653.76\n    ActiveChart.ChartTitle.Text = \"Credit Limit / Company - High Value\"\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 33.12\n    ppt_sld.Shapes(4).Top = 263.52\n\n    ''slide 14\n\n    wb1.Sheets(\"Sheet2\").Select\n    Set ppt_sld = ppt_1.Slides(14)\n\n    ActiveSheet.ChartObjects(\"Chart 22\").Activate\n    ActiveSheet.Shapes(\"Chart 22\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 22\").Width = 653.76\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 33.12\n    ppt_sld.Shapes(3).Top = 59.04\n\n    ActiveSheet.ChartObjects(\"Chart 23\").Activate\n    ActiveSheet.Shapes(\"Chart 23\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 23\").Width = 653.76\n    ActiveChart.ChartTitle.Text = \"Credit Limit / Company - High Value\"\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 33.12\n    ppt_sld.Shapes(4).Top = 263.52\n\n    ''slide 15\n\n    wb1.Sheets(\"Sheet3\").Select\n    Set ppt_sld = ppt_1.Slides(15)\n\n    ActiveSheet.ChartObjects(\"Chart 10\").Activate\n    ActiveSheet.Shapes(\"Chart 10\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 10\").Width = 653.76\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 33.12\n    ppt_sld.Shapes(3).Top = 59.04\n\n    ActiveSheet.ChartObjects(\"Chart 11\").Activate\n    ActiveSheet.Shapes(\"Chart 11\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 11\").Width = 653.76\n    ActiveChart.ChartTitle.Text = \"Credit Limit / Company - High Value\"\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 33.12\n    ppt_sld.Shapes(4).Top = 263.52\n\n    ''slide 16\n\n    wb1.Sheets(\"Sheet4\").Select\n    Set ppt_sld = ppt_1.Slides(16)\n\n    ActiveSheet.ChartObjects(\"Chart 10\").Activate\n    ActiveSheet.Shapes(\"Chart 10\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 10\").Width = 653.76\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 33.12\n    ppt_sld.Shapes(3).Top = 59.04\n\n    ActiveSheet.ChartObjects(\"Chart 11\").Activate\n    ActiveSheet.Shapes(\"Chart 11\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 11\").Width = 653.76\n    ActiveChart.ChartTitle.Text = \"Credit Limit / Company - High Value\"\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 33.12\n    ppt_sld.Shapes(4).Top = 263.52\n\n    ''slide 17\n\n    wb1.Sheets(\"Sheet5\").Select\n    Set ppt_sld = ppt_1.Slides(17)\n\n    ActiveSheet.ChartObjects(\"Chart 10\").Activate\n    ActiveSheet.Shapes(\"Chart 10\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 10\").Width = 653.76\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(3).Left = 33.12\n    ppt_sld.Shapes(3).Top = 59.04\n\n    ActiveSheet.ChartObjects(\"Chart 11\").Activate\n    ActiveSheet.Shapes(\"Chart 11\").Height = 199.44\n    ActiveSheet.Shapes(\"Chart 11\").Width = 653.76\n    ActiveChart.ChartTitle.Text = \"Credit Limit / Company - High Value\"\n    ActiveChart.ChartArea.Copy\n    ppt_sld.Select\n    ppt_sld.Shapes.PasteSpecial ppPastePNG\n    ppt_sld.Shapes(4).Left = 33.12\n    ppt_sld.Shapes(4).Top = 263.52\n\n    ''22 23 usb\n    '' 10 11 other\n\n    ppt_path = ThisWorkbook.Path &amp; \"\\Presentation\\Acquisition_Summary_\" &amp; month_name &amp; \"_\" &amp; year_num\n\n    If Len(Dir(ppt_path)) &gt; 0 Then\n        SetAttr ppt_path, vbNormal\n        Kill ppt_path\n    End If\n\n    ppt_1.SaveAs ppt_path, 24                ''24 for .pptx format\n    ppt_1.Close\n    wb1.Close SaveChanges:=False\n\n\n    ppt_app_1.Quit\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\n\n    MsgBox \"Macro successfully executed\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9355830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3d411e3d1f0127ba13f8a5a1e06384?s=128&d=identicon&r=PG&f=1", "display_name": "M. Nascetti", "link": "https://stackoverflow.com/users/9355830/m-nascetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536750847, "creation_date": 1518605037, "last_edit_date": 1531164843, "question_id": 48785182, "link": "https://stackoverflow.com/questions/48785182/excel-vba-to-copy-slides-to-an-existing-powerpoint-presentation", "title": "Excel vba to copy slides to an existing powerpoint presentation", "body": "<p>I need to copy some pictures from Excel (the pictures are in different folders within the same file) to PowerPoint, adding a slide for every picture in an already existing PowerPoint file (the file name is TBD_ppt_WRK which has already 2 slides inside that must be kept).\nI need to run the macro from Excel. The macro I\u2019m using is:</p>\n\n<pre><code>Sub TBD_GENERATE_PPW()\n\n' OPEN FILE TBD_ppt_WRK WHERE COPY THE PICTURES FROM EXCEL\nDim pp As Object\nSet pp = CreateObject(\"PowerPoint.Application\")\npp.Visible = True\npp.Presentations.Open (\"C:\\ Desktop\\ ppt_TBD_WRK.ppt\") \n \u2018C:\\ Desktop\\ ppt_TBD_WRK.ppt is path &amp; name of the PPW file where to add the slides\n\n'Step 1:  Declare variables\nDim ppPres As Object\nDim ppSlide As Object\nDim xlwksht As Worksheet\nDim MyRange As String\n\n'Step 2:  \nSet pp = New PowerPoint.Application\nSet ppPres = pp.ActivePresentation\npp.Visible = True\n\n'Step 3:  Set the ranges for your data and title\nMyRange = \"B2:S40\"\n\n'Step 4:  Start the loop through each worksheet\nFor Each xlwksht In ActiveWorkbook.Worksheets\nxlwksht.Select\nApplication.Wait (Now + TimeValue(\"0:00:1\"))\n\n'Step 5:  Copy the range as picture\nxlwksht.Range(MyRange).CopyPicture _\nAppearance:=xlScreen, Format:=xlPicture\n\n'Step 6:  Count slides and add new blank slide as next available slide number\n'(the number 12 represents the enumeration for a Blank Slide)\nSlidecount = ppPres.Slides.Count\nSet ppSlide = ppPres.Slides.Add(Slidecount + 1, 12)\nppSlide.Select\n\n'Step 7:  Paste the picture and adjust its position\nppSlide.Shapes.Paste.Select \u2018 =&gt; THIS IS WHERE MACRO GOES IN ERROR SEE BELOW\npp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\npp.ActiveWindow.Selection.ShapeRange.Top = 75\npp.ActiveWindow.Selection.ShapeRange.Left = 125\npp.ActiveWindow.Selection.ShapeRange.Width = 550\n\n'Step 8:  Add the title to the slide then move to next worksheet\nNext xlwksht\n\n'Step 9: Saves the Powerpoint file updated with the name TDB pat_PAG_.ppt  and closes it the Powerpoint file updated \nppPres.SaveAs \"C:\\Users\\392710\\Desktop\\MENSILI_WRK\\TDB patrimoni_PAG_.ppt\", 1\nppPres.Close\n\n'Step 10:  Memory Cleanup\npp.Activate\nSet ppSlide = Nothing\nSet ppPres = Nothing\nSet pp = Nothing\n\nEND SUB\n</code></pre>\n\n<p>The strange thing is that the macro works perfectly when I run it in debug (F8) step by step, but it doesn\u2019t work anymore when I run it directly from the Excel Macro (Macro/View/Run). It stops after the first picture has been copied in the first slide added to ppw (see the comment in the code). </p>\n\n<p>The error message is: </p>\n\n<blockquote>\n  <p>Run time error \u2018-2147188160 (80048240)\u2019 ShapeRange.Select : Invalid request. To select a shape, its view must be active.</p>\n</blockquote>\n\n<p>Can you help me please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 1, "creation_date": 1518603383, "post_id": 48784570, "comment_id": 84570590, "body": "I suspect that &quot;<code>Date</code>&quot; will return current date <b>and time</b> and [02/14/2018 00:00] is lower than [02/14/2018 11:17]"}, {"owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "reply_to_user": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1518603621, "post_id": 48784570, "comment_id": 84570743, "body": "exactly, so I want to update it until yesterday&#39;s date. Hence &quot;ActiveCell.Value &lt; MyDate&quot; and not &quot;ActiveCell.Value &lt;= MyDate&quot;"}, {"owner": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 1, "creation_date": 1518603715, "post_id": 48784570, "comment_id": 84570808, "body": "You have to cut the time from your <code>MyDate</code> so your comparison is good"}, {"owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "reply_to_user": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1518603762, "post_id": 48784570, "comment_id": 84570835, "body": "ok I got it almost, it was only to add the following line in the loop: ActiveCell.Value = ActiveCell.Value + 1"}, {"owner": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 2, "creation_date": 1518604043, "post_id": 48784570, "comment_id": 84571043, "body": "I&#39;m still trying to figure out what you really want to do. Can you show a capture of what was the expected result (as you seemed to solve your problem) ?"}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "is_accepted": false, "score": 0, "last_activity_date": 1518604095, "creation_date": 1518604095, "answer_id": 48784885, "question_id": 48784570, "link": "https://stackoverflow.com/questions/48784570/add-yesterdays-date-to-cell/48784885#48784885", "title": "Add yesterday&#39;s date to cell", "body": "<p>I actually got it myself, in case anybody's interested, this is the code:</p>\n\n<pre><code>Sub Update_Newest_Day_Conversions()\n\nWorksheets(\"CPC - Conversions DoD\").Range(\"A1\"). _\nEnd(xlToRight).Select\n\nMyDate = Date - 1\n\nWhile ActiveCell.Value &lt; MyDate\n\nActiveCell.Copy ActiveCell.Offset(0, 1)\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = ActiveCell.Value + 1\n\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "is_accepted": false, "score": 0, "last_activity_date": 1518604161, "creation_date": 1518604161, "answer_id": 48784907, "question_id": 48784570, "link": "https://stackoverflow.com/questions/48784570/add-yesterdays-date-to-cell/48784907#48784907", "title": "Add yesterday&#39;s date to cell", "body": "<p>The problem is that you are always copying the same date, hence the date will always be smaller than the current date. You could try something like this:</p>\n\n<pre><code>While ActiveCell.Value &lt; MyDate\n    olddate = ActiveCell.Value\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = olddate + 1\nWend\n</code></pre>\n\n<p>Using <code>ActiveCell</code> is not recommend, if you are interested take a look at this: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}, {"comments": [{"owner": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1518604983, "post_id": 48785066, "comment_id": 84571683, "body": "From the question &quot;<i>which updates the first row</i>&quot; - from your answer &quot;<i>all the cells in the first column</i>&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3619, "user_id": 7831383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtBVh.jpg?s=128&g=1", "display_name": "Rafalon", "link": "https://stackoverflow.com/users/7831383/rafalon"}, "edited": false, "score": 0, "creation_date": 1518605053, "post_id": 48785066, "comment_id": 84571734, "body": "@Rafalon - do not watch the text in the answer, but the code :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1518605064, "last_edit_date": 1518605064, "creation_date": 1518604652, "answer_id": 48785066, "question_id": 48784570, "link": "https://stackoverflow.com/questions/48784570/add-yesterdays-date-to-cell/48785066#48785066", "title": "Add yesterday&#39;s date to cell", "body": "<p>Try this:</p>\n\n<pre><code>Sub UpdateNewestDayConversions()\n\n    Dim selectedRange   As Range\n    Dim MyDate          As Date\n    Dim myCell          As Range\n\n    With Worksheets(\"CPC - Conversions DoD\")\n        Set selectedRange = .Range(.Cells(1, 1), .Cells(1, 1).End(xlToRight))\n    End With        \n\n    MyDate = Date - 1\n\n    For Each myCell In selectedRange\n        If IsDate(myCell) Then\n            If DateSerial(Year(myCell), Month(myCell), Day(myCell)) &lt; MyDate Then\n                myCell = DateAdd(\"d\", 1, myCell)\n            End If\n        Else\n            MsgBox \"Check \" &amp; myCell.Address &amp; \" , it is not a valid date!\"\n        End If\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>What are the pluses in this code:</p>\n\n<ul>\n<li>it does not use <code>Select</code>;</li>\n<li>loops through all the cells in the first row;</li>\n<li>checks whether the cell is a valid date and lets you know if this is not the case;</li>\n<li>shows you how to use <code>DateAdd()</code>, which is a nice function;</li>\n<li>compares only the date of the cell, not the hour and the seconds, with the usage of <code>DateSerial()</code> (see the comment of @Rafalon);</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1518604942, "creation_date": 1518604942, "answer_id": 48785155, "question_id": 48784570, "link": "https://stackoverflow.com/questions/48784570/add-yesterdays-date-to-cell/48785155#48785155", "title": "Add yesterday&#39;s date to cell", "body": "<p>Try this:</p>\n\n<pre><code>Sub Update_Newest_Day_Conversions()\n    Dim col As Integer\n\n    col = Range(\"A1\").End(xlToRight).Column\n\n    While Cells(1, col) &lt; VBA.Date() - 1\n        Cells(1, col).Offset(0, 1) = Cells(1, col) + 1\n        col = col + 1\n    Wend\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8510750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15d0f62eb23324a7e0c13ba4a910658?s=128&d=identicon&r=PG&f=1", "display_name": "Naveenkumar", "link": "https://stackoverflow.com/users/8510750/naveenkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1518606636, "creation_date": 1518606636, "answer_id": 48785754, "question_id": 48784570, "link": "https://stackoverflow.com/questions/48784570/add-yesterdays-date-to-cell/48785754#48785754", "title": "Add yesterday&#39;s date to cell", "body": "<p>Try this</p>\n\n<pre><code>  Sub Update_Newest_Day_Conversions()\n\n   Worksheets(\"CPC - Conversions DoD\").Range(\"A1\").End(xlToRight).Select\n   Diff_Date = Date - ActiveCell.Value\n\n   For i = 1 To Diff_Date - 1\n       ActiveCell.Offset(0, 1).Value = ActiveCell.Value + 1\n       ActiveCell.Offset(0, 1).Select\n   Next\n\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1518795316, "creation_date": 1518603202, "last_edit_date": 1518795316, "question_id": 48784570, "link": "https://stackoverflow.com/questions/48784570/add-yesterdays-date-to-cell", "title": "Add yesterday&#39;s date to cell", "body": "<p>I have a report which I update every other day. I want to write a formula which updates the first row (which has dates in it) so that it updates the date until yesterday's date. </p>\n\n<p>This is the code I wrote so far:</p>\n\n<pre><code>Sub Update_Newest_Day_Conversions()\n\n    Worksheets(\"CPC - Conversions DoD\").Range(\"A1\").End(xlToRight).Select\n\n    MyDate = Date\n\n    While ActiveCell.Value &lt; MyDate\n        ActiveCell.Copy ActiveCell.Offset(0, 1)\n        ActiveCell.Offset(0, 1).Select\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately I cannot figure out how to add the part where the date is updated by one for every new column. This is how it ends up looking (the loop does not stop obviously because the date remains unchanged):</p>\n\n<p><a href=\"https://i.stack.imgur.com/OTa6S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OTa6S.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Can anybody help out? </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1518603730, "post_id": 48784488, "comment_id": 84570814, "body": "Best practise is to use Option Explicit. That means you should DIM everything."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1518604156, "post_id": 48784488, "comment_id": 84571118, "body": "Does <code>.Attachments.Add &quot;C:\\123.pdf&quot;</code> work?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1518606704, "post_id": 48784488, "comment_id": 84572804, "body": "What is objEmail? Please show, how you create it"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1518882665, "post_id": 48784488, "comment_id": 84690216, "body": "MailItem object does not expose a property called &quot;From&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1518751905, "creation_date": 1518751905, "answer_id": 48819671, "question_id": 48784488, "link": "https://stackoverflow.com/questions/48784488/why-does-attachment-add-generate-a-type-mismatch-error/48819671#48819671", "title": "Why does Attachment.Add generate a Type Mismatch error?", "body": "<p>Try this version.</p>\n\n<pre><code>Sub Mail_ActiveSheet()\n'Working in Excel 2000-2016\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim Sourcewb As Workbook\n    Dim Destwb As Workbook\n    Dim TempFilePath As String\n    Dim TempFileName As String\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set Sourcewb = ActiveWorkbook\n\n    'Copy the ActiveSheet to a new workbook\n    ActiveSheet.Copy\n    Set Destwb = ActiveWorkbook\n\n    'Determine the Excel version and file extension/format\n    With Destwb\n        If Val(Application.Version) &lt; 12 Then\n            'You use Excel 97-2003\n            FileExtStr = \".xls\": FileFormatNum = -4143\n        Else\n            'You use Excel 2007-2016\n            Select Case Sourcewb.FileFormat\n            Case 51: FileExtStr = \".xlsx\": FileFormatNum = 51\n            Case 52:\n                If .HasVBProject Then\n                    FileExtStr = \".xlsm\": FileFormatNum = 52\n                Else\n                    FileExtStr = \".xlsx\": FileFormatNum = 51\n                End If\n            Case 56: FileExtStr = \".xls\": FileFormatNum = 56\n            Case Else: FileExtStr = \".xlsb\": FileFormatNum = 50\n            End Select\n        End If\n    End With\n\n    '    'Change all cells in the worksheet to values if you want\n    '    With Destwb.Sheets(1).UsedRange\n    '        .Cells.Copy\n    '        .Cells.PasteSpecial xlPasteValues\n    '        .Cells(1).Select\n    '    End With\n    '    Application.CutCopyMode = False\n\n    'Save the new workbook/Mail it/Delete it\n    TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n    TempFileName = \"Part of \" &amp; Sourcewb.Name &amp; \" \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    With Destwb\n        .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n        On Error Resume Next\n        With OutMail\n            .to = \"ron@debruin.nl\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"This is the Subject line\"\n            .Body = \"Hi there\"\n            .Attachments.Add Destwb.FullName\n            'You can add other files also like this\n            '.Attachments.Add (\"C:\\test.txt\")\n            .Send   'or use .Display\n        End With\n        On Error GoTo 0\n        .Close savechanges:=False\n    End With\n\n    'Delete the file you have send\n    Kill TempFilePath &amp; TempFileName &amp; FileExtStr\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s1/outlook/amail2.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/amail2.htm</a></p>\n\n<p>You will find lots of useful Excel/Outlook scripts at the link below.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/mail.htm</a></p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "accepted_answer_id": 48819671, "answer_count": 1, "score": -1, "last_activity_date": 1593057469, "creation_date": 1518602953, "last_edit_date": 1593057469, "question_id": 48784488, "link": "https://stackoverflow.com/questions/48784488/why-does-attachment-add-generate-a-type-mismatch-error", "title": "Why does Attachment.Add generate a Type Mismatch error?", "body": "<p>I am trying to add an attachment to my Outlook email but must be missing something simple. I have been researching but no come across a way around it just yet.</p>\n\n<p>My Code:</p>\n\n<pre><code>With objEmail\n    .To = email\n    .From = strFrom\n    .CC = strCC\n    .Subject = \"A New Deli Order has been Received\"\n    .textbody = \"Please find attached a new deli order\"\n    .Attachments.Add (\"C:\\123.pdf\")\n\nWith .Configuration.Fields\n        .Item(strItem &amp; \"sendusing\") = 2\n        .Item(strItem &amp; \"smtpserver\") = \"mailhost\"\n        .Item(strItem &amp; \"smtpserverport\") = 25\n        .Update\n\n    End With\n    .Send\nEnd With\n</code></pre>\n\n<p>I thought the simple below line would work</p>\n\n<blockquote>\n  <p>.Attachment</p>\n</blockquote>\n\n<p>Do I need DIM anything? If so as what?</p>\n\n<p><strong>The error received:</strong></p>\n\n<blockquote>\n  <p>Type Mismatch</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 36290, "user_id": 300836, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/En2qu.jpg?s=128&g=1", "display_name": "Matt Gibson", "link": "https://stackoverflow.com/users/300836/matt-gibson"}, "edited": false, "score": 1, "creation_date": 1518602954, "post_id": 48784412, "comment_id": 84570308, "body": "Could you describe &quot;doesn&#39;t work&quot;?"}, {"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "reply_to_user": {"reputation": 36290, "user_id": 300836, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/En2qu.jpg?s=128&g=1", "display_name": "Matt Gibson", "link": "https://stackoverflow.com/users/300836/matt-gibson"}, "edited": false, "score": 0, "creation_date": 1518603390, "post_id": 48784412, "comment_id": 84570596, "body": "Sorry. It gives the error: ByRef argument type mismatch"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1518604891, "post_id": 48784412, "comment_id": 84571620, "body": "Did you try to declare <code>wb</code> in <code>Private Sub CommandButton2</code> first? As in <code>Dim wb As Workbook</code>"}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "edited": false, "score": 0, "creation_date": 1518606315, "post_id": 48785144, "comment_id": 84572569, "body": "Thankyou, this helps my understanding. Just found it weird as I was able to use the exact same code but in a sub that wasn&#39;t the button click and it worked..."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1518605231, "last_edit_date": 1518605231, "creation_date": 1518604923, "answer_id": 48785144, "question_id": 48784412, "link": "https://stackoverflow.com/questions/48784412/passing-workbook-from-command-button-vba/48785144#48785144", "title": "passing workbook from command button vba", "body": "<p>In <code>CommandButton2_Click()</code> you don't declare <code>wb</code>. So it's a Variant data type. This isn't compatible to <code>ByRef wb As Workbook</code>.</p>\n\n<p>So add</p>\n\n<pre><code>Dim wb As Workbook\n</code></pre>\n\n<p>and to avoid further errors like this, put <a href=\"https://msdn.microsoft.com/en-us/library/bw9t3484%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> at the top of each module.</p>\n\n<p>It enforces variable declaration and reports undeclared or misspelled variables/constants at compile time. \nTo have this automatically in new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor. </p>\n\n<p><strong>Edit</strong>: Demo</p>\n\n<pre><code>'Option Explicit\n\nSub Demo_Fail()\n    Set wb = ActiveWorkbook\n    CreateChart wb      ' Compile error: ByRef argument type mismatch\nEnd Sub\n\nSub Demo_Success()\n    Dim wb As Workbook\n    Set wb = ActiveWorkbook\n    CreateChart wb\nEnd Sub\n\nSub CreateChart(ByRef wb As Workbook)\n    Debug.Print wb.Name\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1518605133, "creation_date": 1518605133, "answer_id": 48785226, "question_id": 48784412, "link": "https://stackoverflow.com/questions/48784412/passing-workbook-from-command-button-vba/48785226#48785226", "title": "passing workbook from command button vba", "body": "<p>It's because you don't declare explicitly <code>wb</code> variable, so it's assumed implicitly as being of <code>Variant</code> type, while <code>CreateChart</code> accepts a <code>Workbook</code> type parameter</p>\n\n<p>use:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim wb As Workbook ' declare wb of Workbook type\n\n    Workbooks.Open Filename:=TextBox1.Text\n    Set wb = ActiveWorkbook\n\n    CreateChart wb\nEnd Sub\n</code></pre>\n\n<p>but you can even shorten that down to:</p>\n\n<pre><code>Private Sub CommandButton1_Click()        \n    CreateChart Workbooks.Open(Filename:=TextBox1.Text)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 48785144, "answer_count": 2, "score": 0, "last_activity_date": 1518605231, "creation_date": 1518602764, "question_id": 48784412, "link": "https://stackoverflow.com/questions/48784412/passing-workbook-from-command-button-vba", "title": "passing workbook from command button vba", "body": "<p>I have a question about something which is confusing me in VBA. I have a command button, which when clicked I want to set a variable = to a workbook object, then pass this object to another sub. I cannot work out why I can't pass it to the sub, I can't see why what I'm doing doesn't work. Code as follows:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nWorkbooks.Open Filename:=TextBox1.Text\nSet wb = ActiveWorkbook\n\nCreateChart wb\nEnd Sub\n\nSub CreateChart(ByRef wb As Workbook)\n'PURPOSE: Create a chart (chart dimensions are not required)\n\nDim rng As Range\nDim cht As Object\n\n'Your data range for the chart\n  Set rng = wb.ActiveSheet.Range(\"A24:A27\")\n\n'Create a chart\n  Set cht = ActiveSheet.Shapes.AddChart2\n\n'Give chart some data\n  cht.Chart.SetSourceData Source:=rng\n\n'Determine the chart type\n  cht.Chart.ChartType = xlXYScatterLines\n\nEnd Sub\n</code></pre>\n\n<p>NB I have found a workaround which is to set the workbook within another sub, but would like to understand why it doesn't work this way. Please can anyone offer advice?</p>\n\n<p>Thankyou.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518602926, "post_id": 48784321, "comment_id": 84570295, "body": "Why don&#39;t you apply the font size before filtering?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518603268, "post_id": 48784321, "comment_id": 84570508, "body": "I&#39;m at a loss as to why you need to change anything on a hidden cell."}, {"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1518611018, "post_id": 48784321, "comment_id": 84575731, "body": "it is an overview of all of the orders in my department. I have several buttons that filters the ordertypes into subcategories. So if I have a list with orders, one button shows only orders of subtype A and hides B &amp; C, another shows B and hides A &amp;C etcetra. so they are hidden at that moment, but if you switch departments its a mess of different font sizes in the same list"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1518607677, "post_id": 48785491, "comment_id": 84573444, "body": "Does not seem to have any effect"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1518608335, "post_id": 48785491, "comment_id": 84573868, "body": "in my test it does have effect!  You may want to show your scenario in more detail"}, {"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1518612444, "post_id": 48785491, "comment_id": 84576744, "body": "aahh ok i found the difference i think. there are hidden columns, not rows. But if I change the EntireRow to EntireColumn it still does not work"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1518617860, "post_id": 48785491, "comment_id": 84580378, "body": "see edited answer. you have to both keep <code>EntireRow</code> and add <code>EntireColumn</code> handling. if it solves your question please mark it as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1518617764, "last_edit_date": 1518617764, "creation_date": 1518605888, "answer_id": 48785491, "question_id": 48784321, "link": "https://stackoverflow.com/questions/48784321/changing-font-size-of-hidden-cells/48785491#48785491", "title": "Changing font size of hidden cells", "body": "<p><strong>Edited</strong>, to handle hidden columns also</p>\n\n<p>you can unhide all cells, apply font formatting and finally hide back previously hidden cells</p>\n\n<p>like follows</p>\n\n<pre><code>Dim visibleCells As Range\nWith Range(\"B2:Z200\")\n    Set visibleCells = .SpecialCells(xlCellTypeVisible)\n    .EntireRow.Hidden = False 'unhide all rows\n    .EntireColumn.Hidden = False 'unhide all rows\n    .Font.Size = 9\n    .EntireRow.Hidden = True\n    .EntireColumn.Hidden = True\nEnd With\nWith visibleCells\n    .EntireRow.Hidden = False\n    .EntireColumn.Hidden = False\nEnd With \n\nColumns(\"B\").ColumnWidth = 10.86 \n....\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 48785491, "answer_count": 1, "score": 0, "last_activity_date": 1518624144, "creation_date": 1518602500, "last_edit_date": 1531164843, "question_id": 48784321, "link": "https://stackoverflow.com/questions/48784321/changing-font-size-of-hidden-cells", "title": "Changing font size of hidden cells", "body": "<p>To make a long story short, I have an excel with a lot of filter options. To accommodate some different screen sizes I made a macro that changes the column widths and font size.</p>\n\n<pre><code>Sub SmallMode()\n\n'\n'Change to Small Mode\n'font size to 9, various cell widths, Small Mode title\n'\n\nRange(\"B2:Z200\").Font.Size = 9\nColumns(\"B\").ColumnWidth = 10.86\nColumns(\"C\").ColumnWidth = 10.71\nColumns(\"H\").ColumnWidth = 33.14\nColumns(\"I\").ColumnWidth = 21.86\nColumns(\"J\").ColumnWidth = 8.71\nColumns(\"M\").ColumnWidth = 10\nColumns(\"N\").ColumnWidth = 10\nColumns(\"O\").ColumnWidth = 10.57\nColumns(\"S\").ColumnWidth = 7.43\nColumns(\"T\").ColumnWidth = 5.86\nColumns(\"V\").ColumnWidth = 12\nColumns(\"W\").ColumnWidth = 7.14\nColumns(\"X\").ColumnWidth = 11.43\nColumns(\"Y\").ColumnWidth = 14.29\nColumns(\"Z\").ColumnWidth = 15.71\nRange(\"Y1\").Value = \"Small   Mode\"\n\nEnd Sub\n</code></pre>\n\n<p>my problem with it is that while the widths work great, the font only resizes the current cells, not the ones that are hidden under a filter. Is there a way to force all of them into the right size?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1518602232, "post_id": 48784095, "comment_id": 84569847, "body": "What cell is selected at the begining?"}, {"owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1518602540, "post_id": 48784095, "comment_id": 84570051, "body": "At the beginning &quot;O&quot; (Date)"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1518602763, "post_id": 48784095, "comment_id": 84570204, "body": "<code>.Range(&quot;V&quot; &amp; ActiveCell.Row)</code> is wrong syntax. Try <code>ActiveSheet.Cells(ActiveCell.Row, &quot;V&quot;)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1518603291, "post_id": 48784095, "comment_id": 84570527, "body": "@Variatus - what&#39;s wrong with <code>Range(&quot;V&quot; &amp; ActiveCell.Row)</code>?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518603364, "post_id": 48784095, "comment_id": 84570579, "body": "You should read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a>."}, {"owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1518603887, "post_id": 48784095, "comment_id": 84570928, "body": "@Variatus Thank you I&#39;ll keep it in mind. However it didn&#39;t help me in this case."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1518603925, "post_id": 48784095, "comment_id": 84570958, "body": "My mistake - end of day benightedness! I will try to make up."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1518604148, "creation_date": 1518604148, "answer_id": 48784903, "question_id": 48784095, "link": "https://stackoverflow.com/questions/48784095/looping-copying-cells/48784903#48784903", "title": "Looping &amp; copying cells", "body": "<p>Try not to use <code>ActiveCell</code> Your code can do quite unpredictable things to your worksheet if the wrong cell was selected, and so can my \"improvement\" thereof below. </p>\n\n<pre><code>Sub FindAndCopy()\n\n    Dim Ws As Worksheet\n    Dim R As Long, C As Long\n\n    With ActiveCell\n        Set Ws = .Worksheet\n        R = .Row\n        C = .Column\n    End With\n\n    With Ws\n        If Len(Trim(.Cells(R, C - 2).Value)) = 0 Then\n            'Go up find contract number copy\n            Do Until Len(.Cells(R, C - 2).Value)\n                R = R - 1\n            Loop\n            .Cells(R, \"M\").Copy Destination:=.Cells(ActiveCell.Row, \"V\")\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I think the <code>ActiveCell</code> component in this code is still a source of great danger. However, as you see, at least the code doesn't change it which dispenses with the necessity of going back to it in the end.</p>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "is_accepted": false, "score": 1, "last_activity_date": 1518604427, "last_edit_date": 1592644375, "creation_date": 1518604427, "answer_id": 48784997, "question_id": 48784095, "link": "https://stackoverflow.com/questions/48784095/looping-copying-cells/48784997#48784997", "title": "Looping &amp; copying cells", "body": "<h3>You didn't select the desired cell</h3>\n<p>Problem lies in this loop:</p>\n<pre><code>'Selecting cell from a column to the left\nActiveCell.Offset(0, -2).Select\n'Condition: cell value is not empty string\nDo Until ActiveCell.Value &lt;&gt; &quot;&quot;\n    'Selecting cell from previous row in the same column\n    ActiveCell.Offset(-1, 0).Select\nLoop\n</code></pre>\n<p>You're leaving the loop before you can <code>.Select</code> a cell.</p>\n<p>Use this loop instead:</p>\n<pre><code>'Selecting cell from a column to the left\nActiveCell.Offset(0, -2).Select\n'Condition: cell value is not empty string\nDo\n    'Selecting cell from previous row in the same column\n    ActiveCell.Offset(-1, 0).Select\nLoop Until ActiveCell.Value &lt;&gt; &quot;&quot;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518982123, "post_id": 48786251, "comment_id": 84714847, "body": "@Trawa, any feedback?"}, {"owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "edited": false, "score": 0, "creation_date": 1519975951, "post_id": 48786251, "comment_id": 85134050, "body": "I&#39;m sorry for such a late reply. Thank you it worked! I&#39;ll keep in mind not to use select and activecell reference together."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "edited": false, "score": 0, "creation_date": 1519976228, "post_id": 48786251, "comment_id": 85134154, "body": "you are welcome. as for the <code>Selection&#47;Active</code> issue you may want to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">This post</a>"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1518608129, "creation_date": 1518608129, "answer_id": 48786251, "question_id": 48784095, "link": "https://stackoverflow.com/questions/48784095/looping-copying-cells/48786251#48786251", "title": "Looping &amp; copying cells", "body": "<p>the issue lays in your keeping relying on <code>ActiveCell</code> after </p>\n\n<pre><code>ActiveCell.Offset(-1, 0).Select\n</code></pre>\n\n<p>statement, that changes it ...</p>\n\n<p>you're actually playing with fire when using <code>ActiveCell</code> together with <code>Select</code>/<code>Selection</code> coding pattern!</p>\n\n<p>since I cannot see what's behind the code you showed, I must keep using <code>ActiveCell</code> reference and amend your code as per comments:</p>\n\n<pre><code>Dim cellToCopy As Range\nWith ActiveCell 'reference currently \"active\" cell\n    If .Offset(0, -2) = \"\" Then 'if the cell two columns left of referenced (i.e. \"active\") cell is empty...\n        Set cellToCopy = .Offset(0, -2).End(xlUp) '... set cell to copy as the first not empty one above the cell two columns left of referenced (i.e. \"active\") cell\n    Else '... otherwise\n        Set cellToCopy = .Offset(0, -2) 'set cell to copy as the one two columns left of referenced (i.e. \"active\") cell\n    End If\n    cellToCopy.Copy Destination:=Range(\"V\" &amp; .Row) 'copy the cell set as the one to be copied and paste it column V cell same row as reference (i.e. \"active\") cell\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 48786251, "answer_count": 3, "score": 0, "last_activity_date": 1518624164, "creation_date": 1518601877, "last_edit_date": 1531164843, "question_id": 48784095, "link": "https://stackoverflow.com/questions/48784095/looping-copying-cells", "title": "Looping &amp; copying cells", "body": "<p>Generally my macro goes through every \"O\" cell, checks if the row meets given requirements (not mentioned in this part of code) and copies surrounding cells on the side. I have two columns used in this part: \"contract no\"(M), \"date\"(O). The problem is that I try to use below method to go up to last the contract number and copy it as well. \nI do not get any error but the contract cell value does not paste. Could you tell me what I've done wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/nWHFn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nWHFn.png\" alt=\"https://i.stack.imgur.com/nWHFn.png\"></a></p>\n\n<pre><code>If ActiveCell.Offset(0, -2) = \"\" Then\n    'Go up find contract number copy\n    ActiveCell.Offset(0, -2).Select\n    Do Until ActiveCell.Value &lt;&gt; \"\"\n        ActiveCell.Offset(-1, 0).Select                                                                     \n    Loop                                                     \n    ActiveSheet.Range(\"M\" &amp; ActiveCell.Row).Copy _\n        Destination:=ActiveSheet.Range(\"V\" &amp; ActiveCell.Row)\n    'Go down and return to the last active cell\n    Do Until ActiveCell.Value &lt;&gt; \"\"\n        ActiveCell.Offset(1, 0).Select \n    Loop\n    ActiveCell.Offset(0, 2).Select\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "reporting", "ms-access-2016"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1518600601, "post_id": 48783564, "comment_id": 84568827, "body": "You will need a crosstab query for that: <a href=\"https://support.office.com/en-gb/article/make-summary-data-easier-to-read-by-using-a-crosstab-query-8465b89c-2ff2-4cc8-ba60-2cd8484667e8\" rel=\"nofollow noreferrer\">support.office.com/en-gb/article/&hellip;</a>"}, {"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1518602396, "post_id": 48783564, "comment_id": 84569958, "body": "Thank you for you quick answer. I have tried it and it works almost perfectly - the only part I&#39;m stuck on now is that the values shown are a count of the Status and not the actual status it self. I cant work out how to change this to the actual value and not a count/calculation. Is this possible?"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "edited": false, "score": 0, "creation_date": 1518622953, "post_id": 48784670, "comment_id": 84583919, "body": "This all works for me expect for one thing, I&#39;ve noticed that the column headers can not be more than 64 characters long. Some of the fields I am  using for the headers contain 100+ characters. Is there a way to get the full field content as the header?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "edited": false, "score": 0, "creation_date": 1518626347, "post_id": 48784670, "comment_id": 84586312, "body": "In a few words no I&#39;m afraid. <a href=\"https://support.office.com/en-ie/article/access-2010-specifications-1e521481-7f9a-46f7-8ed9-ea9dff1fa854\" rel=\"nofollow noreferrer\">support.office.com/en-ie/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1518603490, "creation_date": 1518603490, "answer_id": 48784670, "question_id": 48783564, "link": "https://stackoverflow.com/questions/48783564/ms-access-2016-reporting-table-data-as-column-headers/48784670#48784670", "title": "Ms Access 2016 Reporting - table data as column headers", "body": "<p>Try this as the source of your crosstab query:</p>\n\n<pre><code>TRANSFORM First(T.Status) AS Status\nSELECT T.Product\nFROM T\nGROUP BY T.Product\nPIVOT T.Date;\n</code></pre>\n\n<p>Where <code>T</code> is your table name.</p>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533403471, "creation_date": 1518600215, "last_edit_date": 1533403471, "question_id": 48783564, "link": "https://stackoverflow.com/questions/48783564/ms-access-2016-reporting-table-data-as-column-headers", "title": "Ms Access 2016 Reporting - table data as column headers", "body": "<p>I am using Ms Access2016 to collect and process data from multiple users.\nI need to create a report showing the statuses of reviews for a rolling 3 month period.</p>\n\n<p>I have a query that gets the relevant data which is held:</p>\n\n<pre><code>Product    Status     Date\nProdA      Green      Feb-2018\nProdA      Red        Jan-2018\nProdA      Red        Dec-2017\nProdB      Green      Feb-2018\nProdB      Green      Jan-2018\nProdB      Red        Dec-2017\n</code></pre>\n\n<p>I need a report where the column headers are the distinct date values, below this are the statuses for the relevant products e.g.</p>\n\n<pre><code>Product     Dec-2017    Jan-2018     Feb-2018\nProdA       Red         Red          Green\nProdB       Red         Green        Green\n</code></pre>\n\n<p>I can create something similar in Excel but really want to keep it all together in Access. Is this possible and if so how? Does anyone have a link to any guides on this - I haven't been able to find anything that helps but probably searching for the wrong thing.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1518608286, "last_edit_date": 1518608286, "creation_date": 1518600314, "answer_id": 48783601, "question_id": 48783497, "link": "https://stackoverflow.com/questions/48783497/changing-value-of-a-cell-in-multiple-worksheets-from-a-range-in-another-workbook/48783601#48783601", "title": "Changing value of a cell in multiple worksheets from a range in another workbook", "body": "<p>Try this:</p>\n\n<ol>\n<li>Open your destination workbook and store a reference to the workbook in a variable</li>\n<li>Loop through the worksheets in your current workbook using a <code>For</code> loop</li>\n<li>Fully qualify your references, using this new variable name and <code>ThisWorkbook</code> to distingish between ranges on different workbooks. </li>\n</ol>\n\n<hr>\n\n<pre><code>Sub TransferValues()\n    Dim workbook2 As Workbook\n    Dim i As Long\n\n    Set workbook2 = Workbooks.Open(\"C://My Documents/.../SomeWorkbook2.xlsx\")\n\n    For i = 1 To ThisWorkbook.Worksheets.Count\n        ThisWorkbook.Worksheets(i).Range(\"A1\").Value = workbook2.Worksheets(\"Sheet1\").Range(\"A1\").Offset(i - 1, 0).Value\n    Next i\n\n    workbook2.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518609015, "post_id": 48785106, "comment_id": 84574352, "body": "I like the progression from my answer to yours, nice addition. This code is undoubtedly faster but I&#39;m interested in the <i>optimised memory access</i> bit. I&#39;d be tempted to say you are using <i>more</i> memory -- but <i>effectively</i> (to speed things up)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518611063, "post_id": 48785106, "comment_id": 84575763, "body": "@CallumDA, I quoted &quot;memory accesses&quot; and not &quot;memory quantity&quot;, so we&#39;re both right! I aimed at: 1) opening and closing a new workbook for as little time as necessary (and this actually minimize memory quantity, too) 2) avoiding repeated access to both &quot;workbook1&quot; (i.e. <code>ThisWorkbook</code>) and &quot;workbook2&quot; inside the loop. That&#39;s it. Edit: and a <code>For Each ... Next</code> loop in a collection is faster than a <code>For i = .. to ... Next i</code> one"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1518604800, "creation_date": 1518604800, "answer_id": 48785106, "question_id": 48783497, "link": "https://stackoverflow.com/questions/48783497/changing-value-of-a-cell-in-multiple-worksheets-from-a-range-in-another-workbook/48785106#48785106", "title": "Changing value of a cell in multiple worksheets from a range in another workbook", "body": "<p>here's a variation on CallumDA code, mainly to optimize memory accesses and, hence, performance (should it ever be an issue):</p>\n\n<pre><code>Sub TransferValues()\n    Dim myValues As Variant\n    With Workbooks.Open(\"C://My Documents//SomeWorkbook2.xlsx\") 'open and reference \"source \" workbook\n        myValues = Application.Transpose(.Worksheets(\"Sheet1\").Range(\"A1\").Resize(ThisWorkbook.Worksheets.Count).Value) 'store referenced workbook \"Sheet1\" worksheet values in column A from row 1 down to \"workbook1\" (i.e. the one where the macro resides in) sheets number\n        .Close False 'close referenced workbook\n    End With\n\n    Dim sht As Worksheet\n    For Each sht In ThisWorkbook.Worksheets\n        sht.Range(\"A1\").Value = myValues(sht.Index)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9359116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jerram Lindsay", "link": "https://stackoverflow.com/users/9359116/jerram-lindsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1518624183, "creation_date": 1518600036, "last_edit_date": 1518624183, "question_id": 48783497, "link": "https://stackoverflow.com/questions/48783497/changing-value-of-a-cell-in-multiple-worksheets-from-a-range-in-another-workbook", "title": "Changing value of a cell in multiple worksheets from a range in another workbook", "body": "<p>So i have a workbook with around 500 worksheets, and i need to change the value of a cell, say A1, in each worksheet, to a value in a range from another workbook.</p>\n\n<p>For example,</p>\n\n<p>the value of A1 in Sheet1 in Workbook1 = A1 in Sheet1 of Workbook2</p>\n\n<p>the value of A1 in Sheet2 in Workbook1 = A2 in Sheet1 of Workbook2</p>\n\n<p>the value of A1 in Sheet3 in Workbook1 = A3 in Sheet1 of Workbook2</p>\n\n<p>etc.</p>\n\n<p>I've been trying to alter and use the following, but getting nowhere, any help would be appreciated. \nThanks</p>\n\n<pre><code>Sub mycode()\n\nFor Each Worksheet InThisWorkbook.Sheets\n    Range(\u201cA1\u2033) = \u201cExceltip\u201d\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1518599645, "post_id": 48783272, "comment_id": 84568147, "body": "Thank you - Also tried this but not received any email"}], "tags": [], "owner": {"reputation": 786, "user_id": 2768231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28d005c3867addfdb49c7f7b07619a44?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan M", "link": "https://stackoverflow.com/users/2768231/stefan-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1518599225, "creation_date": 1518599225, "answer_id": 48783272, "question_id": 48783200, "link": "https://stackoverflow.com/questions/48783200/sending-outlook-emails-from-excel/48783272#48783272", "title": "Sending outlook emails from Excel", "body": "<p>You're probably looking for <code>.SenderEmailAddress</code> or <code>.SentOnBehalfOfName</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 8923663, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-koRqrEUzoCE/AAAAAAAAAAI/AAAAAAAAAAw/2SR93fl9V5Q/photo.jpg?sz=128", "display_name": "Yigit Ozdamar", "link": "https://stackoverflow.com/users/8923663/yigit-ozdamar"}, "is_accepted": true, "score": 1, "last_activity_date": 1518612589, "last_edit_date": 1518612589, "creation_date": 1518602184, "answer_id": 48784201, "question_id": 48783200, "link": "https://stackoverflow.com/questions/48783200/sending-outlook-emails-from-excel/48784201#48784201", "title": "Sending outlook emails from Excel", "body": "<p>You can try <code>.SendUsingAccount</code> to select the account which you are going to send the e-mail.</p>\n\n<pre><code>With .Item\n    .SendUsingAccount = olAccount 'or some other account.\n    .To = \"123@321.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"A new deli pre-order has been received.\"\n    .Send\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1518751757, "creation_date": 1518751757, "answer_id": 48819654, "question_id": 48783200, "link": "https://stackoverflow.com/questions/48783200/sending-outlook-emails-from-excel/48819654#48819654", "title": "Sending outlook emails from Excel", "body": "<p>Try it this way.</p>\n\n<pre><code>Sub Mail_workbook_Outlook_1()\n'Working in Excel 2000-2016\n'This example send the last saved version of the Activeworkbook\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"ron@debruin.nl\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"This is the Subject line\"\n        .Body = \"Hi there\"\n        .Attachments.Add ActiveWorkbook.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s1/outlook/amail1.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/amail1.htm</a></p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 48784201, "answer_count": 3, "score": -1, "last_activity_date": 1518751757, "creation_date": 1518598968, "last_edit_date": 1531161705, "question_id": 48783200, "link": "https://stackoverflow.com/questions/48783200/sending-outlook-emails-from-excel", "title": "Sending outlook emails from Excel", "body": "<p>I have the below VBA that sends an email fine:</p>\n\n<pre><code>    With Sendrng\n\n        ' Select the worksheet with the range you want to send\n        .Parent.Select\n\n        'Remember the ActiveCell on that worksheet\n        Set rng = ActiveCell\n\n        'Select the range you want to mail\n        .Select\n\n        ' Create the mail and send it\n        ActiveWorkbook.EnvelopeVisible = True\n        With .Parent.MailEnvelope\n\n            ' Set the optional introduction field thats adds\n            ' some header text to the email body.\n            .Introduction = \"\"\n\n            With .Item\n                .To = \"123@321.com\"\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"A new deli pre-order has been received.\"\n                .Send\n            End With\n</code></pre>\n\n<p>The part where I am now struggling is to set who the email has come from</p>\n\n<p><strong>I thought adding the below would work:</strong></p>\n\n<pre><code> .From = \"111@222.com\"\n</code></pre>\n\n<p><strong>What happens when adding the above:</strong>\nNo email is received at all</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518598630, "post_id": 48783042, "comment_id": 84567441, "body": "Is this the only code that you are using - if not, show more. And possibly format the 1 line of HTML a bit better. However it seems that you are missing <code>IE.navigate</code> and etc. Check here - <a href=\"https://stackoverflow.com/questions/28153744/use-excel-vba-to-click-on-a-button-in-internet-explorer-when-the-button-has-no\" title=\"use excel vba to click on a button in internet explorer when the button has no\">stackoverflow.com/questions/28153744/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518598949, "post_id": 48783042, "comment_id": 84567650, "body": "I omitted that part as that was an internal website but I used the navigate twice and it was OK when I was debugging. I saw the posted link before. I was wondering why it returns &quot;object required&quot; error"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "edited": false, "score": 0, "creation_date": 1518601616, "post_id": 48783219, "comment_id": 84569453, "body": "I tried this before and it returns &quot;91&quot; error. object variable or with block variable not set vba  . I also tried yours, by adding an object variable. It gives the same error though.           IE.document.getElementsByClassName(&quot;PSPUSHBUTTONTBADD&quot;)(0).C&zwnj;&#8203;lick"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "edited": false, "score": 0, "creation_date": 1518602109, "post_id": 48783219, "comment_id": 84569754, "body": "@Sai - then probably you are not getting the correct class. Have you tried my code with copy+paste exactly? Trying to login to GitHub.com?"}, {"owner": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "edited": false, "score": 0, "creation_date": 1518617378, "post_id": 48783219, "comment_id": 84580056, "body": "I have tried your code with Github and it works. I think the problem is from my HTML code. May you see the HTML code I have pasted and point out what exactly the problem of my code is?         IE.document.getElementsByClassName(&quot;PSPUSHBUTTONTBADD&quot;)(0).C&zwnj;&#8203;lick"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "edited": false, "score": 0, "creation_date": 1518617454, "post_id": 48783219, "comment_id": 84580102, "body": "@Sai - are you sure that you navigate correctly to the corresponding site?"}, {"owner": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "edited": false, "score": 1, "creation_date": 1518665453, "post_id": 48783219, "comment_id": 84601928, "body": "You are right. My code is right. I was on the wrong site. Thx!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1518617535, "last_edit_date": 1518617535, "creation_date": 1518599063, "answer_id": 48783219, "question_id": 48783042, "link": "https://stackoverflow.com/questions/48783042/web-automation-by-vba-error-cannot-click-the-button-javascript/48783219#48783219", "title": "Web automation by VBA error - cannot click the button (javascript)", "body": "<p>This is probably the smallest example of clicking of a button in InternetExplorer with VBA:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.Visible = True\n    IE.navigate \"https://github.com\"\n\n    While IE.Busy\n        DoEvents\n    Wend\n\n    Dim objLoginLink As Object\n    Set objLoginLink = IE.Document.getElementsByClassName(\"text-bold text-white no-underline\")\n    objLoginLink(0).Click\n\nEnd Sub\n</code></pre>\n\n<p>This is how <code>objLoginLink</code> looks in the observer window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vD5mH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vD5mH.png\" alt=\"enter image description here\"></a></p>\n\n<p>The trick is that <code>IE.Document.getElementsBySomething</code> returns a collection, thus you can either loop through it or try to click on the first one.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28153744/use-excel-vba-to-click-on-a-button-in-internet-explorer-when-the-button-has-no\">Use Excel VBA to click on a button in Internet Explorer, when the button has no &quot;name&quot; associated</a></p>\n"}], "owner": {"reputation": 13, "user_id": 9359018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1260875617345955/picture?type=large", "display_name": "Sai ", "link": "https://stackoverflow.com/users/9359018/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 48783219, "answer_count": 1, "score": 1, "last_activity_date": 1518617535, "creation_date": 1518598370, "last_edit_date": 1531164843, "question_id": 48783042, "link": "https://stackoverflow.com/questions/48783042/web-automation-by-vba-error-cannot-click-the-button-javascript", "title": "Web automation by VBA error - cannot click the button (javascript)", "body": "<p>all.\nI would like to click the button named id='#ICSearch'.Runtime error 424, object required. Since it is an on-click button that loads js. Will that be a problem?\nI tried different codes but cannot get it. I am new to this please bear with me.</p>\n\n<pre><code>Private Sub IE_Autiomation()\n    Dim i As Long\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    '1.\n    IE.document.getElementById(\"ICSearch\").Click\n\n    '2.\n    IE.document.getElementsByClassName(\"PSPUSHBUTTONTBADD\")(0).Click\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>&lt;DIV class='' id='win0divSEARCHBELOW'&gt;&lt;br/&gt;&lt;br /&gt;&lt;a class='PSPUSHBUTTON'   \n  id = 'Left' role='presentation'&gt;&lt;span style='background-Color: transparent;border:0;'&gt;    \n  &lt;input type='button'     \n    id='#ICSearch' name='#ICSearch'  class='PSPUSHBUTTONTBADD'      \n    value='Add' onclick=\"javascript:submitAction_win0(document.win0, \n    '#ICSearch');\" tabindex='18' alt='Add (Alt+1)' title='Add (Alt+1)'/&gt; \n  &lt;/span&gt;&lt;/a&gt;\n&lt;/DIV&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "random", "userform"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518607255, "post_id": 48782934, "comment_id": 84573181, "body": "Do you want everything to be random - the number of letters/numbers and their position in the string?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1518611157, "post_id": 48782934, "comment_id": 84575825, "body": "Not to throw a spanner in the works.... ok, it is.  If the <code>Database</code> sheet is completely  empty then your <code>iRow=ws.cells.find....</code> command will throw an error."}, {"owner": {"reputation": 3, "user_id": 9358872, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kGTulV7QHys/AAAAAAAAAAI/AAAAAAAACyw/xb2vQ150BYA/photo.jpg?sz=128", "display_name": "Deryck", "link": "https://stackoverflow.com/users/9358872/deryck"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518661651, "post_id": 48782934, "comment_id": 84601104, "body": "@SJR The idea was that. But I don&#39;t really mind the structure of the letters/numbers as long I can generate code that is random and not a series."}, {"owner": {"reputation": 3, "user_id": 9358872, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kGTulV7QHys/AAAAAAAAAAI/AAAAAAAACyw/xb2vQ150BYA/photo.jpg?sz=128", "display_name": "Deryck", "link": "https://stackoverflow.com/users/9358872/deryck"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1518661850, "post_id": 48782934, "comment_id": 84601143, "body": "@DarrenBartrup-Cook at the moment the data in Textbox1 (Name) will be printed in row A2, as I don&#39;t have code for &#39;No.&#39; and &#39;Date&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9358872, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kGTulV7QHys/AAAAAAAAAAI/AAAAAAAACyw/xb2vQ150BYA/photo.jpg?sz=128", "display_name": "Deryck", "link": "https://stackoverflow.com/users/9358872/deryck"}, "edited": false, "score": 1, "creation_date": 1519017638, "post_id": 48804587, "comment_id": 84723125, "body": "thank you so much @SJR this helps me to generate the code the way that i wanted."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1518689424, "creation_date": 1518689424, "answer_id": 48804587, "question_id": 48782934, "link": "https://stackoverflow.com/questions/48782934/generate-random-code-mixed-number-alphabet/48804587#48804587", "title": "Generate random code - mixed number &amp; alphabet", "body": "<p>This will generate a five character random string of numbers and letters. You could assign to your button and output to your form rather than a message box.</p>\n\n<pre><code>Sub x()\n\nDim vOut(1 To 5), i As Long, n As Long\n\nRandomize\n\nFor i = 1 To 5\n    n = WorksheetFunction.RandBetween(1, 2)\n    If n = 1 Then\n        vOut(i) = WorksheetFunction.RandBetween(0, 9)\n    Else\n        vOut(i) = Chr(64 + WorksheetFunction.RandBetween(1, 26))\n    End If\nNext i\n\nMsgBox Join(vOut, \"\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9358872, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kGTulV7QHys/AAAAAAAAAAI/AAAAAAAACyw/xb2vQ150BYA/photo.jpg?sz=128", "display_name": "Deryck", "link": "https://stackoverflow.com/users/9358872/deryck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 48804587, "answer_count": 1, "score": 0, "last_activity_date": 1550861095, "creation_date": 1518597973, "last_edit_date": 1550861095, "question_id": 48782934, "link": "https://stackoverflow.com/questions/48782934/generate-random-code-mixed-number-alphabet", "title": "Generate random code - mixed number &amp; alphabet", "body": "<p>I want to record user data using a userform.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mFXCR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mFXCR.png\" alt=\"enter image description here\"></a></p>\n\n<p>In first textbox, I will insert user's name. <br>\nSecond textbox is their ID.</p>\n\n<p>In the third textbox I want to generate a 5 character ID/code (mixed number &amp; alphabet) by clicking the 'Generate' button (but I have no idea what is the coding).</p>\n\n<p>Once I click 'Add user', I would like the data to be populated in the Excel sheet. I would like to insert number 1, 2, 3... in Column A, today's date (when the user details added) in Column B. Followed by the data added in the Userform in Column C, D &amp; E.</p>\n\n<p>Here is what I want the data to look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w5LnH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w5LnH.png\" alt=\"data example\"></a></p>\n\n<p>Here is code I copied from the site.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim iRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Database\")\n\n'find first empty row in database\niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\n'check for a Name number\nIf Trim(Me.TextBox1.Value) = \"\" Then\n    Me.TextBox1.SetFocus\n    MsgBox \"Please complete the form\"\n    Exit Sub\nEnd If\n\n'copy the data to the database\nws.Cells(iRow, 1).Value = Me.TextBox1.Value\nws.Cells(iRow, 2).Value = Me.TextBox2.Value\nws.Cells(iRow, 3).Value = Me.TextBox3.Value\n\nMsgBox \"Data added\", vbOKOnly + vbInformation, \"Data Added\"\n\n'clear the data\nMe.TextBox1.Value = \"\"\nMe.TextBox2.Value = \"\"\nMe.TextBox3.Value = \"\"\nMe.TextBox1.SetFocus\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1518598906, "creation_date": 1518598906, "answer_id": 48783187, "question_id": 48782570, "link": "https://stackoverflow.com/questions/48782570/filter-values-at-listbox-from-textbox/48783187#48783187", "title": "Filter values at ListBox from TextBox", "body": "<p>I guess that you want values that are partially matching. What you do is filter based on exact match. So, I think that could work for you:</p>\n\n<pre><code>If Not .List(i, X) Like \"*\" &amp; TextBox2.Value &amp; \"*\" Then .RemoveItem (i)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If Not TextBox2.Value Like \"*\" &amp; .List(i, X) &amp; \"*\" Then .RemoveItem (i)\n</code></pre>\n\n<p>Since you provided very little details, it's only a guess.</p>\n\n<p>Also, if that doesn't do the job, I still think that <code>Like</code> operator could solve your problem and you should consider using it -> <a href=\"https://docs.microsoft.com/pl-pl/dotnet/visual-basic/language-reference/operators/like-operator\" rel=\"nofollow noreferrer\">Reference article</a> :)</p>\n"}], "owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 820, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518598906, "creation_date": 1518596487, "last_edit_date": 1531164843, "question_id": 48782570, "link": "https://stackoverflow.com/questions/48782570/filter-values-at-listbox-from-textbox", "title": "Filter values at ListBox from TextBox", "body": "<p>I have one problem that I think is easy to solve but for someone reason I didn't find it. I find lot of examples at web but for some reason didn't work (show the values only one column...) </p>\n\n<p>I have a Userform with a Multiplage with two pages and I want to show at Listbox2 on the second page the values match value TextBox2 with Column B at the Sheet.</p>\n\n<p>I want that when you navigate trough records at page 1 If you select page 2 show at Listbox2 the 6 columns from sheet (C:H) but only for these who TextBox2 value match with Column B at the sheet.</p>\n\n<p>This code works if I didn't include the filter lines, but show me all the data stored and If I include the filter line at codes it show me anything. </p>\n\n<pre><code>Private Sub MultiPage1_Change()\nIf Me.MultiPage1.Value = 1 Then ' If you select second page show at listBox2 the values match with TextBox2\n      rng = Sheets(\"Page1\").Cells(2, 1).CurrentRegion.Offset(1).Resize(, 8).Value\n   With ListBox2\n    .List = rng\n    .ColumnCount = UBound(rng, 2)\n    For i = .ListCount - 1 To 0 Step -1 ' If I delete code form hereListbox2 show all the values, if maintain it show me anything\n     If .List(i, X) &lt;&gt; TextBox2.Value Then .RemoveItem (i)\n    Next\n  End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I hope you have any suggestion, it will be very appreciated :) </p>\n"}, {"tags": ["vba", "excel", "winapi", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518640249, "post_id": 48794143, "comment_id": 84593767, "body": "Thanks! The UserForm was created and shown successfully, but after I select an item in ListBox, everything freezes. I guess, this is something with variables types. For instance, in your <code>UserForm1_WinProc</code> procedure you use <code>LongPtr</code> type for <code>wParam</code>, but in declaration of <code>CallWindowProc</code> you use <code>Long</code>. From documentation, I couldn&#39;t figure out whether it is a pointer or integer value. Second, you use <code>SetWindowLong</code> for 32 and 64 bit of Windows (as denoted by <code>Alias</code>), but I guess you meant <code>SetWindowLongPtrW</code> for Win64. I will dig further :)"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518640651, "post_id": 48794143, "comment_id": 84593997, "body": "your&#39;re right the signature in not correct for a 64bit usage. Nothing freezes when i run it with Excel 32bits. Is your office 64bits?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518672705, "post_id": 48794143, "comment_id": 84603668, "body": "Yes, I use Excel 2010 64-bit. I will test today this code in Excel 2007 (Windows XP). I guess, I did something wrong with types :("}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518693418, "post_id": 48794143, "comment_id": 84614538, "body": "In Excel 2007 all works fine! And what about hooks? Can the same be achieved with hooks? :)"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518704905, "post_id": 48794143, "comment_id": 84622381, "body": "Yes, though it&#39;s not going to be as simple and you&#39;ll still end-up with this same <code>WndProc</code> procedure as this example."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518706257, "post_id": 48794143, "comment_id": 84623305, "body": "OK! Thanks for your help!"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1518706366, "post_id": 48794143, "comment_id": 84623378, "body": "I just noticed that <code>lpPrevWndFunc</code> from <code>CallWindowProc</code> also needs to be a <code>LongPtr</code>"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1518706494, "post_id": 48794143, "comment_id": 84623474, "body": "and <code>dwNewLong</code> with <code>SetWindowLongPtr</code>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1518706561, "post_id": 48794143, "comment_id": 84623535, "body": "Good) I am about to transfer code to 64-bit Excel. Hope everything&#39;s gonna work OK :)"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1518706582, "last_edit_date": 1518706582, "creation_date": 1518633781, "answer_id": 48794143, "question_id": 48782255, "link": "https://stackoverflow.com/questions/48782255/listen-to-windows-messages-in-control-created-with-winapi-in-vba/48794143#48794143", "title": "Listen to Windows messages in control, created with WinAPI, in VBA", "body": "<p>To listen to the messages, override the function that processes messages sent to a window, which is in this case <code>hClient</code>.</p>\n\n<p>To listen to a change of selection in <code>UserForm1</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate hWin As LongPtr\nPrivate hClient As LongPtr\nPrivate hList As LongPtr    \n\nPrivate Sub UserForm_Initialize()\n\n    ' get the top window handle '\n    hWin = FindWindowEx(0, 0, StrPtr(\"ThunderDFrame\"), StrPtr(Me.Caption))\n    If hWin Then Else Err.Raise 5, , \"Top window not found\"\n\n    ' get first child / client window '\n    hClient = FindWindowEx(hWin, 0, 0, 0)\n    If hClient Then Else Err.Raise 5, , \"Client window not found\"\n\n    ' create the list box '\n    hList = CreateWindowEx( _\n        dwExStyle:=WS_EX_CLIENTEDGE, _\n        lpClassName:=StrPtr(\"LISTBOX\"), _\n        lpWindowName:=0, _\n        dwStyle:=WS_CHILD Or WS_VISIBLE Or WS_VSCROLL Or WS_SIZEBOX Or LBS_NOTIFY Or LBS_HASSTRINGS, _\n        x:=10, _\n        y:=10, _\n        nWidth:=100, _\n        nHeight:=100, _\n        hwndParent:=hClient, _\n        hMenu:=0, _\n        hInstance:=0, _\n        lpParam:=0)\n\n    ' add some values '\n    SendMessage hList, LB_ADDSTRING, 0, StrPtr(\"item a\")\n    SendMessage hList, LB_ADDSTRING, 0, StrPtr(\"item b\")\n    SendMessage hList, LB_ADDSTRING, 0, StrPtr(\"item c\")\n\n    ' intercept messages '\n    UserForm1_Register Me, hClient\nEnd Sub\n\nPublic Sub WndProc(ByVal hwnd As LongPtr, ByVal uMsg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr)\n    Select Case uMsg\n        Case WM_COMMAND\n            Select Case (wParam \\ 65536) And 65535 ' HIWORD '\n                Case LBN_SELCHANGE\n                    Debug.Print \"Selection changed\"\n\n            End Select\n    End Select\nEnd Sub\n</code></pre>\n\n<p>and in a module:</p>\n\n<pre><code>Option Explicit\n\nPublic Declare PtrSafe Function FindWindowEx Lib \"user32.dll\" Alias \"FindWindowExW\" ( _\n    ByVal hwndParent As LongPtr, _\n    ByVal hwndChildAfter As LongPtr, _\n    ByVal lpszClass As LongPtr, _\n    ByVal lpszWindow As LongPtr) As LongPtr\n\nPublic Declare PtrSafe Function CreateWindowEx Lib \"user32.dll\" Alias \"CreateWindowExW\" ( _\n    ByVal dwExStyle As Long, _\n    ByVal lpClassName As LongPtr, _\n    ByVal lpWindowName As LongPtr, _\n    ByVal dwStyle As Long, _\n    ByVal x As Long, _\n    ByVal y As Long, _\n    ByVal nWidth As Long, _\n    ByVal nHeight As Long, _\n    ByVal hwndParent As LongPtr, _\n    ByVal hMenu As LongPtr, _\n    ByVal hInstance As LongPtr, _\n    ByVal lpParam As LongPtr) As LongPtr\n\nPublic Declare PtrSafe Function SendMessage Lib \"user32.dll\" Alias \"SendMessageW\" ( _\n    ByVal hwnd As LongPtr, _\n    ByVal wMsg As Long, _\n    ByVal wParam As LongPtr, _\n    ByVal lParam As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function CallWindowProc Lib \"user32.dll\" Alias \"CallWindowProcW\" ( _\n    ByVal lpPrevWndFunc As LongPtr, _\n    ByVal hwnd As LongPtr, _\n    ByVal Msg As Long, _\n    ByVal wParam As LongPtr, _\n    ByVal lParam As LongPtr) As LongPtr\n\n#If Win64 Then\n    Private Declare PtrSafe Function SetWindowLong Lib \"user32.dll\" Alias \"SetWindowLongPtrW\" ( _\n      ByVal hwnd As LongPtr, _\n      ByVal nIndex As Long, _\n      ByVal dwNewLong As LongPtr) As Long\n#Else\n    Private Declare PtrSafe Function SetWindowLong Lib \"user32.dll\" Alias \"SetWindowLongW\" ( _\n      ByVal hwnd As LongPtr, _\n      ByVal nIndex As Long, _\n      ByVal dwNewLong As LongPtr) As Long\n#End If\n\nPublic Const WS_EX_CLIENTEDGE = &amp;H200&amp;\nPublic Const WS_CHILD = &amp;H40000000\nPublic Const WS_VISIBLE = &amp;H10000000\nPublic Const WS_VSCROLL = &amp;H200000\nPublic Const WS_SIZEBOX = &amp;H40000\nPublic Const LBS_NOTIFY = &amp;H1&amp;\nPublic Const LBS_HASSTRINGS = &amp;H40&amp;\nPublic Const LB_ADDSTRING = &amp;H180&amp;\nPublic Const GW_CHILD = &amp;O5&amp;\nPublic Const GWL_WNDPROC As Long = -4\nPublic Const WM_COMMAND = &amp;H111&amp;\nPublic Const LBN_SELCHANGE = 1\n\nPrivate UserForm1_Form As UserForm1\nPrivate UserForm1_Func As LongPtr\n\nPublic Sub UserForm1_Register(form As UserForm1, ByVal hwnd As LongPtr)\n    Set UserForm1_Form = form\n    UserForm1_Func = SetWindowLong(hwnd, GWL_WNDPROC, AddressOf UserForm1_WinProc)\n    If UserForm1_Func = 0 Then Err.Raise 1, , \"Failed to register\"\nEnd Sub\n\nPrivate Function UserForm1_WinProc(ByVal hwnd As LongPtr, ByVal uMsg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n   UserForm1_Form.WndProc hwnd, uMsg, wParam, lParam\n   UserForm1_WinProc = CallWindowProc(UserForm1_Func, hwnd, uMsg, wParam, lParam)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 2, "accepted_answer_id": 48794143, "answer_count": 1, "score": 4, "last_activity_date": 1518706582, "creation_date": 1518595170, "last_edit_date": 1531164843, "question_id": 48782255, "link": "https://stackoverflow.com/questions/48782255/listen-to-windows-messages-in-control-created-with-winapi-in-vba", "title": "Listen to Windows messages in control, created with WinAPI, in VBA", "body": "<p>I had a great <a href=\"https://stackoverflow.com/questions/48721871/listbox-created-with-winapi-in-vba-doesnt-work\">help</a> with understanding how to correctly create controls (particularly, ListBox) in VBA with WinAPI.\nSo, according to the structure, how VBA handles windows, we have three handles:</p>\n\n<ol>\n<li><code>hWin</code> - UserForm's handle</li>\n<li><code>hClient</code> - UserForm child's handle (<em>Server</em>)</li>\n<li><code>hList</code> - ListBox's handle</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/T5pm7.png\" alt=\"WindowsStructure\"></p>\n\n<p>The question is - how to listen to Windows messages, incoming from Windows and generated by ListBox?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1518593900, "post_id": 48781874, "comment_id": 84565109, "body": "Are you sure you want to use the <code>Int</code> function? It performs integer-truncation."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1518594133, "post_id": 48781874, "comment_id": 84565222, "body": "<code>572662307</code> is one-quarter towards the max value of a 32-bit signed integer (2 billion). In VBA <code>Long</code> is a 32-bit integer and is not a 64-bit integer as in C#. I recommend changing <code>x</code> to <code>Double</code>."}, {"owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1518594141, "post_id": 48781874, "comment_id": 84565225, "body": "@Dai what is the substitute for this int? yes it is necessary cause i need only the integer part of the number after mod"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518595709, "post_id": 48781874, "comment_id": 84565947, "body": "maybe <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/longlong-data-type\" rel=\"nofollow noreferrer\">LongLong</a> data type will do"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518596488, "post_id": 48781874, "comment_id": 84566322, "body": "@DisplayName <code>LongLong</code> is not available in 32-bit Office."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1518596987, "post_id": 48781874, "comment_id": 84566557, "body": "@Dai yes, I know, that&#39;s why I posted the link to a page where it explains that. Let&#39;s see if Vincent can exploit it or not."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "edited": false, "score": 0, "creation_date": 1518594335, "post_id": 48782022, "comment_id": 84565316, "body": "but x is also &gt;2billion also for a"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": true, "score": 3, "last_activity_date": 1518602104, "last_edit_date": 1518602104, "creation_date": 1518594204, "answer_id": 48782022, "question_id": 48781874, "link": "https://stackoverflow.com/questions/48781874/run-time-error-6-overflow/48782022#48782022", "title": "Run-time error 6 Overflow", "body": "<p><code>x = 572662307</code>. is one-quarter of the max value of a 32-bit signed integer (~2 billion) so your arithmetic operations will likely hit that indeed.</p>\n\n<p>In VBA <code>Long</code> is a 32-bit signed integer and is not a 64-bit signed integer as in C#. I recommend changing both <code>a</code> and <code>x</code> to <code>Double</code>.</p>\n\n<p>You could also spread-out your function so you can inspect all intermediate steps in your debugger:</p>\n\n<pre><code>Function equation(x As Double) As Double\n\n    Dim a As Double, b As Double, c As Double, d As Double, e As Double, f As Double, g As Double\n\n    a = (x - 2) Mod 8\n    b = a / 6\n    b = Int( b )\n\n    c = (x - 2) / 8\n    d = 2 * Int( c )\n\n    e = b + d\n    f = (x + a - 1)\n    f = f / 2\n\n    g = 4 * b + 5 + 2 * Int( f )\n    equation = Abs( g )\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 48782022, "answer_count": 1, "score": 0, "last_activity_date": 1518624427, "creation_date": 1518593629, "last_edit_date": 1518624427, "question_id": 48781874, "link": "https://stackoverflow.com/questions/48781874/run-time-error-6-overflow", "title": "Run-time error 6 Overflow", "body": "<p>I have encountered this error even though all my data types seems fine.</p>\n\n<blockquote>\n  <p>Run-time error 6 Overflow</p>\n</blockquote>\n\n<p>Here is the function:</p>\n\n<pre><code>Function equation(x As Long) As Long\n\n    Dim a As Long, b As Double\n\n    a = Int(((x - 2) Mod 8) / 6) + 2 * Int((x - 2) / 8)\n    b = (x + a - 1) / 2\n\n    equation = Abs(4 * b + 5 + 2 * Int(b))\n\nEnd Function\n</code></pre>\n\n<p>Error is encountered when <code>x = 572662307</code> it says overflow.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518593041, "post_id": 48781642, "comment_id": 84564693, "body": "find and learn the difference between <code>ActiveWorkbook</code> and <code>ThisWorkbook</code> I guess <code>Wb1</code> and <code>MainBook</code> are the same workbook, because after opening <code>WorkbookA.xlsm</code> this one is the active one, and therefore you paste exactly there where you copied from."}, {"owner": {"reputation": 1, "user_id": 9358639, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Axel K&#246;nig", "link": "https://stackoverflow.com/users/9358639/axel-k%c3%b6nig"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1518593112, "post_id": 48781642, "comment_id": 84564728, "body": "Oh wow, that was the solution. Sometimes I am just blind. Thank you verry much!"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1518593238, "post_id": 48781745, "comment_id": 84564795, "body": "no need to set it <b>first</b> if you use <code>ThisWorkbook</code> instead of <code>ActiveWorkbook</code>, it will also work after setting <code>Wb1</code>"}], "tags": [], "owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "is_accepted": false, "score": 0, "last_activity_date": 1518593509, "last_edit_date": 1518593509, "creation_date": 1518593188, "answer_id": 48781745, "question_id": 48781642, "link": "https://stackoverflow.com/questions/48781642/excel-synchronize-workbooks-with-vba/48781745#48781745", "title": "Excel synchronize workbooks with vba", "body": "<p>You should set the Mainbook (destination) first before the origin (if you're going to use <code>ActiveWorkbook</code>).</p>\n\n<pre><code>'Set MainBook First\n   Set MainBook = ThisWorkbook\n'Open All workbook:\n   Set Wb1 = Workbooks.Open(\"Z:\\Folder\\WorkbookA.xlsm\")\n</code></pre>\n\n<p>Just for clarity, it's just me being OC on this one.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518599470, "post_id": 48782659, "comment_id": 84568009, "body": "Using <code>ActiveWorkbook</code> and <code>ActiveSheet</code> is the same bad practice like using <code>.Select</code> and <code>.Activate</code> and <code>Selection.</code> I highly recommend <b>never</b> to use them unless you really really have to. In 99.9% there is a solution that avoids them. You can never say for 100% sure which workbook is the currently <code>ActiveWorkbook</code> is. I recommend to read about <code>ThisWorkbook</code> which makes your code much more reliable, because in 99.9% this is what you were looking for. Another recommendation: Never use <code>Sheets</code> if you can use <code>Worksheets</code> only use <code>Sheets</code> if you cannot use <code>Worksheets</code> and you know why."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518600827, "post_id": 48782659, "comment_id": 84568973, "body": "@Peh, in this context, <code>Sub Test()</code> is being called by a <code>Worksheet_Activate()</code> event handler hence <code>ActiveSheet</code> is the only way to go and know what sheet are we dealing with. As for the <code>ActiveWorkbook</code> reference, again  it&#39;s been used right after an opening of a new workbook so I&#39;d assume it&#39;s safe using it, but should it be prone to some workbook opening process delay not affecting <code>ThisWorkbook</code> reference (that changes at every workbook opening, too), then we could use this latter. Or we could use <code>With Workbooks.Open(...) .. End With</code>. Finally, what&#39;s the issue with using <code>Sheets</code> here?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518601526, "post_id": 48782659, "comment_id": 84569401, "body": "I know that your code works, but I still recommend not to use <code>ActiveWorkbook</code>. As you see at the OPs question, people (beginners) don&#39;t understand why <code>ActiveWorkbook</code> works in your code but does not if they copy it into their code (e.g after an <code>Workbooks.Open</code>), they just expect something else. I&#39;ve just seen too many people running into issues using <code>ActiveWorkbook</code> where they wouldn&#39;t have run into if they used <code>ThisWorkbook</code> what they actually meant. It&#39;s not about that there is something wrong with your code, but code with <code>ActiveWorkbook</code> is just harder to maintain than <code>ThisWorkbook</code>."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518602894, "post_id": 48782659, "comment_id": 84570276, "body": "@Peh. I see. So <code>ActiveSheet</code> usage is no longer an issue here, right? While even <code>ThisWorkbook</code> isn&#39;t that safe since it always references the Workbook the currently running macro resides in, so that if your &quot;main&quot; macro calls another macro from a different workbook then <code>ThisWorkbook</code> changes to reference this latter. Finally, as for the <code>Sheets</code> we can agree it&#39;s safe here, can&#39;t we? Anyway, I think this is a good discussion"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518605456, "post_id": 48782659, "comment_id": 84572010, "body": "I mean your code actually has no real issues. I just recommended, didn&#39;t mean you are not allowed to use <code>ActiveWorkbook</code> at all. I mean if I write <code>ActiveWorkbook</code> then this assumes that the code runs using the currently active workbook (no matter which one is active, it should work on every workbook that is active). If the success of running the code depends on that you (or your code) selected a <b>specific</b> workbook before using <code>ActiveWorkbook</code> then you did something which I called a bad practice, because then it would be a good idea to reference that specific workbook."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518605660, "post_id": 48782659, "comment_id": 84572158, "body": "Same for <code>Sheets</code> I mean if my code runs well no matter if the sheet called &quot;Projekte&quot; is a sheet or a chart then use <code>Sheets</code> if it only runs well if the sheet called &quot;Projekte&quot; is a worksheet then use <code>Worksheets</code>. In this case if the sheet &quot;Projekte&quot; was a chart the code would fail so I would say <code>Worksheets</code> was the more correct term here even if <code>Sheets</code> worked too <b>in this case</b>. It&#39;s just more precise, the more precise you are the less can go wrong. Hopefully I could explain well what I meant to tell."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1518606705, "post_id": 48782659, "comment_id": 84572807, "body": "@Peh, I see, again. So, while confirming that <code>ActiveSheet</code> was an <i>unavoidable</i> reference here, I think that the <code>Sheets</code>/<code>Worksheets</code> piece of advice is not as general as you&#39;re depicting: I&#39;d say you 1) <i>have</i> to use <code>Worksheets</code> in code where you want to loop through them only and use methods or properties that wouldn&#39;t be allowed in chart sheets. 2 <i>have</i> to use <code>Sheets</code> when you want to loop through chart sheets only. 3) use whatever reference when your code is using hard coded sheets names, since you must know what you&#39;re doing and  a Worksheet and a Chart sheet can&#39;t have the same name"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1518606757, "post_id": 48782659, "comment_id": 84572833, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/165136/discussion-between-p-and-displayname\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518597384, "last_edit_date": 1518597384, "creation_date": 1518596877, "answer_id": 48782659, "question_id": 48781642, "link": "https://stackoverflow.com/questions/48781642/excel-synchronize-workbooks-with-vba/48782659#48782659", "title": "Excel synchronize workbooks with vba", "body": "<p>you have to properly reference your workbook and worksheet objects</p>\n\n<p>if you have to paste the whole content of range (including formatting, comments, ...), then you want to code like follows (explanations in comments):</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim targetSheet As Worksheet\n\n    Set targetSheet = ActiveSheet 'store currently active sheet\n    Workbooks.Open(\"Z:\\Folder\\WorkbookA.xlsm\").Sheets(\"Projekte\").UsedRange.Copy Destination:=targetSheet.Range(\"A1\") ' open the wanted workbook and copy its \"Projekte\" sheet used range to 'targetSheet (i.e.: the sheet in the workbook where it all started) from its cell A1\n    ActiveWorkbook.Close SaveChanges:=False ' close the currently active workbook (i.e. the just opened one)\nEnd Sub\n</code></pre>\n\n<p>if you only need to paste values, then this is the way to go (much faster!):</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim targetSheet As Worksheet\n\n    Set targetSheet = ActiveSheet 'store currently active sheet\n\n    With Workbooks.Open(\"Z:\\Folder\\WorkbookA.xlsm\").Sheets(\"Projekte\").UsedRange ' open the wanted workbook and reference its sheet \"Projekte\" used range\n        targetSheet.Range(\"A1\").Resize(.Rows.Count, .Columns.Count).Value = .Value\n        .Parent.Parent.Close SaveChanges:=False 'close the parent workbook of referenced range (i.e., the newly opened workbook)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1518600185, "creation_date": 1518600185, "answer_id": 48783556, "question_id": 48781642, "link": "https://stackoverflow.com/questions/48781642/excel-synchronize-workbooks-with-vba/48783556#48783556", "title": "Excel synchronize workbooks with vba", "body": "<p>My recommendation is never to use <code>ActiveWorkbook</code>.</p>\n\n<p>In most cases when people use <code>ActiveWorkbook</code> they actually meant to use <code>ThisWorkbook</code>. The difference is:</p>\n\n<ul>\n<li><p><code>ActiveWorkbook</code> is the currently selected one which is \"on top of the screen\" in exact that moment when your code runs. That can be any workbook the user just clicked on while your code runs. So you never can be 100% sure to get the right workbook.</p></li>\n<li><p><code>ThisWorkbook</code> is the actual workbook your code runs at the moment. And this doesn't change ever. So this is a well defined reference and no gamble about which workbook is on top at the moment.</p></li>\n</ul>\n\n<p><strong>About why your approach did not work</strong></p>\n\n<pre><code>Set Wb1 = Workbooks.Open(\"Z:\\Folder\\WorkbookA.xlsm\") 'this line makes WorkbookA the active one\nSet MainBook = Application.ActiveWorkbook 'this makes MainBook = WorkbookA\n</code></pre>\n\n<p>Therefore a simple <code>Set MainBook = Application.ThisWorkbook</code> should work here.</p>\n\n<p><strong>Another recommendation</strong></p>\n\n<p><code>Sheets</code> and <code>Worksheets</code> is not the same. Make sure you never use <code>Sheets</code> when you can use <code>Worksheets</code>.</p>\n\n<ul>\n<li><code>Sheets</code> contains worksheets and charts</li>\n<li><code>Worksheets</code> contain only worksheets</li>\n</ul>\n\n<p>An example <code>Sheets(1).Range(\"A1\")</code> fails if it is a chart.</p>\n"}], "owner": {"reputation": 1, "user_id": 9358639, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Axel K&#246;nig", "link": "https://stackoverflow.com/users/9358639/axel-k%c3%b6nig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1735, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1518600185, "creation_date": 1518592709, "question_id": 48781642, "link": "https://stackoverflow.com/questions/48781642/excel-synchronize-workbooks-with-vba", "title": "Excel synchronize workbooks with vba", "body": "<p>I'd like to ask if you could help me with copying some worksheet data from workbook A into my active workbook (workbook B)</p>\n\n<p>I have the following code in the main workbook to copy the data from workbook A</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Worksheet_Activate()\n\n    test\n\nEnd Sub\n\n\nSub test()\n    Dim Wb1 As Workbook\n    Dim MainBook As Workbook\n\n    'Open All workbooks first:\n    Set Wb1 = Workbooks.Open(\"Z:\\Folder\\WorkbookA.xlsm\")\n'Set MainBook = Workbooks.Open(Application.ActiveWorkbook.FullName)\nSet MainBook = Application.ActiveWorkbook\n\n'Now, copy what you want from wb1:\nWb1.Sheets(\"Projekte\").Cells.Copy\n'Now, paste to Main worksheet:\nMainBook.Worksheets(\"Projekte\").Range(\"A1\").PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\n\n    'Close Wb's:\n    Wb1.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>I know, that it opens worksheet A and that it highlights and copys the data.</p>\n\n<p>The script wont paste it into worksheet B (where the script is executed from)</p>\n\n<p>Anybody know what i did wrong?</p>\n\n<p>Kindest regards, and thanks for any help !</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1518586483, "post_id": 48780099, "comment_id": 84562127, "body": "Instead of <code>PasteSpecial</code> use <code>Formula</code> or <code>FormulaR1C1</code> property and set the link."}, {"owner": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1518588257, "post_id": 48780099, "comment_id": 84562681, "body": "Sir can you give any example."}], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "edited": false, "score": 0, "creation_date": 1518600135, "post_id": 48781917, "comment_id": 84568495, "body": "Thank you so much QHarr. I tried your function but its giving error &quot;Method Range of Object_&#39;worksheet&#39; failed. I think i am missing something. But thanks anyway, the solution posted by L42 works perfect as i needed. I also appreciate your help."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "edited": false, "score": 0, "creation_date": 1518601055, "post_id": 48781917, "comment_id": 84569114, "body": "You would have needed to change  Set ws = wb.Worksheets(&quot;Sheet2&quot;) to your sheet"}, {"owner": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "edited": false, "score": 0, "creation_date": 1518608218, "post_id": 48781917, "comment_id": 84573802, "body": "Yup you are right, i missed that one. Thanks a lot."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1518598252, "last_edit_date": 1518598252, "creation_date": 1518593824, "answer_id": 48781917, "question_id": 48780099, "link": "https://stackoverflow.com/questions/48780099/excel-paste-to-visible-transpose-as-link-combine-function/48781917#48781917", "title": "Excel Paste to visible, Transpose as Link combine function", "body": "<p>You cannot use the in-built Excel <code>pastespecial</code>, <code>transpose</code> and <code>link</code> cells.</p>\n\n<p>Adapting an idea from <a href=\"https://www.extendoffice.com/documents/excel/4210-excel-transpose-and-link.html\" rel=\"nofollow noreferrer\">here</a> you can create a named range and then refer to that.</p>\n\n<p>The named range is called <code>myRange</code> and you select the range <code>\"A2:A6\"</code>, go to the name box, enter the text <code>\"myRange\"</code> and hit enter. You can then select <code>myRange</code> from the <a href=\"http://www.contextures.com/xlNames01.html\" rel=\"nofollow noreferrer\"><code>Name Box</code></a> to verify entered correctly. Or <kbd>Ctrl</kbd> + <kbd>F3</kbd> to open <a href=\"https://support.office.com/en-ie/article/Define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64\" rel=\"nofollow noreferrer\"><code>Name Manager</code></a>.</p>\n\n<p>Function is by <a href=\"https://stackoverflow.com/questions/12796973/function-to-convert-column-number-to-letter\">@BrettDJ</a> that returns column letter from number.</p>\n\n<p>Note you can refactor this into a more general function that accepts an input range and destination cell and does everything else and then call this from a button push sub that prompts for a range selection.</p>\n\n<pre><code> Option Explicit\n\nPublic Sub TransposeDataWithLink()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet2\")\n    Dim numColumns As Long\n    numColumns = ws.Range(\"myRange\").Rows.Count\n\n    Dim startColumn As Long\n    startColumn = 3 'this would be inputted in call\n    Dim startRow As Long\n    startRow = 2 ''this would be inputted in call\n\n    Dim visibleColumns As Long\n    Dim currCell As Range\n    Dim myRangeStartCol As Long\n    Dim myRangeStartRow As Long\n\n    myRangeStartCol = ws.Range(\"myRange\").Column\n    myRangeStartRow = ws.Range(\"myRange\").Row\n\n    Dim columnLetter As String\n\n    columnLetter = Col_Letter(myRangeStartCol)\n\n    Do Until visibleColumns = numColumns\n\n        Set currCell = ws.Cells(startRow, startColumn)\n\n        If currCell.EntireColumn.Hidden = False Then\n\n            visibleColumns = visibleColumns + 1\n\n            Dim myRangeRef As String\n            myRangeRef = \"=\" &amp; columnLetter &amp; CStr(myRangeStartRow + visibleColumns - 1)\n\n            currCell.Formula = myRangeRef\n\n        End If\n\n        startColumn = startColumn + 1\n\n    Loop\n\nEnd Sub\n\n\nPublic Function Col_Letter(ByVal lngCol As Long) As String\n    Dim vArr\n    vArr = Split(ActiveSheet.Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518598314, "post_id": 48782245, "comment_id": 84567248, "body": "I had a go at this. Think I prefer yours!"}, {"owner": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "edited": false, "score": 0, "creation_date": 1518599593, "post_id": 48782245, "comment_id": 84568109, "body": "Yup.. That works. Thank you soo much L42. I really appreciate your help."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1518600217, "last_edit_date": 1518600217, "creation_date": 1518595126, "answer_id": 48782245, "question_id": 48780099, "link": "https://stackoverflow.com/questions/48780099/excel-paste-to-visible-transpose-as-link-combine-function/48782245#48782245", "title": "Excel Paste to visible, Transpose as Link combine function", "body": "<p>As stated in comment, here's example of what I posted in the comment.</p>\n\n<pre><code>Sub marine()\n\n    'Key board shortcut Ctrl + Shift + C\n\n    Dim cr As Range, dr As Range, c As Range\n    Dim xTitleId As String\n    Dim i As Integer\n\n    xTitleId = \"Paste to Visible\"\n    If TypeOf Selection Is Range Then Set cr = Selection\n\n    On Error Resume Next\n    Set dr = Application.InputBox(\"Destination Range: \", xTitleId, , , , , , 8)\n    On Error GoTo 0\n\n    If Not dr Is Nothing _\n    And Not cr Is Nothing Then\n        Set dr = dr.Resize(1, 1)\n        i = 0\n        For Each c In cr\n            Do While dr.Offset(, i).EntireColumn.Hidden\n                i = i + 1\n            Loop\n            dr.Offset(, i).Formula = \"=\" &amp; c.Address(, , , True)\n            i = i + 1\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I assigned it in <kbd>Ctrl+Shift+C</kbd> shortcut.<br>\nIt will copy the current selection and then prompt you to enter destination cell.<br>\nJust select destination cell (single cell would do) and it will paste the link.<br>\nNot yet optimized but I hope this gives you an idea.</p>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "is_accepted": false, "score": 0, "last_activity_date": 1518600350, "creation_date": 1518600350, "answer_id": 48783610, "question_id": 48780099, "link": "https://stackoverflow.com/questions/48780099/excel-paste-to-visible-transpose-as-link-combine-function/48783610#48783610", "title": "Excel Paste to visible, Transpose as Link combine function", "body": "<p>So, as by L42. i found the solution to my problem.</p>\n\n<pre><code>Sub marine()\n\n'Key board shortcut Ctrl + Shift + C\n\nDim cr As Range, dr As Range, c As Range\nDim xTitleId As String\nDim i As Integer\n\nxTitleId = \"Paste to Visible\"\nIf TypeOf Selection Is Range Then Set cr = Selection\n\nOn Error Resume Next\nSet dr = Application.InputBox(\"Destination Range: \", xTitleId, , , , , , 8)\nOn Error GoTo 0\n\nIf Not dr Is Nothing Then\n    Set dr = dr.Resize(1, 1)\n    i = 0\n    For Each c In cr\n        Do While dr.Offset(, i).EntireColumn.Hidden\n            i = i + 1\n        Loop\n        dr.Offset(, i).Formula = \"=\" &amp; c.Address(, , , True)\n        i = i + 1\n    Next\nEnd If                                                                    \nEnd Sub\n</code></pre>\n\n<p>This works perfectly.</p>\n"}], "owner": {"reputation": 124, "user_id": 6917074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RPPqM.jpg?s=128&g=1", "display_name": "Muhammad Owais", "link": "https://stackoverflow.com/users/6917074/muhammad-owais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 48782245, "answer_count": 3, "score": 3, "last_activity_date": 1529926627, "creation_date": 1518585252, "last_edit_date": 1529926627, "question_id": 48780099, "link": "https://stackoverflow.com/questions/48780099/excel-paste-to-visible-transpose-as-link-combine-function", "title": "Excel Paste to visible, Transpose as Link combine function", "body": "<p>Hope you all are doing good. I am working on a workbook in which i have a column of 10 consecutive cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1aBH3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1aBH3.png\" alt=\"Data to be Copy\"></a></p>\n\n<p>On another sheet there is a row where i want to paste that data as transposed but the problem is, some cells in that rows are not consecutive some of them are hidden. like in image: \n<a href=\"https://i.stack.imgur.com/zjPi5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zjPi5.png\" alt=\"Data to be pasted\"></a></p>\n\n<p>Now i want to paste Data to visible cells only as Transpose and those cells must be paste as a link as if any changes made to first sheet, the relative cell in second sheet should also be change. Luckily i have done much working by my self as i found how to paste to visible cells only by following VBA code: </p>\n\n<pre><code>Sub PasteToVisible()\n'Declarations\nDim Range1            As Range\nDim Range2            As Range\nDim InputRange      As Range\nDim OutputRange     As Range\n\n'Prompt Box Title\nxTitleId = \"Paste to Visible\"\n'Start Input Range\nSet InputRange = Application.Selection\n'Select input range box\nSet InputRange = Application.InputBox(\"Copy Range :\", xTitleId, InputRange.Address, Type:=8)\n'Select output range box\nSet OutputRange = Application.InputBox(\"Paste Range:\", xTitleId, Type:=8)\n'Loop to paste the range in visible cells\nFor Each Range1 In InputRange\n    Range1.Copy\n    For Each Range2 In OutputRange\n        If Range2.EntireRow.RowHeight &gt; 0 Then\n            Range2.PasteSpecial\n            Set OutputRange = Range2.Offset(1).Resize(OutputRange.Rows.Count)\n            Exit For\n        End If\n    Next\nNext\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>End Sub'</p>\n\n<p>This can Paste values to visible cells but in columns only (Not Transpose). For Transpose and Link, I am using a simple excel formula of Transpose as in Image below: <a href=\"https://i.stack.imgur.com/OK8lg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OK8lg.png\" alt=\"enter image description here\"></a></p>\n\n<p>This can link the values in Transposed form. I want to combine all three functions (Paste to visible, Transpose and As a link) in one Step. Please Help me on this. I will really appreciate any suggestion and Help. Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1518583959, "creation_date": 1518583959, "answer_id": 48779893, "question_id": 48779729, "link": "https://stackoverflow.com/questions/48779729/formula-should-shift-one-column-in-the-formula/48779893#48779893", "title": "Formula should shift one column in the formula", "body": "<p>Your narrative states <em>'each time I click the VBA, it shifts one column in the formula'</em> but the example result formula is one row shift.</p>\n\n<p>For one column shift try,</p>\n\n<pre><code>sub shiftRight()\n    dim f as string\n    f = mid(activecell.formula, 2)\n    activecell.formula = chr(61) &amp; range(split(f, chr(45))(0)).offset(0, 1).address(external:=true) &amp; chr(45) &amp; split(f, chr(45))(1)\nend sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9358182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a0f7703f8ada5ba9ac7783c603710?s=128&d=identicon&r=PG&f=1", "display_name": "Anson Tang", "link": "https://stackoverflow.com/users/9358182/anson-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518584879, "creation_date": 1518582842, "last_edit_date": 1531161705, "question_id": 48779729, "link": "https://stackoverflow.com/questions/48779729/formula-should-shift-one-column-in-the-formula", "title": "Formula should shift one column in the formula", "body": "<p>The formula in Excel is this,</p>\n\n<pre><code>=FUT_CHAIN!$D$9-LME!$F$2\n</code></pre>\n\n<p>Each time I click the VBA, it should shift one column in the formula but only limited to the first component, which means that the formula would be,</p>\n\n<pre><code>=FUT_CHAIN!$D$10-LME!$F$2\n</code></pre>\n\n<p>The $ inside the formula and the second component can not be changed or eliminated.</p>\n"}, {"tags": ["html", "excel", "vba", "xmlhttprequest"], "comments": [{"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "edited": false, "score": 0, "creation_date": 1518581639, "post_id": 48779449, "comment_id": 84560722, "body": "Can you please elaborate? What exactly you want to extract from the webpage.? which fields you want to extract?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518581731, "post_id": 48779449, "comment_id": 84560739, "body": "<code>Debug.Print doc.getElementsByClassName(&quot;sidebar-content&quot;)(0).toString</code> (<i>getElementsByClassName</i> is plural; i.e. a collection)"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518590751, "post_id": 48781119, "comment_id": 84563698, "body": "I guess my worry, through lack of experience, is how robust this method is?  Would you determine the appropriateness of this on the basis of how &quot;stable&quot; the webpage layout is i.e. on your impression of its consistency in layout/format over time? Any references I could read on how to decide which method to use when scraping? Btw I upvoted as useful but am intrigued."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 2, "last_activity_date": 1518590408, "creation_date": 1518590408, "answer_id": 48781119, "question_id": 48779449, "link": "https://stackoverflow.com/questions/48779449/what-is-the-best-way-to-retrieve-specific-elements-from-an-html-page-in-vba/48781119#48781119", "title": "What is the best way to retrieve specific elements from an HTML page in VBA?", "body": "<p>Such simple parsing could be done using <code>Split()</code> instead of <code>HTMLDocument</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n\n    MsgBox Join(GetData(\"google.com\"), vbCrLf)\n\nEnd Sub\n\nFunction GetData(sUrl)\n\n    Dim tmp\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://fortiguard.com/webfilter?q=\" &amp; sUrl, False, \"u051772\", \"fy17janr\"\n        .Send\n        tmp = .ResponseText\n    End With\n    tmp = Split(tmp, \"WF Rating History\", 2)(1)\n    tmp = Split(tmp, \"&lt;em&gt;\", 2)(1)\n    tmp = Split(tmp, \"&lt;/strong&gt;\", 2)(0)\n    tmp = Split(tmp, \"&lt;/em&gt;\", 2)\n    tmp(1) = Split(tmp(1), \"&lt;strong&gt;\", 2)(1)\n    GetData = tmp\n\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SLIAv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SLIAv.png\" alt=\"output\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1518594898, "creation_date": 1518594898, "answer_id": 48782196, "question_id": 48779449, "link": "https://stackoverflow.com/questions/48779449/what-is-the-best-way-to-retrieve-specific-elements-from-an-html-page-in-vba/48782196#48782196", "title": "What is the best way to retrieve specific elements from an HTML page in VBA?", "body": "<p>How about giving this a try:</p>\n\n<pre><code>Sub Fetch_Data()\n    Dim http As New ServerXMLHTTP60, HTML As New HTMLDocument\n    Dim post As Object\n\n    With http\n        .Open \"GET\", \"https://fortiguard.com/webfilter?q=google.com\", False\n        .send\n        HTML.body.innerHTML = .responseText\n    End With\n\n    For Each post In HTML.getElementsByClassName(\"sidebar-content\")\n        With post.getElementsByTagName(\"em\")\n            If .Length Then Row = Row + 1: Cells(Row, 1) = .Item(0).innerText\n        End With\n        With post.getElementsByTagName(\"strong\")\n            If .Length Then Cells(Row, 2) = .Item(0).innerText\n        End With\n    Next post\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Jun 10th, 2008 @ 17:45:24 PDT\nSearch Engines and Portals\n</code></pre>\n\n<p>Reference to add to the library:</p>\n\n<pre><code>1.Microsoft Html Object Library\n2.Microsoft XML, V6.0  \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9357996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b040db118560af00ece903850743df8?s=128&d=identicon&r=PG", "display_name": "k d", "link": "https://stackoverflow.com/users/9357996/k-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 48781119, "answer_count": 2, "score": 1, "last_activity_date": 1518608734, "creation_date": 1518580823, "last_edit_date": 1518608734, "question_id": 48779449, "link": "https://stackoverflow.com/questions/48779449/what-is-the-best-way-to-retrieve-specific-elements-from-an-html-page-in-vba", "title": "What is the best way to retrieve specific elements from an HTML page in VBA?", "body": "<p>I have an Excel sheet with some URLs and I'm trying to write a macro that populates categories of websites using Fortigate's web filter. So for example, a cell on the sheet might contain \"www.google.com\" and the site categorizes it as \"Search Engines and Portals\" at the URL <a href=\"https://fortiguard.com/webfilter?q=google.com\" rel=\"nofollow noreferrer\">https://fortiguard.com/webfilter?q=google.com</a>. </p>\n\n<p>I'm having a hard time trying to parse the HTML to get the category. The HTML looks like:</p>\n\n<pre><code>&lt;DIV class=sidebar-content&gt;\n&lt;H4&gt;WF Rating History&lt;/H4&gt;\n&lt;P&gt;&lt;SPAN style=\"FONT-SIZE: 10px\"&gt;&lt;EM&gt;Jun 10th, 2008 @ 17:45:24 PDT&lt;/EM&gt;&lt;/SPAN&gt;&lt;BR&gt;added as &lt;STRONG&gt;Search Engines and Portals&lt;/STRONG&gt;&lt;/P&gt;\n&lt;DIV&gt;&lt;A href=\"about://forticlient.com/\" target=_blank&gt;&lt;IMG src=\"about:/static/images/forticlient_share_button.png?v=5\"&gt;&lt;/A&gt; &lt;/DIV&gt;&lt;/DIV&gt;\n</code></pre>\n\n<p>and the code I used to get that is below (I'm just trying with one site and have made the assumption that it is located on A1 on the sheet): </p>\n\n<pre><code>    Sub siteCatgories()\n\n    Dim xhr As MSXML2.XMLHTTP60\n    Dim doc As MSHTML.HTMLDocument\n\n    Set xhr = New MSXML2.XMLHTTP60\n\n    Url = Cells(1, 1).Value\n\n    With xhr\n    .Open \"GET\", \"https://fortiguard.com/webfilter?q=\" &amp; Url, False\n    .send\n\n    If .readyState = 4 And .Status = 200 Then\n        Set doc = New MSHTML.HTMLDocument\n        doc.body.innerHTML = .responseText\n    End If\n    End With\n\n    'retrieve relevant HTML\n    Debug.Print doc.getElementsByClassName(\"sidebar-content\").toString\n\n    End Sub\n</code></pre>\n\n<p>The above debug statement only returns [Object]. \nAny help on how to parse the site's HTML in VBA would be greatly appreciated!</p>\n"}, {"tags": ["vba", "ms-access", "dropdown"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1518614216, "creation_date": 1518614216, "answer_id": 48788183, "question_id": 48779225, "link": "https://stackoverflow.com/questions/48779225/use-vba-to-add-multiple-fields-to-one-record-while-also-adding-a-category-to-eac/48788183#48788183", "title": "Use VBA to add multiple fields to one record while also adding a category to each field", "body": "<p>You can prompt the user for the code if a new species is entered, or the species if a new code is entered:</p>\n\n<pre><code>Private Sub Code_NotInList(NewData As String, Response As Integer)\nDim strTmp As String\n\n    'Get confirmation that this is not just a spelling error.\n    strTmp = \"Add '\" &amp; NewData &amp; \"' as a new category?\"\n    If MsgBox(strTmp, vbYesNo + vbDefaultButton2 + vbQuestion, \"Not in list\") = vbYes Then\n        Dim strInput As String\n        strInput = InputBox(\"What's the species?\")\n        'Append the NewData as a record in the Categories table.\n        strTmp = \"INSERT INTO MasterVegList ( Code, Species ) \" &amp; _\n            \"VALUES(\"\"\" &amp; NewData  &amp; \"\"\", \"\"\" &amp; strInput  &amp; \"\"\");\"\n        CurrentDb.Execute strTmp, dbFailOnError\n\n        'Notify Access about the new record, so it requeries the combo.\n        Response = acDataErrAdded\n        Me.Species.Requery\n    End If\nEnd Sub\n\nPrivate Sub Species_NotInList(NewData As String, Response As Integer)\nDim strTmp As String\n\n    'Get confirmation that this is not just a spelling error.\n    strTmp = \"Add '\" &amp; NewData &amp; \"' as a new category?\"\n    If MsgBox(strTmp, vbYesNo + vbDefaultButton2 + vbQuestion, \"Not in list\") = vbYes Then\n        Dim strInput As String\n        strInput = InputBox(\"What's the code?\")\n        'Append the NewData as a record in the Categories table.\n        strTmp = \"INSERT INTO MasterVegList ( Code, Species ) \" &amp; _\n            \"VALUES(\"\"\" &amp; strInput  &amp; \"\"\", \"\"\" &amp; NewData  &amp; \"\"\");\"\n        CurrentDb.Execute strTmp, dbFailOnError\n\n        'Notify Access about the new record, so it requeries the combo.\n        Response = acDataErrAdded\n        Me.Code.Requery\n    End If\nEnd Sub\n</code></pre>\n\n<p>You probably want to check that the user actually enters a valid input, but I'm leaving that as an exercise for the reader.</p>\n\n<p>I've also changed the following things: use <code>INSERT INTO ... VALUES ...</code> instead of <code>INSERT INTO ... SELECT</code>, and use <code>CurrentDb</code> instead of <code>DbEngine(0)(0)</code></p>\n\n<p>Also, you might want to parameterize those queries, so people are able to enter quotes in the fields.</p>\n"}], "owner": {"reputation": 13, "user_id": 4072470, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-lGYDpahJnwc/AAAAAAAAAAI/AAAAAAAABns/KvFcyWB7C4Q/photo.jpg?sz=128", "display_name": "Brian Leo", "link": "https://stackoverflow.com/users/4072470/brian-leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 48788183, "answer_count": 1, "score": 0, "last_activity_date": 1518614216, "creation_date": 1518579343, "last_edit_date": 1518613590, "question_id": 48779225, "link": "https://stackoverflow.com/questions/48779225/use-vba-to-add-multiple-fields-to-one-record-while-also-adding-a-category-to-eac", "title": "Use VBA to add multiple fields to one record while also adding a category to each field", "body": "<p>I could not find the answer to this question elsewhere.  I am a new VBA user.</p>\n\n<p>I have a very simple form for entering data on plant specimens.  There are only 3 fields that have drop down boxes.  Two fields, \"Species\" and \"Code\" reference information from another table called \"MasterVegList\" to facilitate field data entry.</p>\n\n<p>In order to allow the end user to add new species into to the form and the \"MasterVegList\" table, I wrote the following VBA code:</p>\n\n<pre><code>Private Sub Code_NotInList(NewData As String, Response As Integer)\nDim strTmp As String\n\n    'Get confirmation that this is not just a spelling error.\n    strTmp = \"Add '\" &amp; NewData &amp; \"' as a new category?\"\n    If MsgBox(strTmp, vbYesNo + vbDefaultButton2 + vbQuestion, \"Not in list\") = vbYes Then\n\n        'Append the NewData as a record in the Categories table.\n        strTmp = \"INSERT INTO MasterVegList ( Code ) \" &amp; _\n            \"SELECT \"\"\" &amp; NewData &amp; \"\"\" AS Code;\"\n        DBEngine(0)(0).Execute strTmp, dbFailOnError\n\n        'Notify Access about the new record, so it requeries the combo.\n        Response = acDataErrAdded\n    End If\nEnd Sub\n\nPrivate Sub Species_NotInList(NewData As String, Response As Integer)\nDim strTmp As String\n\n    'Get confirmation that this is not just a spelling error.\n    strTmp = \"Add '\" &amp; NewData &amp; \"' as a new category?\"\n    If MsgBox(strTmp, vbYesNo + vbDefaultButton2 + vbQuestion, \"Not in list\") = vbYes Then\n\n        'Append the NewData as a record in the Categories table.\n        strTmp = \"INSERT INTO MasterVegList ( Species ) \" &amp; _\n            \"SELECT \"\"\" &amp; NewData &amp; \"\"\" AS Species;\"\n        DBEngine(0)(0).Execute strTmp, dbFailOnError\n\n        'Notify Access about the new record, so it requeries the combo.\n        Response = acDataErrAdded\n    End If\nEnd Sub\n</code></pre>\n\n<p>The problem is that when a new species is entered, a new record is created for both species and code in the MasterVegList table.  I need both species and code to be entered into the same record.  Please note that I am referring to the MasterVegList table, not the table meant to be populated using the form.</p>\n"}, {"tags": ["vba", "xslt", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1518596641, "post_id": 48779126, "comment_id": 84566399, "body": "I get the feeling that the transform result may not be valid Word Open XML. If you create an XML string that uses exactly the structure you specify in the xslt (especially the namespaces) can that be inserted using InsertXML or does it result in the same error? Referring to the article to which you link, take a close look at <i>Simplified Office Open Markup&quot;: you&#39;re missing the outer structures such as &lt;pkg:package&gt;, &lt;pkg:part&gt; and so on. Word *requires</i> these for inserting Open XML."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1518602732, "post_id": 48779126, "comment_id": 84570180, "body": "Hi @CindyMeister - yes, if I exclude the Transform and just use the (erm) finalized XML then it will work. Re the missing bit... ugh - thanks &lt;mutter&gt;&lt;mutter&gt; - I&#39;ll take a closer look  :)   Many thanks"}], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": true, "score": 1, "last_activity_date": 1527049054, "last_edit_date": 1592644375, "creation_date": 1527049054, "answer_id": 50479710, "question_id": 48779126, "link": "https://stackoverflow.com/questions/48779126/range-insertxml-using-transform/50479710#50479710", "title": "Range.InsertXML using Transform", "body": "<h1>Working solution:</h1>\n<p>The original source for the xml appears to be from this <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/ee872374(v=office.12)\" rel=\"nofollow noreferrer\">docs.microsoft.com</a> site. Incidentally, there are also some instructions on how to create an XSLT directly from a MS Word document (well, albeit manually).</p>\n<p>At any rate, it's easiest to just to the transform and insert as two separate steps, like this:</p>\n<pre><code>Sub xmlTest()\n    Dim xData As MSXML2.DOMDocument60\n    Dim xTnsf As MSXML2.DOMDocument60\n    Dim xOutp As MSXML2.DOMDocument60\n\n    Set xData = New MSXML2.DOMDocument60\n    Set xTnsf = New MSXML2.DOMDocument60\n    Set xOutp = New MSXML2.DOMDocument60\n\n    xData.Load &quot;C:\\Temp\\MyMovies.xml&quot;\n    xTnsf.Load &quot;C:\\Temp\\MyMovies.xslt&quot;\n\n    xData.transformNodeToObject xTnsf, xOutp\n    \n    ThisDocument.Range.InsertXML xOutp.XML\n\n    Debug.Print xOutp.XML\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "accepted_answer_id": 50479710, "answer_count": 1, "score": 2, "last_activity_date": 1527049054, "creation_date": 1518578561, "question_id": 48779126, "link": "https://stackoverflow.com/questions/48779126/range-insertxml-using-transform", "title": "Range.InsertXML using Transform", "body": "<p>I am using <code>Range.InsertXML</code> to add formatted content to an existing MS Word document. </p>\n\n<p>AFAICT, the method .InsertXML takes parameters XML as a string and XLST (Transform) as a variant; however <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/range-insertxml-method-word\" rel=\"nofollow noreferrer\">the documentation for .InsertXML</a> is lacking in that it does not provide an example that includes the use of Transform.</p>\n\n<p>In responding to this question: <a href=\"https://stackoverflow.com/q/48285729/3451115\">Range.InsertXML throws when inserting Open XML</a> Cindy Meister linked to <a href=\"https://docs.microsoft.com/en-us/office/dev/add-ins/word/create-better-add-ins-for-word-with-office-open-xml#main\" rel=\"nofollow noreferrer\">an excellent resource</a> that explains lotd about Words XML and how to use it, but I still can't find any examples where Transform is used.</p>\n\n<p><strong>What I am trying to do</strong> is the same as in this question: <a href=\"https://stackoverflow.com/q/32746779/3451115\">XSLT create table with dynamic number of rows and columns</a> (but using VBA).</p>\n\n<p>From that question this is the modified code that I expected to work:</p>\n\n<pre><code>Sub testInsertXML()\n\n    Dim strXML As String\n    Dim XSLT As Variant\n\n    strXML = \"&lt;Movies&gt;&lt;Genre name=\"\"Action\"\"&gt;&lt;Movie&gt;&lt;Name&gt;Crash&lt;/Name&gt;&lt;Released&gt;2005&lt;/Released&gt;&lt;/Movie&gt;&lt;/Genre&gt;&lt;Genre name=\"\"Drama\"\"&gt;&lt;Movie&gt;&lt;Name&gt;The Departed&lt;/Name&gt;&lt;Released&gt;2006&lt;/Released&gt;&lt;/Movie&gt;&lt;Movie&gt;&lt;Name&gt;The Pursuit of Happyness&lt;/Name&gt;&lt;Released&gt;2006&lt;/Released&gt;&lt;/Movie&gt;&lt;/Genre&gt;&lt;Genre name=\"\"Comedy\"\"&gt;&lt;Movie&gt;&lt;Name&gt;The Bucket List&lt;/Name&gt;&lt;Released&gt;2007&lt;/Released&gt;&lt;/Movie&gt;&lt;/Genre&gt;&lt;/Movies&gt;\"\n\n    XSLT = \"&lt;xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:w=\"\"http://schemas.microsoft.com/office/word/2003/wordml\"\"&gt;&lt;xsl:output indent=\"\"yes\"\"/&gt;&lt;xsl:template match=\"\"/\"\"&gt;&lt;w:document&gt;&lt;w:body&gt;&lt;w:tbl&gt;&lt;w:tr&gt;&lt;xsl:for-each select=\"\"/Movies/Genre\"\"&gt;&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;&lt;xsl:value-of select=\"\"@name\"\"/&gt;&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;&lt;/xsl:for-each&gt;&lt;/w:tr&gt;&lt;!-- Movies? --&gt;&lt;xsl:call-template name=\"\"movies-row\"\"&gt;&lt;xsl:with-param name=\"\"i\"\" select=\"\"1\"\"&gt;&lt;/xsl:with-param&gt;&lt;/xsl:call-template&gt;&lt;/w:tbl&gt;&lt;/w:body&gt;&lt;/w:document&gt;&lt;/xsl:template&gt;&lt;xsl:template name=\"\"movies-row\"\"&gt;&lt;xsl:param name=\"\"i\"\"/&gt;&lt;w:tr&gt;&lt;xsl:for-each select=\"\"/Movies/Genre\"\"&gt;&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;&lt;xsl:choose&gt;&lt;xsl:when test=\"\"count(Movie) &gt;= $i\"\"&gt;&lt;xsl:value-of select=\"\"concat(Movie[$i]/Name, ' (', Movie[$i]/Released, ')')\"\"/&gt;&lt;/xsl:when&gt;&lt;xsl:otherwise&gt;&lt;!-- empty cell --&gt;&lt;/xsl:otherwise&gt;&lt;/xsl:choose&gt;&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;&lt;/xsl:for-each&gt;&lt;/w:tr&gt;&lt;xsl:if test=\"\"/Movies/Genre[count(Movie) &gt; $i]\"\"&gt;\" &amp; _\n           \"&lt;xsl:call-template name=\"\"movies-row\"\"&gt;&lt;xsl:with-param name=\"\"i\"\" select=\"\"$i + 1\"\"/&gt;&lt;/xsl:call-template&gt;&lt;/xsl:if&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;\"\n\n    Selection.Range.InsertXML strXML, XSLT\n\nEnd Sub\n</code></pre>\n\n<p>I have added double quotes to the strings (so that the quotes appear correctly when using debug.print) AND I have added additional tags as described <a href=\"http://archive.oreilly.com/pub/h/2636\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I think I'm not setting up the Transform correctly. If the Transform is set to vbnullstring everything works. Otherwise I get an error: </p>\n\n<blockquote>\n  <p>XML markup cannot be inserted in the specified location</p>\n</blockquote>\n\n<p>Basically, as an answer to this question, I'd like a minimal example showing how to use <code>.InsertXML</code> using Transform.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 1320, "user_id": 1999217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574817f0262cfdea1c206ab252a1d84b?s=128&d=identicon&r=PG", "display_name": "Michael Hudson", "link": "https://stackoverflow.com/users/1999217/michael-hudson"}, "edited": false, "score": 1, "creation_date": 1518580237, "post_id": 48779004, "comment_id": 84560343, "body": "You can you use &#39;Filter&#39; to only show the highlighted rows, that might be one way to solve the problem for you...."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 1, "creation_date": 1518582258, "post_id": 48779004, "comment_id": 84560890, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49964/count-a-list-of-cells-with-the-same-background-color\">Count a list of cells with the same background color</a>"}, {"owner": {"reputation": 704, "user_id": 7451779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9312bc877dd61d3a3b15e25eea522b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Haider Malik", "link": "https://stackoverflow.com/users/7451779/haider-malik"}, "reply_to_user": {"reputation": 1320, "user_id": 1999217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574817f0262cfdea1c206ab252a1d84b?s=128&d=identicon&r=PG", "display_name": "Michael Hudson", "link": "https://stackoverflow.com/users/1999217/michael-hudson"}, "edited": false, "score": 0, "creation_date": 1518669522, "post_id": 48779004, "comment_id": 84602787, "body": "@MichaelHudson that wont work as it the highlighted cells are scattered through the table. Filtering will miss some of that data"}], "answers": [{"tags": [], "owner": {"reputation": 704, "user_id": 7451779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9312bc877dd61d3a3b15e25eea522b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Haider Malik", "link": "https://stackoverflow.com/users/7451779/haider-malik"}, "is_accepted": false, "score": 0, "last_activity_date": 1518577579, "creation_date": 1518577579, "answer_id": 48779018, "question_id": 48779004, "link": "https://stackoverflow.com/questions/48779004/if-cell-is-highlight-then/48779018#48779018", "title": "If cell is highlight then", "body": "<p>I dont think there is a straight forward formula like vlookup, sum, countif ect. so unfortunately it requires a macro.</p>\n\n<p>Create a macro and here is the code I used:</p>\n\n<pre><code>Sub COUNT_HIGHLIGHTS()\n'\n' COUNT_HIGHLIGHTS\n'\n\n\n'Defining variables\nDim LastRow As Long, Count As Integer\n\n\n'Getting a number value for the number of rows in the table (as this can vary on table size)\nLastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n\n\n'For loop to loop through rows\nFor i = 2 To LastRow\n'Count is the number of cells in the row which are highlighted\nCount = 0\n'For loop for cells within the row (My table always has 36 cells)\nFor j = 5 To 36\n'If statement to check if cell is highlighted\nIf Cells(i, j).Interior.Color = 65535 Then\n'Add +1 to count ever time a highlighted cell is found\nCount = Count + 1\nEnd If\nNext j\n'find cell at the end of the row and add the count\nCells(i, 37).Select\nSelection.Value = Count\nNext i\nEnd Sub\n</code></pre>\n\n<p>Once you finish you get a column at the end</p>\n\n<p>Column 1 | Column 2 | Column 3 | ...... Column just outside your table\nColValue 1 | ColValue2| ColValue3| ....... 5 (If 5 cells in the table are highlighted)</p>\n\n<p>Then just filter the table to the count values you created to everything but 0</p>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1518581385, "creation_date": 1518581385, "answer_id": 48779526, "question_id": 48779004, "link": "https://stackoverflow.com/questions/48779004/if-cell-is-highlight-then/48779526#48779526", "title": "If cell is highlight then", "body": "<p>You may like to use a UDF (User Defined Function) for that. Here is one. It will count all cells which are not without colour, regardless of which colour they have.</p>\n\n<pre><code>Function HighLightCount(Target As Range) As Integer\n    ' 14 Feb 2018\n\n    Dim Cell As Range\n    Dim Fun As Integer\n\n    For Each Cell In Target\n        Fun = Fun - Int(Cell.Interior.Color &lt;&gt; 16777215)\n    Next Cell\n    HighLightCount = Fun\nEnd Function\n</code></pre>\n\n<p>Install the code in a standard code module (by default that would be <code>Module1</code> until you change the name). Call the function from the worksheet like a normal Excel function, for example,</p>\n\n<pre><code>=HighLightCount(A2:J2)\n</code></pre>\n\n<p>You can copy/paste the formula to other cells just like any other. You can also embed it in Excel's built-in functions, for example,</p>\n\n<pre><code>=IF(HighLightCount(A6:J6)&gt;2,SUM(A6:D6),SUM(E6:J6))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1518581941, "creation_date": 1518581941, "answer_id": 48779604, "question_id": 48779004, "link": "https://stackoverflow.com/questions/48779004/if-cell-is-highlight-then/48779604#48779604", "title": "If cell is highlight then", "body": "<p>If you want to search cells by specific color the below UDF will help you.</p>\n\n<pre><code>Function CountCellsByColor(SearchRange As Range, RefCellColor As Range) As Long\n    Dim indRefColor As Long\n    Dim cellCurrent As Range\n    Dim cntRes As Long\n\n    Application.Volatile\n    cntRes = 0\n    indRefColor = RefCellColor.Cells(1, 1).Interior.Color\n    For Each cellCurrent In SearchRange\n        If indRefColor = cellCurrent.Interior.Color Then\n            cntRes = cntRes + 1\n        End If\n    Next cellCurrent\n\n    CountCellsByColor = cntRes\nEnd Function\n</code></pre>\n\n<p><code>SearchRange</code> is your range where you are searching and <code>RefCellColor</code> is reference cell of which color format you are looking in <code>SearchRange</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1518624418, "creation_date": 1518624418, "answer_id": 48791487, "question_id": 48779004, "link": "https://stackoverflow.com/questions/48779004/if-cell-is-highlight-then/48791487#48791487", "title": "If cell is highlight then", "body": "<p>There <em>is</em> a way to do this without VBA - however it is very messy, and you need both a \"working\" row and an Excel4 macro in a Named Range.  I detail it only for completeness.</p>\n\n<p>Step 1:  Create a Named Range called \"Background_Below\" (FORMULAS > NAME MANAGER) and give it followin Refers To: <code>=GET.CELL(63,INDIRECT(\"r[-1]c\",FALSE))</code></p>\n\n<p>Step 2:  Add a working row on the row <strong>below</strong> the row you want to count highlighted cells in, and put the formula <code>=Background_Below</code> in the row.  This will be 0 for \"no colour\" or >0 for \"colour\"  (The actual value will be the closest <code>xlColorIndex</code> value to the colour of the cell above)</p>\n\n<p>Step 3:  Do a <code>COUNTIF</code> where the Working Row is >0</p>\n\n<p>As I said, it's messy - at least 9-times-out-of-10 you would be better off using a User Defined Function in VBA.  But it is possible</p>\n"}], "owner": {"reputation": 704, "user_id": 7451779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9312bc877dd61d3a3b15e25eea522b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Haider Malik", "link": "https://stackoverflow.com/users/7451779/haider-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13427, "favorite_count": 1, "answer_count": 4, "score": -1, "last_activity_date": 1609196420, "creation_date": 1518577499, "question_id": 48779004, "link": "https://stackoverflow.com/questions/48779004/if-cell-is-highlight-then", "title": "If cell is highlight then", "body": "<p>I have a table and I want to get a count of the number of cells in a row that are highlighted?</p>\n\n<p>I have tried looking for a formula. I tried getting a COUNT-IF against a colored cell.</p>\n\n<p>I'm guessing you will need some sort of V.B.A. code since there's no formula (Otherwise I wouldn't be here)</p>\n\n<p>Any option to get a count of highlighted cells?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1518574864, "post_id": 48778670, "comment_id": 84559051, "body": "Why are you filtering the xlCellTypeVisible cells? AutoFilter is cleared above this."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518575103, "post_id": 48778670, "comment_id": 84559101, "body": "@Jeeped Maybe he does not realize that hiding rows doesn&#39;t prevent them from being processed?"}, {"owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "edited": false, "score": 0, "creation_date": 1518575662, "post_id": 48778670, "comment_id": 84559217, "body": "@jeeped but even if the cells are not hidden, it is still deleted"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "edited": false, "score": 0, "creation_date": 1519183191, "post_id": 48779076, "comment_id": 84800868, "body": "where does this code fit in: .Range(&quot;A4:W&quot; &amp; Rows.Count).Resize(UBound(b, 1), UBound(b, 2)) = b          i have tried to add it in but it copies over additional data which are incorrect"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "edited": false, "score": 0, "creation_date": 1519184001, "post_id": 48779076, "comment_id": 84801041, "body": "I&#39;m guessing it goes after the .ClearContents code line just as it does in your original code. TBH, I could never figure out what you were trying to do with it so I just fixed your original question about .AutoFilter. BTW, it can be shortened to .Range(&quot;A4&quot;).Resize(UBound(b, 1), UBound(b, 2)) = b since you are resizing in any event."}, {"owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "edited": false, "score": 0, "creation_date": 1519269169, "post_id": 48779076, "comment_id": 84844381, "body": "I added it after the .ClearContents and it could not copy the retrieved data. I tried to add it before the sorting code and it was able to copy over but the auto filter could not work."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1518578181, "creation_date": 1518578181, "answer_id": 48779076, "question_id": 48778670, "link": "https://stackoverflow.com/questions/48778670/auto-filter-not-working/48779076#48779076", "title": "auto filter not working", "body": "<p>Your two-criteria-for-one-field AutoFilter logic is flawed. When something is not <em>KH</em> it can be <em>OFM</em> and when something is not <em>OFM</em> it can be <em>KH</em>. I believe you want to filter for not <em>KH</em> <strong>and</strong>  not <em>OFM</em>.</p>\n\n<p>tldr;</p>\n\n<p>You need xlAnd, not xlOr.</p>\n\n<pre><code>'...\n\nWith Worksheets(\"July 2018\")\n    If .AutoFilterMode Then .AutoFilterMode = False\n    With .Range(\"A4\").CurrentRegion\n        .AutoFilter Field:=13, Criteria1:=\"&lt;&gt;Collar &amp; Cuff\"\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;OFM\", Operator:=xlAnd, Criteria2:=\"&lt;&gt;KH\"   '&lt;~~ THIS RIGHT HERE\n        With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n            If CBool(Application.Subtotal(103, .Cells)) Then\n                .SpecialCells(xlCellTypeVisible).ClearContents\n            End If\n        End With\n        .Cells.Sort key1:=.Columns(\"G\"), Order1:=xlAscending, Header:=xlYes\n    End With\n    '...\n    .AutoFilter.ShowAllData\n    .Range(\"A4\").Select\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518578181, "creation_date": 1518574495, "question_id": 48778670, "link": "https://stackoverflow.com/questions/48778670/auto-filter-not-working", "title": "auto filter not working", "body": "<p>i have a code that has a command button which retrieves its records from an external file.\nevery time the command button is clicked it will delete all the records and paste again. however it allows the user input for records with \"OFM\",\"KH\" and \"Collar &amp; Cuff\" hence it would not delete these rows.</p>\n\n<p>But, my autofilter code is not working properly as it still deletes the rows with \"OFM\" and \"KH\"\" </p>\n\n<pre><code> Rows.Count).CurrentRegion.SpecialCells(xlCellTypeVisible).AutoFilter \n field:=1, Criteria1:=\"&lt;&gt;OFM\", Operator:=xlOr, Criteria2:=\"&lt;&gt;KH\"\n</code></pre>\n\n<p>the code:</p>\n\n<pre><code>Sub July()\nDim arr, c, b(), n&amp;\nApplication.ScreenUpdating = False\nWorksheets(\"July 2018\").Range(\"A4\").AutoFilter\nWorkbooks.Open \"C:\\Users\\sophia.tan\\Desktop\\MasterPlanData.xlsx\", 0, 1\narr = Sheets(\"Excel\").UsedRange\nActiveWorkbook.Close 0\nc = Array(0, 2, 13, 14, 7, 8, 11, 1, 9, 10, 16, 17, 20, 22, 15, 30, 27, 28, \n29, 3, 4, 39)\nd = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, \n20, 21, 23)\nReDim b(1 To UBound(arr), 1 To 23)\n\nFor i = 2 To UBound(arr)\nIf arr(i, 13) &gt;= DateSerial(Year:=2018, Month:=7, Day:=1) And arr(i, 12) &lt;= \nDateSerial(Year:=2018, Month:=7, Day:=31) Then\n    n = n + 1\n    For j = 1 To UBound(c)\n        b(n, d(j)) = arr(i, c(j))\n     Next\n End If\nNext\n\n\nWith Worksheets(\"July 2018\")\n\n.Range(\"A4:W\" &amp; \nRows.Count).CurrentRegion.SpecialCells(xlCellTypeVisible).AutoFilter \nfield:=13, Criteria1:=\"&lt;&gt;Collar &amp; Cuff\"\n.Range(\"A4:W\" &amp; \nRows.Count).CurrentRegion.SpecialCells(xlCellTypeVisible).AutoFilter \nfield:=1, Criteria1:=\"&lt;&gt;OFM\", Operator:=xlOr, Criteria2:=\"&lt;&gt;KH\"\n.Range(\"A4:W\" &amp; Rows.Count).CurrentRegion.Offset(1, \n0).SpecialCells(xlCellTypeVisible).ClearContents\n.Range(\"A4:W\" &amp; Rows.Count).Resize(UBound(b, 1), UBound(b, 2)) = b\n.AutoFilter.ShowAllData\n.Range(\"A4\").CurrentRegion.Sort key1:=Range(\"G3\"), order1:=xlAscending, \nHeader:=xlYes\n.Range(\"A4\").Select\nEnd With\nCall Fabrication\nApplication.ScreenUpdating = 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "listbox", "criteria", "multi-select", "advanced-filter"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9357832, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_LAzz3pQF78/AAAAAAAAAAI/AAAAAAAAEGc/_9WCLBjZ3pM/photo.jpg?sz=128", "display_name": "5haun0", "link": "https://stackoverflow.com/users/9357832/5haun0"}, "edited": false, "score": 0, "creation_date": 1518654830, "post_id": 48782297, "comment_id": 84599476, "body": "Thanks! that did exactly what i wanted."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1518595331, "creation_date": 1518595331, "answer_id": 48782297, "question_id": 48778595, "link": "https://stackoverflow.com/questions/48778595/advanced-filter-with-multiple-criteria-selected-for-1-row/48782297#48782297", "title": "Advanced Filter with multiple criteria selected for 1 row", "body": "<p>in short, the <code>AdvancedFilter</code> filtering criteria requires to:</p>\n\n<ul>\n<li><p>spread filter values between rows to achieve some \"OR\" condition</p></li>\n<li><p>keep filter values in the same row to achieve some \"AND\" condition</p></li>\n</ul>\n\n<p>Not so sure about your actual filtering needs, but my first guess is that you need something like follows (explanations in comments, and I'm assuming that filtering criteria are contained in listboxes items themselves):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim iSel As Long, iRow As Long\n\n    Intersect(Range(\"BH1:BR1\").EntireColumn, ActiveSheet.UsedRange).Offset(1).ClearContents ' clear any existing filtering criteria\n\n    With ListBox1 'reference ListBox1\n        For iSel = 0 To 2 'loop through its items from first to third (note you can use 'For iSel = 0 To .Count-1' to loop through all its items)\n            If .Selected(iSel) Then ' if current item is selected\n                iRow = iRow + 1 'update filter range row to achieve \"OR\" condition\n                Cells(1 + iRow, \"BK\") = .List(iSel) 'write current referenced listbox value in criteria range cell in a row by its own\n            End If\n        Next\n    End With\n\n    With ListBox2\n        For iSel = 0 To 4\n            If .Selected(iSel) Then\n                iRow = iRow + 1\n                Cells(1 + iRow, \"BN\") = .List(iSel)\n            End If\n        Next\n    End With\n\n    Range(\"A6:BD99999\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\n        Range(\"BH1:BR1\").Resize(iRow + 1) ' size criteria range to fit the filtering values read from listboxes\nEnd Sub\n</code></pre>\n\n<p>in such a way you filter A:BD rows that match any filter value between those selected in the two listboxes, i.e. filtered record will have:</p>\n\n<ul>\n<li>any selected value from ListBox1 in column referenced by \"BH1\" cell value</li>\n</ul>\n\n<p>or </p>\n\n<ul>\n<li>any selected value from ListBox2 in column referenced by \"BN1\" cell value </li>\n</ul>\n\n<p>should that be what you need, than you can remove columns BL to BM and BO to BR from criteria range (and therefore adjust all BN references to BL)</p>\n\n<p>finally I'd recommend you to use explicit worksheet reference instead of implicitly relying (as your code currently does) on the <code>ActiveSheet</code></p>\n"}], "owner": {"reputation": 13, "user_id": 9357832, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_LAzz3pQF78/AAAAAAAAAAI/AAAAAAAAEGc/_9WCLBjZ3pM/photo.jpg?sz=128", "display_name": "5haun0", "link": "https://stackoverflow.com/users/9357832/5haun0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 48782297, "answer_count": 1, "score": 1, "last_activity_date": 1518595331, "creation_date": 1518573904, "last_edit_date": 1518574140, "question_id": 48778595, "link": "https://stackoverflow.com/questions/48778595/advanced-filter-with-multiple-criteria-selected-for-1-row", "title": "Advanced Filter with multiple criteria selected for 1 row", "body": "<p>Sheet1 contains my data which also becomes my filtered data as i have set filter in place rather than copying the range.</p>\n\n<p>The criteria range on the spreadsheet is populated by a UserForm command button, which also applies the advanced filter.</p>\n\n<p>The criteria range of 2 of the columns within this filter are populated from a list box with the MultiSelectMulti function enabled.</p>\n\n<p>I want to be able to select multiple items from these 2 lists boxes to filter for. I have tried the following and it populated the cells i assigned as it should. Although the filter i believe is trying to find all the values i have assigned in one row, not for each individually so there-fore not displaying anything.</p>\n\n<p>I am pretty new at using VBA and have read some posts about using Unique:=True after the code for the criteria range. I don't know how to use this so if someone could explain that would be great.</p>\n\n<pre><code>'SEARCH CRITERIA - JOB STATUS\nIf ListBox1.Selected(0) = True Then Range(\"BK2\") = \"WON\"\nIf ListBox1.Selected(1) = True Then Range(\"BL2\") = \"PENDING\"\nIf ListBox1.Selected(2) = True Then Range(\"BM2\") = \"LOST\"\n\n'SEARCH CRITERIA - WIN PERCENTAGE\nIf ListBox2.Selected(0) = True Then Range(\"BN2\").Value = \"100%\"\nIf ListBox2.Selected(1) = True Then Range(\"BO2\").Value = \"90%\"\nIf ListBox2.Selected(2) = True Then Range(\"BP2\").Value = \"80%\"\nIf ListBox2.Selected(3) = True Then Range(\"BQ2\").Value = \"70%\"\nIf ListBox2.Selected(4) = True Then Range(\"BR2\").Value = \"60% OR LESS\"\n\n'APPLY ADVANCED FILTER USING SELECTED CRITERIA\n   Range(\"A6:BD99999\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\n        Range(\"BH1:BR2\")\n\n'BH1:BJ2 CONTAINS MY OTHER CRITERIA\n</code></pre>\n\n<p>I already have the sheet set to unprotect prior the code and after the code (as well as my other selections on the user form which work fine). I have tried using 'OR' and 'Else:' to no avail.</p>\n\n<p>Any suggestions would be greatly appreciated on how i can solve my issue to filter the above when selecting multiple items without me having to create extra columns for each criteria in the data as i will have to move loads of conditional formatting manually and it will create too much clutter on my already large sheet.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "bloomberg"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9096584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c240006c39bdc9b7faf6f3fcfb4cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven C", "link": "https://stackoverflow.com/users/9096584/steven-c"}, "edited": false, "score": 0, "creation_date": 1521071095, "post_id": 49262296, "comment_id": 85581863, "body": "I have implemented your recommendations. I only have 1 error left which is the date labeled as &quot;dtStart&quot;. The error message say its an &quot;#N/A Invalid Parameter: &amp; dtStart &amp;&quot;. Do you happen to know how to adjust it to read yyyymmdd format or to get it to work? I just cant seem to get that part to work at all :("}], "tags": [], "owner": {"reputation": 1, "user_id": 9172507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155303181274077/picture?type=large", "display_name": "Masha Galperina", "link": "https://stackoverflow.com/users/9172507/masha-galperina"}, "is_accepted": false, "score": 0, "last_activity_date": 1520961938, "creation_date": 1520961938, "answer_id": 49262296, "question_id": 48778482, "link": "https://stackoverflow.com/questions/48778482/bloomberg-bds-formula-function-to-vba/49262296#49262296", "title": "Bloomberg BDS Formula Function to VBA", "body": "<p>Try <code>\"=BDS(\" &amp; CusipID &amp; \"&amp; \"\" CUSIP\"\",\" &amp; MTGFLOW &amp; \", \"\"MTG_Face_AMT\"\",\" &amp; MTGFace &amp; \",\" &amp; EndDate &amp; \",\"\"Headers = y\"\",\"\"cols=6;rows=184\"\")\"</code>\nfor the formula (not sure I got it totally right Bloomberg-wise) </p>\n\n<p>TIP: <code>\"\"</code> is translated as a quotation mark in the cell itself, while <code>\"</code> is telling VBA that a string is starting/ending</p>\n\n<p>Also, you can't do <code>Dim CusipID as Integer</code> given that the cell you refer to contains letters as well (38378KH93) - just <code>Dim CusipID as String</code> right away.\n<code>MTGFace</code>, on the other hand, is a number (face value), so that can be saved as <code>Long</code> or <code>Double</code> (mind, not <code>Integer</code>).</p>\n"}], "owner": {"reputation": 1, "user_id": 9096584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c240006c39bdc9b7faf6f3fcfb4cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven C", "link": "https://stackoverflow.com/users/9096584/steven-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521130323, "creation_date": 1518572980, "last_edit_date": 1521130323, "question_id": 48778482, "link": "https://stackoverflow.com/questions/48778482/bloomberg-bds-formula-function-to-vba", "title": "Bloomberg BDS Formula Function to VBA", "body": "<p>Below is the Bloomberg BDS formula im using to pull Data Set information from Bloomberg. This formula usually works by manual plugin into a spread sheet but its too troublesome to do it manually for about 80 CUSIPs IDs.</p>\n\n<pre><code>=BDS(A5&amp;\"\" CUSIP\"\",\"\"MTG_Cash_Flow\"\",\"\"MTG_Face_AMT\"\",C5,TEXT(\"\"Settle_DT\"\",\"\"mmddyyyy\"\"),$B$1,\"\"Headers=y\"\",\"\"cols=6;rows=184\"\")\"\n</code></pre>\n\n<p>My goal is to covert the above formula and setup as an Excel VBA formula to pull the information monthly by a click of a button to generate the information. </p>\n\n<p>Since i am unfamiliar with Bloomberg formula format setup in VBA. I would like to get some help with my formula below that I've tried setting up. I've gotten multiple errors when running the formula below but cant figure it out.\nI've also attached the image of the worksheet I'm working on as well for an example.</p>\n\n<p><a href=\"https://i.stack.imgur.com/O8WNy.png\" rel=\"nofollow noreferrer\">Spreadsheet Sample</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oKfgi.png\" rel=\"nofollow noreferrer\">Revised BDS Formula 3.14.18</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tDkCG.png\" rel=\"nofollow noreferrer\">Date Field Used 3.14.18</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/eBi91.png\" rel=\"nofollow noreferrer\">Error Message 3.14.18</a></p>\n\n<pre><code>Sub CalcValues()\n\nDim cusipID As String\ncusipID = Sheets(\"Input\").Cells(5, 1)\n\nDim Cusip As String\nCusip = \"CUSIP\"\n\nDim MTGFLOW As String\nMTGFLOW = \"MTG_CASH_FLOW\"\n\nDim MTGAmt As Long\nMTGAmt = Sheets(\"Input\").Cells(5, 3).Value\n\nDim SettleDT As String\nSettleDT = \"Settle_DT\"\n\nDim dtStart As String\ndtStart = Formart(SettleDT,Format(Sheets(\"Input\").Range(\"B3\"), \"MMDDYYYY\"))\n\nSheets(\"CFs\").Cells(2, 1) = \"=BDS(\"\" &amp; CusipID &amp; \"\",\"\" &amp; CUSIP &amp; \"\",\"\" &amp; MTGFLOW &amp; \"\",\"\" &amp; MTGAmt &amp; \"\",\"\" &amp; SettleDT &amp; \"\",\"\" &amp; dtStart &amp; \"\")\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9357756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c6d325609bafdf2f883277ac9c68716?s=128&d=identicon&r=PG&f=1", "display_name": "Quinnlan", "link": "https://stackoverflow.com/users/9357756/quinnlan"}, "edited": false, "score": 0, "creation_date": 1518576201, "post_id": 48778641, "comment_id": 84559352, "body": "Thank you very much. All of this is so new to me. That worked perfectly. I appreciate your help and time."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1518576282, "last_edit_date": 1518576282, "creation_date": 1518574278, "answer_id": 48778641, "question_id": 48778380, "link": "https://stackoverflow.com/questions/48778380/adding-a-new-row-above-while-adding-suffix-to-first-and-last-cell-in-new-row/48778641#48778641", "title": "Adding a new row above, while adding suffix to first and last cell in new row", "body": "<p>After the copy/insert your active cell and selection should be on the newly inserted row. You need to isolate the used range in that row to edit the first and last cell.</p>\n\n<pre><code>...\nApplication.CutCopyMode = False\ndim nrw as long\nnrw = activecell.row\nwith range(cells(nrw, \"A\"), cells(nrw, columns.count).end(xltoleft))\n    .cells(1, 1) = .cells(1, 1).value &amp; \"A\"\n    .cells(1, .columns.count) = .cells(1, .columns.count).value &amp; \"A\"\nend with\n</code></pre>\n\n<p>You should also be providing a parent worksheet refrence.</p>\n"}], "owner": {"reputation": 21, "user_id": 9357756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c6d325609bafdf2f883277ac9c68716?s=128&d=identicon&r=PG&f=1", "display_name": "Quinnlan", "link": "https://stackoverflow.com/users/9357756/quinnlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518576361, "creation_date": 1518572171, "last_edit_date": 1531164843, "question_id": 48778380, "link": "https://stackoverflow.com/questions/48778380/adding-a-new-row-above-while-adding-suffix-to-first-and-last-cell-in-new-row", "title": "Adding a new row above, while adding suffix to first and last cell in new row", "body": "<p>Need to create a macro that will copy an entire row above the existing row, then deselect the copy range, and add an \"A\" to the end of the first and last cell in the new row.</p>\n\n<p>I have gotten as far as adding the \"A\" in the first cell, but cannot work out how to do so for the last cell also. See code below</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    InsertCopy\n    ActiveCell.Select\n    Application.CutCopyMode = False\n    ActiveCell.Value = ActiveCell.Value &amp; \"A\"\n\nEnd Sub\n</code></pre>\n"}]