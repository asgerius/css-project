[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1478742203, "post_id": 40517980, "comment_id": 68279155, "body": "I posted an answer for your first inquiry and for your 2nd inquiry, it will be better if you put a screenshot of a sample data you want to work on."}, {"owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "reply_to_user": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1478805022, "post_id": 40517980, "comment_id": 68310107, "body": "<a href=\"http://imgur.com/a/MTTa4\" rel=\"nofollow noreferrer\">imgur.com/a/MTTa4</a>  Hi Rowen, thanks for your help.  So basically rngx gets me to AQ13, then i need to paste the formula in AQ15, then drag the formula to the last row.    So that&#39;s the first part. with your help i think i got that.  The 2nd part is that to the right of AQ 13, i need to do the same thing.  the header will be unique but the number of columns in between will be different.  the tricky part i&#39;m faced with is the sum part.  how do i only pick up the range that&#39;s to the right of my first formula"}, {"owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "reply_to_user": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1478805538, "post_id": 40517980, "comment_id": 68310396, "body": "actually i am running into a problem rngx should be AQ13.  using the formula above i get J"}, {"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1478825244, "post_id": 40517980, "comment_id": 68318328, "body": "I updated my code to correctly set the columns, and I added the code for your 2nd inquiry."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "edited": false, "score": 0, "creation_date": 1481132198, "post_id": 40518770, "comment_id": 69254802, "body": "Sorry for the late response, just got back from vacation.  This works great.   thank you sir."}, {"owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "edited": false, "score": 0, "creation_date": 1481134790, "post_id": 40518770, "comment_id": 69256302, "body": "FYI i added the code i ended up using to the original post.  thanks again"}], "tags": [], "owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "is_accepted": true, "score": 1, "last_activity_date": 1478826162, "last_edit_date": 1478826162, "creation_date": 1478742099, "answer_id": 40518770, "question_id": 40517980, "link": "https://stackoverflow.com/questions/40517980/trying-to-find-a-cell-based-on-value-then-using-the-cell-column-location-as-pa/40518770#40518770", "title": "Trying to find a cell based on value then using the cell (column) location as part of my formula", "body": "<p>You can't really get a sum of values in a cell if that cell is part of your <code>=SUM()</code> formula so I changed the formula to get the sum of values from column G to 1 column to the left of the current column.</p>\n\n<p>Then it looks for the second header and gets the sum of values 1 cell to the right of the first sum of values to 1 cell to the left of the column of the second header on row 15.</p>\n\n<p>You can start working on this code:</p>\n\n<pre><code>Sub OutageManagement()\n\n    Dim rngX As Range\n    Dim vCell1, vCell2\n\n    Set rngX = Worksheets(\"WDCap\").Range(\"13:13\").Find(\"MI WD Cap. Reduction\", lookat:=xlPart)\n\n    vCell1 = Replace(rngX.Offset(2, -1).Address, \"$\", \"\")\n\n    rngX.Offset(2, 0).Formula = \"=SUM(G15:\" &amp; vCell1 &amp; \")\"\n\n    vCell1 = Replace(rngX.Offset(2, 1).Address, \"$\", \"\")\n\n    Set rngX = Worksheets(\"WDCap\").Range(\"13:13\").Find(\"Another Header\", lookat:=xlPart)\n\n    vCell2 = Replace(rngX.Offset(2, -1).Address, \"$\", \"\")\n\n    rngX.Offset(2, 0).Formula = \"=SUM(\" &amp; vCell1 &amp; \":\" &amp; vCell2 &amp; \")\"\n\nEnd Sub\n</code></pre>\n\n<p>Here's some mock data I made. From G15 to AP15, I put 1. From AR15 to BR15, I put 2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8N44s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8N44s.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here's after running the macro showing the sum of 1s, which is 36, and the sum of 2s, which is 54.</p>\n\n<p><a href=\"https://i.stack.imgur.com/N4uy9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N4uy9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 40518770, "answer_count": 1, "score": 0, "last_activity_date": 1481135012, "creation_date": 1478735801, "last_edit_date": 1481135012, "question_id": 40517980, "link": "https://stackoverflow.com/questions/40517980/trying-to-find-a-cell-based-on-value-then-using-the-cell-column-location-as-pa", "title": "Trying to find a cell based on value then using the cell (column) location as part of my formula", "body": "<p>So i have this big spreadsheet, the columns and rows are always changing.\nWhat i want to do is find a cell based on it's value, then paste a formula underneath it.  In this case the value is part of a header thus always in the same row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KW3b2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KW3b2.png\" alt=\"Sample Data\"></a></p>\n\n<p>The problem is that i'm trying to sum all the values to the left of the cell.  I know which cell to start from but not the cell that it ends at.  here's my code what am i doing wrong?</p>\n\n<pre><code>Sub OutageManagement()\n\nDim rngX As Range\n\nSet rngX = Worksheets(\"WDCap\").Range(\"13:13\").Find(\"MI WD Cap. Reduction\",   lookat:=xlPart)\n\nrngX.Offset(2, 0).Formula = \"=sum(G15:\" &amp; rngX.Column &amp; \"15)\"\n\n End Sub\n</code></pre>\n\n<p>Bonus points if you can help me with the next step</p>\n\n<p>basically there's another header i need to find thats to the right of my first header, then enter another formula which is adding the sums from where the firsts header was + 3 columns and to the column where the new header is -1.</p>\n\n<p>Sorry if i'm not making sense, bulot of things that doesn't make sense today.</p>\n\n<p><strong>For those interested this is the code i ended up using</strong></p>\n\n<pre><code>Sub WDOutageManagement()\n    Dim rngX As Range\n    Dim vCell1, vCell2\n    LastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row   \n    Set rngX = Worksheets(\"WDCap\").Range(\"13:13\").Find(\"MI WD Cap. Reduction\", lookat:=xlPart)\n        'MI\n    vCell1 = Replace(rngX.Offset(2, -1).Address, \"$\", \"\")\n    rngX.Offset(2, 0).Formula = \"=SUM(G15:\" &amp; vCell1 &amp; \")\"\n    Range(rngX.Offset(2, 0), rngX.Offset(LastRow - 13, 0)).FillDown  \n    'LM\n    vCell1 = Replace(rngX.Offset(2, 5).Address, \"$\", \"\")\n    Set rngX = Worksheets(\"WDCap\").Range(\"13:13\").Find(\"LM WD Cap. Reduction\", lookat:=xlPart)\n    vCell2 = Replace(rngX.Offset(2, -1).Address, \"$\", \"\")\n    rngX.Offset(2, 0).Formula = \"=SUM(\" &amp; vCell1 &amp; \":\" &amp; vCell2 &amp; \")\"\n    Range(rngX.Offset(2, 0), rngX.Offset(LastRow - 13, 0)).FillDown\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "class"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1478735838, "post_id": 40517621, "comment_id": 68277624, "body": "The problem is how are you going to define the class object in Add-In Module? I tried DIM obj as VBProjectName.clsMyClass, but it does not work. Keep in mind that I have to extract VBProject object programmatically too."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1478736813, "post_id": 40517621, "comment_id": 68277884, "body": "Tim solved it: the trick is to do DIM obj and not DIM obj as clsMyClass etc"}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1478736914, "post_id": 40517946, "comment_id": 68277905, "body": "Thanks Tim, that answered my question, just Application.Run syntax should be:  Set obj = Application.Run(&quot;&#39;ObjectSource.xlsm&#39;!GetObject&quot;)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1478735531, "creation_date": 1478735531, "answer_id": 40517946, "question_id": 40517621, "link": "https://stackoverflow.com/questions/40517621/instantiate-a-class-that-sits-in-a-workbook-from-xla-add-in/40517946#40517946", "title": "Instantiate a class that sits in a workbook from XLA add-in", "body": "<p>Create a function in your WB which returns an instance of the class, and use Application.Run from the add-in to call it.</p>\n\n<p>Simple example:</p>\n\n<p><strong>ObjectSource.xlsm</strong></p>\n\n<p>Class module <em>clsTest</em>:</p>\n\n<pre><code>Public MyNumber As Long\n\nPrivate Sub Class_Initialize()\n    MyNumber = 999\nEnd Sub\n</code></pre>\n\n<p>Regular module:</p>\n\n<pre><code>Public Function GetObject() As Object\n    Set GetObject = New clsTest\nEnd Function\n</code></pre>\n\n<p><strong>Other workbook</strong></p>\n\n<pre><code>Sub Tester()\n    Dim obj\n    Set obj = Application.Run(\"ObjectSource.xlsm!GetObject\")\n    MsgBox obj.MyNumber ''&gt;&gt; 999\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 40517946, "answer_count": 1, "score": 1, "last_activity_date": 1478735531, "creation_date": 1478733469, "question_id": 40517621, "link": "https://stackoverflow.com/questions/40517621/instantiate-a-class-that-sits-in-a-workbook-from-xla-add-in", "title": "Instantiate a class that sits in a workbook from XLA add-in", "body": "<p>I have a class that I have defined in a workbook and I have an add-in installed already. I want to create an instance of that class from inside a module that is in the add-in without wiring the two from Tools/References. I want to do that purely with VBA, is there anyway to do that?</p>\n"}, {"tags": ["vba", "ms-access", "vbscript", "catia"], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 1609440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/91540c94dac472edce8c38db739cd29b?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/1609440/rob"}, "is_accepted": true, "score": 1, "last_activity_date": 1478800467, "last_edit_date": 1478800467, "creation_date": 1478736623, "answer_id": 40518069, "question_id": 40516752, "link": "https://stackoverflow.com/questions/40516752/adding-catia-part-properties-through-vba-converted-from-catscript/40518069#40518069", "title": "Adding Catia part properties through VBA, converted from CATScript", "body": "<p>In a scripting document about portability I found the simple workaround is to un-type the variable on which the method is applied. The code below will work in access. It adds a new part and creates a custom vendor dropdown list in properties.</p>\n\n<pre><code>Dim oDoc       '**As Document\nDim i As Integer\nDim param      '**As Paramaters\nDim StrParam   '**As StrParam\nDim arrVendorList(2) As Variant\n\nSet oDoc = CATIA.Documents\nSet AddPart = oDoc.Add(\"Part\") ' create new part\nSet newPart = AddPart.GetItem(\"Part1\") ' set new part\nSet param = newPart.UserRefProperties\nSet StrParam = param.CreateString(\"VENDOR\", \"\") ' create new custom property\n\n' add vender array list to part\narrVendorList(0) = \"\" ' initial value\narrVendorList(1) = \"abc\"\narrVendorList(2) = \"def\"\nStrParam.SetEnumerateValues arrVendorList\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 1609440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/91540c94dac472edce8c38db739cd29b?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/1609440/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1919, "favorite_count": 0, "accepted_answer_id": 40518069, "answer_count": 1, "score": 0, "last_activity_date": 1593957691, "creation_date": 1478728923, "last_edit_date": 1593957691, "question_id": 40516752, "link": "https://stackoverflow.com/questions/40516752/adding-catia-part-properties-through-vba-converted-from-catscript", "title": "Adding Catia part properties through VBA, converted from CATScript", "body": "<p>I am trying to manipulate Catia Part properties using Access VBA. I know there are some incompatibilities between the CAT scripting language and VBA. I am wondering if there are any work arounds or other options for the following built in functions.</p>\n\n<pre><code>.CreateString\n.SetEnumerateValues\n</code></pre>\n\n<p>At the moment I get a \"Method or Data member not found\" with the code below on both functions:</p>\n\n<pre><code>Dim oDoc As Document\nDim oPart As Part\nDim params As Parameters\nDim strParam As StrParam\nDim arrVendorList(1)\n\nSet oDoc = CATIA.ActiveDocument\nSet oPart = oDoc.Part\nSet params = oPart.Parameters\nSet strParam = params.CreateString(\"VENDOR\", \"\")\n\narrVendorList(0) = \"abc\"\narrVendorList(1) = \"def\"\nstrParam.SetEnumerateValues arrVendorList\n</code></pre>\n"}, {"tags": ["javascript", "excel", "href", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1478731455, "post_id": 40516720, "comment_id": 68276119, "body": "Exactly what happens when you run your code?  Have you tried debugging to find out whether you&#39;re getting the elements you expect?  For example try adding <code>Debug.Print objCollection(i).innerText</code> inside your loop and check the output."}, {"owner": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479142374, "post_id": 40516720, "comment_id": 68423264, "body": "Hi Tim - thanks for responding with the tip. The code works fine when I step through line by line and the link is clicked, but when I execute the code from start to end it doesn&#39;t populate any values into the objCollection variable (length = 0). Do you have any tips?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479142980, "post_id": 40516720, "comment_id": 68423629, "body": "If it works when stepping though but not otherwise, then it&#39;s possible the page needs some time to complete and you&#39;re not allowing for that.  The typical tests (e.g. for ReadyState and Busy) do not take into account &quot;dynamic&quot; (&quot;AJAX&quot;) pages where further content is loaded once the page is ready.  That type of page is pretty common now so when you see this issue that&#39;s pretty likely the cause.  Try adding a wait before trying to access the elements."}, {"owner": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479143459, "post_id": 40516720, "comment_id": 68423895, "body": "Thanks Tim - I tried adding a wait and it still doesn&#39;t seem to populate the variable. I&#39;ve updated the code snippet in the question above to include a it more - would you mind taking a look at the final part to see if you have any suggestions for what else I could try?"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "edited": false, "score": 0, "creation_date": 1479225759, "post_id": 40600878, "comment_id": 68462774, "body": "Hi Tim - this is great! Thank you so much for your help - your utility functions are a great resource for me to use. I still run into the same issue when executing vs. stepping-through your code however - the link with the parcel ID is clicked when stepping-through but not when executing. Is there perhaps a setting or something in VBA or Internet Explorer that I need to change to allow it to work during execution?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "edited": false, "score": 0, "creation_date": 1479228756, "post_id": 40600878, "comment_id": 68464803, "body": "There is no functional difference I can think of between running your code straight through and using F8, apart from timing, so I would try increasing the &quot;wait&quot; time just before the problem step."}, {"owner": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "edited": false, "score": 0, "creation_date": 1479262502, "post_id": 40600878, "comment_id": 68479940, "body": "Hm that is so strange. Even when I increase the wait time to 30 seconds it still will not function properly when running the code straight through. Does it work for you when you execute through? I&#39;ve done a bit of research to try to find answers, but haven&#39;t found anything. Best I can find is: <a href=\"http://www.excelforum.com/excel-programming-vba-macros/956625-vba-to-ie-works-in-step-through-not-when-run.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a> but it seems like our code already accounts for that. Any other thoughts? I really appreciate all your help!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "edited": false, "score": 0, "creation_date": 1479264274, "post_id": 40600878, "comment_id": 68480383, "body": "Yes, it works for me if I just let it run: IE10 Excel 2013.  I can&#39;t see any code in that question you link to."}, {"owner": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "edited": false, "score": 0, "creation_date": 1479267511, "post_id": 40600878, "comment_id": 68481141, "body": "I was able to find an answer here....that was pretty obscure! Thank you for your help! <a href=\"http://stackoverflow.com/questions/25488988/internet-explorer-automation-not-working-with-ie11\" title=\"internet explorer automation not working with ie11\">stackoverflow.com/questions/25488988/&hellip;</a> I am using IE11 so I guess that key must have been removed as part of the new program or something..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1479175523, "creation_date": 1479175523, "answer_id": 40600878, "question_id": 40516720, "link": "https://stackoverflow.com/questions/40516720/use-vba-to-click-on-javascript-href-link/40600878#40600878", "title": "Use VBA to Click on javascript href link", "body": "<p>This worked for me.  </p>\n\n<p>If you're doing any amount of web scraping then it's much cleaner to abstract as much of the \"guts\" as you can into utility methods which you can re-use and which help de-clutter your main code, so you can more easily focus on the \"what\" versus the \"how\".</p>\n\n<pre><code>Sub TT()\n\n    Dim i As Integer\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim lookupURL As String, div As Object, el As Object\n    Dim currentParcel As String\n    Dim year As Integer\n    Dim jobs As String\n    Dim completedLoops\n    Dim totalLoops\n\n\n    completedLoops = 0\n    totalLoops = 1\n    lookupURL = \"http://fiscalofficer.cuyahogacounty.us/AuditorApps/real-property/REPI/default.asp\"\n\n    currentParcel = \"648-30-013\"\n\n    Application.StatusBar = \"Executing \" &amp; completedLoops &amp; \" of \" &amp; totalLoops &amp; \" loops\"\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n\n    IE.Navigate lookupURL ' Navigate to website\n    WaitFor IE\n\n    Set div = IE.document.getelementById(\"tabTabdhtmlgoodies_tabView2_1\")\n\n    If Not div Is Nothing Then\n\n        div.Click\n        WaitFor IE\n        ' Input parcel ID\n        If PopulateInputByName(IE, \"parcelNum\", currentParcel) Then\n\n            Application.Wait DateAdd(\"s\", 2, Now)\n\n            Set el = GetNamedInput(IE, \"b_2\")\n            If Not el Is Nothing Then\n\n                el.Click\n                Application.Wait DateAdd(\"s\", 5, Now)\n\n                Set el = GetLinkByText(IE, currentParcel)\n                If Not el Is Nothing Then el.Click 'done!\n\n            Else\n                MsgBox \"Input 'b_2' not found!\"\n            End If\n\n\n        Else\n            MsgBox \"ParcelNum input not found!\"\n        End If\n\n    Else\n        MsgBox \"Tab div not found!\"\n    End If\n\nEnd Sub\n\n'*** Begin utility functions ***\n'utility: wait until page has loaded\nSub WaitFor(IE As Object)\n    Do While IE.ReadyState &lt; 4 Or IE.Busy\n        DoEvents\n    Loop\nEnd Sub\n\n'utility: find a named input and set its value: return True if this succeeded\nFunction PopulateInputByName(IE, theName, theValue) As Boolean\n    Dim el As Object, rv As Boolean\n    Set el = GetNamedInput(IE, theName)\n    If Not el Is Nothing Then\n        el.Value = theValue\n        rv = True\n    End If\n    PopulateInputByName = rv\nEnd Function\n\n'utility: find a named input\nFunction GetNamedInput(IE, theName) As Object\n    Dim objColl As Object, el As Object, rv As Object\n    Set objColl = IE.document.getElementsByTagName(\"input\")\n    For Each el In objColl\n        If el.Name = theName Then\n            Set rv = el\n            Exit For\n        End If\n    Next\n    Set GetNamedInput = rv\nEnd Function\n\n'utility: click link with specific text\nFunction GetLinkByText(IE, theText) As Object\n    Dim objColl As Object, el As Object, rv As Object\n    Set objColl = IE.document.getElementsByTagName(\"a\")\n    For Each el In objColl\n        If el.innerText = theText Then\n            Set rv = el\n            Exit For\n        End If\n    Next\n    Set GetLinkByText = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7138544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed642cc0409f04b01430486eb2769758?s=128&d=identicon&r=PG&f=1", "display_name": "truoger", "link": "https://stackoverflow.com/users/7138544/truoger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4044, "favorite_count": 0, "accepted_answer_id": 40600878, "answer_count": 1, "score": 0, "last_activity_date": 1479175523, "creation_date": 1478728784, "last_edit_date": 1531164843, "question_id": 40516720, "link": "https://stackoverflow.com/questions/40516720/use-vba-to-click-on-javascript-href-link", "title": "Use VBA to Click on javascript href link", "body": "<p>I am trying to automate a program that looks up the property tax returns for specific parcels of land. The website I am using to do so is <a href=\"http://fiscalofficer.cuyahogacounty.us/AuditorApps/real-property/REPI/default.asp\" rel=\"nofollow noreferrer\">here</a>.   </p>\n\n<p>In this example, the parcel ID that I am looking up is 648-30-013. </p>\n\n<p>When I search for that parcel, I arrive at a page with a link that I need to click. The html for the link is below:</p>\n\n<pre><code>&lt;a href='javascript:SubmitThisForm(\"General.asp\", \"64830013\");'&gt;648-30-013&lt;/a&gt;\n</code></pre>\n\n<p>I've tried using the following code to click the link, but have not been successful. The section I am having trouble with is the last section 'click on parcel ID link. The code works fine when stepped through, but when execucted the objCollection variable does not populate.</p>\n\n<pre><code>'Declare Variables\n\n' Counter variable\nDim i As Integer\n\n' Internet explorer variables\nDim IE As Object\nDim objElement As Object\nDim objCollection As Object\nDim lookupURL As String\n\n' Excel variables\nDim currentParcel As String\nDim year As Integer\nDim jobs As String\nDim completedLoops\nDim totalLoops\n\n' Input variables\n'These are the counter variables that loop through your lookup data; where to start and end and how long to loop for\ncompletedLoops = 0\ntotalLoops = 1\nlookupURL = \"http://fiscalofficer.cuyahogacounty.us/AuditorApps/real-property/REPI/default.asp\"\n\n\n'Set value of current lookup based on a starting value and # of loops completed\ncurrentParcel = \"648-30-013\"\nApplication.StatusBar = \"Executing \" &amp; completedLoops &amp; \" of \" &amp; totalLoops &amp; \" loops\"\n\n\n' Establish Internet Exploere Instance\n' Create InternetExplorer Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\n\n' Navigate to website\nIE.Navigate lookupURL\n\n' Wait while IE loading...\nDo While IE.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\n' Click on 'By Parcel #' tab\n' Create a list of all the &lt;div&gt; tags on the page\nSet objCollection = IE.document.getElementsByTagName(\"div\")\n\n' Loop through all &lt;div&gt; tags to find the one with the correct name and input current search term into tag\ni = 0\nDo While i &lt; objCollection.Length\n    If objCollection(i).ID = \"tabTabdhtmlgoodies_tabView2_1\" Then\n        Set objElement = objCollection(i)\n        objElement.Click\n        Exit Do\n    End If\n    i = i + 1\n    Loop\n\nDo While IE.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\n\n' Input parcel ID\nSet objCollection = IE.document.getElementsByTagName(\"input\")\ni = 0\nDo While i &lt; objCollection.Length\n    If objCollection(i).Name = \"parcelNum\" Then\n        objCollection(i).Value = currentParcel\n        Exit Do\n    End If\n    i = i + 1\n    Loop\n\nDo While IE.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\n' Click on search button\nSet objCollection = IE.document.getElementsByTagName(\"input\")\ni = 0\nDo While i &lt; objCollection.Length\n    If objCollection(i).Name = \"b_2\" Then\n        Set objElement = objCollection(i)\n        objElement.Click\n        Exit Do\n    End If\n    i = i + 1\n    Loop\n\nApplication.Wait DateAdd(\"s\", 5, Now)\n\n\n' Click on parcel ID link\nSet objCollection = IE.document.getElementsByTagName(\"a\")\nDebug.Print objCollection.Length\ni = 0\nDo While i &lt; objCollection.Length\n    If objCollection(i).innerText = currentParcel Then\n        Debug.Print objCollection(i).innerText\n        Set objElement = objCollection(i)\n        objElement.Click\n        Exit Do\n    End If\n    i = i + 1\n    Loop\n</code></pre>\n\n<p>Please let me know if there are better ways to click on this link.</p>\n"}, {"tags": ["vba", "excel", "unix"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478733477, "post_id": 40516354, "comment_id": 68276884, "body": "See <a href=\"http://stackoverflow.com/a/6073170/1188513\">this post</a> for reading the <code>StdErr</code> output of your <code>WScript</code> object."}, {"owner": {"reputation": 377, "user_id": 6510076, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa3859327cb7a1f6c90736fe01dd4451?s=128&d=identicon&r=PG&f=1", "display_name": "vivi11130704", "link": "https://stackoverflow.com/users/6510076/vivi11130704"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478790365, "post_id": 40516354, "comment_id": 68301496, "body": "Thank you for the link! I tried their code but still doesn&#39;t work. I updated my post with the new error message. Could you plz take a look?"}], "owner": {"reputation": 377, "user_id": 6510076, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa3859327cb7a1f6c90736fe01dd4451?s=128&d=identicon&r=PG&f=1", "display_name": "vivi11130704", "link": "https://stackoverflow.com/users/6510076/vivi11130704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478790258, "creation_date": 1478727067, "last_edit_date": 1531164843, "question_id": 40516354, "link": "https://stackoverflow.com/questions/40516354/vba-how-to-check-if-download-files-from-server-has-success", "title": "VBA how to check if download files from Server has success?", "body": "<p>I'm able to use the below code to download files from server. However, this does tell me whether the files are downloaded successfully. </p>\n\n<pre><code>Sub DownloadFirstRunFilesPart2()\nApplication.StatusBar = \"Downloading files...\"\nDim wsh As Object\nDim errorcode4 As Integer\nDim cmd5 As Variant\nDim FirstRunFiles(5) As Variant\nDim var As Variant\n\nFirstRunFiles(0) = ProN &amp; \"_KSParameter_UserInput.xlsx\"\nFirstRunFiles(1) = ProN &amp; \"_KSParameter_SysOutput.xlsx\"\nFirstRunFiles(2) = ProN &amp; \"_ModelParameter_UserInput.xlsx\"\nFirstRunFiles(3) = ProN &amp; \"_ModelParameter_SysOutput.xlsx\"\nFirstRunFiles(4) = ProN &amp; \"_VarClusParameter_UserInput.xlsx\"\nFirstRunFiles(5) = ProN &amp; \"_VarClusParameter_SysOutput.xlsx\"\n\nFor Each var In FirstRunFiles\ncmd5 = Chr(34) &amp; \"C:\\Program Files (x86)\" &amp; \"\\PuTTY\\pscp.exe\" &amp; Chr(34) &amp; \" -sftp -l \" &amp; pUser &amp; \" -pw \" &amp; pPass &amp; _\n    \" \" &amp; \" \" &amp; pHost &amp; \":\" &amp; ServerPath &amp; \"/\" &amp; var &amp; \" \" &amp; LocalPath &amp; \"\\\"\nSet wsh = CreateObject(\"wscript.shell\")\nerrorcode4 = wsh.Run(cmd5, vbHide)\n'If errorcode4 = 0 Then MsgBox (\"Error occurs. Fail to download \" &amp; var)\nNext var\n\nApplication.StatusBar = \"Download complete\"\nMsgBox (\"Downloading process complete.\")\nEnd Sub\n</code></pre>\n\n<p>My error code always equals 0 no matter the file exists or not. How should I change this program?</p>\n\n<p>Thanks in advance!</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>The new code that I tried:</p>\n\n<pre><code>Sub test()\nDim wsh As Object\nDim WshShellExec As Variant\nDim cmd3 As String\nDim pFirstRunFile1 As String\nConst WshFinished = 1\nConst WshFailed = 2\n\npFirstRunFile1 = \"this_proj_name.txt\"\n\ncmd3 = Chr(34) &amp; \"C:\\Program Files (x86)\" &amp; \"\\PuTTY\\pscp.exe\" &amp; Chr(34) &amp; \" -sftp -l \" &amp; pUser &amp; \" -pw \" &amp; pPass &amp; _\n    \" \" &amp; \" \" &amp; pHost &amp; \":\" &amp; ServerPath &amp; \"/WOE/\" &amp; pFirstRunFile1 &amp; \" \" &amp; LocalPath &amp; \"\\WOE\"\n\nSet wsh = CreateObject(\"wscript.shell\")\nWshShellExec = wsh.Exec(cmd3)\n\nSelect Case WshShellExec.Status\nCase WshFinished\n   strOutput = WshShellExec.StdOut.ReadAll\nCase WshFailed\n   strOutput = WshShellExec.StdErr.ReadAll\nEnd Select\n\nMsgBox strOutput                'write results in a message box\n\nEnd Sub\n</code></pre>\n\n<p>However I'm getting error on this line:\n    WshShellExec = wsh.Exec(cmd3)\nThe error message says \"Object does not support this property or method\". Any ideas?</p>\n"}, {"tags": ["database", "vba", "ms-access", "where"], "comments": [{"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1478725927, "post_id": 40515953, "comment_id": 68273857, "body": "Couldn&#39;t you do the same thing with one SQL command along the lines of <code>UPDATE order_tbl SET invoice_no = &quot; &amp; invoice_number &amp; &quot; WHERE invoice_no Is Null AND company_name=&#39;&quot; &amp; Me.cmb_start_company.Column(1) &amp; &quot;&#39; AND shiped=True</code>? Although I advocate the use of SQL parameters instead of string concatenation."}, {"owner": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "reply_to_user": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1478726274, "post_id": 40515953, "comment_id": 68274015, "body": "Thanks but i really dont know how to use this code can you post sample please? Thanks"}, {"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1478726913, "post_id": 40515953, "comment_id": 68274323, "body": "I&#39;m not familiar with VBA, but it looks like <a href=\"http://stackoverflow.com/a/1746897/1115360\">What is the VBA equivalent for using Command.Prepare in ADO.NET</a> could help you."}, {"owner": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "reply_to_user": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1478727577, "post_id": 40515953, "comment_id": 68274633, "body": "I got same error :/"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478728228, "post_id": 40516408, "comment_id": 68274900, "body": "@Pecurka - see option 2"}, {"owner": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478728989, "post_id": 40516408, "comment_id": 68275191, "body": "i got this in immediate windows   SELECT * FROM order_tbl WHERE (invoice_no Is Null) AND (company_name=&#39;Bogdanic GmbH doo&#39;) AND (shiped=True)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478730089, "post_id": 40516408, "comment_id": 68275638, "body": "Cool. Now can you paste it as sql in MS Access and see whether you get some results? <a href=\"http://www.quackit.com/pix/microsoft_access/microsoft_access_2016/tutorial/create_a_query_in_microsoft_access_5.png\" rel=\"nofollow noreferrer\">quackit.com/pix/microsoft_access/microsoft_access_2016/tutor&zwnj;&#8203;ial/&hellip;</a>"}, {"owner": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478731060, "post_id": 40516408, "comment_id": 68275964, "body": "yes i got results in query but i make this code in vba at table not in query"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478731409, "post_id": 40516408, "comment_id": 68276097, "body": "Well, I was simply debugging. At which line do you get the error?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478763316, "post_id": 40516408, "comment_id": 68284885, "body": "just returning to your previous answer? Did you really get results from pasting the result from the immediate window as sql in MS Access?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478775465, "post_id": 40516408, "comment_id": 68292035, "body": "@Pecurka see option 4. And try to make your code similar."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1478775440, "last_edit_date": 1478775440, "creation_date": 1478727286, "answer_id": 40516408, "question_id": 40515953, "link": "https://stackoverflow.com/questions/40515953/how-to-enter-a-parameter-in-a-where-clause/40516408#40516408", "title": "How to enter a parameter in a Where clause?", "body": "<p>Just guessing. Can you try this:</p>\n\n<pre><code>\"SELECT * FROM order_tbl WHERE (invoice_no Is Null) AND (company_name='\" _\n &amp; Me.cmb_start_company.Column(1) &amp; \"' )AND (shiped=\" &amp; \"True\")\n</code></pre>\n\n<p>option 2:</p>\n\n<pre><code>dim str_test as string\nstr_test =     \"SELECT * FROM order_tbl WHERE (invoice_no Is Null) AND (company_name='\" &amp; Me.cmb_start_company.Column(1) &amp; \"' )AND (shiped=\" &amp; \"True\")\n\ndebug.print str_test\n</code></pre>\n\n<p>What do you get in the immediate window?</p>\n\n<p>option 3:</p>\n\n<pre><code>  \"SELECT * FROM order_tbl WHERE (invoice_no Is Null) AND (company_name='\" _\n     &amp; Me.cmb_start_company.Column(1) &amp; \"' )AND (shiped=True)\"\n</code></pre>\n\n<p>option 4:\nThen use the sample for here and it should work. <a href=\"https://msdn.microsoft.com/en-us/library/bb243786(v=office.12).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/bb243786(v=office.12).aspx</a> Probably. Just make sure that you set your recordset the same way:</p>\n\n<pre><code>Dim dbsNorthwind As DAO.Database\nDim rstProducts As DAO.Recordset\nDim strSQL As String\n\nSet dbsNorthwind = CurrentDb\nstrSQL = \"SELECT * FROM Products WHERE Discontinued = No \" &amp; _\n         \"ORDER BY ProductName\"\nSet rstProducts = dbsNorthwind.OpenRecordset(strSQL)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478727702, "post_id": 40516483, "comment_id": 68274688, "body": "Just realized, I&#39;ve no idea how the error message is saying a parameter is <i>expected</i>, given it&#39;s an ad-hoc query. Still, a different and more robust approach can&#39;t hurt."}, {"owner": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "edited": false, "score": 0, "creation_date": 1478804486, "post_id": 40516483, "comment_id": 68309846, "body": "I have completed it with new query.. thanks to all :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1478727626, "last_edit_date": 1495541363, "creation_date": 1478727626, "answer_id": 40516483, "question_id": 40515953, "link": "https://stackoverflow.com/questions/40515953/how-to-enter-a-parameter-in-a-where-clause/40516483#40516483", "title": "How to enter a parameter in a Where clause?", "body": "<p>I'm not all that familiar with Access/DAO, but you're concatenating the parameter value into your query. With ADO your command text would look something like this instead:</p>\n\n<pre><code>Const sql As String = \"SELECT * FROM order_tbl WHERE invoice_no Is Null AND company_name = ? AND shiped = True\"\n</code></pre>\n\n<p>The <code>?</code> is a placeholder for a parameter value; instead of calling <code>OpenRecordset(sql)</code> directly, you need to make a <code>Command</code> and add a proper <code>Parameter</code>.</p>\n\n<p>Seems DAO handles this a bit differently, see <a href=\"https://stackoverflow.com/q/95277/1188513\">Parameterized queries in Access</a> - surely one of the answers is applicable here. Because I don't like random ad-hoc queries hitting my databases I'd probably go with the <code>QueryDefs</code> approach in <a href=\"https://stackoverflow.com/a/96134/1188513\">this answer</a>:</p>\n\n<blockquote>\n<pre><code>Dim qdf As Querydef\nDim rst As Recordset\n\n'then we'll open up the query:\nSet qdf = CurrentDB.QueryDefs(qryname)\n\n'Now we'll assign values to the query using the parameters option:\nqdf.Parameters(0) = qryStartDate\nqdf.Parameters(1) = qryEndDate\n\n'Now we'll convert the querydef to a recordset and run it\nSet rst = qdf.OpenRecordset\n</code></pre>\n</blockquote>\n\n<p>That would be:</p>\n\n<pre><code>Dim query As QueryDef\nSet query = CurrentDB.QueryDefs(\"TheQuery\")\n\nquery.Parameters(0) = Me.cmb_start_company.Column(1)\n\nDim result As Recordset\nSet result = query.OpenRecordset\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 6848319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d790f42d85b02d505517309f2853c901?s=128&d=identicon&r=PG", "display_name": "Pecurka", "link": "https://stackoverflow.com/users/6848319/pecurka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1392, "favorite_count": 0, "accepted_answer_id": 40516483, "answer_count": 2, "score": 0, "last_activity_date": 1542056633, "creation_date": 1478725281, "last_edit_date": 1542056633, "question_id": 40515953, "link": "https://stackoverflow.com/questions/40515953/how-to-enter-a-parameter-in-a-where-clause", "title": "How to enter a parameter in a Where clause?", "body": "<p>With this VBA code I get an error:</p>\n\n<blockquote>\n  <p>Too few parameters. Expected 1. </p>\n</blockquote>\n\n<p>I do not know how to enter it right.</p>\n\n<pre><code>Dim rs_invoice As DAO.Recordset\nSet rs_invoice = CurrentDb.OpenRecordset(\"SELECT * FROM order_tbl WHERE invoice_no Is Null AND company_name='\" _\n &amp; Me.cmb_start_company.Column(1) &amp; \"' AND shiped=\" &amp; \"True\")\n\n\nIf Not (rs_invoice.EOF And rs_invoice.BOF) Then\n    rs_invoice.MoveFirst\n    Do Until rs_invoice.EOF = True\n        rs_invoice.Edit\n        rs_invoice!invoice_no = invoice_number\n        rs_invoice.Update\n\n        rs_invoice.MoveNext\n    Loop\nElse\n   'No records\nEnd If\n\n'Finish\n\n\nrs_invoice.Close 'Close the recordset\nSet rs_invoice = Nothing 'Clean up\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 725, "user_id": 6946054, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126539580715735/picture?type=large", "display_name": "Denny S. Temple", "link": "https://stackoverflow.com/users/6946054/denny-s-temple"}, "is_accepted": true, "score": 2, "last_activity_date": 1478730515, "creation_date": 1478730515, "answer_id": 40517068, "question_id": 40515864, "link": "https://stackoverflow.com/questions/40515864/finding-a-character-count-in-word-vba/40517068#40517068", "title": "Finding a character count in Word VBA", "body": "<p>I believe the bookmark functionality is what you're looking for.  </p>\n\n<p>You can create bookmarks in a static Word Document beforehand and use them as your insertion target... or you can create the bookmarks programmatically with VBA and <em>then</em> use the insert text option.</p>\n\n<p><a href=\"http://gregmaxey.mvps.org/word_tip_pages/insert_text_at_or_in_bookmark.html\" rel=\"nofollow noreferrer\">Examples for using a bookmark to insert text.</a></p>\n\n<pre><code>Sub InsertAtBookmarkI()\n  ActiveDocument.Bookmarks(\"bmAtBookmark\").Range.InsertAfter \"Some text here\"\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff197253.aspx\" rel=\"nofollow noreferrer\">MSDN Document for creating bookmarks programmatically.</a></p>\n\n<pre><code>Sub Mark() \n ActiveDocument.Bookmarks.Add Name:=\"mark\" \nEnd Sub\n\nSub ThirdPara() \n Dim myDoc As Document \n ' To best illustrate this example, \n ' Letter.doc must be opened, not active, \n ' and contain more than 3 paragraphs. \n Set myDoc = Documents(\"Letter.doc\") \n myDoc.Bookmarks.Add Name:=\"third_para\", _ \n Range:=myDoc.Paragraphs(3).Range \n myDoc.ActiveWindow.View.ShowBookmarks = True \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 40517068, "answer_count": 1, "score": 1, "last_activity_date": 1478730515, "creation_date": 1478724922, "last_edit_date": 1478726394, "question_id": 40515864, "link": "https://stackoverflow.com/questions/40515864/finding-a-character-count-in-word-vba", "title": "Finding a character count in Word VBA", "body": "<p>I'm trying to dynamically generate a word document from an excel spreadsheet. The way that I am going about doing it now is basically manually finding character count, and then will eventually insert a given item at that specific character count. The given item is stored in excel. So it would be like:</p>\n\n<p>Spreadsheet</p>\n\n<pre><code>     |    1    | 2        |    3\nChar |    50   |  125     |  250\nItem | Hello   | Darkness | Friend\n</code></pre>\n\n<p>And then in the word VBA, use </p>\n\n<pre><code>Dim myCheck As ContentControl\nDim myRange As Range\nDim rng As Long\n\nrng = ''whatever char is for that column\nSet myRange = ActiveDocument.Range(start:=rng, End:=rng)\nSet myCheck = ActiveDocument.ContentControls.Add(wdContentControlCheckBox, myRange)\n 'what I am doing now is adding a check box dynamically at a given position on the range. This can be either checkboxes that are added or text or whatever.\n</code></pre>\n\n<p>The issue is: how do I find locate a specific point on the a word document? The form that I am trying to insert these into is static, so I can safely assume that if I want to insert it at character 100, each time I make a new form it will insert it in the same place.</p>\n\n<p>I tried using 'word count' character button, but that didn't seem to be accurate. It was consistently 40 or so characters in front of where I wanted it to be. Didn't see a pattern. </p>\n\n<p>Is there an easy way to place my cursor at a location on a document and know how many characters came before it, as counted by the range object? Or is there a more efficient way of locating things on a word document, provided that I cannot alter the word document itself in appearance (can't add grids, grid layouts, tables, or anything like that).</p>\n"}, {"tags": ["vba", "vbscript", "visio"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1478725029, "post_id": 40515732, "comment_id": 68273392, "body": "I&#39;d keep the <code>.Close</code> and <code>.Quit</code> calls, but try adding <code>Set appVisio = Nothing</code> at the end, in case."}, {"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478725394, "post_id": 40515732, "comment_id": 68273596, "body": "Rearranging the code worked! Thanks a lot!!"}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "is_accepted": true, "score": 0, "last_activity_date": 1479232466, "creation_date": 1479232466, "answer_id": 40616553, "question_id": 40515732, "link": "https://stackoverflow.com/questions/40515732/closing-visio-from-vbs-file/40616553#40616553", "title": "Closing Visio from VBS file", "body": "<p>The answer to this question is rearranging of code</p>\n\n<pre><code>vsoDoc.close\nappvisio.quit\n\n'put this at the end instead of beginning   \nSet vsoDoc = Nothing\nset AppVisio = nothing\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 40616553, "answer_count": 1, "score": 0, "last_activity_date": 1479232466, "creation_date": 1478724353, "last_edit_date": 1478725276, "question_id": 40515732, "link": "https://stackoverflow.com/questions/40515732/closing-visio-from-vbs-file", "title": "Closing Visio from VBS file", "body": "<p>Currently I open Visio from VBS file and do work. However, every time the macro ends, the Visio.exe still lingers in the 'Active Processes' under Task Manager.</p>\n\n<p>Problem is, when I run the macro multiple times, I get multiple Visio.exe just sitting there.</p>\n\n<p>How can I effectively close the Visio file (hence terminating the process)?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub MacroExample()\n\n    Dim AppVisio \n    Set AppVisio = CreateObject(\"visio.InvisibleApp\")\n    Dim vsoDoc\n\n    Set vsoDoc = AppVisio.Documents.Open(\"filepath\\file.vsd\")\n\n    vsoDoc.ExecuteLine (\"MacroName\")\n    Set vsoDoc = Nothing\n    set AppVisio = nothing\n    vsoDoc.close\n    appvisio.quit\nEnd Sub\n</code></pre>\n\n<p>These 2 lines are not working as intended? (Based on my internet search, documents I've came across all talk about similar code. I thought these 2 would close the process)</p>\n\n<pre><code>    vsoDoc.close\n    appvisio.quit\n</code></pre>\n\n<p>Any help/pointers in the right direction is appreciated! (Note all the code here and inside Visio is working as intended)</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 3, "creation_date": 1478722388, "post_id": 40515166, "comment_id": 68272061, "body": "Try <code>accessApp.Application.Quit</code> after <code>Application.Run</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1478722619, "post_id": 40515166, "comment_id": 68272161, "body": "^^ That. Also you <i>may</i> need to <code>Set accessApp = Nothing</code> too."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1478724522, "post_id": 40515166, "comment_id": 68273139, "body": "you <i>may</i> also gain <i>some</i> speed by using <code>With DoCmd ... End With</code> instead of calling <code>DoCmd</code> on each line."}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478729814, "post_id": 40515166, "comment_id": 68275517, "body": "Thanks, I will try all of these suggestions. Scott, I&#39;m not super experienced in writing code, so could you explain a little more how to use the <code>With DoCmd ... End With</code> ?"}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478733488, "post_id": 40515166, "comment_id": 68276887, "body": "Ok, I tried that and it doesn&#39;t work. Access still sits open and doesn&#39;t close. Can I close it somehow from inside of the Access VBA?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1478764078, "post_id": 40515166, "comment_id": 68285267, "body": "You don&#39;t have to OpenTable, CloseTable and you don&#39;t have to Close the queries - I assume they&#39;re all action queries like updates and appends? I would SetWarnings to False (looks like you&#39;ve done that at the start) - AND test it inside Access first. Add error trap with messagebox"}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479334200, "post_id": 40515166, "comment_id": 68518576, "body": "I was also wondering if any of you would know why I got this error message &quot;ActiveX component can&#39;t create object&quot; at this line of code <code>Set accessApp = CreateObject(&quot;Access.Application&quot;)</code> when I was running this on someone else&#39;s computer. Any suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479133793, "post_id": 40576335, "comment_id": 68417525, "body": "Ok, that makes a lot of sense. I will try this! I do have a question though, do I add the access.App. inside of my macro in Access? Or should I move everything from that macro to Excel? It looks like I should copy the Access code to excel.."}, {"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479139613, "post_id": 40576335, "comment_id": 68421503, "body": "Ah! Oh I am sorry, I didn&#39;t even see that the second macro was located in Access. I just assumed it was all in Excel. Well it depends. You certainly can move it to Excel. I would only move it to Excel if you only use the macro from your Excel file though. Otherwise keep it in a central place. Since your second macro is already in the Access database I am not sure if a global reference is causing the behaviour you are seeing though. It actually shouldnt, because when you are in Excel and type in Application.Something application is your Excel application. If you are in Access, the same holds."}, {"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479139706, "post_id": 40576335, "comment_id": 68421557, "body": "So maybe just try closing the Access application with the 3 lines I wrote at the end of my code sample?"}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479310838, "post_id": 40576335, "comment_id": 68504696, "body": "This worked really well actually! I decided not to use the macro that I had made in Access at all, I just copied it into excel and added <code>accessApp.</code> before all the command lines. I did have to get rid of the loop that deleted the import error tables though, because that did not run nicely from Excel. (Any suggestions?) Thank you! (I have been having trouble trying to accept answers to questions, so I&#39;m emailing with the stack overflow team and trying to resolve it. I&#39;ll accept your answer whenever I can!)"}, {"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479318128, "post_id": 40576335, "comment_id": 68509722, "body": "Before the loop, did you change <code>Set db = CurrentDb</code> to <code>Set db = accessApp.CurrentDb</code>? Also what do you mean by <i>did not run nicely from Excel</i>? Do you mean in terms of performance? In that case I don&#39;t really know. I do loops with TableDefs differently though. I just do <code>Dim tdf As DAO.TableDef</code>, <code>For each tdf in db.TableDefs ...</code>. Maybe this runs faster? It could however also be, that the loop is for some reason just doomed to run slower in Excel. I actually have the same problem the other way around with an application I am building."}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479324910, "post_id": 40576335, "comment_id": 68513551, "body": "Ha Ha, I actually meant that it wouldn&#39;t run at all in Excel, but I did forget to put in <code>accessApp.CurrentDb</code>, so I will try that!"}, {"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479326578, "post_id": 40576335, "comment_id": 68514508, "body": "When you are at it: I think it would be best to omit the <code>db</code> object completely. Instead go with the <code>Dim tdf As DAO.QueryDef</code> approach I described above and then do the while loop like this: <code>For each tdf in accessApp.CurrentDb.QueryDefs</code>. I will edit my answer and post how I would do the loop from within Excel."}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479336238, "post_id": 40576335, "comment_id": 68519437, "body": "Huh, interesting. So, if my code in Excel still starts with this: <code>Dim accessApp Set accessApp = CreateObject(&quot;Access.Application&quot;) accessApp.Visible = True accessApp.OpenCurrentDataBase (&quot;I:\\MyPath\\MyFile.accdb&quot;) accessApp.Run &quot;ImportDataRunQueriesExportData&quot;</code> are you suggesting replacing this with <code>Dim AccessApp As New Access.Application Dim tdf As DAO.TableDef  AccessApp.OpenCurrentDatabase (&quot;SomeDrive:\\SomePath\\SomeDb.accdb&quot;)</code> ? Originally I was going to just plug what you gave me for the loop in, but I think what you mean is that I have to call the database differently, correct?"}, {"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479339605, "post_id": 40576335, "comment_id": 68520606, "body": "Oh nono! I didn&#39;t make myself clear there. You use late binding how you did before and just plug in my loop. But I didn&#39;t know how to late bind the <i>TableDef</i>. I edited my answer one more time so now at the bottom of the answer you can see the loop with late binding. I had to switch the <i>acTable</i> constant with its numeric value which is <i>0</i> ."}, {"owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479339769, "post_id": 40576335, "comment_id": 68520653, "body": "BTW: If the macro <i>ImportDataRunQueriesExportData</i> now lives in Excel you do not have to/should not use <code>accessApp.Run</code> to call it. Simply call it how you would any other Excel macro. You really only need to put <code>AccessApp</code> before anything that isn&#39;t a part of Excel."}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1479929393, "post_id": 40576335, "comment_id": 68769318, "body": "I have one more question, does it make any sense that my code that tells access to close a query doesn&#39;t do anything? The queries don&#39;t close. At the end of running the code, the whole database will close, but when I use <code>accessApp.DoCmd.Close</code> it doesn&#39;t do anything."}], "tags": [], "owner": {"reputation": 327, "user_id": 6229637, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Lxry.jpg?s=128&g=1", "display_name": "Xam Eseerts", "link": "https://stackoverflow.com/users/6229637/xam-eseerts"}, "is_accepted": true, "score": 1, "last_activity_date": 1479339428, "last_edit_date": 1479339428, "creation_date": 1479055661, "answer_id": 40576335, "question_id": 40515166, "link": "https://stackoverflow.com/questions/40515166/running-macro-in-access-from-excel-but-access-doesnt-close-after-running/40576335#40576335", "title": "Running macro in Access from Excel, but Access doesn&#39;t close after running", "body": "<p>From what I can see your problem lies in lines as the following:</p>\n\n<pre><code>DoCmd.OpenQuery (\"5ML\")\n</code></pre>\n\n<p>Change this to:</p>\n\n<pre><code>accessApp.DoCmd.OpenQuery (\"5ML\")\n</code></pre>\n\n<p>To elaborate this a little bit: The DoCmd-Method is from the Access VBA Library. So you need an access application object to run it. You created this object so your code works. But when you invoke a method that is part of the access application and do not reference the application object you create a global reference to the automated application (in this case Access). That's why the application will not shut down, even if you close it properly at the end. That's of course something you should do as well. So what you have to do is first put the application object before every method that is part of the access application and second close the application properly. As a rule:</p>\n\n<pre><code>accessApp.AMethodOfTheAccessApplication\n...\naccessApp.CloseCurrentDatabase\naccessApp.Quit\nSet accessApp = Nothing\n</code></pre>\n\n<p>Here is an article that explains this more clearly, correctly and in detail: <a href=\"http://www.tushar-mehta.com/excel/vba/xl_doesnt_quit/\" rel=\"nofollow noreferrer\">Program won't quit</a></p>\n\n<p><strong>Edit:</strong> To get your TableDef-Deletion-Loop running in Excel you can go with the following code (please note that you have to reference both, the \n<em>Microsoft 16.0 Access database engine Object Library</em>, as well as the <em>Microsoft Access 16.0 Object Library</em> (verion 16 is not important, just take any latest version of these libraries that is available to you)):</p>\n\n<pre><code>Dim AccessApp As New Access.Application\nDim tdf As DAO.TableDef\n\nAccessApp.OpenCurrentDatabase (\"SomeDrive:\\SomePath\\SomeDb.accdb\")\n\nFor Each tdf In AccessApp.CurrentDb.TableDefs\n' loop through all tables\n    If InStr(1, tdf.Name, \"tblDelete\") &gt; 0 Then\n    ' if table is import errors table\n        AccessApp.DoCmd.DeleteObject acTable, tdf.Name\n        ' delete table\n    End If\nNext tdf\n\nSet tdf = Nothing\n\nAccessApp.CurrentDb.Close\nAccessApp.Quit\nSet AccessApp = Nothing\n</code></pre>\n\n<p>As you can see I used late binding instead of early binding (for testing purposes). So if you decide to go with early binding (like in your code above (to not worry about references I guess)) you just have to figure out how to declare the <code>tdf</code> object. <a href=\"https://msdn.microsoft.com/de-de/library/0tcf61s1.aspx\" rel=\"nofollow noreferrer\">What does this binding stuff mean?</a></p>\n\n<p><strong>Edit Edit</strong>: And here is the same loop with late binding:</p>\n\n<pre><code>Dim AccessApp As Object\nSet AccessApp = CreateObject(\"Access.Application\")\nDim tdf As Object\n\nAccessApp.OpenCurrentDatabase (\"SomeDrive:\\SomePath\\SomeDb.accdb\")\n\nFor Each tdf In AccessApp.CurrentDb.TableDefs\n' loop through all tables\n    If InStr(1, tdf.Name, \"tblDelete\") &gt; 0 Then\n    ' if table is import errors table\n        AccessApp.DoCmd.DeleteObject 0, tdf.Name\n        ' delete table\n    End If\nNext tdf\n\nSet tdf = Nothing\n\nAccessApp.CurrentDb.Close\nAccessApp.Quit\nSet AccessApp = Nothing\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "accepted_answer_id": 40576335, "answer_count": 1, "score": 0, "last_activity_date": 1479339428, "creation_date": 1478722232, "question_id": 40515166, "link": "https://stackoverflow.com/questions/40515166/running-macro-in-access-from-excel-but-access-doesnt-close-after-running", "title": "Running macro in Access from Excel, but Access doesn&#39;t close after running", "body": "<p>I am opening Microsoft Access from Excel VBA and running a macro, and then running more code in Excel. Everything worked fine a number of days ago, but now I'm having two problems. First Access doesn't close after running the macro, so Excel times out (It gets a message box that pops up and says Microsoft Excel is waiting for another application to complete an OLE action). That is actually the other problem, because when it times out I have to interact with Excel again to make the macro in Excel continue running. I'm trying to not have to touch anything after I first start my macro in Excel until it is done. And I think it might also be timing out because I added more steps onto my macro in Access so it takes longer...</p>\n\n<p>First, here is the Excel code that calls Access:</p>\n\n<pre><code>Sub Opendatabase()\n\nDim accessApp\nSet accessApp = CreateObject(\"Access.Application\")\naccessApp.Visible = True\naccessApp.OpenCurrentDataBase (\"I:\\MyPath\\MyFile.accdb\")\naccessApp.Run \"ImportDataRunQueriesExportData\"\n\n\n'Run the next part of Excel macro\nApplication.Run \"PullinTheExportedAccessData\"\n\nEnd Sub\n</code></pre>\n\n<p>And then in Access, it does this (sorry it is so long). The purpose it to pull in data, run queries (Which I do by opening and closing them, I'm not sure if there is a faster way) and then exporting data. I want it to close at the end, too, and right now that part doesn't work.</p>\n\n<pre><code>Sub ImportDataRunQueriesExportData()\n\nDoCmd.RunSavedImportExport \"Import-ERT Aggregate Macro\"\n\n'Open master book January to refresh\n\n DoCmd.SetWarnings False\n DoCmd.OpenQuery (\"Remove HP not Area8\")\n DoCmd.OpenQuery (\"Remove Non Area 8 HP\")\n DoCmd.SetWarnings True\nDoCmd.OpenTable (\"Remove HPnonArea8\")\nDoCmd.Close acTable, \"Remove HPnonArea8\"\nDoCmd.OpenQuery (\"Summary For January\")\n\n'Open Duplicate search queries across all c\nDoCmd.OpenQuery (\"S+D\")\nDoCmd.OpenQuery (\"S+D+L\")\nDoCmd.OpenQuery (\"S+D+L+F\")\nDoCmd.OpenQuery (\"S+D+L+F+M\")\n'Open Duplicate search queries within c\nDoCmd.OpenQuery (\"C+S+D\")\nDoCmd.OpenQuery (\"C+S+D+L\")\nDoCmd.OpenQuery (\"C+S+D+L+F\")\nDoCmd.OpenQuery (\"C+S+D+L+F+M\")\n\n\n'Save and close queries, made with create Macro function\n    DoCmd.Close acQuery, \"Summary For January\"\n    DoCmd.Close acQuery, \"S+D\"\n    DoCmd.Close acQuery, \"S+D+L\"\n    DoCmd.Close acQuery, \"S+D+L+F\"\n    DoCmd.Close acQuery, \"S+D+L+F+M\"\n    DoCmd.Close acQuery, \"C+S+D\"\n    DoCmd.Close acQuery, \"C+S+D+L\"\n    DoCmd.Close acQuery, \"C+S+D+L+F\"\n    DoCmd.Close acQuery, \"C+S+D+L+F+M\"\n\n'Open Summary Queries\nDoCmd.OpenQuery (\"New January\")\nDoCmd.OpenQuery (\"Renew January\")\nDoCmd.OpenQuery (\"Count October\")\nDoCmd.OpenQuery (\"Count November\")\nDoCmd.OpenQuery (\"Count December\")\nDoCmd.OpenQuery (\"5B\")\nDoCmd.OpenQuery (\"5CW\")\nDoCmd.OpenQuery (\"5ML\")\nDoCmd.OpenQuery (\"5M\")\nDoCmd.OpenQuery (\"5S\")\nDoCmd.OpenQuery (\"RA\")\n\n'Save and close queries and table\n    DoCmd.Close acQuery, \"New January\"\n    DoCmd.Close acQuery, \"Renew January\"\n    DoCmd.Close acQuery, \"Count October\"\n    DoCmd.Close acQuery, \"Count November\"\n    DoCmd.Close acQuery, \"Count December\"\n    DoCmd.Close acQuery, \"5B\"\n    DoCmd.Close acQuery, \"5CW\"\n    DoCmd.Close acQuery, \"5ML\"\n    DoCmd.Close acQuery, \"5M\"\n    DoCmd.Close acQuery, \"5S\"\n    DoCmd.Close acQuery, \"RA\"\n\n'Make Table, delete w/in c dups, Open Data Table S D Between C, close table\n  DoCmd.SetWarnings False\n\n  DoCmd.OpenQuery (\"Table S+D\")\n  DoCmd.OpenQuery (\"Delete C+S+D\")\n\n  DoCmd.SetWarnings True\n\nDoCmd.OpenTable (\"S D Between C\")\nDoCmd.Close acTable, \"S D B C\"\n\n'Run saved exports of the queries to folder\nDoCmd.RunSavedImportExport \"Export-S+D\"\nDoCmd.RunSavedImportExport \"Export-S+D+L\"\nDoCmd.RunSavedImportExport \"Export-S+D+L+F\"\nDoCmd.RunSavedImportExport \"Export-S+D+L+F+M\"\nDoCmd.RunSavedImportExport \"Export-C+S+D\"\nDoCmd.RunSavedImportExport \"Export-C+S+D+L\"\nDoCmd.RunSavedImportExport \"Export-C+S+D+L+F\"\nDoCmd.RunSavedImportExport \"Export-C+S+D+L+F+M\"\nDoCmd.RunSavedImportExport \"Export-New January\"\nDoCmd.RunSavedImportExport \"Export-Renew January\"\nDoCmd.RunSavedImportExport \"Export-Count October\"\nDoCmd.RunSavedImportExport \"Export-Count November\"\nDoCmd.RunSavedImportExport \"Export-Count December\"\nDoCmd.RunSavedImportExport \"Export-5B\"\nDoCmd.RunSavedImportExport \"Export-5CW\"\nDoCmd.RunSavedImportExport \"Export-5ML\"\nDoCmd.RunSavedImportExport \"Export-5M\"\nDoCmd.RunSavedImportExport \"Export-5S\"\nDoCmd.RunSavedImportExport \"Export-S D Between C\"\nDoCmd.RunSavedImportExport \"Export-RA\"\n\n    Dim n As Integer\n    Dim db As DAO.Database\n\n    Set db = CurrentDb\n    For n = db.TableDefs.Count - 1 To 0 Step -1\n    ' loop through all tables\n        If InStr(1, db.TableDefs(n).Name, \"ImportError\") &gt; 0 Then\n        ' if table is import errors table\n            DoCmd.DeleteObject acTable, db.TableDefs(n).Name\n            ' delete table\n        End If\n    Next n\n\nApplication.SetOption \"Auto compact\", True\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated. Thank you.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478722184, "post_id": 40515027, "comment_id": 68271965, "body": "Seems you&#39;re only missing something like <code>For Each aForm In Application.CurrentProject.AllForms</code> to wrap this logic, and then move that to a <code>Public Sub</code> in a separate standard module (.bas), and run it from the immediate pane."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1478722235, "post_id": 40515027, "comment_id": 68271995, "body": "Related: <a href=\"http://stackoverflow.com/q/34901810/1188513\">Microsoft Access - Loop through all forms and controls on each form</a>"}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1478724111, "post_id": 40515027, "comment_id": 68272940, "body": "I can&#39;t tell you how many times I&#39;ve started a question on SO, fully describe the problem, realize the <i>answer</i> to the problem, then cancel the question. I guess this was almost one of those times!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478724221, "post_id": 40515027, "comment_id": 68272994, "body": "IKR! That&#39;s known as <a href=\"https://blog.codinghorror.com/rubber-duck-problem-solving/\" rel=\"nofollow noreferrer\">rubber duck debugging</a>, it inspired the name for my <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> project (a VBE add-in to enhance VBA IDE functionality) =)"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1478901140, "post_id": 40515027, "comment_id": 68351553, "body": "You don&#39;t need to cycle through the Tab pages. A form will have all controls in its control collection including the tab and all controls in all tab pages. just do for each aControl in aForm.controls ..."}], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478819286, "creation_date": 1478721623, "last_edit_date": 1478819286, "question_id": 40515027, "link": "https://stackoverflow.com/questions/40515027/how-to-make-global-changes-to-access-forms", "title": "How to make global changes to Access forms?", "body": "<p>I've inherited a database which has a tabbed form, which in turn has tabbed subforms. Many of the subforms have a label that has to be corrected.  If this were a Word document or Excel workbook, I'd use Find-and-Replace-All. You can't do that across controls on forms, can you?</p>\n\n<p>Is there a way to do so using VBA? I think it would look something like:</p>\n\n<pre><code> Set aForm = Me\n For each aPage in aForm.Pages\n     For each aControl in aPage.Controls\n          if aControl.type = \"Label\" then\n               if aControl.Value = \"OldText\" then aControl.Value = \"NewText\"\n          end if\n     Next aControl\n Next aPage\n</code></pre>\n\n<p>EDIT  -------------</p>\n\n<p>I tried this code:</p>\n\n<pre><code> For Each aForm In Application.CurrentProject.AllForms  \n     For Each aPage In aForm.Pages  '&lt;---- Error here\n         For Each aControl In aPage.Controls\n              If aControl.Type = \"Label\" Then\n                   If aControl.Value = \"OldText\" Then aControl.Value = \"NewText\"\n              End If\n         Next aControl\n     Next aPage\n Next aForm\n</code></pre>\n\n<p>But I get an error where I put that arrow. It says \"Object doesn't support this property or method\", which means it doesn't like \"aForm.Pages\". What's the right way to cycle through tabbed pages?</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1478797884, "creation_date": 1478797884, "answer_id": 40533376, "question_id": 40515005, "link": "https://stackoverflow.com/questions/40515005/vba-code-to-clear-all-slicer-filters-and-select/40533376#40533376", "title": "VBA code to clear all slicer filters and select", "body": "<p>Try this and let me know what happens:</p>\n\n<pre><code>Dim cache As SlicerCache \n\nFor Each cache In ActiveWorkbook.SlicerCaches \n cache.ClearManualFilter \nNext cache\n\nWith ActiveWorkbook.SlicerCaches(\"Slicer_Manufacturer1\")\n.SlicerItems(\"RB\").Selected = True\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3408, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478963928, "creation_date": 1478721538, "last_edit_date": 1478963928, "question_id": 40515005, "link": "https://stackoverflow.com/questions/40515005/vba-code-to-clear-all-slicer-filters-and-select", "title": "VBA code to clear all slicer filters and select", "body": "<p>I have a very simple VBA code where I want to first clear all filters in the slicer then select RB.</p>\n\n<p>Below is the code I am using without success:</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"Slicer_Manufacturer1\").ClearManualFilter    \nWith ActiveWorkbook.SlicerCaches(\"Slicer_Manufacturer1\")\n.SlicerItems(\"RB\").Selected = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1478724706, "post_id": 40514901, "comment_id": 68273221, "body": "<i>it looks like my code is not copyign the range over</i> - this is not very clear. Can you be more specific? Maybe with screenshots? Also, is <code>Sheet1.Range(&quot;A2:B8&quot;)</code> formulas?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1478724739, "post_id": 40514901, "comment_id": 68273233, "body": "Although the default property of <code>Range</code> is <code>Value</code>, it appears to be required in this statement.  Try <code>.Range(&quot;BA1:BB7&quot;).Value = sheet1.Range(&quot;A2:B8&quot;).Value</code>. Better still try <code>.Range(&quot;BA1:BB7&quot;).Copy Destination := sheet1.Range(&quot;A2&quot;)</code>.  <code>Copy</code> only requires the top, left cell of the destination.  It also copies formats."}, {"owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478726819, "post_id": 40514901, "comment_id": 68274272, "body": ".value fixed it.  thanks guys"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478724894, "post_id": 40515465, "comment_id": 68273322, "body": "yeah i know but i tried without the with and its not working,"}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1478723323, "creation_date": 1478723323, "answer_id": 40515465, "question_id": 40514901, "link": "https://stackoverflow.com/questions/40514901/copying-a-range-from-an-excel-workbook-to-another-workbook-using-sheet-range/40515465#40515465", "title": "copying a range from an Excel workbook to another workbook using sheet range", "body": "<p>The point of the with statement is so that you don't have to keep typing the expression</p>\n\n<p>Try this:</p>\n\n<pre><code>  With setupSheet\n    .Range(\"BA1:BB7\") = sheet1.Range(\"A2:B8\")\n  End With\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478738321, "creation_date": 1478721194, "last_edit_date": 1531164843, "question_id": 40514901, "link": "https://stackoverflow.com/questions/40514901/copying-a-range-from-an-excel-workbook-to-another-workbook-using-sheet-range", "title": "copying a range from an Excel workbook to another workbook using sheet range", "body": "<p>It looks like my code is not copying the range over, but when I tested it with a string it would copy over.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    With setupSheet\n        setupSheet.Range(\"BA1:BB7\") = sheet1.Range(\"A2:B8\")\n    End With\n</code></pre>\n\n<p>Nothing is getting replaced in setupSheet.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 51, "user_id": 7070645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03830f1653d6372e924766d8fbf8634d?s=128&d=identicon&r=PG&f=1", "display_name": "matthias", "link": "https://stackoverflow.com/users/7070645/matthias"}, "edited": false, "score": 0, "creation_date": 1478723516, "post_id": 40514872, "comment_id": 68272620, "body": "What exactly fails? If I delete methods one - three, method 4 works. The array gets printed, the last row remains empty."}, {"owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "reply_to_user": {"reputation": 51, "user_id": 7070645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03830f1653d6372e924766d8fbf8634d?s=128&d=identicon&r=PG&f=1", "display_name": "matthias", "link": "https://stackoverflow.com/users/7070645/matthias"}, "edited": false, "score": 0, "creation_date": 1478724315, "post_id": 40514872, "comment_id": 68273042, "body": "Tks. There is nothing pasted into Excel even for method 4 - my system VBA 7.0 Excel 2010 v 14."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1478739959, "post_id": 40514872, "comment_id": 68278651, "body": "<code>ReDim AllocArray(1 To 970, 1 To 5)</code>  and why is <code>nAsset</code> a <code>Double</code>? It should be an <code>Integer</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478793229, "post_id": 40514872, "comment_id": 68303427, "body": "Most of your variables are variants, so it might be useful to type them more tightly.   If you <code>Dim A, B As Double</code> then only B is a double: A is Variant."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478800082, "post_id": 40514872, "comment_id": 68307662, "body": "Your code work fine for me: no errors and the output range populates with numbers"}, {"owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "edited": false, "score": 0, "creation_date": 1478855882, "post_id": 40514872, "comment_id": 68328001, "body": "It occasionally works, moreoften in the IDE with Watches on the second attempt. Will investigate why inconsistent."}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "edited": false, "score": 0, "creation_date": 1478724563, "post_id": 40515737, "comment_id": 68273156, "body": "Tks. Even when i adjust the AllocArray to start at 1 and go til 5 (instead 0 to 4), the array doesn&#39;t print to sheet...."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "edited": false, "score": 0, "creation_date": 1478724923, "post_id": 40515737, "comment_id": 68273338, "body": "Any error message, or just nothing happens?  Your question doesn&#39;t provide much information about what happens when you run your code.  If you populate the destination range with some dummy content then does your code overwrite that?  Maybe your array doesn&#39;t have any content."}, {"owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "edited": false, "score": 0, "creation_date": 1478768896, "post_id": 40515737, "comment_id": 68287693, "body": "Debug A,B,C,D and AllocArray watch show that the array is populated. The cell gives #VALUE error and nothing is written/overwritten."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1478724364, "creation_date": 1478724364, "answer_id": 40515737, "question_id": 40514872, "link": "https://stackoverflow.com/questions/40514872/publishing-a-2d-array-to-excel-worksheet/40515737#40515737", "title": "Publishing a 2D array to Excel worksheet", "body": "<p>Your array has different lower bounds for each dimension. </p>\n\n<p>You need to adjust for that by adding 1 to <code>UBound(Data,2)</code> :</p>\n\n<pre><code>Sub PrintArray(Data As Variant, Cl As Range)\n    Cl.Resize(UBound(Data, 1), UBound(Data, 2) + 1) = Data\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "edited": false, "score": 0, "creation_date": 1478769104, "post_id": 40518580, "comment_id": 68287827, "body": "Tks, nSim is 160,000 so when defined as Integer may be overflowing."}, {"owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "edited": false, "score": 0, "creation_date": 1478769396, "post_id": 40518580, "comment_id": 68288004, "body": "Tks, these pointers are great.  I don&#39;t know the size (rows) of AllocArray (becuase of the (A+B+C+D)&lt;&gt;100 constraint) until after populating it. I do know the max size (it&#39;s nSim).  I use the <code>UBound()</code> and <code>LBound()</code> to trap new size."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 1, "last_activity_date": 1478740570, "creation_date": 1478740570, "answer_id": 40518580, "question_id": 40514872, "link": "https://stackoverflow.com/questions/40514872/publishing-a-2d-array-to-excel-worksheet/40518580#40518580", "title": "Publishing a 2D array to Excel worksheet", "body": "<p>A few pointers.  </p>\n\n<ul>\n<li>You are correct in using <code>Range(\"D20\").Resize(NumRows, NumCols).Value = AllocArray</code> syntax. </li>\n<li><code>AllocArray</code> needs to be sized with <code>ReDim AllocArray(1 to NumRows, 1 to NumCols)</code></li>\n<li>It is correctly defined as <code>Dim AllocArray() as Variant</code></li>\n<li>The contents need to be either a <code>Double</code> or a <code>String</code>. You are mixing integers and doubles and I think Excel has a hard time with this (I may be wrong). Set <code>A</code>, <code>B</code>, <code>C</code> and <code>D</code> as <code>Double</code></li>\n<li><code>Dim nAsset As Integer: nAsset = 5 ' Count {A, B, ... , F}</code> this is an integer, why was it defined as a <code>Double</code>?</li>\n<li>Use 32-bit integers for counting. <code>Dim Sim As Long: Sim = 1</code>. The max. value for an <code>Integer</code> is 32767 so you may be overflowing. This may apply to other <code>Integer</code> types in your code too.</li>\n<li>You already know how big the array is, you don't need the <code>UBound()</code> and <code>LBound()</code> calls.</li>\n</ul>\n"}], "owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478740570, "creation_date": 1478721085, "question_id": 40514872, "link": "https://stackoverflow.com/questions/40514872/publishing-a-2d-array-to-excel-worksheet", "title": "Publishing a 2D array to Excel worksheet", "body": "<p>The function works as an \"asset class allocation\" engine (with constraints in the Param range) and simulates a portfolio model on each row of the array. I attempt to publish the array onto the worksheet with four methods, each of them fails.</p>\n\n<p>Those Params are configured in M3:O6 as {Min 5, Max 100, Step 5} for each asset weight in assets A,B,C,D.</p>\n\n<p>The function fails to paste the 2D array into Excel. There are 970 permutations, so array is 970x5. Is this a size issue? Code works fine up to <code>PrintArray AllocArray, ActiveWorkbook.Worksheets(\"Test\").[A1]</code></p>\n\n<p><code>Sub PrintArray(Data As Variant, Cl As Range)\n    Cl.Resize(UBound(Data, 1), UBound(Data, 2)) = Data\nEnd Sub</code></p>\n\n<pre><code>Function ConfigureArrayFolly()\n\nDim Param() As Variant\nParam = Range(\"M3:O6\")\n\nDim AMin, AMax, AStep, BMin, BMax, BStep, CMin, CMax, CStep, DMin, DMax, DStep As Double\n\nAMin = Param(1, 1): AMax = Param(1, 2): AStep = Param(1, 3)\nBMin = Param(2, 1): BMax = Param(2, 2): BStep = Param(2, 3)\nCMin = Param(3, 1): CMax = Param(3, 2): CStep = Param(3, 3)\nDMin = Param(4, 1): DMax = Param(4, 2): DStep = Param(4, 3)\n\n\nDim nSim As Double: nSim = (1 + (AMax - AMin) / AStep) * (1 + (BMax - BMin) / BStep) * (1 + (CMax - CMin) / CStep) * (1 + (DMax - DMin) / DStep)\nDim nAsset As Double: nAsset = 4 ' Count {A, B, ... , F}\n\n'Debug.Print nSim\n\nDim AllocArray() As Variant\nReDim AllocArray(1 To 970, 0 To nAsset)\n\nDim Sim As Integer: Sim = 1\nDim A As Double\nDim B As Integer\nDim C As Integer\nDim D As Integer\n\nFor A = AMin To AMax Step AStep\n    For B = BMin To BMax Step BStep\n    'If (A + B) &gt; 100 Then GoTo endB\n        For C = CMin To CMax Step CStep\n        'If (A + B + C) &gt; 100 Then GoTo endC\n            For D = DMin To DMax Step DStep\n                        ' nAsset is the count of set {a1, a2 ... an}\n                        ' AllocArray(1, 2, 3) = (Sim, a1, a2)\n\n                        'Constraints\n                        If (A + B + C + D) &lt;&gt; 100 Then GoTo endD\n                        Debug.Print Sim; A; B; C; D\n\n                        AllocArray(Sim, 0) = Sim\n                        AllocArray(Sim, 1) = A\n                        AllocArray(Sim, 2) = B\n                        AllocArray(Sim, 3) = C\n                        AllocArray(Sim, 4) = D\n                        Sim = Sim + 1\n\n                       ' Debug.Print \"Sim \"; Sim; AllocArray(1, 1)\nendD:\n            Next D\nendC:\n        Next C\nendB:\n    Next B\nNext A\n\n\n' Print to sheet - Method One  (fails)\n    Dim NumRows As Long: Dim NumCols As Long\n    NumRows = UBound(AllocArray, 1) - LBound(AllocArray, 1) + 1\n    NumCols = UBound(AllocArray, 2) - LBound(AllocArray, 2) + 1\n    Set Destination = Range(\"D20\").Resize(NumRows, NumCols).Value = AllocArray\n\n' Print to sheet - Method Two (fails)\n    'Sheets(\"Test\").Range(\"D20\").Value = AllocArray(1, 1)\n\n'Print to sheet - Method Three (fails)\n    PrintArray AllocArray, ActiveWorkbook.Worksheets(\"Test\").[D20]\n\n'Print to sheet - Method Four (fails)\n    Range(\"D20:H989\").Value = AllocArray\n\n    Sheets(\"Test\").Range(\"D20\").Resize(Sim, NumCols).Value = AllocArray\n\n    'Range(D20:G6002) = AllocArray\n\n    ConfigureArrayFolly = nSim\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1478769405, "post_id": 40519979, "comment_id": 68288010, "body": "thank you for the help. Unfortunately still cant get this to work. I am using this record set: Dim db As Database Dim rec As Recordset  Set db = CurrentDb Set rec = db.OpenRecordset(&quot;Select * from tbl_ComplaintsCoded&quot;)  rec.Edit rec(&quot;Business Expert&quot;) = Me.Text5 rec.Update Me.List1.Requery"}], "tags": [], "owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "is_accepted": true, "score": 1, "last_activity_date": 1478752088, "creation_date": 1478752088, "answer_id": 40519979, "question_id": 40514781, "link": "https://stackoverflow.com/questions/40514781/data-not-saving-after-changing-it/40519979#40519979", "title": "Data not saving after changing it", "body": "<p>The problem is this:</p>\n\n<p>Your form is bound to the table test_table; You display data into a bunch of bound fields by clicking on an item in the listbox - but you're never changing the current record of the table, and thus you always update the first record, with whatever values are currently displayed.</p>\n\n<p>Instead of using the listbox, use the navigation buttons the form enables to get to the record you want to update, then your sample may work.</p>\n\n<p>Alternatively If you added ID to listbox's rowsource, when you wanted to save you could do something like:</p>\n\n<pre><code>DoCmd.RunSQL \"UPDATE Test_Table SET [Business Area] = '\" &amp; Combo2 &amp; \"' WHERE ID = \" &amp; List8.Column(4)\n</code></pre>\n\n<p>Better still, (in addition to the above) unbind the form &amp; the controls, and use a recordset to display the current values of the fields onto the form when a record is selected in the listbox. Then the data doesn't need to be in the listbox's rowsource, so you'd change the rowsource to \"SELECT ID, Dates FROM Test_Table\" and set the columnwidths property to \"0cm;3cm\" to hide the ID from the display. Then any reference to List8 is a reference to the ID of the current record, and </p>\n\n<pre><code>List8 = 4\n</code></pre>\n\n<p>Will set the selected index of List8 to the row with ID = 4.</p>\n\n<p>Then after saving, you can</p>\n\n<pre><code>List8.Requery\nList8 = 4\nList8_Click\n</code></pre>\n\n<p>will re-display the data from the database.</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 40519979, "answer_count": 1, "score": -1, "last_activity_date": 1593988333, "creation_date": 1478720686, "last_edit_date": 1593988333, "question_id": 40514781, "link": "https://stackoverflow.com/questions/40514781/data-not-saving-after-changing-it", "title": "Data not saving after changing it", "body": "<p>I am using a listbox to display my data in textboxes and combos. When I change the data it does not save in my table and just can not work out why.</p>\n\n<p>I have attached a simple copy of the database so you get an idea of what im doing</p>\n\n<p><a href=\"https://www.dropbox.com/s/qkndka198tmqc62/Database7.accdb?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/qkndka198tmqc62/Database7.accdb?dl=0</a></p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1478719214, "post_id": 40514378, "comment_id": 68270558, "body": "Why not just <code>application.DisplayFullScreen = True</code>"}, {"owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "reply_to_user": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1478720426, "post_id": 40514378, "comment_id": 68271095, "body": "Because the user must be able to use the other windows of my application. Or other windows entirely"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478721038, "post_id": 40514378, "comment_id": 68271412, "body": "Sounds like you want to display your spreadsheets in some &quot;Excel viewer&quot;, not Microsoft Excel. What&#39;s the rationale for this?"}, {"owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "edited": false, "score": 0, "creation_date": 1478721097, "post_id": 40514378, "comment_id": 68271437, "body": "Just tried with application.disaplayfull screen. Turns out it does not display full screen as I thought. It displays as I want but there is one problem: if the users uses the restore button (say they want to see the window side by side with another)  the title bar disseapears"}, {"owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478721299, "post_id": 40514378, "comment_id": 68271543, "body": "@mat&#39;s mug my application is essentially a large userform. Most of the time data is displayed received thought said userform. However there is a particular set of data that must be shown in excel itself. There used to be a userform control to insert a sheet but it has been deprecated."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1478721546, "post_id": 40514378, "comment_id": 68271654, "body": "So, basically as I said: you made a VBA program that should really be a standalone desktop application, and now you&#39;re trying to &quot;hide&quot; the fact that it&#39;s hosted in Excel. I&#39;d say that&#39;s pushing it a bit. If you want to write a desktop application, don&#39;t write it in VBA."}, {"owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478722246, "post_id": 40514378, "comment_id": 68272003, "body": "@mat&#39;s mug you sir, are one hundred percent correct. However here is a bit of context: I did not know anything about vba until about four months ago. The projected started as a spreassheet to help a friend. So I have most of it done, but they are asking me for an interface. I know this app should have been made in another language but for now porting it is out of the question, because that would mean learning another language from nothing, and for now I dont have the time."}, {"owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "edited": false, "score": 0, "creation_date": 1478722412, "post_id": 40514378, "comment_id": 68272068, "body": "And as for hiding excel... It&#39;s more about making it foolproof than security. My users will know this runs on excel. But I don&#39;t want to give them the ability to screw up. So if I manage to hide the menus completely, that would do."}], "owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478732452, "creation_date": 1478718947, "last_edit_date": 1478732452, "question_id": 40514378, "link": "https://stackoverflow.com/questions/40514378/excel-vba-show-small-title-bar", "title": "Excel vba show small title bar", "body": "<p>My objective is to display an Excel window with title bar, scroll bars, and nothing else menu-wise.</p>\n\n<p>I have been using a combination of the following:</p>\n\n<pre><code>With Application \n    .Executeexcel4macro \"Show.Toolbar(\"\"Ribbon\"\",False)\"\n    .CommandBars(1).Enabled = False\n    .CommandBars(\"ribbon\").Enabled = False\n    .DisplayFormulaBar = False\n    .DisplayStatusBar = False\n End with\n</code></pre>\n\n<p>My problem is, this sometimes removes the title bar completely. I want the small title bar, with just <em>minimize</em>, <em>maximize</em> and <em>close</em> buttons. Not having a title bar at all is a problem. </p>\n\n<p>As a side note, if anyone knows how to disable the <em>File</em> menu, advice is welcome.</p>\n\n<p>Edit: problem solved. It was due to having multiple hidden windows, and executing above code multiple times. Apparently excel gets confused. Solved by executing code on workbook open, once.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "is_accepted": false, "score": 0, "last_activity_date": 1478716885, "creation_date": 1478716885, "answer_id": 40513856, "question_id": 40513855, "link": "https://stackoverflow.com/questions/40513855/excel-how-to-automatically-use-formulas-without-sign/40513856#40513856", "title": "Excel: How to automatically use formulas without = sign", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'Trigger Macro\nIf Target.Cells.Count &gt; 0 Then\n\n'Define Variables\nDim rng As Range\nDim cell As Range\nDim x As String\n\nSet rng = Target\n\n'Add equal sign to all updated cells\nOn Error GoTo NoFormulas\n    If rng = \"\" Then\n    Exit Sub\nOn Error GoTo 0\n        ElseIf rng = Range(\"C2\") Then\n        Exit Sub\n            Else\n                For Each cell In rng\n                On Error GoTo NoFormulas\n                x = cell.Formula\n                cell = \"=\" &amp; Right(x, Len(x))\n                On Error GoTo 0\n\n                Next cell\n                Exit Sub\n\n    End If\n\n\nEnd If\n\n'Error Handler\nNoFormulas:\n  Exit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478716885, "creation_date": 1478716885, "question_id": 40513855, "link": "https://stackoverflow.com/questions/40513855/excel-how-to-automatically-use-formulas-without-sign", "title": "Excel: How to automatically use formulas without = sign", "body": "<p>I thought this was cool when I figured it out and would share.</p>\n\n<p>The code removes the need to add \"=\" signs in front of formulas. This can give your excel sheet more of a software feel when creating templates designed for calculations to be made frequently.</p>\n\n<p>In my case I have a financial analysis template that requires you have to add many items together in many different cells and much of our other templates are not excel based and do not require the \"=\" which causes aggravation for users switching between the two.</p>\n"}, {"tags": ["sql", "excel", "vba", "db2"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478730066, "post_id": 40513831, "comment_id": 68275626, "body": "I am not sure about the syntax with <code>db2</code>. But I&#39;d rather use a solution similar to this one: <a href=\"http://stackoverflow.com/questions/9911659/can-i-use-if-not-exists-to-insert-a-row-if-the-row-is-not-already-present-in-s\" title=\"can i use if not exists to insert a row if the row is not already present in s\">stackoverflow.com/questions/9911659/&hellip;</a> Especially if you allow for multiple instances of the same Excel file you cannot control anymore which records have been inserted into the DB already and which ones are still pending. Other than that I&#39;d implement a worksheet event to track which ones have been uploaded and which ones haven&#39;t been uploaded yet. But this solution wouldn&#39;t be as neat as the first one I proposed."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1478732391, "creation_date": 1478732391, "answer_id": 40517431, "question_id": 40513831, "link": "https://stackoverflow.com/questions/40513831/update-database-connection-before-and-after-database-insert-on-excel-vba/40517431#40517431", "title": "Update Database connection before and after database insert on excel vba", "body": "<p>Regardless of a refresh before or after, the SQL statement does not itself avoid duplicates. If you have a primary key or composite index that restricts duplicate values used in one of the inserted cell values, you may hit an error and break your code as no error/exception handling is currently set up.</p>\n\n<p>Consider populating a temp table (exact structural replica of final table) that is routinely cleaned out. Then, run the classic <code>LEFT JOIN ... NULL / NOT EXISTS / NOT IN</code> append query to insert unique values. Also, as I would be remiss in not encouraging, below uses <a href=\"https://msdn.microsoft.com/en-us/library/ms675869(v=vs.85).aspx\" rel=\"nofollow noreferrer\">ADO parameterization</a>:</p>\n\n<p><strong>SQL</strong> <em>(run one-time)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE OH_CU_WR_TEMPLATE_TEMP AS (\n    SELECT * FROM OH_CU_WR_TEMPLATE\n) WITH NO DATA\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim cmd As ADODB.Command\n    Dim strSQL As String\n    ...\n\n    ' CLEAN OUT TEMP TABLE\n    conn.Execute \"DELETE FROM OH_CU_WR_TEMPLATE_TEMP\"\n\n    ' PREPARE STATEMENT (INSERTS INTO TEMP TABLE)\n    strSQL = \"INSERT INTO OH_CU_WR_TEMPLATE_TEMP (BILL_NUMBER, ROCKTENN_DOC, \" _\n                      &amp; \" ACTION, NOTE1, NOTE2)\" _\n                      &amp; \" VALUES (?, ?, ?, ?, ?)\"\n\n    ' ITERATE ROWS\n    Do Until .Cells(iRowNo, 2) = \"\"\n        ' ASSIGN VALUES\n        sBILL_NUM = .Cells(iRowNo, 2)\n        sROCKTENN_DOC = .Cells(iRowNo, 3)\n        sACTION = .Cells(iRowNo, 4)\n        sNOTE1 = .Cells(iRowNo, 5)\n        sNOTE2 = .Cells(iRowNo, 6)\n\n        ' UPDATE CMD OBJECT \n        Set cmd = New ADODB.Command\n\n        With cmd\n            .ActiveConnection = conn\n            .CommandText = strSQL\n            .CommandType = adCmdText\n            .CommandTimeout = 15\n        End With\n\n        ' BIND PARAMETERS\n        cmd.Parameters.Append cmd.CreateParameter(\"param1\", adVarChar, adParamInput, 255, sBILL_NUM)\n        cmd.Parameters.Append cmd.CreateParameter(\"param2\", adVarChar, adParamInput, 255, sROCKTENN_DOC)\n        cmd.Parameters.Append cmd.CreateParameter(\"param3\", adVarChar, adParamInput, 255, sAction)\n        cmd.Parameters.Append cmd.CreateParameter(\"param4\", adVarChar, adParamInput, 255, sNOTE1)\n        cmd.Parameters.Append cmd.CreateParameter(\"param5\", adVarChar, adParamInput, 255, sNOTE2)\n\n        ' EXECUTE SQL\n        cmd.Execute\n        iRowNo = iRowNo + 1\n    Loop\n\n    ' NON-DUPLICATE APPEND QUERY (USE APPROPRIATE JOIN IDs)\n    conn.Execute \"INSERT INTO OH_CU_WR_TEMPLATE\" _\n                  &amp; \" SELECT * FROM OH_CU_WR_TEMPLATE_TEMP temp\" _\n                  &amp; \" LEFT JOIN OH_CU_WR_TEMPLATE main\" _\n                  &amp; \" ON temp.ID = main.ID\" _\n                  &amp; \" WHERE main.ID IS NULL;\" \n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5414699, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0401be09ab5bf1c978b4a072634a2205?s=128&d=identicon&r=PG&f=1", "display_name": "OVO", "link": "https://stackoverflow.com/users/5414699/ovo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478732391, "creation_date": 1478716810, "last_edit_date": 1478729293, "question_id": 40513831, "link": "https://stackoverflow.com/questions/40513831/update-database-connection-before-and-after-database-insert-on-excel-vba", "title": "Update Database connection before and after database insert on excel vba", "body": "<p>I currently have a worksheet that pulls all records from Table A that do not exists within Table B, I then have a Macro that inserts those values into Table B. </p>\n\n<p>But I realized that it will produce duplicates if the query is not refreshed before the macro is inserted. </p>\n\n<p>With the current Macro I have, how can I include a refresh before and after the insert? </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Insert_New_Bills()\n\n    Dim conn As New ADODB.Connection\n    Dim iRowNo As Integer\n    Dim sBILL_NUM, sROCKTENN_DOC, sACTION, sNOTE1, sNOTE2 As String\n\n    With Sheets(\"NEW BILLS\")\n\n        'Open a connection to SQL Server\n        conn.Open \"Driver={IBM DB2 ODBC DRIVER};Database=BROWN;Hostname=192.168.100.44;Port=50000;Protocol=TCPIP;Uid=\" &amp; \"User\" &amp; \";Pwd=\" &amp; \"Maddox2009\" &amp; \";CurrentSchema=LYNX;\"\n\n        'Skip the header row\n        iRowNo = 2\n\n        'Loop until empty cell in COLUMN1\n        Do Until .Cells(iRowNo, 2) = \"\"\n            sBILL_NUM = .Cells(iRowNo, 2)\n            sROCKTENN_DOC = .Cells(iRowNo, 3)\n            sACTION = .Cells(iRowNo, 4)\n            sNOTE1 = .Cells(iRowNo, 5)\n            sNOTE2 = .Cells(iRowNo, 6)\n\n            'Generate and execute sql statement to import the excel rows to SQL Server table\n            conn.Execute \"INSERT INTO OH_CU_WR_TEMPLATE (BILL_NUMBER, ROCKTENN_DOC, ACTION, NOTE1, NOTE2) values ('\" &amp; sBILL_NUM &amp; \"','\" &amp; sROCKTENN_DOC &amp; \"', '\" &amp; sACTION &amp; \"', '\" &amp; sNOTE1 &amp; \"', '\" &amp; sNOTE2 &amp; \"')\"\n\n\n            iRowNo = iRowNo + 1\n        Loop\n\n        MsgBox \"RECORD UPDATED\"\n\n        conn.Close\n        Set conn = Nothing\n\n        Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-word", "tableofcontents", "vba"], "answers": [{"tags": [], "owner": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "is_accepted": false, "score": 0, "last_activity_date": 1478720844, "creation_date": 1478720844, "answer_id": 40514820, "question_id": 40513293, "link": "https://stackoverflow.com/questions/40513293/word-2010-table-of-contents-manipulation-using-vba/40514820#40514820", "title": "Word 2010 Table of contents manipulation using VBA", "body": "<pre><code>sourceDocument.TablesOfContents().Range.Fields().select\n</code></pre>\n\n<p>is the solution I found</p>\n\n<p>In my case each line in the TOC so my code looks like this:</p>\n\n<pre><code>For I = 1 To TOC_INDEX\n    Debug.Print TOC_INDEX, I, TOC(I)\n    If I = 1 Then\n        sourceDocument.TablesOfContents(1).Range.Fields(TOC(I) + 1).Select\n    Else\n        sourceDocument.TablesOfContents(1).Range.Fields(TOC(I * 2) + 4).Select\n    End If\n    Selection.Font.ColorIndex = wdRed\nNext\n</code></pre>\n\n<p>My task was to highlight entries in the TOC that met certain conditions. (In my case it was the last modification date of a specific document). This data was entered into an array prior to invoking this code. The entire document consisted of a list of other documents and their table of contents, and hyperlinks to those chapters. </p>\n\n<p>Now, when readers view the TOC, they know at a glance that specific documents sections should be viewed. </p>\n"}], "owner": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478720844, "creation_date": 1478714604, "last_edit_date": 1531164843, "question_id": 40513293, "link": "https://stackoverflow.com/questions/40513293/word-2010-table-of-contents-manipulation-using-vba", "title": "Word 2010 Table of contents manipulation using VBA", "body": "<p>I'm attempting to change font color of selected lines in the table of contents, based on certain criteria.</p>\n\n<p>I have an array i move through , where each element is a line number in the TOC.</p>\n\n<pre><code>for I = 1 to TOC_INDEX\n    Selection.GoTo What:=wdGoToLine, Which:=wdGoToAbsolute, Count:=TOC_MORT(J) + 1\n    selection.expand wdline\n    Selection.Font.ColorIndex = wdRed\nnext\n</code></pre>\n\n<p>This works perfectly, except for when J is 1, ( the first entry in the TOC )\nthe entry</p>\n\n<pre><code>selection.expand wdline \n</code></pre>\n\n<p>selects the entire TOC...\nIs there a better method for modifying the TOC, Does anybody have any examples of using the TOC Object</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1481657910, "creation_date": 1481657910, "answer_id": 41129212, "question_id": 40513231, "link": "https://stackoverflow.com/questions/40513231/command-button-to-make-selection-for-slicer/41129212#41129212", "title": "Command Button to make selection for slicer", "body": "<p>How about this...</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/jj229270.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/jj229270.aspx</a></p>\n\n<pre><code>Sub HenkelOnly()\n' HenkelOnly Macro\n\n  With ActiveWorkbook.SlicerCaches(\"Slicer_Manufacturer1\")\n    .ClearAllFilters\n    .SlicerItems(\"HENKEL\").Selected = True\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481657910, "creation_date": 1478714385, "last_edit_date": 1478716371, "question_id": 40513231, "link": "https://stackoverflow.com/questions/40513231/command-button-to-make-selection-for-slicer", "title": "Command Button to make selection for slicer", "body": "<p>I have a command button that makes the selection for the pivot table. I use below VBA code to make the selection. However it takes too long to run. is there a way to optimize the code where it doesnt go thru each line...clears all filters and selects where <code>SlicerItems(\"\").Selected=True</code>. </p>\n\n<pre><code>Sub HenkelOnly()\n'\n' HenkelOnly Macro\n'\n\n'\n    ActiveWorkbook.SlicerCaches(\"Slicer_Manufacturer1\").ClearManualFilter\n    With ActiveWorkbook.SlicerCaches(\"Slicer_Manufacturer1\")\n        .SlicerItems(\"HENKEL\").Selected = True\n        .SlicerItems(\"3M\").Selected = False\n        .SlicerItems(\"ADVANCED BEAUTY CARE INC\").Selected = False\n        .SlicerItems(\"ADVANCED BEAUTY INC\").Selected = False\n        .SlicerItems(\"AGILITY SPORTS\").Selected = False\n        .SlicerItems(\"ALAMO MANUEL MARTIARENA\").Selected = False\n        .SlicerItems(\"ALEN USA\").Selected = False\n        .SlicerItems(\"AMERICAN SAFETY RAZOR\").Selected = False\n        .SlicerItems(\"AMPRO INDUSTRIES\").Selected = False\n        .SlicerItems(\"ANIKA LABORATORIES\").Selected = False\n        .SlicerItems(\"AP DEAUVILLE\").Selected = False\n        .SlicerItems(\"APOLLO\").Selected = False\n        .SlicerItems(\"ASPEN BRANDS\").Selected = False\n        .SlicerItems(\"AWESOME PRODUCTS\").Selected = False\n        .SlicerItems(\"B&amp;G FOODS INC\").Selected = False\n        .SlicerItems(\"BEIERSDORF\").Selected = False\n        .SlicerItems(\"BELLA CURLS\").Selected = False\n        .SlicerItems(\"BIOCARE LABS\").Selected = False\n        .SlicerItems(\"BLISTEX\").Selected = False\n        .SlicerItems(\"BRIGHT AIR\").Selected = False\n        .SlicerItems(\"BRONNER BROS\").Selected = False\n        .SlicerItems(\"BURMAX CO\").Selected = False\n        .SlicerItems(\"CAITCO\").Selected = False\n        .SlicerItems(\"CALIFORNIA SCENTS\").Selected = False\n        .SlicerItems(\"CARMA LABORATORIES\").Selected = False\n        .SlicerItems(\"CHATTEM\").Selected = False\n        .SlicerItems(\"CHEATHAM CHEMICAL CO.\").Selected = False\n        .SlicerItems(\"CHEMTURA CORPORATION\").Selected = False\n        .SlicerItems(\"CHIN HO SHING (USA)\").Selected = False\n        .SlicerItems(\"CHURCH &amp; DWIGHT\").Selected = False\n        .SlicerItems(\"COLGATE-PALMOLIVE\").Selected = False\n        .SlicerItems(\"CONAIR CORP\").Selected = False\n        .SlicerItems(\"CONTROL BRAND\").Selected = False\n        .SlicerItems(\"CR BRANDS\").Selected = False\n        .SlicerItems(\"DAGETT &amp; RAMSDELL\").Selected = False\n        .SlicerItems(\"DAMPRID\").Selected = False\n        .SlicerItems(\"DERMASIL LABS\").Selected = False\n        .SlicerItems(\"DR MIRACLES LLC\").Selected = False\n        .SlicerItems(\"E T BROWNE DRUG CO INC\").Selected = False\n        .SlicerItems(\"ECOCO INC\").Selected = False\n        .SlicerItems(\"ELITE ESSENTIALS\").Selected = False\n        .SlicerItems(\"ENERGIZER\").Selected = False\n        .SlicerItems(\"ENPER INC\").Selected = False\n        .SlicerItems(\"EOS PRODUCTS\").Selected = False\n        .SlicerItems(\"FANTASIA INDUSTRIES CORP\").Selected = False\n        .SlicerItems(\"FAULTLESS STARCH / BON AMI COMPANY\").Selected = False\n        .SlicerItems(\"FREEMAN BEAUTY LABS\").Selected = False\n        .SlicerItems(\"FRUIT OF THE EARTH\").Selected = False\n        .SlicerItems(\"GENOMMA LAB\").Selected = False\n        .SlicerItems(\"GOJO INDUSTRIES\").Selected = False\n        .SlicerItems(\"GROWORKS\").Selected = False\n        .SlicerItems(\"HAIN CELESTIAL GROUP\").Selected = False\n        .SlicerItems(\"HBC CHEMICAL CO.\").Selected = False\n        .SlicerItems(\"HELEN OF TROY\").Selected = False\n        .SlicerItems(\"HIGH RIDGE\").Selected = False\n        .SlicerItems(\"HIGH TIME PRODUCTS\").Selected = False\n        .SlicerItems(\"HILLSHIRE BRANDS\").Selected = False\n        .SlicerItems(\"HOLLYWOOD BEAUTY IMPORTS CO\").Selected = False\n        .SlicerItems(\"HOYU AMERICAN CO\").Selected = False\n        .SlicerItems(\"ICONIC\").Selected = False\n        .SlicerItems(\"ILEX CONSUMER PRODUCTS\").Selected = False\n        .SlicerItems(\"IMPERIAL DAX CO\").Selected = False\n        .SlicerItems(\"INSPIRED BEAUTY BRANDS\").Selected = False\n        .SlicerItems(\"J M PRODUCTS\").Selected = False\n        .SlicerItems(\"J STRICKLAND CO.\").Selected = False\n        .SlicerItems(\"JELMAR\").Selected = False\n        .SlicerItems(\"JOHNSON &amp; JOHNSON\").Selected = False\n        .SlicerItems(\"KAO\").Selected = False\n        .SlicerItems(\"KEY BRANDS\").Selected = False\n        .SlicerItems(\"KEYSTONE LABORATORIES INC\").Selected = False\n        .SlicerItems(\"LA CORONA COMPANY\").Selected = False\n        .SlicerItems(\"LANE BRYANT\").Selected = False\n        .SlicerItems(\"LARRY CHERNILA\").Selected = False\n        .SlicerItems(\"LAVO\").Selected = False\n        .SlicerItems(\"L'OREAL\").Selected = False\n        .SlicerItems(\"L'OREAL SSC\").Selected = False\n        .SlicerItems(\"LORNAMEAD GROUP\").Selected = False\n        .SlicerItems(\"LUSTER PRODUCTS INC.\").Selected = False\n        .SlicerItems(\"M &amp; M PRODUCTS\").Selected = False\n        .SlicerItems(\"M30 MANUFACTURING\").Selected = False\n        .SlicerItems(\"MACANDREWS FORBES HOLDINGS INC\").Selected = False\n        .SlicerItems(\"MAID BRANDS\").Selected = False\n        .SlicerItems(\"MENTHOLATUM COMPANY\").Selected = False\n        .SlicerItems(\"MERCK\").Selected = False\n        .SlicerItems(\"MURRAY S WORLDWIDE INC.\").Selected = False\n        .SlicerItems(\"NAKOMA PRODUCTS\").Selected = False\n        .SlicerItems(\"NAMASTE LABORATORIES LLC\").Selected = False\n        .SlicerItems(\"NATURE'S PROTEIN INC\").Selected = False\n        .SlicerItems(\"NEUTRLAB\").Selected = False\n        .SlicerItems(\"NEW SUNSHINE\").Selected = False\n        .SlicerItems(\"NEWHALL LABORATORIES\").Selected = False\n        .SlicerItems(\"NO-AD PRODUCTS\").Selected = False\n        .SlicerItems(\"NOVARTIS PHARMACEUTICALS\").Selected = False\n        .SlicerItems(\"O'KEEFFE'S COMPANY\").Selected = False\n        .SlicerItems(\"OLD WILLIAMSBURGH CANDLE\").Selected = False\n        .SlicerItems(\"PANAMA JACK PRODUCTS\").Selected = False\n        .SlicerItems(\"PARA LABORATORIES\").Selected = False\n        .SlicerItems(\"PARAMOUNT CHEMICAL SPECIALTIES INC\").Selected = False\n        .SlicerItems(\"PARFUMS DE COEUR\").Selected = False\n        .SlicerItems(\"PDC BRANDS\").Selected = False\n        .SlicerItems(\"PEPSICO\").Selected = False\n        .SlicerItems(\"PERFECT PURITY\").Selected = False\n        .SlicerItems(\"PERSONAL CARE\").Selected = False\n        .SlicerItems(\"PF HARRIS COMPANY\").Selected = False\n        .SlicerItems(\"PHOENIX BRANDS\").Selected = False\n        .SlicerItems(\"PIC CORP\").Selected = False\n        .SlicerItems(\"PRESTIGE BRANDS\").Selected = False\n        .SlicerItems(\"PRIVATE LABEL\").Selected = False\n        .SlicerItems(\"PROCTER &amp; GAMBLE\").Selected = False\n        .SlicerItems(\"PROFESSIONAL PRODUCTS UNLIMTED\").Selected = False\n        .SlicerItems(\"PRO-LINE INTERNATIONAL\").Selected = False\n        .SlicerItems(\"RCJP ACQUISITION INC\").Selected = False\n        .SlicerItems(\"RECKITT BENCKISER\").Selected = False\n        .SlicerItems(\"REDDING HAIR CARE\").Selected = False\n        .SlicerItems(\"REDEX INDUSTRIES\").Selected = False\n        .SlicerItems(\"REDOX BRANDS\").Selected = False\n        .SlicerItems(\"RENPURE\").Selected = False\n        .SlicerItems(\"REVLON\").Selected = False\n        .SlicerItems(\"ROTO-ROOTER\").Selected = False\n        .SlicerItems(\"RUG DOCTOR\").Selected = False\n        .SlicerItems(\"SC JOHNSON\").Selected = False\n        .SlicerItems(\"SCIENCE OF BEAUTY LLC\").Selected = False\n        .SlicerItems(\"SCOTCH CORPORATION\").Selected = False\n        .SlicerItems(\"SERVAAS LABORATORIES\").Selected = False\n        .SlicerItems(\"SKINNUTRITIONS\").Selected = False\n        .SlicerItems(\"SOFTEE\").Selected = False\n        .SlicerItems(\"SPARTAN BRANDS INC\").Selected = False\n        .SlicerItems(\"SPECTRUM BRANDS\").Selected = False\n        .SlicerItems(\"SPRAYWAY INC\").Selected = False\n        .SlicerItems(\"STRAIGHT ARROW PRODUCTS\").Selected = False\n        .SlicerItems(\"STRENGTH OF NATURE\").Selected = False\n        .SlicerItems(\"SUN AND SKIN CARE RESEARCH\").Selected = False\n        .SlicerItems(\"SUN PRODUCTS\").Selected = False\n        .SlicerItems(\"SUNDIAL BRANDS\").Selected = False\n        .SlicerItems(\"SUNSHINE MAKERS\").Selected = False\n        .SlicerItems(\"SUREFIL\").Selected = False\n        .SlicerItems(\"SWIZCO\").Selected = False\n        .SlicerItems(\"THE CLOROX COMPANY\").Selected = False\n        .SlicerItems(\"THE COLOMER\").Selected = False\n        .SlicerItems(\"THE COLOMER GROUP\").Selected = False\n        .SlicerItems(\"ULTIMARK PRODUCTS LLC\").Selected = False\n        .SlicerItems(\"ULTRA GLOW\").Selected = False\n        .SlicerItems(\"UNILEVER\").Selected = False\n        .SlicerItems(\"UNIVERSAL BEAUTY PRODUCTS\").Selected = False\n        .SlicerItems(\"VALEANT CONSUMER PRODUCTS\").Selected = False\n        .SlicerItems(\"VI-JON LABORATORIES\").Selected = False\n        .SlicerItems(\"WAHL CLIPPER CORPORATION\").Selected = False\n        .SlicerItems(\"WALT DISNEY\").Selected = False\n        .SlicerItems(\"WAVE LIFE LLC\").Selected = False\n        .SlicerItems(\"WD-40 COMPANY\").Selected = False\n        .SlicerItems(\"WEIMAN PRODUCTS\").Selected = False\n        .SlicerItems(\"WILLERT HOME PRODUCTS\").Selected = False\n        .SlicerItems(\"WIPRO TECHNOLOGIES\").Selected = False\n        .SlicerItems(\"(blank)\").Selected = False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1478712707, "post_id": 40512779, "comment_id": 68267393, "body": "Could your cells have multiple numbers? How would that be formatted?"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1478713024, "post_id": 40512779, "comment_id": 68267536, "body": "Where did <code>CelVal</code> get its value?"}, {"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1478713287, "post_id": 40512779, "comment_id": 68267660, "body": "@Trincot, a cell value can have multiple numbers. the numbers will be input like 1,4,6,13 etc. depending on what they want from WsP worksheet.       CelVal didn&#39;t get copied into the code for whatever reason, I edited it to add it in though."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1478713913, "post_id": 40512779, "comment_id": 68267975, "body": "Do realise that <code>IsNumeric(CelVal)</code> will not be True when you have such a comma-separated list. It will be a string, and the <code>If</code> block will not be entered."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1478714287, "post_id": 40512779, "comment_id": 68268155, "body": "What kind of values are in <code>WsP.Cells(x, 1).Value</code>? Strings? Numbers?"}, {"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1478714793, "post_id": 40512779, "comment_id": 68268417, "body": "I suppose I could have them entered with spaces and then add the comma when I set PRTval. <code>WsP.cells(x,1).value</code> are strings. Specifically they will be a description of something."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1478714140, "post_id": 40512900, "comment_id": 68268082, "body": "Do you know how I could check the what the next character is? Would it be something like this; <code>if InStr(Cells(MonCt, DayCT).Text, x) Then  i = InStr(Cells(MonCt, DayCT).Text, x) + 1   if Isnumeric(i) then</code> the rest of my code?"}, {"owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "reply_to_user": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1479108396, "post_id": 40512900, "comment_id": 68402648, "body": "I would rather do something like this:"}, {"owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "reply_to_user": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1479109694, "post_id": 40512900, "comment_id": 68403213, "body": "For i = 1 To Len(myStr)         j = 0         If IsNumeric(Mid(myStr, i, 1)) Then             Do While IsNumeric(Mid(myStr, i, 1 + j)) And i + j &lt;= Len(myStr)                 j = j + 1             Loop             output = Mid(myStr, i, j)             MsgBox output         End If         i = i + j     Next i"}], "tags": [], "owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1479109788, "last_edit_date": 1479109788, "creation_date": 1478713042, "answer_id": 40512900, "question_id": 40512779, "link": "https://stackoverflow.com/questions/40512779/instr-function-finding-the-entire-number-so-12-will-not-return-true-for-1/40512900#40512900", "title": "Instr function, finding the entire number, so 12 will not return true for 1", "body": "<p>You can look for a number first and then check whether the next character is a number too. So you iterate as long as there is no more number. </p>\n\n<p>UPDATE:\nI would do something like this:</p>\n\n<pre><code>For i = 1 To Len(myString)\n    j = 0\n    If IsNumeric(Mid(myString, i, 1)) Then\n        Do While IsNumeric(Mid(myString, i, 1 + j)) And i + j &lt;= Len(myString)\n            j = j + 1\n        Loop\n        output = Mid(myString, i, j)\n        MsgBox output\n    End If\n    i = i + j\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1478717469, "post_id": 40513158, "comment_id": 68269682, "body": "This worked for me although I had to change num to a variant. I updated the question with the way my code ended up. Thank you."}], "tags": [], "owner": {"reputation": 270, "user_id": 3642781, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/558190537/picture?type=large", "display_name": "cullan", "link": "https://stackoverflow.com/users/3642781/cullan"}, "is_accepted": true, "score": 1, "last_activity_date": 1478719546, "last_edit_date": 1478719546, "creation_date": 1478714046, "answer_id": 40513158, "question_id": 40512779, "link": "https://stackoverflow.com/questions/40512779/instr-function-finding-the-entire-number-so-12-will-not-return-true-for-1/40513158#40513158", "title": "Instr function, finding the entire number, so 12 will not return true for 1", "body": "<p>I'm not quite understanding your question but here are my thoughts:</p>\n\n<p>You can first split the input string by comma (saving it into an array), then iterate through each number inside that array and checking if it contains the value:</p>\n\n<pre><code>Dim myarr() as String  \nDim num as String \nmyarr = Split(inputLine, \",\")\nFor each num in myarr\n    ......\nNext num\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1478717289, "post_id": 40513351, "comment_id": 68269620, "body": "I tried this and I kept coming up with &quot;For each may iterate&quot; errors. I used @cullan&#39;s suggestion and that worked for me. Thank you for your help though."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "reply_to_user": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1478718378, "post_id": 40513351, "comment_id": 68270127, "body": "OK, the error may be due to the data type of <code>str</code>: if you declare it as <code>Variant</code> it might resolve it. Anyway,  good to hear you got it working with cullan&#39;s solution!"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 1, "last_activity_date": 1478718414, "last_edit_date": 1478718414, "creation_date": 1478714881, "answer_id": 40513351, "question_id": 40512779, "link": "https://stackoverflow.com/questions/40512779/instr-function-finding-the-entire-number-so-12-will-not-return-true-for-1/40513351#40513351", "title": "Instr function, finding the entire number, so 12 will not return true for 1", "body": "<p>Some issues:</p>\n\n<ul>\n<li>The test <code>IsNumeric</code> will not yield <code>True</code> when the content is a comma-separated list, in which case it will have the String data type.</li>\n<li>The variable <code>PRTVal</code> is declared as a string, but you use the <code>+</code> operator on it. That should be <code>&amp;</code>.</li>\n</ul>\n\n<p>You can use <code>Split</code> to split a string by the comma delimiter, and then you can loop over the parts.</p>\n\n<p>Here is the part to adapt:</p>\n\n<pre><code>Dim nums As String\nDim str As Variant\n' ... etc ...\n\nIf IsNumeric(Replace(Replace(CelVal, \",\", \"\"), \" \", \"\")) Then\n    PRTval = \"\"\n    nums = Split(CelVal, \",\")\n    For Each str In nums\n        x = CInt(str)\n        If x &gt;= 1 And x &lt;= 26 Then PRTval = PRTval &amp; \", \" &amp; WsP.Cells(x, 1).Value\n    Next\n    Cells(MonCt, DayCT).Value = Mid(PRTval, 3) ' skip first \", \"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 40513158, "answer_count": 3, "score": 0, "last_activity_date": 1479109788, "creation_date": 1478712626, "last_edit_date": 1478717722, "question_id": 40512779, "link": "https://stackoverflow.com/questions/40512779/instr-function-finding-the-entire-number-so-12-will-not-return-true-for-1", "title": "Instr function, finding the entire number, so 12 will not return true for 1", "body": "<p>I am trying to find a way to search a cell for numbers that may have been input. \nSo B2's value is 12. When using Instr it will find 1,2 and 12. Is there a way for it to return only 12? Here is the code I am currently using for it, which if I only used 1-9 would be fine however I need more options.</p>\n\n<pre><code>Sub PRTLookup()\nDim WsP As Worksheet\nDim PRTval As String\nDim MonCt As Long, DayCT As Long\n\nSet WsP = ThisWorkbook.Sheets(\"PT\")\n\nFor MonCt = 2 To 46 Step 4\n    For DayCT = 2 To 32\n         CelVal = Cells(MonCt, DayCT)\n            If IsNumeric(CelVal) Then\n                For x = 1 To 26\n                    If InStr(Cells(MonCt, DayCT).Text, x) Then PRTval = PRTval + WsP.Cells(x, 1).Value\n                Next\n                Cells(MonCt, DayCT).Value = PRTval\n                PRTval = Empty\n            End If\n    Next\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This is the Final code that worked for me:</p>\n\n<pre><code>Dim myarr() as string\nDim num as Variant\n\nFor MonCt = 2 To 46 Step 4\n    For DayCT = 2 To 32\n        Celval = Cells(MonCt, DayCT)\n        myarr = Split(Celval, \",\")\n            For Each num In myarr\n                PRTval = PRTval &amp; \" \" &amp; WsP.Cells(num, 1).Text\n            Next num\n        Cells(MonCt, DayCT).Value = PRTval\n        PRTval = Empty\n    Next\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "automation", "vlookup"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478711473, "post_id": 40512439, "comment_id": 68266750, "body": "So basically  you want to find the last row of your table each time you write the formula to a cell? There are tons of postings on that. What have you tried searching?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478715650, "post_id": 40512439, "comment_id": 68268834, "body": "Perhaps just use <code>Previous!C2:C22</code> instead of <code>Previous!R2C2:R273C22</code>?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478716593, "post_id": 40512439, "comment_id": 68269279, "body": "@YowE3K: better not, since that will have VLOOKUP run on millions of rows!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478716960, "post_id": 40512439, "comment_id": 68269449, "body": "@user3598756 - Judging by the speed in which it does it, I assumed Excel optimised VLookup to not look beyond the UsedRange.  (Or maybe even only look in non-empty areas?  I just tried sticking something on the first and last row and the VLookup was close to instanteous.)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478717974, "post_id": 40512439, "comment_id": 68269921, "body": "I couldn&#39;t say about optimization, anyway as a good habit I always limit ranges extension to what actually needed"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 1, "last_activity_date": 1478712010, "last_edit_date": 1495541232, "creation_date": 1478712010, "answer_id": 40512623, "question_id": 40512439, "link": "https://stackoverflow.com/questions/40512439/how-to-get-vlookup-to-select-down-to-the-lowest-row-in-vba/40512623#40512623", "title": "How to get VLOOKUP to select down to the lowest row in VBA?", "body": "<p>@nbayly said it, plenty of posts on this. Infact i have provided an answer to this before here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/40378815/how-to-replace-rc-formula-value-with-variable/40379547#40379547\">How to Replace RC Formula Value with Variable</a></p>\n\n<p>below is slightly modified for a dynamic range, which is what i believe you are looking for</p>\n\n<pre><code>For j = n To 10 Step -1\n    If Cells(j, 1).Value = \"\" Then\n        Cells(j, 1).Formula = \"=VLookup(RC20,Previous!R2C2:R273C22,17,FALSE)\"\n    End If\nNext j\n</code></pre>\n\n<p>remember to define j as long and <code>n=sheets(\"sheetname)\".cells(rows.count,1).end(xlup).row</code></p>\n\n<p>replace 10 in <code>j = n to 10 with the starting row number</code></p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1479545921, "post_id": 40513754, "comment_id": 68611732, "body": "@lookininward, did you get through it?"}, {"owner": {"reputation": 543, "user_id": 5513243, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/miw7O.jpg?s=128&g=1", "display_name": "lookininward", "link": "https://stackoverflow.com/users/5513243/lookininward"}, "edited": false, "score": 0, "creation_date": 1482620374, "post_id": 40513754, "comment_id": 69838697, "body": "Had to get away and work on other issues. This is the one though, the last piece of the puzzle. Thanks for taking your time to help out."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1478716527, "creation_date": 1478716527, "answer_id": 40513754, "question_id": 40512439, "link": "https://stackoverflow.com/questions/40512439/how-to-get-vlookup-to-select-down-to-the-lowest-row-in-vba/40513754#40513754", "title": "How to get VLOOKUP to select down to the lowest row in VBA?", "body": "<p>try this:</p>\n\n<pre><code>With Worksheets(\"Previous\")\n    Range(\"AJ2\").FormulaR1C1 = _\n        \"=VLOOKUP(RC[-20], Previous!R2C2:R\" &amp; .Cells(.Rows.Count, 2).End(xlUp).Row &amp; \"C22,17,FALSE)\"\nEnd With\n</code></pre>\n\n<p>where:</p>\n\n<ul>\n<li><p><code>Range(\"AJ2\")</code></p>\n\n<p>will implicitly reference the ActiveSheet</p></li>\n<li><p><code>.Cells(.Rows.Count, 2).End(xlUp).Row</code> </p>\n\n<p>will reference \"Previous\" worksheet, being inside a <code>With Worksheets(\"Previous\")- End With</code> block</p></li>\n</ul>\n"}], "owner": {"reputation": 543, "user_id": 5513243, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/miw7O.jpg?s=128&g=1", "display_name": "lookininward", "link": "https://stackoverflow.com/users/5513243/lookininward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 40513754, "answer_count": 2, "score": 0, "last_activity_date": 1478716527, "creation_date": 1478711363, "question_id": 40512439, "link": "https://stackoverflow.com/questions/40512439/how-to-get-vlookup-to-select-down-to-the-lowest-row-in-vba", "title": "How to get VLOOKUP to select down to the lowest row in VBA?", "body": "<p>Looking to automate the insertion of a VLOOKUP formula in a cell. \nWhen recording the macro I instruct it to populate the columns below with the same formula. Works great, however, there is an issue when the table that the VLOOKUP searches through changes (more or less rows).</p>\n\n<p>As it's recorded, the VLOOKUP drops down to the final row in the table (273). However, I want to set it up so that it will go down to the very last row. Meaning that I can run the script on tables of varying numbers of rows.</p>\n\n<p>Selected columns will remain the same. </p>\n\n<pre><code>Range(\"AJ2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=VLOOKUP(RC[-20], Previous!R2C2:R273C22,17,FALSE)\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7033048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W1v9a.png?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7033048/jordan"}, "edited": false, "score": 0, "creation_date": 1478787012, "post_id": 40512142, "comment_id": 68299219, "body": "It seems to not work if I have some values that are already proper case in the column."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 7033048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W1v9a.png?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7033048/jordan"}, "edited": false, "score": 0, "creation_date": 1478788460, "post_id": 40512142, "comment_id": 68300149, "body": "What do you mean by not working?  It gives an error? It changes them to all lower case?  Not working is not very descriptive.  @Jordan"}, {"owner": {"reputation": 1, "user_id": 7033048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W1v9a.png?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7033048/jordan"}, "edited": false, "score": 0, "creation_date": 1479389145, "post_id": 40512142, "comment_id": 68543176, "body": "It throws up about 20,000 rows instead of 200 with random values spaced out throughout, it also causes a huge delay in the macro."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1478710347, "creation_date": 1478710347, "answer_id": 40512142, "question_id": 40512110, "link": "https://stackoverflow.com/questions/40512110/convert-entire-column-to-propercase/40512142#40512142", "title": "Convert Entire Column To ProperCase", "body": "<p>One line:</p>\n\n<pre><code>[B:B] = [INDEX(PROPER(B:B),)]\n</code></pre>\n\n<p>This will apply the Proper Case to the entire column at once without the need of looping.</p>\n"}], "owner": {"reputation": 1, "user_id": 7033048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W1v9a.png?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7033048/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 811, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557260107, "creation_date": 1478710260, "last_edit_date": 1531164843, "question_id": 40512110, "link": "https://stackoverflow.com/questions/40512110/convert-entire-column-to-propercase", "title": "Convert Entire Column To ProperCase", "body": "<p>So I know I can use the following code to change one cell's value to proper case in column B.</p>\n\n<pre><code>Dim Property As String\n\nProperty = ActiveSheet.range(\"B6\").Value\nProperty = StrConv(Property, vbProperCase)\n\nActiveSheet.range(\"B6\") = Property\n</code></pre>\n\n<p>What I need to do now is figure out how to apply the proper case function to the entire Column B.</p>\n\n<p>I am guessing this could be accomplished by a loop but am unsure of the correct syntax for such a loop.</p>\n"}, {"tags": ["excel", "vba", "time"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1478710614, "post_id": 40511859, "comment_id": 68266259, "body": "are you asking for example how to convert 123 to 2:03?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1478711128, "post_id": 40511859, "comment_id": 68266550, "body": "Please review <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197413.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff197413.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1478712409, "creation_date": 1478712409, "answer_id": 40512717, "question_id": 40511859, "link": "https://stackoverflow.com/questions/40511859/vba-change-the-amount-of-minutes-to-hhnn/40512717#40512717", "title": "VBA: Change the amount of minutes to hh:nn", "body": "<p>Something like this...</p>\n\n<pre><code>dim i as long\nDim MinutesElapsed As String\n\nMinutesElapsed = Format(Cells(i, 3) / 86400, \"hh:mm\")\n\nMsgBox MinutesElapsed, vbInformation\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7137343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/455494b10c7f23e137aa3d3165b1147d?s=128&d=identicon&r=PG&f=1", "display_name": "VBApros", "link": "https://stackoverflow.com/users/7137343/vbapros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478712409, "creation_date": 1478709432, "question_id": 40511859, "link": "https://stackoverflow.com/questions/40511859/vba-change-the-amount-of-minutes-to-hhnn", "title": "VBA: Change the amount of minutes to hh:nn", "body": "<p>For a VBA program, we have made two comboboxes. One for hours, one for minutes. We converted the hours into minutes. By a spinnerbutton, we can add or substract hours. We have converted them also into minutes. Now, we are seeking a way to convert the amount of minutes we have left into a messagebox with a hh:mm layout. \nAnybody who can help us out? Thanks in advance!</p>\n\n<p>--CODE---</p>\n\n<pre><code>Private Sub CalcRT_Click()\nUtcTime.Value = ((Hours.Value * 60) + Minutes.Value) + (TimeDifference.Value * 60) End Sub\n\nPrivate Sub CalculateRT_Click()\n    If UtcTime.Value &gt;= 1440 Then\n        UtcTime.Value = UtcTime.Value - 1440\n    ElseIf UtcTime.Value &lt;= 0 Then\n        UtcTime.Value = UtcTime.Value + 1440\n    End If\n    Select Case UtcTime.Value\n        Case 360 To 809\n            i = 4\n        Case 510 To 839\n            i = 5\n        Case 840 To 869\n            i = 6\n        Case 870 To 899\n            i = 7\n        Case 900 To 929\n            i = 8\n        Case 930 To 959\n            i = 9\n        Case 960 To 989\n            i = 10\n        Case 990 To 1009\n            i = 11\n        Case 1010 To 1439\n            i = 12\n        Case 0 To 299\n            i = 12\n        Case 300 To 314\n            i = 13\n        Case 315 To 329\n            i = 14\n        Case 330 To 344\n            i = 15\n        Case 345 To 359\n            i = 16\n    End Select\n    MsgBox (Cells(i, 3) = Format(CalculateRT, \"hh:nn\"))\n    '[something like this?] MsgBox (\"is \" &amp; Format(Range(\"C4\").Value, \"HH:MM\"))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "edited": false, "score": 0, "creation_date": 1478711057, "post_id": 40511777, "comment_id": 68266510, "body": "you are using a variable named <b>Name</b>, <b>cell</b> and other reserved names, and this wil lead to errors for sure. I suggest always leading your variable names with a variable identifier, like <b>i</b> if it is an integer, <b>s</b> if it is a string, etc. so that you assure they are not using reserved names."}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 3, "last_activity_date": 1478711556, "last_edit_date": 1478711556, "creation_date": 1478711220, "answer_id": 40512395, "question_id": 40511777, "link": "https://stackoverflow.com/questions/40511777/how-to-open-a-new-workbook-and-add-images-with-vba/40512395#40512395", "title": "How to open a new workbook and add images with VBA?", "body": "<p>You can't define a cell by creating the string \"C1\", that's just the address. The way you did it, <code>cell</code> is a string and a string doesn't have any properties. What you want is a range object so either use</p>\n\n<pre><code>Dim cell As Range\nSet cell = sheet.Range(\"C\" &amp; i)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim cell As Range\nSet cell = sheet.Cells(i, 3)\n</code></pre>\n\n<p>You should always <code>Dim</code> all variables, use <code>Option Explicit</code> on top of your module so you don't forget it ;)</p>\n\n<p>This will often prevent mistakes. Of course you should <code>Dim</code> them with the correct type, i.e. <code>Dim FilePath As String</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1478714195, "post_id": 40512698, "comment_id": 68268105, "body": "When will using <code>Name</code> as a variable cause an error? I agree that it shouldn&#39;t be used as a variable but as long as it&#39;s used correctly (as a string variable) it should still work?"}, {"owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1478715679, "post_id": 40512698, "comment_id": 68268851, "body": "I can tell that in excel 2016 <b>Name</b> is reserved. Using this as a variable will result in a runtime error &#39;1004&#39;."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1478772772, "post_id": 40512698, "comment_id": 68290204, "body": "Weird, I am using Excel 2016 and can use <code>Name</code> just like any other variable. I can even use something like <code>ActiveCell</code> as a string variable without causing an error (unless I try to use the actual <code>ActiveCell</code> object of course). Maybe an option I haven&#39;t set?"}, {"owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1478783626, "post_id": 40512698, "comment_id": 68297071, "body": "Try it without Dim&#39;ming Name. Instead of changing a variable you will end up changing your sheet&#180;s name :)"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1478784688, "post_id": 40512698, "comment_id": 68297717, "body": "It just creates a <code>Variant&#47;String</code> type variable for me when I don&#39;t Dim it."}], "tags": [], "owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "is_accepted": false, "score": 0, "last_activity_date": 1478712352, "creation_date": 1478712352, "answer_id": 40512698, "question_id": 40511777, "link": "https://stackoverflow.com/questions/40511777/how-to-open-a-new-workbook-and-add-images-with-vba/40512698#40512698", "title": "How to open a new workbook and add images with VBA?", "body": "<p>The correct command would be:</p>\n\n<pre><code>        Sheet.Shapes.AddPicture Filename:=F, linktofile:=msoFalse, _\n        savewithdocument:=msoCTrue, Left:=Range(cell).Left + 5, Top:=Range(cell).Top + 5, Width:=560, Height:=310\n</code></pre>\n\n<p>I strongly advise you to change your <strong>Name</strong> variable name, as it will cause errors on recent versions of excel.</p>\n"}], "owner": {"reputation": 25, "user_id": 5858874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JgIVm.jpg?s=128&g=1", "display_name": "Zeke", "link": "https://stackoverflow.com/users/5858874/zeke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 40512395, "answer_count": 2, "score": 0, "last_activity_date": 1478712352, "creation_date": 1478709134, "question_id": 40511777, "link": "https://stackoverflow.com/questions/40511777/how-to-open-a-new-workbook-and-add-images-with-vba", "title": "How to open a new workbook and add images with VBA?", "body": "<p>I'm trying to get a macro for Excel 2007to open a folder with a bunch of images in them. Then Create a new workbook and embed the images into it.</p>\n\n<p>Everything works if I comment out the line <code>Sheet.Shapes.AddPicture FileName:=F, linktofile:=msoFalse, savewithdocument:=msoCTrue, Left:=cell.Left + 5, Top:=cell.Top + 5, Width:=560, Height:=310</code> If I uncomment that line I get \"Run-time error '434': Object required\"</p>\n\n<p>I've check that Sheet.Shapes is returning a Shapes object, it is but the Shapes object is empty. When I try Sheet.Shapes,AddPicture on a workbook that is opened outside of the macro, it adds the images. I've also checked that Sheet.Shapes.AddShape works with the workbook opened in the macro, it does.</p>\n\n<p>At this point, I'm at a lose for what the issue might be. Does anyone have any experience with this sort of thing? Should I be using a different method? Thanks in advance for any help or guidance.</p>\n\n<pre><code>Sub Macro1()\nDim ImagePath, Flist\nImagePath = GetFolder()\nIf ImagePath = \"\" Then Exit Sub\nFlist = FileList(ImagePath)\nName = \"C:\\target.xlsm\"\nSet Book = Workbooks.Add\nSet Sheet = Book.Sheets(1)\nFor i = 1 To 5\n    cell = \"C\" + CStr(i)\n    F = ImagePath + \"\\\" + Flist(i - 1)\n        Sheet.Shapes.AddPicture FileName:=F, linktofile:=msoFalse, _\n            savewithdocument:=msoCTrue, Left:=cell.Left + 5, Top:=cell.Top + 5, Width:=560, Height:=310\n    Next\nBook.SaveAs FileName:=Name, FileFormat:=52\nBook.Close\nEnd Sub\n\n Function FileList(ByVal fldr As String) As Variant\n'Lists all the files in the current directory\n'Found at http://www.ozgrid.com/forum/showthread.php?t=71409\n    Dim sTemp As String, sHldr As String\n    If Right$(fldr, 1) &lt;&gt; \"\\\" Then fldr = fldr &amp; \"\\\"\n    sTemp = Dir(fldr &amp; \"*.png\")\n    If sTemp = \"\" Then\n        FileList = False\n        Exit Function\n    End If\n    Do\n        sHldr = Dir\n        If sHldr = \"\" Then Exit Do\n        sTemp = sTemp &amp; \"|\" &amp; sHldr\n    Loop\n    FileList = Split(sTemp, \"|\")\nEnd Function\n\nFunction GetFolder() As String\nFolder:\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .AllowMultiSelect = False\n    .Title = \"New Screenshot Folder\"\n    .Show\n    num = .SelectedItems.Count\n    If .SelectedItems.Count = 0 Then\n        GetFolder = \"\"\n    Else: GetFolder = .SelectedItems(1)\n    End If\nEnd With\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "role-based-access-control"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1478901664, "post_id": 40511699, "comment_id": 68351752, "body": "A login screen for un-split Access is a joke. Anyway, like all membership/role models, you need to have user table, roles table, user_vs_roles table. Finally methods to login, to logout, to assign roles, to read/verify user role against logged in user etc."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "edited": false, "score": 0, "creation_date": 1478782963, "post_id": 40514696, "comment_id": 68296674, "body": "Thanks for the reply @SunKnight0 will this be possible if I do not tie the database to the Windows/Active Directory. Based on the users role when they login with a traditional login in screen will show their various start up page. The person that will be managing the database understands the risk tied using Access, as the users are currently working in an excel sheet but would like more functionality."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "edited": false, "score": 0, "creation_date": 1479747056, "post_id": 40514696, "comment_id": 68677761, "body": "Sorry I was on vacation. You don&#39;t have to use the Windows logon but that just adds more work. In that case you have to add a logon screen in addition to managing everything else."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1478720353, "creation_date": 1478720353, "answer_id": 40514696, "question_id": 40511699, "link": "https://stackoverflow.com/questions/40511699/role-based-access-control-used-in-ms-access/40514696#40514696", "title": "Role-based access control used in MS Access", "body": "<p>You do not need a login screen if the roles are tied to your Windows/Active Directory logins. You should make the assumption that the logged on user in Windows is legitimately using the workstation (and if that is not a safe assumption you need to look into your IT policies).</p>\n\n<p>Access does not support roles and permissions. After accessing which user is currently logged on and getting their role from <code>tblUser</code> will have to:</p>\n\n<ol>\n<li>Lock down the back end and especially access to the tables.</li>\n<li>Lock down most of the user interface inherent to Access and only allow your front end forms to be used.</li>\n<li>For each form of your front end manually make sure that whatever policies you wish to enforce are enforced using VBA.</li>\n</ol>\n\n<p>Ultimately no matter what you do, somebody that knows how to use Access well can bypass any kind of lockdown you put in place. If you need to guard against more than casual curiosity and honest errors, you will need to combine Access with a much more robust DBMS like SQL server or MySQL.</p>\n"}], "owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 40514696, "answer_count": 1, "score": 0, "last_activity_date": 1478720353, "creation_date": 1478708864, "last_edit_date": 1478710813, "question_id": 40511699, "link": "https://stackoverflow.com/questions/40511699/role-based-access-control-used-in-ms-access", "title": "Role-based access control used in MS Access", "body": "<p>I am currently working on a project were one of the requirements are to use the users windows login as their login for MS Access, where they would then click there role to gain access into the system. I have never done this before but I have set up a login screen in Access which pulls data from a table. I have code that successfully pulls the users windows login but I am having trouble after this. The table name is tblUser and the users are General User, HR, and Admin. Currently, In the table I have the roles assigned number with General User = 1, HR = 2, Admin = 3.</p>\n\n<pre><code>The Login Screen:\n   Log On\nGeneral User\nHR\nAdmin\n\n\nCode that pulls the user information:\nPrivate Sub Form_Load()\nStop\n\nDebug.Print Environ(\"UserName\")\nDebug.Print Environ$(\"ComputerName\")\n\nDim strVar As String\nDim i As Long\nFor i = 1 To 255\n    strVar = Environ$(i)\n    If LenB(strVar) = 0&amp; Then Exit For\n    Debug.Print strVar\nNext\nEnd Sub\n</code></pre>\n\n<p>Below is the code that I built for my login screen in the past. Through drawing everything out it seems as though it would be the same process but I am not to sure. Is there anything that I can do to the code below?</p>\n\n<pre><code>Private Sub btnLogin_Click()\nDim rs As Recordset\n\nSet rs = CurrentDb.OpenRecordset(\"tblUser\", dbOpenSnapshot, dbReadOnly)\n\nrs.FindFirst \"UserName='\" &amp; Me.txtUserName &amp; \"'\"\n\nIf rs.NoMatch = True Then\n    Me.lblWrongUser.Visible = True\n    Me.txtUserName.SetFocus\n    Exit Sub\nEnd If\nMe.lblWrongUser.Visible = False\n\nIf rs!Password &lt;&gt; Nz(Me.txtPassword, \"\") Then\n    Me.lblWrongPass.Visible = True\n    Me.txtPassword.SetFocus\n    Exit Sub\nEnd If\nMe.lblWrongPass.Visible = False\n\nIf rs!EmployeeType_ID = 3 Then\n\n    Dim prop As Property\n    On Error GoTo SetProperty\n    Set prop = CurrentDb.CreateProperty(\"AllowBypassKey\", dbBoolean, False)\n\n    CurrentDb.Properties.Append prop\n\nSetProperty:\n    If MsgBox(\"Would you like to turn on the bypass key?\", vbYesNo, \"Allow Bypass\") = vbYes Then\n        CurrentDb.Properties(\"AllowBypassKey\") = True\n    Else\n        CurrentDb.Properties(\"AllowBypassKey\") = False\n    End If\n\nEnd If\n\nDoCmd.OpenForm \"frmPersonal_Information\"\nDoCmd.Close acForm, Me.Name\nEnd Sub\n</code></pre>\n\n<p>I hope this is enough information for what I am trying to accomplish. If anymore information is needed please let me know. Thank you.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1478709252, "post_id": 40511539, "comment_id": 68265506, "body": "<code>.Find</code> is painfully slow. Pull your range into a variant array and loop through that searching for your values and doing the concatenation you are looking for."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1478709354, "post_id": 40511539, "comment_id": 68265571, "body": "I would also recommend looking into <code>With....End With</code> to help make your code easier on the eyes."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1478710431, "post_id": 40511539, "comment_id": 68266149, "body": "I second the propositions offered by @Kyle. Performing all these tasks in memory (instead of the sheet directly) will massively improve the performance. Yet, I am sure that you will get even more helpful insights if you are willing to post this question on the correct site: <a href=\"http://codereview.stackexchange.com/\">code review</a> is essentially the site where they help you improve working / existing code in terms of speed, security, maintainability, and longevity."}], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1478789786, "post_id": 40517302, "comment_id": 68301060, "body": "Thanks @Den Temple, the function OptimizeVBA True turns off all the settings which would slow down Excel. In terms of the array, there would still be ~1600 values in the array, what I did instead is I created a dummy sheet and copied the two columns with the identifying features and did a delete duplicates between the cells, crude but fast. Thanks for the code!"}], "tags": [], "owner": {"reputation": 725, "user_id": 6946054, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126539580715735/picture?type=large", "display_name": "Denny S. Temple", "link": "https://stackoverflow.com/users/6946054/denny-s-temple"}, "is_accepted": false, "score": 2, "last_activity_date": 1478732423, "last_edit_date": 1525816150, "creation_date": 1478731740, "answer_id": 40517302, "question_id": 40511539, "link": "https://stackoverflow.com/questions/40511539/find-vba-running-slowly/40517302#40517302", "title": ".find vba running slowly", "body": "<p>A common suggestion for performing operations on excel sheets is to deactivate certain settings programmatically while executing your code.</p>\n\n<p>Here's a little snippet that I use in many of my projects:</p>\n\n<pre><code>Public Sub ExcelDefaultSettings(ByVal isActive As Boolean)\n\n    With Application\n        .ScreenUpdating = isActive\n        .DisplayAlerts = isActive\n        If isActive Then\n            .Calculation = xlCalculationAutomatic\n        Else\n            .Calculation = xlCalculationManual\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>And then you would just make these two calls before and after your execution:</p>\n\n<pre><code>ExcelDefaultSettings isActive:=False  'Before\n\nExcelDefaultSettings isActive:=True  'After\n</code></pre>\n\n<p>It's not a perfect solution, but it can help tremendously on larger projects.</p>\n\n<p>As @Kyle and @Ralph have said, refactoring your code may also help with improving your execution speed.</p>\n\n<p>Another common piece of advice is to 1) transpose the contents of your range into an array, 2) perform your operations only on the array, and then 3) transpose the array back into your range.</p>\n\n<p>This is a bit more involved than adding a bit of code, but a pretty good explanation about it can be found <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>This is the example they give for a basic loop:</p>\n\n<pre><code>Dim Arr() As Variant\nArr = Range(\"A1:B10\")\nDim R As Long\nDim C As Long\nFor R = 1 To UBound(Arr, 1) ' First array dimension is rows.\n    For C = 1 To UBound(Arr, 2) ' Second array dimension is columns.\n        Debug.Print Arr(R, C)\n    Next C\nNext R\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478732423, "creation_date": 1478708357, "last_edit_date": 1478712355, "question_id": 40511539, "link": "https://stackoverflow.com/questions/40511539/find-vba-running-slowly", "title": ".find vba running slowly", "body": "<p>Basically I need to loop through 1,566 rows and do a .find for each row and compare with 10,691 lines. The thing is, I am concatenating three values together in order to get my search value. It is working very slowly, so I tried to filter by the first value on the 10,691 so it would work more quickly - but no joy! I am using a few functions, letter retrieves the letter of the column. </p>\n\n<pre><code>Option Explicit\n\nSub validate()\nDim gbe As Worksheet, mp As Worksheet, PnS As Worksheet\nDim rng As Range, Frng As Range\nDim ITC, TT, BC, y, GCell, sz, t, vList\n\nt = Timer\nOptimizeVBA True\nShDel (\"Garbage\"): Sheets.Add.name = \"Garbage\": Set gbe = Sheets(\"Garbage\"): Set mp = Sheets(\"Master\"): Set PnS = Sheets(\"PS\")\n\n\n    ITC = Letter(PnS, \"Code\"): TT = Letter(PnS, \"Type\"): BC = Letter(PnS, \"BCode\")\n    mp.Range(\"M2:O\" &amp; mp.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row).ClearContents\n    PnS.Range((ITC &amp; \":\" &amp; ITC &amp; \",\" &amp; TT &amp; \":\" &amp; TT &amp; \",\" &amp; BC &amp; \":\" &amp; BC)).Copy Destination:=gbe.Range(\"A1\")\n    gbe.Range(\"$A$1:$C$\" &amp; PnS.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row).RemoveDuplicates Columns:=Array(1, 2, 3), _\n        Header:=xlYes\n\n        gbe.Range(\"A1:C\" &amp; gbe.Range(\"A1\").End(xlDown).Row).AutoFilter\n        gbe.Range(\"A1:C\" &amp; gbe.Range(\"A1\").End(xlDown).Row).AutoFilter Field:=1, Criteria1:=\"='\", _\n            Operator:=xlOr, Criteria2:=\"='FC\"\n        gbe.rows(\"2:\" &amp; gbe.Range(\"A1\").End(xlDown).Row).EntireRow.Delete\n        gbe.Range(\"A1:C\" &amp; gbe.Range(\"A1\").End(xlDown).Row).AutoFilter\n\n        Set rng = gbe.Range(\"A2:A\" &amp; gbe.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row)\n        For Each y In rng\n        mp.Range(\"A1:K\" &amp; gbe.Range(\"A1\").End(xlDown).Row).AutoFilter Field:=3, Criteria1:=\"=\" &amp; y\n        With mp.Range(\"A2:A\" &amp; mp.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row).SpecialCells(xlCellTypeVisible)\n        Set GCell = .Find(What:=sz, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=True)\n            If GCell Is Nothing Then\n                mp.Range(\"O100000\").End(xlUp) = PnS.Range(ITC &amp; y.Row)\n                mp.Range(\"O100000\").End(xlUp).Offset(0, 1) = PnS.Range(TT &amp; y.Row)\n                mp.Range(\"O100000\").End(xlUp).Offset(0, 2) = PnS.Range(BC &amp; y.Row)\n            End If\n            Set GCell = Nothing\n            mp.ShowAllData\n        End With\n\n        Next y\n\n    ShDel (\"Garbage\")\n\nOptimizeVBA False\nMsgBox Timer - t\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "odbc"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478706233, "post_id": 40510761, "comment_id": 68263596, "body": "is strVal6  a dupe for A3000:A3500?  It may be too long, try just 4,5,6 <a href=\"https://ask.sqlservercentral.com/questions/50819/too-long-sql-in-excel-vba.html\" rel=\"nofollow noreferrer\" title=\"too long sql in excel vba.html\">ask.sqlservercentral.com/questions/50819/&hellip;</a>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478708345, "post_id": 40510761, "comment_id": 68264963, "body": "Can you place on line 56 of your code <code>MsgBox Len(strSQL &amp; strVal1 &amp; strVal2 &amp; strVal3 &amp; strVal4 &amp; strVal5)</code> and review the query string length? As per @Nathan_Sav &#39;s link provided query string length limit is 32767 characters."}, {"owner": {"reputation": 11, "user_id": 6488751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688fb03ec435d5f74ec63c6682d4205c?s=128&d=identicon&r=PG&f=1", "display_name": "Adomas Lingevicius", "link": "https://stackoverflow.com/users/6488751/adomas-lingevicius"}, "edited": false, "score": 0, "creation_date": 1480888404, "post_id": 40510761, "comment_id": 69137616, "body": "Thanks for the answers! However, I did a more straightforward solution, I just added another joined one more table from the DB and added a variable in that table by which I could query the data without using the client ID."}], "owner": {"reputation": 11, "user_id": 6488751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688fb03ec435d5f74ec63c6682d4205c?s=128&d=identicon&r=PG&f=1", "display_name": "Adomas Lingevicius", "link": "https://stackoverflow.com/users/6488751/adomas-lingevicius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478706002, "creation_date": 1478706002, "question_id": 40510761, "link": "https://stackoverflow.com/questions/40510761/cant-change-command-text-in-a-query-excel-vba", "title": "Can&#39;t change command text in a query (Excel VBA)", "body": "<p>So, down below you see my code, it's a bit modified version of a code I found here, can't find the source now...</p>\n\n<p>The error I get is Run-time 1004, and I can't figure out why it doesn't work.</p>\n\n<p>It works if I use variables up to strVal3 (See .CommandText line).</p>\n\n<p>Any help/suggestions are highly appreciated.</p>\n\n<pre><code>Sub valandinai()\n\nDim strVal1 As String\nDim strVal2 As String\nDim strVal3 As String\nDim strVal4 As String\nDim strVal5 As String\n\nDim strSQL As String\n\n'assume the list of values you want in the IN() statement in the sql is held in cells A1:A100 of sheet \"MyValues\" (obviously amend as appropriate)\n'create the delimited list of values from sheet myValues and range A1:A100:\n\nstrVal1 = \"('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A1:A999\").Value), \"','\") &amp; \"')\"\nstrVal2 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A1000:A1999\").Value), \"','\") &amp; \"')\"\nstrVal3 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A2000:A2500\").Value), \"','\") &amp; \"')\"\nstrVal4 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A2501:A2999\").Value), \"','\") &amp; \"')\"\nstrVal5 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A3000:A3500\").Value), \"','\") &amp; \"')\"\nstrVal6 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A3000:A3500\").Value), \"','\") &amp; \"')\"\nstrVal7 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A3501:A3999\").Value), \"','\") &amp; \"')\"\nstrVal8 = vbNewLine &amp; \"or kl.klnt_im_kodas in ('\" &amp; Join(Application.Transpose(Sheets(\"Sheet4\").Range(\"A4000:A4411\").Value), \"','\") &amp; \"')\"\n\n'============             IMPORTANT          =============================\n'note that if you had a horizontal list of values, you need to use Application.Transpose twice:\n'strVal = \"'\" &amp; Join(Application.Transpose(Application.Transpose(Sheets(\"MyValues\").Range(\"A1:A100\").Value)), \"','\") &amp; \"'\"\n\nThisWorkbook.Sheets(\"Sheet4\").Range(\"h1\").Value = strVal1\nThisWorkbook.Sheets(\"Sheet4\").Range(\"h2\").Value = strVal2\nThisWorkbook.Sheets(\"Sheet4\").Range(\"h3\").Value = strVal3\nThisWorkbook.Sheets(\"Sheet4\").Range(\"h4\").Value = strVal4\nThisWorkbook.Sheets(\"Sheet4\").Range(\"h5\").Value = strVal5\n\n\n'this is your current SQL statement as a string and we insert the values at the 'strVal' placeholder:\n\nstrSQL = \"Select kl.klnt_im_kodas, Kl.Klnt_Pavadinimas, Su.Str_Id, Su.Str_Numeris,\" &amp; vbNewLine &amp; _\n\"--Ob.Obj_Id,\" &amp; vbNewLine &amp; _\n\"ob.obj_nr,\" &amp; vbNewLine &amp; _\n\"ob.obj_adresas,\" &amp; vbNewLine &amp; _\n\"Trim(To_Char(Vs.Ovs_ltu_Laikas, 'YYYY mm')) As menuo ,\" &amp; vbNewLine &amp; _\n\"Trim(To_Char(Vs.Ovs_ltu_Laikas, 'YYYY mm dd'))As Laikas ,\" &amp; vbNewLine &amp; _\n\"To_Char(Vs.Ovs_ltu_Laikas, 'D') As Sav_diena,\" &amp; vbNewLine &amp; _\n\"Trim(To_Char(Vs.Ovs_ltu_Laikas, 'hh24:mi'))As Valanda,\" &amp; vbNewLine &amp; _\n\"Vs.ovs_kiekis\" &amp; vbNewLine &amp; _\n\"From Eta_Obj_Val_Suvart Vs\" &amp; vbNewLine &amp; _\n\"Left Join Eta_Objektai Ob On Vs.Ovs_Obj_Id=Ob.Obj_Id\" &amp; vbNewLine &amp; _\n\"Left Join Eta_Sutartys Su On Ob.Obj_Str_Id=Su.Str_Id\" &amp; vbNewLine &amp; _\n\"left join eta_klientai kl on su.str_klnt_id=kl.klnt_id\" &amp; vbNewLine &amp; _\n\"Where 1 = 1\" &amp; vbNewLine &amp; _\n\"--And Vs.Ovs_Laikas&gt;='2015.10.01'\" &amp; vbNewLine &amp; _\n\"And Vs.Ovs_ltu_Laikas&gt;=Add_Months(Trunc(Sysdate,'MM'),-12)\" &amp; vbNewLine &amp; _\n\"and kl.klnt_im_kodas in\" &amp; vbNewLine\n\nThisWorkbook.Sheets(\"Sheet1\").Range(\"A2\").Value = strVal1\nThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\").Value = strSQL\n\n' Now use the strSQL in connection info (do NOT use the Array function to assign it though):\n    With ActiveWorkbook.Connections(\"Connection\").ODBCConnection\n        .BackgroundQuery = True\n        .CommandText = strSQL &amp; strVal1 &amp; strVal2 &amp; strVal3 &amp; strVal4 &amp; strVal5\n        .CommandType = xlCmdSql\n        .Connection = \"connection string\"\n        .RefreshOnFileOpen = False\n        .SavePassword = True\n        .SourceConnectionFile = \"\"\n        '.SourceDataFile = \"\"\n        .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n        .AlwaysUseConnectionFile = False\n    End With\n    ActiveWorkbook.Connections(\"Connection\").Delete\n    With ActiveWorkbook.Connections(\"Connection1\")\n        .Name = \"Connection\"\n        .Description = \"\"\n    End With\n    'ActiveWorkbook.Connections(\"Connection\").Refresh\n\n    MsgBox \"Done\", vbInformation, \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 7036483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1c6301832addd7fcbf5298f03972e4?s=128&d=identicon&r=PG&f=1", "display_name": "Silverarcheress", "link": "https://stackoverflow.com/users/7036483/silverarcheress"}, "is_accepted": false, "score": 0, "last_activity_date": 1478793436, "creation_date": 1478793436, "answer_id": 40531809, "question_id": 40510638, "link": "https://stackoverflow.com/questions/40510638/excel-automatically-update-unshared-pivottables-without-ungrouping-fields/40531809#40531809", "title": "Excel: Automatically update unshared PivotTables without ungrouping fields", "body": "<p>One thing you can do is to record a macro that groups the data into the format that you want. Then copy the macro section that groups the selection after each pivot table refresh command. So essentially you refresh and regroup each time. </p>\n\n<p>A link that shows how you can use VBA to group pivot table data is <a href=\"http://www.ozgrid.com/forum/showthread.php?t=55370\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=55370</a> </p>\n\n<p>I hope this helps</p>\n"}], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478793436, "creation_date": 1478705609, "question_id": 40510638, "link": "https://stackoverflow.com/questions/40510638/excel-automatically-update-unshared-pivottables-without-ungrouping-fields", "title": "Excel: Automatically update unshared PivotTables without ungrouping fields", "body": "<p>I have some very simple code to automatically refresh my pivot tables when the data source is updated:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nSheet2.PivotTables(\"PivotTable1\").PivotCache.Refresh\nSheet3.PivotTables(\"PivotTable2\").PivotCache.Refresh\nSheet4.PivotTables(\"PivotTable3\").PivotCache.Refresh\n\nEnd Sub\n</code></pre>\n\n<p>Whenever it refreshes, my fields ungroup. For example one is in months the other is in weeks, etc. but when it refreshes they all ungroup and show each individual date. Any ideas?</p>\n"}, {"tags": ["excel", "error-handling", "vba"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 2, "creation_date": 1478706169, "post_id": 40510259, "comment_id": 68263549, "body": "You can&#39;t control the indentation of labels in Excel. It is defaulted and fixed on the left. The reason for that is to make them easier to spot"}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1478707188, "post_id": 40510259, "comment_id": 68264231, "body": "I see @Victor Moraes. Is there any way to circumvent this?"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1478708112, "post_id": 40510259, "comment_id": 68264826, "body": "I honestly don&#39;t know, but may I ask why would you want to do that, other than &quot;I think it&#39;s prettier that way&quot;?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1478708742, "post_id": 40510259, "comment_id": 68265217, "body": "<i>&quot;Circumvent&quot;</i>... Rewrite to handle the errors another way without <code>Goto</code> statements."}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1478713560, "post_id": 40510259, "comment_id": 68267796, "body": "That&#39;s really the only reason @Victor Moraes, that&#39;s why I said it was a &quot;<i>fussy question</i>&quot;. Ok, thanks."}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1478721018, "post_id": 40510259, "comment_id": 68271403, "body": "I agree with @PortlandRunner on this one. Avoid the usage of <code>GoTo</code> is the best advice here :)"}, {"owner": {"reputation": 1641, "user_id": 1232660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3843a2bbd046589aeba450315a996d8d?s=128&d=identicon&r=PG", "display_name": "Jeyekomon", "link": "https://stackoverflow.com/users/1232660/jeyekomon"}, "edited": false, "score": 0, "creation_date": 1556268860, "post_id": 40510259, "comment_id": 98388298, "body": "Not a fussy question at all. It is a major pain when the IDE makes decisions and you have to obey."}], "answers": [{"comments": [{"owner": {"reputation": 2081, "user_id": 2426679, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ae42083756ea100bc8b06658725b4493?s=128&d=identicon&r=PG", "display_name": "user2426679", "link": "https://stackoverflow.com/users/2426679/user2426679"}, "edited": false, "score": 0, "creation_date": 1538196114, "post_id": 40528988, "comment_id": 92068176, "body": "This will not work: <code>Err.Number</code> gets reset after <code>On Error GoTo 0</code>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 2081, "user_id": 2426679, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ae42083756ea100bc8b06658725b4493?s=128&d=identicon&r=PG", "display_name": "user2426679", "link": "https://stackoverflow.com/users/2426679/user2426679"}, "edited": false, "score": 0, "creation_date": 1538296432, "post_id": 40528988, "comment_id": 92087638, "body": "@user2426679  Thanks for the heads-up.  Do you think my edit adequately corrects my error?"}, {"owner": {"reputation": 2081, "user_id": 2426679, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ae42083756ea100bc8b06658725b4493?s=128&d=identicon&r=PG", "display_name": "user2426679", "link": "https://stackoverflow.com/users/2426679/user2426679"}, "edited": false, "score": 0, "creation_date": 1538337101, "post_id": 40528988, "comment_id": 92098303, "body": "<i>yes</i>, but I generally detest VBA&#39;s error handling (lack thereof), because (1) MS documentation is hardly comprehensive enough to know all of the error numbers, which is why you have to resort to the &quot;number discovery&quot; that you did above, and (2) this forces one into a position where the code usually becomes equivalent to <code>try ... catch(all)</code>, which you&#39;d <i>never</i> do in another language.  Because of this, I opt to put no more than a single line of code in between an <code>On Error GoTo myHandler</code> and an <code>On Error GoTo 0</code>; I just have to be 100% confident in the erroring line between those."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 2081, "user_id": 2426679, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ae42083756ea100bc8b06658725b4493?s=128&d=identicon&r=PG", "display_name": "user2426679", "link": "https://stackoverflow.com/users/2426679/user2426679"}, "edited": false, "score": 0, "creation_date": 1538340302, "post_id": 40528988, "comment_id": 92099074, "body": "@user2426679  I agree, VBA&#39;s error handling is clumsy and I test for as many possible errors as I can to avoid needing  it.  Like you I only test one statement at a time when I have no choice but to include it.."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1538253376, "last_edit_date": 1538253376, "creation_date": 1478784944, "answer_id": 40528988, "question_id": 40510259, "link": "https://stackoverflow.com/questions/40510259/indentation-of-error-handler-in-excel-vba/40528988#40528988", "title": "Indentation of Error Handler in Excel VBA", "body": "<p><strong>Edit</strong>  There was a careless mistake in the original code.  Thank you  user2426679 for giving me the opportunity to fix it.</p>\n\n<p><strong>Original post</strong></p>\n\n<p>Code that uses <code>GoTo Label</code> can be a nightmare to understand and get error free.  The only situation I know off in which <code>GoTo Label</code> might be appropriate is a fatal error exit where there is no intention to return.  Jumping out of an error and trying to jump back is very difficult to get right and very difficult to understand when you return to it in a few months.</p>\n\n<p>Is there more than one statement in your code that can throw an error?  If so, how does the error handler know which error it is handling?</p>\n\n<p>I favour:</p>\n\n<pre><code>On Error Resume Next                ' Suspend normal error handling\nStatement that might throw an error\nOn Error GoTo 0                     ' Restore normal error handling\nIf Err.Number &lt;&gt; 0 then\n  ' Code to handle error\nEnd If\n</code></pre>\n\n<p>The value of <code>Err.Number</code> and <code>Err.Description</code> will tell what the error is and allow to write specific error handling code.</p>\n\n<p>Some argue that taking error handling out of the main code keeps the main code clean.  There is some merit in this argument.  If there are dozens of potential errors, the analysis can become complicated and make the normal path difficult to isolate. But, in my experience, this is very unusual.  Perhaps, you have a list of files some of which might not open.  There are lots of reasons why a file does open but your code can do nothing about them.  All it can do is display <code>Err.Description</code> and move onto the next file.</p>\n\n<p><strong>New text and code</strong></p>\n\n<p>Apart from the mistake in the code there is nothing in my original post that I now consider incorrect.  However, I do not think the original post was as complete as it should be.</p>\n\n<p>If you search for \u201cVBA Err.Number\u201d you will find sites that list VBA\u2019s error handling codes.  Since these sites come and go, I will not recommend my favourite.  However, I try to generate errors to see what happens.  Consider this code:</p>\n\n<pre><code>Option Explicit\nSub DemoErrorHandling()\n\n  Dim ErrDesc As String\n  Dim ErrNum As Long\n  Dim FileNum As Long\n  Dim PathFile As Variant\n\n  FileNum = FreeFile\n\n  For Each PathFile In Array(\"\", \"X:\", \"C:\\Program Files\\Common Files\\Intel\\\" &amp; _\n                             \"WirelessCommon\\libeay32.dll\")\n\n    On Error Resume Next\n    Open PathFile For Input As FileNum\n    ErrNum = Err.Number\n    ErrDesc = Err.Description\n    Close FileNum\n    On Error GoTo 0\n    Debug.Print \"\"\"\" &amp; PathFile &amp; \"\"\" gives error:\"\n    Debug.Print \"  A \" &amp; Err.Number &amp; \" \" &amp; Err.Description\n    Debug.Print \"  B \" &amp; ErrNum &amp; \" \" &amp; ErrDesc\n\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>Which, on my system, outputs:</p>\n\n<pre><code>\"\" gives error:\n  A 0 \n  B 75 Path/File access error\n\"X:\" gives error:\n  A 0 \n  B 76 Path not found\n\"C:\\Program Files\\Common Files\\Intel\\WirelessCommon\\libeay32.dll\" gives error:\n  A 0 \n  B 0 \n</code></pre>\n\n<p>Note, as user2426679 pointed out, <code>On Error GoTo 0</code>has cleared <code>Err.Number</code> and <code>Err.Description</code>.  Only by saving these values in variables are they available for testing.  Note, attempting to open an empty file name and a non-existent disc give different errors.</p>\n\n<p>My code demonstrates that you can loop trying different files until one opens successfully.  You could keep asking the user for a file until one opened without an error.</p>\n"}], "owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1538253376, "creation_date": 1478704444, "last_edit_date": 1531164843, "question_id": 40510259, "link": "https://stackoverflow.com/questions/40510259/indentation-of-error-handler-in-excel-vba", "title": "Indentation of Error Handler in Excel VBA", "body": "<p>This is a very fussy question: I am inserting an Error Handler in a <code>For To</code> loop in Excel VBA; I want the content of the loop indented, such that:</p>\n\n<pre><code>For i = 0 to n\n    On Error GoTo ErrorHandler:\n        '~~&gt; code here\n    ErrorHandler:\n        '~~&gt; code here\n        Resume NextLoop\n    NextLoop:\nNext\n</code></pre>\n\n<p>However, Excel VBA automatically cancels indentation of Error Handlers:</p>\n\n<pre><code>For i = 0 to n\n    On Error GoTo ErrorHandler:\n        '~~&gt; code here\nErrorHandler:\n        '~~&gt; code here\n        Resume NextLoop\nNextLoop:\nNext\n</code></pre>\n\n<p>I have tried to unselect option \"Auto Indent\" in \"Tools\" > \"Options\" > \"Editor\" but this hasn't worked.</p>\n\n<p><strong>How can I avoid this?</strong></p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1478701209, "post_id": 40509099, "comment_id": 68260304, "body": "You can loop from the bottom of your range assigning the values row by row that meet your criteria.  You can filter the range then copy and paste the visible cells."}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478701621, "post_id": 40509099, "comment_id": 68260542, "body": "ideally I was looking to have it worked into this code only because I wanted it to be seamless for the user just to click a button and it to just Copy And Paste the Orders they have put a QTY Next to."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478701711, "post_id": 40509099, "comment_id": 68260590, "body": "@ScottCraner: why &quot;from the bottom of the range&quot;? I&#39;m asking just because I&#39;m curious and your expertise is beyond doubt."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 1, "creation_date": 1478701771, "post_id": 40509099, "comment_id": 68260632, "body": "Actually, I was thinking of deleting.  It can go either way for copy.  My bad @CMArg"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1478702175, "post_id": 40509099, "comment_id": 68260884, "body": "sorry I am new to VBA but how would I put that into the code ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478702498, "post_id": 40509099, "comment_id": 68261062, "body": "@blood_milk_sky google is your friend.  google each step and try to piece it together.  Then come back with your attempts and tell us what is not working.  Stack Overflow is not a code for me site."}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1479485559, "post_id": 40509099, "comment_id": 68593263, "body": "Hi @ScottCraner I have gone away and have acquired the above but for some reason it is only copying and pasting the first row of the range that is required even though other rows have qtys greater than &quot;0&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 7002050, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Gv7r0.jpg?s=128&g=1", "display_name": "gioxc88", "link": "https://stackoverflow.com/users/7002050/gioxc88"}, "is_accepted": false, "score": 1, "last_activity_date": 1478702661, "creation_date": 1478702661, "answer_id": 40509658, "question_id": 40509099, "link": "https://stackoverflow.com/questions/40509099/copy-paste-when-range-meets-criteria/40509658#40509658", "title": "Copy &amp; Paste when range meets criteria", "body": "<pre><code>dim i as Long\n\nfor i = 7 to 68 \n    If Sheets(\"Menu\").Range(\"D\" &amp; i).Value &gt; 0 Then\n        Sheets(\"Menu\").Range(\"B\" &amp; i &amp; \":D\" &amp; i).Copy\n        Sheets(\"LensOrder\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1,0).PasteSpecial (xlPasteValues)\n    End If \nNext i\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479485482, "creation_date": 1478701018, "last_edit_date": 1531164843, "question_id": 40509099, "link": "https://stackoverflow.com/questions/40509099/copy-paste-when-range-meets-criteria", "title": "Copy &amp; Paste when range meets criteria", "body": "<p>I was just wondering if anyone would know how I can amend the below code so that it will only copy rows where the value in column D exceeds a Value of 0</p>\n\n<pre><code>    Sub ADDTOORDERS()\nDim Sh As Worksheet, C As Worksheet, Last As Long\nSet Sh = Sheets(\"Menu\")\nSet C = Sheets(\"LensOrder\")\nWith Sh\nLast = .Cells(Rows.Count, 2).End(xlUp).Row\n    .Range(\"B7:D\" &amp; Last).AutoFilter Field:=2, Criteria1:=\"&gt;0\", Operator:=xlAnd\n    .Range(\"B7:D\" &amp; Last).SpecialCells(xlCellTypeVisible).Copy\n    C.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n    Sheets(\"Menu\").Range(\"C3\").Select\n   .Range(\"B7:D\" &amp; Last).AutoFilter\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ado"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478703558, "post_id": 40509058, "comment_id": 68261766, "body": "I am guessing that the above line of code is part of a larger VBA macro which is designed to return a recordset. Afterwards, the result of the recordset is pasted to a sheet using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839240.aspx\" rel=\"nofollow noreferrer\">CopyFromRecordset</a> (or something similar). If I am guessing correctly then you should change this line of code (where you are pasting the result) and not the query above."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478703992, "post_id": 40509058, "comment_id": 68262055, "body": "@Ralph, no I am using ADO from o/s the workbook.  ADO is being used to stop having to open the full workbook each time"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478704325, "post_id": 40509058, "comment_id": 68262280, "body": "Not sure if <code>Jet OLE DB</code> supports &quot;select into&quot;. Have you tried using the syntax proposed here: <a href=\"https://support.microsoft.com/en-us/kb/278973\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/278973</a> which would be something like <code>[newSheetName$A10:B20]</code> (of course the new sheet must exist already)?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478704395, "post_id": 40509058, "comment_id": 68262318, "body": "Yes, I get the error This table contains cells that are outside the range of cells defined in this spreadsheet.  It supports with out the cell reference, but in A1"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478704776, "post_id": 40509058, "comment_id": 68262563, "body": "Unfortunately, I don&#39;t have any experience with that (using SELECT INTO with closed Excel files). Hence, my suggestions are limited. The above referenced article (by Microsoft) suggests that it ought to be possible using their provided syntax. Did you have a look at this (somewhat strange) work-around to solve this problem: <a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-35680.html\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/archive/index.php/t-35680.html</a> Maybe it can help. Other than that I hope someone else here can provide further insights."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478705437, "post_id": 40509058, "comment_id": 68263032, "body": "That solution involves a named table or range, where as the select into is creating a new tab, so I don&#39;t have that, I have the longer option of using INSERT INTO from a table created using CREATE TABLE or just to query the empty range into a recordset then put the values into it and update, was just being hopeful, there would be a solution.  I tried to use some data with an empty column and it substituted F1 into its place, so think it has to have headers.  Unless anyone can help/confirm.  Thanks Ralph"}], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478700896, "creation_date": 1478700896, "question_id": 40509058, "link": "https://stackoverflow.com/questions/40509058/select-into-range-excel", "title": "Select INTO range Excel", "body": "<p>I have recently been using ADO to move data between a database and Excel using ADO, this all works as expected, however, for the first time, the data isn't of a \"standard\"  format, where I have run information, file paths etc, input information, the arguments used and then the output, what's out after the macro in excel is run.  The purpose of the ADO is to say, I have a sheet HSBC_Stock_0% and I want to model it at 1.5% then everything would be the same, except the value of 1.5% in the run info, it would then create the new sheet as HSBC_Stock_1.5% ready for me to model next time I am in.</p>\n\n<p>I have everything working as I'd like data wise, however, there is a 7 row company header that has to go in, so I'd like to do the SELECT INTO, but to a specific range, is this possible?</p>\n\n<p><code>strSQL = \"Select * into [\" &amp; strNewTabName &amp; \"] FROM [Sheet1$]\"</code></p>\n\n<p>is an example of how I am tacking the creation of the new tab, I'd like to create this in a10:b20 for example.  I am suspecting that the \"table\" from excel is required to not contain blank header cells.</p>\n"}, {"tags": ["c#", "vba", "ms-word", "vsto", "word-2013"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1478701870, "post_id": 40508937, "comment_id": 68260684, "body": "This is likely related to the document in question and not a general issue. It might be that there is an issue with a particular formatting or Word feature being used in the document. You can try to narrow things down be removing things from the document until the macro works."}, {"owner": {"reputation": 314, "user_id": 4889150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42690a42dbab4128f423d2677b6c9d45?s=128&d=identicon&r=PG", "display_name": "Ivan Rubanau", "link": "https://stackoverflow.com/users/4889150/ivan-rubanau"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1478702375, "post_id": 40508937, "comment_id": 68260992, "body": "Thanks for idea, but I just tried to do it with a new empty document and It crashed either."}], "answers": [{"comments": [{"owner": {"reputation": 314, "user_id": 4889150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42690a42dbab4128f423d2677b6c9d45?s=128&d=identicon&r=PG", "display_name": "Ivan Rubanau", "link": "https://stackoverflow.com/users/4889150/ivan-rubanau"}, "edited": false, "score": 0, "creation_date": 1484292830, "post_id": 41602661, "comment_id": 70459090, "body": "Yes, you are right. I went for option 1 lots time ago."}], "tags": [], "owner": {"reputation": 46, "user_id": 7407126, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d22c2044ccd4e87b0ead9512fb35df8f?s=128&d=identicon&r=PG", "display_name": "Thach", "link": "https://stackoverflow.com/users/7407126/thach"}, "is_accepted": true, "score": 3, "last_activity_date": 1484182169, "last_edit_date": 1484182169, "creation_date": 1484177230, "answer_id": 41602661, "question_id": 40508937, "link": "https://stackoverflow.com/questions/40508937/word-2013-crash-on-find-execute/41602661#41602661", "title": "Word 2013 Crash on Find.Execute", "body": "<p>It's some issue with Word when you have an empty custom undo and do a replace all. I just ran into this issue today.</p>\n\n<p><a href=\"https://devwrench.wordpress.com/2016/08/19/fix-word-vba-crash-wdreplaceall/\" rel=\"nofollow noreferrer\">This page</a> explains it well.</p>\n\n<p>Options</p>\n\n<ol>\n<li>Replace one, then replace all</li>\n<li>Workaround by making a change to the doc before replace all, then\nundoing that change</li>\n<li>remove the custom undo</li>\n</ol>\n"}], "owner": {"reputation": 314, "user_id": 4889150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42690a42dbab4128f423d2677b6c9d45?s=128&d=identicon&r=PG", "display_name": "Ivan Rubanau", "link": "https://stackoverflow.com/users/4889150/ivan-rubanau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 41602661, "answer_count": 1, "score": 1, "last_activity_date": 1484182169, "creation_date": 1478700491, "question_id": 40508937, "link": "https://stackoverflow.com/questions/40508937/word-2013-crash-on-find-execute", "title": "Word 2013 Crash on Find.Execute", "body": "<p>I'm using VSTO ThisAddIn and Word 2013.</p>\n\n<p>I want to replace all occurences of the one string with another using <code>Find.Execute</code> and mark this action with custom undo message. The code is:</p>\n\n<pre><code>application.UndoRecord.StartCustomRecord(\"Some Message\");\n\nvar find = application.ActiveDocument.Content.Find;\nfind.Execute(\"string to be replaced\"\n  , ReplaceWith: \"second string\"\n  , Replace: WdReplace.wdReplaceAll);\n\napplication.EndCustomRecord();\n</code></pre>\n\n<p>So I have a Word Crash during this code run. If I change <code>Replace: WdReplace.wdReplaceAll</code> to <code>Replace: WdReplace.wdReplaceOne</code>, I'll have word working, but I need to replace all occurrences.</p>\n\n<p>Any suggestions/workarounds?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "row", "refresh"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478704748, "post_id": 40508845, "comment_id": 68262544, "body": "I think if you turn off run as background query , your code will naturally wait"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478705070, "post_id": 40508845, "comment_id": 68262758, "body": "Also, you can just take the <code>databodyrange</code> from the <code>listobject</code> to an array"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7136353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e9e66624df4121bb808c8f8dc0d3bf7?s=128&d=identicon&r=PG&f=1", "display_name": "odracir01", "link": "https://stackoverflow.com/users/7136353/odracir01"}, "edited": false, "score": 0, "creation_date": 1478706761, "post_id": 40510498, "comment_id": 68263909, "body": "It worked perfectly!  Did a test, and turning off the background query was indeed the missing part.  Many thanks!"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1478705167, "creation_date": 1478705167, "answer_id": 40510498, "question_id": 40508845, "link": "https://stackoverflow.com/questions/40508845/excel-access-vba-cant-get-last-used-row-because-of-query-refresh/40510498#40510498", "title": "Excel/Access VBA - Cant get last used row because of query refresh", "body": "<p>This may be a start</p>\n\n<pre><code>Sub x()\n\n    Dim l As ListObject\n\n    Set l = ActiveSheet.ListObjects(1)\n\n    l.QueryTable.BackgroundQuery = False\n\n    Debug.Print l.ListRows.Count\n    l.Refresh\n    Debug.Print l.ListRows.Count\n\n    varray = l.DataBodyRange.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7136353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e9e66624df4121bb808c8f8dc0d3bf7?s=128&d=identicon&r=PG&f=1", "display_name": "odracir01", "link": "https://stackoverflow.com/users/7136353/odracir01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 40510498, "answer_count": 1, "score": 1, "last_activity_date": 1593957701, "creation_date": 1478700218, "last_edit_date": 1593957701, "question_id": 40508845, "link": "https://stackoverflow.com/questions/40508845/excel-access-vba-cant-get-last-used-row-because-of-query-refresh", "title": "Excel/Access VBA - Cant get last used row because of query refresh", "body": "<p>I'm refreshing a query on Access and looping over the table, but the loop overruns the refresh - so I dont get the correct last row.</p>\n\n<p>After refreshing, <strong>a</strong> should equal 2746, but it's returning 1478 which is the last row before refreshing.</p>\n\n<pre><code>vPath = ThisWorkbook.Sheets(vHome).Range(\"LogTblFolder\")\nvFile = ThisWorkbook.Sheets(vHome).Range(\"LogTblFile\")\n    Set wb = Workbooks.Open(vPath &amp; vFile)\n\n        Sheets(\"Main\").Select\n        ActiveWorkbook.Connections(\"CTA_DB_Full3\").Refresh\n        ActiveWorkbook.Connections(\"CTA_DB_Full3\").Refresh\n\n            Call WaitForRefresh(1)\n            a = 1:Do Until Sheets(\"Main\").Cells(a, 1).Value2 = \"\":a = a + 1:Loop\n                  vArray = Sheets(\"Main\").Range(Cells(2, 1), Cells(a, 94))\n\n    wb.Close False\n</code></pre>\n\n<hr>\n\n<pre><code>Public Function WaitForRefresh(intSeconds As Integer)\nDim dblStart As Double\n\nIf intSeconds &gt; 0 Then\n\n    dblStart = Timer()\n\n    Do While Timer &lt; dblStart + intSeconds\n    Loop\n\nEnd If\nEnd Function`\n</code></pre>\n\n<p>Help is much appreciated!!!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1478699601, "creation_date": 1478699601, "answer_id": 40508652, "question_id": 40508598, "link": "https://stackoverflow.com/questions/40508598/selecting-range-inside-for-each-loop-works-fine-and-but-if-outside-the-loop-giv/40508652#40508652", "title": "Selecting range inside For each loop works fine and but if outside the loop, gives error", "body": "<p>Your two variables are actually ranges so you need to use the Set statement when assigning such (object) variables. Btw your code will fail if you have nothing underneath B2.</p>\n\n<pre><code>Dim StartCell As Range\nDim EndCell As Range\n\nSet StartCell = Range(\"B2\")\nSet EndCell = Range(\"B2\").End(xlDown)\n\nFor Each d1 In Range(StartCell, EndCell)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7128770, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8e6292870f82eef0aa108354c89eaff3?s=128&d=identicon&r=PG&f=1", "display_name": "Bhushan K", "link": "https://stackoverflow.com/users/7128770/bhushan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478699601, "creation_date": 1478699396, "last_edit_date": 1531164843, "question_id": 40508598, "link": "https://stackoverflow.com/questions/40508598/selecting-range-inside-for-each-loop-works-fine-and-but-if-outside-the-loop-giv", "title": "Selecting range inside For each loop works fine and but if outside the loop, gives error", "body": "<p>When I select a range inside a for loop, it works fine:</p>\n\n<pre><code>For Each d1 In Range(Range(\"B2\"), Range(\"B2\").End(xlDown))\n</code></pre>\n\n<p>To improve the performance of the code, I tried selecting range outside the For Each loop as follows. But it gives me error. </p>\n\n<pre><code>Dim StartCell As Variant\nDim EndCell As Variant\n\nStartCell = Range(\"B2\")\nEndCell = Range(\"B2\").End(xlDown)\n\nFor Each d1 In Range(StartCell, EndCell)\n----\n----\n</code></pre>\n\n<p>Can anyone help in resolving the error? </p>\n"}, {"tags": ["string", "vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478699620, "post_id": 40508377, "comment_id": 68259330, "body": "what has that &quot;msz,*&quot; your searching for to do with &quot;kap&quot; and &quot;KP&quot;?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478699673, "post_id": 40508377, "comment_id": 68259360, "body": "Look at <code>Split</code> or the better way, regular expressions, split by comma first to find the first element, then split by &quot;KP&quot; maybe for the number as the first element"}, {"owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478699974, "post_id": 40508377, "comment_id": 68259554, "body": "@user3598756 my mistake, I have edited it. Thank you."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478700094, "post_id": 40508377, "comment_id": 68259630, "body": "form your narrative I&#39;d expect: <i>Var1 = 002bd4, Var2 = 002bd5 for the first &quot;kap&quot; row</i> , instead of <i>Var1 = 002bd4, Var2 = 123000</i>. How&#39;s it actually?"}, {"owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478700748, "post_id": 40508377, "comment_id": 68260021, "body": "@user3598756 I am sorry I have made mistake again. Now it should be correct. First line - Var1, Var2, Second line - Var3, Var4 etc. And of course there are always only 2 KP per line and lower number of Var means the first KP from the left. I am sorry again."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "edited": false, "score": 0, "creation_date": 1478701953, "post_id": 40509320, "comment_id": 68260740, "body": "I cant format it properly. But I have used this code. Your one is probably also working. Anyway, thanks for help! <code>Dim WrdArray() As String                 Dim text_string As String                 text_string = rFoundAddress                 WrdArray() = Split(text_string, &quot;KP,&quot;)                 strg = Left(WrdArray(1), 6) &amp; vbNewLine &amp; Left(WrdArray(2), 6)                 MsgBox strg</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "edited": false, "score": 0, "creation_date": 1478702174, "post_id": 40509320, "comment_id": 68260882, "body": "you are welcome. BTW, I don&#39;t get what formatting issues you can have: my code returns an array (<code>vals</code>) of two elements, so that you can retrieve its elements as <code>vals(1)</code> and <code>vals(2)</code>, and then do what you want with them"}, {"owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "edited": false, "score": 0, "creation_date": 1478702663, "post_id": 40509320, "comment_id": 68261176, "body": "no I meant that I cant format the reply comment correctly :D code is working, thanks again"}, {"owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "edited": false, "score": 0, "creation_date": 1478779183, "post_id": 40509320, "comment_id": 68294371, "body": "I have updated my code and my problem. Please have a look if you have time <a href=\"http://stackoverflow.com/questions/40527069/vba-search-save-and-replace-by-rows-according-to-conditions\">here</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "edited": false, "score": 0, "creation_date": 1478803314, "post_id": 40509320, "comment_id": 68309259, "body": "hi, I had a look at your new post and I must say that unfortunately people there gave you wrong advice: it <i>is</i> a new issue and therefore it is to be posted in a <i>new</i> question. Make that new post and if you&#39;ll give me a word I&#39;ll certainly have a look at it."}, {"owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "edited": false, "score": 0, "creation_date": 1479102680, "post_id": 40509320, "comment_id": 68400637, "body": "thank you. Now it is posted <a href=\"http://stackoverflow.com/questions/40527069/vba-search-save-and-replace-by-rows-according-to-conditions\">here</a>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1478701640, "creation_date": 1478701640, "answer_id": 40509320, "question_id": 40508377, "link": "https://stackoverflow.com/questions/40508377/vba-search-for-value-in-a-column-after-specific-pattern/40509320#40509320", "title": "VBA search for value in a column after specific pattern", "body": "<p>try this</p>\n\n<pre><code>Sub Find()\n    Dim rFound As Range\n    Dim sFirstAddress As String\n    Dim vals As Variant\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Columns(1)\n        Set rFound = .Find(\"*kap,*\", LookIn:=xlValues, LookAt:=xlWhole)\n        If Not rFound Is Nothing Then\n            sFirstAddress = rFound.Address\n            Do\n                vals = Split(Split(Split(rFound.text, \"KP\")(1), \",\")(1) &amp; \",\" &amp; Split(Split(rFound.text, \"KP\")(2), \",\")(1), \",\")\n                Set rFound = .FindNext(rFound)\n            Loop While rFound.Address &lt;&gt; sFirstAddress\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>where at every row you'l get <code>vals</code> array storing the two wanted values in that row</p>\n"}], "owner": {"reputation": 63, "user_id": 6344454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209673511535968/picture?type=large", "display_name": "Eduard Dindoffer", "link": "https://stackoverflow.com/users/6344454/eduard-dindoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 40509320, "answer_count": 1, "score": 0, "last_activity_date": 1478780254, "creation_date": 1478698758, "last_edit_date": 1478700628, "question_id": 40508377, "link": "https://stackoverflow.com/questions/40508377/vba-search-for-value-in-a-column-after-specific-pattern", "title": "VBA search for value in a column after specific pattern", "body": "<p>I have input data like this:</p>\n\n<pre><code>gen,N,,,GONGD,,,N,,,KL,0007bd,,,,,,,,TAK,\ngen,N,,,RATEC,,,N,,,KP,0007bc,,,,,,,,TAZ,\nkap,N,,,EBFWE,N,,,,,,,,,KP,002bd4,,,KP,123000,,,,,N,,,,P\nkap,N,,,ST,WEIT,E3,EBFWEI,,,KP,002bd2,N,,,,,,KP,002bd3,,,,,,,Z,MG00,,,,,N,,,,P\n</code></pre>\n\n<p>One line is in one column. First I need to know I am in a row starting with \"kap\" and then I need to save 6 characters (or numbers) after first \",KP,\" as \"Variable1\" and save also the 6 chars or numbers after the second \",KP,\" as \"Variable2\". Please help me, I am hopeless. </p>\n\n<p>Expected result: Var1 = 002bd4, Var2 = 123000 for the first \"kap\" row. Var3 = 002bd2, Var4 = 002bd3</p>\n\n<p>I have tried this to know I am in \"kap\" starting line:</p>\n\n<pre><code>Sub Find()\nDim rFoundAddress As Range\nDim sFirstAddress As String\nDim x As Long\n\nWith ThisWorkbook.Worksheets(\"Sheet1\").Columns(1)\n    Set rFoundAddress = .Find(\"kap,*\", LookIn:=xlValues, LookAt:=xlWhole)\n    If Not rFoundAddress Is Nothing Then\n        sFirstAddress = rFoundAddress.Address\n        Do\n\n\n            Set rFoundAddress = .FindNext(rFoundAddress)\n        Loop While Not rFoundAddress Is Nothing And _\n            rFoundAddress.Address &lt;&gt; sFirstAddress\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>THANKS!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1478702852, "post_id": 40508322, "comment_id": 68261309, "body": "M&#225;t&#233;, what we need is a minimal, complete, and verifiable example to reproduce the problem as outlined here: <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> Without that I have a difficult time understand the problem you seem to experience and cannot reproduce it (in order to solve it). So, please add the complete code you are currently using to lock your file (all relevant macros and where they are placed: for example as worksheet events or executed as an event when the file is closed, etc.). Maybe then we can reproduce your problem."}, {"owner": {"reputation": 87, "user_id": 6830121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/468eebdc993b71d4d02b88cf614f9bc5?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Brunner", "link": "https://stackoverflow.com/users/6830121/m%c3%a1t%c3%a9-brunner"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478703402, "post_id": 40508322, "comment_id": 68261664, "body": "Of course, it will be short."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1478704923, "post_id": 40508322, "comment_id": 68262665, "body": "Is this all your code? There is nothing to indicate this should not be working just fine? You say <code>table.locked = False</code> in your questions but the code says otherwise?"}, {"owner": {"reputation": 87, "user_id": 6830121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/468eebdc993b71d4d02b88cf614f9bc5?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Brunner", "link": "https://stackoverflow.com/users/6830121/m%c3%a1t%c3%a9-brunner"}, "edited": false, "score": 0, "creation_date": 1478769896, "post_id": 40508322, "comment_id": 68288323, "body": "The code is much longer, but just using this the problem is the same."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 6830121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/468eebdc993b71d4d02b88cf614f9bc5?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Brunner", "link": "https://stackoverflow.com/users/6830121/m%c3%a1t%c3%a9-brunner"}, "edited": false, "score": 0, "creation_date": 1478770835, "post_id": 40513120, "comment_id": 68288929, "body": "Thanks, it would be good. I thought that the userinterfaceonly protection will lock the unlocked cells, but as I see it doesn&#39;t. So I just have to write that at the beginning of the macros."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 1, "last_activity_date": 1478713925, "creation_date": 1478713925, "answer_id": 40513120, "question_id": 40508322, "link": "https://stackoverflow.com/questions/40508322/how-can-i-handle-this-cell-lock-in-excel-vba/40513120#40513120", "title": "How can I handle this cell-lock in excel? (VBA)", "body": "<p>Apparently, the <code>UserInterfaceOnly</code> option is not stored with the file and after reopening, the sheet is fully protected and you can't unlock cells on a protected sheet.</p>\n\n<p>You can reset the <code>UserInterfaceOnly</code> option without unprotecting so in your example it would be</p>\n\n<pre><code>Sub locking()\n\n    ActiveSheet.Protect UserInterfaceOnly:=True\n    Range(\"A1\").Locked = False\n    Range(\"A1\") = 5\n    Range(\"A1\").Locked = True\n\nEnd Sub\n</code></pre>\n\n<p>Of course in this example unlocking the cell is not necessary because you have set the option to true but I assume that it's relevant in your full macro.</p>\n"}], "owner": {"reputation": 87, "user_id": 6830121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/468eebdc993b71d4d02b88cf614f9bc5?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Brunner", "link": "https://stackoverflow.com/users/6830121/m%c3%a1t%c3%a9-brunner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 2, "accepted_answer_id": 40513120, "answer_count": 1, "score": 0, "last_activity_date": 1478713925, "creation_date": 1478698581, "last_edit_date": 1478703756, "question_id": 40508322, "link": "https://stackoverflow.com/questions/40508322/how-can-i-handle-this-cell-lock-in-excel-vba", "title": "How can I handle this cell-lock in excel? (VBA)", "body": "<p>So with a macro I can create new sheets, in which some cells will be locked. I use this method in the macro:</p>\n\n<p><code>ActiveSheet.Protect UserInterfaceOnly:=False</code> (for the whole new sheet)\nThen in this macro for some cells: <code>locked = False</code></p>\n\n<p>Then with the locked property, other macros switch particular cells's locking using True or False. For example a table in this sheet is locked, but a button's macro recount and rewrite the values of the table, and to do this, at the beginning of the macro the <code>table.Locked = False</code>, and at the end of the macro <code>Locked = True</code> again. </p>\n\n<p>But when I save the excel, close and open it again, I push the button, but I get <code>\"unable to set the Locked property\"</code></p>\n\n<p>How should I do this?</p>\n\n<p>update:</p>\n\n<pre><code>Sub userinterface()\n\nActiveSheet.Protect UserInterfaceOnly:=True\n\nEnd Sub\n\n\nSub locking()\n\nRange(\"A1\").Locked = False\nRange(\"A1\") = 5\nRange(\"A1\").Locked = True\n\nEnd Sub\n</code></pre>\n\n<p>So I have a new sheet, and I run the userinterface macro. It locks the whole sheet. Then I run the locking macro, that writes 5 in the given cell and locks the cell again. After it I save the excel, close and open it, and I just want to run the locking macro. At this point I get the error.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1478701967, "creation_date": 1478701967, "answer_id": 40509428, "question_id": 40508289, "link": "https://stackoverflow.com/questions/40508289/open-access-form-based-on-multiple-values/40509428#40509428", "title": "Open Access Form based on multiple values", "body": "<p>There are some quotes to manage:</p>\n\n<pre><code>DoCmd.OpenForm \"Form1\", , , \"Form1.[Variable] = \" &amp; Me![Combo4] &amp; \" And Form1.[Variable2] &lt;&gt; \" &amp; Me![Checkbox] &amp; \"\"\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4567179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ijFNMYh7HAc/AAAAAAAAAAI/AAAAAAAAAK4/34MHVT5x17U/photo.jpg?sz=128", "display_name": "karjuuhin", "link": "https://stackoverflow.com/users/4567179/karjuuhin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 40509428, "answer_count": 1, "score": 1, "last_activity_date": 1478701967, "creation_date": 1478698462, "question_id": 40508289, "link": "https://stackoverflow.com/questions/40508289/open-access-form-based-on-multiple-values", "title": "Open Access Form based on multiple values", "body": "<p>I have two forms. One connects to a table and is used to enter, change and view entries.\nFrom the second form I want to open the first form to a certain record.</p>\n\n<p>Table contains records for 6 different items, but there are multiple records for each item. A new one is added when old record is marked as closed (true/false tick box.</p>\n\n<p>I can create the code for opening a record based on just the number of item, but am unable to add the checkbox consideration.</p>\n\n<pre><code>DoCmd.OpenForm \"Form1\", , , \"Form1.[Variable]=\" &amp; Me![Combo4]\n</code></pre>\n\n<p>This reads the number from a dropdown menu box on Form2 and opens Form1 with that value.\nNow I need to add another condition to the open command.</p>\n\n<pre><code>DoCmd.OpenForm \"Form1\", , , \"Form1.[Variable]=\" &amp; Me![Combo4] And \"Form1.[Variable2] &lt;&gt;\" &amp; Me![Checkbox]\n</code></pre>\n\n<p>This should open only the record for a certain numbered item and only the record that hasn't been closed yet (I included a hidden checkbox on Form2 to use same Me![] command, but it doesn't work.</p>\n"}, {"tags": ["vba", "ms-word", "word-2013"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1478698070, "post_id": 40507929, "comment_id": 68258410, "body": "Does it work if you select the paragraph and run the code again?"}], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 6943264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d05f8f36ffe3ac55982feb94db9139c?s=128&d=identicon&r=PG&f=1", "display_name": "Roshantha De Mel", "link": "https://stackoverflow.com/users/6943264/roshantha-de-mel"}, "is_accepted": true, "score": 0, "last_activity_date": 1478698075, "creation_date": 1478698075, "answer_id": 40508168, "question_id": 40507929, "link": "https://stackoverflow.com/questions/40507929/set-line-spacing-of-footer-in-word-using-vba/40508168#40508168", "title": "Set line spacing of footer in word using VBA", "body": "<p>I was able to find a solution by my self.</p>\n\n<p>This will do the job.</p>\n\n<pre><code>With Selection.ParagraphFormat\n    .LineSpacingRule = wdLineSpaceExactly\n    .LineSpacing = 12\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 6943264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d05f8f36ffe3ac55982feb94db9139c?s=128&d=identicon&r=PG&f=1", "display_name": "Roshantha De Mel", "link": "https://stackoverflow.com/users/6943264/roshantha-de-mel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 40508168, "answer_count": 1, "score": 0, "last_activity_date": 1478710804, "creation_date": 1478697377, "last_edit_date": 1478710804, "question_id": 40507929, "link": "https://stackoverflow.com/questions/40507929/set-line-spacing-of-footer-in-word-using-vba", "title": "Set line spacing of footer in word using VBA", "body": "<p>I want to set line spacing of footer of word document to exactly 12 pt.</p>\n\n<p>I used this code</p>\n\n<pre><code>ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter\nSelection.ParagraphFormat.LineSpacing = 12\n</code></pre>\n\n<p>But it doensn't work. I'm using word 2013.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1478770956, "last_edit_date": 1478770956, "creation_date": 1478696398, "answer_id": 40507633, "question_id": 40507525, "link": "https://stackoverflow.com/questions/40507525/vba-to-pull-all-tabs-into-one-and-include-tab-name/40507633#40507633", "title": "VBA to pull all TABs into one and include TAB name", "body": "<p>Try this</p>\n\n<pre><code>Sub FuLL_LIST_MERGE()\n'\n' FuLL_LIST_MERGE Macro\n\nDim ws As Worksheet, n As Long\n\nActiveSheet.UsedRange.Offset(0).Clear\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; ActiveSheet.Name Then\n        n = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        ws.Range(\"A1\").Resize(n, ws.UsedRange.Columns.Count).Copy\n        Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues\n        Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlFormats\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(n) = ws.Name\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 2344279, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc4fb7396c689ba46798434f0142debf?s=128&d=identicon&r=PG", "display_name": "Freedox", "link": "https://stackoverflow.com/users/2344279/freedox"}, "edited": false, "score": 0, "creation_date": 1478710327, "post_id": 40508705, "comment_id": 68266082, "body": "Couln&#39;t get this to work so used clear format VBA and it worked... However it would be nice to have a solution how to get it working without clearing formats, if anyone has some time ...  <code>Sub clear_format() Dim ws As Worksheet  ActiveSheet.UsedRange.Offset(0).Clear  For Each ws In ActiveWorkbook.Worksheets     If ws.Name &lt;&gt; ActiveSheet.Name Then         ws.Cells.ClearFormats     End If Next  End Sub</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1478770998, "post_id": 40508705, "comment_id": 68289029, "body": "OK, have amended code above. If the number of columns of data is fixed, could be adapted to incorporate that, but the amendment should at least not copy the empty rows which have been formatted."}], "tags": [], "owner": {"reputation": 113, "user_id": 2344279, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc4fb7396c689ba46798434f0142debf?s=128&d=identicon&r=PG", "display_name": "Freedox", "link": "https://stackoverflow.com/users/2344279/freedox"}, "is_accepted": false, "score": 0, "last_activity_date": 1478699780, "creation_date": 1478699780, "answer_id": 40508705, "question_id": 40507525, "link": "https://stackoverflow.com/questions/40507525/vba-to-pull-all-tabs-into-one-and-include-tab-name/40508705#40508705", "title": "VBA to pull all TABs into one and include TAB name", "body": "<p>Thanks @SJR !!! However, in each of those sheets there are between 1 to   100 lines, but 200 lines formatted (have lines borders ect.). So what's happening now is that this script takes 200 lines for the TAB name (as 200 lines are formatted in each cell) but it only takes 1-100 text from sheets. So in other words, I have  1753 lines pasted from all sheets, but 40042 lines in column A with dates.</p>\n\n<pre><code>Sub FuLL_LIST_MERGE()\n'\n' FuLL_LIST_MERGE Macro\n\nDim ws As Worksheet\n\nActiveSheet.UsedRange.Offset(0).Clear\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; ActiveSheet.Name Then\n        ws.UsedRange.Copy\n        Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues\n\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(ws.UsedRange.Rows.Count) = ws.Name\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 2344279, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc4fb7396c689ba46798434f0142debf?s=128&d=identicon&r=PG", "display_name": "Freedox", "link": "https://stackoverflow.com/users/2344279/freedox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 40507633, "answer_count": 2, "score": 0, "last_activity_date": 1478770956, "creation_date": 1478696051, "question_id": 40507525, "link": "https://stackoverflow.com/questions/40507525/vba-to-pull-all-tabs-into-one-and-include-tab-name", "title": "VBA to pull all TABs into one and include TAB name", "body": "<p>I'm working on VBA code to pull all content on the tabs into one tab. All works great, except I cant get TAB file names included. I have over 200+ tabs and I need to get all content from them put on one tab (data structure is the same) but also include tab name in one of the column (preferably column A).This is what I have so far:</p>\n\n<pre><code>Sub FuLL_LIST_MERGE()\n'\n' FuLL_LIST_MERGE Macro\n'\n\n'\nDim ws As Worksheet\nActiveSheet.UsedRange.Offset(0).Clear\nFor Each ws In ActiveWorkbook.Worksheets\nIf ws.Name &lt;&gt; ActiveSheet.Name Then\nws.UsedRange.Copy\nRange(\"A65536\").End(xlUp).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\nFalse, Transpose:=False\nSelection.PasteSpecial Paste:=xlFormats, Operation:=xlNone, SkipBlanks:= _\nFalse, Transpose:=False\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7133374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7f1e6119b733bff103d9560310f511d8?s=128&d=identicon&r=PG&f=1", "display_name": "NeedToKnowBasis22", "link": "https://stackoverflow.com/users/7133374/needtoknowbasis22"}, "edited": false, "score": 0, "creation_date": 1478696159, "post_id": 40507465, "comment_id": 68257200, "body": "This did exactly what I needed it to do! Thank you so much for your help."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 0, "last_activity_date": 1478695848, "creation_date": 1478695848, "answer_id": 40507465, "question_id": 40507201, "link": "https://stackoverflow.com/questions/40507201/export-excel-data-to-csv-file-using-the-excel-file-name/40507465#40507465", "title": "Export Excel data to CSV file using the Excel file name", "body": "<p>Try this:</p>\n\n<pre><code>Sub WriteCSVFile()\n\n    Dim My_filenumber As Integer\n    Dim logSTR As String\n\n    My_filenumber = FreeFile\n\n    logSTR = logSTR &amp; Cells(18, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(19, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(20, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(21, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(27, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(28, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(29, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(30, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(31, \"C\").Value &amp; \" , \"\n    logSTR = logSTR &amp; Cells(32, \"C\").Value &amp; \" , \"\n\n    Open \"C:\\temp\\\" &amp; ThisWorkbook.Name &amp; \".csv\" For Append As #My_filenumber\n          Print #My_filenumber, logSTR\n    Close #My_filenumber\n\nEnd Sub\n</code></pre>\n\n<p>But you do know this means you need to add the VBA code to each file you run it on?<br>\nYou could make it an add-in and access the VBA code \"externally\" and that way you don't need to copy paste the code to each file.</p>\n"}], "owner": {"reputation": 99, "user_id": 7133374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7f1e6119b733bff103d9560310f511d8?s=128&d=identicon&r=PG&f=1", "display_name": "NeedToKnowBasis22", "link": "https://stackoverflow.com/users/7133374/needtoknowbasis22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 40507465, "answer_count": 1, "score": 0, "last_activity_date": 1478695848, "creation_date": 1478695016, "question_id": 40507201, "link": "https://stackoverflow.com/questions/40507201/export-excel-data-to-csv-file-using-the-excel-file-name", "title": "Export Excel data to CSV file using the Excel file name", "body": "<p>I am using a solution provided by the user The_Barman for exporting specific cells from an Excel document to a CSV document:</p>\n\n<pre><code>Sub WriteCSVFile()\n\nDim My_filenumber As Integer\nDim logSTR As String\n\nMy_filenumber = FreeFile\n\nlogSTR = logSTR &amp; Cells(18, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(19, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(20, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(21, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(27, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(28, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(29, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(30, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(31, \"C\").Value &amp; \" , \"\nlogSTR = logSTR &amp; Cells(32, \"C\").Value &amp; \" , \"\n\nOpen \"C:\\temp\\Filename.csv\" For Append As #My_filenumber\n    Print #My_filenumber, logSTR\nClose #My_filenumber\n\nEnd Sub\n</code></pre>\n\n<p>I am wondering if it would be possible and how I would go about having the CSV file name reference the originating Excel document's filename that the VBA script was run on, rather than having to manually input it into the code each time.</p>\n\n<p>i.e. have \"C:\\temp\\Filename.csv\" save as \"C:\\temp\\ExcelSpreadsheet.csv\" without manually inputting the \"ExcelSpreadsheet\" filename each time it is run: </p>\n\n<p><code>Open \"C:\\temp\\Filename.csv\" For Append As #My_filenumber\n        Print #My_filenumber, logSTR\n    Close #My_filenumber</code></p>\n\n<p>Thank you for any assistance you may provide</p>\n"}, {"tags": ["excel", "crash", "vba"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 2, "creation_date": 1478692061, "post_id": 40506173, "comment_id": 68254911, "body": "Can you try and put some delay between workbooks? It looks like a time competition issue."}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1478718499, "post_id": 40506173, "comment_id": 68270188, "body": "This seemed to work for a moment (I ran it with a 5 second lag before opening a new <code>wb(k)</code>) but when I added further workbooks to <code>WBs</code> it crashed again (I also tried with 10 seconds, same issue)."}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 1, "creation_date": 1478756645, "post_id": 40506173, "comment_id": 68282389, "body": "OK. We need to split the possibilities into two: First, try to manually open many files (there is a limit, at OS level) to the number of open files you can have. Try at least the same number of files that caused the crash in the last attempt. If no crash takes place, try running the process in DEBUG mode with breakpoint just before opening a new file (again, run it with enough files to get a crash in automatic mode). Post your results here and we&#39;ll continue from there."}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479120248, "post_id": 40506173, "comment_id": 68408971, "body": "I have had to modify the code for other reasons, as a consequence this crash might not be happening any longer."}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479121188, "post_id": 40506173, "comment_id": 68409473, "body": "Great, and thanks for up-voting my comment."}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479234864, "post_id": 40506173, "comment_id": 68468410, "body": "Well, the crash still happens. I tried what you advised me to do and, indeed, when I ran the program in debug mode with the break point located just before opening a new file, I was able to execute the whole program without crash. Any ideas on how I could solve the issue with this in mind?"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479274315, "post_id": 40506173, "comment_id": 68483030, "body": "Too long for a comment so I&#39;ll present to you my thoughts as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "edited": false, "score": 0, "creation_date": 1479289936, "post_id": 40625033, "comment_id": 68490672, "body": "Thank you for the additional tips. I tried point 1 above but the program has kept crashing. Nonetheless, inserting an <code>vbOk</code>-type <code>MsgBox</code> just before the file opening line prevents the crash (at each loop, I have to click on &quot;Ok&quot; to allow the program to resume execution)."}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "reply_to_user": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "edited": false, "score": 1, "creation_date": 1479290236, "post_id": 40625033, "comment_id": 68490892, "body": "If you feel like doing one more test, instead of vbOK message box, open a simple box and create for it a timer of, say, 5 secs, after which the box will auto-dismiss. This may preserve the wellbeing of your finger (i.e. no &quot;click&quot; needed)."}], "tags": [], "owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "is_accepted": false, "score": 1, "last_activity_date": 1479275881, "creation_date": 1479275881, "answer_id": 40625033, "question_id": 40506173, "link": "https://stackoverflow.com/questions/40506173/unexplained-excel-crash/40625033#40625033", "title": "Unexplained Excel crash", "body": "<p>It very much looks as a <strong>time competition</strong> issue. There is an apparent difference between having a <em>wait</em> before opening a new file and having a breakpoint at the same location when running with debugger. My guess is that the breakpoint does not halt the sub-process of closing files whereas the <em>wait</em> does. </p>\n\n<p><strong>[If your WAIT was not at the same location as the breakpoint, I'd suggest you to move it there and retry]</strong></p>\n\n<p>What I would try is:</p>\n\n<ol>\n<li><p>I'm assuming that the issue is related to the closing and opening of files; the issue is not caused from the number of files open (I worked in the past having perhaps 20 excel files open at the same time), but by the processes of closing and open; to test this theory, I would disable the file close part and leave files open (my recollection is that you would get the crash just above 10 files, so it should be easy and quick to test); </p></li>\n<li><p>If the result of \"1\" is <strong>no crash</strong>, I would search for a mechanism (event?) that would be fired as soon as the file-close process completes, and only then attempt to open the next file;</p></li>\n<li><p>If the result of \"1\" is <strong>yes crash</strong>... post the relevant section of your code and we'll see if there is any change that can be suggested.</p></li>\n</ol>\n\n<p>This is indeed an interesting case!!!</p>\n"}, {"tags": [], "owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "is_accepted": true, "score": 0, "last_activity_date": 1479400041, "last_edit_date": 1495541624, "creation_date": 1479400041, "answer_id": 40660097, "question_id": 40506173, "link": "https://stackoverflow.com/questions/40506173/unexplained-excel-crash/40660097#40660097", "title": "Unexplained Excel crash", "body": "<p>Following @FDavidov advice, I ended up finding a (rather random) solution to this issue, which consists on popping up a message box that automatically closes after a specified amount of time just before opening a new file; surprisingly, the PopUp does not even seem to pause the program, lines following the PopUp execution line keep being executed while the PopUp is open.</p>\n\n<p>Specifically, the PopUp code - credits to @Orphid, see his answer in the following <a href=\"https://stackoverflow.com/questions/31141775/infobox-popup-refuses-to-close-on-timer-expiration\">thread</a> - is the following:</p>\n\n<pre><code>Sub subClosingPopUp(PauseTime As Integer, Message As String, Title As String)\n\nDim WScriptShell As Object\nDim ConfigString As String\n\nSet WScriptShell = CreateObject(\"WScript.Shell\")\nConfigString = \"mshta.exe vbscript:close(CreateObject(\"\"WScript.Shell\"\").\" &amp; _\n               \"Popup(\"\"\" &amp; Message &amp; \"\"\",\" &amp; PauseTime &amp; \",\"\"\" &amp; Title &amp; \"\"\"))\"\n\nWScriptShell.Run ConfigString\n\nEnd Sub\n</code></pre>\n\n<p>The end result is then:</p>\n\n<pre><code>Sub Main()\n\nDim PauseTime as Integer\nDim Message as String\nDim Title as String\nDim wbk as String\nDim wb as Workbook\n\n'Code\n\nPauseTime = ...\nMessage = ...\nTitle = ...\n\n'Code\n\nFor k = 1 to n\n    '[Code]\n    wbk = ...\n    Call subClosingPopUp(PauseTime, Message, Title)\n    Set wb = Workbooks.Open(wbk)\n    '[Code]\nNext k\n\n'Code\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 5661945, "user_type": "registered", "profile_image": "https://graph.facebook.com/866701376783259/picture?type=large", "display_name": "Cameron Bradley", "link": "https://stackoverflow.com/users/5661945/cameron-bradley"}, "is_accepted": false, "score": 0, "last_activity_date": 1516313118, "creation_date": 1516313118, "answer_id": 48331093, "question_id": 40506173, "link": "https://stackoverflow.com/questions/40506173/unexplained-excel-crash/48331093#48331093", "title": "Unexplained Excel crash", "body": "<p>I encountered this same problem happening repetitively. It turned out the problem was to do with faulty RAM in the computer. The same issue did not occur on other computers, and we are now replacing the faulty RAM.</p>\n"}], "owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 40660097, "answer_count": 3, "score": 0, "last_activity_date": 1516313118, "creation_date": 1478691750, "last_edit_date": 1531161705, "question_id": 40506173, "link": "https://stackoverflow.com/questions/40506173/unexplained-excel-crash", "title": "Unexplained Excel crash", "body": "<p>I am running an Excel VBA macro from a workbook <code>macroWb</code> which:</p>\n\n<ol>\n<li>Opens an Excel Workbook <code>wb(k)</code>;</li>\n<li>Copies some cells from that workbook to <code>macroWb</code>;</li>\n<li>Executes some fairly basic Excel commands (formatting, assigning values to cells, etc.) within the workbook <code>macroWb</code>;</li>\n<li>Closes <code>wb(k)</code>;</li>\n<li>Repeats 1-4 for <code>wb(k+1)</code>.</li>\n</ol>\n\n<p>Letting <code>WBs = {wb(1),...,wb(n)}</code>, it seems that when I add further workbooks to <code>WBs</code> Excel ends up crashing. But then, if you ran the macro at another time it doesn't crash anymore - e.g. yesterday evening the macro was crashing, then I ran it this morning with the same set <code>WBs</code> as yesterday and it worked fine; I then added 3 new workbooks to <code>WBs</code> and it crashed again. </p>\n\n<p>The crash does not seem related to any particular <code>wb(k)</code> as I have tested for that.</p>\n\n<p>The crash details are as follows:</p>\n\n<pre><code>[...]\nFault Module Name:          StackHash_f2b6\nFault Module Version:       0.0.0.0\n[...]\nException Code:             c000041d\nException Offset:           74384f69\n[...]\nAdditional Information 1:   f2b6\nAdditional Information 2:   f2b6a6f8ea78ee3ad1bda3596b78feb6\nAdditional Information 3:   7b01\nAdditional Information 4:   7b010e90eab9e4895f15c0f6ba536eb5\n</code></pre>\n\n<p>Any idea of what might be causing this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 1, "creation_date": 1478690963, "post_id": 40505869, "comment_id": 68254294, "body": "You wrote (3,4,7) would define the ranges (B4:H4,B5:H5,B8:H8), meaning that you have a shift of one row. I don&#39; t see evidences of this shift anywhere. Am I missing something?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478691040, "post_id": 40505869, "comment_id": 68254338, "body": "Probably a header row, this corresponds to data row 3"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478691123, "post_id": 40505869, "comment_id": 68254386, "body": "it would be like range(&quot;b2:h1000&quot;).row(SampleRefArray(0))"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1478692221, "post_id": 40505869, "comment_id": 68255000, "body": "You should say which cells it does select. Is your array zero-based or one-based?"}, {"owner": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1478708258, "post_id": 40505869, "comment_id": 68264917, "body": "My array is zero based. So for index location 0 in the array, there is a value of &#39;3&#39;, and for index location 1 there is a value of 4."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1478692373, "creation_date": 1478692373, "answer_id": 40506369, "question_id": 40505869, "link": "https://stackoverflow.com/questions/40505869/vba-selecting-specific-rows-based-on-list-of-relative-row-numbers-and-range/40506369#40506369", "title": "VBA Selecting specific rows based on list of relative row numbers and range", "body": "<p>Perhaps this?</p>\n\n<pre><code>counter = UBound(SampleRefArr, 1)\n\nFor i = LBound(samplrefarr,1) To counter\n    With Settings.AmountColumn\n        rowSelector = SampleRefArr(i) - .Cells(1, 1).Row + 2\n        'Settings.AmountColumn.Cells(rowSelector, 1).EntireRow.Select\n        .Range(.Cells(rowSelector, 1), .Cells(rowSelector, 10)).Select\n    End With\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1479469544, "post_id": 40506947, "comment_id": 68582447, "body": "Hi! i&#39;ve got a bit of a problem with this code unfortunately...  when I run it on a different workbook it gives me the following error &quot;application defined object defined error &quot;  Any idea what is causing this?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1479471205, "post_id": 40506947, "comment_id": 68583455, "body": "it&#39;s because the <code>Select</code> method must be called upon a range in the currently <i>active</i> worksheet. So you should add <code>rng.Parent.Activate</code> right before the <code>Intersect(rng, ...</code> statement. BTW you should avoid any coding based on <code>Select</code>/<code>Selection</code>/<code>Activate</code>/<code>ActiveXXX</code> and use fully qualified range references. For instance you could turn that <code>Sub</code> into a <code>Function</code> returning the wanted Range like: <code>Function RangeSelector(rng As Range, refArr As Variant) As Range\\ Set RangeSelector = Intersect(rng, rng.Range(&quot;A&quot; &amp; Replace(Join(refArr, &quot;,&quot;), &quot;,&quot;, &quot;,A&quot;)).EntireRow.Offset(1))\\  &#39;End Function</code>"}, {"owner": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1479742595, "post_id": 40506947, "comment_id": 68674724, "body": "Ok thanks for that! so for clarity, now when i can RangeSelector I get a range back, which I then later have to call select on?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1479744040, "post_id": 40506947, "comment_id": 68675750, "body": "If you leave it like a Sub() and make that little change (insert &quot;rng.Parent.Activate&quot; right before the &quot;Intersect(rng, ...&quot; statement), then you get a selected range. While if you turn it into a Function then you get back a range you can call &quot;Select&quot; upon"}, {"owner": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1479746373, "post_id": 40506947, "comment_id": 68677318, "body": "Yea I thought so.   Unfortunately it is still giving me the same error &quot;Application-defined or Object-defined error&quot;.... this is now happening also on a separate sheet of the same work book...  It works on my original dataset on &quot;sheet1&quot; but fails on any other sheet or any other work book. Thank you so much for your time by the way"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1479750536, "post_id": 40506947, "comment_id": 68679874, "body": "that <code>rng.Parent.Activate</code> revision makes the <code>Sub</code> working for range on a different worksheet then the <i>active</i> one but of the <i>same</i> workbook, as I tested it. While for the <code>Function</code> you have to add a <code>someWorksheet.Activate</code> statement right before the <code>RangeSelector(Range(&quot;B1:H100&quot;), Array(3, 4, 7)).Select</code> one in your &quot;main&quot; code. But, above all you have to avoid use of any <code>Select&#47;Selection&#47;Activate&#47;ActiveXXX</code> pattern and go with fully qualified range references"}, {"owner": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "edited": false, "score": 0, "creation_date": 1480071507, "post_id": 40506947, "comment_id": 68827599, "body": "Right... turns out that this is being caused by when my refArr is too long... specifically about 54 items. So strange..... there are no duplicates, and the rows are all contained within the dataset. My datarange is 435 rows long or so..."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1478694162, "creation_date": 1478694162, "answer_id": 40506947, "question_id": 40505869, "link": "https://stackoverflow.com/questions/40505869/vba-selecting-specific-rows-based-on-list-of-relative-row-numbers-and-range/40506947#40506947", "title": "VBA Selecting specific rows based on list of relative row numbers and range", "body": "<p>you could use this:</p>\n\n<pre><code>Sub RangeSelector(rng As Range, refArr As Variant)\n    Intersect(rng, rng.Range(\"A\" &amp; Replace(Join(refArr, \",\"), \",\", \",A\")).EntireRow.Offset(1)).Select\nEnd Sub\n</code></pre>\n\n<p>to be called like:</p>\n\n<pre><code>RangeSelector Range(\"B1:H100\"), Array(3, 4, 7)\n</code></pre>\n\n<p>which would return cells \"B4:H5\" and \"B8:H8\" selected</p>\n"}], "owner": {"reputation": 39, "user_id": 3465779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YZWG8.jpg?s=128&g=1", "display_name": "Stu-co", "link": "https://stackoverflow.com/users/3465779/stu-co"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 40506947, "answer_count": 2, "score": 1, "last_activity_date": 1478694162, "creation_date": 1478690745, "question_id": 40505869, "link": "https://stackoverflow.com/questions/40505869/vba-selecting-specific-rows-based-on-list-of-relative-row-numbers-and-range", "title": "VBA Selecting specific rows based on list of relative row numbers and range", "body": "<p>So I'm trying to make a sample selector.</p>\n\n<p>The current variables I have are a range that has been specified by the user.</p>\n\n<p>Settings.AmountColumn is a range that looks something along the lines of B1:H100. \nSampleRefArr is an array of row numbers, relative to the first row of the Settings.AmountColumn. </p>\n\n<p>For example, if my SampleRefArr shows (3,4,7) then I will need to take the following ranges (B4:H4,B5:H5,B8:H8) and copy them to a new spreadsheet. I have built the following code but that does not select the right cells...</p>\n\n<pre><code>counter = UBound(SampleRefArr, 1)\n\nFor i = 1 To counter\n\n    rowSelector = SampleRefArr(i) - Settings.AmountColumn.Cells(1, 1).Row + 2\n    'Settings.AmountColumn.Cells(rowSelector, 1).EntireRow.Select\n    Settings.AmountColumn(Cells(rowSelector, 1), Cells(rowSelector, 10)).Select\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1478693046, "post_id": 40505788, "comment_id": 68255470, "body": "This will work: Open the programmers tab, start recording a macro, freeze panels as you need, stop recording. Then, look at the generated code. You will find the function invocation that you need."}, {"owner": {"reputation": 35803, "user_id": 3858469, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Lf9q4.png?s=128&g=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/3858469/aravind"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1478693250, "post_id": 40505788, "comment_id": 68255583, "body": "Yes that I tried didn&#39;t help"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1478693582, "post_id": 40505788, "comment_id": 68255741, "body": "But.... Don&#39;t you need to define the limits of the panel you wish to freeze? I mean, try to select a cell and then freeze. I think that the method <code>FreezePanels</code> is applicable to a WINDOW object, not to a specific cell. The  cell selection is to define where the freezing is to take place. Just guessing though..."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1478697205, "post_id": 40505788, "comment_id": 68257850, "body": "To clarify, the worksheet you are trying to freeze the panes of resides in an instance of Excel 2013? Also, does it work to freeze panes manually?"}], "answers": [{"tags": [], "owner": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "is_accepted": true, "score": 1, "last_activity_date": 1479619739, "last_edit_date": 1479619739, "creation_date": 1478696553, "answer_id": 40507678, "question_id": 40505788, "link": "https://stackoverflow.com/questions/40505788/setting-freezepanes-property-of-the-windows-class-excel-vba/40507678#40507678", "title": "Setting FreezePanes Property of the windows class -Excel VBA", "body": "<p>Try this:</p>\n\n<pre><code>AddWorksheetWithDefaults.Parent.Windows(1).Activate\nWith AddWorksheetWithDefaults.Parent.Windows(1)\n    .FreezePanes = False\n    .SplitColumn = 0\n    .SplitRow = 1\n    .FreezePanes = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 35803, "user_id": 3858469, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Lf9q4.png?s=128&g=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/3858469/aravind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2990, "favorite_count": 0, "accepted_answer_id": 40507678, "answer_count": 1, "score": 2, "last_activity_date": 1479619739, "creation_date": 1478690495, "question_id": 40505788, "link": "https://stackoverflow.com/questions/40505788/setting-freezepanes-property-of-the-windows-class-excel-vba", "title": "Setting FreezePanes Property of the windows class -Excel VBA", "body": "<p>I have a huge application for importing and exporting which was written back in the version VBA 9.1 and <strong>migrating</strong> it to Excel 2013\nI'm facing problem during the freezing of first row using this line.</p>\n\n<pre><code>AddWorksheetWithDefaults.Parent.Windows(1).Activate\nWith\u00a0AddWorksheetWithDefaults.Parent.Windows(1)\n.FreezePanes =\u00a0False\n.FreezePanes =\u00a0True\nEnd\u00a0With \n</code></pre>\n\n<p>In this case I a''m getting error as <strong>Unable to set FreezePanes Property of the windows class</strong></p>\n\n<p>and the AddWorksheetWithDefaults is a method that returns a object().\n\"\nI tried following</p>\n\n<p><strong>Try 1</strong></p>\n\n<pre><code>AddWorksheetWithDefaults.Parent.Windows(1).Activate\nWith\u00a0AddWorksheetWithDefaults.Parent.Windows(1).Rows(\"1:1\").Select\n.FreezePanes =\u00a0False\n.FreezePanes =\u00a0True\nEnd\u00a0With\n</code></pre>\n\n<p><strong>Try 2</strong></p>\n\n<pre><code>AddWorksheetWithDefaults.Parent.Windows(1).Activate\nWith\u00a0AddWorksheetWithDefaults.Parent.Windows(1).Rows(1).Select\n.FreezePanes =\u00a0False\n.FreezePanes =\u00a0True\nEnd\u00a0With\n</code></pre>\n\n<p><strong>Try 3</strong></p>\n\n<pre><code>AddWorksheetWithDefaults.Parent.Windows(1).Activate\nWith\u00a0AddWorksheetWithDefaults.Parent.Windows(1).Rows(\"1:1\")\n.FreezePanes =\u00a0False\n.FreezePanes =\u00a0True\nEnd\u00a0With\n</code></pre>\n\n<p>The options I tried gives me error as <strong>property or method not found</strong></p>\n\n<p>Help me out. </p>\n"}, {"tags": ["excel", "vba", "zip"], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1478691284, "creation_date": 1478691284, "answer_id": 40506044, "question_id": 40505759, "link": "https://stackoverflow.com/questions/40505759/copy-selected-files-to-zipped-folder-error-file-not-found-or-no-read-permissio/40506044#40506044", "title": "Copy selected files to zipped folder: Error &quot;File not found or no read permission&quot; in VBA", "body": "<p>If it works while debugging, but gives errors when not debugging, there may be a problem with the asynchronousness of your code. It seems to call (start) and external process that may not be finished when VB executes its next statement. So the library you are using (Ron de Bruin's, you refer to, which I don't have here) may include a function to wait for the process to be ready.</p>\n\n<p>I also note:</p>\n\n<pre><code>For Each Fold In ws.Range(\"E3:E\" &amp; lastrow)\n    Set oApp = CreateObject(\"Shell.Application\")\n</code></pre>\n\n<p>You seem to create a new shell with every iteration of the loop. Wouldn't creating it once before the loop be enough?</p>\n"}], "owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 736, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478691284, "creation_date": 1478690416, "question_id": 40505759, "link": "https://stackoverflow.com/questions/40505759/copy-selected-files-to-zipped-folder-error-file-not-found-or-no-read-permissio", "title": "Copy selected files to zipped folder: Error &quot;File not found or no read permission&quot; in VBA", "body": "<p>I have a code that zips all selected files(credits to RonDeBruin's code) though I revised some parts of it. My problem is that everytime I run the code it pops up an error like this: <br>\n<a href=\"https://i.stack.imgur.com/p2RW8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p2RW8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And here is my code: <br></p>\n\n<pre><code>Sub zipAllFiles()\n 'rondebruin &lt;--- Credits to code\n\nDim FileNameZip, FolderName\nDim strDate As String, DefPath As String\nDim oApp As Object\nDim Fold As Range\nDim ws As Worksheet\nDim i As Integer, lastrow As Long\n\nDefPath = Application.DefaultFilePath\nIf Right(DefPath, 1) &lt;&gt; \"\\\" Then\n    DefPath = DefPath &amp; \"\\\"\nEnd If\n\nSet ws = ThisWorkbook.Sheets(2)\nlastrow = ws.Cells(Rows.Count, 5).End(xlUp).Row  '---&gt; Files Directories\n\nstrDate = Format(Now, \" dd-mmm-yy h-mm-ss\")\nFileNameZip = DefPath &amp; \"MyFilesZip \" &amp; strDate &amp; \".zip\"\n\n\n'Create empty Zip File\nNewZip (FileNameZip)\n\n'E3:E&amp;lastrow  ---&gt; Where the files directories are located.\nFor Each Fold In ws.Range(\"E3:E\" &amp; lastrow)\n    Set oApp = CreateObject(\"Shell.Application\")\n    FolderName = Fold.Value\n    'Copy the files to the compressed folder\n    oApp.Namespace(FileNameZip).CopyHere FolderName\nNext Fold\n\n\nws.Range(\"J1\").Value = Dir(FileNameZip) '---&gt; The directory of the Zipped file to Range(J1).\n\n Application.DisplayAlerts = False\n\n\n End Sub\n</code></pre>\n\n<p><br>\nBut when I debug it, it won't pop up any error. Is there something wrong with the code? Or should I make changes on the Folder or program settings? Please help me :( </p>\n"}, {"tags": ["excel", "vba", "templates", "excel-formula", "populate"], "comments": [{"owner": {"reputation": 18185, "user_id": 165071, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EWdkL.jpg?s=128&g=1", "display_name": "Alexander Farber", "link": "https://stackoverflow.com/users/165071/alexander-farber"}, "edited": false, "score": 0, "creation_date": 1478691455, "post_id": 40505709, "comment_id": 68254578, "body": "Please show more of your source code."}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 4258385, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c41972ad3daddb1f5a08a8f2da6e30ab?s=128&d=identicon&r=PG&f=1", "display_name": "lorgan", "link": "https://stackoverflow.com/users/4258385/lorgan"}, "is_accepted": false, "score": 1, "last_activity_date": 1478693474, "creation_date": 1478693474, "answer_id": 40506734, "question_id": 40505709, "link": "https://stackoverflow.com/questions/40505709/populating-template-with-data-from-another-sheet/40506734#40506734", "title": "Populating Template with data from another sheet?", "body": "<p>If I understand your question correctly I think this does what you need:</p>\n\n<pre><code>=INDEX(Data!$E$1:$E$10001,ROUNDUP(ROW(A1)/6+1,0),1)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7135994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e96183d7927465b2e5842fc9dc2d12be?s=128&d=identicon&r=PG&f=1", "display_name": "L.Pump", "link": "https://stackoverflow.com/users/7135994/l-pump"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478693474, "creation_date": 1478690293, "question_id": 40505709, "link": "https://stackoverflow.com/questions/40505709/populating-template-with-data-from-another-sheet", "title": "Populating Template with data from another sheet?", "body": "<p>I've been trying to solve this problem for quite some time now. It might be good to know I'm not very familiar with Excel formulas &amp; VBA and that I'm using Excel 2010.</p>\n\n<p>I have two separate sheets, let's call them \"Data\" and \"Template\". </p>\n\n<p>In \"Data\" I have ~10 000 cells with information (running adjacent from E2 to E10001, sorted numerically).</p>\n\n<p>In \"Template\" I have templates which I want to populate with the data from \"Data\". The problematic thing here is that the \"Template\" sheet is filled with ~10 000 empty recurring templates, where one template covers 18 columns and 6 rows. All templates are adjacent to each other and running vertically.The second template starts the row after the first template ends, so if the first template stops at row 6, the second template starts at row 7.</p>\n\n<p>How do I automatically pick a value from E2 in \"Data\" and place it in D1 in \"Template\" for the first template and then then pick the value from E3 in \"Data\" and place it in D7 in \"Template\", all the way to the last template?</p>\n\n<p>I've been trying by using formulas that adjust automatically when adding a new template:</p>\n\n<pre><code>=OFFSET('Data'!E7!;-5;0)\n</code></pre>\n\n<p>But the problem being that the row offset has to be dynamic. By the third template, as an example, the -5 needs to be -10 for the formula to return the right cell reference (at the fourth template -16 and so on).</p>\n\n<p>I hope I've explained my problem in a non-confusing way.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1478690593, "creation_date": 1478690593, "answer_id": 40505816, "question_id": 40505558, "link": "https://stackoverflow.com/questions/40505558/add-textbox-value-to-single-record-syntax-error-in-insert-into-statement/40505816#40505816", "title": "Add textbox value to single record: syntax error in INSERT INTO statement", "body": "<p>When you use field names with spaces or special symbols, enclose them in square brackets. And if this field has <code>Text</code> data type, enclose data in quotes:</p>\n\n<pre><code>RnDdB.Execute \"INSERT INTO ComboAreaProgetto ([Area Progetto]) VALUES ( '\" &amp; Forms!ComboAreaProgetto!TextBoxArea &amp; \"');\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 40505816, "answer_count": 1, "score": 0, "last_activity_date": 1478690593, "creation_date": 1478689828, "question_id": 40505558, "link": "https://stackoverflow.com/questions/40505558/add-textbox-value-to-single-record-syntax-error-in-insert-into-statement", "title": "Add textbox value to single record: syntax error in INSERT INTO statement", "body": "<p>I have this error in my Access DB.\nAssuming I have a form called ComboAreaProgetto which has one <em>textbox</em> called textboxArea and one <em>button</em> named AddButton. The button has an event procedure on the <em>click</em> event which must add the textbox content into the field 'Area progetto' of the table ComboAreaProgetto. Here is the following code:  </p>\n\n<pre><code>Private Sub AddButton_Click()\nDim strSQL As String\nDim RnDdB As Database\nSet RnDdB = CurrentDb\n\n   RnDdB.Execute \" INSERT INTO ComboAreaProgetto (Area Progetto) VALUES ( \" &amp; Forms!ComboAreaProgetto!TextBoxArea &amp; \");\"\n\nEnd Sub\n</code></pre>\n\n<p>It gives me syntax error on INSERT INTO statement. I tried to put a different textbox name (an invented one) with this code:</p>\n\n<pre><code>Private Sub AddButton_Click()\nDim strSQL As String\nDim RnDdB As Database\nSet RnDdB = CurrentDb\n\n   RnDdB.Execute \" INSERT INTO ComboAreaProgetto (Area Progetto) VALUES ( \" &amp; Me.TextBox123 &amp; \");\"\n\nEnd Sub\n</code></pre>\n\n<p>and it gives me textbox not found instead of INSERT INTO statement error. What's wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1478691817, "post_id": 40505464, "comment_id": 68254771, "body": "Use a pivot table"}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": 1, "last_activity_date": 1478693508, "creation_date": 1478693508, "answer_id": 40506748, "question_id": 40505464, "link": "https://stackoverflow.com/questions/40505464/excel-vba-how-to-find-best-price-in-worksheet-and-put-all-row-to-another-workshe/40506748#40506748", "title": "Excel VBA How to find best price in worksheet and put all row to another worksheet", "body": "<p>Replace sheet1 &amp; sheet2 with your source and destination sheets-</p>\n\n<p>in sheets(\"Sheet1\") &amp; sheets(\"Sheet2\")</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nSheets(\"Sheet1\").Range(\"A3:C\" &amp; Sheets(\"Sheet1\").Range(\"A50000\").End(xlUp).Row).Sort Key1:=Sheets(\"Sheet1\").Range(\"B3\"), Order1:=xlDescending\nSheets(\"Sheet1\").Range(\"A1:C\" &amp; Sheets(\"Sheet1\").Range(\"A50000\").End(xlUp).Row).Copy Destination:=Sheets(\"Sheet2\").Range(\"A1\")    \nSheets(\"Sheet2\").Range(\"A3:C\" &amp; Sheets(\"Sheet2\").Range(\"A50000\").End(xlUp).Row).RemoveDuplicates Columns:=1, Header:=xlNo\nSheets(\"Sheet2\").Range(\"A3:C\" &amp; Sheets(\"Sheet2\").Range(\"A50000\").End(xlUp).Row).Sort Key1:=Sheets(\"Sheet2\").Range(\"A3\"), Order1:=xlAscending\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 4258385, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c41972ad3daddb1f5a08a8f2da6e30ab?s=128&d=identicon&r=PG&f=1", "display_name": "lorgan", "link": "https://stackoverflow.com/users/4258385/lorgan"}, "is_accepted": true, "score": 1, "last_activity_date": 1478697430, "creation_date": 1478697430, "answer_id": 40507951, "question_id": 40505464, "link": "https://stackoverflow.com/questions/40505464/excel-vba-how-to-find-best-price-in-worksheet-and-put-all-row-to-another-workshe/40507951#40507951", "title": "Excel VBA How to find best price in worksheet and put all row to another worksheet", "body": "<p>This formula will tell you the product max for each product, populate in column D - use cntl+shift+enter to make it an array formula:</p>\n\n<pre><code>{=MAX(IF($A$2:$A$10=A2,$B$2:$B$10))}\n</code></pre>\n\n<p>You can then use this to determine if the current row in the max, populate in column E:</p>\n\n<pre><code>=IF(D2=B2,1,0)\n</code></pre>\n\n<p>You can then use a pivot table and filter on columnE = 1</p>\n"}], "owner": {"reputation": 319, "user_id": 2151533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wwlgj.jpg?s=128&g=1", "display_name": "Endriu", "link": "https://stackoverflow.com/users/2151533/endriu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 40507951, "answer_count": 2, "score": 0, "last_activity_date": 1478697430, "creation_date": 1478689565, "question_id": 40505464, "link": "https://stackoverflow.com/questions/40505464/excel-vba-how-to-find-best-price-in-worksheet-and-put-all-row-to-another-workshe", "title": "Excel VBA How to find best price in worksheet and put all row to another worksheet", "body": "<p>Hi Excel and VBA Masters. </p>\n\n<p>I have a problem and i'm sure You can help me :)</p>\n\n<p>In this case: </p>\n\n<p>I have a worksheet with some products, their prices and shops. I need to find every product with best price.</p>\n\n<p>In Worksheet1 i have offers from shops:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1fWFG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1fWFG.png\" alt=\"enter image description here\"></a></p>\n\n<p>In Worksheet2 i need to list all products <strong>with their best price and shopname</strong> (only rows with best price, without doubling) </p>\n\n<p><a href=\"https://i.stack.imgur.com/gkiut.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gkiut.png\" alt=\"enter image description here\"></a></p>\n\n<p>I bet it is not hard to do it, but my excel skills are very shitty ( and i cant tell it to my boss ofc :) ) so i need a Help of stack community </p>\n"}, {"tags": ["html", "vba", "internet-explorer", "getelementsbytagname", "getelementsbyname"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478688700, "post_id": 40505114, "comment_id": 68253094, "body": "Have you tried using a MSHTML.FramesCollection?  setting from IEDoc.Frames?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478689152, "post_id": 40505114, "comment_id": 68253330, "body": "I have never heard about the type MSHTML.FramesCollection. How do I use this ? If I simply change the type of <i>Collection</i> to it, I have a mismatch of course."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478689192, "post_id": 40505114, "comment_id": 68253342, "body": "Using IEDoc.Frames?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478689459, "post_id": 40505114, "comment_id": 68253490, "body": "I still only get 3 frames in it"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478690096, "post_id": 40505114, "comment_id": 68253825, "body": "does col(1).frames.length give a result?  You may need to iterate the collection and then check for embedded frames"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478690447, "post_id": 40505114, "comment_id": 68254030, "body": "Have a look <a href=\"http://stackoverflow.com/questions/27506705/cannot-write-in-inputbox-inside-a-frame-of-a-website\">here</a>."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1478690453, "post_id": 40505114, "comment_id": 68254033, "body": "Oh yeahh this gives me 2 ! Which means it spotted those 2 &quot;sub-frames&quot;. That&#39;s awesome, thanks man"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478691790, "post_id": 40505114, "comment_id": 68254755, "body": "@dee : this is exactly what I was looking for ! Awesome ! I will implente it in my code and post the result"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478709261, "post_id": 40505114, "comment_id": 68265515, "body": "@dee : I went through the link you gave me but by replacing your PC location path by the URL of mywebpage it doesn&#39;t seem to work. You used &quot;main.html&quot; but I don&#39;t know what&#39;s the equivalent of this for a website. You proposed to replace this part by the &quot;name&quot; of the webpage, you meant &quot;title&quot; ? I am a bit confused...Also in my case I will have to change this method a bit since I cannot &quot;navigate&quot; to a new webpage with the new path so I should copy it in an existing internet window instead."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478715360, "post_id": 40505114, "comment_id": 68268691, "body": "You have url of the page with frames (so called main page). Then you have a <code>src</code> argument of some frame e.g. <code>&#47;puma&#47;xls&#47;common&#47;framesets&#47;all&#47;allsearchframe.html</code>. First IE navigates to main page. When main page is loaded then let IE navigate to some frame. To navigate to some frame combine the home-url with the src of frame. When home url ends with file name then take just the part without this file name. Could you post the format of your main Url?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478769673, "post_id": 40505114, "comment_id": 68288175, "body": "@dee The problem is that it&#39;s an intranet link, but also that it&#39; s a link which is unaccessible directly (even for me). My full code consists of going on an accessible intranet webpage, then providing username+password and once you submit these info a new separate page will open as well. I then activated this page to get to its information. This latter is the so called main page from the sample of code, so basically if I use its url and navigate to it, it doesn&#39;t work, I can only navigate to the first webpage and then activate it when it pops up."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478770405, "post_id": 40505114, "comment_id": 68288646, "body": "<code>Src</code> attribute specifies the address of the document to embed in the frame. In this case the address is relative so what you need is the home address to get the full address where the frame will navigate: ie.Navigate <code>&quot;http:&#47;&#47;192.168.55.66:8899&#47;Some&#47;Intranet&#47;Path&#47;&quot; &amp; &quot;frame.src&quot;</code>."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1478774934, "post_id": 40505114, "comment_id": 68291706, "body": "I tried it again, but if I navigate to a frame of this &quot;unaccessible&quot; webpage, it doesn&#39;t work. If somehow I could say instead that I want the HTMLdocument of the activated page (so the main.html) to be reduced to the one of the src of the frame I&#39;m interested in only it would probably work."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478781284, "post_id": 40505114, "comment_id": 68295631, "body": "So you fitst login then navigate to main page and then to frame but it doesn&#39;t work? What does it mean exactly? What error you get?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1478781524, "post_id": 40505114, "comment_id": 68295781, "body": "I will make a new post now (which will be the following part of this one) since now the problem is not the same anymore as the topic of this post here. And I will tag you, thanks for help mate :)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478781867, "post_id": 40505114, "comment_id": 68295974, "body": "Ok, you are welcome!"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1478787002, "post_id": 40505114, "comment_id": 68299214, "body": "here is the link to the new post : <a href=\"http://stackoverflow.com/questions/40529581/access-to-a-webpages-frame-document-without-navigating-to-this-webpage\" title=\"access to a webpages frame document without navigating to this webpage\">stackoverflow.com/questions/40529581/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1478688722, "post_id": 40505153, "comment_id": 68253108, "body": "Hmmm I see, and is there a way to access to the content of of of those 3 mainframes ?"}], "tags": [], "owner": {"reputation": 473, "user_id": 581229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce1309abec6a7e0cbc35389447ca384?s=128&d=identicon&r=PG", "display_name": "theleebriggs", "link": "https://stackoverflow.com/users/581229/theleebriggs"}, "is_accepted": false, "score": 0, "last_activity_date": 1478688574, "creation_date": 1478688574, "answer_id": 40505153, "question_id": 40505114, "link": "https://stackoverflow.com/questions/40505114/getelementsbytagname-seems-to-not-work-properly/40505153#40505153", "title": "GetelementsByTagName seems to not work properly", "body": "<p>Only 3 frames are on that page, the rest are inside an embedded html frame which getElementsByTagName cannot access as it is a different DOM tree.</p>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478784239, "creation_date": 1478688444, "last_edit_date": 1478784239, "question_id": 40505114, "link": "https://stackoverflow.com/questions/40505114/getelementsbytagname-seems-to-not-work-properly", "title": "GetelementsByTagName seems to not work properly", "body": "<p>this question sounds stupid but how come when I use the function GetElementsByTagname(\"frame\") , it only returns 3 as a length and not 5 as I expected ?</p>\n\n<p>Here is the <a href=\"https://i.stack.imgur.com/L6KTc.png\" rel=\"nofollow noreferrer\">HTML of the webpage </a> where I counted 5 times the apparition of the tagname \"frame\" but when I ask for the length in VBA I get 3...</p>\n\n<p>My observations :</p>\n\n<p>1) You can see that 3 is the number of main frames (top_navigation, contentframe, dummyframe)</p>\n\n<p>2) If I try to access to one of the mainframes via getelementbyname, it works but if I try to access on the the subframes of contentframe ( leftnavigation or postfachcontent) it doesn't work ( 0 item detected)</p>\n\n<p>Here is my code :</p>\n\n<pre><code>Dim Frame As IHTMLElementCollection\n  Set Frame = IEDoc.getElementsByName(\"contentframe\") ' this works and returns 1 item\n   MsgBox Frame.Length\n   Set Frame = IEDoc.getElementsByName(\"postfachcontent\")\n  MsgBox Frame.Length ' this returns 0 item\n\n\nDim Collection As IHTMLElementCollection\n\nSet Collection = IEDoc.getElementsByTagName(\"frame\")\nMsgBox Collection.Length ' this returns 3 and I expected 5...\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478687756, "post_id": 40504669, "comment_id": 68252560, "body": "Direction is an enumeration <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841198.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff841198.aspx</a>  needs to be a number or an enumeration equiv"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1478687925, "post_id": 40504669, "comment_id": 68252649, "body": "A bit of further reading:  <a href=\"https://en.wikipedia.org/wiki/Enumerated_type\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Enumerated_type</a>"}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1478688451, "post_id": 40504669, "comment_id": 68252942, "body": "Thanks for Wiki article."}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1478687772, "creation_date": 1478687772, "answer_id": 40504901, "question_id": 40504669, "link": "https://stackoverflow.com/questions/40504669/find-putting-variable-in-searchdirection-causes-run-time-error-13-type-mism/40504901#40504901", "title": ".Find - putting variable in SearchDirection causes run-time error 13 - type mismatch", "body": "<p><code>SearchDirection</code> is not a argument of type <code>String</code>, but of type <code>XlSearchDirection</code>, you cannot pass a string to it since there is no convertion from one to the other.\n<code>xlNext</code> is not identical to <code>\"xlNext\"</code></p>\n\n<p>Use following code:</p>\n\n<pre><code>Dim direction As XlSearchDirection\ndirection = xlNext\nSet rowNonBlankFound = Rows(rowToUse).Find(what:=\"*\", after:=Cells(rowToUse, leftMostCol), LookIn:=xlValues, SearchDirection:=direction)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1478687797, "creation_date": 1478687797, "answer_id": 40504912, "question_id": 40504669, "link": "https://stackoverflow.com/questions/40504669/find-putting-variable-in-searchdirection-causes-run-time-error-13-type-mism/40504912#40504912", "title": ".Find - putting variable in SearchDirection causes run-time error 13 - type mismatch", "body": "<p>Direction is an enumeration <a href=\"http://msdn.microsoft.com/en-us/library/office/ff841198.aspx\" rel=\"nofollow noreferrer\">enter link description here</a> needs to be a number or an enumeration equiv  </p>\n"}], "owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 40504901, "answer_count": 2, "score": 0, "last_activity_date": 1478687797, "creation_date": 1478687039, "last_edit_date": 1478687432, "question_id": 40504669, "link": "https://stackoverflow.com/questions/40504669/find-putting-variable-in-searchdirection-causes-run-time-error-13-type-mism", "title": ".Find - putting variable in SearchDirection causes run-time error 13 - type mismatch", "body": "<p>Why does this work:</p>\n\n<p><code>Set rowNonBlankFound = Rows(rowToUse).Find(what:=\"*\", after:=Cells(rowToUse, leftMostCol), LookIn:=xlValues, SearchDirection:=xlNext)</code></p>\n\n<p>But this doesn't:</p>\n\n<p><code>Dim direction As String\ndirection = \"xlNext\"\nSet rowNonBlankFound = Rows(rowToUse).Find(what:=\"*\", after:=Cells(rowToUse, leftMostCol), LookIn:=xlValues, SearchDirection:=direction)</code></p>\n\n<p>I get run-time error 13 - type mismatch?</p>\n"}, {"tags": ["vba", "libreoffice", "libreoffice-basic", "libreoffice-writer"], "answers": [{"tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1478846196, "last_edit_date": 1478846196, "creation_date": 1478845886, "answer_id": 40542358, "question_id": 40503974, "link": "https://stackoverflow.com/questions/40503974/duplicate-last-row-of-a-table-in-libreoffice-using-basic/40542358#40542358", "title": "Duplicate last row of a table in LibreOffice using BASIC", "body": "<p>First select the entire row by moving the <a href=\"https://wiki.openoffice.org/wiki/Writer/API/View_cursor\" rel=\"nofollow noreferrer\">View Cursor</a> over it.  Then use the dispatcher to copy and paste into a new row.  Something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>oVC.goRight(3, True)  'Extend the selection.\ndispatcher = createUnoService(\"com.sun.star.frame.DispatchHelper\")\ndispatcher.executeDispatch(document, \".uno:Copy\", \"\", 0, Array())\ndispatcher.executeDispatch(document, \".uno:InsertRowsAfter\", \"\", 0, Array())\noVC.goDown(1, False)  'Move to the new row.\noVC.goLeft(2, False)  'Move to the first column.\ndispatcher.executeDispatch(document, \".uno:Paste\", \"\", 0, Array())\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 478141, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e7e43759e3ab1641fe1ddabc7790effa?s=128&d=identicon&r=PG", "display_name": "cytrinox", "link": "https://stackoverflow.com/users/478141/cytrinox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478846196, "creation_date": 1478684995, "question_id": 40503974, "link": "https://stackoverflow.com/questions/40503974/duplicate-last-row-of-a-table-in-libreoffice-using-basic", "title": "Duplicate last row of a table in LibreOffice using BASIC", "body": "<p>I have a named table in a ODT document and want to duplicate the last row with all content into a new row (above), then replace some value in this duplicate.</p>\n\n<p>I've done this in Word/VBA already for DOCX:</p>\n\n<pre><code>Dim tbl As Table\nDim rowNew As Row\n\nSet tbl = ActiveDocument.Tables(1)\nSet rowNew = tbl.Rows.Add(tbl.Rows(tbl.Rows.Count))\nrowNew.Range.FormattedText = tbl.Rows(tbl.Rows.Count).Range.FormattedText\n'~~~&gt; This is required as the above code inserts a blank row in between\ntbl.Rows(tbl.Rows.Count - 1).Delete\nrowNew.Select\nSelection.Find.Execute FindText:=\"xx*\", ReplaceWith:=\"bar\", MatchWildcards:=True\nSelection.Collapse\n</code></pre>\n\n<p>Is this also possible in LibreOffice? So far, I have:</p>\n\n<pre><code>DIM tbl As Variant\nDIM row As Variant\ntbl =  ThisComponent.getTextTables().getByIndex(0)\nrow = tbl.getRows().getByIndex(tbl.getRows().getCount()-1)\n</code></pre>\n\n<p>How can I select and duplicate the whole <strong>row</strong> and run search&amp;replace on this new row? Hint: the row may contain other objects like subtables.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478684511, "post_id": 40503731, "comment_id": 68250540, "body": "You&#39;ve said the answer in your question AND, but I&#39;d use something lke your commented line, <code>If Right(x, 2) = &quot;30&quot; And x.offset(0,3).value&gt; 0 Then</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478687960, "post_id": 40503731, "comment_id": 68252674, "body": "Your range is wrong, you only need C in there, the offset moves to F and use X rather than cell again for the value comparison =&quot;30&quot;"}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478688528, "post_id": 40503731, "comment_id": 68252998, "body": "@Nathan_Sav Thank you.  Fixed and now working!!"}], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 0, "last_activity_date": 1478685285, "creation_date": 1478685285, "answer_id": 40504082, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns/40504082#40504082", "title": "VBA If with two criteria in two columns", "body": "<p>You were missing the <code>Next</code> statement in your second for <code>each loop</code>.\nThe two criterias can be taken together with this line:</p>\n\n<pre><code>If y &gt; 0 And Right(x, 2) = \"30\" Then\n</code></pre>\n\n<p>so the whole code would be...</p>\n\n<pre><code>Sub compile1()\nDim x As String\nDim y As Integer\nDim rSearch As Range\nDim rSearch1 As Range\nDim cell As Range, cell1 As Range\nDim matchRow As Integer\n\nSet rSearch = Sheets(\"Application\").Range(\"C:c\")\nSet rSearch1 = Sheets(\"Application\").Range(\"F:F\")\n\nFor Each cell In rSearch\n    x = cell.Value\n    For Each cell1 In rSearch1\n    y = cell1.Value\n        If y &gt; 0 And Right(x, 2) = \"30\" Then\n            matchRow = cell.Row\n            Rows(matchRow &amp; \":\" &amp; matchRow).Select\n            Selection.Copy\n\n            Sheets(\"sheet2\").Select\n            ActiveSheet.Rows(matchRow).Select\n            ActiveSheet.Paste\n            Sheets(\"Application\").Select\n        End If\n    Next cell1\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1478686365, "post_id": 40504305, "comment_id": 68251643, "body": "A further performance enhancement would be to use arrays, so <code>arr1=range(c1:c100).value</code>,<code>arr1=range(f1:f100).value</code>, then loop the arrays"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478686475, "post_id": 40504305, "comment_id": 68251715, "body": "@Nathan_Sav While arrays are usually a good way of improving performance, I don&#39;t think that&#39;s the case here (happy to be corrected though)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478687609, "post_id": 40504305, "comment_id": 68252465, "body": "array 16ms, range 31ms in my test of 7000 rows :)"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478687818, "post_id": 40504305, "comment_id": 68252588, "body": "@Nathan_Sav Well then, that&#39;s settled! :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1478687875, "post_id": 40504305, "comment_id": 68252617, "body": "I was doing something similar, not a pedantic argument :)"}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478687901, "post_id": 40504305, "comment_id": 68252630, "body": "Hi both, sorry to say this did not work, I&#39;ve updated the original post with my newer code..."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478688094, "post_id": 40504305, "comment_id": 68252747, "body": "@J.Zentner are you running 97-2003 version of excel?"}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478689849, "post_id": 40504305, "comment_id": 68253696, "body": "@Jeremy, I am running 2010 (64 bit)"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1478685966, "creation_date": 1478685966, "answer_id": 40504305, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns/40504305#40504305", "title": "VBA If with two criteria in two columns", "body": "<p>To speed things up I'd suggest the following:</p>\n\n<pre><code>Sub Copy_Paste()\nDim x As String\nDim y As Integer\nDim WS1 As Worksheet\n\nSet WS1 = ActiveSheet\ny = 1\nDo Until y &gt; WorksheetFunction.Max(Range(\"C1048576\").End(xlUp).Row, Range(\"F1048576\").End(xlUp).Row)\n    x = Trim(Cells(y, 3).Value)\n    If Right(x, 2) = \"30\" And (IsNumeric(Cells(y, 6).Value) And Cells(y, 6).Value &gt; 0) Then Rows(y &amp; \":\" &amp; y).Copy: Sheets(\"Sheet2\").Range(\"A\" &amp; Sheets(\"Sheet2\").Range(\"C1048576\").End(xlUp).Row + 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False: Application.CutCopyMode = False\n    y = y + 1\nLoop\n\nSheets(\"Sheet2\").Activate\nRange(\"A1\").Activate\nWS1.Activate\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478687445, "post_id": 40504427, "comment_id": 68252358, "body": "If I replace &lt;code&gt;x = cell.Value     If Right(x,2)=&quot;30&quot;Then ForEach cell1 In rSearch1y = cell1.Value     If y &gt;0Then&lt;/code&gt; with &lt;Code&gt;If Right(cell, 2) = &quot;30&quot; And cell.Offset(, 3) &gt; 0 Then&lt;/code&gt; then it correctly omits  rows where the value in col F is negative, however it is pulling through values where the last two digits in Col F happen to be 30. What I need is for only Col C&#39;s last two digits to be 30, and Col to be greater than 0."}, {"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "reply_to_user": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478691261, "post_id": 40504427, "comment_id": 68254460, "body": "Did you run my code, this is doing exactly what you you need."}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478691847, "post_id": 40504427, "comment_id": 68254794, "body": "All it did was add a filter in Col C with nothing selected."}, {"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "reply_to_user": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478692581, "post_id": 40504427, "comment_id": 68255218, "body": "change sheet2 to sheets(_destinationsheet)) to reflect changes in this line - Sheets(&quot;Application&quot;).Range(Cells(1, 1), Cells(lastrow, lastcol)).SpecialCells(xlCellTypeVisible).Copy Destination:=**Sheet2**.Range(&quot;A2&quot;)"}, {"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "reply_to_user": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478692621, "post_id": 40504427, "comment_id": 68255246, "body": "And, also, if possible, give your sheet to me, it will not take minutes for me to solve your problem."}], "tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": 0, "last_activity_date": 1478686307, "creation_date": 1478686307, "answer_id": 40504427, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns/40504427#40504427", "title": "VBA If with two criteria in two columns", "body": "<p>Try this code once - this is way too simpler and optimized processing than loops (slower)</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSheets(\"Application\").AutoFilterMode = False\n\nDim lastrow, lastcol As Integer\nlastrow = Range(\"F500000\").End(xlUp).Row\nlastcol = Sheets(\"Application\").Range(\"A1\").End(xlToRight).Column + 1\n\nSheets(\"Application\").Cells(1, lastcol).Value = \"helper\"\nSheets(\"Application\").Range(Sheets(\"Application\").Cells(1, lastcol),Sheets(\"Application\").Cells(lastrow, lastcol)).FormulaR1C1 = \"=Right(RC[-1],2)\"\n\nSheets(\"Application\").Range(Range(\"A1\"), Range(\"A1\").End(xlToRight)).AutoFilter Field:=lastcol, Criteria1:=\"30\"\nSheets(\"Application\").Range(Range(\"A1\"), Range(\"A1\").End(xlToRight)).AutoFilter Field:=3, Criteria1:=\"&gt;0\"\n\nSheets(\"Application\").Range(Cells(1, 1), Cells(lastrow, lastcol)).SpecialCells(xlCellTypeVisible).Copy Destination:=Sheet2.Range(\"A2\")\n\nColumns(lastcol).Delete\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1478688755, "post_id": 40505098, "comment_id": 68253132, "body": "You should avoid <code>.Select</code> instructions at all costs since it is slower and with a higher probability of occurring errors. You should also get your last row with information since looping all the rows until the end does not like very efficient..."}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "reply_to_user": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1478689786, "post_id": 40505098, "comment_id": 68253650, "body": "@Jeremy, do you have any other suggestions on how I can make it quicker?  I&#39;ve managed to get the entire code to work and paste when I need where I need it, but you are both right, it takes and age to run."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1478690441, "post_id": 40505098, "comment_id": 68254027, "body": "@J.Zentner something like my edit? if you don&#39;t like it you can roll it back"}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "reply_to_user": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1478690925, "post_id": 40505098, "comment_id": 68254275, "body": "@Jeremy, get a 424: Object required error on the new If Right...line"}, {"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "reply_to_user": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1478691515, "post_id": 40505098, "comment_id": 68254615, "body": "@Jeremy, removed the isNumeric, but now get an 438: Object doesnt support this property or Method on ln 9: sheets...  You&#39;ve also created Rng As Range but it is never called."}], "tags": [], "owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "is_accepted": false, "score": 0, "last_activity_date": 1478691308, "last_edit_date": 1478691308, "creation_date": 1478688398, "answer_id": 40505098, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns/40505098#40505098", "title": "VBA If with two criteria in two columns", "body": "<pre><code>Sub compile1()\nDim Cel As Range, Rng As Range\n\nSet rSearch = Sheets(\"Application\").Columns(\"C:C\").SpecialCells(xlCellTypeConstants, 23)\n\nFor Each Cel In rSearch\n   If Right(Trim(Cel.Value), 2) = \"30\" And (Cel.Offset(, 3).Value &gt; 0) Then\n        Cel.EntireRow.Copy\n        Sheets(\"Sheet2\").Range(\"A\" &amp; Sheets(\"Sheet2\").Range(\"C1048576\").End(xlUp).Row + 1).Paste\n        Application.CutCopyMode = False\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "is_accepted": false, "score": 0, "last_activity_date": 1478690019, "creation_date": 1478690019, "answer_id": 40505621, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns/40505621#40505621", "title": "VBA If with two criteria in two columns", "body": "<p>Here is the entire code. It works but takes ages to run.  Any help to speed it up would be appreciated. </p>\n\n<pre><code>Sub Master()\nCall compile1\nCall compile2\nEnd Sub\nSub compile1()\nFor Each cell In Sheets(\"Application\").Range(\"C:C\")\n    If Right(cell.Value, 2) = \"10\" Then\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"Routine w credits\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Application\").Select\n    End If\nNext\n\nFor Each cell In Sheets(\"Application\").Range(\"C:C\")\n    If Right(cell.Value, 2) = \"20\" Then\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"Reactive w credits\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Application\").Select\n    End If\nNext\n\nEnd Sub\n\nSub compile2()\n\nSet rSearch = Sheets(\"Application\").Range(\"C:C\")\n\nFor Each cell In rSearch\n\n   If Right(cell, 2) = \"20\" And cell.Offset(, 3) &gt; 0 Then\n\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"Reactive wo credits\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Application\").Select\n    End If\n\nNext\n\nFor Each cell In rSearch\n\n   If Right(cell, 2) = \"10\" And cell.Offset(, 3) &gt; 0 Then\n\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"Routine wo credits\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Application\").Select\n    End If\n\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "edited": false, "score": 0, "creation_date": 1478768265, "post_id": 40506601, "comment_id": 68287349, "body": "The data starts in Col A and ends Col L, I need the entire row copied if the criteria is met, not just the two cells."}], "tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": true, "score": 1, "last_activity_date": 1478771600, "last_edit_date": 1478771600, "creation_date": 1478693058, "answer_id": 40506601, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns/40506601#40506601", "title": "VBA If with two criteria in two columns", "body": "<p>Here you go:</p>\n\n<pre><code>Sub CP()\n\nDim i As Long\nDim n As Long\n\nn = Sheets(\"Application\").Cells(Rows.Count, 3).End(xlUp).Row\n\nFor i = 1 To n\n    With Sheets(\"Application\")\n        If Right(Cells(i, 3), 2) = 30 And Cells(i, 6).Value &gt; 0 Then\n            .Cells(i, 3).EntireRow.Copy Destination:=Sheets(\"Sheet3\").Cells(i, 3)\n            .Cells(i, 6).EntireRow.Copy Destination:=Sheets(\"Sheet3\").Cells(i, 6)\n        End If\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I have used column 3 to count the number of rows and hence assumed this is the main column</p>\n"}], "owner": {"reputation": 25, "user_id": 7135601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896c63297e70feea7f76de894a02b42?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zentner", "link": "https://stackoverflow.com/users/7135601/j-zentner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 40506601, "answer_count": 6, "score": 0, "last_activity_date": 1478771600, "creation_date": 1478684204, "last_edit_date": 1478688453, "question_id": 40503731, "link": "https://stackoverflow.com/questions/40503731/vba-if-with-two-criteria-in-two-columns", "title": "VBA If with two criteria in two columns", "body": "<p>I need to look at two cells (C and F) on a each row, and if the value for C to ends with 30 and the value for F is greater than Zero, copy and paste the row to another sheet.  I've managed to get the copy and paste to work using 1 criteria, but I cannot figure out how to get both criteria to work together.</p>\n\n<pre><code>Sub compile1()\n    Dim x As String\n\nSet rSearch = Sheets(\"Application\").Range(\"C:C\")\n\n\nFor Each cell In rSearch\nx = cell.Value\n       If Right(cell, 2) = \"30\" And cell.Offset(, 3) &gt; 0 Then\n\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"sheet2\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Application\").Select\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478683868, "post_id": 40503511, "comment_id": 68250186, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/microsoft.visualbasic.appwinstyle(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>  you are using send keys in the application, so Excel, you need to get the object and then use it&#39;s send keys"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1478693147, "post_id": 40503511, "comment_id": 68255530, "body": "Which application are you trying to control / automate? It is hard to suggest anything without knowing the app. Maybe the app cannot be hidden? Maybe there is a simple switch you need to pass to the <code>Shell</code> to make it start / run in hidden mode? Maybe there is even a DLL available you can reference in the VBE for direct access to the app. Then you won&#39;t have to use <code>SendKeys</code> anymore."}, {"owner": {"reputation": 17, "user_id": 6037440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N5u2YlSgCxU/AAAAAAAAAAI/AAAAAAAAAD8/KelQXPrPODc/photo.jpg?sz=128", "display_name": "Naveen Umashankar", "link": "https://stackoverflow.com/users/6037440/naveen-umashankar"}, "edited": false, "score": 0, "creation_date": 1478765110, "post_id": 40503511, "comment_id": 68285793, "body": "Hi Ralph, I am using an application called DPS which is given by clients and doesn&#39;t have any reference. I don&#39;t have permission to make any modifications to the application as well."}], "owner": {"reputation": 17, "user_id": 6037440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N5u2YlSgCxU/AAAAAAAAAAI/AAAAAAAAAD8/KelQXPrPODc/photo.jpg?sz=128", "display_name": "Naveen Umashankar", "link": "https://stackoverflow.com/users/6037440/naveen-umashankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 819, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478683471, "creation_date": 1478683471, "question_id": 40503511, "link": "https://stackoverflow.com/questions/40503511/how-to-open-an-application-in-background-using-vba", "title": "How to open an application in background using vba", "body": "<p>I am trying to automate a task at work and I will have to perform certain operations in an application. Since I am automating the stuff, I don't want the application to be visible to the user as I'll perform my operations in the background. I am controlling the application using keyboard commands.</p>\n\n<p>`</p>\n\n<pre><code>Private Sub DPS_Click()\nDim x As Variant\n\nDim Path As String\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\n    .EnableEvents = False\nEnd With\n\n'Set the Path variable equal to the path of your program's installation\nPath = \"C:\\xyz\\xyz.exe\"\nx = Shell(Path, vbNormalFocus)\nApplication.SendKeys (\"%as\")\nApplication.SendKeys (....)\nApplication.SendKeys (.....)\nWith Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\n    .EnableEvents = True\nEnd With`\n</code></pre>\n\n<p>But the application is still visible to the user and the operations are not done in the background. Any Inputs are welcome. Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1478683208, "post_id": 40503380, "comment_id": 68249844, "body": "I would suggest putting some error trapping in the code to see what the error actually is. You also need to make sure that your change event is actually triggering."}, {"owner": {"reputation": 23, "user_id": 7135555, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210715538433837/picture?type=large", "display_name": "Sonwarbo McKasie", "link": "https://stackoverflow.com/users/7135555/sonwarbo-mckasie"}, "edited": false, "score": 0, "creation_date": 1478683902, "post_id": 40503380, "comment_id": 68250212, "body": "sorry about that am new in the vacinity"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1478684718, "post_id": 40503380, "comment_id": 68250669, "body": "What is the error?"}, {"owner": {"reputation": 23, "user_id": 7135555, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210715538433837/picture?type=large", "display_name": "Sonwarbo McKasie", "link": "https://stackoverflow.com/users/7135555/sonwarbo-mckasie"}, "edited": false, "score": 0, "creation_date": 1478685984, "post_id": 40503380, "comment_id": 68251436, "body": "Select method of Range class failed via VBA...refering to the line below the for loop."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7135555, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210715538433837/picture?type=large", "display_name": "Sonwarbo McKasie", "link": "https://stackoverflow.com/users/7135555/sonwarbo-mckasie"}, "edited": false, "score": 0, "creation_date": 1478685764, "post_id": 40503524, "comment_id": 68251308, "body": "How do i code vba to populate my form from my a list selection where my data is in another worksheet?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 7135555, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210715538433837/picture?type=large", "display_name": "Sonwarbo McKasie", "link": "https://stackoverflow.com/users/7135555/sonwarbo-mckasie"}, "edited": false, "score": 0, "creation_date": 1478686688, "post_id": 40503524, "comment_id": 68251859, "body": "Hi. For this one I need the VBA code and a screenshot plus explanations concerning the names of the list you are using. This sounds like another question, so it is probably better to ask it separately. Just remember - format your code wisely, use <code>Option Explicit</code> and Ctrl+K in stackoverflow. Enjoy!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1478683508, "creation_date": 1478683508, "answer_id": 40503524, "question_id": 40503380, "link": "https://stackoverflow.com/questions/40503380/vba-error-somewhere-in-this-code-that-it-doesnt-allow-my-code-to-run/40503524#40503524", "title": "Vba error somewhere in this code that it doesn&#39;t allow my code to run", "body": "<p>There are many possible answers. The most probable is that you should change:</p>\n\n<p><code>Cells(i, 1).Select</code> to \n<code>Sheets(\"CustomerList\").Cells(i, 1).Select</code></p>\n\n<p>Others are - check whether you have values in the range variables and whether the sheets exists as named. Furthermore, use <code>Option Explicit</code> on top to make sure you write one idea better code. </p>\n"}], "owner": {"reputation": 23, "user_id": 7135555, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210715538433837/picture?type=large", "display_name": "Sonwarbo McKasie", "link": "https://stackoverflow.com/users/7135555/sonwarbo-mckasie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 40503524, "answer_count": 1, "score": 0, "last_activity_date": 1478906340, "creation_date": 1478683064, "last_edit_date": 1531164843, "question_id": 40503380, "link": "https://stackoverflow.com/questions/40503380/vba-error-somewhere-in-this-code-that-it-doesnt-allow-my-code-to-run", "title": "Vba error somewhere in this code that it doesn&#39;t allow my code to run", "body": "<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)    \n Dim CustNumber As String    \n  Dim CustName As String    \n  Dim CompanyName As String    \n  Dim    CustPhoneNumb As String    \n  Dim i As Long      \n  CustNumber = Worksheets(\"OrderInvoice\").Range(\"C10\").Value    \n  Sheets(\"CustomerList\").Select\n  FoundDatails = False    \n  i = 1    \n  For i = 1 To 100    \n    Cells(i, 1).Select    \n    If CustNumber = Trim(Cells(i, 1)) Then    \n      CustName = Trim(Cells(i, 2))    \n      CompanyName = Trim(Cells(i, 3))    \n      CustPhoneNumb = Trim(Cells(i, 4))    \n      FoundDatails = True    \n      Exit For    \n    Else    \n      i = i    \n    End If    \n  Next      \n  Sheets(\"OrderInvoice\").Select      \n  Range(\"C11:F11\") = CustName    \n  Range(\"I11:J11\") = CustPhoneNumb    \n  Range(\"C12:J12\") = CompanyName    \nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11618, "user_id": 4964923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Q3Dk.jpg?s=128&g=1", "display_name": "Jaydip Jadhav", "link": "https://stackoverflow.com/users/4964923/jaydip-jadhav"}, "is_accepted": true, "score": 1, "last_activity_date": 1478686341, "creation_date": 1478686341, "answer_id": 40504437, "question_id": 40502908, "link": "https://stackoverflow.com/questions/40502908/ms-access-sql-return-data-from-1-table-based-on-a-summed-total-in-another-table/40504437#40504437", "title": "MS Access SQL: Return data from 1 table based on a summed total in another table", "body": "<p>You may looking for this Select Command</p>\n\n<pre><code>SELECT MC,Description\nFROM Table_A \nWHERE MC IN (SELECT MC FROM Table_B GROUP BY MC HAVING SUM(Quantity) &gt; 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1478687489, "creation_date": 1478687489, "answer_id": 40504824, "question_id": 40502908, "link": "https://stackoverflow.com/questions/40502908/ms-access-sql-return-data-from-1-table-based-on-a-summed-total-in-another-table/40504824#40504824", "title": "MS Access SQL: Return data from 1 table based on a summed total in another table", "body": "<p>Why don't you use the query designer?</p>\n\n<p>First create your base query on Table_B, group by MC and Sum(Quantity) > 0.</p>\n\n<p>Then join the result with Table_A on MC.</p>\n\n<p>When you have this working, you can take the SQL from the queries, and build a dynamic SQL in VBA from it (with the first query being a part of the join).  </p>\n\n<p>But you seem to be trying to do it the other way around, this is not the best idea.</p>\n"}], "owner": {"reputation": 23, "user_id": 7135379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3af9a5639884de763491e79989a59e?s=128&d=identicon&r=PG&f=1", "display_name": "B Haysom", "link": "https://stackoverflow.com/users/7135379/b-haysom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 40504437, "answer_count": 2, "score": 1, "last_activity_date": 1478687489, "creation_date": 1478681400, "last_edit_date": 1478686699, "question_id": 40502908, "link": "https://stackoverflow.com/questions/40502908/ms-access-sql-return-data-from-1-table-based-on-a-summed-total-in-another-table", "title": "MS Access SQL: Return data from 1 table based on a summed total in another table", "body": "<p>I have 2 MS Access tables:</p>\n\n<p>Table_A (2 fields)        </p>\n\n<pre><code>MC    Description           \n1234   Item_1             \n2345   Item_2            \n3456   Item_3 \n</code></pre>\n\n<p>Table_B (3 fields)  </p>\n\n<pre><code>MC    Location  Quantity  \n1234   AAA        0  \n1234   BBB        0  \n1234   CCC        1  \n2345   AAA        0  \n2345   BBB        0  \n2345   CCC        0  \n3456   AAA        1  \n3456   BBB        1  \n3456   CCC        1 \n</code></pre>\n\n<p>I am trying to return items from Table_A where the SUM of Quantity (for a given MC) in Table_B > 0</p>\n\n<p>From the above data the following would be returned.</p>\n\n<p>MC     Description<br>\n1234---Item_1<br>\n3456---Item_3  </p>\n\n<p>If the query were changed to = 0 then only MC 2345 would be returned.<br>\nIf the query were changed to = 1 then only MC 1234 would be returned.</p>\n\n<p>My current attempt is as follows for an = 0 query; however, if using the above data it returns MC 1234 and 2345 when the correct return would be only 2345</p>\n\n<pre><code>Query1 = \"SELECT mat_MaterielCode, mat_DescriptionShort \" &amp; _\n    \"FROM mat_MaterielMaster \" &amp; _\n    \"INNER JOIN mml_MaterielMasterLocation \" &amp; _\n    \"ON mat_MaterielMaster.mat_MaterielCode = mml_MaterielMasterLocation.mml_MaterielCode \" &amp; _\n    \"WHERE (([mat_MaterielMaster]![mat_SpareClass] IN ('OBS')) AND ([mml_MaterielMasterLocation]![mml_SOH]=0)) \" &amp; _\n    \"GROUP BY mat_MaterielMaster.mat_MaterielCode, mat_MaterielMaster.mat_DescriptionShort \"\n</code></pre>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 66, "user_id": 4534746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9419c142719689fbb84acacc4a9a8df5?s=128&d=identicon&r=PG&f=1", "display_name": "matellan", "link": "https://stackoverflow.com/users/4534746/matellan"}, "edited": false, "score": 0, "creation_date": 1478683278, "post_id": 40501651, "comment_id": 68249872, "body": "What data type has the zeiDat Field?"}, {"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "reply_to_user": {"reputation": 66, "user_id": 4534746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9419c142719689fbb84acacc4a9a8df5?s=128&d=identicon&r=PG&f=1", "display_name": "matellan", "link": "https://stackoverflow.com/users/4534746/matellan"}, "edited": false, "score": 0, "creation_date": 1478684507, "post_id": 40501651, "comment_id": 68250538, "body": "Date/Time (guess it&#39;s called like that, using the German Version)"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1478688435, "creation_date": 1478688435, "answer_id": 40505107, "question_id": 40501651, "link": "https://stackoverflow.com/questions/40501651/sql-query-from-excel-via-vba-to-access-date-specific/40505107#40505107", "title": "SQL Query from Excel via VBA to Access (date specific)", "body": "<p>You need to use an unambiguous format for the string expressions of the date values:</p>\n\n<pre><code>start = Application.WorksheetFunction.Text(Cells(3, 2), \"yyyy/mm/dd\")\nende = Application.WorksheetFunction.Text(Cells(4, 2), \"yyyy/mm/dd\")\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "accepted_answer_id": 40505107, "answer_count": 1, "score": 0, "last_activity_date": 1488269378, "creation_date": 1478675356, "last_edit_date": 1531164843, "question_id": 40501651, "link": "https://stackoverflow.com/questions/40501651/sql-query-from-excel-via-vba-to-access-date-specific", "title": "SQL Query from Excel via VBA to Access (date specific)", "body": "<p>For testing purposes, I am trying to get some data from an MS Access table to a recordset in Excel using vba and SQL (direction: Excel + VBA to Access). </p>\n\n<p>The MS Access table is called <code>T_Zeiten</code> and one column is called <code>zeiDat</code> which contains dates (European style like 09.11.2016).</p>\n\n<p>What I want to do is opening a connection, look for all entries between two specific dates and write them to a recordset. I already managed to open a connection but struggle with the date stuff (US-style dates). The \"From\" and \"To\" dates in Excel are also formatted as \"dd.mm.yyyy\".</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Dim cn As Object\nDim ZeitenArbeitenGrob As Recordset\nDim strSqlZeitenArbeitenGrob As String\nDim start As String\nDim ende As String\nstart = Application.WorksheetFunction.Text(Cells(3, 2), \"dd/mm/yyyy\")\nende = Application.WorksheetFunction.Text(Cells(4, 2), \"dd/mm/yyyy\")\nDim strConnection As String\ncelllocation = 6\nSet cn = CreateObject(\"ADODB.Connection\")\nstrConnection = \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n\"Data Source=C:\\Users\\mj\\Downloads\\Neuer Ordner (2)\\ZeitErfKonst.mdb\"\nstrSqlZeitenArbeitenGrob = \"SELECT COUNT(zeiDat) FROM T_Zeiten WHERE [zeiDat] BETWEEN #\" &amp; start &amp; \"# And #\" &amp; ende &amp; \"#\"\ncn.Open strConnection\nSet ZeitenArbeitenGrob = cn.Execute(strSqlZeitenArbeitenGrob)\nMsgBox ZeitenArbeitenGrob.Fields(0)\n</code></pre>\n\n<p>There are 15 entries but the messagebox shows me 213 and I don't know why.</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2013"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478677559, "post_id": 40501506, "comment_id": 68247479, "body": "How do you mean type conflict?  Also you can just use <code>if rst.state&lt;&gt;adstateclosed then rst.close</code>"}, {"owner": {"reputation": 15, "user_id": 6838312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc9477367bef9ac9123d37ce5931e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "andrklein123", "link": "https://stackoverflow.com/users/6838312/andrklein123"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478678571, "post_id": 40501506, "comment_id": 68247837, "body": "@Nathan_Sav If i write on my excel-file something in the field audit (text) and want to upload it to sharepoint there is a error: runtime error -2147352571 (80020005). type conflict. any other field (single line of text on sharepoint) is working only the one specific field (lookup column on sharepoint) isn&#39;t"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478679409, "post_id": 40501506, "comment_id": 68248151, "body": "try debug window rst.Fields(&quot;audit&quot;).type then look at the ado types, it may be something that you need to format, guessing a date/time? <a href=\"http://www.w3schools.com/asp/ado_datatypes.asp\" rel=\"nofollow noreferrer\">w3schools.com/asp/ado_datatypes.asp</a>"}, {"owner": {"reputation": 15, "user_id": 6838312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc9477367bef9ac9123d37ce5931e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "andrklein123", "link": "https://stackoverflow.com/users/6838312/andrklein123"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478681065, "post_id": 40501506, "comment_id": 68248775, "body": "if i get the raw data from the sharepoint list i got for the lookup column for example: 13 | Item instead of the text that is stored in the list. on Sharepoint i see: N. America on my excel file i see 13 | Item (in two different cells after one synchronisation)// and in my excel file i write text. i think this is the mismatch."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478682637, "post_id": 40501506, "comment_id": 68249546, "body": "mySQL = &quot;SELECT * FROM [interactive_turtle];&quot;  once this has been opened to a recordset, use the .type from the field to get its type, based on what you are saying it looks like N.America is the item with an index in another table of 13?"}], "owner": {"reputation": 15, "user_id": 6838312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc9477367bef9ac9123d37ce5931e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "andrklein123", "link": "https://stackoverflow.com/users/6838312/andrklein123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478674630, "creation_date": 1478674630, "question_id": 40501506, "link": "https://stackoverflow.com/questions/40501506/adodb-excel-vba-addnew-typeconflict-lookup-column", "title": "ADODB - Excel - VBA: AddNew Typeconflict Lookup Column", "body": "<p>I have a problem. I have a Sharepoint 2013 teamsite and a Excel 2010 installation. I'm using the Microsoft Active X Data Objects 2.8 Library; Data Objects 6.1 and Data Objects Recordset 6.0/2.8 are also available but not used/tryed yet.</p>\n\n<p>At my sharepoint list i have one lookup column to make a connections between the two lists.</p>\n\n<p>No I'm using following code to put some entrys with a click on a button on my sharepoint list.</p>\n\n<pre><code>Option Explicit\n\nSub AddNewEntry()\n\nDim cnt As ADODB.Connection\nDim rst As ADODB.Recordset\n\nDim mySQL As String\n\nSet cnt = New ADODB.Connection\nSet rst = New ADODB.Recordset\n\nmySQL = \"SELECT * FROM [interactive_turtle];\"\n\nWith cnt\n    .ConnectionString = _\n    \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;DATABASE=xxxxxxxxxxxxx;LIST={xxxxxxxxxxxx};\"\n    .Open\nEnd With\n\nrst.Open mySQL, cnt, adOpenDynamic, adLockOptimistic\n\nrst.AddNew\n    rst.Fields(\"process\") = [E6]\n    rst.Fields(\"output\") = [H6]\n    rst.Fields(\"Input\") = [B6]\n    rst.Fields(\"rules\") = [H10]\n    rst.Fields(\"personal\") = [H2]\n    rst.Fields(\"material\") = [B2]\n    rst.Fields(\"xxxxxxxxx\") = [B10]\n    rst.Fields(\"audit\") = [E10]\nrst.Update\n\nIf CBool(rst.State And adStateOpen) = True Then rst.Close\nSet rst = Nothing\nIf CBool(cnt.State And adStateOpen) = True Then cnt.Close\nSet cnt = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>the lookup column is: rst.Fields(\"audit\") = [E10].</p>\n\n<p>If I run this code there is a type conflict for the lookup column. How can i fix this and put some entry in the lookup column?</p>\n\n<p>~~~~~~\nIf you know something with another connector or another method to put data from excel to sharepoint let me know. I'm not fixed using ADODB!\n~~~~~~</p>\n\n<p>Thanks in advance.</p>\n\n<p>Best wishes </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1478685202, "post_id": 40501313, "comment_id": 68250967, "body": "Have a look at the value of <code>rngCell</code> when the error is thrown - if there&#39;s no space in the name then <code>intLocation</code> will be 0 and the <code>LEFT</code> function will try and return -1 characters from <code>rngCell</code> causing an error.  Another possible option - any names have a leading space at the start?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7106833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232275c413f2030e9bccd05b042d1730?s=128&d=identicon&r=PG&f=1", "display_name": "TommyBoy116", "link": "https://stackoverflow.com/users/7106833/tommyboy116"}, "edited": false, "score": 0, "creation_date": 1478699847, "post_id": 40501426, "comment_id": 68259467, "body": "Thank you for your help. Much appreciated."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1478674242, "creation_date": 1478674242, "answer_id": 40501426, "question_id": 40501313, "link": "https://stackoverflow.com/questions/40501313/excel-workbook-trouble/40501426#40501426", "title": "Excel Workbook Trouble", "body": "<p>The following code will split the values in column A into Columns A and B (last and first name) :</p>\n\n<pre><code>Option Explicit\n\nPublic Sub BreakNameApart()\n\n    'declare variables and assign address to Worksheet object variable\n    Dim intLocation As Integer, shtConsult As Worksheet, rngCell As Range\n\n    Set shtConsult = _\n        Application.Workbooks(\"Franklin Consultants.xls\").Worksheets(\"Consultants\")\n\n    shtConsult.Columns(\"b\").Insert\n    shtConsult.Range(\"a4\").Value = \"Last Name\"\n    shtConsult.Range(\"b4\").Value = \"First Name\"\n    shtConsult.Range(\"a4:b4\").Font.Bold = True\n\n    'beginning in cell A5, seperate each full name into last and first name\n    Set rngCell = shtConsult.Range(\"a5\")\n\n    Do Until rngCell.Value = \"\"\n        'find location of space\n        intLocation = InStr(1, rngCell.Value, \" \")\n\n        If intLocation &gt; 0 Then ' space found\n            'assign first name to appropriate cell in column B\n            rngCell.Offset(0, 1).Value = Left(rngCell.Value, intLocation - 1)\n\n            'assign last name to current cell\n            rngCell.Value = Mid(rngCell.Value, intLocation + 1)\n        End If\n        'assign the address of the cell in the next row to the rngCell variable\n        Set rngCell = rngCell.Offset(1, 0)\n    Loop\n\n   'adjust the width of columns A and B\n   shtConsult.Columns(\"a:b\").AutoFit\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7106833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232275c413f2030e9bccd05b042d1730?s=128&d=identicon&r=PG&f=1", "display_name": "TommyBoy116", "link": "https://stackoverflow.com/users/7106833/tommyboy116"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 40501426, "answer_count": 1, "score": 0, "last_activity_date": 1478674242, "creation_date": 1478673665, "last_edit_date": 1478673766, "question_id": 40501313, "link": "https://stackoverflow.com/questions/40501313/excel-workbook-trouble", "title": "Excel Workbook Trouble", "body": "<p>Everything is good up until I get to the loop. </p>\n\n<p>Once I get to the loop it runs through it's cycle adjusting the first name and last names into two different columns, but then, for some reason, it gives me an error. I can't figure out why.</p>\n\n<p>Code below:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub BreakNameApart()\n    'declare variables and assign address to Worksheet object variable\n    Dim intLocation As Integer, shtConsult As Worksheet, rngCell As Range\n    Set shtConsult = _\n        Application.Workbooks(\"Franklin Consultants.xls\").Worksheets(\"Consultants\")\n    shtConsult.Columns(\"b\").Insert\n    shtConsult.Range(\"a4\").Value = \"Last Name\"\n    shtConsult.Range(\"b4\").Value = \"First Name\"\n    shtConsult.Range(\"a4:b4\").Font.Bold = True\n    'beginning in cell A5, seperate each full name into last and first name\n    Set rngCell = shtConsult.Range(\"a5\")\n    Do Until rngCell.Value = \"\"\n        'find location of space\n        intLocation = InStr(1, rngCell.Value, \" \")\n        'assign first name to appropriate cell in column B\n        rngCell.Offset(columnoffset:=1).Value = _\n                Left(String:=rngCell.Value, Length:=intLocation - 1)\n        'assign last name to current cell\n        rngCell.Value = Mid(String:=rngCell.Value, Start:=intLocation + 1)\n        'assign the address of the cell in the next row to the rngCell variable\n        Set rngCell = rngCell.Offset(rowoffset:=1)\n    Loop\n   'adjust the width of columns A and B\n   shtConsult.Columns(\"a:b\").AutoFit\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Most notably it gives me an error here:</p>\n\n<pre><code>rngCell.Offset(columnoffset:=1).Value = _\n                Left(String:=rngCell.Value, Length:=intLocation - 1)\n</code></pre>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "edited": false, "score": 0, "creation_date": 1478671522, "post_id": 40500566, "comment_id": 68245448, "body": "Here is not such a place just &quot;give me code&quot;. Have you tried at first? Did you write any formula or VBA code?"}, {"owner": {"reputation": 13, "user_id": 6940605, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1d6bbc97054f784888d02dad8e03072?s=128&d=identicon&r=PG&f=1", "display_name": "rajendra kodavaty", "link": "https://stackoverflow.com/users/6940605/rajendra-kodavaty"}, "reply_to_user": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "edited": false, "score": 0, "creation_date": 1478677208, "post_id": 40500566, "comment_id": 68247349, "body": "@bzimor. I write codes using relative references and modifying them using IF and dowhile loops.`Sub Vcpy() &#39; &#39; Vcpy Macro If ActiveCell.Value &lt;&gt; Empty Then Do While ActiveCell.Value &lt;&gt; Empty     ActiveCell.Offset(1, 0).Rows(&quot;1:1&quot;).EntireRow.Select     Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove     ActiveCell.Offset(-1, 4).Range(&quot;A1&quot;).Select     Selection.Copy     ActiveCell.Offset(1, -1).Range(&quot;A1&quot;).Select     ActiveSheet.Paste     Application.CutCopyMode = False     ActiveCell.Offset(1, 1).Range(&quot;A1&quot;).Select     Loop End If End Sub"}, {"owner": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "edited": false, "score": 0, "creation_date": 1478677955, "post_id": 40500566, "comment_id": 68247624, "body": "ok, put your code in question context, if there is any error, then ask to troubleshoot"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1478684971, "post_id": 40500566, "comment_id": 68250825, "body": "Please add your code to the question so it is readable."}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1478686181, "creation_date": 1478686181, "answer_id": 40504382, "question_id": 40500566, "link": "https://stackoverflow.com/questions/40500566/insert-a-row-based-on-length-of-the-string-in-cell/40504382#40504382", "title": "Insert a row based on length of the string in cell", "body": "<p>I have no idea how to make your code work, but I have a different solution. Verified on your given example dataset.</p>\n\n<pre><code>Sub RowSplitter()\n    Dim rng As Range\n    Dim arr() As String\n    Dim str As String\n\n    Set rng = Range(\"A1\")\n\n    Do While (rng.Value &lt;&gt; \"\")\n        ' Determine if we need to split\n        If Len(rng.Value) &gt; 6 Then\n            ' Split values into an array\n            arr() = Split(rng.Value, \"+\")\n\n            For i = 1 To UBound(arr())\n                str = \"\"\n\n                ' Insert row\n                rng.Offset(i).Insert Shift:=xlDown\n\n                ' Calculate string to insert from array\n                If Len(arr(i)) &lt; 4 Then str = Left(arr(0), 3)\n                str = str &amp; arr(i)\n\n                ' Enter value from array\n                rng.Offset(i).Value = str\n            Next i\n\n            rng.Value = arr(0)\n        End If\n\n        Set rng = rng.Offset(1)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6940605, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1d6bbc97054f784888d02dad8e03072?s=128&d=identicon&r=PG&f=1", "display_name": "rajendra kodavaty", "link": "https://stackoverflow.com/users/6940605/rajendra-kodavaty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478686181, "creation_date": 1478669040, "last_edit_date": 1531161705, "question_id": 40500566, "link": "https://stackoverflow.com/questions/40500566/insert-a-row-based-on-length-of-the-string-in-cell", "title": "Insert a row based on length of the string in cell", "body": "<p>How could i insert a row based on the row value for example\nI have the following cases in the cells</p>\n\n<pre><code>SFF465\nSFF465+466\nSFF466+467+468+469\nSFF469+DFG234\nDFG235\nDFG236+237+238+239\n</code></pre>\n\n<p>If there are or more values in the same cell i want to insert a new row for second batch. For example in first row there should not be any change but in second row both the batches need to split in different rows.I need <code>SFF465</code> in second row and <code>SFF 466</code> in third row.Thus the second row will change from <code>SFF465+466</code> to <code>SFF465</code> only.</p>\n\n<p>Same thing goes for Current third row which has four numbers and want to split them individually as <code>SFF466</code>, <code>SFF467</code>, <code>SFF468</code>, <code>SFF469</code> below the current rows.</p>\n\n<p>In the fourth row you can see, two different products. I want to split the by adding another row right below the current fourth row. Hence converting current Fourth row to <code>SFF469</code> and fifth row as <code>DFG234</code>.</p>\n\n<p>Desired format would be</p>\n\n<pre><code>SFF465\nSFF465\nSFF466\nSFF466\nSFF467\nSFF468\nSFF469\nSFF469\nDFG234\nDFG235\nDFG236\nDFG237\nDFG238\nDFG239\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>I have written code using relative references and modifying them using <code>If Then</code> and <code>Do While</code> loops.</p>\n\n<pre><code>Sub Vcpy() \n' ' Vcpy Macro\n\n    If ActiveCell.Value &lt;&gt; Empty Then \n\n        Do While ActiveCell.Value &lt;&gt; Empty\n\n         ActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select \n         Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove    \n         ActiveCell.Offset(-1, 4).Range(\"A1\").Select\n         Selection.Copy\n         ActiveCell.Offset(1, -1).Range(\"A1\").Select\n         ActiveSheet.Paste Application.CutCopyMode = False \n         ActiveCell.Offset(1, 1).Range(\"A1\").Select\n\n       Loop \n\n   End If \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1478668995, "post_id": 40500489, "comment_id": 68244772, "body": "You&#39;ve got fairly sophisticated code here (it clearly wasn&#39;t written by a beginner), so why don&#39;t you tell what you&#39;ve done to debug it? Also, while you&#39;ve showed your inputs and desired outputs, you don&#39;t indicate what the <i>actual output</i> is, nor explain how it differs from your expectations."}, {"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478669627, "post_id": 40500489, "comment_id": 68244924, "body": "The actual output is exactly as you see in the second picture. I should be seeing 3893 in cell E4 in the second picture, along with a bunch of different numbers in the rest of the highlighted cells. Most of the code was not written by me, which is why I&#39;m struggling to understand exactly how it is working. The only problem I have is defining which rows go into each key in the dictionary."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478670267, "post_id": 40500489, "comment_id": 68245109, "body": "You need to include the code for <code>PopSummaryRT</code>"}, {"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "edited": false, "score": 0, "creation_date": 1478671999, "post_id": 40500489, "comment_id": 68245596, "body": "You mean include it in the question? Edited it in."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1478673869, "creation_date": 1478673869, "answer_id": 40501355, "question_id": 40500489, "link": "https://stackoverflow.com/questions/40500489/dictionary-item-cell-value-in-last-row-in-column-for-each-grouping/40501355#40501355", "title": "dictionary item = cell value in last row in column for each grouping", "body": "<p>change</p>\n\n<pre><code>For r = 1 To UBound(d, 1)\n    k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n    dBT(k) = Cells(r, COL_RT).Value '&lt;--| wrong line\nNext r\n</code></pre>\n\n<p>to </p>\n\n<pre><code>For r = 1 To UBound(d, 1)\n    k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n    dBT(k) = d(r, COL_RT) '&lt;--| corrected line\nNext r\n</code></pre>\n\n<p>since <code>Cells</code> is referencing <em>all</em> active worsheet cells, thus ranging from cell \"A1\" <em>on</em>, while your relevant values are collected from cell \"B7\" on</p>\n"}], "owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 40501355, "answer_count": 1, "score": 0, "last_activity_date": 1478673869, "creation_date": 1478668384, "last_edit_date": 1478670903, "question_id": 40500489, "link": "https://stackoverflow.com/questions/40500489/dictionary-item-cell-value-in-last-row-in-column-for-each-grouping", "title": "dictionary item = cell value in last row in column for each grouping", "body": "<p>This is my code:</p>\n\n<pre><code>Dim dBT As Object 'global dictionary\n\nSub buttonpresscount()\n\n    'constants for column positions\n    Const COL_BLOCK As Long = 1\n    Const COL_TRIAL As Long = 2\n    Const COL_ACT As Long = 7\n    Const COL_AOI As Long = 8\n    Const COL_RT As Long = 16\n\n    Dim rng As Range, lastrow As Long, sht As Worksheet\n    Dim d, r As Long, k, resBT()\n\n    Set sht = Worksheets(\"full test\")\n    lastrow = Cells(Rows.Count, 3).End(xlUp).Row\n    Set dBT = CreateObject(\"scripting.dictionary\")\n\n    Set rng = sht.Range(\"B7:Q\" &amp; lastrow)\n\n    d = rng.Value  'get the data into an array\n\n    ReDim resBT(1 To UBound(d), 1 To 1) 'resize the array which will\n                                        '  be placed in ColT\n\n    'get unique combinations of Block and Trial and pressedcounts for each\n    For r = 1 To UBound(d, 1)\n        k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        dBT(k) = dBT(k) + IIf(d(r, COL_ACT) &lt;&gt; \"\", 1, 0)\n    Next r\n\n    'populate array with appropriate counts for each row\n    For r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)          'get the count\n    Next r\n\n    'place array to sheet\n    sht.Range(\"T7\").Resize(UBound(resBT, 1), 1) = resBT\n\n    'clear dictionary\n    dBT.RemoveAll\n\n'count AOI entries\n For r = 1 To UBound(d, 1)\n        k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        dBT(k) = dBT(k) + IIf(d(r, COL_AOI) = \"AOI Entry\", 1, 0)\n    Next r\n\n    'populate array with appropriate counts for each row\n    For r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)          'get the count\n    Next r\n\n    'place array to sheet\n    sht.Range(\"U7\").Resize(UBound(resBT, 1), 1) = resBT\n\nCall createsummarytable\nCall PopSummaryAOI(dBT)\n\ndBT.RemoveAll\n\n   For r = 1 To UBound(d, 1)\n        k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        dBT(k) = Cells(r, COL_RT).Value\n    Next r\n\n 'Populate array with last row reaction time for each trial\n        For r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)          'get the count\n    Next r\n\nCall PopSummaryRT(dBT)\n\nEnd Sub\n</code></pre>\n\n<p>I want this line: <code>dBT(k) = Cells(r, COL_RT).Value</code> to refer to the value in the last cell in column Q for each trial. At the moment I'm not getting any errors, but the values I want to be printed are not being printed, so I must not be defining the cells' addresses properly.</p>\n\n<p>Here is a screenshot of my data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/98zzJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/98zzJ.png\" alt=\"\"></a></p>\n\n<p>This is where I expect to see the values printed:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qzyko.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qzyko.png\" alt=\"\"></a></p>\n\n<p>This is the code to print the value to the table:</p>\n\n<pre><code>Sub PopSummaryRT(dict)\n\n    Dim sht As Worksheet, k, b, t, f, f2\n\n    Set sht = ThisWorkbook.Sheets(\"datasummary\")\n\n    For Each k In dict\n\n        b = Split(k, \"|\")(0) 'get block\n        t = Split(k, \"|\")(1) 'get trial\n        'find the block\n        Set f = sht.Columns(1).Find(what:=b, lookat:=xlWhole, LookIn:=xlValues)\n        If Not f Is Nothing Then\n            'find the trial under that block\n            Set f2 = f.Offset(1, 0).EntireRow.Find(what:=t, lookat:=xlWhole, LookIn:=xlValues)\n            If Not f2 Is Nothing Then f2.Offset(2, 0).Value = dict(k)\n        End If\n    Next k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "ms-word", "macros"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1478668369, "post_id": 40500437, "comment_id": 68244622, "body": "Probably the easiest implementation would be to modify the python script to write a text file in a known location, and have the VBA then query that file. But that becomes difficult to implement in a distributed environment. The proper way to do this would be to register your python program as a COM server with accessible methods (basically an API) and then your VBA can just create an instance of that object and invoke it&#39;s methods, which return directly to the caller (VBA)."}, {"owner": {"reputation": 657, "user_id": 235218, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/070cd829f2413b16d521c5f4aaa7db95?s=128&d=identicon&r=PG", "display_name": "Marc B. Hankin", "link": "https://stackoverflow.com/users/235218/marc-b-hankin"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478754851, "post_id": 40500437, "comment_id": 68281903, "body": "Thank you.  While doing some research to learn about what it means to register a python program as a COM server, I came across Pyro4, which ostensibly is a library that enables you to build applications in which objects can talk to each other over the network, with minimal programming effort. May I follow up with you later, if I can&#39;t figure out where to see an example showing how to register a python program as a COM server, and then use it as you indicated?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478755924, "post_id": 40500437, "comment_id": 68282169, "body": "Your function is called <code>fnShellOutput</code> but you set the return value using <code>ShellOutput </code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478756177, "post_id": 40500437, "comment_id": 68282256, "body": "If that change doesn&#39;t fix it then you need to explain exactly what happens when you run your version."}, {"owner": {"reputation": 657, "user_id": 235218, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/070cd829f2413b16d521c5f4aaa7db95?s=128&d=identicon&r=PG", "display_name": "Marc B. Hankin", "link": "https://stackoverflow.com/users/235218/marc-b-hankin"}, "edited": false, "score": 0, "creation_date": 1478790385, "post_id": 40500437, "comment_id": 68301510, "body": "It Worked!!!!!!  Thank you so much!!!!"}, {"owner": {"reputation": 657, "user_id": 235218, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/070cd829f2413b16d521c5f4aaa7db95?s=128&d=identicon&r=PG", "display_name": "Marc B. Hankin", "link": "https://stackoverflow.com/users/235218/marc-b-hankin"}, "edited": false, "score": 0, "creation_date": 1478791070, "post_id": 40500437, "comment_id": 68301991, "body": "Do you know of a URL where I could learn about what you showed me, i.e., creating standard output, and harvesting it, using python and using vba?  please don&#39;t spend more than a moment or two on this because you&#39;ve spent a lot of time helping me, and I don&#39;t want to abuse your kindness.  Thank you so much."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478792961, "post_id": 40500437, "comment_id": 68303227, "body": "Sorry I don&#39;t really use Python at all, I just remembered that approach from a previous question and was able to find an example."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 235218, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/070cd829f2413b16d521c5f4aaa7db95?s=128&d=identicon&r=PG", "display_name": "Marc B. Hankin", "link": "https://stackoverflow.com/users/235218/marc-b-hankin"}, "edited": false, "score": 0, "creation_date": 1478755645, "post_id": 40501223, "comment_id": 68282094, "body": "Please take a peek at my addendum that I added today, responding to your posting.  And thank you for your efforts.  They are much appreciated.  Marc"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1478825368, "last_edit_date": 1478825368, "creation_date": 1478673241, "answer_id": 40501223, "question_id": 40500437, "link": "https://stackoverflow.com/questions/40500437/return-to-word-vba-the-result-of-a-python-script-called-by-the-vba-macro-in-wind/40501223#40501223", "title": "Return to Word vba the result of a python script called by the vba macro in Windows", "body": "<p>If you use <code>print()</code> in your Python script then the printed content will be sent to stdout.  </p>\n\n<p>Using a <code>WScript.Shell</code> object to run your script gives you access to the stdout content.</p>\n\n<p>Here's a very basic example:</p>\n\n<p>Test python script <em>test.py</em>:</p>\n\n<pre><code>print(\"hello world\")\n</code></pre>\n\n<p>VBA:</p>\n\n<pre><code>Sub TestIt()\n    Debug.Print ShellOutput(\"python D:\\temp\\test.py\") ''&gt;&gt; hello world\nEnd Sub\n\nFunction ShellOutput(cmd As String) As String\n\n    Dim oShell As Object, oCmd As String\n    Dim oExec As Object, oOutput As Object\n    Dim arg As Variant\n    Dim s As String, sLine As String\n\n    Set oShell = CreateObject(\"WScript.Shell\")\n    Set oExec = oShell.Exec(cmd)\n    Set oOutput = oExec.StdOut\n\n    While Not oOutput.AtEndOfStream\n        sLine = oOutput.ReadLine\n        If sLine &lt;&gt; \"\" Then s = s &amp; sLine &amp; vbNewLine\n    Wend\n\n    ShellOutput = s\n\n    Set oOutput = Nothing\n    Set oExec = Nothing\n    Set oShell = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Adapted from: <a href=\"https://stackoverflow.com/questions/39516875/return-result-from-python-to-vba\">Return result from Python to Vba</a></p>\n"}], "owner": {"reputation": 657, "user_id": 235218, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/070cd829f2413b16d521c5f4aaa7db95?s=128&d=identicon&r=PG", "display_name": "Marc B. Hankin", "link": "https://stackoverflow.com/users/235218/marc-b-hankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 1, "accepted_answer_id": 40501223, "answer_count": 1, "score": 3, "last_activity_date": 1478825368, "creation_date": 1478667957, "last_edit_date": 1478790859, "question_id": 40500437, "link": "https://stackoverflow.com/questions/40500437/return-to-word-vba-the-result-of-a-python-script-called-by-the-vba-macro-in-wind", "title": "Return to Word vba the result of a python script called by the vba macro in Windows", "body": "<p>I know how to use vba in MS Word in Windows (7 or 10) to run a python script.  Here\u2019s one example:</p>\n\n<pre><code>RegExpPatrn = \"[RegExp search string]\"\nPythonScriptFullName = Chr(34) &amp; \"[PythonScriptFullname.py]\" &amp; Chr(34)\nPyExe = \"C:\\Python27\\python2.7.exe\"\nCmdLin = PyExe &amp; \" \" &amp; PythonScriptFullName &amp; \" \" &amp; RegExpPatrn \nSet objWshShell = CreateObject(\"WScript.Shell\")\nobjWshShell.Run strCmdLin01, 1, True\n</code></pre>\n\n<p>But I don\u2019t know how to return the result of the Python script (e.g., a regexp file search) to the vba macro that called the Python script.</p>\n\n<p>If anyone has any suggestions, I'd appreciate getting them.</p>\n\n<p>I've read about \"piping\", but I don't understand how to do that.</p>\n\n<p>I've read about using environment variables, but I haven't been able to use python to create an environment variable that I was able to retrieve after the python script had run.</p>\n\n<p>If anyone has any suggestions, I'd appreciate getting them.</p>\n\n<p>Marc</p>\n\n<p>.\n . </p>\n\n<p>**</p>\n\n<h2>SOLUTION added November 10, 2016, thanks to user235218 and Tim Williams:</h2>\n\n<p>**\nThe following are: </p>\n\n<ol>\n<li><p>My python script; </p></li>\n<li><p>My version of your vba sub; and</p></li>\n<li><p>My version of your vba function.</p></li>\n</ol>\n\n<p>Here's My python script:</p>\n\n<pre><code>print(\"This is my Python script's output\")\n</code></pre>\n\n<p>Here's My version of your vba sub:</p>\n\n<pre><code>    Sub subTestfnShellOutput()\n    Dim strPythonPath As String\n    Dim strPyScript As String\n    Dim strCmd As String\n\n    strPythonPath = \"C:\\Python27\\python2.7.exe\"\n    strPyScript = \"C:\\Apps\\UtilitiesByMarc\\Test_2016-11-09_StackOverFlowSoution_aaa_.py\"\n    strCmd = strPythonPath &amp; \" \" &amp; strPyScript\n\n    'Debug.Print fnShellOutput(\"python D:\\temp\\test.py\") ''&gt;&gt; hello world\n    MsgBox fnShellOutput(strCmd) ''&gt;&gt; hello world        \n    End Sub 'subTestfnShellOutput\n</code></pre>\n\n<p>Here's My version of your vba function:</p>\n\n<pre><code>    Function fnShellOutput(cmd As String) As String\n    ' https://stackoverflow.com/questions/39516875/return-result-from-python-to-vba\n\n    Dim oShell As Object, oCmd As String\n    Dim oExec As Object, oOutput As Object\n    Dim arg As Variant\n    Dim s As String, sLine As String\n\n    Set oShell = CreateObject(\"WScript.Shell\")\n    Set oExec = oShell.Exec(cmd)\n    Set oOutput = oExec.StdOut\n\n    While Not oOutput.AtEndOfStream\n        sLine = oOutput.ReadLine\n        If sLine &lt;&gt; \"\" Then s = s &amp; sLine &amp; vbNewLine\n    Wend\n\n    \"\"\"November 10, 2016 Addendum:  It works now that I replaced 'ShellOutput = s' with\n     'fnShellOutput = s'\"\"\"\n    fnShellOutput = s\n\n    Set oOutput = Nothing\n    Set oExec = Nothing\n    Set oShell = Nothing    \n    End Function 'fnShellOutput\n</code></pre>\n"}, {"tags": ["excel", "alm", "hp-quality-center", "vba"], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 4842596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/--pbtx34xGAw/AAAAAAAAAAI/AAAAAAAAARo/rjg6TR8QWpM/photo.jpg?sz=128", "display_name": "venkat reddy padala", "link": "https://stackoverflow.com/users/4842596/venkat-reddy-padala"}, "edited": false, "score": 0, "creation_date": 1479177993, "post_id": 40502914, "comment_id": 68437754, "body": "2nd one is the block i am looking for. Able to get the instance. Thanks for the help @Ronald :)"}], "tags": [], "owner": {"reputation": 1270, "user_id": 1254809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322bc2ada9df000f651cbfc5183b34ce?s=128&d=identicon&r=PG&f=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1254809/roland"}, "is_accepted": true, "score": 2, "last_activity_date": 1478681427, "creation_date": 1478681427, "answer_id": 40502914, "question_id": 40499796, "link": "https://stackoverflow.com/questions/40499796/executing-the-test-cases-in-alm-from-excel-by-test-id/40502914#40502914", "title": "Executing the test cases in alm from Excel by Test ID", "body": "<p>I think you are looking for the TestId property of the TSTest object. So in your loop you could just test whether TestId matches the value from Excel:</p>\n\n<pre><code>If tsTest.TestId = testidfromexcel Then\n    ' do something\nEnd If\n</code></pre>\n\n<p>Or you can use a Filter to only get the TSTest instances from your Test Set that matches the respective test ID from Excel:</p>\n\n<pre><code>Set testSetFilter = tsTestFactory.Filter\ntestSetFilter.Filter(\"TC_TEST_ID\") = testidfromexcel\nSet tsTestList = testSetFilter.NewList()\n</code></pre>\n\n<p>Now your tsTestList should only contain test instances from the test with the ID from Excel.</p>\n"}], "owner": {"reputation": 403, "user_id": 4842596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/--pbtx34xGAw/AAAAAAAAAAI/AAAAAAAAARo/rjg6TR8QWpM/photo.jpg?sz=128", "display_name": "venkat reddy padala", "link": "https://stackoverflow.com/users/4842596/venkat-reddy-padala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1592, "favorite_count": 0, "accepted_answer_id": 40502914, "answer_count": 1, "score": 3, "last_activity_date": 1521010364, "creation_date": 1478661759, "last_edit_date": 1531164843, "question_id": 40499796, "link": "https://stackoverflow.com/questions/40499796/executing-the-test-cases-in-alm-from-excel-by-test-id", "title": "Executing the test cases in alm from Excel by Test ID", "body": "<p>I am trying to execute the test cases in QC ALM through an Excel macro. I am able to access the tests in testlist, but I am not able to find the particular test case I need to execute by its ID.</p>\n\n<p>Below is the sample code I am using:</p>\n\n<pre><code>Set tsTreeMgr = tdConnection.testsettreemanager\nSet tsFolder = tsTreeMgr.NodeByPath(nPath)\n' --Search for the test set passed as an argument to the example code\nSet tsList = tsFolder.FindTestSets(\"Test Set Name\")\n\n'------Accessing the Test Cases inside the Test SEt ----\n\nSet theTestSet = tsList.Item(1)\nFor Each testsetfound In tsList\n    Set tsFolder = testsetfound.TestSetFolder\n    Set tsTestFactory = testsetfound.tsTestFactory\n    Set tsTestList = tsTestFactory.NewList(\"\")\n\n    For Each tsTest In tsTestList\n        MsgBox (tsTest.Name+\",\"+ tsTest.ID)\n        testrunname = \"Test Case name from excel sheet\"\n        '----Accesssing the Run Factory ---\n        Set RunFactory = tsTest.RunFactory\n        Set obj_theRun = RunFactory.AddItem(CStr(testrunname))\n        obj_theRun.Status = \"Passed\"\n        obj_theRun.Post\n    Next\nNext\n</code></pre>\n\n<p>Any help to get TestCase in testset of testlab to execute would be great help. </p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 7046688, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5d7cf16b9321d6a77f08cf9baa5e136?s=128&d=identicon&r=PG&f=1", "display_name": "Tan Stanley", "link": "https://stackoverflow.com/users/7046688/tan-stanley"}, "is_accepted": true, "score": 1, "last_activity_date": 1478659922, "creation_date": 1478659922, "answer_id": 40499601, "question_id": 40499501, "link": "https://stackoverflow.com/questions/40499501/same-array-size-but-subscript-out-of-range/40499601#40499601", "title": "Same array size, but subscript out of range", "body": "<p>I have found the problem which i should have realized earlier. </p>\n\n<pre><code>For c = 1 To (Application.CountA(sheet2TempArray)-1)\n</code></pre>\n\n<p>Include -1 at the for loop will solve the problem. </p>\n"}], "owner": {"reputation": 101, "user_id": 7046688, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5d7cf16b9321d6a77f08cf9baa5e136?s=128&d=identicon&r=PG&f=1", "display_name": "Tan Stanley", "link": "https://stackoverflow.com/users/7046688/tan-stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40499601, "answer_count": 1, "score": 0, "last_activity_date": 1478659922, "creation_date": 1478658920, "last_edit_date": 1531164843, "question_id": 40499501, "link": "https://stackoverflow.com/questions/40499501/same-array-size-but-subscript-out-of-range", "title": "Same array size, but subscript out of range", "body": "<p>2 arrays (sheet1TempArray and sheet2TempArray) are declared and populated, both are of the same size 102. All arrarys shown in the code below are declared such as <code>public sheet1TempArray(), sheet2TempArray() as String</code>.</p>\n\n<p>I want to check if the elements in sheet1TempArray is in sheet2TempArray, therefore i have the follow function. </p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n\n     IsInArray = Not IsError(Application.Match(stringToBeFound, arr, 0))\n\nEnd Function\n</code></pre>\n\n<p>And i have another sub which calls this function</p>\n\n<pre><code>For c = 1 To Application.CountA(sheet2TempArray)\n        If IsInArray(Trim(CStr(sheet2TempArray(c))), sheet1TempArray) = False Then\n\n           tempNotFoundArray(c) = CStr(sheet2TempArray(c))\n        End If\n\n    Next c\n</code></pre>\n\n<p>however, it kept on showing this error (sheet2TempArray(c)) = . May i ask is my looping method wrong? </p>\n"}, {"tags": ["excel", "pdf", "vba"], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "edited": false, "score": 0, "creation_date": 1478658717, "post_id": 40499282, "comment_id": 68242871, "body": "For the print area, it will automatically adjust based on the autofilter, how would I adjust it for that?  Thank you for your help so far!"}], "tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": true, "score": 1, "last_activity_date": 1478656766, "creation_date": 1478656766, "answer_id": 40499282, "question_id": 40499192, "link": "https://stackoverflow.com/questions/40499192/excel-vba-output-to-pdf-zoom/40499282#40499282", "title": "Excel VBA Output to PDF Zoom %", "body": "<p>Before you end the sub, can you add those lines to your code please.</p>\n\n<pre><code>Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n        .Orientation = xlLandscape\n        .Zoom = False\n        '.PrintArea = Worksheets(ReportWsName).UsedRange\n        .FitToPagesWide = 1\n        '.FitToPagesTall = 1\n    End With\nApplication.PrintCommunication = True\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2685, "favorite_count": 0, "accepted_answer_id": 40499282, "answer_count": 1, "score": 1, "last_activity_date": 1478658527, "creation_date": 1478655989, "last_edit_date": 1531164843, "question_id": 40499192, "link": "https://stackoverflow.com/questions/40499192/excel-vba-output-to-pdf-zoom", "title": "Excel VBA Output to PDF Zoom %", "body": "<p>Is there a way to control the zoom % on the PDF when it is printed via a macro?  I have zoomed in on the spreadsheet at 100% but the PDF always shows at 79.3% and it's really hard to see.  If it is zoomed in at 200%, it shows perfectly fine on the PDF.  I would normally ignore this aspect and just tell the user to zoom in but it's for the CEO and, ya know.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Sel_Manager As String\n'Specify headers to be repeated at the top\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n        .PrintTitleRows = \"$5:$10\"\n        .PrintTitleColumns = \"$B:$M\"\n        .Orientation = xlLandscape\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\nEnd With\n\n'Manager selection through simple Inputbox\n Sel_Manager = ComboBox1\n'Insert autofilter for worksheet\nCells.Select\nSelection.AutoFilter\n'Select manager defined in inputbox\nActiveSheet.Range(\"B10\", Range(\"M10\").End(xlDown)).AutoFilter Field:=1, Criteria1:=Sel_Manager\nActiveSheet.Range(\"B10\", Range(\"M10\").End(xlDown)).AutoFilter Field:=2, Criteria1:=\"A\"\n 'Select range to be printed and specify manager in filename\nActiveSheet.Range(\"B10\", Range(\"M10\").End(xlDown)).Select\n\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\nSel_Manager + \".pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\nActiveSheet.ShowAllData\nApplication.PrintCommunication = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478654102, "post_id": 40498901, "comment_id": 68241972, "body": "What have you tried so far? Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478656695, "post_id": 40498901, "comment_id": 68242460, "body": "I havent tried anything yet. New to VBA and not sure if this is something that can be done."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478656966, "post_id": 40498901, "comment_id": 68242520, "body": "It can be done. You can process all of the VLOOKUP (or Index/Match) within VBA (not a function on the worksheet). Does that help you get started?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1478674885, "post_id": 40498901, "comment_id": 68246526, "body": "You need to use a Scripting Dictionary.  Reference: <a href=\"https://www.youtube.com/watch?v=dND4coLI_B8&amp;index=43&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 39 - Dictionaries</a>.  My answer to  <a href=\"http://stackoverflow.com/questions/37792580/excel-vba-macro-iterating-over-values-on-one-page-to-check-for-match-on-another/37806960#37806960\">Excel VBA Macro: Iterating over values on one page to check for match on another page and assign value</a> uses a dictionary to match key values between two lists, in order to update a value in the second list."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1478677685, "post_id": 40498901, "comment_id": 68247521, "body": "Have a look at <code>FIND</code>.  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839746.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1478713239, "post_id": 40500218, "comment_id": 68267631, "body": "Thank you for your detailed response! Is this something i need to copy to module?"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1478722051, "post_id": 40500218, "comment_id": 68271892, "body": "Yes. Make sure you open immediate window <code>Ctrl-G</code>, put the cursor somewhere inside <code>matchRows()</code> and press <code>F5</code> to run."}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479331409, "post_id": 40500218, "comment_id": 68517193, "body": "When i run the code i am getting Compile error : Sub or Function not defined error message. I wonder whats causing it? Thanks"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479393406, "post_id": 40500218, "comment_id": 68546393, "body": "There is another helper function <code>contains()</code> below - make sure you copied that over as well (on my browser there is a scroll bar to scroll down the code - you may not have copied over everything)."}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479519418, "post_id": 40500218, "comment_id": 68607049, "body": "Yes i did include helper function. but getting compile error; Method or Data Member not found error message. Thanks"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479524610, "post_id": 40500218, "comment_id": 68607807, "body": "Does it say / highlight which line? Also make sure you have &quot;Sheet1&quot; and &quot;Sheet2&quot; with the data as pictured above."}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479581554, "post_id": 40500218, "comment_id": 68622710, "body": "It highlights &quot;Sub matchRows()&quot; in yellow and put the cursor on book1"}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479595021, "post_id": 40500218, "comment_id": 68626476, "body": "I change the workbook names now i am not getting an error message but vba code is not doing anything? Thanks  <a href=\"https://ufile.io/2b124\" rel=\"nofollow noreferrer\">ufile.io/2b124</a>"}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479752086, "post_id": 40500218, "comment_id": 68680689, "body": "Hi Logan,  I tried it over and over again. when i run the code it puts the cursor on R in the middle of &quot;(c, CStr(r))&quot; and highlights Sub matchRows()  in yelllow. Thanks"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479764034, "post_id": 40500218, "comment_id": 68686918, "body": "Hmm, I am not sure what the issue is - it is probably can&#39;t locate the data in a second sheet properly. Here is the link to my spreadsheet that is working. If it runs ok on your machine, try replacing data (little by little) and see if you can make it work. <a href=\"https://ufile.io/11a19\" rel=\"nofollow noreferrer\">ufile.io/11a19</a>"}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479791549, "post_id": 40500218, "comment_id": 68694868, "body": "Hi, I dont get an error message but the code doesnt return results"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479836023, "post_id": 40500218, "comment_id": 68722071, "body": "Results are in the &quot;Immediate&quot; window (aka console) - you can see it by pressing <code>Ctrl-G</code> or from the View menu. I&#39;ve made remarks in my code as to where the actual match a happens. This is where you&#39;d need to do what you planned originally for matches."}, {"owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "edited": false, "score": 0, "creation_date": 1479850462, "post_id": 40500218, "comment_id": 68730208, "body": "Great! Thank you for all your help Logan"}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": false, "score": 1, "last_activity_date": 1478666966, "last_edit_date": 1478666966, "creation_date": 1478666012, "answer_id": 40500218, "question_id": 40498901, "link": "https://stackoverflow.com/questions/40498901/vba-code-to-use-rather-than-vlookup/40500218#40500218", "title": "VBA code to use rather than vlookup", "body": "<p>You can use <code>Collection</code> object to quickly find matches. This will work very fast (if not faster than <code>VLOOKUP</code>) because when you add key parameter to <code>Collection</code> - it hashes / indexes its value with the specific goal of fast lookup later).</p>\n\n<p>Moreover, for the large number of records you populate <code>Collection</code> once and keep reusing it, while <code>VLOOKUP</code> does search the entire target range repeatedly (which is way less efficient, although built-in formulas run in parallel on multiple cores plus Microsoft definitely built-in some caching for increased efficiency for repeated searches). Even then a single-threaded VBA collections should still be faster. </p>\n\n<p>See example below with more information in the in-line comments.</p>\n\n<p>\"Big Table\" is on Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XwBdP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XwBdP.png\" alt=\"Big Table\"></a></p>\n\n<p>\"Small Table\" is on Sheet2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1wp7W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1wp7W.png\" alt=\"Small Table\"></a></p>\n\n<p>And the code that matches records in small table to those in the big one:</p>\n\n<pre><code>Option Explicit\n\nSub matchRows()\n\n    ' this is where the big table is\n    Dim w1 As Worksheet\n    Set w1 = Worksheets(\"Sheet1\")\n\n    ' this is where the small table is\n    Dim w2 As Worksheet\n    Set w2 = Worksheets(\"Sheet2\")\n\n    Dim c As New Collection ' list of match keys in big table 1\n    Dim r As Range\n\n    ' assume the match key is in col1 in both tables\n    ' enumerate the keys in the big table\n    For Each r In w1.Range(w1.[a2], w1.[a2].End(xlDown))\n        c.Add r, r ' this stores the range (first param) and\n                    ' its key (second param - taken as string\n                    ' (value of the range), must be unique)\n    Next r\n\n    ' now lets try to match / vlookup records in small table against\n    ' big table\n    For Each r In w2.Range(w2.[a2], w2.[a2].End(xlDown))\n        If contains(c, CStr(r)) Then\n            ' you didn't say what you want to do after a match, so\n            ' I'll just display matched key value and row number in debug console\n            Debug.Print \"Found match \"\"\" &amp; r &amp; \"\"\" at row number \" &amp; r.Row\n        Else\n            Debug.Print \"No match found for \"\"\" &amp; r &amp; \"\"\" at row number \" &amp; r.Row\n        End If\n    Next r\n\nEnd Sub\n\nFunction contains(col As Collection, key As String) As Boolean\n    On Error Resume Next\n    col.Item key\n    contains = (Err.Number = 0)\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Result in Immediate Window:</p>\n\n<pre><code>Found match \"data51\" at row number 2\nFound match \"data61\" at row number 3\nNo match found for \"data81\" at row number 4\nFound match \"data91\" at row number 5\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1632, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478666966, "creation_date": 1478653416, "question_id": 40498901, "link": "https://stackoverflow.com/questions/40498901/vba-code-to-use-rather-than-vlookup", "title": "VBA code to use rather than vlookup", "body": "<p>I have two very large tables. One of them has 12 columns and 280K rows. The other ones has 12k rowns and 33 columns. I am using vlookup to look for matching values in large table to small one. Vlookups take forever to calculate. Is there an easy way to do this with a VBA code? Can someone share a sample code for me to replicate? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["regex", "macos", "vba", "excel"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1478651415, "post_id": 40498628, "comment_id": 68241306, "body": "That first function would work for you with a little bit of editing. Im guessing when you said its adding spaces in undesired locations had to do with names where the previous char is space, and with the &lt;br&gt; part. You can simply add another If statement or add on to the existing one to catch those characters and have it perform in the way you intend."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1478651475, "post_id": 40498628, "comment_id": 68241322, "body": "What Im getting at is, youre practically already there, just a little more and youve got it \ud83d\ude00"}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1478769835, "post_id": 40498628, "comment_id": 68288278, "body": "Do you ALWAYS have a combination of first and last names? What I am asking is if you always have a pair of strings, even without being formatted as the examples you are showing (sorry the caps but I do not know how to bold in comments)"}], "answers": [{"comments": [{"owner": {"reputation": 6870, "user_id": 598599, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3f0d59c484274d5ec80b566ea737666?s=128&d=identicon&r=PG", "display_name": "AutomatedChaos", "link": "https://stackoverflow.com/users/598599/automatedchaos"}, "edited": false, "score": 1, "creation_date": 1478698557, "post_id": 40503295, "comment_id": 68258707, "body": "I don&#39;t think the <code>vbscript.regexp</code> lib is available on MacOSX, otherwise this was the better, more flexible, solution."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 6870, "user_id": 598599, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3f0d59c484274d5ec80b566ea737666?s=128&d=identicon&r=PG", "display_name": "AutomatedChaos", "link": "https://stackoverflow.com/users/598599/automatedchaos"}, "edited": false, "score": 0, "creation_date": 1478740669, "post_id": 40503295, "comment_id": 68278799, "body": "@AutomatedChaos My bad - saw my solution from last time and missed the Mac OSX reference."}, {"owner": {"reputation": 53, "user_id": 6338489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50400bb2d04103d7284789985e9ebaae?s=128&d=identicon&r=PG&f=1", "display_name": "LVPoker", "link": "https://stackoverflow.com/users/6338489/lvpoker"}, "edited": false, "score": 0, "creation_date": 1478759659, "post_id": 40503295, "comment_id": 68283350, "body": "Thank you, guys.  Tried the function and it only returns #VALUE!  I&#39;m assuming this is an OSX problem with the regexp, and if so, is there a workaround?  Some kind of patch or something that you know of??"}, {"owner": {"reputation": 53, "user_id": 6338489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50400bb2d04103d7284789985e9ebaae?s=128&d=identicon&r=PG&f=1", "display_name": "LVPoker", "link": "https://stackoverflow.com/users/6338489/lvpoker"}, "edited": false, "score": 1, "creation_date": 1479373811, "post_id": 40503295, "comment_id": 68532679, "body": "@brettdj - I emailed the file to myself and took it to a windows machine.  The function worked great.  I gave up on the Mac workaround.  I&#39;m sure it&#39;s out there, but whatevs.  Thank you!!"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 1, "last_activity_date": 1478682791, "last_edit_date": 1495535558, "creation_date": 1478682791, "answer_id": 40503295, "question_id": 40498628, "link": "https://stackoverflow.com/questions/40498628/cleaning-bad-data-in-excel-splitting-words-by-capital-letters/40503295#40503295", "title": "Cleaning bad data in excel, splitting words by capital letters", "body": "<p>My function from <a href=\"https://stackoverflow.com/questions/10190269/split-uppercase-words-in-excel/10202057#10202057\">Split Uppercase words in Excel</a> needs udpdating for your additional string matching.</p>\n\n<p>You would use this function in cell <code>B1</code> for text in <code>A1</code> as follows\n<a href=\"https://i.stack.imgur.com/vxbBN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vxbBN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>One assumption your cleansing does make is people have only two names, so </p>\n\n<blockquote>\n  <p>Ben OliverCarlos Alberto</p>\n</blockquote>\n\n<p>is broken to  </p>\n\n<blockquote>\n  <p>Ben Oliver<br>\n  Carlos Alberto</p>\n</blockquote>\n\n<p>is that actually what should happen? (needs a  minor tweak if so)</p>\n\n<p><em>code</em></p>\n\n<pre><code>Function SplitCaps(strIn As String) As String\nDim objRegex As Object\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Global = True\n    .Pattern = \"([a-z])([A-Z])\"\n    SplitCaps = Replace(.Replace(strIn, \"$1, $2\"), \"&lt;br&gt;\", \", \")\nEnd With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6338489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50400bb2d04103d7284789985e9ebaae?s=128&d=identicon&r=PG&f=1", "display_name": "LVPoker", "link": "https://stackoverflow.com/users/6338489/lvpoker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 40503295, "answer_count": 1, "score": 5, "last_activity_date": 1478740683, "creation_date": 1478651087, "last_edit_date": 1478740683, "question_id": 40498628, "link": "https://stackoverflow.com/questions/40498628/cleaning-bad-data-in-excel-splitting-words-by-capital-letters", "title": "Cleaning bad data in excel, splitting words by capital letters", "body": "<p>I'm using excel 2011 on Mac OSX.  I have a data set with about 3000 entries.  In the fields that contain names, many of the names are not separated.  First and last names are separated by a space, but separate names are bunched together. </p>\n\n<p>Here's what I have, (one cell):</p>\n\n<blockquote>\n  <p>Grant MorrisonSholly Fisch<br>Ben OliverCarlos Alberto Fernandez Urbano<br>Ben OliverCarlos Alberto Fernandez Urbano<br>Ben Oliver<br>Ben Oliver</p>\n</blockquote>\n\n<p>Here's what I want to accomplish, (one cell, comma separated with one space after comma):</p>\n\n<blockquote>\n  <p>Grant Morrison, Sholly Fisch, Ben Oliver, Carlos Alberto, Fernandez Urbano, Ben Oliver, Carlos Alberto, Fernandez Urbano, Ben Oliver, Ben Oliver</p>\n</blockquote>\n\n<p>I have found a few VBA scripts that will split words by capital letters, but the ones I've tried will add spaces where I don't need them like this one...</p>\n\n<pre><code>Function splitbycaps(inputstr As String) As String\n\nDim i As Long\nDim temp As String\n\nIf inputstr = vbNullString Then\n    splitbycaps = temp\n    Exit Function\nElse\n    temp = inputstr\n    For i = 1 To Len(temp)\n        If Mid(temp, i, 1) = UCase(Mid(temp, i, 1)) Then\n            If i &lt;&gt; 1 Then\n                temp = Left(temp, i - 1) + \" \" + Right(temp, Len(temp) - i + 1)\n                i = i + 1\n            End If\n        End If\n    Next i\n    splitbycaps = temp\n\nEnd If\nEnd Function\n</code></pre>\n\n<p>There was another one that I found here that used RegEx, (forgive me, I'm just learning all of this so I may sound a little dumb) but when I tried that one, it wouldn't work at all, and my research pointed me to a way to add references to the library that would add the necessary tools so I could use it.  Unfortunately, I cannot, for the life of me, find how to add a reference to the library on my mac version of excel...  I may be doing something wrong, but this is the answer that I could not get to work...</p>\n\n<pre><code>Function SplitCaps(strIn As String) As String\nDim objRegex As Object\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Global = True\n    .Pattern = \"([a-z])([A-Z])\"\n    SplitCaps = .Replace(strIn, \"$1 $2\")\nEnd With\nEnd Function\n</code></pre>\n\n<p>I am basically brand new at adding custom functions via VBA through excel, and there may even be a better way to do this, but it seems like every answer that I come to just doesn't quite get the data right.  Thanks for any answers!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 4, "creation_date": 1478650910, "post_id": 40498261, "comment_id": 68241183, "body": "<a href=\"https://exceljet.net/formula/partial-match-against-numbers-with-wildcard\" rel=\"nofollow noreferrer\">Why can&#39;t people use google?</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1478677319, "post_id": 40498261, "comment_id": 68247392, "body": "@vacip :) :) or press F1"}, {"owner": {"reputation": 1, "user_id": 7111934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e45df93ada46622dafc38678fa9289b?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/7111934/vinay"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1478811269, "post_id": 40498261, "comment_id": 68313151, "body": "@vacip I tried that and I&#39;m getting #N/A. And before you ask, yes the value is in the column i&#39;m looking at."}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 0, "last_activity_date": 1478885791, "last_edit_date": 1478885791, "creation_date": 1478885339, "answer_id": 40553230, "question_id": 40498261, "link": "https://stackoverflow.com/questions/40498261/using-index-match-to-find-values-contained-within-cells/40553230#40553230", "title": "Using Index Match to find values contained within cells", "body": "<p>Works for me:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PdA0d.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PdA0d.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Formula:</p>\n\n<pre><code>=MATCH(\"*\"&amp;A1&amp;\"*\";Sheet2!$A$1:$A$5&amp;\"\";0)\n</code></pre>\n\n<p>Enter it as an array formula. If you don't know what an array formula is, please use google and spend 30 minutes understanding and testing the concept.</p>\n\n<p>If you don't understand the formula, just say so.</p>\n\n<p>Cheers.</p>\n"}], "owner": {"reputation": 1, "user_id": 7111934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e45df93ada46622dafc38678fa9289b?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/7111934/vinay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1478885791, "creation_date": 1478648371, "question_id": 40498261, "link": "https://stackoverflow.com/questions/40498261/using-index-match-to-find-values-contained-within-cells", "title": "Using Index Match to find values contained within cells", "body": "<p>I'm trying to get index match to to search for things more generically. </p>\n\n<p>Col A  | Column B <br/>\n1234      | 9514, 6548, 3181, 9516<br/>\n2356      | 1458, 1234, 1594<br/>\n4568      | 9874<br/>\n1594      | 9845, 9841<br/>\n1563      | 4568<br/>\nNOTE: Column A &amp; Column B are in 2 different excel sheets</p>\n\n<p>Match would normally only pick up \"4568\"(it's in the last row of Column B) but I would also like to find \"1234\" (it's in the second row of Column B).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1090, "user_id": 3878638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UlH9h.png?s=128&g=1", "display_name": "wbrugato", "link": "https://stackoverflow.com/users/3878638/wbrugato"}, "is_accepted": true, "score": 3, "last_activity_date": 1478649363, "last_edit_date": 1478649363, "creation_date": 1478647537, "answer_id": 40498141, "question_id": 40498040, "link": "https://stackoverflow.com/questions/40498040/excel-formula-if-cell-contains-substring-this-and-does-not-contain-substring/40498141#40498141", "title": "Excel formula: If cell contains substring &quot;this&quot; AND does not contain substring &quot;that&quot;", "body": "<p>What you need is some kind of Substring function. I think <code>FIND</code> might work. Check out this page: <a href=\"https://exceljet.net/excel-functions/excel-find-function\" rel=\"nofollow noreferrer\">https://exceljet.net/excel-functions/excel-find-function</a></p>\n\n<p><strong>Your function would be like:\n<code>=IF(AND(ISERROR(FIND(\"some project\", E3))=FALSE,ISERROR(FIND(\"overhead\",E3))),1,0)</code></strong></p>\n\n<p><strong>EDIT: Above function works after testing</strong></p>\n\n<p>Tricky part here is that <code>FIND</code> returns the starting position of the string, and if it fails it returns <code>#VALUE</code>, which I believe you can catch with the <code>ISERROR()</code> function. This is in no way a beautiful solution. I would try to utilize the code behind and write this is VBA, as I am certain there is a proper <code>substring</code> function in VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 5486521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec65d2c49be632df085e50e384e8235?s=128&d=identicon&r=PG&f=1", "display_name": "kajahno", "link": "https://stackoverflow.com/users/5486521/kajahno"}, "is_accepted": false, "score": 2, "last_activity_date": 1478649354, "last_edit_date": 1478649354, "creation_date": 1478648822, "answer_id": 40498327, "question_id": 40498040, "link": "https://stackoverflow.com/questions/40498040/excel-formula-if-cell-contains-substring-this-and-does-not-contain-substring/40498327#40498327", "title": "Excel formula: If cell contains substring &quot;this&quot; AND does not contain substring &quot;that&quot;", "body": "<p>You can actually use the SEARCH function, like this:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"some project\",B2)),NOT(ISNUMBER(SEARCH(\"overhead\",B2)))*1,0)\n</code></pre>\n\n<p><strong>Considerations</strong>:</p>\n\n<ul>\n<li><a href=\"https://support.office.com/en-gb/article/SEARCH-SEARCHB-functions-9ab04538-0e55-4719-a72e-b6f54513b495\" rel=\"nofollow noreferrer\"><em>SEARCH</em></a> function: returns either a number or error (that's why I used ISNUMBER, you could actually have used <a href=\"https://support.office.com/en-gb/article/IS-functions-0f2d7971-6019-40a0-a171-f2d869135665\" rel=\"nofollow noreferrer\">ISERROR</a> too). This function is <strong>case insensitive</strong>. For case sensitiveness you might just use <a href=\"https://support.office.com/en-gb/article/FIND-FINDB-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628\" rel=\"nofollow noreferrer\"><em>FIND</em></a>, in the previous formula woud be <code>=IF(ISNUMBER(FIND(\"some project\",B2)),NOT(ISNUMBER(FIND(\"overhead\",B2)))*1,0)</code></li>\n<li><a href=\"https://support.office.com/en-gb/article/IS-functions-0f2d7971-6019-40a0-a171-f2d869135665\" rel=\"nofollow noreferrer\"><em>ISNUMBER</em></a> function: returns either FALSE or TRUE. I converted the result to 1 or 0 simply by multiplying TRUE or FALSE by 1.</li>\n</ul>\n\n<p>Hope helps</p>\n"}, {"comments": [{"owner": {"reputation": 1090, "user_id": 3878638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UlH9h.png?s=128&g=1", "display_name": "wbrugato", "link": "https://stackoverflow.com/users/3878638/wbrugato"}, "edited": false, "score": 1, "creation_date": 1478649504, "post_id": 40498428, "comment_id": 68240864, "body": "The true solution here. While the excel functions may work, they are ugly and can be hard to understand."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1090, "user_id": 3878638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UlH9h.png?s=128&g=1", "display_name": "wbrugato", "link": "https://stackoverflow.com/users/3878638/wbrugato"}, "edited": false, "score": 0, "creation_date": 1478649810, "post_id": 40498428, "comment_id": 68240943, "body": "thanks @wbrugato -- I was going to revise your post with something like this, but felt it better as a separate answer, since it&#39;s conceptually a bit different than using worksheet functions as per yours &amp; the other answer above.  Cheers."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1478652945, "last_edit_date": 1478652945, "creation_date": 1478649422, "answer_id": 40498428, "question_id": 40498040, "link": "https://stackoverflow.com/questions/40498040/excel-formula-if-cell-contains-substring-this-and-does-not-contain-substring/40498428#40498428", "title": "Excel formula: If cell contains substring &quot;this&quot; AND does not contain substring &quot;that&quot;", "body": "<p>If you can insert a little VBA code, then you can use a custom function like so:</p>\n\n<pre><code>=StrContains(E3, \"some project\", \"overhead\")\n</code></pre>\n\n<p>And this will return <code>True</code> if the value in E3 contains <strong>both</strong> of those substrings. This function relies mainly on VBA's <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264811.aspx\" rel=\"nofollow noreferrer\"><code>Instr</code> function</a>, which </p>\n\n<p>Function code:</p>\n\n<pre><code>Public Function StrContains(ByRef cl As Excel.Range, ParamArray strings() As Variant)\n'Function returns TRUE if the range contains ALL of the passed substring items\n' uses ParamArray to allow varying number of substring items\n' Ex:\n' =StrContains(A1, \"something\", \"else\", \"foo\")\n'\nDim val$\nDim s\nDim i As Integer\nDim ret As Boolean\nDim length As Integer\n\nlength = UBound(strings) + 1\nval = cl.Value2\n\nFor Each s In strings\n    If InStr(1,val, s) &lt;&gt; 0 Then\n        i = i + 1\n    End If\nNext\n\nret = (i = length)\nStrContains = ret\nEnd Function\n</code></pre>\n\n<p>You could modify this relatively easily to be case-insensitive, or to accept partial matches optionally, etc. Here is what it looks like extended for both of those concepts:</p>\n\n<pre><code>=StrContains(E3, False, True, \"some project\", \"overhead\")\n</code></pre>\n\n<p>Function Code:</p>\n\n<pre><code>Public Function StrContains(ByRef cl As Excel.Range, MatchCase As Boolean, MatchAll as Boolean, ParamArray strings() As Variant)\n'MatchAll is matching switch, use True to require ALL matching items, or False to allow for fewer.\n'MatchCase is the Case-sensitive switch, use False to ignore case.\n' uses ParamArray to allow varying number of substring items\n' Ex:\n' =StrContains(A1, \"something\", \"else\", \"foo\")\n'\nDim val$\nDim s\nDim i As Integer\nDim ret As Boolean\nDim length As Integer\n\nlength = UBound(strings) + 1\nval = cl.Value2\n\nIf Not MatchCase Then\n    val = LCase(val)\n    For i = lBound(strings) to UBound(strings)\n        strings(i) = lcase(strings(i))\n    Next\nNext\n\n\nFor Each s In strings\n    If InStr(val, s) &lt;&gt; 0 Then\n        i = i + 1\n    End If\nNext\n\nret = (i = IIF(MatchAll, length, 1))\nStrContains = ret\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 242, "user_id": 1860635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45aef8c6994638a9f48ca6ab0a2f43f2?s=128&d=identicon&r=PG", "display_name": "Marta", "link": "https://stackoverflow.com/users/1860635/marta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11780, "favorite_count": 0, "accepted_answer_id": 40498141, "answer_count": 3, "score": 1, "last_activity_date": 1478714588, "creation_date": 1478646899, "last_edit_date": 1531161705, "question_id": 40498040, "link": "https://stackoverflow.com/questions/40498040/excel-formula-if-cell-contains-substring-this-and-does-not-contain-substring", "title": "Excel formula: If cell contains substring &quot;this&quot; AND does not contain substring &quot;that&quot;", "body": "<p>I'm trying to write a function in which a column contains one substring and does not contain another substring.</p>\n\n<p>In the example bellow I would like my function to return 1 if my row contains \"some project\" AND DOES NOT CONTAIN \"overhead\".</p>\n\n<pre><code>row| example strings             | desired return value\n0  |some project,other project   | 1\n1  |some project                 | 1\n2  |overhead                     | 0\n3  |some project, overhead       | 0\n4  |some project, other, boo     | 1\n</code></pre>\n\n<p>I was trying to formulate it first with exact strings such as:</p>\n\n<pre><code>=IF(AND((E3=\"some project\"),NOT(E3=\"overhead\")),1,0)\n</code></pre>\n\n<p>But this only gives correct results for row 1 and 2 because it only does exact mach for the string instead of matching on the substring. </p>\n"}, {"tags": ["excel", "vba", "product"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1478647251, "post_id": 40497995, "comment_id": 68240261, "body": "You need to enter the formula (in Excel), as an <i>Array Formula</i>, by pressing &lt;Ctrl&gt; + &lt;Shift&gt; + &lt;Enter&gt;, rather than just &lt;Enter&gt;"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1478647450, "post_id": 40497995, "comment_id": 68240314, "body": "and the adding and subtracting of 1 would seem to be related to the interest-rate nature of the data, and/or to offset the negative values for some of the values. Hard to say precisely without more detail of the nature of the data."}, {"owner": {"reputation": 17, "user_id": 7134066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f41b5d5de5d79af2dc1a7a04c7d94dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Palee ", "link": "https://stackoverflow.com/users/7134066/palee"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1478647561, "post_id": 40497995, "comment_id": 68240346, "body": "ah. so that&#39;s the trick. I also found the reason for adding 1+ from another example. It means adding a constant before doing a PRODUCT function and then subtract -1. Interesting. Thanks for the response."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1478657090, "creation_date": 1478657090, "answer_id": 40499318, "question_id": 40497995, "link": "https://stackoverflow.com/questions/40497995/excel-formula-product1a1a21-1/40499318#40499318", "title": "Excel Formula =PRODUCT(1+A1:A21)-1", "body": "<p>Because the PRODUCT function multiplies values together the result of any data set with an entry such as the first above will always be a not very useful <code>0</code>. The <code>+1</code> offsets all values to guarantee the result will never be <code>0</code> (before deduction of <code>1</code>).  </p>\n\n<p>The <code>-1</code> then removes the offset and for the data above the result is <code>0.0153</code> (or <code>1.53%</code>). </p>\n\n<p>You should check your VBA if that is returning <code>3.81%</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13082643, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l_q6GLi_D_4/AAAAAAAAAAI/AAAAAAAABgc/AKF05nAFj2cD4bd7NeiILITfe_KANHgYVg/photo.jpg?sz=128", "display_name": "Matej \u0160tulrajter", "link": "https://stackoverflow.com/users/13082643/matej-%c5%a0tulrajter"}, "is_accepted": false, "score": 0, "last_activity_date": 1584905311, "creation_date": 1584905311, "answer_id": 60803947, "question_id": 40497995, "link": "https://stackoverflow.com/questions/40497995/excel-formula-product1a1a21-1/60803947#60803947", "title": "Excel Formula =PRODUCT(1+A1:A21)-1", "body": "<blockquote>\n  <p>1+A1:A21 means: (1+A1) * (1+A2) * ...(1+A21)</p>\n  \n  <p>1+ ist there to compute 0 numbers too...</p>\n  \n  <p>-1 must by for cleaning</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 7134066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f41b5d5de5d79af2dc1a7a04c7d94dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Palee ", "link": "https://stackoverflow.com/users/7134066/palee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2171, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1584905311, "creation_date": 1478646607, "last_edit_date": 1478651085, "question_id": 40497995, "link": "https://stackoverflow.com/questions/40497995/excel-formula-product1a1a21-1", "title": "Excel Formula =PRODUCT(1+A1:A21)-1", "body": "<p>I am trying to understand the formula <code>{PRODUCT(1+A1:A21)-1}</code> because for some reason, when executed thru VBA its returning value, but not when I type in the actual formula in a cell. Excelhelp has examples for <code>PRODUCT(A1:A21)</code>. I am trying to understand the significance of 1+ and -1 at the end.</p>\n\n<p>Data from A1:A21 - </p>\n\n<pre><code> 0.00%\n 0.28%\n 0.19%\n-0.02%\n 0.03%\n 0.15%\n-0.24%\n 0.17%\n 0.59%\n-0.16%\n-0.28%\n 0.58%\n 0.31%\n 0.10%\n-0.11%\n 0.40%\n 0.04%\n-0.48%\n-0.23%\n 0.17%\n 0.04%\n</code></pre>\n\n<p>the output for the formula is 3.81% when executed thru VBA, but when I type the formula in a cell getting a <code>#value</code>!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 100, "user_id": 1771401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B3Och.jpg?s=128&g=1", "display_name": "Lodewijk", "link": "https://stackoverflow.com/users/1771401/lodewijk"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1478643398, "post_id": 40497298, "comment_id": 68238873, "body": "Ok will edit, obviously just typed the sample lines from the top of my head. Thanks for noticing."}], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 1771401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B3Och.jpg?s=128&g=1", "display_name": "Lodewijk", "link": "https://stackoverflow.com/users/1771401/lodewijk"}, "edited": false, "score": 0, "creation_date": 1479566590, "post_id": 40497663, "comment_id": 68617597, "body": "Sorry to keep you waiting. Your answer was just right. My code came out like this:  <a href=\"http://pastebin.com/zaSPb4v1\" rel=\"nofollow noreferrer\">pastebin.com/zaSPb4v1</a>  I couldn&#39;t paste the code in this comment due to character limitations...  By the way, the shift-up seems to be unnecessary as it already does just that - shift cells up."}, {"owner": {"reputation": 100, "user_id": 1771401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B3Och.jpg?s=128&g=1", "display_name": "Lodewijk", "link": "https://stackoverflow.com/users/1771401/lodewijk"}, "edited": false, "score": 0, "creation_date": 1479566966, "post_id": 40497663, "comment_id": 68617732, "body": "Almost forgot to say thanks! So, thanks! Marked your reply as the correct answer."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 100, "user_id": 1771401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B3Och.jpg?s=128&g=1", "display_name": "Lodewijk", "link": "https://stackoverflow.com/users/1771401/lodewijk"}, "edited": false, "score": 0, "creation_date": 1479567990, "post_id": 40497663, "comment_id": 68618062, "body": "Not a problem. :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1478644817, "creation_date": 1478644817, "answer_id": 40497663, "question_id": 40497298, "link": "https://stackoverflow.com/questions/40497298/excel-vba-compare-condition-delete/40497663#40497663", "title": "Excel-vba compare, condition, delete", "body": "<blockquote>\n  <p>Im not looking for code, just the psuedo code / logic</p>\n</blockquote>\n\n<p>It seems to me that you just need the following:</p>\n\n<ol>\n<li>A simple loop to go through each row and look at the end date.  </li>\n<li>If the end date is in the past, then go to step 3.  </li>\n<li>If the employee has only one record, do not delete, otherwise go to step 4.  </li>\n<li>If end date is in the past, <strong>and</strong> there is more than one record - delete.</li>\n</ol>\n\n<blockquote>\n  <p>How would I go about removing old stuff but keeping the two lines that he;s working on now + the line that he will be working on as of 1 dec?</p>\n</blockquote>\n\n<p>I believe simply testing if the end date is in the past will suffice for each scenario?  </p>\n\n<hr>\n\n<p>In pseudo code that might look like:</p>\n\n<pre><code>For i = [num_rows]\n    If end_date &lt; today Then\n        If [COUNTIF(colleague_column, colleague)] &gt; 1 Then\n            rows(i).delete\n        End If\n    End If\nNext \n</code></pre>\n\n<p>or</p>\n\n<pre><code>For i = [num_rows]\n    If end_date &lt; today And [COUNTIF(colleague_column, colleague)] &gt; 1Then\n            rows(i).delete\n    End If\nNext \n</code></pre>\n\n<hr>\n\n<p>or in <em>actual</em> VBA (we would loop backwards in the case of deleting rows) assuming your data is in columns A:D with no headers:</p>\n\n<pre><code>For i = Cells(Rows.Count, 1).End(xlUp).Row To 1 Step -1\n    If CDate(Cells(i, 2)) &lt; Date And WorksheetFunction.CountIf(Range(\"D:D\"), Cells(i, 4).Value) &gt; 1 Then\n        Rows(i).EntireRow.Delete Shift:=xlUp\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 100, "user_id": 1771401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B3Och.jpg?s=128&g=1", "display_name": "Lodewijk", "link": "https://stackoverflow.com/users/1771401/lodewijk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40497663, "answer_count": 1, "score": 1, "last_activity_date": 1478644817, "creation_date": 1478642983, "last_edit_date": 1478643415, "question_id": 40497298, "link": "https://stackoverflow.com/questions/40497298/excel-vba-compare-condition-delete", "title": "Excel-vba compare, condition, delete", "body": "<p>I have an Excel file with activities for different colleagues, like so:</p>\n\n<ul>\n<li>1 jan 2016 || 1 dec 2016 || 100% || colleague A</li>\n<li>1 feb 2014 || 31 dec 2014 || 100% || colleague B</li>\n<li>1 jan 2016 || 1 okt 2016 || 100% || colleague B</li>\n<li>1 okt 2016 || 31 dec 2016 || 80% || colleague B</li>\n<li>1 nov 2016 || 10 dec 2016 || 100% | colleague B</li>\n<li>1 dec 2016 || 1 jan 2017 || 50% || colleague B</li>\n</ul>\n\n<p>Start date || end date || usage % || colleague</p>\n\n<p>Now what I would like is to see what people are working on now / when they are available for what % / since when they have been available. </p>\n\n<p>So deleting rows which end date is in the past, unless that is the only row for a colleague, because then I want to see that row as a measure of \" since when has he been available for a new job \".</p>\n\n<p>But then colleague B for example, has several things going. How would I go about removing old stuff but keeping the two lines that he;s working on now + the line that he will be working on as of 1 dec?</p>\n\n<p>They can have a usage % of >!00 thats fine.</p>\n\n<p>Sorry for the long description... Im not looking for code, just the psuedo code / logic to tackle this!</p>\n"}, {"tags": ["vba", "excel", "unix"], "comments": [{"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1478642922, "post_id": 40497136, "comment_id": 68238673, "body": "you should add a debug line that prints the value of <code>cmd5</code>. Then copy/paste that into a terminal environment and see if it works (I don&#39;t expect it to). See what error msgs you get there, then fix your code to eliminate error msgs, and get your process to work. Good luck."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478642928, "post_id": 40497136, "comment_id": 68238677, "body": "before the <code>errorcode4 = wsh.Run(cmd5)</code> line, insert a line that does <code>Debug.Print cmd5</code>, then insert a breakpoint (F9) on the <code>wsh.Run(cmd5)</code> instruction/line. Run your macro. When execution stops, look at the contents of the <i>immediate pane</i> (Ctrl+G). Does it look like a legit command? Adjust as needed."}, {"owner": {"reputation": 377, "user_id": 6510076, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa3859327cb7a1f6c90736fe01dd4451?s=128&d=identicon&r=PG&f=1", "display_name": "vivi11130704", "link": "https://stackoverflow.com/users/6510076/vivi11130704"}, "edited": false, "score": 0, "creation_date": 1478701539, "post_id": 40497136, "comment_id": 68260494, "body": "I tried those methods. Thanks guys!"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1478646268, "creation_date": 1478646268, "answer_id": 40497926, "question_id": 40497136, "link": "https://stackoverflow.com/questions/40497136/use-vba-run-unix-command-with-arrays-get-type-mismatch-error/40497926#40497926", "title": "Use VBA run Unix Command with Arrays get Type Mismatch Error", "body": "<p>It is invalid to use a string as the index of an array, nor did you need to.</p>\n\n<p>Assuming that all your variables have been defined in other parts of your code, and have module-level scope, the following slight change may make your code valid.  Use:</p>\n\n<pre><code>cmd5 = Chr(34) &amp; \"C:\\Program Files (x86)\" &amp; \"\\PuTTY\\pscp.exe\" &amp; Chr(34) &amp; \" -sftp -l \" &amp; pUser &amp; \" -pw \" &amp; pPass &amp; _\n    \" \" &amp; \" \" &amp; pHost &amp; \":\" &amp; ServerPath &amp; \"/\" &amp; var &amp; \" \" &amp; LocalPath &amp; \"/\"\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>cmd5 = Chr(34) &amp; \"C:\\Program Files (x86)\" &amp; \"\\PuTTY\\pscp.exe\" &amp; Chr(34) &amp; \" -sftp -l \" &amp; pUser &amp; \" -pw \" &amp; pPass &amp; _\n    \" \" &amp; \" \" &amp; pHost &amp; \":\" &amp; ServerPath &amp; \"/\" &amp; FirstRunFiles(var) &amp; \" \" &amp; LocalPath &amp; \"/\"\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 6510076, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa3859327cb7a1f6c90736fe01dd4451?s=128&d=identicon&r=PG&f=1", "display_name": "vivi11130704", "link": "https://stackoverflow.com/users/6510076/vivi11130704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 40497926, "answer_count": 1, "score": -1, "last_activity_date": 1478646268, "creation_date": 1478642220, "last_edit_date": 1531164843, "question_id": 40497136, "link": "https://stackoverflow.com/questions/40497136/use-vba-run-unix-command-with-arrays-get-type-mismatch-error", "title": "Use VBA run Unix Command with Arrays get Type Mismatch Error", "body": "<p>I'm using VBA to connect to UNIX and download a series of files from the server. However I encounter \"Run time error 13. Type Mismatch\" error with my \"cmd5\" commend line. The code is below:</p>\n\n<pre><code>Sub DownloadFirstRunFilesPart2()\nApplication.StatusBar = \"Downloading files...\"\nDim wsh As Object\nDim errorcode4 As Integer\nDim cmd5 As Variant\nDim FirstRunFiles(5) As Variant\nDim var As Variant\n\n'Files that need to be downloaded\nFirstRunFiles(0) = ProN &amp; \"_KSParameter_UserInput.xlsx\"\nFirstRunFiles(1) = ProN &amp; \"_KSParameter_SysOutput.xlsx\"\nFirstRunFiles(2) = ProN &amp; \"_ModelParameter_UserInput.xlsx\"\nFirstRunFiles(3) = ProN &amp; \"_ModelParameter_SysOutput.xlsx\"\nFirstRunFiles(4) = ProN &amp; \"_VarClusParameter_UserInput.xlsx\"\nFirstRunFiles(5) = ProN &amp; \"_VarClusParameter_SysOutput.xlsx\"\n\n'Connect to server and run loop to download files. Error occurs in \"cmd 5\" line\nFor Each var In FirstRunFiles\ncmd5 = Chr(34) &amp; \"C:\\Program Files (x86)\" &amp; \"\\PuTTY\\pscp.exe\" &amp; Chr(34) &amp; \" -sftp -l \" &amp; pUser &amp; \" -pw \" &amp; pPass &amp; _\n    \" \" &amp; \" \" &amp; pHost &amp; \":\" &amp; ServerPath &amp; \"/\" &amp; FirstRunFiles(var) &amp; \" \" &amp; LocalPath &amp; \"/\"\nSet wsh = CreateObject(\"wscript.shell\")\nerrorcode4 = wsh.Run(cmd5)\n\n'Get feedback and display error message\nIf errorcode4 &lt;&gt; 0 Then MsgBox (\"Error occurs. Fail to download \" &amp; FirstRunFiles(var))\nNext var\n\nApplication.StatusBar = \"Download complete\"\nEnd Sub\n</code></pre>\n\n<p>Could someone please help me? Thanks a lot!!</p>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 2, "creation_date": 1478640553, "post_id": 40496587, "comment_id": 68237590, "body": "Post your code in your question, not a screenshot :-)"}], "answers": [{"tags": [], "owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "is_accepted": false, "score": 0, "last_activity_date": 1478641916, "creation_date": 1478641916, "answer_id": 40497061, "question_id": 40496587, "link": "https://stackoverflow.com/questions/40496587/indenting-a-column-in-excel/40497061#40497061", "title": "Indenting a column in excel", "body": "<p>It looks here like you are not properly initializing the range that you intend to iterate over.  The <code>Range</code> object is tricky, in that it can actually refer to a group of cells itself, and the array usage here is unnecessary and even confusing.  Try something like this:</p>\n\n<pre><code>Dim OutLvl as Range ' This will refer to the whole range of interest\nDim t as Range      ' Always good practice to declare all variables\n...   ' Fill in the code as you have written\nSet OutLvl = Range(\"A1:A20\")    ' Now OutLvl refers to A1:A20 on the active sheet.\n    'Note that I can't possibly know how to appropriately set this range.\n\nFor Each t in OutLvl\n    ...  ' Now perform the loop as you have written\nNext t\n</code></pre>\n\n<p>More on the error you have received.  Note I have not watched this, so I can't speak for its accuracy:\n<a href=\"https://www.youtube.com/watch?v=kWT2YfSHpfM\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=kWT2YfSHpfM</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7133751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a92fb491c41ca815e247328f88a806?s=128&d=identicon&r=PG&f=1", "display_name": "user7133751", "link": "https://stackoverflow.com/users/7133751/user7133751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478641916, "creation_date": 1478639925, "last_edit_date": 1531164843, "question_id": 40496587, "link": "https://stackoverflow.com/questions/40496587/indenting-a-column-in-excel", "title": "Indenting a column in excel", "body": "<p>I am a VBA novice and am trying to \"automate\" a repetitive task within an excel spreadsheet. Am trying to indent a column based upon outline levels in a different column. I've been attempting to adapt code from a similar task but have run into a wall. Basically what I'm trying to accomplish is have the macro read down the OutLvl column and indent the next column based upon the outline level. Below is a screen shot of this macro and highlighted in yellow is where it got hung up. Any opinions or feedback is appreciated as I am trying to learn the application. Thanks!\n<a href=\"https://i.stack.imgur.com/sYSS9.png\" rel=\"nofollow noreferrer\">Indent Macro Attempt</a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1478641866, "post_id": 40496531, "comment_id": 68238167, "body": "Why not use <code>RAND()</code> in a VBA procedure to select the rows and then build and execute a custom SQL statement?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7128342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf72e96905e96ac04049fae13a0f091a?s=128&d=identicon&r=PG&f=1", "display_name": "sam x", "link": "https://stackoverflow.com/users/7128342/sam-x"}, "edited": false, "score": 0, "creation_date": 1478723121, "post_id": 40498053, "comment_id": 68272430, "body": "This is not working. Its not working in access sql anyways. There is no &#39;id&#39; field. Do you mean categoryid?"}, {"owner": {"reputation": 31, "user_id": 7128342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf72e96905e96ac04049fae13a0f091a?s=128&d=identicon&r=PG&f=1", "display_name": "sam x", "link": "https://stackoverflow.com/users/7128342/sam-x"}, "edited": false, "score": 0, "creation_date": 1478975505, "post_id": 40498053, "comment_id": 68369264, "body": "Does Access support the row_number() function?"}], "tags": [], "owner": {"reputation": 60, "user_id": 1772361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66eddffaa5611a8cd03a2c715272f735?s=128&d=identicon&r=PG", "display_name": "Russ", "link": "https://stackoverflow.com/users/1772361/russ"}, "is_accepted": false, "score": 0, "last_activity_date": 1478647464, "last_edit_date": 1478647464, "creation_date": 1478647023, "answer_id": 40498053, "question_id": 40496531, "link": "https://stackoverflow.com/questions/40496531/how-to-write-a-sql-microsoft-access-query-that-picks-20-random-records-out-of-10/40498053#40498053", "title": "How to write a sql microsoft access query that picks 20 random records out of 100 but filter based on record categories?", "body": "<pre><code>-- example using sys.all_objects that returns three random objects of each type\nSELECT type_desc, name\nFROM (\n  SELECT type_desc, name, Id = ROW_NUMBER() OVER (PARTITION BY type_desc ORDER BY NEWID())\n  FROM sys.all_objects\n  ) Q\nWHERE Id &lt; 4\n\n-- example using your table\nSELECT QuestionID, QuestionText, CategoryID\nFROM (\n  SELECT QuestionID, QuestionText, CategoryID, Id = ROW_NUMBER() OVER (PARTITION BY CategoryID  ORDER BY NEWID())\n  FROM dbo.MCQuestionsT\n  WHERE CourseCode = '2323'\n  ) Q\nWHERE Id &lt; 4\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7128342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf72e96905e96ac04049fae13a0f091a?s=128&d=identicon&r=PG&f=1", "display_name": "sam x", "link": "https://stackoverflow.com/users/7128342/sam-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478647464, "creation_date": 1478639689, "question_id": 40496531, "link": "https://stackoverflow.com/questions/40496531/how-to-write-a-sql-microsoft-access-query-that-picks-20-random-records-out-of-10", "title": "How to write a sql microsoft access query that picks 20 random records out of 100 but filter based on record categories?", "body": "<p>I need a sql query that will randomly pick 20 records from a table that contains about 100 records. Each record has an associated category that goes from 1 to 15. I want the records that are picked to be completely random. However, I can't have 3 records from the same category being picked. </p>\n\n<p>It seems to me that I can randomly pick 20 records  and then eliminate records which contain a given category >=3 times. And then pick again. But all these implies having more than one query. And I don't know how to pass the results of one query to another and then another in microsoft access query. The query results are supposed to serve as a control source for a form. What do i do so that just one query will give me the results which can then be used as a control source for the form?</p>\n\n<p>I tried the following and the problem is that the questions from the same category are grouped together which is not what I want. Here's a sample of what I am trying.</p>\n\n<pre><code>`(SELECT TOP 3 MCQuestionsT.QuestionID, MCQuestionsT.QuestionText,  MCQuestionsT.CategoryID\nFROM MCQuestionsT\nWHERE (((MCQuestionsT.CourseCode)=\"2323\") AND MCQuestionsT.CategoryID = 1)\nORDER BY Rnd(MCQuestionsT.QuestionID))\nUNION ALL\n(SELECT TOP 3 MCQuestionsT.QuestionID, MCQuestionsT.QuestionText,  MCQuestionsT.CategoryID\nFROM MCQuestionsT\nWHERE (((MCQuestionsT.CourseCode)=\"2323\") AND MCQuestionsT.CategoryID = 2)\nORDER BY Rnd(MCQuestionsT.QuestionID))\nUNION ALL\n(SELECT TOP 3 MCQuestionsT.QuestionID, MCQuestionsT.QuestionText,  MCQuestionsT.CategoryID\nFROM MCQuestionsT\nWHERE (((MCQuestionsT.CourseCode)=\"2323\") AND MCQuestionsT.CategoryID = 3)\nORDER BY Rnd(MCQuestionsT.QuestionID))\n\n`\n</code></pre>\n"}, {"tags": ["excel", "textbox", "userform", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1478639480, "post_id": 40496422, "comment_id": 68237161, "body": "Why is it necessary to have the textbox <i>display</i> the %? It would seem preferable to simply handle the user input in the dependent procedures/functions, and do a conversion there e.g., <code>CDbl(PV.Value)&#47;100)</code>"}, {"owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478639714, "post_id": 40496422, "comment_id": 68237246, "body": "@DavidZemens I suppose it is not necessary but it makes the userform more intuitive to the user if they are clearly aware the value is a %."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478639769, "post_id": 40496422, "comment_id": 68237270, "body": "It will make it harder for the user to enter though, as they will have to enter <code>.05</code> in order to get <code>5%</code> displayed."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1478640210, "post_id": 40496422, "comment_id": 68237449, "body": "It won&#39;t work as posted.  Try typing 0.05 - I get <code>0.00%.05</code> It&#39;s because after the first key stroke the text box contains <code>0.00%</code> then after the second key it&#39;s <code>0.00%.</code> which is no longer interperatable as a number and <code>Format</code> fails and returns the original string.  Better to put a string next to the text box to indicate %, and handle the conversion elsewhere"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1478640314, "post_id": 40496422, "comment_id": 68237490, "body": "@chrisneilsen I wish I could up-vote your comment by about +100"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478641048, "post_id": 40496422, "comment_id": 68237818, "body": "Just put a <i>label</i> next to the textbox, and have the label&#39;s caption as &quot;%&quot;, otherwise, you&#39;re going to have a helluva time trying to intercept keystrokes (backspaces, etc.) and interpret what the user is actually doing. There&#39;s a reason most web forms normalize data like SSN, Phone Numbers, etc., and don&#39;t let you input the hyphen/dash, and most survey forms ask you to fill in a percent as an integer value, etc."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1478641347, "creation_date": 1478641347, "answer_id": 40496927, "question_id": 40496422, "link": "https://stackoverflow.com/questions/40496422/editing-percentage-value-in-userform-textbox/40496927#40496927", "title": "Editing percentage value in Userform TextBox", "body": "<p>You could do your code in the <code>PV_Exit</code> procedure rather than the <code>_Change</code> procedure, but I still think you're asking for trouble this way :)</p>\n\n<pre><code>Private Sub PV_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    PV.Value = Format(PV.Value, \"Percent\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1479816376, "last_edit_date": 1495540416, "creation_date": 1479816376, "answer_id": 40741410, "question_id": 40496422, "link": "https://stackoverflow.com/questions/40496422/editing-percentage-value-in-userform-textbox/40741410#40741410", "title": "Editing percentage value in Userform TextBox", "body": "<p>I agree with the objections made previously, but to show a simple solution without error trapping try this:</p>\n\n<pre><code>Private Sub tbPV_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nDim dblPV As Double\n' don't allow backspace\n  If KeyCode = Asc(vbBack) Then Exit Sub\n' Change string to Double value (without percent sign)\n  dblPV = CDbl(Replace(Me.tbPV.Text, \"%\", \"\"))\n' Show the formatted result\n  Me.tbPV.Text = Format(dblPV, \"0.00\") &amp; \"%\"\n</code></pre>\n\n<p>End Sub</p>\n\n<p><strong>Further Remark</strong> Naming a text box 'PV' only doesn' t seem to be state of the art. Adding a prefix - e.g. 'tb' or 'txt'- to all your <strong>t</strong>ext <strong>b</strong>oxes gives a hint to to control's original type and could give your code a comprehensible structure.</p>\n\n<p>There are number of naming conventions and divergent opinions, but just to give you an impression have a look at\n<a href=\"https://stackoverflow.com/questions/2572946/hungarian-in-vba-okay\">Hungarian in VBA okay?</a> or search within the Stack Overflow's \"naming-conventions\" tag.</p>\n\n<p>Best Regards </p>\n"}], "owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4789, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479816376, "creation_date": 1478639253, "last_edit_date": 1531164843, "question_id": 40496422, "link": "https://stackoverflow.com/questions/40496422/editing-percentage-value-in-userform-textbox", "title": "Editing percentage value in Userform TextBox", "body": "<p>I am attempting to create a textbox which allows users to input a percentage between 1-5% in my Excel-VBA Userform. I have created the textbox and added code to restrict the formatting to always show as a percentage. My problem is that when I attempt to edit the default percentage in the textbox by pressing backspace the decimal moves two spaces to the right instead of deleting any present values. Below is a copy of my code. Please note that the Textbox is not locked.</p>\n\n<pre><code>Private Sub PV_change()\n\nPV.Text = Format(PV.Value, \"Percent\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1478639581, "post_id": 40496325, "comment_id": 68237191, "body": "To code worksheet events from an Addin you will need to code a Application Event Handler in the AddIn.  <a href=\"http://www.cpearson.com/excel/AppEvent.aspx0\" rel=\"nofollow noreferrer\">See here</a>"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478642078, "post_id": 40496325, "comment_id": 68238258, "body": "Take a look here <a href=\"http://www.excelguru.ca/content.php?152-Deploying-Add-ins-in-a-Network-Environment\" rel=\"nofollow noreferrer\">excelguru.ca/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1478640954, "post_id": 40496613, "comment_id": 68237773, "body": "That will only respond to sheet changes in the Addin sheets.  the OP wants to, quote <i>share that code across all excel workbooks on our network.</i>"}], "tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": false, "score": 0, "last_activity_date": 1478640051, "creation_date": 1478640051, "answer_id": 40496613, "question_id": 40496325, "link": "https://stackoverflow.com/questions/40496325/excel-vba-modules-not-working/40496613#40496613", "title": "Excel VBA modules not working", "body": "<p>You must put the <code>Worksheet_Change</code> under the Sheetname of the Excel Objects. So if it is Sheet1 that you want this procedure to run on, you will have to put it under Sheet1. If you want it to work on all sheets in the workbook, you will need to put it under <code>ThisWorkbook</code> AND you need to change the procedure name to <code>Workbook_SheetChange</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4851649"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3790, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478640051, "creation_date": 1478638861, "last_edit_date": 1531161705, "question_id": 40496325, "link": "https://stackoverflow.com/questions/40496325/excel-vba-modules-not-working", "title": "Excel VBA modules not working", "body": "<p>I'm using Excel 2010.</p>\n\n<p>I added this code to my sheet and it works.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(\"A1\") &gt; 0.5 Then\n        MsgBox \"Discount too high\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>But I want to create some way where I could create code and share that code across all excel workbooks on our network.</p>\n\n<p>So I made a module and created an add-in and put the code INTO the module of the add-in.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RbnsE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RbnsE.png\" alt=\"enter image description here\"></a></p>\n\n<p>I deleted the code from the sheet since I want the code to be accessible from the module.</p>\n\n<p>I enabled the module.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q1tAj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q1tAj.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the VBA code doesn't work unless I put the code into the sheet. Please advise how I can just have this code in one file and have that code shared across all excel workbooks on our server.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "is_accepted": false, "score": 0, "last_activity_date": 1478646006, "creation_date": 1478646006, "answer_id": 40497885, "question_id": 40496220, "link": "https://stackoverflow.com/questions/40496220/word-2010-vba-counting-columns/40497885#40497885", "title": "word 2010 vba, counting columns", "body": "<p>.Rows(CR).cells.count yields the number of cells per row</p>\n\n<pre><code>With ActiveDocument.Tables(1).Range\n    For CR = 1 To .Rows.Count\n        For Each acell In .Rows(CR).Cells\n            debug.print .Rows(CR).cells.count\n        next\n    next\nend with\n</code></pre>\n"}], "owner": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594024438, "creation_date": 1478638436, "last_edit_date": 1594024438, "question_id": 40496220, "link": "https://stackoverflow.com/questions/40496220/word-2010-vba-counting-columns", "title": "word 2010 vba, counting columns", "body": "<p>I have an imported table in Word, that contains joined columns. Each line may contain 2 or more columns.\nWhat is the best way of identifying the number of columns on a single line.\nMy aim, is to examine the content of column two when a line contains only two columns,(no line will ever have a single column), and ignore the content of column two then there are more than two columns on a line.</p>\n"}, {"tags": ["excel", "udf", "array-formulas", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1478632828, "post_id": 40494716, "comment_id": 68233685, "body": "It&#39;s hard to know without seeing the code - <a href=\"http://stackoverflow.com/help/how-to-ask\">kindly post the code</a>."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1478633408, "post_id": 40494716, "comment_id": 68233979, "body": "Help us to help you. <b>Post your current code.</b>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478633429, "post_id": 40494716, "comment_id": 68233999, "body": "See <a href=\"http://stackoverflow.com/a/40451062/6535336\">stackoverflow.com/a/40451062/6535336</a> - if you copy a number of values to a range that is larger, but an exact multiple larger, the values get repeated - so copying two values to 8 cells will cause the two values to be repeated 4 times, copying one value to an entire column will cause the one value to be repeated 1048576 times, but copying 7 values to 24 cells will cause the values to only be inserted once (because 7 is not a factor of 24).  So, how big is your target range?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1478634703, "creation_date": 1478634703, "answer_id": 40495288, "question_id": 40494716, "link": "https://stackoverflow.com/questions/40494716/array-udf-keeps-repeating-single-value/40495288#40495288", "title": "Array UDF keeps repeating single value", "body": "<p>If you're using a UDF in an Array Formula context then you can make sure your output array is the correct size by looking at</p>\n\n<pre><code>Application.Caller\n</code></pre>\n\n<p>inside the UDF.</p>\n\n<p>This represents the range where you've entered your array formula.  Use the dimensions of this range to resize your output array to avoid the problem you note in your question.  </p>\n"}], "owner": {"reputation": 1, "user_id": 7132395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J8iq9Cc6PsA/AAAAAAAAAAI/AAAAAAAAG0E/eRlVphJ7iKc/photo.jpg?sz=128", "display_name": "Pieter Koens", "link": "https://stackoverflow.com/users/7132395/pieter-koens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478636333, "creation_date": 1478632415, "last_edit_date": 1531161705, "question_id": 40494716, "link": "https://stackoverflow.com/questions/40494716/array-udf-keeps-repeating-single-value", "title": "Array UDF keeps repeating single value", "body": "<p>I use an array UDF to select elements from a large data file that comply with several criteria. The formula works fine when I have multiple eligible elements, but when there is only one eligible element. The element keeps getting repeated indefinitely. </p>\n\n<p>Example output multiple eligible elements:  </p>\n\n<pre><code>A  \nB  \nC  \nN/A  \nN/A  \n</code></pre>\n\n<p>Example output 1 eligible elements:  </p>\n\n<pre><code>A  \nA  \nA  \nA  \nA  \n</code></pre>\n\n<p>The output array I pass in my UDF contains only 1 element so this seems to be an issue related array functions in general. For instance I can recreate the behaviour using the TRANSPOSE function on 1 cell. </p>\n\n<p><a href=\"https://i.stack.imgur.com/o67mb.png\" rel=\"nofollow noreferrer\">Transpose example</a></p>\n\n<p>Does somebody know a way to avoid this behaviour?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1478634762, "post_id": 40494657, "comment_id": 68234698, "body": "Your comment &quot;The above code gives me the &quot;Type Mismatch&quot; error on If cell.Value = &quot;&quot; Then and it appears that the For loop no longer runs through each cell&quot; confuses me - how do you know it no longer runs through each cell if the first line gives an error?  Or is it a case of the line only gives an error sometimes (e.g. when one of the cells in column A has an error value of some sort)?  What is the value of <code>cell.Row</code> when it crashes?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478634954, "post_id": 40494657, "comment_id": 68234796, "body": "Without anything in the For loop, it only runs once rather than the expected 1736 times.  If I place <code>cell.row</code> inside the loop, I get the expected row when it runs.  I forgot to place <code>Debug.Print</code> the first time hence the error."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478635109, "post_id": 40494657, "comment_id": 68234865, "body": "If I print <code>cell.address</code> then I get $A$1:$A$1736 rather than 1 cell."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1478635802, "post_id": 40494657, "comment_id": 68235233, "body": "Change <code>For Each cell In SheetRNG</code> to <code>For Each cell In SheetRNG.Cells</code> and it should work."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1478637976, "post_id": 40495437, "comment_id": 68236351, "body": "Actually, <code>Range(&quot;A1:B19&quot;).Columns(1)</code> and <code>Range(&quot;A1:A19&quot;)</code> <i>are</i> equivalent.  Properties like <code>Column</code> are <i>relative</i> to the specified range object."}, {"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1478677153, "post_id": 40495437, "comment_id": 68247334, "body": "@chris neilsen, type <code>Set rng1 = Range(&quot;A1:B19&quot;).Columns(1)</code> and <code>Set rng2 = Range(&quot;A1:A19&quot;)</code> , and compare compare both in Locals Window.  They are similar, but different in some parameters."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 0, "last_activity_date": 1478635346, "creation_date": 1478635346, "answer_id": 40495437, "question_id": 40494657, "link": "https://stackoverflow.com/questions/40494657/type-mismatch-on-range-for-loop/40495437#40495437", "title": "Type Mismatch on Range For Loop", "body": "<p>The <code>.Columns(1)</code> statement does not that work the way you have used it. For example:</p>\n\n<pre><code>Set SheetRNG = Range(\"A1:B19\").Columns(1)\n</code></pre>\n\n<p>is not the same like:</p>\n\n<pre><code>Set SheetRNG = Range(\"A1:A19\")\n</code></pre>\n\n<p>You can <code>.Resize()</code> this <code>.UsedRange</code>.</p>\n\n<pre><code>   Set SheetRNG = SOSheet.UsedRange.Resize(SOSheet.UsedRange.Rows.Count, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1478639082, "creation_date": 1478639082, "answer_id": 40496381, "question_id": 40494657, "link": "https://stackoverflow.com/questions/40494657/type-mismatch-on-range-for-loop/40496381#40496381", "title": "Type Mismatch on Range For Loop", "body": "<p>As others have said, and you yourself identified, the issue is that <code>For Each cell In SheetRNG</code> returns the whole ranhe to <code>cell</code>.  </p>\n\n<p>Use <code>For Each cell In SheetRNG.Cells</code> to get each cell individually.</p>\n\n<p>There are other issues in the code as well. See below comments for reccomendations</p>\n\n<pre><code>Sub RebuildAllFormat()\n    Dim SheetRNG As Range, RowDelete As Range, SOSheet As Worksheet\n    Dim cell as Range '&lt;~~ Dim all variables\n\n    Set SOSheet = Sheet1 '&lt;~~ Sheet1 is already a Worksheet reference\n\n    Set SheetRNG = SOSheet.UsedRange.Columns(1) '&lt;~~ May overstate the required range, but will work OK \n\n    For Each cell In SheetRNG.Cells\n        If cell.Value = \"\" Then\n            '~~ Qualify the Sheet reference, otherwise it refers to the active sheet\n            With SOSheet \n                .Cells(cell.Row - 1, \"P\") = .Cells(cell.Row, \"P\") '&lt;~~ faster than Cut/Paste\n                If Not RowDelete Is Nothing Then\n                    Set RowDelete = Union(RowDelete, cell)\n                Else\n                    Set RowDelete = cell\n                End If\n            End With\n        End If\n    Next cell\n\n    '~~ Avoid error if no blanks found\n    If Not RowDelete Is Nothing Then\n        RowDelete.EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2040, "favorite_count": 0, "accepted_answer_id": 40496381, "answer_count": 2, "score": 0, "last_activity_date": 1478639082, "creation_date": 1478632191, "last_edit_date": 1531164843, "question_id": 40494657, "link": "https://stackoverflow.com/questions/40494657/type-mismatch-on-range-for-loop", "title": "Type Mismatch on Range For Loop", "body": "<p>I am trying to rebuild a worksheet we use daily and in the process make it faster.  I've been working with ranges now and trying to incorporate those but ran into a problem when trying to use <code>UsedRange</code> to get the last row for the range than finding it.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub RebuildAllFormat()\n\nDim SheetRNG As Range, RowDelete As Range, SOSheet As Worksheet\n\nSet SOSheet = ThisWorkbook.Worksheets(Sheet1.Name)\n\nSet SheetRNG = SOSheet.UsedRange.Columns(1)   \n\nFor Each cell In SheetRNG\n    If cell.Value = \"\" Then\n        Cells(cell.Row, \"P\").Cut Cells(cell.Row - 1, \"P\")\n                If Not RowDelete Is Nothing Then\n                    Set RowDelete = Union(RowDelete, cell)\n                Else\n                    Set RowDelete = cell\n                End If\n    End If\nNext cell\n\nRowDelete.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>The above code gives me the \"Type Mismatch\" error on <code>If cell.Value = \"\" Then</code> and it appears that the For loop no longer runs through each cell even though I get the expected value from <code>Debug.Print SheetRNG.Address</code> which is $A$1:$A$1736.</p>\n\n<p>If I replace <code>Set SheetRNG = SOSheet.UsedRange.Columns(1)</code> with </p>\n\n<pre><code>lastrow = SOSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n\nSet SheetRNG = SOSheet.Range(SOSheet.Range(\"A1\"), SOSheet.Cells(lastrow, \"A\"))\n</code></pre>\n\n<p>then the loop works as expected and I'm able to check values.  Running <code>Debug.Print SheetRNG.Address</code> after using the above also returns $A$1:$A$1736.</p>\n\n<p>Am I missing something in the <code>UsedRange</code> code or is it not possible to use it that way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478631896, "post_id": 40494487, "comment_id": 68233210, "body": "What is ThisWorkbook.Sheets(1).Range(&quot;A2&quot;).Value"}, {"owner": {"reputation": 1, "user_id": 7116004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff764733e9d425cd6e21e78abd0ea9fd?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doe28", "link": "https://stackoverflow.com/users/7116004/m-doe28"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478631977, "post_id": 40494487, "comment_id": 68233261, "body": "@Nathan_Sav please see updated question. Cell A2 contains 19:00 as time format"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478632001, "post_id": 40494487, "comment_id": 68233276, "body": "think you need to add seconds also, and perhaps it needs to be the text value rather than the value, as this will be a number??"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1478638561, "post_id": 40495827, "comment_id": 68236703, "body": "I tried this approach but for some reason it didn&#39;t seem to work (hence my more complicated but now deleted answer). I just tried it again and it does work. I must have had some sort of typo in my original test."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1483309832, "last_edit_date": 1483309832, "creation_date": 1478636938, "answer_id": 40495827, "question_id": 40494487, "link": "https://stackoverflow.com/questions/40494487/vba-automatically-run-macro-in-excel-if-cell-value-current-time/40495827#40495827", "title": "VBA automatically run macro in excel, if cell value = current time?", "body": "<p>A Cell with a Time Serial formatted to display as a time is <em>already</em> in the correct format for <code>OnTime</code>, so just use</p>\n\n<pre><code>Application.OnTime ThisWorkbook.Sheets(1).Range(\"A2\").Value, \"MyMacro\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7116004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff764733e9d425cd6e21e78abd0ea9fd?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doe28", "link": "https://stackoverflow.com/users/7116004/m-doe28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "closed_date": 1478675222, "answer_count": 1, "score": -2, "last_activity_date": 1483309832, "creation_date": 1478631515, "last_edit_date": 1478633050, "question_id": 40494487, "link": "https://stackoverflow.com/questions/40494487/vba-automatically-run-macro-in-excel-if-cell-value-current-time", "closed_reason": "Not suitable for this site", "title": "VBA automatically run macro in excel, if cell value = current time?", "body": "<p>I am trying to run a piece of vba code automatically when the time in a cell matches the current pc time.</p>\n\n<p>Cell A2 is on sheet 1, cell A2 contains a time value of 19:00 for example</p>\n\n<p>Here is my code:</p>\n\n<p>This workbook:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Application.OnTime TimeValue(ThisWorkbook.Sheets(1).Range(\"A2\").Value), \"MyMacro\"\n\nEnd Sub\n</code></pre>\n\n<p>Module1:</p>\n\n<pre><code>Sub MyMacro()\nMsgBox \"Hey\"\nEnd Sub\n</code></pre>\n\n<p>For some reason this doesnt work, please can someone show me where i am going wrong? Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1478631371, "post_id": 40494394, "comment_id": 68232912, "body": "Those <code>LinkToFile</code> and <code>SaveWithDocument</code>, are they meant to be properties of an object? (Because I guess they are currently undeclared variables. Put <code>option explicit</code> at the top.)."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1478631496, "post_id": 40494394, "comment_id": 68232987, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/38509557/11683\">VBA Workbook Savechanges = False still saving and closing workbook when running Macro</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478631788, "post_id": 40494394, "comment_id": 68233154, "body": "@YowE3K They need to replace <code>LinkToFile = False</code> with <code>LinkToFile := False</code>, which is why it&#39;s a duplicate."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1478632071, "post_id": 40494394, "comment_id": 68233316, "body": "@Gserg - Ahhh - I had noticed the weirdness of <code>LinkToFile = False</code>, but the MSDN page I found about <code>Pictures.Insert</code> said that the second parameter (of only two parameters) was the <code>Converter</code> parameter which took an object, so I was thinking the reference to <code>LinkToFile</code> was just plain wrong."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1478632459, "post_id": 40494394, "comment_id": 68233505, "body": "@gserg - It looks like <code>LinkToFile</code> is a parameter to the <code>Shapes.AddPicture</code> method, but not to the <code>Pictures.Insert</code> method."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478633014, "post_id": 40494394, "comment_id": 68233787, "body": "<code>MsgBox (&quot;You Forgot Your Image.&quot;)</code> - these superfluous parentheses will eventually bite you in the rear end. <a href=\"http://stackoverflow.com/documentation/vba/1179/procedure-calls/3818/this-is-confusing-why-not-just-always-use-parentheses#t=201611081923154601046\">See why on Documentation.SO</a>."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1478632953, "creation_date": 1478632953, "answer_id": 40494852, "question_id": 40494394, "link": "https://stackoverflow.com/questions/40494394/how-do-i-remove-link-to-image/40494852#40494852", "title": "HOW DO I REMOVE LINK TO IMAGE", "body": "<p>Try the following code:</p>\n\n<pre><code>Sub ChangeImage()\n\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect = False\n        .ButtonName = \"Submit\"\n        .Title = \"Select an image file\"\n        .Filters.Clear\n        .Filters.Add \"JPG\", \"*.JPG\"\n        .Filters.Add \"JPEG File Interchange Format\", \"*.JPEG\"\n        .Filters.Add \"Graphics Interchange Format\", \"*.GIF\"\n        .Filters.Add \"Portable Network Graphics\", \"*.PNG\"\n        .Filters.Add \"Tag Image File Format\", \"*.TIFF\"\n        .Filters.Add \"All Pictures\", \"*.*\"\n\n        If .Show = -1 Then\n            Application.ActiveSheet.Shapes.AddPicture FileName:=.SelectedItems(1), _\n                                                      LinkToFile:=False, _\n                                                      SaveWithDocument:=True, _\n                                                      Left:=568, _\n                                                      Top:=63, _\n                                                      Width:=155, _\n                                                      Height:=91\n\n        Else\n            MsgBox (\"You Forgot Your Image.\")\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>(And, as GSerg suggested in a comment, include <code>Option Explicit</code> at the start of all your code modules to ensure that your variables are correctly defined.)</p>\n"}], "owner": {"reputation": 1, "user_id": 7133239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2eb219725aa719c62a4466ac321ed5c?s=128&d=identicon&r=PG&f=1", "display_name": "Kile", "link": "https://stackoverflow.com/users/7133239/kile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 681, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478632953, "creation_date": 1478631170, "last_edit_date": 1478631291, "question_id": 40494394, "link": "https://stackoverflow.com/questions/40494394/how-do-i-remove-link-to-image", "title": "HOW DO I REMOVE LINK TO IMAGE", "body": "<p>I am using this code works good at inserting images and adjusting. The problem I have is when you open in another pc the images are missing and a it shows link missing. Can anyone help me with this fix?</p>\n\n<pre><code>Sub ChangeImage()\n\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect = False\n        .ButtonName = \"Submit\"\n        .Title = \"Select an image file\"\n        .Filters.Clear\n        .Filters.Add \"JPG\", \"*.JPG\"\n        .Filters.Add \"JPEG File Interchange Format\", \"*.JPEG\"\n        .Filters.Add \"Graphics Interchange Format\", \"*.GIF\"\n        .Filters.Add \"Portable Network Graphics\", \"*.PNG\"\n        .Filters.Add \"Tag Image File Format\", \"*.TIFF\"\n        .Filters.Add \"All Pictures\", \"*.*\"\n\n        If .Show = -1 Then\n            Dim img As Object\n            Set img = ActiveSheet.Pictures.Insert(.SelectedItems(1), LinkToFile = False)\n             LinkToFile = False\n             SaveWithDocument = True\n            'Scale image size\n            'img.ShapeRange.ScaleWidth .75, msoFalse, msoScaleFromTopLeft\n            'img.ShapeRange.ScaleHeight .75, msoFalse, msoScaleFromTopLeft\n\n            'Position Image\n            img.Left = 568\n            img.Top = 63\n\n            'Set image sizes in points (71 point per inch)\n            img.Width = 155\n            img.Height = 91\n        Else\n            MsgBox (\"You Forgot Your Image.\")\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "transpose"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1478631324, "last_edit_date": 1478631324, "creation_date": 1478630662, "answer_id": 40494248, "question_id": 40494229, "link": "https://stackoverflow.com/questions/40494229/pasting-1d-array-vba-with-transpose/40494248#40494248", "title": "Pasting 1D array VBA - with transpose", "body": "<p>You need to specify the number of cells for the output.  You are currently only specifiying one cell.</p>\n\n<p>You can use Resize to dynamically set the size of the output range:</p>\n\n<pre><code>Sub test()\n  Dim str() As String\n\n  str = Split(Range(\"A1\").Value, \"/\")\n  Range(\"C1\").Resize(Ubound(str)+1).Value = Application.Transpose(str)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6205270, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c971cac4a2ea1bc31285a311206a62a4?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/6205270/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 0, "accepted_answer_id": 40494248, "answer_count": 1, "score": 0, "last_activity_date": 1478631324, "creation_date": 1478630580, "last_edit_date": 1531164843, "question_id": 40494229, "link": "https://stackoverflow.com/questions/40494229/pasting-1d-array-vba-with-transpose", "title": "Pasting 1D array VBA - with transpose", "body": "<p><a href=\"https://i.stack.imgur.com/bHlfi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bHlfi.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have something that looks like above. Basically I need to split the string and paste it vertically down column C.</p>\n\n<pre><code>Sub test()\n  Dim str() As String\n\n  str = Split(Range(\"A1\").Value, \"/\")\n  Range(\"C1\").Value = Application.Transpose(str)\n\nEnd Sub\n</code></pre>\n\n<p>The transpose is not working. Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1478630767, "post_id": 40494209, "comment_id": 68232585, "body": "What part of that task are you having trouble with?"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1478630790, "post_id": 40494209, "comment_id": 68232601, "body": "Any reason you can&#39;t just remove the End Sub from the first and the header from the second?"}], "answers": [{"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 1, "last_activity_date": 1478637602, "last_edit_date": 1478637602, "creation_date": 1478637037, "answer_id": 40495854, "question_id": 40494209, "link": "https://stackoverflow.com/questions/40494209/combine-two-private-sub-worksheet-changes/40495854#40495854", "title": "Combine two Private Sub Worksheet_Changes", "body": "<h2>?</h2>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim C As Range, SortRange as Range\n  If Not Intersect(Target, Me.Range(\"D:D\")) Is Nothing Then\n      For Each C In Intersect(Target, Me.Range(\"D:D\")).Cells\n        If C.Text = \"y\" Then\n          C.EntireRow.Copy Worksheets(\"Shipped\").Cells(Rows.Count, \"D\").End(xlUp).Offset(1).EntireRow\n          C.EntireRow.Delete\n        End If\n      Next\n  End If\n'End Sub\n\n'Private Sub Worksheet_Change(ByVal Target As Range)\n  If Target.Column = 8 And Target.Cells.Count &lt;= 1 Then\n    Set SortRange = Range((\"A1\"), Cells(Rows.Count, 8).End(xlUp))\n    SortRange.Sort Key1:=Range(\"H2\"), Order1:=xlAscending, Header:=xlYes\n  End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Instead of existing the <code>Sub</code> with your <code>If Statements</code>, they codes will only run if the opposite of your original <code>If Statements</code> are true. I also commented out the <code>Sub</code> declaration statement of the second <code>Sub</code> and the <code>End Sub</code> of the first <code>Sub</code>. Is this what you wanted?</strong></p>\n"}], "owner": {"reputation": 1, "user_id": 7132865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad243251cc4fad500752ce540754f02f?s=128&d=identicon&r=PG&f=1", "display_name": "mark mullet", "link": "https://stackoverflow.com/users/7132865/mark-mullet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478637602, "creation_date": 1478630509, "last_edit_date": 1531164843, "question_id": 40494209, "link": "https://stackoverflow.com/questions/40494209/combine-two-private-sub-worksheet-changes", "title": "Combine two Private Sub Worksheet_Changes", "body": "<p>I am trying to combine the following 2 codes. Any help would be appreciated</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim C As Range\n  If Intersect(Target, Me.Range(\"D:D\")) Is Nothing Then Exit Sub\n  For Each C In Intersect(Target, Me.Range(\"D:D\")).Cells\n    If C.Text = \"y\" Then\n      C.EntireRow.Copy Worksheets(\"Shipped\").Cells(Rows.Count, \"D\").End(xlUp).Offset(1).EntireRow\n      C.EntireRow.Delete\n    End If\n  Next\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n  If Target.Column &lt;&gt; 8 Or Target.Cells.Count &gt; 1 Then Exit Sub\n    Dim SortRange As Range\n    Set SortRange = Range((\"A1\"), Cells(Rows.Count, 8).End(xlUp))\n           SortRange.Sort Key1:=Range(\"H2\"), Order1:=xlAscending, Header:=xlYes\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "is_accepted": false, "score": -1, "last_activity_date": 1478636744, "creation_date": 1478636744, "answer_id": 40495773, "question_id": 40494089, "link": "https://stackoverflow.com/questions/40494089/vba-to-automatically-update-a-table-in-one-workbook-based-on-a-sheet-in-a-differ/40495773#40495773", "title": "VBA to automatically update a table in one workbook based on a sheet in a different workbook", "body": "<p>You could always just copy the data from one workbook and paste it to the other.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Sub Transfer_Data()\n\nWindows(\"2015\").Activate\nRange (\"A1:P144031\").Select\nSelection.Copy\nWindows(\"Mergetest\").Activate\nRange (\"A1\").Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "is_accepted": false, "score": 1, "last_activity_date": 1478651501, "creation_date": 1478651501, "answer_id": 40498682, "question_id": 40494089, "link": "https://stackoverflow.com/questions/40494089/vba-to-automatically-update-a-table-in-one-workbook-based-on-a-sheet-in-a-differ/40498682#40498682", "title": "VBA to automatically update a table in one workbook based on a sheet in a different workbook", "body": "<p>Devin's answer works well but you want to try to avoid using <code>.select</code> when at all possible. I would suggest something more along the lines of:</p>\n\n<pre><code>sub Transfer()\n\n    Dim copyRangeValues as Long\n    Dim destinationRange as Range\n    Workbook(\"2015.xls\").Activate\n    set copyRangeValues = Worksheet(\"Sheet1\").Range(\"A1:P144031\").Value\n    Worksheet(\"Mergetest.xls\").Activate\n    set destinationRange = Worksheet(\"Sheet1\").Range(\"A1:P144031\") \n    destinationRange.Value = copyRangeValues\n\nEnd Sub\n</code></pre>\n\n<p>This assumes that A1:P144031 is also the range of cells that your table in the second sheet is in. You would need to modify that if its not, or add some counter variables to make it more automated.</p>\n"}], "owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478651501, "creation_date": 1478630055, "question_id": 40494089, "link": "https://stackoverflow.com/questions/40494089/vba-to-automatically-update-a-table-in-one-workbook-based-on-a-sheet-in-a-differ", "title": "VBA to automatically update a table in one workbook based on a sheet in a different workbook", "body": "<p>Good Afternoon Everyone,</p>\n\n<p>I have two workbooks where i want Excel to automatically update the table in one sheet based on the other one.\ni want the table in workbook MergetestSheet!2015 to automatically update based on the table in workbook 2015Sheet!1 Range A1:p144,031. Can someone help with the VBA code?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "ms-word", "dialog", "built-in"], "comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1478634680, "post_id": 40493982, "comment_id": 68234666, "body": "I think the reason this kind of thing is not a common piece of reference code is that you&#39;re talking about (a) a form, including properties and controls (b) some code driving the form (c) a public module function or a class that hides the complexity. Sharing those things together in some easy copy-paste format would be rather difficult."}, {"owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1478710511, "post_id": 40493982, "comment_id": 68266195, "body": "@Blackhawk I was hoping it would be a Microsoft standard VBA library for a picker dialog.  But I do see that there are no general dialogs available; all the pre-canned dialogs for vba seem to be coded for Excel or Word functionality and exposed to VBA via Application.Dialogs(wdDialogInsertField).Show (for instance.)"}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478632416, "post_id": 40494683, "comment_id": 68233478, "body": "Sure, that&#39;s the hand coded method.  It just seems like that should EXIST in MS code because it&#39;s such an elementary implementation."}], "tags": [], "owner": {"reputation": 246, "user_id": 6788933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d2b2dc42c7da9169786fe754ce86cd4?s=128&d=identicon&r=PG&f=1", "display_name": "user6788933", "link": "https://stackoverflow.com/users/6788933/user6788933"}, "is_accepted": false, "score": 1, "last_activity_date": 1478632310, "creation_date": 1478632310, "answer_id": 40494683, "question_id": 40493982, "link": "https://stackoverflow.com/questions/40493982/creating-a-string-picker-dialog-from-a-collection-in-vba-via-built-in-dialog/40494683#40494683", "title": "Creating a string picker dialog from a collection in vba via built in dialog?", "body": "<p>My aproach would be to create a Form, add a ListBox, Ok, Cancel and the ShowModal property.\nTo use it first set the ListBox RowSource according to what you need:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff196460.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff196460.aspx</a></p>\n\n<p>Then make it visible, manage Ok/Cancel and then use the ItemsSelect property (multiselect is possible): \n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff823015.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff823015.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478632745, "post_id": 40494753, "comment_id": 68233642, "body": "Gaah.  What craziness.  Thanks much.  The investment in something globally useful is more than &quot;just make it work&quot; but maybe the useful solution will evolve over time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478632933, "post_id": 40494753, "comment_id": 68233743, "body": "@BenPen you might also want to consider writing a COM-visible type library in C# or VB.NET, and work off arrays instead of collections (easier marshaling I guess), for a more &quot;universal&quot; solution. Heck, you could even make it a cutting-edge WPF UI and reimplement the <code>MsgBox</code> and <code>InputBox</code> functions, too."}, {"owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478633744, "post_id": 40494753, "comment_id": 68234181, "body": "I was actually looking to make use of polymorphism.  Collections have an interator with GetFirst and GetNext, right?   Is it just wishful thinking that there&#39;s uniformity of interface for accessing a list of x in word or excel? (range of cells, set of sentences, set of paragraphs, array, etc)  If you just throw a collection at the popup and maybe a sort order option: ascending, decending or default (randomish in non-sequential collections such as a hash).  It would be super easy to use.  If you cared a lot about order, you just create an array to pass in, if not, use the defaults."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 1, "creation_date": 1478634376, "post_id": 40494753, "comment_id": 68234514, "body": "<i>Collections have an interator with GetFirst and GetNext, right?</i> not quite. Iteratable types have a hidden <code>_NewEnum</code> member with <code>UserMemId</code> flag set to <code>-4</code>, that returns an <code>IUnknown</code>. There&#39;s no &quot;framework&quot; in VBA, the <code>Collection</code> class doesn&#39;t &quot;implement&quot; some <code>IEnumerable</code> interface that you can use, so you would have to make your parameter a <code>Variant</code> and then determine if that&#39;s an array, or else try to iterate it with <code>For Each</code> - seems you&#39;re expecting VBA to be strongly typed as a .NET language. It&#39;s not. It&#39;s from last century."}, {"owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478635877, "post_id": 40494753, "comment_id": 68235265, "body": "Ah.  And it never caught up...  That would be why such a window doesn&#39;t exist: no uniformity of access interface between all storage methods.   Sometimes the price of backwards compatibility back to the dawn of time is quite high...  This would have been an easy thing to fix over time, if not for that...  Make the object model go a bit deeper, and voila.  Thanks @mat&#39;smug."}, {"owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478711387, "post_id": 40494753, "comment_id": 68266696, "body": "As a non-com object, could I not declare the build function as Build(list as object), pass in any object that is a collection that works with foreach and use foreach to get the strings in the collection?   I realize that for COM, you&#39;d have to standardize on variant, and it gets dicey, but a code module/add-in should be able to do this, no?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "edited": false, "score": 0, "creation_date": 1478712392, "post_id": 40494753, "comment_id": 68267214, "body": "VBA objects <i>are</i> COM obejcts. But yeah, you could pass anything that works with <code>For Each</code> and work with that - but I&#39;d go with <code>Variant</code> instead of <code>Object</code>; <code>Object</code> would not work with arrays, <code>Variant</code> would. Although, it&#39;s debatable whether iterating arrays with <code>For Each</code> is a good idea."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1478632586, "creation_date": 1478632586, "answer_id": 40494753, "question_id": 40493982, "link": "https://stackoverflow.com/questions/40493982/creating-a-string-picker-dialog-from-a-collection-in-vba-via-built-in-dialog/40494753#40494753", "title": "Creating a string picker dialog from a collection in vba via built in dialog?", "body": "<p>Yup, no such thing.</p>\n\n<p>Hand-code it, and keep it as part of your VBA \"toolbox\" - make yourself an add-in that other VBA projects can reference, so you can reuse the code without having to rewrite it every time.</p>\n\n<p>Then export the code modules from your host document, upload them to a GitHub repository, and share your solution with the world so the next person looking for it doesn't need to implement it from scratch again.</p>\n\n<p>The VBA standard library is rather limited, and beyond <code>MsgBox</code> there isn't much available in terms of built-in UI. That's just how it is.</p>\n"}], "owner": {"reputation": 361, "user_id": 2129481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525348ee13623bc031e5e336d465a782?s=128&d=identicon&r=PG", "display_name": "BenPen", "link": "https://stackoverflow.com/users/2129481/benpen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478706164, "creation_date": 1478629597, "last_edit_date": 1495541216, "question_id": 40493982, "link": "https://stackoverflow.com/questions/40493982/creating-a-string-picker-dialog-from-a-collection-in-vba-via-built-in-dialog", "title": "Creating a string picker dialog from a collection in vba via built in dialog?", "body": "<p>(Questions with an answer of NO are still useful; they're just not the solution to the problem.  Answers say, no, there is no built-in, you have to implement the dialog for yourself...)</p>\n\n<p>In VBA, (ms-word, or ms-excel, but seems like a generic operation) is there any way to simply a provide a collection to a built in dialog in order to prompt the user to select a value from a list of values?  </p>\n\n<p>I can't believe there's not a built in method to do this, it seems like a such a generic operation that could be coded once and everybody would re-use it.  I can certainly hand code it, but why bother if it's already in the vba libraries someplace.</p>\n\n<p>I've searched for a solution, but it does appear that the standard answer is to <a href=\"https://stackoverflow.com/questions/24435931/ladding-files-to-a-two-column-listbox/24436376#24436376\">hand code it</a>.  </p>\n"}, {"tags": ["vb.net", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 3, "creation_date": 1478628883, "post_id": 40493742, "comment_id": 68231616, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">Tour</a>.  This shows no effort to solve the problem yourself.  Also VB.NET IsNot vba"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478629095, "post_id": 40493742, "comment_id": 68231728, "body": "<a href=\"http://stackoverflow.com/documentation/vba/3480/searching-within-strings-for-the-presence-of-substrings#t=201611081817391650478\">Searching within strings for the presence of substrings</a>, from the [Documentation] button right here on this page."}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1478633304, "post_id": 40493742, "comment_id": 68233927, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/system.string.chars(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><b><code>String.Chars()</code> property</b></a>."}, {"owner": {"reputation": 851, "user_id": 5170116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g76oA.png?s=128&g=1", "display_name": "JerryM", "link": "https://stackoverflow.com/users/5170116/jerrym"}, "edited": false, "score": 0, "creation_date": 1478642121, "post_id": 40493742, "comment_id": 68238272, "body": "Consider the possibility that the string might be less than 3 characters."}, {"owner": {"reputation": 1806, "user_id": 6729812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffac5788cea655c101342b4bc638a039?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Skiba", "link": "https://stackoverflow.com/users/6729812/marek-skiba"}, "edited": false, "score": 0, "creation_date": 1478642884, "post_id": 40493742, "comment_id": 68238652, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17127272/getting-char-from-string-at-specified-index-in-the-visual-basic\">Getting char from string at specified index in the visual basic</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11547, "user_id": 832052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VA1xt.png?s=128&g=1", "display_name": "djv", "link": "https://stackoverflow.com/users/832052/djv"}, "is_accepted": true, "score": 0, "last_activity_date": 1478637183, "creation_date": 1478637183, "answer_id": 40495895, "question_id": 40493742, "link": "https://stackoverflow.com/questions/40493742/check-a-specific-character-in-textbox-visual-basic/40495895#40495895", "title": "check a specific character in textbox visual basic?", "body": "<p>You could use this function</p>\n\n<pre><code>Private Function checkCharacter(thisString As String,\n                                searchCharacter As Char,\n                                index As Integer)\n    Try\n        Return thisString(index) = searchCharacter\n    Catch\n        Return False\n    End Try\nEnd Function\n</code></pre>\n\n<p>Call it like this</p>\n\n<pre><code>Dim result As Boolean = checkCharacter(TextBox1.Text, \"l\"c, 2)\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 7122363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8fhFi.jpg?s=128&g=1", "display_name": "Greg Koc", "link": "https://stackoverflow.com/users/7122363/greg-koc"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "closed_date": 1478678479, "accepted_answer_id": 40495895, "answer_count": 1, "score": -3, "last_activity_date": 1478637183, "creation_date": 1478628739, "question_id": 40493742, "link": "https://stackoverflow.com/questions/40493742/check-a-specific-character-in-textbox-visual-basic", "closed_reason": "Needs details or clarity", "title": "check a specific character in textbox visual basic?", "body": "<p>Lets say i have a textbox containing the string \"hello\".</p>\n\n<p>Is there a way in which can i check that the 3rd character of textbox.text = \"l\"?</p>\n\n<p>We are talking about visual basic, of course.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1478628583, "post_id": 40493478, "comment_id": 68231471, "body": "You need to swap the parameters around as AVERAGEIF takes the range, criteria, [average range] so: <code>AVERAGEIF(&#39;Daily KPI w Rows&#39;!K:K, &#39;Daily KPI w Rows&#39;!K:K = LastColumnCell(&#39;Daily KPI w Rows&#39;!B:B))</code> I think as you want to check column K for the date and average column B. I&#39;m not sure if you need your custom function or not as you might choose to use <code>MAX(K:K)</code>"}, {"owner": {"reputation": 2427, "user_id": 4044400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/66e0ff17a11f74087ee15055ce6ab367?s=128&d=identicon&r=PG", "display_name": "Jonathan Bechtel", "link": "https://stackoverflow.com/users/4044400/jonathan-bechtel"}, "reply_to_user": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1478671366, "post_id": 40493478, "comment_id": 68245400, "body": "Thank you Max. I do need the function because this will eventually spill into new years with repeating months."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 1399616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMsUc.jpg?s=128&g=1", "display_name": "Matt M", "link": "https://stackoverflow.com/users/1399616/matt-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1478628685, "creation_date": 1478628685, "answer_id": 40493725, "question_id": 40493478, "link": "https://stackoverflow.com/questions/40493478/using-averageif-to-determine-month-to-date-metrics-in-excel/40493725#40493725", "title": "Using AVERAGEIF to Determine Month to Date Metrics in Excel", "body": "<p>I can't see your images, but if I am to assume that:</p>\n\n<p>1.) Column B contains the metrics\n2.) Column K contains the month value</p>\n\n<p>...your formula should be:</p>\n\n<pre><code>=AVERAGEIF('Daily KPI w Rows'!K:K,\"  LastColumnCell('Daily KPI w Rows'!K:K)\",'Daily KPI w Rows'!B:B)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "is_accepted": false, "score": 0, "last_activity_date": 1478629122, "creation_date": 1478629122, "answer_id": 40493839, "question_id": 40493478, "link": "https://stackoverflow.com/questions/40493478/using-averageif-to-determine-month-to-date-metrics-in-excel/40493839#40493839", "title": "Using AVERAGEIF to Determine Month to Date Metrics in Excel", "body": "<p>Just use this formula:</p>\n\n<pre><code>=AVERAGEIF('Daily KPI w Rows'!B:B,MAX('Daily KPI w Rows'!B:B),'Daily KPI w Rows'!A:A)\n</code></pre>\n\n<p>There <code>MAX('Daily KPI w Rows'!B:B)</code> is to get last entered month of data. Then you dont need to use VBA code.</p>\n"}], "owner": {"reputation": 2427, "user_id": 4044400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/66e0ff17a11f74087ee15055ce6ab367?s=128&d=identicon&r=PG", "display_name": "Jonathan Bechtel", "link": "https://stackoverflow.com/users/4044400/jonathan-bechtel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478629122, "creation_date": 1478627706, "last_edit_date": 1495541210, "question_id": 40493478, "link": "https://stackoverflow.com/questions/40493478/using-averageif-to-determine-month-to-date-metrics-in-excel", "title": "Using AVERAGEIF to Determine Month to Date Metrics in Excel", "body": "<p>I'm trying to create a dashboard that calculates month to date averages for various metrics that are logged in a separate sheet in the same workbook.</p>\n\n<p>This is an example of one of what one of the dashboard components will look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ayx24.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ayx24.png\" alt=\"Sample Dashboard Widget\"></a></p>\n\n<p>This is a picture of the table I'm populating the data from:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/HSHz5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HSHz5.png\" alt=\"Example Data Table\"></a></p>\n\n<p>So, to populate the month to date average for logistics I'm trying to use the AVERAGEIF function, where I'd like to average the values in the 'Logistics' column if the values in the 'Month' column are equal to the last entered value in that column.  (I know you'd ideally want to check for both month and year, but since the data for this table started at the beginning of the year this is not necessary for now).  </p>\n\n<p>I have tried many permutations of the <a href=\"https://stackoverflow.com/questions/16846367/get-average-based-on-value-in-another-row\">answers listed in this question</a>, but none have worked for me and I'm not sure why.</p>\n\n<p>Here are some of the different versions I've tried:</p>\n\n<pre><code>=AVERAGEIF('Daily KPI w Rows'!B:B, 'Daily KPI w Rows'!K:K = LastColumnCell('Daily KPI w Rows'!K:K))\n=AVERAGEIF('Daily KPI w Rows'!B:B,  LastColumnCell('Daily KPI w Rows'!K:K))\n=AVERAGEIF('Daily KPI w Rows'!B:B,  LastColumnCell('Daily KPI w Rows'!K:K), 'Daily KPI w Rows'!B:B)\n=AVERAGEIF('Daily KPI w Rows'!B:B,  'Daily KPI w Rows'!K:K = LastColumnCell('Daily KPI w Rows'!K:K), 'Daily KPI w Rows'!B:B)\n</code></pre>\n\n<p><strong>Important</strong></p>\n\n<p>LastColumnCell is a VBA function I wrote that grabs the last value in a column. </p>\n\n<p>It uses the following code:</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Function LastColumnCell (arg As Range)\n    LastColumnCell = arg.End(xlDown)\nEnd Function \n</code></pre>\n\n<p>So the idea is that if November is the latest month that there's data then it'll average the values in 'Logistics' if the value in the 'Month' column is equal to 11.</p>\n\n<p>All my implementations of the AVERAGEIF function get the <code>Div/#0</code> error message, so apparently none of these are evaluating to True, but I'm not sure why.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "vb6"], "comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478638820, "post_id": 40493248, "comment_id": 68236834, "body": "I think the best solution would be to &quot;insert&quot; a new column where you use <code>=Len(L4)</code> and then <code>AutoFill</code>. Then you sort the 2 columns, L+the new one with the formula, on numbers largest to smallest.  Afterwards you loop through column L to find the first cell containing 2 values, e.g. EA and -1 that range with 1, so you find the range containing text with more than 2 chars. Afterwards, you solve that range on A to Z. Then you will achieve the above."}, {"owner": {"reputation": 199, "user_id": 4415301, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p2GZU.jpg?s=128&g=1", "display_name": "Obfuscated", "link": "https://stackoverflow.com/users/4415301/obfuscated"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478703426, "post_id": 40493248, "comment_id": 68261678, "body": "Yeah, that&#39;s where I&#39;ve been leaning, but was hoping someone might know a way that was a little neater/cleaner. Thanks."}], "owner": {"reputation": 199, "user_id": 4415301, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p2GZU.jpg?s=128&g=1", "display_name": "Obfuscated", "link": "https://stackoverflow.com/users/4415301/obfuscated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478627234, "creation_date": 1478626887, "last_edit_date": 1478627234, "question_id": 40493248, "link": "https://stackoverflow.com/questions/40493248/how-to-modify-an-advanced-filter-copy", "title": "How to modify an advanced filter copy", "body": "<p>I have a list similar to this:</p>\n\n<pre><code>EO\nEV\nEA\nEZ\nExtra Bar(s) Loaded\nExtra Pc(s) in Cut Pattern\nExtra Pc(s) in Make Up Bar\nBB Substitution\nEL\nSet Up Bar(s)\nMissed Lab\n</code></pre>\n\n<p>I am using </p>\n\n<pre><code>wrksh.Range(\"F4:F\" &amp; rn).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ActiveSheet.Range(\"L4\"), Unique:=True\n</code></pre>\n\n<p>to copy unique item to range \"L4\" from the column \"F\".</p>\n\n<p>I want to sort them with the ones greater in length than 2 first, then the 2 letter items below them, all in column \"L4\" and down.</p>\n\n<p>Can that be accomplished with the advanced filter copy to function? If not how would I modify a normal sort routine to list all the \"long\" ones first, then the \"short\" ones?</p>\n\n<p>I'm using VB6 to build the excel sheet.</p>\n\n<p>The final result should look like this:</p>\n\n<pre><code>BB Substitution\nExtra Bar(s) Loaded\nExtra Pc(s) in Cut Pattern\nExtra Pc(s) in Make Up Bar\nMissed Lab\nSet Up Bar(s)\nEA\nEL\nEO\nEV\nEZ\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1478625482, "post_id": 40492800, "comment_id": 68229756, "body": "<code>=Max(A1:C1)</code> and copy/drag the formula down."}, {"owner": {"reputation": 1, "user_id": 7132867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef103d677f50217c8e5b13daa0140c0?s=128&d=identicon&r=PG&f=1", "display_name": "Waran", "link": "https://stackoverflow.com/users/7132867/waran"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478625997, "post_id": 40492800, "comment_id": 68230076, "body": "It is not my problem. I don&#39;t need the highest value of set A1, B1, C1. I need the highest value of C from all rows in which A=x. And i do have circa 5k families to go (so 5k of uniqe A values), each family can have different number of members. But thank you for the response!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1478626141, "post_id": 40492800, "comment_id": 68230140, "body": "Ah, <code>=Aggregate(14,6,$C$2:$C$13000&#47;($A$2:$A$13000=A2),1)</code> in D2 and copy/drag down."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478626157, "post_id": 40492800, "comment_id": 68230148, "body": "<code>{=MAX(IF($A:$A=$A1,$C:$C))}</code> and drag down - enter using Ctrl+Shift+Enter.  Will give value 5 for family 1 and value 6 for family 2.  Edit:  +1 to @Scott as it doesn&#39;t use a CSE formula."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1478626378, "post_id": 40492800, "comment_id": 68230264, "body": "@DarrenBartrup-Cook One should avoid using full column references with array formulas. It will do 1 million more calculations than needed."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1478626396, "post_id": 40492800, "comment_id": 68230278, "body": "@DarrenBartrup-Cook but thanks"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478626470, "post_id": 40492800, "comment_id": 68230331, "body": "If you have Office 365 Excel you can use: <code>=MAXIFS(C:C,A:A,A2)</code> in D2 and copy/drag down."}, {"owner": {"reputation": 1, "user_id": 7132867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef103d677f50217c8e5b13daa0140c0?s=128&d=identicon&r=PG&f=1", "display_name": "Waran", "link": "https://stackoverflow.com/users/7132867/waran"}, "edited": false, "score": 0, "creation_date": 1478627869, "post_id": 40492800, "comment_id": 68231134, "body": "Scott Craner, thank you very, very much! I would spend ages to figure it out myself. It works perfectly :) Darren Bartrup-Cook Thank you very much as well!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478677265, "post_id": 40492800, "comment_id": 68247366, "body": "@Scott Craner - good point. Maybe an INDEX/MATCH to get the last row would&#39;ve been better, but if it&#39;s a set amount of rows.  Either way Aggregate is the better function to use."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478626356, "post_id": 40493062, "comment_id": 68230249, "body": "One should avoid using full column references with array formulas.  It will do 1 million more calculations than needed."}, {"owner": {"reputation": 1, "user_id": 7132867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef103d677f50217c8e5b13daa0140c0?s=128&d=identicon&r=PG&f=1", "display_name": "Waran", "link": "https://stackoverflow.com/users/7132867/waran"}, "edited": false, "score": 0, "creation_date": 1478627922, "post_id": 40493062, "comment_id": 68231160, "body": "Thank you very much for your time bobajob"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1478626574, "last_edit_date": 1478626574, "creation_date": 1478626299, "answer_id": 40493062, "question_id": 40492800, "link": "https://stackoverflow.com/questions/40492800/vba-choosing-biggest-value-but-only-from-rows-which-have-certain-value-in-other/40493062#40493062", "title": "vba choosing biggest value, but only from rows which have certain value in other column", "body": "<p>Put <code>=MAX(IF(A2=A:A,C:C))</code> in cell D2, and confirm it as an array formula, then copy that cell down column D. Edit: Beaten to it, and with a better answer, by @Scott Craner in the comments</p>\n"}], "owner": {"reputation": 1, "user_id": 7132867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef103d677f50217c8e5b13daa0140c0?s=128&d=identicon&r=PG&f=1", "display_name": "Waran", "link": "https://stackoverflow.com/users/7132867/waran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478626574, "creation_date": 1478625374, "last_edit_date": 1531164843, "question_id": 40492800, "link": "https://stackoverflow.com/questions/40492800/vba-choosing-biggest-value-but-only-from-rows-which-have-certain-value-in-other", "title": "vba choosing biggest value, but only from rows which have certain value in other column", "body": "<p>I have a quite big file (13k rows).\n<a href=\"https://i.stack.imgur.com/zAaxv.jpg\" rel=\"nofollow noreferrer\">It looks like this</a>\nI need to figure out a makro which will for each family choose the highest education value among it's members and insert it for all of them in new column.\nAny advices how to do it would be very appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23, "user_id": 5115793, "user_type": "registered", "profile_image": "https://graph.facebook.com/863081903739981/picture?type=large", "display_name": "Sam McInnis", "link": "https://stackoverflow.com/users/5115793/sam-mcinnis"}, "edited": false, "score": 0, "creation_date": 1478702358, "post_id": 40492774, "comment_id": 68260976, "body": "So I made a temporary workaround by adding a hyperlink whose address is the final sheet copied from templates when adding a location. This is far from ideal, however, because it will not have the ability to update the hyperlink should the end user delete the calculation that is linked. After seeing the results of this, I believe using the last sheet would be acceptable as well. It feels like the answer is staring me in the face... I just can&#39;t see it."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5115793, "user_type": "registered", "profile_image": "https://graph.facebook.com/863081903739981/picture?type=large", "display_name": "Sam McInnis", "link": "https://stackoverflow.com/users/5115793/sam-mcinnis"}, "is_accepted": true, "score": 0, "last_activity_date": 1478708954, "creation_date": 1478708954, "answer_id": 40511725, "question_id": 40492774, "link": "https://stackoverflow.com/questions/40492774/adding-toc-hyperlinks-with-multiple-valid-references-available/40511725#40511725", "title": "Adding TOC Hyperlinks with multiple valid references available", "body": "<p>Adding the hyperlink when the group of sheets are moved has resolved the issue.</p>\n\n<pre><code>Set SortRng = Range(Range(\"A6\"), Range(\"A6\").End(xlDown))\nFor Each rng In SortRng\n    ReDim wSheet(0)\n    For Each Group_Sheets In ThisWorkbook.Worksheets\n        If Left(Group_Sheets.Name, Len(rng)) = rng Then\n            wSheet(UBound(wSheet)) = Group_Sheets.Name\n            ReDim Preserve wSheet(UBound(wSheet) + 1)\n        End If\n    Next\n    ReDim Preserve wSheet(UBound(wSheet) - 1)\n    With Worksheets(wSheet)\n        .Select\n        .Move after:=Worksheets(Worksheets.Count)\n    End With\n'Select the sheet to which the hyperlink directs HERE\n    Sheets(Sheets.Count).Select\n'Insert hyperlink HERE\n    TOC_Sheet.Hyperlinks.Add Anchor:=rng.Offset(0, 1), _\n        Address:=\"\", SubAddress:=\"'\" &amp; ActiveSheet.Name &amp; \"'!A1\", _\n        ScreenTip:=ActiveSheet.Name, _\n        TextToDisplay:=\"Link\"\nNext\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5115793, "user_type": "registered", "profile_image": "https://graph.facebook.com/863081903739981/picture?type=large", "display_name": "Sam McInnis", "link": "https://stackoverflow.com/users/5115793/sam-mcinnis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 40511725, "answer_count": 1, "score": 0, "last_activity_date": 1478708954, "creation_date": 1478625304, "last_edit_date": 1531164843, "question_id": 40492774, "link": "https://stackoverflow.com/questions/40492774/adding-toc-hyperlinks-with-multiple-valid-references-available", "title": "Adding TOC Hyperlinks with multiple valid references available", "body": "<p>I am currently looking to expand the functionality of an existing macro-enabled workbook by adding hyperlinks to an existing \"Contents\" sheet. The workbook operates much like a dashboard: button commands on the \"Contents\" sheet activate macros that pull templates from a remote source, change the sheet name to be unique while identifying with the location being added, copy them to the local workbook, and update the bottom of the location list on the contents sheet with the location added.</p>\n\n<p>The problem arises when I have locations with several iterations of the same calculations between the locations, and up to 30 sheets in the same workbook. It takes time for the end-user to click through all the tabs to find the specific calculation required for the specific location. So, what I had hoped to do would be to create a hyperlink on the contents page linking to the first calculation related to the location in question.</p>\n\n<p>For example, <em>Location A</em> has 3 different calculations associated with it, while <em>Location B</em> has 4. How would I identify which sheet contains the first calculation for the associated location?</p>\n\n<p>My thoughts: I have a sort code <strong>(EDIT: see below)</strong> implemented upon adding a new location where it sorts the contents sheet then iterates through the entire workbook, grouping sheets named <em>Location X (Calc n)</em> and pushing the group of worksheets to the back of the workbook based on the new order on the contents sheet. I'm thinking this would be the ideal spot to insert the hyperlink, but I'm not sure how to go about it. Perhaps declaring and assigning a string variable the value of the currently selected location, making a logical comparison and counting the number of sheets assigned to said location, resetting the counter when the location name changes, and using the active sheet in the hyperlink anchor when the counter equals 0?</p>\n\n<p><strong>EDIT :</strong></p>\n\n<pre><code>Dim Group_Sheets As Worksheet\nDim wSheet As Variant\nDim SortRng, rng As Range\n\nSet SortRng = Range(Range(\"A6\"), Range(\"A6\").End(xlDown))\nFor Each rng In SortRng\n    ReDim wSheet(0)\n    For Each Group_Sheets In ThisWorkbook.Worksheets\n        If Left(Group_Sheets.Name, Len(rng)) = rng Then\n            wSheet(UBound(wSheet)) = Group_Sheets.Name\n            ReDim Preserve wSheet(UBound(wSheet) + 1)\n        End If\n    Next\n    ReDim Preserve wSheet(UBound(wSheet) - 1)\n    With Worksheets(wSheet)\n        .Select\n        .Move after:=Worksheets(Worksheets.Count)\n    End With\nNext\n</code></pre>\n"}, {"tags": ["excel", "directory", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1478627380, "post_id": 40492722, "comment_id": 68230875, "body": "There is AFAIK no <i>dependable</i> sort order.  If you need a specific order then you&#39;ll have to sort the output."}], "owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1478625149, "creation_date": 1478625149, "last_edit_date": 1531164843, "question_id": 40492722, "link": "https://stackoverflow.com/questions/40492722/function-dir-in-excel-vba", "title": "Function Dir in Excel VBA", "body": "<p>Does anyone know how is the order in which the VBA function <code>Dir</code> returns filenames determined? The function work as follows (description from <a href=\"https://www.techonthenet.com/excel/formulas/dir.php\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<blockquote>\n  <p>The Microsoft Excel DIR function returns the first filename that matches the <em>pathname</em> and <em>attributes</em> specified. To retrieve additional filenames that match <em>pathname</em> and <em>attributes</em>, call DIR again with no arguments.</p>\n</blockquote>\n\n<p>So let's say I apply <code>Dir</code> to some folder <code>path</code> with files x, y and z. Suppose that <code>Dir(path)</code> returns z, then calling <code>Dir</code> twice returns y and x respectively. </p>\n\n<p><strong>How was the order z-y-x determined?</strong></p>\n\n<hr>\n\n<p><strong>EDIT: some context</strong></p>\n\n<p>My question is motivated by the following fact: when I applied <code>Dir</code> to this folder <code>path</code> with files x, y and z it returned the filenames in a given order. Then, for some reason I took out these files from the folder, put them again in <code>path</code> and applied <code>Dir</code> again; the order had changed.</p>\n"}, {"tags": ["vba", "excel", "for-loop", "goto"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1478625598, "post_id": 40492659, "comment_id": 68229833, "body": "Change your IF structure to an ElseIF like the answer below. You can then remove the goto Jump line and replace the goto Outside with <code>Exit For</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1478625317, "creation_date": 1478625317, "answer_id": 40492780, "question_id": 40492659, "link": "https://stackoverflow.com/questions/40492659/excel-vba-jump-inside-a-for-loop-next-without-for-what-am-i-doing-wrong/40492780#40492780", "title": "Excel VBA: Jump inside a for loop: &quot;Next without For&quot; \u2013 What am I doing wrong?", "body": "<p>try this (revision marked in comments):</p>\n\n<pre><code>    counter2 = 0\n    If (counter1 &gt; 1) Then\n        For i = 0 To (MaxLastCell - 4)\n            If (IncompleteRows(i) = 1) Then\n                If ((counter2 &gt; 1) And (counter2 &lt; counter1)) Then\n                    x = x + \", \" + CLng(i)\n                    counter2 = counter2 + 1\n                    GoTo Jump\n                End If\n                If ((counter2 &gt; 1) And (counter2 = counter1)) Then\n                    x = x + \" and \" + CLng(i)\n                    GoTo Outside\n                ElseIf (counter2 = 0) Then '&lt;--*** changed from simple 'If'\n                    x = CLng(i)\n                    counter2 = 1\n                End If\n            End If\nJump:\n        Next i\n    End If '&lt;--*** added\n</code></pre>\n\n<p>but you should avoid GoTos</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1478628779, "last_edit_date": 1495541960, "creation_date": 1478628779, "answer_id": 40493751, "question_id": 40492659, "link": "https://stackoverflow.com/questions/40492659/excel-vba-jump-inside-a-for-loop-next-without-for-what-am-i-doing-wrong/40493751#40493751", "title": "Excel VBA: Jump inside a for loop: &quot;Next without For&quot; \u2013 What am I doing wrong?", "body": "<p>You've got some nice spaghetti code there. <code>GoTo</code> is but a poor alternative to proper control flow.</p>\n\n<p><a href=\"https://xkcd.com/292/\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yiQ2W.png\" alt=\"Neal Stephenson thinks it&#39;s cute to name his labels &#39;dengo&#39;\"></a></p>\n\n<p>One <code>GoTo</code> to \"skip to next iteration\" is one thing. Another to <code>GoTo Outside</code> (wherever that is) is something else.</p>\n\n<p>VBA (the language spec) doesn't care on which column a line label starts; for all we know the answer you linked to was typed in the answer box, not in the VBE. When the VBE (the IDE/editor) sees a line label, it moves it to column 1 automatically, just like it automatically inserts spaces between operators and operands, and just like it automatically adjusts the casing of keywords and identifiers as you type them. So no, it doesn't matter at all.</p>\n\n<p>VBA syntax requires blocks to be closed: just like a <code>Sub DoSomething()</code> procedure <strong>must</strong> end with <code>End Sub</code> and a <code>With</code> block <strong>must</strong> end with <code>End With</code>, a <code>For</code> block <strong>must</strong> end with <code>Next</code>. Proper indentation and small procedure bodies usually help getting this right.</p>\n\n<p>A lot of other languages (C#, Java, C++, etc.) have similar constraints about what makes a valid code block (mismatched <code>{</code> and <code>}</code> braces are a compiler error in every language that uses them AFAIK), so this isn't VBA being picky or complaining for no reason.</p>\n\n<p>That said it's hard to tell whether and where your code is malformed, because you're not including the entire procedure scope so we have to assume there's nothing else that follows your snippet - and the snippet you've posted is missing an <code>End If</code> <a href=\"https://stackoverflow.com/a/40492780/1188513\">as user3598756 has noted</a>:</p>\n\n<pre><code>If (counter1 &gt; 1) Then\n    '...code...\nEnd If\n</code></pre>\n\n<p>So, how to go about restructuring this?</p>\n\n<ul>\n<li>Assuming the <code>Outside</code> line label is located just before <code>End Sub</code> (or is it <code>End Function</code>?), then you can replace it with <code>Exit Sub</code> (or <code>Exit Function</code>) and call it a day.\n\n<ul>\n<li>If there's more code that needs to run after the loop but before the end of the procedure scope, <code>Exit For</code> will get you out of the loop while keeping you inside the procedure - next line to run will be the first executable statement that follows the <code>Next</code> token.</li>\n</ul></li>\n<li><p>Now take the condition that makes the loop skip an iteration, and rephrase the loop body accordingly; use <code>ElseIf</code> to avoid evaluating conditions you don't need to, and remove all these extraneous and confusing parentheses:</p>\n\n<pre><code>If IncompleteRows(i) = 1 And counter2 &gt; 1 And counter2 &lt; counter1 Then\n    x = x + \", \" + CLng(i)\n    counter2 = counter2 + 1\nElseIf counter2 &gt; 1 And counter2 = counter1 Then\n    x = x + \" and \" + CLng(i)\n    Exit For ' assuming...\nElseIf counter2 = 0 Then\n    x = CLng(i)\n    counter2 = 1\nEnd If\n</code></pre>\n\n<p>And that would be the entire body of the loop. Of course it could still be improved; <code>counter2 &gt; 1</code> is repeated twice, so there's room for some further restructuring. But already, all <code>GoTo</code>'s are gone.</p></li>\n</ul>\n"}], "owner": {"reputation": 73, "user_id": 7127333, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d30718f84622a381500eaf4aa0eff13c?s=128&d=identicon&r=PG&f=1", "display_name": "Qralnaq", "link": "https://stackoverflow.com/users/7127333/qralnaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478628779, "creation_date": 1478624946, "last_edit_date": 1495541210, "question_id": 40492659, "link": "https://stackoverflow.com/questions/40492659/excel-vba-jump-inside-a-for-loop-next-without-for-what-am-i-doing-wrong", "title": "Excel VBA: Jump inside a for loop: &quot;Next without For&quot; \u2013 What am I doing wrong?", "body": "<p>I honestly do not know why the VBA compiler is nagging me because of that <code>GoTo Jump</code>, respectively <code>Jump:</code>.</p>\n\n<pre><code>    counter2 = 0\n    If (counter1 &gt; 1) Then\n        For i = 0 To (MaxLastCell - 4)\n            If (IncompleteRows(i) = 1) Then\n                If ((counter2 &gt; 1) And (counter2 &lt; counter1)) Then\n                    x = x + \", \" + CLng(i)\n                    counter2 = counter2 + 1\n                    GoTo Jump\n                End If\n                If ((counter2 &gt; 1) And (counter2 = counter1)) Then\n                    x = x + \" and \" + CLng(i)\n                    GoTo Outside\n                If (counter2 = 0) Then\n                    x = CLng(i)\n                    counter2 = 1\n                End If\n            End If\nJump:\n        Next i\n</code></pre>\n\n<p>Every time I am trying to run my code, this code snippet appears to be a problem. The compiler marks <code>Next</code> at the very bottom and tells me that there is a <code>\"Next without For\"</code>.</p>\n\n<p>But shouldn\u2019t this kind of coding work? I just saw it <a href=\"https://stackoverflow.com/a/30448991/7127333\">here</a>. A strange thing, however, is that the compiler there did not seem to coerce <a href=\"https://stackoverflow.com/users/1539001/b-h\">B H</a> to move his jumping point <code>NextIteration:</code> to the very left but allowed it to stay at the second indent level and, thus, <em>within</em> the <code>for</code>-loop, as it seems. (Does that even matter?)</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "comments": [{"owner": {"reputation": 1936, "user_id": 4322884, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007767376821/picture?type=large", "display_name": "mike510a", "link": "https://stackoverflow.com/users/4322884/mike510a"}, "edited": false, "score": 0, "creation_date": 1478625876, "post_id": 40492243, "comment_id": 68230006, "body": "Sounds tough.. here might be a good place to start looking..  <a href=\"https://support.office.com/en-us/article/Power-View-Explore-visualize-and-present-your-data-98268d31-97e2-42aa-a52b-a68cf460472e\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1478629021, "post_id": 40492243, "comment_id": 68231679, "body": "you could create a calendar sheet of known size and position, then add some columns to your table with formulae to dtermine x and y cordinates on your calendar, then create a for loop in VBA to create a shape for each row. You might then consider adding a macro to each shape to bring through the desired information"}], "answers": [{"tags": [], "owner": {"reputation": 13436, "user_id": 1787137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bdtdu.jpg?s=128&g=1", "display_name": "Mike Honey", "link": "https://stackoverflow.com/users/1787137/mike-honey"}, "is_accepted": false, "score": 0, "last_activity_date": 1478844223, "creation_date": 1478844223, "answer_id": 40542040, "question_id": 40492243, "link": "https://stackoverflow.com/questions/40492243/display-information-in-a-dynamic-created-calender-with-vba-powerquery-bi/40542040#40542040", "title": "Display Information in a dynamic created calender with VBA (Powerquery, BI?)", "body": "<p>Power BI has a Custom Visual to make a Gantt Chart:</p>\n\n<p><a href=\"https://app.powerbi.com/visuals/show/Gantt1448688115699\" rel=\"nofollow noreferrer\">https://app.powerbi.com/visuals/show/Gantt1448688115699</a></p>\n\n<p>Before you get too excited, the lowest granularity is Day.  It's all open source, so all you need is a friendly JavaScript developer to extend it ...</p>\n"}], "owner": {"reputation": 1, "user_id": 7132787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/huT2d.jpg?s=128&g=1", "display_name": "Mario Adenauer", "link": "https://stackoverflow.com/users/7132787/mario-adenauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478844223, "creation_date": 1478623572, "question_id": 40492243, "link": "https://stackoverflow.com/questions/40492243/display-information-in-a-dynamic-created-calender-with-vba-powerquery-bi", "title": "Display Information in a dynamic created calender with VBA (Powerquery, BI?)", "body": "<p>I have about 10.000 rows of time sheets of workers in excel. The data looks like this:</p>\n\n<pre><code>Description  |       Date       | Start Time | End time | Worker  | Duration\nFirst contact    4.4.2063         16:00       18:00      HP           02:00\n Assimilation    8.6.2098         13:30       14:50      KF           01:20\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I want to display this information in calender form for an easier overview. Some projects are worked by different people and sometimes even at the same time. In an optimal world there will be visual indicators for each day, as well as the ability to pop the calender up to see the values for the day. While I found some interesting stuff while googling, none of the advice really gave a solution.</p>\n\n<p>I am especially interested if microsoft or a third party actually introduced a solution for my problem, maybe in powerquery or the new products coming out.</p>\n\n<p>In any case, thank you very much for your help.</p>\n"}, {"tags": ["html", "vba", "onclick", "click"], "comments": [{"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1478623682, "post_id": 40492161, "comment_id": 68228599, "body": "Yeah, because this part of code <code>javascript:return false;</code>"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1478624052, "post_id": 40492161, "comment_id": 68228830, "body": "Can I somehow turn it True so that the click event becomes effective ?"}, {"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1478624275, "post_id": 40492161, "comment_id": 68228997, "body": "No, you can&#39;t do it with VBA...my guest is that the method is handled via javascript or jquery in another place...can you post the url in order to inspect the code?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1478625002, "post_id": 40492161, "comment_id": 68229433, "body": "Unfortunately you won&#39;t be able to access it since it is from my intranet, but here is the code on a bigger scale"}, {"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1478626180, "post_id": 40492161, "comment_id": 68230159, "body": "Ok, I see a <code>form</code> in there...are you sure that there is no submit button, somewhere?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1478627559, "post_id": 40492161, "comment_id": 68230977, "body": "no button of type submit in the code nope. 2 ways to manually submit the form : 1 ) by clicking the button display ( which is my issue) 2) with the cell <i>operation</i> selected by pressing enter ( so I guess I can also use this method in the code somehow but I thought it was even harder) (see the picture I just added from the webpage)"}], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "is_accepted": false, "score": 0, "last_activity_date": 1478627652, "last_edit_date": 1478627652, "creation_date": 1478625165, "answer_id": 40492730, "question_id": 40492161, "link": "https://stackoverflow.com/questions/40492161/running-click-event-with-no-result/40492730#40492730", "title": "Running Click event with no result", "body": "<p>Here is a bigger scale of the HTML code from the page in which we can see the form containing the button to submit the information.<a href=\"https://i.stack.imgur.com/G4ffJ.png\" rel=\"nofollow noreferrer\">html code bigger scale</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/svjOY.png\" rel=\"nofollow noreferrer\">user interface of the webpage</a></p>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478627652, "creation_date": 1478623288, "last_edit_date": 1478624484, "question_id": 40492161, "link": "https://stackoverflow.com/questions/40492161/running-click-event-with-no-result", "title": "Running Click event with no result", "body": "<p>Can someone explain to me why when I click on the following element, the form is not sent. The element is identified however there is no result. \nThis is the part of the code i am interested in solving, everything up to this point is running fine.</p>\n\n<pre><code>Set IEDoc = Internet.document\n\nSet collection = IEDoc.getElementsByTagName(\"input\") ' there are actually 9 elements\n\nFor Each Element In collection\n    If Element.Type = \"image\" Then ' there is only the element of interest in here\n        Element.Click\n\n\n        End If\nNext\n</code></pre>\n\n<p>Here is a sample of the HTML code from the webpage:</p>\n\n<p><img src=\"https://i.stack.imgur.com/fsI0Z.png\" alt=\"html code\"></p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1478623012, "post_id": 40492073, "comment_id": 68228199, "body": "Show the results that you are getting and the results you would like to get.  The description of the problem is meaningless without an example."}, {"owner": {"reputation": 2126, "user_id": 2473577, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5ed04ad62699997e452172b83f022e96?s=128&d=identicon&r=PG", "display_name": "E Mett", "link": "https://stackoverflow.com/users/2473577/e-mett"}, "edited": false, "score": 1, "creation_date": 1478623139, "post_id": 40492073, "comment_id": 68228281, "body": "SELECT DISTINCT will help if the duplicate rowd are exactly the same"}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1478624028, "post_id": 40492073, "comment_id": 68228812, "body": "Just added a screenshot of it. I don&#39;t want to see the highlighted entry."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1478624672, "post_id": 40492073, "comment_id": 68229236, "body": "the second join needs to look for a relation between event names also"}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1478752477, "post_id": 40492073, "comment_id": 68281323, "body": "You will need to filter the data by more than just FullName if you only want one row, where there is more than one row of data for a given FullName value"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478623975, "creation_date": 1478622969, "last_edit_date": 1478623975, "question_id": 40492073, "link": "https://stackoverflow.com/questions/40492073/bundle-2-tables-in-1-inner-join", "title": "Bundle 2 tables in 1 Inner Join", "body": "<p><a href=\"https://i.stack.imgur.com/mT0dc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mT0dc.jpg\" alt=\"enter image description here\"></a>I have the sql code below. It works but when I run the query, it repeats the data more than one time. I believe it has something to do with the Inner Join. Since it is Inner Joining twice the data is repeating twice in the report. Any help is appreciated</p>\n\n<pre><code>SELECT NewRelative.FullName, GiftGave.EventName, GiftGave.EventDate, GiftGave.AmountGiven, GiftGave.Notes, GiftRcvd.EventName\nFROM (NewRelative INNER JOIN GiftGave ON NewRelative.FullName = GiftGave.FullName) INNER JOIN GiftRcvd ON NewRelative.FullName = GiftRcvd.FullName\nWHERE (((NewRelative.FullName)=[forms]![FormRelativeReport]![TxtPickRelative]));\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478623239, "post_id": 40491967, "comment_id": 68228344, "body": "is your code actually compiling? there seem to be missing an <code>End If</code> or the likes"}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478623338, "post_id": 40491967, "comment_id": 68228398, "body": "@user3598756 I added in the extra elseif on the fly as that is the way it will work and I missed the final end if but I do know the rest of the code does what I described just it doesn&#39;t quite work how it is intended."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1478623668, "post_id": 40491967, "comment_id": 68228593, "body": "I think you may just need <code>Sheets(&quot;Setup&quot;).Range(&quot;B65536&quot;).End(xlUp)(2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1478624785, "post_id": 40492160, "comment_id": 68229318, "body": "Some slight adjustment but this works perfectly Thanks :-) @Benoit Ranque"}, {"owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "reply_to_user": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1478644540, "post_id": 40492160, "comment_id": 68239333, "body": "@Alan Treanor if performance is an issue you might want to use the code provided in the other answer. I&#39;m out of my dept here, but I believe it is faster since it uses built in excel functions. My code sets a range object for every iteration of the loop, so I&#39;m pretty sure it&#39;s inefficient. Again I&#39;m a beginner so not sure."}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1478671138, "post_id": 40492160, "comment_id": 68245345, "body": "Thanks, this particular code is only designed to be run once a week as a setup platform for the following week and will only look down a list of about 200 numbers! Thanks \ud83d\ude0a"}], "tags": [], "owner": {"reputation": 64, "user_id": 6814292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f4046ebc458b27656c2c4517a83ed0?s=128&d=identicon&r=PG", "display_name": "Benoit Ranque", "link": "https://stackoverflow.com/users/6814292/benoit-ranque"}, "is_accepted": true, "score": 1, "last_activity_date": 1478623421, "last_edit_date": 1478623421, "creation_date": 1478623288, "answer_id": 40492160, "question_id": 40491967, "link": "https://stackoverflow.com/questions/40491967/listbox-multiselect-add-to-next-available-blank-cell-remove-from-original-rang/40492160#40492160", "title": "Listbox Multiselect add to next available blank cell &amp; remove from original range", "body": "<p>I'm on my phone so cannot post code buy maybe this can help you:</p>\n\n<pre><code>Dim TargetRange as range \n\nSet TargetRange = thisworkbook.sheets(1).range(\"A1\")  'or whereever you want it\n\nDo until IsEmpty(TargetRange.value)\nSet targetrange = targetrange.offset(1,0)\nLoop\n\nTargetRange.value = \"your value here\"\n</code></pre>\n\n<p>This loops down until it finds an empty cell</p>\n\n<p>Hope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1478624133, "post_id": 40492179, "comment_id": 68228881, "body": "app defined or object defined error when using this code."}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1478624847, "post_id": 40492179, "comment_id": 68229352, "body": "I have it sorted now though another code above helped. Thanks for the help :-)  .Range(.Rows.Count, &quot;B&quot;).End(xlUp).Offset(1) = RndAdd1.List(lItem)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 1, "creation_date": 1478625153, "post_id": 40492179, "comment_id": 68229531, "body": "if your original code didn&#39;t throw any error then that <i>only</i> revision wouldn&#39;t either."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1478623354, "creation_date": 1478623354, "answer_id": 40492179, "question_id": 40491967, "link": "https://stackoverflow.com/questions/40491967/listbox-multiselect-add-to-next-available-blank-cell-remove-from-original-rang/40492179#40492179", "title": "Listbox Multiselect add to next available blank cell &amp; remove from original range", "body": "<p>substitute</p>\n\n<pre><code>Sheets(\"Setup\").Range(\"B65536\").End(xlUp)(0, 1) = RndAdd1.List(lItem)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>With Sheets(\"Setup\")\n    .Range(.Rows.Count, \"B\").End(xlUp).Offset(1) = RndAdd1.List(lItem)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 40492160, "answer_count": 2, "score": 0, "last_activity_date": 1478623561, "creation_date": 1478622592, "last_edit_date": 1478623561, "question_id": 40491967, "link": "https://stackoverflow.com/questions/40491967/listbox-multiselect-add-to-next-available-blank-cell-remove-from-original-rang", "title": "Listbox Multiselect add to next available blank cell &amp; remove from original range", "body": "<p>Hopefully someone can help me? I have 2 list boxes RndAdd1 &amp; RndEdit1. I want to be able to multi select items in RndAdd1 and then click Button1 and it loops through selected items and one at a time adds them to the new range (first blank cell) until all items added. Then remove all the values just added from the original range. (basically move from Column A to Column B for Monday, Column C to D for Tuesday and so on) </p>\n\n<p>I also have another variable set (which day of the week) I have the following code I was going to place on the button then nest a series of if/Elseif statements. </p>\n\n<p>The trouble I'm having currently is that it posts the first value in the first blank cell, then the 2nd value overwrites the first value and so on until only the final value is now visible in the new range. This is probably a simple fix and I'm just not thinking of it in the correct way! </p>\n\n<pre><code>Dim lItem As Long\nFor lItem = 0 To RndAdd1.ListCount - 1\n    If RndAdd1.Selected(lItem) = True Then\n        If ComboBox1.Value = \"Monday\" Then\n            Sheets(\"Setup\").Range(\"B65536\").End(xlUp)(0, 1) = RndAdd1.List(lItem)\n            RndAdd1.Selected(lItem) = False\n        End If\n    End If\nNext\n\nRndAdd1.Clear\nRndEdit1.Clear\nComboBox1.Clear\nComboBox1.List = Array(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\")\n\nComboBox1.Value = \"Monday\"\n\n'Tuesday Repeat Code but with different range to take round numbers from\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478622590, "post_id": 40491903, "comment_id": 68227914, "body": "I&#39;d recommend using Microsofts libraries, Internet Controls and HTML to use the proper objects, also, use the readystate and status rather than a 3 second loop.  Also use the object rather than send keys, so <code>getElementByID(&quot;UserName&quot;).value=ID</code>"}, {"owner": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478623994, "post_id": 40491903, "comment_id": 68228795, "body": "Thanks, I&#39;m looking into it. I&#39;ll be updating this post once I make those changes"}, {"owner": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478625518, "post_id": 40491903, "comment_id": 68229784, "body": "is there another way to get an element? The html code doesn&#39;t have id or tag properties."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478627283, "post_id": 40491903, "comment_id": 68230825, "body": "It doesn&#39;t have a tag?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "edited": false, "score": 0, "creation_date": 1479398513, "post_id": 40558825, "comment_id": 68550327, "body": "Thanks for the suggestion, I&#39;m implementing this piece by piece. So far I&#39;ve gone through the first sub but I&#39;m getting a runtime error very intermittently, it says &quot;object variable or with block variable not set&quot;. Clicking the debug button highlights the first getElement line."}, {"owner": {"reputation": 1, "user_id": 4156343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wW8nkp7Awtc/AAAAAAAAAAI/AAAAAAAAACo/JIorzOajkH8/photo.jpg?sz=128", "display_name": "IPI Paul", "link": "https://stackoverflow.com/users/4156343/ipi-paul"}, "reply_to_user": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "edited": false, "score": 0, "creation_date": 1480200192, "post_id": 40558825, "comment_id": 68866521, "body": "Open a blank page to begin with. Navigate to the page for the first instance. Then after, close each webbrowser connection and Create new Internet explorer objects with each new navigation!"}, {"owner": {"reputation": 1, "user_id": 4156343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wW8nkp7Awtc/AAAAAAAAAAI/AAAAAAAAACo/JIorzOajkH8/photo.jpg?sz=128", "display_name": "IPI Paul", "link": "https://stackoverflow.com/users/4156343/ipi-paul"}, "reply_to_user": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "edited": false, "score": 0, "creation_date": 1480241410, "post_id": 40558825, "comment_id": 68873470, "body": "Here is a project I have just worked on. Use the IE link form in the excel file. It loads a blank Internet explorer window then you can select an address in the Web Links drop down to navigate to in the form and select Navigate to in the functions drop down of the form."}, {"owner": {"reputation": 1, "user_id": 4156343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wW8nkp7Awtc/AAAAAAAAAAI/AAAAAAAAACo/JIorzOajkH8/photo.jpg?sz=128", "display_name": "IPI Paul", "link": "https://stackoverflow.com/users/4156343/ipi-paul"}, "reply_to_user": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "edited": false, "score": 0, "creation_date": 1480241594, "post_id": 40558825, "comment_id": 68873531, "body": "<a href=\"http://www.ipi-international.co.uk/ipi%20web%20elements/IPI%20Web%20Elements%20x64.zip\" rel=\"nofollow noreferrer\">link</a> The yourLoginPageURL needs to be blank the first time you load Internet explorer."}], "tags": [], "owner": {"reputation": 1, "user_id": 4156343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wW8nkp7Awtc/AAAAAAAAAAI/AAAAAAAAACo/JIorzOajkH8/photo.jpg?sz=128", "display_name": "IPI Paul", "link": "https://stackoverflow.com/users/4156343/ipi-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1478916632, "last_edit_date": 1478916632, "creation_date": 1478916164, "answer_id": 40558825, "question_id": 40491903, "link": "https://stackoverflow.com/questions/40491903/why-is-my-vba-script-behaving-so-unpredictably/40558825#40558825", "title": "Why is my VBA script behaving so unpredictably?", "body": "<p>There are a number of factors all at play:</p>\n\n<p>When you initiate a function the VBA code remains in the environment of that function. As I have found today, IE calls a new window once the navigate function is called. Hence your VBA will return that the connection has been lost.</p>\n\n<p>Try:</p>\n\n<pre>\n\n    Private Sub UserForm_Password_AfterUpdate()\n        set WebBrowser = New InternetExplorerMedium\n        WebBrowser.visible = True\n        WebBrowser.Navigate yourLoginPageURL\n\n        While WebBrowser.Busy = True\n            DoEvents\n        Wend\n\n        WebBrowser.Document.getElementById(\"UName\").value = Worksheets(\"home\").Range(\"B25\") OR txtBoxUname.Text\n        WebBrowser.Document.getElementById(\"UPwd\").value =     Worksheets(\"home\").Range(\"B26\") OR txtBoxPwd.text\n        Worksheets(\"home\").Range(\"B25\").Clear\n        Worksheets(\"home\").Range(\"B26\").Clear\n    End Sub\n\n\n    Private sub cboAddress_AfterUpdate()\n        if cboAddress.Text > \"\" then\n            WebBrowser.Quit\n            Set WebBrowser = Nothing\n            newIE\n        End If\n    End Sub\n\n    Private Sub newIE()\n        Set WebBrowser = CreateObject(\"InternetExplorer.Application\")\n        With WebBrowser\n            Hwnd = .Hwnd\n            .Navigate cboAddress.Text\n            .Visible = True\n        End With\n\n        While WebBrowser.Busy \n            DoEvents\n        Wend\n    End Sub\n</pre>\n\n<p>You can use const = uName and Const = UPwd for your login details.</p>\n"}], "owner": {"reputation": 1, "user_id": 7132646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9e9a257b4f530e16c9ba88f45afd5?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen E Jackson", "link": "https://stackoverflow.com/users/7132646/stephen-e-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478916632, "creation_date": 1478622404, "question_id": 40491903, "link": "https://stackoverflow.com/questions/40491903/why-is-my-vba-script-behaving-so-unpredictably", "title": "Why is my VBA script behaving so unpredictably?", "body": "<p>I am doing some IE automation in a vba script, and for some reason the </p>\n\n<p>\"Set IE = CreateObject(\"InternetExplorer.Application\")\" </p>\n\n<p>line of my code seems to be looping because it will sometimes launch 3-7 IE browsers instead of just one. The most aggravating part is that it works fine on my machine, but when I email it to someone else it usually doesn't run correctly. Here is my script:</p>\n\n<pre><code>Private Sub LauncherButton_Click()\n 'Here an instance of Internet Explorer is created,\n '  and pointed at the login page\n Dim IE As InternetExplorer\n Set IE = CreateObject(\"InternetExplorer.Application\")\n URL = \"www.google.com\"\n IE.Visible = True\n IE.Navigate URL\n\n\n 'The script waits for Internet Explorer to finish loading\n Application.Wait Now + TimeValue(\"00:00:03\")\n\n 'Here the login info is taken from the user inputs and entered\n '  login page\n ID = Worksheets(\"home\").Range(\"B25\")\n PW = Worksheets(\"home\").Range(\"B26\")\n\n Application.SendKeys ID, True\n Application.SendKeys \"{TAB}\", True\n Application.SendKeys PW, True\n Application.SendKeys \"{TAB}\", True\n Application.SendKeys \"{TAB}\", True\n Application.SendKeys \"{TAB}\", True\n\n 'This command will 'click' the login button, it will remain\n '  commented until a user with access can run the script\n\n 'Application.SendKeys \"~\", True\n\n 'After the login info is entered it is removed from memory\n Worksheets(\"home\").Range(\"B25\").Clear\n Worksheets(\"home\").Range(\"B26\").Clear\n ID = \"\"\n PW = \"\"\nEnd Sub\n</code></pre>\n\n<p>I changed the website to goggle since the actual target is only reachable on our intranet. The sendKeys portion is also irrelevant since the login page is not being loaded.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "edited": false, "score": 0, "creation_date": 1478623713, "post_id": 40491880, "comment_id": 68228631, "body": "Do your saved copied need to have the macros also, or could they be just empty sheets with the copied data values instead of formulas?"}, {"owner": {"reputation": 59, "user_id": 6205270, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c971cac4a2ea1bc31285a311206a62a4?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/6205270/will"}, "reply_to_user": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "edited": false, "score": 0, "creation_date": 1478625098, "post_id": 40491880, "comment_id": 68229498, "body": "@cyberponk, the saved copies do not need to have the macros, as long as the copied data values are correct."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6205270, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c971cac4a2ea1bc31285a311206a62a4?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/6205270/will"}, "edited": false, "score": 0, "creation_date": 1478625042, "post_id": 40492545, "comment_id": 68229458, "body": "I like this idea, but is it practical if you have thousands of formulas? I oversimplified what I was doing in this example"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 59, "user_id": 6205270, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c971cac4a2ea1bc31285a311206a62a4?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/6205270/will"}, "edited": false, "score": 0, "creation_date": 1478625578, "post_id": 40492545, "comment_id": 68229819, "body": "If you read the formulae in and out of an array then it should be very quick."}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1478624576, "creation_date": 1478624576, "answer_id": 40492545, "question_id": 40491880, "link": "https://stackoverflow.com/questions/40491880/creating-copies-from-a-master-workbook-using-vba/40492545#40492545", "title": "Creating Copies from a Master Workbook using VBA", "body": "<p>You could save a copy of the formula, and put it back into the workbook each time. ie:</p>\n\n<pre><code>Option Explicit\nSub test()\nWith ThisWorkbook.ActiveSheet\n    Dim formulaText As String\n    formulaText = .Range(\"D2\").Formula\n    Dim i As Long\n    For i = 1 To 3\n        If Not .Range(\"B\" &amp; i).Value = \"X\" Then\n            .Range(\"C2\").Value = Range(\"A\" &amp; i).Value\n            Calculate 'updates the formula\n            .Range(\"B\" &amp; i).Value = \"X\" 'update the check\n\n            .Range(\"D2\").Copy\n            .Range(\"D2\").PasteSpecial xlPasteValues\n\n            ActiveWorkbook.SaveCopyAs  \"C:\\Users\\n0269777\\Desktop\\\" &amp; Range(\"A\" &amp; i).Value &amp; \".xlsm\" \n            .Range(\"D2\").Formula = formulaText\n        End If\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 59, "user_id": 6205270, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c971cac4a2ea1bc31285a311206a62a4?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/6205270/will"}, "edited": false, "score": 0, "creation_date": 1478625917, "post_id": 40492781, "comment_id": 68230029, "body": "Glad we got there in the end."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1478625318, "creation_date": 1478625318, "answer_id": 40492781, "question_id": 40491880, "link": "https://stackoverflow.com/questions/40491880/creating-copies-from-a-master-workbook-using-vba/40492781#40492781", "title": "Creating Copies from a Master Workbook using VBA", "body": "<p>Not sure it was necessary to start a new question, but anyway try this.</p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook, s As String, i As Long\n\nFor i = 1 To 3\n    If Not Range(\"B\" &amp; i).Value = \"X\" Then\n        Range(\"C2\").Value = Range(\"A\" &amp; i).Value\n        Calculate 'updates the formula\n        Range(\"B\" &amp; i).Value = \"X\" 'update the check\n        s = \"C:\\Users\\n0269777\\Desktop\\\" &amp; Range(\"A\" &amp; i).Value &amp; \".xlsm\"\n        ActiveWorkbook.SaveCopyAs s\n        Set wb = Workbooks.Open(s)\n        wb.Sheets(1).UsedRange.Value = wb.Sheets(1).UsedRange.Value\n        wb.Close True\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6205270, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c971cac4a2ea1bc31285a311206a62a4?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/6205270/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 40492781, "answer_count": 2, "score": 0, "last_activity_date": 1478625318, "creation_date": 1478622339, "last_edit_date": 1478622817, "question_id": 40491880, "link": "https://stackoverflow.com/questions/40491880/creating-copies-from-a-master-workbook-using-vba", "title": "Creating Copies from a Master Workbook using VBA", "body": "<p>I have two files, one the file in which I want to run the macro in and another external file. </p>\n\n<p>Within the file that the macro is running in (henceforth the \"master\" file), there is something that looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/r7dQJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r7dQJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code that I have so far is this:</p>\n\n<pre><code>Sub test()\nFor i = 1 To 3\n    If Not Range(\"B\" &amp; i).Value = \"X\" Then\n\n        Range(\"C2\").Value = Range(\"A\" &amp; i).Value\n        Calculate 'updates the formula\n        Range(\"B\" &amp; i).Value = \"X\" 'update the check\n\n        Range(\"D2\").Copy 'this is the tricky part - this is what is needed. The formula links needs to be broken so that only the values remain\n        Range(\"D2\").PasteSpecial xlPasteValues\n\n        ActiveWorkbook.SaveCopyAs \"C:\\Users\\n0269777\\Desktop\\\" &amp; Range(\"A\" &amp; i).Value &amp; \".xlsm\" 'the problem with SaveCopyAs is that the formula originally is now overwritten.\n        'thus I need some way to refer back to the 'master' workbook, the one where the formula has not yet been overwritten\n\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>What I want to achieve is that the macro will loop through and check to see if a workbook has been created with the names in column A. Then, it will update the value in \"C2\". Finally, a copy is saved -- <strong>and the formula is overwriten to its value, rather than remain a formula</strong>. This is the difficulty in that I cannot simply save a copy of the workbook -- the formula would have been overwritten after the run of the macro.</p>\n\n<p>This is what happens in Type3.xlsm after running the macro. As you can see, the value in \"D2\" is 1, whereas it should be 3.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5lwnk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5lwnk.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have also considered this method:</p>\n\n<pre><code>Sub test2()\nFor i = 1 To 3\n    If Not Range(\"B\" &amp; i).Value = \"X\" Then\n\n        Range(\"C2\").Value = Range(\"A\" &amp; i).Value\n        Calculate 'updates the formula\n        Range(\"B\" &amp; i).Value = \"X\" 'update the check\n\n        Set wboor = ActiveWorkbook\n        fileaddress = ActiveWorkbook.Path &amp; \"\\\" &amp; ActiveWorkbook.Name\n\n        Range(\"D2\").Copy 'this is the tricky part - this is what is needed. The formula links needs to be broken so that only the values remain\n        Range(\"D2\").PasteSpecial xlPasteValues\n\n        wboor.SaveCopyAs \"C:\\Users\\n0269777\\Desktop\\\" &amp; Range(\"A\" &amp; i).Value &amp; \".xlsm\" 'Perhaps I can save a copy first? Then close the workbook, so the formula is preserved\n        wboor.Close\n        Workbooks.Open Filename:=fileaddress 'but then, how do I call the original file, and then loop the macro to run again?\n\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Any suggestions/help would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7097762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125e372f2f83b52b9a504055b34abf92?s=128&d=identicon&r=PG&f=1", "display_name": "VbaNoob", "link": "https://stackoverflow.com/users/7097762/vbanoob"}, "is_accepted": false, "score": 0, "last_activity_date": 1478624816, "creation_date": 1478624816, "answer_id": 40492631, "question_id": 40491675, "link": "https://stackoverflow.com/questions/40491675/dtpicker-control-value-not-updated-after-user-selects-date/40492631#40492631", "title": "DtPicker control value not updated after user selects date", "body": "<p>Ok I figured out my mistake. When I declared the dtPicker in my class I neglected to declare it WithEvents (Private WithEvents date1 as DTPicker). </p>\n"}], "owner": {"reputation": 1, "user_id": 7097762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125e372f2f83b52b9a504055b34abf92?s=128&d=identicon&r=PG&f=1", "display_name": "VbaNoob", "link": "https://stackoverflow.com/users/7097762/vbanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478624816, "creation_date": 1478621762, "last_edit_date": 1531164843, "question_id": 40491675, "link": "https://stackoverflow.com/questions/40491675/dtpicker-control-value-not-updated-after-user-selects-date", "title": "DtPicker control value not updated after user selects date", "body": "<p>I have a class that adds 3-4 dtPickers to a userform dynamically at runtime. The dtPickers are added to the userform as I anticipate, and I'm able to choose different dates for each one.</p>\n\n<p>My problem is that I have been unable to \"record\" the new date that the user chooses back to the spreadsheet. The value being sent back is 0. Is there a specific way I should be handling the events for this control or adjusting its value at runtime?</p>\n\n<p>Additional info: I store the class that creates the dtPicker in a collection and then create the class during initialization. I tried to add events to the class but haven't been able to successfully trigger them.</p>\n\n<p>Please let me know if you need any additional info, thanks!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478622006, "post_id": 40491667, "comment_id": 68227512, "body": "I think the error is in your formula."}, {"owner": {"reputation": 31, "user_id": 2290171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9113c523e878ad5f5155fdd68daf292e?s=128&d=identicon&r=PG", "display_name": "ubiquetous", "link": "https://stackoverflow.com/users/2290171/ubiquetous"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478624198, "post_id": 40491667, "comment_id": 68228935, "body": "Formula works perfectly for first cell, but won&#39;t FillDown."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478624453, "post_id": 40491667, "comment_id": 68229097, "body": "For me everything work except from the formula. The filldown works fine if I just type something in the cells. If you use F8 to step through the code, where do you get the error?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478624643, "post_id": 40491667, "comment_id": 68229223, "body": "What range do you get from this <code>Table_Query_from_MS_Access_Database[@[1&#47;1&#47;2016]:[&quot; &amp; DateValue &amp; &quot;]]</code>?"}, {"owner": {"reputation": 31, "user_id": 2290171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9113c523e878ad5f5155fdd68daf292e?s=128&d=identicon&r=PG", "display_name": "ubiquetous", "link": "https://stackoverflow.com/users/2290171/ubiquetous"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478625115, "post_id": 40491667, "comment_id": 68229510, "body": "Table_Query_from_MS_Access_Database is the SQL Query. [@[1/1/2016] refers to the dated column headers. Formula was based on manual formula creation, and then copied to VBA. :[&quot; &amp; DateValue &amp; &quot;] this just gets it to calculate based on the most recent week. Since DateValue is based on last column header from SQL query which should equal most current week."}, {"owner": {"reputation": 31, "user_id": 2290171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9113c523e878ad5f5155fdd68daf292e?s=128&d=identicon&r=PG", "display_name": "ubiquetous", "link": "https://stackoverflow.com/users/2290171/ubiquetous"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478625210, "post_id": 40491667, "comment_id": 68229573, "body": "If I change <code>Worksheets(&quot;Heatmap - FTE&quot;).Range(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).FillDown</code> to <code>Range(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).FillDown</code> it seems to work better."}], "answers": [{"comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478630870, "post_id": 40493449, "comment_id": 68232649, "body": "You should always avoid using <code>select</code>. Define it instead using, for instance, <code>Dim wks as worksheet</code> and <code>set wks = thisworkbook.sheets(&quot;Heatmap - FTE&quot;)</code>. Then you can use <code>With wks</code> write your code in between this and <code>end with</code>"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478630980, "post_id": 40493449, "comment_id": 68232702, "body": "And use <code>Option Explicit</code> ;-)"}], "tags": [], "owner": {"reputation": 31, "user_id": 2290171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9113c523e878ad5f5155fdd68daf292e?s=128&d=identicon&r=PG", "display_name": "ubiquetous", "link": "https://stackoverflow.com/users/2290171/ubiquetous"}, "is_accepted": false, "score": 0, "last_activity_date": 1478627586, "creation_date": 1478627586, "answer_id": 40493449, "question_id": 40491667, "link": "https://stackoverflow.com/questions/40491667/filldown-method-failing-in-excel-2010/40493449#40493449", "title": "FillDown method failing in Excel 2010", "body": "<p>Found a solution.</p>\n\n<p>Apparently, I didn't need to reference the worksheet for the FillDown method. Noticed that macro worked if I was on the worksheet where it was intended to run, but failed at the FillDown method if I was on another worksheet.</p>\n\n<p>Resolved that by selecting the worksheet.</p>\n\n<p>Working code is:</p>\n\n<pre><code>Sub Heatmap_FTE_Update()\nDim LastCol As Long\nDim LastRow As Long\nDim rng As Range\nDim DateValue As String\n\nSheets(\"Heatmap - FTE\").Select\n\nSet rng = Sheets(\"Heatmap - FTE\").Range(\"B2:BZ2\")\n\nLastCol = Worksheets(\"Heatmap - FTE\").Cells(2, Columns.Count).End(xlToLeft).Column\n\n'MsgBox LastCol\n\nrng.Parent.Cells(2, LastCol + 1).Value = \"% Over Capacity\"\n\nDateValue = rng.Parent.Cells(2, LastCol).Value\n\nWorksheets(\"Heatmap - FTE\").Cells(3, LastCol + 1).Formula = \"=IFERROR(COUNTIF(Table_Query_from_MS_Access_Database[@[1/1/2016]:[\" &amp; DateValue &amp; \"]],\"\"&gt;\"\"&amp;40)/(COUNT(Table_Query_from_MS_Access_Database[@[1/1/2016]:[\" &amp; DateValue &amp; \"]])),0)\"\n\nLastRow = Worksheets(\"Heatmap - FTE\").Cells(Rows.Count, \"B\").End(xlUp).Row\n\n'MsgBox LastRow\n\nRange(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).FillDown\n\nRange(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).NumberFormat = \"0.00%\"\n\nRange(Cells(3, 2), Cells(LastRow, LastCol + 1)).Sort key1:=Range(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)), order1:=xlDescending, Header:=xlYes\n\nSheets(\"Control\").Select\n\nEnd Sub\n</code></pre>\n\n<p>However, if you have a more elegant solution  or explanation of my error that is appreciated. </p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 31, "user_id": 2290171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9113c523e878ad5f5155fdd68daf292e?s=128&d=identicon&r=PG", "display_name": "ubiquetous", "link": "https://stackoverflow.com/users/2290171/ubiquetous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 896, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478627825, "creation_date": 1478621743, "last_edit_date": 1592644375, "question_id": 40491667, "link": "https://stackoverflow.com/questions/40491667/filldown-method-failing-in-excel-2010", "title": "FillDown method failing in Excel 2010", "body": "<p>I'm getting an error message related to the below <code>VBA</code> Macro in Excel 2010.</p>\n<h1><strong>Purpose of the Macro:</strong></h1>\n<p>I have a Table in an Excel worksheet that is refreshed via an SQL query. the table contains 1 week per column of data, as well as, a few columns containing attributes preceding the date columns.</p>\n<p>After the table is refreshed each week the Macro should do the following:</p>\n<ol>\n<li><p>Find the last column in the table in row 2 and label that cell &quot;Over Capacity %&quot;</p>\n</li>\n<li><p>Find last row of table (rows are variable and may change every time data is refreshed)</p>\n</li>\n<li><p>Copy &amp; fill the formula in row 3 of the last column all the way down to the last row of the last column of the table.</p>\n</li>\n<li><p>Format the numbers in the last column as percentages with 2 decimal places.</p>\n</li>\n<li><p>sort the entire table based on the percentages in the last column.</p>\n</li>\n</ol>\n<h1>Where the Error Occurs</h1>\n<p>The error occurs in what is listed as step 3 above. I have attempted the both the <code>AutoFill</code> and <code>FillDown</code> methods.</p>\n<p>Related line of VBA is:</p>\n<pre><code>Worksheets(&quot;Heatmap - FTE&quot;).Range(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).FillDown\n</code></pre>\n<h1>Error Message Shown</h1>\n<p>Run-time error '1004':\nApplication-defined or object-defined error</p>\n<h1>Full VBA code for the Macro:</h1>\n<pre><code>Sub Heatmap_FTE_Update()\nDim LastCol As Long\nDim LastRow As Long\nDim rng As Range\nDim DateValue As String\n    \nSet rng = Sheets(&quot;Heatmap - FTE&quot;).Range(&quot;B2:BZ2&quot;)\n\nLastCol = Worksheets(&quot;Heatmap - FTE&quot;).Cells(2, Columns.Count).End(xlToLeft).Column\n    \n'MsgBox LastCol\n\nrng.Parent.Cells(2, LastCol + 1).Value = &quot;% Over Capacity&quot;\n\nDateValue = rng.Parent.Cells(2, LastCol).Value\n\nWorksheets(&quot;Heatmap - FTE&quot;).Cells(3, LastCol + 1).Formula = &quot;=IFERROR(COUNTIF(Table_Query_from_MS_Access_Database[@[1/1/2016]:[&quot; &amp; DateValue &amp; &quot;]],&quot;&quot;&gt;&quot;&quot;&amp;40)/(COUNT(Table_Query_from_MS_Access_Database[@[1/1/2016]:[&quot; &amp; DateValue &amp; &quot;]])),0)&quot;\n\nLastRow = Worksheets(&quot;Heatmap - FTE&quot;).Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row\n\n'MsgBox LastRow\n\nWorksheets(&quot;Heatmap - FTE&quot;).Range(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).FillDown\n\nRange(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)).NumberFormat = &quot;0.00%&quot;\n\nRange(Cells(3, 2), Cells(LastRow, LastCol + 1)).Sort key1:=Range(Cells(3, LastCol + 1), Cells(LastRow, LastCol + 1)), order1:=xlDescending, Header:=xlYes\n\n\nEnd Sub\n</code></pre>\n<p>Any input is appreciated. Thank you.</p>\n"}, {"tags": ["c#", "vba", "reporting-services"], "comments": [{"owner": {"reputation": 1094, "user_id": 4314870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8b0dfe71faba6f43642a0ff77581ec46?s=128&d=identicon&r=PG&f=1", "display_name": "Hespen", "link": "https://stackoverflow.com/users/4314870/hespen"}, "edited": false, "score": 0, "creation_date": 1478621323, "post_id": 40491484, "comment_id": 68227013, "body": "So do you have some code already?"}, {"owner": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "reply_to_user": {"reputation": 1094, "user_id": 4314870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8b0dfe71faba6f43642a0ff77581ec46?s=128&d=identicon&r=PG&f=1", "display_name": "Hespen", "link": "https://stackoverflow.com/users/4314870/hespen"}, "edited": false, "score": 0, "creation_date": 1478622760, "post_id": 40491484, "comment_id": 68228044, "body": "Sorry forgot to add that."}, {"owner": {"reputation": 13317, "user_id": 2647648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be60d7dc56a2cfaf0072a315ca498d7e?s=128&d=identicon&r=PG", "display_name": "alejandro zuleta", "link": "https://stackoverflow.com/users/2647648/alejandro-zuleta"}, "edited": false, "score": 0, "creation_date": 1478624411, "post_id": 40491484, "comment_id": 68229081, "body": "@RobertThompson, Level 3 and Level 4 are groups in your matrix? How are you calling the function and what is its expected behaviour? Add a screenshot of your matrix in the Design window."}, {"owner": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "edited": false, "score": 0, "creation_date": 1478626862, "post_id": 40491484, "comment_id": 68230546, "body": "I have added more information"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "edited": false, "score": 0, "creation_date": 1478721097, "post_id": 40497062, "comment_id": 68271438, "body": "Thanks Alejandro for the quick response.   I am a little confuse on what you are saying on the following.  ** &quot;Add three rows outside the scope of any group and hardcode the description in each one.&quot;**.  Are you saying create 3 rows and hide them to do the calculation."}, {"owner": {"reputation": 13317, "user_id": 2647648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be60d7dc56a2cfaf0072a315ca498d7e?s=128&d=identicon&r=PG", "display_name": "alejandro zuleta", "link": "https://stackoverflow.com/users/2647648/alejandro-zuleta"}, "reply_to_user": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "edited": false, "score": 0, "creation_date": 1478721269, "post_id": 40497062, "comment_id": 68271532, "body": "@RobertThompson, I mean you have to insert three adittional rows below Total row to calculate the total per Level 4 Description."}, {"owner": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "edited": false, "score": 0, "creation_date": 1478721909, "post_id": 40497062, "comment_id": 68271823, "body": "Ok.  I just found this link 5 mins ago. And this did the job. <a href=\"https://sqlserverreportingservices.wordpress.com/2012/11/29/adding-a-group-to-a-matrix-to-create-subtotals/\" rel=\"nofollow noreferrer\">sqlserverreportingservices.wordpress.com/2012/11/29/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13317, "user_id": 2647648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be60d7dc56a2cfaf0072a315ca498d7e?s=128&d=identicon&r=PG", "display_name": "alejandro zuleta", "link": "https://stackoverflow.com/users/2647648/alejandro-zuleta"}, "is_accepted": false, "score": 0, "last_activity_date": 1478641918, "creation_date": 1478641918, "answer_id": 40497062, "question_id": 40491484, "link": "https://stackoverflow.com/questions/40491484/reporting-services-dynamic-grand-total-with-multiple-lines-using-matrix/40497062#40497062", "title": "Reporting Services - Dynamic grand total with multiple lines using Matrix", "body": "<p>Even if you store the description in a collection you cannot use it to produce rows in a tablix. I think you have two options. First is create embed a tablix inside a cell in your matrix to calculate the total per description; the second option (which I recommend) is to add three rows outside the scope of any group and hardcode the description in each one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/syDZy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/syDZy.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Note the Grand Total rows and Final Total are outside the scope of Level 3 and Level 4 Row Groups, that is the trick. Also note each description is hardcoded in the cell, so you will have to add manually a row per description in your dataset.</p>\n\n<p>Then for calculating the <code>Grand Total</code> in each row (Green) use a specific expression as follows. For <code>Personnel Rel</code> total use:</p>\n\n<pre><code>=SUM(IIF(Fields!Level_4.Value=\"Personnel Rel\",Fields!Activity_Amt.Value,0))\n</code></pre>\n\n<p>For <code>Other Expenses</code> use:</p>\n\n<pre><code>=SUM(IIF(Fields!Level_4.Value=\"Other Expenses\",Fields!Activity_Amt.Value,0))\n</code></pre>\n\n<p>And for <code>Shipping Rel</code> use:</p>\n\n<pre><code>=SUM(IIF(Fields!Level_4.Value=\"Shipping Rel\",Fields!Activity_Amt.Value,0))\n</code></pre>\n\n<p>In the <code>Final Total</code> row just use:</p>\n\n<pre><code>=SUM(Fields!Activity_Amt.Value)\n</code></pre>\n\n<p>It should produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A0aGD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A0aGD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know if this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1478722731, "creation_date": 1478722731, "answer_id": 40515315, "question_id": 40491484, "link": "https://stackoverflow.com/questions/40491484/reporting-services-dynamic-grand-total-with-multiple-lines-using-matrix/40515315#40515315", "title": "Reporting Services - Dynamic grand total with multiple lines using Matrix", "body": "<p>I was able to find this link to help resolve my problem.</p>\n\n<p><a href=\"https://sqlserverreportingservices.wordpress.com/2012/11/29/adding-a-group-to-a-matrix-to-create-subtotals/\" rel=\"nofollow noreferrer\">https://sqlserverreportingservices.wordpress.com/2012/11/29/adding-a-group-to-a-matrix-to-create-subtotals/</a></p>\n\n<p>I did a Right click Add Group => Adjacent Below on the sub total</p>\n\n<p><a href=\"https://i.stack.imgur.com/pG3EI.png\" rel=\"nofollow noreferrer\">Click this link to review the report</a></p>\n"}], "owner": {"reputation": 37, "user_id": 3427372, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ec7325c315f28df1c787828d1443ab4e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thompson", "link": "https://stackoverflow.com/users/3427372/robert-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1478722731, "creation_date": 1478621197, "last_edit_date": 1478633170, "question_id": 40491484, "link": "https://stackoverflow.com/questions/40491484/reporting-services-dynamic-grand-total-with-multiple-lines-using-matrix", "title": "Reporting Services - Dynamic grand total with multiple lines using Matrix", "body": "<p>I need to be able to use custom code to allow summing on the different Level 4 descriptions an show a grand total on the Level 4 descriptions.  This is a matrix report.</p>\n\n<p>Here the report</p>\n\n<p><a href=\"https://i.stack.imgur.com/HANOb.png\" rel=\"nofollow noreferrer\">Report Image click here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/NAMJZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NAMJZ.png\" alt=\"enter image description here\"></a> </p>\n\n<pre><code>Level 3      Level 4          2016-009    2016-010   2016-011\nArcadia      Personnel Rel     100          120        11\nArcadia      Other Expenses    100           10         1 \nArcadia      Shipping Rel      100           20         2\n\n             Total             300          150        14\n\nChicago      Personnel Rel     1             30        10 \nChicago      Other Expenses    2             10        10\nChicago      Shipping Rel      100           10        10\n\n             Total             103           50        30\n\nGrand Total  Personnel Rel     101          150        21\n             Other Expenses    102           20        11\n             Shipping Rel      200           30        12\n\nFinal Total                    403          200        44                                \n</code></pre>\n\n<p>I started using custom code like this but I need to do some type of collection storing the description with the correct totals for each period.</p>\n\n<p>Using this expression on the detail line</p>\n\n<pre><code>=Code.AddTotal(Sum(Fields!Activity_Amt.Value), Field!Period_Nbr.Value, Field!Level4.Value)\n</code></pre>\n\n<p>This code should kept track of the Level 4 description totals</p>\n\n<p>Custom Code</p>\n\n<pre><code> Public Shared detailTotal as New Collection\n\nPublic Function AddTotal(ByVal value as Double, ByVal period as String, ByVal level4 as String) as Object\n\nDim subtotal as Double\nDim combineStr = period &amp; \"\" &amp;level4\n\nif  not detailTotal.Contains(combineStr) Then\n   detailTotal.Add(value, combineStr)\n   subtotal = detailTotal.item(combineStr)\n   return subtotal\nend if\n\nsubtotal = detailTotal.item(combineStr) + value\ndetailTotal.remove(combineStr)\ndetailTotal.add(subtotal,combineStr)\nreturn detailTotal.item(combineStr)\nend function\n</code></pre>\n"}, {"tags": ["excel", "validation", "conditional", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "edited": false, "score": 1, "creation_date": 1478622286, "post_id": 40491404, "comment_id": 68227708, "body": "You can do this using <a href=\"http://www.excel-easy.com/basics/data-validation.html\" rel=\"nofollow noreferrer\">data validation with formulas in the min and max</a> or even <a href=\"https://support.office.com/en-us/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\">conditional formatting</a>. No need for VBA in this case."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1478622376, "post_id": 40491404, "comment_id": 68227766, "body": "If you want to use VLOOKUP,, VLOOKUP supports only one criterion, so you have to have a single value which contains both the bird id and the gender id: e.g. <code>=A5 &amp; &quot;_&quot; &amp; A6</code>. Then you can lookup on that single column. <a href=\"https://exceljet.net/formula/vlookup-with-two-or-more-criteria\" rel=\"nofollow noreferrer\">exceljet.net/formula/vlookup-with-two-or-more-criteria</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1478633077, "last_edit_date": 1592644375, "creation_date": 1478633077, "answer_id": 40494878, "question_id": 40491404, "link": "https://stackoverflow.com/questions/40491404/data-validation-conditional-between-min-and-max-values-in-different-columns-cell/40494878#40494878", "title": "Data validation conditional between min and max values in different columns cells (with or without vba)", "body": "<p>Assuming your worksheet structure looks like this:</p>\n<blockquote>\n<p><strong>Sheet1</strong></p>\n<pre><code>A         B         C           D\nBirdID    Gender    WingMMin    WingMMax\n</code></pre>\n<p><strong>Sheet2</strong></p>\n<pre><code>A         B         C\nBirdID    Gender    WingLength\n</code></pre>\n</blockquote>\n<p>you could add columns to Sheet1 and Sheet2 with the following formula:</p>\n<pre><code>=A1 &amp; &quot;_&quot; &amp; B1\n</code></pre>\n<p>which would give a unique string for each bird-ID / gender combination. On Sheet1, this column should be before the <code>WingMin</code>/<code>WingMax</code> columns; we'll assume it's the third column.</p>\n<blockquote>\n<p><strong>Sheet1</strong></p>\n<pre><code>A         B         C           D           E\nBirdID    Gender    UniqueID    WingMMin    WingMMax\n</code></pre>\n<p><strong>Sheet2</strong></p>\n<pre><code>A         B         C             D\nBirdID    Gender    WingLength    UniqueID\n</code></pre>\n</blockquote>\n<p>Then, you can use the <code>VLOOKUP</code> worksheet function to determine whether a particular line is valid:</p>\n<pre><code>=AND(C2 &gt;= VLOOKUP(D2, Sheet1!$C$1:$E$100, 2, FALSE), C2 &lt;= VLOOKUP(D2, Sheet1!$C$1:$E$100, 3, FALSE)\n</code></pre>\n<p>This function will return TRUE if the value is valid, and FALSE if it is invalid.</p>\n<p>You can place this formula in an additional column, or you could apply conditional formatting based on the formula.</p>\n"}], "owner": {"reputation": 1, "user_id": 7132424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f246845a7317ec2f401d0b157b83a4?s=128&d=identicon&r=PG&f=1", "display_name": "L Lotter", "link": "https://stackoverflow.com/users/7132424/l-lotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 693, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478633077, "creation_date": 1478620968, "last_edit_date": 1531161705, "question_id": 40491404, "link": "https://stackoverflow.com/questions/40491404/data-validation-conditional-between-min-and-max-values-in-different-columns-cell", "title": "Data validation conditional between min and max values in different columns cells (with or without vba)", "body": "<p>On Sheet 1 I have the min and max length of bird wings which is different for males and females, i.e. variables:</p>\n\n<p>BirdID | WingMMin (Average minimum length of males) | WingMMax (Average max length of males).</p>\n\n<p>On Sheet 2 I want to capture actual measurements for birds, but validated against Sheet 1 (The data captured, e.g. WingLength must be between WingMMin and WingMMax for the specific bird and sex using variables:</p>\n\n<p>BirdID (No to be typed) | Sex (1= Male; 2=Female to be entered) | WingLength.</p>\n\n<p>It seems to be too difficult to do this without VBA, but since I do not know VBA, I don't how to program this for all the values in the WingLength column. The logic should be as follows:</p>\n\n<pre><code>If Winglength &lt;&gt; between WingMMin and WingMMin) then\n   Msgbox (The measurement is invalid. It should be between WingMMin and WingMMin)\nEnd if\n</code></pre>\n"}]