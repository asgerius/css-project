[{"tags": ["excel", "vba", "web-scraping", "yahoo-finance"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571871782, "post_id": 58531855, "comment_id": 103387718, "body": "What is the value of <code>ticker</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571873608, "post_id": 58531855, "comment_id": 103388083, "body": "Works for me with a valid ticker symbol"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1571897974, "post_id": 58531855, "comment_id": 103393267, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 9, "user_id": 12135571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23fbcaf3e6461859b19723a09003bf85?s=128&d=identicon&r=PG&f=1", "display_name": "mollieda", "link": "https://stackoverflow.com/users/12135571/mollieda"}, "edited": false, "score": 0, "creation_date": 1575407192, "post_id": 58531855, "comment_id": 104554596, "body": "The above code is useful but is limited to the use of 50 tickers. If I use more than 50 tickers, I am confronted with bugs.  Is there a possibility to modify this code to load in mass the statistical data of several hundred tickers? Many thanks in advance for your help."}], "owner": {"reputation": 9, "user_id": 12135571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23fbcaf3e6461859b19723a09003bf85?s=128&d=identicon&r=PG&f=1", "display_name": "mollieda", "link": "https://stackoverflow.com/users/12135571/mollieda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572173533, "creation_date": 1571870614, "last_edit_date": 1572173533, "question_id": 58531855, "link": "https://stackoverflow.com/questions/58531855/how-to-automate-historical-key-statistics-from-yahoo", "title": "How to automate historical key statistics from yahoo?", "body": "<p>With the code below, i'm able to get current key statistics from Yahoo for multiple tickers. Do you know  if it's possible to change the code below in order to get historical data ? For instance, the statistics registered for a ticker 3 years ago ? </p>\n\n<p>Many thanks in advance for your answers and  you for your help  </p>\n\n<pre><code>Sub KeyStat()\n\nFor i = 2 To Sheets(1).Cells(1, 1).End(xlToRight).Column\n\nticker = Sheets(1).Cells(1, i)\nqurl = \"https://finance.yahoo.com/quote/\" &amp; ticker &amp; \"/key-statistics?p=\" &amp; ticker &amp; \"\"\n\nSheets(2).Select\nSheets(2).Cells.Clear\n\n    With ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=Sheets(2).Range(\"A1\"))\n        .BackgroundQuery = True\n        .TablesOnlyFromHTML = False\n        .Refresh BackgroundQuery:=False\n        .SaveData = True\n    End With\n\nSheets(2).Range(\"B3:B69\").Copy\nSheets(1).Select\nCells(2, i).Select\nActiveSheet.Paste\nCutCopyMode = False\n\nNext i\n\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "string", "function", "return"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571870819, "post_id": 58531713, "comment_id": 103387497, "body": "<code>val = val And True</code> is not proper vba.  <code>val = True</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571897044, "post_id": 58531713, "comment_id": 103392925, "body": "@ScottCraner, actually <code>val = val And True</code> <i>is</i> proper VBA, although redundant (since it&#39;s the same as <code>val = val</code>, which is of no use)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1571897329, "post_id": 58531713, "comment_id": 103393019, "body": "@NaraeGim, both <code>val = val And False</code> and <code>val = val And True</code> are redundant and should be changed, respectively, to <code>val = False</code> and no statement at all. And whichi line is throwing the error?"}, {"owner": {"reputation": 1, "user_id": 12265720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v8nPeM3lEwc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrLZ2b5D_Zcgn7IQiwz3mFzqc00g/photo.jpg?sz=128", "display_name": "Narae Gim", "link": "https://stackoverflow.com/users/12265720/narae-gim"}, "edited": false, "score": 0, "creation_date": 1571964334, "post_id": 58531713, "comment_id": 103422338, "body": "It&#39;s not redundant...but for sure, I found my error!! Thank you so much!!!!"}], "owner": {"reputation": 1, "user_id": 12265720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v8nPeM3lEwc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrLZ2b5D_Zcgn7IQiwz3mFzqc00g/photo.jpg?sz=128", "display_name": "Narae Gim", "link": "https://stackoverflow.com/users/12265720/narae-gim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571902692, "creation_date": 1571869468, "last_edit_date": 1571902692, "question_id": 58531713, "link": "https://stackoverflow.com/questions/58531713/vba-string-function-not-returning-the-value", "title": "VBA string function: not returning the value", "body": "<p>I am making an excel sheet with a specific condition that will return a string. <strong>This function worked as a sub-procedure</strong> but when I tried to use it as a function, I keep getting '#VALUE!'. Can someone please help me why this code is not returning the string?</p>\n\n<p>Please see the code below:</p>\n\n<pre><code>Function check_input2() As String\n\nDim range1 As range\nDim range2 As range\nDim row_num As Integer\n'Dim col_num As Integer\nDim val As Boolean\nDim a As Integer\nDim b As Integer\nDim row_end As Integer\n'count = 0\n'row_num = range1(1, 1).Row\n'col_num = range1(1, 1).Column\n\na = 1\nb = 1\nval = True\nrow_end = 11 + 12\n\nrow_num = 11\nSet range1 = range(\"A\" &amp; row_num &amp; \":\" &amp; \"A\" &amp; row_end)\n\nFor row_num = 11 To row_end\n    Set range2 = range(\"I\" &amp; row_num &amp; \":O\" &amp; row_num)\n\n    If WorksheetFunction.Sum(range2.Value) = 0 Then\n        'nothing has to happen\n        val = val And True\n        range(\"Q\" &amp; row_num).Value = True\n    ElseIf WorksheetFunction.Sum(range2.Value) &gt; 0 Then\n        If IsEmpty(range1(a, b).Value) = True Then\n        val = val And False\n        range(\"Q\" &amp; row_num).Value = False '**************************\n        ElseIf IsEmpty(range1(a, b).Value) = False Then\n        val = val And True\n        range(\"Q\" &amp; row_num).Value = True '**************************\n        End If\n    End If\n    a = a + 1\nNext\n\nIf val = True Then\n    'do nothing\n    'check_input2 (\"hello\")--error\n    check_input2 = \"hello\"\n    'check_input2 = True\nElseIf val = False Then\n    'check_input2 (\"Please do not skip the project number!\")--error\n    check_input2 = \"Please do not skip the project number!\"\n    'check_input2 = False\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "ibm-midrange"], "comments": [{"owner": {"reputation": 6118, "user_id": 106769, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsZek.png?s=128&g=1", "display_name": "Conspicuous Compiler", "link": "https://stackoverflow.com/users/106769/conspicuous-compiler"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1571871453, "post_id": 58531603, "comment_id": 103387623, "body": "@SMeaden Indeed it is.  I believe the poster&#39;s intent is to use some communication functionality external to Excel which provides glue between running automated tasks on an AS400 machine and an interface exposed in an Excel workbook.  But really need more specifics from OP."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1571871531, "post_id": 58531603, "comment_id": 103387640, "body": "This maybe of use <a href=\"https://developer.ibm.com/answers/questions/477817/pcomm-for-as400-automation-with-excel/\" rel=\"nofollow noreferrer\" title=\"pcomm for as400 automation with excel\">developer.ibm.com/answers/questions/477817/&hellip;</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1571871617, "post_id": 58531603, "comment_id": 103387669, "body": "Also this, <a href=\"https://www.experts-exchange.com/questions/24956712/AS400-PCOMM-Read-Write-Issue-in-VBA.html\" rel=\"nofollow noreferrer\" title=\"AS400 PCOMM Read Write Issue in VBA.html\">experts-exchange.com/questions/24956712/&hellip;</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1571871769, "post_id": 58531603, "comment_id": 103387715, "body": "Here is another IBM webpage <a href=\"https://www.ibm.com/support/knowledgecenter/SSEQ5Y_5.9.0/com.ibm.pcomm.doc/books/html/host_access08.htm\" rel=\"nofollow noreferrer\">ibm.com/support/knowledgecenter/SSEQ5Y_5.9.0/com.ibm.pcomm.d&zwnj;&#8203;oc/&hellip;</a>"}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1571874778, "post_id": 58531603, "comment_id": 103388286, "body": "I&#39;ve used sendkeys in the past with some success in JDE on AS400"}, {"owner": {"reputation": 1032, "user_id": 3175562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/866fd7f2263cbabce6395353970679ae?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3175562/mike"}, "edited": false, "score": 1, "creation_date": 1571932491, "post_id": 58531603, "comment_id": 103411308, "body": "This is the kind of thing that I have done on a large scale, making a .NET dll with one class associated with each display file screen on the IBM. The class properties correlate with screen fields. In Excel, I have simple &quot;updating worksheets&quot; where you can press a button and update all the data in the column. VBA code calls my .dll which provides the actual update mechanism. Some people would scoff at doing massive data updates through the emulator interface, but I like the fact that unlike SQL updates, the data must run through the display&#39;s RPG for validation with errors returned to Excel."}, {"owner": {"reputation": 1032, "user_id": 3175562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/866fd7f2263cbabce6395353970679ae?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3175562/mike"}, "edited": false, "score": 1, "creation_date": 1571932500, "post_id": 58531603, "comment_id": 103411313, "body": "Related:  <a href=\"https://stackoverflow.com/q/33309939/3175562\">stackoverflow.com/q/33309939/3175562</a>"}], "owner": {"reputation": 33, "user_id": 10300738, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hg94Q3vs1OM/AAAAAAAAAAI/AAAAAAAAAGQ/WKKEp7WGuBA/photo.jpg?sz=128", "display_name": "Francesco Grassano", "link": "https://stackoverflow.com/users/10300738/francesco-grassano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 1, "closed_date": 1571895925, "answer_count": 0, "score": 3, "last_activity_date": 1571900131, "creation_date": 1571868729, "last_edit_date": 1571900131, "question_id": 58531603, "link": "https://stackoverflow.com/questions/58531603/vba-macro-for-use-as400", "closed_reason": "Needs more focus", "title": "VBA Macro for use AS400", "body": "<p>I want to automate AS400 through a VBA code. </p>\n\n<p>I would make a simple macro that make access to AS400 and insert some text in a field. </p>\n\n<p>It is possible?</p>\n\n<p>I search on internet and i understand that exist a PCOMM properties that allow to command AS400 from VBA Macro. It's right?</p>\n\n<p>Thank's for your support!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1571868074, "post_id": 58531486, "comment_id": 103386833, "body": "stoops. the answer is <code>Asc(ch.text)</code>. Without the <code>.text</code> it spits out invalid results."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1571869408, "post_id": 58531698, "comment_id": 103387176, "body": "Would have avoided the headache of the <code>ch.text</code> for sure. Thank you as always for the lessons"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1571869320, "creation_date": 1571869320, "answer_id": 58531698, "question_id": 58531486, "link": "https://stackoverflow.com/questions/58531486/from-character-to-chr/58531698#58531698", "title": "From character to chr()", "body": "<p>Use <code>String</code> and <code>Mid</code></p>\n\n<pre><code>Sub IterateCharactersObject()\n    Dim ch As String, n As Long\n\n    With ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\")\n        For n = 1 To .Characters.Count\n            ch = Mid(.Value, n, 1)\n\n            Debug.Print ch &amp; \", \" &amp; Asc(ch) '&lt;-- what should go in place of Asc(ch)?\n\n        Next n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JYlyG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JYlyG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 58531698, "answer_count": 1, "score": 0, "last_activity_date": 1571897874, "creation_date": 1571867769, "last_edit_date": 1571897874, "question_id": 58531486, "link": "https://stackoverflow.com/questions/58531486/from-character-to-chr", "title": "From character to chr()", "body": "<p>I have a string and I want to convert each character to it's appropriate ASCII character. </p>\n\n<pre><code>Sub IterateCharactersObject()\n    Dim ch As Characters, n As Long\n\n    With ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\")\n        For n = 1 To .Characters.Count\n            Set ch = .Characters(n, 1)\n\n            Debug.Print ch.Text &amp; \", \" &amp; Asc(ch) '&lt;-- what should go in place of Asc(ch)?\n\n        Next n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Not sure what function I am looking for and can't seem to find.</p>\n\n<p>If my string started with \"A big....\" then </p>\n\n<ul>\n<li>When <code>n= 1</code> output is <code>A, 65</code></li>\n<li>When <code>n= 2</code> output is <code>, 32</code></li>\n</ul>\n\n<p>I am essentially looking for the inverse of <code>Chr()</code> function in VBA</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1571863122, "post_id": 58530664, "comment_id": 103385173, "body": "And use <code>&amp;</code> instead of <code>+</code> to concatenate"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1571863183, "post_id": 58530664, "comment_id": 103385200, "body": "Dim your <code>start</code> and <code>finish</code> variables as long. No need to convert them to strings"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571863202, "post_id": 58530664, "comment_id": 103385216, "body": "^ All your <code>CStr</code> and <code>CInt</code> lines are unnecessary."}, {"owner": {"reputation": 49, "user_id": 11929220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Akj-AODqcNs/AAAAAAAAAAI/AAAAAAAACHo/l9AyUODANvs/photo.jpg?sz=128", "display_name": "Jake C", "link": "https://stackoverflow.com/users/11929220/jake-c"}, "edited": false, "score": 0, "creation_date": 1571863277, "post_id": 58530664, "comment_id": 103385257, "body": "Ah didn&#39;t know that. Thanks. Also, changed the &quot;+&quot; to &quot;&amp;&quot; and am now getting an &quot;application defined or object defined&quot; error"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571863307, "post_id": 58530664, "comment_id": 103385271, "body": "Then change the error in the OP as it no longer throws that error."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571863325, "post_id": 58530664, "comment_id": 103385276, "body": "what are the values of <code>start</code> and <code>finish</code>? Probably one or both are 0. <b>EDIT</b>: <code>j</code> is <b>0</b>."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1571863390, "post_id": 58530664, "comment_id": 103385300, "body": "^ you need to assign values to <code>start</code> and <code>finish</code> <i>before</i> your loop"}, {"owner": {"reputation": 49, "user_id": 11929220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Akj-AODqcNs/AAAAAAAAAAI/AAAAAAAACHo/l9AyUODANvs/photo.jpg?sz=128", "display_name": "Jake C", "link": "https://stackoverflow.com/users/11929220/jake-c"}, "edited": false, "score": 0, "creation_date": 1571863433, "post_id": 58530664, "comment_id": 103385316, "body": "start = 2 and changes based on a slider value. I can include the rest of the code in the post"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1571863493, "post_id": 58530664, "comment_id": 103385340, "body": "Might be useful to see the initial values for <code>start</code>, <code>finish</code>, <code>i</code> and <code>j</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571863601, "post_id": 58530664, "comment_id": 103385390, "body": "Move <code>j = j + 1</code> before the <code>Sheets</code> line, otherwise you have <code>B0</code> as your cell. Or better, just use <code>i</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571863660, "post_id": 58530782, "comment_id": 103385405, "body": "Why use <code>j</code>? Use <code>i</code>."}, {"owner": {"reputation": 49, "user_id": 11929220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Akj-AODqcNs/AAAAAAAAAAI/AAAAAAAACHo/l9AyUODANvs/photo.jpg?sz=128", "display_name": "Jake C", "link": "https://stackoverflow.com/users/11929220/jake-c"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571863760, "post_id": 58530782, "comment_id": 103385447, "body": "The actual application is going to be a little more complicated. This is the rough draft."}], "tags": [], "owner": {"reputation": 49, "user_id": 11929220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Akj-AODqcNs/AAAAAAAAAAI/AAAAAAAACHo/l9AyUODANvs/photo.jpg?sz=128", "display_name": "Jake C", "link": "https://stackoverflow.com/users/11929220/jake-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1571863601, "creation_date": 1571863601, "answer_id": 58530782, "question_id": 58530664, "link": "https://stackoverflow.com/questions/58530664/use-formula-to-sum-a-changing-range-of-cells/58530782#58530782", "title": "Use .Formula to Sum a Changing Range of Cells", "body": "<p>Thank you all for your help, the problem was that I had not defined \"j\" yet. </p>\n"}], "owner": {"reputation": 49, "user_id": 11929220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Akj-AODqcNs/AAAAAAAAAAI/AAAAAAAACHo/l9AyUODANvs/photo.jpg?sz=128", "display_name": "Jake C", "link": "https://stackoverflow.com/users/11929220/jake-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571863601, "creation_date": 1571863024, "last_edit_date": 1571863518, "question_id": 58530664, "link": "https://stackoverflow.com/questions/58530664/use-formula-to-sum-a-changing-range-of-cells", "title": "Use .Formula to Sum a Changing Range of Cells", "body": "<p>I am trying to fill out a table by summing the first \"x\" number of values then the next \"x\" number of values.</p>\n\n<p>Essentially this:\n=SUM(Ax:Ay) where x and y are the row numbers</p>\n\n<pre><code>Sheets(1).Range(\"B\"+i).Formula = \"=SUM(A\" &amp; x &amp; \":A\" &amp; y &amp; \")\"\n</code></pre>\n\n<p>Here is what my actual code looks like:</p>\n\n<pre><code>Private Sub ScrollBar1_Change()\n\nApplication.ScreenUpdating = False\n\nDim slider_val As Long\nDim output_tbl As ListObject\nDim data_tbl As ListObject\nDim i As Long\nDim j As Long\nDim start As Long\nDim finish As Long\n\nSet data_tbl = Sheets(\"Data\").ListObjects(\"DataTable\")\nSet output_tbl = Sheets(\"Slider\").ListObjects(\"OutputTable\")\nslider_val = Sheets(\"Slider\").Range(\"A5\").Value\n\nstart = 2\n\n    For i = 1 To 12\n\n        finish = start + slider_val\n\n        Sheets(\"Slider\").Range(\"B\" &amp; j).Formula = \"=SUM(Data!K\" &amp; start &amp; \":K\" &amp; finish &amp; \")\"\n\n        j = j + 1\n        start = finish + 1\n\n    Next i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I get the error \"Application-defined or object-defined error\" when I try to run this code. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571862976, "post_id": 58530630, "comment_id": 103385115, "body": "You can write a formula to an entire range in one go: <code>MyRange.FormulaR1C1 = ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6518722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c562e5068caa7e150a9c86242b60b42?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno MA", "link": "https://stackoverflow.com/users/6518722/bruno-ma"}, "edited": false, "score": 0, "creation_date": 1571863888, "post_id": 58530669, "comment_id": 103385494, "body": "Thank you, it works way faster! Now I&#39;ll implement throughout my code in other parts!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1571863039, "creation_date": 1571863039, "answer_id": 58530669, "question_id": 58530630, "link": "https://stackoverflow.com/questions/58530630/fill-a-large-range-of-cells-with-the-same-formula/58530669#58530669", "title": "Fill a large range of cells with the same formula?", "body": "<p>No Loop needed:</p>\n\n<pre><code>With ActiveSheet\n    .Range(.Cells(50, 2),.Cells(8050,N+1)).FormulaR1C1 = \"=3*R31C[0]*(R23C[0]/1000)*((R15C[-1]+RC1)/SQRT(3)/(v_RMT*1000)/cos_phi)^2\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6518722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c562e5068caa7e150a9c86242b60b42?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno MA", "link": "https://stackoverflow.com/users/6518722/bruno-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58530669, "answer_count": 1, "score": 0, "last_activity_date": 1571863039, "creation_date": 1571862888, "question_id": 58530630, "link": "https://stackoverflow.com/questions/58530630/fill-a-large-range-of-cells-with-the-same-formula", "title": "Fill a large range of cells with the same formula?", "body": "<p>I'm printing formulas to 8000 rows and a set number of columns. I'm using two for loops to print the formulas on the columns. Although the code works, it takes very long to finish. </p>\n\n<pre><code>'N is a value that is supplied by the user and can be large\n For j = 1 To N                                               \n     For Z = 50 To 8050                                               \n Cells(Z, j + 1).FormulaR1C1 = \"=3*R31C[0]*(R23C[0]/1000)*((R15C[-1]+RC1)/SQRT(3)/(v_RMT*1000)/cos_phi)^2\"\n     Next Z\nNext j\n</code></pre>\n\n<p>Is there a faster way to perform this task?</p>\n"}, {"tags": ["vba", "combobox", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1041, "user_id": 3348264, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e315904b63494207bd6f59a56838ddff?s=128&d=identicon&r=PG", "display_name": "Lewis Morris", "link": "https://stackoverflow.com/users/3348264/lewis-morris"}, "is_accepted": true, "score": 3, "last_activity_date": 1571861846, "creation_date": 1571861846, "answer_id": 58530418, "question_id": 58530316, "link": "https://stackoverflow.com/questions/58530316/configuring-a-combobox-as-read-only-is-there-a-way-to/58530418#58530418", "title": "Configuring a ComboBox as Read-Only: Is there a way to?", "body": "<p>If you change the style when creating the combobox to fmStyleDropDownList this will work.</p>\n\n<p>or </p>\n\n<p>Put this in your code - you will have the name of the combo box below to your objects name (if you have changed it).</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Me.ComboBox1.Style = fmStyleDropDownList\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 12232855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkzr1.jpg?s=128&g=1", "display_name": "Malachilee", "link": "https://stackoverflow.com/users/12232855/malachilee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58530418, "answer_count": 1, "score": 0, "last_activity_date": 1582095829, "creation_date": 1571861400, "last_edit_date": 1582095829, "question_id": 58530316, "link": "https://stackoverflow.com/questions/58530316/configuring-a-combobox-as-read-only-is-there-a-way-to", "title": "Configuring a ComboBox as Read-Only: Is there a way to?", "body": "<p>I would Like to use a ComboBox but disable the option to type into it.</p>\n\n<p>I'm trying to populate a textbox from a listbox, using a commandbutton. I can't get the button to transfer whats in the listbox unless the item in the listbox is seleceted and highlighted blue. If I use a combobox it doesn't need to be highlighted, But I don't want the option to type into the box, only select from the list.</p>\n\n<p>This is my entire code that I am testing.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nTextBox1 = Me.ComboBox1.Value\nEnd Sub\n\n\nPrivate Sub TextBox1_Change()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n'Creates and assigns the Array to the ListBox when the form loads.\n   Dim name As Variant\n\n   name = Array(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", _\n      \"Thursday\", \"Friday\", \"Saturday\")\n   ComboBox1.List = name\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1571862649, "post_id": 58530123, "comment_id": 103384963, "body": "I suggest you show some actual data before and after. It doesn&#39;t have to be your own data -- just something simple to demonstrate. Focus on demonstrating what you want and where it&#39;s going wrong. If you do this, I&#39;m sure you&#39;ll get help."}, {"owner": {"reputation": 415, "user_id": 2002558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tDGtp.jpg?s=128&g=1", "display_name": "dra_red", "link": "https://stackoverflow.com/users/2002558/dra-red"}, "edited": false, "score": 0, "creation_date": 1571880704, "post_id": 58530123, "comment_id": 103389278, "body": "I am guessing a bit here as I don&#39;t find the question clear but my guess is you are expecting &#39;j&#39; to be incremented but you don&#39;t have a &#39;j&#39; in a 2nd &#39;for/next&#39; loop as you do in your first block of code.   Apart from that though....this should be straight forward to debug so I will describe some basic debugging... Stick a break in (ie click to the left of the edit window) near where you see what is not working. Hit f5 to start and let the macro get to the break point and  then hit &#39;f8&#39; to move step by step to observe the output and identify where it is going wrong."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571894973, "post_id": 58530123, "comment_id": 103392274, "body": "Your question is not clear because you are requesting 2 columns of then values each and later you are exposing that your code is working ok for 20 columns. Could you upload some screenshots with your input and expected output?"}, {"owner": {"reputation": 5, "user_id": 8812783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LBsH680exE0/AAAAAAAAAAI/AAAAAAAAAJE/tPgqnCNVJfw/photo.jpg?sz=128", "display_name": "Milenko Jovic", "link": "https://stackoverflow.com/users/8812783/milenko-jovic"}, "reply_to_user": {"reputation": 415, "user_id": 2002558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tDGtp.jpg?s=128&g=1", "display_name": "dra_red", "link": "https://stackoverflow.com/users/2002558/dra-red"}, "edited": false, "score": 0, "creation_date": 1571929869, "post_id": 58530123, "comment_id": 103409903, "body": "Thanks @dra_red i have debugged it. Thing is in <b>If j &gt;= 13 Then</b> under added <b>n = 3</b> and other for loop is entering into second table."}, {"owner": {"reputation": 415, "user_id": 2002558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tDGtp.jpg?s=128&g=1", "display_name": "dra_red", "link": "https://stackoverflow.com/users/2002558/dra-red"}, "edited": false, "score": 0, "creation_date": 1571963227, "post_id": 58530123, "comment_id": 103422153, "body": "Good to hear you sorted it Milenko. Cheers"}], "owner": {"reputation": 5, "user_id": 8812783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LBsH680exE0/AAAAAAAAAAI/AAAAAAAAAJE/tPgqnCNVJfw/photo.jpg?sz=128", "display_name": "Milenko Jovic", "link": "https://stackoverflow.com/users/8812783/milenko-jovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571929709, "creation_date": 1571860563, "last_edit_date": 1571929709, "question_id": 58530123, "link": "https://stackoverflow.com/questions/58530123/break-for-loop-and-enter-results-into-different-table-in-excel-vba", "title": "Break For loop and enter results into different table in Excel VBA", "body": "<p>Taking results from API and sorting into different fileds, problem is that i have 20 columns returned from API and i want 2 different tables with 10 results each.</p>\n\n<pre><code>j = 3\nFor Each result In JSON.Item(\"results\")\n\nCells(20, j) = result.Item(\"param_1\")\nCells(21, j) = result.Item(\"param_2\")\nCells(22, j) = result.Item(\"param_3\")\nCells(23, j) = result.Item(\"param_4\")\ni = 0\n\nFor Each t In result.Item(\"param_5\")\n    If i &gt; 0 Then\n        Cells(24, j) = Cells(24, j) &amp; \", \" &amp; t\n    Else\n        Cells(24, j) = t\n        i = i + 1\n    End If\nNext\nCells(25, j) = result.Item(\"param_6\")\nCells(26, j) = result.Item(\"param_7\")\nj = j + 1\nNext\n</code></pre>\n\n<p>This is work well for every 20 columns, problem is when i add this part of code under first part, obviously its not works well in first table i get 10 results but in next table i have only one entry.</p>\n\n<pre><code>If j &gt;= 13 Then\nj = 3\n\nCells(33, j) = result.Item(\"param_1\")\nCells(34, j) = result.Item(\"param_2\")\nCells(35, j) = result.Item(\"param_3\")\nCells(36, j) = result.Item(\"param_4\")\ni = 0\nFor Each t In result.Item(\"param_5\")\n    If i &gt; 0 Then\n        Cells(37, j) = Cells(37, j) &amp; \", \" &amp; t\n    Else\n        Cells(37, j) = t\n        i = i + 1\n    End If\nNext\nCells(38, j) = result.Item(\"param_6\")\nCells(39, j) = result.Item(\"param_7\")\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571860313, "post_id": 58529919, "comment_id": 103384011, "body": "I think you should be able to modify the answer to <a href=\"https://stackoverflow.com/questions/43516312/vba-select-all-slides-of-defined-sections\">this question</a> to do what you want."}], "answers": [{"comments": [{"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 0, "creation_date": 1571861771, "post_id": 58530170, "comment_id": 103384598, "body": "Thank you! Very stupid question - how do I use this within a sub? I&#39;m not very sure of where to put the function - completely new to this."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 1, "creation_date": 1571862009, "post_id": 58530170, "comment_id": 103384702, "body": "@TheveshTheva Just add the function to a new/existing module and then in your sub/macro, you can use something like <code>Dim slideNumber As Long : slideNumber = GetFirstSlideNumber(&quot;AddInfo&quot;)</code> Is that what you&#39;re asking?"}, {"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 1, "creation_date": 1571862432, "post_id": 58530170, "comment_id": 103384872, "body": "This works absolutely perfect! Thank you so much - more than I had hoped for. :)"}], "tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 2, "last_activity_date": 1571861079, "last_edit_date": 1571861079, "creation_date": 1571860750, "answer_id": 58530170, "question_id": 58529919, "link": "https://stackoverflow.com/questions/58529919/how-to-get-slide-number-of-first-slide-in-a-section/58530170#58530170", "title": "How to get slide number of first slide in a section?", "body": "<p>To get the first slide of a specific section, you may use the following function:</p>\n\n<pre><code>' Returns the index of the first slide under the section `sectionName`.\n' Returns -1 if the section is not found or doesn't have any slides.\nPublic Function GetFirstSlideNumber(ByVal sectionName As String) As Long\n    With ActivePresentation.SectionProperties\n        Dim i As Long\n        For i = 1 To .Count\n            If .Name(i) = sectionName Then\n                GetFirstSlideNumber = .firstSlide(i)\n                Exit Function\n            End If\n        Next\n    End With\n\n    ' Section not found.\n    GetFirstSlideNumber = -1\nEnd Function\n</code></pre>\n\n<h3>Usage:</h3>\n\n<pre><code>Debug.Print GetFirstSlideNumber(\"AddInfo\")\n</code></pre>\n"}], "owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 58530170, "answer_count": 1, "score": 0, "last_activity_date": 1582781739, "creation_date": 1571859533, "last_edit_date": 1582781739, "question_id": 58529919, "link": "https://stackoverflow.com/questions/58529919/how-to-get-slide-number-of-first-slide-in-a-section", "title": "How to get slide number of first slide in a section?", "body": "<p>I am trying to number only the slides within a specific section. To do this, I need to generate numbering for each slide. Let <strong>first</strong> be the slide number of the first slide in that section. Then, the formula for the number of each slide in the section is:</p>\n\n<blockquote>\n  <p>Number = Current slide number - first + 1</p>\n</blockquote>\n\n<p>I currently have code which gives me the current slide number (the Text is within a shape, no need to worry about that).</p>\n\n<pre><code>.Text = \"Add. Info\" &amp; vbNewLine &amp; _\nActiveWindow.View.Slide.SlideIndex\n</code></pre>\n\n<p>The section that I'm looking for is named AddInfo. </p>\n\n<p>How do I get the slide number of the first slide in that section?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571859732, "post_id": 58529914, "comment_id": 103383773, "body": "So basically you&#39;re looking for a function to convert a name to its Initials. Can you give some sample names - are we always dealing with First, space, Last?"}, {"owner": {"reputation": 1, "user_id": 12265115, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YFbr6l4a__E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdP1jnMO2rJEsDhpzc1La-9MlhbsA/photo.jpg?sz=128", "display_name": "Jeremiah", "link": "https://stackoverflow.com/users/12265115/jeremiah"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571861959, "post_id": 58529914, "comment_id": 103384686, "body": "Yes the format I need is: \u201cyyyy-mm-dd - sender initials - title.msg&quot;  Eg email for John A Smith today: \u201c2019-10-23 - JAS - Subject\u201d  Or email from Kevin Bishop yesterday: \u201c2019-10-22 - KB - Subject\u201d  Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1571866993, "last_edit_date": 1571866993, "creation_date": 1571862280, "answer_id": 58530498, "question_id": 58529914, "link": "https://stackoverflow.com/questions/58529914/saving-emails-with-senders-initials/58530498#58530498", "title": "Saving emails with sender&#39;s initials", "body": "<p>You could use a helper function like this perhaps to return the initials from the sender name:</p>\n\n<pre><code>Private Function Initials(ByVal fullName As String) As String\n    Dim splitName\n    splitName = Split(fullName)\n\n    Dim i As Long\n    For i = LBound(splitName) To UBound(splitName)\n        Initials = UCase$(Initials &amp; IIf(Len(splitName(i) &gt; 0), Left$(splitName(i), 1), \"\"))\n    Next\nEnd Function\n</code></pre>\n\n<p>Call it perhaps like this:</p>\n\n<pre><code>olkMsg.SaveAs SAVE_TO_FOLDER &amp; strDate &amp; RemoveIllegalCharacters(Initials(olkMsg.senderName))...\n</code></pre>\n\n<p>though I would break that up into multiple pieces for readability.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>You can probably simplify the <code>Initials = ...</code> line to:</p>\n\n<pre><code>Initials = UCase$(Initials &amp; Left$(splitName(i), 1))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12265115, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YFbr6l4a__E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdP1jnMO2rJEsDhpzc1La-9MlhbsA/photo.jpg?sz=128", "display_name": "Jeremiah", "link": "https://stackoverflow.com/users/12265115/jeremiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584013855, "creation_date": 1571859519, "last_edit_date": 1584013855, "question_id": 58529914, "link": "https://stackoverflow.com/questions/58529914/saving-emails-with-senders-initials", "title": "Saving emails with sender&#39;s initials", "body": "<p>I am trying to save emails as .msg files.</p>\n\n<p>I am using the following code, resulting in the filename format \"yyyy-mm-dd - sender - title.msg\". I need the sender's initials instead of the whole name.</p>\n\n<pre><code>Sub OpenAndSave()\n    Const SAVE_TO_FOLDER = \"C:\\Users\\Documents\\Emails\\\"\n    Dim olkMsg As Outlook.MailItem, intCount As Integer\n    intCount = 1\n    For Each olkMsg In Outlook.ActiveExplorer.Selection\n        strDate = Format(olkMsg.ReceivedTime, \"yyyy-mm-dd - \")\n        olkMsg.Display\n        olkMsg.SaveAs SAVE_TO_FOLDER &amp; strDate &amp; RemoveIllegalCharacters(olkMsg.senderName) &amp; \" - \" &amp; RemoveIllegalCharacters(olkMsg.Subject) &amp; \".msg\"\n        olkMsg.Close olDiscard\n    Next\n    Set olkMsg = Nothing\nEnd Sub\n\nFunction RemoveIllegalCharacters(strValue As String) As String\n    ' Purpose: Remove characters that cannot be in a filename from a string.'\n    RemoveIllegalCharacters = strValue\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"&lt;\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"&gt;\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \":\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, Chr(34), \"'\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"/\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"\\\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"|\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"?\", \"\")\n    RemoveIllegalCharacters = Replace(RemoveIllegalCharacters, \"*\", \"\")\nEnd Function\n</code></pre>\n\n<p>E.g. email from John A Smith today: \u201c2019-10-23 - JAS - Subject\u201d Or email from Kevin Bishop yesterday: \u201c2019-10-22 - KB - Subject\u201d </p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "automation"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572003889, "post_id": 58532091, "comment_id": 103434886, "body": "Thanks QHarr! For the code you suggested, which code should I replace this? Is it starting from Set &#39;HTMLbuttons&#39; to &#39;Next&#39;? Also, what is this &#39;#example&#39; you mentioned on your code. Is this the file path? Thank you very much!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572004025, "post_id": 58532091, "comment_id": 103434946, "body": "Change your page load loop to a proper page load loop with While ie.readyState &lt;&gt; 4 Or ie.Busy:DoEvents:Wend then replace the lines after with the code I suggest in the bottom block. # is a css id selector so it select for the parent element which has id <i>example</i> IIRC this limits the returned children (matched by <i>[type=file]</i> to only the 3 visible upload buttons which needs clicking."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572004138, "post_id": 58532091, "comment_id": 103435000, "body": "Please see: <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors</a>"}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572284752, "post_id": 58532091, "comment_id": 103504606, "body": "Hi Qharr. I have not tried it yet. Just saw your reply. I will let you know."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572284815, "post_id": 58532091, "comment_id": 103504645, "body": ":-) Coolio. Thanks for letting me know"}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572286363, "post_id": 58532091, "comment_id": 103505310, "body": "Hi QHarr. I just replied. It did not work. What does that run time error mean?"}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572287789, "post_id": 58532091, "comment_id": 103505919, "body": "I tested it but it is not working. I received Run Time Error &#39;-2147417848 (80010108). THE OBJECT INVOKED HAS DISCONNECTED FROM ITS CLIENTS after I clicked F8 in the Loop line.. Also,I changed the url site to my actual url .What&#39;s causing this issue? Thanks for your time!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572288026, "post_id": 58532091, "comment_id": 103506019, "body": "On which line did this occur on?"}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572288879, "post_id": 58532091, "comment_id": 103506315, "body": "Below is the new code.   The error  begins in line   8 which is LOOP.                  Private Sub CommandButton21_Click()     Dim ie As Object  Dim uploads As Object, i As Long     Set ie = CreateObject(&quot;internetexplorer.application&quot;)  ie.Visible = True  ie.navigate &quot;<a href=\"http://www.htmlquick.com/reference/tags/input-file.html\" rel=\"nofollow noreferrer\">htmlquick.com/reference/tags/input-file.html</a>&quot;  Do While ie.readyState &lt;&gt; 4     Loop     Set uploads = ie.document.querySelectorAll(&quot;#examples [type=file]&quot;)     For i = 0 To uploads.Length - 1      uploads.Item(i).Click      &#39;other code  Next        End Sub"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572289084, "post_id": 58532091, "comment_id": 103506394, "body": "Sounds like you may need to use InternetExplorerMedium... also make sure all instances of IE are closed when running code and use task manager to ensure all open IE processes relating to this are closed."}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "edited": false, "score": 0, "creation_date": 1572289576, "post_id": 58532091, "comment_id": 103506582, "body": "Yeah,I did that. I made sure no IE was open. But still same error message. Also I was wondering what code to open &#39;choose to file&#39; windows dialog box after clicking the Upload Files button?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1572003926, "last_edit_date": 1572003926, "creation_date": 1571872446, "answer_id": 58532091, "question_id": 58529861, "link": "https://stackoverflow.com/questions/58529861/what-is-the-correct-element-id-for-this-vba-code/58532091#58532091", "title": "What is the correct element ID for this vba code?", "body": "<p>Some pointers:</p>\n\n<p>This <code>HTMLButton.Click btnInput.Value = \"C:\\temp\\test.txt\"</code>  should be on two separate lines. </p>\n\n<pre><code>HTMLButton.Click \nbtnInput.Value = \"C:\\temp\\test.txt\"\n</code></pre>\n\n<p>I think the second line is redundant. Your code is missing the more complex instructions required to interact with the file dialog for inputing the filepath. A subject for a whole other question which has been addressed elsewhere on SO.</p>\n\n<p>The \"buttons\" are input tag elements and you need to limit to the appropriate three.</p>\n\n<pre><code>Dim uploads As Object, i As Long\n\nSet uploads = ie.document.querySelectorAll(\"#examples [type=file]\")\n\nFor i = 0 To uploads.Length-1\n    uploads.item(i).click\n    'other code\nNext\n</code></pre>\n\n<p>My advice would be to try and code with the actual url and share the problems you are having with the actual scenario. The code above, IMO, is not fit for purpose for the url given.</p>\n"}, {"comments": [{"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1572334727, "post_id": 58596265, "comment_id": 103517574, "body": "You could type <code>taskkill &#47;F &#47;IM iexplore.exe</code> in cmd to kill all the IE instance and try it again. If you use <code>InternetExplorerMedium</code>, you need to add a reference to <code>Microsoft Internet Controls</code>. You could also refer to <a href=\"https://stackoverflow.com/questions/26925206/automation-error-when-getting-readystate-of-internetexplorer-object/29349900#29349900\">this answer</a> and try the workarounds in it."}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "reply_to_user": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1572470559, "post_id": 58596265, "comment_id": 103574617, "body": "Thanks for the link!I was able to solve it. However, the Upload file button action is not working. The codes were provided by QHarr. Below is the updated code.         Private Sub CommandButton21_Click() Dim ie As Object Dim uploads As Object, i As Long Set ie = New InternetExplorerMedium ie.Visible = True ie.navigate &quot;<a href=\"http://www.htmlquick.com/reference/tags/input-file.html\" rel=\"nofollow noreferrer\">htmlquick.com/reference/tags/input-file.html</a>&quot; While ie.readyState &lt;&gt; 4 DoEvents Wend Set uploads = ie.document.querySelectorAll(&quot;#examples [type=file]&quot;) For i = 0 To uploads.Length - 1     uploads.Item(i).Click Next End Sub"}, {"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1572488963, "post_id": 58596265, "comment_id": 103579014, "body": "What do you mean &quot;upload file button not working&quot;? Is there any error or something? I test with the above code you provide and it will open the upload file window dialog box and we can choose which file to open to upload."}, {"owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "reply_to_user": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1572557215, "post_id": 58596265, "comment_id": 103607499, "body": "Sorry for the confusion. I did not post the actual URL here for confidentiality. But when I copied the codes and changed the url to my actual url,the upload file button did not work. There was no error message. It just did not work."}, {"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1572573414, "post_id": 58596265, "comment_id": 103611051, "body": "Have you added breakpoints to debug? You should also change this line <code>Set uploads = ie.document.querySelectorAll(&quot;#examples [type=file]&quot;) </code> to fit the real situation of yours. How do you use the querySelector? You could also use the querySelector in console in browser to see if it chooses the right element."}], "tags": [], "owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "is_accepted": false, "score": 0, "last_activity_date": 1572286316, "creation_date": 1572286316, "answer_id": 58596265, "question_id": 58529861, "link": "https://stackoverflow.com/questions/58529861/what-is-the-correct-element-id-for-this-vba-code/58596265#58596265", "title": "What is the correct element ID for this vba code?", "body": "<p>I tested it but it is not working. I received Run Time Error '-2147417848 (80010108). THE OBJECT INVOKED HAS DISCONNECTED FROM ITS CLIENTS after I clicked F8 in the Loop line.. Below is the new code as per your suggestion. What is causing this issue? Apologies if I postes my comment here as a simple Add Comment does not allow me to put the codes. Thanks for your time!</p>\n\n<pre><code>Private Sub CommandButton21_Click() Dim ie As Object Dim uploads As Object, i As Long Set ie = CreateObject(\"internetexplorer.application\") ie.Visible = True ie.navigate\u00a0\"http://www.htmlquick.com/reference/tags/input-file.html\" Do While ie.readyState &lt;&gt; 4 Loop Set uploads = ie.document.querySelectorAll(\"#examples [type=file]\") For i = 0 To uploads.Length - 1 uploads.Item(i).Click'other code Next End Sub\n</code></pre>\n\n<p>\u00a0</p>\n"}], "owner": {"reputation": 1, "user_id": 9710351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18aa7cb0b9d762fb68293518a028d10?s=128&d=identicon&r=PG&f=1", "display_name": "LadyTiara", "link": "https://stackoverflow.com/users/9710351/ladytiara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572286316, "creation_date": 1571859242, "last_edit_date": 1571897501, "question_id": 58529861, "link": "https://stackoverflow.com/questions/58529861/what-is-the-correct-element-id-for-this-vba-code", "title": "What is the correct element ID for this vba code?", "body": "<p>I got the below vba code from this site. The code will automatically open the site in IE(will be using different url) and will import files as well. When I ran this code,it did not work due to incorrect elementsTagName and maybe InputType as well. What should be the correct codes? I am not sure. The second part is the html codes.</p>\n\n<p>Please help check the codes.</p>\n\n<pre><code>Sub File_Test()\nDim HTMLDoc As MSHTML.HTMLDocument\nDim HTMLButtons As MSHTML.IHTMLElementCollection\nDim HTMLButton As MSHTML.IHTMLElement\nDim btnInput As MSHTML.IHTMLInputElement \nDim ie As Object \nDim pointer As Integer \nSet ie = CreateObject(\"internetexplorer.application\") \nie.Visible = True \nie.navigate \"http://www.htmlquick.com/reference/tags/input-file.html\" \nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE \nLoop \nSet HTMLDoc = ie.document \nSet HTMLButtons = HTMLDoc.getElementsByTagName(\"Upload Files\") \nFor Each HTMLButton In HTMLButtons \n    For Each btnInput In HTMLButtons \n        If btnInput.Type = \"button\" Then \n             HTMLButton.Click btnInput.Value = \"C:\\temp\\test.txt\" \n             pointer = 1 \n             Exit For \n        End If \n     Next \n     btnInput \n     If pointer = 1 Then Exit For \n  Next \nEnd sub\n\n\n    &lt;button title=\"Upload Files\" class=\"button button--white xc-action-nav__button ng-binding ng-scope\" type=\"button\" loading-key=\"0\" ng-click=\"setLoading('group1', '0'); \" ng-disabled=\"isLoading('group1', null)\"&gt;&lt;span class=\"spinner-transition\" ng-class=\"{'spinner spinner--is-loading': isLoading('group1', '0')}\"&gt;&lt;/span&gt; Upload Files&lt;/button&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571856519, "post_id": 58529259, "comment_id": 103382511, "body": "<code>There are over 10,000 rows</code>  am I missing the loop?  This should be quick as it is a one off."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1571856627, "post_id": 58529259, "comment_id": 103382547, "body": "<code>10,000 rows</code> ... <code>taking over 1 min</code>.... turn off auto calcs and it will fly.  <code>Application.Calculation = xlCalculationManual</code>. Turn back on again after it writes the new value if needed"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571856640, "post_id": 58529259, "comment_id": 103382550, "body": "If this specific code is slow you need to check for events or volatile calculations.  This code would happen nearly instantly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571856669, "post_id": 58529259, "comment_id": 103382568, "body": "If you are looping 10,000 times, then look into using variant arrays."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571860583, "post_id": 58529259, "comment_id": 103384120, "body": "what @ScottCraner said. This action would take under a second (more like less than half a second to complete). check this out <a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">excelmacromastery.com/excel-vba-array</a>"}, {"owner": {"reputation": 415, "user_id": 2002558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tDGtp.jpg?s=128&g=1", "display_name": "dra_red", "link": "https://stackoverflow.com/users/2002558/dra-red"}, "edited": false, "score": 0, "creation_date": 1571883056, "post_id": 58529259, "comment_id": 103389703, "body": "IF you are updating elements on the same line then &#39;yes&#39;, you should copy and paste that last line of the routine (five times) and adjust the references. There would be no need to do repeated searches for the same information. There are efficiences to be had but it is hard to imagine them making a notable difference in such a small routine. One thing you could consider is to sort your &#39;index&#39; column so you can use a more efficient search method in the &#39;match&#39; function (ie using &#39;-1&#39; or &#39;1&#39; instead of &#39;0&#39;)"}, {"owner": {"reputation": 415, "user_id": 2002558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tDGtp.jpg?s=128&g=1", "display_name": "dra_red", "link": "https://stackoverflow.com/users/2002558/dra-red"}, "edited": false, "score": 0, "creation_date": 1571885387, "post_id": 58529259, "comment_id": 103390151, "body": "I did a small test on time. I created 15,000 claim records (ie JE94040682) and did a thousand lookups on that data. Hard to tell as it was quick so I upped it to 15,000 look ups (using &#39;match&#39;) and it came out at 15 sec. So 5 or six lookups is not the issue... As Scott Holtzman mentioned above, you are probably triggering workbook calculations which would explain the lag."}, {"owner": {"reputation": 27, "user_id": 12264897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56aafd25a2f4d41feb949db1b1c48987?s=128&d=identicon&r=PG&f=1", "display_name": "Rob O", "link": "https://stackoverflow.com/users/12264897/rob-o"}, "edited": false, "score": 0, "creation_date": 1571924842, "post_id": 58529259, "comment_id": 103407094, "body": "Thank you so much for the help! Really appreciate it!"}], "owner": {"reputation": 27, "user_id": 12264897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56aafd25a2f4d41feb949db1b1c48987?s=128&d=identicon&r=PG&f=1", "display_name": "Rob O", "link": "https://stackoverflow.com/users/12264897/rob-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571924778, "creation_date": 1571856299, "last_edit_date": 1571924778, "question_id": 58529259, "link": "https://stackoverflow.com/questions/58529259/vba-using-index-match-to-find-and-replace-specific-values-on-target-spreadsheet", "title": "VBA using Index/Match to find and replace specific values on target spreadsheet", "body": "<p>Updating information on an already populated target sheet which contains a particular numerical string in a source sheet.  Using INDEX/MATCH</p>\n\n<p>I've successfully done this using Excel-VLOOKUP in Vba but I need to use INDEX/MATCH because current code is too slow.</p>\n\n<p>Im currently using this method, but it is way too slow.</p>\n\n<p>[Sub faster_reviewercomments()\n    Dim lngRow As Long</p>\n\n<pre><code>On Error Resume Next\nlngRow = Application.WorksheetFunction.Match(Worksheets(\"REVIEW SHEET\").Range(\"C2\"), Worksheets(\"SAVEDWORK\").Range(\"b2:b15000\"), 0)\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Search failed \"\n    Exit Sub\nEnd If\nOn Error GoTo 0\nWorksheets(\"SavedWork\").Range(\"b2:b15000\").Cells(lngRow, 18) = Sheets(\"Review Sheet\").Range(\"d18\")\n</code></pre>\n\n<p>End Sub]</p>\n\n<p>On the Target sheet (Sheet2) there is old information and I need to replace some of the data with updated information that I will be inputting on sheet1 using a Claim Number as the Match.</p>\n\n<p>For example, if claim #123's old information on sheet2 is \"OPEN\" under the Status Column, I want to enter that claim number on Sheet1, type \"CLOSED\" and have that change on sheet2 to reflect the new status I've just assigned to it.</p>\n\n<p>There are over 10,000 rows on sheet 2, so some of the code i have tried using vba and the Vlookup takes over 1 minute to update each record. </p>\n\n<p>I'm hoping something like this is possible with INDEX MATCH to see if it's faster.</p>\n\n<p>Edit #2:  Ok, I consolidated all the lookups into 1.  Now it looks like this.  I timed it, and it takes 37-38 Seconds to complete (which may still be unacceptable to boss lady).  there are really only 3500 excel rows populated but I have it at 10K in the code to give it room for expansion.</p>\n\n<p>there will really never be duplicate claim numbers in that sheet, so i wonder if there's a way to make it stop looping when it finds the desired target in that list.</p>\n\n<p>Sub UPDATE_RECORD()\n    Dim lngRow As Long\n    On Error Resume Next\n    lngRow = Application.WorksheetFunction.Match(Worksheets(\"REVIEW SHEET\").Range(\"C2\"), Worksheets(\"SAVEDWORK\").Range(\"b2:b10000\"), 0)\n    If Err.Number &lt;> 0 Then\n        MsgBox \"Search failed \"\n        Exit Sub\n    End If\n    On Error GoTo 0\n    Worksheets(\"SavedWork\").Range(\"b2:b10000\").Cells(lngRow, 18) = Sheets(\"Review Sheet\").Range(\"D18\")\n    Worksheets(\"SavedWork\").Range(\"b2:b10000\").Cells(lngRow, 19) = Sheets(\"Review Sheet\").Range(\"D19\")\n    Worksheets(\"SavedWork\").Range(\"b2:b10000\").Cells(lngRow, 20) = Sheets(\"Review Sheet\").Range(\"D20\")\n    Worksheets(\"SavedWork\").Range(\"b2:b10000\").Cells(lngRow, 23) = Sheets(\"Review Sheet\").Range(\"F22\")\n    Worksheets(\"SavedWork\").Range(\"b2:b10000\").Cells(lngRow, 22) = Sheets(\"Review Sheet\").Range(\"D22\")\n    Worksheets(\"SavedWork\").Range(\"b2:b10000\").Cells(lngRow, 16) = Sheets(\"Review Sheet\").Range(\"D2\")\nEnd Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571856557, "post_id": 58529255, "comment_id": 103382524, "body": "So <code>Me.Input_ID.Value = tbl.DataBodyRange.Rows.Count + 1</code> is the line that throws the error?"}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571856592, "post_id": 58529255, "comment_id": 103382532, "body": "yes it mate... sorry forgot to mention that"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1571856810, "post_id": 58529255, "comment_id": 103382638, "body": "If the table is empty, <code>tbl.DataBodyRange</code> is nothing and as such there are no <code>Rows</code> and will throw that error."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 1, "creation_date": 1571856903, "post_id": 58529255, "comment_id": 103382677, "body": "ahh yes .. the table at this moment is empty indeed. I see what you mean. Will check it and report here them ... thanks"}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 1, "creation_date": 1571858156, "post_id": 58529255, "comment_id": 103383161, "body": "So i am changing to <code>tbl.ListRows.Count</code> instead . This one will work always, even if table has zero rows. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobject.listrows\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a> <code>The ListRows object returned does **not include** the header, total, or Insert rows.</code> Thanks in advance for help"}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1571858490, "post_id": 58529255, "comment_id": 103383284, "body": "no BigBen just using like this <code>Dim tRow As Integer | tRow = tbl.ListRows.Count | Me.Input_ID.Value = IIf(tRow = 0, 1, tRow)</code> | = new line"}], "owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571856277, "creation_date": 1571856277, "question_id": 58529255, "link": "https://stackoverflow.com/questions/58529255/error-91-when-counting-rows-on-userform-event-activate", "title": "error 91 when counting rows on userForm event activate", "body": "<p>I have a UserForm with some inputs, witch some of them are to be populated automatically (like the ID number) when the user enters the excel or to be re-populated when user adds news items, however it's giving an error when counting the number of rows in a table when opening the workbook.</p>\n\n<p>Run-time error '91': Object variable or With block variable not set</p>\n\n<p>At the beginning i had all the code showing here in the Initialize event, but when reading more carefully the documentation ( <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/initialize-event\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/initialize-event</a> ) it would make sense don't work like this cause the table is not open yet, so i did move the code to the Activate event, but it gives the exact same error. I did move back all the code again to the Initialize event and since i cannot find nothing regarding this particular case i come ask here about it.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\u00b4Workbook code part\nPrivate Sub Workbook_Open()\n    Form_Queimas.Show (vbModeless)\nEnd Sub\n\n\u00b4UserForm code part\nPrivate Sub UserForm_Initialize()\n    Dim ws As Worksheet\n    Dim tbl As ListObject\n\n    Set ws = Worksheets(\"Dados\")\n    Set tbl = ws.ListObjects(\"TabelaDados\")\n\n    Me.Input_ID.Value = tbl.DataBodyRange.Rows.Count + 1\n    Me.Input_Hora_inicial.Value = Format(Now(), \"hh:mm\")\n\n    Me.Input_Freguesia.AddItem \"Buarcos e S\u00e3o Juli\u00e3o\"\n    Me.Input_Freguesia.AddItem \"Pai\u00e3o\"\n    Me.Input_Freguesia.AddItem \"Marinha das Ondas\"\n    Me.Input_Freguesia.AddItem \"Ferreira A Nova\"\n    Me.Input_Freguesia.AddItem \"Vila Verde\"\n    Me.Input_Freguesia.AddItem \"Quiaios\"\nEnd Sub\n</code></pre>\n\n<p>The idea was to populate automatically the disable input with the table last row number</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "is_accepted": true, "score": 0, "last_activity_date": 1571970975, "creation_date": 1571970975, "answer_id": 58551453, "question_id": 58528853, "link": "https://stackoverflow.com/questions/58528853/consolidate-data-from-multiple-sheets-with-multiple-rows-of-headers-vba/58551453#58551453", "title": "Consolidate data from multiple sheets with multiple rows of headers VBA", "body": "<pre><code>Public Sub CopyRows() \n    Sheets(\"Sheet1\").Select \n    ' Find the last row of data \n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row \n    ' Loop through each row \n    For x = 2 To FinalRow \n        ' Decide if to copy based on column D \n        ThisValue = Cells(x, 4).Value \n        If ThisValue = \"A\" Then \n            Cells(x, 1).Resize(1, 33).Copy \n            Sheets(\"SheetA\").Select \n            NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1 \n            Cells(NextRow, 1).Select \n            ActiveSheet.Paste \n            Sheets(\"Sheet1\").Select \n        ElseIf ThisValue = \"B\" Then \n            Cells(x, 1).Resize(1, 33).Copy \n            Sheets(\"SheetB\").Select \n            NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1 \n            Cells(NextRow, 1).Select \n            ActiveSheet.Paste \n            Sheets(\"Sheet1\").Select \n        End If \n    Next x \nEnd Sub\n</code></pre>\n\n<p>This code helped to resolve the issue :-) </p>\n"}], "owner": {"reputation": 73, "user_id": 10763297, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248055548675933/picture?type=large", "display_name": "Sergej Dikun", "link": "https://stackoverflow.com/users/10763297/sergej-dikun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58551453, "answer_count": 1, "score": 0, "last_activity_date": 1571970975, "creation_date": 1571854725, "question_id": 58528853, "link": "https://stackoverflow.com/questions/58528853/consolidate-data-from-multiple-sheets-with-multiple-rows-of-headers-vba", "title": "Consolidate data from multiple sheets with multiple rows of headers VBA", "body": "<p>In advance, thank you for all your help. </p>\n\n<p>The task that I have is I need to copy data from two sheets in to \"Consolidation\" sheet. Both sheets have similar headers, but I only need to keep one set of those headers.</p>\n\n<p>So far I've tried multiple consolidation techniques, but they either copy everything, or summarizing up all the numerical values. </p>\n\n<p>When I tried to convert text in to header, it would allow for only one row to be converted, perhaps there is another way, but I could not find it.</p>\n\n<p>'the code below copies the numbers if I will the table with numbers, but ignores strings</p>\n\n<pre><code>Dim ws As Worksheet\nDim sArray As Variant, i As Integer\nReDim sArray(1 To 1)\n\n'---Make Array with Named Ranges to be Consolidated\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Visible And ws.Name &lt;&gt; \"Consolidation\" Then\n        i = i + 1\n        ReDim Preserve sArray(1 To i)\n        sArray(i) = ws.UsedRange.Address(ReferenceStyle:=XlReferenceStyle.xlR1C1, external:=True)\n    End If\nNext ws\nIf i = 0 Then Exit Sub\n\n'---Consolidate using the Array\nSheets(\"Consolidation\").Range(\"A1\").Consolidate Sources:=(sArray), _\n    Function:=xlSum, TopRow:=False, LeftColumn:=False, CreateLinks:=False\n</code></pre>\n\n<p>Sheet1: \n<a href=\"https://imgur.com/a/S0h0iHv\" rel=\"nofollow noreferrer\">https://imgur.com/a/S0h0iHv</a></p>\n\n<p>Sheet2: \n<a href=\"https://imgur.com/a/S0h0iHv\" rel=\"nofollow noreferrer\">https://imgur.com/a/S0h0iHv</a></p>\n\n<p>Desired outcome: \n<a href=\"https://imgur.com/a/kthyNPv\" rel=\"nofollow noreferrer\">https://imgur.com/a/kthyNPv</a></p>\n\n<p>Once again, thanks everyone for your help.</p>\n"}, {"tags": ["vba", "internet-explorer", "automation"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571885524, "post_id": 58531770, "comment_id": 103390171, "body": "Nice approach there."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1571869874, "creation_date": 1571869874, "answer_id": 58531770, "question_id": 58528743, "link": "https://stackoverflow.com/questions/58528743/vba-how-to-wait-for-pop-up-windows-using-ie/58531770#58531770", "title": "VBA: How to wait for Pop-up windows using IE", "body": "<p>Here's one way to do it:</p>\n\n<pre><code>Sub Tester()\n\n    Dim w As Object, t\n\n    t = Timer\n    Set w = WaitForWindow(\"google.com\", 10)\n\n    If Not w Is Nothing Then\n        Debug.Print \"Found in \" &amp; Timer - t\n    Else\n        Debug.Print \"Not found after \" &amp; Timer - t\n    End If\n\nEnd Sub\n\n'Find (or wait for) an IE window with location\n'   matching URL (using \"Like\" for matching)\n'Try for maxWait seconds then give up\nFunction WaitForWindow(URL As String, maxWait As Long)\n    Dim rv As Object, t\n    t = Timer\n    Do While Timer - t &lt; maxWait\n        Set rv = GetIEByUrl(URL)\n        If Not rv Is Nothing Then Exit Do\n        Application.Wait (Now + TimeValue(\"00:00:01\"))\n    Loop\n    Set WaitForWindow = rv\nEnd Function\n\n'Try to get an existing IE window based on URL match\nFunction GetIEByUrl(URL As String) As Object\n    Dim o As Object, rv As Object\n    For Each o In CreateObject(\"Shell.Application\").Windows\n        If TypeName(o) = \"IWebBrowser2\" Then\n            If o.Locationurl Like \"*\" &amp; URL &amp; \"*\" Then\n                Set rv = o\n                Exit For\n            End If\n        End If\n    Next o\n    Set GetIEByUrl = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4938290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f97ac40fe79d24417358e7b2c02748?s=128&d=identicon&r=PG", "display_name": "Shadow Slim", "link": "https://stackoverflow.com/users/4938290/shadow-slim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571869874, "creation_date": 1571854229, "question_id": 58528743, "link": "https://stackoverflow.com/questions/58528743/vba-how-to-wait-for-pop-up-windows-using-ie", "title": "VBA: How to wait for Pop-up windows using IE", "body": "<p>Generally, what is the easiest way to wait for a pop-up window in VBA using the IE automation? I wrote a program with the help of this community, which has been very informative, every time that I hit a roadblock in my code. Thank you, graciously. </p>\n\n<p>Situation: </p>\n\n<p>I create a program that interacts with IE. It's an automation process that handles data based on the functionality of the site. In the automation process, when I click on a link, it opens a pop-up window. Here is where the problems being. Sometimes, the pop-window takes anywhere between 5 seconds to 30 seconds to load. However, I am unable to determine the length of time that it takes for the pop-window to load, nor does the program, which crashes every time it reaches outside the scope of the waiting period I set it for in the program. </p>\n\n<p>Everything else works perfectly, except for this small little delete that is the ultimate death of my program and sends it spiraling downhill. </p>\n\n<p>The pop-window has to load first before I am able to assign the popWindow (IE) object. </p>\n\n<pre><code> Dim popWindow As InternetExplorer \n Set popWindow = oGetIEWindowFromTitle(\"Site Name\")\n Set deviceWindow = popWindow.Document\n</code></pre>\n\n<pre><code>Function oGetIEWindowFromTitle(sTitle As String, _\n                               Optional bCaseSensitive As Boolean = False, _\n                               Optional bExact As Boolean = False) As Shdocvw.InternetExplorer\n\n    Dim objShellWindows As New Shdocvw.ShellWindows\n    Dim found As Boolean\n    Dim startTime As Single\n\n    found = False\n    'Loop through shell windows\n    For Each oGetIEWindowFromTitle In objShellWindows\n        found = oGetIEWindowFromTitleHandler(oGetIEWindowFromTitle, sTitle, bCaseSensitive, bExact)\n        If found Then Exit For\n    Next\n\n    'Check whether a window was found\n    If Not found Then\n        Set oGetIEWindowFromTitle = Nothing\n    Else\n\n\n\n\n        Do While oGetIEWindowFromTitle.Busy '----- this is what I have tried\n        Application.Wait (Now + TimeValue(\"00:00:01\"))\n        Loop\n\n\n        Do While oGetIEWindowFromTitle.Busy = True Or oGetIEWindowFromTitle.ReadyState &lt;&gt; 4: DoEvents: Loop '------ this is what I have tried\n\n\n\n\n    End If\n\nEnd Function\n</code></pre>\n\n<pre><code>Private Function oGetIEWindowFromTitleHandler(win As Shdocvw.InternetExplorer, _\n                                      sTitle As String, _\n                                      bCaseSensitive As Boolean, _\n                                      bExact As Boolean) As Boolean\n\n    oGetIEWindowFromTitleHandler = False\n\n    On Error GoTo handler\n    'If the document is of type HTMLDocument, it is an IE window\n    If TypeName(win.Document) = \"HTMLDocument\" Then\n        'Check whether the title contains the passed title\n        If bExact Then\n            If (win.Document.Title = sTitle) Or ((Not bCaseSensitive) And (LCase(sTitle) = LCase(win.Document.Title))) Then oGetIEWindowFromTitleHandler = True\n        Else\n            If InStr(1, win.Document.Title, sTitle) Or ((Not bCaseSensitive) And (InStr(1, LCase(win.Document.Title), LCase(sTitle), vbTextCompare) &lt;&gt; 0)) Then oGetIEWindowFromTitleHandler = True\n        End If\n    End If\nhandler:\n    'We assume here that if an error is raised it's because\n    'the window is not of the correct type. Therefore we\n    'simply ignore it and carry on.\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 21, "user_id": 12220243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snSXG.jpg?s=128&g=1", "display_name": "Aaron Butler", "link": "https://stackoverflow.com/users/12220243/aaron-butler"}, "edited": false, "score": 0, "creation_date": 1571857262, "post_id": 58528444, "comment_id": 103382841, "body": "I can do this by having an embedded macro which has a GoToControl with the control name =[Screen].[PreviousControl].[Name] but when I try and put this into code it will not work."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1571897751, "post_id": 58528444, "comment_id": 103393172, "body": "Which code? There is no code in your question.  If we don&#39;t see the code we cannot tell whats wrong in the code."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1571905762, "post_id": 58528444, "comment_id": 103396838, "body": "Why don&#39;t you use Access conversion tool to convert macro to VBA and see what the result is. Maybe it will show <code>DoCmd.GoToRecord acActiveDataObject, , acPrevious</code>. However, it should not be necessary to move to previous. Post your attempted VBA code."}, {"owner": {"reputation": 21, "user_id": 12220243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snSXG.jpg?s=128&g=1", "display_name": "Aaron Butler", "link": "https://stackoverflow.com/users/12220243/aaron-butler"}, "edited": false, "score": 0, "creation_date": 1571915937, "post_id": 58528444, "comment_id": 103402244, "body": "Here is my code:  I tried with acPrevious and it came up with an error  &quot;You can&#39;t go to the specified record&quot; so I removed it and every time I press the button it selected the next one down starting from the top.                                                                                 DoCmd.GoToRecord acActiveDataObject AID = Me.Auto_ID DoCmd.SetWarnings False Set Mydb = CurrentDb strSQL = &quot;UPDATE Dev_Proc_ResinToolSpec SET Dev_Proc_ResinToolSpec.Approval = -1 WHERE ResinSpec_AID = &quot; &amp; AID &amp; &quot;;&quot; Mydb.Execute strSQL, dbSeeChanges Me.Recalc DoCmd.SetWarnings True"}, {"owner": {"reputation": 21, "user_id": 12220243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snSXG.jpg?s=128&g=1", "display_name": "Aaron Butler", "link": "https://stackoverflow.com/users/12220243/aaron-butler"}, "edited": false, "score": 0, "creation_date": 1571916376, "post_id": 58528444, "comment_id": 103402497, "body": "I can&#39;t put a screen show of the code on here for some reason or of the macro which has the &quot;Convert Macros to Visual Basic&quot; button greyed out."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1571929539, "post_id": 58528444, "comment_id": 103409730, "body": "@AaronButler Please <a href=\"https://stackoverflow.com/posts/58528444/edit\">edit</a> your original question and add the code there. In a comment it is pretty much un-readable."}, {"owner": {"reputation": 21, "user_id": 12220243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snSXG.jpg?s=128&g=1", "display_name": "Aaron Butler", "link": "https://stackoverflow.com/users/12220243/aaron-butler"}, "edited": false, "score": 0, "creation_date": 1571933788, "post_id": 58528444, "comment_id": 103411929, "body": "Hi.  Thanks for the help but I have now resolved the issue in a round about way.  I created a text field with the word &quot;Reject&quot; in it and one with the word &quot;Approve&quot;.  This then selected the row when pressed and ran the rest of the code for that row.  Also conditional formatted it so it disables them when clicked so it can&#39;t be clicked twice."}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1572348764, "post_id": 58528444, "comment_id": 103524096, "body": "Please have a look at <a href=\"http://stackoverflow.com/help/self-answer\">Can I answer my own question?</a> and come back two days later and check as answered if you have more than 15 reputation."}], "owner": {"reputation": 21, "user_id": 12220243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snSXG.jpg?s=128&g=1", "display_name": "Aaron Butler", "link": "https://stackoverflow.com/users/12220243/aaron-butler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594278583, "creation_date": 1571853026, "last_edit_date": 1594278583, "question_id": 58528444, "link": "https://stackoverflow.com/questions/58528444/updating-row-that-contains-the-button", "title": "Updating row that contains the button", "body": "<p>I have the form below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SEfou.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SEfou.png\" alt=\"Button Selection Image\"></a></p>\n\n<p>When I select the button to change the status field to Rejected it changes the one that was clicked on before not the row that the button is on.</p>\n\n<p>Is there a way of forcing focus on that record with the selected button before running the code?</p>\n\n<p>Here is the code behind the button:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.GoToRecord acActiveDataObject\nAID = Me.Auto_ID\nDoCmd.SetWarnings False\nSet Mydb = CurrentDb\nstrSQL = \"UPDATE Dev_Proc_ResinToolSpec SET Dev_Proc_ResinToolSpec.Approval = -1 WHERE ResinSpec_AID = \" &amp; AID &amp; \";\"\nMydb.Execute strSQL, dbSeeChanges\nMe.Recalc \nDoCmd.SetWarnings True\n</code></pre>\n\n<p>I tried changing the <code>GoToRecord</code> to use <code>acPrevious</code> but it threw up this error</p>\n\n<blockquote>\n  <p>You can't go to the specified record</p>\n</blockquote>\n"}, {"tags": ["json", "excel", "vba", "excel-formula", "spreadsheet"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1571852680, "post_id": 58528273, "comment_id": 103380874, "body": "I think in this particular case, VBA will be easier and better route from maintenance perspective. Is there any specific reason to opt for formula approach?"}, {"owner": {"reputation": 1886, "user_id": 4927657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17e2d11c4248f28f4c711ded2167a055?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/4927657/alejandro"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1571853371, "post_id": 58528273, "comment_id": 103381183, "body": "I have multiple spreadsheets in this format. As long I can get an output with the JSON format, I am okay with any methods"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1571854365, "post_id": 58528273, "comment_id": 103381598, "body": "Okay. Have you tried to code or formulate something to solve your case?"}, {"owner": {"reputation": 1886, "user_id": 4927657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17e2d11c4248f28f4c711ded2167a055?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/4927657/alejandro"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1571854811, "post_id": 58528273, "comment_id": 103381807, "body": "I&#39;ve tried using concatenate and append each column with appropriate syntax &quot;{...},[]&quot; but to no vail"}, {"owner": {"reputation": 613, "user_id": 7127929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b334f57c3d15f8eeae4bdf256ee036a?s=128&d=identicon&r=PG&f=1", "display_name": "RegularNormalDayGuy", "link": "https://stackoverflow.com/users/7127929/regularnormaldayguy"}, "edited": false, "score": 1, "creation_date": 1571855706, "post_id": 58528273, "comment_id": 103382163, "body": "Split your problem into multiple parts. Take a row by row analysis; what do you do if column A has something ? If it&#39;s empty ? By concatenating multiple <code>IFs</code> together, you should be able to create a nice JSON file. Come back and show us what you&#39;ve tried"}], "answers": [{"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1571856511, "creation_date": 1571856511, "answer_id": 58529307, "question_id": 58528273, "link": "https://stackoverflow.com/questions/58528273/convert-excel-sheet-nested-to-json/58529307#58529307", "title": "Convert Excel Sheet (nested) to JSON", "body": "<p>Here's some basic code which should point you to the right direction.</p>\n\n<p>I have commented it as much as possible.</p>\n\n<pre><code>Sub GetJSONOutput()\nDim wks As Worksheet: Set wks = ActiveSheet\nDim lngLastRow As Long, i As Long, j As Long, k As Long\nDim blFirstRow As Boolean\nDim strOut As String\nlngLastRow = wks.Cells.Find(\"*\", wks.Cells(1, 1), , , , xlPrevious).Row\nk = 1\nFor i = 1 To lngLastRow\n    '\\\\ First Element - Column A\n    '\\\\ Check for first line and build beginning style\n    If Len(wks.Cells(i, 1).Value) &gt; 0 Then\n        If blFirstRow = False Then\n            strOut = \"{ \"\"\" &amp; wks.Cells(i, 1).Value &amp; \"\"\": {\"\n            blFirstRow = True\n        Else '\\\\ Rest follow the same style\n            strOut = \"}, \"\"\" &amp; wks.Cells(i, 1).Value &amp; \"\"\": {\"\n        End If\n        wks.Cells(k, 4).Value = strOut: k = k + 1 '--&gt; Output Column D\n    End If\n\n    '\\\\ Middle element - Column B\n    If Len(wks.Cells(i, 2).Value) &gt; 0 Then strbase = \"    \"\"\" &amp; wks.Cells(i, 2).Value &amp; \"\"\": [\"\n\n    If Len(wks.Cells(i, 3).Value) &gt; 0 Then\n        '\\\\ Now we have Middle element then we need to loop through all elements under it!\n        '\\\\ Last Element - Column C\n        If Len(wks.Cells(i + 1, 3).Value) &gt; 0 Then\n            strAppend = \"\"\n            For j = i To wks.Cells(i, 3).End(xlDown).Row\n                strAppend = strAppend &amp; \"|\" &amp; wks.Cells(j, 3).Value\n            Next j\n            strOut = strbase &amp; \"\"\"\" &amp; Replace(Mid(strAppend, 2, Len(strAppend)), \"|\", Chr(34) &amp; \", \" &amp; Chr(34)) &amp; \"\"\"]\"\n            wks.Cells(k, 4).Value = strOut: k = k + 1  '--&gt; Output Column D\n            i = j - 1\n        Else\n            strOut = strbase &amp; \"\"\"\" &amp; wks.Cells(i, 3).Value &amp; \"\"\"]\"\n            wks.Cells(k, 4).Value = strOut: k = k + 1  '--&gt; Output Column D\n        End If\n    End If\n    '\\\\ Complete output by outputting the last closing brackets\n    If i = lngLastRow Then\n        strOut = \"}}\"\n        wks.Cells(k, 4).Value = strOut  '--&gt; Output Column D\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "is_accepted": false, "score": 0, "last_activity_date": 1572741533, "creation_date": 1572741533, "answer_id": 58676511, "question_id": 58528273, "link": "https://stackoverflow.com/questions/58528273/convert-excel-sheet-nested-to-json/58676511#58676511", "title": "Convert Excel Sheet (nested) to JSON", "body": "<pre><code>Sub ConvertToJSONText()\n    Dim Sht As Worksheet\n    Set Sht = Worksheets(\"Sheet1\")\n    Dim a As Integer\n    Dim lstA\n    Dim lstB\n    Dim lstC\n    a = 0\n    Dim myJsonText\n    myJsonText = \"{\"\n    Do While True\n       a = a + 1\n       If Sht.Range(\"a\" &amp; a).Value = \"\" And Sht.Range(\"b\" &amp; a).Value = \"\" And Sht.Range(\"c\" &amp; a).Value = \"\" Then\n          Exit Do\n       End If\n       If Sht.Range(\"a\" &amp; a).Value &lt;&gt; \"\" And Sht.Range(\"b\" &amp; a).Value = \"\" And Sht.Range(\"c\" &amp; a).Value = \"\" Then\n          If lstB &lt;&gt; \"\" Then myJsonText = myJsonText &amp; \"]\"\n          If lstA &lt;&gt; \"\" Then myJsonText = myJsonText &amp; \"},\"\n      lstA = Sht.Range(\"a\" &amp; a).Value\n          lstB = \"\"\n          lstC = \"\"\n          myJsonText = myJsonText &amp; \"\"\"\" &amp; lstA &amp; \"\"\": {\"\n       End If\n       If Sht.Range(\"a\" &amp; a).Value = \"\" And Sht.Range(\"b\" &amp; a).Value &lt;&gt; \"\" And Sht.Range(\"c\" &amp; a).Value = \"\" Then\n          If lstB &lt;&gt; \"\" Then myJsonText = myJsonText &amp; \"]\"\n          lstB = Sht.Range(\"B\" &amp; a).Value\n          lstC = \"\"\n          myJsonText = myJsonText &amp; \"\"\"\" &amp; lstB &amp; \"\"\": [\"\n       End If\n       If Sht.Range(\"a\" &amp; a).Value = \"\" And Sht.Range(\"b\" &amp; a).Value = \"\" And Sht.Range(\"c\" &amp; a).Value &lt;&gt; \"\" Then\n          If lstC &lt;&gt; \"\" Then myJsonText = myJsonText &amp; \",\"\n          lstC = Sht.Range(\"C\" &amp; a).Value\n          myJsonText = myJsonText &amp; \"\"\"\" &amp; lstC &amp; \"\"\"\"\n       End If\n    Loop\n    If lstB &lt;&gt; \"\" Then myJsonText = myJsonText &amp; \"]\"\n    myJsonText = myJsonText &amp; \"}\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1886, "user_id": 4927657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17e2d11c4248f28f4c711ded2167a055?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/4927657/alejandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572741533, "creation_date": 1571852279, "last_edit_date": 1571853901, "question_id": 58528273, "link": "https://stackoverflow.com/questions/58528273/convert-excel-sheet-nested-to-json", "title": "Convert Excel Sheet (nested) to JSON", "body": "<p>I am giving a spreedsheet and I need to convert into JSON. \nI have the following spreadsheet as so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XUrwf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XUrwf.png\" alt=\"enter image description here\"></a></p>\n\n<p>In essence, I'd need to convert into like this: </p>\n\n<pre><code>{ \"CompanyA\": {\n    \"Products\": [\"Beds\", \"Knifes\", \"Spoons\"]\n}, \"CompanyB\": {\n    \"Products\": [\"Beds\", \"Knifes\", \"Spoons\"],\n    \"Sites\": [\"West Coast\", \"East Coast\"]\n}, \"CompanyC\": {\n    \"Office\": [\"Los Angeles\"]\n}}\n</code></pre>\n\n<p>I tried looking at online sources, but I haven't got a good solution to what I am looking for</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571851360, "post_id": 58528009, "comment_id": 103380361, "body": "Start with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.shape.fill\" rel=\"nofollow noreferrer\"><code>Shape.Fill</code></a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.shape.line\" rel=\"nofollow noreferrer\"><code>Shape.Line</code></a>. You already specify the position and size in <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.shapes.addshape\" rel=\"nofollow noreferrer\"><code>Shapes.AddShape</code></a>."}, {"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571853669, "post_id": 58528009, "comment_id": 103381298, "body": "@BigBen Thank you - I was being very stupid. I&#39;ve incorporated all your suggestions - how do I rotate the shape?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1571853992, "post_id": 58528009, "comment_id": 103381429, "body": "A Shape has a <code>Rotation</code> property. Can you try to tinker with that?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1571854060, "post_id": 58528009, "comment_id": 103381454, "body": "Another hint: Shapes work much the same in Excel as they do in PowerPoint. Excel allows you to &quot;record a macro&quot; (basically, translates your user-interaction to VBA code). If you are stuck, that is also a good place to start. Record a macro doing the rotation manually, and then use/modify the recorded VBA code in PowerPoint. Cheers."}, {"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571854314, "post_id": 58528009, "comment_id": 103381575, "body": "@DavidZemens I found the rotation property, but it rotates the text inside 180 degrees as well. How best to get around this? (and thank you for the Excel tip!)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571854354, "post_id": 58528009, "comment_id": 103381594, "body": "You can also rotate the text, if I recall correctly. That&#39;s a textrange or textframe  property, I think."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571854528, "post_id": 58528009, "comment_id": 103381683, "body": "Maybe <code>.TextFrame2.Notextrotation = msoTrue</code>?"}, {"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571854987, "post_id": 58528009, "comment_id": 103381887, "body": "@DavidZemens I&#39;m getting an <code>object doesn&#39;t support this action</code> error when I try that."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571856493, "post_id": 58528009, "comment_id": 103382494, "body": "hmmmm. I don&#39;t see an obvious or intuitive way to do this. Not particularly surprising. It&#39;s odd that the <code>NoTextRotation</code> raises an error, but I see the same error on my end even though this <i>should</i> be a valid property of the shape."}, {"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1571856521, "post_id": 58528009, "comment_id": 103382512, "body": "@DavidZemens Solved with <code>.TextFrame2.ThreeD.RotationZ = -180</code> but this messes with the look of the text so I&#39;ll probably just create another box."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571858268, "post_id": 58528009, "comment_id": 103383202, "body": "Yes that would be the other hack -- creating a separate textbox that overlays or is a child shape of your triangle."}], "owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1582781762, "creation_date": 1571851200, "last_edit_date": 1582781762, "question_id": 58528009, "link": "https://stackoverflow.com/questions/58528009/powerpoint-vba-how-to-rotate-right-angled-triangle", "title": "Powerpoint VBA - How to rotate right-angled triangle?", "body": "<p>I have the following VBA code, adapted from <a href=\"https://stackoverflow.com/a/24512082\">here</a>:</p>\n\n<pre><code>Sub Risk(ByVal control As IRibbonControl)\n\n    Dim tri As Shape\n    Set tri = ActiveWindow.Selection.SlideRange.Shapes.AddShape(msoShapeRightTriangle, 886, 0, 74, 74)\n\n    With tri\n        .Fill.ForeColor.RGB = RGB(255, 0, 0)\n\n        With .Line\n        .Weight = 0\n        .ForeColor.RGB = RGB(255, 0, 0)\n        End With ' Outline\n\n        With .TextFrame.TextRange\n          .Text = \"Risk\"\n\n           With .Font\n            .Name = \"Arial\"\n            .Size = 10\n            .Bold = msoTrue\n            .Italic = msoFalse\n            .Underline = msoFalse\n            .Shadow = msoFalse\n            .Emboss = msoFalse\n            .BaselineOffset = 0\n            .AutoRotateNumbers = msoFalse\n            .Color.RGB = RGB(255, 255, 255)\n        End With   ' Font\n\n       End With   ' TextRange\n\n    End With ' Shape itself\n\n    End Sub\n</code></pre>\n\n<p>This successfully creates a right-angled triangle, but it's got the wrong orientation (the right angle should be flush against the corner). How do I rotate it?</p>\n\n<hr>\n\n<p><strong>Note: Question was edited to incorporate comment, and made more specific.</strong></p>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1571850715, "post_id": 58527679, "comment_id": 103380038, "body": "This is what I use to parse Json, check if it helps: <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571850720, "post_id": 58527679, "comment_id": 103380040, "body": "&quot;however this solution still makes use of the scripting runtime and fails&quot;. You&#39;ll have to back that claim, because VBA-JSON is portable by design and works perfectly fine on a Mac (which doesn&#39;t have the scripting runtime library). From <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/README.md\" rel=\"nofollow noreferrer\">readme</a>: <b>For Mac and Windows support, include <a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">VBA-Dictionary</a></b>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571851342, "post_id": 58527679, "comment_id": 103380353, "body": "Scripting runtime library should work perfectly fine in a 64-bit host; the ScriptControl ActiveX control is the problem (won&#39;t work in a 64-bit host), and this is true of any 32-bit ActiveX control (e.g. date picker). The problem is the 32-bit ActiveX control, not the scripting runtime."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1578180477, "post_id": 58527679, "comment_id": 105356406, "body": "Try <a href=\"https://stackoverflow.com/a/38134477/2165759\">this solution</a>, although I would avoid parsing JSON with ScriptControl."}], "owner": {"reputation": 11, "user_id": 4816920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yuZDZAQGbnk/AAAAAAAAAAI/AAAAAAAAA7s/gb8Htp4ZFOk/photo.jpg?sz=128", "display_name": "SharpRock", "link": "https://stackoverflow.com/users/4816920/sharprock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571849703, "creation_date": 1571849703, "question_id": 58527679, "link": "https://stackoverflow.com/questions/58527679/parsing-json-in-excel-365-without-referencing-msscript-control-32-bit", "title": "Parsing JSON in Excel 365 without referencing MSScript control 32 bit", "body": "<p>We are upgrading a legacy spreadsheet application to run in Excel 365 64 bit, win 10. The spreadsheet application interacts with a RESTful API through HTTP post, the response JSON is parsed leveraging \"MSScriptControl.ScriptControl\".</p>\n\n<p>The spreadsheet application does not run in Excel 365 64 bit because the underlying \"microsoft scripting runtime\" (scrrun.dll) is a 32 bit file and is not supported natively in Excel 365, win 10. We have looked at various solutions like <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-JSON</a> however this solution still makes use of the scripting runtime and fails. We considered also looking at alternative scripting runtimes such as <a href=\"https://github.com/tablacus/TablacusScriptControl\" rel=\"nofollow noreferrer\">https://github.com/tablacus/TablacusScriptControl</a> but we would not be able to release the new scripting runtime on client machines.</p>\n\n<p>The code below illustrates what we are currently doing in our VBA code:</p>\n\n<pre><code>    Set request = CreateObject(\"MSXML2.XMLHTTP\")\n    Set scriptControl = CreateObject(\"MSScriptControl.ScriptControl\")\n\n    request.Open \"post\", custom_url, False\n    jsonRequest = \"...\"\n    request.Send (jsonRequest)\n\n    If request.Status = 200 Then\n\n        scriptControl.Language = \"JScript\"\n        scriptControl.AddCode \"function GetPropertyValue(jsonObj, propertyName) { return jsonObj[propertyName]; } \"\n\n        Set json = scriptControl.Eval(\"(\" + request.ResponseText + \")\")\n\n    End If\n</code></pre>\n\n<p>We have searched for a simple solution online but we cannot find one. How do you parse JSON in Excel 365 VBA without having to write a custom JSON parser? Are there any MS equivalent libraries to MSScript control that can be used in Excel 365 64 bit?</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12264374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2f6b08ea4b673443ca929a2db3feaac?s=128&d=identicon&r=PG&f=1", "display_name": "DianaLV", "link": "https://stackoverflow.com/users/12264374/dianalv"}, "edited": false, "score": 0, "creation_date": 1571859507, "post_id": 58528236, "comment_id": 103383693, "body": "I did the changes you told me, but I can&#39;t make it work, I get an error message number 438, it says something like: the object does not support this property or method"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 3, "user_id": 12264374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2f6b08ea4b673443ca929a2db3feaac?s=128&d=identicon&r=PG&f=1", "display_name": "DianaLV", "link": "https://stackoverflow.com/users/12264374/dianalv"}, "edited": false, "score": 0, "creation_date": 1571860313, "post_id": 58528236, "comment_id": 103384012, "body": "What line is causing the error? BTW: this code is intended to run in MS Project, not Excel."}, {"owner": {"reputation": 3, "user_id": 12264374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2f6b08ea4b673443ca929a2db3feaac?s=128&d=identicon&r=PG&f=1", "display_name": "DianaLV", "link": "https://stackoverflow.com/users/12264374/dianalv"}, "edited": false, "score": 1, "creation_date": 1571864034, "post_id": 58528236, "comment_id": 103385548, "body": "I already make it work! Thank u so much. I think that the error was because I write the tasks in spanish, but the code recognize them only in english"}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1571860154, "last_edit_date": 1571860154, "creation_date": 1571852138, "answer_id": 58528236, "question_id": 58527541, "link": "https://stackoverflow.com/questions/58527541/how-to-get-the-value-of-a-cell-in-vba-ms-project/58528236#58528236", "title": "How to get the value of a cell in VBA MS Project", "body": "<p>To get the values of a task, use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.task\" rel=\"nofollow noreferrer\">Task</a> object. In this case you'll want to loop through all of the tasks using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.tasks(object)\" rel=\"nofollow noreferrer\">Tasks</a> object (collection of all tasks). It is unclear what task fields you need, but this should get you started:</p>\n\n<pre><code>Private Sub Avance()\n\nDim PtjR As Double\nDim PtjP As Double\nDim FechaRI As Date\nDim FechaRF As Date\nDim FechaPI As Date\nDim FechaPF As Date\nDim ListaT As String\nDim t As Task\n\nFor Each t In ActiveProject.Tasks\n\n    FechaPI = t.Start\n    FechaPF = t.Finish\n    FechaRI = IIf(t.BaselineStart = \"NA\", 0, t.BaselineStart)\n    FechaRF = IIf(t.BaselineFinish = \"NA\", 0, t.BaselineFinish)\n    PtjR = t.PercentComplete\n    PtjP = t.PhysicalPercentComplete\n\n    If PtjR &lt; PtjP Then\n\n        ListaT = ListaT &amp; vbNewLine &amp; Chr(13) &amp; \"La tarea\" &amp; \" \" &amp; t.Name &amp; \" \" &amp; \"se encuentra en DELATE, lleva\" &amp; \" \" &amp; PtjR * 100 &amp; \"% y deber\u00eda llevar\" &amp; \" \" &amp; PtjP * 100 &amp; \"%\"\n\n        If FechaPF - DateValue(Now) &lt; 0 Then\n            ListaT = ListaT &amp; \". Esta tarea debi\u00f3 terminar hace \" &amp; -(FechaPF - DateValue(Now)) &amp; \" d\u00edas.\"\n        ElseIf FechaPF - DateValue(Now) &lt;= 7 Then\n            ListaT = ListaT &amp; \". Esta tarea termina en \" &amp; FechaPF - DateValue(Now) &amp; \" d\u00edas.\"\n        End If\n\n    End If\n\nNext t\n\nMsgBox ListaT, vbCritical, \"Advertencia\"\n\nEnd Sub\n</code></pre>\n\n<p>Note that the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.task.percentcomplete\" rel=\"nofollow noreferrer\">Percent Complete</a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.task.physicalpercentcomplete\" rel=\"nofollow noreferrer\">Physical Percent Complete</a> properties return a value from 0 to 100, so don't multiply by 100 later on.</p>\n"}], "owner": {"reputation": 3, "user_id": 12264374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2f6b08ea4b673443ca929a2db3feaac?s=128&d=identicon&r=PG&f=1", "display_name": "DianaLV", "link": "https://stackoverflow.com/users/12264374/dianalv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 58528236, "answer_count": 1, "score": 0, "last_activity_date": 1571860154, "creation_date": 1571849017, "last_edit_date": 1571849063, "question_id": 58527541, "link": "https://stackoverflow.com/questions/58527541/how-to-get-the-value-of-a-cell-in-vba-ms-project", "title": "How to get the value of a cell in VBA MS Project", "body": "<p>I need a code that gives a message depending the different values of some particular cells in a Project, I have already used VBA in Excel, but never in Project, so I don\u00b4t know how to do it </p>\n\n<p>I did a code in VBA Excel that do the same thing that I need to do in Project, but I need the code but with the infomation of a Project, but the functions that I use in Excel, are not defined in Project, so I don\u00b4t know how to addecuate the code</p>\n\n<pre><code>Option Explicit\nPrivate Sub Avance()\nDim PtjR As Double\nDim PtjP As Double\nDim FechaRI As Date\nDim FechaRF As Date\nDim FechaPI As Date\nDim FechaPF As Date\nDim ListaT As String\nDim i As Integer\nDim ListaTT As String\n\n\nFor i = 3 To 40\n\n        FechaPI = Round(Cells(i, 2).Value, 2)\n        FechaPF = Cells(i, 3).Value\n        FechaRI = Cells(i, 4).Value\n        FechaRF = Cells(i, 5).Value\n        PtjR = Round(Cells(i, 6).Value, 2)\n        PtjP = Round(Cells(i, 7).Value, 2)\n\n        If PtjR &lt; PtjP Then\n\n                ListaT = ListaT &amp; vbNewLine &amp; Chr(13) &amp; \"La tarea\" &amp; \" \" &amp; Cells(i, 1).Value &amp; \" \" &amp; \"se encuentra en DELATE, lleva\" &amp; \" \" &amp; PtjR * 100 &amp; \"% y deber\u00eda llevar\" &amp; \" \" &amp; PtjP * 100 &amp; \"%\"\n\n                If FechaPF - DateValue(Now) &lt; 0 Then\n                    ListaT = ListaT &amp; \". Esta tarea debi\u00f3 terminar hace \" &amp; -(FechaPF - DateValue(Now)) &amp; \" d\u00edas.\"\n                ElseIf FechaPF - DateValue(Now) &lt;= 7 Then\n                    ListaT = ListaT &amp; \". Esta tarea termina en \" &amp; FechaPF - DateValue(Now) &amp; \" d\u00edas.\"\n                End If\n\n\n        End If\n\nNext i\n\nMsgBox ListaT, vbCritical, \"Advertencia\"\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure if the way how I get the values of the cells are the only thing that will change about the code, but knowing how to do that, will be a big help</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571848803, "post_id": 58527450, "comment_id": 103379244, "body": "Note - SO is not mean to be a code-writing service. Have you tried anything so far?"}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571849496, "post_id": 58527450, "comment_id": 103379542, "body": "Nope. I&#39;m really clueless on where to start."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1571850864, "post_id": 58527450, "comment_id": 103380111, "body": "I honestly suggest rethinking your approach if you can. This setup does not feel like the most efficient solution to your issue."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571853681, "post_id": 58527450, "comment_id": 103381303, "body": "Formulas are not going to do it for you.  This will require vba."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1571857144, "post_id": 58527450, "comment_id": 103382787, "body": "&quot;I honestly suggest rethinking your approach if you can. This setup does not feel like the most efficient solution to your issue.&quot; I can&#39;t because the &quot;data before&quot; is already in this shape and not even my work. I just need to convert them to date ranges."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572032340, "post_id": 58532440, "comment_id": 103448104, "body": "Thank you very much for your effort. I didn&#39;t have the time to test the solution thoroughly but from what I&#39;ve seen I have some trouble to make the formulas work for different starting cells. And to be sure I got this right by this &quot;Step 1: Hard-code the data up to row 8.&quot;, you mean that the data are just values, without any formulas behind them."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572032857, "post_id": 58532440, "comment_id": 103448279, "body": "To be specific about my approach to the problem, I need the outcome to be a list of names (with duplicate values for multiple day offs) with the starting and ending date beside the name. With my Excel knowledge, I can extract the dates from a row that only contains a single period of &quot;+&quot;s but not with multiple ones. If there&#39;s a better way to do it than the population of rows, like I described at the original post, please let me know."}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572034009, "post_id": 58532440, "comment_id": 103448700, "body": "To your first comment, yes, the starting data is presumed to be &quot;hard-coded&quot;, which means values without any formulas. As for a different starting row, which is obviously a must, I recommend reading carefully through the paragraph in my answer which begins with &quot;In case it isn&#39;t obvious, this can be extended to however many rows you have...&quot;. Actually, after you update the two named ranges to pick up your ~3000 rows, and on a second look, the task is a bit easier than I described it in that the two main formulas actually copy down correctly without modification."}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572034095, "post_id": 58532440, "comment_id": 103448739, "body": "Seeing as the conditional formatting step is completely optional (it just provides colors on B/M/E/N; it doesn&#39;t affect any formula results), here are some new instructions:"}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572034146, "post_id": 58532440, "comment_id": 103448757, "body": "1) Paste the provided formulas into cells A9 and B9, as instructed in my answer. 2) Let&#39;s say you have exactly 3,000 rows of data. It will start in row 3 and end in row 3,002. Since the formulas go 3 rows below the end of the data, paste cells A9:B9 into cells A3005:B3005. 3) Copy the row of 1-31 into cells B3004:AF3004 4) Paste your raw data into cells A3:AF3002 (and make sure the row of 1-31 is above that in row 2)5"}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572034896, "post_id": 58532440, "comment_id": 103449000, "body": "5) Update the two range names to cover the ranges A3:A3002 and B3:AF3002; Google how to do that if needed. 6) Copy down and across the formulas in cells A3005:B3005 as needed; this will be some number of rows fewer than 93,000. 7) Once those formulas cover the correct range of rows, skip one more row, paste that whole range in as values (just to have content) but put in two new formulas: For the column, the values are correct (or you can put in =Bx where x is the starting row of the formula section above it). For the data =IF(Bx=&quot;M&quot;,&quot;+&quot;,&quot;&quot;). That should do it for you!"}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572089678, "post_id": 58532440, "comment_id": 103457836, "body": "I got it to work for a small example like yours and it works like a charm. Can this work when there are duplicate names in column A?"}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 1, "creation_date": 1572094668, "post_id": 58532440, "comment_id": 103458842, "body": "Yes! I got to work for the whole project. Thank you SO much!"}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1572276719, "post_id": 58532440, "comment_id": 103500617, "body": "Glad it worked for yout! I&#39;d much appreciate it if you would mark my answer as accepted. It will not work for duplicate names because the original data row to match would be ambiguous."}], "tags": [], "owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "is_accepted": true, "score": 0, "last_activity_date": 1571933860, "last_edit_date": 1571933860, "creation_date": 1571875653, "answer_id": 58532440, "question_id": 58527450, "link": "https://stackoverflow.com/questions/58527450/populate-rows-based-on-calendar-like-data/58532440#58532440", "title": "Populate rows based on calendar-like data", "body": "<p>Let me preface this answer by saying that I, too, do not think is an efficient, let alone the <em>most</em> efficient, approach to this problem, and it certainly isn't straightforward. I should put it more strongly than that, though, lest there be confusion: This is NOT a good way to solve this problem! With that out of the way, I could not resist this challenge.</p>\n\n<p>I will try to post enough details for you to replicate my Excel file.</p>\n\n<p>In case it isn't obvious, this can be extended to however many rows you have in your original table of employees with the \"+\"'s. You would start by putting in the original table. Then, update the two range names shown below to pick up all of your employees and all of your data. Skip a row, paste in the row of '1' through '31', and then paste in the two main formulas (i.e., the ones that start in cells <strong>A9</strong> and <strong>B9</strong>) in the row below that, making sure to replace any references to rows 8 and 9 with the newly applicable start rows, then drag down to as many rows as you need to pick up the pluses through the last row of original data! Add conditional formatting afterwards on the whole range if you want to see the color scheme for B/M/E/N (beginning, middle, end, next) appear automatically (optional step). Then, make an identically-sized section below the B/M/E/N section to put in your \"If 'M' then '+' else blank\" formula.</p>\n\n<p>Here is a screenshot of the grid from the example file I created:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tBc2D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tBc2D.png\" alt=\"enter image description here\"></a></p>\n\n<p>You'll need to create the following named ranges:</p>\n\n<p><a href=\"https://i.stack.imgur.com/srW7P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/srW7P.png\" alt=\"enter image description here\"></a></p>\n\n<p>Optionally, if you want to see the colors in the picture appear automatically, you can create the following conditional formatting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JLZJp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JLZJp.png\" alt=\"enter image description here\"></a></p>\n\n<p>(You might find it easier to put in the conditional formatting after putting in the formulas, but if you want to put it in beforehand, make sure you paste special formulas only in that section)</p>\n\n<p>Now, with the named ranges in place, here is what to put in the worksheet grid:</p>\n\n<p><strong>Step 1:</strong> Hard-code the data up to row 8.</p>\n\n<p><strong>Step 2:</strong> Enter the following formula in cell <strong>A9</strong> and drag down to cell <strong>A22</strong></p>\n\n<pre><code>=IF(B8=1,INDEX(rngEmps,1),IF(COUNTIF(OFFSET(rngData,MATCH(A8,rngEmps,0)-1,,1,),\"+\")=COUNTIF(OFFSET($B$8:$AF8,MATCH(A8,$A$8:$A8,0)-1,,COUNTA($A$8:$A8)+COUNTBLANK($A$8:$A8)-(MATCH(A8,$A$8:$A8,0)-1),),\"M\"),INDEX(rngEmps,MATCH(A8,rngEmps,0)+1),A8))\n</code></pre>\n\n<p><strong>Step 3:</strong> Enter the following formula in cell <strong>B9</strong> and drag right and down to cell <strong>AF22</strong></p>\n\n<pre><code>=IF($A9=$A8,IF(OR(B8=\"B\",B8=\"M\"),\"B\",IF(B8=\"E\",IF(A9=\"B\",\"B\",\"E\"),IF(OR(A9=\"B\",A9=\"M\"),\"M\",\"N\"))),IF(B$2=1,IF(INDEX(rngData,MATCH($A9,rngEmps,0),1)=\"+\",\"M\",\"B\"),IF(INDEX(OFFSET(rngData,MATCH($A9,rngEmps,0)-1,,1),1,B$8)=\"+\",IF(OR(A9=\"E\",A9=\"N\"),\"N\",\"M\"),IF(A9=\"B\",\"B\",\"E\"))))\n</code></pre>\n\n<p>Let me know if you get stuck on this anywhere, Ragnar. Also, I'm guessing you can recreate the bottom section with the \"+\"'s.</p>\n\n<p><strong>UPDATE/EDIT:</strong> There was previously a slight bug in the main (cell A9) formula that I posted last night (10/23/2019) in that it didn't correctly handle the first column being \"+\"; that should be fixed now. Also, in general, I have not taken the time to thoroughly optimize these formulas (e.g., minimize repeated work as much as possible, ensure the ideal order of arranging IF statements, etc.). This is meant to be more of a proof of concept. Please post a comment if you find a bug in my solution. Thanks!</p>\n"}], "owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 58532440, "answer_count": 1, "score": 1, "last_activity_date": 1571933860, "creation_date": 1571848655, "last_edit_date": 1571897867, "question_id": 58527450, "link": "https://stackoverflow.com/questions/58527450/populate-rows-based-on-calendar-like-data", "title": "Populate rows based on calendar-like data", "body": "<p>In Excel, I have a table of employees/dates in which employees are at the vertical axis and dates at the horizontal. The table has data about the employees' day offs and vacations shown as \"+\".</p>\n\n<p>I need something that will populate the same name to multiple rows based on how many times the sequence of \"+\" starts and will return at each row the day-offs that are together, as shown:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KUG4A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KUG4A.png\" alt=\"enter image description here\"></a></p>\n\n<p>Coloring is only for understanding purposes. All cells are with \"No fill\".\nThis needs to be done to a massive database of 3000 people.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 0, "creation_date": 1571848573, "post_id": 58527385, "comment_id": 103379131, "body": "Where are the issues in your existing code?"}, {"owner": {"reputation": 1, "user_id": 12264296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea2aa5cba8d1589b200eebf77575e56?s=128&d=identicon&r=PG&f=1", "display_name": "gabrielalina", "link": "https://stackoverflow.com/users/12264296/gabrielalina"}, "reply_to_user": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 0, "creation_date": 1571848698, "post_id": 58527385, "comment_id": 103379193, "body": "i am a begginer in vba and i don&#39;t know how to produce this code"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 0, "creation_date": 1571940139, "post_id": 58527385, "comment_id": 103414634, "body": "To update on this- it&#39;s rare to find people willing to write code for free based on a list of requirements.  Your best bet is making an attempt, no matter how &quot;beginner&quot;, it might seem. Hopefully everyone learns in the process.  There are some decent guides on asking questions around the site- <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "owner": {"reputation": 1, "user_id": 12264296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea2aa5cba8d1589b200eebf77575e56?s=128&d=identicon&r=PG&f=1", "display_name": "gabrielalina", "link": "https://stackoverflow.com/users/12264296/gabrielalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571849853, "creation_date": 1571848383, "last_edit_date": 1571849853, "question_id": 58527385, "link": "https://stackoverflow.com/questions/58527385/how-can-i-changereplace-the-the-name-of-a-message-with-the-name-of-a-pdf-file", "title": "How can i change(replace) the the name of a message with the name of a pdf file?", "body": "<p>I send messages through an application named Hermes, the title of the messages are the same all the time, but each message contain an different pdf file.\nEvery  pdf file has a different name for each message .\nAfter I sent the message I save all the messages in an local archive and then i  take  the name of the pdf file and to put it in the name of the message (every day for a 20-30 messages)</p>\n\n<p>How can i change (replace)  the name of an message with the name of pdf file ?</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1571850962, "post_id": 58527055, "comment_id": 103380160, "body": "It looks to me like an Excel object model deficiency. I was able to record this in Word and it runs successfuly: ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:=&quot;<a href=\"http://brandwares.com/\" rel=\"nofollow noreferrer\">brandwares.com</a>&quot;, SubAddress:=&quot;&quot; But the analogous line in Excel returns only Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method."}], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1571846963, "creation_date": 1571846963, "question_id": 58527055, "link": "https://stackoverflow.com/questions/58527055/add-a-hyperlink-to-a-smartart-node", "title": "Add a Hyperlink to a SmartArt Node", "body": "<p>In the Excel (also PowerPoint and Word) user interface it's possible to assign a hyperlink to a SmartArt node, or text in a node:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PtaSQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PtaSQ.png\" alt=\"Add hyperlink to SmartArt in UI\"></a></p>\n\n<p>Recording these steps in a macro yields an empty procedure.</p>\n\n<p>Trying to use logic with the object model yields no useful result (see code below). I tried the following three approaches:</p>\n\n<ol>\n<li>A <code>SmartArtNode</code> has a <code>Shapes</code> property and one can extract a <code>Shape</code> object... But the type belongs to the Office object model (<code>Office.Shape</code>) and cannot be coerced (that I can find) to an <code>Excel.Shape</code> (nor to a <code>PowerPoint.Shape</code>). Trying to assign it to an <code>Excel.Shape</code> - <code>Set xlShape = nd1.Shapes(1)</code> - results in</li>\n</ol>\n\n<blockquote>\n  <p>Run-time error '13' \n  Type mismatch</p>\n</blockquote>\n\n<ol start=\"2\">\n<li>Trying to add a hyperlink to the <code>Office.Shape</code> results in</li>\n</ol>\n\n<blockquote>\n  <p>Run-time error -2147417848 (80010108)</p>\n  \n  <p>Automation error<br>\n  The object invoked has disconnected from its clients.</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>Then I tried selecting the node and adding the hyperlink to <code>Application.Selection</code> (<code>TypeName(Application.Selection)</code> returns <code>Shape</code>) which returned</li>\n</ol>\n\n<blockquote>\n  <p>Run-time error 1004<br>\n   Application-defined or object-defined error</p>\n</blockquote>\n\n<p>How does one add a hyperlink to a SmartArt node?</p>\n\n<pre><code>Sub AddHyperlinkToSmartArtNode()\n  Dim sa As SmartArt\n  Dim ws As Worksheet\n  Dim nd1 As SmartArtNode\n  Dim shp As Office.Shape\n  Dim shpx\n  Dim rng As TextRange2\n\n  Set ws = ActiveSheet\n  Set sa = ws.Shapes(1).SmartArt\n  Set nd1 = sa.Nodes(1)\n\n  'Dim xlShape As Excel.Shape\n  'Set xlShape = nd1.Shapes(1)\n  'Run-time error '13'\n  'Type mismatch\n\n  Set shp = nd1.Shapes(1)\n\n  'ws.Hyperlinks.Add shp, \"www.google.com\"\n  'Run-time error -2147417848 (80010108)\n  'Automation error\n  'The object invoked has disconnected from its clients.\n\n  Set rng = shp.TextFrame2.TextRange\n  rng.Select\n  Set shpx = Application.Selection\n  ws.Hyperlinks.Add shpx, \"www.google.com\"\n  'Run-time error 1004\n  'Application-defined or object-defined error\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "edited": false, "score": 0, "creation_date": 1571846936, "post_id": 58527019, "comment_id": 103378341, "body": "Sub copypaste() Dim lastrow As Integer, erow As Integer, sheet1 As Worksheet, sheet2 As Worksheet  Set sheet1 = Worksheets(&quot;Sheet1&quot;) Set sheet2 = Worksheets(&quot;Sheet2&quot;) lastrow = sheet1.Cells(Rows.Count, 1).End(xlUp).Row  For i = 2 To lastrow     erow = sheet2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row     sheet2.Cells(erow, 2) = sheet1.Cells(i, 3)     sheet2.Cells(erow, 3) = sheet1.Cells(i, 6)     sheet2.Cells(erow, 4) = sheet1.Cells(i, 9) Next i  &#39;ThisWorkbook.Worksheets(&quot;Sheet2&quot;).Columns().AutoFit &#39;sheet1.Cells(1, 1).Activate End Sub"}, {"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "edited": false, "score": 0, "creation_date": 1571846945, "post_id": 58527019, "comment_id": 103378348, "body": "Sub copypaste1() Dim lastrow As Integer, erow As Integer, sheet5 As Worksheet, sheet2 As Worksheet  Set sheet5 = Worksheets(&quot;sheet5&quot;) Set sheet2 = Worksheets(&quot;Sheet2&quot;) lastrow = sheet5.Cells(Rows.Count, 1).End(xlUp).Row  For i = 2 To lastrow     erow = sheet2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row     sheet2.Cells(erow, 2) = sheet5.Cells(i, 3)     sheet2.Cells(erow, 3) = sheet5.Cells(i, 6)     sheet2.Cells(erow, 4) = sheet5.Cells(i, 9) Next i  &#39;ThisWorkbook.Worksheets(&quot;Sheet2&quot;).Columns().AutoFit &#39;sheet1.Cells(1, 1).Activate End Sub"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1571846951, "post_id": 58527019, "comment_id": 103378354, "body": "Please <a href=\"https://stackoverflow.com/posts/58527019/edit\">edit</a> your question with the code (as text)."}, {"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571846959, "post_id": 58527019, "comment_id": 103378361, "body": "Am using above codes which is not helping me"}, {"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571847119, "post_id": 58527019, "comment_id": 103378432, "body": "Separate sheet name should be &quot;JOhn&quot;,&quot;Alex&quot;,&quot;france&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1571897596, "post_id": 58527019, "comment_id": 103393117, "body": "@Basavarajk.s. Code in comments is usless because it is not readable. Line breaks matter in VBA code but in comments you cannot see them. Please <a href=\"https://stackoverflow.com/posts/58527019/edit\">edit</a> your original question and add the code there. Format it correctly as codeblock using the buttons in the toolbar of the editor or ctrl + K."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1572525869, "creation_date": 1572525869, "answer_id": 58643639, "question_id": 58527019, "link": "https://stackoverflow.com/questions/58527019/copy-paste-from-multiple-sheet-to-one-sheet-only-required-multiple-columns-and/58643639#58643639", "title": "Copy paste from multiple sheet to one sheet ( only required multiple columns and set auto filter on consolidated sheet and seprate)", "body": "<pre><code>Sub CopyDataWithoutHeaders()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim shLast As Long\n    Dim CopyRng As Range\n    Dim StartRow As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"RDBMergeSheet\" if it exist\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"RDBMergeSheet\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"RDBMergeSheet\"\n\n    'Fill in the start row\n    StartRow = 2\n\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            'Find the last row with data on the DestSh and sh\n            Last = LastRow(DestSh)\n            shLast = LastRow(sh)\n\n            'If sh is not empty and if the last row &gt;= StartRow copy the CopyRng\n            If shLast &gt; 0 And shLast &gt;= StartRow Then\n\n                'Set the range that you want to copy\n                Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n\n                'Test if there enough rows in the DestSh to copy all the data\n                If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                    MsgBox \"There are not enough rows in the Destsh\"\n                    GoTo ExitTheSub\n                End If\n\n                'This example copies values/formats, if you only want to copy the\n                'values or want to copy everything look below example 1 on this page\n                CopyRng.Copy\n                With DestSh.Cells(Last + 1, \"A\")\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                End With\n\n            End If\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>See the link below for more details.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win002.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win002.htm</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1572525869, "creation_date": 1571846863, "last_edit_date": 1571910667, "question_id": 58527019, "link": "https://stackoverflow.com/questions/58527019/copy-paste-from-multiple-sheet-to-one-sheet-only-required-multiple-columns-and", "title": "Copy paste from multiple sheet to one sheet ( only required multiple columns and set auto filter on consolidated sheet and seprate)", "body": "<p>I have three sheets (Sheet1,sheet2 and sheet5)Need to copy from sheet1 column \"A\",\"B\",\"E\"paste to \"Sheet5 \"c\",\"G\",\"H\" and copy from sheet2 column \"J\",\"K\", \"N\" paste to \" Sheet5 \"c\",\"G\",\"H\" (should not overwrite) and Sheet5 i have first three rows are my headers under this it should paste Sheet5 column \"G\" which has data from sheet1 and sheet2:Need to seperate using autofilter for the specific text \"JOhn\",\"Alex\",\"france\" only.Separate sheet name should be \"JOhn\",\"Alex\",\"france\".Need your help on the code:I have tried on below code which is not working for my requirement and am not able to edit because of more conditions( I got from google ) Sub copypaste() Dim lastrow As Integer, erow As Integer, sheet1 As Worksheet, sheet2 As Worksheet Set sheet1 = Worksheets(\"Sheet1\") Set sheet2 = Worksheets(\"Sheet2\") lastrow = sheet1.Cells(Rows.Count, 1).End(xlUp).Row For i = 2 To lastrow erow = sheet2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row sheet2.Cells(erow, 2) = sheet1.Cells(i, 3) sheet2.Cells(erow, 3) = sheet1.Cells(i, 6) sheet2.Cells(erow, 4) = sheet1.Cells(i, 9) Next i End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571845653, "post_id": 58526397, "comment_id": 103377708, "body": "You can&#39;t. Applying a filter changes the worksheet, that&#39;s just how it is. Merely <i>activating/selecting a worksheet</i> marks the workbook as &quot;dirty&quot;. What does it matter though, if you&#39;re closing it <i>without saving changes</i>?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571845769, "post_id": 58526397, "comment_id": 103377754, "body": "I don&#39;t see where you are applying the filter in your code? If you haven&#39;t applied any filters, all cells in your range will be visible"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571845903, "post_id": 58526397, "comment_id": 103377826, "body": "Adding to @MathieuGuindon comments, just because your worksheet is <b>dirty</b> doesn&#39;t necessarily means that the data in the sheet has changed. Filter just hides some rows (as applicable), it doesn&#39;t mean that you have lost the data"}, {"owner": {"reputation": 1, "user_id": 12264034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811a6750ffbf9f0e9a6c27047fae0f5a?s=128&d=identicon&r=PG&f=1", "display_name": "Heath Norris", "link": "https://stackoverflow.com/users/12264034/heath-norris"}, "edited": false, "score": 0, "creation_date": 1571866262, "post_id": 58526397, "comment_id": 103386276, "body": "I left the macro with the filter out of the question...I didn&#39;t want the field to be too busy so I just included the macro that copies to the email. That makes sense about applying a filter and the spreadsheet being modified regardless. I guess what I need to do instead is instead of copying all the rows to the email body, just the rows that match required criteria. I am trying to keep the original spreadsheet from being modified so it can be a template. I would like to use this same spreadsheet the next time I place an order but it may have different quantities and different particular items."}], "owner": {"reputation": 1, "user_id": 12264034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811a6750ffbf9f0e9a6c27047fae0f5a?s=128&d=identicon&r=PG&f=1", "display_name": "Heath Norris", "link": "https://stackoverflow.com/users/12264034/heath-norris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571845687, "creation_date": 1571844756, "last_edit_date": 1571845687, "question_id": 58526397, "link": "https://stackoverflow.com/questions/58526397/copying-certain-rows-to-an-email-based-on-criteria-while-leaving-the-original-wo", "title": "Copying Certain Rows to an Email Based on Criteria While Leaving the Original Worksheet Unmodified", "body": "<p>I have a spreadsheet used for ordering materials with multiple suppliers. When I have rows expressing a quantity needed, I would like to have a button to run a macro that copies only the rows with quantities and for a certain manufacturer to be copied to the body of an Outlook email without modifying the spreadsheet.</p>\n\n<p>I have an object button that runs a macro that will copy all the visible cells from the spreadsheet to the email body. When I apply a filter to the range it modifies the spreadsheet.</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n\n    Application.ReferenceStyle = xlA1\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set rng = Nothing\n    On Error Resume Next\n\n    Set rng = Sheets(\"Sheet1\").Range(\"C4:F20\").SpecialCells(xlCellTypeVisible)\n\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Order to be Placed\"\n        .HTMLBody = RangetoHTML(rng)\n        .Display\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n\n    TempWB.Close savechanges:=False\n\n\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n\n<p>This macro works except it puts all of the visible cells in the email. When I apply a filter it modifies the spreadsheet. I tried the following:</p>\n\n<pre><code>Set rng = Sheets(\"Sheet1\").Range(\"F5:F19\")\nFor Each cell In rng\nIf cell.Value = \"anixter\" Then\n    cell.EntireRow.Copy\n</code></pre>\n\n<p>This just hangs the process.</p>\n"}, {"tags": ["javascript", "html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571848375, "post_id": 58526138, "comment_id": 103379046, "body": "Looks like the <code>querySelector</code> argument is malformed in the first attempt, and well-formed but returning an array (?) in the second one; assuming <code>querySelector</code> returns an array, then you need to pick a subscript to invoke the <code>Click</code> member against, e.g. <code>ie.document.querySelector(&quot;div[data-bind*=&#39;0274 AP INVOICES SAP&#39;]&quot;)(0).Click</code>"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1571881758, "last_edit_date": 1571881758, "creation_date": 1571881249, "answer_id": 58532998, "question_id": 58526138, "link": "https://stackoverflow.com/questions/58526138/navigate-to-a-tab-of-a-website-based-on-title-name-in-vba/58532998#58532998", "title": "Navigate to a tab of a website based on title name in VBA", "body": "<p>You have half the answer (syntax wise) in each of your two lines.</p>\n\n<p>You need</p>\n\n<pre><code>ie.document.querySelector(\"[title='0274 AP INVOICES SAP']\").click\n</code></pre>\n\n<p>Assuming a proper page load wait has happened before and that this title = value combination is either unique and/or you want the first; that it is not dynamic and that it is the correct target for the click event.</p>\n\n<p>Due to the spaces in the value string you need to use single quotes around the it. Also, after the attribute selector you should not be using class selectors which aren't part of the target element.</p>\n\n<p>If you continue to get a JScriptTypeInfo error, which I have seen before with pages using <code>knockoutjs</code>, you need to either resort to MS ScriptControl and a lot more code (on a 32 bit system) - which I don't recommend, or switch to using a getElement(s) by method where this problem shouldn't occur. You are ending up with an array like object that VBA is calling JSCriptTypeInfo and if you inspect it you will mostly likely see a string denoting an array of objects (nodes) which come, I suspect, from a default member call.</p>\n"}], "owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571881758, "creation_date": 1571843906, "question_id": 58526138, "link": "https://stackoverflow.com/questions/58526138/navigate-to-a-tab-of-a-website-based-on-title-name-in-vba", "title": "Navigate to a tab of a website based on title name in VBA", "body": "<p>I am trying to navigate to another tab shown in the html code below from my current tab in VBA.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div title=\"0274 AP INVOICES SAP\" data-bind=\"text: Name, attr: { title: Name }\"&gt;0274 AP INVOICES SAP&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I tried the following:</p>\n\n<pre><code>ie.document.querySelector(\"[title*=AP INVOICES SAP].menu-row active-route\").Click\n</code></pre>\n\n<p>but this gave me the \"Method 'querySelector' of object 'JScriptTypeInfo' failed\" error, and I also tried the following:</p>\n\n<pre><code>ie.document.querySelector(\"div[data-bind*='0274 AP INVOICES SAP']\").Click\n</code></pre>\n\n<p>but this gave me the \"Object required\" error.</p>\n\n<p>What should I do to navigate to this tab properly? Please let me know if you need more information</p>\n"}, {"tags": ["excel", "vba", "text-to-column"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1571844050, "post_id": 58526136, "comment_id": 103376867, "body": "Why would you do the text to columns here? Dates and time are numbers for excels. Dates are integers and time are floating numbers for the date... so if you want to only show de date and not by format, Roundown the numbers for every date leaving only the date without time."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1571844202, "post_id": 58526136, "comment_id": 103376953, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26119089/vba-text-to-columns-reading-date-format-as-us\">VBA Text-To-Columns Reading Date Format As US</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571844661, "post_id": 58526136, "comment_id": 103377198, "body": "Looks like you&#39;re trying to split at the space? Yet you have <code>Comma:=True, Space:=False</code>. Have you tried <code>Comma:=False, Space:=True</code>? That said, seems all that&#39;s needed is to parse the date string into a <code>Date</code> value, overwrite the string with the <code>Date</code>, and then use number formatting to remove the time portion."}], "answers": [{"tags": [], "owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1572358981, "creation_date": 1572358981, "answer_id": 58609358, "question_id": 58526136, "link": "https://stackoverflow.com/questions/58526136/vba-texttocolumns-date-format/58609358#58609358", "title": "VBA TextToColumns - Date format", "body": "<p>Currently you have it set to split on commas instead of spaces which would explain why nothing is getting separated.</p>\n\n<p>When it does split you are given four columns of data and so I've written some code that will create and delete temporary columns to protect and data you might have in the cells to the right.</p>\n\n<p>The format of the output column is also set to general so it defaults to date and doesn't show a blank time at the end.</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n    .Columns(\"B\").NumberFormat = \"General\"\n    .Columns(\"C:E\").Insert Shift:=xlToRight\n    .Columns(\"A\").TextToColumns Destination:=.Columns(\"B\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n        Semicolon:=False, Comma:=False, Space:=True, Other:=False, DecimalSeparator:=\".\"\n    .Columns(\"C:E\").Delete\nEnd With\n</code></pre>\n\n<p>If you need any help with it or a further explanation just leave a comment and I'll get back to you.</p>\n"}], "owner": {"reputation": 23, "user_id": 11199745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d6947521278804418879f4d5ea4a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hanna", "link": "https://stackoverflow.com/users/11199745/hanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572358981, "creation_date": 1571843904, "last_edit_date": 1571897858, "question_id": 58526136, "link": "https://stackoverflow.com/questions/58526136/vba-texttocolumns-date-format", "title": "VBA TextToColumns - Date format", "body": "<p>I have a problem with macro TextToColumns: I have two date formats, one with 01:00 at the end and the other with 03:00 at the end, for example:</p>\n\n<p>14/10/2019 03:00</p>\n\n<p>08/06/2019 01:00</p>\n\n<p>When I run macro:</p>\n\n<pre><code>    Worksheet.Columns(\"A:A\").TextToColumns Destination:=Worksheet.Range(\"A1\"), DataType:=xlDelimited, _\n            TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n            Semicolon:=False, Comma:=True, Space:=False, Other:=False, DecimalSeparator:=\".\"\n</code></pre>\n\n<p>I have results: \n<img src=\"https://i.stack.imgur.com/4h3IY.png\" alt=\"results\"></p>\n\n<p>I need to have all the data in format like the bottom one, but I can't do it for example by number -> format -> custom.</p>\n\n<p>I would really appreciate if you have any ideas what is wrong with my macro?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 11898285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yILbeumWayI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2Wm7vl_c_Ce0u2RhSD_DTCVedmQ/photo.jpg?sz=128", "display_name": "Digit Pres", "link": "https://stackoverflow.com/users/11898285/digit-pres"}, "is_accepted": true, "score": 0, "last_activity_date": 1572026102, "creation_date": 1572026102, "answer_id": 58563463, "question_id": 58526007, "link": "https://stackoverflow.com/questions/58526007/record-continuously-changing-data-from-one-sheet-to-another-sheet-of-excel-throu/58563463#58563463", "title": "Record continuously changing data from one sheet to another sheet of Excel through VBA code", "body": "<pre><code>  Dim NextTime As Double\n  Sub RecordData()\n  Dim Interval As Double\n  Dim cel As Range, Capture As Range\n  Interval = 5    'Number of seconds between each recording of data\n  Set Capture = Worksheets(\"Sheet1\").Range(\"A3:C4\") 'Capture this column of data\n  With Worksheets(\"Sheet2\")   'Record the data on this worksheet\n  Set cel = .Range(\"A2\")  'First timestamp goes here\n  Set cel = .Cells(.Rows.Count, cel.Column).End(xlUp).Offset(1, 0)\n  cel.Resize(Capture.Rows.Count).Value = Now\n\n  cel.Offset(0, 1).Resize(Capture.Rows.Count, Capture.Columns.Count).Value = \n  Capture.Value\n\n  End With\n\n  NextTime = Now + Interval / 86400\n  Application.OnTime NextTime, \"RecordData\"\n  End Sub\n\nSub StopRecordingData()\nOn Error Resume Next\nApplication.OnTime NextTime, \"RecordData\", , False\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11898285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yILbeumWayI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2Wm7vl_c_Ce0u2RhSD_DTCVedmQ/photo.jpg?sz=128", "display_name": "Digit Pres", "link": "https://stackoverflow.com/users/11898285/digit-pres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 58563463, "answer_count": 1, "score": -1, "last_activity_date": 1572026102, "creation_date": 1571843517, "last_edit_date": 1571843779, "question_id": 58526007, "link": "https://stackoverflow.com/questions/58526007/record-continuously-changing-data-from-one-sheet-to-another-sheet-of-excel-throu", "title": "Record continuously changing data from one sheet to another sheet of Excel through VBA code", "body": "<p><a href=\"https://i.stack.imgur.com/p3P13.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p3P13.jpg\" alt=\"Please look at the image for what problem I faced in the code\"></a></p>\n\n<p>My code works fine to record the data to another sheet but not as per my requirement.  </p>\n\n<pre><code>Dim NextTime As Double\nSub RecordData()\nDim Interval As Double\nDim cel As Range, Capture As Range\nInterval = 5    'Number of seconds between each recording of data\nSet Capture = Worksheets(\"Sheet2\").Range(\"A3:C4\") 'Capture this column of data\nWith Worksheets(\"Sheet1\")   'Record the data on this worksheet\nSet cel = .Range(\"A2\")  'First timestamp goes here\nSet cel = .Cells(.Rows.Count, cel.Column).End(xlUp).Offset(1, 0)\ncel.Value = Now\n\ncel.Offset(0, 1).Resize(1, Capture.Cells.Count).Value = Capture.Value\n\nEnd With\n\nNextTime = Now + Interval / 86400\nApplication.OnTime NextTime, \"RecordData\"\nEnd Sub\n\nSub StopRecordingData()\nOn Error Resume Next\nApplication.OnTime NextTime, \"RecordData\", , False\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1571843609, "post_id": 58525944, "comment_id": 103376630, "body": "Using <code>EntireColumn</code> will select all the cells in the column, no matter the row you put.  Instead, adjust that to be a range, e.g. ` Set R = Range(Cells(2,2),Cells(lastRow,2))`"}, {"owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1571843827, "post_id": 58525944, "comment_id": 103376745, "body": "@BruceWayne I added that in, and now it&#39;s not hiding any columns"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1571877502, "post_id": 58525944, "comment_id": 103388749, "body": "I&#39;m not positive if it&#39;s affecting anything but I&#39;d actually add <i>something</i> in the first <code>Case</code>, even just <code>debug.print &quot;This is 9 to 14&quot;</code>. I&#39;ll review the rest and get back to you."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1571927542, "post_id": 58525944, "comment_id": 103408630, "body": "Can you show an example of the column(s) that have a merged header?"}], "owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571843422, "creation_date": 1571843299, "last_edit_date": 1571843422, "question_id": 58525944, "link": "https://stackoverflow.com/questions/58525944/how-to-omit-merged-rows-in-if-statement-counta-criteria", "title": "How to omit merged rows in IF Statement CountA criteria?", "body": "<p>I have a CASE statement that omits a block of columns, and then n IF statement that hides columns if worksheetfunction.COUNTA &lt; 2. I pretty much just wanted to hide columns with only headers, and no values in the column. Thing is, there is a block of columns (\"P:U\") that have a merged overarching header in row 1, while the regular headers are in row 2, data starts on row 3. </p>\n\n<p>I tried to adjust <code>Set R = Cells(1,i).EntireColumn</code> to <code>Set R = Cells(2,i).EntireColumn</code> so that way it'd only apply the IF statement from the 2nd row--down, but that's not working correctly. The statement still shows one column from columns P:U  because of the merged cells in row 1. </p>\n\n<pre><code>Option Explicit\n    Sub ColumnHider()\n\n        Dim wf As WorksheetFunction\n        Dim i As Long, R As Range\n\n        Set wf = Application.WorksheetFunction\n\n        For i = 1 To 44\n\n            Select Case i\n\n            Case 9 To 14\n\n            Case Else\n\n                Set R = Cells(2, i).EntireColumn &lt;---problem area\n\n                If wf.CountA(R) &lt; 2 Then R.Hidden = True\n\n            End Select\n\n        Next i\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "multidimensional-array"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571842671, "post_id": 58525670, "comment_id": 103376127, "body": "There is no redim line in your code."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571842746, "post_id": 58525670, "comment_id": 103376180, "body": "If you <code>ReDim Preserve</code>, you can resize only the last array dimension."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571842873, "post_id": 58525670, "comment_id": 103376245, "body": "@BigBen - You mean if my array has two dimensions, e.g. twod_array(1,2) I can only resize the last one (e.g. 2 in this instance)?   I really only need to resize the first dimension. Is there a way to do this? Or must I swap the order I add elements to my array?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571843002, "post_id": 58525670, "comment_id": 103376306, "body": "See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/redim-statement\" rel=\"nofollow noreferrer\"><code>ReDim</code></a> docs. Em - maybe you just want a jagged array? What are you trying to do?"}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571843193, "post_id": 58525670, "comment_id": 103376394, "body": "@BigBen - I want to capture data from multiple arrays and sort the results before spitting an output to a new worksheet. I think knowing the limitation I can just change the order I add my values to the 2D array so the size of the last dimension can be changed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1571843343, "post_id": 58525670, "comment_id": 103376492, "body": "FWIW resizing an array by +1 at each iteration is terribly inefficient. If you know how many elements you&#39;re going to need, size the array up front."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571843500, "post_id": 58525670, "comment_id": 103376570, "body": "That&#39;s the problem... I wont know how many elements I have until  I analyze each cell in the workbook which may produce arrays of different sizes. That&#39;s why I have to keep resizing the 2D array by 1 until I&#39;m ready to take the values it stores and output it into a new spreadsheet."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571843661, "post_id": 58525670, "comment_id": 103376646, "body": "How are you analyzing each cell? Hopefully by reading the values into an array first?"}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571843954, "post_id": 58525670, "comment_id": 103376821, "body": "@BigBen - I first loop through a range in a spreadsheet. Then if a cell contains a comma separated list of entries, I split those entries by a comma to create sub-arrays. Every time I have a unique combination of sub-arrays, I increment a counter which corresponds to a new row in a new worksheet. A concatenation of values from various columns are added to the 2D array in the form twod_array(x,y) where one variable represents the count e.g. row in the new worksheet and one represents the column (will be fixed)."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571844133, "post_id": 58525670, "comment_id": 103376915, "body": "I changed my twod_array to have the dimension that changes last, but even when I ReDim Preserve I only get the output of the first row e.g. twod_array(0, 0) to twod_array(6, 0)  and not the others   Where the first dimension corresponds to the column number and second dimension corresponds to the row number which I swapped around because the second dimension size in the array will change based on when I determine more rows should be added."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571847888, "post_id": 58525670, "comment_id": 103378796, "body": "edited my post for clarity :)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1571863708, "post_id": 58525670, "comment_id": 103385425, "body": "Collect your array elements into Collection or Dictionary objects. Then you will know the size of the necessary array and can populate it without all the ReDim overhead."}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571854117, "post_id": 58528548, "comment_id": 103381473, "body": "It&#39;s not quite what I&#39;m looking for. Because the size of each array could be different and I want to iterate through all elements of each one.  Do you know why I can&#39;t ReDim inside the loop based on my counter?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571895191, "post_id": 58528548, "comment_id": 103392346, "body": "Your question didn&#39;t speak about array with different sizes. You may want to reword it as per your real needs and add some meaningful examples, too"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1571853421, "creation_date": 1571853421, "answer_id": 58528548, "question_id": 58525670, "link": "https://stackoverflow.com/questions/58525670/only-first-element-in-2d-array-is-being-returned-incorrect-usage-of-redim/58528548#58528548", "title": "Only first element in 2D array is being returned - incorrect usage of ReDim?", "body": "<p>maybe you're after this:</p>\n\n<pre><code>Option Explicit\n\nSub arrays()\n\n    Dim arrayOne As Variant, arrayTwo As Variant\n    arrayOne = Array(1, 2, 3)\n    arrayTwo = Array(4, 5, 6)\n\n    Dim i As Long\n    ReDim twod_array(1, UBound(arrayOne)) As Variant ' array sizing\n    For i = 0 To UBound(arrayOne)\n        twod_array(0, i) = arrayOne(i)\n        twod_array(1, i) = arrayTwo(i)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>which outputs your desired output:</p>\n\n<pre><code>twod_array(0,0) = 1\ntwod_array(1,0) = 4\n</code></pre>\n\n<p>and</p>\n\n<pre><code>twod_array(0,1) = 2\ntwod_array(1,1) = 5\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58528548, "answer_count": 1, "score": 0, "last_activity_date": 1571856459, "creation_date": 1571842476, "last_edit_date": 1571856459, "question_id": 58525670, "link": "https://stackoverflow.com/questions/58525670/only-first-element-in-2d-array-is-being-returned-incorrect-usage-of-redim", "title": "Only first element in 2D array is being returned - incorrect usage of ReDim?", "body": "<p>I have a 2D array:</p>\n\n<pre><code>Dim twod_array() As Variant\n</code></pre>\n\n<p>Which I want to store values from two other arrays: e.g.:</p>\n\n<pre><code>Dim arrayone As Variant\narrayone = (1, 2, 3)\nDim arraytwo As Variant\narraytwo = (4, 5, 6)\n</code></pre>\n\n<p>I want to loop through each element of the above arrays and add them in the below manner:</p>\n\n<pre><code>Dim count As Long\ncount = 0\nReDim Preserve twod_array(1,0) // initial sizing\nfor i = 0 To UBound(arrayone)\n    for j = 0 To UBound(arraytwo)\n        twod_array(0,count) = arrayone(i) \n        twod_array(1,count) = arraytwo(j)\n        count = count + 1\n        ReDim Preserve twod_array(1, count) // dynamic resizing (doesnt work)\n    Next j\nNext i\n</code></pre>\n\n<p>I know at some point I have to ReDim the 2D array which I believe I can do as follows:</p>\n\n<pre><code>ReDim Preserve twod_array(1, count)\n</code></pre>\n\n<p>The 1 allows me to specify 2 elements in the x-dimension and the count is incremented because I don't know how many elements each one-d array will have (I just set them equal to three in this example)</p>\n\n<p>For some reason, I can only output the values twod_array(0,0) to twod_array(1,0) and the other ones are blank. I suspect this has to do with how I used ReDim</p>\n\n<p>e.g. right now I'm only getting:</p>\n\n<pre><code>twod_array(0,0) = 1\ntwod_array(1,0) = 4\n</code></pre>\n\n<p>but not:</p>\n\n<pre><code>twod_array(0,1) = 1\ntwod_array(1,1) = 5\n</code></pre>\n\n<p>instead I get:</p>\n\n<pre><code>twod_array(0,1) = //blank\ntwod_array(1,1) = //blank\n</code></pre>\n\n<p>Can someone please help me understand why my code is not resizing the 2D array correctly so I can output all elements it collects?</p>\n"}, {"tags": ["python", "vba", "attachment", "data-extraction"], "comments": [{"owner": {"reputation": 11, "user_id": 12263456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7648deb68d73ca8640250a1dd44b228?s=128&d=identicon&r=PG&f=1", "display_name": "Vassilis M", "link": "https://stackoverflow.com/users/12263456/vassilis-m"}, "edited": false, "score": 0, "creation_date": 1572540902, "post_id": 58525541, "comment_id": 103600944, "body": "The VBA macro seems to work best, but only extracts 1 file, is there a command I am missing somewhere in the code?"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9274117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db1d65b33c4475355cad068e61d94be1?s=128&d=identicon&r=PG&f=1", "display_name": "anshu", "link": "https://stackoverflow.com/users/9274117/anshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1574941884, "creation_date": 1574941884, "answer_id": 59088263, "question_id": 58525541, "link": "https://stackoverflow.com/questions/58525541/extracting-xlsx-attachments-from-msg-files/59088263#59088263", "title": "Extracting .xlsx attachments from .msg files", "body": "<p>I have not tried saving the attachments using win32com, so I can't tell why only a single attachment from a single file is getting saved. But I was able to save multiple attachments using <a href=\"https://github.com/mattgwwalker/msg-extractor\" rel=\"nofollow noreferrer\">msg-extractor</a></p>\n\n<pre><code>import extract_msg\n\nfor file in files:\n    msg = extract_msg.Message(file)\n    msg_attachment = msg.attachments\n    attach_path = \"path where the files have to be saved.\"\n    for attachment in msg_attachment:\n        if not os.path.exists(attach_path):\n            os.makedirs(attach_path)\n        attachment.save(customPath=attach_path)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12263456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7648deb68d73ca8640250a1dd44b228?s=128&d=identicon&r=PG&f=1", "display_name": "Vassilis M", "link": "https://stackoverflow.com/users/12263456/vassilis-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1575585607, "creation_date": 1575585607, "answer_id": 59204291, "question_id": 58525541, "link": "https://stackoverflow.com/questions/58525541/extracting-xlsx-attachments-from-msg-files/59204291#59204291", "title": "Extracting .xlsx attachments from .msg files", "body": "<p>Thank you! I actually figured out a solution to extract multiple files with Win32 by including a counter:</p>\n\n<pre><code>   path = r'C:\\Users\\filepath' #change path to directory where your msg files are located\n   files = [f for f in os.listdir(path) if '.msg' in f]\n   print (files)\n   counter=0\n   for file in files:\n       outlook = win32com.client.Dispatch(\"Outlook.Application\").GetNamespace(\"MAPI\")\n       msg = outlook.OpenSharedItem(os.path.join(path, file))\n       att=msg.Attachments\n       for i in att:\n           counter +=1\n           i.SaveAsFile(os.path.join(path, str(counter)+i.FileName))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12263456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7648deb68d73ca8640250a1dd44b228?s=128&d=identicon&r=PG&f=1", "display_name": "Vassilis M", "link": "https://stackoverflow.com/users/12263456/vassilis-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1575585607, "creation_date": 1571842090, "last_edit_date": 1572553301, "question_id": 58525541, "link": "https://stackoverflow.com/questions/58525541/extracting-xlsx-attachments-from-msg-files", "title": "Extracting .xlsx attachments from .msg files", "body": "<p>I know that this has been asked here several times, and I have tried what has apparently worked for others...I have more than 1000 Outlook .msg files with .xlsx file attachments stored in folders on my desktop and I only need to extract the .xlsx files to combine into a single dataframe.</p>\n\n<p>I have tried the <a href=\"https://stackoverflow.com/questions/48201007/extracting-attachments-from-msg-files-stored-in-many-subfolders-within-main-sh?noredirect=1&amp;lq=1\">VBA macro</a>, and Python [Win32] (<a href=\"https://stackoverflow.com/questions/26322255/parsing-outlook-msg-files-with-python\">Parsing outlook .msg files with python</a>) and <a href=\"https://github.com/mattgwwalker/msg-extractor\" rel=\"nofollow noreferrer\">msg-extractor</a>. The best I can do is to extract a single attachment from a single .msg file</p>\n\n<p>Any advice is greatly appreciated. Thank you!</p>\n\n<pre><code>import argparse\nimport csv\nimport os as os\nimport pathlib\nimport sys\nfrom datetime import date, datetime, timedelta, tzinfo\nfrom enum import Enum, IntEnum\nfrom tempfile import mkstemp\n\nimport dateutil.parser as duparser\nfrom dateutil.rrule import rrulestr, rruleset\nimport pywintypes\nimport pytz\nimport win32com.client  \n\npath = r'C:\\Users\\Me\\Desktop\\MyFiles\\feb_2018'\nfiles = [f for f in os.listdir(path) if '.msg' in f]\nprint (files)\nfor file in files:\n    outlook = win32com.client.Dispatch(\"Outlook.Application\").GetNamespace(\"MAPI\")\n    msg = outlook.OpenSharedItem(os.path.join(path, file))\n    att=msg.Attachments\n    for i in att:\n        i.SaveAsFile(os.path.join(path, i.FileName))       \n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-statements", "conditional-formatting"], "comments": [{"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571842500, "post_id": 58525509, "comment_id": 103376014, "body": "@BigBen good point. I originally had a loop that went through all worksheets and an if statement to check for worksheet names. Disregard the loop - i&#39;ll remove it from above"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571842595, "post_id": 58525509, "comment_id": 103376080, "body": "Also, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.formatconditions.add\" rel=\"nofollow noreferrer\"><code>FormatConditions.Add</code></a> doesn&#39;t have a <code>String</code> parameter..."}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571842763, "post_id": 58525509, "comment_id": 103376191, "body": "@BigBen would I then simply need to get rid of the String operator and leave &quot;=TEXT&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571842821, "post_id": 58525509, "comment_id": 103376224, "body": "<code>String</code> should be <code>Formula1</code>, and get rid of the <code>=</code> within quotes. Though I&#39;m not sure what the last condition is supposed to be."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571842897, "post_id": 58525509, "comment_id": 103376255, "body": "And you have set the format for the 2nd through 4th conditions you&#39;ve added."}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571843233, "post_id": 58525509, "comment_id": 103376412, "body": "@BigBen gotcha. It looks like it is formatting correctly. Refer to edited code above. I&#39;m still curious on how I can have the whole row be highlighted, rather than the single cell"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571843263, "post_id": 58525509, "comment_id": 103376436, "body": "Then you&#39;d need an actual formula, not text."}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571843991, "post_id": 58525509, "comment_id": 103376836, "body": "@BigBen so, rather than having <i>Type:=xlCellValue</i>, I changed it to <i>Type:=xlExpression, Formula1:=&quot;$AZ6=&quot;REPAIR&quot;&quot;</i>"}], "owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571897853, "creation_date": 1571841981, "last_edit_date": 1571897853, "question_id": 58525509, "link": "https://stackoverflow.com/questions/58525509/vba-conditional-formatting-for-specific-sheets-and-spefiic-ranges", "title": "VBA - Conditional Formatting for Specific Sheets and Spefiic Ranges", "body": "<p>I'm trying to loop through 3 sheets that update daily and format each of them based on different conditions. I've been getting several errors with the below section, such as Run-time error '91'.</p>\n\n<pre><code>.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, String:=\"=REPAIR\"\n</code></pre>\n\n<p>Please refer to the comments in the code below.</p>\n\n<pre><code>    Dim rng As Range\n    Dim ws As Worksheet, ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n    Dim condition1 As FormatCondition, condition2 As FormatCondition, condition3 As FormatCondition, condition4 As FormatCondition, condition5 As FormatCondition\n\n   Set ws1 = Sheets(\"sheet1\")\n   Set ws2 = Sheets(\"sheet2\")\n   Set ws3 = Sheets(\"sheet3\")\n\n        ' Format Conditions for Sheet1\n        '   - Check column AZ for all available rows (starting on row 6)\n        '   - If Cell Value = \"REPAIR\" or \"REPAIR - INSUFFICIENT HOLDINGS\" or \"OTHER\" highlight the row RED\n        '   - If Cell Value is blank, highlight the row YELLOW\n        With Range(ws1.Cells(2, 52), ws1.Cells(1000, 1))\n            .FormatConditions.Delete\n            .FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:=\"REPAIR - INSUFFICIENT HOLDINGS\"\n            .FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:=\"REPAIR - REFER NARRATIVE\"\n            .FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:=\"OTHER\"\n            .FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:=\" \"\n\n            With .FormatConditions(1)\n                .SetFirstPriority\n                .Font.Color = vbRed\n            End With\n\n            With .FormatConditions(2)\n                .SetFirstPriority\n                .Font.Color = vbRed\n            End With\n\n            With .FormatConditions(3)\n                .SetFirstPriority\n                .Font.Color = vbRed\n            End With\n\n            With .FormatConditions(4)\n                .SetFirstPriority\n                .Font.Color = vbYellow\n            End With\n        End With\n\n        ' Format Conditions for Sheet2\n        '   - Check column N for all available rows (starting on row 2)\n        '   - If Cell Value = \"OTHER\" or \"INSUFFICIENT\", highlight the row RED\n        '   - If Cell Value is blank, highlight the row YELLOW\n        'With Range(ws2.Cells(2, N), ws2.Cells(1000, 1))\n\n        'End With\n\n        ' Format Conditions for Sheet3\n        '   - Check column CC for all available rows (starting on row 2)\n        '   - If Cell Value = \"OTHER\" or \"AWAITING CP\", highlight the row RED\n        '   - If Cell Value is blank, highlight the row YELLOW\n        'With Range(ws2.Cells(2, CC), ws2.Cells(1000, 1))\n\n        'End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "cdo.message"], "comments": [{"owner": {"reputation": 12634, "user_id": 1204258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dV7nD.png?s=128&g=1", "display_name": "Andrew Leach", "link": "https://stackoverflow.com/users/1204258/andrew-leach"}, "edited": false, "score": 0, "creation_date": 1571842209, "post_id": 58525487, "comment_id": 103375857, "body": "I&#39;m not sure this is a programming question. You say your code works."}, {"owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "reply_to_user": {"reputation": 12634, "user_id": 1204258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dV7nD.png?s=128&g=1", "display_name": "Andrew Leach", "link": "https://stackoverflow.com/users/1204258/andrew-leach"}, "edited": false, "score": 0, "creation_date": 1571843341, "post_id": 58525487, "comment_id": 103376489, "body": "Question  concerns the typical VBA CDO Message sending program. I finding coding works less and less often: I expect the issue could be related to the Email account provider. Maybe someone has had the issue and can help with a solution"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1579160904, "post_id": 58525487, "comment_id": 105674447, "body": "That&#39;s a very wordy explanation but it doesn&#39;t have one error message in it. An error message usually gives you some idea of the issue. By &quot;does not work&quot; do you mean the code works without errors, but the email does not arrive at the destination?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1579161003, "post_id": 58525487, "comment_id": 105674486, "body": "So whatever you did in your prior question isn&#39;t working anymore? <a href=\"https://stackoverflow.com/questions/58286932/cdo-gmail-macro-some-accounts-work-some-don-t-message-could-not-be-sent-to-sm\" title=\"cdo gmail macro some accounts work some don t message could not be sent to sm\">stackoverflow.com/questions/58286932/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1579170004, "post_id": 58525487, "comment_id": 105678910, "body": "@Nick.McDermaid  Hi Nick. Here is the full Answer to my question. <a href=\"http://www.excelfox.com/forum/showthread.php/2380-Tests-and-Notes-for-EMail-Threads?p=11548&amp;viewfull=1#post11548\" rel=\"nofollow noreferrer\">excelfox.com/forum/showthread.php/&hellip;</a> . I think it answers your comments also. I posted it here yesterday, but  it got tanked by a moderator. Alan"}, {"owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1579170478, "post_id": 58525487, "comment_id": 105679143, "body": "@Nick.McDermaid  What I did in my prior question is still working. It is related, but a slightly different issue. The solution given by me to this question  Yesterday,  prevents that issue stopping a macro working. Sorry, it is not easy to explain in a few words. Hence I gave a full detailed answer."}, {"owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "edited": false, "score": 0, "creation_date": 1579170689, "post_id": 58525487, "comment_id": 105679259, "body": "I try again. .. That other issue might stop a typical CDO Sernd  macro working with a gmail account. In addition other issues might stop other accounts working. This solution will try other accounts until a successful CDO Send is obtained. You can then look at that other answer to get any  failing gmail account to work."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "edited": false, "score": 0, "creation_date": 1579171510, "post_id": 59756971, "comment_id": 105679705, "body": "Here is the full answer explanation. <a href=\"http://www.excelfox.com/forum/showthread.php/2380-Tests-and-Notes-for-EMail-Threads?p=11548&amp;viewfull=1#post11548\" rel=\"nofollow noreferrer\">excelfox.com/forum/showthread.php/&hellip;</a>"}], "tags": [], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "is_accepted": true, "score": 0, "last_activity_date": 1579248171, "last_edit_date": 1579248171, "creation_date": 1579110411, "answer_id": 59756971, "question_id": 58525487, "link": "https://stackoverflow.com/questions/58525487/excel-vba-cdo-message-email-sending-accounts-work-less-and-less/59756971#59756971", "title": "Excel VBA CDO Message Email Sending accounts work less and less\u2026", "body": "<p>Coding for my last answer (  <a href=\"https://stackoverflow.com/questions/58525487/excel-vba-cdo-message-email-sending-accounts-work-less-and-less/59756874#59756874\">Excel VBA CDO Message Email Sending accounts work less and less\u2026</a>   )</p>\n\n<p>EDIT: The answer post has been hidden! - here is a copy of it: <a href=\"http://www.excelfox.com/forum/showthread.php/2380-Tests-and-Notes-for-EMail-Threads?p=11548&amp;viewfull=1#post11548\" rel=\"nofollow noreferrer\">http://www.excelfox.com/forum/showthread.php/2380-Tests-and-Notes-for-EMail-Threads?p=11548&amp;viewfull=1#post11548</a></p>\n\n<pre><code>    Option Explicit\n    ''_-(ii)                        \"sendusername\"     ,     \"sendpassword\"    ,       \"smtpusessl\"        ,         \"smtpauthenticate\"  ,   \"smtpserver\"             , \"sendusing\"                 ,  \"smtpserverport\"             ,  \"smtpconnectiontimeout\"\n    'Sub ScrudOverFlowDemolition(ByVal UsrNme As String, ByVal PssWrd As String, ByVal SlutPussly As String, ByVal PatheticCake As String, ByVal ServiceChef As String, ByVal WayntkerUsed As String, ByVal ConnectingDoor As String, ByVal WaitSecs As String, ByVal Snd_Frm As String)\n    Dim CunFik() As String       '  CDO Account configuration\n    Dim CunFikaNation As String  '  CDO Account configurations, CunFik(x)s seperated by vbCr &amp; vbLf is   \"sendusername\" \"sendpassword\" \"smtpusessl\" \"smtpauthenticate\" \"smtpserver\" \"sendusing\" \"smtpserverport\" \"smtpconnectiontimeout\"\n\n    '_- Program_(i)\n    '  ( '_-(ii)  ScrudOverFlow..(\"sendusername\",\"sendpassword\",\"smtpusessl\",\"smtpauthenticate\",\"smtpserver\",\"sendusing\",\"smtpserverport\",\"smtpconnectiontimeout\", .From )\n    Sub TestCall_ScrudOverFlowDemolition()\n     Let CunFikaNation = \"\"\n\n    Rem 1  Collect of accounts and their configuration parameters\n    ' gmail\n     Call ScrudOverFlowDemolition(\"1234567890123456789.com\", \"xxxxxxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"465\", \"30\", \"ExcelVBAExp@gmail.com\")\n     Call ScrudOverFlowDemolition(\"1234567890@gmail.com\", \"xxxxxxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"465\", \"30\", \"mail2taste@gmail.com\")\n     Call ScrudOverFlowDemolition(\"1234567890@gmail.com\", \"xxxxxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"25\", \"30\", \"mail2taste@gmail.com\")\n     Call ScrudOverFlowDemolition(\"1234567890123456@gmail.com\", \"xxxxxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"465\", \"30\", \"excellearning12@gmail.com\")\n     Call ScrudOverFlowDemolition(\"12345678901@gmail.com\", \"xxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"465\", \"30\", \"JaneAmbrose1958@gmail.com\")\n     Call ScrudOverFlowDemolition(\"1234567890@gmail.com\", \"xxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"465\", \"30\", \"CDOMsgExp@gmail.com\")\n     Call ScrudOverFlowDemolition(\"123456789@gmail.com\", \"xxxxxxx\", \"True\", \"1\", \"smtp.gmail.com\", \"2\", \"25\", \"30\", \"CDOMsgExp@gmail.com\")\n    ' Yandex\n     Call ScrudOverFlowDemolition(\"xxxxxxxxxxx@yandex.com\", \"xxxxxxxxx\", \"True\", \"1\", \"smtp.yandex.com\", \"2\", \"465\", \"30\", \"developmentstest@yandex.com\")\n     Call ScrudOverFlowDemolition(\"eeeeeeeeeee@yandex.com\", \"ahetkdkjhddhj\", \"True\", \"1\", \"smtp.yandex.com\", \"2\", \"465\", \"30\", \"developmentstest@yandex.com\")\n     Call ScrudOverFlowDemolition(\"123456789@yandex.com\", \"96lskKFHSHFDLHF\", \"True\", \"1\", \"smtp.yandex.com\", \"2\", \"465\", \"30\", \"123456789@yandex.com\")\n    ' Yahoo\n     Call ScrudOverFlowDemolition(\"1234567890@yahoo.com\", \"XXXXXXXX\", \"True\", \"1\", \"smtp.mail.yahoo.com\", \"2\", \"465\", \"30\", \"yangsfool@yahoo.com\")\n    ' Outlook\n     Call ScrudOverFlowDemolition(\"12345678901@Outlook.com\", \"cccccccccc*\", \"True\", \"1\", \"smtp-mail.outlook.com\", \"2\", \"587\", \"30\", \"MollyBrennholz@Outlook.com\")\n     Call ScrudOverFlowDemolition(\"123456789012@Outlook.com\", \"yyyyyyyy\", \"True\", \"1\", \"smtp-mail.outlook.com\", \"2\", \"587\", \"30\", \"excellearning@Outlook.com\")\n     'Call ScrudOverFlowDemolition(\"123456789012@Outlook.com\", \"zzzzzzzzzz\", \"True\", \"1\", \"smtp-mail.outlook.com\", \"2\", \"465\", \"30\", \"excellearning@Outlook.com\") ' This line takes a long time\n    ' GMX\n     Call ScrudOverFlowDemolition(\"1234567890@gmx.net\", \"fffffffffffff\", \"True\", \"1\", \"mail.gmx.net\", \"2\", \"465\", \"30\", \"GiMiCDOMsg@gmx.net\")\n     Call ScrudOverFlowDemolition(\"12345678901234@gmx.net\", \"xxxxxx\", \"True\", \"1\", \"mail.gmx.net\", \"2\", \"465\", \"30\", \"Doc.AElstein@gmx.net\")\n     Call ScrudOverFlowDemolition(\"12345@gmx.com\", \"966455535\", \"True\", \"1\", \"mail.gmx.com\", \"2\", \"465\", \"30\", \"Vixer@gmx.com\")\n    ' AOL\n     Call ScrudOverFlowDemolition(\"123456789@aol.com\", \"dddddddddd\", \"True\", \"1\", \"smtp.aol.com\", \"2\", \"587\", \"30\", \"aliarseol@aol.com\")\n\n    ' German Telekom\n     Call ScrudOverFlowDemolition(\"12345@t-online.de\", \"cccccccccc\", \"True\", \"1\", \"securesmtp.t-online.de\", \"2\", \"465\", \"30\", \"Jayae@t-online.de\")\n     Call ScrudOverFlowDemolition(\"12345678901@t-online.de\", \"ddddddddddd\", \"True\", \"1\", \"securesmtp.t-online.de\", \"2\", \"465\", \"30\", \"CDOMsgTest@t-online.de\")\n     Call ScrudOverFlowDemolition(\"12345678901234@t-online.de\", \"eeeeeeeeeeee\", \"True\", \"1\", \"securesmtp.t-online.de\", \"2\", \"465\", \"30\", \"CDOMsgScrotum@t-online.de\")\n      '\n\n\n     If CunFikaNation &lt;&gt; \"\" Then Let CunFikaNation = Left(CunFikaNation, Len(CunFikaNation) - 2) ' I do not need the last  vbCr &amp; vbLf\n    Rem 2 Store the final string Configuration parameters\n    ' 2a) In the Immediate window\n     Debug.Print CunFikaNation\n    ' 2b) Send CunFikaNation  to a text file, ( the file will be made if it does not exist, or it will be overwritten if it does exist\n    Dim Highway2 As Long: Let Highway2 = FreeFile(0) '\n     Open ThisWorkbook.Path &amp; \"\\\" &amp; \"CunFikaNation \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Output As #Highway2 '  Text file will be made if not there\n     Print #Highway2, CunFikaNation\n     Close Highway2\n    ' 2c) Using a function to get the string in a form which can be hardcoded into a VBA macro\n    ' 2c)(i) direct use of CunFikaNation in function\n     Call WtchaGot_Unic_NotMuchIfYaChoppedItOff(CunFikaNation)  '      http://www.excelfox.com/forum/showthread.php/2302-quot-What%E2%80%99s-in-a-String-quot-VBA-break-down-Loop-through-character-contents-of-a-string?p=11016&amp;viewfull=1#post11016\n    ' 2c)(ii) indirect use ater retreiving from the text file\n     Open ThisWorkbook.Path &amp; \"\\\" &amp; \"CunFikaNation \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Binary As #Highway2\n     Let CunFikaNation = Space$(LOF(Highway2))       ' sets buffer to Length Of File : Space$(LOF(1)) creates a string the size of the file. LOF and Space$ is to initialize the string to a given length\n     Get #Highway2, , CunFikaNation                  ' fits exactly\n     Close Highway2\n     Let CunFikaNation = Left(CunFikaNation, Len(CunFikaNation) - 2) '  There appears to be an extra 2 characters,   vbCr &amp; vbLf  , added to the string which we don't want so we effectiuvely chop off the last two characters\n     Call WtchaGot_Unic_NotMuchIfYaChoppedItOff(CunFikaNation)     '     http://www.excelfox.com/forum/showthread.php/2345-Appendix-Thread-(-Codes-for-other-Threads-HTML-Tables-etc-)?p=11818&amp;viewfull=1#post11818      http://www.excelfox.com/forum/showthread.php/2302-quot-What%E2%80%99s-in-a-String-quot-VBA-break-down-Loop-through-character-contents-of-a-string?p=11016&amp;viewfull=1#post11016\n    ' 2c)(iii) Paste to a cell\n     Let ThisWorkbook.Worksheets.Item(1).Range(\"A1\").Value = CunFikaNation\n    End Sub\n\n\n    '\n\n    ' https://stackoverflow.com/questions/58525487/excel-vba-cdo-message-email-sending-accounts-work-less-and-less?noredirect=1#comment103375857_58525487\n    '                                                            '   Allow access to deep down cods wollops from Microsoft to collaborating in particular in the form of messaging. An available library of ddl library functions and associated things is available on request, the  Microsoft CDO for Windows 2000. We require some of these '  CDO is an object library that exposes the interfaces of the Messaging Application Programming Interface (MAPI). API: interfaces that are fairly easy to use from a fairly higher level from within a higher level programming language. In other words this allows you to get at and use some of the stuff to do with the COM OLE Bollocks from within a programming language such as VBA  API is often referring loosely to do with using certain shipped with Windows software in Folders often having the extension dll. This extension , or rather the dll stands for direct link libraries. These are special sort of executable files of functions shared by many other (Windows based usually) sof\n    '_- Program_(ii)               \"sendusername\"     ,     \"sendpassword\"    ,       \"smtpusessl\"        ,         \"smtpauthenticate\"  ,   \"smtpserver\"             , \"sendusing\"                 ,  \"smtpserverport\"             ,  \"smtpconnectiontimeout\"\n    Sub ScrudOverFlowDemolition(ByVal UsrNme As String, ByVal PssWrd As String, ByVal SlutPussly As String, ByVal PatheticCake As String, ByVal ServiceChef As String, ByVal WayntkerUsed As String, ByVal ConnectingDoor As String, ByVal WaitSecs As String, ByVal Snd_Frm As String)\n    'Rem1 The deep down fundamental stuff , which includes stuff been there the longest goes by the name of Component Object Model. Stuff which is often, but not always, later stuff, or at a slightly higher level of the computer workings, or slightly more to a specific application ( an actual running \"runtime\" usage / at an instance in time , \"instance of\" ) orientated goes to the name of Object Linking and Embedding. At this lower level, there are protocols for communicating between things, and things relate are grouped into the  to Office  application available Library, CDO. An important object there goes by the name of Message.\n    'Rem 1) Library made available            ====================#\n      With CreateObject(\"CDO.Message\") '   Folders mostly but not always are in some way referenced using dll, either as noted with the extension or maybe refered to as dll Files or dll API files.\n    'Rem 2 ' Intraction protocols are given requird infomation and then set\n        '2a) 'With --------------------* my Created LCDCW Library, (LCD 1.0 Library ) (Linking Configuration Data_Cods Wollups) which are used and items configured for the Exchange at Microsoft\u2019s protocol thereof;   http://schemas.microsoft.com/cdo/configuration/ ......This section provides the configuration information for the remote SMTP server\n        Dim LCD_CW As String: Let LCD_CW = \"http://schemas.microsoft.com/cdo/configuration/\" ' Linking Configuration Data : defines the majority of fields used to set configurations for various Linking Collaboration (LCD) Objects Cods Wollops: These configuration fields are set using an implementation of the IConfiguration.Fields collection.  https://msdn.microsoft.com/en-us/library/ms872853(v=exchg.65).aspx\n         .Configuration(LCD_CW &amp; \"smtpusessl\") = SlutPussly ' ' ' HTTPS (Hyper Text Transfer Protocol Secure) appears in the URL when a website is secured by an SSL certificate. The details of the certificate, including the issuing authority and the corporate name of the website owner, can be viewed by clicking on the lock symbol on the browser bar. in short, it's the standard technology for keeping an internet connection secure and safeguarding any sensitive data that is being sent between two systems, preventing criminals from reading and modifying any information transferred, including potential personal details.  ' SSL protocol has always been used to encrypt and secure transmitted data\n         .Configuration(LCD_CW &amp; \"smtpauthenticate\") = PatheticCake  ' ... possibly this also needed ..   When you also get the Authentication Required Error you can add this three lines.\n        '  ' Sever info\n         .Configuration(LCD_CW &amp; \"smtpserver\") = ServiceChef   ' \"smtp.gmail.com\" ' \"securesmtp.t-online.de\"                 '\"smtp.gmail.com\" \"smtp.mail.yahoo.com\" \"smtp.live.com\" \"pod51017.outlook.com\"  \"smtp-mail.outlook.com\" \"smtp.live.com\"  \"securesmtp.t-online.de\"  465         SMTP is just used to mean the common stuff.....  Simple Mail Transport Protocol (SMTP) server is used to send outgoing e-mails. The SMTP server receives emails from your Mail program and sends them over the Internet to their destination.\n        '  The mechanism to use to send messages.\n         .Configuration(LCD_CW &amp; \"sendusing\") = WayntkerUsed  '  Based on the LCD_OLE Data Base of type DBTYPE_I4 , 2 will use the default account\n         .Configuration(LCD_CW &amp; \"smtpserverport\") = ConnectingDoor  ' 465 or 25 for t-online.de ' 465 'or 587 'or 25   ' The port of type somehow refered to by the last line\n         .Configuration(LCD_CW &amp; \"sendusername\") = UsrNme   '                                            .... \"server rejected your response\".  AFAIK : This will happen if you haven't setup an account in Outlook Express or Windows Mail .... Runtime error '-2147220975 (800440211)': The message could not be sent to the SMTP server. The transport error code is 0x80040217. The server response is not available\n         .Configuration(LCD_CW &amp; \"sendpassword\") = PssWrd\n        ' Optional - How long to try     ( End remote SMTP server configuration section )\n         .Configuration(LCD_CW &amp; \"smtpconnectiontimeout\") = 30 '    Or there Abouts ;) :)\n        ' Intraction protocol is Set/ Updated\n         .Configuration.fields.Update ' 'Not all infomation is given, some will have defaults. - possibly this might be needed initially ..    .Configuration.Load -1 ' CDO Source Defaults\n        'End With ' -------------------* my Created  LCDCW Library ( Linking Configuration Data Cods Wollups)  which are  used and items configured for the Exchange at Microsoft's protocol therof;\n       '2b) ' Data to be sent\n        .To = \"123456789012@t-online.de\"\n        .CC = \"\" ' 12345678901@gmail.com\"\n        .BCC = \"\"\n        .From = Snd_Frm                           '\n        .Subject = \"Hello from \" &amp; UsrNme &amp; \"\"    '\n        .TextBody = \"Hi\" &amp; vbCr &amp; vbLf &amp; \"Testing automated EMail sending. Please ignoor this EMail\"\n       ' add header for this Account in log text file.\n        Dim Highway1 As Long: Let Highway1 = FreeFile(0) 'range 1 \u2013 255, inclusive - next free      The \"highway/ street/ link\" to be built to transport the text will be given a number. It must be unique. So we use for convenience, the Freefile function: it returns an integer that represents the next file number that the Open statement can use.  The optional argument for the range number is a variant that is used to specify a range from which the next free file number is returned. Enter a value of data type 0 (default) to return a file number in the range 1 - 255 inclusive. Enter 1 to return a file number in the range 256 - 511.   https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/freefile-function  . Note also : Use file numbers in the range 1-255, inclusive, for files not accessible to other applications. Use file numbers in the range 256-511 for files accessible from other applications\n         Open ThisWorkbook.Path &amp; \"\\\" &amp; \"ScrudOverFlowDemolition \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Append As #Highway1 ' Will be made if not there\n         Print #Highway1, \"EMail Address:\"\"\" &amp; UsrNme &amp; \"\"\"\" &amp; vbCrLf\n         Close #Highway1\n        'Rem 3 Attemt the send\n          On Error GoTo Bed                                                                             ' Intended to catch a possible predicted error in the next line when running the routine\n         .send\n          On Error GoTo 0\n        ' Add to the log a note to the effect that this account was successful\n          Debug.Print \"Done \" &amp; \"\"\"\" &amp; UsrNme &amp; \"\"\"\"\n          Open ThisWorkbook.Path &amp; \"\\\" &amp; \"ScrudOverFlowDemolition \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Append As #Highway1 ' Will be made if not there\n          Print #Highway1, \"Sended \" &amp; Format(Now(), \"hh mm\") &amp; \"  \" &amp; vbCr &amp; vbLf\n          Close #Highway1\n        '\n         ' Add to the string of succesful accounts CDO config data, CunFikaNation\n          Let CunFikaNation = CunFikaNation &amp; UsrNme &amp; \" \" &amp; PssWrd &amp; \" \" &amp; SlutPussly &amp; \" \" &amp; PatheticCake &amp; \" \" &amp; ServiceChef &amp; \" \" &amp; WayntkerUsed &amp; \" \" &amp; ConnectingDoor &amp; \" \" &amp; WaitSecs &amp; \" \" &amp; Snd_Frm &amp; vbCr &amp; vbLf\n\n         End With ' CreateObject(\"CDO.Message\") (Rem 1 Library End =======#\n    Exit Sub                                                                                          ' Normal routine end for no error exceptional errected situation\n Bed:                                                                                                    ' Intended to catch an error when running the routine\n    ' Add to the log a note to the effrect that this account was unsuccessful\n     Debug.Print \"Not done \" &amp; \"\"\"\" &amp; UsrNme &amp; \"\"\"\" &amp; \"   Error is \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n     Open ThisWorkbook.Path &amp; \"\\\" &amp; \"ScrudOverFlowDemolition \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Append As #Highway1 ' Will be made if not there\n     Print #Highway1, \"Fail \" &amp; Format(Now(), \"hh mm\") &amp; \"  \" &amp; Err.Number &amp; \":  \" &amp; Err.Description &amp; vbLf\n     Close #Highway1\n    ' On Error GoTo -1: On Error GoTo 0 ' Do not need to do this as the code is ending\n    End Sub\n\n\n    ' NOTE: This is an extra macro that can be used to fill the global variable,  CunFikaNation . This can be useful in development since the global variable is often emptied. It is also useful for checking error handling in the next coding, since you can modify the text file, then refil the global variable ,  CunFikaNation    from it\n    Sub GetthelastCunFikaNation()\n    Dim Highway2 As Long: Let Highway2 = FreeFile(0)   'range 1 \u2013 255, inclusive - next free      The \"highway/ street/ link\" to be built to transport the text will be given a number. It must be unique. So we use for convenience, the Freefile function: it returns an integer that represents the next file number that the Open statement can use.  The optional argument for the range number is a variant that is used to specify a range from which the next free file number is returned. Enter a value of data type 0 (default) to return a file number in the range 1 - 255 inclusive. Enter 1 to return a file number in the range 256 - 511.   https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/freefile-function  . Note also : Use file numbers in the range 1-255, inclusive, for files not accessible to other applications. Use file numbers in the range 256-511 for files accessible from other applications\n     Open ThisWorkbook.Path &amp; \"\\\" &amp; \"CunFikaNation \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Binary As #Highway2\n     Let CunFikaNation = Space$(LOF(Highway2))       ' sets buffer to Length Of File : Space$(LOF(1)) creates a string the size of the file. LOF and Space$ is to initialize the string to a given length\n     Get #Highway2, , CunFikaNation                  ' fits exactly\n     Close Highway2\n\n     Let CunFikaNation = Left(CunFikaNation, Len(CunFikaNation) - 2) '  There appears to be an extra 2 characters,   vbCr &amp; vbLf  , added to the string which we don't want so we effectiuvely chop off the last two characters\n     Call WtchaGot_Unic_NotMuchIfYaChoppedItOff(CunFikaNation)  '     http://www.excelfox.com/forum/showthread.php/2302-quot-What%E2%80%99s-in-a-String-quot-VBA-break-down-Loop-through-character-contents-of-a-string?p=11016&amp;viewfull=1#post11016\n    ' 2c)(iii) Paste to a cell\n     ' Let ThisWorkbook.Worksheets.Item(1).Range(\"A1\").Value = CunFikaNation   '   This is already done by Call WtchaGot_Unic_NotMuchIfYaChoppedItOff(     )\n    End Sub\n\n    ' '_- Program_(iii)\n    Sub CallCDOSendMailAttempt()\n    Dim VlagaMir As Boolean ' This is set to True after an EMail is succcesful\n\n    Rem 1 make array for the configutration parameters of all EMail accounts\n    Dim SptACnt() As String: Let SptACnt() = Split(CunFikaNation, vbCr &amp; vbLf, -1, vbBinaryCompare)\n    Rem 2 pass the config parameters to CDOSendMail until successful mail send\n    Dim Cnt As Long\n        For Cnt = 0 To UBound(SptACnt())\n        Dim CunFik() As String: Let CunFik() = Split(SptACnt(Cnt), \" \", 9, vbBinaryCompare)\n         Call CDOSendMailAttempt(VlagaMir, CunFik(0), CunFik(1), CunFik(2), CunFik(3), CunFik(4), CunFik(5), CunFik(6), CunFik(7), CunFik(8))\n            If VlagaMir = True Then Exit Sub\n        Next Cnt\n    End Sub\n\n\n    ' '_- Program_(iv)\n    Sub CDOSendMailAttempt(ByRef FlagerMe As Boolean, ByVal UsrNme As String, ByVal PssWrd As String, ByVal SlutPussly As String, ByVal PatheticCake As String, ByVal ServiceChef As String, ByVal WayntkerUsed As String, ByVal ConnectingDoor As String, ByVal WaitSecs As String, ByVal Snd_Frm As String)\n    'Rem1 The deep down fundamental stuff , ...\n    'Rem 1) Library made available            ====================#\n      With CreateObject(\"CDO.Message\") '   Folders mostly but not always are in some way referenced using dll, either as noted with the extension or maybe refered to as dll Files or dll API files.\n    'Rem 2 ' Intraction protocols are given requird infomation and then set\n        '2a) 'With --------------------* my Created LCDCW Library, (LCD 1.0 Library ) (Linking Configuration Data_Cods Wollups) which are used and items configured for the Exchange at Microsoft\u2019s protocol thereof;   http://schemas.microsoft.com/cdo/configuration/ ......This section provides the configuration information for the remote SMTP server\n        Dim LCD_CW As String: Let LCD_CW = \"http://schemas.microsoft.com/cdo/configuration/\" ' Linking Configuration Data : defines the majority of fields used to set configurations for various Linking Collaboration (LCD) Objects Cods Wollops: These configuration fields are set using an implementation of the IConfiguration.Fields collection.  https://msdn.microsoft.com/en-us/library/ms872853(v=exchg.65).aspx\n         .Configuration(LCD_CW &amp; \"smtpusessl\") = SlutPussly ' ' ' HTTPS (Hyper Text Transfer Protocol Secure) appears in the URL when a website is secured by an SSL certificate. The details of the certificate, including the issuing authority and the corporate name of the website owner, can be viewed by clicking on the lock symbol on the browser bar. in short, it's the standard technology for keeping an internet connection secure and safeguarding any sensitive data that is being sent between two systems, preventing criminals from reading and modifying any information transferred, including potential personal details.  ' SSL protocol has always been used to encrypt and secure transmitted data\n         .Configuration(LCD_CW &amp; \"smtpauthenticate\") = PatheticCake  ' ... possibly this also needed ..   When you also get the Authentication Required Error you can add this three lines.\n        '  ' Sever info\n         .Configuration(LCD_CW &amp; \"smtpserver\") = ServiceChef   ' \"smtp.gmail.com\" ' \"securesmtp.t-online.de\"                 '\"smtp.gmail.com\" \"smtp.mail.yahoo.com\" \"smtp.live.com\" \"pod51017.outlook.com\"  \"smtp-mail.outlook.com\" \"smtp.live.com\"  \"securesmtp.t-online.de\"  465         SMTP is just used to mean the common stuff.....  Simple Mail Transport Protocol (SMTP) server is used to send outgoing e-mails. The SMTP server receives emails from your Mail program and sends them over the Internet to their destination.\n        '  The mechanism to use to send messages.\n         .Configuration(LCD_CW &amp; \"sendusing\") = WayntkerUsed  '  Based on the LCD_OLE Data Base of type DBTYPE_I4 , 2 will use the default account\n         .Configuration(LCD_CW &amp; \"smtpserverport\") = ConnectingDoor  ' 465 or 25 for t-online.de ' 465 'or 587 'or 25   ' The port of type somehow refered to by the last line\n         .Configuration(LCD_CW &amp; \"sendusername\") = UsrNme   '                                            .... \"server rejected your response\".  AFAIK : This will happen if you haven't setup an account in Outlook Express or Windows Mail .... Runtime error '-2147220975 (800440211)': The message could not be sent to the SMTP server. The transport error code is 0x80040217. The server response is not available\n         .Configuration(LCD_CW &amp; \"sendpassword\") = PssWrd\n        ' Optional - How long to try     ( End remote SMTP server configuration section )\n         .Configuration(LCD_CW &amp; \"smtpconnectiontimeout\") = 30 '    Or there Abouts ;) :)\n        ' Intraction protocol is Set/ Updated\n         .Configuration.fields.Update ' 'Not all infomation is given, some will have defaults. - possibly this might be needed initially ..    .Configuration.Load -1 ' CDO Source Defaults\n        'End With ' -------------------* my Created  LCDCW Library ( Linking Configuration Data Cods Wollups)  which are  used and items configured for the Exchange at Microsoft's protocol therof;\n        '2b) ' Data to be sent\n        .To = \"1234567890123@t-online.de\"\n        .CC = \"\" ' 1234567890@gmail.com\"\n        .BCC = \"\"\n        .From = Snd_Frm                           '                                             \"\"\"Avinash_gMail_Send\"\" &lt;\" &amp; UsrNme &amp; \"&gt;\"\n        .Subject = \"Hello from \" &amp; UsrNme &amp; \"\"    '                                             \"Pro f\u00fcr \" &amp; DieseArbeitsmappe1.LisWbProWb.Name\n        .TextBody = \"Hi\" &amp; vbCr &amp; vbLf &amp; \"Testing automated EMail sending. Please ignoor this EMail\"\n        '.HTMLBody = MyLengthyStreaming\n        '.htmlbody = ProTble\n        ' Add text file attachments\n        ' make file if it does not exist, or add to it\n        Dim Highway1 As Long: Let Highway1 = FreeFile(0) 'range 1 \u2013 255, inclusive - next free      The \"highway/ street/ link\" to be built to transport the text will be given a number. It must be unique. So we use for convenience, the Freefile function: it returns an integer that represents the next file number that the Open statement can use.  The optional argument for the range number is a variant that is used to specify a range from which the next free file number is returned. Enter a value of data type 0 (default) to return a file number in the range 1 - 255 inclusive. Enter 1 to return a file number in the range 256 - 511.   https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/freefile-function  . Note also : Use file numbers in the range 1-255, inclusive, for files not accessible to other applications. Use file numbers in the range 256-511 for files accessible from other applications\n         Open ThisWorkbook.Path &amp; \"\\\" &amp; \"CDOSendMailAttempt \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Append As #Highway1 ' Will be made if not there\n         Print #Highway1, \"EMail Address:\"\"\" &amp; UsrNme &amp; \"\"\"\" &amp; vbCrLf\n         Close #Highway1\n        'Dim DirTxtFl As String: Let DirTxtFl = Dir(ThisWorkbook.Path &amp; \"\\\" &amp; \"*.txt\")\n        '    Do While DirTxtFl &lt;&gt; \"\"\n        '        If VBA.Left$(DirTxtFl, 7) = \"Avinash\" Then .AddAttachment ThisWorkbook.Path &amp; \"\\\" &amp; DirTxtFl\n        '     Let DirTxtFl = Dir\n        '    Loop\n\n        'Rem 3 Do it\n         On Error GoTo Bed                                                                             ' Intended to catch a possible predicted error in the next line when running the routine\n         .send\n         On Error GoTo 0\n        ' MsgBox Prompt:=\"Done \" &amp; \"\"\"\" &amp; UsrNme &amp; \"\"\"\" &amp; \"(with \" &amp; SmptySvrPrt &amp; \")\"               ' This will typically give either  \"Done (with 25)\"  or   \"Done (with 465)\"  if the routine worked\n         Debug.Print \"Done \" &amp; \"\"\"\" &amp; UsrNme &amp; \"\"\"\"\n         Open ThisWorkbook.Path &amp; \"\\\" &amp; \"CDOSendMailAttempt \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Append As #Highway1 ' Will be made if not there\n         Print #Highway1, \"Sended \" &amp; Format(Now(), \"hh mm\") &amp; \"  \" &amp; vbCr &amp; vbLf\n         Close #Highway1\n\n        End With  ' CreateObject(\"CDO.Message\") (Rem 1 Library End =======#\n\n     Let FlagerMe = True   '   Boolean set to True after a succesful run of macro\n    Exit Sub               '   Normal succesful run of macro end\n Bed:\n     Debug.Print \"Not done \" &amp; \"\"\"\" &amp; UsrNme &amp; \"\"\"\" &amp; \"   Error is \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n     Open ThisWorkbook.Path &amp; \"\\\" &amp; \"CDOSendMailAttempt \" &amp; Format(Date, \"dddd dd mmmm yyyy\") &amp; \".txt\" For Append As #Highway1 ' Will be made if not there\n     Print #Highway1, \"Fail \" &amp; Format(Now(), \"hh mm\") &amp; \"   \" &amp; Err.Number &amp; \":  \" &amp; Err.Description &amp; vbLf\n     Close #Highway1\n    ' ' On Error GoTo -1 ' This takes out of the exceptional error handling state, so that the Error handler will work again ... not needed as the sub ends\n    ' Ending Sub  with  FagerMe  still set at  False\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10360, "favorite_count": 1, "accepted_answer_id": 59756971, "answer_count": 1, "score": 0, "last_activity_date": 1579248171, "creation_date": 1571841916, "question_id": 58525487, "link": "https://stackoverflow.com/questions/58525487/excel-vba-cdo-message-email-sending-accounts-work-less-and-less", "title": "Excel VBA CDO Message Email Sending accounts work less and less\u2026", "body": "<p>Herllo</p>\n\n<p>I have been trying to use some CDO Message VBA coding to automate sending short Emails. All is for private use, and never more than a couple of Emails per day. Either the Emailing is for people in my family, or other peple who I am sharing the coding with , for example on free help forums.\nMy macros definitely work, and in the past were very reliable. \nMore recently I am finding that more and more often an Email account no longer works. So I have to replace the sending  EMail account with another. \nI am running out of accounts that work.\nNew accounts either do not work, or work just a few times, and then on further attempts give various errors.\nDifferent accounts from the same provider which I am using all have identical settings and in some cases have been used previously in similar ways. But some accounts still work in the CDO message sending, others don\u2019t. It seems random which ones work and which don\u2019t, with a growing tendency for less and less to work.</p>\n\n<p>I cannot find any help from the EMail providers other than automated Q / A which does not address my problem, or useless time wasting telephone help lines</p>\n\n<p>Can anyone recommend an Email account provider whose accounts they are finding to work consistently in a CDO Message macro.</p>\n\n<p>I think I know about most of the required settings, since I have been able to get the accounts working previously. I am guessing that maybe spam software is being tightened up and as a by product genuine use gets more often blocked by mistake\u2026 and I guess that automated use of accounts is more likely to arouse  suspicion.</p>\n\n<p>gmail was always very reliable for me. But now 7 out of 10 accounts are not working. I cannot register anymore, as they limit you to just a few registrations per confirming telephone number. So I expect soon that gmail will no longer be an option for me.</p>\n\n<p>New accounts on yahoo and yandex usually work a few times then stop working. Once in a while they occasionally work again.</p>\n\n<p>The only provider I have currently working consistently is a small German telecom provider. But as per Sod\u2019s Law, some Email features that I need are available on most other providers, ..but not on this German one!! :--(</p>\n\n<p>I have access to a few different computers and internet connection possibilities at different locations. I get similar results in different places. So I do not think it is intermittent problems to do with my internet connection. What I mean by this is that an account that currently is working consistently will work in various places with different quality internet connections. </p>\n\n<p>My guess is that the problem is coming from automated security measures, which will be different for different providers, so that is why I an asking for other peoples experience with Email accounts and CDO Message sending coding.</p>\n\n<p>In all cases, an account that stops working in the CDO coding, still works manually. I am aware that there are temporary blocks often made when accounts are used from new locations. This only causes a temporary block. This is not my issue. These temporary blocks also occur on the working accounts, and I know how to deal with them. </p>\n\n<p>Thx\nAlan</p>\n"}, {"tags": ["vba", "ms-access", "configuration", "settings", "reusability"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571842539, "post_id": 58525442, "comment_id": 103376050, "body": "Create a module and put the configuration settings there?  That&#39;s typically what I do in a VBA project.  If you&#39;re looking for something more elaborate than that, then it might be useful to be a bit more detailed about what it is you&#39;re looking to implement."}, {"owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571842754, "post_id": 58525442, "comment_id": 103376184, "body": "Thx, it is a typical Thick Client application with UI and an access DB.  I just need to have a typical &quot;template&quot; file with the settings.  It be nice if it were an xml or text file( as opposed to a code file) because if I need to change it then I don&#39;t have to edit code files.  Could you provide some suggestions as to how I should do this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571843016, "post_id": 58525442, "comment_id": 103376314, "body": "There&#39;s nothing built-in like that - if you want something along those lines you&#39;d need to implement it - XML/JSON or plain text &quot;ini&quot; file could all work, depending on what settings you need to store."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1571843628, "post_id": 58525442, "comment_id": 103376637, "body": "See this. <a href=\"https://stackoverflow.com/questions/49112116/assigning-a-value-to-variablenameofvariable/49116217#49116217\" title=\"assigning a value to variablenameofvariable\">stackoverflow.com/questions/49112116/&hellip;</a>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1571843803, "post_id": 58525442, "comment_id": 103376727, "body": "<i>I need to change it then I don&#39;t have to edit code files.</i> A (surprise) <i>table</i> will fit that purpose."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1571847376, "post_id": 58525442, "comment_id": 103378567, "body": "Personally, I recommend using database properties. You can create and set your own properties (be sure to check they don&#39;t conflict with existing ones), easily look them up, and can store data with any type without worrying about separate tables for integers, doubles, text, etc."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1571848095, "post_id": 58525442, "comment_id": 103378900, "body": "all above comments are valid unless you edit your question and explain what exactly you are trying to achieve."}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1571857345, "creation_date": 1571857345, "answer_id": 58529468, "question_id": 58525442, "link": "https://stackoverflow.com/questions/58525442/implementing-common-configuration-settings-area-xml-or-txt-file-or-code-file/58529468#58529468", "title": "Implementing common configuration settings area ( xml or txt file or code file) MS Access application (VBA)", "body": "<p>As noted, I great way to do this is to simply create a table in the front end. It is  assumed that you will split your database into two  parts. The code/forms etc. is the so called front end,and then you have the back end part (the database - it can be a accDB file, or it can be say SQL server).</p>\n\n<p>So the typical update and deploy  of your software  will be:</p>\n\n<p>Re-link your tables from test database to the actual  live production database.</p>\n\n<p>Compile your accDB into a accDE.</p>\n\n<p>Deploy this new updated \"next\" version of your software to all the desktops. </p>\n\n<p>So, since any change or addition to settings will be in the new front end then any application wide settings you have will thus roll out with your update.</p>\n\n<p>It often depends on the user base. In the case that we had multiple customer sites running our software, then using a local table would not suffice, since things like path names, connection strings to the database etc. are customer specific. So, in this case we moved the settings table out to a text file (setup.ini). So we now use a setup.ini file that is external to the program and assumed to be deployed in the same folder as the front end. On startup we use the windows API to read \".ini\" files.</p>\n\n<p>So, both ideas (external setup.ini) or a local table in the front end are rather good choices from a development cycle point of view. </p>\n\n<p>So once you down the road in developing your application, and the table/data structure changes are down to a dull roar, then it is time to split your application. (use the built in split wizard for this). I will say that even for my .net applications, I still often use a external setup.ini file for settings, since once again with multiple customer sites, it not practical to have customer specific settings in the application as opposed to a external settings file. </p>\n"}], "owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571857345, "creation_date": 1571841775, "question_id": 58525442, "link": "https://stackoverflow.com/questions/58525442/implementing-common-configuration-settings-area-xml-or-txt-file-or-code-file", "title": "Implementing common configuration settings area ( xml or txt file or code file) MS Access application (VBA)", "body": "<p>I have very a rudimentary understanding  of Microsoft Access and VBA Code.</p>\n\n<p>On my work desktop, I have Microsoft Office Professional Plus 2013 Access</p>\n\n<p>I've been tasked to create a MS Access application with an Access DB.</p>\n\n<p>I started developing an MS Access application with Forms , and the corresponding DB \nI'm using VBA code event handlers(or Event Procedures) for the UI control buttons.</p>\n\n<p>I wanted to create a common configuration settings area for said application( like ASP.NET web application have web.config files or app.config files )</p>\n\n<p>I failed to find anything similar for MS Access application development.</p>\n\n<p>Could someone please provide me with an explanation as to how to implement an MS access  implementation model/software design pattern for common configuration settings area that is modular, reusable, clear and concise?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10050562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee5ba942edbc4ec5cab55135637d36a?s=128&d=identicon&r=PG&f=1", "display_name": "plank", "link": "https://stackoverflow.com/users/10050562/plank"}, "edited": false, "score": 0, "creation_date": 1571931509, "post_id": 58529734, "comment_id": 103410828, "body": "Thanks for the answer! That definitely looks promising. Could you give me a quick pointer on how one could check for text size and shape position?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 13, "user_id": 10050562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee5ba942edbc4ec5cab55135637d36a?s=128&d=identicon&r=PG&f=1", "display_name": "plank", "link": "https://stackoverflow.com/users/10050562/plank"}, "edited": false, "score": 0, "creation_date": 1571934670, "post_id": 58529734, "comment_id": 103412263, "body": "For position: If oShape.Left &gt; 36 And oShape.Left &lt; 108 And oShape.Top &gt; 36 And oShape.Top &lt; 108 Then  For text size: If oShape.TextFrame.TextRange.Font.Size &gt; 36 Then"}, {"owner": {"reputation": 13, "user_id": 10050562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee5ba942edbc4ec5cab55135637d36a?s=128&d=identicon&r=PG&f=1", "display_name": "plank", "link": "https://stackoverflow.com/users/10050562/plank"}, "edited": false, "score": 0, "creation_date": 1571940860, "post_id": 58529734, "comment_id": 103414958, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1571858648, "creation_date": 1571858648, "answer_id": 58529734, "question_id": 58525321, "link": "https://stackoverflow.com/questions/58525321/how-to-make-shapes-hastitle-find-all-titles-in-presentation-vba-ppt/58529734#58529734", "title": "How to make Shapes.HasTitle find all titles in presentation (VBA, .ppt)?", "body": "<p>This will get all the titles in a normal presentation. Each shape is checked for whether it has text and is a placeholder. If both are true it checks for the title placeholder format:</p>\n\n<pre><code>Sub GetTitles()\n  Dim oSlide As Slide, oShape As Shape\n  For Each oSlide In ActivePresentation.Slides\n    For Each oShape In oSlide.Shapes\n      If oShape.Type = msoPlaceholder And oShape.TextFrame.HasText Then\n        If oShape.PlaceholderFormat.Type = ppPlaceholderTitle Or _\n        oShape.PlaceholderFormat.Type = ppPlaceholderCenterTitle Then\n          MsgBox oShape.TextFrame.TextRange.Text\n        End If\n      End If\n    Next oShape\n  Next oSlide\nEnd Sub\n</code></pre>\n\n<p>If you have decks where users have repurposed titles for text boxes, or vice versa, you may have to do more checking based on the text size used and to see if the shape position is in the right area for a title.</p>\n"}], "owner": {"reputation": 13, "user_id": 10050562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee5ba942edbc4ec5cab55135637d36a?s=128&d=identicon&r=PG&f=1", "display_name": "plank", "link": "https://stackoverflow.com/users/10050562/plank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571858648, "creation_date": 1571841440, "question_id": 58525321, "link": "https://stackoverflow.com/questions/58525321/how-to-make-shapes-hastitle-find-all-titles-in-presentation-vba-ppt", "title": "How to make Shapes.HasTitle find all titles in presentation (VBA, .ppt)?", "body": "<p>I am trying to extract all titles from a presentation to an excel spreadsheet with its page index. My code works relatively well overall but is not picking up every title unfortunately.</p>\n\n<p>I basically used the <code>Shapes.HasTitle</code> method, my code is a bit sloppy (looping once to set the size of the array that will be used, then to populate the array) but is relatively straight forward otherwise.</p>\n\n<pre><code>Dim sld As Slide\nDim ppt As PowerPoint.Presentation\nDim wb As Workbook\nDim table As Range\nDim bottomLeft As Range\nDim titlesNPages() As Variant\n\nSet wb = ThisWorkbook\nmyFileName = Application.GetOpenFilename(filefilter:=\"PowerPoint Files,*.ppt*;*.pptx*\")\nIf myFileName &lt;&gt; False Then\n    Set ppt = PowerPointApp.Presentations.Open(myFileName)\nEnd If\n\n'Setting array to the right size (# of shapes with title)\nFor Each sld In ppt.slides\n    With sld\n        If .Shapes.HasTitle Then\n            i = i + 1\n        End If\n    End With\nNext sld\nReDim titlesNPages(1 To 2, 1 To i)\n\ni = 0\n\n'Populating array\nFor Each sld In ppt.slides\n    With sld\n        If .Shapes.HasTitle Then\n        i = i + 1\n            titlesNPages(1, i) = .SlideIndex 'Page index\n            titlesNPages(2, i) = .Shapes.Title.TextFrame.TextRange.Text 'Title\n        End If\n    End With\nNext sld\n\nWith wb.Worksheets(\"Sheet1\")\n    Set bottomLeft = .Range(\"B3\").Offset(UBound(titlesNPages, 2) - 1, 1)\n    Set table = .Range(\"B3:\" &amp; bottomLeft.Address)\n    table.Value = WorksheetFunction.Transpose(titlesNPages)\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The main issue is that Shapes.HasTitle doesn't seem to be picking up on all shapes that are titles nor on titles that were produced in a ppt that was in a language other than English.\nAny ideas to get this to work a bit better? It is currently getting close to 70% of titles (then I'll need to figure out how to deal with the textboxes that are actually titles)</p>\n"}, {"tags": ["excel", "vba", "rest", "api", "request"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571841814, "post_id": 58525282, "comment_id": 103375654, "body": "Shouldn&#39;t this be a <code>GET</code> request?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1571842029, "post_id": 58525282, "comment_id": 103375772, "body": "If it is post request (looks like it is in the docs), you need to POST the JSON in the body of the request, not the header. e.g. don&#39;t do <code>.SetRequestHeader &quot;service&quot;, &quot;company.list&quot;</code>, do this: <code>.Send &quot;{ &quot;&quot;service&quot;&quot;: &quot;&quot;company.list&quot;&quot; }&quot;</code>"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1571842150, "post_id": 58525282, "comment_id": 103375825, "body": "Seems based on their response that  they want to have the request encoded as a json object..but i can not see any curly braces in your request { - which simply means you do not send a JSON string. They provide a sample &quot; {   &quot;service&quot;: &quot;absence.list&quot;,   &quot;company&quot; : {&quot;id&quot; : 233}   }&quot; so format your response string according the Javascript Object notation (and their sample) and send this. You currently just sent plain test. And this will mix up the server which send you a 500 (usually internal server error). No wonder the Javascript interpreter get  a mal formated string."}, {"owner": {"reputation": 1, "user_id": 10321530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vcNlX3E1UmM/AAAAAAAAAAI/AAAAAAAADOs/UER7yGCbGME/photo.jpg?sz=128", "display_name": "Matheus Gratz", "link": "https://stackoverflow.com/users/10321530/matheus-gratz"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571842484, "post_id": 58525282, "comment_id": 103376005, "body": "@Zac the support team said to me that they just accept HTTP POST. That&#39;s why I&#39;m  using that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571842560, "post_id": 58525282, "comment_id": 103376061, "body": "&quot;500 - not found&quot; is weird. &quot;not found&quot; should be 404, 500 should be for an &quot;internal server error&quot;. Add to that, that the API apparently wants a POST request to <i>get</i> things, and that&#39;s a REST API one would justifiably qualify as wrong. Your only hope is that their documentation is actually up-to-date and accurately documents how to use this weird, broken API. The problem is the API, not the language you use to make the request - the API will be just as awkward &amp; wrong if you make the request in Java or Python."}, {"owner": {"reputation": 1, "user_id": 10321530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vcNlX3E1UmM/AAAAAAAAAAI/AAAAAAAADOs/UER7yGCbGME/photo.jpg?sz=128", "display_name": "Matheus Gratz", "link": "https://stackoverflow.com/users/10321530/matheus-gratz"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1571842657, "post_id": 58525282, "comment_id": 103376115, "body": "@RyanWildry It works. Know it&#39;s kinda clear to me.  Do you have any documentation o something that I can read about it?"}, {"owner": {"reputation": 1, "user_id": 10321530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vcNlX3E1UmM/AAAAAAAAAAI/AAAAAAAADOs/UER7yGCbGME/photo.jpg?sz=128", "display_name": "Matheus Gratz", "link": "https://stackoverflow.com/users/10321530/matheus-gratz"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571842708, "post_id": 58525282, "comment_id": 103376154, "body": "@MathieuGuindon you are right. The server returns &quot;Status 500 - Internal Server Error&quot;. I will correct my post. Tks"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1571843767, "post_id": 58525282, "comment_id": 103376700, "body": "You set <code>token64 = &quot;usernameEncoded64&quot;</code> - is this a &quot;short hand&quot; version of your actual encoding of your <code>authstring</code> or have you hard coded the API token they give you? The docs indicate that you need to use the API token as the username and <code>x</code> as the password, then <code>Base64Encode</code> that to insert into your <code>&quot;Authorization&quot;</code> header."}, {"owner": {"reputation": 1, "user_id": 10321530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vcNlX3E1UmM/AAAAAAAAAAI/AAAAAAAADOs/UER7yGCbGME/photo.jpg?sz=128", "display_name": "Matheus Gratz", "link": "https://stackoverflow.com/users/10321530/matheus-gratz"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1571845255, "post_id": 58525282, "comment_id": 103377495, "body": "@FreeMan I put &quot;usernameEncoded64&quot; to not share the token that I&#39;m using. I&#39;ve tried both ways: Base64Encoding the key (username+&quot;:&quot;+pass) and using their enconded key. Both works."}], "owner": {"reputation": 1, "user_id": 10321530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vcNlX3E1UmM/AAAAAAAAAAI/AAAAAAAADOs/UER7yGCbGME/photo.jpg?sz=128", "display_name": "Matheus Gratz", "link": "https://stackoverflow.com/users/10321530/matheus-gratz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571843326, "creation_date": 1571841326, "last_edit_date": 1571843326, "question_id": 58525282, "link": "https://stackoverflow.com/questions/58525282/vba-api-rest-returns-status-500", "title": "VBA API REST - Returns Status 500", "body": "<p>I'm trying to connect to an API from a web-based tool.\nReading their documentation, I figured out how to send requests via VBA (Excel - Code Below).</p>\n\n<ul>\n<li>The tool gives me the <code>username</code> (aka token), <code>password</code> and the <code>authString</code> (aka Base64 encoded token)</li>\n<li>Running the code, commenting the <code>.SetRequestHeader \"Authorization\", \"Basic \" &amp; token64</code> line returns <code>Status 401 - Unauthorized</code>.</li>\n<li>Running the code with the line <code>.SetRequestHeader \"Authorization\", \"Basic \" &amp; token64</code> returns <code>Status 500 - Internal server Error</code></li>\n<li>Asking the support team, they say to me that to get a response, I need to call a service, such as:</li>\n</ul>\n\n<blockquote>\n  <p>{   \"service\": \"company.list\" }</p>\n</blockquote>\n\n<p>My main objective here is to use VBA integration to pull some information via API to the tool, such as 'Projects', 'Customers', etc. </p>\n\n<p>What am I doing wrong? Can you guys please help me to accomplish my objective, sending me tips/documentation to read?\nShould I use another language but VBA (python, C#)?</p>\n\n<p>Website API documentation:\n<a href=\"https://beebole.com/timesheet-api/\" rel=\"nofollow noreferrer\">https://beebole.com/timesheet-api/</a></p>\n\n<h1>Code</h1>\n\n<pre><code>Option Explicit\n\nPublic Sub RESTtest()\n\n    Dim URL As String\n    Dim username As String\n    Dim password As String\n    Dim authString As String\n    Dim aSync As String\n    Dim token64 As String\n    Dim project As String\n\n\n        username = \"username\"\n        password = \"x\"\n        authString = username &amp; \":\" &amp; password\n\n        token64 = \"usernameEncoded64\"\n        URL = \"https://beebole-apps.com/api/v2\"\n        aSync = False\n\n\n    Dim restRequest As WinHttp.WinHttpRequest\n    Dim restResult As String\n\n        Set restRequest = New WinHttp.WinHttpRequest\n\n  With restRequest\n    .Open \"POST\", URL, aSync\n    .SetRequestHeader \"Content-type\", \"application/json\"\n    .SetRequestHeader \"service\", \"company.list\"\n    .SetRequestHeader \"Authorization\", \"Basic \" &amp; token64\n    .Send\n    .waitForResponse\n\n    Debug.Print \".ResponseText: \" &amp; .ResponseText\n    Debug.Print \".Status: \" &amp; .Status\n    Debug.Print \".StatusText: \" &amp; .StatusText\n    Debug.Print \".ResponseBody: \" &amp; .ResponseBody\n\n  End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571840452, "post_id": 58524967, "comment_id": 103374855, "body": "<code>activecell.row</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1571841181, "creation_date": 1571841181, "answer_id": 58525216, "question_id": 58524967, "link": "https://stackoverflow.com/questions/58524967/is-there-a-way-to-select-a-range-dynamically-in-a-macro-based-on-cursor-position/58525216#58525216", "title": "Is there a way to select a range dynamically in a macro based on cursor position?", "body": "<p>Replace the <code>.Copy</code> row with this:</p>\n\n<pre><code>ActiveSheet.Range(\"A\" &amp; ActiveCell.Row &amp; \":CO\" &amp; ActiveCell.Row).Copy\n</code></pre>\n\n<p>It builds a range string based on the <code>ActiveCell.Row</code>, similar to what you are doing on row 2 in your snippet.</p>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1571844043, "creation_date": 1571844043, "answer_id": 58526193, "question_id": 58524967, "link": "https://stackoverflow.com/questions/58524967/is-there-a-way-to-select-a-range-dynamically-in-a-macro-based-on-cursor-position/58526193#58526193", "title": "Is there a way to select a range dynamically in a macro based on cursor position?", "body": "<p>Simple solution using resize.</p>\n\n<pre><code>ActiveCell.Resize(, 93).Copy\nSheets(\"Completed\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12254696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf1402bb7f74604bf22d0bdea6553da?s=128&d=identicon&r=PG&f=1", "display_name": "Becki Schulz", "link": "https://stackoverflow.com/users/12254696/becki-schulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571844043, "creation_date": 1571840316, "last_edit_date": 1571840650, "question_id": 58524967, "link": "https://stackoverflow.com/questions/58524967/is-there-a-way-to-select-a-range-dynamically-in-a-macro-based-on-cursor-position", "title": "Is there a way to select a range dynamically in a macro based on cursor position?", "body": "<p>I want to copy rows from columns A to CO but the row will be different each time. I would like to copy the range of A:CO based on the postion of the cursor.</p>\n\n<pre><code>Range(\"A6:CO6\").Copy\n    Sheets(\"Completed\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    Sheets(\"Active\").Select\n    Rows(\"6:6\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<p>I would like to pick the row with cursor postion and have the range of A:CO copy to the Completed sheet. I have this macro working but only for row 6.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1571839857, "post_id": 58524704, "comment_id": 103374485, "body": "Note - this is probably doable with just a formula. Is VBA a must?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1571839951, "post_id": 58524704, "comment_id": 103374546, "body": "You could use a PivotTable for this."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1571840044, "post_id": 58524704, "comment_id": 103374609, "body": "Put in C2 and copy down: <code>=IF(A2&lt;&gt;A3,SUM($B$1:$B2)-SUM($C$1:$C1),&quot;&quot;)</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1571840553, "post_id": 58524704, "comment_id": 103374918, "body": "to keep your vba going I would create a variable to store the running total and then when A does not match the previous A, paste the variable to the spreadsheet"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571840908, "post_id": 58524704, "comment_id": 103375141, "body": "@BigBen VBA isn&#39;t necessarily a must but I was trying not to bog the spreadsheet down with formulas. What I&#39;m showing as an example is a simplified version of the spreadsheet which does have a ton of formulas. Which is why I decided to switch to VBA for this particular part."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571841031, "post_id": 58524704, "comment_id": 103375220, "body": "You can write the formula, and then hard-code its value (with <code>.Value</code> = <code>.Value</code> on the range)."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1571841087, "post_id": 58524704, "comment_id": 103375252, "body": "@Damian I would agree but since this is just an example of what I&#39;m doing the actual spreadsheet is much more complex and uses a ton of formulas etc... In order to keep things together I can&#39;t really get away with a PivotTable. I appreciate the suggestion though!"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571841156, "post_id": 58524704, "comment_id": 103375291, "body": "@BigBen oh good idea! that should do the trick!"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571841233, "post_id": 58524704, "comment_id": 103375343, "body": "@ScottCraner thanks for the formula! I think if I hardcode that using BigBen&#39;s suggestion that should get me where I need to be. Thanks everyone!"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1571841945, "post_id": 58525236, "comment_id": 103375721, "body": "that&#39;s exactly what I was looking for! Appreciate your&#39;s and everyone else help too!"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 2, "last_activity_date": 1571841209, "creation_date": 1571841209, "answer_id": 58525236, "question_id": 58524704, "link": "https://stackoverflow.com/questions/58524704/add-totals-to-last-row-of-criteria/58525236#58525236", "title": "Add totals to last row of criteria", "body": "<p>Here's a version using the variable <code>total</code> to be the running total. When the <code>spread</code> in the next row doesn't match the current row, the <code>total</code> is written in the column to the right.</p>\n\n<pre><code>Sub SpacingTotals()\n\n    Dim total As Long\n\n    Dim spread As Range\n    For Each spread In Range(\"A2:A\" &amp; Range(\"A\" &amp; Rows.count).End(xlUp).Row)\n\n        total = total + spread.offset(0, 1).Value2\n\n        If spread.Value2 &lt;&gt; spread.offset(1, 0).Value2 Then\n            spread.offset(0, 2).Value2 = total\n            total = 0\n        End If\n\n    Next spread\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58525236, "answer_count": 1, "score": 0, "last_activity_date": 1571897848, "creation_date": 1571839557, "last_edit_date": 1571897848, "question_id": 58524704, "link": "https://stackoverflow.com/questions/58524704/add-totals-to-last-row-of-criteria", "title": "Add totals to last row of criteria", "body": "<p>I'm trying to set up a simple macro to add totals from column B based on the spread number of column A. Using VBA I have the following code:</p>\n\n<pre><code>Sub SpacingTotals()\n    Dim Rng As Range, Dn As Range, Temp As Range\n\n    Set Rng = Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n    Set Temp = Rng(1)\n\n    For Each Dn In Rng\n        If Not Dn.Value = Temp Then\n            Set Temp = Dn\n        End If\n\n        Dn.Offset(, 0) = Dn.Value\n        Temp.Offset(, 2) = Temp.Offset(, 2) + Dn.Offset(, 1).Value\n    Next Dn\n\nEnd Sub\n</code></pre>\n\n<p>The problem I'm having is more of a formatting issue. I want the totals on the last line of the spread criteria rather than the first line (See image).</p>\n\n<p>Any push in the right direction would be appreciated.</p>\n\n<p><img src=\"https://i.stack.imgur.com/PrVfQ.png\" alt=\"Should be\"></p>\n"}, {"tags": ["excel", "vba", "email"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571839305, "post_id": 58524588, "comment_id": 103374125, "body": "Please be specific: what doesn&#39;t work? Note <code>Cells(cell.Row, &quot;M&quot;)</code> seems redundant - <code>cell</code> is already in column M."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571839426, "post_id": 58524588, "comment_id": 103374215, "body": "Also - the result of <code>LCase</code> can never be equal to <code>No</code> (which has an <i>uppercase</i> N), perhaps a typo?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571839843, "post_id": 58524588, "comment_id": 103374478, "body": "Adding to @BigBen comments, another approach would be to filter column <code>M</code> for values with <b>&quot;No&quot;</b> and then send emails for all visible rows"}, {"owner": {"reputation": 41, "user_id": 4633011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152789357188576/picture?type=large", "display_name": "Tomas Joe Gemine", "link": "https://stackoverflow.com/users/4633011/tomas-joe-gemine"}, "edited": false, "score": 0, "creation_date": 1571990020, "post_id": 58524588, "comment_id": 103428347, "body": "update: it was the uppercase N that was preventing anything from happening. after changing it to &quot;no&quot; it works!  Thanks for you help guys, something so small ey!"}], "owner": {"reputation": 41, "user_id": 4633011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152789357188576/picture?type=large", "display_name": "Tomas Joe Gemine", "link": "https://stackoverflow.com/users/4633011/tomas-joe-gemine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571977016, "creation_date": 1571839138, "last_edit_date": 1571977016, "question_id": 58524588, "link": "https://stackoverflow.com/questions/58524588/vba-to-send-email-to-an-email-address-in-excel-depending-on-cell-value", "title": "VBA to send email to an email address in excel depending on cell value", "body": "<p>I am completely stuck and wondering if someone could help, please bare with my complete Noobness on VBA. </p>\n\n<p>I have a shared spreadsheet that my team use to keep on track of tasks of documents that need to be rescanned. Please see the screenshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JNA7p.png\" rel=\"nofollow noreferrer\">Screenshot</a></p>\n\n<p>I have code on the sheet that automatically changes column 'M' when an agent enters a value into column A. </p>\n\n<p>Column B (hidden) has a Vlookup which uses an array on a different sheet for the agent in column A's email address. </p>\n\n<p>I've done a bit of research and have tried to create a code that will search in column M for any incompleted/Unactioned work \"NO\" and automatically send an email reminder to the agent and and email address in columns A and B of the same row (also including the Title Number)</p>\n\n<p>However I just cannot get the code to work. </p>\n\n<p>Any thoughts or suggestions where I'm going wrong? </p>\n\n<pre><code>\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range\n\n    Application.ScreenUpdating = False\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    On Error GoTo cleanup\n    For Each cell In Columns(\"M\").Cells.SpecialCells(xlCellTypeConstants)\n        If LCase(Cells(cell.Row, \"M\").Value) = \"No\" Then\n\n            Set OutMail = OutApp.CreateItem(0)\n            On Error Resume Next\n            With OutMail\n                .To = cell.Value\n                .Subject = \"Re-Scan Reminder\"\n                .Body = \"Dear \" &amp; Cells(cell.Row, \"A\").Value _\n                      &amp; vbNewLine &amp; vbNewLine &amp; _\n                        \"You still have outstanding work on the Rescan Spreadsheet \" &amp; _\n                        \" Title number:  \" &amp; Cells(cell.Row, \"E\").Value _\n\n                .Display\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n    Next cell\n\ncleanup:\n    Set OutApp = Nothing\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "find-replace"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571839125, "post_id": 58524542, "comment_id": 103374018, "body": "Is that sheet active when you run the macro? You should in any case read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571839814, "post_id": 58524542, "comment_id": 103374458, "body": "Yes sheet 1 (raw data) is active when i try to run the macro but it does not work.  I read the link you sent and tried to change it to some of those options and none of them worked either."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1571840806, "post_id": 58524910, "comment_id": 103375090, "body": "this worked except for one....the town of Mullins   (must have the s on the end)  if someone manually types Mullin....i would like it to find that as an error and replace with Mullins.     it didn&#39;t do that one. why?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 1, "creation_date": 1571840928, "post_id": 58524910, "comment_id": 103375159, "body": "So Mullin appears in H and then on your other sheet you&#39;d need Mullin in A and Mullins in B. That should work - is that what you&#39;ve done?"}, {"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1571841241, "post_id": 58524910, "comment_id": 103375349, "body": "yes.  but now it is changing &quot;mullins&quot; in column H to &quot;mullinss&quot; ....but like N Charleston....it changes to North Charleston just fine.  Same with West Cola changing to West Columbia.   those 2 worked great."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 1, "creation_date": 1571841406, "post_id": 58524910, "comment_id": 103375439, "body": "Ah yes well if you have &quot;Mullins&quot; in H and you&#39;re looking up part of the cell it will find &quot;Mullin&quot; (everything except the &quot;s&quot;) and replace that with &quot;Mullins&quot; so you end up with an extra &quot;s&quot;. Make sense? You&#39;ll either need an exact match or use regular expressions, or possibly another way though hard to say without seeing any data."}, {"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1571841675, "post_id": 58524910, "comment_id": 103375582, "body": "nevermind.  i figured it out.   I then went back to the CITY FIND REPLACE list and added one at the bottom to MULLINSS in column A and MULLINS in column B so that it would change those back in the same run of the macro and it worked!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1571840146, "creation_date": 1571840146, "answer_id": 58524910, "question_id": 58524542, "link": "https://stackoverflow.com/questions/58524542/excel-vba-find-and-replace-from-a-table-on-difference-worksheet/58524910#58524910", "title": "Excel VBA find and replace from a table on difference worksheet", "body": "<p>I can't see any reason why this wouldn't work.</p>\n\n<pre><code>Sub FindReplace()\n\nFor i = 2 To 40\n    Worksheets(\"RAW DATA\").Range(\"H:H\").Replace what:=Worksheets(\"CITY FIND REPLACE\").Cells(i, 1).Value, _\n                                   replacement:=Worksheets(\"CITY FIND REPLACE\").Cells(i, 2).Value, lookat:=xlPart, _\n                                    searchorder:=xlByRows, MatchCase:=False\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 58524910, "answer_count": 1, "score": 0, "last_activity_date": 1571841504, "creation_date": 1571839012, "last_edit_date": 1571841504, "question_id": 58524542, "link": "https://stackoverflow.com/questions/58524542/excel-vba-find-and-replace-from-a-table-on-difference-worksheet", "title": "Excel VBA find and replace from a table on difference worksheet", "body": "<p>I am working on a project that will filter our SC sales taxes by tax codes. In order to do this, I have to write some codes to get things corrected e.g. the city names. Seeing that sometimes this information is manually put into our system, the spellings can vary causing my codes to not work properly. So, I have created a new worksheet \"CITY FIND REPLACE\" where there is a \"find\" column(A) of incorrect spellings and a \"replace\" column (B) with the way it needs to be so that my codes work correctly. I need it in a table so that each month I do it and find more/different spellings of the cities, I can add them to the search list so that it will catch and change them.</p>\n\n<p>I am having a hard time getting the code I have found to pull from a different worksheet and I am not sure what I am doing wrong. I want it to search through Column H on Sheet1 (RAW DATA) (the # of rows can change each month as well so I just need it to go through the bottom of the data but that can't be a set #) and then compare each cell to Sheet12 (CITY FIND REPLACE) TABLE 1 column A. If they match, change it to Sheet12 (CITY FIND REPLACE) column B.</p>\n\n<p>Note: VBA coding is not my thing. I fumbled through and used stackoverflow to help me on another project and now my work thinks I am good at this... and I am not. I don't understand it. Any help in plain English would be amazing.</p>\n\n<pre><code>Sub FindReplace()\n\n    For i = 2 To 40\n        Worksheets(\"RAW DATA\").Range(\"H:H\").Select\n        Selection.Replace what:=Worksheets(\"CITY FIND REPLACE\").Cells(i, 1).Value,\n        replacement:=Worksheets(\"CITY FIND REPLACE\").Cells(i, 2).Value, lookat:=xlPart,\n        searchorder:=xlByRows, MatchCase:=False\n\n    Next\n\n    Worksheets(\"RAW DATA\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>I am right now getting  </p>\n\n<blockquote>\n  <p>RUN TIME ERROR'1004': SELECT METHOD OF RANGE CLASS FAILED. </p>\n</blockquote>\n\n<p>When I click debug it will highlight the line <code>Worksheets(\"RAW DATA\").Range(\"H:H\").Select</code>.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571840819, "post_id": 58524525, "comment_id": 103375095, "body": "This is probably not in the least bit helpful, but have you considered INDEX? I only mention because I had this in mind <a href=\"https://www.excelforum.com/tips-and-tutorials/758402-vba-working-with-areas-within-2d-arrays.html\" rel=\"nofollow noreferrer\">excelforum.com/tips-and-tutorials/&hellip;</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571843687, "post_id": 58524525, "comment_id": 103376653, "body": "@Sjr thanks for the link, I have been tinkering around with Index as well though without success so far. Obviously will inform when I do manage to find something."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571858027, "post_id": 58527378, "comment_id": 103383123, "body": "Nice work, wonder what put you on to CHOOSE. Next steps - non-consecutive sheets, different cells? An intellectual exercise or for something specific?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571859437, "post_id": 58527378, "comment_id": 103383655, "body": "Yes next step is non consecutive sheets, and it&#39;s all really an intellectual exercise @SJR, I am always telling people to use arrays so I was wondering how else I could get arrays quickly and can&#39;t recall I have seen something like this before. There always was a loop involved. So I started of with the dynamic sheets array, then this. <code>CHOOSE</code> came into the picture when I was thinking which functions would take non consecutive cells. On to non-consecutive sheets now....=). Thanks"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1571901316, "last_edit_date": 1571901316, "creation_date": 1571848363, "answer_id": 58527378, "question_id": 58524525, "link": "https://stackoverflow.com/questions/58524525/retrieve-one-dimensional-array-of-values-directly-through-evaluate/58527378#58527378", "title": "Retrieve one-dimensional array of values directly through Evaluate", "body": "<p>Eventually using <code>CHOOSE</code> in the <code>.Evaluate</code> did it for me:</p>\n\n<pre><code>Dim lwr As Long: lwr = 2\nDim uppr As Long: uppr = 5\n\nDim shts As Variant: shts = Application.Evaluate(\"TRANSPOSE(\"\"Sheet\"\"&amp;ROW(\" &amp; lwr &amp; \":\" &amp; uppr &amp; \")&amp;\"\"!A1\"\")\")\nDim vals As Variant: vals = Application.Evaluate(\"TRANSPOSE(CHOOSE(ROW(1:\" &amp; uppr - lwr + 1 &amp; \"),\" &amp; Join(shts, \",\") &amp; \"))\")\n</code></pre>\n\n<p>What I did here:</p>\n\n<ul>\n<li>Get a lower bound > <code>lwr</code></li>\n<li>Get a upper bound > <code>uppr</code></li>\n<li>Get an array of ranges through <code>.Evaluate</code> with those bounds</li>\n<li>Get an array of values through <code>Join</code> of the previous array within an <code>.Evaluate</code> that makes use of <code>CHOOSE</code>.</li>\n</ul>\n\n<p>If for example <code>Sheet2!A1</code> = <code>4</code>, <code>Sheet3!A1</code> = <code>5</code>, <code>Sheet4!A1</code> = <code>1</code>, <code>Sheet5!A1</code> = <code>Test</code></p>\n\n<p>The above code will then return the following for <code>vals</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vk5Wq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vk5Wq.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, it holds a one-dimensional array with variant values. Exactly what I wanted. I'm now able to get a dynamic array pulling values from different sheets in one go.</p>\n"}], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 2, "accepted_answer_id": 58527378, "answer_count": 1, "score": 2, "last_activity_date": 1571901316, "creation_date": 1571838980, "last_edit_date": 1571844219, "question_id": 58524525, "link": "https://stackoverflow.com/questions/58524525/retrieve-one-dimensional-array-of-values-directly-through-evaluate", "title": "Retrieve one-dimensional array of values directly through Evaluate", "body": "<p><strong><em>Background:</em></strong></p>\n\n<p>In my <a href=\"https://stackoverflow.com/q/58505728/9758194\">former</a> question I set up how I retrieved a range of worksheets in an array in order to loop through them.</p>\n\n<p>I would like to take it a step further and instead retrieve an array of values, e.g.: <code>{\"Val1\", \"Val2\", \"Val3\"}</code></p>\n\n<p><strong><em>Code:</em></strong></p>\n\n<p>To work with the following codes, you could replicate what I'm trying to achieve with creating a bunch of sheets, named \"Sheet1\", \"Sheet2\" etc etc. Then input a module:</p>\n\n<pre><code>Sub Test\n\nDim lwr As Long: lwr = 2\nDim uppr As Long: uppr = 5\n\n'Options will follow here *\n\nEnd sub\n</code></pre>\n\n<p>This is how I would retrieve the worksheet array with dynamic row variables. You will see it will pull an array of sheetnames that we could use in for example: <code>For Each ws In ThisWorkbook.Sheets(shts)</code>:</p>\n\n<pre><code>Dim shts As Variant: shts = Application.Evaluate(\"TRANSPOSE(\"\"Sheet\"\"&amp;ROW(\" &amp; lwr &amp; \":\" &amp; uppr &amp; \"))\")\n</code></pre>\n\n<p>Now however, I would like to take an array of values directly from these sheets. This is how I would retrieve the cells I'm interested in (the same cell across all sheets), e.g. <code>A1</code>:</p>\n\n<pre><code>Dim shts As Variant: shts = Application.Evaluate(\"TRANSPOSE(\"\"Sheet\"\"&amp;ROW(\" &amp; lwr &amp; \":\" &amp; uppr &amp; \")&amp;\"\"!A1\"\")\")\n</code></pre>\n\n<p>The cells references are rather pointless, but one example this would work with is when all values would be numeric and I want to be able to sum like this:</p>\n\n<pre><code>Debug.Print Application.Evaluate(\"SUM(\" &amp; Join(shts, \",\") &amp; \")\")\n</code></pre>\n\n<p>However I would like to pull them into an array variable directly (without a loop through sheets), no matter numeric or non-numeric, e.g: <code>{5,3,\"Val1\",6}</code></p>\n\n<p><strong><em>Problem:</em></strong></p>\n\n<p>I've tried several things amongst <code>INDIRECT</code>, <code>VALUE</code>, and even <code>ADDRESS</code> to put the range into a named range first. All attempts are futile since none of these functions seem to work with arrays. For example:</p>\n\n<pre><code>Dim vals As Variant: vals = Application.Evaluate(\"TRANSPOSE(INDIRECT(\"\"Sheet\"\"&amp;ROW(\" &amp; lwr &amp; \":\" &amp; uppr &amp; \")&amp;\"\"!A1\"\"))\")\n</code></pre>\n\n<p>Will throw an array with a bunch of errors as the problem most likely lays with non-contiguous ranges.</p>\n\n<p><strong><em>Question:</em></strong></p>\n\n<p>Any way to retrieve an one-dimensional array succesfully directly through evaluation? Or is what I'm seeking simply not possible, which in that case brings me back to a loop to get my array.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571838433, "post_id": 58524312, "comment_id": 103373601, "body": "If Sheet1 has data in A35, then <code>lastrow</code> from <code>lastrow = Worksheets(&quot;Sheet1&quot;).Cells(Rows.Count, 1).End(xlUp).Row</code> will equal 35."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571838781, "post_id": 58524312, "comment_id": 103373805, "body": "^ So &quot;this means the code only copy and paste up until cell A28&quot; doesn&#39;t make sense to me."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1571838793, "post_id": 58524312, "comment_id": 103373811, "body": "hi. the problem is that op doesnt know witch column has more lines. he have to test all the columns and get the biggest lastrow"}, {"owner": {"reputation": 19, "user_id": 11863410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43e34601c89b369f1c9dd22569d9708?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst1", "link": "https://stackoverflow.com/users/11863410/analyst1"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571838827, "post_id": 58524312, "comment_id": 103373833, "body": "Thanks @BigBen, you&#39;re right it copies up until A35 but minus the rows with the blank cells (A29 and A31), so rather than copying all 35 rows on column A and C, there are only 33 rows on sheet2, hope this makes sense, thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571838903, "post_id": 58524312, "comment_id": 103373870, "body": "If you want to find the last effective row in a <i>sheet</i>, see the approach in the answer to <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571839172, "post_id": 58524312, "comment_id": 103374051, "body": "No need for a loop. Just transfer the entire range in one go, and the blanks will transfer from sheet1 to sheet2."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571839067, "post_id": 58524537, "comment_id": 103373979, "body": "I think you can get rid of the loop here, and this will eliminate OP&#39;s problem with blanks."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571839168, "post_id": 58524537, "comment_id": 103374047, "body": "@BigBen - yes you&#39;re probably right but am going to leave for now as not completely sure what OP wants."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571839204, "post_id": 58524537, "comment_id": 103374071, "body": "I think you&#39;ve nailed the problem with &quot;if you are copying blank cells, the last row will not update.&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571839299, "post_id": 58524537, "comment_id": 103374121, "body": "Might the OP wanting to be eliminate the blanks. Otherwise it&#39;s a 1-liner as you suggest."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571839390, "post_id": 58524537, "comment_id": 103374192, "body": "I was interpreting <a href=\"https://stackoverflow.com/questions/58524312/how-to-copy-columns-with-blank-cells-and-paste-in-new-worksheet-vba#comment103373833_58524312\">this comment</a>, which seems to suggest OP still wants the blanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571839553, "post_id": 58524537, "comment_id": 103374302, "body": "^ and I completely agree with you on that :)"}, {"owner": {"reputation": 19, "user_id": 11863410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43e34601c89b369f1c9dd22569d9708?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst1", "link": "https://stackoverflow.com/users/11863410/analyst1"}, "edited": false, "score": 0, "creation_date": 1571839606, "post_id": 58524537, "comment_id": 103374336, "body": "Thanks @SJR, unfortunately it errored with run time error &quot;9&quot;, subscript out of range with this row highlighted in yellow. Worksheets(&quot;Sheet2&quot;).Cells(erow + 1, 1).Value = .Cells(i, 1).Value."}, {"owner": {"reputation": 19, "user_id": 11863410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43e34601c89b369f1c9dd22569d9708?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst1", "link": "https://stackoverflow.com/users/11863410/analyst1"}, "edited": false, "score": 0, "creation_date": 1571839987, "post_id": 58524537, "comment_id": 103374571, "body": "Just to clarify, the issue is this: I have 35 employees on &quot;sheet1&quot; with many columns. I want to copy certain columns but in different order to &quot;sheet2&quot;, the issue is that all columns have blank cells but on different rows including on column A which is the employee number. I want all employees to be listed even if their number, name or address cells are blank, hope this explains better."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571840257, "post_id": 58524537, "comment_id": 103374746, "body": "What&#39;s the value of erow when it errors, and what&#39;s in the cell being copied?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571840369, "post_id": 58524537, "comment_id": 103374811, "body": "Why doesn&#39;t BigBen&#39;s suggestion to copy and paste in one go not work for you? There is no obvious need for your loop based on what you&#39;ve shown here."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571840565, "post_id": 58524537, "comment_id": 103374929, "body": "Depending on your version of Excel, PowerQuery/Get and Transform will do what you want quite nicely (export and reorder columns)."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 19, "user_id": 11863410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43e34601c89b369f1c9dd22569d9708?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst1", "link": "https://stackoverflow.com/users/11863410/analyst1"}, "edited": false, "score": 1, "creation_date": 1571840979, "post_id": 58524537, "comment_id": 103375187, "body": "@Analyst1 what do you mean by &quot;different order&quot;? your question or code does not represent what you just stated. Please update your question and provide an example of your start and finish product"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1571840178, "last_edit_date": 1571840178, "creation_date": 1571839004, "answer_id": 58524537, "question_id": 58524312, "link": "https://stackoverflow.com/questions/58524312/how-to-copy-columns-with-blank-cells-and-paste-in-new-worksheet-vba/58524537#58524537", "title": "How to copy columns with blank cells and paste in new worksheet VBA?", "body": "<p>Assuming Luis Curado has diagnosed your problem correctly, you can find the larger of the last cell row in A and C.</p>\n\n<p>Also you had some confused syntax here</p>\n\n<pre><code>Worksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 1)\n</code></pre>\n\n<hr>\n\n<p>Finally, you can transfer the values without involving the clipboard.</p>\n\n<pre><code>Sub Transfer_Macro()\n\nDim lastrow As Long, erow As Long\n\nWith Worksheets(\"Sheet1\")\n    lastrow = WorksheetFunction.Max(.Cells(Rows.Count, 1).End(xlUp).Row, .Cells(Rows.Count, 3).End(xlUp).Row) 'could use Find instead for this\n    For i = 2 To lastrow\n        erow = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n        Worksheets(\"Sheet2\").Cells(erow + 1, 1).Value = .Cells(i, 1).Value\n        Worksheets(\"Sheet2\").Cells(erow + 1, 3).Value = .Cells(i, 3).Value\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Note that if you are copying blank cells, the last row will not update.</p>\n"}], "owner": {"reputation": 19, "user_id": 11863410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43e34601c89b369f1c9dd22569d9708?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst1", "link": "https://stackoverflow.com/users/11863410/analyst1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571897839, "creation_date": 1571838274, "last_edit_date": 1571897839, "question_id": 58524312, "link": "https://stackoverflow.com/questions/58524312/how-to-copy-columns-with-blank-cells-and-paste-in-new-worksheet-vba", "title": "How to copy columns with blank cells and paste in new worksheet VBA?", "body": "<p>The code below works but does not copy over rows with blank cells, for example \"Sheet1\" has a total of 35 rows and 56 columns but certain cells are blank e.g. cell A28 &amp; A31, this means the code will copy and paste 33 rows in \"Sheet2\" which excludes rows 28 and 31 instead of all 35 rows.</p>\n\n<p>How can I change this to copy all 35 rows irrespective of whether it has blank cells or not? </p>\n\n<p>My objective is to copy 10 specific columns for all 35 rows from \"Sheet1\" which has 56 columns to \"Sheet2\" which is currently blank and in different column order. Hope this makes sense.</p>\n\n<pre><code>Sub Transfer_Macro ()\n'\nDim lastrow As Long, erow As Long\n\nlastrow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To lastrow\n\nWorksheets(\"Sheet1\").Cells(i, 1).Copy\n\nerow = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n\nWorksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 1)\n\nWorksheets(\"Sheet1\").Cells(i, 3).Copy\n\nWorksheets(\"Sheet1`\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 3)\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 6, "creation_date": 1571836791, "post_id": 58523712, "comment_id": 103372639, "body": "Times are doubles, not dates."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1571838053, "post_id": 58523712, "comment_id": 103373391, "body": "You can also use <code>?typename(cell.value)</code> in Immediate Window to determine cell&#39;s datatype."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1571838825, "post_id": 58523712, "comment_id": 103373831, "body": "You could look at its <code>.NumberFormat</code> returning <code>h:mm</code> for example?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7956679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ee9309c80bb5faf542003565588f36?s=128&d=identicon&r=PG&f=1", "display_name": "user104430", "link": "https://stackoverflow.com/users/7956679/user104430"}, "is_accepted": false, "score": 0, "last_activity_date": 1573206119, "last_edit_date": 1573206119, "creation_date": 1573199397, "answer_id": 58762506, "question_id": 58523712, "link": "https://stackoverflow.com/questions/58523712/how-to-check-if-cell-value-is-time-vba/58762506#58762506", "title": "How to check if cell value is time - VBA", "body": "<p>You can use\uff1a</p>\n\n<pre><code>isdate(format(now(),\"yyyy-mm-dd \") &amp; \"yourtime\")\n</code></pre>\n\n<p>The same to isdate.</p>\n\n<pre><code>?isdate(format(now(),\"yyyy-mm-dd \") &amp; \"12:12:13\")\n\nTrue\n\n?isdate(format(now(),\"yyyy-mm-dd \") &amp; \"32:12:13\")\n\nFalse\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CPXbR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CPXbR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573206119, "creation_date": 1571836428, "last_edit_date": 1571836743, "question_id": 58523712, "link": "https://stackoverflow.com/questions/58523712/how-to-check-if-cell-value-is-time-vba", "title": "How to check if cell value is time - VBA", "body": "<p>I m trying to check if cell value it time without luck. </p>\n\n<p>I use <code>IsDate(cell.value)</code> but always get <code>False</code>.\ncolumn format is <code>Time</code></p>\n\n<p>Data structure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YVBTS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YVBTS.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1571835751, "post_id": 58523413, "comment_id": 103371931, "body": "You can do this with <code>VLookup</code>. You don&#39;t need VBA for this"}, {"owner": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571839929, "post_id": 58523413, "comment_id": 103374534, "body": "@Zac How can Vlookup satisfies two criterias of matching? Moreover, I have 2000+ data."}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 5045578, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9-VygvgDnJY/AAAAAAAAAAI/AAAAAAAAEi4/-NYkWDu8Zek/photo.jpg?sz=128", "display_name": "Michal Schmitt", "link": "https://stackoverflow.com/users/5045578/michal-schmitt"}, "is_accepted": true, "score": 1, "last_activity_date": 1571841215, "creation_date": 1571841215, "answer_id": 58525239, "question_id": 58523413, "link": "https://stackoverflow.com/questions/58523413/matching-the-data-across-column-and-rows-using-vba/58525239#58525239", "title": "Matching the data across column and rows using VBA", "body": "<p>Since you asked for a VBA solution, please see the code below.</p>\n\n<pre><code>Dim colLen As Integer\nDim i As Integer\nDim colPt As Integer\nDim rowPt As Integer\n\n' Counts number of rows on Sheet 1, column B.\ncolLen = Sheets(1).Cells(Rows.Count, \"B\").End(xlUp).Row\n\n' Loops through all names on Sheet 1.\nFor i = 2 To colLen\n' Retain US or NA ID for blank cells.\n    If Sheets(1).Cells(i, 1) &lt;&gt; \"\" Then\n        If Sheets(1).Cells(i, 1) = \"US\" Then\n            colPt = 2\n        Else\n            colPt = 3\n        End If\n    End If\n\n' Find name on Sheet 2 and set row.\n    rowPt = Sheets(2).Range(\"A:A\").Find(Sheets(1).Cells(i, 2)).Row\n' Add ID from Sheet 2 to Sheet 3\n    Sheets(1).Cells(i, 3) = Sheets(2).Cells(rowPt, colPt)\n\nNext i\n</code></pre>\n\n<p>Assumptions:</p>\n\n<ol>\n<li>Sheet 1 is the main worksheet, sheet 2 has the lookup data.</li>\n<li>All names in the lookup data are unique.</li>\n</ol>\n\n<p>I would recommend including the ID in every row instead of treating it as a heading but that's preference.  There are formula solutions that would work for this as well if you want to skip VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1571841305, "creation_date": 1571841305, "answer_id": 58525272, "question_id": 58523413, "link": "https://stackoverflow.com/questions/58523413/matching-the-data-across-column-and-rows-using-vba/58525272#58525272", "title": "Matching the data across column and rows using VBA", "body": "<p>There are a few ways to approach this. Below is one of them:</p>\n\n<p><strong>NOTE</strong>: for simplicity, I have kept my data on one sheet. You can amend the below formulas as your data is on 2 sheets. Saying that, I have used the same columns as you have in your query</p>\n\n<p><strong>Solution:</strong>\nHave a <strong>\"holding column\"</strong>. In my example, I used column <code>J</code> as the holding column (you can hide this column if you want). In <code>J2</code>, type the following formula: <code>=IF(ISBLANK($K2), $J1,$K2)</code>. Copy the formula down to all used rows. Then copy the following formula in <code>M2</code>: <code>=VLOOKUP($L2,$A$3:$C$8,IF($J2=\"US\",2,3),FALSE)</code>. As per before, copy the formula down to all used rows. This should give you your results</p>\n"}], "owner": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58525239, "answer_count": 2, "score": 0, "last_activity_date": 1571841305, "creation_date": 1571835509, "last_edit_date": 1571836449, "question_id": 58523413, "link": "https://stackoverflow.com/questions/58523413/matching-the-data-across-column-and-rows-using-vba", "title": "Matching the data across column and rows using VBA", "body": "<p>I have two sheets :                                                    </p>\n\n<p>Sheet 1 consist of :</p>\n\n<p><img src=\"https://i.stack.imgur.com/3phsx.png\" alt=\"Sheet1\"></p>\n\n<p>Sheet 2 consist of :</p>\n\n<p><img src=\"https://i.stack.imgur.com/MkaiM.png\" alt=\"Sheet2\"></p>\n\n<p>And the output should show in M column in Sheet1. I am attaching the sample output here :</p>\n\n<p><img src=\"https://i.stack.imgur.com/LIKlo.png\" alt=\"Sample Output\"></p>\n\n<p>So,what I have here is ID in Sheet 1, for eg : ID 'US' has Abhay,Carl and Dev\nand in Sheet3, I have names in column and ID in Rows.\nWhat i want is my Sample output column should populate using macro based on matched values from Sheet3</p>\n\n<p>I am using below logic but something is going wrong : </p>\n\n<pre><code>For i = 2 To 10\nj = i + 1\nIf ThisWorkbook.Sheets(\"Input\").Range(\"N\" &amp; i) = ThisWorkbook.Sheets(\"Sheet3\").Range(\"A\" &amp; i) And ThisWorkbook.Sheets(\"Input\").Range(\"K\" &amp; i) = ThisWorkbook.Sheets(\"Sheet3\").Range(\"B1\") Then\n    ThisWorkbook.Sheets(\"Input\").Range(\"O\" &amp; i) = ThisWorkbook.Sheets(\"Sheet3\").Range(\"B\" &amp; j)\nEnd If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571836015, "post_id": 58523353, "comment_id": 103372096, "body": "So... slightly confused - your example has multiple columns (A, B, C) but you say &quot;You get it all in 1 column.&quot; Is your code right (because it seems like you could just cut <code>A14:C6368</code> and paste in B1 to achieve what it is doing)?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12263176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e844ea3be8941f876e07a7b725e07667?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre73953", "link": "https://stackoverflow.com/users/12263176/pierre73953"}, "edited": false, "score": 1, "creation_date": 1571842524, "post_id": 58523444, "comment_id": 103376035, "body": "That&#39;s amazing, thank you so much! I&#39;m suprised by how long it takes to run, but that&#39;s exactly what I needed. You&#39;re a star!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 13, "user_id": 12263176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e844ea3be8941f876e07a7b725e07667?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre73953", "link": "https://stackoverflow.com/users/12263176/pierre73953"}, "edited": false, "score": 0, "creation_date": 1571843389, "post_id": 58523444, "comment_id": 103376521, "body": "@Pierre73953 well there are ways of simplifying - I&#39;m still confused why you need a loop/VBA here, per my previous <a href=\"https://stackoverflow.com/questions/58523353/basic-copy-loop-problem-with-range-column-iteration/58523444?noredirect=1#comment103372096_58523353\">comment</a>"}, {"owner": {"reputation": 13, "user_id": 12263176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e844ea3be8941f876e07a7b725e07667?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre73953", "link": "https://stackoverflow.com/users/12263176/pierre73953"}, "edited": false, "score": 0, "creation_date": 1571846621, "post_id": 58523444, "comment_id": 103378185, "body": "The data is in 1 column. Rows 2 and 3 in the code i posted were just me showing the automation needed. Basically, every 14th row, the rest of the column is pasted onto the next column, row 1, and so on ~500x, which is what your function does."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1571835584, "creation_date": 1571835584, "answer_id": 58523444, "question_id": 58523353, "link": "https://stackoverflow.com/questions/58523353/basic-copy-loop-problem-with-range-column-iteration/58523444#58523444", "title": "Basic copy loop problem with range &amp; column iteration", "body": "<p>Something like the following perhaps:</p>\n\n<pre><code>Dim i As Long \nFor i = 1 To 500\n    Range(Cells(14, i), Cells(6368, i)).Cut Destination:=Cells(1, i + 1)\nNext\n</code></pre>\n\n<p>You can also use <code>Offset</code>.</p>\n\n<pre><code>Dim i As Long\nFor i = 0 To 499\n    Range(\"A14:A6368\").Offset(, i).Cut Destination:=Range(\"B1\").Offset(, i)\nNext\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12263176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e844ea3be8941f876e07a7b725e07667?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre73953", "link": "https://stackoverflow.com/users/12263176/pierre73953"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 58523444, "answer_count": 1, "score": 1, "last_activity_date": 1571835584, "creation_date": 1571835316, "last_edit_date": 1571835362, "question_id": 58523353, "link": "https://stackoverflow.com/questions/58523353/basic-copy-loop-problem-with-range-column-iteration", "title": "Basic copy loop problem with range &amp; column iteration", "body": "<p>how can i turn the following into a 500x loop?</p>\n\n<pre><code>Range(\"A14:A6368\").Cut Range(\"B1\")\nRange(\"B14:B6368\").Cut Range(\"C1\")\nRange(\"C14:C6368\").Cut Range(\"D1\")\n</code></pre>\n\n<p>Basically, I copied a table on the web, when I paste into excel, I get it all in 1 column. \nMust be simple, but I've spent hours googling and I cannot find the solution!</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1571834784, "post_id": 58523141, "comment_id": 103371381, "body": "...maybe you add some screenshots to clarify!"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1571834924, "post_id": 58523141, "comment_id": 103371469, "body": "Step 1:  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid Using Select</a>  Step 2: Funnily enough, <code>Application.ScreenUpdating = True</code> sets Screen Updating to <code>True</code>, not <code>False</code>.  Then you shows your InputBox, and (<b>after</b> the InputBox has opened, been used, and been closed) <i>then</i> you are setting <code>Application.ScreenUpdating = false</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1571836890, "post_id": 58523141, "comment_id": 103372701, "body": "@Chronocidal: I am against using things like <code>Select</code> but I think this is one of the very few instances where <code>Select</code> is probably needed as OP is selecting sheets so that user can select a range from <code>Sheet1</code>. This is the reason why OP is also setting screen updating to <b>true</b>. Saying that, I am with DisplayName!.. I have no idea what OP&#39;s query is"}, {"owner": {"reputation": 11, "user_id": 7794309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258e6d1a105ed5d06334383806f82987?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Abadinia", "link": "https://stackoverflow.com/users/7794309/mahdi-abadinia"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1571837708, "post_id": 58523141, "comment_id": 103373188, "body": "@Chronocidal: I need to have data changing and keeping between &quot;all subs&quot; in the cell, the best way was to use select. the point is this to update screen to true then false so that user can select from another sheet and then back to sheet2 and showing sheet2 while a cell in sheet1 is active"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571839239, "post_id": 58523141, "comment_id": 103374091, "body": "Still not clear on your query. Are you saying that once you set screen updating to <code>False</code>, screen is still showing what you are doing on <code>Sheet2</code>?"}, {"owner": {"reputation": 11, "user_id": 7794309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258e6d1a105ed5d06334383806f82987?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Abadinia", "link": "https://stackoverflow.com/users/7794309/mahdi-abadinia"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571839943, "post_id": 58523141, "comment_id": 103374542, "body": "@Zac yes, when I set screen updating to false still screen updates as code goes. I also added screen shot of sheets."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1571840104, "post_id": 58523141, "comment_id": 103374650, "body": "My understanding is that <code>.activate</code> and <code>.select</code> will immediately turn screen updating back on.  Right after you set <code>.screenupdating = false</code> you use <code>.activate</code> which means, yes, you will see that screen flicker."}, {"owner": {"reputation": 11, "user_id": 7794309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258e6d1a105ed5d06334383806f82987?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Abadinia", "link": "https://stackoverflow.com/users/7794309/mahdi-abadinia"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571841626, "post_id": 58523141, "comment_id": 103375557, "body": "@Cyril: I used this trick once, and worked fine the exact code runs by &quot;UserForm_Initialize&quot;"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571845199, "post_id": 58523141, "comment_id": 103377463, "body": "Not sure why you need to <code>Activate</code> the cell? You already have access to the cell via VBA"}, {"owner": {"reputation": 11, "user_id": 7794309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258e6d1a105ed5d06334383806f82987?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Abadinia", "link": "https://stackoverflow.com/users/7794309/mahdi-abadinia"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1572085004, "post_id": 58523141, "comment_id": 103456990, "body": "@Zac I need to have data changing and keeping the data and format cell between &quot;all subs&quot;"}], "owner": {"reputation": 11, "user_id": 7794309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258e6d1a105ed5d06334383806f82987?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi Abadinia", "link": "https://stackoverflow.com/users/7794309/mahdi-abadinia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571839788, "creation_date": 1571834606, "last_edit_date": 1571839788, "question_id": 58523141, "link": "https://stackoverflow.com/questions/58523141/screen-updating-does-not-change-to-false", "title": "Screen Updating does not change to false", "body": "<p>I need to work on cell by activating it but another cell in another sheet being shown, so before showing the userform ScreenUpdating is set to false. in the userform when one check box is selected below code will run to switch between sheets so that some data be selected from sheet1 and then showing sheet2 while the previous cell is still activated.\n<a href=\"https://i.stack.imgur.com/PMmNk.png\" rel=\"nofollow noreferrer\">These are the sheets i need to switch between</a>                               </p>\n\n<pre><code>Application.ScreenUpdating = True\nSheets(\"Sheet1\").Select\n\nSet rRange = Application.InputBox(Prompt:= _\n               \"Please select the Ticket ID with your Mouse.\", _\n                   Title:=\"Title\", Default:=\"\", Type:=8)\nSheets(\"Sheet2\").Activate\n\nApplication.ScreenUpdating = false\n\nSheets(\"Sheet1\").Activate  ' previous cell row number is stored in Sheets(\"Sheet2\").Range(\"A1\")\nSheets(\"Sheet1\").Cells(Sheets(\"Sheet2\").Range(\"A1\").Value, Sheets(\"Sheet1\").Rows(1).Find(\"head1\", , xlValues, xlWhole).Column).Activate\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571834279, "post_id": 58522983, "comment_id": 103371126, "body": "Just to clarify - this code is currently in Powerpoint, right? Is there any reason for <code>ppApp</code> then?"}, {"owner": {"reputation": 1, "user_id": 12213975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rgg8eM73HJo/AAAAAAAAAAI/AAAAAAAABQU/Kf5umfoZCbs/photo.jpg?sz=128", "display_name": "Abhishek Kulkarni", "link": "https://stackoverflow.com/users/12213975/abhishek-kulkarni"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571834877, "post_id": 58522983, "comment_id": 103371443, "body": "Yup sir, the code is in powerpoint  and neglect the ppApp I will comment it"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571839493, "post_id": 58522983, "comment_id": 103374265, "body": "Does this code work? you have a lot of <code>End If</code> without any starting <code>If</code> blocks.. maybe I&#39;ve missed something"}, {"owner": {"reputation": 1, "user_id": 12213975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rgg8eM73HJo/AAAAAAAAAAI/AAAAAAAABQU/Kf5umfoZCbs/photo.jpg?sz=128", "display_name": "Abhishek Kulkarni", "link": "https://stackoverflow.com/users/12213975/abhishek-kulkarni"}, "edited": false, "score": 0, "creation_date": 1571895578, "post_id": 58522983, "comment_id": 103392473, "body": "yes it works for only replacing one cell data with a slide shape but I want this process to do with 21 cell data has to replaced in slide shapes and sorry for that end If I forgot to comment that"}], "owner": {"reputation": 1, "user_id": 12213975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rgg8eM73HJo/AAAAAAAAAAI/AAAAAAAABQU/Kf5umfoZCbs/photo.jpg?sz=128", "display_name": "Abhishek Kulkarni", "link": "https://stackoverflow.com/users/12213975/abhishek-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1582781749, "creation_date": 1571834066, "last_edit_date": 1582781749, "question_id": 58522983, "link": "https://stackoverflow.com/questions/58522983/how-to-increment-the-cell-value-horizontally-in-vba-macro", "title": "how to increment the cell value horizontally? in VBA macro", "body": "<p>I'm writing VBA program in powerpoint </p>\n\n<p><strong>The flow of program:</strong> VBA powerpoint macro have to open the excel file and <strong>copy and replace</strong> cell content to the specific shape in a specific slide.<br>\nHere the excel file has 21 columns. I have to <strong>copy and replace</strong> cell <strong>data</strong> to <strong>slide shape</strong> in slide #8. How to <strong>increment</strong> the cell value <strong>horizontally?</strong> Like a1 to b1 till 21 cells and repeat the same from beginning  </p>\n\n<p>here the code </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub xltoppt()\n\nDim xlApp As Object\nDim xlWorkBook As Object\n\nSet xlApp = CreateObject(\"Excel.Application\")\n\nxlApp.Visible = True\nSet xlWorkBook = xlApp.Workbooks.Open(\"C:\\Users\\\\Desktop\\test.xls\", True, False)\n\nSet xlApp = Nothing\nSet xlWorkBook = Nothing\n\nDim SheetName As String\nDim TestRange As Range\nDim TestSheet As Worksheet\nDim PasteRange As Boolean\nDim RangePasteType As String\nDim RangeName As String\nDim AddSlidesToEnd As Boolean\nDim shts As Worksheet\nDim sld As Slide\nDim grpItem As Shape\nDim shp As Shape\nDim i As Long\nDim j As Long\n\nSheetName = ActiveSheet.Name\n\n'Setting PasteRange to True means that Chart Option will not be used\nPasteRange = True\nRangeName = (\"B1:B1\") '\"MyRange\"\nRangePasteType = \"HTML\"\nRangeLink = True\n\nPasteChart = False\nPasteChartLink = True\nChartNumber = 1\n\nAddSlidesToEnd = True\n\n'Error testing\nOn Error Resume Next\nSet TestSheet = Sheets(SheetName)\nSet TestRange = Sheets(SheetName).Range(RangeName)\nSet TestChart = Sheets(SheetName).ChartObjects(ChartNumber)\nOn Error GoTo 0\n\n'If TestSheet Is Nothing Then\n'MsgBox \"Sheet \" &amp; SheetName &amp; \" does not exist. Macro will exit\", vbCritical\nExit Sub\n'End If\n\n'If PasteRange And TestRange Is Nothing Then\nMsgBox \"Range \" &amp; RangeName &amp; \" does not exist. Macro will exit\", vbCritical\nExit Sub\n'End If\n\n'Look for existing instance\n'On Error Resume Next\n'Set ppApp = GetObject(, \"PowerPoint.Application\")\n'On Error GoTo 0\n\n'Create new instance if no instance exists\n''If ppApp Is Nothing Then Set ppApp = New PowerPoint.Application\n'Add a presentation if none exists\n'If ppApp.Presentations.Count = 0 Then ppApp.Presentations.Add\n\n'Make the instance visible\nppApp.Visible = True\n\n'Check that a slide exits, if it doesn't add 1 slide. Else use the last slide for the paste operation\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n\nIf shp.HasTextFrame Then\n            If shp.TextFrame.HasText Then\n                shp.TextFrame.TextRange.Text = replace(shp.TextFrame.TextRange.Text, \"happy\", Worksheets(SheetName).Range(RangeName))\n\nEnd If\n\nEnd If\n\nNext shp\nNext\n\n\nEnd Sub```\n\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1571833003, "post_id": 58522565, "comment_id": 103370433, "body": "Exporting as PDF as a fixed format or saving as csv is two very different things. Have a look <a href=\"https://stackoverflow.com/q/10551353/9758194\">here</a>"}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1571833192, "post_id": 58522565, "comment_id": 103370539, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42068803/save-copies-as-pdf-xlsx\">Save copies as .PDF &amp; .xlsx</a>"}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1571833249, "post_id": 58522565, "comment_id": 103370564, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"http://stackoverflow.com/help\">help center</a>, in particular <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a>. Your best bet here is to do your research, search for related topics on SO, and give it a go. After doing more research and searching, post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> of your attempt and say specifically where you&#39;re stuck, which can help you get better answers."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 10867189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gV_nfI5zrLQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYzWv5emqCz9bfWiaFYLBB7rVHMcg/mo/photo.jpg?sz=128", "display_name": "Mehmet Canbulat", "link": "https://stackoverflow.com/users/10867189/mehmet-canbulat"}, "is_accepted": false, "score": 0, "last_activity_date": 1571832995, "creation_date": 1571832995, "answer_id": 58522678, "question_id": 58522565, "link": "https://stackoverflow.com/questions/58522565/saving-a-csv-to-desktop-regardless-of-user/58522678#58522678", "title": "Saving a csv to desktop regardless of user", "body": "<p>This Should Work. Tested</p>\n\n<pre><code>Sub SaveCSVtoDesktop()\n\nActiveWorkbook.SaveAs Filename:=CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; _\nApplication.PathSeparator &amp; \"Your File Name\" &amp; \".csv\", FileFormat:=xlCSV, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12262993, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAoxFYGaGd8iKj5zmTefhe-Mzqo_XcTqAqMmJ-4Zw=k-s128", "display_name": "Alex", "link": "https://stackoverflow.com/users/12262993/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571832995, "creation_date": 1571832615, "last_edit_date": 1571832948, "question_id": 58522565, "link": "https://stackoverflow.com/questions/58522565/saving-a-csv-to-desktop-regardless-of-user", "title": "Saving a csv to desktop regardless of user", "body": "<p>I'm trying to save a CSV file that can then be saved on any users desktop. I've been reading through a lot of threads, and I seem to be getting close, but just don't have the right mix! </p>\n\n<p>The code below does exactly what I want...except it saves as a PDF rather than a CSV because it uses the exportasfixedformat object. </p>\n\n<p>I think I need to use 'save as' for a CSV, but I cant work out how to then mix in the \"userprofile\" command to save regardless of user login. </p>\n\n<pre><code>Private Sub CommandButton1_Click() \n\nSub SavePDF()     \nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _                   \n          Filename:= Environ(\"USERPROFILE\") &amp; \"\\Desktop\\Export.pdf\", _        \n          OpenAfterPublish:=True \nEnd Sub  \n</code></pre>\n"}, {"tags": ["vba", "for-loop", "ms-word", "bookmarks"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571830125, "post_id": 58521717, "comment_id": 103368752, "body": "hi. u have a double Each, so, it only add a bookmark if a sentence and a bookmark exists. u must get only the sentences and then add the bookmark"}, {"owner": {"reputation": 13, "user_id": 11808707, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GT0ofVNeS_o/AAAAAAAAAAI/AAAAAAAABew/rt7k9TjhJDA/photo.jpg?sz=128", "display_name": "Colin Miller", "link": "https://stackoverflow.com/users/11808707/colin-miller"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571831119, "post_id": 58521717, "comment_id": 103369332, "body": "Thanks, Luis. So how would that update the above code?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1571832904, "post_id": 58521717, "comment_id": 103370381, "body": "You should be aware that Word doesn&#39;t really understand sentences so the results you get may be not what you are expecting. Paragraphs yes, sentences no."}, {"owner": {"reputation": 13, "user_id": 11808707, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GT0ofVNeS_o/AAAAAAAAAAI/AAAAAAAABew/rt7k9TjhJDA/photo.jpg?sz=128", "display_name": "Colin Miller", "link": "https://stackoverflow.com/users/11808707/colin-miller"}, "edited": false, "score": 0, "creation_date": 1571835821, "post_id": 58521717, "comment_id": 103371981, "body": "Great point. Didn&#39;t think about the names of sentences. Might try to create a bookmark for each paragraph and then try another strategy. The trustee goal is to find overlapping text as granular as possible without overloading system resources"}, {"owner": {"reputation": 13, "user_id": 11808707, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GT0ofVNeS_o/AAAAAAAAAAI/AAAAAAAABew/rt7k9TjhJDA/photo.jpg?sz=128", "display_name": "Colin Miller", "link": "https://stackoverflow.com/users/11808707/colin-miller"}, "edited": false, "score": 0, "creation_date": 1571836131, "post_id": 58521717, "comment_id": 103372168, "body": "Blasted android autocorrect. *Issues with sentences. **Ultimate goal"}], "answers": [{"tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": -1, "last_activity_date": 1571838067, "creation_date": 1571838067, "answer_id": 58524228, "question_id": 58521717, "link": "https://stackoverflow.com/questions/58521717/word-vba-how-to-fix-for-each-loop-to-add-bookmark-to-each-sentence/58524228#58524228", "title": "Word VBA: How to Fix FOR EACH loop to add bookmark to each sentence?", "body": "<p>u can try like this</p>\n\n<pre><code>Sub tryAddBmarkatSentence()\nDim myRange As Range\nSet myRange = ActiveDocument.Content\nDim bmark As Bookmark\n\nApplication.ScreenUpdating = False\n\nFor Each MySent In ActiveDocument.Sentences\n\n        ActiveDocument.Bookmarks.Add ... and the rest of the code.\n        //i dont know how you define witch bookmark is to asign to that sentence\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1571849734, "creation_date": 1571849734, "answer_id": 58527686, "question_id": 58521717, "link": "https://stackoverflow.com/questions/58521717/word-vba-how-to-fix-for-each-loop-to-add-bookmark-to-each-sentence/58527686#58527686", "title": "Word VBA: How to Fix FOR EACH loop to add bookmark to each sentence?", "body": "<p>The following works for me, as far as the requirements in the question go.</p>\n\n<p>Please remember to put <code>Option Explicit</code> at the top of a code page. This will force you to declare (\"Dim\") variables, but will also save time and trouble as it will prevent typos and warn you of other problems.</p>\n\n<p>A <code>Sentence</code> in Word returns a <code>Range</code> object, so the code below delares <code>MySent As Range</code>. This provides the target <code>Range</code> for the <code>Bookmarks.Add</code> method.</p>\n\n<p>If you won't be doing anything else with the bookmark, it's not strictly necessary to <code>Set bkm =</code> when adding the bookmark. I left it in since it is declared in the code in the question.</p>\n\n<p>It's not necessary to loop the collection of bookmarks - espeicially since there aren't any - they're being added. </p>\n\n<p>I've added some code for naming the bookmarks, as well.</p>\n\n<pre><code>Sub tryAddBmarkatSentence()\n    Dim doc As Word.Document\n    Dim MySent As Word.Range\n    Dim bmark As Bookmark\n\n    Application.ScreenUpdating = False\n    Set doc = ActiveDocument\n\n    For Each MySent In doc.Sentences\n        Set bmark = doc.Bookmarks.Add(Name:=\"bmark\" &amp; _\n        MySent.Information(wdActiveEndAdjustedPageNumber) &amp; \"_\" &amp;_\n        MySent.Information(wdFirstCharacterLineNumber) &amp; \"_\" &amp; _\n        MySent.Information(wdFirstCharacterColumnNumber), Range:=MySent)\n        'bmark name would have added info of page, line, and col number. here as example is pagenumber.\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11808707, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GT0ofVNeS_o/AAAAAAAAAAI/AAAAAAAABew/rt7k9TjhJDA/photo.jpg?sz=128", "display_name": "Colin Miller", "link": "https://stackoverflow.com/users/11808707/colin-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571849734, "creation_date": 1571829672, "last_edit_date": 1571829858, "question_id": 58521717, "link": "https://stackoverflow.com/questions/58521717/word-vba-how-to-fix-for-each-loop-to-add-bookmark-to-each-sentence", "title": "Word VBA: How to Fix FOR EACH loop to add bookmark to each sentence?", "body": "<p>Within a Word docx: I'm trying to add a bookmark to each sentence. For example, at first sentence would be bookmark \"bmarkpg01\" and second sentence would be bookmark \"\"bmarkpg01ln01col01\"\". My code adds only one bookmark to first sentence and doesn't loop through to end of document.</p>\n\n<p>I've tried a for each loop to attempt each sent in sentences and each bmark in bookmark. </p>\n\n<pre><code>Sub tryAddBmarkatSentence()\nDim myRange As Range\nSet myRange = ActiveDocument.Content\nDim bmark As Bookmark\n\nApplication.ScreenUpdating = False\n\nFor Each MySent In ActiveDocument.Sentences\n    For Each bmark In ActiveDocument.Bookmarks\n        ActiveDocument.Bookmarks.Add Name:=\"pmark\" &amp; bmark.Range.Information(wdActiveEndAdjustedPageNumber), Range:=myRange 'bmark name would have added info of page, line, and col number. here as example is pagenumber.\n\n    Next\nNext\n\nEnd Sub\n</code></pre>\n\n<p>EXPECTED RESULT: Within entire document, each sentence has a corresponding bookmark and bookmark name (\"bmarkpg01ln01col01\", \"bmarkpg01ln02col10\", etc.)</p>\n\n<p>ACTUAL RESULTS: only one bookmark is added to the first sentence of the document.</p>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2016"], "comments": [{"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 2, "creation_date": 1571828969, "post_id": 58521341, "comment_id": 103368167, "body": "Is this a typo or are you missing one parenthesis at the beginning of the iif statement... it should be <code>=IIF((</code> in your case..."}, {"owner": {"reputation": 1, "user_id": 12262610, "user_type": "registered", "profile_image": "https://graph.facebook.com/2684238931598019/picture?type=large", "display_name": "Scott Ward", "link": "https://stackoverflow.com/users/12262610/scott-ward"}, "reply_to_user": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 1, "creation_date": 1571831471, "post_id": 58521341, "comment_id": 103369527, "body": "Yes...typo on my part and once inserted, resolves the issue.  I&#39;ll be over in the corner of shame if anybody needs me,  Thanks"}], "owner": {"reputation": 1, "user_id": 12262610, "user_type": "registered", "profile_image": "https://graph.facebook.com/2684238931598019/picture?type=large", "display_name": "Scott Ward", "link": "https://stackoverflow.com/users/12262610/scott-ward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571837799, "creation_date": 1571828392, "last_edit_date": 1571837799, "question_id": 58521341, "link": "https://stackoverflow.com/questions/58521341/multiple-or-conditions-relating-to-value-of-a-parameter", "title": "Multiple OR conditions relating to value of a parameter", "body": "<p>I have an SSRS report that I'm working on that returns multiple rows and columns of data.                                                  </p>\n\n<p>I would like to have a parameter that allows the user to enter a value for the data to be filtered on.\nThe catch is that this parameters value may be in any one of multiple columns.</p>\n\n<p>I was hoping to use a filter expression that utilities multiple OR conditions.</p>\n\n<p><img src=\"https://i.stack.imgur.com/i65yY.jpg\" alt=\"screenshot of filter setup\"></p>\n\n<p>The expression I have currently (that isn't working) is:</p>\n\n<pre><code>=IIf(Fields!Call_ID.Value = Parameters!SearchFor.Value)\nor(Fields!Surname.Value = Parameters!SearchFor.Value) \nor (Fields!Mobile.Value = Parameters!SearchFor.Value) \nor (Fields!Land_Tel.Value = Parameters!SearchFor.Value) \nor (Fields!Email.Value = Parameters!SearchFor.Value) \nor (Fields!Postcode.Value = Parameters!SearchFor.Value) \nor (Fields!Product_Class.Value = Parameters!SearchFor.Value) \nor (Fields!Referral_Authorisation_Number.Value = Parameters!SearchFor.Value ), \"Include\", \"Exclude\")\n</code></pre>\n\n<p>Any help would be gratefully received.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1571832675, "post_id": 58521222, "comment_id": 103370243, "body": "If the code is running but you feel there can be an improvement, then consider posting it on <a href=\"https://codereview.stackexchange.com/\">Code Review</a> instead. It&#39;s of topic on here."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12262609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD_tlAcsp0KbS1sHuHe7b_PSOvSNiigm6DdT83vmQ=k-s128", "display_name": "Eleazer Mojica", "link": "https://stackoverflow.com/users/12262609/eleazer-mojica"}, "edited": false, "score": 0, "creation_date": 1572313008, "post_id": 58524458, "comment_id": 103513078, "body": "Hi Ryan, thank you very much for your answer. I already fixed the problem by creating a dll file which will be reference to Excel VBA."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1571838759, "creation_date": 1571838759, "answer_id": 58524458, "question_id": 58521222, "link": "https://stackoverflow.com/questions/58521222/looking-for-the-fastest-way-to-check-if-an-executable-file-is-still-running-usin/58524458#58524458", "title": "Looking for the fastest way to check if an executable file is still running using excel vba", "body": "<p>This might be not working exactly as you are expecting as the like query isn't quite implemented correctly. I've fixed this and added a few optimizations, mainly reducing the number of returned query terms, adding an exact match method, and added a caching method to store a reference to the computer prior to the query.</p>\n\n<pre><code>Option Explicit\n\n'Function averages 0.03 seconds on my machine\nPublic Function IsExeRunning(sExeName As String, _\n                             Optional sComputer As String = \".\", _\n                             Optional ExactMatch As Boolean = False) As Boolean\nOn Error GoTo Error_Handler\n    Static Computer As Object\n    Dim Process     As Object\n    Dim SearchQuery As String\n    IsExeRunning = False\n\n    'Cache Computer reference\n    If Computer Is Nothing Or sComputer &lt;&gt; \".\" Then Set Computer = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\" &amp; sComputer &amp; \"\\root\\cimv2\")\n\n    'Build query\n    If ExactMatch Then\n        SearchQuery = \"SELECT Name FROM Win32_Process WHERE Name = '\" &amp; sExeName &amp; \"'\"\n    Else\n        SearchQuery = \"SELECT Name FROM Win32_Process WHERE Name like '%\" &amp; sExeName &amp; \"%'\"\n    End If\n\n    Set Process = Computer.ExecQuery(SearchQuery)\n    If Process Is Nothing Then Exit Function\n    If Process.Count = 0 Then Exit Function\n    IsExeRunning = True\n\nError_Handler_Exit:\n     Exit Function\n\nError_Handler:\n     Resume Error_Handler_Exit\nEnd Function\n\nSub TestRunner()\n    Dim t As Single\n    t = Timer\n    Debug.Print \"Function returns \" &amp; IsExeRunning(\"Excel\", \".\", False) &amp; \" took: \" &amp; Timer - t &amp; \" seconds\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12262609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD_tlAcsp0KbS1sHuHe7b_PSOvSNiigm6DdT83vmQ=k-s128", "display_name": "Eleazer Mojica", "link": "https://stackoverflow.com/users/12262609/eleazer-mojica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571838759, "creation_date": 1571827994, "last_edit_date": 1571830321, "question_id": 58521222, "link": "https://stackoverflow.com/questions/58521222/looking-for-the-fastest-way-to-check-if-an-executable-file-is-still-running-usin", "title": "Looking for the fastest way to check if an executable file is still running using excel vba", "body": "<p>I have a codes that checks if an executable file is still running or not, but the problem is I find it quite slow when checking if the executable file is running or not. Is there a fastest way to do it? </p>\n\n<pre><code> Public Function IsExeRunning(sExeName As String, Optional sComputer As \n String = \".\") As Boolean\n     On Error GoTo Error_Handler\n     Dim objProcesses    As Object\n\nSet objProcesses = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\" &amp; sComputer &amp; \"\\root\\cimv2\").ExecQuery(\"SELECT * FROM Win32_Process WHERE Name  like '\" &amp; sExeName &amp; \"'\") ' = '\" &amp; sExeName &amp; \"'\")\nIf objProcesses.Count &lt;&gt; 0 Then IsExeRunning = True\n\nError_Handler_Exit:\n     On Error Resume Next\n     Set objProcesses = Nothing\n     Exit Function\n\nError_Handler:\n    MsgBox \"The following error has occured.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"Error Number: IsExeRunning\" &amp; vbCrLf &amp; _\n        \"Error Description: \" &amp; Err.Description, _\n        vbCritical, \"An Error has Occured!\"\n     Resume Error_Handler_Exit\n End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571828358, "post_id": 58521107, "comment_id": 103367845, "body": "What for example is in <code>Range(&quot;FILE_SOURCE&quot;)</code>?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1571828496, "post_id": 58521107, "comment_id": 103367899, "body": "You are asking users to enter the names of workbooks into a spreadsheet.  This kind of request is not nice to the user.  What you should have is two buttons in your dashboard which link to the Application FIleOpen dialogs which allow the users to use the filepicker to select the relevant workbooks.  In that way you will avoid completely the issues you are currently facing and make your dashboard much easier for the users to use."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1571828527, "post_id": 58521107, "comment_id": 103367913, "body": "I don&#39;t see why it wouldn&#39;t work if these workbooks are open, are you sure your variables match wb names? Did you consider <code>Set wbSource = Workbooks.Open(filepath)</code> if these are always the same, otherwise maybe let the user select these workbooks using <code>Application.FileDialog(msoFileDialogFilePicker)</code> ?"}], "owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571827563, "creation_date": 1571827563, "question_id": 58521107, "link": "https://stackoverflow.com/questions/58521107/setting-workbook-with-variable-name", "title": "Setting workbook with variable name", "body": "<p>I am encountering a strange issue when I use variable names to define and set variables for workbooks. The user opens three workbooks (dashboard, source and target). In the dashboard workbook the user then inputs the names of the source and target workbooks - so for instance \"source.xls\" and \"target.xlsm\". These inputs are defined as ranged names called \"FILE_SOURCE\" and \"FILE_TARGET\".</p>\n\n<p>As such, I use the range names to define my workbook variables as in the following:</p>\n\n<pre><code>Dim sourceModel, targetModel As String\nsourceModel = wbMainDashboard.Range(\"FILE_SOURCE\") 'Pull from dashboard input (works)\ntargetModel = wbMainDashboard.Range(\"FILE_TARGET\") 'Pull from dashboard input (works)\n\n'Source and target workbooks\nDim wbSource As Workbook: Set wbSource = Workbooks(sourceModel) 'Workbook already open (doesn't work)\nDim wbTarget As Workbook: Set wbTarget = Workbooks(targetModel) 'Workbook already open (doesn't work)\n</code></pre>\n\n<p>This works perfectly fine when the source and target workbooks are both saved on the desktop but for some reason it doesn't work when they are saved on the drives on my computer. As such, I was thinking that I may have to specify the full path location of the source and target workbooks in order to define the wbSource and wbTarget variables?</p>\n\n<p>In order to do this I tried to implement the following function which should return the file paths:</p>\n\n<pre><code>Public Function GetWorkbookReference(ByVal sFullName As String) As Workbook\n\nDim wbReturn As Workbook\n\nSet wbReturn = Workbooks(Dir$(sFullName))\nSet GetWorkbookReference = wbReturn\n\nEnd Function\n</code></pre>\n\n<p>After which I wanted to call this function when defining the wbSource and wbTarget variables:</p>\n\n<pre><code>Dim wbSource As Workbook: Set wbSource = GetWorkbookReference(sourceModel) 'Workbook already open (doesn't work)\nDim wbTarget As Workbook: Set wbTarget = GetWorkbookReference(targetModel) 'Workbook already open (doesn't work)\n</code></pre>\n\n<p>Unfortunately this doesn't work either. If anyone can assist in figuring out why either of these to alternatives doesn't work that would be very helpful. If you know of a third alternative that would be much appreciated as well.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571829856, "post_id": 58520377, "comment_id": 103368620, "body": "Hi. i&#39;ve tested and its ok. it must be other thing changing the movement. maybe an onchange envent ?"}, {"owner": {"reputation": 500, "user_id": 2248535, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/1SDHI.png?s=128&g=1", "display_name": "Lionel_A", "link": "https://stackoverflow.com/users/2248535/lionel-a"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571843916, "post_id": 58520377, "comment_id": 103376799, "body": "Are you using Windows ?. Because that works under windows 10 but not under macOS."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571845818, "post_id": 58520377, "comment_id": 103377781, "body": "yes, i didnt realize it was a mac... sorry"}], "owner": {"reputation": 500, "user_id": 2248535, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/1SDHI.png?s=128&g=1", "display_name": "Lionel_A", "link": "https://stackoverflow.com/users/2248535/lionel-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581926602, "creation_date": 1571825073, "last_edit_date": 1581926602, "question_id": 58520377, "link": "https://stackoverflow.com/questions/58520377/it-is-not-possible-to-move-a-window-using-activewindow-left", "title": "It is not possible to move a window using ActiveWindow.Left", "body": "<p>With Office 365 (up to date) for Mac, trying to execute</p>\n\n<pre><code>ActiveWindow.Left = ActiveWindow.Left + 100\n</code></pre>\n\n<p>doesn't produce the expected result. The window moves horizontally of course but also vertically and that is unexpected.</p>\n\n<p>Did someone find a solution to solve the problem ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "edited": false, "score": 0, "creation_date": 1571827214, "post_id": 58520181, "comment_id": 103367259, "body": "are you sure you want to use vba? it can just be done easily using <code>vlookup</code> or combination of <code>index</code> and <code>match</code>, which are available functions in excel."}, {"owner": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "reply_to_user": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "edited": false, "score": 0, "creation_date": 1571827841, "post_id": 58520181, "comment_id": 103367600, "body": "@Atreyagaurav You are correct. but I have multiple matches of HR position in Sheet1 which i want in Output sheet. so the format itself is changing in output sheet"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "edited": false, "score": 0, "creation_date": 1571828539, "post_id": 58520934, "comment_id": 103367921, "body": "Thanks a ton, Nathan Though i am getting an error at  Set dicTasks = dicFilter(rngFirstTable.Cells(lngRowSource, 3).Value) as &quot;object required &quot;  Any idea why?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "edited": false, "score": 0, "creation_date": 1571828756, "post_id": 58520934, "comment_id": 103368039, "body": "can you give some more details, are you using my data for example?"}, {"owner": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "edited": false, "score": 0, "creation_date": 1571830047, "post_id": 58520934, "comment_id": 103368713, "body": "Okk nevermind.. I have made it dynamic using lastrow function and its working now. Thanks a bunch, nathan. God bless you"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1581084260, "post_id": 58520934, "comment_id": 106322108, "body": "@Nathan_Sav : I am using his code but i am facing error at line Set dicTasks = dicFilter(rngFirstTable.Cells(lngRowSource, 3).Value) as &quot;object required &quot;  If in input sheet, data is &quot;Hello Dear&quot; and in sheet 2, data is &quot;hello dear&quot;, then it is throwing an error because it is not able to catch that value"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1571826966, "creation_date": 1571826966, "answer_id": 58520934, "question_id": 58520181, "link": "https://stackoverflow.com/questions/58520181/using-auto-filter-for-matching-data-across-sheets-using-vba/58520934#58520934", "title": "Using auto-filter for matching data across sheets using VBA", "body": "<p>Rather than filtering, you could use some of the collection objects that are available to help you out, like <code>scripting.dictionary</code></p>\n\n<p>I have created a dummy version of your data, like the below image</p>\n\n<p><a href=\"https://i.stack.imgur.com/SUdbk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SUdbk.png\" alt=\"enter image description here\"></a></p>\n\n<p>an used this code to produce the output in column J accross</p>\n\n<pre><code>Sub testing()\n\nDim rngFirstTable As Excel.Range\nDim rngSecondTable As Excel.Range\nDim dicFilter As New Scripting.Dictionary\nDim dicTasks As Scripting.Dictionary\nDim rngInspect As Excel.Range\nDim lngRowSource As Long\nDim lngRowDest As Long\nDim rngDisplayTopLeft As Range\nDim rngDisplay As Range\n\nlngRowDest = 1\n\nSet rngFirstTable = Range(\"A1:A4\")\nSet rngSecondTable = Range(\"F1:G5\")\nSet rngDisplayTopLeft = Range(\"J1\")\nSet rngDisplay = rngDisplayTopLeft\n\n'   Set dictionary up containing Key's of the HR Roles\nFor Each rngInspect In rngSecondTable.Columns(1).Cells\n    If dicFilter.Exists(rngInspect.value) Then\n        dicFilter(rngInspect.value).Add _\n            CStr(dicTasks.Count + 1), _\n            rngInspect.Offset(0, 1).value\n    Else\n        Set dicTasks = New Scripting.Dictionary\n        dicTasks.Add \"1\", rngInspect.Offset(0, 1).value\n        dicFilter.Add rngInspect.value, dicTasks\n    End If\nNext rngInspect\n\nFor lngRowSource = 2 To rngFirstTable.Rows.Count\n\n    '   Copy the \"header info\" columns\n    rngDisplay.Resize(1, 3).value = rngFirstTable.Cells(lngRowSource, 1).Resize(1, 3).value\n\n    '   Extract the relevant dictionary corresponding to HR Role HR Position\n    Set dicTasks = dicFilter(rngFirstTable.Cells(lngRowSource, 3).value)\n\n    '   Use the array from .items() to transpose to array equiv to range\n    rngDisplay.Offset(0, 4).Resize(dicTasks.Count, 1).value = _\n        Application.Transpose(dicTasks.Items())\n\n    '   Increment the offset from the top left cell\n    lngRowDest = lngRowDest + dicTasks.Count\n    Set rngDisplay = rngDisplayTopLeft.Offset(lngRowDest - 1, 0)\n\n    Set dicTasks = Nothing\n\nNext lngRowSource\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 12262343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDY5jfWn2mT2bcYJJZ2svLmAA0KpGnXLQmuECP2=k-s128", "display_name": "ACSO", "link": "https://stackoverflow.com/users/12262343/acso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58520934, "answer_count": 1, "score": 1, "last_activity_date": 1571826966, "creation_date": 1571824521, "last_edit_date": 1571824733, "question_id": 58520181, "link": "https://stackoverflow.com/questions/58520181/using-auto-filter-for-matching-data-across-sheets-using-vba", "title": "Using auto-filter for matching data across sheets using VBA", "body": "<p>I have 3 sheets :</p>\n\n<p>Input sheet which consist of the following data :</p>\n\n<p><a href=\"https://i.stack.imgur.com/CqLjP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CqLjP.png\" alt=\"Input Sheet\"></a></p>\n\n<p>Sheet1 consist of the following data :</p>\n\n<p><a href=\"https://i.stack.imgur.com/hAQRE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hAQRE.png\" alt=\"Sheet1\"></a></p>\n\n<p>And the output should look like :</p>\n\n<p><a href=\"https://i.stack.imgur.com/6A3Uy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6A3Uy.png\" alt=\"Sample output\"></a></p>\n\n<p>My idea is that the macro should pick up HR Position from <strong>Input</strong> sheet one by one, filter it in <strong>Sheet1</strong> and find the number of corresponding Task/roles, then paste it in <strong>output</strong> sheet with the corresponding user and company codes.</p>\n\n<p>My code so far : </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nWith ThisWorkbook.Sheets(\"Input\")\n    LastRow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\ncntr = 2\nFor i = 2 To LastRow\n    ThisWorkbook.Worksheets(\"Output\").Cells(cntr, 1).Value = ThisWorkbook.Worksheets(\"Input\").Range(\"A\" &amp; i).Value\n\n    Set Range1 = ThisWorkbook.Worksheets(\"Input\").Range(\"C\" &amp; i)\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        .Range(\"A1\").AutoFilter Field:=1, Criteria1:=Range1\n        LastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n        .Range(\"A2:B\").Copy _\n        ThisWorkbook.Sheets(\"Output\").Range(\"C2\")\n\n    End With\n    cntr = cntr + 1\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I am stuck because i am not able to find how to repeat corresponding user and company codes in Output tab</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1571824588, "post_id": 58519867, "comment_id": 103365939, "body": "About your first lines of code, you might benefit from reading <b><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></b>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571824690, "post_id": 58519867, "comment_id": 103365991, "body": "What is the point of <code>ecol</code> in that loop as you don&#39;t use it?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1571824702, "post_id": 58519867, "comment_id": 103365995, "body": "<i>It keeps giving me an error</i> What error? Which line? did you try debugging with F8? Your question now is too broad and unclear. Help making more specific question, please see <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 3, "user_id": 12193823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f920ca9db7a91698009a001369035b6c?s=128&d=identicon&r=PG&f=1", "display_name": "ThisMatthijs", "link": "https://stackoverflow.com/users/12193823/thismatthijs"}, "edited": false, "score": 0, "creation_date": 1571825174, "post_id": 58519867, "comment_id": 103366250, "body": "This line:  ecol = Sheet14.Cells(3, Columns.Count).End(xlToRight).Offset(0, 1).Columns"}, {"owner": {"reputation": 3, "user_id": 12193823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f920ca9db7a91698009a001369035b6c?s=128&d=identicon&r=PG&f=1", "display_name": "ThisMatthijs", "link": "https://stackoverflow.com/users/12193823/thismatthijs"}, "edited": false, "score": 0, "creation_date": 1571825209, "post_id": 58519867, "comment_id": 103366264, "body": "It gives the &#39;1004&#39; error of Object not defined. But I can t see if this code even makes sense"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571825637, "post_id": 58519867, "comment_id": 103366478, "body": "It needs to be <code>Column</code> at the end. The second ecol line looks like a typo?"}, {"owner": {"reputation": 3, "user_id": 12193823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f920ca9db7a91698009a001369035b6c?s=128&d=identicon&r=PG&f=1", "display_name": "ThisMatthijs", "link": "https://stackoverflow.com/users/12193823/thismatthijs"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571826216, "post_id": 58519867, "comment_id": 103366758, "body": "@SJR Thanks and yes, the <code>en</code> was a typo. But still, the same line keeps failing. Is the correct correct (regardless of the links to sheets etc..)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571826878, "post_id": 58519867, "comment_id": 103367057, "body": "Oops it should be <code>toleft</code> as we are starting on the right hand column, code amended below."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571827164, "post_id": 58520651, "comment_id": 103367237, "body": "Afterthought: could you not do all this in one go with a paste special transpose?"}, {"owner": {"reputation": 3, "user_id": 12193823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f920ca9db7a91698009a001369035b6c?s=128&d=identicon&r=PG&f=1", "display_name": "ThisMatthijs", "link": "https://stackoverflow.com/users/12193823/thismatthijs"}, "edited": false, "score": 0, "creation_date": 1571827329, "post_id": 58520651, "comment_id": 103367320, "body": "The line <code>ecol = Sheet14.Cells(3, Columns.Count).End(xlToRight).Offset(0, 1).Column</code> keeps giving me error &#39;1004&#39; but I can t see why :("}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1571826853, "last_edit_date": 1571826853, "creation_date": 1571826009, "answer_id": 58520651, "question_id": 58519867, "link": "https://stackoverflow.com/questions/58519867/copy-rows-and-paste-them-as-columns-in-excel-with-vba-automatically/58520651#58520651", "title": "Copy rows and paste them as columns in Excel with VBA automatically", "body": "<p>You are wanting the <code>Column</code> property of the <code>Range</code>, not <code>Columns</code>.</p>\n\n<p>Also, you can transfer the value directly which is slightly more efficient than copying and pasting.</p>\n\n<p>I have made a semi-educated guess as to desired destination range.</p>\n\n<pre><code>For i = 2 To lastrow\n    ecol = Sheet14.Cells(3, Columns.Count).End(xlToleft).Offset(0, 1).Column 'not columns at the end\n    Sheet14.Cells(3, ecol).Value = Sheet12.Cells(i, 2).Value\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "is_accepted": false, "score": 0, "last_activity_date": 1571827880, "creation_date": 1571827880, "answer_id": 58521201, "question_id": 58519867, "link": "https://stackoverflow.com/questions/58519867/copy-rows-and-paste-them-as-columns-in-excel-with-vba-automatically/58521201#58521201", "title": "Copy rows and paste them as columns in Excel with VBA automatically", "body": "<p>I didn't even look into your code, if what you want is just transpose version of the data, get your data into an array (range.value will give array) just use a loop to transpose and then assign it to a new range.\nIf you want them to contain formula use range.formula instead of value. just be sure to care about relative/absolute references. </p>\n"}], "owner": {"reputation": 3, "user_id": 12193823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f920ca9db7a91698009a001369035b6c?s=128&d=identicon&r=PG&f=1", "display_name": "ThisMatthijs", "link": "https://stackoverflow.com/users/12193823/thismatthijs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58520651, "answer_count": 2, "score": 0, "last_activity_date": 1571827880, "creation_date": 1571823512, "last_edit_date": 1571825963, "question_id": 58519867, "link": "https://stackoverflow.com/questions/58519867/copy-rows-and-paste-them-as-columns-in-excel-with-vba-automatically", "title": "Copy rows and paste them as columns in Excel with VBA automatically", "body": "<p>I am learning to copy and paste with VBA automatically without overwriting data.\nI managed to get a code to copy from rows and paste them as rows.</p>\n\n<p>Now, I want to copy rows (Same way) but paste them as a column each time.\nThe first line has to start with a date stamp (Each month) and underneath it the amounts. The amounts are being copied from a pivot table which will refresh then each month.                                           </p>\n\n<p>Here is my written code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim lastrow As Long, ecol As Long\n\n'Stamp from when the data set is (in months)\n\n\n        If Worksheets(\"Database\").Range(\"A3\").Offset(1, 1) &lt;&gt; \"\" Then\n            Worksheets(\"Database\").Range(\"A3\").End(xlDown).Select\n             ActiveCell.Offset(1, 0).FormulaR1C1 = Now\n        End If\n\n\n'To check the last filled line on sheet 'Database_Input'\nlastrow = Sheet12.Cells(Rows.Count, 2).End(xlUp).Row\n\n'Copy Paste section\nFor i = 2 To lastrow\n    Sheet12.Cells(i, 2).Copy\n        ecol = Sheet14.Cells(3, Columns.Count).End(xlToRight).Offset(0, 1).Column\n    ecol = Sheet14.Cells(3, Columns.Count).End\n            Sheet12.Paste Destination:=Sheet14.Cells(3, ecol)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>It keeps giving me an error on the following section:</p>\n\n<pre><code>For i = 2 To lastrow\n    Sheet12.Cells(i, 2).Copy\n        ecol = Sheet14.Cells(3, Columns.Count).End(xlToRight).Offset(0, 1).Column\n    ecol = Sheet14.Cells(3, Columns.Count).End\n            Sheet12.Paste Destination:=Sheet14.Cells(3, ecol)\nNext i\n</code></pre>\n\n<p>Anyone who has an idea how to deal with this? I copied my row --> row code and edited it. Maybe it has to be completely different.</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["vba", "ms-access", "messagebox"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1571823711, "post_id": 58519783, "comment_id": 103365483, "body": "You could create a form to mimic the message box."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1571827076, "creation_date": 1571827076, "answer_id": 58520969, "question_id": 58519783, "link": "https://stackoverflow.com/questions/58519783/how-can-i-customize-message-box-in-access-vba/58520969#58520969", "title": "How can I customize message box in access vba", "body": "<p>That's not an easy task, but it can be done as shown in my article:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/17684/Modern-Metro-style-message-box-and-input-box-for-Microsoft-Access-2013.html\" rel=\"nofollow noreferrer\">Modern/Metro style message box and input box for Microsoft Access 2013+</a></p>\n\n<p>(If you don't have an account, browse for the link: Read the full article.)</p>\n\n<p>Code is way too much to post here, but it can found on <strong>GitHub</strong> as well: <a href=\"https://github.com/GustavBrock/VBA.ModernBox\" rel=\"nofollow noreferrer\">VBA.ModernBox</a></p>\n"}], "owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594421149, "creation_date": 1571823213, "last_edit_date": 1594421149, "question_id": 58519783, "link": "https://stackoverflow.com/questions/58519783/how-can-i-customize-message-box-in-access-vba", "title": "How can I customize message box in access vba", "body": "<p>I want to be able to customise messagebox button from the classical YesNo, okonly and the rest of them</p>\n\n<p>Instead of msgbox(\"hello world\", vbOKonly). i have tried to use another word like vbContinue but i got an error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1571822074, "post_id": 58519344, "comment_id": 103364566, "body": "What is the purpose of this code? Add a column in every sheet which will contain  the sheet name + a counter?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1571822077, "post_id": 58519344, "comment_id": 103364568, "body": "<a href=\"https://stackoverflow.com/q/10714251/9758194\">How to avoid using Select in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1571822616, "creation_date": 1571822616, "answer_id": 58519594, "question_id": 58519344, "link": "https://stackoverflow.com/questions/58519344/excel-vba-select-first-column/58519594#58519594", "title": "Excel vba - select first column", "body": "<p>Here is a way to reliable loop through your worksheet index numbers:</p>\n\n<pre><code>Sub AddRefNo()\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet\nDim x As Long\n\nFor x = 4 To wb.Worksheets.Count - 1\n    Set ws = wb.Worksheets(x)\n    'Your code to work with ws as a parent\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571822971, "post_id": 58519621, "comment_id": 103365037, "body": "OP seems to be interested in index from 4 to 1 below the total worksheet count though. Upvoted either way for a more complete answer than mine =)"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571823066, "post_id": 58519621, "comment_id": 103365085, "body": "@JvdV <code>ActiveSheet.Next.Select</code> this is supposed to select the next worksheet, right? If he is starting from sheet 4 and selecting the next in every loop... this will go to the <code>worksheets.count</code> right?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571823111, "post_id": 58519621, "comment_id": 103365110, "body": "First line in his <code>Do While</code> loop says otherwise <code>Do While ActiveSheet.Index &lt; Worksheets.Count</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1571823252, "post_id": 58519621, "comment_id": 103365198, "body": "Edited so it skips the last worksheet, thanks @JvdV!"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 2, "last_activity_date": 1571823236, "last_edit_date": 1571823236, "creation_date": 1571822711, "answer_id": 58519621, "question_id": 58519344, "link": "https://stackoverflow.com/questions/58519344/excel-vba-select-first-column/58519621#58519621", "title": "Excel vba - select first column", "body": "<p>This should do the trick if you want to loop from sheet 4:</p>\n\n<pre><code>Option Explicit\nSub AddRefNo()\n\n    'Declare a worksheet variable\n    Dim ws As Worksheet\n    'Loop every sheet in the workbook\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Index &lt; 4  Or ws.Index = ThisWorkbook.Worksheets.Count Then GoTo nextWorksheet\n        'Reference always the sheet\n        With ws\n            'Calculate last row\n            Dim LastRow As Long\n            LastRow = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n            'Insert a column\n            .Range(\"A:A\").Insert\n            .Range(\"A1\") = \"Ref. No\"\n            'Put the name sheet + reference starting from 1\n            With .Range(\"A2:A\" &amp; LastRow)\n                .FormulaR1C1 = \"=\" &amp; Chr(34) &amp; ws.Name &amp; Chr(34) &amp; \"&amp;ROW(RC)-1\"\n                .Value = .Value\n            End With\n        End With\nnextWorksheet:\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7272792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XKUYUsy7nGI/AAAAAAAAAAI/AAAAAAAAAA0/VXaI-CcwQOk/photo.jpg?sz=128", "display_name": "offa rex", "link": "https://stackoverflow.com/users/7272792/offa-rex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571823236, "creation_date": 1571821885, "last_edit_date": 1571822366, "question_id": 58519344, "link": "https://stackoverflow.com/questions/58519344/excel-vba-select-first-column", "title": "Excel vba - select first column", "body": "<p>i'm trying to make some changes in excel file using VBA, the file contains many sheets\nthe code should make changes for 1st sheet then go to the next and next, \nbut after makes the changes in 1st sheet and go to 2nd it shows:</p>\n\n<blockquote>\n  <p>Error no 1004 \"Object error\".</p>\n</blockquote>\n\n<p>Here the code:</p>\n\n<pre><code>Sub AddRefNo()\n\n    'This code adds Reference Number to All BOQ sheets based on Worksheet Name\n    'select the first sheet\n    Worksheets(4).Select\n\n    ' Work in One Sheet\n    Do While ActiveSheet.Index &lt; Worksheets.Count\n\n        'add new Column\n        'the error happens here\n        Columns(\"A:A\").Select\n\n        Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n        Range(\"A1\").Select\n        ActiveCell.FormulaR1C1 = \"Ref. No\"\n        Range(\"A2\").Select\n\n        'Find Sheet Name\n        MySheet = ActiveSheet.Name\n\n        'creat numbering system\n        Dim Noe As String\n        Noe = 0\n\n        ' Find the last row\n        Dim LastRow As Integer\n\n        LastRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n        Range(\"E2\").Select\n\n        'repeat steps to the last row\n\n        Do While ActiveCell.Row &lt; LastRow\n\n            'checking if the cell is not blank\n\n            Do While ActiveCell.Value &lt;&gt; \"\"\n\n                 ActiveCell.Offset(0, -4).Select\n                 Noe = Noe + 1\n                 ActiveCell.Value = MySheet &amp; \" - \" &amp; Noe\n                 ActiveCell.Offset(0, 4).Select\n                 ActiveCell.Offset(1, 0).Select\n\n            Loop\n\n            ActiveCell.Offset(1, 0).Select\n\n        Loop\n\n        Noe = 0\n        Range(\"A1\").Select\n        ActiveSheet.Next.Select\n\n    Loop\n\n    Worksheets(1).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1571820558, "post_id": 58518947, "comment_id": 103363746, "body": "Help needed in this block &#39;&#39;Macro recording-Iwant to replace the range C1:C499872 with f1(variabe)         ActiveWorkbook.Worksheets(&quot;Data&quot;).AutoFilter.Sort.SortFields&zwnj;&#8203;.Add2 Key:=Range( _             &quot;C1:C499872&quot;), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _             xlSortTextAsNumbers         With ActiveWorkbook.Worksheets(&quot;Data&quot;).AutoFilter.Sort"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1571895932, "post_id": 58519248, "comment_id": 103392582, "body": "Hi Team, issue in the below code ActiveWorkbook.Worksheets(&quot;Data&quot;).AutoFilter.Sort.SortFields&zwnj;&#8203;.Add2 Key:=Range( _        (Cells(f1))), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _         xlSortTextAsNumbers"}, {"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1571895977, "post_id": 58519248, "comment_id": 103392591, "body": "it is throwing run time error... Invalid procedure call or argument (Error 5)"}], "tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": 0, "last_activity_date": 1571821574, "creation_date": 1571821574, "answer_id": 58519248, "question_id": 58518947, "link": "https://stackoverflow.com/questions/58518947/filter-data-in-ascending-order-by-using-a-variable-reference-in-excel/58519248#58519248", "title": "Filter data in ascending order by using a variable reference in excel", "body": "<p>Try below code not tested </p>\n\n<pre><code>Sub age()\n      Dim OpenWb As Workbook\n      With Application.FileDialog(msoFileDialogFilePicker)\n            'Makes sure the user can select only one file\n            .AllowMultiSelect = False\n            'Filter to just the following types of files to narrow down selection options\n            .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n            'Show the dialog box\n            .Show\n\n            'Store in fullpath variable\n            fullpath = .SelectedItems.Item(1)\n\n            'Actions in raw data sheet\n\n        Set OpenWb = Workbooks.Open(fullpath)\n        Dim wsData As Worksheet\n        Set wsData = OpenWb.Worksheets(\"Data\")\n\n     'Find last cell number of row A from data sheet\n        Dim last As Double\n        Dim Cell As Range\n        With OpenWb.Worksheets(\"Data\")\n        last = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        End With\n\n    OpenWb.Worksheets(\"Data\").Rows(\"1:1\").Select\n    Dim f1 As String\n\n    f1 = Selection.Find(What:=\"BIRTH_YEAR\", After:=ActiveCell, LookIn:=xlValues, _\n            LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).value\n\n        Selection.AutoFilter\n        ActiveWorkbook.Worksheets(\"Data\").AutoFilter.Sort.SortFields.Clear\n    '    Cells(f1).Sort , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    '        xlSortTextAsNumbers\n''Macro recording-Iwant to replace the range C1:C499872 with f1(variabe)        \nActiveWorkbook.Worksheets(\"Data\").AutoFilter.Sort.SortFields\n .Add Key:=Range(\"C1:C499872\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= xlSortTextAsNumbers\n        With ActiveWorkbook.Worksheets(\"Data\").AutoFilter.Sort\n             .SetRange f1\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    End With\n\n\n\n    End Sub\n\n\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571821574, "creation_date": 1571820531, "last_edit_date": 1571820866, "question_id": 58518947, "link": "https://stackoverflow.com/questions/58518947/filter-data-in-ascending-order-by-using-a-variable-reference-in-excel", "title": "Filter data in ascending order by using a variable reference in excel", "body": "<p>I have identified a column header (Birth_Year) by searching and stored the value in a variable f1\nNow, I want to apply filters and sort the data by Birth_Year by using f1 as reference variable.                                     </p>\n\n<p>Please see the code below:</p>\n\n<pre><code>   Sub age()\n      Dim OpenWb As Workbook\n      With Application.FileDialog(msoFileDialogFilePicker)\n            'Makes sure the user can select only one file\n            .AllowMultiSelect = False\n            'Filter to just the following types of files to narrow down selection options\n            .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n            'Show the dialog box\n            .Show\n\n            'Store in fullpath variable\n            fullpath = .SelectedItems.Item(1)\n\n            'Actions in raw data sheet\n\n        Set OpenWb = Workbooks.Open(fullpath)\n        Dim wsData As Worksheet\n        Set wsData = OpenWb.Worksheets(\"Data\")\n\n     'Find last cell number of row A from data sheet\n        Dim last As Double\n        Dim Cell As Range\n        With OpenWb.Worksheets(\"Data\")\n        last = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        End With\n\n    OpenWb.Worksheets(\"Data\").Rows(\"1:1\").Select\n    Dim f1 As String\n\n    f1 = Selection.Find(What:=\"BIRTH_YEAR\", After:=ActiveCell, LookIn:=xlValues, _\n            LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).value\n\n        Selection.AutoFilter\n        ActiveWorkbook.Worksheets(\"Data\").AutoFilter.Sort.SortFields.Clear\n    '    Cells(f1).Sort , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    '        xlSortTextAsNumbers\n''Macro recording-Iwant to replace the range C1:C499872 with f1(variabe)        \nActiveWorkbook.Worksheets(\"Data\").AutoFilter.Sort.SortFields.Add2 Key:=Range( _\n            \"C1:C499872\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n            xlSortTextAsNumbers\n        With ActiveWorkbook.Worksheets(\"Data\").AutoFilter.Sort\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    End With\n\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "comparison"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1571820641, "post_id": 58518917, "comment_id": 103363797, "body": "Your <code>a</code> variable is not declared: <code>Dim a as Range</code> and also not set: <code>Set a = Cells(3+i,1)</code>. Also declare <code>i</code> as <code>Long</code>, not <code>Integer</code>"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 2, "creation_date": 1571820698, "post_id": 58518917, "comment_id": 103363827, "body": "To start, replace <code>For i = 1 to Rows.Count</code> with a <a href=\"https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/38882823#38882823\">more reliable lastrow statement</a>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1571821444, "post_id": 58518917, "comment_id": 103364218, "body": "Don&#39;t use <code>Integer</code> variables (causing overflow really easy), use <code>Long</code> instead. As per @Plution, do also use a more reliable way of retrieving the last row. Furthermore, I would recommend the use of at least a worksheet reference and loop through an array (through memory) instead of cells. That being said. Please can you include some mockup sample data and expected result?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1571821558, "post_id": 58518917, "comment_id": 103364281, "body": "@Teamothy, I don&#39;t think <code>a</code> variable is meant to be a range object. Instead I think OP is trying to write <code>Cells(228 + j, 3) = Cells(3 + i, 1)</code>"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571822349, "post_id": 58518917, "comment_id": 103364688, "body": "@JvdV yes, my bad, he wanted a value not range, would be easier taking your approach."}, {"owner": {"reputation": 63, "user_id": 11321100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVvHiV09Syg/AAAAAAAAAAI/AAAAAAAAAGY/JBibxkYAU7A/photo.jpg?sz=128", "display_name": "CosmoCramer", "link": "https://stackoverflow.com/users/11321100/cosmocramer"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571822656, "post_id": 58518917, "comment_id": 103364862, "body": "@JvdV I included some mockup sample data and expected result. And edited the  code like you said."}, {"owner": {"reputation": 63, "user_id": 11321100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVvHiV09Syg/AAAAAAAAAAI/AAAAAAAAAGY/JBibxkYAU7A/photo.jpg?sz=128", "display_name": "CosmoCramer", "link": "https://stackoverflow.com/users/11321100/cosmocramer"}, "edited": false, "score": 0, "creation_date": 1571823249, "post_id": 58518917, "comment_id": 103365195, "body": "I edited the cells since i switched up rows and columns in the if statement.  Now i get output but just one: (&quot;6:25&quot;), its the first time both values don&#39;t match."}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1571824034, "creation_date": 1571824034, "answer_id": 58520012, "question_id": 58518917, "link": "https://stackoverflow.com/questions/58518917/how-to-check-for-equal-values-in-cells-with-a-for-loop/58520012#58520012", "title": "How to check for equal values in cells with a for loop?", "body": "<p>Here I'm using a dictionary which will store every time for every product comma separated, so later will split that and take the first and last occurrence:</p>\n\n<pre><code>Sub TimeTable()\n\n        'Declare an array variable to store the data\n        'change MySheet for your sheet name\n        arr = ThisWorkbook.Sheets(\"MySheet\").UsedRange.Value 'this will store the whole worksheet, the used area.\n\n        'Declare a dictionary object\n        Dim Products As Object: Set Products = CreateObject(\"Scripting.Dictionary\")\n\n        'Loop through the array\n        Dim i As Long\n        For i = 3 To UBound(arr) 'start from row 3 because of your screenshoot\n            If arr(i, 21) = vbNullString Then GoTo NextRow 'if column U is empty won't add anything\n            If Not Products.Exists(arr(i, 21)) Then '21 is the column index for column U\n                Products.Add arr(i, 21), arr(i, 1)\n            Else\n                Products(arr(i, 21)) = arr(i, 21) &amp; \",\" &amp; arr(i, 1)\n            End If\nNextRow:\n        Next i\n        Erase arr\n\n        'Redim the array to fit your final data, 4 columns and as many rows as products\n        ReDim arr(1 To Products.Count + 1, 1 To 4)\n\n        'Insert the headers\n        arr(1, 1) = \"Time\"\n        arr(1, 4) = \"Product / Error\"\n\n        'Now loop through the dictionary\n        Dim Key As Variant, MySplit As Variant\n        i = 2\n        For Each Key In Products.Keys\n            MySplit = Split(Products(Key), \",\")\n            arr(i, 1) = MySplit(LBound(MySplit))\n            arr(i, 2) = \"-\"\n            arr(i, 3) = MySplit(UBound(MySplit))\n            arr(i, 4) = Key\n            i = i + 1\n        Next Key\n\n\n        'I don't know where are you going to paste your data, so I'm making a new worksheet at the end of your workbook\n        Dim ws As Worksheet\n        Set ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n        With ws\n            .Range(\"A1\").Resize(UBound(arr), UBound(arr, 2)).Value = arr\n            .Range(\"A1:C1\").Merge\n        End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1571824312, "creation_date": 1571824312, "answer_id": 58520108, "question_id": 58518917, "link": "https://stackoverflow.com/questions/58518917/how-to-check-for-equal-values-in-cells-with-a-for-loop/58520108#58520108", "title": "How to check for equal values in cells with a for loop?", "body": "<p>You could use</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowA As Long, i As Long, j As Long, LastRowW As Long\n    Dim StartTime As Date, EndTime As Date, strOutPut\n\n    j = 0\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastRowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = 3 To LastRowA\n\n            If i &gt; j - 1 Then\n\n                StartTime = .Range(\"A\" &amp; i).Value\n                strOutPut = .Range(\"U\" &amp; i).Value\n\n                For j = i + 1 To LastRowA + 1\n\n                    If strOutPut &lt;&gt; .Range(\"U\" &amp; j).Value Then\n\n                        EndTime = .Range(\"A\" &amp; j - 1).Value\n                        LastRow = .Cells(.Rows.Count, \"W\").End(xlUp).Row\n\n                        .Range(\"W\" &amp; LastRow + 1).Value = StartTime\n                        .Range(\"X\" &amp; LastRow + 1).Value = EndTime\n                        .Range(\"Y\" &amp; LastRow + 1).Value = strOutPut\n\n                        Exit For\n\n                    End If\n\n                Next j\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/8AKAQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8AKAQ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 63, "user_id": 11321100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVvHiV09Syg/AAAAAAAAAAI/AAAAAAAAAGY/JBibxkYAU7A/photo.jpg?sz=128", "display_name": "CosmoCramer", "link": "https://stackoverflow.com/users/11321100/cosmocramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 58520108, "answer_count": 2, "score": 0, "last_activity_date": 1582182309, "creation_date": 1571820413, "last_edit_date": 1582182309, "question_id": 58518917, "link": "https://stackoverflow.com/questions/58518917/how-to-check-for-equal-values-in-cells-with-a-for-loop", "title": "How to check for equal values in cells with a for loop?", "body": "<p>I want to check if the text value in a cell is the same as in the cell below with a for loop. </p>\n\n<p>If the value in Cell(1) and Cell(2) does not match I want the value from Cell(3) written in Cell(4).</p>\n\n<p>I get an error</p>\n\n<blockquote>\n  <p>\"Overflow (Error 6)\"</p>\n</blockquote>\n\n<pre><code>Dim i As Integer\n\nFor i = 1 To Rows.Count\n\n    If Cells(2 + i,21) = Cells(3 + i,21) Then\n        i = i + 1\n    Else\n        a = Cells(3 + i, 1)\n        j = j + 1\n        Cells(228 + j, 3) = a\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I have a production output and a timeline from 6 am to 12 am and I want to create a timetable as seen below. </p>\n\n<p>Screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vHAas.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vHAas.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "formatting", "numbers", "cell"], "comments": [{"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 2, "creation_date": 1571820501, "post_id": 58518826, "comment_id": 103363717, "body": "Isn&#39;t it easier to consider car numbers in plain text?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 1, "creation_date": 1571820750, "post_id": 58518826, "comment_id": 103363852, "body": "Agreed with @CommonSense. Please show some example data too, because it feels like you don&#39;t start of with a list of text values but numbers. Otherwise your code makes no sense to me."}, {"owner": {"reputation": 99, "user_id": 10424194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4P2iT.jpg?s=128&g=1", "display_name": "zepeu", "link": "https://stackoverflow.com/users/10424194/zepeu"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571821167, "post_id": 58518826, "comment_id": 103364084, "body": "@JvdV Yes, it&#39;s considered as text at the beginning, but text become numbers really easily in Excel..."}], "owner": {"reputation": 99, "user_id": 10424194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4P2iT.jpg?s=128&g=1", "display_name": "zepeu", "link": "https://stackoverflow.com/users/10424194/zepeu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571820063, "creation_date": 1571820063, "question_id": 58518826, "link": "https://stackoverflow.com/questions/58518826/display-a-serial-number-without-having-the-dot-considered-as-a-decimal-separator", "title": "Display a serial number without having the dot considered as a decimal separator", "body": "<p>For work, I have a list of cars numbers under the form N.NNN (always 4 numbers with a dot after the first number)\nSo, for instance 1.578 or 5.247.\nThere are 2 problems there :</p>\n\n<p>1) The dot is considered as a decimal separator and therfore replaced by a comma \",\" (I'm in France)... But I don't want this comma ! The \"good official way\" to write it is with a dot.</p>\n\n<p>2) As the dot is ment to be a decimal separator, if the car got the number 2.200, it will be displayed \"2,2\"... But we need the \"00\" after the \"2.2\"</p>\n\n<p>I got a small VBA code that helps me putting all these numbers in the good format, but this decimal thing is driving me crazy, I searched for a while on the internet without success.</p>\n\n<p>here is the small part of code that could interest you :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Const SpecialCharacters As String = \"!,@,#,$,%,^,&amp;,*,(,),{,[,],},?, ,-,_,/,\\,.\"   'Defines the special characters we want to get rid of in the Tools codes\n\nOn Error Resume Next\nFor Each Lin In Worksheets(\"Tabelle1\").Range(\"A1:A\" &amp; LastCell) \n        CodeVal = Worksheets(\"Tabelle1\").Range(\"A\" &amp; Lin.Row).Value\n        'Modify the Short Code to have a point as second character\n        For Each Char In Split(SpecialCharacters, \",\")                                              'Deletes all the other special characters possibles, even more... Definition of \"SpecialCharacters\" at the beginning of this code part\n            NewCodeVal = CStr(Replace(CodeVal, Char, \"\"))\n        Next\n        If Len(CodeVal) = 4 Then\n            CodeVal = Left(NewCodeVal, 1) &amp; Chr(46) &amp; Right(NewCodeVal, Len(NewCodeVal) - 1)\n        ElseIf Len(CodeVal) = 3 Then\n            CodeVal = Left(NewCodeVal, 1) &amp; Chr(46) &amp; Right(NewCodeVal, Len(NewCodeVal) - 1) &amp; \"0\"\n        ElseIf Len(CodeVal) = 2 Then\n            CodeVal = Left(NewCodeVal, 1) &amp; Chr(46) &amp; Right(NewCodeVal, Len(NewCodeVal) - 1) &amp; \"00\"\n        End If\n        With Worksheets(\"Tabelle1\").Range(\"B\" &amp; Lin.Row)\n            .Value = CodeVal\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlCenter\n            .Font.Size = 11\n            .Font.Name = Calibri\n            .NumberFormat = \"##0.000\"\n        End With\n\nNext\nOn Error GoTo 0\n</code></pre>\n\n<p>As you've seen, I tried to insert the dot as an ascii character and I tried to use the number formatting without success...</p>\n\n<p>Thank's by advance for your help !</p>\n"}, {"tags": ["excel", "vba", "rename", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1571820362, "post_id": 58518837, "comment_id": 103363656, "body": "to automate sheetname sheetname= sheetname&amp; i ............here i is counter i=i+1"}, {"owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 0, "creation_date": 1571830992, "post_id": 58518837, "comment_id": 103369258, "body": "@JvdV i got the sheet name &quot;false&quot; after follow your method. I have edit my code in my post for your reference"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 0, "creation_date": 1571831690, "post_id": 58518837, "comment_id": 103369678, "body": "@Hilmi, please try again, there was a small typo in my code too that I corrected. I accidentely copy pasted your <code>myval</code> variable in there."}, {"owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 0, "creation_date": 1571834310, "post_id": 58518837, "comment_id": 103371136, "body": "@JvdV Yeah it rename the sheet using current workbook name, but what I want actually is get the name from <code>myfile</code>(in my original code) and want rename the sheet as <code>M 100P 1</code> &amp; etc. Sorry for the confusing"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571834442, "post_id": 58518837, "comment_id": 103371208, "body": "Then try to ammend/change the code with the hints I have given you. <code>Split(myfile.Name, &quot;.&quot;)(0)</code> would give you the name of the <code>myfile</code> workbook. And you&#39;ll need to have some sort of counter to ammend with the 1 etc."}, {"owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 0, "creation_date": 1571836855, "post_id": 58518837, "comment_id": 103372682, "body": "@JvdV Thanks for your help. I will try later"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1571831767, "last_edit_date": 1571831767, "creation_date": 1571820128, "answer_id": 58518837, "question_id": 58518787, "link": "https://stackoverflow.com/questions/58518787/rename-sheet-using-their-file-name/58518837#58518837", "title": "Rename sheet using their file name", "body": "<p>To add a sheet at the end and name it in one go, try something like:</p>\n\n<pre><code>Thisworkbook.Sheets.Add(After:=Thisworkbook.Sheets(Thisworkbook.Sheets.Count)).Name = \"Your sheet name goes here\"\n</code></pre>\n\n<p>As per your last question, I also mentioned it's best to set a workbook object and reference that:</p>\n\n<pre><code>Dim wb as Workbook: Set wb = ThisWorkbook\n</code></pre>\n\n<p>This will make the above code written much cleaner:</p>\n\n<pre><code>With wb\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Your sheet name goes here\"\nEnd with\n</code></pre>\n\n<p>To go a step further and get your current workbook name you can then use:</p>\n\n<pre><code>myVal = wb.Name 'Will get you with extension\nmyVal = Split(wb.Name, \".\")(0) 'Will get you name without extension\n</code></pre>\n\n<p>And as mentioned in the comments you can then also implement some sort of counter. But as per your current code, there is no loop to do so with. The above comes down to:</p>\n\n<pre><code>Dim wb as Workbook: Set wb = ThisWorkbook\n\nWith wb\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = Split(wb.Name, \".\")(0) &amp; \"Your counter goes here\"\nEnd with\n</code></pre>\n\n<p>And on a sidenote (also as per your last question) have a look at <a href=\"https://stackoverflow.com/q/10714251/9758194\">this</a> post on SO to start improving your code drastically.</p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571985565, "post_id": 58537146, "comment_id": 103426541, "body": "Good you got a new piece of code. You can improve a little by avoiding <code>ActiveSheet</code> too. Don&#39;t forget, if the post has helped you/answered your question. Consider to upvote/accept the answer."}], "tags": [], "owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "is_accepted": false, "score": 1, "last_activity_date": 1571905394, "creation_date": 1571905394, "answer_id": 58537146, "question_id": 58518787, "link": "https://stackoverflow.com/questions/58518787/rename-sheet-using-their-file-name/58537146#58537146", "title": "Rename sheet using their file name", "body": "<p>Thanks to @JvdV,I made a revise on my code an upgrade it to</p>\n\n<pre><code>    Dim wbk, twb As Workbook, sPath As String, sFile As String, sName As String\n\n    sPath = \"C:\\Users\\mazman\\Desktop\\Hilmi\\data Summary\\\"\n    sFile = Dir(sPath &amp; \"*.xls*\")\n\n    Set twb = ThisWorkbook\n    Application.ScreenUpdating = 0\n\n    Do While sFile &lt;&gt; \"\"\n        Set wbk = Workbooks.Open(sPath &amp; sFile)\n\n        With wbk\n            sName = Split(Split(.Name, \"_\")(6), \".\")(0)\n            .Sheets(3).Copy after:=twb.Sheets(twb.Sheets.Count)\n            .Close 0\n        End With\n\n        With twb\n        .ActiveSheet.Name = sName\n        .ActiveSheet.Range(\"A1:R1\").RowHeight = 45\n        .ActiveSheet.Range(\"A1:R1\").WrapText = True\n        .ActiveSheet.Range(\"A1:R1\").Interior.ColorIndex = 15\n        End With\n        sFile = Dir()\n    Loop\n    Set wbk = Nothing\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "accepted_answer_id": 58518837, "answer_count": 2, "score": 0, "last_activity_date": 1571905394, "creation_date": 1571819914, "last_edit_date": 1571831407, "question_id": 58518787, "link": "https://stackoverflow.com/questions/58518787/rename-sheet-using-their-file-name", "title": "Rename sheet using their file name", "body": "<p>Description: \nWhat I am try to do is allow user to select excel file via browse then copy data from sheet 3 in selected file and paste to current workbook sheet2 (which name is Raw data(STEP 1) ). From the result in the current workbook sheet2 I want to copy the data to a new sheet and want to rename the sheet base on their file name but not the full string but just the ending such as M 100P 1.</p>\n\n<p>Example of my file name(just a dummy) &amp; it contains almost 20 file is the folder:</p>\n\n<pre><code>abcd_19-10-10_17-26_efgh-ijkl-02_ww1_line0_M 100P 1\nabcd_19-10-10_18-33_efgh-ijkl-02_ww1_line0_M 100P 16\n</code></pre>\n\n<p>For now I am using inputbox to rename the sheet, as my code below:</p>\n\n<pre><code>Private Sub OpenWorkBook_Click()\n\nDim myFile As Variant\nDim OpenBook As Workbook\n\nApplication.ScreenUpdating = False\n\nmyFile = Application.GetOpenFilename(Title:=\"Browse your file\", FileFilter:=\"Excel Files(*.xls*),*xls*\")\nIf myFile &lt;&gt; False Then\n    Set OpenBook = Application.Workbooks.Open(myFile)\n    OpenBook.Sheets(3).Range(\"A2:R3063\").Copy\n    ThisWorkbook.Worksheets(\"Raw data(STEP 1)\").Range(\"A3\").PasteSpecial xlPasteValues\n    OpenBook.Close True\n\n    ThisWorkbook.Sheets(3).Range(\"A9:O27\").Copy\n    myVal = InputBox(\"Enter Sheet Name\")\n    Sheets.Add After:=Sheets(ActiveWorkbook.Sheets.Count)\n    ActiveSheet.Name = myVal\n    ThisWorkbook.ActiveSheet.Range(\"A1\").PasteSpecial xlPasteAllUsingSourceTheme\n    ThisWorkbook.ActiveSheet.Range(\"A1\").PasteSpecial xlPasteValues\n    ThisWorkbook.ActiveSheet.Range(\"A1:O19\").ColumnWidth = 10.8\n\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Edited code</p>\n\n<pre><code>If myFile &lt;&gt; False Then\n    Set OpenBook = Application.Workbooks.Open(myFile)\n    OpenBook.Sheets(3).Range(\"A2:R3063\").Copy\n    WB.Worksheets(2).Range(\"A3\").PasteSpecial xlPasteValues\n    OpenBook.Close True\n\n    WB.Sheets(3).Range(\"A9:O27\").Copy\n\n    With WB\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = myVal = Split(WB.Name, \".\")(0)\n    .ActiveSheet.Range(\"A1\").PasteSpecial xlPasteAllUsingSourceTheme\n    .ActiveSheet.Range(\"A1\").PasteSpecial xlPasteValues\n    .ActiveSheet.Range(\"A1:O19\").ColumnWidth = 10.8\n    End With\n\n\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\nEnd If\n</code></pre>\n\n<p>Is there anyways to do that without using the inputbox?</p>\n\n<p>Any help will be appreciate </p>\n"}, {"tags": ["python", "excel", "vba", "xls"], "comments": [{"owner": {"reputation": 1598, "user_id": 2970853, "user_type": "registered", "profile_image": "https://graph.facebook.com/507188635/picture?type=large", "display_name": "henrywongkk", "link": "https://stackoverflow.com/users/2970853/henrywongkk"}, "edited": false, "score": 0, "creation_date": 1571818184, "post_id": 58518124, "comment_id": 103362587, "body": "Maybe worth adding a simple example to explain how you create macros in python for xls files in windows. I was looking for something similar (running excel vba macro through python on linux) but it seems to be impossible from the findings I had"}, {"owner": {"reputation": 19, "user_id": 11567679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee287c0ebb5b11ecc87fb256b4ecdfbd?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe44", "link": "https://stackoverflow.com/users/11567679/pepe44"}, "reply_to_user": {"reputation": 1598, "user_id": 2970853, "user_type": "registered", "profile_image": "https://graph.facebook.com/507188635/picture?type=large", "display_name": "henrywongkk", "link": "https://stackoverflow.com/users/2970853/henrywongkk"}, "edited": false, "score": 0, "creation_date": 1571821799, "post_id": 58518124, "comment_id": 103364409, "body": "If you want create macros in windows you need win32com.client. Look here for example: <a href=\"https://stackoverflow.com/questions/19616205/running-an-excel-macro-via-python\" title=\"running an excel macro via python\">stackoverflow.com/questions/19616205/&hellip;</a>"}], "owner": {"reputation": 19, "user_id": 11567679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee287c0ebb5b11ecc87fb256b4ecdfbd?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe44", "link": "https://stackoverflow.com/users/11567679/pepe44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571830210, "creation_date": 1571817402, "last_edit_date": 1571830210, "question_id": 58518124, "link": "https://stackoverflow.com/questions/58518124/python-write-a-macros-in-xls-file-on-linux", "title": "Python write a macros in .xls file on linux", "body": "<p>I generate .xls file and use xlwt, xlrd and xlutils, but when i use the copy function from xlutils, every macro is missing in the new file. </p>\n\n<p>I need to write my own macros to the .xls file, but I already looked for a solution on google and i've only found libraries for windows. </p>\n\n<p>Is there any way to create macros in python for .xls files? </p>\n\n<p>Please help me.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1571817562, "post_id": 58517851, "comment_id": 103362306, "body": "I suggest looking at <a href=\"https://stackoverflow.com/a/3628198/11936678\">this answer</a> to a similar question to determine which rows in your range are used. Then take the output from that to determine a conclusive range. However if the empty rows are always at the end as per your example above, I suggest changing your selected range based on a <a href=\"https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/38882823#38882823\">lastrow statement</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571820386, "post_id": 58517851, "comment_id": 103363667, "body": "From what I can see, you don&#39;t have any empty rows within your data, just at the end. You could use <code>UsedRange</code> to get your range.. if my above presumption is correct"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12175247"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1571824381, "post_id": 58517851, "comment_id": 103365830, "body": "@Plutian  as I am generating dynamically. The data may vary every time so I need to find range of rows filled with the given range &#39;A2:D16&#39; . This A2:D16 will be constant range does not going to change only within that range I need to find the range of filled data range"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12175247"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1571824400, "post_id": 58517851, "comment_id": 103365842, "body": "@Zac - as I am generating dynamically. The data may vary every time so I need to find range of rows filled with the given range A2:D16 . This A2:D16 will be constant range does not going to change only within that range I need to find the range of filled data range"}], "answers": [{"tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1571826917, "creation_date": 1571826917, "answer_id": 58520917, "question_id": 58517851, "link": "https://stackoverflow.com/questions/58517851/how-do-i-print-only-filled-rows-with-a-range-to-a-mail-excel-vba/58520917#58520917", "title": "How do i print only filled rows with a range to a mail |excel | vba|", "body": "<p>The below loops over all rows in your range, and determines whether there is any values within the row. It then sets the range to include all rows which have data.</p>\n\n<pre><code>Sub rngsel()\nDim rng As Range, cel As Range\n\nFor Each cel In Sheets(\"Sheet1\").Range(\"A2:A16\") 'loop over the first column in your range\n\n    If Not Application.CountA(Range(\"A\" &amp; cel.Row &amp; \":D\" &amp; cel.Row)) = 0 Then 'test if the entire row for each cell has any values with countif\n\n        If rng Is Nothing Then  'test if this is the first row with values\n            Set rng = Range(\"A\" &amp; cel.Row &amp; \":D\" &amp; cel.Row) 'set the first row in the range\n                        Else\n                Set rng = Union(rng, Range(\"A\" &amp; cel.Row &amp; \":D\" &amp; cel.Row)) 'add the found row to the already defined range\n\n        End If\n\n    End If\n\nNext cel\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12175247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571830567, "creation_date": 1571816435, "last_edit_date": 1571830567, "question_id": 58517851, "link": "https://stackoverflow.com/questions/58517851/how-do-i-print-only-filled-rows-with-a-range-to-a-mail-excel-vba", "title": "How do i print only filled rows with a range to a mail |excel | vba|", "body": "<p>As the data is generated from data base using SQL</p>\n\n<p>I want to display certain row of data which are filled within a range </p>\n\n<p>As data is fetched dynamically from the Database the data may vary each time I generate</p>\n\n<p><strong>example:</strong> - below is the data got fetched from database might contain some rows which are empty </p>\n\n<p>[Data][1]: <a href=\"https://i.stack.imgur.com/ysV64.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/ysV64.png</a></p>\n\n<p>So the issue is how do i identify with in a range how many rows are filled only those rows need to be displayed to the email body (Range is A2 : D16) </p>\n\n<p>My code </p>\n\n<pre><code>Private Sub Mail_0_Click()\n'Working in Excel 2000-2016\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set rng = Nothing\n    On Error Resume Next\n    'Only the visible cells in the selection\n    Set rng = Selection.SpecialCells(xlCellTypeVisible)\n    'You can also use a fixed range if you want\n    Set rng = Sheets(\"Sheet\").Range(\"A2:D16\").SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .To = \"example@.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Student Details\"\n        ''.HTMLBody = RangetoHTML(rng)\n        .HTMLBody = \"Hi,\" _\n         &amp; vbNewLine &amp; vbNewLine &amp; _\n         \"Please find your details \" &amp; _\n         RangetoHTML(rng)\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\n\nEnd Function\n</code></pre>\n\n<p>The output should be : only filled rows within a range in a mail body like below</p>\n\n<p>[Output][1]: <a href=\"https://i.stack.imgur.com/oqSLJ.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/oqSLJ.png</a></p>\n"}, {"tags": ["excel", "vba", "mysql-connector"], "comments": [{"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1571816586, "post_id": 58517726, "comment_id": 103361819, "body": "You can&#39;t connect to mysql without using any external libraries, which the other users may not have either. You have to ask them to install something anyway. MyODBC has a really user friendly installer and using it from VBA is a lot simpler than other solutions."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571833416, "post_id": 58517726, "comment_id": 103370653, "body": "FWIW ADODB is usually included by default in most Windows installations. <code>Microsoft.ActiveX.DataObjects</code> is the name of the library in Tools/References. That&#39;s newer than ODBC and I&#39;d think mysql would support it..."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571878154, "post_id": 58517726, "comment_id": 103388850, "body": "@CindyMeister you still need to install myodbc to be able to connect to mysql..."}], "owner": {"reputation": 5, "user_id": 12212515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6db18be0ac4510c3d327f5fd6c6ae12?s=128&d=identicon&r=PG&f=1", "display_name": "lkip0209", "link": "https://stackoverflow.com/users/12212515/lkip0209"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571816833, "creation_date": 1571816025, "last_edit_date": 1571816833, "question_id": 58517726, "link": "https://stackoverflow.com/questions/58517726/mysql-query-from-excel-without-odbc", "title": "MySQL query from excel without ODBC", "body": "<p>Is possible to get connection to mysql server from excel macro, without downloading any ODBC connector? I have found solutions only with this connector. Problem is, that I have to send excel workbook to some people which they don't have this connector in their computer, and it will be a little problem to set it for them.</p>\n\n<p>I need to make only one INSERT query.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1571815041, "post_id": 58517379, "comment_id": 103361079, "body": "What does <code>foundRange.Rows.Count</code> return?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1571815097, "post_id": 58517379, "comment_id": 103361111, "body": "Delete: <code>foundRange.Rows.Select</code>and change <code>MsgBox selection.Rows.Count</code> for <code>MsgBox foundRange.Rows.Count</code>. Also take a look to this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">post</a> on how to avoid using select in VBA"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1571815126, "post_id": 58517379, "comment_id": 103361125, "body": "Note: This is a very complicated (and expensive) way to check and count some data."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571815150, "post_id": 58517379, "comment_id": 103361142, "body": "I think if the rows are not contiguous it will only pick up the first <code>Area</code>. A workaround would be <code>foundRange.count&#47;6</code> or loop through the areas."}, {"owner": {"reputation": 3, "user_id": 12261523, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220497549369013/picture?type=large", "display_name": "Jan Ettema", "link": "https://stackoverflow.com/users/12261523/jan-ettema"}, "edited": false, "score": 0, "creation_date": 1571815757, "post_id": 58517379, "comment_id": 103361403, "body": "foundRange.Rows.Count returns 1."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1571815840, "post_id": 58517379, "comment_id": 103361452, "body": "On the subject of efficiency:  <code>Set foundRange = Union(foundRange, Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6), Cells(i, 7), Cells(i, 8))</code> is the same as just writing <code>Set foundRange = Union(foundRange, Range(Cells(i, 3), Cells(i, 8)))</code>.  That said, this is basically an overcomplicated <code>WorksheetFunction.CountIfs</code>"}, {"owner": {"reputation": 3, "user_id": 12261523, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220497549369013/picture?type=large", "display_name": "Jan Ettema", "link": "https://stackoverflow.com/users/12261523/jan-ettema"}, "edited": false, "score": 0, "creation_date": 1571815874, "post_id": 58517379, "comment_id": 103361470, "body": "Should i loop though the data instead? I use the code with a button, so people can add lines to a table without making duplicates. But i will check out the post you have linked to Damian"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1571815976, "post_id": 58517379, "comment_id": 103361524, "body": "@JanEttema do you need this range for anything on your code later on? If not, as Chronocidal said, you could just use a <code>COUNTIFS</code>"}, {"owner": {"reputation": 3, "user_id": 12261523, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220497549369013/picture?type=large", "display_name": "Jan Ettema", "link": "https://stackoverflow.com/users/12261523/jan-ettema"}, "edited": false, "score": 0, "creation_date": 1571816206, "post_id": 58517379, "comment_id": 103361632, "body": "I think that <code>COUNTIFS</code> actually can do the trick."}, {"owner": {"reputation": 3, "user_id": 12261523, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220497549369013/picture?type=large", "display_name": "Jan Ettema", "link": "https://stackoverflow.com/users/12261523/jan-ettema"}, "edited": false, "score": 0, "creation_date": 1571816240, "post_id": 58517379, "comment_id": 103361647, "body": "But the range is used later on in the code, as i need to remove the required rows by the user"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1571816517, "post_id": 58517379, "comment_id": 103361784, "body": "Then I&#39;d use a <code>Dim counter As Long</code> and when the criteria is meet, <code>counter = counter + 1</code> So you can get the number of rows and retain your ranges. @JanEttema"}, {"owner": {"reputation": 3, "user_id": 12261523, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220497549369013/picture?type=large", "display_name": "Jan Ettema", "link": "https://stackoverflow.com/users/12261523/jan-ettema"}, "edited": false, "score": 0, "creation_date": 1571816886, "post_id": 58517379, "comment_id": 103361964, "body": "Thank you all for your input! I have some to read up about now."}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 2, "last_activity_date": 1571816589, "creation_date": 1571816589, "answer_id": 58517902, "question_id": 58517379, "link": "https://stackoverflow.com/questions/58517379/selection-rows-count-only-returns-1-row-instead-of-3/58517902#58517902", "title": "Selection.rows.count only returns 1 row instead of 3", "body": "<p>If you don't need the cells to be Selected, or stored in <code>foundRange</code> to use later on, then you can just use a <code>CountIfs</code>, like so:</p>\n\n<pre><code>With ActiveSheet.Range(ActiveSheet.Cells(39, 3), ActiveSheet.Cells(lastRow, 8))\n    MsgBox WorksheetFunction.CountIfs(.Columns(1), Range(\"C29\").Value, _\n        .Columns(2), Range(\"D29\").Value, _\n        .Columns(3), Range(\"E29\").Value, _\n        .Columns(4), Range(\"F29\").Value, _\n        .Columns(5), Range(\"G29\").Value, _\n        .Columns(6), Range(\"H29\").Value)\nEnd With\n</code></pre>\n\n<p>If you <em>do</em> need to have the cells stored in a range, then you may need to look through <code>Areas</code> of the <code>Range</code>:</p>\n\n<pre><code>'Most of your code here...\n\nIf foundRange Is Nothing Then\n    MsgBox \"No rows found acording to input\"\nElse\n    'Count amount of rows to be removed\n    foundRange.Rows.Select 'Is this line necessary?\n\n    Dim RangeArea As Range, TotalRows AS Long: TotalRows = 0\n\n'N.B. If your Areas can be in different Columns of the same Row:\n'     use foundRange.EntireRow.Areas to prevent double-counting!\n    For Each RangeArea In foundRange.Areas\n         TotalRows = TotalRows + RangeArea.Rows.Count\n    Next RangeArea\n\n    MsgBox TotalRows\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12261523, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220497549369013/picture?type=large", "display_name": "Jan Ettema", "link": "https://stackoverflow.com/users/12261523/jan-ettema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 58517902, "answer_count": 1, "score": 0, "last_activity_date": 1571816589, "creation_date": 1571814883, "question_id": 58517379, "link": "https://stackoverflow.com/questions/58517379/selection-rows-count-only-returns-1-row-instead-of-3", "title": "Selection.rows.count only returns 1 row instead of 3", "body": "<p>I am fairly new to VBA. </p>\n\n<p>VBA selectes 3 rows, but only count 1? I could not find a similar case, which I could understand.</p>\n\n<p>I could not paste the whole code, as stackoverflow does not allow that kind of post.</p>\n\n<p>Code underneath. </p>\n\n<pre><code>\nFor i = 39 To lastRow\n\n    ' Look for identical rows as input\n    If Cells(i, 3) = Range(\"C29\") And Cells(i, 4) = Range(\"D29\") And Cells(i, 5) = Range(\"E29\") And Cells(i, 6) = Range(\"F29\") And Cells(i, 7) = Range(\"G29\") And Range(\"H29\") = Cells(i, 8) Then\n        If foundRange Is Nothing Then\n\n                'Defines the first row as foundrange, if nothing found earlier\n                Set foundRange = Range(Cells(i, 3), Cells(i, 8))\n        Else\n\n            'Adds rows to foundRange, if one (or more) rows are found\n            Set foundRange = Union(foundRange, Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6), Cells(i, 7), Cells(i, 8))\n    End If\nEnd If\nNext i\n\n\nIf foundRange Is Nothing Then\n    MsgBox \"No rows found acording to input\"\nElse\n\n'Count amount of rows to be removed\nfoundRange.Rows.Select\nMsgBox selection.Rows.Count\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "form-control"], "answers": [{"comments": [{"owner": {"reputation": 493, "user_id": 5696601, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1069c3472dca57b324275fe9caa37afb?s=128&d=identicon&r=PG&f=1", "display_name": "St&#252;cke", "link": "https://stackoverflow.com/users/5696601/st%c3%bccke"}, "edited": false, "score": 1, "creation_date": 1571815529, "post_id": 58517490, "comment_id": 103361303, "body": "Works! Thank you a lot! I will check out the link too. Thanks"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1571817545, "post_id": 58517490, "comment_id": 103362300, "body": "Helpful link [](<a href=\"https://wellsr.com/vba/2016/excel/complete-guide-to-excel-vba-form-control-listboxes/\" rel=\"nofollow noreferrer\">wellsr.com/vba/2016/excel/&hellip;</a>)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1571817668, "post_id": 58517490, "comment_id": 103362352, "body": "@T.M. a very helpfull link. feel free to edit into the answer =)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1571822992, "last_edit_date": 1571822992, "creation_date": 1571815257, "answer_id": 58517490, "question_id": 58517296, "link": "https://stackoverflow.com/questions/58517296/run-time-error-when-retrieving-value-from-formcontrol-listbox/58517490#58517490", "title": "Run-time error when retrieving value from FormControl ListBox", "body": "<p>Try:</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Value = Activesheet.ListBoxes(\"ListBox2\").List(1)\n</code></pre>\n\n<p>Note: a reference to the <code>ActiveSheet</code> is not the best way to reference a sheet. Have a look at <a href=\"https://stackoverflow.com/q/10714251/9758194\">this</a> post here to read more about it.</p>\n\n<p>A helpful overview of <code>FormControl ListBoxes</code> using several methods can be found at the site <a href=\"https://wellsr.com/vba/2016/excel/complete-guide-to-excel-vba-form-control-listboxes/\" rel=\"nofollow noreferrer\">Complete guide to Excel VBA Form Control ListBoxes</a>. - Edited due to Jonas' comment :-)</p>\n"}], "owner": {"reputation": 493, "user_id": 5696601, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1069c3472dca57b324275fe9caa37afb?s=128&d=identicon&r=PG&f=1", "display_name": "St&#252;cke", "link": "https://stackoverflow.com/users/5696601/st%c3%bccke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58517490, "answer_count": 1, "score": 2, "last_activity_date": 1571822992, "creation_date": 1571814595, "last_edit_date": 1592644375, "question_id": 58517296, "link": "https://stackoverflow.com/questions/58517296/run-time-error-when-retrieving-value-from-formcontrol-listbox", "title": "Run-time error when retrieving value from FormControl ListBox", "body": "<p>I added a <code>FormControl</code> <code>ListBox</code> with the name <code>ListBox2</code> to an Excel worksheet and I assigned a Macro <code>RectangleRoundedCorners3_Click</code> to a shape. Now I would like to print the first item of the list box into cell A1:</p>\n<pre><code>Sub RectangleRoundedCorners3_Click()\n\nActiveSheet.Range(&quot;A1&quot;).Value = ActiveSheet.ListBox1.List(0)\n\nEnd Sub\n</code></pre>\n<p>I get the following error:</p>\n<blockquote>\n<p>Run-time error '438':</p>\n<p>Object doesn't support this property or method</p>\n</blockquote>\n<p>I don't really understand why this happens. If I use an <code>ActiveX Controls</code> <code>ListBox</code> the exact same code works perfectly fine.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571814359, "post_id": 58517056, "comment_id": 103360746, "body": "So the problem is the equation? Can you let us know what the correct result would be with some examples? In this example, would the answer be  2.12?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1571814931, "post_id": 58517056, "comment_id": 103361023, "body": "Wow, I totally misinterpreted that question.  Wrote an answer saying that you can&#39;t write the equation  in Excel without referencing Word.  Still with noting here for those who think like my....<a href=\"https://docs.microsoft.com/en-us/office/vba/api/Word.OMath\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/Word.OMath</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12261458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dad979984d10bbb79680207bbb91b9?s=128&d=identicon&r=PG&f=1", "display_name": "Cognex", "link": "https://stackoverflow.com/users/12261458/cognex"}, "edited": false, "score": 0, "creation_date": 1571821565, "post_id": 58517263, "comment_id": 103364291, "body": "Thanks for all the help when i do the calculation on the calculator and math way 0.5 * 2.7182818284 \u221a1+0.5^2   * ( 1+ 1\\\u221a1+0.5^2 )  the answer i get is 2.878706652.   Should the equation in excel be  (x * e * Sqr(1 + x ^ 2)) * (1 + 1 / Sqr(1 + x ^ 2)) i replaced (x * e ^Sqr to (x * e *  Sqr"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1571814497, "creation_date": 1571814497, "answer_id": 58517263, "question_id": 58517056, "link": "https://stackoverflow.com/questions/58517056/how-to-write-equation-in-vba/58517263#58517263", "title": "How to write equation in VBA", "body": "<p>You are missing a few parts of your expression. First, <strong>e</strong> is not defined, and it is also not part of your expression. Have a look at this:</p>\n\n<pre><code>e = 2.7182818284\nAnswer = (x * e ^ Sqr(1 + x ^ 2)) * (1 + 1 / Sqr(1 + x ^ 2))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1571815331, "last_edit_date": 1571815331, "creation_date": 1571815009, "answer_id": 58517416, "question_id": 58517056, "link": "https://stackoverflow.com/questions/58517056/how-to-write-equation-in-vba/58517416#58517416", "title": "How to write equation in VBA", "body": "<p>You can insert a module into you VBA project:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sDAaQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sDAaQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>write below function there:</p>\n\n<pre><code>Function func(x As Double) As Double\n    Dim result As Double\n\n    result = x * Exp(Sqr(1 + x * x))\n    result = result * (1 + 1 / (Sqr(1 + x * x)))\n    func = result\nEnd Function\n</code></pre>\n\n<p>And then use it in worksheet like: <code>=func(A1)</code></p>\n\n<p><strong>NOTE</strong>: <a href=\"https://stackoverflow.com/questions/51264287/vba-power-operator-not-working-as-expected-in-64-bit-vba\"><code>^</code> operator doesn't work everywhere</a></p>\n"}, {"tags": [], "owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1571815185, "creation_date": 1571815185, "answer_id": 58517468, "question_id": 58517056, "link": "https://stackoverflow.com/questions/58517056/how-to-write-equation-in-vba/58517468#58517468", "title": "How to write equation in VBA", "body": "<p>If you want it to be an actual function do this ( @sam has the equation for you ).</p>\n\n<pre><code>Function Equation(x as Double) as Double\n\nDim e = As Double \n\ne = 2.7182818284\n\nEquation = (x * e ^ Sqr(1 + x ^ 2)) * (1 + 1 / Sqr(1 + x ^ 2))\n\nEnd Function\n</code></pre>\n\n<p>Now in B1 you could do <code>=Equation(A1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1571816017, "last_edit_date": 1571816017, "creation_date": 1571815282, "answer_id": 58517495, "question_id": 58517056, "link": "https://stackoverflow.com/questions/58517056/how-to-write-equation-in-vba/58517495#58517495", "title": "How to write equation in VBA", "body": "<p>a) To enter your math formula, you need to know the syntax: </p>\n\n<ul>\n<li>To get the square root, use <code>Sqr</code> (you did already)</li>\n<li>The power function is done with the ^ (caret) character</li>\n<li>There is no build in constant <code>e</code>, you can define it either by defining a constant or use <code>Exp(1)</code> </li>\n</ul>\n\n<p>b) If you want to use your equation available in your Excel, create a <em>UDF</em> (User Defined Function).</p>\n\n<p>Have a look at the following piece of code. I like to split complicated statements into pieces, so I have used 2 intermediate variables.</p>\n\n<p>If your <code>x</code> is in <code>A1</code>, you can for example write the Formula <code>=Equation(A1)</code> into cell <code>B1</code>. </p>\n\n<pre><code>Public Function Equation(x As Double) As Double    \n    Dim term1 As Double, term2 As Double, answer As Double\n    term1 = Sqr(1 + x ^ 2)\n    term2 = 1 + (1 / term1)\n    Equation = x * (Exp(1) ^ term1) * term2\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12261458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dad979984d10bbb79680207bbb91b9?s=128&d=identicon&r=PG&f=1", "display_name": "Cognex", "link": "https://stackoverflow.com/users/12261458/cognex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 58517416, "answer_count": 4, "score": 3, "last_activity_date": 1571817205, "creation_date": 1571813692, "last_edit_date": 1571817205, "question_id": 58517056, "link": "https://stackoverflow.com/questions/58517056/how-to-write-equation-in-vba", "title": "How to write equation in VBA", "body": "<p>I am new to VBA and I am stuck on how to enter the following equation in to VBA so that Cell A1 will can change the value of X. X=0.5<br>\n<img src=\"https://i.stack.imgur.com/XnpMC.jpg\" alt=\"Equation\"></p>\n\n<p>Here is my code in VBA:</p>\n\n<pre><code>Sub Equation()\n\nDim x As Double\nx = Range(\"A1\").Value\nAnswer = Sqr(1 + x ^ 2) &amp; (1 + (1) / Sqr(1 + x ^ 2))\n\nMsgBox (\"The Answer to the equation is \" &amp; Answer)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "range", "getopenfilename"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1571813622, "post_id": 58516960, "comment_id": 103360335, "body": "Your actual range reference is incomplete. However, look at <a href=\"https://stackoverflow.com/q/10714251/9758194\">this</a> post on how to avoid <code>.Activate</code>. Also if you just interested in values, there is no need to copy and paste them (through the clipboard). You should also set a reference to your initial workbook to, to be save."}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1571813515, "creation_date": 1571813515, "answer_id": 58517008, "question_id": 58516960, "link": "https://stackoverflow.com/questions/58516960/getting-runtime-error-1004-using-copy-range-method/58517008#58517008", "title": "Getting Runtime Error 1004 using Copy Range method", "body": "<p>Your range address is invalid. Probably you mean <code>ActiveSheet.Range(\"A2:A3063\")</code></p>\n\n<p>And you should read <a href=\"https://stackoverflow.com/a/10717999/7599798\">https://stackoverflow.com/a/10717999/7599798</a> to get an idea how to deal with Sheets and Ranges without using <code>Activate</code> (or <code>Select</code>)</p>\n"}], "owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58517008, "answer_count": 1, "score": 0, "last_activity_date": 1571822279, "creation_date": 1571813310, "last_edit_date": 1571822279, "question_id": 58516960, "link": "https://stackoverflow.com/questions/58516960/getting-runtime-error-1004-using-copy-range-method", "title": "Getting Runtime Error 1004 using Copy Range method", "body": "<p>Description:\nWhat am I trying to do is allow user to select excel file via browse then copy data from Sheet3 in selected file and paste to current workbook Sheet2 (which name is Raw data(STEP 1)).</p>\n\n<p>My problem is that I am getting:</p>\n\n<blockquote>\n  <p>runtime error 1004 application-defined or object-defined error</p>\n</blockquote>\n\n<p>on this line <code>ActiveSheet.Range(\"A2:3063\").Copy</code></p>\n\n<p>My full code:                                   </p>\n\n<pre><code>Private Sub OpenWorkBook_Click()\n\nDim myFile As Variant\nDim OpenBook As Workbook\nApplication.ScreenUpdating = False\n\nmyFile = Application.GetOpenFilename(Title:=\"Browse your file\", FileFilter:=\"Excel Files(*.xls*),*xls*\")\n\nIf myFile &lt;&gt; False Then\n    Set OpenBook = Application.Workbooks.Open(myFile)\n    OpenBook.Sheets(3).Activate\n    ActiveSheet.Range(\"A2:3063\").Copy\n    ThisWorkbook.Worksheets(\"Raw data(STEP 1)\").Range(\"A3\").PasteSpecial xlPasteValues\n    OpenBook.Close True\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571810918, "post_id": 58516410, "comment_id": 103359194, "body": "<code>cell.offset(0,1).value = &quot;Correct&quot;</code>. But it can all be done a bit smarter. Would you need to iterate a lot of rows? Or really just this little rows?"}, {"owner": {"reputation": 13, "user_id": 12261263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819e6b28b05b15b67fb1a8393d6e8602?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12261263/wayne"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571811104, "post_id": 58516410, "comment_id": 103359255, "body": "Hi thanks for the reply. yes i need to iterate around 1000 rows. may you advise me?"}], "answers": [{"comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1571813104, "post_id": 58516586, "comment_id": 103360079, "body": "Up-voting for the formula suggestion as I think that is the better route in this particular case."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1571811535, "creation_date": 1571811535, "answer_id": 58516586, "question_id": 58516410, "link": "https://stackoverflow.com/questions/58516410/how-can-i-show-the-data-in-specific-cell/58516586#58516586", "title": "How can i show the data in specific cell?", "body": "<p>Just try:</p>\n\n<pre><code>Sub test()\n  Dim i As Long\n  For i = 1 To Rows.Count\n    If Cells(i, 1) = \"yes.com\" Then Cells(i, 2) = \"Correct\"\n  Next\nEnd Sub\n</code></pre>\n\n<p>It will loop through entire <code>A</code> column.</p>\n\n<p>Alternatively, you can enter in B1 formula:</p>\n\n<pre><code>=IF(A1=\"yes.com\",\"Correct\",\"\")\n</code></pre>\n\n<p>and drag it all the way down.</p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1571813075, "last_edit_date": 1571813075, "creation_date": 1571811997, "answer_id": 58516676, "question_id": 58516410, "link": "https://stackoverflow.com/questions/58516410/how-can-i-show-the-data-in-specific-cell/58516676#58516676", "title": "How can i show the data in specific cell?", "body": "<p>Currently you are looping through a range object. Per cell. One a small dataset this is fine but in your current attempt you'll need to change:</p>\n\n<p><code>Range(\"B2:B4\").Value = \"Correct\"</code> for <code>cell.Offset(0,1).value = \"Correct\"</code></p>\n\n<p>As per my comment, you can do this a bit smarter/faster. Looping through worksheet cells is slow, certainly on large datasets (a 1000 rows is not that many yet to be honest). Nonetheless it's good to know that a good practice is to go through arrays. Let me show you below:</p>\n\n<pre><code>Sub Testing()\n\nDim lr As Long, x As Long\nDim arr As Variant\n\nWith Sheet1 'Change accordingly\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr = .Range(\"A2:B\" &amp; lr)\n    For x = LBound(arr) To UBound(arr)\n        If arr(x, 1) = \"yes.com\" Then\n            arr(x, 2) = \"correct\"\n        End If\n    Next x\n    .Range(\"A2:B\" &amp; lr).Value = arr\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>So you can see a few things that will be helpfull:</p>\n\n<ul>\n<li>A reference to a sheet (through a <code>CodeName</code> to refer to a range's parent. Without it, the macro will simply reference the <code>ActiveSheet</code> which is for obvious reasons not always the correct one.</li>\n<li>I have made use of a dynamic sized array. The <code>lr</code> variable will get the last used row in column A, so you don't have to work through full qualified references no more.</li>\n<li>The <code>arr</code> variable is an array which takes the values from the specified range into memory. Running through data in memory is much quicker than a loop/iteration over worksheet cells. This will become much more noticable when you would have even larger datasets.</li>\n<li>I wrote the array back to the range in one go instead of several writings.</li>\n</ul>\n\n<p>Hopefully that helped =)</p>\n\n<hr>\n\n<p>As previously mentioned a 1000 rows is still not that much. Allthough I suggest you stick with the <code>Array</code> approach, you can also <code>Evaluate</code> column A and fill column B accordingly in one go instead of stepping through a range object. It's an array formula in disguise so not very quick on actual large datasets.</p>\n\n<pre><code>Sub Testing()\n\nDim lr As Long\nDim rng As Range\n\nWith Sheet1 'Change accordingly\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Set rng = .Range(\"A2:B\" &amp; lr)\n    rng.Columns(2).Value = .Evaluate(\"IF(\" &amp; rng.Columns(1).Address &amp; \"=\"\"yes.com\"\",\"\"correct\"\",\"\"\"\")\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12261263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819e6b28b05b15b67fb1a8393d6e8602?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12261263/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58516676, "answer_count": 2, "score": 1, "last_activity_date": 1571813075, "creation_date": 1571810775, "last_edit_date": 1571811551, "question_id": 58516410, "link": "https://stackoverflow.com/questions/58516410/how-can-i-show-the-data-in-specific-cell", "title": "How can i show the data in specific cell?", "body": "<p>Hi i want to show an output to a specific cell at B column but i really don't have any idea on how to make it to show. Example: if \"A2\" has the record i want \"B2\" to show the output. If \"A100\" has the record, i want \"B100\" to show the output</p>\n\n<pre><code>Sub Testing()\n\n  Dim cell As Range\n  For Each cell In Range(\"A2:A4\")\n    If cell.Value = \"yes.com\" Then\n      Range(\"B2:B4\").Value = \"Correct\"\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>The code above shows the output data \"Correct\" from \"B2\" to \"B4\" but what i want it to show on only the specific cell. Please Help</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 568, "user_id": 4630650, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/799739480117365/picture?type=large", "display_name": "Bhavesh Shaha", "link": "https://stackoverflow.com/users/4630650/bhavesh-shaha"}, "edited": false, "score": 0, "creation_date": 1571809668, "post_id": 58515764, "comment_id": 103358728, "body": "Can you attach a photo before and after toggling presentation view?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1571839858, "post_id": 58515764, "comment_id": 103374486, "body": "Super User or Answers.microsoft.com would be a better place for this question. You&#39;re seeing a video driver problem. You may be able to fix it by installing a recent video driver from your computer manufacturer. You can also try File&gt;Options&gt;Advanced&gt;Display and checking Disable Slide Show hardware graphics acceleration."}, {"owner": {"reputation": 1, "user_id": 1152929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54fdc8af2d8bf7dd02710e13881147fc?s=128&d=identicon&r=PG", "display_name": "user1152929", "link": "https://stackoverflow.com/users/1152929/user1152929"}, "edited": false, "score": 0, "creation_date": 1571988390, "post_id": 58515764, "comment_id": 103427657, "body": "Thanks John. Video drivers are up to date but disabling hardware acceleration fixed the problem. Many thanks. I put this up on Microsoft&#39;s forum but still haven&#39;t had a reply despite it going up there first."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 15013982, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f45e512e26dbfbe44184925e2695ca74?s=128&d=identicon&r=PG", "display_name": "Edward Francis", "link": "https://stackoverflow.com/users/15013982/edward-francis"}, "is_accepted": false, "score": 0, "last_activity_date": 1610728128, "creation_date": 1610728128, "answer_id": 65739823, "question_id": 58515764, "link": "https://stackoverflow.com/questions/58515764/powerpoint-activex-text-boxes-and-labels-split-in-to-2-parts-during-presentation/65739823#65739823", "title": "PowerPoint ActiveX text boxes and labels split in to 2 parts during presentation", "body": "<p>On the monitor that I was presenting on, I changed the display property scale settings from 100% to 125% and the issue resolved.</p>\n"}], "owner": {"reputation": 1, "user_id": 1152929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54fdc8af2d8bf7dd02710e13881147fc?s=128&d=identicon&r=PG", "display_name": "user1152929", "link": "https://stackoverflow.com/users/1152929/user1152929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610728128, "creation_date": 1571806884, "last_edit_date": 1582781978, "question_id": 58515764, "link": "https://stackoverflow.com/questions/58515764/powerpoint-activex-text-boxes-and-labels-split-in-to-2-parts-during-presentation", "title": "PowerPoint ActiveX text boxes and labels split in to 2 parts during presentation", "body": "<p>When I add a text box or label from Powerpoint's developer tab, they look fine until I run the presentation and then they split into 2 boxes, one where it should be but is unfunctioning and another one above and left of the first that allows actions. </p>\n\n<p>I haven't tried anything as I have no idea why it is acting this way</p>\n\n<p>I simply want a control that I can activate to pop up an input box and to store the result. It happens with labels and text boxes as soon as I assign some vba code to it. The input box / vba works fine but having the ghost box ruins the page layout.<a href=\"https://i.stack.imgur.com/tDepy.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>presentation mode:\n<a href=\"https://i.stack.imgur.com/EOLiQ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571806747, "post_id": 58515374, "comment_id": 103357989, "body": "If your Find fails then the chained Activate will raise an error.  Comment out the <code>On Error</code> to see if that&#39;s the problem."}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571807453, "post_id": 58515374, "comment_id": 103358149, "body": "I have tried this but doesn&#39;t work. it gives error when Find fails."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571812442, "post_id": 58515374, "comment_id": 103359777, "body": "avoid using <code>ActiveSheet</code> as well. Incoporate that in @TimWilliams code and try again. also remember <code>lookat:=xlWhole</code> will find the whole word. Maybe you want <code>lookat:=xlPart</code>?"}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571840050, "post_id": 58515374, "comment_id": 103374612, "body": "I am v greatful for the help. But can anybody point the exact issue in my code. I want to know for my knowledge."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571811005, "post_id": 58515999, "comment_id": 103359221, "body": "Not working. Although it does not give any error but does not perform the desired task too."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571842343, "post_id": 58515999, "comment_id": 103375923, "body": "I made a guess you wanted exact match, but maybe that&#39;s not the case?  Anyhow, did you try debugging to see what&#39;s not working?"}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571843362, "post_id": 58515999, "comment_id": 103376505, "body": "The find portion of code shows error. Can&#39;t figure out why."}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571847008, "post_id": 58515999, "comment_id": 103378382, "body": "Object variable or with block variable not set"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571866537, "post_id": 58515999, "comment_id": 103386364, "body": "Which exact line?"}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571888051, "post_id": 58515999, "comment_id": 103390631, "body": "<code>Cells.Find(What:=Sheet2.Cells(rw, 1)).Activate</code> This line is highlighted in error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1571891102, "post_id": 58515999, "comment_id": 103391215, "body": "That&#39;s not in my code and there&#39;s a reason why my code doesn&#39;t try to do that, explained in my first comment on your question."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1571842286, "last_edit_date": 1571842286, "creation_date": 1571808405, "answer_id": 58515999, "question_id": 58515374, "link": "https://stackoverflow.com/questions/58515374/object-variable-or-with-block-variable-not-set-code-suddenly-put-on-the-error/58515999#58515999", "title": "Object Variable or with block variable not set. Code suddenly put on the error", "body": "<p>You can do something like this:</p>\n\n<pre><code>Dim c As Range, f As Range\n\nSet c = Sheet2.Cells(1, 1)\n\nDo Until IsEmpty(c)\n    Set f = ActiveSheet.Cells.Find(What:=c.Value, lookat:=xlWhole)\n    'got a match?\n    If Not f is nothing then\n         'highlight the match\n         With f.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 65535\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n         End With\n\n         Sheet2.Cells(1, 3) = Sheet2.Cells(1, 3) + 1\n\n         c.offset(0, 1).Value = \"Found\"\n     End if\n\n     Set c = c.offset(1,0) 'next row \nLoop\nMsgBox \"Total E-Forms Searched \" &amp; Sheet2.Cells(1, 3)\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571842286, "creation_date": 1571803926, "last_edit_date": 1571809676, "question_id": 58515374, "link": "https://stackoverflow.com/questions/58515374/object-variable-or-with-block-variable-not-set-code-suddenly-put-on-the-error", "title": "Object Variable or with block variable not set. Code suddenly put on the error", "body": "<p>Please let me know the error in this code. It was working fine a few hours ago and suddenly started giving error </p>\n\n<blockquote>\n  <p>\"Object Variable or with block variable not set\"</p>\n</blockquote>\n\n<pre><code>'\n' Find Macro\n'\n\n'\nDim rw As Integer\nrw = 1\n\n Do Until IsEmpty(Sheet2.Cells(rw, 1))\n    Cells.Find(What:=Sheet2.Cells(rw, 1)).Activate\n\n         On Error GoTo hello\n\n\n         With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n\n       Sheet2.Cells(rw, 2).Value = \"Found\"\n\nhello:          rw = rw + 1\nSheet2.Cells(1, 3) = Sheet2.Cells(1, 3) + 1\n\n\n      End With\n      Loop\nMsgBox \"Total E-Forms Searched \" &amp; Sheet2.Cells(1, 3)\nEnd Sub\n</code></pre>\n\n<p>It is finding data in sheet1 and highlights it yellow. Criteria is in sheet2.</p>\n"}, {"tags": ["javascript", "excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571803129, "post_id": 58515203, "comment_id": 103357242, "body": "Welcome to SO! When you place a question try to add a minimum content: input sample, expected output sample, what did you try, research and where are you stacked. So whatever you can bring to clarify your question is welcome. Did you try the Macro Recorder?"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571805482, "post_id": 58515203, "comment_id": 103357715, "body": "Sometimes, depends on the webpage, even if the data comes from a CSV data, they have not been design to download, just to show. Could you give us, as I mention in my previous comment, one sample?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571806506, "post_id": 58515203, "comment_id": 103357936, "body": "The &quot;URL&quot; you see when hovering over the button may not have any connection to how the Excel is produced or downloaded - the button may just be there to trigger a script."}, {"owner": {"reputation": 1, "user_id": 12260848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641ded9b7500a977989554364e697278?s=128&d=identicon&r=PG&f=1", "display_name": "TheHalfMonty", "link": "https://stackoverflow.com/users/12260848/thehalfmonty"}, "edited": false, "score": 0, "creation_date": 1571838558, "post_id": 58515203, "comment_id": 103373678, "body": "I added a screenshot of my browser so you can kind of see what I&#39;m talking about.  Can I use the macro recorder in Excel to handle this task?  Will the recorder be able to capture what I&#39;m doing in my browser?  (Apologies in advance.  I&#39;m still relatively new to VBA.)  Thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571877592, "post_id": 58515203, "comment_id": 103388764, "body": "99% likely that is not a real working URL you&#39;re seeing but an artifact of how the menus are implemented in the browser.  You&#39;d need to look at the HTML source to figure out what&#39;s really going on.  Macro recorder only records what you do in Excel - it will not capture actions in other applications."}], "owner": {"reputation": 1, "user_id": 12260848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641ded9b7500a977989554364e697278?s=128&d=identicon&r=PG&f=1", "display_name": "TheHalfMonty", "link": "https://stackoverflow.com/users/12260848/thehalfmonty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571838197, "creation_date": 1571802580, "last_edit_date": 1571838197, "question_id": 58515203, "link": "https://stackoverflow.com/questions/58515203/download-url-from-website-with-vba-macro-but-it-doesnt-have-extension", "title": "Download URL from website with VBA macro but it doesn&#39;t have extension", "body": "<p><a href=\"https://i.stack.imgur.com/2pXiq.jpg\" rel=\"nofollow noreferrer\">Browser Screenshot</a></p>\n\n<p>I've been trying to find a solution but have been coming up empty handed...probably due to my own inexperience. I'm trying to automate a procedure from Excel that goes to a website (requires my username and password), downloads the Excel export file (it usually has a button next to a table that says \"Export to Excel\"), and saves that spreadsheet to a location on my C: drive. The problem I'm running into is that I can see the URL if I hover over the \"Export to Excel\" button, but it doesn't end in .CSV or .XLS. The link is websitename.com/name/# as opposed to websitename.com/name.csv. Is there a way I can find the URL for the Excel export file so that I can use that in the myURL variable from the code below?</p>\n\n<p>Let me know if screenshots or anything else is helpful here. Thank you</p>\n\n<pre><code>Sub DownloadFile()\n\nDim myURL As String\nmyURL = \"Insert URL with file extension\"\n\nDim WinHttpReq As Object\nSet WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\nWinHttpReq.Open \"GET\", myURL, False, \"MyUserName\", \"MyPassword\"\nWinHttpReq.send\n\nDim oStream As Variant\nIf WinHttpReq.Status = 200 Then\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write WinHttpReq.responseBody\n    oStream.SaveToFile \"C:\\Users\\Me\\File.csv\", 2 ' 1 = no overwrite, 2 = overwrite\n    oStream.Close\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "excel", "vba", "onchange"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571811322, "post_id": 58515101, "comment_id": 103359333, "body": "Can you provide a value for <i>var</i> that produces a valid url for testing please? Also, I think the url is likely location based in terms of access given my experience with the domain. And are you getting any error messages? If so, what?"}, {"owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571839081, "post_id": 58515101, "comment_id": 103373986, "body": "Var can be &quot;2330&quot;, &quot;1232&quot; and &quot;2317&quot;. Please try it. It pops up error method &#39;queryselector&#39; of object &#39;Jscripttypeinfo&#39; failed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571839213, "post_id": 58515101, "comment_id": 103374079, "body": "You are going to have to switch to non querySelector e.g. getElementsByTagName and do a loop testing inner text or .valu"}, {"owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1571883811, "post_id": 58515101, "comment_id": 103389856, "body": "Thanks QHarr your tips. It works with getElementsByTagName(). <a href=\"https://stackoverflow.com/questions/58254532/excel-vba-to-activate-selectitem-in-web-and-go-web-for-data\" title=\"excel vba to activate selectitem in web and go web for data\">stackoverflow.com/questions/58254532/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571883978, "post_id": 58515101, "comment_id": 103389895, "body": "you are most welcome."}, {"owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571887376, "post_id": 58515101, "comment_id": 103390495, "body": "I have an issue for web table. Wondering if you have some tips or codes. Thanks <a href=\"https://stackoverflow.com/questions/58533678/how-vba-to-scrape-table-from-web\" title=\"how vba to scrape table from web\">stackoverflow.com/questions/58533678/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571807936, "creation_date": 1571801812, "last_edit_date": 1571807936, "question_id": 58515101, "link": "https://stackoverflow.com/questions/58515101/how-vba-to-code-fireevent-on-change-in-selected-terms-in-javascript", "title": "How VBA to code fireevent &quot;on change&quot; in selected terms in Javascript", "body": "<p>How to code in VBA for fireevent \"onchange\" in selected term in Javascript. It doesn't work as coding <code>.querySelector(\".zcq0.djhtm?b=Q&amp;a= &amp; var &amp; \").FireEvent \"onchange\"</code>. Can someone help it, thanks in advance?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub GetTWYIn()\n    Dim ie As Object, URL As String, var As Object, ele As Object, td As Date\n    Const max_wait_sec As Long = 10\n\n    Set var = ThisWorkbook.Worksheets(\"Sheet3\").Cells(1, 1)\n    URL = \"http://pscnetinvest.moneydj.com.tw/z/zc/zcq/zcqa/zcqa_\" &amp; var &amp; \".djhtm\"\n    Set ie = CreateObject(\"internetexplorer.application\")\n    With ie\n        .Visible = True\n        .navigate URL\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            b = Timer\n            Do\n                On Error Resume Next\n                Set ele = .querySelector(\"[value$='/zcq0.djhtm?b=Q&amp;a=\" &amp; var &amp; \"']\")\n\n                On Error GoTo 0\n                If Timer - td &gt; max_wait_sec Then Exit Do\n            Loop While ele Is Nothing\n            If ele Is Nothing Then Exit Sub\n            ele.Selected = True\n            .querySelector(\".zcq0.djhtm?b=Q&amp;a= &amp; var &amp; \").FireEvent \"onchange\"\n        End With\n    End With\n     Set ie = Nothing`\nEnd Sub\n</code></pre>\n\n<p>This is html.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;SELECT name=\"selB\" id=\"selB\" onchange=\"javascript:selopn(this.options[this.selectedIndex].value);\"&gt;\n\n&lt;OPTION value=\"/z/zc/zcq/zcq0.djhtm?b=Q&amp;a=1232\" &gt;\u5b63\u8868&lt;/OPTION&gt;\n&lt;OPTION value=\"/z/zc/zcq/zcq0.djhtm?b=A&amp;a=1232\" &gt;\u7d2f\u8a08\u5b63\u8868&lt;/OPTION&gt;\n&lt;OPTION value=\"/z/zc/zcq/zcq0.djhtm?b=Y&amp;a=1232\"  selected&gt;\u5e74\u8868&lt;/OPTION&gt;\n\n&lt;/SELECT&gt;\n</code></pre>\n"}, {"tags": ["vba", "pivot-chart"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12253827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d2c7e79ceaa76950cbbb1442f6db18?s=128&d=identicon&r=PG&f=1", "display_name": "snappy_irides", "link": "https://stackoverflow.com/users/12253827/snappy-irides"}, "edited": false, "score": 0, "creation_date": 1571866698, "post_id": 58515781, "comment_id": 103386405, "body": "Thanks for your reply, I looked at your previous example and that cleared up some errors. I got the graph sorted in the way I wanted with the attached code; is there a better way of doing this? (sorry for the shitty formatting) `` With PvtSht     .Range(&quot;B2&quot;, .Cells(.Rows.Count, &quot;B&quot;).End(xlUp)).Sort _     Key1:=.Range(&quot;B2&quot;), Order1:=xlDescending, _     Header:=xlYes End With ``"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 12253827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d2c7e79ceaa76950cbbb1442f6db18?s=128&d=identicon&r=PG&f=1", "display_name": "snappy_irides", "link": "https://stackoverflow.com/users/12253827/snappy-irides"}, "edited": false, "score": 0, "creation_date": 1571867862, "post_id": 58515781, "comment_id": 103386763, "body": "That looks fine to me"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1571806966, "creation_date": 1571806966, "answer_id": 58515781, "question_id": 58515056, "link": "https://stackoverflow.com/questions/58515056/applying-pivotfield-autosort-when-generating-a-pivot-chart/58515781#58515781", "title": "Applying &quot;PivotField.Autosort&quot; when generating a pivot chart", "body": "<p>\"that part works just fine with the error message suppressed\" it doesn't work fine, it just doesn't matter that it doesn't work.</p>\n\n<pre><code>Dim PCache As PivotCache\n\n'...\n'...\n\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n          (SourceType:=xlDatabase, SourceData:=PRange). _\n          CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n          TableName:=\"MaintenanceData\")\n</code></pre>\n\n<p>Here you create a pivotcache, but then use it to create a pivottable, and try to assign that pivottable to your PCache variable (which can only be used for a pivotcache...)  So that raises a run-time error, but by that point the pivottable is created, and you pick that up on the next line.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/58493637/vba-copy-pivot-table-to-new-sheet/58493696#comment103317725_58493696\">VBA Copy Pivot Table to New Sheet</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12253827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d2c7e79ceaa76950cbbb1442f6db18?s=128&d=identicon&r=PG&f=1", "display_name": "snappy_irides", "link": "https://stackoverflow.com/users/12253827/snappy-irides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583744674, "creation_date": 1571801436, "last_edit_date": 1583744674, "question_id": 58515056, "link": "https://stackoverflow.com/questions/58515056/applying-pivotfield-autosort-when-generating-a-pivot-chart", "title": "Applying &quot;PivotField.Autosort&quot; when generating a pivot chart", "body": "<p>I am creating a macro to generate some clustered column pivot charts. I have used examples from the internet/stack overflow to generate the pivot table, generate the pivot chart and display the columns in decreasing order.</p>\n\n<p>I have consulted the Microsoft Documentation and tried fiddling with the syntax of <code>PivotField.Autosort</code>.</p>\n\n<p>Here is a generalised version of my code with comments. The Autosort command to display the columns in descending order is the last two lines:</p>\n\n<pre><code>'Declare Variables\nDim PSheet As Worksheet 'To create a sheet for a new pivot table.\nDim DSheet As Worksheet 'To use as a data sheet.\nDim PCache As PivotCache 'To use as a name for pivot table cache.\nDim PTable As PivotTable 'To use as a name for our pivot table.\nDim PRange As Range 'to define source data range.\nDim LastRow As Long 'To get the last row and column of our data range.\nDim LastCol As Long '\n\nDim chtObj      As ChartObject\nDim PvtSht      As Worksheet\nDim PvtTbl      As PivotTable\n\n'After inserting a new worksheet, this code will set the value of FSheet\n'variable to pivot table worksheet and DSheet to source data worksheet.\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"MaintActivType\").Delete\nWorksheets(\"Sheet1\").Select\nSheets.Add After:=ActiveSheet\nActiveSheet.Name = \"MaintActivType\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"MaintActivType\")\nSet DSheet = Worksheets(\"Sheet1\")\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Define Pivot Cache\n'In Excel 2000 and above, before creating a pivot\n'table you need to create a pivot cache to define the data source.\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"MaintenanceData\")\n\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable _\n(TableDestination:=PSheet.Cells(1, 1), TableName:=\"MaintenanceData\")\n\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"MaintenanceData\").PivotFields(\"MaintActivType\")\n    .Orientation = xlRowField\n    .Position = 1 'this field allows for sub-categories of data to be displayed\nEnd With\n\n'Insert Column Fields\nWith ActiveSheet.PivotTables(\"MaintenanceData\").PivotFields(\"MaintActivType\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlCount\n    .Name = \"Count of MaintActivType\"\nEnd With\n\n' set the Pivot sheet\nSet PvtSht = Sheets(\"MaintActivType\")\n\n' set the Pivot Table object\nSet PvtTbl = PvtSht.PivotTables(\"MaintenanceData\")\n\n' set the Chart Object\nSet chtObj = PvtSht.ChartObjects.Add(300, 200, 550, 200)\n\n' modify ChartObject properties\nWith chtObj\n    .Chart.SetSourceData PvtTbl.TableRange2 ' set the chart's data range to the Pivot-Table's TableRange2\n    .Chart.ChartType = xlColumnClustered\n    .Name = \"Maintenance Activity Type\"\n    .Chart.HasTitle = True\n    .Chart.ChartTitle.Text = \"Maintenance Activity Type\"\n    .Chart.HasLegend = False\nEnd With\n\nActiveSheet.PivotTables(\"MaintenanceData\").PivotField(\"MaintActivType\") _\n  .AutoSort xlDescending, \"Sum of MaintActivType\"\n'End With\n</code></pre>\n\n<p>I don't get any error messages associated with the Autosort command, but if I comment out the <code>On Error Resume Next</code> I get a Type mismatch error for the pivot cache creation (\"Set&nbsp;Pcache&nbsp;...\"), which is baffling because that part works just fine with the error message suppressed.</p>\n"}, {"tags": ["excel", "vba", "label"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571805723, "post_id": 58515052, "comment_id": 103357759, "body": "Did you check that Worksheet backside exists? Because if it exists, <code>StartRow = Worksheets(&quot;Backside&quot;).Range(&quot;T4&quot;).Value</code> works if the sheet exists."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571806015, "post_id": 58515052, "comment_id": 103357823, "body": "Maybe the value in T4 can&#39;t be placed into an integer?  What is in T4 when it fails?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1571810976, "post_id": 58515052, "comment_id": 103359209, "body": "<code>Worksheets(&quot;Backside&quot;).Range(&quot;T4&quot;).Value</code> is most likely a formula and it has some type of error."}], "owner": {"reputation": 23, "user_id": 8677762, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728019463876028/picture?type=large", "display_name": "ositis", "link": "https://stackoverflow.com/users/8677762/ositis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571802416, "creation_date": 1571801402, "last_edit_date": 1571802416, "question_id": 58515052, "link": "https://stackoverflow.com/questions/58515052/excel-vba-automatic-print-range-not-working-after-update", "title": "Excel VBA Automatic print range not working after update", "body": "<p>I've been using this Excel VBA script combined with my label printing sheet, but suddenly it has stopped working. I think it has to do with a new update.\nIt's used to loop through my data and print multiple labels, but now it only prints one and stops, not going to the next line.</p>\n\n<p>Can someone please take a look at the code and see if there is something that might be interrupting the process?</p>\n\n<p>I'm getting type mismatch \"13\" error on this row:</p>\n\n<p><code>StartRow = Worksheets(\"Backside\").Range(\"T4\").Value</code></p>\n\n<p>This is the rest of the code:</p>\n\n<pre><code>Sub PrintOneShelf()\nDim NrPositions As Integer\nDim StartRow As Integer\n\n\nApplication.Calculate\n\n\n    NrPositions = Worksheets(\"Backside\").Range(\"T3\").Value\n    StartRow = Worksheets(\"Backside\").Range(\"T4\").Value\n    PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n\n    Worksheets(\"Backside\").PrintOut From:=1, To:=NrPositions, Copies:=1\n\n    NrPositions = Worksheets(\"Frontside\").Range(\"T3\").Value\n    StartRow = Worksheets(\"Frontside\").Range(\"T4\").Value\n\n    Worksheets(\"Frontside\").PrintOut From:=1, To:=NrPositions, Copies:=1\n    Worksheets(\"Print Overview\").Cells(PrintRow, 2).Value = \"x\"\n\n\nEnd Sub\nSub PrintBackShelf()\n\nDim NrPositions As Integer\nDim StartRow As Integer\n\n\nApplication.Calculate\n\n\n    NrPositions = Worksheets(\"Backside\").Range(\"T3\").Value\n    StartRow = Worksheets(\"Backside\").Range(\"T4\").Value\n    PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n\n    Worksheets(\"Backside\").PrintOut From:=1, To:=NrPositions, Copies:=1\n    Worksheets(\"Print Overview\").Cells(PrintRow, 2).Value = \"x\"\n\nEnd Sub\n\nSub PrintFrontShelf()\n\nDim NrPositions As Integer\nDim StartRow As Integer\n\n\nApplication.Calculate\n\n    NrPositions = Worksheets(\"Frontside\").Range(\"T3\").Value\n    StartRow = Worksheets(\"Frontside\").Range(\"T4\").Value\n    PrintRow = Worksheets(\"Frontside\").Range(\"T5\").Value\n\n    Worksheets(\"Frontside\").PrintOut From:=1, To:=NrPositions, Copies:=1\n    Worksheets(\"Print Overview\").Cells(PrintRow, 3).Value = \"x\"\n\n\n\nEnd Sub\n\nSub PrintBackShelves()\n\nDim StartRow\n\nApplication.Calculate\n\n    PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n\n    Do While IsNumeric(PrintRow)\n\n        Call PrintBackShelf\n        Application.Calculate\n        PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n    Loop\n\nEnd Sub\nSub PrintFrontShelves()\n\nDim StartRow\n\nApplication.Calculate\n\n    PrintRow = Worksheets(\"Frontside\").Range(\"T5\").Value\n\n    Do While IsNumeric(PrintRow)\n\n        Call PrintFrontShelf\n        Application.Calculate\n        PrintRow = Worksheets(\"Frontside\").Range(\"T5\").Value\n    Loop\n\nEnd Sub\n\nSub PrintShelves()\n\nDim StartRow\n\nApplication.Calculate\n\n    PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n\n    Worksheets(\"Print Overview\").Range(\"B5\").End(xlDown).Value = \"\"\n\n    Do While IsNumeric(PrintRow)\n\n        Call PrintBackShelf\n        Application.Calculate\n        PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n    Loop\n\n\n\nApplication.Calculate\n\n    Worksheets(\"Print Overview\").Range(\"B5\").End(xlDown).Value = \"\"\n\n    PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n\n    Do While IsNumeric(PrintRow)\n\n        Call PrintFrontShelf\n        Application.Calculate\n        PrintRow = Worksheets(\"Backside\").Range(\"T5\").Value\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571805991, "post_id": 58514761, "comment_id": 103357818, "body": "Some screenshots will help. Anyhow, did you try to create some code or just the one on the post? I will recommend you to use the Macro Recorder for one sample, try to clean as much as you can and, then, bring the new code with your doubts. It seems that you are asking us to develop you code and SO is not a free coding service."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 1, "creation_date": 1571816171, "post_id": 58514761, "comment_id": 103361620, "body": "You don&#39;t need to create an array for this. Try to copy the columns while you are already looping through the sheets and pasting them in the new sheet you created instead of adding them to the array"}, {"owner": {"reputation": 45, "user_id": 10934092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9ac9998b85959937cbb4a4f5b9b389?s=128&d=identicon&r=PG&f=1", "display_name": "gbengel", "link": "https://stackoverflow.com/users/10934092/gbengel"}, "edited": false, "score": 0, "creation_date": 1571839613, "post_id": 58514761, "comment_id": 103374339, "body": "Thanks for the starting point, Pablo. I have simplified the code to the following but I think it is too simple for what I am trying to capture. What do I need before calling the &quot;copy &quot; function. For loops and and arrays are new for me. &#39;Sub Summary_Sheet()  Dim WS As Object Dim newName As String  newName = InputBox(&quot;Enter Doctor&#39;s Last Name&quot;)  Sheets.Add After:=Worksheets(Sheets.Count) ActiveSheet.Name = newName   For Each WS In ActiveWorkbook.Sheets  If InStr(WS.Name, &quot;newName&quot;) Then     Cells(&quot;C8:C8&quot;).Copy     Sheets(&quot;Test&quot;).Range(&quot;C8&quot;).Paste  End If  Next  End Sub&#39;"}, {"owner": {"reputation": 45, "user_id": 10934092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9ac9998b85959937cbb4a4f5b9b389?s=128&d=identicon&r=PG&f=1", "display_name": "gbengel", "link": "https://stackoverflow.com/users/10934092/gbengel"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571840113, "post_id": 58514761, "comment_id": 103374655, "body": "@DavidGarc&#237;aBodego I did create that code through copy and paste of other sources. Do not need anything written, merely a starting point for this loop as it is my first one"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571893161, "post_id": 58514761, "comment_id": 103391762, "body": "Welcome to SO! When you place a question try to add a minimum content: input sample, expected output sample, what did you try, research and where are you stuck. @gbengel. With no screenshots, we don&#180;t know how your data is disposed and which kind of data you have. You did not expose which one is your expected output."}], "owner": {"reputation": 45, "user_id": 10934092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9ac9998b85959937cbb4a4f5b9b389?s=128&d=identicon&r=PG&f=1", "display_name": "gbengel", "link": "https://stackoverflow.com/users/10934092/gbengel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571809738, "creation_date": 1571798908, "last_edit_date": 1571809738, "question_id": 58514761, "link": "https://stackoverflow.com/questions/58514761/how-to-copy-specific-columns-to-a-new-sheet-based-on-a-user-input-contained-with", "title": "How to copy specific columns to a new sheet based on a user input contained within the name of a worksheet?", "body": "<p>I am developing an audit tracking sheet for some medical coder colleagues and would like to write a macro that would allow them to easily summarize the information they are tracking. The workflow is as follows...</p>\n\n<ol>\n<li><p>A Doctor is Selected for Audit</p></li>\n<li><p>Each Patient has his/her own unique tab created that contains their specific information</p></li>\n<li><p>The audit is performed in each sheet</p></li>\n</ol>\n\n<p>Once the audit is complete, I need to summarize all the changes for one doctor. The naming convention of all the sheet is the same, as well as the structure. </p>\n\n<p>What I would like to have happen is let them run one macro that will copy columns \"R:T\" from every sheet in the workbook that contains the last name of the doctor and stack them on top of one another in a new sheet. However, I want this new sheet to be created from the Macro and the name of that sheet will be a user input. I hope this is clear. Let me know if anyone needs more detail. The following code is where I have started, but I need help to get further. Please see below.</p>\n\n<pre><code>Sub Summary_Sheet()    \n    Dim sArr() As String, Cnt As Long, WS As Object\n    Dim newName As String\n    ReDim sArr(0)\n\n    newName = InputBox(\"Enter Doctor's Last Name\")\n\n    Sheets.Add After:=Worksheets(Sheets.Count)\n    ActiveSheet.Name = newName\n\n    Cnt = 0\n    For Each WS In ActiveWorkbook.Sheets        \n        If InStr(WS.Name, newName) Then\n            ReDim Preserve sArr(Cnt)\n            sArr(Cnt) = WS.Name\n            Cnt = Cnt + 1\n        End If        \n    Next\n\n    If Cnt &gt; 0 Then Sheets(sArr).Select\n    Set WS = Nothing\nEnd Sub\n</code></pre>\n\n<p>Currently the code will only create a new sheet and will not select based off the new sheet name. I know that the for loop will need to copy and paste each individual sheet as opposed to selecting all of them, but I wanted to turn to the experts.</p>\n\n<p>Ultimately, the columns that are copied over will need the duplicates removed and I will need to save the sheet as a pretty PDF but I need to solve this problem first. Any help would be greatly appreciated! Thanks!</p>\n"}, {"tags": ["excel", "vba", "getopenfilename"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 0, "creation_date": 1571800723, "post_id": 58514923, "comment_id": 103356819, "body": "yeah it works thanks, but this line <code>OpenBook = Application.Workbooks.Open(myFile)</code> give me error 424 object required is there anything wrongs with the code?"}, {"owner": {"reputation": 4675, "user_id": 5086631, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IKrb6.png?s=128&g=1", "display_name": "Keith Stein", "link": "https://stackoverflow.com/users/5086631/keith-stein"}, "reply_to_user": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 1, "creation_date": 1571801355, "post_id": 58514923, "comment_id": 103356937, "body": "The code in your comment is missing <code>Set</code>. That would be required. It&#39;s there in your question, is it there in your actual code?"}, {"owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "edited": false, "score": 0, "creation_date": 1571810347, "post_id": 58514923, "comment_id": 103358967, "body": "one more question, Why I am getting Runtime Error &#39;1004&#39; on this line <code>OpenBook.Sheets(3).Range(&quot;A1:3063&quot;).Copy</code>"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571811593, "post_id": 58514923, "comment_id": 103359445, "body": "Hi. In the range u are putting A1:3063.. You missed a letter..."}], "tags": [], "owner": {"reputation": 4675, "user_id": 5086631, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IKrb6.png?s=128&g=1", "display_name": "Keith Stein", "link": "https://stackoverflow.com/users/5086631/keith-stein"}, "is_accepted": false, "score": 1, "last_activity_date": 1571800264, "creation_date": 1571800264, "answer_id": 58514923, "question_id": 58514750, "link": "https://stackoverflow.com/questions/58514750/run-time-error-91-object-variable-or-with-block-not-set/58514923#58514923", "title": "Run-time error 91 Object Variable or With Block not Set", "body": "<p>I think it should be <code>If myFile &lt;&gt; False Then</code>. <code>myFile</code> is the variable you're using to get the file name. <code>OpenBook</code> isn't set until afterwards, hence the null error.</p>\n"}], "owner": {"reputation": 43, "user_id": 11028966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pd_WkCxcFMw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMU0KdaPfPavCZMowi3cJrJ1vzNNg/mo/photo.jpg?sz=128", "display_name": "Hilmi ", "link": "https://stackoverflow.com/users/11028966/hilmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571811794, "creation_date": 1571798823, "last_edit_date": 1571811794, "question_id": 58514750, "link": "https://stackoverflow.com/questions/58514750/run-time-error-91-object-variable-or-with-block-not-set", "title": "Run-time error 91 Object Variable or With Block not Set", "body": "<p>I am getting this error </p>\n\n<blockquote>\n  <p>Run Time Error '91' : Object Variable or With Block not Set.</p>\n</blockquote>\n\n<p>What I am try to do is let user select files then select sheet3 (which name is Raw data) from selected files then copy to the current workbook</p>\n\n<p>My code is </p>\n\n<pre><code>Private Sub OpenWorkBook_Click()\n\nDim myFile As Variant\nDim OpenBook As Workbook\nApplication.ScreenUpdating = False\n\nmyFile = Application.GetOpenFilename(Title:=\"Browse your file\", FileFilter:=\"Excel Files(*.xls*),*xls*\")\n\nIf OpenBook &lt;&gt; False Then\n    Set OpenBook = Application.Workbooks.Open(myFile)\n    OpenBook = Application.Workbooks.Open(myFile)\n    OpenBook.Sheets(3).Range(\"A1:3063\").Copy\n    ThisWorkbook.Worksheets(\"Raw data(STEP 1)\").Range(\"A2\").PasteSpecial xlPasteValues\n    OpenBook.Close False\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Highlighted line <code>If OpenBook &lt;&gt; False Then</code></p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["excel", "vba", "combobox", "disable"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571787154, "post_id": 58513388, "comment_id": 103354329, "body": "Remove that option from the list when Stainless is selected."}, {"owner": {"reputation": 3, "user_id": 12253135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bhMxajRxwRE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-YyewMqQyiENgWJoef2x_6fIhvQ/photo.jpg?sz=128", "display_name": "Tahni", "link": "https://stackoverflow.com/users/12253135/tahni"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571787548, "post_id": 58513388, "comment_id": 103354403, "body": "@TimWilliams That is one way of disabling the option. How would I do that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571787775, "post_id": 58513388, "comment_id": 103354449, "body": "That would probably depend on how you populated the list in the first place.  Plenty of similar posts on this topic to be found here: <a href=\"https://www.google.com/search?q=vba+dependent+combobox\" rel=\"nofollow noreferrer\">google.com/search?q=vba+dependent+combobox</a>   &quot;dependent combobox&quot; is the term to Google for."}, {"owner": {"reputation": 3, "user_id": 12253135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bhMxajRxwRE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-YyewMqQyiENgWJoef2x_6fIhvQ/photo.jpg?sz=128", "display_name": "Tahni", "link": "https://stackoverflow.com/users/12253135/tahni"}, "edited": false, "score": 0, "creation_date": 1571801939, "post_id": 58513388, "comment_id": 103357039, "body": "<a href=\"https://www.excel-easy.com/vba/examples/dependent-combo-boxes.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/dependent-combo-boxes.html</a> Dependent combobox is the key I needed! Not exactly disabling an option, more repopulating the list, but it accomplished the right thing. Thank you!"}], "owner": {"reputation": 3, "user_id": 12253135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bhMxajRxwRE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-YyewMqQyiENgWJoef2x_6fIhvQ/photo.jpg?sz=128", "display_name": "Tahni", "link": "https://stackoverflow.com/users/12253135/tahni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571786605, "creation_date": 1571785633, "last_edit_date": 1571786605, "question_id": 58513388, "link": "https://stackoverflow.com/questions/58513388/disable-one-option-in-excel-vba-combobox-listbox", "title": "Disable one option in excel VBA combobox/listbox?", "body": "<p><strong>Stainless Steel Plumbing Selected</strong><br>\n<a href=\"https://i.stack.imgur.com/DHzKD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DHzKD.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Jacket Material Options</strong><br>\n<a href=\"https://i.stack.imgur.com/5v95P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5v95P.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have several comboboxes where the available options depend on the selection in another combobox, but only in certain situations. For example, if stainless steel plumbing is selected then the jacket <em>can't</em> be carbon steel. </p>\n\n<p>Is there a way to disable carbon steel as an option when stainless plumbing is selected? </p>\n"}, {"tags": ["excel", "vba", "date", "vlookup"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1571796954, "post_id": 58513353, "comment_id": 103356134, "body": "I think i figured out what you wanted. Let me know if it doesn&#39;t work. If it does, don&#39;t forget to click <code>Accept</code> thanks."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "edited": false, "score": 0, "creation_date": 1571810370, "post_id": 58514537, "comment_id": 103358976, "body": "The function works great when set in the table I am using as a cross reference.  I cannot figure out how to call it from the the code that is triggered from the source file.  ie.  Book1 is opened and code ran to customize the file and use a cross reference workbook (book2) to capture the week and month as in this example.  I can open book2 by assigning a variable to the file (in the same folder) but don&#39;t know how to get the function to point to book2 to get the data."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "edited": false, "score": 0, "creation_date": 1571870012, "post_id": 58514537, "comment_id": 103387315, "body": "@BobMacey Glad it worked. It&#39;d be great if you could click accept since it did answer your question of looking up within a range. In answer to your second question, there&#39;s a lot of options. If you lookup how to set a value in a cell with a formula, I&#39;m sure that will help. Or if you want to set the calculation in the cell, that&#39;s an option too."}, {"owner": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "edited": false, "score": 1, "creation_date": 1571879716, "post_id": 58514537, "comment_id": 103389099, "body": "Tester.  Thanks for the help and the advice to move forward.  Much appreciated."}, {"owner": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "edited": false, "score": 0, "creation_date": 1572068324, "post_id": 58514537, "comment_id": 103454392, "body": "Tester, while I was able to extract data from the cross reference book, when I try the same with the function code you provided, I keep getting a type mismatch.  Assuming this is from the date format but I have checked and rechecked (and reformatted in the code) to verify both the source value and the columns in the cross reference table are set to the same date format.  Any suggestions would be appreciated."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 0, "last_activity_date": 1571796906, "creation_date": 1571796906, "answer_id": 58514537, "question_id": 58513353, "link": "https://stackoverflow.com/questions/58513353/excel-vba-vlookup-to-find-row-of-date-in-date-range-table/58514537#58514537", "title": "Excel VBA: vlookup to find row of date in date range table", "body": "<p>This custom function is similar to Vlookup where it will compare the first two columns of a range as a date, and if the input date falls in the range, it will return the respective column.</p>\n\n<pre><code>Function rngLOOKUP(aDate As Date, rng As Range, theColumn As Long) As Variant\nDim acell As Range\n\nFor Each acell In rng.Columns(1).Cells\n    If acell.Value &lt;= aDate And acell.Offset(0, 1).Value &gt;= aDate Then\n        rngLOOKUP = acell.Offset(0, theColumn - 1).Value\n        Exit Function\n    End If\nNext acell\n\nrngLOOKUP = \"#Nothing\"\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://1drv.ms/x/s!AiO7_3PtXmZ9gogeczhg_M0Tnb9Y4A?e=99epOF\" rel=\"nofollow noreferrer\">In this excel file</a>, you can see it in action. Or see below screenshot. The highlight cell has the custom formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/n2L3Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n2L3Z.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "edited": false, "score": 0, "creation_date": 1571879617, "post_id": 58531635, "comment_id": 103389084, "body": "Thanks.  The index method in particular will definitely be useful.  New to this group and thinking I may have broken the intent down too far.  The entire process is being designed to be automated so excel based formulas may not be the best but the approach you used will be useful."}], "tags": [], "owner": {"reputation": 11, "user_id": 12265697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIZpY.png?s=128&g=1", "display_name": "Mavidian", "link": "https://stackoverflow.com/users/12265697/mavidian"}, "is_accepted": false, "score": 1, "last_activity_date": 1571868957, "creation_date": 1571868957, "answer_id": 58531635, "question_id": 58513353, "link": "https://stackoverflow.com/questions/58513353/excel-vba-vlookup-to-find-row-of-date-in-date-range-table/58531635#58531635", "title": "Excel VBA: vlookup to find row of date in date range table", "body": "<p>The functionality described here can be accomplished via cell formulas without resorting a VBA function. I included 2 possible solutions.</p>\n\n<p>I have simplified the scenario a bit. Assume that the cross reference table (located in Sheet1 of a XR.xlsx file) only contains these 3 columns:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>          A               B               C\n   +--------------+---------------+---------------+\n 1 | PDWK_St_Date | PDWK_End_Date | Short_Descrip |\n   +--------------+---------------+---------------+\n 2 | 07-Nov-16    | 13-Nov-16     | P1W1          |\n 3 | 14-Nov-16    | 20-Nov-16     | P1W2          |\n 4 | 21-Nov-16    | 27-Nov-16     | P1W3          |\n 5 | 28-Nov-16    | 04-Dec-16     | P1W4          |\n 6 | 05-Dec-16    | 11-Dec-16     | P2W1          |\n 7 | 12-Dec-16    | 18-Dec-16     | P2W2          |\n 8 | 19-Dec-16    | 25-Dec-16     | P2W3          |\n 9 | 26-Dec-16    | 01-Jan-17     | P2W4          |\n10 | 02-Jan-17    | 08-Jan-17     | P3W1          |\n11 | 09-Jan-17    | 15-Jan-17     | P3W2          |\n12 | 16-Jan-17    | 22-Jan-17     | P3W3          |\n13 | 23-Jan-17    | 29-Jan-17     | P3W4          |\n14 | 30-Jan-17    | 05-Feb-17     | P4W1          |\n15 | 06-Feb-17    | 12-Feb-17     | P4W2          |\n16 | 13-Feb-17    | 19-Feb-17     | P4W3          |\n17 | 20-Feb-17    | 26-Feb-17     | P4W4          |\n18 | 27-Feb-17    | 05-Mar-17     | P5W1          |\n   +--------------+---------------+---------------+\n</code></pre>\n\n<p><strong>Solution 1</strong> (simplified)</p>\n\n<p>It only works if the date ranges are consecutive (i.e. start date = end date from previous row + 1 day) - his is the case in your cross reference table.</p>\n\n<p>In your destination workbook, use VLOOKUP to refer to the cross reference table:</p>\n\n<pre><code>=VLOOKUP(B2,[XR.xlsx]Sheet1!$A$2:$C$18,3,TRUE)\n</code></pre>\n\n<p>The above formula is specific to row 2 in the destination table and assumes the \"Business Date\" is in column B (hence <code>B2</code> in the 1st parameter), 2nd parameter is the lookup range, 3 in the 3rd parameter means the value to retrieve is in the 3rd column and TRUE allows date matching within a range (from start date to the next row's start date).</p>\n\n<p>Note that the formula can be easily replicated to other rows, e.g. by dragging the fill handle (the small square in the cell's bottom-right corner).</p>\n\n<p><strong>Solution 2</strong></p>\n\n<p>In this approach, the business date is compared against both start and end dates from the cross-reference table. Instead of <code>VLOOKUP</code>, it uses <code>INDEX</code> and <code>MATCH</code> functions:</p>\n\n<pre><code>=INDEX([XR.xlsx]Sheet1!$C$2:$C$18,MATCH(1,(B2&gt;=[XR.xlsx]Sheet1!$A$2:$A$18)*(B2&lt;=[XR.xlsx]Sheet1!$B$2:$B$18),0),1)\n</code></pre>\n\n<p>Here, the business date (cell <code>B2</code>) is compared against both start and end date, the results are multiplied (equivalent to logical AND) and matched against 1 (i.e. TRUE).</p>\n\n<p>IMPORTANT: After pasting this formula (e.g. into formula bar for cell <code>C2</code>) you need to hit <code>Ctrl+Shift+Enter</code> instead of the usual <code>Enter</code>. This is to indicate a so-called \"array formula\" (aka CSE formula); otherwise, our comparisons inside MATCH wouldn't work as intended. You may refer to <a href=\"https://superuser.com/questions/674566/when-to-use-ctrlshiftenter-and-when-to-use-enter-in-excel\">this post</a> for more info. The CSE formulas show surrounded by braces in the formula bar. The good news is that they can be replicated just like all other formulas.</p>\n\n<p>The destination table will look similar to:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>      A           B              C       \n   +------+---------------+-------------+\n 1 | Unit | Business Date | Short Descr |\n   +------+---------------+-------------+\n 2 | 1102 | 26-Aug-17     | #N/A        |\n 3 | 1102 | 05-Jan-17     | P3W1        |\n 4 | 1102 | 06-Feb-17     | P4W2        |\n 5 | 1102 | 11-Nov-16     | P1W1        |\n 6 | 1102 | 02-Feb-17     | P4W1        |\n 7 | 1102 | 01-Oct-16     | #N/A        |\n   +------+---------------+-------------+\n</code></pre>\n\n<p>Note that in case of solution 1, cell <code>C2</code> would contain P5W1 instead of #N/A - this is because no end date was used in comparison.</p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "is_accepted": false, "score": 1, "last_activity_date": 1572194435, "creation_date": 1572194435, "answer_id": 58581358, "question_id": 58513353, "link": "https://stackoverflow.com/questions/58513353/excel-vba-vlookup-to-find-row-of-date-in-date-range-table/58581358#58581358", "title": "Excel VBA: vlookup to find row of date in date range table", "body": "<p>The Function Provided by @PGTester worked great once a couple of issues were dealt with in the code:</p>\n\n<p>1) Declarations:  The declarations were all on one line for each type.  This does not work in VBA as only the last variable is declared as intended and all previous ones are declared as variant. (ie, DIM adate, bdate, cdate as date)  In this example only cdate is an actual date.  Passing adate to the function resulted in a mismatch until the declarations were corrected. (This was pointed out by @Domenic)</p>\n\n<p>2) Date formats:  While all dates in the source file and the cross reference file were formatted as \"yyyy-mmm-dd\" prior to calling the function, Error 13, Type Mismatch still prevented the code from moving forward. Changing the format to \"m-d-yyyy\" on both the source file (done in code) and the cross reference table (manually prior to accessing) solved the issue and the following code worked as expected.  </p>\n\n<p>3) Pointing the function calls at the cross reference file for both the vlookup and rnglookup was done by building and setting variables to the pages needed.  This simplified the selections when required.</p>\n\n<pre><code>Set variables for next steps\n'\n    Set CRef = Workbooks.Open(refFILE)\n    Set shtJOB = CRef.Sheets(\"JobCross\")\n    Set shtDATE = CRef.Sheets(\"fcalendar\")\n    sht.Activate\n    Set rngJOBS = Range(\"i2:i\" &amp; lastRow)\n    Set rngJBGRP = shtJOB.Range(\"A1:b16\")\n    Set rng = shtDATE.Range(\"A2:f210\")\n</code></pre>\n\n<p>Completed code with both functions follows:</p>\n\n<pre><code>Sub CleanDaily_Labour()\n'\n' CleanDaily_Labour Macro\n' RMDC Payroll Resarch (MU) Report prep\n'\n\n' Note the separate declarations for each variable\n'    \n    Dim myPath As String, fName As String, refFILE As String, job As String, _\n      JobGR As String, DateST As String, WKDay As String, PDWK As String\n    Dim CRef As Workbook, wkb As Workbook\n    Dim shtDATE As Worksheet, shtJOB As Worksheet, sht As Worksheet\n    Dim aDate As Date, fYR As Date\n    Dim fYear As Variant\n    Dim rng As Range, rngJOBS As Range, rngJBGRP As Range\n    Dim SC As Long, lastRow As Long, PD As Long, WK As Long\n\n    ' Application.ScreenUpdating = False\n    myPath = Application.ActiveWorkbook.Path\n'\n' Get the file date and assign to variables\n'\n    Range(\"D3\").Select\n    **Selection.NumberFormat = \"m-d-yyyy\"**\n    aDate = Range(\"D3\").Value\n    DateST = WorksheetFunction.Text(aDate, \"YYYYMMDD\")\n    WKDay = WorksheetFunction.Text(aDate, \"DDD\")\n\n    Selection.Copy\n    Range(\"D7\").Select\n    ActiveSheet.Paste\n'\n' Rename and save the active workbook by date\n' set wkb to new workbook name and assign calendar cross ref\n'\n    fName = myPath &amp; \"\\Daily_Labour_\" _\n        &amp; DateST &amp; \".xlsx\"\n    ActiveWorkbook.SaveAs fName, 51\n    Set wkb = Workbooks.Open(fName)\n    Set sht = wkb.Sheets(\"Sheet1\")\n\n\n    refFILE = myPath &amp; \"\\Cross_Ref_fCalendar.xlsx\"\n\n'\n' Remove extra header info\n'\n    Rows(\"1:5\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\n'\n'   Insert Column to the left of Column D\n'\n    Columns(\"E:G\").Insert Shift:=xlToRight, _\n      CopyOrigin:=xlFormatFromRightOrBelow\n'\n' Update Headers that will be kept / used\n'\n    Range(\"A1\").Value = \"FYear\"\n    Range(\"E1\").Value = \"PD_WK\"\n    Range(\"J1\").Value = \"JOB_GRP\"\n    Range(\"F1\").Value = \"WKDay\"\n    Range(\"G1\").Value = \"PD\"\n    Range(\"H1\").Value = \"WK\"\n'\n    Rows(\"1:1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n    End With\n'\n' Remove extra columns\n'\n    Sheets(\"Sheet1\").Range(\"K:K,M:P,R:AY\").EntireColumn.Delete\n'\n' Get the last row and fill known columns\n'\n    lastRow = Cells(Rows.Count, 1).End(xlUp).row\n    Range(\"d2:d\" &amp; lastRow).Value = aDate\n    Range(\"d2:d\" &amp; lastRow).NumberFormat = \"m-d-yyyy\"\n    Range(\"f2:f\" &amp; lastRow).Value = WKDay\n'\n' Set variables for next steps\n'\n    Set CRef = Workbooks.Open(refFILE)\n    Set shtJOB = CRef.Sheets(\"JobCross\")\n    Set shtDATE = CRef.Sheets(\"fcalendar\")\n    sht.Activate\n    Set rngJOBS = Range(\"i2:i\" &amp; lastRow)\n    Set rngJBGRP = shtJOB.Range(\"A1:b16\")\n    Set rng = shtDATE.Range(\"A2:f210\")\n'\n' Loop through jobs in column i match job in shtJOB\n' put matching group in row j (Use Function vLookupVBA)\n'\n    For Each jRow In rngJOBS\n        jRow.Select\n        job = ActiveCell.Value\n        JobGR = VLookupVBA(job, rngJBGRP, Null)\n        ActiveCell.Offset(0, 1).Value = JobGR\n    'end for\n   Next jRow\n'\n'Save Progress during testing:\n'\n   Application.DisplayAlerts = False\n   ActiveWorkbook.SaveAs fName, 51\n'\n' Fill in date parameters from Cross Ref file for Business date\n' Use function rngLOOKUP to update variables then set ranges to the variables\n' May be more efficient to get row number from cross ref table instead - later.\n'\n    shtDATE.Activate '(does not seem to affect)\n'\n    fYear = rngLOOKUP(aDate, rng, 3)\n    PDWK = rngLOOKUP(aDate, rng, 6)\n    PD = rngLOOKUP(aDate, rng, 4)\n    WK = rngLOOKUP(aDate, rng, 5)\n'\n' Fill the columns with the variables (can likely bypass the variables and put on 1 line)- later\n'\n    sht.Activate\n    Range(\"A2:A\" &amp; lastRow).Value = fYear\n    Range(\"E2:E\" &amp; lastRow).Value = PDWK\n    Range(\"G2:G\" &amp; lastRow).Value = PD\n    Range(\"H2:H\" &amp; lastRow).Value = WK\n'\n' Close reference file\n'\n    Application.DisplayAlerts = False\n    CRef.Close False\n'\n' Cleanup, save and close workbooks\n'\n    Application.DisplayAlerts = False\n    wkb.SaveAs fName, 51\n'\n' SQL call: Load to existing datbase (GDrive), use same format as Transactions\n' ?? Get sales by day? vs maintain PDWK - Future\n'\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n'    wkb.Close.false\n\n\n\nEnd Sub\nPrivate Function VLookupVBA(what As Variant, lookupRng As Range, defaultValue As Variant) As Variant\n    Dim rv As Variant: rv = Application.VLookup(what, lookupRng, lookupRng.Columns.Count, False)\n    If IsError(rv) Then\n        VLookupVBA = \"NULL\"\n    Else\n        VLookupVBA = rv\n    End If\nEnd Function\n\nPublic Sub UsageExample()\n    MsgBox VLookupVBA(\"ValueToFind\", ThisWorkbook.Sheets(\"ReferenceSheet\").Range(\"A:D\"), \"Not found!\")\nEnd Sub\nFunction rngLOOKUP(chkDate As Date, rngf As Range, theColumn As Long) As Variant\nDim acell As Range\n\n'\nFor Each acell In rngf.Columns(1).Cells\n    If acell.Value &lt;= chkDate And acell.Offset(0, 1).Value &gt;= chkDate Then\n        rngLOOKUP = acell.Offset(0, theColumn - 1).Value\n        Exit Function\n    End If\nNext acell\n\nrngLOOKUP = \"#Nothing\"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12259901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDmRTqQuwtNm6UcN2YBg-rlMDpZTOlYdAuJ4Jse=k-s128", "display_name": "Bob Macey", "link": "https://stackoverflow.com/users/12259901/bob-macey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2130, "favorite_count": 0, "accepted_answer_id": 58514537, "answer_count": 3, "score": 1, "last_activity_date": 1572194435, "creation_date": 1571785325, "last_edit_date": 1571786717, "question_id": 58513353, "link": "https://stackoverflow.com/questions/58513353/excel-vba-vlookup-to-find-row-of-date-in-date-range-table", "title": "Excel VBA: vlookup to find row of date in date range table", "body": "<p>Hi and thanks in advance for any help.  Extracting daily files that have the date in a cell.  I need to use the date to find which week it falls into in a table which has start and end dates in two columns.  There is more data in subsequent columns I need to extract once I know the row the date falls into. The cross reference table is in this format: The date variable (assigned to both string and date variables) that is picked up from the source needs to be compared to col's A and B to find out what row it would fit in then extract fiscal year (Col A) as well as short description (col F)</p>\n\n<p><strong>Cross Ref Table</strong><br>\n<a href=\"https://i.stack.imgur.com/2m4je.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2m4je.png\" alt=\"enter image description here\"></a></p>\n\n<p>The adjusted and renamed destination file looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/f8mPU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f8mPU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571787846, "post_id": 58513199, "comment_id": 103354461, "body": "VBA typically operates on US locale"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571788189, "post_id": 58513199, "comment_id": 103354543, "body": "It&#39;s not very tidy but you can use a cell to translate: <code>Range(&quot;A1&quot;).NumberFormatLocal = Local_Format_Name: English_Format_Name = Range(&quot;A1&quot;).NumberFormat</code>"}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571821117, "post_id": 58513199, "comment_id": 103364055, "body": "I see what you mean. I&#39;ll try that. I hope it doesn&#39;t affect performance. Also looking for an option without accessing cell properties..."}], "owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1582175880, "creation_date": 1571784135, "last_edit_date": 1582175880, "question_id": 58513199, "link": "https://stackoverflow.com/questions/58513199/format-decimal-places-to-local-numeric-format", "title": "Format decimal places to local numeric format", "body": "<p>How do I convert to my local numeric format?</p>\n\n<pre><code>Sub test()\n    MsgBox Application.DecimalSeparator\n    MsgBox Format(\"25234,32\", \"#,0#\")\n    MsgBox Format(\"25234,32\", \"#.0#\")\nEnd Sub\n</code></pre>\n\n<pre>\nMsgbox prints:  \nFirst : \",\"  \nSecond: 252.3432  \nThird : 25234,32\n</pre>\n\n<p>Correct should be 25234,32 for my local settings.</p>\n\n<p>Is it normal that <code>Format</code> does not display the same as <code>.NumberFormatLocal</code>?</p>\n\n<p>In my program I have text variable with numberformat that's used on <code>.NumberFormatLocal</code> so I can't use it on <code>Format</code> unless I switch \"<strong>.</strong>\" and \"<strong>,</strong>\".</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1571798481, "post_id": 58513024, "comment_id": 103356457, "body": "Why would there be a need for acCmdSaveRecord? Has code changed values in fields for current record on form? Perhaps you should do a test. I use transaction with ADODB connection object. All code examples I see involve SQL actions."}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1571808693, "post_id": 58513024, "comment_id": 103358463, "body": "Why do you use <code>acCmdSaveRecord</code> if there is <code>Me.Dirty = false</code> ? Forms don&#39;t use transactions. But you can add code to start transaction, open <code>Recordset</code>, assign it to <code>Form.Recordset</code> and manage <code>Commit</code> and <code>RollBack</code> as you need."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 1, "creation_date": 1571818531, "post_id": 58513024, "comment_id": 103362752, "body": "@4dmonster: Forms <i>do</i> use a transaction - when you delete records manually."}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 0, "last_activity_date": 1571858040, "creation_date": 1571858040, "answer_id": 58529606, "question_id": 58513024, "link": "https://stackoverflow.com/questions/58513024/are-we-able-to-use-ms-access-transactions-with-accmdsaverecord/58529606#58529606", "title": "Are we able to use MS Access transactions with acCmdSaveRecord?", "body": "<p>No, not as a general rule. So the use of transactions is for VBA code, and sql  or recordset code you have. Unfortunately, the transactions don't apply to forms.</p>\n\n<p>However, you can as a work around:\nstart a transaction.\nCreate a recordset.\nShove (assign) the forms record source to the above created record set.</p>\n\n<p>Now, the user can freely edit, change, add, delete to that form, but if you don't commit the record set after all is above and done, then the editing etc. will be ignored. It can be  bit of a pain to set this up, and for sub forms, I never really cooked up a seamless coding approach that worked well. </p>\n\n<p>So if you willing to create a recordset in code and then assign that reocrdset to the forms datasouce, the result is now a form that is bound to the transaction you started in code.</p>\n"}], "owner": {"reputation": 43, "user_id": 12161958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13ea4db9ad1bd947809bcbaaaf7aa383?s=128&d=identicon&r=PG&f=1", "display_name": "openspaceranger", "link": "https://stackoverflow.com/users/12161958/openspaceranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58529606, "answer_count": 1, "score": 1, "last_activity_date": 1594421164, "creation_date": 1571782919, "last_edit_date": 1594421164, "question_id": 58513024, "link": "https://stackoverflow.com/questions/58513024/are-we-able-to-use-ms-access-transactions-with-accmdsaverecord", "title": "Are we able to use MS Access transactions with acCmdSaveRecord?", "body": "<p>I know we can use transactions for SQL within Access through the DAO namespace, but are we able to do the same with acCmdSaveRecord, since it's not explicitly linked to the DAO? or Does acCmdSaveRecord have an implicit transaction? If you cannot put acCmdSaveRecord within a transaction, what's the alternative? Explicit SQL?</p>\n\n<p>Forgot to add that I'm a VBA novice, so I am not currently aware which are best practices. Also since I can't comment, I'm taking over existing Access VBA apps, so I don't know the rationale behind using acCmdSaveRecord. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1571782655, "post_id": 58512970, "comment_id": 103353255, "body": "There&#39;s no need to <code>set tbl</code> just <code>tbl=</code> will do"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1571782716, "post_id": 58512970, "comment_id": 103353270, "body": "if the combobox selection is the same as the sheetname then just get the selected value and combine with Table &amp; &lt;that selected value&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571784972, "post_id": 58513001, "comment_id": 103353861, "body": "Tried this, but am getting a selection error <code>For i = 1 To 1500     If i = sht Then         Worksheets(sht).Range(&quot;Table&quot; &amp; i).Select     End If Next i</code> With sht being the sheet name (which is a number matching the building address)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571786594, "post_id": 58513001, "comment_id": 103354207, "body": "@Liworker - write <code>Worksheets(i).Select</code> on the line above the previous select. Thus, the worksheet would be selected and then the table."}, {"owner": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571845214, "post_id": 58513001, "comment_id": 103377469, "body": "Got it working just by removing the <code>Worksheets(sht).Range(&quot;Table&quot; &amp; i).Select</code> line. Thanks for your help"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571853622, "post_id": 58513001, "comment_id": 103381278, "body": "@Liworker - good that you managed yourself. In general, just keep in mind that <code>Select</code> and <code>Activate</code> are considered a bit bad practice in VBA - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here is how to avoid them</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1571782793, "creation_date": 1571782793, "answer_id": 58513001, "question_id": 58512970, "link": "https://stackoverflow.com/questions/58512970/is-there-a-way-to-select-a-table-based-on-a-userform-input/58513001#58513001", "title": "Is there a way to select a table based on a userform input?", "body": "<p>This will select 2 tables - <code>table1</code> and <code>table2</code>, the one after the other:</p>\n\n<pre><code>Sub TableSelector()\n\n    Dim tableName As String\n    Dim i As Long\n\n    For i = 1 To 2\n        Worksheets(1).Range(\"table\" &amp; i).Select\n        Stop\n    Next i        \n\nEnd Sub\n</code></pre>\n\n<p>Just make sure to pass the <code>i</code> from a UserForm:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FJfyv.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FJfyv.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571785935, "post_id": 58513128, "comment_id": 103354061, "body": "Yeah, sorry I have a lot of code and forgot a few things when I cut it down to post. Essentially, The user selects the region, location, then building address. The numerical part of the address is what is tied to the sheets (sht). My hope is to have it open the sheet for that building, then enter the data into the table on that sheet. Currently the <code>tbl = &quot;Table&quot; &amp; sht</code> gives an error saying an object is needed. I changed it a little bit based on the answer above to include a for loop that when i = sht then it selects it (See my response to above answer), but that also gives an error"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571841448, "post_id": 58513128, "comment_id": 103375456, "body": "@Liworker You may want to post a sample set of data so we can see how the address is and the sheet is named.  This would help in providing a more robust answer."}, {"owner": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "edited": false, "score": 0, "creation_date": 1571845172, "post_id": 58513128, "comment_id": 103377442, "body": "Ended up having to change it around a little bit due to a change in how they wanted it to work (not all buildings are referenced by the numerical part of the address) but got it working by removing the line to select the table. Thanks for your help"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1571785008, "last_edit_date": 1571785008, "creation_date": 1571783575, "answer_id": 58513128, "question_id": 58512970, "link": "https://stackoverflow.com/questions/58512970/is-there-a-way-to-select-a-table-based-on-a-userform-input/58513128#58513128", "title": "Is there a way to select a table based on a userform input?", "body": "<p>Maybe I am misreading this but it sounds like you want to get the sheet name from the combobox to select the right table.   </p>\n\n<pre><code>'updated as it looks like your logic is in the actual form\n\n'Lets say your combobox name is ComboBox1 (since oyu did not supply that)\n\nDim oNewRow As ListRow, rng As Range, tbl As String\nDim sht As String\nsht = Me.ComboBox1.Text\ntbl = \"Table\" &amp; sht\n\nSet rng = Worksheets(sht).Range(tbl)\nrng.Select\nSet oNewRow = Selection.ListObject.ListRows.Add(AlwaysInsert:=True)\nWith ws\n    oNewRow.Range.Cells(1, 1).Value = Me.box1.Value\n    oNewRow.Range.Cells(1, 2).Value = Me.box2.Value\n    oNewRow.Range.Cells(1, 3).Value = Me.box3.Value\n    oNewRow.Range.Cells(1, 4).Value = Me.box4.Value\n    oNewRow.Range.Cells(1, 5).Value = Me.box5.Value\n    oNewRow.Range.Cells(1, 6).Value = Me.box6.Value\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571809754, "creation_date": 1571782574, "last_edit_date": 1571809754, "question_id": 58512970, "link": "https://stackoverflow.com/questions/58512970/is-there-a-way-to-select-a-table-based-on-a-userform-input", "title": "Is there a way to select a table based on a userform input?", "body": "<p>I created a universal userform on which the user would select a building location from a combobox. This is tied to a sheet with the same name as the location. I am looking to have it so that when they hit the enter button, the data on the form will be entered in a table on the corresponding page. Because Tables have to have a unique name that is not repeated across any sheets, I am struggling with how to set the table range using a string. I named all tables with the following format: TableSheetname. Is there a way to set a string equal to \"Table\" &amp; Sheetname?</p>\n\n<pre><code>Dim oNewRow As ListRow, rng As Range, tbl As String\n\nSet tbl = \"Table\" &amp; sht\n\nSet rng = Worksheets(sht).Range(tbl)\nrng.Select\nSet oNewRow = Selection.ListObject.ListRows.Add(AlwaysInsert:=True)\nWith ws\n        oNewRow.Range.Cells(1, 1).Value = Me.box1.Value\n        oNewRow.Range.Cells(1, 2).Value = Me.box2.Value\n        oNewRow.Range.Cells(1, 3).Value = Me.box3.Value\n        oNewRow.Range.Cells(1, 4).Value = Me.box4.Value\n        oNewRow.Range.Cells(1, 5).Value = Me.box5.Value\n        oNewRow.Range.Cells(1, 6).Value = Me.box6.Value\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571791565, "post_id": 58513298, "comment_id": 103355109, "body": "Tim, that works flawlessly!  I think you saw from my modules that I have been trying several diferent approachs on this task, and I&#39;m hitting walls every time. Thank you!  Do you think you can tip me off on how to insert the actual lines in the mail body?"}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571793772, "post_id": 58513298, "comment_id": 103355525, "body": "Ops. Only now I understood these lines: corpodoemail &amp; &quot;&lt;br&gt;&quot; &amp; _                               .Cells(1).value &amp; &quot;, &quot; &amp; _                               .Cells(12).value  Thanks!"}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571796265, "post_id": 58513298, "comment_id": 103356005, "body": "Nearly there.  Everytime I loop on &quot;corpodoemail&quot;, the .cells(n).value resets to the next data. How do I storage this itens and list it all in the e-mail body?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571797283, "post_id": 58513298, "comment_id": 103356199, "body": "Maybe I misunderstood what you&#39;re trying to do, but I&#39;m not following the issue - I thought there was some common info which goes at the top of the mail, and then a listing of information taken from the rows associated with each recipient."}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571797315, "post_id": 58513298, "comment_id": 103356207, "body": "Yep, definitely stuck on the e-mail building. I&#39;m doing the above, but it only gathers the last itens from the rw.  corpodoemail = &quot;&lt;head&gt;&lt;style&gt;table, th, td {border: 1px solid black; border-collapse:&quot; &amp; _         &quot;collapse;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&quot; &amp; _         &quot;&lt;table style=&quot;&quot;width:50%&quot;&quot;&gt;&lt;tr&gt;&quot; &amp; _         &quot;&lt;th bgcolor=&quot;&quot;#D8D8D8&quot;&quot;&gt;MCI&lt;/th&gt;&lt;th bgcolor=&quot;&quot;#D8D8D8&quot;&quot;&gt;PRODUTO&lt;/th&gt;&quot; &amp; _          &quot;&lt;th bgcolor=&quot;&quot;#D8D8D8&quot;&quot;&gt;DATA&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&quot; &amp; _         &quot;&lt;th&gt;&quot; &amp; .Cells(1).value &amp; &quot;&lt;/th&gt;&quot; &amp; &quot;&lt;th&gt;&quot; &amp; .Cells(2).value &amp; &quot;&lt;/th&gt;&quot; &amp; &quot;&lt;th&gt;&quot; &amp; .Cells(4).value &amp; &quot;/&quot; &amp; .Cells(5).value &amp; &quot;&lt;/th&gt;&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571797402, "post_id": 58513298, "comment_id": 103356223, "body": "I can take a look later if you can update your shared file with your current code and an example of the expected output for a recipient who has &gt;1 row"}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571797585, "post_id": 58513298, "comment_id": 103356264, "body": "Tim, what you did is perfectly. My problem that I have to build an ordenated list to send in the e-mail. I&#39;m using the HTML layout I just posted, but my problem is: I will face some managers with several clients, and some with only a few. How to automatically build an formated list to send the information with such variable data set?  From what I could gather, .Cells(1) is storaging the first Client ID, and .Cells(12) is storaging the second. On a virtually non exaustive list, I&#39;m not sure how to do it."}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571797917, "post_id": 58513298, "comment_id": 103356338, "body": "I&#39;ve updated the code on the question to reflect the changes I made on the code you provided  Thank you so much for the support!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571801119, "post_id": 58513298, "comment_id": 103356891, "body": "Each <code>rw</code> should only add one row to your table, but you&#39;re building the whole thing each time through the <code>rw</code> loop.  Build the top of the table, enter the loop and add one row per iteration, then close the table when you get out of the loop"}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571803971, "post_id": 58513298, "comment_id": 103357410, "body": "Yep. That is is.  The problem with coding once in a million years, is that when you need to do it, every step is a cringe.  Thanks Tim!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1571801815, "last_edit_date": 1571801815, "creation_date": 1571784961, "answer_id": 58513298, "question_id": 58512789, "link": "https://stackoverflow.com/questions/58512789/how-to-sort-through-a-report-and-send-one-e-mail-to-each-recipient-with-all-ke/58513298#58513298", "title": "How to sort through a report, and send one e-mail to each recipient, with all key values?", "body": "<p>Here's how I'd do it. Some parts of your code removed so the overall approach is more obvious: it should be clear what you need to add back.</p>\n\n<pre><code>Private Sub CommandButton2_Click() 'envia o email com registro de log\n\n    Dim dictMails As Object, k, rw\n    Dim OutlookApp As Object\n    Dim cell As Range\n    Dim html As String\n\n    Set OutlookApp = CreateObject(\"Outlook.Application\")\n\n    'start by grouping all rows related by the recipient...\n    Set dictMails = CreateObject(\"scripting.dictionary\")\n    For Each cell In Sheets(\"publico\").Range(\"H2:H2000\").Cells\n        'recipient, or default recipient?\n        destinatario = cell.value\n        If Len(destinatario) = 0 Then destinatario = cell.Offset(1, 0).value\n\n        If Len(destinatario) &gt; 0 Then\n            If Not dictMails.exists(destinatario) Then\n                Set dictMails(destinatario) = New Collection 'to hold the linked rows\n            End If\n            dictMails(destinatario).Add cell.Row 'record this row\n        End If\n    Next cell\n\n    'loop over the distinct recipients and their related rows\n    For Each k In dictMails.keys\n\n        Debug.Print \"Recipient: \" &amp; k \n\n        'build up the email body\n        html = \"&lt;head&gt;&lt;style&gt;table, th, td \" &amp; _\n              \"{border: 1px solid black; border-collapse:\" &amp; _\n              \"collapse;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\"\n\n        html = html &amp; \"Here is your information:&lt;br&gt;&lt;br&gt;\"\n\n        'open the table\n        html = html &amp; \"&lt;table style=\"\"width:50%\"\"&gt;&lt;tr&gt;\" &amp; _\n           \"&lt;th bgcolor=\"\"#D8D8D8\"\"&gt;MCI&lt;/th&gt;&lt;th bgcolor=\"\"#D8D8D8\"\"&gt;\" &amp; _\n           \"PRODUTO&lt;/th&gt;&lt;th bgcolor=\"\"#D8D8D8\"\"&gt;DATA&lt;/th&gt;&lt;/tr&gt;\"\n\n\n        'add one row for each linked row\n        For Each rw In dictMails(k)\n            Debug.Print \"    Row: \" &amp; rw\n            With Sheets(\"publico\").Rows(rw)\n\n               html = html &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; .Cells(1).value &amp; \"&lt;/td&gt;\" &amp; _\n                 \"&lt;td&gt;\" &amp; .Cells(2).value &amp; \"&lt;/td&gt;\" &amp; _\n                \"&lt;td&gt;\" &amp; .Cells(4).value &amp; \"/\" &amp; .Cells(5).value &amp; \"&lt;/td&gt;\" &amp; _\n                \"&lt;td&gt;\" &amp; .Cells(12).value &amp; \"&lt;/td&gt;\" &amp; _\n                \"&lt;td&gt;\" &amp; .Cells(12).value &amp; \"&lt;/td&gt;\" &amp; _\n                \"&lt;td&gt;\" &amp; .Cells(14).value &amp; \"/\" &amp; .Cells(55).value &amp; \"&lt;/td&gt;&lt;/tr&gt;\"\n\n            End With\n        Next rw\n\n        html = html &amp; \"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;\"  '&lt;&lt; close the mail\n\n        'send the mail for this recipient....\n\n    Next k 'next recipient\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58513298, "answer_count": 1, "score": 0, "last_activity_date": 1582219921, "creation_date": 1571781217, "last_edit_date": 1582219921, "question_id": 58512789, "link": "https://stackoverflow.com/questions/58512789/how-to-sort-through-a-report-and-send-one-e-mail-to-each-recipient-with-all-ke", "title": "How to sort through a report, and send one e-mail to each recipient, with all key values?", "body": "<p>I have a list of managers and their clients on sheet \"publico\".</p>\n\n<p>I need to send a report to each manager, with their clients on the e-mail body.</p>\n\n<p>For example: Manager \"ag1126ct18@teste.com\" would receive the lines 2 and 3 from the \"publico\" sheet.</p>\n\n<p>The list is attached here:\n<a href=\"https://drive.google.com/file/d/1jLkrWqZY9s2Kt2vy_cIMMRAd1H5iDCzg/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1jLkrWqZY9s2Kt2vy_cIMMRAd1H5iDCzg/view?usp=sharing</a></p>\n\n<p>I have a somewhat functional code that runs through the table and send emails to managers, but it is sending an e-mail each time if finds the manager, repeating the e-mail each time if finds the same manager.</p>\n\n<p>Another issue is I can't figure out how to add the lines in the mail body.</p>\n\n<pre><code>Private Sub CommandButton2_Click() 'envia o email com registro de log\n\n    Dim dictMails As Object, k, rw\n    Dim OutlookApp As Object\n    Dim cell As Range\n    Dim corpodoemail As String\n    Dim AssuntoEmail As String\n    Dim contator As Integer\n\n    contador = 1\n\n    Set OutlookApp = CreateObject(\"Outlook.Application\")\n\n    'Agrupa as linhas correlatas por destinat\u00e1rio do e-mail\n    Set dictMails = CreateObject(\"scripting.dictionary\")\n\n    For Each cell In Sheets(\"publico\").Range(\"H2:H2000\").Cells\n\n        destinatario = cell.value\n        If Len(destinatario) = 0 Then destinatario = cell.Offset(1, 0).value\n        If Len(destinatario) &gt; 0 Then\n            If Not dictMails.exists(destinatario) Then\n                Set dictMails(destinatario) = New Collection 'to hold the linked rows\n            End If\n            dictMails(destinatario).Add cell.Row 'record this row\n        End If\n    Next cell\n\n    'loop over the distinct recipients and their related rows\n    For Each k In dictMails.keys\n\n        Debug.Print \"Recipient: \" &amp; k\n\n        'build up the email body\n        'corpodoemail = Sheets(\"CAPA\").Range(\"F11\").value &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n          Sheets(\"CAPA\").Range(\"F13\").value &amp; \"&lt;br&gt;&lt;br&gt;\"\n\n        'etc etc\n        'add the information from the linked rows\n\n        For Each rw In dictMails(k)\n            Debug.Print \"    Row: \" &amp; rw\n            With Sheets(\"publico\").Rows(rw)\n                corpodoemail = \"&lt;head&gt;&lt;style&gt;table, th, td {border: 1px solid black; border-collapse:\" &amp; _\n                  \"collapse;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\" &amp; _\n                  \"&lt;table style=\"\"width:50%\"\"&gt;&lt;tr&gt;\" &amp; _\n                  \"&lt;th bgcolor=\"\"#D8D8D8\"\"&gt;MCI&lt;/th&gt;&lt;th bgcolor=\"\"#D8D8D8\"\"&gt;PRODUTO&lt;/th&gt;\" &amp; _\n                  \"&lt;th bgcolor=\"\"#D8D8D8\"\"&gt;DATA&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;\" &amp; _\n                  \"&lt;th&gt;\" &amp; .Cells(1).value &amp; \"&lt;/th&gt;\" &amp; \"&lt;th&gt;\" &amp; .Cells(2).value &amp; \"&lt;/th&gt;\" &amp; \"&lt;th&gt;\" &amp; .Cells(4).value &amp; \"/\" &amp; .Cells(5).value &amp; \"&lt;/th&gt;\" &amp; _\n                  \"&lt;th&gt;\" &amp; .Cells(12).value &amp; \"&lt;/th&gt;\" &amp; \"&lt;th&gt;\" &amp; .Cells(12).value &amp; \"&lt;/th&gt;\" &amp; \"&lt;th&gt;\" &amp; .Cells(14).value &amp; \"/\" &amp; .Cells(55).value &amp; \"&lt;/th&gt;\"\n            End With\n        Next rw\n\n        AssuntoEmail = Sheets(\"CAPA\").Range(\"F8\").value\n        Set Email = OutlookApp.CreateItem(0)\n        With Email\n            .To = k\n            .subject = AssuntoEmail\n            .HTMLBody = corpodoemail\n        End With\n\n        Email.Send\n\n    Next k 'pr\u00f3ximo gerente\n\nEnd Sub\n</code></pre>\n\n<p>How can I send one e-mail to each manager, and include the list with all the clients?</p>\n\n<p>To make it more clear:</p>\n\n<p>Client 1 and 2 from the list, belongs to branch 1126, manager 18, so the script must send and e-mail with line 2 and 3 of the sheet to said manager.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1571777203, "post_id": 58512077, "comment_id": 103351582, "body": "<code>vdate = cdbl(CDate(&quot;10&#47;22&#47;2019 2:10 PM&quot;))</code>"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571777500, "post_id": 58512077, "comment_id": 103351696, "body": "Awesome, thank you"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1571778126, "creation_date": 1571778126, "answer_id": 58512267, "question_id": 58512077, "link": "https://stackoverflow.com/questions/58512077/vba-excel-convert-date-time-to-text/58512267#58512267", "title": "VBA Excel Convert Date Time to Text", "body": "<p><code>Format</code> yields a <code>String</code>, you don't want that.</p>\n\n<p>Declare <code>vdate</code> as a <code>Double</code>:</p>\n\n<pre><code>Dim vdate As Double\n</code></pre>\n\n<p>Now this will work:</p>\n\n<pre><code>vdate = CDate(\"10/22/2019 2:10 PM\")\n</code></pre>\n\n<p>...but that's an implicit type conversion from <code>Date</code> to <code>Double</code>; you can make it explicit:</p>\n\n<pre><code>vdate = CDbl(CDate(\"10/22/2019 2:10 PM\"))\n</code></pre>\n\n<p>...as <a href=\"https://stackoverflow.com/questions/58512077/vba-excel-convert-date-time-to-text#comment103351582_58512077\">Scott mentioned in the comments</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13328844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VNqJspXqRUU/AAAAAAAAAAI/AAAAAAAAAAA/AAKWJJOiAYKAjEUtg3X7uWN5guMlbSkw4Q/photo.jpg?sz=128", "display_name": "office helpdesk", "link": "https://stackoverflow.com/users/13328844/office-helpdesk"}, "is_accepted": false, "score": 0, "last_activity_date": 1587029706, "creation_date": 1587029706, "answer_id": 61247068, "question_id": 58512077, "link": "https://stackoverflow.com/questions/58512077/vba-excel-convert-date-time-to-text/61247068#61247068", "title": "VBA Excel Convert Date Time to Text", "body": "<p>this example may be help you </p>\n\n<pre><code>Sub convert_date2txt()\n     Dim theRange as Range\n     Set theRange = Selection\n     Dim sDate As String\n     For Each theCell In theRange\n         sDate=Format(theCell,\"dd/mm/yyyy\")\n         theCell.Value = sDate\n         theCell.NumberFormat=\"@\"\n     Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 58512267, "answer_count": 2, "score": 0, "last_activity_date": 1587029706, "creation_date": 1571777114, "question_id": 58512077, "link": "https://stackoverflow.com/questions/58512077/vba-excel-convert-date-time-to-text", "title": "VBA Excel Convert Date Time to Text", "body": "<p>I'd like to convert a date time to text.</p>\n\n<p>Example: 10/22/2019 2:10 PM should be converted to 43760.59028. I know how to do this if I was trying to convert a cell in a spreadsheet, but I'm trying to convert a date time variable.</p>\n\n<p>I've tried: <code>vdate = Format(CDate(\"10/22/2019 2:10 PM\"), \"@\")</code></p>\n\n<p>I end up with a string rather than the text conversion to a number.</p>\n\n<p>How do I convert a date or date time and store the value in a variable?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571776948, "post_id": 58511953, "comment_id": 103351481, "body": "Do you get some error? You should get rid of <code>On Error Resume Next</code>."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571777067, "post_id": 58511953, "comment_id": 103351533, "body": "when trying to debug with the immediate window it just not shows nothing at all after that with... no errors as well. I just have it there to make sure all is ok, while doing/writing the code"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571777077, "post_id": 58511953, "comment_id": 103351539, "body": "You are using <code>Exit Sub</code> before your error handler. So even if Err.Number &gt; 0, you won&#39;t print the error."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571777148, "post_id": 58511953, "comment_id": 103351564, "body": "humm you sure about that ? i mean i was using the same method on the form button click and it was showing the errors"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571777230, "post_id": 58511953, "comment_id": 103351596, "body": "I am 100% sure that <code>Exit Sub</code> executs before your <code>If Err.Number...</code> statement."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1571777458, "post_id": 58511953, "comment_id": 103351682, "body": "you right... i migh have understood that part wrong <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/exit-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1571778480, "post_id": 58512144, "comment_id": 103352052, "body": "ahh so it&#39;s possible to create the headers when we create the table nice... I did read several times the help from the official site and i did try using the &quot;Destination&quot; option from add method but with out success. I start wondering it was not possible. Thanks in advance will test it to see and will upvote if..."}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1571778965, "post_id": 58512144, "comment_id": 103352232, "body": "ahh so it&#39;s not indeed possible to create the table with headers you just using the Transpose method to populate the future header cell values ... nice method by the way i was not away of that one"}, {"owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1571779818, "post_id": 58512144, "comment_id": 103352508, "body": "i noted you did not declared the variable tCell. Isn&#39;t that one needed to be declared ? If not why ? Thanks advance"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1571793638, "post_id": 58512144, "comment_id": 103355496, "body": "Yes, but you already declared it. I only included the relevant snippet of code that I modified, which the first case didn&#39;t use any new declarations."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "edited": false, "score": 0, "creation_date": 1571793818, "post_id": 58512144, "comment_id": 103355529, "body": "Yes, I just populate headers in advance. This could be done manually (not part of macro). The idea is that you insert table and existing values will become the headers, otherwise it uses the defaults like &quot;Column 1&quot;, etc."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1571777808, "last_edit_date": 1571777808, "creation_date": 1571777444, "answer_id": 58512144, "question_id": 58511953, "link": "https://stackoverflow.com/questions/58511953/having-issue-with-headerrowrange-to-loop-through-all-headers-and-change-their-va/58512144#58512144", "title": "Having issue with HeaderRowRange to loop through all headers and change their values", "body": "<p>Try this to iterate over the <code>tbl.HeaderRowRange.Cells</code> directly:</p>\n\n<pre><code>With tbl\n    .Name = \"TabelaDados\"\n    .TableStyle = \"TableStyleMedium2\"\n    For Each tCell In tbl.HeaderRowRange.Cells\n        Debug.Print tCell\n    Next tCell\nEnd With\n</code></pre>\n\n<p>Note comments above re: error-handling:</p>\n\n<ul>\n<li>You are using <code>Exit Sub</code> before your error handler. So even if <code>Err.Number &gt; 0</code>, you won't print the error.</li>\n<li><code>On Error Resume Next</code> simply tells the IDE to <em>ignore any and all errors</em>. This means that errors can compound and lead to further errors, which then become the more difficult to troubleshoot. It's generally frowned upon to use <code>On Error Resume Next</code> <em>especially</em> when you've wrapped the entire executable body of your subroutine in that sort of handler. There are some limited/single-use functions that make use of this construct, but that is not a good idea to implement in this case.</li>\n</ul>\n\n<blockquote>\n  <p>it's not possible (to my knowledge) to create the table and give names to headers before creating</p>\n</blockquote>\n\n<p>Here this is possible, if you first populate the cells that will comprise the range, and <em>then</em> add a table:</p>\n\n<pre><code>Dim hdrRange As Range\nSet hdrRange = Range(\"A1:E1\")\nConst HEADERS As String = \"Alpha,Beta,Gamma,Delta,Epsilon\"\nhdrRange.Value = Application.Transpose(Application.Transpose(Split(HEADERS, \",\")))\n' Creates table with the headers already in place:\nSet tbl = ws.ListObjects.Add(xlSrcRange, Range(Cells(1, 1), Cells(1, 5)), , xlYes)\n\nWith tbl\n    .Name = \"TabelaDados\"\n    .TableStyle = \"TableStyleMedium2\"\n    For Each tCell In tbl.HeaderRowRange.Cells\n        Debug.Print tCell\n    Next tCell\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/i3str.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i3str.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/3h6ss.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3h6ss.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 89, "user_id": 2320826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e669c798427613b2a065884c7a7d1b4?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2320826/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 58512144, "answer_count": 1, "score": 0, "last_activity_date": 1571777808, "creation_date": 1571776574, "last_edit_date": 1571776760, "question_id": 58511953, "link": "https://stackoverflow.com/questions/58511953/having-issue-with-headerrowrange-to-loop-through-all-headers-and-change-their-va", "title": "Having issue with HeaderRowRange to loop through all headers and change their values", "body": "<p>I was trying to loop through all headers in my table on Excel to change their values, unless there is a better approach.</p>\n\n<p>The idea is to check if the table already exists and if it does not, create a new table, however and since it's not possible (to my knowledge) to create the table and give names to headers before creating, I have to  change their names after. For that I was trying to use the <strong>.HeaderRowRange.Address</strong> to loop true all cells in that range and change the values of headers, but the <strong>With tCells</strong> is not being triggered</p>\n\n<p>This is the code I have:</p>\n\n<pre><code>Sub novaLinha()\nDim iRow As Long\nDim ws As Worksheet\nDim tbl As ListObject\nDim tCells As Ranges\nDim tCell As Range\n\nOn Error Resume Next\n\nSet ws = Worksheets(\"Dados\")\n\nIf ws.ListObjects.count Then\n\nElse\n    Set tbl = ws.ListObjects.Add(xlSrcRange, Range(cells(1, 1), cells(1, 5)), , xlYes)\n\n    With tbl\n        .Name = \"TabelaDados\"\n        .TableStyle = \"TableStyleMedium2\"\n        Set tCells = Range(.HeaderRowRange.Address)\n        Debug.Print Range(.HeaderRowRange.Address)\n        With tCells\n            Debug.Print tCells\n            For Each tCell In tCells\n                Debug.Print tCell\n            Next tCell\n        End With\n    End With\nEnd If\n\n'iRow = ws.Cells(Rows.count, 1).End(xlUp).Row\n'ws.Cells(iRow, 1).Value = ws.ListObjects.count\nExit Sub\n    If Err.Number &gt; 0 Then\n        Debug.Print Err.Number &amp; \":\" &amp; Err.Description\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "outlook", "autohotkey"], "owner": {"reputation": 21, "user_id": 10046180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5554a4e33f959b91fc42b3be31de4179?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/10046180/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571774734, "creation_date": 1571774734, "question_id": 58511566, "link": "https://stackoverflow.com/questions/58511566/using-vba-ahk-to-highlight-the-most-recent-email-in-outlook", "title": "Using VBA / AHK to highlight the most recent email in Outlook", "body": "<p>Within Outlook, in the central pane of Outlook one can see a table of emails in the currently selected folder. I would like to highlight, but not open, the most recently received of these.  I'm doing this in AHK so the code looks a little odd, but it\u2019s basically VBA.</p>\n\n<pre><code>OlApp := ComObjActive(\"Outlook.Application\")\nActiveExplorer := OlApp.ActiveExplorer\nMyCurrentFolder:= OlApp.ActiveExplorer.CurrentFolder\nMyItems := MyCurrentFolder.Items\nMyItems.Sort(\"[Received]\", true)\nMailItem:=MyItems.GetFirst\nActiveExplorer.ClearSelection\nActiveExplorer.AddToSelection(MailItem)\n</code></pre>\n\n<p>However: \n1) it doesn't run at all when the folder is set to View > \u201cShow as Conversations\u201d\n2) although it does highlight the most recent email, it does not give that email keyboard focus; e.g. if you try to use the keyboard down arrows to select the next email in the list you will find that the keyboard's focus is on a different email.\n3) MailItem seems to get the most recent email in ANY folder, not the current folder.</p>\n\n<p>Any suggestions to improve on these shortcomings would be gratefully received.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571774586, "post_id": 58511480, "comment_id": 103350524, "body": "You need <code>WorksheetFunction</code> in front of <code>rept</code> too, if you plan to use it."}, {"owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571774736, "post_id": 58511480, "comment_id": 103350592, "body": "editor keeps highlighting the last <code>100</code> in this line <code>&amp; application.worksheetfunction.right(Manager,&quot; &quot;,worksheetfunction.rept(&quot; &quot;,100)),100))</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571774860, "post_id": 58511480, "comment_id": 103350649, "body": "By &quot;if you plan to use it,&quot; I also meant that there&#39;s probably a cleaner VBA solution that doesn&#39;t resort to worksheet formulas, to be honest."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1571775218, "post_id": 58511480, "comment_id": 103350814, "body": "<code>Split(Range(&quot;E2&quot;),&quot; &quot;)(Ubound(Split(Range(&quot;E2&quot;),&quot; &quot;))</code>"}, {"owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571775837, "post_id": 58511480, "comment_id": 103351040, "body": "@ScottCraner I&#39;ll need it to reference the <code>Manager</code> variable, so would I do:  <code>Split(Manager,&quot; &quot;)(UBound(Split(Manager,&quot; &quot;))</code>?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1571775953, "post_id": 58511480, "comment_id": 103351093, "body": "@NidenK - Yes. You can replace <code>Manager</code> in Scott&#39;s example"}, {"owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571775978, "post_id": 58511480, "comment_id": 103351105, "body": "@ScottCraner this: <code>Split(Manager, &quot; &quot;)(UBound(Split(Manager, &quot; &quot;)))</code> worked perfectly, can you provide an answer so I can mark it solved? Thanks!!!"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1571776125, "creation_date": 1571776125, "answer_id": 58511836, "question_id": 58511480, "link": "https://stackoverflow.com/questions/58511480/incorporating-a-worksheetfunction-right-in-this-naming-convention/58511836#58511836", "title": "Incorporating a Worksheetfunction.right in this naming convention?", "body": "<p>When using VBA, use VBA.  There are time that <code>WorkSheetFunction</code> are needed but they are rare and slower than the native functions in vba.</p>\n\n<p>In this case we can use <code>Split()</code> to split on the space and return the last one with UBound</p>\n\n<pre><code>Split(Manager, \" \")(UBound(Split(Manager, \" \")))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1571776456, "creation_date": 1571776456, "answer_id": 58511921, "question_id": 58511480, "link": "https://stackoverflow.com/questions/58511480/incorporating-a-worksheetfunction-right-in-this-naming-convention/58511921#58511921", "title": "Incorporating a Worksheetfunction.right in this naming convention?", "body": "<p>You can also use <code>mid</code> and <code>InStrRev</code> ;o) like so:</p>\n\n<p><code>mid(Range(\"E2\").value,InStrRev(Range(\"E2\").value,chr(32)))</code></p>\n"}], "owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58511836, "answer_count": 2, "score": 0, "last_activity_date": 1571776456, "creation_date": 1571774356, "last_edit_date": 1571775704, "question_id": 58511480, "link": "https://stackoverflow.com/questions/58511480/incorporating-a-worksheetfunction-right-in-this-naming-convention", "title": "Incorporating a Worksheetfunction.right in this naming convention?", "body": "<p>I have files being saved off a master file. Unfortunately, the character limit is coming close to exceeding excels limitations and I wanted to see if it's possible to implement this formula as a worksheet function in VBA? </p>\n\n<p>formula: <code>=TRIM(RIGHT(SUBSTITUTE(E2,\" \",REPT(\" \",100)),100))</code></p>\n\n<p>vba line in order to save my file: <code>.SaveAs Filename:=Basepath &amp; dt &amp; \"_\" &amp; Manager &amp; \"_Employee Impacts File\", FileFormat:=xlOpenXMLWorkbook</code></p>\n\n<p>I was thinking something like: <code>&amp; application.worksheetfunction.right(Manager,\" \",rept(\" \",100)),100)) &amp; \"_Employee Impacts File\"</code>, but that's not working for me, getting a syntax error</p>\n"}, {"tags": ["python", "excel", "vba", "win32com"], "answers": [{"tags": [], "owner": {"reputation": 5785, "user_id": 7306999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9dNzL.jpg?s=128&g=1", "display_name": "Xukrao", "link": "https://stackoverflow.com/users/7306999/xukrao"}, "is_accepted": true, "score": 4, "last_activity_date": 1571774280, "creation_date": 1571774280, "answer_id": 58511460, "question_id": 58511252, "link": "https://stackoverflow.com/questions/58511252/how-to-quit-excel-with-win32com-without-saving/58511460#58511460", "title": "How to Quit Excel with win32com, without saving?", "body": "<pre><code>from win32com.client import Dispatch\n\n# Start excel application\nxl = Dispatch('Excel.Application')\n\n# Open existing excel file\nbook = xl.Workbooks.Open('workbook.xlsx')\n\n# Some arbitrary excel operations ...    \n\n# Close excel application without saving file\nbook.Close(SaveChanges=False)\nxl.Quit()\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4929321, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/76855ab71ff9182a05e0aa7187caeca7?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Chan", "link": "https://stackoverflow.com/users/4929321/joe-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 58511460, "answer_count": 1, "score": 2, "last_activity_date": 1598986212, "creation_date": 1571773365, "last_edit_date": 1598986212, "question_id": 58511252, "link": "https://stackoverflow.com/questions/58511252/how-to-quit-excel-with-win32com-without-saving", "title": "How to Quit Excel with win32com, without saving?", "body": "<p>When I do xl.Quit(), Excel always pops up with a prompt that ask whether or not I want to save. How do tell it I don't want to save?</p>\n\n<pre><code>xl = Dispatch('Excel.Application')\nxl.Workbooks.Open('New Workbook.xlsx')\n# do some stuff\n\nxl.Quit()\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1571772232, "post_id": 58510765, "comment_id": 103349605, "body": "I would imagine that <code>qcolumns(i).XlGrouped</code> has to extract the class from the array and then do the property check, where the 1st is just the property check."}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1571772406, "post_id": 58510765, "comment_id": 103349684, "body": "It&#39;s weird because if you set it to variable is much much faster. So I don&#39;t get it why this &quot;extraction&quot; would take this much. Unless it&#39;s duplicating it and setting to a variable just sets a reference."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 2, "creation_date": 1571773518, "post_id": 58510765, "comment_id": 103350088, "body": "How are <code>qc</code> and <code>qcolumns()</code> defined, and where is the code in the VBA project? Is it in class, a module, a worksheet? We need to see the <code>Dim</code> statements so we know what is what."}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571775230, "post_id": 58510765, "comment_id": 103350823, "body": "<code>Dim qcolumns As Variant</code> ; <code>Dim qc As settingscolumns</code> ; <code>qcolumns</code> in an array of custom classes, <code>qc</code> is is a custom class."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1571775372, "post_id": 58510765, "comment_id": 103350884, "body": "Have you tried alternative collection objects to use instead of array, the collection or the dictionary, see how they perform?  Looking at your dim&#39;s, this method <code>qcolumns(i).</code> would also need time to find a suitable object to put it in.  It is unusual the amount of time I imagine."}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571775490, "post_id": 58510765, "comment_id": 103350927, "body": "<code>qcolumns</code> array has 4 positions... so that&#39;s not a problem. I&#39;ll try collection. That might work faster."}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571775946, "post_id": 58510765, "comment_id": 103351089, "body": "Ok I tried collection but it&#39;s actually even slower than array."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571776572, "post_id": 58510765, "comment_id": 103351328, "body": "You tried a collection, but were you iterating it with a <code>For</code> loop or a <code>For Each</code> loop? It makes <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">quite a massive difference</a>"}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571780987, "post_id": 58510765, "comment_id": 103352823, "body": "I was doing for."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571781243, "post_id": 58511922, "comment_id": 103352893, "body": "I see, so if I do <code>set qc = qcolumns(i)</code> the pointer gets precompiled? While looping of an array doesn&#39;t and it then needs to find a memory location for it each time? (sorry for newbish question)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571781635, "post_id": 58511922, "comment_id": 103352996, "body": "No. When you do <code>qcolumns(i).MemberCall</code>, the member call is late-bound, because all the compiler sees is a <code>Variant</code>. When you do <code>Set qc = qcolumns(i)</code>, if <code>qc</code> is declared <code>As Variant</code> then <code>qc.MemberCall</code> is still late bound. What makes it early bound is <code>Dim qc As SettingsColumn</code>. That&#39;s a separate issue from how the data structure (array vs collection) is being iterated and how each item is retrieved (by index vs by enumerator)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1571782224, "post_id": 58511922, "comment_id": 103353157, "body": "@DamGal actually, kinda - the dereferencing needs to occur at every iteration. If the array contains numbers or strings (i.e. plain values), a <code>For</code> loop is extremely fast. It&#39;s slower when objects are involved, and <code>For Each</code> is optimized for iterating object collections, so think values=&gt;array=&gt;for and objects=&gt;collection=&gt;for each =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1571776465, "creation_date": 1571776465, "answer_id": 58511922, "question_id": 58510765, "link": "https://stackoverflow.com/questions/58510765/vba-class-performance/58511922#58511922", "title": "VBA class performance", "body": "<p>The 200ms is anecdotal, but the overhead can be explained.</p>\n\n<pre><code>Dim qcolumns As Variant\n</code></pre>\n\n<p>That's your array, but to VBA it's just a <code>Variant</code>: in order to know it's looking at an array, VBA needs (at runtime) to dereference the variant pointer, inspect the bytes that hold the subtype metadata, get the array pointer, ...and dereference the array pointer.</p>\n\n<p>There would be less overhead with an explicit array declaration:</p>\n\n<pre><code>Dim qcolumns(1 To 10) As SettingsColumns\n</code></pre>\n\n<p>Now, we don't really care about the array... we're just trying to iterate its contents:</p>\n\n<pre><code>Set qc = qcolumns(i)\n</code></pre>\n\n<p>So at each iteration, the variant/array dereferencing needs to happen, and the object pointer gets copied to <code>qc</code>. But why is it slower to make a member call against <code>qcolumns(i)</code>?</p>\n\n<p>Because <code>qcolumns</code> is a <code>Variant</code>, any member call made against it has to be late-bound, i.e. resolved at run-time. The <code>XlGrouped</code> property isn't known to VBA until the member call succeeds, and the member call can only succeed after querying the <code>IUnknown</code> interface of the object (if that fails, error 438 is raised).</p>\n\n<p>When you do <code>Dim qc As SettingsColumn</code>, you are binding early, at compile-time. Now the compiler already knows where to find the <code>XlGrouped</code> member, and doesn't need to query <code>IUnknown</code> through a <code>Variant</code> pointer: everything is much simpler... and usually simpler means faster.</p>\n\n<p>But you're iterating an array of objects: that's going to be slower than it needs to be, no matter what.</p>\n\n<p>Objects want to be iterated in a <code>Collection</code>, using a <code>For Each</code> loop.</p>\n\n<pre><code>Dim qc As SettingsColumn\nFor Each qc In myCollection\n    If qc.XlGrouped Then  '&lt;~ note =True is redundant\n       '...\n    End If\nNext\n</code></pre>\n\n<p>See <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">For vs For Each</a> for more information and performance benchmarks. The bottom line is, iterating an object <code>Collection</code> with a <code>For</code> loop and retrieving each item by index, is always going to be much slower than a <code>For Each</code> loop; use <code>For</code> to iterate arrays of values, <code>For Each</code> to iterate collections of objects.</p>\n"}], "owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 58511922, "answer_count": 1, "score": 1, "last_activity_date": 1571776465, "creation_date": 1571770965, "question_id": 58510765, "link": "https://stackoverflow.com/questions/58510765/vba-class-performance", "title": "VBA class performance", "body": "<p>I've got this code:</p>\n\n<pre><code>For i = 0 To .Fields.Count - 1\n    Set qc = qcolumns(i)\n    If qc.XlGrouped = True Then\n...\n</code></pre>\n\n<p>What is weird for me is that if I change <code>qc.XlGrouped = True</code> to <code>qcolumns(i).XlGrouped = True</code> it will take 200ms while the first one takes 0ms. Why such a difference just from setting class from an array to a variable?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571770118, "post_id": 58510580, "comment_id": 103348732, "body": "<code>Rows(lastrow + 1, 1).EntireRow.PasteSpecial</code>"}, {"owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571770308, "post_id": 58510580, "comment_id": 103348804, "body": "When I run that, I get run-time error &#39;1004&#39;: application-defined or object defined error for that line"}, {"owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1571770647, "post_id": 58510580, "comment_id": 103348949, "body": "When I did that, it gave me Run-time error &#39;438&#39;: object doesn&#39;t support this property or method"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571770800, "post_id": 58510580, "comment_id": 103349014, "body": "<code>Cells(lastrow + 1, 1).PasteSpecial</code>"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1571771030, "post_id": 58510719, "comment_id": 103349102, "body": "I copied and pasted that, and now I get run-time error &#39;9&#39;: Subscript out of range for <code>lastrow = Worksheets(&quot;Employee Reports&quot;).Range(&quot;A65536&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1571771202, "post_id": 58510719, "comment_id": 103349176, "body": "@Tara then there is no sheet named <code>Employee Reports</code>  Check to make sure it is spelled correctly and there are no preceding or end spaces in the sheet name."}, {"owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1571771579, "post_id": 58510719, "comment_id": 103349329, "body": "Yep you were right, small typo. Now it gives run-type error &#39;13&#39;: Type mismatch for <code>Set rw = .Range(&quot;B:B&quot;).Find(What:=myEmp, After:=ActiveCell, _         LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _         SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571771791, "post_id": 58510719, "comment_id": 103349429, "body": "Going to remove my answer as Scott hit on the 2 things I was working with... inappropriate syntax (swapped to using <code>Cells()</code>) and copy/paste directly one after another to prevent the clipboard from clearing the Copy."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571771851, "post_id": 58510719, "comment_id": 103349453, "body": "@ScottCraner I also just saw your comment about the <code>.paste</code> and missed the change to <code>.pastespecial</code> when answering"}, {"owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1571930018, "post_id": 58510719, "comment_id": 103409993, "body": "Hey guys, do you know how I could edit the code to make it paste every time the row is found with that person&#39;s name? Right now it&#39;s only copying and pasting the first row it finds and not all rows"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1571771651, "last_edit_date": 1571771651, "creation_date": 1571770723, "answer_id": 58510719, "question_id": 58510580, "link": "https://stackoverflow.com/questions/58510580/trouble-pasting-entire-row/58510719#58510719", "title": "Trouble Pasting Entire Row", "body": "<pre><code>Private Sub CommandButton1_Click()\n\n    Dim myValue As String\n    myEmp = InputBox(\"Search for an employee by last name\")\n    ActiveSheet.Range(\"B3\").Value = myEmp\n\n    Dim lastrow As Long\n    lastrow = Worksheets(\"Employee Reports\").Range(\"A65536\").End(xlUp).Row\n\n    With Sheet7\n        Dim rw As Range\n        Set rw = .Range(\"B:B\").Find(What:=myEmp, After:=.Range(\"B1\"), _\n        LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n        If Not rw Is Nothing Then\n            rw.EntireRow.Copy Worksheets(\"Employee Reports\").Cells(lastrow + 1, 1)\n        Else\n            MsgBox myEmp &amp; \" Not Found in Range\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58510719, "answer_count": 1, "score": 0, "last_activity_date": 1571771651, "creation_date": 1571769969, "question_id": 58510580, "link": "https://stackoverflow.com/questions/58510580/trouble-pasting-entire-row", "title": "Trouble Pasting Entire Row", "body": "<p>I'm trying to paste the enire row of information to the next available row but I keep getting errors about not having the <code>Rows(lastrow +1, 1).EntireRow.Paste</code> written correctly. Please let me know how I can perform that action correctly.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim myValue As String\n    myEmp = InputBox(\"Search for an employee by last name\")\n    Range(\"B3\").Value = myEmp\n\nWith Sheet7\n    Range(\"B:B\").Select\n        Set Row = Selection.Find(What:=myEmp, After:=ActiveCell, _\n        LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n    Row.EntireRow.Copy\n\nEnd With\n\nWorksheets(\"Employee Reports\").Activate\n    Dim lastrow As Long\n    lastrow = Range(\"A65536\").End(xlUp).Row\n    Rows(lastrow + 1, 1).EntireRow.Paste\n\n\nEnd Sub\nPrivate Sub Workbook_Open()\n\nApplication.EnableEvents = False\nWorksheets(\"Sheet3\").Range(\"A4:A20\").Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 5144005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633f1ccad8f34c8cbde37dc9536eb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ericka Miller", "link": "https://stackoverflow.com/users/5144005/ericka-miller"}, "edited": false, "score": 0, "creation_date": 1571837025, "post_id": 58510421, "comment_id": 103372775, "body": "I tried to do a workaround that would tell if the data was numeric or string but failed epically. I created a few variables and added an if statement that if the value isNumeric then an integer variable would be used else a string variable would be used. Thought myself a clever workaround. Of course both 10 and &quot;10&quot; are apparently both numerical in the expression IsNumeric so therefore I never get to setting my string variable in the ELSE part of the If IsNumeric(Width.Fields(&quot;Width&quot;)) Then ............"}, {"owner": {"reputation": 3, "user_id": 5144005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633f1ccad8f34c8cbde37dc9536eb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ericka Miller", "link": "https://stackoverflow.com/users/5144005/ericka-miller"}, "edited": false, "score": 0, "creation_date": 1571838475, "post_id": 58510421, "comment_id": 103373619, "body": "Got my workaround to work with If Application.WorksheetFunction.IsNumber (Width.Fields(&quot;Width&quot;) =True then ..... But I still don&#39;t understand why VBA is pulling Numbers stored as numbers in the worksheet as test into VBA"}], "owner": {"reputation": 3, "user_id": 5144005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633f1ccad8f34c8cbde37dc9536eb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ericka Miller", "link": "https://stackoverflow.com/users/5144005/ericka-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571809775, "creation_date": 1571769311, "last_edit_date": 1571809775, "question_id": 58510421, "link": "https://stackoverflow.com/questions/58510421/vba-sql-query-is-not-pulling-values-consistently-as-numeric-when-the-data-is-num", "title": "VBA SQL Query is not pulling values consistently as numeric when the data is numeric", "body": "<p>I have a excel database that I wrote VBA code to create a pricegrid by width and height based on item category. I am using 3 SQL statements to achieve this grid. One for the height, one for the Width, and one for the price for each width x height I am using SQL Queries to pull the data from the worksheet. I have additional code that fires first to transform the data into numeric or text based on column. This way the Height and Width columns will always be numbers and not numbers saved as text and the item category columns that are mixed text and numbers will be numbers stored as text. This way the StrSql Statement can pull the data without a mismatch. The problem is that while the entire column is the correct type of data on the worksheet and the sql statement is pulling the correct number type of data for one grid and then the next grid pulls the number data as string. I have checked the data in the worksheet and it is indeed converted to number and the column is formatted as a number. Some of the grids are created ok but others I get a data mismatch error. What can cause a SQL Query to pull numerical data as string only sometimes?</p>\n\n<pre><code>StrSql=SELECT DISTINCT [GRIDDATA$].[WIDTH] FROM [GRIDDATA$] WHERE [GRIDDATA$].[ItemCategory] = '\" CAT.Fields(\"ItemCategory\")\"' ORDER BY [GRIDDATA$].[Width]\nWidth.Open strSQL, cnn, adOpenKeyset, adLockOptimistic\n\n'more code\n\nStrSql= SELECT DISTINCT [GRIDDATA$].[Price] FROM [GRIDDATA$] WHERE [GRIDDATA$].[WIDTH] = \" &amp; Width.Fields(\"Width\") &amp; \" AND [GRIDDATA$].[HEIGHT] = \" &amp; Height.Fields(\"Height\") &amp; \" AND [GRIDDATA$].[ItemCategory] = '\"CAT.Fields(\"ItemCategory\")\"'\nPriceVal.Open strSQL, cnn, adOpenKeyset, adLockOptimistic \n</code></pre>\n\n<p>It is only the PriceVal Query that is having the error Data Mistype error on the Width.Fields(\"Width\"). It is sometimes pulling the number stored as a number as a string.</p>\n\n<p>Below is my Prep data code</p>\n\n<pre><code>'Convert Width to Numbers\n\nLastRow = sht.Cells(sht.Rows.Count, \"Q\").End(xlUp).Row\n\nSet SelectR = sht.Range(\"Q2:Q\" &amp; LastRow)\n\nSelectR.TextToColumns Destination:=Range(\"Q2\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1571768889, "post_id": 58510310, "comment_id": 103348280, "body": "<code>&quot;&quot;</code> should be <code>&quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 7, "user_id": 11616164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ru86g.jpg?s=128&g=1", "display_name": "Stephanie", "link": "https://stackoverflow.com/users/11616164/stephanie"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571769208, "post_id": 58510310, "comment_id": 103348404, "body": "Oh my goodness. Thank you! I have been going around this for hours.  I didn&#39;t realize the formula formatting changed like that when transferring to VBA as the formula functioned correctly otherwise."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1571775216, "post_id": 58510310, "comment_id": 103350811, "body": "Just 2 tips, 1) Try to avoid complete search columns. 2) Avoid whenever possible (it&#39;s almost ever possible) IFERROR, it masks all errors, in this case you could use COUNTIF to see if there&#39;s no CHECK NO."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1571780947, "post_id": 58510310, "comment_id": 103352810, "body": "@EvR why?  1.  Vlookup is optimized and there is no difference in speed when using full column in the lookup and just the data set. 2. Using IFERROR in this case it perfectly acceptable and avoids the COUNTIF which is not as optimized as vlookup.  Basicall, both your statements are misleading and in error."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571782814, "post_id": 58510310, "comment_id": 103353293, "body": "@Scott Craner in which versions Vlookup is optimized? What if when there&#39;s data below or above the data set? What if [CHECK NO.] is already an error? Personally I think masking errors is bad practice, usage of complete columns or rows in formulas is also. And when it comes to speed I don&#39;t think you have to place formulas by VBA in cells in the first place.  But just my two cents."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1571783102, "post_id": 58510310, "comment_id": 103353362, "body": "@EvR I agree 100% on dealing with errors in the data, but this IFERROR is not dealing with errors in the lookup columns it is dealing with there not being a match.  and it is less overhead to use it than to do an <code>IF</code> with <code>COUNTIF</code>  As far as full columns data should not have different tables on top of one another.  Data should be on its own sheet and kept flattened, In my opinion, then as data grows one does not need to update the formulas.  When using COUNTIF(), SUMIF() AVERAGEIF() or array type formulas, yes it should be limited to the  dataset.  And I agree if using VBA, use VBA."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1571783346, "post_id": 58510310, "comment_id": 103353434, "body": "@EvR if you want to test it, do this.  In A1 put <code>=RANDBETWEEN(1,100)</code> and copy down 15,000 rows.  In B1 put <code>=VLOOKUP(A1,A:A,1,FALSE)</code> and fill down the same.  Now hit F9 a few times, the numbers update nearly instantly.  Now in C1 put: <code>=COUNTIF(A:A,A1)</code> and fill down the same number of rows.  Now when you hit F9, it takes a second or two to calculate.  That is what I mean.  And eventually with enough COUNTIF()s it will cause the calcs to fail completely but you can fill the full column with VLOOKUP()s and it will not fail."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571786049, "post_id": 58510310, "comment_id": 103354082, "body": "@Scott Craner, Tested and yes COUNTIF compared to Vlookup is (very) slow on large datasets, In addition to the use of some matrix formulas and with Getpivotdata formulas, I see there is still a reason to use IFERROR with VLOOKUP and that&#39;s speed. I see users use the IFERROR formula, too much and inappropriately, and thereby incur all sorts of mistakes. (maybe IFNA is even better in this case?)"}], "owner": {"reputation": 7, "user_id": 11616164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ru86g.jpg?s=128&g=1", "display_name": "Stephanie", "link": "https://stackoverflow.com/users/11616164/stephanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571768782, "creation_date": 1571768782, "question_id": 58510310, "link": "https://stackoverflow.com/questions/58510310/trying-to-insert-iferror-formula-in-col-using-vba", "title": "Trying to insert IFERROR formula in Col using VBA", "body": "<pre><code>Private Sub CommandButton1_Click()\n'Filters Table for Blanks\nDim lo As ListObject\nDim icol As Long\n\nSet lo = ActiveSheet.ListObjects(1)\n'Sets Date cleared/voided col\nicol = lo.ListColumns(8).Index\n\nlo.Range.AutoFilter Field:=icol, Criteria1:=\"=\"\nlo.ListColumns(8).DataBodyRange.Formula = \"=IFERROR(VLOOKUP([@[CHECK NO.]],Vlookup!D:D,1,0),\"\")\"\n\nEnd Sub\n</code></pre>\n\n<p>What I am trying to do is update a list for checks that have cleared for the date pulled. \nIf it has cleared, enter the date it cleared. </p>\n\n<p>My current manual method is to use vlookup to determine if it has cleared. If there is an error, no data is populated. </p>\n\n<p>I know IFERROR isn't feasible in VBA, it is how I was pulling the date manually. Removing the IFERROR portion pulls the checks that have cleared ok, but I then want to convert all the error/\"N/A\" to empty cells and those that did not have errors equal to user input date. </p>\n\n<p>Any help in this endeavor is greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1571773736, "last_edit_date": 1571773736, "creation_date": 1571773386, "answer_id": 58511258, "question_id": 58510134, "link": "https://stackoverflow.com/questions/58510134/how-to-copy-row-and-insert-it-in-new-row-below-if-cell-contains-and-delete-w/58511258#58511258", "title": "How to copy row and insert it in new row below if cell contains &quot;,&quot; and delete what is after the &quot;,&quot; in the original cell", "body": "<p>You can do it thus, adjust sheet names to suit (I put the results on a different sheet): </p>\n\n<pre><code>Sub x()\n\nDim r As Range, v As Variant\n\nFor Each r In Sheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Columns(1).Cells\n    v = Split(r.Offset(, 3), \",\")\n    r.Resize(, 3).Copy Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp)(2).Resize(UBound(v) + 1)\n    Sheets(\"Sheet2\").Range(\"D\" &amp; Rows.Count).End(xlUp)(2).Resize(UBound(v) + 1).Value = Application.Transpose(v)\nNext r\n\nEnd Sub\n</code></pre>\n\n<p><code>Split</code> converts it to an array using a comma as delimiter; by transposing it you turn it into a 'vertical' array which can be pasted in the output sheet.</p>\n"}], "owner": {"reputation": 3, "user_id": 12259004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b324827e0572f48a820cea5307cf4f7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan", "link": "https://stackoverflow.com/users/12259004/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58511258, "answer_count": 1, "score": 0, "last_activity_date": 1571773736, "creation_date": 1571768031, "last_edit_date": 1571772146, "question_id": 58510134, "link": "https://stackoverflow.com/questions/58510134/how-to-copy-row-and-insert-it-in-new-row-below-if-cell-contains-and-delete-w", "title": "How to copy row and insert it in new row below if cell contains &quot;,&quot; and delete what is after the &quot;,&quot; in the original cell", "body": "<p>I am trying to copy a row and insert into a new row directly below if a cell in column D contains a \",\". There is a little more that I want to do, but it is easier to show a sample with before and after of what I want.                   </p>\n\n<p>Before</p>\n\n<pre><code>Jon     Junior   Male   A, X    \nPete    Freshman Male   A, X    \nTyler   Senior   Male   A, X, C    \nDave    Senior   Male   A, C, P, U\n</code></pre>\n\n<p>After</p>\n\n<pre><code>Jon     Junior   Male   A    \nJon     Junior   Male   X    \nPete    Freshman Male   A    \nPete    Freshman Male   X    \nTyler   Senior   Male   A    \nTyler   Senior   Male   X    \nTyler   Senior   Male   C    \nDave    Senior   Male   A    \nDave    Senior   Male   C    \nDave    Senior   Male   P    \nDave    Senior   Male   U\n</code></pre>\n\n<p>I've tried combining some ideas from past questions, but they don't seem to be working and I haven't really used VBA before.</p>\n\n<pre><code>Dim GCell As Range\nDim N As Long, i As Long\nN = ws.Cells(Rows.Count, \"D\").End(xlUp).Row\nFor Each GCell In Range(\"D2:D\")\n    If GCell.Value Like \"*,*\" Then\n    GCell.Offset(1, 0).EntireRow.Insert\n    ws.Cells(i, \"D\").EntireRow.Copy ws.Cells(i + 1, 1)\n    Else\n\n    End If\n    i = i + 1\n    Next GCell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1571766978, "post_id": 58509817, "comment_id": 103347474, "body": "I have never tried two timers in the same workbook (if I recall correctly). But I have had several workbooks open with reoccurring ontimes running with no problems"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1571768485, "post_id": 58509817, "comment_id": 103348111, "body": "Use 1 timer for 5 minutes, and where the <code>(now() - offset_from_hour) &#47; 15</code> is equal to the rounded version (no decimals), you trigger the 15 minute code, and similar for the 10 minute code."}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571766682, "creation_date": 1571766625, "last_edit_date": 1571766682, "question_id": 58509817, "link": "https://stackoverflow.com/questions/58509817/is-it-possible-to-run-multiple-ontime-events-when-the-first-one-is-recurring", "title": "Is it possible to run multiple ontime events when the first one is recurring?", "body": "<p>I am using <code>Application.Ontime</code> to run 3 procedures in a Workbook which will act as timers. The first one is just a reminder that the user has the Workbook locked for editing after 10 minutes. The other two check for inactivity based on Workbook events (<code>SheetCalculate</code>,<code>SheetSelectionChange</code> etc). After 10 minutes of inactivity a userform is called to warn them that they've been idle for 10 minutes, and that after 15 minutes, the form will automatically save and close.</p>\n\n<p>What I wanted to do is alter the first ontime event to <strong>repeat</strong> every 10 minutes just to let them know they are still working in a non Read-Only session. Easy enough, I just reschedule the procedure at the end of the procedure that is called. </p>\n\n<p>The issue I'm having though, is that it will repeat every 10 minutes as intended, but the other two (idle checks) that are scheduled, won't run until the recurring one is cancelled. <strong>And</strong> even though they are scheduled for <code>Now</code> + x minutes when the Workbook is opened, the timers do not start until the first scheduled procedure (EditTimeCheck) is finished. So even if I don't have it repeat, if the workbook were opened and inactive from the start, the first alert will pop up after 10 minutes, then the warning will trigger 10 minutes after that, then the save and close procedure 15 minutes after that. Meaning instead of closing after 15 minutes, it will close after 35. I may not fully understand <code>Application.Ontime</code> I suppose. </p>\n\n<p>I gather I can schedule multiple at once, but is it possible to have them actually function the way I thought they would? I've confirmed this is how they are behaving by commenting out the code for each procedure and adding <code>Debug.Print</code> With the procedure name and a timestamp.</p>\n\n<pre><code>Public IdleTimeClose As Double\nPublic IdleTime As Double\nPublic TimeOpen As Double\n</code></pre>\n\n<hr>\n\n<pre><code>    Private Sub Workbook_Open()\n    TimeOpen = Now + TimeValue(\"00:10:00\")\n    IdleTime = Now + TimeValue(\"00:15:00\")\n    IdleTimeClose = Now + TimeValue(\"00:15:00\")\n\n        If Not ThisWorkbook.ReadOnly Then\n        Application.OnTime TimeOpen, \"EditTimeCheck\"\n        Application.OnTime IdleTimeClose, \"CloseWB\"\n        End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub EditTimeCheck()\n\nMsgBox \"You've had the Workbook open for editing for x minutes\"\n\nTimeOpen = Now + TimeValue(\"00:10:00\")\nApplication.OnTime TimeOpen, \"EditTimeCheck\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub IdleWarning()\n\nWith inactiveUF\n  .StartUpPosition = 0\n  .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n  .Top = Application.Top + (0.55 * Application.Height) - (0.5 * .Height)\n  .Show False\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>    Sub CloseWB()\nDim wb As Workbook\nSet wb = Workbooks(\"Copy of Requests Tracker.xlsm\")\n\nWith wb\n    .Save\n    .Close True\n'End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub StartIdle()\n\nIdleTime = Now + TimeValue(\"00:00:10\")\nIdleTimeClose = Now + TimeValue(\"00:00:15\")\n\nApplication.OnTime IdleTime, \"IdleWarning\"\nApplication.OnTime IdleTimeClose, \"CloseWB\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub StopIdle()\n\nOn Error Resume Next\nApplication.OnTime IdleTime, \"IdleWarning\", , False\nApplication.OnTime IdleTimeClose, \"CloseWB\", , False\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Example of one of the Workbook events to reset the timer on the idle procedures</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Call StopIdle\n    Call StartIdle\nEnd Sub\n</code></pre>\n\n<p>Thanks for any insight, I haven't been able to find a clear cut answer in my searches.</p>\n"}, {"tags": ["excel", "vba", "text", "number-formatting"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 6, "creation_date": 1571765903, "post_id": 58509612, "comment_id": 103347022, "body": "That error means that no match was found. What are <code>ColumnB_Menu</code> and  <code>.Range(&quot;Dyn_Onsite_Number&quot;)</code>? i.e. what is the specific value of <code>ColumnB_Menu</code> when this fails?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1571768080, "creation_date": 1571768080, "answer_id": 58510141, "question_id": 58509612, "link": "https://stackoverflow.com/questions/58509612/match-generates-unable-to-get-the-match-property-of-the-worksheetfunction-class/58510141#58510141", "title": "Match generates &quot;Unable to get the Match property of the WorksheetFunction class&quot;", "body": "<p>Late Bind the Match by removing <code>WorkSheetFUnction.</code> and test for the error:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim TargetRow As Variant\n\n    TargetRow = Application.Match(ColumnB_Menu, Sheets(\"Data\").Range(\"Dyn_Onsite_Number\"), 0)\n\n    If Not IsError(TargetRow) Then\n        MsgBox TargetRow\n    Else\n        MsgBox ColumnB_Menu &amp; \" Not Found in Range\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12258882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f4c12f92ed975483157ae80d4adb9d8?s=128&d=identicon&r=PG&f=1", "display_name": "Marilyn", "link": "https://stackoverflow.com/users/12258882/marilyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574954014, "creation_date": 1571765753, "last_edit_date": 1574954014, "question_id": 58509612, "link": "https://stackoverflow.com/questions/58509612/match-generates-unable-to-get-the-match-property-of-the-worksheetfunction-class", "title": "Match generates &quot;Unable to get the Match property of the WorksheetFunction class&quot;", "body": "<p>I want to create a database. It seems VBA won't recognize numbers.</p>\n\n<p>This is the error I get:</p>\n\n<blockquote>\n  <p>Unable to get the Match property of the WorksheetFunction class</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/d6ZXD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d6ZXD.png\" alt=\"this is the error I get\"></a></p>\n\n<p>This is my code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim TargetRow As Integer\n\nTargetRow = Application.WorksheetFunction.Match(ColumnB_Menu, Sheets(\"Data\").Range(\"Dyn_Onsite_Number\"), 0)\nMsgBox TargetRow\n\nEnd Sub\n</code></pre>\n\n<p>This is a picture of my worksheet:<br>\n<a href=\"https://i.stack.imgur.com/bwWav.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bwWav.png\" alt=\"This is a picture of my worksheet\"></a></p>\n\n<p>Onsite Number = ColumnB_Menu</p>\n"}, {"tags": ["javascript", "html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1571780144, "post_id": 58509529, "comment_id": 103352601, "body": "Where are you getting the error?"}, {"owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1571795293, "post_id": 58509529, "comment_id": 103355802, "body": "On the &quot;For each l In date1&quot; line I get the error"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571839753, "post_id": 58518617, "comment_id": 103374426, "body": "It says that the object doesn&#39;t support this property or method on the &quot;ele.click&quot; line"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571839827, "post_id": 58518617, "comment_id": 103374463, "body": "What is the result of debug.print typename(ele) ?"}, {"owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571841240, "post_id": 58518617, "comment_id": 103375348, "body": "Ah so I took a look at your second line of code and you were right about the dynamic id. The problem with that though is that there are 2 datepickers, one that is $data.Range.From and the other is $data.Range.To. Do you know how I can distinguish the two? Because the 3rd solution you provided is a little difficult to incorporate into my macro for me."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571841308, "post_id": 58518617, "comment_id": 103375390, "body": "Can you share the html for both? Use the snippet tool via <a href=\"https://stackoverflow.com/posts/58518617/edit\">edit</a> to insert html properly."}, {"owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571842073, "post_id": 58518617, "comment_id": 103375786, "body": "I put the two snippets in the question post :D. What I want to do is type in values into those areas. I thought clicking and then using Sendkeys (vba) to input values from Excel, but if there is a way to directly input these values without clicking, that would be great too."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571851136, "post_id": 58518617, "comment_id": 103380245, "body": "getAttribute takes a value. It does not assign. So, are you saying you used my bottom edit to assign a value then read it to the sheet and got  &quot;Tue Jan 30 2018 00:00:00 GMT-0500 (Eastern Standard Time)&quot; ?"}, {"owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571851284, "post_id": 58518617, "comment_id": 103380315, "body": "I just tried it now and still got that weird result"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571851339, "post_id": 58518617, "comment_id": 103380350, "body": "I can&#39;t see your screen so I don&#39;t know what you are doing :-( you need to tell me the steps you are doing to produce this."}, {"owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571851987, "post_id": 58518617, "comment_id": 103380616, "body": "What I am trying to do is input the From date and To date into the above html fields. I will be getting these dates from an excel doc. The dates have the format MM/DD/YYYY. Say the From date is in cells(1, 1). When I do ie.document.querySelector(&quot;.hasDatepicker[placeholder=To]&quot;).&zwnj;&#8203;value = Cells(1,1).value, it autmatically inputs the date in that weird format. But if I do ie.document.querySelector(&quot;.hasDatepicker[placeholder=To]&quot;).&zwnj;&#8203;value = &quot;1/30/2018&quot;, it inputs it correctly. :("}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571863661, "post_id": 58518617, "comment_id": 103385406, "body": "try ie.document.querySelector(&quot;.hasDatepicker[placeholder=To]&quot;).&zwnj;&#8203;value = Cells(1,1).value2"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "edited": false, "score": 0, "creation_date": 1571863708, "post_id": 58518617, "comment_id": 103385426, "body": "Or input as text e.g. ie.document.querySelector(&quot;.hasDatepicker[placeholder=To]&quot;).&zwnj;&#8203;value = Format$(Cells(1,1).value, &quot;mm/dd/yyyy&quot;)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1571850538, "last_edit_date": 1571850538, "creation_date": 1571819233, "answer_id": 58518617, "question_id": 58509529, "link": "https://stackoverflow.com/questions/58509529/click-text-input-box-based-on-id/58518617#58518617", "title": "Click text input box based on id", "body": "<p>Some possibilities (the first being the likely culprit then some other considerations are listed):</p>\n\n<p>1) <code>getElementById</code> returns a single element so you do not <code>For Each</code> over. Simply do:</p>\n\n<pre><code>html.getElementById(\"dp1571754895218\").click\n</code></pre>\n\n<p>2) The id may be dynamic. Then try using combination of <code>title</code> and <code>class</code></p>\n\n<pre><code>ie.document.querySelector(\"[title=INVOICEDATE].hasDatepicker\").click\n</code></pre>\n\n<p>No need for a loop</p>\n\n<p>3) You do not have a long enough wait for the element to be present. Use a proper page load wait and a timed loop for the presence of the element</p>\n\n<pre><code>Public Sub test()\n    Dim ie As New InternetExplorer, t As Date, ele As Object\n    Const MAX_WAIT_SEC As Long = 10\n\n\n    With ie\n        .Visible = True\n        .Navigate2 \"url\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        t = Timer\n        Do\n            On Error Resume Next\n            Set ele = .document.getElementById(\"dp1571754895218\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n\n        If ele Is Nothing Then Exit Sub\n\n        ele.click\n\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<p>4) Your element is inside a <a href=\"https://stackoverflow.com/questions/44902558/accessing-object-in-iframe-using-vba\">frame/iframe</a> which needs to be navigated first</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Try:</p>\n\n<pre><code>ie.document.querySelector(\".hasDatepicker[placeholder=To]\").value = \"ABC\"\nie.document.querySelector(\".hasDatepicker[placeholder=From]\").value = \"XYZ\"\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1571850538, "creation_date": 1571765357, "last_edit_date": 1571841953, "question_id": 58509529, "link": "https://stackoverflow.com/questions/58509529/click-text-input-box-based-on-id", "title": "Click text input box based on id", "body": "<p>I am currently trying to click the following text input box based on its id: dp1571754895218 in VBA</p>\n\n<pre><code>&lt;input title=\"INVOICEDATE\" class=\"half-filter hasDatepicker\" id=\"dp1571754895218\" style=\"margin-right: 2px; opacity: 1;\" type=\"text\" placeholder=\"From\" data-bind=\"attr: { placeholder: 'From', title: $data.Key, 'data-tabgroup': 'itemlistfilter', 'data-tabgroupindex': ($index() + 1) }, datepicker: $data.Range.From, datepickerOptions: { dateFormat: $root.jQformatDate($data.Format) }, style: { 'opacity': $parent.multiSearchOn() ? '0.3' : '1' }\" data-tabgroup=\"itemlistfilter\" data-tabgroupindex=\"7\"&gt;\n</code></pre>\n\n<p>What I have tried so far is this:</p>\n\n<pre><code>Dim date1 As Object\nSet html = ie.document\nSet date1 = html.getElementById(\"dp1571754895218\")\nFor Each l In date1\n    If l.className = \"half-filter hasDatepicker\" Then\n        l.Click\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>But I keep getting the following error: <strong>Run-time error '424': Object required</strong>.\nI already have the correct references too. What am I doing incorrectly?</p>\n\n<p>Edit: For QHarr, here are both html codes\nplaceholder = To:\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input title=\"INVOICEDATE\" class=\"half-filter hasDatepicker\" id=\"dp1571841444746\" style=\"opacity: 1;\" type=\"text\" placeholder=\"To\" data-bind=\"attr: { placeholder: 'To', title: $data.Key, 'data-tabgroup': 'itemlistfilter', 'data-tabgroupindex': ($index() + 1.1) }, datepicker: $data.Range.To, datepickerOptions: { dateFormat: $root.jQformatDate($data.Format) }, style: { 'opacity': $parent.multiSearchOn() ? '0.3' : '1' }\" data-tabgroup=\"itemlistfilter\" data-tabgroupindex=\"7.1\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Placeholder = From:\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input title=\"INVOICEDATE\" class=\"half-filter hasDatepicker\" id=\"dp1571841444745\" style=\"margin-right: 2px; opacity: 1;\" type=\"text\" placeholder=\"From\" data-bind=\"attr: { placeholder: 'From', title: $data.Key, 'data-tabgroup': 'itemlistfilter', 'data-tabgroupindex': ($index() + 1) }, datepicker: $data.Range.From, datepickerOptions: { dateFormat: $root.jQformatDate($data.Format) }, style: { 'opacity': $parent.multiSearchOn() ? '0.3' : '1' }\" data-tabgroup=\"itemlistfilter\" data-tabgroupindex=\"7\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1571763263, "post_id": 58509000, "comment_id": 103345833, "body": "Activate the sheet before running the code?"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1571763776, "post_id": 58509000, "comment_id": 103346071, "body": "hi. u have everywhere ActiveWindow... try to change to the sheet u want..."}, {"owner": {"reputation": 1312, "user_id": 9988108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfd8fa67aa26b06219e478858493cf05?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin", "link": "https://stackoverflow.com/users/9988108/agustin"}, "edited": false, "score": 0, "creation_date": 1571764442, "post_id": 58509000, "comment_id": 103346377, "body": "Thank you. That works I think"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1571764638, "post_id": 58509000, "comment_id": 103346472, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34094445/excel-vba-freeze-pane-without-select\">excel vba freeze pane without select</a>"}], "answers": [{"tags": [], "owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "is_accepted": false, "score": 0, "last_activity_date": 1571764493, "creation_date": 1571764493, "answer_id": 58509319, "question_id": 58509000, "link": "https://stackoverflow.com/questions/58509000/freeze-panes-with-vba/58509319#58509319", "title": "Freeze panes with VBA", "body": "<p>You could do something like this... (See comments for explanation)</p>\n\n<pre><code>' Don't update the screen\nApplication.ScreenUpdating = False\nDim wb As Workbook\nDim ws As worksheet\n' Change this if you aren't using the workbook your code is in\nSet wb = ThisWorkbook\n' Activate the workbook... otherwise you might not be able to activate the sheet\nwb.Activate\n' Save the current sheet\nSet ws = wb.ActiveSheet\n' The sheet to apply FreezePanes to\nwb.Sheets(\"Your Sheet\").Activate\nWith ActiveWindow\n    .FreezePanes = False\n    .SplitColumn = 4\n    .SplitRow = 2\n    .FreezePanes = True\nEnd With\n' Move back to original sheet\nws.Activate\n' Update the screen again\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 1312, "user_id": 9988108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfd8fa67aa26b06219e478858493cf05?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin", "link": "https://stackoverflow.com/users/9988108/agustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571764493, "creation_date": 1571763185, "question_id": 58509000, "link": "https://stackoverflow.com/questions/58509000/freeze-panes-with-vba", "title": "Freeze panes with VBA", "body": "<p>I am able to freeze the first 2 rows and first 4  columns using:</p>\n\n<pre><code>ActiveWindow.FreezePanes = False\nWith ActiveWindow\n    .SplitColumn = 4\n    .SplitRow = 2\n    End With\nActiveWindow.FreezePanes = True\n</code></pre>\n\n<p>However this only seems to work if I am in the sheet I want to freeze. But The Command button is in a different sheet, and I would rather not change it. Is there a way of specifying which sheet I want frozen?\nI would also be happy with freezing all sheets the same way if required.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1571762849, "post_id": 58508845, "comment_id": 103345642, "body": "Using Types is a major pain - you&#39;d be better off making your Type a Class instead."}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1571765201, "post_id": 58509327, "comment_id": 103346709, "body": "I&#39;ve seen people using <code>this</code> before, but didn&#39;t find it as a keyword in VBA. Is it just a coincidence?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 1, "creation_date": 1571765419, "post_id": 58509327, "comment_id": 103346825, "body": "It&#39;s an instance variable. You could name it <code>foo</code> or <code>elephant</code> if you wanted."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571790698, "post_id": 58509327, "comment_id": 103354978, "body": "<code>Me</code> is the VBA equivalent of other languages&#39; <code>this</code>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1571764944, "last_edit_date": 1571764944, "creation_date": 1571764528, "answer_id": 58509327, "question_id": 58508845, "link": "https://stackoverflow.com/questions/58508845/do-i-have-to-use-getters-and-setters-for-a-following-class/58509327#58509327", "title": "Do I have to use getters and setters for a following class?", "body": "<p>A <code>Type</code> is not a class, or an object. It's very little more than a chunk of memory with a specific layout. If you have something you can have an instance of, that you can <code>New</code> up, then you don't want a <code>Type</code>, but a class module. User-defined types have many restrictions that make them rather hard to work with, at least from an OOP perspective.</p>\n\n<p>In this case you want a <code>ValueTagPair</code> or something, might look like this - note how a <code>Private Type</code> can be still be used to hold the instance state under a single private field (<code>this</code>):</p>\n\n<pre><code>Option Explicit\nPrivate Type TPair\n    Value As String \n    Tag As String\nEnd Type\nPrivate this As TPair\n\nPublic Property Get Value() As String\n    Value = this.Value\nEnd Property\n\nPublic Property Let Value(ByVal rhs As String)\n    this.Value = rhs\nEnd Property\n\nPublic Property Get Tag() As String\n    Tag = this.Tag\nEnd Property\n\nPublic Property Let Tag(ByVal rhs As String)\n    this.Tag = rhs\nEnd Property\n</code></pre>\n\n<p>Now you can declare any variable <code>As ValueTagPair</code>, and use it as such - including as the return type of a <code>Property</code> member on another class.</p>\n\n<pre><code>Option Explicit\nPrivate Type TSomething\n    Name As ValueTagPair\n    Id As ValueTagPair\nEnd Type\nPrivate this As TSomething\n\nPublic Property Get Name() As ValueTagPair\n    Set Name = this.Name\nEnd Property\n\nPublic Property Get Id() As ValueTagPair\n    Set Id = this.Id\nEnd Property\n\nPrivate Sub Class_Initialize()\n    Set this.Name = New ValueTagPair\n    Set this.Id = New ValueTagPair\nEnd Sub\n</code></pre>\n\n<p>Now assuming that's a <code>Something</code> class, we can now do this:</p>\n\n<pre><code>Dim thing As Something\nSet thing = New Something\nthing.Name.Tag = \"name-tag\"\nthing.Name.Value = \"name-value\"\nthing.Id.Tag = \"id-tag\"\nthing.Id.Value = \"id-value\"\n</code></pre>\n\n<p>If you need to be able to do <code>Set thing.Name = New ValueTagPair</code>, then you'll have to expose a <code>Public Property Set</code> member for the <code>Name</code> property.</p>\n\n<blockquote>\n  <p><em>Does that mean I have to make getters/setters for every member variable of the class?</em></p>\n</blockquote>\n\n<p>Yes. The public members of a class define that class' interface, and an interface determines how an object can be used. If <code>Class1.Name</code> isn't exposed on the interface of <code>Class1</code>, then it doesn't exist; early-bound usage won't compile, and late-bound member calls (i.e. calls made against <code>Object</code> or <code>Variant</code>) will blow up at run-time with error 438.</p>\n\n<blockquote>\n  <p><em>What if my class is 10 times bigger?</em></p>\n</blockquote>\n\n<p>Then it likely has too many responsibilities. Objects with a clear and well-defined purpose don't typically do 20 things.</p>\n"}], "owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58509327, "answer_count": 1, "score": 1, "last_activity_date": 1571764944, "creation_date": 1571762543, "question_id": 58508845, "link": "https://stackoverflow.com/questions/58508845/do-i-have-to-use-getters-and-setters-for-a-following-class", "title": "Do I have to use getters and setters for a following class?", "body": "<p>So, I need a Class, that has a structure like this:</p>\n\n<pre><code>Obj\n    .Name\n        .value as string\n        .tag as string\n    .Id\n        .value as string\n        .tag as string\n</code></pre>\n\n<p>With those <code>value</code> and <code>tag</code> member variables being accesible from the outside. So I tried to write a class using Types.</p>\n\n<pre><code>'make a \"RefPairType\" Type for value/tag pair \nPublic Type RefPairType\n    value As String\n    tag as String\nEnd Type\n\n'Make member vars of the class based on RefPairType \nPrivate Name As RefPairType\nPrivate Id As RefPairType\n</code></pre>\n\n<p>Obviously, since those members are private I cannot interact with them on the module level. Code on the module level:</p>\n\n<pre><code>Private Sub Document_New()\n    'create an exemplar of aforementioned Class called \"Class1\"\n    Dim client As New Class1\n\n    'try to assign value to the member:\n    client.Name.value = \"foo\"\n    'COMPILE ERROR: method or data member not found\nEnd Sub\n</code></pre>\n\n<p>And if I make those Types or member variables public I get errors: </p>\n\n<pre><code>'Cannot define a public user-defined type within an object module\n</code></pre>\n\n<p>or </p>\n\n<pre><code>'constants, ... user-defined types not allowed as public members of object modules\n</code></pre>\n\n<p>Does that mean I have to make getters/setters for every member variable of the class? What if my class is 10 times bigger? How do I even make getters and setters for a nested member like object.name.tag? </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1571761994, "post_id": 58508581, "comment_id": 103345229, "body": "That makes two of us.  <code>IE.Navigate(url)</code>  then <code>Do While IE.ReadyState &lt;&gt; 4: DoEvents: Loop</code>"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 3, "creation_date": 1571762093, "post_id": 58508581, "comment_id": 103345281, "body": "It literally says in the comment why there are two loops."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1571766954, "post_id": 58508581, "comment_id": 103347467, "body": "Note that <code>Do While IE.ReadyState = 4: DoEvents: Loop</code> is a busy wait, which is usually a bad plan (you can expect CPU usage to spike while loading a web page, which can slow down that load (especially on single-core computers) and cause a battery drain in laptops). Instead, you want to import a sleep function and use it."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1571772779, "last_edit_date": 1571772779, "creation_date": 1571763745, "answer_id": 58509151, "question_id": 58508581, "link": "https://stackoverflow.com/questions/58508581/why-does-ie-object-need-to-be-looped-over/58509151#58509151", "title": "Why does IE object need to be looped over?", "body": "<p>While it's usually not necessary, in some cases running</p>\n\n<pre><code>Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n</code></pre>\n\n<p>by itself will skip the loop altogether because VBA runs the code before the browser has the chance to update the <code>.ReadyState</code> property to from Complete to Loading. When this property isn't changed in time then this line is automatically true and the loop is skipped entirely. By waiting for the change to take place first, you can usually prevent this issue.</p>\n\n<p>So the first line essentially waits for the <code>.ReadyState</code> property to change back to 1 so you do not inadvertently skip the line that really matters, which is the 2nd line that actually waits for your page to load.</p>\n\n<hr>\n\n<p>Take a look at the top portion of <a href=\"https://stackoverflow.com/a/48490013/5781745\">another answer of mine</a>. You should be checking for both the <code>.ReadyState</code> and the <code>.Busy</code> properties, not just one or the other.</p>\n\n<p>So your 2nd line should really look like this:</p>\n\n<pre><code>Do Until IE.ReadyState = 4 And Not IE.Busy: DoEvents: Loop\n</code></pre>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58509151, "answer_count": 1, "score": 1, "last_activity_date": 1571772779, "creation_date": 1571761549, "question_id": 58508581, "link": "https://stackoverflow.com/questions/58508581/why-does-ie-object-need-to-be-looped-over", "title": "Why does IE object need to be looped over?", "body": "<p>I am trying to start IE automation using MS Access and I was going through <a href=\"https://www.automateexcel.com/vba/automate-internet-explorer-ie-using/\" rel=\"nofollow noreferrer\">this</a> tutorial. </p>\n\n<p>I understand that IE ReadyState = 4 means that the webpage has loaded</p>\n\n<p>According to the article:</p>\n\n<blockquote>\n  <p>A very common problem people encounter when working with IE in VBA is\n  VBA attempting to run code before Internet Explorer has fully loaded.\n  By using this code, you tell VBA to repeat a loop until IE is ready\n  (IE.ReadyState \u2013 4).</p>\n</blockquote>\n\n<pre><code>'IE ReadyState = 4 signifies the webpage has loaded (the first loop is set to avoid inadvertently skipping over the second loop)\n    Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n    Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n</code></pre>\n\n<p>I do not understand the importance of do While loop. Why not just do until IE ready state is 4?</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1571760967, "post_id": 58508271, "comment_id": 103344747, "body": "Share the code you&#39;re using and maybe some print screens. otherwise it&#39;s rather difficult to identify what is it making it to crash."}, {"owner": {"reputation": 11, "user_id": 12258427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156701685624109/picture?type=large", "display_name": "Tabitha Murillo", "link": "https://stackoverflow.com/users/12258427/tabitha-murillo"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1571761300, "post_id": 58508271, "comment_id": 103344922, "body": "This the code for my combobox on Sheet1 <code>Private Sub TempCombo_Change()     TempCombo.ListFillRange = &quot;Cities&quot;     Me.TempCombo.DropDown End Sub</code>          The named range &quot;Cities&quot; is defined by formula on sheet 2(&#39;City Data&#39;)            <code>=&#39;City Data&#39;!$L$2:INDEX(&#39;City Data&#39;!$L$2:$L$570,MAX(&#39;City Data&#39;!$K$2:$K565,1))</code>"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1571766988, "post_id": 58508271, "comment_id": 103347480, "body": "@TabithaMurillo welcome to the site!  Sometimes I&#39;ve found the issue is doing too much in the change event, see if this <a href=\"https://stackoverflow.com/questions/42162379/excel-crash-when-trying-to-autocomplete-an-activex-combobox\">answer</a> is any help here."}, {"owner": {"reputation": 11, "user_id": 12258427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156701685624109/picture?type=large", "display_name": "Tabitha Murillo", "link": "https://stackoverflow.com/users/12258427/tabitha-murillo"}, "reply_to_user": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 1, "creation_date": 1571769728, "post_id": 58508271, "comment_id": 103348585, "body": "@JimmySmith  Thank you for the response. I tried adding the <code>.ListFillRange</code> to a Workbook_Open event and it resolved the crashing issue, but now when I type in &quot;sea&quot; into my ComboBox I get the two results (Seaport and Seattle), followed by three blank result lines, and this five line pattern repeats down the scrollbar for about 200 more lines. I don&#39;t understand why moving the range would cause this issue."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1571770649, "post_id": 58508271, "comment_id": 103348952, "body": "Nice, we&#39;re halfway there.  Before you type in the box, does the list have any duplicates at that point?"}, {"owner": {"reputation": 11, "user_id": 12258427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156701685624109/picture?type=large", "display_name": "Tabitha Murillo", "link": "https://stackoverflow.com/users/12258427/tabitha-murillo"}, "edited": false, "score": 0, "creation_date": 1571772696, "post_id": 58508271, "comment_id": 103349796, "body": "No duplicates, no blanks, just the complete list."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1571774734, "post_id": 58508271, "comment_id": 103350590, "body": "That&#39;s bizarre - I don&#39;t think it&#39;s related to moving the code to that event, but something could be firing the _Open more than once.  Do you have any other code that may be affecting how that is populated?"}, {"owner": {"reputation": 11, "user_id": 12258427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156701685624109/picture?type=large", "display_name": "Tabitha Murillo", "link": "https://stackoverflow.com/users/12258427/tabitha-murillo"}, "edited": false, "score": 0, "creation_date": 1571775833, "post_id": 58508271, "comment_id": 103351038, "body": "I don&#39;t have any other VBA code entered. I also encountered this issue when I change the TempCombo event type from _Change() to anything else. My Named range is determined from formulas in 3 helper columns on sheet 2 that narrow down the results list as the user types.  I&#39;m using the process listed on &lt;<a href=\"https://trumpexcel.com/excel-drop-down-list-with-search-suggestions/\" rel=\"nofollow noreferrer\">trumpexcel.com/excel-drop-down-list-with-search-suggestions</a>&zwnj;&#8203;&gt;"}], "owner": {"reputation": 11, "user_id": 12258427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156701685624109/picture?type=large", "display_name": "Tabitha Murillo", "link": "https://stackoverflow.com/users/12258427/tabitha-murillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571766702, "creation_date": 1571760335, "last_edit_date": 1571766702, "question_id": 58508271, "link": "https://stackoverflow.com/questions/58508271/excel-combobox-crashing-with-down-arrow-keystroke", "title": "Excel ComboBox Crashing with down arrow keystroke", "body": "<p>I have created a ComboBox to do a Google-style search of Cities. I have my ComboBox on sheet 1, that is linked to a dynamic range of cities on sheet 2. The ComboBox output cell is what changes the dynamic range. </p>\n\n<p>Here\u2019s the problem I\u2019m having. I start typing \u201csea\u201d and I get two results in my drop down list-seaport and Seattle. So far so good. Then I use the down arrow to Select Seattle and the program crashes and restarts. I believe it is because when I hit down one time, seaport is selected and this narrows down my range to just the one option and Seattle disappears. </p>\n\n<p>Is there any way around this? Either disabling the use of the keyboard down arrows for selections or preventing the output to the linked cell until a selection is finalized?</p>\n\n<p>This the code for my combobox on Sheet1</p>\n\n<pre><code>Private Sub TempCombo_Change()\n   TempCombo.ListFillRange = \"Cities\"\n   Me.TempCombo.DropDown\nEnd Sub\n</code></pre>\n\n<p>The named range \"Cities\" is defined by formula on sheet 2</p>\n\n<pre><code> ='City Data'!$L$2:INDEX('City Data'!$L$2:$L$570,MAX('City Data'!$K$2:$K565,1))\n</code></pre>\n"}]