[{"tags": ["vb.net", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455173377, "post_id": 35328032, "comment_id": 58372885, "body": "StackOverflow is not a code-writing service: please show us what you&#39;ve already tried and detail how it&#39;s not working / at what point you&#39;re stuck. Since you&#39;re relatively new to the site you might also want to take a moment to read the guidelines in the Help Center about what&#39;s expected in a Question."}, {"owner": {"reputation": 487, "user_id": 1602286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05396893155418a0a93052cb05f64a3f?s=128&d=identicon&r=PG", "display_name": "Michael Daniloff", "link": "https://stackoverflow.com/users/1602286/michael-daniloff"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455203253, "post_id": 35328032, "comment_id": 58392899, "body": "@CindyMeister. I probably can do this task in Open XML SDK or XSLT in 10-15 minutes. But so far I haven&#39;t found a way to code it using Object Model API. I tried manipulating ranges, but running into &quot;Cannot edit range&quot;, &quot;cannot delete a range&quot; errors. That&#39;s why I posted the question here."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455475054, "post_id": 35328032, "comment_id": 58494768, "body": "I repeat: Please show us what you&#39;ve tried. And indicate the line that triggers the error. My best guess: your range included the end-of-cell markers."}, {"owner": {"reputation": 487, "user_id": 1602286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05396893155418a0a93052cb05f64a3f?s=128&d=identicon&r=PG", "display_name": "Michael Daniloff", "link": "https://stackoverflow.com/users/1602286/michael-daniloff"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455662299, "post_id": 35328032, "comment_id": 58586890, "body": "@CindyMeister. I just posted the code which I plugged 5 days ago. Once again, I wasn&#39;t  expecting a someone to write the code for me. I was looking for the suggestions on the approach to take."}], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455734199, "post_id": 35444327, "comment_id": 58625552, "body": "So you&#39;re saying this code does what you were asking about? If yes, don&#39;t forget to click the checkmark at the left to mark it as such. I note that the function SelectionInsideContentControl is not included. It would help others who may have a similar question if you would include that. Click &quot;Edit&quot; below the code in order to add it to the &quot;Answer&quot;."}, {"owner": {"reputation": 487, "user_id": 1602286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05396893155418a0a93052cb05f64a3f?s=128&d=identicon&r=PG", "display_name": "Michael Daniloff", "link": "https://stackoverflow.com/users/1602286/michael-daniloff"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456423467, "post_id": 35444327, "comment_id": 58951405, "body": "Thanks. I just added the helper function definition."}], "tags": [], "owner": {"reputation": 487, "user_id": 1602286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05396893155418a0a93052cb05f64a3f?s=128&d=identicon&r=PG", "display_name": "Michael Daniloff", "link": "https://stackoverflow.com/users/1602286/michael-daniloff"}, "is_accepted": true, "score": 2, "last_activity_date": 1456423428, "last_edit_date": 1456423428, "creation_date": 1455662026, "answer_id": 35444327, "question_id": 35328032, "link": "https://stackoverflow.com/questions/35328032/delete-all-text-following-a-tagged-content-control-in-a-table-cell-in-word/35444327#35444327", "title": "Delete all text following a tagged Content control in a table cell in Word", "body": "<p>Here is my final (hopefully) code. </p>\n\n<pre><code>Private Sub CleanupTableCell(range As Word.Range)\n    Dim n As Integer = range.Cells.Count\n    If n &gt; 0 Then\n        range = range.Cells(1).Range\n    End If\n    range.Select()\n    Dim selection As Word.Selection = range.Document.ActiveWindow.Selection\n\n    selection.EndOf(Unit:=Word.WdUnits.wdCell)\n    selection.Bookmarks.Add(\"CellBookmark\")\n    Do While (Not SelectionInsideContentControl(selection))\n        selection.MoveLeft(Unit:=Word.WdUnits.wdCharacter)\n    Loop\n\n    selection.MoveRight(Unit:=Word.WdUnits.wdCharacter, Count := 2)\n    selection.Bookmarks.Add(\"ContentControlBookmark\")\n    Dim delRange As Word.Range = range.Document.Range()\n    delRange.Start = range.Document.Bookmarks(\"ContentControlBookmark\").Range.End\n    delRange.End = range.Document.Bookmarks(\"CellBookmark\").Range.Start\n    delRange.Delete()\n    if range.Document.Bookmarks.Exists(\"CellBookmark\") then\n        range.Document.Bookmarks(\"CellBookmark\").Delete()\n    End If\n    if range.Document.Bookmarks.Exists(\"ContentControlBookmark\") then\n        range.Document.Bookmarks(\"ContentControlBookmark\").Delete()\n    End If\nEnd Sub\n</code></pre>\n\n<p>and here is the definition of the helper function:</p>\n\n<pre><code>Private Function SelectionInsideContentControl(selection As Word.Selection) As Boolean\n\n\nDim controls As Word.ContentControls =   selection.Document.SelectContentControlsByTag(STR_IMergeField &amp; \"CrossComplaintPartyOneType\")\n\n    dim count as Integer = controls.Count\n\n    if count = 0 Then\n        Return False\n    End If\n    Dim control as Word.ContentControl = controls(count)\n    If selection.InRange(control.Range) Then\n        Return True\n    Else \n        Return False\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 1602286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05396893155418a0a93052cb05f64a3f?s=128&d=identicon&r=PG", "display_name": "Michael Daniloff", "link": "https://stackoverflow.com/users/1602286/michael-daniloff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "accepted_answer_id": 35444327, "answer_count": 1, "score": 1, "last_activity_date": 1456423428, "creation_date": 1455146897, "last_edit_date": 1455733976, "question_id": 35328032, "link": "https://stackoverflow.com/questions/35328032/delete-all-text-following-a-tagged-content-control-in-a-table-cell-in-word", "title": "Delete all text following a tagged Content control in a table cell in Word", "body": "<p>Can't figure out how to accomplish this task using Word Object Model API. The code is running inside Microsoft Word Addin written mostly in VB.Net.</p>\n\n<p>Here is the outline of the task in question:</p>\n\n<p>Given a reference to the table cell:</p>\n\n<p>1 find a tagged content control (it's going to be a single instance of that control)</p>\n\n<p>2 Delete all text and new lines after that control.</p>\n\n<p>3 Make sure to preserve (insert) a single new line between that content control and the end of the cell.</p>\n\n<p>Edit: </p>\n\n<pre><code>Sub Macro2()\n  Dim endOfCell As Integer\n  Dim count As Integer\n\n  Selection.EndOf Unit:=wdCell\n  endOfCell = Selection.range.End\n  Do While (Selection.Information(wdInContentControl) = False)\n    Selection.MoveLeft Unit:=wdCharacter\n    count = count + 1\n  Loop\n\n  Selection.MoveRight Unit:=wdCharacter\n  count = count - 1\n  Selection.MoveRight Unit:=wdCharacter, count:=count, Extend:=wdExtend\n  Selection.Delete Unit:=wdCharacter, count:=1\nEnd Sub\n</code></pre>\n\n<p>But unfortunately this code doesn't work when integrated into VB.Net MS Word Addin solution</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 0, "creation_date": 1455151312, "post_id": 35328671, "comment_id": 58365997, "body": "Great. Thank you @Jeeped!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 1, "creation_date": 1455151637, "post_id": 35328671, "comment_id": 58366102, "body": "YW. I don&#39;t really get the down-vote or the VTC. There might be a couple of different ways to improve things but the most obvious to me was the <code>With ... End With</code>. Neither <i>too broad</i> nor <i>opinion based</i> in my estimation."}, {"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 0, "creation_date": 1455277984, "post_id": 35328671, "comment_id": 58429676, "body": "I am now having trouble with arrays :) Found out several examples on the internet, adapted them but none worked for my specific needs"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 0, "creation_date": 1455278232, "post_id": 35328671, "comment_id": 58429852, "body": "I&#39;ll try to keep an eye out for your question."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1455150445, "creation_date": 1455150445, "answer_id": 35328671, "question_id": 35327934, "link": "https://stackoverflow.com/questions/35327934/improve-code-readability-and-speed-in-excel-vba/35328671#35328671", "title": "Improve code readability and speed in Excel VBA", "body": "<p>A <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> serves to provide a single parent worksheet reference that all methods and properties within the With ... End With block can reference with a prefixing period (aka <em>full stop</em>).</p>\n\n<pre><code>With Worksheets(\"MS1\")\n    .Unprotect Password:=\"0123\"\n    .Visible = xlSheetVisible\n    '.OLEObjects(\"label1\").Object.Caption = \"this is label 1\"\n    With .Range(\"A1\")\n        .Value = \"Hello\"\n        .Interior.Color = vbYellow\n    End With\n    .Protect Password:=\"0123\"\n    .Activate   'bring to the foreground\nEnd With\n</code></pre>\n\n<p>This also improves code execution in that the single reference is carried along as opposed to making repeated requests to establish the parent worksheet.</p>\n\n<p>The nested With ... End With statement isolates the next two commands to a single cell. This could be a single cell or a range of cells.</p>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "is_accepted": false, "score": 0, "last_activity_date": 1455291563, "last_edit_date": 1455291563, "creation_date": 1455290992, "answer_id": 35366327, "question_id": 35327934, "link": "https://stackoverflow.com/questions/35327934/improve-code-readability-and-speed-in-excel-vba/35366327#35366327", "title": "Improve code readability and speed in Excel VBA", "body": "<p>The code below solved [problem 2]. Now I can modify several aspects at once and only in chosen worksheets:</p>\n\n<pre><code>Option explicit\n\nSub Testing ()\n\nActiveWorkbook.Unprotect Password:=\"0123\"\n\n  Dim R As Variant\n  Dim CONJ3 As Worksheet\n\n  With Worksheets(\"MS2\")\n    .Unprotect Password:=\"4567\"\n    .Range(\"K12\").Value = R\n    .Protect Password:=\"4567\", UserInterfaceOnly:=True, AllowFiltering:=True\n  End with\n\nFor Each CONJ3 In ActiveWorkbook.Worksheets\n      Select Case CONJ3.Name\n      Case Is = \"Jan \" &amp; R, \"Feb \" &amp; R, \"Mar \" &amp; R, \"Apr \" &amp; R, _\n         \"Mai \" &amp; R, \"Jun \" &amp; R, \"Jul \" &amp; R, \"Aug \" &amp; R, \"Set \" &amp; R, _\n         \"Oct \" &amp; R, \"Nov \" &amp; R, \"Dec \" &amp; R, \"MS3\", \"MS4\", \"MS5\"\n\n  With CONJ3\n    .Unprotect Password:=\"4567\"\n    .Visible = xlSheetVeryHidden\n    .Protect Password:=\"4567\", UserInterfaceOnly:=True, AllowFiltering:=True\n  End With\n\n  Case Else\n  End Select\n  Next CONJ3\n\n ActiveWorkbook.Protect Password:=\"0123\", Structure:=True, Windows:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 35328671, "answer_count": 2, "score": 0, "last_activity_date": 1455291920, "creation_date": 1455146317, "last_edit_date": 1531164843, "question_id": 35327934, "link": "https://stackoverflow.com/questions/35327934/improve-code-readability-and-speed-in-excel-vba", "title": "Improve code readability and speed in Excel VBA", "body": "<p><strong><em>[PROBLEM 1]</em></strong> I have some VBA commands that make sheet named \"MS1\" in Excel perform a series of tasks. Some example below:</p>\n\n<pre><code>Sheets(\"MS1\").Unprotect Password:=\"0123\" \nSheets(\"MS1\").Visible = xlSheetVisible\nSheets(\"MS1\").OLEObjects(\"label1\").Object.Caption = \"this is label 1\"\nSheets(\"MS1\").Select\n    Range(\"A1\").Value = \"Hello\"\nSheets(\"MS1\").Protect Password:=\"0123\"\n</code></pre>\n\n<p><strong>[QUESTION 1]</strong> I would like a more concise code by avoiding the repetition of \"Sheets(\"MS1\")\", so as to improve readability and processing speed. Please, feel free to demonstrate solutions. </p>\n\n<hr>\n\n<p><strong><em>[PROBLEM 2]</em></strong> By exploring code readability ...</p>\n\n<pre><code>    Option explicit\n\n    ActiveWorkbook.Unprotect Password:=\"0123\"\n\n    Dim R As Variant\n    Dim CONJ3 As Variant\n\n   With Worksheets(\"MS2\")\n     .Unprotect Password:=\"4567\"\n     .Range(\"K12\").Value = R\n     .Protect Password:=\"4567\", UserInterfaceOnly:=True, AllowFiltering:=True\n   End with\n\n     CONJ3 = Array(\"Jan \" &amp; R, \"Feb \" &amp; R, \"Mar \" &amp; R, \"Apr \" &amp; R, _\n         \"Mai \" &amp; R, \"Jun \" &amp; R, \"Jul \" &amp; R, \"Aug \" &amp; R, \"Set \" &amp; R, _    \n         \"Oct \" &amp; R, \"Nov \" &amp; R, _\"Dec \" &amp; R, \"MS3\", \"MS4\", \"MS5\")\n\n   With Worksheets(\"CONJ3\")\n     .Unprotect Password:=\"4567\"\n     .Visible = xlSheetVeryHidden\n     .Protect Password:=\"4567\", UserInterfaceOnly:=True, AllowFiltering:=True\n   End With\n</code></pre>\n\n<p><strong>[QUESTION 2]</strong> I have now some issues with run-time error9:subscript out of range (possible array error). How to fix it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1455143952, "creation_date": 1455143952, "answer_id": 35327404, "question_id": 35327157, "link": "https://stackoverflow.com/questions/35327157/avoid-cell-specification-when-moving-across-for-loop/35327404#35327404", "title": "Avoid Cell specification when moving across for loop", "body": "<p>Instead of:</p>\n\n<pre><code>Range(Chr(a + 66) &amp; (l + 299)).Value = Cl\n</code></pre>\n\n<p>use </p>\n\n<pre><code>Cells(l+299, a).Value = Cl\n</code></pre>\n\n<p>In general it's easier to use <code>Cells()</code> with two numeric arguments than to try to create an address string to pass to <code>Range()</code>, particularly if you're working on a single cell.</p>\n"}, {"comments": [{"owner": {"reputation": 303, "user_id": 3604362, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100006517024810/picture?type=large", "display_name": "user3604362", "link": "https://stackoverflow.com/users/3604362/user3604362"}, "edited": false, "score": 0, "creation_date": 1455175423, "post_id": 35327421, "comment_id": 58373853, "body": "I get an error here when using option explicit, since it tells me that val1 is not defined. But am I not defining it right there? Other than that, the tips are very useful, thanks!"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1455144009, "creation_date": 1455144009, "answer_id": 35327421, "question_id": 35327157, "link": "https://stackoverflow.com/questions/35327157/avoid-cell-specification-when-moving-across-for-loop/35327421#35327421", "title": "Avoid Cell specification when moving across for loop", "body": "<p>Just a couple quick things...</p>\n\n<p>Always use <code>Option Explicit</code> in your code modules. It forces you to declare your variables and helps avoid crossing up value types.</p>\n\n<p>Always create a worksheet object, so you can \"guarantee\" which worksheet your code refers. It makes it more clear, especially when you're involving multiple worksheets (maybe not now, but later).</p>\n\n<p>Finally, refer to the values in your table using the <code>Cells(rowindex,columnindex)</code> format. This way you can index rows and columns numerically.</p>\n\n\n\n<pre><code>Option Explicit\n\nsub alpha()\n    Dim ws as Worksheet\n    Dim a as Integer\n    Dim lrow as Integer, lcol as Integer\n    Dim irow as Integer, icol as Integer\n    Dim \n\n    Set ws = Activesheet\n    a = 0\n\n    Val1 = ws.Cells(lrow, lcol).value\nend sub\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 3604362, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100006517024810/picture?type=large", "display_name": "user3604362", "link": "https://stackoverflow.com/users/3604362/user3604362"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 35327404, "answer_count": 2, "score": 1, "last_activity_date": 1455149120, "creation_date": 1455143008, "last_edit_date": 1531164843, "question_id": 35327157, "link": "https://stackoverflow.com/questions/35327157/avoid-cell-specification-when-moving-across-for-loop", "title": "Avoid Cell specification when moving across for loop", "body": "<p>I am trying to use step functions to describe a curve. This is mainly due to other methods not being as precise as this one, in which the data points are connected by a linear relationship. \nI have a table of x-values. Each x-value is taken, and compared to a second table until the following condition is met: </p>\n\n<p>Value2>Value1</p>\n\n<p>Once that is achieved, the second table is used to construct a linear relationship, with which I can accurately calculate the first values actual result, the y-value (assuming y = f(x) ), which is introduced to a last table.</p>\n\n<p>This process has to be repeated then exactly the same way, however the table from which the first value is taken and the table from below which contains the results shifts to the right for every table iteration. </p>\n\n<p>The code I used is as follows:</p>\n\n<pre><code>Sub alpha()\n\n    Dim a As Integer\n    a = 0\nBegin_Count:\n    a = a + 1\n\n\n    Dim l As Integer\n    For l = 1 To 13\n\n       'Check the first value\n        Val1 = Range(Chr(a + 66) &amp; (l + 269))\n\n        'Check the numbers to compare range\n        Dim i As Integer\n        For i = 1 To 12:\n            Val2 = Range(Chr(67) &amp; (i + 284))\n            If Val2 &gt; Val1 = True Then\n\n                'Calculate Cl\n                dy = (Range(\"D\" &amp; (i + 284)) - Range(\"D\" &amp; (i + 283)))\n                dx = (Range(\"C\" &amp; (i + 284)) - Range(\"C\" &amp; (i + 283)))\n                x = (Val1 - Range(\"C\" &amp; (i + 283)))\n                y = Range(\"D\" &amp; (i + 283))\n\n                Cl = ((dy / dx) * x) + y\n\n                'Insert Cl\n                Range(Chr(a + 66) &amp; (l + 299)).Value = Cl\n\n                Exit For\n            End If\n\n\n        Next\n\n\n    Next\n    If a &lt; 101 = True Then\n        GoTo Begin_Count\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This code runs until it reaches the point in which the cells from Excel are labeled \"AA\",\"AB\",etc., at which the code gives an error. </p>\n\n<p>Can anyone help me out with this? </p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1455143929, "post_id": 35326910, "comment_id": 58363343, "body": "Are the column names sufficiently different that one is not a partial match of any other? What is there is a column that is not in your list?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455146517, "post_id": 35326910, "comment_id": 58364417, "body": "Is the order of columns important? - what if all columns are there but in a different order?"}, {"owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455243623, "post_id": 35326910, "comment_id": 58414365, "body": "Order is paramount which is why I have to add these empty columns in their respective spots. Also, there is lots of naming similarity in headers although no exact matches. E.g. &quot;Phone1&quot;&quot;Phone2&quot; &quot;ContactName&quot; &quot;ContactName2&quot; etc"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1455143795, "creation_date": 1455143795, "answer_id": 35327372, "question_id": 35326910, "link": "https://stackoverflow.com/questions/35326910/run-a-loop-to-check-columns-based-on-header-name-and-insert-columns-if-they-are/35327372#35327372", "title": "Run a loop to check columns based on header name, and insert columns if they are missing", "body": "<p>This code will work as standalone to do what you want. You can incorporate into your existing code, or simply add as a separate sub to just do this activity.</p>\n\n<p>It loops through the list backward and adds any missing columns in alphabetical order.</p>\n\n<pre><code>Sub AddMissingColumns()\n\nDim arrColumnList() As String\n\narrColumnList = Split(\"Alpha,Bravo,Charlie,Delta,Echo,Foxtrot,Golf\", \",\")\n\nDim x As Integer\nFor x = UBound(arrColumnList) To LBound(arrColumnList) Step -1\n\n    Dim rngFound As Range\n    Set rngFound = Sheets(\"sheet1\").Rows(1).Find(arrColumnList(x), lookat:=xlWhole)\n\n    If Not rngFound Is Nothing Then\n\n        Dim sLastFound As String\n        sLastFound = arrColumnList(x)\n\n    Else\n\n        If sLastFound = \"\" Then\n            With Sheets(\"Sheet1\")\n                .Range(\"A\" &amp; .Columns.Count).End(xlToLeft).Offset(1).Value = arrColumnList(x)\n            End With\n            sLastFound = arrColumnList(x)\n        Else\n            With Sheets(\"Sheet1\")\n                Dim rCheck As Range\n                Set rCheck = .Rows(1).Find(sLastFound, lookat:=xlWhole)\n                rCheck.EntireColumn.Insert shift:=xlShiftRight\n                rCheck.Offset(, -1).Value = arrColumnList(x)\n                sLastFound = arrColumnList(x)\n            End With\n        End If\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455243770, "post_id": 35328062, "comment_id": 58414405, "body": "This seems like it should work. I did some hard value setting to the columns as a stop gap for now due to time constraints, but it will break if anything else changes in the source files. I will test this implementation though when I get a chance. Thank you."}, {"owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455663372, "post_id": 35328062, "comment_id": 58587360, "body": "This worked perfectly for my needs. At first I thought something was broken and commented to that effect, but realized it was my own issue and deleted that comment. My array is huge, but I have tested on multiple files with consistent results. Thank you very much for your input on this, I don&#39;t know how I would get by without this community!"}, {"owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455927834, "post_id": 35328062, "comment_id": 58725546, "body": "Looks like I ran into a hiccup. The array filter sorting is now partially sorting alphabetically... Where I have columns with similar names &quot;Contact1&quot; &quot;contact1first&quot; &quot;Contact2&quot; etc it has sorted these and subsequent columns to the right alphabetically, but my first few columns are arranged in the array order. I believe this is the risk you mentioned in it not being an exact match, so I assume I need to change this to the Range.Sort method you mentioned. Unfortunately, I&#39;m having trouble finding information on how to use it with my array. Canyou please point me in the right direction? Thanks."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1455147058, "creation_date": 1455147058, "answer_id": 35328062, "question_id": 35326910, "link": "https://stackoverflow.com/questions/35326910/run-a-loop-to-check-columns-based-on-header-name-and-insert-columns-if-they-are/35328062#35328062", "title": "Run a loop to check columns based on header name, and insert columns if they are missing", "body": "<p>The easiest way would be to put any missing columns off the right side and then sort left-to-right (rather than the typical top-to-bottom). However, I'll assume that your column header labels are not like the nice alphabetic ones you've provided so that means a custom sort and you would have to provide all of the column names for that.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/fat7fw0s%28v=vs.90%29.aspx\" rel=\"nofollow\">Array Filter</a> method can quickly determine if you have columns that do not belong however it is a pattern match not an exact match so there is a possibility of false positives. Your own results will depend on the actual names of the columns header labels you use. If this is an inappropriate method then simply loop through each.</p>\n\n<pre><code>Sub fixImportColumns()\n    Dim c As Long, vCOLs As Variant\n\n    vCOLs = Array(\"Alpha\", \"Bravo\", \"Charlie\", \"Delta\", \"Echo\", _\n                  \"Foxtrot\", \"Golf\", \"Hotel\", \"India\", \"Julliet\")\n\n    With Worksheets(\"myImportedCSV\")\n\n        'add non-existent columns from list\n        For c = LBound(vCOLs) To UBound(vCOLs)\n            If IsError(Application.Match(vCOLs(c), .Rows(1), 0)) Then _\n                .Cells(1, Columns.Count).End(xlToLeft).Offset(0, 1) = vCOLs(c)\n        Next c\n\n        With .Cells(1, 1).CurrentRegion\n\n            'get rid of columns not in list (from right-to-left)\n            For c = .Columns.Count To 1 Step -1\n                If UBound(Filter(vCOLs, .Cells(1, c), True, vbTextCompare)) &lt; 0 Then _\n                    .Columns(c).EntireColumn.Delete\n            Next c\n\n            'create a custom list for the sort order\n            Application.AddCustomList ListArray:=vCOLs\n\n            'clear any remembered sort\n            .Parent.Sort.SortFields.Clear\n\n            'sort the columns into the correct order\n            .Cells.Sort Key1:=.Rows(1), Order1:=xlAscending, _\n                        Orientation:=xlLeftToRight, Header:=xlNo, MatchCase:=False, _\n                        OrderCustom:=Application.CustomListCount + 1\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Although not widely used, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow\">Range.Sort method</a> can sort blocks of data from lef-to-right and use a custom list as the sort order.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455244176, "post_id": 35328109, "comment_id": 58414512, "body": "This also looks like it may work for my needs and seems pretty straightforward. I will test in my environment. Thank you."}, {"owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455660359, "post_id": 35328109, "comment_id": 58585961, "body": "Not sure if I made a mistake with this, but after incorporating your code, I lose all of the data in the rows. I end up with just the header row and nothing else."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "edited": false, "score": 0, "creation_date": 1455662329, "post_id": 35328109, "comment_id": 58586896, "body": "I tested my code and it worked OK.  Are all your headers in row 1?  If you put a breakpoint on the line <code>sht.Columns(f.Column).Cut sht.Cells(1, x)</code> does it hit that line?  If not there is some mismatch between the headers in your data and what you&#39;re telling it to look for.  If you can share your workbook I will take a look."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1455149534, "last_edit_date": 1455149534, "creation_date": 1455147342, "answer_id": 35328109, "question_id": 35326910, "link": "https://stackoverflow.com/questions/35326910/run-a-loop-to-check-columns-based-on-header-name-and-insert-columns-if-they-are/35328109#35328109", "title": "Run a loop to check columns based on header name, and insert columns if they are missing", "body": "<p>This should take care of it (assuming duplicate column names are not permitted):</p>\n\n<pre><code>Sub ReorderAddDeleteCols()\n\n    Dim arrCols, x As Long, sht As Worksheet, f As Range, s\n\n    'All the fields you want in the final version (in the order needed)\n    arrCols = Array(\"Col1\", \"Col5\", \"Col2\", \"Col3\", \"Col6\")\n\n    Set sht = ActiveSheet\n\n    'insert enough columns for the required fields\n    sht.Cells(1, 1).Resize(1, UBound(arrCols) + 1).Insert Shift:=xlToRight\n    x = 1\n\n    For Each s In arrCols\n        Set f = sht.Rows(1).Find(What:=s, LookIn:=xlValues, lookat:=xlWhole)\n        If Not f Is Nothing Then\n            'column found, move to required location\n            sht.Columns(f.Column).Cut sht.Cells(1, x)\n        Else\n            'not found - add header\n            sht.Cells(1, x).Value = s\n        End If\n        x = x + 1\n    Next s\n    'delete all other remaining columns (100 just an arbitrary value here...)\n    sht.Cells(1, x).Resize(1, 100).EntireColumn.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4292905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1684c2a1b698cd0251bac86875330d24?s=128&d=identicon&r=PG&f=1", "display_name": "js2Hard", "link": "https://stackoverflow.com/users/4292905/js2hard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2729, "favorite_count": 0, "accepted_answer_id": 35328062, "answer_count": 3, "score": 1, "last_activity_date": 1455739796, "creation_date": 1455142033, "last_edit_date": 1495542200, "question_id": 35326910, "link": "https://stackoverflow.com/questions/35326910/run-a-loop-to-check-columns-based-on-header-name-and-insert-columns-if-they-are", "title": "Run a loop to check columns based on header name, and insert columns if they are missing", "body": "<p>I am new to VBA and have been tasked with creating a macro to clean up and save .csv files. So far I have been able to put together the script from other answered questions here on Stack Overflow, but the final piece is eluding me.</p>\n\n<p>So far I can open, check for columns that need to be deleted, delete them, then save as a new file. What I need to do is check if columns are missing and insert them so that the csv files all consistently have the same header row.</p>\n\n<p>For example:</p>\n\n<p>Let's say that all of the necessary columns  have the first row cell values as \"Alpha\", \"Bravo\", \"Charlie\", \"Delta\", \"Echo\", \"Foxtrot\", \"Golf\"</p>\n\n<p>But sometimes the CSV files we receive only go from \"Alpha\" to \"Echo\"</p>\n\n<p>I need to check for this and then insert the columns \"foxtrot\" and \"Golf\" in their respective order. How would I go about doing this?</p>\n\n<p>It seems like with minor tweaks and a little more code, I can modify my column delete script (which I found <a href=\"https://stackoverflow.com/a/18213842/4292905\">here</a>) to do this.</p>\n\n<pre><code>Dim rngFound As Range\n      Dim rngDel As Range\n      Dim arrColumnNames() As Variant\n      Dim varName As Variant\n      Dim strFirst As String\n\n      arrColumnNames = Array(\"Hotel\",\"India\",\"Julliet\")\n\n      For Each varName In arrColumnNames\n          Set rngFound = Rows(1).Find(varName, Cells(1, Columns.Count), xlValues, xlPart)\n          If Not rngFound Is Nothing Then\n              strFirst = rngFound.Address\n              Do\n                  If rngDel Is Nothing Then Set rngDel = rngFound Else Set rngDel = Union(rngDel, rngFound)\n                  Set rngFound = Rows(1).Find(varName, rngFound, xlValues, xlPart)\n              Loop While rngFound.Address &lt;&gt; strFirst\n          End If\n      Next varName\n\n      If Not rngDel Is Nothing Then rngDel.EntireColumn.Delete\n\n      Set rngFound = Nothing\n      Set rngDel = Nothing\n      Erase arrColumnNames\n</code></pre>\n\n<p>But it's a little beyond me as I've never worked with VBA; can someone provide some direction?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1455142320, "post_id": 35326906, "comment_id": 58362630, "body": "A <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224506(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheet object</a> is not a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">WorksheetFunction object</a>. You cannot <code>Set</code> a var to the Application.WorksheetFunction object."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1455143168, "creation_date": 1455143168, "answer_id": 35327203, "question_id": 35326906, "link": "https://stackoverflow.com/questions/35326906/why-does-vba-say-method-or-data-member-not-found-on-the-initial-sub/35327203#35327203", "title": "Why does VBA say method or data member not found on the initial sub?", "body": "<p>A <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224506(v=office.11).aspx\" rel=\"nofollow\">Worksheet object</a> is not a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a>. You cannot <code>Set</code> a var to the Application.WorksheetFunction object.</p>\n\n<p>Further, you cannot <code>Set</code> the results of  a worksheet function like the <a href=\"https://support.office.com/en-us/article/AVERAGE-function-047BAC88-D466-426C-A32B-8F33EB960CF6\" rel=\"nofollow\">AVERAGE function</a> to an undeclared and unassigned variable; even in reverse.</p>\n\n<p>Your <code>Option Explicit</code> states that all variables must be declared before use yet there are no declarations for the Average, Standard, Min and Max vars. It is also considered bad practise to name your vars the same as VBA or worksheet functions or reserved names.</p>\n\n<pre><code>Private Sub cmdLaunchStats_Click()\n    Dim shtThisSheet As Worksheet\n    Dim dAverage As Double, dStandard As Double\n    Dim dMin As Double, dMax As Double, sStatistics As String\n\n    Set shtThisSheet = Worksheets(\"Sheet1\")\n\n    With shtThisSheet\n        With .Range(\"A1:A100\")\n            dAverage = Application.Average(.Cells)\n            dStandard = Application.StDev(.Cells)\n            dMin = Application.Min(.Cells)\n            dMax = Application.Max(.Cells)\n        End With\n    End With\n    sStatistics = \"average: \" &amp; dAverage &amp; Chr(10) &amp; _\n                  \"standard deviation: \" &amp; dStandard &amp; Chr(10) &amp; _\n                  \"minimum: \" &amp; dMin &amp; Chr(10) &amp; _\n                  \"maximum: \" &amp; dMax\n    MsgBox sStatistics, , False\nEnd Sub\n</code></pre>\n\n<p>While the full <code>Application.WorksheetFunction</code> can be used, typically it is unnecessary. Either <code>Application.Average(...</code> or <code>WorksheetFunction.Average(...</code> is all that is generally necessary.</p>\n"}], "owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455144390, "creation_date": 1455142019, "last_edit_date": 1455144390, "question_id": 35326906, "link": "https://stackoverflow.com/questions/35326906/why-does-vba-say-method-or-data-member-not-found-on-the-initial-sub", "title": "Why does VBA say method or data member not found on the initial sub?", "body": "<p>I have tried enabling solver but that didn't seem to work. The error gets thrown at the very first sub in the code saying \"data member not found\" (Private Sub CmdLaunchStats_Click). I will list my code below.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cmdLaunchStats_Click()\n\nDim shtThisSheet As Worksheet\nSet shtThisSheet = Application.WorksheetFunction\n\nshtThisSheet.Average (\"A1:A100\")\nshtThisSheet.StDev (\"A1:A100\")\nshtThisSheet.Min (\"A1:A100\")\nshtThisSheet.Max (\"A1:A100\")\n\nSet shtThisSheet.Average(\"A1:A100\") = Average\nSet shtThisSheet.StDev(\"A1:A100\") = Standard\nSet shtThisSheet.Min(\"A1:A100\") = Min\nSet shtThisSheet.Max(\"A1:A100\") = Max\n\nMsgBox Statistics, , False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455212925, "post_id": 35327008, "comment_id": 58399971, "body": "Thanks so much for your help. Unfortunately this throws a &#39;type mismatch&#39; error on the line: Set olMail = item"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455213386, "post_id": 35327008, "comment_id": 58400273, "body": "@ChrisWakefield - sorry to hear that. Are you running this directly in Outlook? Did you copy the code exactly as I wrote it? Do you have any other items in the <code>Inbox</code> besides <code>MailItems</code>?I just rested on my end again and it works."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455219775, "post_id": 35327008, "comment_id": 58404370, "body": "Thanks for your reply. I just have emails in the inbox, nothing else is in it. I copied it into a new module in outlook and hit run. Nor sure why the error is coming up if it works for you. I&#39;ll have a play around with it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455219947, "post_id": 35327008, "comment_id": 58404473, "body": "@ChrisWakefield - in <b>Outlook VBE&gt;Tools&gt;References</b> I have the following checked -&gt; <code>1) Visual Basic for Applications 2) Microsoft Outlook 14.0 Object Library 3) OLE Automation 4) Microsoft Office 14.0 Object Library.</code> These are pretty standard, but thought it was worth having you consider / check on yours."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455221264, "post_id": 35327008, "comment_id": 58405224, "body": "Just checked and I have the same as you. Not sure what the eroor could be if it&#39;s working at your end."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455221778, "post_id": 35327008, "comment_id": 58405531, "body": "I&#39;ve found the issue! I do have other items in the mailbox. There are some emails come through from InfoPath forms, and these have a different icon to the mail. I&#39;ve tested your code on a subfolder and it works fine. Do you know how I would get it to count everything in that folder? Thanks again for all your help, I&#39;m very new to this."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455222525, "post_id": 35327008, "comment_id": 58405977, "body": "@ChrisWakefield - see my edit. just pull the <code>ReceivedTime</code> straight from the <code>item</code> object itself. By not defining the <code>item</code> as any particular type any type of item (mail, InfoPath form, calendar item, etc.) will pass through."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455222859, "post_id": 35327008, "comment_id": 58406174, "body": "Thanks for your edits. Unfortunaly the code is now throwing an error &#39;object doesn&#39;t support this property or method&#39; on the line: dRT = item.ReceivedTime. Sorry to be a pain, and thanks for your help"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1455223283, "post_id": 35327008, "comment_id": 58406468, "body": "@ChrisWakefield - what is the item type it fails on? You can use <code>If TypeOf item is MailItem Then</code> to test against items that may fail. It&#39;s possible that <code>ReceivedTime</code> may not be available for all items."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 1, "creation_date": 1455224038, "post_id": 35327008, "comment_id": 58406930, "body": "Thanks for the heads up, the offending items were four read receipts that were in the inbox. I deleted those and it works a charm. Thanks for your patience and your support!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 4, "last_activity_date": 1455222458, "last_edit_date": 1455222458, "creation_date": 1455142464, "answer_id": 35327008, "question_id": 35326813, "link": "https://stackoverflow.com/questions/35326813/using-receivedtime-in-outlook-vba-to-count-yesterdays-mail/35327008#35327008", "title": "Using ReceivedTime in Outlook VBA to count yesterday&#39;s mail", "body": "<p>You almost got it. You basically never set the <code>MailItem</code> nor qualified it to the <code>Item</code>, and since <code>ReceivedTime</code> is Date / Time format, it will never equal a straight <code>Date</code>. </p>\n\n<p>See the code below. I added some features to sort by <code>ReceivedTime</code>, then Exit the loop once it passes yesterday's date. I also cleaned up some of the variable naming so it will not be confused with inherent Outlook Object naming conventions.</p>\n\n<pre><code>Public Sub YesterdayCount()\n\nDim outNS As Outlook.NameSpace\nSet outNS = Application.GetNamespace(\"MAPI\")\n\nDim olFolder As Outlook.Folder\nSet olFolder = outNS.Folders(\"Correspondence Debt Advisor Queries\").Folders(\"Inbox\")\n\nDim olItems As Outlook.Items\nSet olItems = olFolder.Items\n\nolItems.Sort \"[ReceivedTime]\", True\n\nDim yestcount As Integer\nyestcount = 0\n\nDim item As Object\n\nFor Each item In olItems\n\n    'commented code works for MailItems\n    'Dim olMail As Outlook.MailItem\n    'Set olMail = item\n\n    Dim dRT As Date\n    'dRT = olMail.ReceivedTime\n    dRT = item.ReceivedTime\n\n    If dRT &lt; Date And dRT &gt; Date - 2 Then\n        If dRT &lt; Date - 1 Then Exit For\n        yestcount = yestcount + 1\n    End If\n\n\nNext\n\nMsgBox yestcount\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8777, "favorite_count": 0, "accepted_answer_id": 35327008, "answer_count": 1, "score": 2, "last_activity_date": 1455222458, "creation_date": 1455141667, "last_edit_date": 1455151346, "question_id": 35326813, "link": "https://stackoverflow.com/questions/35326813/using-receivedtime-in-outlook-vba-to-count-yesterdays-mail", "title": "Using ReceivedTime in Outlook VBA to count yesterday&#39;s mail", "body": "<p>I want to flash up a message box with the amount of mail received yesterday.</p>\n\n<p>The code I have at the moment is:</p>\n\n<pre><code>Public Sub YesterdayCount()\n\nSet ns = Application.GetNamespace(\"MAPI\")\nSet outApp = CreateObject(\"Outlook.Application\")\nSet outNS = outApp.GetNamespace(\"MAPI\")\n\nDim Items As Outlook.Items\nDim MailItem As Object\n\nDim yestcount As Integer\nyestcount = 0\n\nSet Folder = outNS.Folders(\"Correspondence Debt Advisor Queries\").Folders(\"Inbox\")\nSet Items = Folder.Items\n\nFor Each Item In Items\n    If MailItem.ReceivedTime = (Date - 1) Then\n        yestcount = yestcount + 1\n    End If\nNext\n\nMsgBox yestcount\n\nEnd Sub\n</code></pre>\n\n<p>The problem is with the line:</p>\n\n<pre><code>If MailItem.ReceivedTime = (Date - 1) Then\n</code></pre>\n\n<p>The error says that an object variable is not set, but I can't fathom this after researching.</p>\n"}, {"tags": ["vba", "excel", "command"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455146415, "post_id": 35326595, "comment_id": 58364382, "body": "It won&#39;t ever get past line one because Exit Sub exits out of that sub. It will never go beyond that the way that it&#39;s written so I&#39;m not sure what you mean by &quot;it worked fine&quot;. You also need End If&#39;s for each of your If&#39;s."}, {"owner": {"reputation": 3, "user_id": 5910622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5C2YW2GZsaM/AAAAAAAAAAI/AAAAAAAACrA/DuB6zDDYqxo/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/5910622/sean"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455148182, "post_id": 35326595, "comment_id": 58365009, "body": "I agree with what you say regarding the exit subs. That is what I want it to do. However, when the terms of the firs IF statement are false it should move to the next if statement. It does not do that."}, {"owner": {"reputation": 3, "user_id": 5910622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5C2YW2GZsaM/AAAAAAAAAAI/AAAAAAAACrA/DuB6zDDYqxo/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/5910622/sean"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455148288, "post_id": 35326595, "comment_id": 58365044, "body": "Also, when I put in &quot;End If&quot; statements I get the error: End If without block If."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5910622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5C2YW2GZsaM/AAAAAAAAAAI/AAAAAAAACrA/DuB6zDDYqxo/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/5910622/sean"}, "edited": false, "score": 0, "creation_date": 1455204534, "post_id": 35334373, "comment_id": 58393842, "body": "This seems like it should work however when I type the else statement as you have it shown &quot;ElseIf&quot; I get the error: &quot;Expected: end of statement&quot;. When I put a space between Else and If and have the code run on a new line as you have it shown I get the error: &quot;Else without If&quot;. If I put a space and then put the code into one continuous line I eventually run out of room and I am forced to place the code on the lower line. This repeats the error &quot;Else without If&quot;. So this doesn&#39;t seem to work. Unless I am missing something."}, {"owner": {"reputation": 3, "user_id": 5910622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5C2YW2GZsaM/AAAAAAAAAAI/AAAAAAAACrA/DuB6zDDYqxo/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/5910622/sean"}, "edited": false, "score": 0, "creation_date": 1455205303, "post_id": 35334373, "comment_id": 58394457, "body": "Ignore my previous comment. I was able to get this to work using your suggested solution. Thank you very much!"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1455179819, "creation_date": 1455179819, "answer_id": 35334373, "question_id": 35326595, "link": "https://stackoverflow.com/questions/35326595/command-button-code-stopped-working/35334373#35334373", "title": "Command Button Code stopped working", "body": "<p>I expect your routine should be modified like so:</p>\n\n<pre><code>Private Sub Complete_Enter()\n    If Serial_Number.Value = \"\" Then\n        MsgBox \"Fill in Serial Number\"\n    ElseIf Order_Number.Value = \"\" Then\n        MsgBox \"Fill in Order Number\"\n    ElseIf TextBox1.Value = \"\" Then\n        MsgBox \"Fill in Date\"\n    ElseIf Revision.Value = \"\" Then\n        MsgBox \"Select the correct Revision\"\n    ElseIf Inspector.Value = \"\" Then\n        MsgBox \"Who was the inspector? If it was you,select 'SELF'\"\n    ElseIf Assembler.Value = \"\" Then\n        MsgBox \"Select Your Name as the Assembler\"\n    ElseIf Process_Code.Value = \"\" Then\n        MsgBox \"Select the correct Process Code\"\n    ElseIf OptionButton1.Value = False And OptionButton21.Value = False Then\n        MsgBox \"What is the Status of Step 1\"\n    ElseIf OptionButton2.Value = False And OptionButton12.Value = False Then\n        MsgBox \"What is the Status of Step 2\"\n    ElseIf OptionButton3.Value = False And OptionButton13.Value = False Then\n        MsgBox \"What is the Status of Step 3\"\n    ElseIf OptionButton4.Value = False And OptionButton14.Value = False Then\n        MsgBox \"What is the Status of Step 4\"\n    ElseIf OptionButton5.Value = False And OptionButton15.Value = False Then\n        MsgBox \"What is the Status of Step 5\"\n    ElseIf OptionButton6.Value = False And OptionButton16.Value = False Then\n        MsgBox \"What is the Status of Step 6\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5910622, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5C2YW2GZsaM/AAAAAAAAAAI/AAAAAAAACrA/DuB6zDDYqxo/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/5910622/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 35334373, "answer_count": 1, "score": 0, "last_activity_date": 1455179819, "creation_date": 1455140866, "last_edit_date": 1531164843, "question_id": 35326595, "link": "https://stackoverflow.com/questions/35326595/command-button-code-stopped-working", "title": "Command Button Code stopped working", "body": "<p>I was using this user form code yesterday and everything worked fine. Today, nothing is working. When my command button \"Complete\" is clicked, the code should verify that the user form is complete (Complete_Enter()) and then transfer the information from the userform to my worksheet. This all worked perfectly yesterday and today it does not. Instead when I click complete, VBA only runs the first line under the Complete_Enter() sub. Here is the code:</p>\n\n<pre><code>Private Sub ConnectorCoverProductionForm_Initialize()\n\n'Empty Serial_NumberTextBox\nSerial_Number.Value = \"\"\nSerial_Number.SetFocus\n\n'Empty Order_NumberTextBox\nOrder_Number.Value = \"\"\n\n'Empty DateTextBox\nTextBox1.Value = \"\"\n\nInspector.Clear\nAssembler.Clear\nProcess_Code.Clear\n\n'Uncheck OptionButton\nOptionButton1.Value = False\nOptionButton2.Value = False\nOptionButton3.Value = False\nOptionButton4.Value = False\nOptionButton5.Value = False\nOptionButton6.Value = False\nOptionButton21.Value = False\nOptionButton12.Value = False\nOptionButton13.Value = False\nOptionButton14.Value = False\nOptionButton15.Value = False\nOptionButton16.Value = False\n\n\nEnd Sub\nPrivate Sub Assembler_DropButtonClick()\nAssembler.List = Array(\"Trung\", \"Jesus\", \"Khoi\", \"Josie\", \"Omi\")\nEnd Sub\nPrivate Sub ClearALL_Click()\n\nCall ConnectorCoverProductionForm_Initialize\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nShell (\"Explorer \\\\PC148\\Assembly Group\\Traveler \nEnd Sub\nPrivate Sub CommandButton2_Click()\nShell (\"Explorer \\\\PC148\\Assembly Group\\Traveler               \nEnd Sub\n\nPrivate Sub CommandButton3_Click()\nShell (\"Explorer \\\\PC148\\Assembly Group\\Traveler Templates\\Videos\\Edited\\Mag \nEnd Sub\n\nPrivate Sub CommandButton4_Click()\nShell (\"Explorer \\\\PC148\\Assembly Group\\Traveler Templates\\Videos\\Edited\\Mag \nEnd Sub\n\nPrivate Sub Complete_Click()\n\nDim emptyRow As Long\n\nSheet1.Activate\n\nemptyRow = WorksheetFunction.CountA(Range(\"C:C\")) + 1\n\nCells(emptyRow, 3).Value = Serial_Number.Value\nCells(emptyRow, 4).Value = Order_Number.Value\nCells(emptyRow, 5).Value = TextBox1.Value\nCells(emptyRow, 6).Value = Revision.Value\nCells(emptyRow, 7).Value = Inspector.Value\nCells(emptyRow, 8).Value = Assembler.Value\nCells(emptyRow, 9).Value = Process_Code.Value\nIf OptionButton1.Value = True Then Cells(emptyRow, 10).Value =         OptionButton1.Caption\nIf OptionButton21.Value = True Then Cells(emptyRow, 10).Value = OptionButton21.Caption\nIf OptionButton2.Value = True Then Cells(emptyRow, 11).Value = OptionButton2.Caption\nIf OptionButton12.Value = True Then Cells(emptyRow, 11).Value = OptionButton12.Caption\nIf OptionButton3.Value = True Then Cells(emptyRow, 12).Value = OptionButton3.Caption\nIf OptionButton13.Value = True Then Cells(emptyRow, 12).Value = OptionButton13.Caption\nIf OptionButton4.Value = True Then Cells(emptyRow, 13).Value = OptionButton4.Caption\nIf OptionButton14.Value = True Then Cells(emptyRow, 13).Value = OptionButton14.Caption\nIf OptionButton5.Value = True Then Cells(emptyRow, 14).Value = OptionButton5.Caption\nIf OptionButton15.Value = True Then Cells(emptyRow, 14).Value = OptionButton15.Caption\nIf OptionButton6.Value = True Then Cells(emptyRow, 15).Value = OptionButton6.Caption\nIf OptionButton16.Value = True Then Cells(emptyRow, 15).Value = OptionButton16.Caption\n\nEnd Sub\n\nPrivate Sub Complete_Enter()\n\nIf Serial_Number.Value = \"\" Then MsgBox \"Fill in Serial Number\"\nExit Sub\n\nIf Order_Number.Value = \"\" Then MsgBox \"Fill in Order Number\"\nExit Sub\n\nIf TextBox1.Value = \"\" Then MsgBox \"Fill in Date\"\nExit Sub\nIf Revision.Value = \"\" Then MsgBox \"Select the correct Revision\"\nExit Sub\nIf Inspector.Value = \"\" Then MsgBox \"Who was the inspector? If it was you,select 'SELF'\"\nExit Sub\nIf Assembler.Value = \"\" Then MsgBox \"Select Your Name as the Assembler\"\nExit Sub\nIf Process_Code.Value = \"\" Then MsgBox \"Select the correct Process Code\"\nExit Sub\nIf OptionButton1.Value = False And OptionButton21.Value = False Then MsgBox \"What is the Status of Step 1\"\nExit Sub\nIf OptionButton2.Value = False And OptionButton12.Value = False Then MsgBox \"What is the Status of Step 2\"\nExit Sub\nIf OptionButton3.Value = False And OptionButton13.Value = False Then MsgBox \"What is the Status of Step 3\"\nExit Sub\nIf OptionButton4.Value = False And OptionButton14.Value = False Then MsgBox \"What is the Status of Step 4\"\nExit Sub\nIf OptionButton5.Value = False And OptionButton15.Value = False Then MsgBox \"What is the Status of Step 5\"\nExit Sub\nIf OptionButton6.Value = False And OptionButton16.Value = False Then MsgBox \"What is the Status of Step 6\"\nExit Sub\n\n\nEnd Sub\n\nPrivate Sub Inspector_DropButtonClick()\nInspector.List = Array(\"Tom\", \"Tre\", \"Omi\", \"Self\")\nEnd Sub\n\nPrivate Sub Process_Code_DropButtonClick()\nProcess_Code.List = [index(12*(row(1:12)-1),)]\nEnd Sub\nPrivate Sub Revision_DropButtonClick()\nRevision.List = [index(char(64+row(1:26)),)]\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "null", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1455198540, "post_id": 35326571, "comment_id": 58389332, "body": "For speed, it&#39;s all relative. Does it take 10 secs, 30 secs, 1 min? And how is your connection set up? Does query run as long in Access? What are its size, indices, structure? Also, Date is a reserved Access word, consider escaping with brackets: <code>[Date]</code>."}, {"owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1455216692, "post_id": 35326571, "comment_id": 58402460, "body": "Adding an index did speed things up considerably"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "edited": false, "score": 0, "creation_date": 1455213073, "post_id": 35341058, "comment_id": 58400057, "body": "AccessRS.RecordCount returns a value of &#39;-1&#39;. That means ADO cannot determine the number of records or if the provider or cursor type does not support RecordCount. Any way to get around this? <a href=\"https://msdn.microsoft.com/en-us/library/ms676701(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms676701(v=vs.85).aspx</a>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "edited": false, "score": 0, "creation_date": 1455228361, "post_id": 35341058, "comment_id": 58409257, "body": "Whoops, missed that you are running <a href=\"https://msdn.microsoft.com/en-us/library/ms675023%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">ADO execute</a> instead of <a href=\"https://msdn.microsoft.com/en-us/library/ms675544%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">ADO open</a> recordset method. The former&#39;s recordset is slightly limited being a read-only, forward-only cursor. I updated for the latter which has RecordCount available."}, {"owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "edited": false, "score": 0, "creation_date": 1455302149, "post_id": 35341058, "comment_id": 58445565, "body": "Works perfectly! Thanks again. I just had to add the CN to the RS.Open string: AccessRS.Open strSql, AccessCN"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1455228248, "last_edit_date": 1455228248, "creation_date": 1455198338, "answer_id": 35341058, "question_id": 35326571, "link": "https://stackoverflow.com/questions/35326571/query-ms-access-db-from-excel-vba-how-to-return-0-if-no-value-found/35341058#35341058", "title": "Query MS Access DB from Excel VBA - How to return 0 if no value found?", "body": "<p>Consider conditionally wrapping recordset by <a href=\"https://msdn.microsoft.com/en-us/library/ms676701(v=vs.85).aspx\" rel=\"nofollow\">recordcount</a> property during field retrieval:</p>\n\n<pre><code>Dim AccessCN As Object, AccessRS As Object\n\nSet AccessCN = CreateObject(\"ADODB.Connection\")\nSet AccessRS = CreateObject(\"ADODB.Recordset\")\n\nAccessCN.Open \"DRIVER=Microsoft Access Driver (*.mdb, *.accdb);\" _\n                &amp; \"DBQ=C:\\Path\\To\\Database\\File.accdb;\"\nAccessRS.Open \"SELECT Date FROM AccessDB WHERE Date = #\" &amp; MyDate &amp; \"#\", AccessCN\n\nIf AccessRS.RecordCount &gt; 0 Then\n     CheckIfDateExistInDB = AccessRS.Fields(0)\nElse\n     CheckIfDateExistInDB = 0\nEnd If\n\nAccessRS.Close\n\nSet AccessRS = Nothing\nSet AccessCN = Nothing\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 35341058, "answer_count": 1, "score": 0, "last_activity_date": 1455228248, "creation_date": 1455140782, "last_edit_date": 1531164843, "question_id": 35326571, "link": "https://stackoverflow.com/questions/35326571/query-ms-access-db-from-excel-vba-how-to-return-0-if-no-value-found", "title": "Query MS Access DB from Excel VBA - How to return 0 if no value found?", "body": "<p>I'm querying an MS Access database from within excel VBA. I need it to return 0 in excel if no record exists in the DB. This is my code:</p>\n\n<pre><code>Function CheckIfDateExistInDB(MyDate As Date) As Date\nDim strSql As String\n\nstrSql = \"SELECT Date FROM AccessDB WHERE Date = #\" &amp; MyDate &amp; \"#\"\n\nSet AccessRS = AccessCN.Execute(strSql)\nCheckIfDateExistInDB = AccessRS.Fields(0)\nSet AccessRS = Nothing\nEnd Function\n</code></pre>\n\n<p>Please help -\n1) This code returns \"#VALUE!\" in excel if the record does not exist in the DB.\n2) If the record does not exist, this query takes a LONG time to run.\n3) I need the code to return 0 if no record exists (and speed it up).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 751, "user_id": 4433555, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8jspF.png?s=128&g=1", "display_name": "etalon11", "link": "https://stackoverflow.com/users/4433555/etalon11"}, "edited": false, "score": 1, "creation_date": 1455140593, "post_id": 35326268, "comment_id": 58361825, "body": "Wscript is not a object you declared. What are you trying to achieve?"}, {"owner": {"reputation": 31, "user_id": 5806569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ae7cba6a0635408c444a01d699cc86?s=128&d=identicon&r=PG&f=1", "display_name": "Danish Shahid", "link": "https://stackoverflow.com/users/5806569/danish-shahid"}, "reply_to_user": {"reputation": 751, "user_id": 4433555, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8jspF.png?s=128&g=1", "display_name": "etalon11", "link": "https://stackoverflow.com/users/4433555/etalon11"}, "edited": false, "score": 0, "creation_date": 1455200563, "post_id": 35326268, "comment_id": 58390842, "body": "I am trying to telnet to the desired ip and port and send some commands. How would you declare it then?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6567142, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8861c9b405baef0dd31013b884702f76?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/6567142/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1468014302, "last_edit_date": 1468014302, "creation_date": 1468013998, "answer_id": 38275769, "question_id": 35326268, "link": "https://stackoverflow.com/questions/35326268/telnet-script-error-in-vba/38275769#38275769", "title": "telnet script error in vba", "body": "<p>The generic way to declare an object like WScript is</p>\n\n<pre><code>Dim WshShell As Object\n\nset WshShell=CreateObject(\"WScript.Shell\")\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5806569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ae7cba6a0635408c444a01d699cc86?s=128&d=identicon&r=PG&f=1", "display_name": "Danish Shahid", "link": "https://stackoverflow.com/users/5806569/danish-shahid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468014302, "creation_date": 1455139597, "question_id": 35326268, "link": "https://stackoverflow.com/questions/35326268/telnet-script-error-in-vba", "title": "telnet script error in vba", "body": "<p>So I am writing a script in vba to perform telnet and following is part of the code. </p>\n\n<pre><code>Dim vPath As String\nDim vFile As String\nDim vFTPServ As String\nDim ServSlot As String\nDim fNum As Long\n\n\n\n vPath = Application.InputBox(\"Enter the File Directory\")\n vFile = Application.InputBox(\"Enter the File Name\")\n vFTPServ = Application.InputBox(\"Enter the IP Address\")\n ServSlot = Application.InputBox(\"Enter the slot #\")\n\n\n\n Dim WshShell As Object\n Set WshShell = CreateObject(\"WScript.Shell\")\n WshShell.Run \"cmd.exe\"\n WScript.Sleep 1000\n</code></pre>\n\n<p>it seems as the code works fine till the cmd.exe and then displays the runtime error \"424\" - object required. for the Wscript.sleep 1000 line. </p>\n\n<p>Any kind of help will be much appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455140745, "post_id": 35326128, "comment_id": 58361902, "body": "Welcome to SO. Do you just want a list of individuals with blank cells and how many blanks they have? And by cells do you mean how many rows of data that are blank? Or many blank cells are in the entire column/row set for a given name? <i>(btw - I removed the <code>ActiveWindow.Scroll</code>&#39;s from your code since they are, most likely, unnecessary outputs from the recorder)</i>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455141118, "post_id": 35326128, "comment_id": 58362084, "body": "here is a <b>array</b> formula that will work. I based it on your code ranges, but adjust as needed: <code>=COUNT(IF(G3:G26=Z3,IF(ISBLANK(A3:A26),1,0)))</code> - *be sure to <b>Ctrl + Shift + Enter</b> instead of just <b>Enter</b> when exiting cell edit mode. Then drag down your set of unique names listed in say, column Z."}, {"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455202175, "post_id": 35326128, "comment_id": 58392069, "body": "I want to know number of blank cells per each user  (not rows) when they run a macro"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455203104, "post_id": 35326128, "comment_id": 58392785, "body": "then adjust the <code>A3:A26</code> range to be <code>A3:W26</code>. If you want it to be in VBA. You can wrap it in a Evaluate statement."}, {"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455553331, "post_id": 35326128, "comment_id": 58529171, "body": "Hi Scott , in the above code mycount = Application.WorksheetFunction.CountBlank(ActiveSheet.Range(&quot;&zwnj;&#8203;$A$3:$W$26&quot;)) how do i put in the criteria selection say in this case John Doe is the criteria and I want to know how many blank cells he has"}, {"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455555040, "post_id": 35326128, "comment_id": 58530398, "body": "=COUNT(IF(G3:G26=Z3,IF(ISBLANK(A3:A26),1,0)))  is showing as an error"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "edited": false, "score": 0, "creation_date": 1455556854, "post_id": 35326705, "comment_id": 58531495, "body": "Hi when I run the above code it is showing as object doesnt support this property or method . I did include the Range.Resize property"}, {"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "edited": false, "score": 0, "creation_date": 1455558038, "post_id": 35326705, "comment_id": 58532181, "body": "If .AutoFilterMode Then .AutoFilterMode = False"}, {"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "edited": false, "score": 0, "creation_date": 1455558240, "post_id": 35326705, "comment_id": 58532313, "body": "Also I need to know only the number of blank cells after filtering the data"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "edited": false, "score": 0, "creation_date": 1455558635, "post_id": 35326705, "comment_id": 58532553, "body": "Don&#39;t know what I can offer. The <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.autofiltermode.aspx\" rel=\"nofollow noreferrer\">Worksheet.AutoFilterMode</a> property has been around since at least xl2003. What did you change?"}, {"owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "edited": false, "score": 0, "creation_date": 1456161071, "post_id": 35326705, "comment_id": 58807588, "body": "I didnt change anything ..your code did work without the offset .. is still need to know the number of blank cells after applying filters against each individual person suppose &quot;John Doe&quot; , &quot;Tom Harris&quot; etc"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1455141957, "last_edit_date": 1495541251, "creation_date": 1455141203, "answer_id": 35326705, "question_id": 35326128, "link": "https://stackoverflow.com/questions/35326128/to-display-number-of-blank-cells-from-a-range-by-using-filters/35326705#35326705", "title": "To display number of blank cells from a range by using filters", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a> with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow noreferrer\">xlCellTypeVisible property</a> to isolate the cells left visible by the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844.aspx\" rel=\"nofollow noreferrer\">AutoFilter method</a>.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> statement can help you reference specific areas within your workbook without resorting to <code>.Select</code>\u00b9 and <code>.Activate</code>\u00b9.</p>\n\n<pre><code>Sub Displayblanks_John_Doe()\n    ' Displayblanks_John_Doe Macro\n    ' Keyboard Shortcut: Ctrl+Shift+J\n    Dim mycount As Long\n\n    With Worksheets(\"Sheet1\")   'you should know what worksheet you are on\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Range(\"A3:L26,N3:N26,R3:R26,W3:W26\")\n            .FormatConditions.Add Type:=xlExpression, Formula1:=\"=LEN(TRIM(A3))=0\"\n            With .FormatConditions(.FormatConditions.Count)\n                .Interior.Pattern = xlGray8\n                .StopIfTrue = False\n                .SetFirstPriority\n            End With\n        End With\n        With .Range(\"A3:W26\")\n            .AutoFilter Field:=7, Criteria1:=\"John Doe\"\n            'there has to be visible cells because we haven't excluded the header row yet\n            With Intersect(.SpecialCells(xlCellTypeVisible), _\n                           .SpecialCells(xlCellTypeBlanks))\n                mycount = .Cells.Count\n                MsgBox mycount\n            End With\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The above code counts visible cells that are truly blank; not cells that could be zero-length strings returned by formulas (e.g. <code>\"\"</code> ).</p>\n\n<p>I realize that your code is not finished yet; simply because it doesn't actually do anything but report teh number of blank visible cells. One of the first steps would be to find the last populated cell in column G and use that as the extent of the filter range. A quick method of accomplishing this is to reference the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a> is a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> as soon as you've referenced the worksheet; e.g.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")   'you should know what worksheet you are on\n    With .Cells(1, 1).CurrentRegion\n        'do all of your work here\n    End With\nEnd With\n</code></pre>\n\n<p>This may not be appropriate for your particular situation as you wish to start at row 3 but the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa176182%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Range.Resize property</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow noreferrer\">Range.Offset property</a> can take care of this.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")   'you should know what worksheet you are on\n    With .Cells(1, 1).CurrentRegion\n        With .Resize(.Rows.Count - 2, .Columns.Count).Offset(2, 0)\n            'do all of your work here\n        End With\n    End With\nEnd With\n</code></pre>\n\n<p>Recorded macro code is a good place to start but you will quickly find that it is very verbose and often records actions that are not desired. Get used to cleaning your code up after a macro recording session and you will soon find that you are writing the code from scratch.</p>\n\n<hr>\n\n<p>\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 5843682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fee77b129d9096d3bdee272fc6efb3?s=128&d=identicon&r=PG&f=1", "display_name": "sharon gorikapudi", "link": "https://stackoverflow.com/users/5843682/sharon-gorikapudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498595302, "creation_date": 1455139212, "last_edit_date": 1498595302, "question_id": 35326128, "link": "https://stackoverflow.com/questions/35326128/to-display-number-of-blank-cells-from-a-range-by-using-filters", "title": "To display number of blank cells from a range by using filters", "body": "<p>I used conditional formatting to display blank cells and created macros by filtering  by name of every  individual who has blanks on the worksheet. Now I need to display the number of blank cells for each individual. How do I go about it .</p>\n\n<pre><code>Sub Displayblanks_John_Doe()\n '\n' Displayblanks_John_Doe Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+J\n'\nRange(\"A3:L26\").Select\nRange(\"A3:L26,N3:N26\").Select\nRange(\"N3\").Activate\nRange(\"A3:L26,N3:N26,R3:R26\").Select\nRange(\"R3\").Activate\nRange(\"A3:L26,N3:N26,R3:R26,W3:W26\").Select\nRange(\"W3\").Activate\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=LEN(TRIM(A3))=0\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlGray8\n    .PatternColorIndex = xlAutomatic\n    .ColorIndex = xlAutomatic\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\nActiveSheet.Range(\"$A$3:$W$26\").AutoFilter Field:=7, Criteria1:= _\n    \"John Doe\"\n    Dim mycount As Long\n    mycount = Application.WorksheetFunction.CountBlank(ActiveSheet.Range(\"$A$3:$W$26\"))\n    MsgBox mycount\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "function", "import", "reference"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1455138013, "post_id": 35325769, "comment_id": 58360421, "body": "<code>WorksheetFunction.SQRT()</code> or just <code>Sqr()</code>.  See <a href=\"http://www.techonthenet.com/excel/formulas/sqr.php\" rel=\"nofollow noreferrer\">HERE</a>"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 2, "creation_date": 1455139262, "post_id": 35325769, "comment_id": 58361101, "body": "Being a self-taught vba noob I&#39;ve found google to be very useful. In my case I googled &quot;Square root vba&quot; and got the very page that scott has linked for you."}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 0, "last_activity_date": 1455139260, "creation_date": 1455139260, "answer_id": 35326145, "question_id": 35325769, "link": "https://stackoverflow.com/questions/35325769/importing-excel-function-into-my-module/35326145#35326145", "title": "Importing Excel function into my module", "body": "<p>this will return a square root:</p>\n\n<pre><code>MsgBox 4 ^ (1 / 2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1455142082, "creation_date": 1455142082, "answer_id": 35326922, "question_id": 35325769, "link": "https://stackoverflow.com/questions/35325769/importing-excel-function-into-my-module/35326922#35326922", "title": "Importing Excel function into my module", "body": "<p>Here is my answer, \nHoping this helps. </p>\n\n<pre><code>Function myFunction(rng As Range) As Double\n    Dim i As Double\n    i = rng.Value\n    myFunction = Sqr(i)\n    'this function returns the square root of the value of i\nEnd Function\n</code></pre>\n\n<p>With a search and no effort <a href=\"https://www.google.com/search?q=how%20to%20use%20sqrt%20into%20vba%20macro%20excel&amp;oq=how%20to%20use%20sqrt%20into%20vba%20macro%20excel%20&amp;aqs=chrome..69i57.8359j0j4&amp;sourceid=chrome&amp;es_sm=122&amp;ie=UTF-8\" rel=\"nofollow\">Google show me</a> this</p>\n\n<p>1: <a href=\"http://www.techonthenet.com/excel/formulas/sqr.php\" rel=\"nofollow\">MS Excel: How to use the SQR Function (WS)</a></p>\n\n<p>2: <a href=\"http://www.mrexcel.com/forum/excel-questions/648601-create-squareroot-function-visual-basic-applications.html\" rel=\"nofollow\">Create SquareRoot Function in VBA - MrExcel.com</a></p>\n\n<p>And many more. </p>\n"}], "owner": {"reputation": 1, "user_id": 5673616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6RSU.jpg?s=128&g=1", "display_name": "Brian R.", "link": "https://stackoverflow.com/users/5673616/brian-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455142082, "creation_date": 1455137900, "question_id": 35325769, "link": "https://stackoverflow.com/questions/35325769/importing-excel-function-into-my-module", "title": "Importing Excel function into my module", "body": "<p>I'm working in VBA, Excel specifically, and trying to use the SQRT (square root) function.  I'm writing a module but don't know how to do import the SQRT function so my function can use it.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1455137079, "post_id": 35325497, "comment_id": 58359908, "body": "lol so you have <a href=\"http://stackoverflow.com/questions/35324010/how-to-copy-down-formula-in-excel-to-last-cell-with-data-in-vba/35324103#35324103\">two accounts</a>? Also, I figured it was obvious but all you had to do was substitute <code>lastrow</code> everywhere you have <code>G55</code>. Edit: forgot rest of your code was recorded not object driven. You can&#39;t sort a worksheet. Only a range."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1455137862, "post_id": 35325497, "comment_id": 58360337, "body": "I do unfortunately because I have been getting blasted for not being able to do anything right when it comes to code so I had to create another account so people would not shame me consistently"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1455138349, "post_id": 35325497, "comment_id": 58360595, "body": "You have 95 points so at some point you were doing something right. That said, it doesn&#39;t appear you put in much effort here XD As I said, you can&#39;t sort a sheet, only <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\">range</a> and your syntax appears to be bad <code>Sort.SortFields.</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1455138472, "post_id": 35325497, "comment_id": 58360661, "body": "What @findwindow is trying to say is replace both <code>ws.Sort</code> with <code>ws.Columns(&quot;A:G&quot;).Sort</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1455138712, "post_id": 35325497, "comment_id": 58360780, "body": ":/ Let&#39;s hope so! Edit: you better not go on vacation =P"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455194394, "creation_date": 1455136952, "last_edit_date": 1531164843, "question_id": 35325497, "link": "https://stackoverflow.com/questions/35325497/method-of-range-error-when-sorting", "title": "Method of range error when sorting", "body": "<p>I am creating a code that copies down a formula in column g and then sorts column g in ascending order. I am receiving a method of range error on the part of my code that is selecting columns a:g to sort. I have provided the code I have below. All help is appreciated!</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub Sorting()\nDim ws As Worksheet\nSet ws = Worksheets(\"FedEx Air Ops Workbench Report\")\nlastrow = ws.Cells(ws.Rows.Count, \"E\").End(xlUp).Row\nDebug.Print lastrow\nws.Range(\"G1\").FormulaR1C1 = \"=VLOOKUP(RC[-2],BUTTONS!R2C9:R6C10,2,FALSE)\"\nws.Range(\"G1\").AutoFill Destination:=ws.Range(\"G1:G\" &amp; lastrow), Type:=xlFillDefault\nWith ws.Columns(\"A:G\").Sort\n    .SetRange ws.Range(\"A1:G\" &amp; lastrow)\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1455137508, "post_id": 35325050, "comment_id": 58360135, "body": "You&#39;ve definitely been here long enough to know you have to show effort."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1455139456, "post_id": 35325050, "comment_id": 58361193, "body": "One way to do it would be to look at this page about how to create a hyperlink to a worksheet, then create a macro that loops through all the values in column B that says if Worksheets(cells(i, 2).Value) exists, create the hyperlink <a href=\"http://stackoverflow.com/questions/9813488/excel-vba-create-hyperlink-to-another-sheet\" title=\"excel vba create hyperlink to another sheet\">stackoverflow.com/questions/9813488/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 3, "last_activity_date": 1455144017, "creation_date": 1455144017, "answer_id": 35327423, "question_id": 35325050, "link": "https://stackoverflow.com/questions/35325050/excel-vba-assign-hyperlink-to-a-cell/35327423#35327423", "title": "Excel VBA assign hyperlink to a cell", "body": "<p>Here's a sample of how to do that: </p>\n\n<pre><code>Sub createLink()\nDim lastRow As Integer, sheetCount As Integer, myRange As Excel.Range, c As Excel.Range\nlastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nsheetCount = Application.Sheets.Count\nSet myRange = Excel.ThisWorkbook.Sheets(\"Sheet1\").Range(\"B1:B\" &amp; lastRow)\n\nFor Each c In myRange\n    For x = 1 To sheetCount\n        If Worksheets(x).Name = c.Value Then\n             Excel.ThisWorkbook.Sheets(\"Sheet1\").Hyperlinks.Add Anchor:=c, Address:=\"\", SubAddress:=c.Value &amp; \"!A1\"\n        End If\n    Next x\nNext c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 1664305, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7eecf5f38fc79539ed5ddfd9fed36615?s=128&d=identicon&r=PG", "display_name": "user1664305", "link": "https://stackoverflow.com/users/1664305/user1664305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2846, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1455144017, "creation_date": 1455135437, "last_edit_date": 1455135938, "question_id": 35325050, "link": "https://stackoverflow.com/questions/35325050/excel-vba-assign-hyperlink-to-a-cell", "title": "Excel VBA assign hyperlink to a cell", "body": "<p>Currently I have VBA macro that will generate a page based on some information that I key into cell T3 on an overview page. What I would like to do is to have the same 'create page' button also automatically assign a hyperlink based on the value.</p>\n\n<p>For instance, if I put brownj1 into cell t3, a page will be created and named 'brownj1', what I would also like the macro to achieve is to assign cell 'b3' which also has the name 'brownj1' to the newly created page. Another way I think would probably be a better way around it would be to search/loop through column B to locate the matching cell to T3 and then assign the hyperlink.</p>\n\n<p>As I mentioned I already have the necessary code to generate the page and assign the name as the sheet name and all I am looking for is a formula to assign a hyperlink to a specific name as the page is being generated.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "is_accepted": false, "score": 5, "last_activity_date": 1455135524, "creation_date": 1455135524, "answer_id": 35325079, "question_id": 35325028, "link": "https://stackoverflow.com/questions/35325028/what-is-wrong-with-this-message-box/35325079#35325079", "title": "What is wrong with this message box?", "body": "<p>You forgot the <code>&amp;</code> operator between the last two components:</p>\n\n<pre><code>tripCost _\n\" for gas\"\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>tripCost &amp; _\n\" for gas\"\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533727053, "creation_date": 1455135365, "last_edit_date": 1533727053, "question_id": 35325028, "link": "https://stackoverflow.com/questions/35325028/what-is-wrong-with-this-message-box", "title": "What is wrong with this message box?", "body": "<p>I am curious below why the final msgBox is failing. I am getting both a syntax error and an end of statement error. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Travel_Expenses_Click()\n\n    Dim firstName As String\n    Dim lastName As String\n    Dim nMiles As Single\n    Dim milesPerGallon As Single\n    Dim avgPrice As Currency\n    Dim tripCost As Currency\n\n    firstName = InputBox(\"Enter your first name\", \"Expenses Calculator\", \"First\")\n    lastName = InputBox(\"Enter your last name\", \"Expenses Calculator\", \"Last\")\n    nMiles = InputBox(\"How many miles did you drive\", \"Expenses Calculator\",     \"99\")\n    milesPerGallon = InputBox(\"What was your average miles per gallon\", \"Expenses   Calculator\", \"35\")\n    avgPrice = InputBox(\"What was the average price per gallon on your trip\",     \"Expenses Calculator\", \"1.90\")\n    tripCost = nMiles / milesPerGallon * avgPrice\n\n    msgBox firstName &amp; lastName &amp; \" Traveled \" &amp; nMiles &amp; \"Miles, got \" &amp; _\n    milesPerGallon &amp; \"Miles per Gallon on average, paid \" &amp; _\n    avgPrice &amp; \"per gallon on average, and paid a total of \" &amp; tripCost _\n    \" for gas\"\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "environ"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1455135474, "post_id": 35324653, "comment_id": 58358991, "body": "Perhaps you are aware of this, but it is unclear from your question.  Environ(&quot;username&quot;) should return the user name of the logged in user, not the person who&#39;s machine it is...."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1455138469, "post_id": 35324653, "comment_id": 58360659, "body": "I don&#39;t understand what&#39;s going on.  If you open a command prompt window on that machine and ask for <code>echo %username%</code>, does that give you a different name than you get from the VBA <code>environ(&quot;username&quot;)</code> ?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1455143916, "post_id": 35324653, "comment_id": 58363337, "body": "In the Access Immediate window, what name does this show you? <code>Debug.Print CreateObject(&quot;WScript.Network&quot;).Username</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1455782426, "last_edit_date": 1455782426, "creation_date": 1455159919, "answer_id": 35330079, "question_id": 35324653, "link": "https://stackoverflow.com/questions/35324653/environusername-returning-wrong-user-names/35330079#35330079", "title": "Environ(&quot;username&quot;) returning wrong user names", "body": "<p>This uses Windows API functions to return the name of the user who is currently logged in.</p>\n\n<pre><code>'// API Declarations\nPrivate Declare Function GetUserName Lib \"advapi32.dll\" _\nAlias \"GetUserNameA\" (ByVal lpBuffer As String, nSize As Long) _\n  As Long\n\n\nFunction UserName() As String\n    '// Returns the name of the logged-in user\n    Dim Buffer As String * 100\n    Dim BuffLen As Long\n    BuffLen = 100\n    GetUserName Buffer, BuffLen\n    UserName = Left(Buffer, BuffLen - 1)\n    'MsgBox UserName\nEnd Function\n</code></pre>\n\n<p><a href=\"http://spreadsheetpage.com/index.php/site/tip/looping_through_ranges_efficiently_in_custom_worksheet_functions/\" rel=\"nofollow\">Retrieving Logged-in User Name</a></p>\n"}], "owner": {"reputation": 65, "user_id": 2069483, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eaae84d2c5423441faa713dcf0e5ca9d?s=128&d=identicon&r=PG", "display_name": "Eric Hondzinski", "link": "https://stackoverflow.com/users/2069483/eric-hondzinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455782426, "creation_date": 1455133988, "last_edit_date": 1455758766, "question_id": 35324653, "link": "https://stackoverflow.com/questions/35324653/environusername-returning-wrong-user-names", "title": "Environ(&quot;username&quot;) returning wrong user names", "body": "<p>When I execute my Access application across alternating sessions, the function <strong><code>Environ(\"username\")</code></strong> returns the user name of a person in my department other than the actual user whose machine I am then currently using to execute the code. </p>\n\n<p>No other type of user name manipulation occurs throughout the program. </p>\n\n<p>Any idea how this is possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1455133978, "post_id": 35324523, "comment_id": 58358116, "body": "The issue is that the code in your cells is being fully escaped when your VBA reads it in, so the compiler doesn&#39;t recognize it as code...Out of curiosity, why not include that code in your VBA script directly?"}, {"owner": {"reputation": 143, "user_id": 3893269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b6b4d981b936631003800707e90560?s=128&d=identicon&r=PG&f=1", "display_name": "Julie4435637", "link": "https://stackoverflow.com/users/3893269/julie4435637"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1455206445, "post_id": 35324523, "comment_id": 58395388, "body": "Thank you. I thought VBA was treating it as a string but I didn&#39;t know how to fix it. I want to share the macro with my co-workers who do not know how to update VBA code.  We produce a lot of reports and there is a standard way we need to format the reports. I thought creating a sheet where they can update values that change from report to report would save time. For example the title of the report changes often and the footer must have the title in the 1st line on every sheet.  We sometimes have 100 sheets to a workbook and it is very tedious to open page setup and add the footer."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 3893269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b6b4d981b936631003800707e90560?s=128&d=identicon&r=PG&f=1", "display_name": "Julie4435637", "link": "https://stackoverflow.com/users/3893269/julie4435637"}, "edited": false, "score": 0, "creation_date": 1455205782, "post_id": 35325011, "comment_id": 58394861, "body": "Thank you.  I did not realize that quotes were being added to my string. Also, I didn&#39;t think of setting up the leftfooter they way you suggested.  This is very helpful."}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1455135325, "creation_date": 1455135325, "answer_id": 35325011, "question_id": 35324523, "link": "https://stackoverflow.com/questions/35324523/formatting-codes-for-footer-not-being-applied-and-page-orientation-data-mismatch/35325011#35325011", "title": "formatting codes for footer not being applied and page orientation data mismatch", "body": "<p>AFAIK, there is no (straightforward) way to do what you're trying to do. When you put code in a cell, and then call that cell's value in place of actual code, what VBA is trying to run is not: </p>\n\n<p><code>.PageSetup.Orientation = xlLandscape</code></p>\n\n<p>but rather:</p>\n\n<p><code>.PageSetup.Orientation = \"xlLandscape\"</code></p>\n\n<p>which will produce the errors and behavior you're seeing. </p>\n\n<p>As rule of thumb, if your VBA code needs a string (ie, something in \"\"), or a number, you can do that calculation on the sheet and have the code pull in the value.</p>\n\n<p>For everything else (there's Mastercard) put it in the code. For example:</p>\n\n<p><code>leftfooter = cell1.value &amp; Chr(10) &amp; cell2.value &amp; Chr(10) &amp; cell3.value</code></p>\n\n<p>(As a side note, I'm not familiar with the formatting it seems you're trying to do in that string... Those are generally set up through things like</p>\n\n<pre><code>With sheet.PageSetup.leftFooter.\n    .Font.Size = 9\n    'etc...\n</code></pre>\n\n<p>) </p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 3893269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b6b4d981b936631003800707e90560?s=128&d=identicon&r=PG&f=1", "display_name": "Julie4435637", "link": "https://stackoverflow.com/users/3893269/julie4435637"}, "edited": false, "score": 0, "creation_date": 1455205917, "post_id": 35325051, "comment_id": 58394984, "body": "Thank you very much.  Everything you suggested worked perfectly.  I am very new to VBA programming and what you showed me here will be helpful to create my macro worksheet that I want to share with my co-workers."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1455136046, "last_edit_date": 1455136046, "creation_date": 1455135441, "answer_id": 35325051, "question_id": 35324523, "link": "https://stackoverflow.com/questions/35324523/formatting-codes-for-footer-not-being-applied-and-page-orientation-data-mismatch/35325051#35325051", "title": "formatting codes for footer not being applied and page orientation data mismatch", "body": "<p>Reading in your footer definitions like that they are treated as literal string, not code.  You need to resolve the code to valid footer strings somehow.</p>\n\n<p>For the <code>LeftFooter</code> string, you can use <code>Evaluate</code> to resolve it, but it will need to be written as if it's a Excel Formula, not VBA, so use</p>\n\n<blockquote>\n  <p>\"&amp;9 2014 YTD Financial Data for PP\" &amp; Char(10) &amp; \" &amp;D &amp;T\" &amp; Char(10) &amp; \" Version 1.0\" &amp; Char(10) &amp; \" &amp;F\"</p>\n</blockquote>\n\n<p>Note the I use <code>Char</code> rather than <code>Chr</code>, the Excel formula equivalent.</p>\n\n<p>For Orientation you are using a named constant, which won't work.  Either put the value on your Excel sheet (<code>2</code> in this case) or write your own code to resolve the name to its value</p>\n\n<p>Working version (with corrected source data on sheet as descibed above)</p>\n\n<pre><code>Sub page_setup()\n    Dim reportWB As Excel.Workbook\n    Dim sheet As Excel.Worksheet\n    Dim wsSource As Worksheet\n\n    'open report workbook - name of workbook is in cell b4\n    Set wsSource = Workbooks(\"macros.xlsm\").Sheets(\"adHoc\")\n    Set reportWB = Workbooks.Open(wsSource.Range(\"b4\").Value)\n\n    Dim leftFooter\n    leftFooter = wsSource.Range(\"b28\").Value\n\n    For Each sheet In reportWB.Sheets\n        With sheet\n            .PageSetup.leftFooter = Evaluate(leftFooter)\n            .PageSetup.Orientation = wsSource.Range(\"b36\").Value\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>To handle the constants you could add a UDF that resolves the string names to values and call that from your settings sheet</p>\n\n<p>Eg</p>\n\n<pre><code>Function GetConst(s As String) As Variant\n    Select Case s\n        Case \"xlLandscape\"\n            GetConst = xlLandscape\n        Case \"xlPortrait\"\n            GetConst = xlPortrait\n        ' etc\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>Put in cell <code>B36</code> <code>GetConst(\"xlLandscape\")</code> (as a string, not formula), and change your Orientation line of code to</p>\n\n<pre><code>.PageSetup.Orientation = Evaluate(wsSource.Range(\"b36\").Value)\n</code></pre>\n\n<p>Add any other named constants you want to the <code>Select Case</code> statement.</p>\n"}], "owner": {"reputation": 143, "user_id": 3893269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b6b4d981b936631003800707e90560?s=128&d=identicon&r=PG&f=1", "display_name": "Julie4435637", "link": "https://stackoverflow.com/users/3893269/julie4435637"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1455136046, "creation_date": 1455133547, "last_edit_date": 1455133693, "question_id": 35324523, "link": "https://stackoverflow.com/questions/35324523/formatting-codes-for-footer-not-being-applied-and-page-orientation-data-mismatch", "title": "formatting codes for footer not being applied and page orientation data mismatch", "body": "<p>I have a worksheet(adHoc) where cell b28 contains </p>\n\n<blockquote>\n  <p>\"&amp;9 2014 YTD Financial Data for PP\" &amp; Chr(10) &amp; \" &amp;D &amp;T\" &amp; Chr(10) &amp; \" Version 1.0\" &amp; Chr(10) &amp; \" &amp;F\"</p>\n</blockquote>\n\n<p>When I use the above to update the footer of another worksheet in a different workbook. I don't get the embedded formatting - it displays exactly what is contained in the cell b28.For example excel should see &amp;9 and make the font 9 points.</p>\n\n<p>I am also getting a datatype mismatch error with the page orientation. The contents of cell b36 is <strong>xlLandscape</strong>.</p>\n\n<p>I posted a copy of this question last week on another board but did not get any answers.  I hope someone here has answer.</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/919033-updating-pagesetup-using-cells-master-worksheet-orientation-formatting-footer-excel-visual-basic-applications.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/919033-updating-pagesetup-using-cells-master-worksheet-orientation-formatting-footer-excel-visual-basic-applications.html</a></p>\n\n<p>This is the code I am using.</p>\n\n<pre><code>Sub page_setup()\n\n  Dim reportWB As Excel.Workbook\n\n  Dim sheet As Excel.Worksheet\n\n  'open report workbook - name of workbook is in cell b4\n  Set reportWB = Workbooks.Open(Workbooks(\"macros.xlsm\").Sheets(\"adHoc\").Range(\"b4\").Value)\n\n  Dim leftFooter\n\n  leftFooter = Workbooks(\"macros.xlsm\").Sheets(\"adHoc\").Range(\"b28\").Value\n\n  For Each sheet In reportWB.Sheets\n\n  With sheet\n\n     .PageSetup.leftFooter = leftFooter\n\n     .PageSetup.Orientation = Workbooks(\"macros.xlsm\").Sheets(\"adHoc\").Range(\"b36\").Value\n\n  End With     \n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1455136129, "post_id": 35325003, "comment_id": 58359343, "body": "Thanks that was exactly what I was looking for. Much appreciated."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": true, "score": 2, "last_activity_date": 1455135300, "creation_date": 1455135300, "answer_id": 35325003, "question_id": 35324486, "link": "https://stackoverflow.com/questions/35324486/loop-in-vba-skipping-values/35325003#35325003", "title": "Loop in VBA Skipping Values", "body": "<p>Sounds like you want a while loop since the for loop as written will always go the same number of times.  Looks like you might need a second counter to increment your date.  </p>\n\n<pre><code>while count &lt; 76\n    'get rs here\n    if rs.RecordCount &lt;&gt; 0 Then\n        'do everything else\n        count = count + 1\n    end if\n    dateCounter = dateCounter + 1\nloop\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 35325003, "answer_count": 1, "score": 0, "last_activity_date": 1455135300, "creation_date": 1455133416, "question_id": 35324486, "link": "https://stackoverflow.com/questions/35324486/loop-in-vba-skipping-values", "title": "Loop in VBA Skipping Values", "body": "<p>I have the following code in Access VBA. </p>\n\n<pre><code>Public Sub CalculateVol()\n\nDim vol As Double\nDim rs As Recordset\nDim rs2 As Recordset\nDim iRow As Long, iField As Long\nDim strSQL As String\nDim CurveID As Long\nDim MarkRunID As Long\nDim MaxOfMarkAsofDate As Date\nDim userdate As String\n\nDoCmd.RunSQL \"DELETE * FROM HolderTable\"\n'Clears out the old array from the holder table.\n\nDim I As Integer\nDim x As Date\n\nuserdate = InputBox(\"Please Enter the Date (mm/dd/yyyy)\")\n\nx = userdate\n\nDim BucketTermAmt As Long\nBucketTermAmt = InputBox(\"Please Enter the Term Amount\")\n\nFor I = 0 To 76\n\nMaxOfMarkAsofDate = x - I\n\n\n\nstrSQL = \"SELECT * FROM VolatilityOutput WHERE CurveID=\" &amp; Forms!Volatility.cboCurve.Value &amp; \" AND MaxOfMarkAsofDate=#\" &amp; MaxOfMarkAsofDate &amp; \"# ORDER BY MaxOfMarkasOfDate, MaturityDate\"\n\nSet rs = CurrentDb.OpenRecordset(strSQL, Type:=dbOpenDynaset, Options:=dbSeeChanges)\nSet rs2 = CurrentDb.OpenRecordset(\"HolderTable\")\n\n\n\nIf rs.RecordCount &lt;&gt; 0 Then\n\n    rs.MoveFirst\n\n    rs.MoveLast\n\n\n    Dim BucketTermUnit As String\n    Dim BucketDate As Date\n    Dim MarkAsOfDate As Date\n    Dim InterpRate As Double\n\n\n    Dim b As String\n\n    b = BucketTermAmt\n\n    BucketTermUnit = Forms!Volatility.cboDate.Value\n    BucketDate = DateAdd(BucketTermUnit, b, MaxOfMarkAsofDate)\n    InterpRate = CurveInterpolateRecordset(rs, BucketDate)\n\n    rs2.AddNew\n    rs2(\"BucketDate\") = BucketDate\n    rs2(\"InterpRate\") = InterpRate\n    rs2.Update\n\n\nEnd If\n\nNext I\n\n\nvol = EWMA(0.94)\n\nForms!Volatility!txtVol = vol\n\nDebug.Print vol\n\n\nEnd Sub\n</code></pre>\n\n<p>The basic idea is that the user inputs a date for MaxofMarkAsofDate. The code then finds that instance of MarkAsofDate in the table VolatilityOutput, and uses it as a reference point to calculate InterpRate. It stores this number in the HolderTable. Then it loops the same procedure, except using one day previous to the user-inputted MarkAsofDate, and then one day previous to that, and so on for a total of 76 times. </p>\n\n<p>The first part works fine but the loop is giving me trouble. If it doesn't find the user-inputted date in the table, it'll just skip it, but still count it as a loop. So while I want 76 data points, I might only end up with 56, for example, if it skips 20 dates. So I want to either stop it from skipping, or just keep looping until HolderTable has a total of 76 numbers in it. How do I do this?</p>\n"}, {"tags": ["vba", "validation", "excel"], "comments": [{"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1455133058, "post_id": 35324251, "comment_id": 58357543, "body": "Do not use irrelevant tags. This is VBA, VB.NET has no say here."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1455138430, "post_id": 35324251, "comment_id": 58360636, "body": "What errors you have?? How you tried to acomplish this???? We are not a resource site, we help you to fix the errors you have, and give answers to your questions, we don&#39;t do the job for you. Please read this <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "reply_to_user": {"reputation": 1, "user_id": 5904332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaacfde8192bfe22c0f331ddd13f32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joul.K", "link": "https://stackoverflow.com/users/5904332/joul-k"}, "edited": false, "score": 0, "creation_date": 1455145364, "post_id": 35326008, "comment_id": 58363928, "body": "No problem. If you want to allow additional currency you can duplicate the line that contains $ and replace the $ with another symbol."}], "tags": [], "owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "is_accepted": true, "score": 0, "last_activity_date": 1455140927, "last_edit_date": 1455140927, "creation_date": 1455138814, "answer_id": 35326008, "question_id": 35324251, "link": "https://stackoverflow.com/questions/35324251/input-validation-and-repetition-in-vba/35326008#35326008", "title": "Input validation and repetition in vba", "body": "<p>This should answer your questions without delving into all your code. Tested.</p>\n\n<pre><code>Sub getInput()\nDim ans As String\n\nDo\n   ans = InputBox(\"Please indicate your salary\", \"Salary Calculation\")\nLoop Until isValid(ans)\n\n''{{{{{{{{\n''Do what you need here with the user input (stored in *ans* variable)\n''}}}}}}}}\n\nEnd Sub\n\nFunction isValid(ans As String) As Boolean\n   Dim cleanAns As variant\n   cleanAns = IIf(ans Like \"*$*\", Replace(ans, \"$\", \"\"), ans)\n   isValid = IsNumeric(cleanAns) And cleanAns &gt; 0\n   If Not isValid Then MsgBox \"only positive numbers allowed\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5904332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaacfde8192bfe22c0f331ddd13f32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joul.K", "link": "https://stackoverflow.com/users/5904332/joul-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 35326008, "answer_count": 1, "score": 0, "last_activity_date": 1455140927, "creation_date": 1455132637, "last_edit_date": 1455134265, "question_id": 35324251, "link": "https://stackoverflow.com/questions/35324251/input-validation-and-repetition-in-vba", "title": "Input validation and repetition in vba", "body": "<p>I have the following code and I would like help in 4 areas:</p>\n\n<blockquote>\n  <ol>\n  <li>Did I validate the inputbox correctly? It should only take positive numerical variables.</li>\n  <li>How can I let the input box accept both input with, and without, symbols such as ($)?</li>\n  <li>How can I link the code so that it can directly request another number if the user has entered a negative non numeric number?</li>\n  <li>How can I repeat the procedure in the loop directly without repeating the whole code?</li>\n  </ol>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub IncomeSalaryCalculation()\n\nDim strSalary As String\nDim dblTaxableSalary As Double\nDim dblTax As Double\nDim dblSalaryAfterTax As Double\nDim strOutput As String\nDim SalaryCalculationRequest As VbMsgBoxResult\n\nstrSalary = InputBox(\"Please indicate your salary\", \"Salary Calculation\")\n\nIf Not IsNumeric(strSalary) Then\n    MsgBox \"This is no number! Please enter a non-negatif number\", vbOKOnly, \"Error\"\n\nElseIf strSalary &lt; 0 Then\n    MsgBox \"You should enter a positive number\", vbOKOnly, \"Error\"\n\nElse\n\ndblTaxableSalary = CDbl(strSalary)\n\nSelect Case dblTaxableSalary\n      Case Is &gt;= 151000\n               dblTax = 2440 * 0.1 + (37400 - 2440) * 0.2 + (150000 - 37400) * 0.5 + (dblTaxableSalary - 150000) * 0.5\n      Case Is &gt;= 37401\n               dblTax = 2440 * 0.1 + (37400 - 2440) * 0.2 + (dblTaxableSalary - 37400) * 0.4\n      Case Is &gt;= 2441\n               dblTax = 2440 * 0.1 + (dblTaxableSalary - 2440) * 0.2\n      Case Else\n               dblTax = 2440 * 0.1\nEnd Select\n\ndblSalaryAfterTax = dblTaxableSalary - dblTax\n\nstrOutput = \"The amount of income tax is \" &amp; dblTax &amp; vbNewLine &amp; \"Your salary after tax is \" &amp; dblSalaryAfterTax\n\nMsgBox strOutput, vbOKOnly, \"Final Salary\"\n\nDo\n\nSalaryCalculationRequest = MsgBox(\"Do you want to calculate the tax of a new income?\", vbYesNo, \"New income tax salary calculation\")\n\nIf SalaryCalculationRequest = vbYes Then\n\n         strSalary = InputBox(\"Please indicate your salary\", \"Salary Calculation\")\n\n         dblTaxableSalary = CDbl(strSalary)\n\n         Select Case dblTaxableSalary\n          Case Is &gt;= 151000\n                   dblTax = 2440 * 0.1 + (37400 - 2440) * 0.2 + (150000 - 37400) * 0.5 + (dblTaxableSalary - 150000) * 0.5\n\n          Case Is &gt;= 37401\n                   dblTax = 2440 * 0.1 + (37400 - 2440) * 0.2 + (dblTaxableSalary - 37400) * 0.4\n\n          Case Is &gt;= 2441\n                   dblTax = 2440 * 0.1 + (dblTaxableSalary - 2440) * 0.2\n\n          Case Else\n                   dblTax = 2440 * 0.1\n\n        End Select\n\n        dblSalaryAfterTax = dblTaxableSalary - dblTax\n\n        strOutput = \"The amount of income tax is \" &amp; dblTax &amp; vbNewLine &amp; \"Your salary after tax is \" &amp; dblSalaryAfterTax\n\n        MsgBox strOutput, vbOKOnly, \"Final Salary\"\n\nElse\n     MsgBox \"Glad to serve you\"\n\nEnd If\n\nLoop Until SalaryCalculationRequest = vbNo\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word", "outlook", "save"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1455142411, "creation_date": 1455142411, "answer_id": 35327000, "question_id": 35324233, "link": "https://stackoverflow.com/questions/35324233/saving-an-outlook-item-vba-issue/35327000#35327000", "title": "Saving an Outlook Item VBA issue", "body": "<p>Try to call myItem.Save before calling SaveAs.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5910206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X7Wy8.jpg?s=128&g=1", "display_name": "Cid Rahim", "link": "https://stackoverflow.com/users/5910206/cid-rahim"}, "is_accepted": false, "score": 0, "last_activity_date": 1455219560, "creation_date": 1455219560, "answer_id": 35348553, "question_id": 35324233, "link": "https://stackoverflow.com/questions/35324233/saving-an-outlook-item-vba-issue/35348553#35348553", "title": "Saving an Outlook Item VBA issue", "body": "<p>I figured it out. </p>\n\n<p>I needed to remove the \", olMsg\" part from the end of the SaveAs line. Thanks anyways!</p>\n"}], "owner": {"reputation": 11, "user_id": 5910206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X7Wy8.jpg?s=128&g=1", "display_name": "Cid Rahim", "link": "https://stackoverflow.com/users/5910206/cid-rahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1455219560, "creation_date": 1455132574, "last_edit_date": 1455145062, "question_id": 35324233, "link": "https://stackoverflow.com/questions/35324233/saving-an-outlook-item-vba-issue", "title": "Saving an Outlook Item VBA issue", "body": "<p>I'm having trouble saving the outlook item. (Hmmm, I just realized I'm working with Ms Word - does it matter? Can I still post here?) Anyways, the issue is that, Word is creating the Message and sending it just fine (with attachments, subject and everything), but it is not saving the file in the designated location properly. It is saving as 1 KB and not opening. Below is the code and an image of the error. Thanks much for your help!</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nDim myString As String\nDim myString2 As String\n\n\nSet myOlApp = CreateObject(\"Outlook.Application\")\nSet myItem = myOlApp.CreateItem(olMailItem)\n\n' Doing some texts replacements here.\nmyString = Label9\nmyString = Replace(myString, \"[Name of Person]\", TextBoxNoP.Value)\nmyString = Replace(myString, \"[Name of Establishment]\", TextBoxNoE.Value)\nmyString = Replace(myString, \"[Date Received]\", TextBoxDR.Value)\n\n\nmyString2 = Label10\nmyString2 = Replace(myString2, \"[Name of Establishment]\", TextBoxNoE.Value)\nmyString2 = Replace(myString2, \"[Date Received]\", TextBoxDR.Value)\n\n' Done with texts replacements here. Setting up, saving and sending messages.\nSet myAttachments = myItem.Attachments\n\nmyItem.To = TextBoxTo.Value\nmyItem.CC = TextBoxCC.Value\nmyItem.Subject = myString2\nmyAttachments.Add \"\\\\di-afs.doi-ad.state.nv.us\\LifeHealth\\Charitable Gift Annuities\\Charitable Gift Annuities 2016\\Pending Charitable Gift Annunites\\\" &amp; TextBoxAtt.Value &amp; \".pdf\"\nmyItem.Body = myString\nmyItem.SaveAs \"\\\\di-afs.doi-ad.state.nv.us\\LifeHealth\\Charitable Gift Annuities\\Charitable Gift Annuities 2016\\E-mails sent by Nanci\\\" &amp; myString2 &amp; \".msg\", olMsg\nmyItem.Send\n\n\n\n\nUnload Me\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cHevX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cHevX.png\" alt=\"link to screenshot of error\"></a></p>\n\n<p>Thanks much for your help!!</p>\n"}, {"tags": ["excel", "vba", "excel-web-query"], "answers": [{"comments": [{"owner": {"reputation": 704, "user_id": 1223666, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c6ab89875cbfe231f52df4c9cb610cb?s=128&d=identicon&r=PG", "display_name": "Jatin Gera", "link": "https://stackoverflow.com/users/1223666/jatin-gera"}, "edited": false, "score": 0, "creation_date": 1455193122, "post_id": 35326862, "comment_id": 58385548, "body": "i have updated the code you can see above, however it is still not working excel always inserts a new column"}, {"owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "reply_to_user": {"reputation": 704, "user_id": 1223666, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c6ab89875cbfe231f52df4c9cb610cb?s=128&d=identicon&r=PG", "display_name": "Jatin Gera", "link": "https://stackoverflow.com/users/1223666/jatin-gera"}, "edited": false, "score": 0, "creation_date": 1455198218, "post_id": 35326862, "comment_id": 58389062, "body": "I suggest you add only that one row to your previous code. also change destination property to range($A$1). it worked for me on excel 2010. no column was added, the new data overwrites whatever is on cell a1"}], "tags": [], "owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "is_accepted": true, "score": 0, "last_activity_date": 1455141871, "creation_date": 1455141871, "answer_id": 35326862, "question_id": 35324191, "link": "https://stackoverflow.com/questions/35324191/excel-vba-webquey-creates-new-column/35326862#35326862", "title": "Excel VBA Webquey creates new column", "body": "<p>Yes. Add <code>.RefreshStyle = xlOverwriteCells</code> inside your With clause. This will force the external data to A1 instead of adding a new column.</p>\n"}], "owner": {"reputation": 704, "user_id": 1223666, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c6ab89875cbfe231f52df4c9cb610cb?s=128&d=identicon&r=PG", "display_name": "Jatin Gera", "link": "https://stackoverflow.com/users/1223666/jatin-gera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 35326862, "answer_count": 1, "score": 0, "last_activity_date": 1455193049, "creation_date": 1455132398, "last_edit_date": 1455193049, "question_id": 35324191, "link": "https://stackoverflow.com/questions/35324191/excel-vba-webquey-creates-new-column", "title": "Excel VBA Webquey creates new column", "body": "<p>for example, following query will create a new column <strong>A</strong> and the data from <strong>A</strong> column will now be in Column <strong>B</strong></p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; u, _\nDestination:=Cells(14, 8))\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = True\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = False\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlOverwriteCells\n    .SavePassword = False\n    .SaveData = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlEntirePage\n    .WebFormatting = xlWebFormattingNone\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n    .AdjustColumnWidth = False\nEnd With\n</code></pre>\n\n<p>is it possible that the destination of web query remain fixed lets say <strong>A1</strong></p>\n"}, {"tags": ["vba", "spreadsheet"], "comments": [{"owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455148203, "post_id": 35324150, "comment_id": 58365020, "body": "Thanks. That is the problem/error that I&#39;m having. DName is variable it is related to the column (i.e. Integer i). Maybe DName is erroneously defined as &quot;String&quot;? or how could I solve it?"}, {"owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455316218, "post_id": 35324150, "comment_id": 58452443, "body": "I have spreadsheets named Pepsi, Water, etc. in another workbook (Workbook2). In Workbook 1 I have a table that aggregates certain data from the mentioned tabs, consequently I inserted the names on the tabs in row 10 of the table in order to refer to them whenever variable &quot;i&quot; changes (i is the variable column), so the code identifies what spreadsheet to look at. Please let me know if this explains better my requirement, thanks!"}, {"owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455318569, "post_id": 35324150, "comment_id": 58453335, "body": "He he sorry. I&#39;ll explain in detail: 1) I need to fill the table below row 12 with data from another workbook, 2) That data is in different spreadsheets in another workbook, 3) For example, to fill column C (let&#39;s say: Pepsi Dates) in the table, I need to look for tab named &quot;Pepsi&quot;, and copy range (&quot;A52:A500&quot;) and paste in Range(&quot;C14&quot;) of the table, 4) for &quot;Pepsi Quantities&quot; I need to do the same as step 3, but with range (&quot;B52:B500&quot;), 5) And so on with Coke, Water, Coffee, etc. 6) So what I&#39;m trying to do is define variable &quot;i&quot; as column, so when values in row 3 = 1, then refer to.."}, {"owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455318835, "post_id": 35324150, "comment_id": 58453445, "body": "Spreadsheet which name is defined in cell C10 for Pepsi, E10 for Coke, G10 for Water, etc. 7) So when &quot;i&quot; changes, then column to be filled changes and the spreadsheet to look for changes as well.   By the way, THANKS in advance!"}, {"owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455322941, "post_id": 35324150, "comment_id": 58454843, "body": "Well, that is not a solution for +200 hundred tabs..."}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1455560993, "creation_date": 1455560993, "answer_id": 35416555, "question_id": 35324150, "link": "https://stackoverflow.com/questions/35324150/pull-data-from-another-workbook-searching-in-the-sheets-which-names-are-in-a-ta/35416555#35416555", "title": "Pull data from another workbook, searching in the sheets which names are in a table and depending on certain number in a row", "body": "<p>Here, I think this is what you're looking for: </p>\n\n<pre><code>Sub getInfo()\nDim cel As Range, nameRow As Range, lastCell As Variant\nlastCell = Cells(10, Columns.Count).End(xlToLeft).Address\nSet nameRow = Range(\"A10:\" &amp; lastCell)\nFor Each cel In nameRow\n    If cel.Value &lt;&gt; \"Tab\" And cel.Value &lt;&gt; \"\" Then\n        Workbooks(\"Workbook2\").Activate\n        Sheets(cel.Value).Range(\"A52:A500\").Copy\n        Workbooks(\"Workbook1\").Activate\n        Sheets(\"ACCT\").Cells(14, cel.Column).PasteSpecial Paste:=xlPasteValues\n    End If\nNext cel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4472266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9c545deb372d7c7190123d7f9d537346?s=128&d=identicon&r=PG&f=1", "display_name": "Flavinho", "link": "https://stackoverflow.com/users/4472266/flavinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455560993, "creation_date": 1455132229, "question_id": 35324150, "link": "https://stackoverflow.com/questions/35324150/pull-data-from-another-workbook-searching-in-the-sheets-which-names-are-in-a-ta", "title": "Pull data from another workbook, searching in the sheets which names are in a table and depending on certain number in a row", "body": "<p>please I need help with a code for:\n1) Copying data from columns of spreadsheets of another workbook (Workbook2), spreadsheets names are in a table of the current workbook (Workbook1).\n2) Paste selected data in the columns that contains the spreadsheet name accordingly. I'm using indicators 1 and 2 to differentiate what data to post, i.e. 1 for dates, 2 for quantities.\n3) Maybe picture in the link helps for a better understanding.\n<a href=\"http://i.stack.imgur.com/TXeO1.png\" rel=\"nofollow\">enter image description here</a></p>\n\n<p>4) Code I have so far is:\nSub Data()</p>\n\n<pre><code>Dim i As Integer\n\nDim DName As String\nDName = Workbooks(\"Workbook1\").Sheets(\"ACCT\").Range(Cells(10, i))\n\nFor i = 3 To 250\n    If Workbooks(\"Workbook1\").Sheets(\"ACCT\").Cells(3, i) = \"1\" Then\n        Workbooks(\"Workbook2\").Activate\n        Sheets(DName).Range(\"A52:A500\").Copy\n\n        Workbooks(\"Workbook1\").Activate\n        Sheets(\"ACCT\").Range(Cells(14, i)).PasteSpecial Paste:=xlPasteValues\n    End If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1455132046, "post_id": 35324010, "comment_id": 58356865, "body": "Rather than fish for you; consider this process using a macro recorder.  It may help with other problems later! step 1) Start macro recorder.  Step 2) place focus in column containing desired data. Step 3) press ctrl-down (assuming PC) on column which has desired values.  Step 4 stop macro recorder.  Step 5) review what system recorded so you know how the system can dynamically select the last cell.  (Ctrl-down will set focus to the last cell with data (Assuming no gaps in column)  ctrl-shift-end will give you all data on a sheet regardless of gaps.  Add shift to the key combo to select!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455133112, "post_id": 35324103, "comment_id": 58357588, "body": "When I do this its giving me an Run Time Error"}, {"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455133132, "post_id": 35324103, "comment_id": 58357602, "body": "It says method &quot;range&quot; of object_global failed"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455133264, "post_id": 35324103, "comment_id": 58357686, "body": "Just noticed something. <code>Worksheets.Select (&quot;FedEx Air Ops Workbench Report&quot;)</code> should be <code>Worksheets(&quot;FedEx Air Ops Workbench Report&quot;).select</code>? What does <code>debug.print lastRow</code> say?"}, {"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455133571, "post_id": 35324103, "comment_id": 58357875, "body": "Its giving me the number 4.. I put it in the immediate window and pressed enter is that what you were saying?"}, {"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455134627, "post_id": 35324103, "comment_id": 58358521, "body": "Now I&#39;m getting a run time error 1004 autofill method of range class failed"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455134710, "post_id": 35324103, "comment_id": 58358564, "body": "Huh. It works for me.... Edit: add a <code>ws.</code> before <code>Range(&quot;G4:G&quot; &amp; lastRow)</code>. If still fails, then I don&#39;t know :/"}, {"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455135201, "post_id": 35324103, "comment_id": 58358840, "body": "Ok now its running but its just not finding the last row for some reason its stopping at the 4th row and the debug.print lastrow is returning the number 4 and I dont understand why"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455135313, "post_id": 35324103, "comment_id": 58358917, "body": "Oh so G is blank to begin with. What&#39;s the column that G corresponds to? Edit: whatever that column is, just change the line for <code>lastrow</code> to that column."}, {"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455136076, "post_id": 35324103, "comment_id": 58359319, "body": "What do you mean corresponds to? Column G is where I want the formula to populate but it is blank should I use the column next to it to get to the bottom?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455136189, "post_id": 35324103, "comment_id": 58359383, "body": "Try changing the G to E."}, {"owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "edited": false, "score": 0, "creation_date": 1455136243, "post_id": 35324103, "comment_id": 58359419, "body": "Nevermind I got it now you were correct I put the wrong column thank you for that!"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 1, "last_activity_date": 1455134245, "last_edit_date": 1455134245, "creation_date": 1455132088, "answer_id": 35324103, "question_id": 35324010, "link": "https://stackoverflow.com/questions/35324010/how-to-copy-down-formula-in-excel-to-last-cell-with-data-in-vba/35324103#35324103", "title": "How to copy down formula in Excel to last cell with data in VBA", "body": "<pre><code>Dim ws As Worksheet\nSet ws = WorkSheets(\"FedEx Air Ops Workbench Report\")\nlastRow = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row\nDebug.Print lastRow\nws.Range(\"G4\").FormulaR1C1 = \"=VLOOKUP(RC[-2],BUTTONS!R2C11:R6C12,2,FALSE)\"\nws.Range(\"G4\").AutoFill Destination:=Range(\"G4:G\" &amp; lastRow), Type:=xlFillDefault\n</code></pre>\n\n<p>Does the above work?</p>\n"}], "owner": {"reputation": 3, "user_id": 5898510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f9b43190bb9598abceff2a1aec96b?s=128&d=identicon&r=PG&f=1", "display_name": "Marro24", "link": "https://stackoverflow.com/users/5898510/marro24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 35324103, "answer_count": 1, "score": 0, "last_activity_date": 1455134245, "creation_date": 1455131844, "last_edit_date": 1531164843, "question_id": 35324010, "link": "https://stackoverflow.com/questions/35324010/how-to-copy-down-formula-in-excel-to-last-cell-with-data-in-vba", "title": "How to copy down formula in Excel to last cell with data in VBA", "body": "<p>I have a code that will perform a formula and then place the value in Column G and then sort column G... The code works fine but I will be having a dynamically changed amount of row I need the formula to be ran for so I am trying to figure out how to change the range from just certain cells to all cells that have a value. Any help is appreciated. The code I have written is below.</p>\n\n<pre><code>Sub Sorting()\nWorksheets.Select (\"FedEx Air Ops Workbench Report\")\nRange(\"G4\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-2],BUTTONS!R2C11:R6C12,2,FALSE)\"\nSelection.AutoFill Destination:=Range(\"G4:G58\"), Type:=xlFillDefault\nActiveWorkbook.Worksheets(\"FedEx Air Ops Workbench Report\").Sort.SortFields. _\n    Add Key:=Range(\"G4:G58\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"FedEx Air Ops Workbench Report\").Sort\n    .SetRange Range(\"A4:G58\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1455131719, "post_id": 35323964, "comment_id": 58356654, "body": "What doesn&#39;t work? What error do you get?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455132259, "post_id": 35323964, "comment_id": 58357009, "body": "It&#39;s not clear exactly what you&#39;re expecting to return.  Can you make it work as a worksheet formula?  If yes then it would be useful add that formula to the question: likely you could use something based on <code>Worksheet.Evaluate</code> ..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1455132273, "post_id": 35323964, "comment_id": 58357015, "body": "Also, if you&#39;re running it literally as you have it, there is no <code>origen</code> or <code>destino</code>...so it doesn&#39;t have anything to compare the ranges to."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455132539, "post_id": 35323964, "comment_id": 58357195, "body": "I get a Type Missmatch error. No, it&#39;s not literal, there is a value for origen and destino. It works as a Worksheet fromula:"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455132596, "post_id": 35323964, "comment_id": 58357234, "body": "{=MATCH(1, (F:F= origen) * (G:G = destino), 0)}"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455132671, "post_id": 35323964, "comment_id": 58357281, "body": "So you only want the position od the first match ?  Try <code>fila = WorkSheets(&quot;sheetNameHere&quot;).Evaluate(&quot;=MATCH(1, (F:F= origen) * (G:G = destino), 0)&quot;)</code>  You shouldn&#39;t need to include the &quot;{}&quot;"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455132728, "post_id": 35323964, "comment_id": 58357318, "body": "Yes, the position of the first match that fulfills those two conditions (there could be more)."}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455133335, "post_id": 35324395, "comment_id": 58357732, "body": "Perfect, but I need &quot;B&quot; and &quot;R&quot; to be vba variables, like origen and destino. Is there a way to do that?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455311079, "post_id": 35324395, "comment_id": 58450192, "body": "I have one more question regarding this issue. If destino or origen were numbers (integers), how should the code be?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 1, "creation_date": 1455312345, "post_id": 35324395, "comment_id": 58450791, "body": "ActiveSheet.Evaluate(&quot;=MATCH(1,(C:C=&quot; &amp; destino &amp; &quot;) * (D:D=&quot; &amp; origen &amp; &quot;),0)&quot;)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1455133690, "last_edit_date": 1455133690, "creation_date": 1455133087, "answer_id": 35324395, "question_id": 35323964, "link": "https://stackoverflow.com/questions/35323964/array-formula-in-vba/35324395#35324395", "title": "Array formula in vba", "body": "<p><a href=\"https://i.stack.imgur.com/rEg12.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rEg12.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Tester()\n\n    Dim f As Integer\n    Dim destino as String\n    Dim origen as String\n\n    destino = \"B\"\n    origen = \"R\"\n\n    f = ActiveSheet.Evaluate(\"=MATCH(1,(C:C=\"\"\" &amp; destino &amp; \"\"\") * (D:D=\"\"\" &amp; origen &amp; \"\"\"),0)\")\n    Debug.Print f '&gt;&gt; 6\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1455182120, "accepted_answer_id": 35324395, "answer_count": 1, "score": -1, "last_activity_date": 1455133690, "creation_date": 1455131671, "last_edit_date": 1455132817, "question_id": 35323964, "link": "https://stackoverflow.com/questions/35323964/array-formula-in-vba", "closed_reason": "Not suitable for this site", "title": "Array formula in vba", "body": "<p>I'm trying the following code to find the location of several values:</p>\n\n<pre><code>Dim destino as String\nDim origen as String\ndestino=\"A\"\norigen=\"B\"\nDim fila as Integer\nfila = Application.WorksheetFunction.Match(1, (Range(\"F:F\") = origen) * (Range(\"G:G\") = destino), 0)\n</code></pre>\n\n<p>But it doesn't work. Does anybody know why?</p>\n"}, {"tags": ["excel", "vba", "for-loop", "while-loop"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1455130258, "post_id": 35323362, "comment_id": 58355758, "body": "I don&#39;t see any connection between volatility and the choice between types of loops. The two topics seem quite unrelated. Choice of loop is mostly a matter of taste."}, {"owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1455135395, "post_id": 35323362, "comment_id": 58358957, "body": "I see your point, please see my edit."}], "answers": [{"tags": [], "owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "is_accepted": true, "score": -1, "last_activity_date": 1455139117, "creation_date": 1455139117, "answer_id": 35326102, "question_id": 35323362, "link": "https://stackoverflow.com/questions/35323362/excel-vba-loop-through-range-with-while-or-for/35326102#35326102", "title": "(Excel VBA) loop through range with while or for?", "body": "<p>There will be no difference in time between <code>Do..While</code>, <code>For Each</code>, or <code>For i = x to y</code>. If you are wondering how make a not calculate every time you Loop you can Use <code>Application.Calculation = xlCalculationManual</code> before your loop with <code>Application.Calculation =xlCalculationAutomatic</code>after.</p>\n\n<p>When I say no difference there will be very little, nothing to notice.</p>\n"}], "owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1072, "favorite_count": 0, "accepted_answer_id": 35326102, "answer_count": 1, "score": -1, "last_activity_date": 1455139117, "creation_date": 1455129728, "last_edit_date": 1455135192, "question_id": 35323362, "link": "https://stackoverflow.com/questions/35323362/excel-vba-loop-through-range-with-while-or-for", "title": "(Excel VBA) loop through range with while or for?", "body": "<p>Recently I was pointed out that some Excel functions are volatile, meaning they are triggered every time there is a change in the worksheet, while others aren't. Now this brings me to the point that most of my VBA usage is looping through a range and I am wondering which of the two methods is to be preferred and why? \nCase do while-loop; </p>\n\n<pre><code>Dim i as long\ni = 1\nDo while cells(i,1) &lt;&gt; \"\"\n    ...\n    i = i + 1\nLoop\n</code></pre>\n\n<p>Or for-loop</p>\n\n<pre><code>Dim curCell as cell\nfor curCell = cells(1,1) to cells(1,1).end(xlDown)\n    ...\nNext curCell\n</code></pre>\n\n<p>(please note that the exact code might be incorrect since I currently don't have access to a computer with Excel)</p>\n\n<p>Edit (after John's remark); As far as I can see in the first example the target cell value is requested every time the loop is looped, in the second example the cell will only be requested twice \u00e1nd .end(xlDown) does not require the vba layer but is a standard function thus the second option might be running faster. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1455126728, "post_id": 35322444, "comment_id": 58353556, "body": "Look into arrays, it will allow you to load it up with a loop."}, {"owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 1, "creation_date": 1455126736, "post_id": 35322444, "comment_id": 58353564, "body": "What about using array ? : <a href=\"http://www.excel-easy.com/vba/array.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/array.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 5909783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f313b898b5d205241ab092e57f425fec?s=128&d=identicon&r=PG&f=1", "display_name": "Studix", "link": "https://stackoverflow.com/users/5909783/studix"}, "edited": false, "score": 0, "creation_date": 1455127968, "post_id": 35322660, "comment_id": 58354312, "body": "Thank you AndASM, I will try and it sounds the right way to go. I ignored there were arrays in VBA (very stupid of me\u2026!!!) Thanks."}], "tags": [], "owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "is_accepted": true, "score": 7, "last_activity_date": 1455127355, "creation_date": 1455127355, "answer_id": 35322660, "question_id": 35322444, "link": "https://stackoverflow.com/questions/35322444/vba-how-to-define-a-large-set-of-string-variables/35322660#35322660", "title": "VBA : How to define a large set of string variables?", "body": "<p>Arrays do exactly this! See this example:</p>\n\n<pre><code>Dim Port(1 to 100) As String\nDim i As Long\n\nPort(1) = \"String\"\nFor i = 2 to 100\n    Port(i) = \"String \" &amp; i\nNext i\n</code></pre>\n\n<p>It sets Port(1), the first array element to the word \"String\". Everything else <code>Port(2)</code> and on, contain \"String 2\", \"String 3\", etc. Up to <code>Port(100)</code>.</p>\n\n<p>I hope that helps!</p>\n"}], "owner": {"reputation": 191, "user_id": 5909783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f313b898b5d205241ab092e57f425fec?s=128&d=identicon&r=PG&f=1", "display_name": "Studix", "link": "https://stackoverflow.com/users/5909783/studix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 35322660, "answer_count": 1, "score": 1, "last_activity_date": 1455127355, "creation_date": 1455126655, "last_edit_date": 1455126741, "question_id": 35322444, "link": "https://stackoverflow.com/questions/35322444/vba-how-to-define-a-large-set-of-string-variables", "title": "VBA : How to define a large set of string variables?", "body": "<p>I am trying (in VBA) to define a large number of string variables. The brute force would be :</p>\n\n<p><code>Dim Port1 as String \nDim Port2 as String \netc\u2026</code></p>\n\n<p>Unpleasant for say 100 variables. There must be a more intelligent solution.\nI have tried :</p>\n\n<p><code>Dim n As Integer\nFor n = 1 To 100\n  Dim \"Port\" &amp; n as String\nNext n</code></p>\n\n<p>and variations of it without success.\nI would greatly appreciate if someone could point me in the right direction or share an example.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455128765, "post_id": 35321580, "comment_id": 58354821, "body": "I just did a test with <code>debug.print .Top</code> before the <code>.Show</code> method and after the <code>.Top</code> method. Before was <code>122.25</code>. After was <code>269.25</code> and exact difference of <code>147</code>. So it seems to be adding <code>147</code> to the current top position. I did a second test and got <code>0</code> and <code>147</code>."}, {"owner": {"reputation": 53, "user_id": 4540136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBhw9.jpg?s=128&g=1", "display_name": "Dasmittel", "link": "https://stackoverflow.com/users/4540136/dasmittel"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455129106, "post_id": 35321580, "comment_id": 58355029, "body": "So that would mean that the .top adds 147 to the height rather than setting it to 147?  That&#39;s interesting.  But why did it go from 122.25 on the first test to 0 on the second?   Edit: I just ran this myself, and got 139.5 before then 286.5 after on the first test, and 286.5 before then 286.5 after on the second test.  I wonder why mine is getting different numbers than yours."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455129301, "post_id": 35321580, "comment_id": 58355145, "body": "good question - seems like it automatically sets a random placement when first referenced. But you can probably do some quick math to get it to work. Something like <code>.Top = .Top - .Top + 147</code>"}, {"owner": {"reputation": 53, "user_id": 4540136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBhw9.jpg?s=128&g=1", "display_name": "Dasmittel", "link": "https://stackoverflow.com/users/4540136/dasmittel"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455129638, "post_id": 35321580, "comment_id": 58355353, "body": "That&#39;s a good idea, but it didn&#39;t change anything for some reason.  I tried your      [.Top = .Top - .Top + 147] , but that kept the same 139.5 I got earlier.  I also tried      [.Top = .Top - .Top]      [Debug.Print .Top]      [.Top = 147] , but the debug printed 139.5 again. Edit: formatting is hard."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455129861, "post_id": 35321580, "comment_id": 58355482, "body": "its interesting - maybe its something that needs to be played with more. (too format with grey background use the ` key <code>around the text</code> or a <code>*</code> for <i>italicized</i> or <code>**</code> for <b>bold</b>)"}, {"owner": {"reputation": 53, "user_id": 4540136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBhw9.jpg?s=128&g=1", "display_name": "Dasmittel", "link": "https://stackoverflow.com/users/4540136/dasmittel"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455130176, "post_id": 35321580, "comment_id": 58355705, "body": "Hmm..  I also tried setting an integer n to the .top value.  So now, I have <code>n = .Top</code> <code>Debug.Print .Top &amp; &quot;, &quot; &amp; n</code> <code>Top = -n</code> <code>Debug.Print .Top</code>, and I get <code>.top = 286.5</code>, <code>n = 286</code> the first time, and then <code>.top = -146.25</code>.  I have no idea how it&#39;s getting that negative number though."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 4540136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBhw9.jpg?s=128&g=1", "display_name": "Dasmittel", "link": "https://stackoverflow.com/users/4540136/dasmittel"}, "is_accepted": true, "score": 0, "last_activity_date": 1455148298, "creation_date": 1455148298, "answer_id": 35328290, "question_id": 35321580, "link": "https://stackoverflow.com/questions/35321580/userform-top-value-changes-from-assigned/35328290#35328290", "title": "UserForm.Top value changes from assigned", "body": "<p>I still don't understand the entirety of what is happening here, but I thought I should post this answer in case some future person has a similar question.</p>\n\n<p>The key to all of this, as I discovered in my 2nd edit, was the SetParent function:</p>\n\n<pre><code>Private Declare Function SetParent Lib \"user32\" _\n   (ByVal hWndChild As Long, _\n    ByVal hWndNewParent As Long) As Long\n</code></pre>\n\n<p>This caused Excel to add a particular value, say XMod, (which can vary by user and hardware) to the .top property of the form, but also another value, YMod, to the .left property, which I didn't see in this case.  Ultimately, if I set both .top and .left to 0, the XMod and YMod will cause the form to appear with the top of the form lining up with the top of the column header, and the left of the form lining up with the left of the row header.  Any number I set will have the appropriate modifier added for the final result.  But this number will often have a small variation made to it to align with the screen resolution, which is why I initially thought it was random.</p>\n\n<p>However, this did introduce another problem, as whenever I set either .top or .left, Excel would add the modifier to both .top and .left.  Meaning, if I have the following code:</p>\n\n<pre><code>With UserForm1\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = 147\n   End With\n</code></pre>\n\n<p>Excel will set the <code>.top = YMod + 147</code>, and the <code>.left = XMod + XMod + 17</code>.  In my initial code, the XMod was 0, so I didn't notice it added it twice.  I got around this by setting a variable to the YMod, and then subtracting that variable when setting the .Top later, such as the following:</p>\n\n<pre><code>With Navigation\n   .Top = 0\n   t = .Top\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Top = 13 - t\n   .Left = 19\n End With\n</code></pre>\n\n<p>This gave me the correct results I needed.  If anyone else has any problems getting this to work, I hope this will help.  And if I can see someone else answer the question in a way that makes more sense, I'll definitely mark theirs as the answer.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6435489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7cc03c23cdcc29d817be42226afbab9?s=128&d=identicon&r=PG", "display_name": "Banica Tom", "link": "https://stackoverflow.com/users/6435489/banica-tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1600306666, "last_edit_date": 1600306666, "creation_date": 1599930248, "answer_id": 63862827, "question_id": 35321580, "link": "https://stackoverflow.com/questions/35321580/userform-top-value-changes-from-assigned/63862827#63862827", "title": "UserForm.Top value changes from assigned", "body": "<p>Dasmittel, I seem to be walking your exact path (albeit 4 years later) and wonder if you've made any progress in that time?  For the record, I have worked with this issue in both Excel 2007 and (currently) Excel 2013 as you have in your example case.</p>\n<p>I also am using the Chip Pearson code (which I recognize above) to make the userform a child of the worksheet. And like you, I also determined that the SetParent call was buloxing up the positioning.</p>\n<pre><code>'&lt;=== Form IS correctly positioned here\nRes = SetParent(hWndChild:=ChildHWnd, hWndNewParent:=ParentHWnd)\n'&lt;=== Form is NOT correctly positioned here\n</code></pre>\n<p>Setting/changing the parent of the userform is also the reason that various solutions for positioning the userform relative to a given cell do not function. This is due to:</p>\n<ol>\n<li>the reference point changes from the screen's 0,0 to the\napplication's.  So Left = 20 will necessarily be different after\nsetting the userform's parent.</li>\n<li>(Feel free to correct me if I am wrong on this) that there is a different unit of measure being used.</li>\n</ol>\n<p>I believe between these two is the explanation that assigning .Left or .Top gives a result like this:</p>\n<pre><code>.Left = 10:  '--&gt; Debug.Print .Left = 149\n</code></pre>\n<p>What I do not understand is why setting .Left <em>also changes</em> .Top (likewise setting .Top <em>also changes</em> .Left)?!!</p>\n<p>However I <em>think</em> my results seem to be slightly different than yours.  Yes, there are what you label XMod and YMod. Startup position of the spreadsheet (and maybe size of the spreadsheet?) seem to affect these values. But whatever they are upon opening the worksheet they then remain constant and...</p>\n<ol>\n<li>every change of x to .left seems to do this: .left = x + XMod <strong>AND</strong> .top = .top + YMOD</li>\n<li>every change of y to .top seems to do this: .top = y + YMod <strong>AND</strong> .left = .left + XMOD</li>\n</ol>\n<p>I am of the opinion that this is an error in Excel. I'd love clarification one way or the other though.</p>\n<p>I received help from someone that seems to work at initial positioning and now I get this:</p>\n<p>[1]<a href=\"https://drive.google.com/file/d/1smHLeNLy8w23YnRgZmQtaMCp_kJzpM72/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1smHLeNLy8w23YnRgZmQtaMCp_kJzpM72/view?usp=sharing</a></p>\n<p>I originally had frozen the workbook at row 2 to keep my column headers visible. Unfortunately as Chip Pearson and others who have worked with this issue have noted, freezing panes further complicates the issue and I got inconsistent results once again. My current thought is that it has to do with which pane is active when the userform's position is assigned. For now, I am not freezing any row/column. If I ever get this working with frozen panes, I'll add that solution here as well.</p>\n<p>In the hope that it helps the original poster or someone else, here is my current code base for placing a userform (without frozen panes) over cell A1 <strong>AFTER</strong> setting its parent to be the worksheet.</p>\n<p>Note that I use MyUserForm as the userform's name in this sample. You would change the call to PositionUserForm to reflect the name of your userform. Here is the code.</p>\n<p>This goes into a module:</p>\n<pre><code>    Declarations\n    \n        Private Type POINTAPI\n          x As Long\n          y As Long\n        End Type\n    \n        #If VBA7 Then\n            #If Win64 Then\n                Private Declare PtrSafe Function FindWindowEx Lib &quot;user32&quot; Alias &quot;FindWindowExA&quot; (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long\n                Private Declare PtrSafe Function GetDC Lib &quot;user32&quot; (ByVal hwnd As Long) As Long\n                Private Declare PtrSafe Function GetDeviceCaps Lib &quot;gdi32.dll&quot; (ByVal hdc As Long, ByVal nIndex As Long) As Long\n                Private Declare PtrSafe Function ReleaseDC Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal hdc As Long) As Long\n                Private Declare PtrSafe Function ScreenToClient Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByRef lpPoint As POINTAPI) As Long\n                Private Declare PtrSafe Function SetParent Lib &quot;user32.dll&quot; (ByVal hWndChild As Long, ByVal hWndNewParent As Long) As Long\n                Private Declare PtrSafe Function SetWindowPos Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long\n                Private Declare PtrSafe Function ShowWindow Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n            #Else\n                Private Declare PtrSafe Function FindWindowEx Lib &quot;user32&quot; Alias &quot;FindWindowExA&quot; (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As LongLong\n                Private Declare PtrSafe Function GetDC Lib &quot;user32&quot; (ByVal hwnd As Long) As LongLong\n                Private Declare PtrSafe Function GetDeviceCaps Lib &quot;gdi32.dll&quot; (ByVal hdc As Long, ByVal nIndex As Long) As LongLong\n                Private Declare PtrSafe Function ReleaseDC Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal hdc As Long) As LongLong\n                Private Declare PtrSafe Function ScreenToClient Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByRef lpPoint As POINTAPI) As LongLong\n                Private Declare PtrSafe Function SetParent Lib &quot;user32.dll&quot; (ByVal hWndChild As Long, ByVal hWndNewParent As Long) As LongLong\n                Private Declare PtrSafe Function SetWindowPos Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As LongLong\n                Private Declare PtrSafe Function ShowWindow Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal nCmdShow As Long) As LongLong\n            #End If\n            Private Declare PtrSafe Function WindowFromAccessibleObject Lib &quot;oleacc&quot; (ByVal pacc As IAccessible, phwnd As Long) As Long\n        #Else\n            Private Declare Function WindowFromAccessibleObject Lib &quot;oleacc&quot; (ByVal pacc As IAccessible, phwnd As Long) As Long\n            Private Declare Function FindWindowEx Lib &quot;user32&quot; Alias &quot;FindWindowExA&quot; (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long\n            Private Declare Function GetDC Lib &quot;user32&quot; (ByVal hwnd As Long) As Long\n            Private Declare Function GetDeviceCaps Lib &quot;gdi32.dll&quot; (ByVal hDC As Long, ByVal nIndex As Long) As Long\n            Private Declare Function ReleaseDC Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal hDC As Long) As Long\n            Private Declare Function ScreenToClient Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByRef lpPoint As POINTAPI) As Long\n            Private Declare Function SetParent Lib &quot;user32.dll&quot; (ByVal hWndChild As Long, ByVal hWndNewParent As Long) As Long\n            Private Declare Function SetWindowPos Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal X As Long, ByVal Y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long\n            Private Declare Function ShowWindow Lib &quot;user32.dll&quot; (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n        #End If\n    \n    Public Sub PositionUserForm(Target As Range, frm As UserForm)\n        Const SWP_NOSIZE = &amp;H1\n        Const SW_SHOW = 5\n        Dim pt As POINTAPI\n        Dim OffsetX As Long\n        Dim OffsetY As Long\n        Dim EXCEL7Hwnd As Long\n        Dim UserFormHwnd As Long\n        \n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' *Should* be the screen coords of the leftmost, visible range\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        OffsetX = ActiveWindow.PointsToScreenPixelsX(0)\n        OffsetY = ActiveWindow.PointsToScreenPixelsY(0)\n          \n        pt.x = OffsetX + PointsToPixels(ActiveWindow.PointsToScreenPixelsX(Target.Left) - OffsetX, &quot;X&quot;)\n        pt.y = OffsetY + PointsToPixels(ActiveWindow.PointsToScreenPixelsY(Target.Top) - OffsetY, &quot;Y&quot;)\n    \n        WindowFromAccessibleObject frm, UserFormHWnd \n        EXCEL7Hwnd = FindWindowEx(FindWindowEx(Application.hwnd, 0, &quot;XLDESK&quot;, vbNullString), 0, &quot;EXCEL7&quot;, vbNullString)\n        SetParent UserFormHwnd, EXCEL7Hwnd\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' Note: In simple terms, the userform does not scroll with the worksheet. So you need to be\n    ' sure that the cell you are using to position the userform is physically (in regards to\n    ' Excel) positioned where the userform needs to be placed. Failure to do so, will result\n    ' in an incorrectly placed (and possibly &quot;invisible&quot;) userform.\n    '\n    ' In a little more detail, the coords used in this subroutine are based upon a &quot;virtual&quot;\n    ' desktop that extends beyond the Excel window. The *initial* location of the cell used\n    ' for positioning upon this virtual desktop is critical. If the &quot;home&quot; cell is off the\n    ' visible screen when the userform is positioned, the userform will be &quot;visible&quot;  but\n    ' permanently off screen until the appropriate .left or .top property is corrected.\n    '\n    ' Personally, I place the userform over cell A1 and want the userform to cover the top/\n    ' leftmost corner of usable window/area of the worksheet.\n    '\n    ' If row 1 is scrolled off the top of the screen, pt.x will be negative.\n    ' If column A is scrolled off the left of the screen, pt.y will be negative.\n    ' In either case, your userform will be &quot;Visible&quot; but placed OUTSIDE of the visible window.\n    '\n    ' A1 can neither be scrolled off the bottom or right the screen. However should you use a\n    ' different cell, then that cell *could* be scrolled down and/or right which would result\n    ' in an incorrectly larger positive value for .left and/or .top and possibly therefore an\n    ' incorrectly placed userform. Should the number be large enough, the userform, though\n    ' &quot;visible&quot; would be permanently placed oustide of the visible window.\n    '\n    ' Should your userform be displayed outside of the visible screen, you will want to correct\n    ' its position by adjusting .left or .top. Know that after having been made a child of the\n    ' workbook, the userform's .left and .top will no longer work as expected (the very reason\n    ' this routine is needed to properly place it). This is because .left and .top are based\n    ' upon SCREEN positioning while after being made a child, the userform's .top and .left are\n    ' based upon the Excel window's posititon AND also use a different unit of measure than\n    ' previously.\n    '\n    ' Additionally, note that after making the userform a child of the workbook, changing\n    ' either of these two properties also changes *the other*?!! This seems to be an error\n    ' in Excel (I am using Excel 2013) as noted in a previous post in this thread. If the userform\n    ' is off screen, you can change either .Left or .Top. Once the userform appears on screen,\n    ' drag it to where you want with the mouse.\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' Translate screen coords to client (new parent) coords\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ScreenToClient EXCEL7Hwnd, pt\n        \n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' SWP_NOSIZE tells the function to ignore the height and width args\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        SetWindowPos UserFormHwnd, 0, pt.x, pt.y, 0, 0, SWP_NOSIZE\n        ShowWindow UserFormHwnd, SW_SHOW\n    End Sub\n    \n    Private Function PointsToPixels(Pts As Double, Axis As String) As Long\n        Const WU_LOGPIXELSX = 88\n        Const WU_LOGPIXELSY = 90\n        Dim hdc As Long\n        hdc = GetDC(0)\n        PointsToPixels = (Pts / (72 / GetDeviceCaps(hdc, IIf(Axis = &quot;X&quot;, WU_LOGPIXELSX, WU_LOGPIXELSY)))) * (ActiveWindow.Zoom / 100)\n        ReleaseDC 0, hdc\n    End Function\n\nPublic Sub GotoHomeCell\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' I am showing my low level of vba programming skills with this subroutine's method of \n    ' being certain that the correct worksheet is active and that cell A1 is top/left\n    ' so that the userform is correctly situated. I tried various ways and was not happy\n    ' with the results.  This while surely not optimal seems to work. I'd love a better\n    ' solution should someone want to correct this. \n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' Be sure A1 is displayed on screen\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        Sheets(&quot;GameDev&quot;).Activate\n        ActiveSheet.Range(&quot;A1&quot;).Select                  'Goto ActiveCell did not seem to work without EntireRow but...\n        Application.Goto ActiveCell.EntireRow, True     'Leaves entire row selected so... next line...\n        ActiveSheet.Range(&quot;A1&quot;).Select\n    \n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' Display userform in correct position\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        Call PositionUserForm(Range(&quot;A1&quot;), MyUserForm)     '&lt; Set flag?  In theory, only need to execute PositionUserForm ONCE?\nEnd Sub\n</code></pre>\n<p>This single line goes into the userform's UserForm_Initialize:</p>\n<pre><code>   Call GotoHomeCell\n</code></pre>\n<p>Note that I placed the call to GotoHomeCell</p>\n<ol>\n<li>After code to make the userform a child of the worksheet.</li>\n<li>After code to hide the menu bar. Obviously, if you do not want to hide the menu bar, this would be moot.</li>\n</ol>\n"}], "owner": {"reputation": 53, "user_id": 4540136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBhw9.jpg?s=128&g=1", "display_name": "Dasmittel", "link": "https://stackoverflow.com/users/4540136/dasmittel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 35328290, "answer_count": 2, "score": 2, "last_activity_date": 1600306666, "creation_date": 1455124171, "last_edit_date": 1525816150, "question_id": 35321580, "link": "https://stackoverflow.com/questions/35321580/userform-top-value-changes-from-assigned", "title": "UserForm.Top value changes from assigned", "body": "<p>I've long used this site to find answers to my questions, but I couldn't find anything regarding this question.  Apologies in advance if I missed anything.</p>\n\n<p>So I have a workbook (Office 2013, VBA 7.1) where I'm trying to use a userform as a menu which will remain stationary on the page and also move with the workbook.  I used a combination of code from <a href=\"http://www.cpearson.com/excel/SetParent.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/SetParent.aspx</a> to lock the form to the window and <a href=\"http://www.oaltd.co.uk/Excel/Default.htm\" rel=\"nofollow noreferrer\">http://www.oaltd.co.uk/Excel/Default.htm</a> (the FormFun.zip) to remove the caption from the form and prevent it from being moved on the page.</p>\n\n<p>This code is working great, but I'm consistently encountering a strange bug, where the inserted forms \".Top\" value is different from what I assigned in my code.  I also had a co-worker run the code and get the same issue.  I'll list the relevant parts of the code below.</p>\n\n<p>I have the following code in a Module (Module1):</p>\n\n<pre><code>Sub CallFormTestA()\n\nWith UserForm1\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = 147\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>And I have the following code in the UserForm (UserForm1):</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" _\n   (ByVal hwnd As Long, _\n    ByVal nIndex As Long) As Long\n\nPrivate Declare Function SetWindowLong Lib \"user32\" Alias \"SetWindowLongA\" _\n   (ByVal hwnd As Long, _\n    ByVal nIndex As Long, _\n    ByVal dwNewLong As Long) As Long\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n   (ByVal lpClassName As String, _\n    ByVal lpWindowName As String) As Long\n\nPrivate Declare Function FindWindowEx Lib \"user32\" Alias \"FindWindowExA\" _\n   (ByVal hWnd1 As Long, _\n    ByVal hWnd2 As Long, _\n    ByVal lpsz1 As String, _\n    ByVal lpsz2 As String) As Long\n\nPrivate Declare Function SetParent Lib \"user32\" _\n   (ByVal hWndChild As Long, _\n    ByVal hWndNewParent As Long) As Long\n\nPrivate Const GWL_STYLE As Long = (-16)          'The offset of a window's style\nPrivate Const WS_CAPTION As Long = &amp;HC00000      'Style to add a titlebar\n\nPrivate Sub SetBit(ByRef lStyle As Long, ByVal lBit As Long, ByVal bOn As Boolean)\n   If bOn Then\n      lStyle = lStyle Or lBit\n   Else\n      lStyle = lStyle And Not lBit\n   End If\nEnd Sub\n\nPrivate Sub Userform_Initialize()\nDim MeHWnd, ApphWnd, DeskhWnd, WindowhWnd, Res, lStyle As Long\n\n'Get the window handle of the main Excel application window.\nApphWnd = Application.hwnd\nIf ApphWnd &gt; 0 Then\n   'Get the window handle of the Excel desktop.\n   DeskhWnd = FindWindowEx(ApphWnd, 0&amp;, \"XLDESK\", vbNullString)\n   If DeskhWnd &gt; 0 Then\n      'Get the window handle of the ActiveWindow.\n      WindowhWnd = FindWindowEx(DeskhWnd, 0&amp;, \"EXCEL7\", ActiveWindow.Caption)\n      If WindowhWnd &gt; 0 Then\n         'OK\n      Else\n         MsgBox \"Unable to get the window handle of the ActiveWindow.\"\n      End If\n   Else\n      MsgBox \"Unable to get the window handle of the Excel Desktop.\"\n   End If\nElse\n   MsgBox \"Unable to get the window handle of the Excel application.\"\nEnd If\n\nMeHWnd = FindWindow(\"ThunderDFrame\", Me.Caption)\n\nIf MeHWnd = 0 Then Exit Sub\nlStyle = GetWindowLong(MeHWnd, GWL_STYLE)\nSetBit lStyle, WS_CAPTION, False\nSetWindowLong MeHWnd, GWL_STYLE, lStyle\n\nIf (MeHWnd &gt; 0) And (WindowhWnd &gt; 0) Then\n   Res = SetParent(MeHWnd, WindowhWnd)\n   If Res = 0 Then\n      MsgBox \"The call to SetParent failed.\"\n   End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>As I said, this code creates the form correctly, but when I run\n    msgbox userform1.top\nin the immediate window, it returns a different value, inconsistent across multiple attempts, but usually in the range of 250-300, often with a decimal point of either .25, .5 or .75.</p>\n\n<p>I don't understand most of this code I'm using from Stephen Bullen and Chip Pearson, but it doesn't look like it could affect the userform1.top value to me.  Can anyone identify whether there is an issue with the code I'm using that will change the userform1.top value?  Is it possible this is a bug instead?</p>\n\n<p>This is my first time asking a question here, so please let me know if there is any additional information I should include (or leave out).</p>\n\n<p>Thanks!</p>\n\n<p>Edit1:  Based on some feedback from Scott Holtzman, I've tried putting some debug.print lines in the code to identify the value of the .top at each point of the code.  My findings are below, though Scott did get different numbers when he ran this.  This is all contained in the sub CallFormTestA() of module1.  I also found that if I ran the module a second time without resetting the project, I would get a different result.  If I ran the module again after the second time, it keeps the same result I got the second time.</p>\n\n<pre><code>With UserForm1\n   Debug.Print .Top 'Returns 139.5 then 286.5\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = 147\n   Debug.Print .Top 'Returns 286.5 then 286.5\n   End With\n\nWith UserForm1\n   Debug.Print .Top '139.5 then 286.5\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = .Top - .Top 'Changed\n   Debug.Print .Top '139.5 then 139.5\n   .Top = 147\n   Debug.Print .Top '286.5 then 286.5\n   End With\n\nWith UserForm1\n   Debug.Print .Top 'Returns 139.5 then 286.5\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = -.Top 'Changed\n   Debug.Print .Top 'Returns -372 then -147\n   .Top = 147\n   Debug.Print .Top 'Returns 286.5 then 286.5\n   End With\n\nWith UserForm1\n   Debug.Print .Top '139.5 then 286.5\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = Abs(-.Top) 'Changed\n   Debug.Print .Top '511.5 then 286.5\n   .Top = 147\n   Debug.Print .Top '286.5 then 286.5\n   End With\n\nWith UserForm1\n   Debug.Print .Top '286.5 then 286.5\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   .Top = 0 'Changed\n   Debug.Print .Top '139.5 then 139.5\n   .Top = 147\n   Debug.Print .Top '286.5 then 286.5\n   End With\n\nDim n As Long 'Tried using an integer to store the .top value\nWith UserForm1\n   Debug.Print .Top '139.5 then 286.5\n   .Show vbModal = False\n   .StartUpPosition = 0\n   .Left = 17\n   n = .Top 'This drops the decimal, but I don't care about that.\n   Debug.Print .Top &amp; \", \" &amp; n '511.5, 512 then 286.5, 286\n   .Top = .Top - n\n   Debug.Print .Top '138.75 then 140.25\n   .Top = 147\n   Debug.Print .Top '286.5 then 286.5\n   End With\n</code></pre>\n\n<p>Edit2: I've done some more playing around, and isolating certain parts of the code in particular.  I found that if I comment out the following line from the UserForm1 code, the .Top property is set correctly.</p>\n\n<pre><code>If (MeHWnd &gt; 0) And (WindowhWnd &gt; 0) Then\n   Res = SetParent(MeHWnd, WindowhWnd)\n   If Res = 0 Then\n      MsgBox \"The call to SetParent failed.\"\n   End If\nEnd If\n</code></pre>\n\n<p>To clarify, the SetParent function is repeated here:</p>\n\n<pre><code>Private Declare Function SetParent Lib \"user32\" _\n   (ByVal hWndChild As Long, _\n    ByVal hWndNewParent As Long) As Long\n</code></pre>\n\n<p>I still don't see how these lines could affect the form.top property, but I can't figure out where else the problem might be.  I'm going to continue to research this, but wanted to update this in case anyone is looking at this question.</p>\n\n<p>Edit3: I was able to wrestle with this code and ultimately get it to do what I want, but I still don't know why.  I posted my updated code as an answer, but if anyone can offer any more insight to what happened here, I would greatly appreciate the input.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1455123977, "post_id": 35321454, "comment_id": 58351732, "body": "SO isn&#39;t a coding service. Please see how to <a href=\"http://stackoverflow.com/help\">ask a question</a>. As an aside, you can do this with just one button assuming the staff is in a column on the master sheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455124005, "post_id": 35321454, "comment_id": 58351758, "body": "Welcome to Stack Overflow.  SO is not a code for me service.  There are many tutorials that already exist on how to code in vba."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5554102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022b953507034801541525983f201c1b?s=128&d=identicon&r=PG&f=1", "display_name": "MisterProzilla", "link": "https://stackoverflow.com/users/5554102/misterprozilla"}, "is_accepted": true, "score": 0, "last_activity_date": 1455204960, "creation_date": 1455204960, "answer_id": 35343571, "question_id": 35321454, "link": "https://stackoverflow.com/questions/35321454/excel-vba-copy-several-cells-from-the-same-row-as-activecell-then-paste-them/35343571#35343571", "title": "Excel VBA - copy several cells from the same row as activecell, then paste them to the first blank row in another sheet", "body": "<p>This is what I settled on, for anyone interested:</p>\n\n<pre><code>Sub CopytoSheet2()\n\n\nDim rng As Range\n\nSet rng = Range(\"A\" &amp; ActiveCell.Row &amp; \":M\" &amp; ActiveCell.Row)\n\nIf IsEmpty(Sheet2.Range(\"A1048576\").End(xlUp).Value) = True Then\nSheet2.Range(\"A1048576\").End(xlUp).Resize(rng.Rows.Count, rng.Columns.Count). _\n    Cells.Value = rng.Cells.Value\nElse\nSheet2.Range(\"A1048576\").End(xlUp).Offset(1, 0).Resize(rng.Rows.Count, rng.Columns.Count). _\n    Cells.Value = rng.Cells.Value\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>There are ten buttons in the sheet, one each to send to a different member of staff. The Waiting List is named Sheet1 in the VBA properties, so the first staff sheet is Sheet2, etc.  There's a separate Sub for each button.</p>\n\n<p>The user clicks on a cell in the row they want to copy, then clicks the button, and it copies the values of columns A:M of that row into the first blank row in the respective sheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 5554102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022b953507034801541525983f201c1b?s=128&d=identicon&r=PG&f=1", "display_name": "MisterProzilla", "link": "https://stackoverflow.com/users/5554102/misterprozilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 35343571, "answer_count": 1, "score": -2, "last_activity_date": 1455204960, "creation_date": 1455123820, "last_edit_date": 1531164843, "question_id": 35321454, "link": "https://stackoverflow.com/questions/35321454/excel-vba-copy-several-cells-from-the-same-row-as-activecell-then-paste-them", "title": "Excel VBA - copy several cells from the same row as activecell, then paste them to the first blank row in another sheet", "body": "<p>I'm fairly new to VBA, so I don't have much of a clue where to start here.</p>\n\n<p>Basically, I have a front sheet that's a waiting list and ten staff sheets to track active clients; the waiting list has ten buttons to send data to each sheet respectively.\nIn the waiting list, I'd like to be able to click any cell in a given row to select it, then click one of the buttons, which will then copy the contents of columns A:G in that row, into the first blank row in the respective sheet. </p>\n\n<p>So, for example, I click cell C6 in the waiting list, then click the button for staff sheet 1: cells A6:G6 will be copied and pasted into the staff sheet cells A15:G15, which is the first blank row in staff sheet 1.</p>\n\n<p>I don't need it to delete anything from the waiting list, everything else is set up to work perfectly; I just need the vba code to do exactly as in the example.</p>\n\n<p>Hope that's clear - any help would be greatly appreciated :)</p>\n\n<p>Edit - Apologies, I didn't mean for this question to come across as expecting a code for me service. I've looked for existing answers to this for a few days, tried quite a few things, but it's all been abortive - I worried that posting the code that I've tried would just confuse things further. The most substantive solution I found had a few errors but otherwise looked sensible, but I got rid of it when it didn't work and can't track it down again. I'll post it if I find.</p>\n\n<p>Thanks anyway</p>\n"}, {"tags": ["sql", "vba", "sql-server-2008", "excel", "stored-procedures"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1455122509, "post_id": 35320859, "comment_id": 58350637, "body": "So the columns in the table are char as opposed to varchar?"}, {"owner": {"reputation": 44721, "user_id": 5696608, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/82086984779cd4c215e63edc1d1b7731?s=128&d=identicon&r=PG", "display_name": "Tom H", "link": "https://stackoverflow.com/users/5696608/tom-h"}, "edited": false, "score": 1, "creation_date": 1455122567, "post_id": 35320859, "comment_id": 58350703, "body": "The length should be the maximum size for the parameter, so it&#39;s the length of the parameter as declared in your stored procedure, not the length of the string being passed into it."}, {"owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "edited": false, "score": 1, "creation_date": 1455124884, "post_id": 35320859, "comment_id": 58352322, "body": "Alex K and Tom H, good shout, thanks.  I had tried already to use the max size for the column, but then it added spaces onto the end of the strings. I changed this to adVarChar and added the max size of the column again as the Size and it removed the spaces.  Thanks for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 4106446, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1205859778/picture?type=large", "display_name": "Dave Kelly", "link": "https://stackoverflow.com/users/4106446/dave-kelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1455122693, "creation_date": 1455122693, "answer_id": 35321041, "question_id": 35320859, "link": "https://stackoverflow.com/questions/35320859/using-createparameters-with-a-variable-size-parameter/35321041#35321041", "title": "Using CreateParameters with a variable size parameter", "body": "<p>you can make size an optional parameter in your stored procedure. Then add logic to change it from null to 0. If you do set a size it will keep the value you pass.</p>\n\n<pre><code>CREATE PROCEDURE usp_SQL_Procedure\n     @size INT = null,\n\nAS Begin \n--if @size comes over as null make it 0\n   set @size=ISNULL(@size,0)\nrest of you SP\n</code></pre>\n\n<p>END</p>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "is_accepted": true, "score": 1, "last_activity_date": 1455125005, "creation_date": 1455125005, "answer_id": 35321854, "question_id": 35320859, "link": "https://stackoverflow.com/questions/35320859/using-createparameters-with-a-variable-size-parameter/35321854#35321854", "title": "Using CreateParameters with a variable size parameter", "body": "<p>Alex K and Tom H helped me here. </p>\n\n<p>I changed the type to adVarChar and the size to the maximum size allowed by the column, which resolved the issue.</p>\n"}], "owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 35321854, "answer_count": 2, "score": 0, "last_activity_date": 1455125005, "creation_date": 1455122195, "question_id": 35320859, "link": "https://stackoverflow.com/questions/35320859/using-createparameters-with-a-variable-size-parameter", "title": "Using CreateParameters with a variable size parameter", "body": "<p>I need to call a stored procedure from Excel, passing several values entered by a user as parameters. I have almost achieved this with a Macro using the following Parameters collection. </p>\n\n<pre><code>Set ADOCmd = New ADODB.Command\n\nWith ADOCmd\n        .Parameters.Append .CreateParameter(\"@Department\", adChar, adParamInput, Len(cDept), cDept)\n        .Parameters.Append .CreateParameter(\"@title\", adChar, adParamInput, Len(cTitle), cTitle)\n        .Parameters.Append .CreateParameter(\"@name\", adChar, adParamInput, Len(cName), cName)\n        .Parameters.Append .CreateParameter(\"@email\", adChar, adParamInput, Len(cEmail), cEmail)\n        .Parameters.Append .CreateParameter(\"@tel_no\", adChar, adParamInput, Len(cTel), cTel)\n        .Parameters.Append .CreateParameter(\"@mob_no\", adChar, adParamInput, Len(cMob), cMob)\nEnd With\n</code></pre>\n\n<p>This will work just fine if all of the values have been filled out by the user. However if anything is left blank the following error occurs.</p>\n\n<pre><code>Run-time error:'3708':\nParameter object is improperly defined. Inconsistent or incomplete information was provided.\n</code></pre>\n\n<p>I'm led to believe this is because the Size parameter passed in the CreateParameter function is zero. Is there any way I can get around this? Shouldn't it accept zero as a valid Size if the string entered is zero characters long?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "edited": false, "score": 0, "creation_date": 1455123053, "post_id": 35320909, "comment_id": 58351072, "body": "Oh wow this is awesome. I&#39;ve never seen this before. So the only issue is if they try to run this while Subtotals are already off it&#39;ll throw an error. How do I properly condition check to only run this command if the subtotals are already off?"}, {"owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "edited": false, "score": 0, "creation_date": 1455124780, "post_id": 35320909, "comment_id": 58352253, "body": "I tried with a different pivot table and now no issues. I&#39;ll keep an eye on it, thanks for the tip this is awesome!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1455122333, "creation_date": 1455122333, "answer_id": 35320909, "question_id": 35320766, "link": "https://stackoverflow.com/questions/35320766/vba-using-sendkey-to-execute-excel-hotkeys/35320909#35320909", "title": "VBA Using Sendkey to execute Excel Hotkeys", "body": "<p>No, you're not impatient! If you are using 2007 or later, use:</p>\n\n<pre><code>    Application.CommandBars.ExecuteMso \"PivotTableSubtotalsDoNotShow\"\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "accepted_answer_id": 35320909, "answer_count": 1, "score": 4, "last_activity_date": 1455122333, "creation_date": 1455121977, "question_id": 35320766, "link": "https://stackoverflow.com/questions/35320766/vba-using-sendkey-to-execute-excel-hotkeys", "title": "VBA Using Sendkey to execute Excel Hotkeys", "body": "<p>I know that sendkeys are considered bad and dangerous but I'm struggling to figure out how to best deal with issues in VBA compared to front end Excel.</p>\n\n<p>I wrote a personal macro for setting up an unknown pivot table to repeat all labels, set to tabular, sort ascending field list, and finally hide subtotals.  Everything works fine except the subtotals requires a loop, and when there's a large amount of data this loop can take a long time.  Oddly, if you were to just turn off subtotals the from the front end controls, it's instant.  Hence where using Sendkey would be faster than actually looping. (Sendkey is doing the Hotkey presses to execute Turn off Subtotals)</p>\n\n<pre><code>Sub formatpivotTable()\nDim pivotName As Variant\nDim pf As pivotField\n\nOn Error Resume Next\npivotName = ActiveCell.PivotTable.Name\nIf pivotName = \"\" Then\n    MsgBox \"You did not select a pivot table\"\n    Exit Sub\nEnd If\nActiveSheet.PivotTables(\"\" &amp; pivotName &amp; \"\").ManualUpdate = True\nWith ActiveSheet.PivotTables(\"\" &amp; pivotName &amp; \"\")\n    .RepeatAllLabels (xlRepeatLabels)\n    .RowAxisLayout (xlTabularRow)\n    .FieldListSortAscending = True\n    'For Each pf In .PivotFields\n    '    pf.Subtotals(1) = True\n    '    pf.Subtotals(1) = False\n    'Next\nEnd With\nActiveSheet.PivotTables(\"\" &amp; pivotName &amp; \"\").ManualUpdate = False\n\n'Remove the Loop and instead use the Front End Hotkey\nActiveSheet.Activate  'Normally using activate is bad, but maybe it's good here to ensure your sendkeys hit excel? not even sure this prevents it\nApplication.SendKeys \"%\", True\nApplication.SendKeys \"{J}\", True\nApplication.SendKeys \"{Y}\", True\nApplication.SendKeys \"{T}\", True\nApplication.SendKeys \"{D}\", True\nEnd Sub\n</code></pre>\n\n<p>When it works, it works beautifully.  The whole thing is done within less than a second.  But I feel like there's still a danger that your sendkeys could overwrite pivot information with \"JYTD\" if something goes wrong.  I have commented out my original loop, which just takes too long when dealing with large amounts of data.</p>\n\n<p>Any thoughts? Am I just impatient using the loop method?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1455129652, "post_id": 35320704, "comment_id": 58355359, "body": "Please provide sample data and expected result. Use <a href=\"http://www.sensefulsolutions.com/2010/10/format-text-as-table.html\" rel=\"nofollow noreferrer\">sensefulsolutions.com/2010/10/format-text-as-table.html</a>"}, {"owner": {"reputation": 11, "user_id": 5909406, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iyszIokHGyo/AAAAAAAAAAI/AAAAAAAAABc/bnW9GTgJl-Q/photo.jpg?sz=128", "display_name": "Wendell", "link": "https://stackoverflow.com/users/5909406/wendell"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1455132548, "post_id": 35320704, "comment_id": 58357202, "body": "I have a concatenate function that results in a numbered list: 1) Peter 2) Paul 3) Mary 4) Joseph I want the result to be in sentence format such as, \u201cPeter, Paul, Mary, and Joseph.\u201d  I need the function to properly punctuate the sentence based on the number of records. If record set has only one name the result would be \u201cPeter\u201d If record set has two names the result would be \u201cPeter and Paul\u201d If record set has more than two names the result would be \u201cPeter, Paul, Mary, and Joseph.\u201d"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1455132529, "creation_date": 1455132529, "answer_id": 35324221, "question_id": 35320704, "link": "https://stackoverflow.com/questions/35320704/ms-access-concatenate-recordset-with-different-separators-based-on-number-of-re/35324221#35324221", "title": "MS Access: Concatenate recordset with different separators based on number of records", "body": "<p>I'd do something like this:</p>\n\n<pre><code>Dim test() As String\nDim arraySize As Integer\nDim arrayCounter As Integer\nDim rec as RecordSet\n\nSet rec = CurrentDB.OpenRecordset(\"SELECT MyField FROM MyTable\")\n\n'I was always told that MoveFirst/MoveLast gave the most \n'  accurate count of records\nrec.MoveFirst\nrec.MoveLast\narraysize = rec.RecordCount\n\n'reDim the array, now that you know the size\nreDim test(arraySize)\n\n'Fill the array\nFor i = 0 to arraysize - 1\n  test(i) = rec(0)\nnext I\n\n'Set up the text string\nMyText = \"\"\n\nFor j =  0 to arraysize - 1\n  If (j - 1) = arraysize Then\n    MyText = MyText &amp; \" and \" &amp; test(j)\n  else\n    MyText = MyText &amp; \", \" &amp; test(j)\n  End If\nNext j\n\n'Trim off the first comma\nMyFinalText = Trim(Right(MyText, Len(MyText) - 2))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5909406, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iyszIokHGyo/AAAAAAAAAAI/AAAAAAAAABc/bnW9GTgJl-Q/photo.jpg?sz=128", "display_name": "Wendell", "link": "https://stackoverflow.com/users/5909406/wendell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455132529, "creation_date": 1455121854, "question_id": 35320704, "link": "https://stackoverflow.com/questions/35320704/ms-access-concatenate-recordset-with-different-separators-based-on-number-of-re", "title": "MS Access: Concatenate recordset with different separators based on number of records", "body": "<p>How do I concatenate a recordset and have separators based on the number of records?  No separator for one record, \u201c and \u201c for two records, and commas between more than two records with \u201c, and\u201d before the last record. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 99, "user_id": 444154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29e4ea160b89871bd4e8abc00823dacb?s=128&d=identicon&r=PG", "display_name": "NestorInc", "link": "https://stackoverflow.com/users/444154/nestorinc"}, "edited": false, "score": 0, "creation_date": 1455120881, "post_id": 35320188, "comment_id": 58349394, "body": "This is here: <a href=\"http://stackoverflow.com/questions/3630496/how-do-you-get-a-range-to-return-its-name\" title=\"how do you get a range to return its name\">stackoverflow.com/questions/3630496/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1455120730, "creation_date": 1455120730, "answer_id": 35320266, "question_id": 35320188, "link": "https://stackoverflow.com/questions/35320188/returning-a-custom-named-ranges-name-from-selected-target/35320266#35320266", "title": "Returning a custom named range&#39;s name from selected target", "body": "<p>You actually need the <code>Name</code> property of the <code>Name</code> object:</p>\n\n<pre><code>Select Case Target.Name.Name\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5909327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/055dde3cb72037050aea4dd703a87c77?s=128&d=identicon&r=PG&f=1", "display_name": "Roman B.", "link": "https://stackoverflow.com/users/5909327/roman-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 35320266, "answer_count": 1, "score": 0, "last_activity_date": 1455120730, "creation_date": 1455120537, "last_edit_date": 1531164843, "question_id": 35320188, "link": "https://stackoverflow.com/questions/35320188/returning-a-custom-named-ranges-name-from-selected-target", "title": "Returning a custom named range&#39;s name from selected target", "body": "<p>I have a macro-enabled spreadsheet with several named ranges, with vba references to those named ranges (I use named ranges rather than the default so that I can move them around without breaking all of my references). What I want to do is to be able to pull the custom name of the cell that is selected by the user in a SelectionChange event. What I have right now is:</p>\n\n<pre><code>Select Case Target.Name\nCase \"A\"\n...etc,\n</code></pre>\n\n<p>However, Target.Name only returns the A1-style name of the cell, and not the custom name that is assigned to the cell. Is there any other property that I should be using? Any and all help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455121126, "post_id": 35319533, "comment_id": 58349611, "body": "Could you please tell us exactly which commands you use in the Word UI for inserting the files (especially the xls). And did you try recording the steps in a Word macro to compare whether the syntax you&#39;re using is the same as Word uses for inserting the files?"}, {"owner": {"reputation": 392, "user_id": 5909136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/afaad314b2d7cd25e4d05f673d779a17?s=128&d=identicon&r=PG&f=1", "display_name": "SmashingQuasar", "link": "https://stackoverflow.com/users/5909136/smashingquasar"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455177369, "post_id": 35319533, "comment_id": 58374865, "body": "Well, I&#39;m using the Insert as Object to insert it in Word UI, problem is, I have to create a custom toolbar in VBA and make it work without having to use the insert as object from Word UI, meaning it must use a method from the word VBA reference. I cannot really use a macro, since I will need to deconstruct strings of text, and do complexe algorithms to determine if the file is to be merged or not."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455197209, "post_id": 35319533, "comment_id": 58388310, "body": "InsertFile will not give you the same result as Insert/Object, so the &quot;why&quot; of your problem is clear enough. Do record the macro, as I suggested, so that you can see WHICH METHOD WORD NEEDS YOU TO USE! I&#39;m not telling you to use a macro, but to use the result of the recorder for your code."}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 5909136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/afaad314b2d7cd25e4d05f673d779a17?s=128&d=identicon&r=PG&f=1", "display_name": "SmashingQuasar", "link": "https://stackoverflow.com/users/5909136/smashingquasar"}, "is_accepted": true, "score": 0, "last_activity_date": 1457431796, "creation_date": 1457431796, "answer_id": 35864459, "question_id": 35319533, "link": "https://stackoverflow.com/questions/35319533/vba-inserting-excel-complexe-spreadsheet-in-doc-document/35864459#35864459", "title": "VBA Inserting Excel complexe spreadsheet in .doc document", "body": "<p>Here's the final answer to that question:</p>\n\n<p>As Word cannot interpret an Excel file it is not possible to force file insertion this way.</p>\n\n<p>Instead use the following code:</p>\n\n<pre><code>Sub MergeFiles()\n\n    Dim appExcel As Excel.Application\n    Dim wdDocument As Word.Document\n\n    Set appExcel = CreateObject(\"Excel.Application\")\n    Set wdDocument = Documents.Open(\"mydoc.doc\")\n\n    appExcel.Workbooks.Open(\"myxls.xls\")\n\n    appExcel.ActiveWorkbook.Sheets(1).Range(\"Print_area\").CopyPicture 'Copy picture prevents weird behavior from Word'\n\n    Selection.PasteSpecial Placement:=wdInLine, DataType:=wdPasteMetafilePicture\n\nEnd Sub\n</code></pre>\n\n<p>Obviously this is a sample code that will do the whole process but the idea is to copy the Print Area (one must be defined, you can also use Sheets(1).UsedRange but this will be a problem if the Excel file is oddly formatted) as picture and paste it into Word. You can also simply copy it and paste it but it may mess up your output table formatting.</p>\n\n<p>I don't even know why people down voted my question -_-</p>\n\n<p>Anyway, if you encouter the same issue, simply tell me if this code works.</p>\n"}], "owner": {"reputation": 392, "user_id": 5909136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/afaad314b2d7cd25e4d05f673d779a17?s=128&d=identicon&r=PG&f=1", "display_name": "SmashingQuasar", "link": "https://stackoverflow.com/users/5909136/smashingquasar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 35864459, "answer_count": 1, "score": -1, "last_activity_date": 1457431796, "creation_date": 1455118853, "last_edit_date": 1455121684, "question_id": 35319533, "link": "https://stackoverflow.com/questions/35319533/vba-inserting-excel-complexe-spreadsheet-in-doc-document", "title": "VBA Inserting Excel complexe spreadsheet in .doc document", "body": "<p>So I've been working on a word .dotm file that will combine several .doc and .xls documents into a single .pdf file.</p>\n\n<p>Right now, I have two different problems, I will only detail the first one on this topic:</p>\n\n<p>When inserting a complexe (very complexe) Excel sheet in my .doc document, the output is only a pile of meta data (Well mostly looks like it, if you prefer clearer language: it is a complete mess of characters and page breaks) instead of my file. I've looked for the entire day (really, I wasted my work day looking for answers) on the internet and even asked on MSDN forum (no answer at all) about this topic and everyone seems to have his code working like a charm.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub MergeFiles()\n    Documents.Open FileName:=\"C:\\test_cea\\02.doc\"\n\n    Selection.EndKey Unit:=wdStory\n    Selection.InsertFile FileName:=\"C:\\test_cea\\03.doc\"\n\n    Selection.EndKey Unit:=wdStory\n    Selection.InsertFile FileName:=\"C:\\test_cea\\04.xls\"\n\n    ActiveDocument.SaveAs2 FileName:=\"C:\\test_cea\\output.pdf\", FileFormat:=wdFormatPDF\n    ActiveDocument.Close SaveChanges:=doNotSaveChanges\nEnd Sub\n</code></pre>\n\n<p>I've tried a TREMENDOUS amount of things, from switching to opening the .xls first, to trying every single combination of parameters possible in my InsertFile() method and nothing works.<br>\nThe most amusing part is: it works perfectly when trying to do it with Word UI, meaning Word can do it, but I'm doing it wrong somehow.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 4, "creation_date": 1455118836, "post_id": 35319459, "comment_id": 58347758, "body": "You have two End Sub lines, that will cause an issue.  Otherwise, is there something specific that&#39;s not working?  Are you getting an error or unexpected results?  I guess I&#39;m not really seeing a question here..."}, {"owner": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1455118961, "post_id": 35319459, "comment_id": 58347844, "body": "hmm. there is no error when i put 2 end sub. my question is since i need to input company name, address and contact number and then click add. Must i also link it to another form. or i just remove the entire lines from &#39;to transfer student details to studentsubjectform.show. Thanks."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1455119263, "post_id": 35319459, "comment_id": 58348120, "body": "Did you try it and see what happens?  If the form is in memory, it should work (I haven&#39;t tested this) but if the form hasn&#39;t been created yet, I don&#39;t know if what you&#39;ve done will work.  Honestly, try and and see what happens.  It&#39;ll be much quicker than asking on a forum."}, {"owner": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1455119511, "post_id": 35319459, "comment_id": 58348332, "body": "it works though. and besides that i have another question to ask if you don mind. can you give me a few guide lines on what should i put in my update and retrieve codes? like how am i going to start?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1455119892, "post_id": 35319459, "comment_id": 58348613, "body": "Could you retitle your thread to reflect what your question is about?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1455120212, "post_id": 35319459, "comment_id": 58348862, "body": "Seems like this is more of a question for codereview: <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1455120239, "post_id": 35319459, "comment_id": 58348886, "body": "This isn&#39;t really the right venue for a discussion but...One way to go about it would be to store the values in a worksheet cell and then call them back when you want to populate the other form.  So rather than &quot;StudentSubjectForm.StudentNameDisplayLabel.Caption = studentName&quot;  you could use &quot;Sheet1.Range(&quot;A1&quot;).Value = studentName&quot; in you AddButton event and in the StudentSubjectForm_Initialization() event you could do StudentSubjectForm.StudentNameDisplayLabel.Caption = Sheet1.Range(&quot;A1&quot;).Value"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "edited": false, "score": 0, "creation_date": 1455120539, "post_id": 35320150, "comment_id": 58349129, "body": "wow thanks  a lot. This really answers my question. but what if i don want to link to another form. is okay right?"}, {"owner": {"reputation": 189, "user_id": 5719502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bUXs5V4RLU0/AAAAAAAAAAI/AAAAAAAABqQ/xRNG_fkW78Q/photo.jpg?sz=128", "display_name": "K Zombro", "link": "https://stackoverflow.com/users/5719502/k-zombro"}, "reply_to_user": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "edited": false, "score": 0, "creation_date": 1455121192, "post_id": 35320150, "comment_id": 58349662, "body": "I&#39;d appreciate an upvote then. Yes, you do not need to link to another form. Just name your variables appropriately and the Type will behave as expected"}, {"owner": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "edited": false, "score": 0, "creation_date": 1455121235, "post_id": 35320150, "comment_id": 58349696, "body": "so the type xcompanydata, i can just give any name i want?"}, {"owner": {"reputation": 189, "user_id": 5719502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bUXs5V4RLU0/AAAAAAAAAAI/AAAAAAAABqQ/xRNG_fkW78Q/photo.jpg?sz=128", "display_name": "K Zombro", "link": "https://stackoverflow.com/users/5719502/k-zombro"}, "reply_to_user": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "edited": false, "score": 0, "creation_date": 1455121419, "post_id": 35320150, "comment_id": 58349811, "body": "Yes, the type xcompanydata could be named whatever you&#39;d like."}, {"owner": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "edited": false, "score": 0, "creation_date": 1455122137, "post_id": 35320150, "comment_id": 58350341, "body": "1 last question for this &#39;example CompanyData(1).Name = &#39;userdata form stuff here.                                        i have to create a userdata form? because i not very sure what to give. thanks."}], "tags": [], "owner": {"reputation": 189, "user_id": 5719502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bUXs5V4RLU0/AAAAAAAAAAI/AAAAAAAABqQ/xRNG_fkW78Q/photo.jpg?sz=128", "display_name": "K Zombro", "link": "https://stackoverflow.com/users/5719502/k-zombro"}, "is_accepted": false, "score": 0, "last_activity_date": 1455120449, "creation_date": 1455120449, "answer_id": 35320150, "question_id": 35319459, "link": "https://stackoverflow.com/questions/35319459/add-update-and-retrieve-userform-entries/35320150#35320150", "title": "Add, update and retrieve userform entries", "body": "<p>Why not create a static data structure to organize your company data? Regardless of your question, this might help keep things clear.</p>\n\n<pre><code>Type xCompanyData\n    Name As String\n    Address As String\n    Number As String\nEnd Type\n</code></pre>\n\n<p>Then... for multiple companies, make instances of CompanyData...</p>\n\n<pre><code>Dim CompanyData() As xCompanyData\n' # companies? = n\nReDim CompanyData(1 To n)\n\n'example\nCompanyData(1).Name = 'userdata form stuff here\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5909050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d01435d04ec73b7f7c53068ea552e20?s=128&d=identicon&r=PG&f=1", "display_name": "1506585G Javier", "link": "https://stackoverflow.com/users/5909050/1506585g-javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455210835, "creation_date": 1455118677, "last_edit_date": 1531164843, "question_id": 35319459, "link": "https://stackoverflow.com/questions/35319459/add-update-and-retrieve-userform-entries", "title": "Add, update and retrieve userform entries", "body": "<p>Take a look at my design first because i have to Add, update and retrieve supplier details such as company name, business address, contact number etc. And when i click add button. must i really need to link to another form which is StudentSubjectForm. My question is i need to know what codes to write in update and retrieve button. Please give me the basics.</p>\n\n<p>My design consists of add, update and retrieve button. with a 3 textbox and 3 labels. </p>\n\n<p><a href=\"https://i.stack.imgur.com/PF4LC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PF4LC.png\" alt=\"enter image description here\"></a></p>\n\n<p>And these are my codes when i click add button.</p>\n\n<pre><code>Private Sub AddButton_Click()\n\n Dim companyName As String\n Dim companyAddress As String\n Dim contactNo As String\n\n    companyName = CompanyNameTextBox.Text\n    companyAddress = CompanyAddressTextBox.Text\n    contactNo = ContactNumberTextBox.Text\n\n    'To transfer student details to StudentSubjectForm window\n    StudentSubjectForm.StudentNameDisplayLabel.Caption = studentName\n    StudentSubjectForm.AdmissionNoDisplayLabel.Caption = admissionNo\n    StudentSubjectForm.CourseDisplayLabel.Caption = courseName\n    'To show the student subject form\n    StudentSubjectForm.Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 4, "creation_date": 1455118458, "post_id": 35319309, "comment_id": 58347471, "body": "also you are trying to dim to a collection (Worksheets) instead of an object (Worksheet)"}, {"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 1, "creation_date": 1455121335, "post_id": 35319309, "comment_id": 58349760, "body": "Also you are using <code>with shtThisSheet</code> but then not referencing that in your <code>Range</code> statements. you should be using <code>.Range</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "edited": false, "score": 0, "creation_date": 1455132685, "post_id": 35319368, "comment_id": 58357291, "body": "This fixed the old issue (thank you), Do yo know why it may cause a script out of range error?"}, {"owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "edited": false, "score": 0, "creation_date": 1455141967, "post_id": 35319368, "comment_id": 58362467, "body": "Set shtThisSheet = Application.Workbooks(&quot;Formatting2.xlsm&quot;).Worksheets(&quot;Sheet1&zwnj;&#8203;&quot;)"}, {"owner": {"reputation": 44608, "user_id": 1127114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb1b2345f4c7b696d7c0376d273d01b2?s=128&d=identicon&r=PG", "display_name": "Michael Liu", "link": "https://stackoverflow.com/users/1127114/michael-liu"}, "reply_to_user": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "edited": false, "score": 0, "creation_date": 1455143168, "post_id": 35319368, "comment_id": 58362984, "body": "It probably can&#39;t find an open workbook named Formatting2.xlsm, or it can&#39;t find a sheet named Sheet1 in that workbook."}], "tags": [], "owner": {"reputation": 44608, "user_id": 1127114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb1b2345f4c7b696d7c0376d273d01b2?s=128&d=identicon&r=PG", "display_name": "Michael Liu", "link": "https://stackoverflow.com/users/1127114/michael-liu"}, "is_accepted": false, "score": 10, "last_activity_date": 1455118405, "creation_date": 1455118405, "answer_id": 35319368, "question_id": 35319309, "link": "https://stackoverflow.com/questions/35319309/why-does-my-vba-code-throw-an-invalid-outside-procedure-error/35319368#35319368", "title": "Why does my VBA code throw an &quot;Invalid outside procedure&quot; error?", "body": "<p><code>Set</code> statements aren't allowed outside procedures. Move the <code>Set</code> statement into the <code>Formatting</code> procedure:</p>\n\n<pre><code>Sub Formatting()\n    Set shtThisSheet = Application.Workbook(\"Formatting2.xlsm\").Worksheets(\"Sheet1\")\n    ...\n</code></pre>\n\n<p>(I'd move the <code>Dim</code> statement into the procedure as well. I prefer to avoid global variables when possible.)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "is_accepted": false, "score": 3, "last_activity_date": 1455129376, "creation_date": 1455129376, "answer_id": 35323266, "question_id": 35319309, "link": "https://stackoverflow.com/questions/35319309/why-does-my-vba-code-throw-an-invalid-outside-procedure-error/35323266#35323266", "title": "Why does my VBA code throw an &quot;Invalid outside procedure&quot; error?", "body": "<p>You can declare variables as global, but you cannot set them outside of a procedure such as a sub or function.</p>\n\n<p>If you need this variable as a global, then it's best to set it on.\n    Workbook_Open()</p>\n\n<p>If you do not need it as a global, then move both the declaration and the set statement into your procedure</p>\n"}], "owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66381, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1614238043, "creation_date": 1455118277, "last_edit_date": 1455123211, "question_id": 35319309, "link": "https://stackoverflow.com/questions/35319309/why-does-my-vba-code-throw-an-invalid-outside-procedure-error", "title": "Why does my VBA code throw an &quot;Invalid outside procedure&quot; error?", "body": "<p>For the life of me I cannot figure out why the following code is throwing a compile error with the message \"Invalid outside procedure\". It is highlighting the error on the starred line below. </p>\n\n<pre><code>Option Explicit\n\nDim shtThisSheet As Worksheets\n\n**Set shtThisSheet = Application.Workbook(\"Formatting2.xlsm\").Worksheets(\"Sheet1\")**\n\nSub Formatting()\n\n    With shtThisSheet\n\n        With Range(\"A1\")\n            .Font.Bold = True\n            .Font.Size = 14\n            .HorizontalAlignment = xlLeft\n        End With\n\n        With Range(\"A3:A6\")\n            .Font.Bold = True\n            .Font.Italic = True\n            .Font.ColorIndex = 5\n            .InsertIndent 1\n        End With\n\n        With Range(\"B2:D2\")\n            .Font.Bold = True\n            .Font.Italic = True\n            .Font.ColorIndex = 5\n            .HorizontalAlignment = xlRight\n        End With\n\n        With Range(\"B3:D6\")\n            .Font.ColorIndex = 3\n            .NumberFormat = \"$#,##0\"\n        End With\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "highlighting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1455117816, "post_id": 35319083, "comment_id": 58346940, "body": "&quot;...but it didn&#39;t work.&quot; How doesn&#39;t it work? Do you get an error? Does the macro run, but nothing happens? Please describe how it&#39;s not working like you expect."}, {"owner": {"reputation": 13, "user_id": 5883317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc7f4f138b17e28cb49a506dd2425de?s=128&d=identicon&r=PG&f=1", "display_name": "Vba student", "link": "https://stackoverflow.com/users/5883317/vba-student"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1455117912, "post_id": 35319083, "comment_id": 58347028, "body": "It runs but nothing happens"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1455118107, "post_id": 35319083, "comment_id": 58347183, "body": "Remove your On Error line, run it and see were it breaks.  Then let us know the line that is highlighted when it stops."}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1455118173, "post_id": 35319083, "comment_id": 58347237, "body": "Your code as posted doesn&#39;t compile because the label <code>Err</code> is not defined."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455121661, "post_id": 35319083, "comment_id": 58349995, "body": "@Scott - where are you seeing the error line? Or did it get edited out?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1455121735, "post_id": 35319083, "comment_id": 58350054, "body": "@BruceWayne must have gotten edited out."}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 5719502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bUXs5V4RLU0/AAAAAAAAAAI/AAAAAAAABqQ/xRNG_fkW78Q/photo.jpg?sz=128", "display_name": "K Zombro", "link": "https://stackoverflow.com/users/5719502/k-zombro"}, "is_accepted": false, "score": 0, "last_activity_date": 1455121053, "creation_date": 1455121053, "answer_id": 35320396, "question_id": 35319083, "link": "https://stackoverflow.com/questions/35319083/adding-a-command-click-to-excel-to-search-for-hello/35320396#35320396", "title": "Adding a command click to excel to search for hello", "body": "<p>Your IF conditional is likely not behaving the way you'd like it....\nTry a With... End With for speed / clarity.</p>\n\n<pre><code>With Worksheets(\"detail_report\").Range(\"CZ:CZ\")\n    aCell = .Find(What:=SearchString, LookIn:=xlValues, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False))\n\n    If aCell &lt;&gt; \"\" Then 'this is probably what you want\n        'do your manipulation stuff here\n    End if\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5883317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc7f4f138b17e28cb49a506dd2425de?s=128&d=identicon&r=PG&f=1", "display_name": "Vba student", "link": "https://stackoverflow.com/users/5883317/vba-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455121053, "creation_date": 1455117713, "last_edit_date": 1495540757, "question_id": 35319083, "link": "https://stackoverflow.com/questions/35319083/adding-a-command-click-to-excel-to-search-for-hello", "title": "Adding a command click to excel to search for hello", "body": "<p>I'm trying to add a Search command click to my code on Sheet 3. i created a command click and I tried <a href=\"https://stackoverflow.com/questions/130166/clicking-command-button-from-\">&quot;Clicking&quot; Command Button from other workbook</a>\nother-workbook but it didn't work. Can you tell me what i'm doing wrong, \nI'm fairly new to vba so any help will be appreciated </p>\n\n<pre><code>Sub Sample()\nDim oRange As Range, aCell As Range, bCell As Range\nDim ws As Worksheet\nDim ExitLoop As Boolean\nDim SearchString As String, FoundAt As String\nDim iCount() As String\nDim outws As Worksheet\nDim Sheets As String\n\n\n\nSet ws = Worksheets(\"detail_report\")\n\n Sheets(\"detail_report\").Activate\n ActiveSheet.cmdRefresh_Click\n\nSet oRange = ws.Range(\"CZ:CZ\")\n\nSearchString = \"input\"\n\nSet aCell = oRange.Find(What:=SearchString, LookIn:=xlValues, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False)\n\nIf Not aCell Is Nothing Then\n    Set bCell = aCell\n    FoundAt = aCell.Address\n    Do While ExitLoop = False\n        Set aCell = oRange.FindNext(After:=aCell)\n\n        If Not aCell Is Nothing Then\n            If aCell.Address = bCell.Address Then Exit Do\n            FoundAt = FoundAt &amp; \", \" &amp; aCell.Address\n        Else\n            ExitLoop = True\n        End If\n    Loop\n\n     iCount = Split(FoundAt, \", \")\n\n    Set outws = Worksheets(\"output\")\n\n   outws.Range(\"A2\").Value = SearchString\n\n   outws.Range(\"B2\").Value = UBound(iCount) + 1\n\nElse\n    MsgBox SearchString &amp; \" not Found\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1455116006, "post_id": 35318417, "comment_id": 58345519, "body": "If I understand correctly, let&#39;s say you want this to run on &quot;Sheet1&quot; and &quot;Sheet2&quot;, same cells.  Just add the sheet you want it to update before the <code>Cells()</code>: <code>Sheets(&quot;Sheet1&quot;).Cells(currentrow - 1, 1).Resize(1, 4).Value</code> then just copy/paste and change to &quot;Sheet2&quot;."}, {"owner": {"reputation": 112, "user_id": 4930333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/373773996165145/picture?type=large", "display_name": "Kzhel Farmer", "link": "https://stackoverflow.com/users/4930333/kzhel-farmer"}, "edited": false, "score": 0, "creation_date": 1455116658, "post_id": 35318417, "comment_id": 58346019, "body": "@Muhammad Khurrum Butt Agree with Bruce Wayne i just tested it is working"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1455126337, "creation_date": 1455126337, "answer_id": 35322318, "question_id": 35318417, "link": "https://stackoverflow.com/questions/35318417/update-data-in-two-sheets-excel-vba/35322318#35322318", "title": "Update data in two Sheets Excel VBA", "body": "<p>Just add the sheet you want it to update before the Cells(): <code>Sheets(\"Sheet1\").Cells(currentrow - 1, 1).Resize(1, 4).Value</code> then just copy/paste and change to \"Sheet2\":</p>\n\n<pre><code>Private Sub cmdUpdate_Click()\n    Sheets(\"Sheet1\").Cells(currentrow - 1, 1).Resize(1, 4).Value = Array(TB1.Text,startdate.Text, enddate.Text, ComboB.Text)\n    Sheets(\"Sheet2\").Cells(currentrow - 1, 1).Resize(1, 4).Value = Array(TB1.Text,startdate.Text, enddate.Text, ComboB.Text)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35322318, "answer_count": 1, "score": 1, "last_activity_date": 1455126337, "creation_date": 1455115932, "last_edit_date": 1531161705, "question_id": 35318417, "link": "https://stackoverflow.com/questions/35318417/update-data-in-two-sheets-excel-vba", "title": "Update data in two Sheets Excel VBA", "body": "<p>Is it possible to update data on two sheets that is Sheet1 and Sheet2 data is available in same rows and same column in both sheets</p>\n\n<p>i use this update code </p>\n\n<pre><code>Private Sub cmdUpdate_Click()\n    Cells(currentrow - 1, 1).Resize(1, 4).Value = Array(TB1.Text,startdate.Text, enddate.Text, ComboB.Text)\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1455116241, "post_id": 35318326, "comment_id": 58345686, "body": "Did you tried to use <code>Sheets(&quot;Sheet1&quot;).Range(&quot;A1:K92&quot;) = olMi.Body</code>??"}, {"owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1455116406, "post_id": 35318326, "comment_id": 58345810, "body": "@ElbertVillarreal yes, it just pastes the entire email body into each cell in that range"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1455116746, "post_id": 35318326, "comment_id": 58346079, "body": "And which character is used to split the columns? TAB? Coma?? Space??"}, {"owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1455116979, "post_id": 35318326, "comment_id": 58346255, "body": "@ElbertVillarreal it looks like it&#39;s &quot;enter&quot; to separate each cell. not sure how I could parse that the separate rows vs. columns when it&#39;s the same character for all"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455117171, "post_id": 35318326, "comment_id": 58346395, "body": "@Meghan you could merge, <code>A1:K92</code>, then copy it into the merged range. If that&#39;s an option for you. (I know merged cells can be a nightmare). So your code would be <code>With Sheets(&quot;Sheet1&quot;).Range(&quot;A1:K92&quot;) &lt;br&gt; .Merge &lt;br&gt; .Value = olMi.Body &lt;br&gt; End With</code> <i>(&lt;br&gt; signals line break and should not appear in actual code)</i>."}, {"owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455118342, "post_id": 35318326, "comment_id": 58347373, "body": "@scott I will need to reference individual cells from the email so one merged cell doesn&#39;t help the way I would like it to."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1455118736, "post_id": 35318326, "comment_id": 58347678, "body": "Could you put the body of the email in a text file and post it and send me the link, to see clear all the facts. I think to parse the text is the solution here."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455120171, "post_id": 35318326, "comment_id": 58348831, "body": "What about if you use the word editor to view the email, then you should be able to get the <code>Table</code> object and write the <code>Cells</code> from the <code>Table</code> into the <code>Excel Cells</code>, If you search around a bit, you can find the code to use the <code>Word Inspector</code>(?) to read the email. I&#39;ll see if I can find it."}], "answers": [{"comments": [{"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 1, "creation_date": 1455122314, "post_id": 35320594, "comment_id": 58350477, "body": "Must to say, that answer is great!!! I never tried this, but now, will be part of my own tool box!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1455121583, "creation_date": 1455121583, "answer_id": 35320594, "question_id": 35318326, "link": "https://stackoverflow.com/questions/35318326/vba-copy-email-body-to-excel-as-table/35320594#35320594", "title": "vba copy email body to excel as table", "body": "<p>If you only have 1 table in the email and it's recognized as an actual table this code (to be placed inside the first <code>If</code> block) will work <em>(and has been tested)</em>. You can modify the parts to suit your exact needs, if need be.</p>\n\n<p>Also note, it requires an Reference to the Microsoft Word Object Library (as you have already the Outlook Object Library).</p>\n\n<pre><code>If Format(olMi.ReceivedTime, \"mm/dd/yyyy\") = pnldate Then\n\n    With olMi\n\n        Debug.Print .ReceivedTime\n        Debug.Print .Subject\n\n        Dim olInsp As Outlook.Inspector\n        Set olInsp = .GetInspector\n\n        Dim wdDoc As Word.Document\n        Set wdDoc = olInsp.WordEditor\n\n        Dim tb As Word.Table\n        For Each tb In wdDoc.Tables 'assumes only 1 table\n            Dim y as Long, x as Long\n            For y = 0 To tb.Rows.Count\n                For x = 0 To tb.Columns.Count\n                    Sheets(\"Sheet1\").Range(\"A1\").Offset(y, x).Value = tb.Cell(y, x).Range.Text\n                Next\n            Next\n        Next\n\n    End With\n\n    GoTo AllDone\n\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1455122194, "creation_date": 1455122194, "answer_id": 35320858, "question_id": 35318326, "link": "https://stackoverflow.com/questions/35318326/vba-copy-email-body-to-excel-as-table/35320858#35320858", "title": "vba copy email body to excel as table", "body": "<p>Even Scot give you a great answer, I give my answer, may be could help someone else.</p>\n\n<p>This take the string, and create a table, parsing the data, inside the excel, offset 1 column, but this could be fixed just with a <code>.copy</code>. </p>\n\n<pre><code>Sub convertToTable()\n    Dim bigString As String\n    Dim i\n    Dim lenString\n    Dim n\n    Dim typeChar\n    Dim r\n    Dim rng As Range\n    Dim lineLen\n    Dim a\n    Dim tLen\n    Dim textR\n\n    bigString = Range(\"A1\").Value 'take the value from A1\n    lenString = Len(bigString) 'take the lenght\n\n    Do 'go over the string spliting by the new line character (char10)\n        i = i + 1 'just the index\n        Range(Cells(i, 1), Cells(i, 1)).Value = Left(bigString, InStr(1, bigString, Chr(10)))\n        'important:\n        'use the col 1 to put the values in the sheet, here we split just into rows\n        'you can change the value of the column as you want\n        bigString = Right(bigString, Len(bigString) - InStr(1, bigString, Chr(10)))\n        'here adjust the string to the rest of the text\n    Loop While i &lt; lenString\n\n    r = Range(Cells(1, 1), Cells(1, 1)).End(xlDown).Row 'same as Range(\"A1\").End\n    Set rng = Range(Cells(1, 2), Cells(r, 2)) 'the whole range of data in col A\n\n    a = 1 'here set 1 to use the column B (a = a + 1)\n          'if we delete the data there will be a trouble\n    For Each i In rng 'for each cell/row in the data range in column A\n        tLen = Len(i.Value) 'the lenght\n        textR = i.Value 'the text\n        Do\n            a = a + 1 'the next column...\n            Cells(i.Row, a).Value = Left(textR, InStr(1, textR, Chr(32)))\n            'Left(textR, InStr(1, textR, Chr(32)))\n            'this split the values using the space char (Chr(32)), but you can\n            'change it as you need, just find the spliting character\n            textR = Right(textR, Len(textR) - InStr(1, textR, Chr(32)))\n        Loop While InStr(1, textR, Chr(32)) &lt;&gt; 0\n        a = 1\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1855, "favorite_count": 0, "accepted_answer_id": 35320594, "answer_count": 2, "score": 4, "last_activity_date": 1455122194, "creation_date": 1455115680, "question_id": 35318326, "link": "https://stackoverflow.com/questions/35318326/vba-copy-email-body-to-excel-as-table", "title": "vba copy email body to excel as table", "body": "<p>Hi I have the following code which successfully loops through my folder and pulls the email I want and copies the body (which is in table format) into excel. however, when I paste it In, the entire body gets pasted in cell A1 when it should fill the range A1:K92 as it would if I manually copied and pasted it. is there any way to use vba to paste it in the correct range?\n Thanks!</p>\n\n<pre><code>Sub GetFXEmail()\nDim olApp As Outlook.Application\nDim olNs As Namespace\nDim Fldr As MAPIFolder\nDim olMi As Variant\nDim i As Integer\nSet olApp = New Outlook.Application\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\nSet Fldr = Fldr.Folders(\"MyFolder\")\nSet inboxItems = Fldr.Items\n\npnldate = Format((Date - 1), \"mm/dd/yyyy\")\n\nSet inboxItems = Fldr.Items\ninboxItems.Sort \"[ReceivedTime]\", True\nFor i = 1 To Fldr.Items.Count Step 1\n    Set olMi = Fldr.Items(i)\n        If Format(olMi.ReceivedTime, \"mm/dd/yyyy\") = pnldate Then\n            Debug.Print olMi.ReceivedTime\n            Debug.Print olMi.Subject\n            If InStr(1, olMi.Subject, \"Breakdown\") &gt; 0 Then\n                Sheets(\"Sheet1\").Range(\"A1\") = olMi.Body\n                GoTo AllDone\n            End If\n        End If\nNext i\n\nAllDone:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "row"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1455115710, "post_id": 35318253, "comment_id": 58345310, "body": "you know you can simply; <code>Range(&quot;F2:I4&quot;).Value = Range(&quot;A2:D4&quot;).Value</code>"}, {"owner": {"reputation": 257, "user_id": 2187762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/1O9kW.jpg?s=128&g=1", "display_name": "mcadamsjustin", "link": "https://stackoverflow.com/users/2187762/mcadamsjustin"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455116042, "post_id": 35318253, "comment_id": 58345549, "body": "but I want the a variable to change the value of the second range. I will give the value from the first range a &quot;score&quot; and then place the score in the second range. I just wanted to focus on this issue before doing that calculation"}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 2187762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/1O9kW.jpg?s=128&g=1", "display_name": "mcadamsjustin", "link": "https://stackoverflow.com/users/2187762/mcadamsjustin"}, "edited": false, "score": 0, "creation_date": 1455116483, "post_id": 35318355, "comment_id": 58345881, "body": "That works thanks. Also, my code is not correct, it should be &#39;Set valueRng = Range(&quot;F2:I4&quot;)&#39;. And to your point about simpler way of populating an array of same size and shape, as I mentioned to @Scott, I want to assign a score to the valueand then place the score in the second range. I just wanted to focus on this issue before doing that calculation"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1455116559, "last_edit_date": 1455116559, "creation_date": 1455115771, "answer_id": 35318355, "question_id": 35318253, "link": "https://stackoverflow.com/questions/35318253/get-the-value-of-a-cell-in-range-store-it-a-variable-then-next-cell-next-row/35318355#35318355", "title": "Get the value of a cell in range, store it a variable, then next cell, next row (Excel)", "body": "<p>Use row and column counters instead of <code>For each</code>:</p>\n\n<pre><code>Dim rng As Range\nDim row As Range\nDim cell As Range\nDim card1 As String\nDim card2 As String\nDim card3 As String\nDim card4 As String\nDim card5 As String\nDim valueRng As Range\nDim x as long\nDim y as long\n\nSet rng = Range(\"A2:D4\")\nSet valueRng = Range(\"F2:I4\")\n\n\nFor x = 1 to rng.Rows.Count\n   for y = 1 to rng.Columns.Count\n\n card1 = rng.cells(x, y).Value\n 'Set first variable\n 'Code here for setting value of for first cell in valueRng\n valueRng.Cells(x, y).Value = card1\n\nNext y  \nNext x\n</code></pre>\n\n<p>Note that there are far simpler ways of populating one array from another when they are the same size and shape.</p>\n"}], "owner": {"reputation": 257, "user_id": 2187762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/1O9kW.jpg?s=128&g=1", "display_name": "mcadamsjustin", "link": "https://stackoverflow.com/users/2187762/mcadamsjustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36494, "favorite_count": 0, "accepted_answer_id": 35318355, "answer_count": 1, "score": 0, "last_activity_date": 1455116559, "creation_date": 1455115475, "question_id": 35318253, "link": "https://stackoverflow.com/questions/35318253/get-the-value-of-a-cell-in-range-store-it-a-variable-then-next-cell-next-row", "title": "Get the value of a cell in range, store it a variable, then next cell, next row (Excel)", "body": "<p>I'd like to get the value of a cell in a range and store it as a variable.  And then set the value of another cell in another range as that variable. Then move on to the cell. After all the cells in the row are captured, I'd like to move to the next row and start again with the first cell and first variable. I can't figure out how to move to the next cell and then set the value in the new range to the variable. Here's what I got so far</p>\n\n<pre><code>Dim rng As Range\nDim row As Range\nDim cell As Range\nDim card1 As String\nDim card2 As String\nDim card3 As String\nDim card4 As String\nDim card5 As String\nDim valueRng As Range\n\nSet rng = Range(\"A2:D4\")\nSet valueRng = (\"F2:I4\")\n\n\nFor Each row In rng.Rows\n For Each cell In row.Cells\n card1 = cell.Value\n 'Set first variable\n 'Code here for setting value of for first cell in valueRng\n\n'Move to second cell\n'get value\n'set variable card2\n'Set value of second cell in valueRng\n\nNext cell  \nNext row\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1455118879, "post_id": 35318173, "comment_id": 58347788, "body": "Why is <code>rownumber2</code> Double? Couldn&#39;t it be just integer?"}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "edited": false, "score": 0, "creation_date": 1455118968, "post_id": 35318173, "comment_id": 58347849, "body": "So your code worked for me. Is the workbook protected by any chance?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5908710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a48ddad7a94aefb526e9cba0e5295b3?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick A", "link": "https://stackoverflow.com/users/5908710/patrick-a"}, "edited": false, "score": 0, "creation_date": 1455201861, "post_id": 35321517, "comment_id": 58391837, "body": "Looking back that could definitely be the issue not clearing the variable once it leaves the for loop"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1455123989, "creation_date": 1455123989, "answer_id": 35321517, "question_id": 35318173, "link": "https://stackoverflow.com/questions/35318173/application-defined-or-object-defined-error-if-statement/35321517#35321517", "title": "Application-defined or object-defined error IF statement", "body": "<p>What's the value of rowNumber2 when it fails ? </p>\n\n<p>You never reset its value, so eventually it will exceed the number of rows in a sheet. Maybe you mean to reset it to 2 each time through the \"j\" loop...</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5908710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a48ddad7a94aefb526e9cba0e5295b3?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick A", "link": "https://stackoverflow.com/users/5908710/patrick-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1455201765, "creation_date": 1455201765, "answer_id": 35342365, "question_id": 35318173, "link": "https://stackoverflow.com/questions/35318173/application-defined-or-object-defined-error-if-statement/35342365#35342365", "title": "Application-defined or object-defined error IF statement", "body": "<p>So I couldn't figure out why that code was not working so I solved the problem by changing the code to this.</p>\n\n<pre><code>Sub stock()\nApplication.ScreenUpdating = False\nDim rownumber As Long\nDim rng As Range, i As Range, j As Range, rng2 As Range\nrownumber = 0 'Machining 900#\nSet rng = Range(\"j1:j1921\")\nSet rng2 = Range(\"A2:A62685\")\nFor Each i In rng\n    rownumber = rownumber + 1\n    For Each j In rng2\n        If i = j Then\n            If j.Offset(0, 1) &lt;&gt; \"Active\" Then\n                Cells(rownumber, 10).Interior.ColorIndex = 3\n                a = j.Offset(0, 1).Value\n                i.Offset(0, 1).Value = a\n            Exit For\n            End If\n            Exit For\n        End If\n     Next\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5908710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a48ddad7a94aefb526e9cba0e5295b3?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick A", "link": "https://stackoverflow.com/users/5908710/patrick-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455201765, "creation_date": 1455115278, "question_id": 35318173, "link": "https://stackoverflow.com/questions/35318173/application-defined-or-object-defined-error-if-statement", "title": "Application-defined or object-defined error IF statement", "body": "<p>I get Run-time error '1004' Application-defined or object-defined error.\nit get's stuck on this If statement</p>\n\n<pre><code>If Cells(rownumber2, 2).Value &lt;&gt; 1 Then\n</code></pre>\n\n<p>Any help would be appropriated</p>\n\n<pre><code>Sub stock()\nApplication.ScreenUpdating = False\nDim rownumber As Long\nDim rownumber2 As Double\nDim rng As Range, i As Range, j As Range, rng2 As Range\nrownumber = 0 'Machining 900#\nrownumber2 = 1 'maximo 900#\nSet rng = Range(\"j1:j1910\")\nSet rng2 = Range(\"A2:A62685\")\nFor Each i In rng\n    rownumber = rownumber + 1\n    For Each j In rng2\n    rownumber2 = rownumber2 + 1\n    If i = j Then\n        If Cells(rownumber2, 2).Value &lt;&gt; 1 Then\n        'If (IsNumber(Search(\"*Active*\", Cells(rownumber2, 2)))) Then\n            Cells(rownumber, 10).Interior.ColorIndex = 5\n        Exit For\n        End If\n        Exit For\n    End If\n Next\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "odbc", "excel-2016"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6354206, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1bdeee6dbfe9746d54b34705b661099f?s=128&d=identicon&r=PG", "display_name": "ameyer", "link": "https://stackoverflow.com/users/6354206/ameyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1463632538, "creation_date": 1463632538, "answer_id": 37314028, "question_id": 35317762, "link": "https://stackoverflow.com/questions/35317762/querytable-commandtext-not-found/37314028#37314028", "title": "QueryTable CommandText Not Found", "body": "<p>I was going crazy trying to find a workaround for this when I came across your question, wishing someone had answered it. I just discovered a work-around today. My problem seems similar to yours so maybe my solution will help you out:</p>\n\n<p>I was unable to use QueryTables.Add or CommandText in VBA, but I was able to create the tables manually and then use data from the excel sheet as a parameter.<br>\n  I created the ODBC connection manually by clicking New Database Query>From Database, which you probably know how to do. I entered my SQL into the Microsoft Query window as such:</p>\n\n<pre><code>    SELECT DISTINCT WIN\n  FROM RETAIL.OFFER\n  WHERE WIN LIKE 'XS%'\n  AND WIN NOT LIKE 'XS92500' \n  AND WIN NOT LIKE 'XS%a'\n  AND TITLE = 'The Binge'\n</code></pre>\n\n<p>I'm new to SQL so it may not be pretty but it worked. However, I needed the title to be a parameter that came from a cell in the spreadsheet instead of having to go in and manually update the SQL each time. I was able to do this by going into Connections>Properties>Definition>Edit Query and changing the SQL to this:</p>\n\n<pre><code>    SELECT DISTINCT WIN\n  FROM RETAIL.OFFER\n  WHERE WIN LIKE 'XS%'\n  AND WIN NOT LIKE 'XS92500' \n  AND WIN NOT LIKE 'XS%a'\n  AND TITLE = ?\n</code></pre>\n\n<p>Note: It only worked when I actually pressed the Edit Query button, it changed all the ' to curvy apostrophes if I edited it in the Definition window. \n  Excel then prompted me to select a parameter to replace the ? in the SQL. You can select a cell in the spreadsheet or enter any other string for the parameter. You can also go back into connections and edit the parameters if needed.<br>\n  Now, I just use a VBA macro to refresh all connections and pass the data from the cells into the query. This works in my use case, sorry if you already knew about making parameters in this way and you need to use VBA.  I couldn't get my VBA to work on my mac either, even though it worked perfectly on my PC. Hopefully this will be helpful to someone out there!  </p>\n"}], "owner": {"reputation": 2969, "user_id": 2200824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/14d5e4db680bf435588c48c505301479?s=128&d=identicon&r=PG", "display_name": "ARich", "link": "https://stackoverflow.com/users/2200824/arich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593562361, "creation_date": 1455114246, "last_edit_date": 1593562361, "question_id": 35317762, "link": "https://stackoverflow.com/questions/35317762/querytable-commandtext-not-found", "title": "QueryTable CommandText Not Found", "body": "<p>I'm building an Excel-based tool that has to be both Windows and Mac compatible. This tool needs to pull data from and push data to a SQL Server. I've written and tested a way to do this that works in Windows and should work in Mac <a href=\"http://answers.microsoft.com/en-us/mac/forum/macoffice2011-macexcel/querytable-object-not-the-same-as-on-pc/41987dfd-5cb4-46c5-af79-e883755fc82a\" rel=\"nofollow\">as described here</a> (though that link pertains to Excel 2011):</p>\n\n<pre><code>On Error GoTo err1\nDim connstring As String\nDim sqlstring As String\nDim dArr As Variant\nDim qt As QueryTable\nDim sht As Worksheet\nSet sht = ThisWorkbook.Sheets(1)\nconnstring = \"ODBC;DRIVER={SQL Server};SERVER=SERVERNAME;DATABASE=master;Trusted_Connection=yes\"\nsqlstring = \"SELECT 1\"\n\nSet qt = sht.QueryTables.Add(Connection:=connstring, Destination:=sht.Range(\"A1\"), Sql:=sqlstring)\n\nWith qt\n  .BackgroundQuery = False\n  .RowNumbers = False\n  .Refresh\nEnd With\n</code></pre>\n\n<p>This approach doesn't work in Excel 2016 for Mac. In fact, when I record the process of adding a connection on a Mac, the QueryTables.Add method doesn't even show a Connection or SQL argument...</p>\n\n<p>Instead of creating the tables programmatically, I thought a workaround could be to manually create the tables and then change the CommandText for the tables programmatically as needed (for different parameters, etc.). But when I try to access the CommandText property of the QueryTable object, the Mac VBEditor tells me that it can't find the member! </p>\n\n<p>Has anyone successfully created ODBC QueryTables programmatically in Excel 2016 for Mac or is this another shortfall of Excel 2016?</p>\n"}, {"tags": ["vba", "date", "search", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5903421"}, "edited": false, "score": 0, "creation_date": 1455110742, "post_id": 35316466, "comment_id": 58341683, "body": "Have you tried <code>Datetime.Now</code> instead of <code>Now</code>?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455118032, "post_id": 35316466, "comment_id": 58347128, "body": "This question shows a woeful lack of serious research. If you&#39;d attempted searching the date using Word&#39;s built-in Find functionality and recorded that in a macro you&#39;d have had the beginnings of a useful code basis. &quot;It doesn&#39;t work&quot; is not a useful problem description. You need to detail HOW it doesn&#39;t work. I&#39;m pretty sure you&#39;re getting an error message and which line is generating it. Record the Find macro for the current date. Click EDIT below your question and subsitute that code. Then ask how it can be adjusted to find &quot;today&#39;s date&quot; for any day and we can help you."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455124179, "post_id": 35316466, "comment_id": 58351861, "body": "You declare c as String, but then use Set to assign a values: Set is only used when assigning values to object-type variables."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1455127299, "post_id": 35316466, "comment_id": 58353898, "body": "Make habit of break mode and use <code>Msgbox</code> to display results so that you can know where the problem is."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1455127622, "post_id": 35316466, "comment_id": 58354092, "body": "What You want to do after find?"}], "answers": [{"tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": true, "score": 1, "last_activity_date": 1455128985, "creation_date": 1455128985, "answer_id": 35323153, "question_id": 35316466, "link": "https://stackoverflow.com/questions/35316466/search-for-the-date-of-today-in-a-word-doc-filled-with-dates/35323153#35323153", "title": "Search for the date of today in a Word doc filled with dates", "body": "<p>Is this you are looking for?</p>\n\n<pre><code>Sub Demo123()\nApplication.ScreenUpdating = False\nDim s As String\ns = Format(Now(), \"DD.MM.YYYY\")\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = s\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = False\n    .Execute\n  End With\n  Do While .Find.Found\n      .HighlightColorIndex = wdYellow\n      'or do whatever you want\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5908515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c17a32ebe213475025a669c1148b693?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/5908515/willem"}, "reply_to_user": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1457963454, "post_id": 35343643, "comment_id": 59631109, "body": "Thanks again, Rahul. I didn&#39;t notice the accept-function before. I have accepted."}], "tags": [], "owner": {"reputation": 25, "user_id": 5908515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c17a32ebe213475025a669c1148b693?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/5908515/willem"}, "is_accepted": false, "score": 0, "last_activity_date": 1455205146, "creation_date": 1455205146, "answer_id": 35343643, "question_id": 35316466, "link": "https://stackoverflow.com/questions/35316466/search-for-the-date-of-today-in-a-word-doc-filled-with-dates/35343643#35343643", "title": "Search for the date of today in a Word doc filled with dates", "body": "<p>Many thanks, Rahul</p>\n\n<p>You helped me see the way. I eventually came up with this, which does the trick. To answer your side question, after Find it just had to go there.</p>\n\n<pre><code>Sub Today()\nDim s As String\ns = Format(Now(), \"DD.MM.YYYY^p\")\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = s\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\n    If Selection.Find.Found Then\n    Exit Sub\n    Else\n    MsgBox \"Date not found.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>All the best,</p>\n\n<p>Willem</p>\n"}], "owner": {"reputation": 25, "user_id": 5908515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c17a32ebe213475025a669c1148b693?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/5908515/willem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 35323153, "answer_count": 2, "score": -1, "last_activity_date": 1455205146, "creation_date": 1455110532, "last_edit_date": 1455112353, "question_id": 35316466, "link": "https://stackoverflow.com/questions/35316466/search-for-the-date-of-today-in-a-word-doc-filled-with-dates", "title": "Search for the date of today in a Word doc filled with dates", "body": "<p>I have Word doc filled with dates of several years. I would like to add a macro that searches today. The format of the date is DD.MM.YYYY. I tried many things in vain. The last thing I tried was:</p>\n\n<pre><code>Sub Today\n    Dim c As String\n    Set c = Format(Now(), \"DD.MM.YYYY\")\n    c.Find.ClearFormatting\n    c.Find.Execute\nEnd Sub\n</code></pre>\n\n<p>But it does not work...</p>\n"}, {"tags": ["vba", "excel", "error-handling", "copy-paste"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455109733, "post_id": 35315837, "comment_id": 58340958, "body": "Wouldn&#39;t it be easier to copy the sheet, then just delete what you don&#39;t need?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455110227, "post_id": 35315837, "comment_id": 58341307, "body": "Adding the sheet clears the clipboard. You should add it, then copy and paste."}, {"owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455110443, "post_id": 35315837, "comment_id": 58341457, "body": "I have already tried to add a new sheet first and then copy, but I am still getting the same error."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455110850, "post_id": 35315837, "comment_id": 58341768, "body": "what happens if you change <code>.Copy</code> to <code>.SpecialCells(xlCellTypeVisible).Copy</code>.  And while you are at it, change <code>Sheets.Add</code> to <code>ThisWorkbook.Sheets.Add</code> (and separate out the add and the paste calls)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455110945, "post_id": 35315837, "comment_id": 58341851, "body": "What code did you try exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455111587, "post_id": 35316793, "comment_id": 58342342, "body": "Hmmm it is still not working. Maybe something is wrong with raw data? Raw data is just number and string, that is it :/"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455112136, "post_id": 35316793, "comment_id": 58342704, "body": "Do you have any merged cells in the source data?"}, {"owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455112416, "post_id": 35316793, "comment_id": 58342890, "body": "The first row is merged but that is why I am using this in the code: <code>With .Cells.Resize(.rows.Count - 1, .Columns.Count).Offset(1, 0)</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455112526, "post_id": 35316793, "comment_id": 58342962, "body": "Does it work if you replace (just to test) the two copy/paste special lines with just this: <code>.Copy Destination:=ws.Cells(1, 1)</code>"}, {"owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455112729, "post_id": 35316793, "comment_id": 58343111, "body": "in this case the error message is: <b>Copy method of range class failed</b>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455112871, "post_id": 35316793, "comment_id": 58343201, "body": "And if you use two lines: <code>.Copy</code> followed by <code>ws.Paste</code>?"}, {"owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455113910, "post_id": 35316793, "comment_id": 58343967, "body": "Still getting error: <b>Method Paste of object _Worksheet failed</b>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455116065, "post_id": 35316793, "comment_id": 58345565, "body": "Can you put a sample file somewhere (Onedrive / Dropbox etc) and post a link here so I can see what&#39;s happening?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455117904, "post_id": 35316793, "comment_id": 58347024, "body": "The revised code I posted works fine for me with that workbook."}, {"owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455121381, "post_id": 35316793, "comment_id": 58349787, "body": "Yes, revised code is working. Can you please tell me what caused the issue? What was wrong with my code? Thanks"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "edited": false, "score": 0, "creation_date": 1455121574, "post_id": 35316793, "comment_id": 58349929, "body": "Mostly the fact that you were copying almost all the cells on the sheet, which caused a memory issue I think."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1455114580, "last_edit_date": 1455114580, "creation_date": 1455111429, "answer_id": 35316793, "question_id": 35315837, "link": "https://stackoverflow.com/questions/35315837/pastespecial-method-of-range-class-failed-excel-vba/35316793#35316793", "title": "Pastespecial method of range class failed - Excel VBA", "body": "<p>This should work:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = Sheets.Add(After:=Sheets(Sheets.Count))\nws.Name = \"TEMP\"\nWith s1\n    If .AutoFilterMode Then .AutoFilterMode = False\n    With .Cells.Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n    If CBool(Application.Subtotal(103, .Cells)) Then\n        .AutoFilter Field:=vCols(0), Criteria1:=FilterFor\n        .Copy\n        ws.Cells(1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    End If\n    End With\nEnd With\n</code></pre>\n\n<p>Or some completely revised code:</p>\n\n<pre><code>Sub copypaste()\n\n    Dim i, j, v               As Long\n    Dim vSearchCols           As Variant\n    Dim vCols                 As Variant\n    Dim FilterFor             As String\n    Dim ws                    As Worksheet\n    Dim s1                    As Worksheet\n    Dim s2                    As Worksheet\n\n\n    FilterFor = \"=AF*\"\n    With ThisWorkbook\n        Set s1 = .Worksheets(\"RAW DATA\")\n        Set s2 = .Worksheets(\"AF SITE TYPE\")\n        Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    End With\n    ws.Name = \"TEMP\"\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .EnableEvents = False\n    End With\n\n    vSearchCols = Array(\"Prefix+short name\", \"Site type\", \"Probe Id\", \"Owner\", \"SLA Target\", \"Avg RTT (ms)\", \"Completion (ms)\")\n    ReDim vCols(0 To UBound(vSearchCols))\n    For v = LBound(vSearchCols) To UBound(vSearchCols)\n        vCols(v) = s1.Rows(2).Cells.Find(What:=vSearchCols(v), LookIn:=xlFormulas, LookAt:=xlWhole).Column\n    Next v\n\n    With s1\n        .AutoFilterMode = False\n        With .Range(\"A1\").CurrentRegion\n            .AutoFilter Field:=vCols(0), Criteria1:=FilterFor\n            If .Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n                .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0).SpecialCells(xlCellTypeVisible).Copy\n                ws.Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            End If\n        End With\n    End With\n    With Application\n        .DisplayAlerts = True\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 5139028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/437175612308a7677a275f82b2f99932?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/5139028/erika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 35316793, "answer_count": 1, "score": 0, "last_activity_date": 1455114580, "creation_date": 1455108766, "last_edit_date": 1531164843, "question_id": 35315837, "link": "https://stackoverflow.com/questions/35315837/pastespecial-method-of-range-class-failed-excel-vba", "title": "Pastespecial method of range class failed - Excel VBA", "body": "<p>I need you help. I really do not understand what is the wrong with my code. I always get an error message at this point: </p>\n\n<pre><code>Sheets.Add(After:=Sheets(Sheets.Count)).Cells(1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>The error message is that: <strong>Pastespecial method of range class failed</strong> </p>\n\n<p>What I want is to filter the raw data and copy the result to a new sheet in the workbook.</p>\n\n<p>Do you have any suggestion what is the problem with my code?\nThank you for your help in advance!</p>\n\n<pre><code> Sub copypaste()\n\n    Dim i, j, v As Long\n    Dim vSearchCols As Variant\n    Dim vCols As Variant\n    Dim FilterFor As String\n\n    FilterFor = \"=AF*\"\n    Set s1 = ThisWorkbook.Worksheets(\"RAW DATA\")\n    Set s2 = ThisWorkbook.Worksheets(\"AF SITE TYPE\")\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n\n    With s1\n        vSearchCols = Array(\"Prefix+short name\", \"Site type\", \"Probe Id\", \"Owner\", \"SLA Target\", \"Avg RTT (ms)\", \"Completion (ms)\")\n        ReDim vCols(0 To UBound(vSearchCols))\n            For v = LBound(vSearchCols) To UBound(vSearchCols)\n                vCols(v) = .rows(2).Cells.Find(What:=vSearchCols(v), LookIn:=xlFormulas, LookAt:=xlWhole).Column\n            Next v\n    End With\n\n    With s1\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells.Resize(.rows.Count - 1, .Columns.Count).Offset(1, 0)\n        If CBool(Application.Subtotal(103, .Cells)) Then\n            .AutoFilter Field:=vCols(0), Criteria1:=FilterFor\n            .Copy\n            Sheets.Add(After:=Sheets(Sheets.Count)).Cells(1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            ActiveSheet.Name = \"TEMP\"\n        End If\n        End With\n    End With\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1455106382, "post_id": 35314797, "comment_id": 58338482, "body": "have you tried changing <code>currentrow</code> to <code>currentrow - 1</code> ?"}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455107113, "post_id": 35314797, "comment_id": 58339031, "body": "@MacroMan you are right it is working"}], "answers": [{"tags": [], "owner": {"reputation": 112, "user_id": 4930333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/373773996165145/picture?type=large", "display_name": "Kzhel Farmer", "link": "https://stackoverflow.com/users/4930333/kzhel-farmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1455106901, "creation_date": 1455106901, "answer_id": 35315179, "question_id": 35314797, "link": "https://stackoverflow.com/questions/35314797/update-is-not-working-excel-vba/35315179#35315179", "title": "Update is not working Excel VBA", "body": "<p>Try this sub </p>\n\n<pre><code>  Private Sub cmdUpdate_Click()\n   Dim evtname As String, sname As String, sdate As String, edate As String\n    evtname = TB1.Text\n      Cells(currentrow - 1, 1).Value = evtname\n    sname = ComboB.Text\n     Cells(currentrow - 1, 4).Value = sname\n   sdate = startdate.Text\n       Cells(currentrow - 1, 2).Value = sdate\n   edate = enddate.Text\n  Cells(currentrow - 1, 3).Value = edate\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455109206, "post_id": 35315256, "comment_id": 58340591, "body": "it is helpful but it is only updating the LAST ROW how can i set it up to look for data and update in any row"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 1, "creation_date": 1455109272, "post_id": 35315256, "comment_id": 58340640, "body": "we don&#39;t know where <code>currentrow</code> gets it&#39;s value from, so there is not enough information for us to help"}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455109810, "post_id": 35315256, "comment_id": 58341001, "body": "sorry for that in edit it was removed &quot;Dim currentrow As Long&quot;"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 1, "creation_date": 1455109848, "post_id": 35315256, "comment_id": 58341028, "body": "that just tells me how it was declared, we need to know where it gets it&#39;s value from."}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455110310, "post_id": 35315256, "comment_id": 58341356, "body": "i just update the code in question that is full code for FIND and Update button i really don&#39;t know currentrow gets value from!"}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455115226, "post_id": 35315256, "comment_id": 58344962, "body": "is it possible to update two sheets at a time with same data in same rows same column sheet 1 and sheet 2"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455115381, "post_id": 35315256, "comment_id": 58345059, "body": "Yes, but that&#39;s outside the scope of this question - please start a new question for that."}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455115959, "post_id": 35315256, "comment_id": 58345489, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/103115/discussion-between-muhammad-khurrum-butt-and-macro-man\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1455110762, "last_edit_date": 1455110762, "creation_date": 1455107116, "answer_id": 35315256, "question_id": 35314797, "link": "https://stackoverflow.com/questions/35314797/update-is-not-working-excel-vba/35315256#35315256", "title": "Update is not working Excel VBA", "body": "<p>Try this instead - there is no need to assign variables for the scope of this sub and you can do the whole thing with a single line of code:</p>\n\n<pre><code>Private Sub cmdUpdate_Click()\n    Cells(currentrow - 1, 1).Resize(1, 4).Value = Array(TB1.Text, startdate.Text, enddate.Text, ComboB.Text)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To get the right row rather than the last row:  </p>\n\n<p>You need to exit your loop when the condition has been found, so that <code>currentrow</code> retains the correct value. In both of your find subs, exit the loop at the end of your <code>If</code> block:</p>\n\n<pre><code>'// existing code here\nExit For '&lt;~~ add this in both subs.\nEnd If\n</code></pre>\n\n<p>Once you have done that, change <code>currentrow - 1</code> back to <code>currentrow</code> to make sure it's the right row.</p>\n"}], "owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 35315256, "answer_count": 2, "score": -1, "last_activity_date": 1455110762, "creation_date": 1455105971, "last_edit_date": 1455110206, "question_id": 35314797, "link": "https://stackoverflow.com/questions/35314797/update-is-not-working-excel-vba", "title": "Update is not working Excel VBA", "body": "<p>update button is not functioning properly it is just adding up new row with data instead of updating </p>\n\n<pre><code>Dim currentrow As Long\n\n        Private Sub cmdFindNext_Click()\n        Dim lastrow\n        Dim evtname As String\n        lastrow = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        evtname = TB1.Text\n        For currentrow = 4 To lastrow\n        If Cells(currentrow, 1).Text = evtname Then\n        TB1.Text = Cells(currentrow, 1).Text\n        ComboB.Text = Cells(currentrow, 4)\n        startdate.Text = Cells(currentrow, 2)\n        enddate.Text = Cells(currentrow, 3)\n        End If\n        Next currentrow\n        TB1.SetFocus\n        End Sub\n\n        Private Sub cmdFindPrevious_Click()\n        Dim lastrow\n        Dim evtname As String\n        lastrow = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        evtname = TB1.Text\n        For currentrow = lastrow To 4 Step -1\n        If Cells(currentrow, 1).Text = evtname Then\n        TB1.Text = Cells(currentrow, 1).Text\n        ComboB.Text = Cells(currentrow, 4)\n        startdate.Text = Cells(currentrow, 2)\n        enddate.Text = Cells(currentrow, 3)\n        End If\n        Next currentrow\n        TB1.SetFocus\n        End Sub\n\n        Private Sub cmdUpdate_Click()\n        Cells(currentrow - 1, 1).Resize(1, 4).Value = Array(TB1.Text,     startdate.Text, enddate.Text, ComboB.Text)\n\n        End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/J2Ys7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J2Ys7.jpg\" alt=\"update\"></a></p>\n\n<p>What can i do about that update i added textboxes to make it simple that date controls but still its same</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455108942, "post_id": 35314421, "comment_id": 58340399, "body": "Your question makes no sense - a string wouldn&#39;t make the cell bold or underlined, and there is other text in the cell that you haven&#39;t said if you want to change also"}, {"owner": {"reputation": 21, "user_id": 5907925, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126861434011277/picture?type=large", "display_name": "Suganthan Srinivasan", "link": "https://stackoverflow.com/users/5907925/suganthan-srinivasan"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455165767, "post_id": 35314421, "comment_id": 58369932, "body": "I need only the particular text &quot;Highlights for current week:&quot; in the cell to be bold and underline  Could you hard code the above property and reply please?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5907925, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126861434011277/picture?type=large", "display_name": "Suganthan Srinivasan", "link": "https://stackoverflow.com/users/5907925/suganthan-srinivasan"}, "edited": false, "score": 0, "creation_date": 1455166036, "post_id": 35316807, "comment_id": 58370009, "body": "I need only the particular text &quot;Highlights for current week:&quot; in the cell to be bold and underline Could you hard code the above property and reply please?"}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 4, "last_activity_date": 1455180622, "last_edit_date": 1455180622, "creation_date": 1455111484, "answer_id": 35316807, "question_id": 35314421, "link": "https://stackoverflow.com/questions/35314421/how-to-make-particular-text-in-a-cell-bold-and-underlined/35316807#35316807", "title": "How to make particular text in a cell Bold and Underlined", "body": "<p>Yes you can.  The bold and italic properties belong to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840959.aspx\" rel=\"nofollow\">Font object</a>, which can be accessed via a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">range object</a>.</p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>ActiveCell.Font.Bold = True\nActiveCell.Font.Italic = True\n</code></pre>\n\n<p>This example updates the currently active cell.  </p>\n\n<p><strong>Updated</strong></p>\n\n<p>If you only want to apply a style to part of a cell the syntax is a little different.</p>\n\n<p><strong>Partial Formatting Example</strong></p>\n\n<pre><code>ActiveCell.Characters(Start:=1 Length:=10).Font.Bold = True\n</code></pre>\n\n<p>The start and length parameters control which characters are shown in bold.</p>\n\n<p>Did you know Excel can write the VBA for you?  Look for the macro recorder in the bottom left corner.  When active Excel will translate your manual actions into VBA.  This is a great way to discover the required code.</p>\n"}], "owner": {"reputation": 21, "user_id": 5907925, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126861434011277/picture?type=large", "display_name": "Suganthan Srinivasan", "link": "https://stackoverflow.com/users/5907925/suganthan-srinivasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4775, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458479857, "creation_date": 1455104980, "last_edit_date": 1531164843, "question_id": 35314421, "link": "https://stackoverflow.com/questions/35314421/how-to-make-particular-text-in-a-cell-bold-and-underlined", "title": "How to make particular text in a cell Bold and Underlined", "body": "<pre><code> strProject = Trim(ThisWorkbook.Sheets(\"Proposed\").Cells(i, 2).Value)\n       On Error Resume Next\n       Set objWorkSheet = objWorkbook.Sheets(\"\" &amp; strProject &amp; \"\")\n       If Not objWorkSheet Is Nothing Then\n            ThisWorkbook.Sheets(\"Proposed\").Cells(i, 5).Value = Trim(objWorkSheet.Cells(12, 6).Value)\n            ThisWorkbook.Sheets(\"Proposed\").Cells(i, 6).Value = \"Highlights for current week:\" + Chr(10) + Trim(objWorkSheet.Cells(22, 2).Value) + Chr(10) + Chr(10) + \"Action Plan for next Week:\" + Chr(10) + Trim(objWorkSheet.Cells(27, 2).Value)\n</code></pre>\n\n<p>How do I make \"Highlights for current week:\" bold and underlined?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 2, "last_activity_date": 1455104910, "creation_date": 1455104910, "answer_id": 35314401, "question_id": 35314047, "link": "https://stackoverflow.com/questions/35314047/copy-cells-to-active-worksheet-from-a-defined-range-of-sheets/35314401#35314401", "title": "Copy cells to active worksheet from a defined RANGE of SHEETS", "body": "<p>You can use the sheet index such as</p>\n\n<pre><code>    Sub SheetIndx()\n    If Sheets.Count &gt;= 7 Then\n        ActiveSheet.Range(\"A1:B4\").Copy Sheets(6).Cells(Sheets(6).Rows.Count, \"A\").End(xlUp).Offset(1)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Or the actual sheet6, regardless of that the name of the sheet is, it is still sheet6 and doesn't matter what order it is in the workbook.</p>\n\n<pre><code>Sub Sheet()\n    If Sheets.Count &gt;= 7 Then\n        ActiveSheet.Range(\"A1:B4\").Copy Sheet6.Cells(Sheet6.Rows.Count, \"A\").End(xlUp).Offset(1)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5907895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccde9c74a3d4e2c4a6abf61b1b3efab?s=128&d=identicon&r=PG&f=1", "display_name": "Kazzy", "link": "https://stackoverflow.com/users/5907895/kazzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455108840, "creation_date": 1455103985, "last_edit_date": 1531164843, "question_id": 35314047, "link": "https://stackoverflow.com/questions/35314047/copy-cells-to-active-worksheet-from-a-defined-range-of-sheets", "title": "Copy cells to active worksheet from a defined RANGE of SHEETS", "body": "<p>I need to copy a particular cell value to the current activesheet from worksheets between a predefined worksheet range. For example only the sheets between Sheet5 and Sheet7.  I cannot specify the worksheet names as they do not yet exist.  They will be created by the user via another macro upon request and placed within this predefined worksheet range upon creation.</p>\n\n<p>In essence, I think I need to somehow <strong>define a Workbook Range between</strong> Sheet5 and Sheet7. Coincidentally, the new sheets will ALWAYS be within the sheet range of sheet 5 to 7.</p>\n"}, {"tags": ["excel", "macos", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5682366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fc830fcf87e58eb9777710712383e9?s=128&d=identicon&r=PG&f=1", "display_name": "Zara", "link": "https://stackoverflow.com/users/5682366/zara"}, "edited": false, "score": 0, "creation_date": 1455169880, "post_id": 35314360, "comment_id": 58371346, "body": "Thanks for your quick reply. But it is a template file. It shows the default save as type as All Files. But I want to show default save as type as xlsm in save as dialog. Is it that possible"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1455104836, "creation_date": 1455104836, "answer_id": 35314360, "question_id": 35313642, "link": "https://stackoverflow.com/questions/35313642/show-save-as-dialogbox-in-mac-excel-2011-using-vba/35314360#35314360", "title": "Show \u201cSave As\u201d dialogbox in Mac excel 2011 using vba", "body": "<p>There are some features that do not work on MacOS, try this as an alternative:</p>\n\n<pre><code>Dim saveName As Variant\n\nsaveName = Application.GetSaveAsFileName()\n\nIf Not saveName = False Then\n    ActiveWorkbook.SaveAs CStr(saveName)\nElse\n    MsgBox \"File not saved!\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5682366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fc830fcf87e58eb9777710712383e9?s=128&d=identicon&r=PG&f=1", "display_name": "Zara", "link": "https://stackoverflow.com/users/5682366/zara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455104836, "creation_date": 1455102916, "last_edit_date": 1455104652, "question_id": 35313642, "link": "https://stackoverflow.com/questions/35313642/show-save-as-dialogbox-in-mac-excel-2011-using-vba", "title": "Show \u201cSave As\u201d dialogbox in Mac excel 2011 using vba", "body": "<p>How to show save as dialog box with xlsm as default save as file type in mac excel 2011?</p>\n\n<pre><code>Application.FileDialog(msoFileDialogSaveAs)  \n</code></pre>\n\n<p>works fine in windows. But it throws error in Mac</p>\n\n<p>Thanks in Advance!!!</p>\n"}, {"tags": ["vba", "iframe", "amazon"], "comments": [{"owner": {"reputation": 1595, "user_id": 5276890, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VfQC8.jpg?s=128&g=1", "display_name": "Roy Falk", "link": "https://stackoverflow.com/users/5276890/roy-falk"}, "edited": false, "score": 0, "creation_date": 1455103099, "post_id": 35313310, "comment_id": 58336248, "body": "Welcome to stackoverflow. Please go through the tour and the faq before asking questions. Your question is also in need of editing. The code is all in one line."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5598099, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/dcaeb288166361dfd9680c69aabec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tahir Mehmood", "link": "https://stackoverflow.com/users/5598099/tahir-mehmood"}, "edited": false, "score": 0, "creation_date": 1455166292, "post_id": 35321920, "comment_id": 58370075, "body": "I use above method but still error is same i.e Object does not support this property or method,Please note that i am using MS Access VBA."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1455167028, "last_edit_date": 1455167028, "creation_date": 1455125194, "answer_id": 35321920, "question_id": 35313310, "link": "https://stackoverflow.com/questions/35313310/extract-iframe-data-using-ms-access-vba-object-does-not-support-property-or-met/35321920#35321920", "title": "Extract iframe data using ms access vba &quot;object does not support property or method&quot; error", "body": "<p><code>getElementsByClassName(\"productDescriptionWrapper\")</code> will return a <em>collection</em> of elements (even if there's only one found).  </p>\n\n<p>That collection deosn't have an <code>innerText</code> property - you need to use something like:</p>\n\n<pre><code> productDesc1 = Docx.frames(\"product-description-iframe\"). _\n                   document.getElementsByClassName( _\n                   \"productDescriptionWrapper\")(0).innerText\n</code></pre>\n\n<p><strong>EDIT</strong>: made some changes - tested and works for me</p>\n"}], "owner": {"reputation": 29, "user_id": 5598099, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/dcaeb288166361dfd9680c69aabec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tahir Mehmood", "link": "https://stackoverflow.com/users/5598099/tahir-mehmood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455167028, "creation_date": 1455101932, "last_edit_date": 1455103470, "question_id": 35313310, "link": "https://stackoverflow.com/questions/35313310/extract-iframe-data-using-ms-access-vba-object-does-not-support-property-or-met", "title": "Extract iframe data using ms access vba &quot;object does not support property or method&quot; error", "body": "<p>During exectuion of below mentioned code,following error appears.\"Object does not support this property of Method\".Any suggestion why my statement does not work?</p>\n\n<p>I appreciate your replies!</p>\n\n<pre><code>    Sub Getdata()\n Dim Ie As New InternetExplorer\n Dim WebURL\n Dim Docx As HTMLDocument\n Dim productDesc1\n Dim productTitle\n Dim price\n Dim RcdNum\nIe.Visible = False\n    WebURL = \"http://www.amazon.com/Pyramex-I-Force-Sporty-Anti-Fog-Goggle/dp/B006WPSDXS/ref=sr_1_1?s=sporting-goods&amp;ie=UTF8&amp;qid=1455101600&amp;sr=1-1&amp;keywords=glassess\"\n     Ie.Navigate2 WebURL\n     Do Until Ie.ReadyState = READYSTATE_COMPLETE\n     DoEvents\n     Loop\n     Set Docx = Ie.Document\n\n     productDesc1 = Docx.window.frames(\"product-description-iframe\").contentWindow.document.getElementsByClassName(\"productDescriptionWrapper\").innerText\n\n\n\nEnd Sub   \n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1455167399, "post_id": 35313190, "comment_id": 58370452, "body": "Post the stored procedure code."}, {"owner": {"reputation": 1, "user_id": 5907765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c99aafd108006d0dfe71d5b03dd42d?s=128&d=identicon&r=PG&f=1", "display_name": "Atri SQL", "link": "https://stackoverflow.com/users/5907765/atri-sql"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1455203538, "post_id": 35313190, "comment_id": 58393096, "body": "Hi, I think I&#39;ve found the issue. We&#39;ve added the WITH RECOMPILE hint to the stoed procedure. It was a Parameter Sniffing issue. Thx"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5907765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c99aafd108006d0dfe71d5b03dd42d?s=128&d=identicon&r=PG&f=1", "display_name": "Atri SQL", "link": "https://stackoverflow.com/users/5907765/atri-sql"}, "edited": false, "score": 0, "creation_date": 1455203589, "post_id": 35331140, "comment_id": 58393138, "body": "Hi, I&#39;ve tried this already before asking this question here. This didn&#39;t work. But thx"}], "tags": [], "owner": {"reputation": 137, "user_id": 1888461, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/030b7ed8ddb2bc9b51c7e65e1d951168?s=128&d=identicon&r=PG&f=1", "display_name": "Viladimir", "link": "https://stackoverflow.com/users/1888461/viladimir"}, "is_accepted": false, "score": 0, "last_activity_date": 1455167001, "creation_date": 1455167001, "answer_id": 35331140, "question_id": 35313190, "link": "https://stackoverflow.com/questions/35313190/excel-vba-calling-stored-procedure-timeout-after-x-executions/35331140#35331140", "title": "Excel VBA - Calling Stored Procedure Timeout after x executions", "body": "<p>This usually happens when you have quires which take more than 30 secs, that is the default timeout for the  command.</p>\n\n<p>try changing this</p>\n\n<pre><code>With cmd\n    .ActiveConnection = cnn\n    .CommandType = adCmdText\n    .commandText = \"EXEC spTest '\" xxx \"', '\" &amp; xxx \"';\"\nEnd With\n</code></pre>\n\n<p>to</p>\n\n<pre><code>With cmd\n    .ActiveConnection = cnn\n    .CommandTimeout = 1200\n    .CommandType = adCmdText\n    .commandText = \"EXEC spTest '\" xxx \"', '\" &amp; xxx \"';\"\nEnd With\n</code></pre>\n\n<p>this will set your timeout to 1200 seconds , This should hopefully solve it.</p>\n"}], "owner": {"reputation": 1, "user_id": 5907765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c99aafd108006d0dfe71d5b03dd42d?s=128&d=identicon&r=PG&f=1", "display_name": "Atri SQL", "link": "https://stackoverflow.com/users/5907765/atri-sql"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455167001, "creation_date": 1455101586, "last_edit_date": 1531161705, "question_id": 35313190, "link": "https://stackoverflow.com/questions/35313190/excel-vba-calling-stored-procedure-timeout-after-x-executions", "title": "Excel VBA - Calling Stored Procedure Timeout after x executions", "body": "<p>Can someone explain me this behaviour? </p>\n\n<p>We are executing a stored procedure calling it from Excel VBA and placing the results in a pivot table. We use this code:</p>\n\n<pre><code>Set cnn = New ADODB.Connection\nSet rst = New ADODB.Recordset\nSet cmd = New ADODB.Command\n\nconnectionstring = \"Provider=SQLOLEDB.1;Password=***;User ID=***;Initial Catalog=***;Data Source=***\"\ncnn.Open connectionstring\n\nWith cmd\n    .ActiveConnection = cnn\n    .CommandType = adCmdText\n    .commandText = \"EXEC spTest '\" xxx \"', '\" &amp; xxx \"';\"\nEnd With\n\nSet rst = cmd.Execute\n</code></pre>\n\n<p>The stored procedure: contains 200 lines of code that executes in 1 sec with the correct result.</p>\n\n<p>The problem occurs after x time of successfull executions that we get a timeout error. The only way I can slove this problem, is to comment out 75% of the stored procedure and execute it again from Excel. Next we comment out 50% of the stored procedure and execute it again. Next 25% and the last run we execute the full stored procedure again and now there is no more timeout error coming out. </p>\n\n<p>When I call it now it returns the results in about 3 seconds in a pivot table in Excel. This is not the first time I ran into this problem.</p>\n\n<p>Does anyone else ever had this issue? What can I do about it? What causes this behaviour?</p>\n\n<p>Thx!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455103203, "post_id": 35312740, "comment_id": 58336319, "body": "You&#39;re not properly qualifying your objects, which will cause you other issues - it shoudl be: <code>.Applicaiton.ActiveWindow.View = xlPageBreakPreview</code> not just <code>ActiveWindow.View = xlPageBreakPreview</code>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455106505, "post_id": 35312740, "comment_id": 58338563, "body": "Unfortunately it didn&#39;t do the trick. I&#39;m leaving the proper qualifiers in though... thanks."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455106607, "post_id": 35312740, "comment_id": 58338653, "body": "Is the page setup of the sheet set to use any of the fit to pages options?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455108614, "post_id": 35312740, "comment_id": 58340154, "body": "Yes... in a sub that runs before this one I set the page width to 1 wide using With <code>.PageSetup.FitToPagesWide = 1</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455108999, "post_id": 35312740, "comment_id": 58340432, "body": "That could add additional pagebreaks but it shouldn&#39;t remove the ones you have added. Do you turn <code>PrintCommunication</code> off?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455109655, "post_id": 35312740, "comment_id": 58340912, "body": "I haven&#39;t done anything with <code>PrintCommunication</code>. Should I simply turn it off, or turn it off and then back on?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455110169, "post_id": 35312740, "comment_id": 58341264, "body": "Don&#39;t do anything with it. To clarify, are you seeing <b>additional</b> pagebreaks, or just not seeing your manual ones?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455110354, "post_id": 35312740, "comment_id": 58341385, "body": "I see the automatic pagebreaks, simply not the manual ones which I want to set by code."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455111318, "post_id": 35312740, "comment_id": 58342146, "body": "Does it work if you leave out the <code>FitToPagesWide</code> part?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455111577, "post_id": 35312740, "comment_id": 58342329, "body": "It did not seem to have any effect."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455112092, "post_id": 35312740, "comment_id": 58342678, "body": "Probably need to see all the code then."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455112921, "post_id": 35312740, "comment_id": 58343230, "body": "I don&#39;t think I can post the entire code without violating some corporate policy or other... but I appreciate your help thus far. If I find out why this is happening or how to get past the issue, I&#39;ll post it here."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1455115768, "post_id": 35317957, "comment_id": 58345362, "body": "I tried your answer and unfortunately the page breaks didn&#39;t move. I&#39;m beginning to think this is some kind of nasty excel bug."}], "tags": [], "owner": {"reputation": 99, "user_id": 5871209, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/816e13a76f7ace0a86c982f68312cfe2?s=128&d=identicon&r=PG&f=1", "display_name": "mat_zat", "link": "https://stackoverflow.com/users/5871209/mat-zat"}, "is_accepted": false, "score": 0, "last_activity_date": 1455114707, "creation_date": 1455114707, "answer_id": 35317957, "question_id": 35312740, "link": "https://stackoverflow.com/questions/35312740/adding-pagebreaks-via-vba-doesnt-work/35317957#35317957", "title": "Adding pagebreaks via VBA doesn&#39;t work", "body": "<p>Try this</p>\n\n<pre><code>ActiveSheet.DisplayPageBreaks = True\n</code></pre>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 944, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455114707, "creation_date": 1455100360, "last_edit_date": 1531164843, "question_id": 35312740, "link": "https://stackoverflow.com/questions/35312740/adding-pagebreaks-via-vba-doesnt-work", "title": "Adding pagebreaks via VBA doesn&#39;t work", "body": "<p>I created code to set the pagebreaks in an excel report to deal with the orphan issue (i.e. one line of text spills over onto the next page, etc.). The code works fine when I run it with the report open / visible.</p>\n\n<p>It is part of a larger application which is opened and the code executed from MS Access. Excel is not visible during the process to improve performance.</p>\n\n<p><strong>When I run my code from MS Access it no longer works... it doesn't produce an error, but simply ignores the actual pagebreak setting command.</strong></p>\n\n<p>I read on various <a href=\"http://www.ozgrid.com/forum/showthread.php?t=65887\" rel=\"nofollow\">forums</a> that in order to avoid this problem, excel needs to be first switched over to <code>ActiveWindow.View = xlPageBreakPreview</code>, but that doesn't work either (I suspect since Excel isn't visible).</p>\n\n<p>I have tested for the following:</p>\n\n<ul>\n<li>Code works when it is started manually or stepped through with F8</li>\n<li>Code is executed when called upon from Access (I set breakpoints)</li>\n<li>Switching the window view doesn't do anything either</li>\n</ul>\n\n<p><strong>How can I get Excel to change the pagebreaks via code when Excel is run in the background?</strong></p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub TheOrphanProblem()\nDim iPageBrkRow\n\n'Determine if there are page breaks and if so on which row of the document\nIf FindNthAutoPageBreak(wsRptHolding, 1) Is Nothing Then\n    'No pagebreak found so we exit the sub\n    Exit Sub\nElse\n    iPageBrkRow = FindNthAutoPageBreak(wsRptHolding, 1).Row 'Get row\nEnd If\n\nDebug.Print iPageBrkRow\n\nDim x As Integer\nDim sCase As String\nDim rNewposition As Range\nWith wsRptHolding\n</code></pre>\n\n<p>'Code edited out for brevity. This part checks if there is an orphan problem and finds the new position for a pagebreak if needed. \nIt then provides that position as a range called \"rNewposition\".</p>\n\n<pre><code>'Moves page break to calculated position\nActiveWindow.View = xlPageBreakPreview\n.HPageBreaks.Add rNewposition\nActiveWindow.View = xlNormalView\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This is the code I use to find the pagebreak positions...</p>\n\n<pre><code>Private Function FindNthAutoPageBreak(Sht As Worksheet, Nth As Long) As Range\n'Set page break of the last page so that sub asset groups are kept together\n\nDim HP As HPageBreak\nDim Ctr As Long\nFor Each HP In Sht.HPageBreaks\n    If HP.Type = xlPageBreakAutomatic Then\n        Ctr = Ctr + 1\n        If Ctr = Nth Then\n            Set FindNthAutoPageBreak = HP.Location\n        End If\n    End If\nNext HP\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vbscript", "vba"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 2054137, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/368e4ac5dc46f2f027b664ca79b79130?s=128&d=identicon&r=PG", "display_name": "abdulkhadar7", "link": "https://stackoverflow.com/users/2054137/abdulkhadar7"}, "edited": false, "score": 0, "creation_date": 1455121506, "post_id": 35313540, "comment_id": 58349874, "body": "Thanks a lot. I have tried a lot functions but this is best. Thanks buddy"}], "tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": true, "score": 1, "last_activity_date": 1455102573, "creation_date": 1455102573, "answer_id": 35313540, "question_id": 35312657, "link": "https://stackoverflow.com/questions/35312657/excel-cell-wise-substraction/35313540#35313540", "title": "Excel cell wise substraction", "body": "<hr>\n\n<hr>\n\n<p>The below code is provided assuming that the Job Expense is ColumnA,Advance in columnB and Balance in ColumnC.</p>\n\n<p>The below code will work when any change occurs in ColumnB cells.</p>\n\n<hr>\n\n<hr>\n\n<p>Copy the below code and do right click on sheet tab and select view code and paste it.</p>\n\n<p>Close the VBA window (Alt+Q to close VBA window) and return to that sheet and check.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column = 2 Then\n    Application.EnableEvents = False\n        With Target\n            .Offset(, 1).Value = Val(.Offset(, -1).Value) - Val(.Value)\n        End With\n    Application.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 2054137, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/368e4ac5dc46f2f027b664ca79b79130?s=128&d=identicon&r=PG", "display_name": "abdulkhadar7", "link": "https://stackoverflow.com/users/2054137/abdulkhadar7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 35313540, "answer_count": 1, "score": 0, "last_activity_date": 1455102573, "creation_date": 1455100149, "last_edit_date": 1531164843, "question_id": 35312657, "link": "https://stackoverflow.com/questions/35312657/excel-cell-wise-substraction", "title": "Excel cell wise substraction", "body": "<p>I have a worksheet in excel where i need to perform subtraction only either of the column contains value and result should be stored in a cell automatically for each cell. for eg\n<strong>strong text</strong></p>\n\n<p>**JobExpense    Advance   Balance</p>\n\n<p>4500             100       4400</p>\n\n<p>8000             4000      4000</p>\n\n<p>9800              5000     4800**</p>\n\n<p>consider this as my sheet I need to store the contents of Balance columns automatically when  user enters value in Advance columns.\nany help is appreciable. formula,vbscipt whatever.\nI have tried formula,but it will always show zeros whenever formulas are used in the columns</p>\n"}, {"tags": ["vba", "excel", "if-statement", "lookup"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455124969, "post_id": 35314897, "comment_id": 58352375, "body": "Hi, thanks for your quick reply! I&#39;m having a bit of trouble with the syntax, Specifically where to put the:   Else             Exit If         End If     Next End If"}, {"owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "reply_to_user": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455178376, "post_id": 35314897, "comment_id": 58375473, "body": "The <code>else</code> comes after your desired code has run. The <code>exit if</code> happens when the <code>else</code> is executed. It means that if the status is NOT &quot;started&quot; the else statement will run. In this case that is <code>Exit If</code> which cancels the entire code.  If you have an IF-block, you will also need an <code>End if</code>, this determines the end point of the IF-block, so you&#39;ll place that after the entire code (of the if block). The next is for the For-loop to run, so place that after the end if, so that the entire IF-block is run for every time &quot;Started&quot; is found. Lastly, close the entire code with a last End if."}, {"owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "reply_to_user": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455179054, "post_id": 35314897, "comment_id": 58375857, "body": "I&#39;ve just added some to my original answer, if you have any more questions, feel free to ask"}, {"owner": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455192101, "post_id": 35314897, "comment_id": 58384772, "body": "Hi Wouter. Many thanks again! I&#39;m still getting errors, not sure it likes the    &#39;exit if&#39; statement?... I&#39;ve updated my full code to my original question, any thoughts? I&#39;m probably just being an idiot...."}, {"owner": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455197033, "post_id": 35314897, "comment_id": 58388192, "body": "The line beginning with &#39;if active workbook....&#39; highlights red and says syntax error.."}, {"owner": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455197174, "post_id": 35314897, "comment_id": 58388283, "body": "I don&#39;t think &#39;exit if&#39; exists !?  this is the problematic line: If ActiveWorkbook.Worksheets(&quot;Initiative Index&quot;).Range(&quot;A&quot; &amp; i).Value = ws.Name And ActiveWorkbook.Worksheets(&quot;Initiative Index&quot;).Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;Started&quot; Then Exit If"}, {"owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "reply_to_user": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "edited": false, "score": 0, "creation_date": 1455201723, "post_id": 35314897, "comment_id": 58391740, "body": "Oh dear, my bad. Try changing <code>Exit If</code> to <code>Exit For</code>?"}], "tags": [], "owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "is_accepted": false, "score": 1, "last_activity_date": 1455179030, "last_edit_date": 1455179030, "creation_date": 1455106235, "answer_id": 35314897, "question_id": 35311361, "link": "https://stackoverflow.com/questions/35311361/vba-excel-look-up-sheet-name-if-tab-has-started-then-loop-through-these-sheet/35314897#35314897", "title": "VBA Excel Look up sheet name, IF tab has &#39;started&#39; then loop through these sheets", "body": "<pre><code>If IsNumeric(ws.Name) Then\n    l = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n    For i = 1 To l\n        If ActiveWorkbook.Worksheets(\"Initiative Index\").Range(\"A\" &amp; i).Value = ws.Name And ActiveWorkbook.Worksheets(\"Initiative Index\").Range(\"E\" &amp; i).Value = \"Started\" Then\n            'run code\n        Else\n            Exit If\n        End If\n    Next\nEnd If\n</code></pre>\n\n<p>Perhaps this could help you. The code first checks if the value you assigned <code>(001)</code> is in the list specified in <code>Initiative Index</code>. It also checks if the value in column E is equal to <code>Started</code>. If so, you'll be able to run your desired code. If not, you can quit the If-statement and don't run the code. </p>\n\n<p><strong>Update 1:</strong>\nYou may also try something like the code below, this way you have to replace the code you suggested by everything between the <code>-----</code>, the <code>next</code> you'll have to place here: </p>\n\n<pre><code>          End If\n        Next   'here \n    End If\nNext ws\n</code></pre>\n\n<p>The code: </p>\n\n<pre><code>   '-----------------------------------        \n    If IsNumeric(ws.Name) Then\n                l = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n                For i = 1 To l\n                    If ActiveWorkbook.Worksheets(\"Initiative Index\").Range(\"A\" &amp; i).Value = ws.Name And ActiveWorkbook.Worksheets(\"Initiative Index\").Range(\"E\" &amp; i).Value &lt;&gt; \"Started\" Then Exit If\n    '--------------------------------------\n                Next\n     End If\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5868468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83dc8fe23885716c8f2324dd828f132?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5868468/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455194702, "creation_date": 1455096884, "last_edit_date": 1455194702, "question_id": 35311361, "link": "https://stackoverflow.com/questions/35311361/vba-excel-look-up-sheet-name-if-tab-has-started-then-loop-through-these-sheet", "title": "VBA Excel Look up sheet name, IF tab has &#39;started&#39; then loop through these sheets", "body": "<p>I have a function in my VBA script that currently loops through all numerical sheet names and performs a function. 001, 002, 003 etc.</p>\n\n<p>I'm hoping to refine this so that only sheet names that are marked as 'started' are looked at. I have a sheet called 'Initiative Index' in the same workbook which lists the sheet numbers (with hyperlinks, hope this doesn't cause an issue) in column 1 (A), in the same table there is a 'status'column 5 (E) which for each sheet contains 'started', 'idea', 'hold'.</p>\n\n<p>The VBA script then goes on to copy and paste certain bits on info from the relevant tabs in to a new sheet called actions summary.</p>\n\n<p>I'm hoping to simply replace the below section of code to do this. Any ideas?</p>\n\n<pre><code> 'Loop through all sheets in the workbook\nFor Each ws In wb.Sheets\n    'Only look for worksheets whose names are numbers (e.g. \"001\", \"002\", etc)\n    If IsNumeric(ws.Name) Then\n</code></pre>\n\n<p>UPDATE: For context, full code here:</p>\n\n<pre><code>    Sub UpDate_List_v2()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim wsSum As Worksheet\n    Dim rLastCell As Range\n    Dim lCalc As XlCalculation\n    Dim bHasHeaders As Boolean\n\n\n    'Turn off calculation, events, and screenupdating\n    'This allows the code to run faster and prevents \"screen flickering\"\n    With Application\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set wb = ActiveWorkbook\n\n    'Check if Actions Summary sheet exists already or not\n    On Error Resume Next\n    Set wsSum = wb.Sheets(\"Actions summary\")\n    On Error GoTo 0\n\n    If wsSum Is Nothing Then\n        'Does not exist, create it\n        Set wsSum = wb.Sheets.Add(Before:=wb.Sheets(1))\n        wsSum.Name = \"Actions summary\"\n        bHasHeaders = False\n    Else\n        'Already exists, clear previous data\n        wsSum.UsedRange.Offset(1).Clear\n        bHasHeaders = True\n    End If\n\n    'Loop through all sheets in the workbook\n    For Each ws In wb.Sheets\n        'Only look for worksheets whose names are numbers (e.g. \"001\", \"002\",       etc)\n '-----------------------------------\n    If IsNumeric(ws.Name) Then\n                l = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n                For i = 1 To l\n                    If ActiveWorkbook.Worksheets(\"Initiative Index\").Range(\"A\" &amp; i).Value = ws.Name And ActiveWorkbook.Worksheets(\"Initiative Index\").Range(\"E\" &amp; i).Value &lt;&gt; \"Started\" Then Exit If\n    '--------------------------------------\n            'Check if the \"Actions Summary\" sheet already has headers\n            If bHasHeaders = False Then\n                'Does not have headers yet\n                With ws.Range(\"A8:M8\")\n                    'Check if this sheet has headers in A8:G8\n                    If WorksheetFunction.CountBlank(.Cells) = 0 Then\n                        'This sheet does have headers, copy them over\n                        .Copy wsSum.Range(\"A1\")\n                        bHasHeaders = True\n                    End If\n                End With\n            End If\n\n            'Find the last row of the sheet\n            Set rLastCell = ws.Cells.Find(\"*\", ws.Range(\"A1\"), SearchDirection:=xlPrevious)\n            If Not rLastCell Is Nothing Then\n                'Check if the last row is greater than the header row\n                If rLastCell.Row &gt; 8 Then\n                    'Last row is greater than the header row so there is data\n                                    'Check if the \"Actions Summary\" sheet has enough rows to hold the data\n                                    If wsSum.Cells(wsSum.Rows.Count, \"A\").End(xlUp).Row + rLastCell.Row - 8 &gt; wsSum.Rows.Count Then\n                                        'Not enough rows, return error and exit the subroutine\n                                        MsgBox \"There are not enough rows in the summary worksheet to place the data.\", , \"Data Overflow\"\n                                        Exit Sub\n                                    Else\n                        'Does have enough rows, copy the data - Values\n                        ws.Range(\"A9:M\" &amp; rLastCell.Row).Copy\n                        With wsSum.Cells(wsSum.Rows.Count, \"A\").End(xlUp).Offset(1)\n                            .PasteSpecial xlPasteValues\n                            .PasteSpecial xlPasteFormats\n                        End With\n                    End If\n                End If\n            End If\n           Next   'here\n        End If\n    Next ws\n\n        'Sheets(\"Actions summary\").Columns(\"H:L\").EntireColumn.Delete       'Delete unwanted columns\n        'Sheets(\"Actions summary\").Columns(\"H:L\").Hidden = True              'Hide unwanted columns\n        Worksheets(\"Actions summary\").Columns(\"H\").Hidden = True\n        Worksheets(\"Actions summary\").Columns(\"J\").Hidden = True\n        Worksheets(\"Actions summary\").Columns(\"L\").Hidden = True\n        Sheets(\"Actions summary\").Columns(\"H\").Style = \"currency\"           'Set to \u00a3\n\n    Application.CutCopyMode = False                         'Remove the cut/copy border\n    'wsSum.Range(\"A1\").CurrentRegion.EntireColumn.AutoFit    'Autofit columns on the \"Actions Summary\" sheet\n\n    'Turn calculation, events, and screenupdating back on\n    With Application\n        '.Calculation = lCalc\n        Application.Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "checkbox"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1455094964, "post_id": 35310608, "comment_id": 58330809, "body": "Just assign the name of a macro that does what you want to its <code>OnAction</code> property"}, {"owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455107494, "post_id": 35310608, "comment_id": 58339311, "body": "Thanks, was just was i was looking for, didnt know it had this emmbed."}], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "is_accepted": true, "score": 0, "last_activity_date": 1455174942, "creation_date": 1455174942, "answer_id": 35332979, "question_id": 35310608, "link": "https://stackoverflow.com/questions/35310608/vba-checkbox-additional-code/35332979#35332979", "title": "VBA Checkbox Additional code", "body": "<p>As @Rory mentioned, the answear was : </p>\n\n<p>add \".OnAction = \"Name of macro\" and then you can write a macro that coresponds to the click:</p>\n\n<pre><code>With Selection\n    .Caption = \"\"\n    .LinkedCell = \"AN2\"\n    .Value = xlOff\n    .OnAction = \"DateClicked\"\nEnd With\n\nFunction DateClicked()\n    If Cells(2,\"AN\") = \"TRUE\" Then\n        Cells(2,\"A\") = Now()\n    Else \n        Cells(2,\"A\") = \"\"\n    End If\nEnd Function  \n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 35332979, "answer_count": 1, "score": 0, "last_activity_date": 1455174942, "creation_date": 1455094608, "question_id": 35310608, "link": "https://stackoverflow.com/questions/35310608/vba-checkbox-additional-code", "title": "VBA Checkbox Additional code", "body": "<p>I was wandering, if it was possible to add another event to a checkbox in VBA Excel. I create a checkbox like this: </p>\n\n<pre><code>ActiveSheet.CheckBoxes.Add(.Left, .Top,.Width, .Height).Select\nWith Selection\n    .Caption = \"\"\n    .LinkedCell = \"AN2\"\n    .Value = xlOn\nEnd With\n</code></pre>\n\n<p>I was wondering if I could add code to it, so that whenever someone checks it, some cell would get the current date like:</p>\n\n<pre><code>Cells(1,\"A\").Now()\n</code></pre>\n\n<p>Cheers!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 2, "last_activity_date": 1455095118, "creation_date": 1455095118, "answer_id": 35310761, "question_id": 35310405, "link": "https://stackoverflow.com/questions/35310405/excel-vba-paste-special-values/35310761#35310761", "title": "Excel VBA Paste Special values", "body": "<p>Try this code:</p>\n\n<pre><code>Sub CopyColumnToWorkbook()\n     Dim sourceColumn As Range, targetColumn As Range\n\n     Set sourceColumn = Workbooks(\"Source.xls\").Worksheets(2).Columns(\"A:E\")\n     Set targetColumn = Workbooks(\"Target.xls\").Worksheets(1).Columns(\"A\")\n\n     sourceColumn.Copy\n     targetColumn.PasteSpecial xlPasteValues\n     Application.CutCopyMode = False\n\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5907235, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m3JXQf67vyM/AAAAAAAAAAI/AAAAAAAAPR0/wkKFlgVZbCk/photo.jpg?sz=128", "display_name": "peter amir", "link": "https://stackoverflow.com/users/5907235/peter-amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455095118, "creation_date": 1455093998, "last_edit_date": 1455094991, "question_id": 35310405, "link": "https://stackoverflow.com/questions/35310405/excel-vba-paste-special-values", "title": "Excel VBA Paste Special values", "body": "<p>I need to edit on this below code to copy data to another workbook as value only </p>\n\n<pre><code>Sub CopyColumnToWorkbook()\nDim sourceColumn As Range, targetColumn As Range\n\nSet sourceColumn = Workbooks(\"Source.xls\").Worksheets(2).Columns(\"A:E\")\nSet targetColumn = Workbooks(\"Target.xls\").Worksheets(1).Columns(\"A\")\n\nsourceColumn.Copy Destination:=targetColumn\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1455483159, "last_edit_date": 1455483159, "creation_date": 1455093957, "answer_id": 35310390, "question_id": 35310299, "link": "https://stackoverflow.com/questions/35310299/reference-fields-in-subform-query-ms-access/35310390#35310390", "title": "Reference fields in subform query (ms Access)", "body": "<p>Try this: <code>Me.frmResultsSub.Form.fldA.Width = 600</code></p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1455098255, "creation_date": 1455098255, "answer_id": 35311912, "question_id": 35310299, "link": "https://stackoverflow.com/questions/35310299/reference-fields-in-subform-query-ms-access/35311912#35311912", "title": "Reference fields in subform query (ms Access)", "body": "<p>I don't think you can adjust column width on a query using VBA. You can however solve your problem using one of those methods:  </p>\n\n<ul>\n<li>create a form (<code>AutoForm</code> is ok) and make its default view as Datasheet. then use that form as the source of your subform control. that will be visually identical to your current solution.   </li>\n<li>use a listBox instead of a subform. It's quite versatile and you can easily set the listbox <code>rowSource</code> to any SQL statement. You will have to handle sync with main form data but it is very simple.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 393, "user_id": 2521883, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/69880a3cdd09e9c794de7525bbe5b3b1?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/2521883/jim"}, "edited": false, "score": 0, "creation_date": 1455144710, "post_id": 35316877, "comment_id": 58363671, "body": "Many thanks for everyone&#39;s help here. As above, Me!SubFqrySearchHLA!DonorAx.ColumnWidth = 600, worked in the On Load event (forgot to adjust field/form names - thanks for seeing through the confusion!). All field widths can now be customised. What I should do is put the query output into a continuous form which will give much more format/customisation/presentation possibilities. The query, however, yields variable numbers of fields (the Wizard sets controls up according to the last run query). I could create a new continuous form for each display through VBA, or there might be an easier way."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1455493704, "last_edit_date": 1455493704, "creation_date": 1455111707, "answer_id": 35316877, "question_id": 35310299, "link": "https://stackoverflow.com/questions/35310299/reference-fields-in-subform-query-ms-access/35316877#35316877", "title": "Reference fields in subform query (ms Access)", "body": "<p>Reference the <em>fldA</em> field in the query the same as you would if it were the name of a textbox on a form contained in that <em>frmResultsSub</em> subform control.  </p>\n\n<p>Put this in <em>On Load</em> and verify it shows you the field name instead of triggering an error ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>MsgBox Me!frmResultsSub!fldA.name\n</code></pre>\n\n<p>Once you have that working correctly, you can work with the column's properties.  During <em>On Load</em>, adjust its <code>ColumnWidth</code> property to change its width ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me!frmResultsSub!fldA.ColumnWidth = 600\n</code></pre>\n\n<p>That should allow you to set the width.  But you also mentioned text alignment, and I don't see how to do that for a query column unless you create an actual form based on the query.</p>\n"}], "owner": {"reputation": 393, "user_id": 2521883, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/69880a3cdd09e9c794de7525bbe5b3b1?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/2521883/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 35316877, "answer_count": 3, "score": 1, "last_activity_date": 1455493704, "creation_date": 1455093672, "last_edit_date": 1455478579, "question_id": 35310299, "link": "https://stackoverflow.com/questions/35310299/reference-fields-in-subform-query-ms-access", "title": "Reference fields in subform query (ms Access)", "body": "<p>I have a form, <code>frmResults</code>, which contains a subform control, <code>frmResultsSub</code>.</p>\n\n<p><code>frmResultsSub</code> is a subform control which contains a query instead of a form. In other words, its SourceObject property is set to the query, \"<code>Query.qrySearch</code>\"</p>\n\n<p>Is there any way I can reference the fields of this query to e.g. to centre text or change field width?</p>\n\n<p>I've tried these statements in the Open Event for <code>frmResults</code>, but neither was successful:</p>\n\n<pre><code>Me!frmResultsSub.fldA.Width = 600\nMe.frmResultsSub.fldA.Width = 600\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455090191, "post_id": 35309228, "comment_id": 58328291, "body": "You can say column(&quot;b:b&quot;).column or use&quot;b&quot; in range or cells sa range(&quot;b&quot; &amp; row)"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1455090787, "post_id": 35309228, "comment_id": 58328572, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10106465/excel-column-number-from-column-name\">Excel column number from column name</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1455090979, "post_id": 35309228, "comment_id": 58328682, "body": "<code>Worksheet.Cells(Row, X)</code> will work whether <code>X</code> is a letter or number."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1455246891, "post_id": 35309228, "comment_id": 58415249, "body": "Why can&#39;t you use <code>Range(X&amp;&quot;:&quot;&amp;X)</code> instead of <code>Cells()</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1455090674, "post_id": 35309458, "comment_id": 58328518, "body": "I was about to suggest this myself, but a problem occurs once you move past column Z: <code>?Asc(lcase(&quot;aa&quot;))-asc(&quot;a&quot;)+1</code> in the immediate-window outputs 1."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1455091062, "last_edit_date": 1455091062, "creation_date": 1455090242, "answer_id": 35309458, "question_id": 35309228, "link": "https://stackoverflow.com/questions/35309228/how-to-use-column-letters-in-vba/35309458#35309458", "title": "How to use column letters in VBA", "body": "<p>B is the second column, so you can use the expression (based on ASCII):</p>\n\n<pre><code>Sub main()\n    Dim s As String\n    s = \"AB\"\n    example s\nEnd Sub\n\nSub example(s As String)\n\n    Dim colNum As Integer\n    Dim i As Integer\n\n    i = 1: colNum = 0\n    While (Mid(s, i, 1) &lt;&gt; \"\")\n        colNum = colNum * 26 + (Asc(UCase(Mid(s, i, 1))) - Asc(\"A\") + 1)\n        i = i + 1\n    Wend\n    MsgBox colNum\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 7, "last_activity_date": 1455091744, "creation_date": 1455091744, "answer_id": 35309792, "question_id": 35309228, "link": "https://stackoverflow.com/questions/35309228/how-to-use-column-letters-in-vba/35309792#35309792", "title": "How to use column letters in VBA", "body": "<p>Cells() is your friend.</p>\n\n<p>Don't overthink this.</p>\n\n<pre><code>Cells(1, 1) = \"jello\" ' changes cell A1\nCells(2, \"AZ\") = \"too much jello\" ' changes cell AZ2\n</code></pre>\n\n<p>The second argument of Cells() can be either a number or the alpha column header.</p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1455092480, "last_edit_date": 1455092480, "creation_date": 1455091947, "answer_id": 35309841, "question_id": 35309228, "link": "https://stackoverflow.com/questions/35309228/how-to-use-column-letters-in-vba/35309841#35309841", "title": "How to use column letters in VBA", "body": "<pre><code>Function getColNum(colLetter As String) As Long\n    On Error Resume Next   'will return 0 if letter &gt; last col\n    getColNum = Range(colLetter &amp; \"1\").Column\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4907, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1455246621, "creation_date": 1455089435, "last_edit_date": 1455246621, "question_id": 35309228, "link": "https://stackoverflow.com/questions/35309228/how-to-use-column-letters-in-vba", "title": "How to use column letters in VBA", "body": "<p>I'm currently struggling with the following problem</p>\n\n<p>I'm trying to implement an input box where a user can input the character of the column. </p>\n\n<p>After that, i dont know how to convert this into a number to use it in the <code>Worksheet.Cells</code> Method</p>\n\n<p><em>For example</em>: The User inputs \"B\", so the program saves it in a variable named x and converts it into a number so it can be used as <code>Worksheet.Cells(Row, X)</code></p>\n\n<p>Is there any method or does someone has an idea how to do this?</p>\n"}, {"tags": ["vba", "ms-access", "macros"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4811191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-jLmm4c1NuJU/AAAAAAAAAAI/AAAAAAAAAB0/CrNz9kTPSqQ/photo.jpg?sz=128", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/4811191/adam-smith"}, "edited": false, "score": 0, "creation_date": 1455517458, "post_id": 35309803, "comment_id": 58507042, "body": "Thanks for the tip. I&#39;ve set up a query with the added field, but when I try to use the query as the data for a PivotTable I get the error: &quot;Data could not be retrieved from the database. Check the database server or contact your database administrator. Make sure the external database is available, and then try the operation again.&quot; I am still able to use the table from the database for the PivotTable, so there is no problem connecting to the database."}, {"owner": {"reputation": 716, "user_id": 2895831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/611c415418ec891cfd415dfa76ce336d?s=128&d=identicon&r=PG", "display_name": "Alex Hedley", "link": "https://stackoverflow.com/users/2895831/alex-hedley"}, "reply_to_user": {"reputation": 105, "user_id": 4811191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-jLmm4c1NuJU/AAAAAAAAAAI/AAAAAAAAAB0/CrNz9kTPSqQ/photo.jpg?sz=128", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/4811191/adam-smith"}, "edited": false, "score": 0, "creation_date": 1455524778, "post_id": 35309803, "comment_id": 58510355, "body": "@AdamSmith does the query run ok if not used as a pivot? Check for errors in the calculated Field"}], "tags": [], "owner": {"reputation": 716, "user_id": 2895831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/611c415418ec891cfd415dfa76ce336d?s=128&d=identicon&r=PG", "display_name": "Alex Hedley", "link": "https://stackoverflow.com/users/2895831/alex-hedley"}, "is_accepted": false, "score": 1, "last_activity_date": 1455091783, "creation_date": 1455091783, "answer_id": 35309803, "question_id": 35309080, "link": "https://stackoverflow.com/questions/35309080/access-vba-add-a-calculated-field/35309803#35309803", "title": "Access VBA add a calculated field", "body": "<p>You could add this field to a Query then base your Pivots on the Query.</p>\n"}], "owner": {"reputation": 105, "user_id": 4811191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-jLmm4c1NuJU/AAAAAAAAAAI/AAAAAAAAAB0/CrNz9kTPSqQ/photo.jpg?sz=128", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/4811191/adam-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455091783, "creation_date": 1455088827, "question_id": 35309080, "link": "https://stackoverflow.com/questions/35309080/access-vba-add-a-calculated-field", "title": "Access VBA add a calculated field", "body": "<p>I currently have a Macro in Access that will pull in specific CSV files. I am looking to attach VBA code to this macro to also generate a calculated field at the end.</p>\n\n<p>I am able to add the calculated field manually with the expression:</p>\n\n<pre><code>IIf([Weight] &lt;= 5, 1, IIf([Weight] &lt;= 10, 2, IIf([Weight] &lt;= 20, 3, IIf([Weight] &lt;= 30, 4, IIf([Weight] &lt;= 50, 5, 6)))))\n</code></pre>\n\n<p>Is there a way to add this calculated field automatically when the macro is run, or via a second macro?</p>\n\n<p>This Access database is just being used to connect to Excel and generate PivotTables from the data. I can create the calculated fields within Excel, but cannot use calculated fields as rows in Pivottables.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455091113, "post_id": 35308906, "comment_id": 58328767, "body": "It&#39;s timing. The Enter event occurs before your control actually gets the focus. So setting the focus elsewhere works, but then focus is automatically returned to the textbox."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455091168, "post_id": 35308906, "comment_id": 58328797, "body": "@rory It works in userforms without frames though? What makes this UF different?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455091302, "post_id": 35308906, "comment_id": 58328863, "body": "Frames are containers and events like Enter and Exit are actually inherited from the container. Why do you need frames anyway - you could just use labels to simulate them without the side effects."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455091469, "post_id": 35308906, "comment_id": 58328942, "body": "@rory It looks prettier, and allows for easy grouping of controls inside it :P There is actually no easy way to set the focus to something outside the frame, if I choose to use those in a form?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455091744, "post_id": 35308906, "comment_id": 58329056, "body": "But you don&#39;t need them here. It&#39;s very difficult from events that are themselves triggered by a change in focus."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455092032, "post_id": 35308906, "comment_id": 58329200, "body": "Well, the question isn&#39;t really about whether or not I need them. Furthermore there may be another time when I, or someone else, do need them, so an answer to whether or not this problem can be handled by VBA would be nice. Following your comments regarding timing, I tried using a few other ones, e.g. <code>textbox_change</code> but none of those worked either. I assume that means everything inside the frame inherits their events from the frame? @rory"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455093458, "post_id": 35308906, "comment_id": 58329913, "body": "No. A simple change event should have no problem setting the focus elsewhere."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455094299, "post_id": 35308906, "comment_id": 58330383, "body": "@Rory Nevertheless it fails, and I am having little luck with figuring out why =/ Oh, well, gonna go with no frames for now and try to figure out what is going on when I have more time on hand."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455094909, "post_id": 35308906, "comment_id": 58330776, "body": "It works just fine here - I suspect you have something else interfering."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455096113, "post_id": 35308906, "comment_id": 58331567, "body": "@rory Yeah, my guess is that after the enter-event has caused the change-event to fire, control is handed back to the enter-event, which brings us back to the original problem. Hmm, I wonder, could raising a custom error prevent this from happening?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455097500, "post_id": 35308906, "comment_id": 58332488, "body": "You coud avoid the whole issue by having a little button next to each textbox to launch your calendar control."}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 786, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455088183, "creation_date": 1455088183, "question_id": 35308906, "link": "https://stackoverflow.com/questions/35308906/how-do-i-set-focus-to-an-element-outside-the-current-frame", "title": "How do I set focus to an element outside the current frame?", "body": "<p>I have a simple userform for entering data into a macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DgLgJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DgLgJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Everything works fine, except for one thing - I want the commandbuttons at the bottom to get focus, after the textboxes are populated from a different form which pops up when either textbox is clicked.</p>\n\n<p>Stepping through the code this does indeed happen, but somehow focus is returned to the textbox before the code ends.</p>\n\n<p>Googling about a bit, it seems that the issue may be that there is a frame around the textboxes, but I can't find any way to actually solve the problem. </p>\n\n<p>The code for the two textboxes is next to similar, and looks like this:</p>\n\n<pre><code>Private Sub tbxTil_Enter()\n  DATA_TO_CALENDAR = Me.tbxTil.Value\n  DatePickerForm.Show\n  Me.tbxTil.Value = Format(DATA_FROM_CALENDAR, \"dd.mmm. yyyy\")\n  If Me.cmdOk.Enabled Then\n    Me.cmdOk.SetFocus\n  Else\n    Me.cmdAvbryt.SetFocus\n  End If\nEnd Sub\n</code></pre>\n\n<p>Assuming the problem is what I believe it is, is there any way to set the focus to an element outside the frame you are currently in? If not, what is the actual issue with my code?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455087893, "post_id": 35308606, "comment_id": 58327164, "body": "Where is the code running?  In WB1, or in some other workbook?"}, {"owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455090294, "post_id": 35308606, "comment_id": 58328340, "body": "WB1, the workbook into which data from WB2 has to be inserted."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1455088276, "last_edit_date": 1455088276, "creation_date": 1455087812, "answer_id": 35308819, "question_id": 35308606, "link": "https://stackoverflow.com/questions/35308606/transferring-data-into-an-open-workbook-from-a-closed-workbook-without-having-to/35308819#35308819", "title": "Transferring data into an open workbook from a closed workbook without having to specify the file path, considering that both are in the same folder", "body": "<p>Try:</p>\n\n<pre><code>Set WB2 = Workbooks.Open(WB1.Path &amp; \"\\RawData.xlsm\")\n</code></pre>\n\n<p>if WB2 is in the same folder as WB1.</p>\n\n<p>If the macro is running from a third (separate) workbook in the same location as WB2 then:</p>\n\n<pre><code>Set WB2 = Workbooks.Open(ThisWorkbook.Path &amp; \"\\RawData.xlsm\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 35308819, "answer_count": 1, "score": 1, "last_activity_date": 1455088276, "creation_date": 1455086952, "question_id": 35308606, "link": "https://stackoverflow.com/questions/35308606/transferring-data-into-an-open-workbook-from-a-closed-workbook-without-having-to", "title": "Transferring data into an open workbook from a closed workbook without having to specify the file path, considering that both are in the same folder", "body": "<p>How can I modify the below code to do so? I tried my luck with ThisWorkbook.Path. New to VB, any help would be much appreciated.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim WB1 As Workbook\nDim WB2 As Workbook\n\nSet WB1 = ActiveWorkbook\nSet WB2 = Workbooks.Open(\"C:\\Users\\joseph\\Desktop\\Required Files\\Almost final\\ RawData.xlsm\")\n\nWB1.Sheets(\"CR Details\").Columns(\"A:AW\").Value = WB2.Sheets(\"sheet1\").Columns(\"A:AW\").Value\n\nWB2.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "list", "for-loop"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455085706, "post_id": 35307714, "comment_id": 58326194, "body": "VBA doesn&#39;t have &quot;lists&quot; - are you maybe using VB.NET ?"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1455088760, "creation_date": 1455088760, "answer_id": 35309066, "question_id": 35307714, "link": "https://stackoverflow.com/questions/35307714/setting-a-variable-to-a-list-name/35309066#35309066", "title": "Setting a variable to a list name", "body": "<p>In VB variables can't be declared dynamically by name.</p>\n\n<p>The Dim statement is executed at compile time and defines the name and optionally the type of a variable. Th default type of a variable is <code>Variant</code> which can hold any type of value.</p>\n\n<p>Of course you can define an array of lists:</p>\n\n<pre><code>Dim lists(0 to 5) As List(Of Integer)\n</code></pre>\n\n<p>and use them like:</p>\n\n<pre><code>lists(2).Add(100)\n</code></pre>\n\n<p>(Using your example, which may be VB.NET rather than VB.)</p>\n"}, {"tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 0, "last_activity_date": 1455097094, "creation_date": 1455097094, "answer_id": 35311429, "question_id": 35307714, "link": "https://stackoverflow.com/questions/35307714/setting-a-variable-to-a-list-name/35311429#35311429", "title": "Setting a variable to a list name", "body": "<p>Take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/w8k3cys2.aspx\" rel=\"nofollow\">Redim Preseve</a> statement, it allows you to change the array size on the fly.</p>\n\n<p>Something in the spirit of this code:</p>\n\n<pre><code>Option Base 1\nDim list(1) As Integer\nDim count As Integer\n\n'Add 100 to the end of the array\ncount=count+1\nRedim Preserve list(count)\nlist(count)=100\n\n\n'Add 200 to the end of the array\ncount=count+1\nRedim Preserve list(count)\nlist(count)=200\n\n\n'Print all items\nDim i As Integer\nFor i = LBound(list) To UBound(list)\n     Debug.Print (list(i))\nNext i\n'Output: 100,200\n</code></pre>\n\n<p>Should help you get the desired behavior using <code>VBA</code></p>\n"}], "owner": {"reputation": 1, "user_id": 5906561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67d68bbca2d86ad9697197dfd68ac19?s=128&d=identicon&r=PG&f=1", "display_name": "Diuzkari", "link": "https://stackoverflow.com/users/5906561/diuzkari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455097094, "creation_date": 1455082975, "question_id": 35307714, "link": "https://stackoverflow.com/questions/35307714/setting-a-variable-to-a-list-name", "title": "Setting a variable to a list name", "body": "<p>I'm trying to generate lists named by a variable in FOR loop like this:</p>\n\n<pre><code>    For i = 0 To 5\n\n        Dim list(i) As List(Of Integer)\n\n    Next\n</code></pre>\n\n<p>But it doesn't work. I cant use those lists further on like: list2.add(100)..</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1455085801, "post_id": 35307282, "comment_id": 58326240, "body": "Please show the code line which throws the error &quot;Object Required&quot;. <code>.FormulaArray = &quot;=SUM(SUMIFS(B!$D:$D,B!$E:$E,$A5,B!$B:$B,&quot;&quot;&gt;=&quot;&quot;&amp;E$2,B!$B:$B,&zwnj;&#8203;&quot;&quot;&lt;&quot;&quot;&amp;F$2)*1,SUMIFS(&zwnj;&#8203;B!$D:$D,B!$F:$F,$A5,&zwnj;&#8203;B!$B:$B,&quot;&quot;&gt;=&quot;&quot;&amp;E$2,B&zwnj;&#8203;!$B:$B,&quot;&quot;&lt;&quot;&quot;&amp;F$2)*-1&zwnj;&#8203;)&quot;</code> works for me."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1455113446, "post_id": 35307282, "comment_id": 58343608, "body": "That&#39;s exactly it, you need to use double quotes <code>&quot;&quot;</code> if you need quotes in the formula."}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 2675618, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/929ce34993b5be60600c2f6a2b33e8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Fleetwood", "link": "https://stackoverflow.com/users/2675618/nick-fleetwood"}, "edited": false, "score": 0, "creation_date": 1455199929, "post_id": 35331916, "comment_id": 58390379, "body": "Ah, thanks for explaining! Yes, working now. Unfortunately, this has presented a new problem for me. But that&#39;s for another question. Awesome"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 0, "last_activity_date": 1455170564, "creation_date": 1455170564, "answer_id": 35331916, "question_id": 35307282, "link": "https://stackoverflow.com/questions/35307282/vba-insert-correlating-array-formula-into-cell/35331916#35331916", "title": "VBA Insert correlating array formula into cell", "body": "<p>If a string literal is enclosed in double quotes and we need double quotes in the string literal, then we must mask those double quotes somehow. If we don't, the unmasked double quote will end the string literal. This is the case with all programming languages.</p>\n\n<p>In VBA we mask double quotes by repeating them.</p>\n\n<pre><code>Dim s As String\n's = \"He said: \"This is a quote.\" But this is not a valid string literal\"\ns = \"He said: \"\"This is a quote.\"\" This is  a valid string literal\"\n</code></pre>\n\n<p>Normally the VBA editor will recognize such invalid string literals. But here you are confusing it with comparison operators.</p>\n\n<pre><code>s = \"Sting literal 1\" &gt;= \"Sting literal 2\"\n</code></pre>\n\n<p>So <code>s</code> will become the string representation of a boolean value <code>FALSE</code> since the comparison is false.</p>\n\n<p>The following will work:</p>\n\n<pre><code>.FormulaArray = \"=SUM(SUMIFS(B!$D:$D,B!$E:$E,$A5,B!$B:$B,\"\"&gt;=\"\"&amp;E$2,B!$B:$B,\"\"&lt;\"\"&amp;F$2)*1,SUMIFS(B!$D:$D,B!$F:$F,$A5,B!$B:$B,\"\"&gt;=\"\"&amp;E$2,B!$B:$B,\"\"&lt;\"\"&amp;F$2)*-1)\"\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 2675618, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/929ce34993b5be60600c2f6a2b33e8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Fleetwood", "link": "https://stackoverflow.com/users/2675618/nick-fleetwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 35331916, "answer_count": 1, "score": -1, "last_activity_date": 1455200064, "creation_date": 1455081029, "last_edit_date": 1455200064, "question_id": 35307282, "link": "https://stackoverflow.com/questions/35307282/vba-insert-correlating-array-formula-into-cell", "title": "VBA Insert correlating array formula into cell", "body": "<p>I have an input page, where the user can determine the number of accounts they need and which will display on the overview page. There are six different types of account.  I have accomplished this using the Copy property. My code pastes each of the six types one at a time.</p>\n\n<pre><code>With Sheet4\n    .Range(\"B9\", .Cells(Rows.Count, \"C\").End(xlUp)).Copy Sheet7.[A4]\nEnd With\n</code></pre>\n\n<p>Next, for each row, I need to insert a specified formula for each account. I have accomplished this as so:</p>\n\n<pre><code>'then count sheet7 col a\nqRow = wsA.Cells(Rows.Count, 1).End(xlUp).Row\n'paste the formula\nDim q As Long\nFor q = 2 To qRow\n    If wsA.Cells(q, 1).Value &gt; 1000 Then\n        wsA.Cells(q, 5).Value = \"=sum(2+1)\"\n    End If\n    Next q\n</code></pre>\n\n<p>So far, so good. My problem occurs at this juncture, because the following is the actual formula I need to insert, and it needs to be an ARRAY formula:</p>\n\n<pre><code>=SUM(SUMIFS(B!$D:$D,B!$E:$E,$A5,B!$B:$B,\"&gt;=\"&amp;E$2,B!$B:$B,\"&lt;\"&amp;F$2)*1,SUMIFS(B!$D:$D,B!$F:$F,$A5,B!$B:$B,\"&gt;=\"&amp;E$2,B!$B:$B,\"&lt;\"&amp;F$2)*-1)\n</code></pre>\n\n<p>I tried messing with the .formulaArray property, but I kept getting \"Object Required\"</p>\n\n<p>Any thoughts?\nI'm open to changing up my code, if anyone has a better idea on how to accomplish this. Thanks!</p>\n\n<p>UPDATE 10FEB15</p>\n\n<p>Error code is \"mismatch\" on the commented line:</p>\n\n<pre><code>If wsA.Cells(q, 1).Value &gt; 1000 Then\n        'wsA.Cells(q, 5).FormulaArray = \"=SUM(SUMIFS(B!$D:$D,B!$E:$E,$A5,B!$B:$B,\" &gt;= \"&amp;E$2,B!$B:$B,\" &lt; \"&amp;F$2)*1,SUMIFS(B!$D:$D,B!$F:$F,$A5,B!$B:$B,\" &gt;= \"&amp;E$2,B!$B:$B,\" &lt; \"&amp;F$2)*-1)\"   \n    End If\n</code></pre>\n\n<p>SOLUTION:\nIn VBA we mask double quotes by repeating them.</p>\n\n<pre><code>Dim s As String\n's = \"He said: \"This is a quote.\" But this is not a valid string literal\"\ns = \"He said: \"\"This is a quote.\"\" This is  a valid string literal\"\n</code></pre>\n\n<p>Normally the VBA editor will recognize such invalid string literals. But here I was confusing it with comparison operators.</p>\n\n<p>For the string literal within the formula, I required double quotations. Full answer below.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1455087085, "post_id": 35307702, "comment_id": 58326785, "body": "A little bit more hint Explode = Split function. Good Luck."}, {"owner": {"reputation": 303, "user_id": 5765277, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-swG-f0kZpSA/AAAAAAAAAAI/AAAAAAAAANw/PZrFjfmUSy0/photo.jpg?sz=128", "display_name": "VolleyballAddictSandiego", "link": "https://stackoverflow.com/users/5765277/volleyballaddictsandiego"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1455089944, "post_id": 35307702, "comment_id": 58328168, "body": "yup.  author tagged it vba so it&#39;s split. if author&#39;d tagged it php then it&#39;d be explode."}, {"owner": {"reputation": 39, "user_id": 5906472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8026fea335e1795c793f7ba90fcd2225?s=128&d=identicon&r=PG&f=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/5906472/gopi"}, "edited": false, "score": 0, "creation_date": 1455162346, "post_id": 35307702, "comment_id": 58368946, "body": "Can you please give piece of code to implement this logic in excel vba?"}, {"owner": {"reputation": 303, "user_id": 5765277, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-swG-f0kZpSA/AAAAAAAAAAI/AAAAAAAAANw/PZrFjfmUSy0/photo.jpg?sz=128", "display_name": "VolleyballAddictSandiego", "link": "https://stackoverflow.com/users/5765277/volleyballaddictsandiego"}, "edited": false, "score": 0, "creation_date": 1455163433, "post_id": 35307702, "comment_id": 58369243, "body": "&quot;Can you please write the code for me&quot;. No, this doesn&#39;t work that way. Read what I wrote above, it explains the approach. You write it. I repeat, you write the code. We help you if you get stuck."}], "tags": [], "owner": {"reputation": 303, "user_id": 5765277, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-swG-f0kZpSA/AAAAAAAAAAI/AAAAAAAAANw/PZrFjfmUSy0/photo.jpg?sz=128", "display_name": "VolleyballAddictSandiego", "link": "https://stackoverflow.com/users/5765277/volleyballaddictsandiego"}, "is_accepted": false, "score": 1, "last_activity_date": 1455082932, "creation_date": 1455082932, "answer_id": 35307702, "question_id": 35307281, "link": "https://stackoverflow.com/questions/35307281/split-multiple-comma-separated-entries-from-multiple-columns-to-new-rows-with-un/35307702#35307702", "title": "Split multiple comma separated entries from multiple columns to new rows with unique data in excel macro VBA", "body": "<p>Well that sure does look an awful lot like a homework assignment for someone enrolled in an introduction to software development course.</p>\n\n<p>Your first LOOP is to take the string \"Apple,Orange,Apricot  \" which has at most 22 characters and explode it by the COMMA, then loop through its elements.\nYour nested second LOOP is to do likewise with the string \"Fruit,Vegetable  \" which has at most 17 characters and explode it by the COMMA, then loop through its elements.\nYour nested nested third LOOP is ... you get the idea.\nSince Apple maps to both Fruit and Vegetable, and to both Cat1 and Cat2, the output ends up having 4 instances of Apple. This kind of extraction is also known as a Cartesian product, where 1x2x2=4.</p>\n\n<p>So, the purpose of this is to teach you how to split a string on a comma character, then use the resulting array of comma-separated-strings to loop though an action.</p>\n\n<p>Why isn't there a 200 point reputation bounty on this question?  Hmm... hard to say (I'm joking). But on the bright side, it's just simple enough that even I can answer it, so that's something!  Have a great day.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10177223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2a2c9adef4befea96f1859f79ef9e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar", "link": "https://stackoverflow.com/users/10177223/sagar"}, "is_accepted": false, "score": 1, "last_activity_date": 1533486848, "last_edit_date": 1533486848, "creation_date": 1533483341, "answer_id": 51695734, "question_id": 35307281, "link": "https://stackoverflow.com/questions/35307281/split-multiple-comma-separated-entries-from-multiple-columns-to-new-rows-with-un/51695734#51695734", "title": "Split multiple comma separated entries from multiple columns to new rows with unique data in excel macro VBA", "body": "<pre><code>Public Sub SliceNDice()\n\n    Dim objRegex As Object\n    Dim X\n    Dim Y\n    Dim lngRow As Long\n    Dim lngCnt As Long\n    Dim tempArr() As String\n    Dim strArr\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    objRegex.Pattern = \"^\\s+(.+?)$\"\n     'Define the range to be analysed\n    X = Range([a2], Cells(Rows.Count, \"c\").End(xlUp)).Value2\n    ReDim Y(1 To 3, 1 To 1000)\n    For lngRow = 1 To UBound(X, 1)\n         'Split each string by \",\"\n        tempArr = Split(X(lngRow, 2), \",\")\n        For Each strArr In tempArr\n            lngCnt = lngCnt + 1\n             'Add another 1000 records to resorted array every 1000 records\n            If lngCnt Mod 1000 = 0 Then ReDim Preserve Y(1 To 3, 1 To lngCnt + 1000)\n                Y(1, lngCnt) = X(lngRow, 1)\n                Y(3, lngCnt) = objRegex.Replace(strArr, \"$1\")\n        Next\n    Next lngRow\n\n    Worksheets(\"Test_Execution\").Range(\"A1\").Value = \"Req. JIRA#\"\n    Worksheets(\"Test_Execution\").Range(\"B1\").Value = \"Req. JIRA Summary\"\n    Worksheets(\"Test_Execution\").Range(\"C1\").Value = \"Test JIRA#\"\n    Worksheets(\"Test_Execution\").Range(\"D1\").Value = \"Test JIRA Summary\"\n    Worksheets(\"Test_Execution\").Range(\"E1\").Value = \"Issue Type\"\n    Worksheets(\"Test_Execution\").Range(\"F1\").Value = \"Execution Status\"\n    Worksheets(\"Test_Execution\").Range(\"G1\").Value = \"Comments\"\n\n\n     'Dump the re-ordered range to columns C:D\n    Worksheets(\"Test_Execution\").[a2].Resize(lngCnt, 3).Value2 = Application.Transpose(Y)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5906472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8026fea335e1795c793f7ba90fcd2225?s=128&d=identicon&r=PG&f=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/5906472/gopi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1533486848, "creation_date": 1455081027, "last_edit_date": 1531164843, "question_id": 35307281, "link": "https://stackoverflow.com/questions/35307281/split-multiple-comma-separated-entries-from-multiple-columns-to-new-rows-with-un", "title": "Split multiple comma separated entries from multiple columns to new rows with unique data in excel macro VBA", "body": "<p>I want to separate the values in excel with unique data. I have bunch of data like below. </p>\n\n<pre><code>1 Apple,Orange,Apricot  Fruit,Vegetable  Cat1,Cat2\n2 Aubergine,Avocado     Vegetable        Cat2,Cat3,Cat4\n3 Banana                Fruit            Cat5\n</code></pre>\n\n<p>I just want to split the above values like below split values using excel VBA. Multiple columns contains comma-separated values. Have to split values to new rows with unique data.</p>\n\n<pre><code>1 Apple      Fruit      Cat1\n1 Apple      Fruit      Cat2\n1 Apple      Vegetable  Cat1\n1 Apple      Vegetable  Cat2\n1 Orange     Fruit      Cat1\n1 Orange     Fruit      Cat2\n1 Orange     Vegetable  Cat1\n1 Orange     Vegetable  Cat2\n1 Apricot    Fruit      Cat1\n1 Apricot    Fruit      Cat2\n1 Apricot    Vegetable  Cat1\n1 Apricot    Vegetable  Cat2\n2 Aubergine  Vegetable  Cat2\n.......................\n</code></pre>\n\n<p>Can you help me?</p>\n"}, {"tags": ["oracle", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455082332, "post_id": 35307132, "comment_id": 58324888, "body": "You need to have the Oracle client installed."}, {"owner": {"reputation": 1, "user_id": 4432236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7c28dc02134252157a4e968415dd0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Sawant", "link": "https://stackoverflow.com/users/4432236/shankar-sawant"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455114475, "post_id": 35307132, "comment_id": 58344412, "body": "Thanks for above comment..On my machine SQL developer is installed to access Oracle database..."}, {"owner": {"reputation": 1, "user_id": 4432236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7c28dc02134252157a4e968415dd0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Sawant", "link": "https://stackoverflow.com/users/4432236/shankar-sawant"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455115521, "post_id": 35307132, "comment_id": 58345171, "body": "Oracle_11G_Client_R2 is installed on my machine"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455118447, "post_id": 35307132, "comment_id": 58347460, "body": "Do you have that specific driver installed?"}, {"owner": {"reputation": 1, "user_id": 4432236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7c28dc02134252157a4e968415dd0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Sawant", "link": "https://stackoverflow.com/users/4432236/shankar-sawant"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455172074, "post_id": 35307132, "comment_id": 58372285, "body": "Could you please let me know the driver name"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4222703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc14fc3dbae1e5cd1bb3e973474a2dee?s=128&d=identicon&r=PG&f=1", "display_name": "DJ811", "link": "https://stackoverflow.com/users/4222703/dj811"}, "edited": false, "score": 0, "creation_date": 1455202197, "post_id": 35342467, "comment_id": 58392086, "body": "I can&#39;t add comments on your post so had to add this as an answer, the links should help though"}], "tags": [], "owner": {"reputation": 5, "user_id": 4222703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc14fc3dbae1e5cd1bb3e973474a2dee?s=128&d=identicon&r=PG&f=1", "display_name": "DJ811", "link": "https://stackoverflow.com/users/4222703/dj811"}, "is_accepted": false, "score": 0, "last_activity_date": 1455202060, "creation_date": 1455202060, "answer_id": 35342467, "question_id": 35307132, "link": "https://stackoverflow.com/questions/35307132/how-to-import-data-into-ms-excel-2010-from-sql-developer-oracle-using-vba-macr/35342467#35342467", "title": "How to import data into MS excel 2010 from SQL developer (Oracle) using VBA macro", "body": "<p>Can you confirm you can tnsping the database from your machine?</p>\n\n<p>If so can you confirm you can connect to the database and run that query from sqlplus?</p>\n\n<p>It looks like sqlserver syntax? I'm not entirely sure it would run in Oracle, I may be wrong it might well.</p>\n\n<p>If all is ok, can you confirm whether you are running 32/64bit oracle? MSDAORA would probably need to match.</p>\n\n<p>Assuming all above is correct then these links might help.</p>\n\n<p><a href=\"http://blog.mclaughlinsoftware.com/microsoft-excel/how-to-query-oracle-from-excel-2007/\" rel=\"nofollow\">http://blog.mclaughlinsoftware.com/microsoft-excel/how-to-query-oracle-from-excel-2007/</a></p>\n\n<p><a href=\"https://support.office.com/en-us/article/Connect-to-an-Oracle-database-Power-Query-d7fbd231-a705-4eb7-83b3-a66bfb678395\" rel=\"nofollow\">https://support.office.com/en-us/article/Connect-to-an-Oracle-database-Power-Query-d7fbd231-a705-4eb7-83b3-a66bfb678395</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4432236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7c28dc02134252157a4e968415dd0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Sawant", "link": "https://stackoverflow.com/users/4432236/shankar-sawant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455202060, "creation_date": 1455080299, "last_edit_date": 1455120696, "question_id": 35307132, "link": "https://stackoverflow.com/questions/35307132/how-to-import-data-into-ms-excel-2010-from-sql-developer-oracle-using-vba-macr", "title": "How to import data into MS excel 2010 from SQL developer (Oracle) using VBA macro", "body": "<p>I want to import data into MS excel 2010 from <code>SQL</code> developer (<code>Oracle</code>) using <code>VBA</code> macro</p>\n\n<p>I am using below code but not able to connect to <code>SQL</code> devevloper. Getting error like Provider not found or not installed.</p>\n\n<p>Kindly help.</p>\n\n<pre><code>Sub ImportData()\n\nSheets(\"sheet1\").Select\n\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n    \"OLEDB;Provider=MSDAORA.1;User ID=MY_USER;password= MY_PW;Data Source=sourceName\", Destination _\n    :=Range(\"$A$1\")).QueryTable\n    .CommandType = xlCmdSql\n    .CommandText = \"Select Main.[ID],Main.[Count1] From Main Where Main.[Count1] &gt; 25\"\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "date", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": true, "score": 0, "last_activity_date": 1455080755, "creation_date": 1455080755, "answer_id": 35307229, "question_id": 35307097, "link": "https://stackoverflow.com/questions/35307097/datevalue-returning-british-units/35307229#35307229", "title": "DateValue Returning British Units", "body": "<p>In Text to column Step 3 Window Select Date Option button and select your desired Date formatting from the drop down.</p>\n"}], "owner": {"reputation": 7, "user_id": 3381297, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bdc15afa2d68cd2b92e35456e597192?s=128&d=identicon&r=PG&f=1", "display_name": "user3381297", "link": "https://stackoverflow.com/users/3381297/user3381297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 35307229, "answer_count": 1, "score": 0, "last_activity_date": 1455160397, "creation_date": 1455080067, "last_edit_date": 1531164843, "question_id": 35307097, "link": "https://stackoverflow.com/questions/35307097/datevalue-returning-british-units", "title": "DateValue Returning British Units", "body": "<p>I download a spreadsheet daily that has columns of dates formatted as mm/dd/yyyy that my Excel does not recognize as dates. I need to convert them to usable dates via a macro.</p>\n\n<p>I found a very useful post here that I tweaked and came up with the following:</p>\n\n<pre><code>    'DateValue Cells\nDim v As Long, vCOLs As Variant\nvCOLs = Array(\"E\", \"F\", \"G\", \"H\", \"I\", \"L\", \"M\", \"Q\", \"R\")\nWith ActiveSheet\n    For v = LBound(vCOLs) To UBound(vCOLs)\n        If CBool(Application.CountA(.Columns(vCOLs(v)))) Then _\n            .Columns(vCOLs(v)).TextToColumns Destination:=.Columns(vCOLs(v)), _\n              DataType:=xlFixedWidth, FieldInfo:=Array(0, 4)\n    Next v\nEnd With\n</code></pre>\n\n<p>The result is flipping the date into dd/mm/yyyy leaving my data incorrect and unusable.  I read that I could do a text-to-columns, break it up, and put it back together, but with 9 columns of dates already that seems to be too many steps.</p>\n\n<p>Any ideas as to how to fix this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1455081023, "post_id": 35307263, "comment_id": 58324366, "body": "Replace <code>TextBox1</code> with <code>TB1</code> in-case of your <code>Textbox</code>."}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455081866, "post_id": 35307263, "comment_id": 58324685, "body": "still getting same error INVALID PROCEDURE CALL or Argument RUN TIME error 5 and same line is highlight"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455082305, "post_id": 35307263, "comment_id": 58324873, "body": "But I tested and its working. Can you share a sample workbook, so that we can check in real time."}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455084091, "post_id": 35307263, "comment_id": 58325581, "body": "here is link <a href=\"https://drive.google.com/file/d/0B_kP5vLX56wJb3R1TlowSy0tV00/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B_kP5vLX56wJb3R1TlowSy0tV00/&hellip;</a>"}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455084169, "post_id": 35307263, "comment_id": 58325610, "body": "just write ABC, it will give you msg click ok use backspace and it will crash"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455084808, "post_id": 35307263, "comment_id": 58325851, "body": "I just test your file. Its working fine. I am able to type without any message. When I type <code>Comma (,)</code> then it prompt message. May problem your excel any other setting. Can you test the file in another pc. I found your file completely working."}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455088401, "post_id": 35307263, "comment_id": 58327418, "body": "Have you type &quot;ABCCCC,&quot; after getting error click OK after that use backspace to delete all you will get again msg not allowed on click ok and backspace it will crash i tried in 3 PC"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455089688, "post_id": 35307263, "comment_id": 58328052, "body": "Got your point. Se my edited answer. You need to use a <code>if...</code> condition to handle blank. I also suggest to use a <code>Error Handler</code>."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1455089764, "post_id": 35307263, "comment_id": 58328087, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/103055/discussion-between-harun24hr-and-muhammad-khurrum-butt\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": true, "score": 6, "last_activity_date": 1455089739, "last_edit_date": 1455089739, "creation_date": 1455080945, "answer_id": 35307263, "question_id": 35307027, "link": "https://stackoverflow.com/questions/35307027/textbox-restriction-error-excel-vba/35307263#35307263", "title": "Textbox restriction error Excel VBA", "body": "<p>Use the following sub.</p>\n\n<pre><code>Private Sub TB1_Change()\nOn Error GoTo HarunErrHandler\nDim strStrings As String, LastLetter As String\n\n    If TB1 = \"\" Then\n        Exit Sub\n    End If\n\n    Application.EnableEvents = False\n        LastLetter = Right(TB1, 1)\n        strStrings = \",\"\n        If Val(InStr(1, strStrings, LastLetter)) &gt; 0 Then\n            MsgBox LastLetter &amp; \" not allowed\"\n            TB1 = Left(TB1, Len(TB1) - 1)\n        End If\n    Application.EnableEvents = True\n\nExit Sub\nHarunErrHandler:\nMessageBox = MsgBox(\"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 35307263, "answer_count": 1, "score": 4, "last_activity_date": 1455089739, "creation_date": 1455079752, "last_edit_date": 1531161705, "question_id": 35307027, "link": "https://stackoverflow.com/questions/35307027/textbox-restriction-error-excel-vba", "title": "Textbox restriction error Excel VBA", "body": "<p>If textbox is empty and i press backspace it crashed and highlighted line is</p>\n\n<blockquote>\n  <p>TB1 = Left(TB1, Len(TB1) - 1)</p>\n</blockquote>\n\n<p>what can i change to stop that crash</p>\n\n<pre><code>Private Sub TB1_Change()\nDim strStrings As String, LastLetter As String\nApplication.EnableEvents = False\nLastLetter = Right(TB1, 1)\nstrStrings = \",\"\nIf InStr(1, strStrings, LastLetter) &gt; 0 Then\n    MsgBox LastLetter &amp; \" not allowed\"\n    TB1 = Left(TB1, Len(TB1) - 1)\nEnd If\nApplication.EnableEvents = True\n</code></pre>\n\n<p>End Sub</p>\n\n<p>It is a textbox where \",\" is restricted.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1455091421, "post_id": 35307102, "comment_id": 58328914, "body": "You should remove the additional range call here: <code>.Range(&quot;A3:A6&quot;).InsertIndent 1</code>"}], "tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1455080095, "creation_date": 1455080095, "answer_id": 35307102, "question_id": 35307016, "link": "https://stackoverflow.com/questions/35307016/vba-expected-identifier-or-bracketed-expression-error-when-using-with-command/35307102#35307102", "title": "VBA - Expected identifier or bracketed expression error when using With command", "body": "<pre><code>Option Explicit\nSub Formatting()\nDim shtThisSheet As Worksheet\n\nSet shtThisSheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n\nWith shtThisSheet\n    With .Range(\"A3:A6\")\n        .Font.Bold = True\n        .Font.Size = 14\n        .HorizontalAlignment = xlLeft\n        .Font.Bold = True\n        .Font.Italic = True\n        .Font.ColorIndex = 5\n        .Range(\"A3:A6\").InsertIndent 1\n    End With\n    With .Range(\"B2:D2\")\n        .Font.Bold = True\n        .Font.Italic = True\n        .Font.ColorIndex = 5\n        .HorizontalAlignment = xlRight\n    End With\n    With .Range(\"B3:D6\")\n        .Font.ColorIndex = 3\n        .NumberFormat = \"$#,##0\"\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4927, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455091347, "creation_date": 1455079667, "last_edit_date": 1455091347, "question_id": 35307016, "link": "https://stackoverflow.com/questions/35307016/vba-expected-identifier-or-bracketed-expression-error-when-using-with-command", "title": "VBA - Expected identifier or bracketed expression error when using With command", "body": "<p>I am trying to figure out an problem for class where the idea is to \"shorten\" the code using the With command. Below is the code I have so far. I am curious why you cannot use the shtThisSheet variable under the with command when there is a parenthesis directly after the .</p>\n\n<p>Thanks all!</p>\n\n<pre><code>Option Explicit\n\nSub Formatting()\nDim shtThisSheet As Worksheet\nSet shtThisSheet = ActiveWorkbook.Worksheets(\"Sheet1\").Range\n\n\nWith shtThisSheet\n\n    .Font.Bold = True\n    .Font.Size = 14\n    .HorizontalAlignment = xlLeft\n    . (\"A3:A6\").Font.Bold = True\n    .(\"A3:A6\").Font.Italic = True\n    .(\"A3:A6\").Font.ColorIndex = 5\n    .Range(\"A3:A6\").InsertIndent 1\n    .Range(\"B2:D2\").Font.Bold = True\n    .Range(\"B2:D2\").Font.Italic = True\n    .Range(\"B2:D2\").Font.ColorIndex = 5\n    .Range(\"B2:D2\").HorizontalAlignment = xlRight\n    .Range(\"B3:D6\").Font.ColorIndex = 3\n    .Range(\"B3:D6\").NumberFormat = \"$#,##0\"\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 1, "creation_date": 1455090143, "post_id": 35306692, "comment_id": 58328268, "body": "welcome at Stackoverflow. You are asking a complete solution for a complex problem (open web-page from url, open its source, find tag, extract value to excel). What exactly is your problem? What&#39;ve you already tried to achieve? Please note that as it is currently your question likely will be closed as too broad."}, {"owner": {"reputation": 157, "user_id": 5902616, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Io3Nj49eguA/AAAAAAAAAAI/AAAAAAAAAD8/nrWAIhBNmiQ/photo.jpg?sz=128", "display_name": "jatin verma", "link": "https://stackoverflow.com/users/5902616/jatin-verma"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1455095799, "post_id": 35306692, "comment_id": 58331334, "body": "Thanks for reply, i already solved this problem. (after asking this question here)"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 1, "creation_date": 1455096582, "post_id": 35306692, "comment_id": 58331884, "body": "could you please post your answer too? that would help also others to benefit from it. Otherwise if you don&#39;t want to publish it then please remove your question instead of just abandoning it."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5902616, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Io3Nj49eguA/AAAAAAAAAAI/AAAAAAAAAD8/nrWAIhBNmiQ/photo.jpg?sz=128", "display_name": "jatin verma", "link": "https://stackoverflow.com/users/5902616/jatin-verma"}, "edited": false, "score": 0, "creation_date": 1455098770, "post_id": 35312089, "comment_id": 58333344, "body": "change &quot;.Visible=1&quot; to &quot;Visible=0&quot;"}], "tags": [], "owner": {"reputation": 157, "user_id": 5902616, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Io3Nj49eguA/AAAAAAAAAAI/AAAAAAAAAD8/nrWAIhBNmiQ/photo.jpg?sz=128", "display_name": "jatin verma", "link": "https://stackoverflow.com/users/5902616/jatin-verma"}, "is_accepted": false, "score": 1, "last_activity_date": 1455101722, "last_edit_date": 1455101722, "creation_date": 1455098682, "answer_id": 35312089, "question_id": 35306692, "link": "https://stackoverflow.com/questions/35306692/how-to-get-tag-value-by-tag-name-using-web-scraping-in-excel-sheet/35312089#35312089", "title": "How to get tag value by tag name using web scraping in Excel sheet?", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Public Sub GetValueFromBrowser()\n' Keyboard Shortcut: Ctrl+q\nDim ie As Object\n    Dim url As String\n    Dim selling As String\n    Dim cost As String\n    url = Selection.Value\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n      .Visible = 1\n      .navigate url\n       While .Busy Or .readyState &lt;&gt; 4\n         DoEvents\n       Wend\n    End With\n\n    Dim Doc As HTMLDocument\n    Set Doc = ie.document\n\n    selling = Trim(Doc.getElementsByName(\"sellingPrice\")(0).Value)\n    ActiveCell.Offset(0, 1).Value = selling\n    cost = Trim(Doc.getElementsByName(\"costPrice\")(0).Value)\n    ActiveCell.Offset(0, 2).Value = cost\n    ie.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5902616, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Io3Nj49eguA/AAAAAAAAAAI/AAAAAAAAAD8/nrWAIhBNmiQ/photo.jpg?sz=128", "display_name": "jatin verma", "link": "https://stackoverflow.com/users/5902616/jatin-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455101722, "creation_date": 1455077562, "last_edit_date": 1531161705, "question_id": 35306692, "link": "https://stackoverflow.com/questions/35306692/how-to-get-tag-value-by-tag-name-using-web-scraping-in-excel-sheet", "title": "How to get tag value by tag name using web scraping in Excel sheet?", "body": "<p>I do daily analysis of eCommerce sites and I have to copy their prices.</p>\n\n<p>All i wanna do is, i paste the URL of a website into an Excel worksheet and I get prices from the tag name in the cell. The source of site looks like this: </p>\n\n<pre><code>&lt;table&gt;\n&lt;td&gt;\nPrice\n&lt;/td&gt;\n&lt;td&gt;\n:\n&lt;/td&gt;\n&lt;td&gt;\n&lt;input name=\"Price\" type=\"text\" value=\"148.0000\" id=\"uxMSRPPrice1\" style=\"width: 250px;\" /&gt;\n(In x.xx format)\n&lt;/td&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>and I want to get price 148.0000 in my worksheet, using tag name=\"Price\"\nprice is unique tag in source</p>\n\n<p>One more thing, I can only get source from the URL like this including view-source (I cant share the original client URL so i change it to <code>xyz</code>):</p>\n\n<pre><code>https://www.xyz com/admin/ProductPage.aspx?ProductID=xxx\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": true, "score": 4, "last_activity_date": 1455076466, "creation_date": 1455076466, "answer_id": 35306522, "question_id": 35306442, "link": "https://stackoverflow.com/questions/35306442/copy-range-values-into-array-without-for-loop/35306522#35306522", "title": "Copy range values into array without for loop", "body": "<p>Use Transpose()</p>\n\n<p>Replace this line</p>\n\n<pre><code>Range(\"C1:E1\").Value = Arr\n</code></pre>\n\n<p>With</p>\n\n<pre><code>Range(\"C1:E1\").Value = Application.Transpose(Arr)\n</code></pre>\n"}], "owner": {"reputation": 1318, "user_id": 5370413, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2b7951a75d86af6b167f26c2640fb46b?s=128&d=identicon&r=PG&f=1", "display_name": "KKS", "link": "https://stackoverflow.com/users/5370413/kks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10267, "favorite_count": 1, "accepted_answer_id": 35306522, "answer_count": 1, "score": 1, "last_activity_date": 1455086881, "creation_date": 1455075889, "last_edit_date": 1455086881, "question_id": 35306442, "link": "https://stackoverflow.com/questions/35306442/copy-range-values-into-array-without-for-loop", "title": "Copy range values into array without for loop", "body": "<p>I would like to copy Range values into an array, and then copy the array into new range like below.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\nDim Arr As Variant\nArr = Range(\"A1:A3\").Value\nRange(\"C1:E1\").Value = Arr\nEnd Sub\n</code></pre>\n\n<p>But, the result is as below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HaaY6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HaaY6.png\" alt=\"enter image description here\"></a></p>\n\n<p>What's wrong with this code?</p>\n\n<p>Are there any ways to tranfer range values into new range without for loop?</p>\n"}, {"tags": ["excel", "vba", "events", "runtime-error", "schedule"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455085377, "post_id": 35306243, "comment_id": 58326062, "body": "I only see an error when trying to clear a non-set timeout.  Are you certain the timeouts are actually set when you&#39;re trying to clear them?  Eg &quot;TaskTracker&quot; only gets set if there&#39;s an error in the Function."}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455110452, "post_id": 35306243, "comment_id": 58341463, "body": "Hey @TimWilliams thanks for the reply. The timers are indeed set when I attempt to clear them. Both functions are called when the Workbook is opened, and the AutoDeactivate function is called when the Workbook is closed. I know that they are sceduled even when I get the error message as the Workbook re-open itself after closure (which is the problem I attempt to fix by canceling the schedule). Since the workbook reopen, there must have been an event scheduled."}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "is_accepted": true, "score": 1, "last_activity_date": 1455125495, "creation_date": 1455125495, "answer_id": 35322015, "question_id": 35306243, "link": "https://stackoverflow.com/questions/35306243/application-ontime-cancel-fails-to-method-ontime-of-object-application/35322015#35322015", "title": "Application.Ontime Cancel Fails to Method &#39;ONTIME&#39; of Object &#39;Application&#39;", "body": "<p>It looks like it was a setup mistake!</p>\n\n<pre><code>Option Explicit\nDim dTime As Date\nDim dTime2 As Date\n\nApplication.OnTime dTime, \"TaskTracker\", , True\nApplication.OnTime dTime2, \"AutoClear\", , True\n</code></pre>\n\n<p>With the AutoDeactivation function called when the workbook closes does work as intended!</p>\n\n<pre><code>Function AutoDeactivate()\nOn Error Resume Next\nApplication.OnTime EarliestTime:=dTime, Procedure:=\"TaskTracker\", _\nSchedule:=False\nApplication.OnTime EarliestTime:=dTime2, Procedure:=\"AutoClear\", _\nSchedule:=False\nEnd Function\n</code></pre>\n\n<p>Workbook_BeforeClose:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nCall AutoDeactivate\nEnd Sub\n</code></pre>\n\n<p>What was happening is pretty idiotic. I had an issue with canceling the event at Work, so I took the Excel Sheet home and coded the fix found above. Yet, it still didn't work. Not because there was a mistake in it, but because I didn't have Outlook at home! :P</p>\n\n<p>Not having the Outlook application prevented the event from being rescheduled after running once (resulting in an auto-dismissed ActiveX error message).</p>\n\n<p>So as soon as I took this script back to work (where Outlook is installed) and everything worked properly :)</p>\n\n<p>Marking this as resolved by myself haha.</p>\n"}], "owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4296, "favorite_count": 0, "accepted_answer_id": 35322015, "answer_count": 1, "score": 0, "last_activity_date": 1543171071, "creation_date": 1455074354, "last_edit_date": 1543171071, "question_id": 35306243, "link": "https://stackoverflow.com/questions/35306243/application-ontime-cancel-fails-to-method-ontime-of-object-application", "title": "Application.Ontime Cancel Fails to Method &#39;ONTIME&#39; of Object &#39;Application&#39;", "body": "<p>I am <strong>completely</strong> lost so any help will be greatly appreciated. </p>\n\n<p>I am attempting to cancel 2 scheduled event that are triggered when the Workbook is opened, and repeated using the Application.Ontime method.</p>\n\n<p>I know that to terminate the OnTime schedule loop, you must provide the exact time that it is scheduled to run and that having multiple Application.OnTime tasks requires multiple variables.\nThis is why I have set two Public variables (Header of the document below Options Explicit):</p>\n\n<pre><code>Dim dTime as Date\nDim dTime2 as Date\n</code></pre>\n\n<p>The scheduler use these Variables and everything works properly as the code runs every minute.</p>\n\n<p><strong>dTime</strong>'s value is set inside the <strong>TaskTracker</strong> function to be:</p>\n\n<pre><code>dTime = Now() + TimeValue(\"00:01:00\")\nApplication.OnTime dTime, \"TaskTracker\", , True\n</code></pre>\n\n<p><strong>dTime2</strong>'s value is set inside the <strong>Autoclear</strong> function to be:</p>\n\n<pre><code>dTime2 = Now() + TimeValue(\"00:01:00\")\nApplication.OnTime dTime, \"AutoClear\", , True\n</code></pre>\n\n<p>Despite all this, I get a <em>Method 'ONTIME' of Object'Application'</em> error message when attempting to run the function at the end of the module:</p>\n\n<pre><code>Function AutoDeactivate()\nApplication.OnTime EarliestTime:=dTime, Procedure:=\"TaskTracker\", _\n    Schedule:=False\nApplication.OnTime EarliestTime:=dTime2, Procedure:=\"AutoClear\", _\n    Schedule:=False\nEnd Function\n</code></pre>\n\n<p>This is where I absolutely do not get what is going wrong. Triggering the Debug brings me to the OnTime section of each procedure cancel attempt.</p>\n\n<p>Below is the script that contains these elements. Hopefully this will give you guys some insight as to why these event can't be canceled.</p>\n\n<pre><code>Option Explicit\nDim dTime As Date\nDim dTime2 As Date\n\n'------------------------------------------------------------\n'This is what checks cells to define if an email notification has to be sent, and what the content of that email should be.\n'------------------------------------------------------------\nFunction TaskTracker()\nDim FormulaCell     As Range\nDim FormulaRange    As Range\nDim NotSentMsg      As String\nDim MyMsg           As String\nDim SentMsg         As String\nDim SendTo          As String\nDim CCTo            As String\nDim BCCTo           As String\nDim MyLimit         As Double\nDim MyLimit2        As Double\n\ndTime = Now() + TimeValue(\"00:01:00\")\nNotSentMsg = \"Not Sent\"\nSentMsg = \"Sent\"\nSendTo = ThisWorkbook.Worksheets(\"Tasks\").Range(\"D2\")\nCCTo = ThisWorkbook.Worksheets(\"Tasks\").Range(\"E2\")\nBCCTo = ThisWorkbook.Worksheets(\"Tasks\").Range(\"F2\")\n\nMyLimit = Date\nMyLimit2 = ((Round(Now * 1440, 0) - 30) / 1440)\n\nSet FormulaRange = ThisWorkbook.Worksheets(\"Tasks\").Range(\"F5:F35\")\nOn Error GoTo EndMacro:\nFor Each FormulaCell In FormulaRange.Cells\n    With FormulaCell\n            If DateValue(CDate(.Value)) = MyLimit Then\n                MyMsg = SentMsg\n                If .Offset(0, 1).Value = NotSentMsg Then\n                    strTO = SendTo\n                    strCC = CCTo\n                    strBCC = BCCTo\n                    strSub = \"[Task Manager] Reminder that you need to: \" &amp; Cells(FormulaCell.Row, \"B\").Value\n\n                If Cells(FormulaCell.Row, \"C\").Value = \"\" Then\n                        strBody = \"Greetings, \" &amp; vbNewLine &amp; vbNewLine &amp; _\n                        \"Your task : \" &amp; Cells(FormulaCell.Row, \"B\").Value &amp; \" is nearing its Due Date: \" &amp; Cells(FormulaCell.Row, \"F\").Value &amp; \".\" &amp; vbNewLine &amp; \"A wise decision would be to complete this task before it expires!\" &amp; _\n                        vbNewLine &amp; vbNewLine &amp; \"Truly yours,\" &amp; vbNewLine &amp; \"Task Manager\"\n                Else\n                        strBody = \"Hello, \" &amp; vbNewLine &amp; vbNewLine &amp; _\n                        \"Your task : \" &amp; Cells(FormulaCell.Row, \"B\").Value &amp; \" with the mention: \" &amp; Cells(FormulaCell.Row, \"C\").Value &amp; \" is nearing its Due Date: \" &amp; Cells(FormulaCell.Row, \"F\").Value &amp; \".\" &amp; vbNewLine &amp; \"A wise decision would be to complete this task before it expires!\" &amp; _\n                        vbNewLine &amp; vbNewLine &amp; \"Truly yours,\" &amp; vbNewLine &amp; \"Task Manager\"\n                End If\n        If sendMail(strTO, strSub, strBody, strCC) = True Then MyMsg = SentMsg\n        End If\n\n            Else\n            MyMsg = NotSentMsg\n            End If\n\n            If .Value = MyLimit2 Then\n            MyMsg = NotSentMsg\n        End If\n\n            Application.EnableEvents = False\n            .Offset(0, 1).Value = MyMsg\n            Application.EnableEvents = True\n\n    End With\n\nNext FormulaCell\n\nExitMacro:\nExit Function\n\nEndMacro:\nApplication.EnableEvents = True\n\nMsgBox \"Some Error occurred.\" _\n     &amp; vbLf &amp; Err.Number _\n     &amp; vbLf &amp; Err.Description\n\nApplication.OnTime dTime, \"TaskTracker\", , True\n\nEnd Function\n'------------------------------------------------------------\n'This is the function that clears the rows of Completed Tasks\n'------------------------------------------------------------\nFunction AutoClear()\nDim i As Integer\n\ndTime2 = Now() + TimeValue(\"00:01:00\")\n\nWith Tasks\n    For i = 5 To 35\n         If .Cells(i, 4).Value Like \"Done\" And .Cells(i, 5).Value = \"1\" Then\n            .Cells(i, 1).ClearContents\n            .Cells(i, 2).ClearContents\n            .Cells(i, 3).ClearContents\n            .Cells(i, 5).ClearContents\n            .Cells(i, 6).ClearContents\n            .Cells(i, 4).Value = \"Pending\"\n            .Cells(i, 7).Value = \"Not Sent\"\n\n        End If\n    Next i\nEnd With\n\nTasks.AutoFilter.ApplyFilter\nApplication.OnTime dTime2, \"AutoClear\", , True\n\nEnd Function\n'------------------------------------------------------------\n'ThisWorkbook calls this to deactivate the Application.OnTime. This \"should\" prevent the Excel process from reoppening the worksheets.\n'------------------------------------------------------------\n\nFunction AutoDeactivate()\nOn Error Resume Next\nApplication.OnTime EarliestTime:=dTime, Procedure:=\"TaskTracker\", _\n    Schedule:=False\nApplication.OnTime EarliestTime:=dTime2, Procedure:=\"AutoClear\", _\n    Schedule:=False\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3169, "user_id": 39355, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ac230262ca0d3dcee88af9851c884a?s=128&d=identicon&r=PG", "display_name": "Theresa", "link": "https://stackoverflow.com/users/39355/theresa"}, "edited": false, "score": 0, "creation_date": 1455080590, "post_id": 35306048, "comment_id": 58324200, "body": "What code have you tried?  You can edit your question to add your code."}], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1455077167, "creation_date": 1455077167, "answer_id": 35306611, "question_id": 35306048, "link": "https://stackoverflow.com/questions/35306048/how-to-format-data-copied-from-the-web-and-pasted-into-an-excel-sheet-without-al/35306611#35306611", "title": "How to format data copied from the Web and pasted into an Excel sheet without altering the string itself?", "body": "<p>Try to set that column formatting as Text (Manually) and performing Paste Special Values will consider the value as Text without changing anything in the pasted data.</p>\n"}], "owner": {"reputation": 11, "user_id": 5906091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bda9b444bbc5a9576dc140292360674?s=128&d=identicon&r=PG&f=1", "display_name": "EasyShortcutsPlease", "link": "https://stackoverflow.com/users/5906091/easyshortcutsplease"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455077167, "creation_date": 1455072981, "question_id": 35306048, "link": "https://stackoverflow.com/questions/35306048/how-to-format-data-copied-from-the-web-and-pasted-into-an-excel-sheet-without-al", "title": "How to format data copied from the Web and pasted into an Excel sheet without altering the string itself?", "body": "<p>Let us say I need to copy a list of names from a webpage. Since I don't want to retain the formatting that is there in the webpage, I currently use Paste Special\u2192\"Match Destination format\". This is simple and clean.</p>\n\n<p>But Excel also removes any extra spaces present within the string.\ne.g. ABC  DEF will become ABC DEF.\nThis is also true for leading and trailing spaces. I believe this is the TRIM function at work which is part of the default settings.</p>\n\n<p>What can I do to apply new formatting without applying the TRIM function? (Other than pasting with source formatting and changing the format manually?)</p>\n\n<p>I think the question can be extended to other parts of the default settings. e.g. the default number formatting in Excel may not be what you want. I looked at the settings under Excel\u2192Options but could not find the settings that specified number/text formatting.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1455076321, "creation_date": 1455076321, "answer_id": 35306505, "question_id": 35305802, "link": "https://stackoverflow.com/questions/35305802/how-do-i-select-a-range-of-cells-in-a-table-top-copy-using-vba/35306505#35306505", "title": "How do I select a range of cells in a table top copy using VBA?", "body": "<p>Try something like this... Adapt the resize rows, columns column based on your requirement.</p>\n\n<p>Resize(Row,Column)</p>\n\n<pre><code>Range(\"Table1\").Cells(1).Resize(5, 2).Copy\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1480095129, "creation_date": 1455071115, "last_edit_date": 1531161705, "question_id": 35305802, "link": "https://stackoverflow.com/questions/35305802/how-do-i-select-a-range-of-cells-in-a-table-top-copy-using-vba", "title": "How do I select a range of cells in a table top copy using VBA?", "body": "<p>What is the syntax for copying a range of cells from a table using VBA? Ideally it would be a structured reference, using the column names and table row numbers. And be able to select any sized rectangle of cells from that table, not just one row or one column.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455062959, "post_id": 35304535, "comment_id": 58319713, "body": "works fine for me... exactly as it is... maybe there&#39;s just a lot of data... try to set a <code>ActiveChart.Refresh</code> as last step... maybe that helps"}, {"owner": {"reputation": 927, "user_id": 4950204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/246295ada7d994b6b6a585163107f770?s=128&d=identicon&r=PG&f=1", "display_name": "kaminsknator", "link": "https://stackoverflow.com/users/4950204/kaminsknator"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455125314, "post_id": 35304535, "comment_id": 58352599, "body": "Thanks for the feedback refresh didn&#39;t seem to help but if i a create a new sheet first within the macro the data displays fine. Very strange must be something unique to my system. Thanks again."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "is_accepted": true, "score": 0, "last_activity_date": 1455129965, "creation_date": 1455129965, "answer_id": 35323433, "question_id": 35304535, "link": "https://stackoverflow.com/questions/35304535/macro-creates-graph-but-doesnt-display-until-manually-select-data/35323433#35323433", "title": "macro creates graph but doesn&#39;t display until manually select data", "body": "<p>Sometimes the Modules in Excel can get corrupted and the code does strange things.</p>\n\n<p>Copy your code into notepad or notepad++, delete the module, add a new module, and paste the code back into the module from notepad.  see if that helps.  I've had to do that more than once.</p>\n"}], "owner": {"reputation": 927, "user_id": 4950204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/246295ada7d994b6b6a585163107f770?s=128&d=identicon&r=PG&f=1", "display_name": "kaminsknator", "link": "https://stackoverflow.com/users/4950204/kaminsknator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 35323433, "answer_count": 1, "score": 0, "last_activity_date": 1521470755, "creation_date": 1455062319, "last_edit_date": 1455120726, "question_id": 35304535, "link": "https://stackoverflow.com/questions/35304535/macro-creates-graph-but-doesnt-display-until-manually-select-data", "title": "macro creates graph but doesn&#39;t display until manually select data", "body": "<p>I have a macro in excel that creates a graph from the data is the first worksheet. The issue is that the graph is blank until i right click, select data, press ok. I don't have to actually select the data the values are already populated. Once I do this the graph looks fine. How do I get the graph to show the values without having to manually do this?</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart2(240, xlXYScatterLinesNoMarkers).Select\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(1).Name = Sheets(1).Range(\"C1\")\nActiveChart.FullSeriesCollection(1).XValues = Sheets(1).Range(\"AB:AB\")\nActiveChart.FullSeriesCollection(1).Values = Sheets(1).Range(\"C:C\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1455060695, "post_id": 35304237, "comment_id": 58318878, "body": "Remove the quotes. Edit: maybe not... you might have to concatenate quotes with the variable XD"}, {"owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1455068646, "post_id": 35304237, "comment_id": 58321216, "body": "tried that. no luck."}], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "edited": false, "score": 0, "creation_date": 1455068856, "post_id": 35304549, "comment_id": 58321277, "body": "Tried your code. Now the main function triggers a circular reference warning, requiring user to click on [OK], and then the main function evaluates to 0, which is not the correct answer, presumably because it is not pointing to the intended worksheet."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "edited": false, "score": 0, "creation_date": 1455074567, "post_id": 35304549, "comment_id": 58322614, "body": "@Max  **You must put a value in <code>paramLabel</code> when you adapt this code."}, {"owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "edited": false, "score": 0, "creation_date": 1455120684, "post_id": 35304549, "comment_id": 58349241, "body": "I do: paramLabel is a string that is passed to the function paramToWriteWorksheet, which returns another string, which is the name of the worksheet that is to be used in the main function."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1455062418, "creation_date": 1455062418, "answer_id": 35304549, "question_id": 35304237, "link": "https://stackoverflow.com/questions/35304237/how-to-set-worksheet-name-name-returned-by-function-call/35304549#35304549", "title": "How to set worksheet name = name returned by function call", "body": "<p>Something like:</p>\n\n<pre><code>Sub qwerty()\n   Dim wsLabel As String\n   Dim ws As Worksheet\n   Set ws = ActiveSheet\n\n   wsLabel = paramToWriteWorksheet(paramLabel)\n   ws.Name = wsLabel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455062418, "creation_date": 1455060635, "last_edit_date": 1531164843, "question_id": 35304237, "link": "https://stackoverflow.com/questions/35304237/how-to-set-worksheet-name-name-returned-by-function-call", "title": "How to set worksheet name = name returned by function call", "body": "<p>This code compiles but does not work:</p>\n\n<pre><code>Dim wsLabel As String\nDim ws As Worksheet\n\nwsLabel = paramToWriteWorksheet(paramLabel)\nSet ws = Sheets(\"wsLabel\")\n</code></pre>\n\n<p>where paramToWriteWorksheet returns a string that is the name of an existing worksheet</p>\n\n<p>How can I get the code to do what my title says?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455066878, "post_id": 35304066, "comment_id": 58320768, "body": "Please give us more information about your database design."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1455086327, "post_id": 35304066, "comment_id": 58326481, "body": "Better share a sample (With dummy data) file, so that we can code in it."}], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1455079406, "creation_date": 1455079406, "answer_id": 35306978, "question_id": 35304066, "link": "https://stackoverflow.com/questions/35304066/how-do-i-open-a-specific-form-based-on-the-user-input-in-a-text-box-ms-access/35306978#35306978", "title": "How do I open a specific form based on the user input in a text box (MS Access)?", "body": "<p>Just keep a Table with 3 fields to store the Employee Id and Password along with the Form name they can access.</p>\n\n<p>Use DLookup() function to do the comparison against the table to check the User ID and Password credentials.  If it matches with the Textbox entry then use the Same DLookup() function to get the form name from that table and populate the form to the employee.</p>\n"}], "owner": {"reputation": 13, "user_id": 3073431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c126d2c553cc2fc37fee223e0d489187?s=128&d=identicon&r=PG&f=1", "display_name": "user3073431", "link": "https://stackoverflow.com/users/3073431/user3073431"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 705, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455079406, "creation_date": 1455059654, "question_id": 35304066, "link": "https://stackoverflow.com/questions/35304066/how-do-i-open-a-specific-form-based-on-the-user-input-in-a-text-box-ms-access", "title": "How do I open a specific form based on the user input in a text box (MS Access)?", "body": "<p>Just for some context: I am using MS Access 2016.</p>\n\n<p>I have 3 dashboard forms for 3 types of employees (employees, managers, contractors). Each type of employee has a separate table and everyone has a unique ID. Managers will have an employeeID AND a managerID.</p>\n\n<p>I have a form that I will have people start with. It will have a text box asking for the users ID number and a button that says \"Go to Dashboard\".</p>\n\n<p>Depending on the type of employee that ID number belongs to, I want the correct dashboard form to open.</p>\n\n<p>So let's say I am a manager and I enter my manager ID and click go.. I will be taken to the Manager Dashboard. If I enter my employee ID and click go.. I will be taken to the Employee Dashboard. </p>\n\n<p>Not sure how do do this.. I'd like to do it with the expression builder if possible. </p>\n\n<p>Thanks ahead of time!</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455059376, "post_id": 35303960, "comment_id": 58318329, "body": "have you tried to filter the list?"}, {"owner": {"reputation": 75, "user_id": 5890032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2435bd74d6b137376e45b07228be07d0?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5890032/sam"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455059649, "post_id": 35303960, "comment_id": 58318421, "body": "I have tried the filter list, but it will not be able to filter properly. My data set also contains multiple of the same start dates and end dates. However, the Unique ID and Program ID are the best way to differentiate them."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455059944, "post_id": 35303960, "comment_id": 58318543, "body": "can you show some code or formulas of what you have tried? at least, we need something to start... how should we know the criteria for all your filter???"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1455061041, "post_id": 35303960, "comment_id": 58319020, "body": "Those &#39;Unique ID&#39; entries don&#39;t look very unique to me."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455062420, "post_id": 35303960, "comment_id": 58319530, "body": "also multiple filters can be set... right now, i don&#39;t know what the real problem is :/"}], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": true, "score": 1, "last_activity_date": 1455079229, "creation_date": 1455079229, "answer_id": 35306951, "question_id": 35303960, "link": "https://stackoverflow.com/questions/35303960/validate-if-date-is-in-between-two-dates-excel/35306951#35306951", "title": "Validate if date is in between two dates - Excel", "body": "<p>Use following formula to filter data between two date:</p>\n\n<pre><code>=IFERROR(INDEX($B$4:$H$10,SMALL(IF($B$4:$B$10&gt;=$F$13,IF($B$4:$B$10&lt;=$F$14,ROW($B$4:$B$10)-ROW($B$3))),ROWS($B$3:B3)),COLUMNS($B$3:B$3)),\"\")\n</code></pre>\n\n<p>As it is a array formula. Press <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd> to evaluate the formula.</p>\n\n<p>Put formula in <code>B17</code> cell (as per example of below screenshot). Then drag and fill right and down as you need. <strong><em>Make sure you applied date format manually after filling formulas</em></strong> for date columns.</p>\n\n<p><a href=\"https://i.stack.imgur.com/v6bjc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v6bjc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 75, "user_id": 5890032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2435bd74d6b137376e45b07228be07d0?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5890032/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "accepted_answer_id": 35306951, "answer_count": 1, "score": 0, "last_activity_date": 1455079229, "creation_date": 1455059180, "last_edit_date": 1531161705, "question_id": 35303960, "link": "https://stackoverflow.com/questions/35303960/validate-if-date-is-in-between-two-dates-excel", "title": "Validate if date is in between two dates - Excel", "body": "<p>I am trying to pull out a set of data based on a criteria of dates. If the event date does not fall between the Start and End Date, it should not be pulled into the results. IF it does fall in between those dates, It would then need to ensure that the Unique ID matches with the correct program. This would need to pull all the data associated to those particular events. All Unique ID and Program ID need to match and be pulled if it is between the Start and End Date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eVbZw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eVbZw.png\" alt=\"enter image description here\"></a></p>\n\n<p>End result should bunch up to the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/veaY0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/veaY0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455063619, "post_id": 35303736, "comment_id": 58319899, "body": "You can do this using VLOOKUP() - no VBA required."}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 4535615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152527554236739/picture?type=large", "display_name": "Kieran", "link": "https://stackoverflow.com/users/4535615/kieran"}, "is_accepted": false, "score": 0, "last_activity_date": 1455060210, "creation_date": 1455060210, "answer_id": 35304169, "question_id": 35303736, "link": "https://stackoverflow.com/questions/35303736/vba-to-find-replace-information-from-one-sheet-to-another/35304169#35304169", "title": "VBA to find/replace information from one sheet to another", "body": "<p>Hey Mate give this a crack:  </p>\n\n<pre><code>=INDEX(Sheet2!$B$2:$B$7,MATCH(Sheet1!$C2,Sheet1!C2:C7,0))  \n</code></pre>\n\n<p>Alternative would be a vlookup but index/match is best practice.  </p>\n\n<p>Here's a tutorial: <a href=\"http://www.randomwok.com/excel/how-to-use-index-match/\" rel=\"nofollow\">LINK</a>  </p>\n\n<p>No VBA Necessary...</p>\n"}], "owner": {"reputation": 1, "user_id": 5905485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4267da93435ec21feb9310124ea5e291?s=128&d=identicon&r=PG&f=1", "display_name": "dominika", "link": "https://stackoverflow.com/users/5905485/dominika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455060210, "creation_date": 1455058099, "question_id": 35303736, "link": "https://stackoverflow.com/questions/35303736/vba-to-find-replace-information-from-one-sheet-to-another", "title": "VBA to find/replace information from one sheet to another", "body": "<p>I am looking for help on writing a VBA that will replace information in one sheet using a legend that is in another sheet. </p>\n\n<p>I need two things to happen. \n1. replace cells in column C in Sheet1 with data from column C in Sheet2 if column C in Sheet1 = column A in Sheet2. \n2. also insert the adjacent cell (Item Number) that corresponds with the new description. </p>\n\n<p>Here is a simple sample of the spreadsheet. </p>\n\n<p>Sheet 1 BEFORE Code: </p>\n\n<pre><code>1    A                             B                 C\n2   EQUIPMENT TYPE             ITEM NUMBER      DESCRIPTION\n3   Actives                                        NC400\n4   Full Spectrum EQ- Bank 1                       T2&amp;4 CS12\n5                                                  T2&amp;4 CS09\n6   Full Spectrum EQ - Bank 2                      T8 CS09  \n7                                                  T8 CS06\n</code></pre>\n\n<p>Sheet 2 (legend)</p>\n\n<pre><code>1               A                B                  C\n2   Original Description    Item Number     New Description\n3           NC400               5543          Full Features 2x2\n4           T2&amp;4 CS12           5568          Cable Simulator 12db\n5           T2&amp;4 CS09           9956          Cable Simulator 9db\n6           T8 CS09             5547          Return Path 9db\n7           T8 CS06             6689          Return Path 6db\n</code></pre>\n\n<p>Sheet 1 AFTER CODE:</p>\n\n<pre><code>1             A                      B              C\n2   EQUIPMENT TYPE              ITEM NUMBER      DESCRIPTION\n3   Actives                       5543              Full Features 2x2\n4   Full Spectrum EQ- Bank 1      5568              Cable Simulator 12db\n5                                 9956              Cable Simulator 9db\n6   Full Spectrum EQ - Bank 2     5547              Return Path 9db\n7                                 6689              Return Path 6db\n</code></pre>\n\n<p>I know that I will have to use a series of loops, I would appreciate any help. </p>\n\n<p>Thanks! </p>\n"}, {"tags": ["vba", "excel", "delete-row"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455056456, "post_id": 35303210, "comment_id": 58317082, "body": "having (0 and 6) and (6 and 12) will count the line as noisy and delete it... is there no need to check if the line above and below (0 and 12) is <code>&lt; 10</code>... if you get what i mean ^^;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455056499, "post_id": 35303210, "comment_id": 58317100, "body": "You seem to be mixing up row1/2/3 and deltat_value1/2/3 ?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5879828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8961162fb695acbc00974eb9403a9602?s=128&d=identicon&r=PG&f=1", "display_name": "T.Joe", "link": "https://stackoverflow.com/users/5879828/t-joe"}, "edited": false, "score": 0, "creation_date": 1455060176, "post_id": 35303499, "comment_id": 58318642, "body": "Thanks Dirk, sorry I forgot to change deltat_value1, to make it easier to understand, I change them to row 1,2,3."}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1455057456, "last_edit_date": 1455057456, "creation_date": 1455057149, "answer_id": 35303499, "question_id": 35303210, "link": "https://stackoverflow.com/questions/35303210/vba-delete-multiple-rows-by-comparing-3-adjacent-rows/35303499#35303499", "title": "VBA delete multiple rows by comparing 3 adjacent rows", "body": "<p>Wouldn't something like this do exactly what you want?</p>\n\n<pre><code>Sub delMe()\n  Dim i As Long, rng As Range\n  i = 2 'change to the row you want to start\n  While Len(Cells(i + 1, 2).Value)\n    If Abs(Cells(i - 1, 2).Value - Cells(i, 2).Value) And Abs(Cells(i + 1, 2).Value - Cells(i, 2).Value) Then\n      If rng Is Nothing Then Set rng = Rows(i) Else Set rng = Union(rng, Rows(i))\n    End If\n    i = i + 1\n  Wend\n  rng.Delete\nEnd Sub\n</code></pre>\n\n<p>Still: I don't know how <code>deltat_value1</code> will change inside the loop? Wouldn't run your loop till it hits the end of the sheet?</p>\n"}], "owner": {"reputation": 51, "user_id": 5879828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8961162fb695acbc00974eb9403a9602?s=128&d=identicon&r=PG&f=1", "display_name": "T.Joe", "link": "https://stackoverflow.com/users/5879828/t-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455057456, "creation_date": 1455055834, "question_id": 35303210, "link": "https://stackoverflow.com/questions/35303210/vba-delete-multiple-rows-by-comparing-3-adjacent-rows", "title": "VBA delete multiple rows by comparing 3 adjacent rows", "body": "<p>I am trying to figure out noisy data and delete the whole row of noisy data. There are 79 rows of data in total and about 6-7 noisy data, the data are all integers. To define noisy data, I dim 3 variables: row1,row2,row3, and compare the absolute value of difference between each other, and if Absolute(row1-row2) and Abslute(row2-row3) are bigger than 5 at the same time, I will say row2 is a noisy data and delete the whole row. However, I am having application or object defined error problems. I tried to dim the variables with integer, variant, long, double. None of them works and it is the same problem.</p>\n\n<pre><code>Sub project()\n    Dim a As Long, row1 As Long, row2 As Long, row3 As Long\n    Dim rKill As Range\n    a = 2\n    Do\n        row1 = Cells(a, 2).Value\n        row2 = Cells(a + 1, 2).Value\n        row3 = Cells(a + 2, 2).Value\n        If Abs(row1 - row2) &gt; 5 And Abs(row2 - row3) &gt; 5 Then\n            If rKill Is Nothing Then\n                Set rKill = Cells(a + 1, 2)\n            Else\n                Set rKill = Union(rKill, Cells(a + 1, 2))\n            End If\n        End If\n        a = a + 1\n    Loop Until deltat_value1 = 14700\n    rKill.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>The problem is as following:<code>Application-defined or object defined error</code>and happens at the line: <code>deltat_value3 = Cells(a + 2, 2).Value</code>\nThen I am thinking it may be because I define too many variables. I changed a little bit to:</p>\n\n<pre><code>Sub project()\n    Dim a As Long, row1 As Long, row2 As Long, row3 As Long\n    Dim rKill As Range\n    a = 2\n    Do\n        row1 = Cells(a, 2).Value\n        row2 = Cells(a + 1, 2).Value\n        If Abs(row1 - row2) &gt; 5 And Abs(row2 - row3) &gt; 5 Then\n            row3 = Cells(a + 2, 2).Value\n            If Abs(row2 - row3) &gt; 5 Then\n            If rKill Is Nothing Then\n                Set rKill = Cells(a + 1, 2)\n            Else\n                Set rKill = Union(rKill, Cells(a + 1, 2))\n            End If\n        End If\n        End If\n        a = a + 1\n    Loop Until deltat_value1 = 14700\n    rKill.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>But it still doesn't work, this time the same error shows for the line:</p>\n\n<pre><code>row2 = Cells(a + 1, 2).Value\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1455059895, "post_id": 35303118, "comment_id": 58318519, "body": "In Excel 2016 the boolean check <code>If files = false</code> works fine. According to help that&#39;s the way it works. I wonder why it&#39;s not working for you."}, {"owner": {"reputation": 592, "user_id": 2080575, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/10a65580c89a1ef9005d97fe8d5597e9?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/2080575/alex-r"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1455100535, "post_id": 35303118, "comment_id": 58334541, "body": "In Excel 2013, the check only works, if cancel is pressed. If one or more files are selected, files will contain a Variant() which gives a type mismatch error when compared to <code>False</code>."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1455104587, "post_id": 35303118, "comment_id": 58337249, "body": "Oh, of course. I always use the FileDialog one, Seems to me, it doesn&#39;t have that issue: <a href=\"https://msdn.microsoft.com/en-us/library/office/aa219843(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 592, "user_id": 2080575, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/10a65580c89a1ef9005d97fe8d5597e9?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/2080575/alex-r"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1455486290, "post_id": 35303118, "comment_id": 58499004, "body": "If you posted a solution using FileDialog, I could accept that as answer"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4736025"}, "is_accepted": false, "score": 0, "last_activity_date": 1455130162, "creation_date": 1455130162, "answer_id": 35323489, "question_id": 35303118, "link": "https://stackoverflow.com/questions/35303118/how-to-check-if-getopenfilename-with-multiselect-was-canceled/35323489#35323489", "title": "How to check if GetOpenFilename with MultiSelect was canceled?", "body": "<p>Can't comment due to low rep but wanted to add that I had the same situation in a program I wrote and after a fair amount of research at the time I ended up with essentially the same exact code as you did so at least for your situation it looks like you have it right.</p>\n"}, {"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": true, "score": 1, "last_activity_date": 1455590277, "creation_date": 1455590277, "answer_id": 35422696, "question_id": 35303118, "link": "https://stackoverflow.com/questions/35303118/how-to-check-if-getopenfilename-with-multiselect-was-canceled/35422696#35422696", "title": "How to check if GetOpenFilename with MultiSelect was canceled?", "body": "<p>As mentioned in the comments, I like to use <code>FileDialog(msoFileDialogOpen)</code> (along with its folder counterpart, msoFileDialogFolderPicker). It behaves more cleanly than what you are experiencing with GetOpenFileName. I've sometimes wondered why both dialogs exist:</p>\n\n<pre><code>Private Sub PickSomeFiles()\nDim fdFileDialog As FileDialog\nDim SelectedItemsCount As Long\nDim i As Long\n\nSet fdFileDialog = Application.FileDialog(msoFileDialogOpen)\nWith fdFileDialog\n    .Filters.Clear\n    .Filters.Add \"Alle-Dateien (*.*),*.*\", \"*.*\"\n    .FilterIndex = 1\n    .InitialView = msoFileDialogViewDetails\n    .Title = \"please choose files\"\n    .ButtonName = \"open\"\n    .AllowMultiSelect = True\n    .Show\n    If .SelectedItems.Count = 0 Then\n        MsgBox \"No files selected\"\n        Exit Sub\n    End If\n    SelectedItemsCount = .SelectedItems.Count\n    For i = 1 To SelectedItemsCount\n        MsgBox \"You selected: \" &amp; .SelectedItems(i)\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7888604, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3823e7da69c4aa30fc27bc87d719c6de?s=128&d=identicon&r=PG", "display_name": "user7888604", "link": "https://stackoverflow.com/users/7888604/user7888604"}, "is_accepted": false, "score": 0, "last_activity_date": 1492591499, "creation_date": 1492591499, "answer_id": 43490720, "question_id": 35303118, "link": "https://stackoverflow.com/questions/35303118/how-to-check-if-getopenfilename-with-multiselect-was-canceled/43490720#43490720", "title": "How to check if GetOpenFilename with MultiSelect was canceled?", "body": "<p>False = 0. Checking if files=0 should help...</p>\n"}], "owner": {"reputation": 592, "user_id": 2080575, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/10a65580c89a1ef9005d97fe8d5597e9?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/2080575/alex-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1791, "favorite_count": 0, "accepted_answer_id": 35422696, "answer_count": 3, "score": 1, "last_activity_date": 1492591499, "creation_date": 1455055478, "last_edit_date": 1455882137, "question_id": 35303118, "link": "https://stackoverflow.com/questions/35303118/how-to-check-if-getopenfilename-with-multiselect-was-canceled", "title": "How to check if GetOpenFilename with MultiSelect was canceled?", "body": "<p><code>GetOpenFilename</code> with <code>MultiSelect := True</code> either returns a array of Variant or Boolean <code>False</code> if the dialog was canceled. How can I make a decent check?\nIf I check the return value against <code>False</code>, I get a type mismatch error when files are selected (i.e. the dialog is not canceled) because apparently I cannot check if a <code>Variant()</code> is <code>False</code>.</p>\n\n<p>I now check for \"Boolean\" type, which works. But I feel dirty having written this code. Is there a decent way?</p>\n\n<pre><code>Dim files As Variant\nfiles = Application.GetOpenFilename(\"Alle-Dateien (*.*),*.*,\", , \"please choose files\", \"open\", MultiSelect:=True)\nIf TypeName(files) = \"Boolean\" Then \n    MsgBox \"Nothing selected\"\n    Exit Sub\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455056087, "post_id": 35302967, "comment_id": 58316876, "body": "keep in mind that something like <code>=&quot;&quot;</code> will not be counted as &quot;empty&quot;... i recommend something like <code>LEN(M) = 0</code>... however... how do you want to search? there are multiple rows -&gt; multiple outputs, what and how do you want your &quot;answer&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 666582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745dc16acb73cb954fb4fc3a6a3c6941?s=128&d=identicon&r=PG", "display_name": "Dale Matt", "link": "https://stackoverflow.com/users/666582/dale-matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1455063252, "last_edit_date": 1455063252, "creation_date": 1455058636, "answer_id": 35303840, "question_id": 35302967, "link": "https://stackoverflow.com/questions/35302967/excel-vba-macro-searching-for-blank-from-selection/35303840#35303840", "title": "Excel VBA Macro: Searching For Blank From Selection", "body": "<p><code>Test()</code> sets up the worksheet and cells to examine -- if you want to work down a list of cells you can do it here -- and calls <code>DoStuffIfNotEmpty</code>, which examines the Name, Result and Count columns in order.  Its not even close to being elegant but there you go...</p>\n\n<pre><code>Sub Test()\n    Dim cWorksheet As Worksheet\n    Dim CRange As Range\n\n    Set cWorksheet = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set CRange = cWorksheet.Range(\"A2:C2\")\n    MsgBox DoStuffIfNotEmpty(cWorksheet, CRange), vbOKOnly\nEnd Sub\n\nFunction DoStuffIfNotEmpty(CurrWorksheet As Worksheet, CurrRange As Range) As String\n\n    CurrWorksheet.Select\n    CurrRange.Select\n\n    Set m = Selection\n\n    If m.Cells(1, 1) = \"\" Or IsNull(m.Cells(1, 1)) Then\n        retmsg = \"N/A\"\n    Else\n        If m.Cells(1, 2) = \"\" Or IsNull(m.Cells(1, 2)) Or m.Cells(1, 2) = \"N/A\" Then\n            retmsg = \"N/A\"\n        Else\n            If m.Cells(1, 3) = 0 Then\n                retmsg = \"No\"\n            Else\n                retmsg = \"Yes\"\n            End If\n        End If\n    End If\n    DoStuffIfNotEmpty = retmsg\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5905481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b327d96a4ec8926858eca8cbaabb7?s=128&d=identicon&r=PG&f=1", "display_name": "L Baker", "link": "https://stackoverflow.com/users/5905481/l-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 35303840, "answer_count": 1, "score": 0, "last_activity_date": 1455063252, "creation_date": 1455054972, "question_id": 35302967, "link": "https://stackoverflow.com/questions/35302967/excel-vba-macro-searching-for-blank-from-selection", "title": "Excel VBA Macro: Searching For Blank From Selection", "body": "<p>I am trying to search through a selection from a table, find a value and then return a specific result.</p>\n\n<p>The conditions I am trying are: </p>\n\n<ol>\n<li>IF 'Name' = blank, return \"N / A\".</li>\n<li>IF 'Result' = blank, OR \"N/A\", return \"N / A\".</li>\n<li>IF 'Count' = 0, return \"No\", ELSE \"Yes\".</li>\n</ol>\n\n<p><strong>The code I have tried so far is as follows:</strong></p>\n\n<pre><code>Sub DoStuffIfNotEmpty()\n\n  Set M = Selection\n\n  If Not IsEmpty(M) Then\n     MsgBox \"I'm not empty!\"\n\n  Else\n     MsgBox \"Empty Value\"\n\n  End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Also for reference, here is the test table I have created:</strong></p>\n\n<p><a href=\"http://i.stack.imgur.com/wipLj.png\" rel=\"nofollow\">Reference Image</a></p>\n"}, {"tags": ["vba", "validation", "excel", "datetime"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455053833, "post_id": 35302657, "comment_id": 58315642, "body": "Please note:  this is an rss pubdate format that I am trying to put into an  Excel cell to be able to sort by date format DAY-MONTH-TIME"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455054055, "post_id": 35302657, "comment_id": 58315761, "body": "Remove the day and the following comma and space."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455054362, "post_id": 35302657, "comment_id": 58315956, "body": "how would it work as the weekday name is not a fixed finite character count?  How would also combine both trims?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455054809, "post_id": 35302874, "comment_id": 58316171, "body": "how can I get rid of the Wednesday, as that is the value in the cell.  Both the weekday names and the month names are not fixed finite character counts, so how could I select them by trim to remove?  oh and a big thank you, as I have been trying since early this morning San Francisco time to solve this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455055047, "post_id": 35302874, "comment_id": 58316311, "body": "how could this work as the format is not &quot;M/D/YYYY H:MM:SS AM/PM&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455055098, "post_id": 35302874, "comment_id": 58316334, "body": "that is what I am hoping to be able to do, to convert the rss pubdate into a string that I can sort on in Excel , oh and thank you!"}, {"owner": {"reputation": 16, "user_id": 5419100, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GrQIi.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/5419100/drew"}, "edited": false, "score": 0, "creation_date": 1455055722, "post_id": 35302874, "comment_id": 58316676, "body": "Basically by getting rid of the &quot;Wednesday ,&quot; excel will take it as a date, I just added it just to restate it. If the only way to eliminate the word is in the code, then I would use the functions Right() and Left() but first you need to know the length of the word.. ie Monday Tuesday... etc for that use conditionals like if Left(vDate,3) = &quot;Mon&quot; then length = 7"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455055998, "post_id": 35302874, "comment_id": 58316829, "body": "Thank you, it has been resolved with switching from left to mid with the fDAT - as provided by Scott Craner - thank you, wow!  what an excellent community- how do I now close this request?"}, {"owner": {"reputation": 16, "user_id": 5419100, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GrQIi.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/5419100/drew"}, "edited": false, "score": 0, "creation_date": 1455056264, "post_id": 35302874, "comment_id": 58316987, "body": "Great, you should click on the check mark next to Scott&#39;s answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455058633, "post_id": 35302874, "comment_id": 58318053, "body": "ok, I did that, thank you... will this now show this as a successfully resolved IN RECORD TIME issue?"}], "tags": [], "owner": {"reputation": 16, "user_id": 5419100, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GrQIi.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/5419100/drew"}, "is_accepted": false, "score": 0, "last_activity_date": 1455054630, "creation_date": 1455054630, "answer_id": 35302874, "question_id": 35302657, "link": "https://stackoverflow.com/questions/35302657/convert-datetime-string-to-valid-date-value-and-valid-time-value/35302874#35302874", "title": "Convert datetime string to valid date value and valid time value", "body": "<p>Get rid of the \"Wednesday, \" and try something like:</p>\n\n<pre><code>vDate = Format(vDate, \"M/D/YYYY H:MM:SS AM/PM\")\nxDate = IsDate(vDate)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455055293, "post_id": 35303004, "comment_id": 58316441, "body": "wow, the change from the left to the mid WORKED!!! it returned back a true date value."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455055367, "post_id": 35303004, "comment_id": 58316490, "body": "@LiterateAspects please mark as correct.  It is something only you can do.  Click on the green check mark by the answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455055987, "post_id": 35303004, "comment_id": 58316824, "body": "Thank you, it has been resolved with switching from left to mid with the fDAT - as provided by Scott Craner - thank you, wow!  what an excellent community- how do I now close this request?  THANK YOU SCOTT"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455056120, "post_id": 35303004, "comment_id": 58316891, "body": "@LiterateAspects you choose one of these as answer by clicking on the green check mark by the answer you choose.  That will not keep others from submitting more answers but it will mark it as answered."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1455055068, "creation_date": 1455055068, "answer_id": 35303004, "question_id": 35302657, "link": "https://stackoverflow.com/questions/35302657/convert-datetime-string-to-valid-date-value-and-valid-time-value/35303004#35303004", "title": "Convert datetime string to valid date value and valid time value", "body": "<p>You would change:</p>\n\n<pre><code>fDAT = Left(vDate, Len(vDate) - 7)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>fDAT = Mid(vDate, InStr(vDate, \",\") + 2)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "edited": false, "score": 0, "creation_date": 1455055890, "post_id": 35303106, "comment_id": 58316773, "body": "Thank you, it has been resolved with switching from left to mid with the fDAT - as provided by Scott Craner - thank you, wow!  what an excellent community- how do I now close this request?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1455056164, "post_id": 35303106, "comment_id": 58316929, "body": "Quote: <i>Click on the green check mark by the answer.</i> (from the answer you want to accept) ;)"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1455055439, "creation_date": 1455055439, "answer_id": 35303106, "question_id": 35302657, "link": "https://stackoverflow.com/questions/35302657/convert-datetime-string-to-valid-date-value-and-valid-time-value/35303106#35303106", "title": "Convert datetime string to valid date value and valid time value", "body": "<p>to get also the correctness you can use something like that:</p>\n\n<pre><code>Sub blabla()\n  Dim vDate As Variant, xDate As Boolean\n  vDate = \"Wednesday, September 10, 2014 6:53 AM\"\n  xDate = IsDate(vDate) Or (IsDate(Mid(vDate, InStr(vDate, \",\") + 1)) And Left(vDate, InStr(vDate, \",\") - 1) = Format(Mid(vDate, InStr(vDate, \",\") + 1), \"dddd\"))\nEnd Sub\n</code></pre>\n\n<p>this would also be false if it is not the correct weekday ;)</p>\n\n<p>To get a usable value you could use something like:</p>\n\n<pre><code>If Not IsDate(vDate) And IsDate(Mid(vDate, InStr(vDate, \",\") + 1)) Then vDate = Mid(vDate, InStr(vDate, \",\") + 1)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5758156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 35303004, "answer_count": 3, "score": 1, "last_activity_date": 1455057959, "creation_date": 1455053749, "last_edit_date": 1455057959, "question_id": 35302657, "link": "https://stackoverflow.com/questions/35302657/convert-datetime-string-to-valid-date-value-and-valid-time-value", "title": "Convert datetime string to valid date value and valid time value", "body": "<p>This code is returning as an invalid date for conversion:</p>\n\n<blockquote>\n  <p>'Wednesday, September 10, 2014 6:53 AM'</p>\n</blockquote>\n\n<p>The VBA <code>IsDate</code> function is used to check if an expression is a <code>Date</code> or the expression can be converted to a valid <code>Date</code> or <code>Time</code>. The function returns <code>true</code> or <code>false</code>.</p>\n\n<p>How can I get the date to be valid?</p>\n\n<pre><code>'-----------------------------------------\n\nDim x As Integer\n\nx = ActiveCell.Row\n\n'-----------------------------------------\n\nDim vDate As Variant\n\nvDate = \"Wednesday, September 10, 2014 6:53 AM\"\n\nMsgBox vDate\n\nMsgBox IsDate(vDate) 'retuns false\n\n'-----------------------------------------\n\nDim fDAT As String\n\nfDAT = Left(vDate, Len(vDate) - 7)\n\nMsgBox fDAT\n\nMsgBox IsDate(fDAT) 'retuns false\n\n'-----------------------------------------\n\n''ActiveSheet.Range(\"a\" &amp; x).Value = fDAT\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1455054289, "post_id": 35302553, "comment_id": 58315908, "body": "can you show the line directly in front and after the <code>newArr=</code> line cus theoretically can&#39;t that error occur at that part of line..."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455055304, "post_id": 35302553, "comment_id": 58316448, "body": "It&#39;s not actually the size of the number that&#39;s the issue, it&#39;s the amount of bits that the number uses to store in memory. That being said the number you&#39;ve quoted only uses 22 bits of memory so shouldn&#39;t be an issue really."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1455057100, "post_id": 35302553, "comment_id": 58317377, "body": "Have you tried to declare the varable as <code>Dim NewArr As Variant</code>? Not array."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1455060470, "post_id": 35302553, "comment_id": 58318764, "body": "You could try to dimension the array to the size needed to load the range and then loop through the range, copying the data to the array element by element. That way you might be able to tell where the problem lies (assuming that the problem is actually in that line and not, as Dirk suggested, on a neighboring line)."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1455067591, "post_id": 35302553, "comment_id": 58320938, "body": "I tried multiple ways of recreating your issue but cannot even with large random numbers. You may need to post some actual data. SO strongly recommends a <a href=\"http://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>."}, {"owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "edited": false, "score": 0, "creation_date": 1455085367, "post_id": 35302553, "comment_id": 58326058, "body": "Thank you for all the replies.  I have added more of my code above.  Dee - I tried your suggestion but this made no difference.  John, I will take a look at your suggestion - thanks."}], "owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455090227, "creation_date": 1455053387, "last_edit_date": 1455090227, "question_id": 35302553, "link": "https://stackoverflow.com/questions/35302553/excel-vba-run-time-error-6-when-populating-an-array", "title": "Excel VBA Run-time Error &#39;6&#39; when populating an array", "body": "<p>I have resolved this issue.  The problem was nothing (directly) to do with the code.  It was to do with the lRow variable.  This value was populated by a formula on my spreadsheet and this was in turn populated by another macro.  I discovered that I had inserted a column and was consequently updating the wrong column.  I changed my code to update a named range rather than an actual address and the problem disappeared.  Still a bit odd that this code was failing as the values in row 24 appear valid to me. </p>\n\n<p>Thanks for all the input!</p>\n\n<hr>\n\n<p>Hope someone can help here.  I have recently started to get an error when trying to run my code.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/t3GG9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t3GG9.jpg\" alt=\"Run-time error &#39;6&#39;\"></a></p>\n\n<p>This error arises at this line of code:</p>\n\n<pre><code>NewArr = Sheets(\"Input Sheet\").Range(\"A\" &amp; lRow &amp; \":BJ\" &amp; lRow).Value\n</code></pre>\n\n<p>The variable is declared above as:</p>\n\n<pre><code>Dim NewArr() As Variant\n</code></pre>\n\n<p>lRow is evaluating as 24 so the idea is that the array called NewArr will be populated with the values that appear on Input Sheet range A24:BJ24.  </p>\n\n<p>I know that the variant data type can handle very large numbers and although there are some big numbers and text etc in this row, none are over 4 million.  (One is 3380438.98545603).  Any ideas as to why I am getting this error?  </p>\n\n<p>TIA!</p>\n\n<p>My full code (up to the point where I get the error) is:</p>\n\n<pre><code>Private Sub BT_SUBMIT_Click()\n\nDim NewArr As Variant\nDim lRow As Long\nDim lCol As Long\nDim PasteRange As Range\nDim bUpdated As Boolean\n\n'Check if the user  has ticked the confirm box before writing to the spreadsheet\nIf Me.XB_CONFIRM.Value = False Then\n    MsgBox \"You must tick the confirm box to indicate you understand that \" _\n    &amp; \"your amendments cannot be undone.  Please return to the form, tick the box and \" _\n    &amp; \"resubmit.\", vbOKOnly, \"Please tick confirmation box\"\n    Exit Sub\nEnd If\n\n'Check if the user has selected either yes or no on changes frame\nIf Me.OB_CHNGS_NO.Value = False And Me.OB_CHNGS_YES.Value = False Then\n    MsgBox \"You must select either yes or no to indicate if there are changes being made.\" _\n    &amp; \"  Please correct and resubmit.\", vbCritical, \"Select Yes or No\"\n    Exit Sub\nEnd If\n\n'Check if the Target Resolution Date is at least today or later and if not\n'user must update\nIf Sheets(\"Input Sheet\").Cells(Sheets(\"Lookups\").Range(\"NEW_IAR_ROW\").Value, 38).Value &lt; Now() And Me.OB_CHNGS_YES.Value = False Then\n\n    MsgBox \"The Target Resolution Date must be no earlier than today.\" _\n    &amp; \"  Please correct and resubmit.\", vbCritical, \"Change Target Resolution Date\"\n\n    Me.OB_CHNGS_YES.Value = True\n    Exit Sub\nEnd If\n\n\n'Check if the values enterered are valid\nIf Me.OB_CHNGS_YES Then\n    If Control_Error(\"FR_AMNDMENTS\") Then\n        Exit Sub\n    End If\n\n    If (Len(Me.TB_AMNT_RES.Value) + Len(Me.TB_NO_TRNS_RES.Value) + Len(Me.TB_CMNT_RES.Value)) &gt; 0 Then\n        bUpdated = True\n        If Control_Error(\"FR_IAR_RSVD\") Then\n            Exit Sub\n        End If\n    End If\n    If (Len(Me.TB_AMNT_WO.Value) + Len(Me.TB_NO_TRNS_WO.Value) + Len(Me.TB_CMNT_WO.Value)) Then\n        bUpdated = True\n        If Control_Error(\"FR_IAR_WO\") Then\n            Exit Sub\n        End If\n    End If\n\n    If (Len(Me.TB_AMNT_INC.Value) + Len(Me.TB_NO_TRNS_INC.Value) + Len(Me.TB_CMNT_INC.Value)) Then\n        bUpdated = True\n        If Control_Error(\"FR_IAR_INCR\") Then\n            Exit Sub\n        End If\n    End If\n\n    If Not (bUpdated) Then\n        MsgBox \"You have not entered any changes for resolved, write offs or increases.  \" _\n        &amp; \"You must update at least one of these sections or select no changes.\", vbCritical, \"Error\"\n        Exit Sub\n    End If\nEnd If\n\nlRow = Sheets(\"Lookups\").Range(\"NEW_IAR_ROW\").Value\nlCol = Sheets(\"Lookups\").Range(\"TOTAL_COLUMNS\").Value\n\n'First we load the array with the current values on the sheet.\nNewArr = Sheets(\"Input Sheet\").Range(\"A\" &amp; lRow &amp; \":BJ\" &amp; lRow).Value\n\nApplication.ScreenUpdating = False\n'Then there is other code beyond this point\nEnd Sub\n</code></pre>\n"}, {"tags": ["jquery", "python", "vba", "sharepoint-2010", "spservices"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 1205100, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ErraD.jpg?s=128&g=1", "display_name": "Peter Joyce", "link": "https://stackoverflow.com/users/1205100/peter-joyce"}, "is_accepted": false, "score": 0, "last_activity_date": 1455473129, "creation_date": 1455473129, "answer_id": 35395220, "question_id": 35302475, "link": "https://stackoverflow.com/questions/35302475/autofill-a-sharepoint-list-imacro-didnt-work/35395220#35395220", "title": "Autofill a SharePoint List...iMacro didn&#39;t work", "body": "<p>The easiest way to do this would be to add a Content Editor WebPart (CEWP) to the NewForm.apsx (the input form) that contains JQuery to auto-fill a value for t those fields.  If you don't have a reference to JQuery in your environment, you'll have to add one.  see this: <a href=\"http://sympmarc.com/2011/05/03/adding-jquery-to-a-sharepoint-page-step-one-always/\" rel=\"nofollow\">http://sympmarc.com/2011/05/03/adding-jquery-to-a-sharepoint-page-step-one-always/</a></p>\n\n<p>In JQuery, the easiest way to lookup and set a SharePoint field is using the Title attribute, which will map the external name of the field. so:</p>\n\n<pre><code>$(document).ready(function () {\n    $(\"input[title='MyField']\").val(\"I Set This!\"); \n}\n</code></pre>\n\n<p>If you haven't done it before, you cant to add script tags in the content editor webpart.  so stick the above inside </p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>One other best practice note: It's better to put the javascript in a text file that your reference from the CEWP than to just put the script directly in the webpart.  It also makes it much easier to edit.</p>\n"}], "owner": {"reputation": 1, "user_id": 2978880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d6bcf3d3cb98119759fb7580c51b6?s=128&d=identicon&r=PG&f=1", "display_name": "user2978880", "link": "https://stackoverflow.com/users/2978880/user2978880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455473129, "creation_date": 1455053113, "question_id": 35302475, "link": "https://stackoverflow.com/questions/35302475/autofill-a-sharepoint-list-imacro-didnt-work", "title": "Autofill a SharePoint List...iMacro didn&#39;t work", "body": "<p>At work, we use SharePoint 2010 to log in issues.  For my area, the values for about 16 fields do not change. Instead of selecting 16 values every time I log an issue, I would rather auto fill them. I like to dabble with coding.  I know some Python and C++.  Can you please recommend a way that I could set defaults and run a script from my desktop to auto fill the 16 values for my issues.  I would just like to update the fields that change. I tried to use iMacro in Firefox, but it doesn't work as the form has a dynamic id, and the macro stops as it can't find the form id that I used to record the macro.  Any feedback would be appreciated because filling the same information is driving me out of my mind.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2865, "user_id": 4509121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f5SN7.png?s=128&g=1", "display_name": "Ben Rhys-Lewis", "link": "https://stackoverflow.com/users/4509121/ben-rhys-lewis"}, "edited": false, "score": 0, "creation_date": 1455879270, "post_id": 35302352, "comment_id": 58698152, "body": "What exactly are you asking? Do you mean use a variable from the &#39;ThisWorkbook&#39; code or one module to another module?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 2865, "user_id": 4509121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f5SN7.png?s=128&g=1", "display_name": "Ben Rhys-Lewis", "link": "https://stackoverflow.com/users/4509121/ben-rhys-lewis"}, "edited": false, "score": 0, "creation_date": 1457716963, "post_id": 35302352, "comment_id": 59549104, "body": "@BenRhys-Lewis I am referring to, lets say I have a .BAS file uploaded on a server. Can I link that module in my workbook and call macros from that?"}], "answers": [{"tags": [], "owner": {"reputation": 2865, "user_id": 4509121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f5SN7.png?s=128&g=1", "display_name": "Ben Rhys-Lewis", "link": "https://stackoverflow.com/users/4509121/ben-rhys-lewis"}, "is_accepted": false, "score": 0, "last_activity_date": 1455879442, "creation_date": 1455879442, "answer_id": 35503621, "question_id": 35302352, "link": "https://stackoverflow.com/questions/35302352/load-vba-to-excel-module-from-a-url/35503621#35503621", "title": "Load vba to excel module from a url", "body": "<p>To call a module:</p>\n\n<pre><code>Sub main()\n    Call Macro\nEnd Sub\n</code></pre>\n\n<p>Or you do something like this:</p>\n\n<pre><code>Sub main()\n    moduleName.subName\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455881203, "creation_date": 1455052672, "last_edit_date": 1455881203, "question_id": 35302352, "link": "https://stackoverflow.com/questions/35302352/load-vba-to-excel-module-from-a-url", "title": "Load vba to excel module from a url", "body": "<p>I would like to know if it's possible to load or link vba code to the module in excel? \n( like in JavaScript src = \"script.js\")</p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455057946, "post_id": 35302318, "comment_id": 58317767, "body": "Does format exist in comps book?"}, {"owner": {"reputation": 1, "user_id": 5874683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f1731441c8f5daa6366046e841f1a7?s=128&d=identicon&r=PG&f=1", "display_name": "epifinygirl", "link": "https://stackoverflow.com/users/5874683/epifinygirl"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455071467, "post_id": 35302318, "comment_id": 58321930, "body": "Yes, I can run the macro manually in the Excel file"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455090060, "post_id": 35302318, "comment_id": 58328223, "body": "Try adding the filename also in the run call"}, {"owner": {"reputation": 1, "user_id": 5874683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f1731441c8f5daa6366046e841f1a7?s=128&d=identicon&r=PG&f=1", "display_name": "epifinygirl", "link": "https://stackoverflow.com/users/5874683/epifinygirl"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455113852, "post_id": 35302318, "comment_id": 58343921, "body": "Adding the filename like: objXLS.Run (&quot;Comps Macro.xlsm!Format&quot;)?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455119206, "post_id": 35302318, "comment_id": 58348074, "body": "I think you need &#39;xyz&#39;!macro.  Not in excel at the minute, so cant get the correct syntax for you."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1455252406, "creation_date": 1455252406, "answer_id": 35355010, "question_id": 35302318, "link": "https://stackoverflow.com/questions/35302318/running-excel-macro-through-access-vba-runtime-error-2147417851/35355010#35355010", "title": "Running Excel Macro through Access VBA Runtime Error -2147417851", "body": "<p>You have to reference the Sub or Function correctly.\nYour Sub named <code>Format</code> is defined at Workbook- or Sheet- level?</p>\n\n<p>If defined in a Sheet module (for example Sheet1):</p>\n\n<pre><code>objXLS.Run (\"Sheet1.Format\")\n</code></pre>\n\n<p>If at Workbook level:</p>\n\n<pre><code>objXLS.Run (\"ThisWorkbook.Format\")\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 5874683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f1731441c8f5daa6366046e841f1a7?s=128&d=identicon&r=PG&f=1", "display_name": "epifinygirl", "link": "https://stackoverflow.com/users/5874683/epifinygirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642714, "creation_date": 1455052507, "last_edit_date": 1594642714, "question_id": 35302318, "link": "https://stackoverflow.com/questions/35302318/running-excel-macro-through-access-vba-runtime-error-2147417851", "title": "Running Excel Macro through Access VBA Runtime Error -2147417851", "body": "<p>I created code that will copy the RecordSet to Excel and I want a macro in the Excel file to run. The code works perfectly until it hits the code to run the macro. I must not be calling the application correctly but can't figure it out!</p>\n\n<pre><code>Private Sub Command233_Click()\nDim objXLS As Object\n Dim wks As Object\n Dim rsc As Recordset\n Dim idx As Long\n Set rsc = Me.RecordsetClone\nIf Me.RecordsetClone.RecordCount = 0 Then\nMsgBox (\"No Records To Export\")\nElse\n rsc.MoveLast\n rsc.MoveFirst\n Set objXLS = CreateObject(\"Excel.Application\")\n objXLS.Workbooks.Open FileName:=\"C:\\Comps Macro.xlsm\", ReadOnly:=True\n Set wks = objXLS.Worksheets(1)\n For idx = 0 To rsc.Fields.Count - 1\n   wks.Cells(1, idx + 1).Value = rsc.Fields(idx).Name\n Next\n wks.Range(wks.Cells(1, 1), wks.Cells(1, rsc.Fields.Count)).Font.Bold = True\n wks.Range(\"A2\").CopyFromRecordset rsc, rsc.RecordCount, rsc.Fields.Count\n objXLS.Visible = True\n objXLS.Run (\"Format\")\nEnd If\n\n Set objXLS = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The runtime error I am receiving is:\nRun-Time Error '-2147417851 (80010105)':\nMethod 'Run' of object '_Application' failed</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1455052558, "post_id": 35302295, "comment_id": 58314947, "body": "Thanks for the Answer!  I&#39;ve done so and the document still opens itself. Mind that I have another script that uses the Application.OnTime to run, but I also call it in the manner as the above, and made changes for both. I have a StopAutoRun and StopAutoRun2"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1455053142, "post_id": 35302295, "comment_id": 58315288, "body": "Your code doesn&#39;t open anything so not sure what you mean? On a side note, this line <code>If .Cells(i, 4).Value Like &quot;Done&quot; And .Cells(i, 5).Value = &quot;1&quot; &gt; Then</code> makes no sense - there&#39;s not need to use the <code>Like</code> operator and there&#39;s a <code>&gt;</code> after the 1 at the end?"}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1455053728, "post_id": 35302295, "comment_id": 58315585, "body": "That&#39;s where I get confused too :P The document keeps opening itself once it is closed. So I guess that the Application.Ontime isn&#39;t successfully killed.  The &gt; at the end is a copy-paste mistake. My apologies.  I also removed the Like and changed it for =. Result is the same though, it did work with the Like :)"}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1455053990, "post_id": 35302295, "comment_id": 58315735, "body": "Should I provide you with the other script that has an autorun based on Application.OnTime? Although that one is more character heavy. Maybe there&#39;s only one of the two that fails to False?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1455054937, "post_id": 35302295, "comment_id": 58316245, "body": "It might help to see the other script too"}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1455073101, "post_id": 35302295, "comment_id": 58322305, "body": "Marking this as Answered. It should do it. But it still doesn&#39;t so I&#39;ll have to follow another path. Your answer is still true that that was a part of the problem."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1455110850, "post_id": 35302295, "comment_id": 58341769, "body": "Your beforeclose routine contains two calls, one to StopAutoRun and one to StopAutoRun2. You only show the code belonging to StopAutoRun2. What does StopAutoRun contain?"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1455052410, "creation_date": 1455052410, "answer_id": 35302295, "question_id": 35302137, "link": "https://stackoverflow.com/questions/35302137/killing-application-ontime-with-workbook-beforeclose/35302295#35302295", "title": "Killing Application.ontime with Workbook_BeforeClose", "body": "<p>Change <code>\"AutoRun2\"</code> to <code>\"AutoClear\"</code> in your stop sub as this is the actual macro that you want to stop being scheduled with the <code>False</code> argument.</p>\n"}], "owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 35302295, "answer_count": 1, "score": 1, "last_activity_date": 1455073220, "creation_date": 1455051775, "last_edit_date": 1455073220, "question_id": 35302137, "link": "https://stackoverflow.com/questions/35302137/killing-application-ontime-with-workbook-beforeclose", "title": "Killing Application.ontime with Workbook_BeforeClose", "body": "<p>I looked through every topic I've found in here, but couldn't figure what is wrong with the below.</p>\n\n<p>I am using Application.OnTime to run a Module every minutes. The problem is, when I close the worksheet, Excel reopens the sheet the next time the Macro should run.</p>\n\n<p>I have attempted to use the following fix, to no avail.</p>\n\n<pre><code>Option Explicit\nDim dTime As Date\n\nPublic Function AutoRun2()\ndTime = Now + TimeValue(\"00:01:00\")\nApplication.OnTime dTime, \"AutoClear\"\nEnd Function\n\nSub StopAutoRun2()\nApplication.OnTime dTime, \"AutoRun2\", , False\nEnd Sub\n</code></pre>\n\n<p>and I have the following in ThisWorkbook:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nCall StopAutoRun\nCall StopAutoRun2\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455051387, "post_id": 35301937, "comment_id": 58314253, "body": "VTC - <i>How can I implement this?</i> - please post the code you&#39;ve built to try to accomplish this and where it&#39;s not doing what you expect it to. We can help you tweak it to get it to work, but most likely no one will write it for you."}, {"owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455052517, "post_id": 35301937, "comment_id": 58314922, "body": "I&#39;m not looking for someone to write it for me, but I am looking for some direction of literature. I have very little programming experience and wanted to reduce a redundant task. I have no code as of yet."}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1455063059, "post_id": 35301937, "comment_id": 58319744, "body": "That would be a very straightforward macro. Just read any intro to vba article, learn how to record a macro, and record yourself sorting the table on DTF-RL column, and copying and pasteing the data where you want. That will give you a basic macro, which you can edit to make it work for different use cases. Good luck."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455110459, "post_id": 35301937, "comment_id": 58341466, "body": "@JamesHayek - Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>. It will help you understand the scope of what SO assists with in programming, since you are not likely to get much help with this question."}], "owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455053057, "creation_date": 1455051095, "last_edit_date": 1455053057, "question_id": 35301937, "link": "https://stackoverflow.com/questions/35301937/find-lowest-value-in-csv-file-below-a-certain-cell-and-output-to-excel-cell", "title": "Find Lowest Value in CSV File Below A Certain Cell and Output to Excel Cell", "body": "<p>I am looking to take data from a CSV file and check for the lowest value under a certain heading. </p>\n\n<p>I would then like to write that file to an excel file within a certain cell.</p>\n\n<p>As an example:</p>\n\n<h2>|18| Distance( ft) | DTF-RL |</h2>\n\n<h2>|19|  69.63636364  |31.05373|</h2>\n\n<h2>|20|  69.81818182  |30.85291|</h2>\n\n<h2>|21|  70.61818182  |31.85291|</h2>\n\n<p>The value of interest would be 30.85291, the lowest value in the range.</p>\n\n<p>I would like to write that value to a specific cell within an excel document\nI would then like to write the value next to it (the distance) in another cell within the same excel document.</p>\n\n<p>I have very little programming experience and wanted to reduce a redundant task. I have no code as of yet, any direction would be much appreciated. </p>\n\n<p>How can I implement this?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1455050930, "post_id": 35301844, "comment_id": 58313961, "body": "Google <code>instr</code> and <code>mid</code>."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1455051940, "last_edit_date": 1455051940, "creation_date": 1455051026, "answer_id": 35301917, "question_id": 35301844, "link": "https://stackoverflow.com/questions/35301844/searching-copying-specific-content-from-an-excel-cell/35301917#35301917", "title": "Searching / Copying specific content from an Excel cell", "body": "<p>If the text is in cell E2, this formula will work for any month so long as the \"-\" is always after Maturity and close parenthesis after date.</p>\n\n<pre><code>=MID(E2,FIND(\"-\",E2)+2,FIND(\")\",E2,FIND(\"-\",E2)+2)-1-FIND(\"-\",E2)-1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1455051357, "creation_date": 1455051357, "answer_id": 35302026, "question_id": 35301844, "link": "https://stackoverflow.com/questions/35301844/searching-copying-specific-content-from-an-excel-cell/35302026#35302026", "title": "Searching / Copying specific content from an Excel cell", "body": "<p>If the date is always at the end and in the same format this will pull the last three \"words\"</p>\n\n<pre><code>=LEFT(MID(A1,SEARCH(\"}}}\",SUBSTITUTE(A1,\" \",\"}}}\",LEN(A1)-LEN(SUBSTITUTE(AP7,\" \",\"\"))-2)),999),LEN(MID(A1,SEARCH(\"}}}\",SUBSTITUTE(A1,\" \",\"}}}\",LEN(A1)-LEN(SUBSTITUTE(A1,\" \",\"\"))-2)),999))-1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455052222, "post_id": 35302169, "comment_id": 58314746, "body": "Gary - I edited mine right as you posted your answer. They are similar, so didn&#39;t want you to think I was copy-catting :)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1455052769, "post_id": 35302169, "comment_id": 58315078, "body": "@ScottHoltzman  As I commented - the approach is pretty standard......find the left encapsulator.........find the right encapsulator.........subtract.............."}, {"owner": {"reputation": 2332, "user_id": 5319229, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fe016d5983a221686cebf48bc87769f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/5319229/rafael"}, "edited": false, "score": 0, "creation_date": 1455052882, "post_id": 35302169, "comment_id": 58315142, "body": "I like this one as well, however some of the data has hyphens while others have m dashes... Is there a way to search for either / or  ?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2332, "user_id": 5319229, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fe016d5983a221686cebf48bc87769f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/5319229/rafael"}, "edited": false, "score": 0, "creation_date": 1455053171, "post_id": 35302169, "comment_id": 58315304, "body": "@RafaelBucciarelli  I would need to see specific examples."}, {"owner": {"reputation": 2332, "user_id": 5319229, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fe016d5983a221686cebf48bc87769f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/5319229/rafael"}, "edited": false, "score": 0, "creation_date": 1455053328, "post_id": 35302169, "comment_id": 58315370, "body": "For example, the sample you used had <code>10% Current &#47; 2% PIK Secured Debt (Maturity- September 19, 2019)</code> while the next entry is <code>10% Current &#47; 2% PIK Secured Debt (Maturity\u2014September 19, 2019)</code>. I should be able to adjust the FIND criteria to catch both of these cases, right?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1455053469, "post_id": 35302169, "comment_id": 58315438, "body": "@RafaelBucciarelli.......so some records have <i>dash space</i> and other records do not have the <i>space</i> ??"}, {"owner": {"reputation": 2332, "user_id": 5319229, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fe016d5983a221686cebf48bc87769f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/5319229/rafael"}, "edited": false, "score": 0, "creation_date": 1455053573, "post_id": 35302169, "comment_id": 58315495, "body": "Exactly. (Does the <i>dash</i> being different sizes not matter?)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455053883, "post_id": 35302169, "comment_id": 58315670, "body": "He is talking about the <code>--</code> or char(151) versus the <code>-</code> or char(45). Sometimes it is one and not the other."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2332, "user_id": 5319229, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fe016d5983a221686cebf48bc87769f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/5319229/rafael"}, "edited": false, "score": 0, "creation_date": 1455054493, "post_id": 35302169, "comment_id": 58316020, "body": "@RafaelBucciarelli  Perhaps my <b>EDIT#1</b> is what you need <i>(maybe not)</i>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455054700, "post_id": 35302169, "comment_id": 58316119, "body": "@ScottCraner  Whatever the criteria, the approach would be the same.......use something like <code>=ISNUMBER(FIND(CHAR(),A1))</code> to determine which <code>=MID()</code> formula to pick"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455055274, "post_id": 35302169, "comment_id": 58316428, "body": "I know, I was just trying to help clarify that it was not <code>- Sept..</code> or <code>-Sept..</code> that it was the double dash."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1455055468, "post_id": 35302169, "comment_id": 58316547, "body": "@ScottCraner  Thank you.............more examples in the original question would have helped."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1455055792, "post_id": 35302169, "comment_id": 58316717, "body": "back to the space or not the space, couldn&#39;t you just search on the <code>-</code> and use <code>TRIM()</code> as a wrapper to get rid of the space if it is there?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1455055504, "last_edit_date": 1455055504, "creation_date": 1455051896, "answer_id": 35302169, "question_id": 35301844, "link": "https://stackoverflow.com/questions/35301844/searching-copying-specific-content-from-an-excel-cell/35302169#35302169", "title": "Searching / Copying specific content from an Excel cell", "body": "<p>With data in cell <strong>A1</strong>, in another cell:</p>\n\n<pre><code>=MID(A1,FIND(\"- \",A1)+2,FIND(\")\",A1)-FIND(\"- \",A1)-2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/17lhu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/17lhu.png\" alt=\"enter image description here\"></a></p>\n\n<p>This assumes that there is a <em>dash space</em> before the date and a close parens after the date.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>I am not sure I understand, but to make a formula that will work with both <em>dash space</em> and just <em>dash</em>:</p>\n\n<pre><code>=IF(ISNUMBER(FIND(\"- \",A1)),MID(A1,FIND(\"- \",A1)+2,FIND(\")\",A1)-FIND(\"- \",A1)-2),MID(A1,FIND(\"-\",A1)+1,FIND(\")\",A1)-FIND(\"-\",A1)-1))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/L7xOe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L7xOe.png\" alt=\"enter image description here\"></a></p>\n\n<p>But the formula is rapidly losing its beauty.</p>\n"}], "owner": {"reputation": 2332, "user_id": 5319229, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fe016d5983a221686cebf48bc87769f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/5319229/rafael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 35302169, "answer_count": 3, "score": 0, "last_activity_date": 1455055504, "creation_date": 1455050768, "last_edit_date": 1531161705, "question_id": 35301844, "link": "https://stackoverflow.com/questions/35301844/searching-copying-specific-content-from-an-excel-cell", "title": "Searching / Copying specific content from an Excel cell", "body": "<p>I have <code>10% Current / 2% PIK Senior Secured Debt (Maturity- September 19, 2019)</code> in a cell, and I want to extract just the date, in this case <code>September 19, 2019</code>, and copy that over into a different cell. </p>\n\n<p>I can search the cell for the months (<code>January</code>, <code>February</code>... etc) but is there a way to copy the next ~8 characters to complete the date?</p>\n"}, {"tags": ["vba", "excel", "ms-access", "excel-2013"], "comments": [{"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1455050809, "post_id": 35301762, "comment_id": 58313867, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20422356/loop-through-excel-sheets\">Loop through Excel Sheets</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1803, "user_id": 5030129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d0f7c1816e64369016c23c3c04344f07?s=128&d=identicon&r=PG&f=1", "display_name": "Claudius", "link": "https://stackoverflow.com/users/5030129/claudius"}, "is_accepted": false, "score": 0, "last_activity_date": 1455050656, "last_edit_date": 1495542201, "creation_date": 1455050656, "answer_id": 35301810, "question_id": 35301762, "link": "https://stackoverflow.com/questions/35301762/import-data-from-excel-to-ms-access-using-vb/35301810#35301810", "title": "Import data from Excel to Ms Access using VB", "body": "<p>this may help you</p>\n\n<pre><code>Option Explicit\n\nSub AccImport()\n    Dim acc As New Access.Application\n    acc.OpenCurrentDatabase \"C:\\Users\\Public\\Database1.accdb\"\n    acc.DoCmd.TransferSpreadsheet _\n            TransferType:=acImport, _\n            SpreadSheetType:=acSpreadsheetTypeExcel12Xml, _\n            TableName:=\"tblExcelImport\", _\n            Filename:=Application.ActiveWorkbook.FullName, _\n            HasFieldNames:=True, _\n            Range:=\"Folio_Data_original$A1:B10\"\n    acc.CloseCurrentDatabase\n    acc.Quit\n    Set acc = Nothing\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/16161865/using-excel-vba-to-export-data-to-ms-access-table\">Link to question</a></p>\n"}], "owner": {"reputation": 9, "user_id": 4279530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xZlK2Gh6O6M/AAAAAAAAAAI/AAAAAAAAABk/us4Uz3VSp-4/photo.jpg?sz=128", "display_name": "Alaeddin Dhahri", "link": "https://stackoverflow.com/users/4279530/alaeddin-dhahri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1981, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455052518, "creation_date": 1455050475, "last_edit_date": 1455052518, "question_id": 35301762, "link": "https://stackoverflow.com/questions/35301762/import-data-from-excel-to-ms-access-using-vb", "title": "Import data from Excel to Ms Access using VB", "body": "<p>I'm trying to import Data from Excel file to my Ms Access Database.\nI have a ready table in my Ms Access Database and an Import Form where I press the Import Button (That I designed) then select the Excel file in my computer and the data is imported. \nThe problem is that my code work for only 1 sheet Excel file, means that it doesn't work if the file has multiple sheets in it, here is the code I wrote:</p>\n\n<pre><code>Private Sub ImportButton_Click()\nDim dlg As FileDialog, strFileName As String\nSet dlg = Application.FileDialog(msoFileDialogFilePicker)\nWith dlg\n.Title = \"Select the Excel file to import\"\n.AllowMultiSelect = False\n.Filters.Clear\n.Filters.Add \"Excel Files\", \"*.xls*\", 1\n.Filters.Add \"All Files\", \"*.*\",  \nIf .Show = -1 Then\nstrFileName = .SelectedItems(1)\nDoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel8, \"Personnel\", strFileName, True\nElse\nExit Sub\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>So is there a way that I can loop through the sheets in the Excel file one by one?\nThanks in advance.\n<strong>Update:</strong>\nthis the new working code if anyone needs it.</p>\n\n<pre><code>Private Sub Command0_Click()\n\n' Requires reference to Microsoft Office 11.0 Object Library.\n   Dim fDialog As FileDialog\n   Dim varFile As Variant\n\n   ' Clear listbox contents.\n   'Me.FileList.RowSource = \"\"\n\n   ' Set up the File Dialog.\n   Set fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fDialog\n\n      .AllowMultiSelect = False\n      .Filters.Add \"Excel File\", \"*.xls\"\n      .Filters.Add \"Excel File\", \"*.xlsx\"\n\n      If .Show = True Then\n\n         'Loop through each file selected and add it to our list box.\n         For Each varFile In .SelectedItems\n         ' Label3.Caption = varFile\n\n         Const acImport = 0\n         Const acSpreadsheetTypeExcel9 = 8\n\n         ''This gets the sheets to new tables\n         GetSheets varFile\n\n         Next\n         MsgBox (\"Import data successful!\")\n         End If\nEnd With\nEnd Sub\n\n\nSub GetSheets(strFileName)\n   'Requires reference to the Microsoft Excel x.x Object Library\n\n   Dim objXL As New Excel.Application\n   Dim wkb As Excel.Workbook\n   Dim wks As Object\n\n   'objXL.Visible = True\n\n   Set wkb = objXL.Workbooks.Open(strFileName)\n\n   For Each wks In wkb.Worksheets\n      DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _\n            \"Personnel\", strFileName, True, wks.Name &amp; \"$\"\n   Next\n\n   'Tidy up\n   wkb.Close\n   Set wkb = Nothing\n   objXL.Quit\n   Set objXL = Nothing\n\nEnd Su\n</code></pre>\n\n<p>b</p>\n\n<p>Note: \"Personnel\" is the name of the table where I'm importing data to.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 21, "user_id": 5905212, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205817854349437/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5905212/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1455202262, "creation_date": 1455049893, "last_edit_date": 1455200560, "question_id": 35301598, "link": "https://stackoverflow.com/questions/35301598/evaluate-not-working-inexcel-vba-as-expected", "title": "Evaluate() not working inExcel VBA as expected", "body": "<p>I have a user-defined function in an Excel VBA module. Let's say it's:</p>\n\n<pre><code>Function MyFunc( val1 as Double, val2 as int, val3 as int ) as Double\n    MyFunc = val1 * val2 + val3\nEnd Function\n</code></pre>\n\n<p>I also have another Function MyEval:</p>\n\n<pre><code>Function MyEval( formula as string )\n    MyEval = Evaluate( formula )\nEnd Function\n</code></pre>\n\n<p>In a worksheet, the cell B1 contains the following string:</p>\n\n<pre><code>\"blah blah blah \"&amp;MyFunc(VAL,2,0)&amp;\" foobar \"&amp;MyFunc(VAL,6,5)&amp;\" do re mi\"\n</code></pre>\n\n<p>Note that the quotes are part of the string, not just denoting that it is a string. In second cell, I have the following:</p>\n\n<pre><code>=MyEval(SUBSTITUTE(B1,\"VAL\",8))\n</code></pre>\n\n<p>In general this works. In the above case I would get, as expected, the string:</p>\n\n<pre><code>blah blah blah 16 foobar 53 do re mi\n</code></pre>\n\n<p>In some cases, however, I would get #VALUE!. When I examined those examples that failed, I would find that removing different parts would allow the string to evaluate, but that no specific part caused it to fail, i.e., just the first half works, just the second half works, and just the middle part works.</p>\n\n<p>Thinking that it might be a length issue (strings are up to 200 characters), I wrote a new evaluation function, where I break the string into parts on the concatenate symbol (&amp;), evaluate each part separately, and then concatenate the results together:</p>\n\n<pre><code>Function MyEval2(formula As String)\n\nIf Len(formula) = 0 Then\n    Eval2 = \"\"\nElse\n    Dim parts() As String\n    parts = Split(formula, \"&amp;\")\n    Dim result As String\n    result = \"\"\n\n    Dim index As Integer\n    Dim part As String\n    For index = LBound(parts) To UBound(parts)\n        part = parts(index)\n        If (Left(part, 1) = \"\"\"\") And (Right(part, 1) = \"\"\"\") Then\n            part = Left(part, Len(part) - 1)\n            part = Right(part, Len(part) - 1)\n            result = result &amp; part\n        Else\n            Dim val As Variant\n            val = Evaluate(part)\n            result = result &amp; val\n        End If\n    Next index\n    Eval2 = result\nEnd If\n</code></pre>\n\n<p>End Function</p>\n\n<p>In this case, sometimes when the variable 'part' was, for example, the string</p>\n\n<pre><code>MyFunc(8,6,5)\n</code></pre>\n\n<p>the line</p>\n\n<pre><code>val = Evaluate(part)\n</code></pre>\n\n<p>resulted in 'val' being the string</p>\n\n<pre><code>MyFunc(8,6,5)\n</code></pre>\n\n<p>instead of the value 53.</p>\n\n<p>Note: I have extensively re-written this to make it clearer.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1455053017, "post_id": 35301387, "comment_id": 58315211, "body": "Do the forms have a proper Child/Parent relationship?  If they do, the parent form should be independent of whether or not data is returned on the child form, so those fields should populate no matter what."}, {"owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 1, "creation_date": 1455112001, "post_id": 35301387, "comment_id": 58342609, "body": "i just realised that i had my main form linked to a record source that is the same as the subform which caused the problem"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1455113207, "post_id": 35301387, "comment_id": 58343427, "body": "That&#39;ll do it every time."}], "answers": [{"comments": [{"owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "edited": false, "score": 0, "creation_date": 1455111934, "post_id": 35313663, "comment_id": 58342573, "body": "oh yes! i didnt realise my main form has it record source linked to the same table as the subform. Now that i removed record source from my main form. it works"}, {"owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "edited": false, "score": 0, "creation_date": 1455113595, "post_id": 35313663, "comment_id": 58343713, "body": "There&#39;s actually a second part which is to hide the subform if there is no data. Currently, it does not hide the subform when the user has verified all the records. i will edit my post"}, {"owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "edited": false, "score": 0, "creation_date": 1455115723, "post_id": 35313663, "comment_id": 58345324, "body": "I managed to solve this Issue by setting the focus back to the main form and running the refresh count function"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1455102960, "creation_date": 1455102960, "answer_id": 35313663, "question_id": 35301387, "link": "https://stackoverflow.com/questions/35301387/blank-parent-form-if-subform-has-no-data/35313663#35313663", "title": "Blank parent form if subform has no data", "body": "<p>It sounds like your query for the main form has an inner join to the table (or a query with this table) for the subform.</p>\n\n<p>Remove this join or change it to an outer join.</p>\n"}], "owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 35313663, "answer_count": 1, "score": 1, "last_activity_date": 1455114255, "creation_date": 1455049148, "last_edit_date": 1455114255, "question_id": 35301387, "link": "https://stackoverflow.com/questions/35301387/blank-parent-form-if-subform-has-no-data", "title": "Blank parent form if subform has no data", "body": "<p>i have my regular form with a continous form attached to it. Everything works fine untill the subform has no data.\nHere is the subform with data<br>\nimage1 <a href=\"https://i.stack.imgur.com/eSE8b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eSE8b.png\" alt=\"enter image description here\"></a></p>\n\n<p>IF there are no data in the subform, the form becomes like this.<br>\nimage 2 <a href=\"https://i.stack.imgur.com/lNnAx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lNnAx.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using the following code in my on current event on my main form:</p>\n\n<pre><code>Function RefreshCOunt()\nIf Me.frmVerifyEquipmentSub.Form.Recordset.RecordCount = 0 Then\n\n    Me.frmVerifyEquipmentSub.Visible = False\n    Me.txtTotal = 0\n    Me.Refresh\n\nElse\n    Me.frmVerifyEquipmentSub.Visible = True\n    Me.frmVerifyEquipmentSub.Form.Requery\n    Forms![test3].txtTotal = Me.frmVerifyEquipmentSub.Form.txtSum\n    Me.Refresh\n    Forms![test3].Refresh\n\nEnd If\nEnd Function\n\nPrivate Sub Form_Current()\nCall RefreshCOunt\nEnd Sub\n\nPrivate Sub Form_GotFocus()\nCall RefreshCOunt\nEnd Sub\n</code></pre>\n\n<p>Here is the code on my subform, THis function is run when my user clicks the save button.</p>\n\n<pre><code>Function RefreshCOunt()\nIf Me.txtCount = 0 Then\n    Forms![test3].SetFocus\nElse\n    Me.Requery\n    Forms![test3].txtTotal = Me.txtSum\n    Me.Refresh\n    Forms![test3].Refresh\n\nEnd If\nEnd Function\n</code></pre>\n\n<p>I have a text behind the subform which says \"NO Available Data to be shown\"</p>\n\n<p>2 problems in this situation are:</p>\n\n<ol>\n<li><p>Empty form view as shown on image 2 (resolved as i had linked the record source of the main form to the table also used in subform)</p></li>\n<li><p>Hide the subform once the user has verified all the equipment.\n-currently my code only works the first time the form is loaded.\n-the subform does not hide once the user has verifed all the equipment</p></li>\n</ol>\n\n<p>I know how to do this in report with the HAsData function but i am not sure how i can do so in Forms.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5358, "user_id": 1562451, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qEhut.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/1562451/fred"}, "is_accepted": false, "score": 0, "last_activity_date": 1455055887, "creation_date": 1455055887, "answer_id": 35303220, "question_id": 35301346, "link": "https://stackoverflow.com/questions/35301346/vba-excel-check-for-duplicated-values-in-rows/35303220#35303220", "title": "VBA Excel check for duplicated values in rows", "body": "<p>Based on your columns above (IE. <code>Col A = Doc Number</code>, <code>Col B = Inv Number</code> etc):</p>\n\n<pre><code>=SUMIF(B:B,B:B,D:D)\n</code></pre>\n\n<p>Use this formula in E:2 and copy it down. Column E will then hold the sum of matching Inv Numbers</p>\n"}], "owner": {"reputation": 9, "user_id": 3472675, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b23f56be3fdfbdb0288fc73f7cd33bb8?s=128&d=identicon&r=PG&f=1", "display_name": "user3472675", "link": "https://stackoverflow.com/users/3472675/user3472675"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455055887, "creation_date": 1455048963, "last_edit_date": 1531164843, "question_id": 35301346, "link": "https://stackoverflow.com/questions/35301346/vba-excel-check-for-duplicated-values-in-rows", "title": "VBA Excel check for duplicated values in rows", "body": "<p>I have a raw data like that in excel:</p>\n\n<p>[<strong>Doc number</strong>]      [<strong>Inv number</strong>]      [<strong>Description</strong>]      [<strong>Amount</strong>]</p>\n\n<p>I want to check if <strong>Inv number</strong> exist in other row and then check if the sum of <strong>Amount</strong> between those rows are 0. (One row will be negative number)</p>\n\n<p>The document could be 3000 rows of more. The purpose is to check accounting movements.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455048917, "post_id": 35301226, "comment_id": 58312788, "body": "Welcome to SO. Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> and update your post with your efforts to reach your solution."}], "answers": [{"tags": [], "owner": {"reputation": 17564, "user_id": 2780791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1feea731a99cb95e342d196802bb868a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei - check Codidact", "link": "https://stackoverflow.com/users/2780791/alexei-check-codidact"}, "is_accepted": false, "score": 1, "last_activity_date": 1455048921, "creation_date": 1455048921, "answer_id": 35301326, "question_id": 35301226, "link": "https://stackoverflow.com/questions/35301226/excel-2013-after-insert-data-in-1-column-another-column-from-same-sheet-needs-up/35301326#35301326", "title": "Excel 2013 After Insert Data in 1 column another column from same sheet needs updated using macro", "body": "<p>You do not need <code>VBA</code> to achieve what you need. Formula to set 1 if not empty and 0 if empty. I have used first cell from the <code>Sheet1</code>.</p>\n\n<pre><code>=IF(ISBLANK(Sheet1!A1),0,1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5905116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551f7eb5d216d181e7dd544e8c0f1e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Vbmw", "link": "https://stackoverflow.com/users/5905116/vbmw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455049438, "creation_date": 1455048538, "last_edit_date": 1531161705, "question_id": 35301226, "link": "https://stackoverflow.com/questions/35301226/excel-2013-after-insert-data-in-1-column-another-column-from-same-sheet-needs-up", "title": "Excel 2013 After Insert Data in 1 column another column from same sheet needs updated using macro", "body": "<p>I am using Excel 2013 and have two sheets.</p>\n\n<p>\"Sheet 1\" has the following</p>\n\n<pre><code>Product      Com 1    Com 2   Com 3\nRadio Head          \nTr          \nRx  \n</code></pre>\n\n<p>\"Sheet 2\" has the following</p>\n\n<pre><code>Prod        Com 1   Com 2   Com 3\nRadio Head  \nTr\nRx\n</code></pre>\n\n<p>Now to my problem:</p>\n\n<p>Whenever I type a value in Com1 from Sheet1, I want value '1' in Com1 for the Sheet2 for the respective field.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28156, "user_id": 1026, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea331e778d54effc15b5fbc694bc8232?s=128&d=identicon&r=PG", "display_name": "Nickolay", "link": "https://stackoverflow.com/users/1026/nickolay"}, "edited": false, "score": 0, "creation_date": 1533598860, "post_id": 35301178, "comment_id": 90395055, "body": "FWIW, I found that <code>DoEvents</code> can lead to unexpected events being processed, which can lead to re-enabling ScreenUpdating."}, {"owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "reply_to_user": {"reputation": 28156, "user_id": 1026, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea331e778d54effc15b5fbc694bc8232?s=128&d=identicon&r=PG", "display_name": "Nickolay", "link": "https://stackoverflow.com/users/1026/nickolay"}, "edited": false, "score": 0, "creation_date": 1533730895, "post_id": 35301178, "comment_id": 90452869, "body": "Thanks, I&#39;ll have to look into that.  I&#39;ve always put a DoEvents in every loop, so changing programs won&#39;t be easy."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 2421914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46bd722d3ae67145b3e76f0be572e6f4?s=128&d=identicon&r=PG", "display_name": "vicsar", "link": "https://stackoverflow.com/users/2421914/vicsar"}, "is_accepted": false, "score": 2, "last_activity_date": 1466439509, "creation_date": 1466439509, "answer_id": 37927302, "question_id": 35301178, "link": "https://stackoverflow.com/questions/35301178/screenupdating-false-fails-in-excel-2013-and-2016/37927302#37927302", "title": "ScreenUpdating = False fails in Excel 2013 and 2016", "body": "<p>I wanted to leave a comment but I am not allowed to do so. Without a code sample it is very dificult to understand your problem (please see <a href=\"https://stackoverflow.com/help/how-to-ask\">https://stackoverflow.com/help/how-to-ask</a>  and edit your question appropriately.</p>\n\n<p>Here are some ideas:\n- Check if your code calls for code in a different procedure, maybe the Application.ScreenUpdating is turned on outside of the procedure.\n- Try this at the beginning of your procedure:</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>Then, at the end of the code set it to:</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>It might help; however, without a code sample it is very difficult to properly help you.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "edited": false, "score": 0, "creation_date": 1499109414, "post_id": 44546729, "comment_id": 76763046, "body": "Thanks for this suggestion, King123.  I have been experimenting with this technique, and although it doesn\u2019t stop the flickering completely, it improves the result in an important way:  It restores visibility to the StatusBar message, which I update every few seconds to show the application\u2019s progress.  Making the new output workbook invisible will crash the program during some operations, but making the macro workbook invisible after adding the new output workbook seems to suppress all but one flicker, and it preserves the StatusBar display."}], "tags": [], "owner": {"reputation": 1, "user_id": 8160892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa06dac23f21ac5b634563be82bbca48?s=128&d=identicon&r=PG", "display_name": "King123", "link": "https://stackoverflow.com/users/8160892/king123"}, "is_accepted": false, "score": 0, "last_activity_date": 1497448179, "creation_date": 1497448179, "answer_id": 44546729, "question_id": 35301178, "link": "https://stackoverflow.com/questions/35301178/screenupdating-false-fails-in-excel-2013-and-2016/44546729#44546729", "title": "ScreenUpdating = False fails in Excel 2013 and 2016", "body": "<p>After looking through many forums, I believe the flicker problem is related to SDI vs MDI.\nSomeone suggested setting the application to not visible.</p>\n\n<pre><code>Application.Visible=False\nenter code here\nApplication.Visible=True\n</code></pre>\n\n<p>This solved my flicker problem, but I didn't like how the excel application disappeared completely then suddenly reappeared for the user.</p>\n\n<p>I was able to solve the issue to my liking by using a workaround this 'which window is on top' problem.</p>\n\n<p>By leaving the main window alone, and forcing other workbooks to become not visible, letting the code run, then bringing them back to visible, it stopped flickering.</p>\n\n<pre><code>Application.Workbooks(\"yourworkbooktohide\").Windows(1).Visible = False\n</code></pre>\n\n<p>Just remember to bring it back with =true.</p>\n\n<p>Again, my script worked just fine in Excel 2010, but after \"upgrading\" to 2013, this flicker issue started. </p>\n"}, {"comments": [{"owner": {"reputation": 344, "user_id": 1134623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49cbe1fd6ccd8927321e1cca48987ab?s=128&d=identicon&r=PG", "display_name": "Erin Halbmaier", "link": "https://stackoverflow.com/users/1134623/erin-halbmaier"}, "edited": false, "score": 0, "creation_date": 1512217334, "post_id": 44892698, "comment_id": 82174034, "body": "Have you noticed if this method also improves the macro speed like when <code>.ScreenUpdating = false</code> works correctly?"}, {"owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "reply_to_user": {"reputation": 344, "user_id": 1134623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49cbe1fd6ccd8927321e1cca48987ab?s=128&d=identicon&r=PG", "display_name": "Erin Halbmaier", "link": "https://stackoverflow.com/users/1134623/erin-halbmaier"}, "edited": false, "score": 0, "creation_date": 1512394471, "post_id": 44892698, "comment_id": 82226732, "body": "No, it doesn&#39;t seem to improve the speed more than just specifying .ScreenUpdating = false."}], "tags": [], "owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "is_accepted": true, "score": 1, "last_activity_date": 1499109929, "creation_date": 1499109929, "answer_id": 44892698, "question_id": 35301178, "link": "https://stackoverflow.com/questions/35301178/screenupdating-false-fails-in-excel-2013-and-2016/44892698#44892698", "title": "ScreenUpdating = False fails in Excel 2013 and 2016", "body": "<p>Here is a technique that helps reduce flickering and preserves the StatusBar message.</p>\n\n<pre><code>Application.Cursor = xlWait\nApplication.ScreenUpdating = False\n. . .\nSet wkbNewBook = Workbooks.Add\nThisWorkbook.Windows(1).Visible = False\n. . .\nThisWorkbook.Windows(1).Visible = True\nwkbNewBook.Activate\nApplication.ScreenUpdating = True\nApplication.Cursor = xlDefault\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12273187, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9e6939438ade3085f2c88d81c7575dd2?s=128&d=identicon&r=PG", "display_name": "nico Mijnster", "link": "https://stackoverflow.com/users/12273187/nico-mijnster"}, "is_accepted": false, "score": 0, "last_activity_date": 1571996203, "creation_date": 1571996203, "answer_id": 58555921, "question_id": 35301178, "link": "https://stackoverflow.com/questions/35301178/screenupdating-false-fails-in-excel-2013-and-2016/58555921#58555921", "title": "ScreenUpdating = False fails in Excel 2013 and 2016", "body": "<p>For me, only \"Application.ScreenUpdating = False\" did not completely cure the flickering.\nCalculation caused also the flickering.\nAdding \"Application.Calculation = xlCalculationManual\" solved the flickering issue.\nSo, the code should be like:</p>\n\n<p>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual</p>\n\n<p>... inportant code here....</p>\n\n<p>Application.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic</p>\n\n<p>Nico Mijnster.</p>\n"}], "owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8855, "favorite_count": 0, "accepted_answer_id": 44892698, "answer_count": 4, "score": 8, "last_activity_date": 1571996203, "creation_date": 1455048343, "last_edit_date": 1533586114, "question_id": 35301178, "link": "https://stackoverflow.com/questions/35301178/screenupdating-false-fails-in-excel-2013-and-2016", "title": "ScreenUpdating = False fails in Excel 2013 and 2016", "body": "<p>Long-running, high-end Excel-based applications that I developed years ago and that run beautifully in Excel 2007 and 2010 look like Amateur Hour in Excel 2013 and 2016 because <code>Application.ScreenUpdating = False</code> no longer works reliably.</p>\n\n<p>The screen unfreezes apparently when VBA code copies a preformatted worksheet from the macro workbook into a new workbook, although other circumstances must trigger it as well.</p>\n\n<p>I\u2019ve seen the threads on this subject that recommend \u201cfiddling with the code\u201d or \u201ccalling the code in a subroutine\u201d.  Unfortunately, I have to maintain hundreds of Excel applications each with thousands of lines of code and hundreds of users who are about to migrate to Office 2016, so rewriting is not an option.  How can I recover Excel\u2019s former elegance?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455048510, "post_id": 35301096, "comment_id": 58312547, "body": "do you place the event code inside the sheet modules or ThisWorkbook module of the newly created workbook?"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455048618, "post_id": 35301096, "comment_id": 58312604, "body": "Hello @ScottHoltzman I have the code inside the eventWB.cls module which is located inside the new workbook"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455048781, "post_id": 35301096, "comment_id": 58312706, "body": "I am not 100% familiar with classes, but how would for instance a <code>Worksheet_Change</code> event know to fire if I change a cell on <code>Sheet1</code> in the new workbook if the code is in the class module?"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455049206, "post_id": 35301096, "comment_id": 58312959, "body": "since its inside the class module, I am creating the workbook as new eventWB. So its not a regular workbook. Each time I make a change on the cell, the workbook has this function inside of it so it will look it up as long as the application.enableEvents = true"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1455053946, "post_id": 35301096, "comment_id": 58315708, "body": "Just to understand, you&#39;ve created a custom class that catches all workbook events (possibly even custom events you generate). In your current (active) workbook, you use <code>Workbooks.Add</code> to create a new workbook and then copy your code modules/classes over to it. On a sheet in the new workbook, you have the code listed above (which creates an object of your custom event class). If you close all workbooks and then open the macro-created workbook, events do not work. Is this correct?"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1455059731, "post_id": 35301096, "comment_id": 58318457, "body": "Hello @PeterT yes you are correct one thing is the custom class is the actual new workbook. So when I create this new workbook I create it as new eventWB instead of a regular wrokbook"}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "is_accepted": false, "score": 0, "last_activity_date": 1455121325, "creation_date": 1455121325, "answer_id": 35320481, "question_id": 35301096, "link": "https://stackoverflow.com/questions/35301096/event-in-workbook-not-working-when-reopening/35320481#35320481", "title": "Event in Workbook not working when reopening", "body": "<p>I beleive I found the solution to my problem. I was able to make it work by adding an extra lin on my workbook class:</p>\n\n<pre><code>Public WithEvents m_events As Application\n</code></pre>\n\n<p>Every time I open the workbook I call I set it as:</p>\n\n<pre><code>Newbook.m_events = Application\n</code></pre>\n\n<p>And it does the trick the events work again. Hope this helps anybody with the same issue! Thank you again!</p>\n"}], "owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455121325, "creation_date": 1455048008, "last_edit_date": 1455072250, "question_id": 35301096, "link": "https://stackoverflow.com/questions/35301096/event-in-workbook-not-working-when-reopening", "title": "Event in Workbook not working when reopening", "body": "<p>I have an Excel macro that creates a new custom workbook with events. The macro also copies the .bas and .cls files onto the new workbook and changes the link to be the new workbook. </p>\n\n<p>When the new workbook is created, everything, including events works fine. But when I close it and reopen it, the events do not work anymore. I realize the new workbook value is been lost. Since I have a button on the sheet I added the following to try to recreate it but no luck:</p>\n\n<pre><code>Dim Newbook As New eventWB\nDim thisWB As Workbook\nSet Newbook.Workbook = ActiveWorkbook\nSet thisWB = Newbook.Workbook\n\n// extra code to gather information\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1455047855, "post_id": 35300997, "comment_id": 58312229, "body": "<code>marco</code>? Macro, you mean?"}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1455060771, "creation_date": 1455060771, "answer_id": 35304264, "question_id": 35300997, "link": "https://stackoverflow.com/questions/35300997/vb-macro-issue-for-relinking-word-documents/35304264#35304264", "title": "VB Macro Issue for relinking Word Documents", "body": "<p>1) few typos in the above code which might just be formatting on StackOverflow: <code>.SourceNam e</code> a couple times. Also in the function which makes the new path: </p>\n\n<pre><code>Right(ActiveDocument.Fields(x).LinkFormat.SourceNa me, Len(ActiveDocument.Fields(x).LinkFormat.SourceName ) - InStr(ActiveDocument.Fields(x).LinkFormat.SourceNa me, \"_\")). \n</code></pre>\n\n<p>Also add a string variable and catch one of them in a msgbox to test:</p>\n\n<pre><code>If Left(ActiveDocument.Fields(x).LinkFormat.SourceNam e, Len(oriacro)) = oriacro Then\n\n    'read all the fields that has \"original agency acronym\" in the beginning of its linked excel files.'\n    str = ActiveDocument.Fields(x).LinkFormat.SourceName 'Dim str variable above if necessary\n    ActiveDocument.Fields(x).LinkFormat.SourceFullName = path &amp; \"\\\" &amp; taracro &amp; \"_\" &amp; Right(str, InStrRev(str, \"_\")-1)\n    'Assign the fields with new links that are created from combining the \"target path\" ,\"target agency acronym\", and the parts of the names right after the original acronyms of the original linked file names.'\n    msgbox ActiveDocument.Fields(x).LinkFormat.SourceFullName   'does this message show the proper path??\nElse\n    'Leave other linked fields as they are.'\nEnd If\nActiveDocument.Fields.Update\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5905104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ca556dcbacfb81a285b81278a436f2?s=128&d=identicon&r=PG&f=1", "display_name": "gmason2", "link": "https://stackoverflow.com/users/5905104/gmason2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455060771, "creation_date": 1455047626, "last_edit_date": 1531164843, "question_id": 35300997, "link": "https://stackoverflow.com/questions/35300997/vb-macro-issue-for-relinking-word-documents", "title": "VB Macro Issue for relinking Word Documents", "body": "<p>I am having trouble getting this macro to work. I am working on a Windows 10 computer with Office 2013. The code was not written by me and I have limited knowledge in VB. The marco is supposed to update a a word document's links by mirroring how the the previous word document was linked. Below is the code, if anyone could help that would be great.</p>\n\n<pre><code>Sub relinking()\n\nDim oriacro As String\nDim taracro As String\nDim path As String\n\noriacro = InputBox(Prompt:=\"please enter the original agency acronym.\", Title:=\"ENTER THE ORIGINAL AGENCY ACRONYM\")\ntaracro = InputBox(Prompt:=\"please enter the target agency acronym.\", Title:=\"ENTER THE TARGET AGENCY ACRONYM\")\npath = InputBox(Prompt:=\"please enter the target path.\", Title:=\"ENTER THE TARGET PATH\")\n\nExcel.Application.Quit\n'close all the excel files.(excel reference has to be activated in tool-&gt;reference'\n\nFor x = 1 To ActiveDocument.Fields.Count\n'the program runs over all the linked fields'\n\nIf Left(ActiveDocument.Fields(x).LinkFormat.SourceNam e, Len(oriacro)) = oriacro Then\n'read all the fields that has \"original agency acronym\" in the beginning of its linked excel files.'\nActiveDocument.Fields(x).LinkFormat.SourceFullName = path &amp; \"\\\" &amp; taracro &amp; \"_\" &amp; Right(ActiveDocument.Fields(x).LinkFormat.SourceNa me, Len(ActiveDocument.Fields(x).LinkFormat.SourceName ) - InStr(ActiveDocument.Fields(x).LinkFormat.SourceNa me, \"_\"))\n'Assign the fields with new links that are created from combining the \"target path\" ,\"target agency acronym\", and the parts of the names right after the original acronyms of the original linked file names.'\nElse\n'Leave other linked fields as they are.'\nEnd If\nNext x\n\nMsgBox (\"All Fields have been relinked!\")\nEnd Sub \n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "replace"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455047281, "post_id": 35300784, "comment_id": 58311897, "body": "Exactly which part of this is giving you problems?"}, {"owner": {"reputation": 51, "user_id": 5904446, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afbd88ac2467b7bc2e0d5424a3c81006?s=128&d=identicon&r=PG&f=1", "display_name": "The_BMan", "link": "https://stackoverflow.com/users/5904446/the-bman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455123093, "post_id": 35300784, "comment_id": 58351107, "body": "I&#39;m not sure what syntax would be that would from a VBA script would access the text file within a directory, open it, and find and replace the necessary strings. When I had looked into it it seemed like I was required to use some functions with FileSystemObjects, but I couldn&#39;t seem to employ that within the VBA editor. would this imply that visual studio? but also, hopw can find, insert functions be employed within a outside text document?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455123530, "post_id": 35300784, "comment_id": 58351427, "body": "<a href=\"http://stackoverflow.com/questions/11528694/read-parse-text-file-line-by-line-in-vba\" title=\"read parse text file line by line in vba\">stackoverflow.com/questions/11528694/&hellip;</a>"}], "owner": {"reputation": 51, "user_id": 5904446, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afbd88ac2467b7bc2e0d5424a3c81006?s=128&d=identicon&r=PG&f=1", "display_name": "The_BMan", "link": "https://stackoverflow.com/users/5904446/the-bman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455046835, "creation_date": 1455046835, "last_edit_date": 1531164843, "question_id": 35300784, "link": "https://stackoverflow.com/questions/35300784/vba-augmenting-text-txt-file", "title": "VBA augmenting Text.txt file", "body": "<p>I have multiple Text files. They are all located in a specific directory. </p>\n\n<p>Directory = \"C:\\Users\\Bob\\Documents\\Projects\"</p>\n\n<p>The file would be listed within this directory as </p>\n\n<pre><code>BobFileA.txt\nBobFileB.txt\nBobFileC.txt\n</code></pre>\n\n<p>With each of these text files, there is some similar string of text. The string of text would be something like \"IDStringHere\" and the string of text resides within the file amongst other text such that it would be</p>\n\n<pre><code>787,Tangent(IDStringHere1)\n</code></pre>\n\n<p>Is there a way that I acn run a VBA script which will go through all the file i mentioned above, open them, find the string of text, Replace the string of text with another in-putted string of textbut with the new line commands  \"NewText\"\\n\"String\", and then save the file in a new format such as a \".CSV\" \nso the goal of this would be to have the files, </p>\n\n<pre><code>BobFileA.csv\nBobFileB.csv\nBobFileC.csv\n</code></pre>\n\n<p>and within these files they would have ONLY the original string of text replaced with the new. </p>\n\n<pre><code>    787,Tangent(NewText\n    String)\n</code></pre>\n\n<p>Thank you in advance. I am forever in your service. </p>\n"}, {"tags": ["excel", "vba", "explorer"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455048182, "post_id": 35300786, "comment_id": 58312390, "body": "thank you for your quick response. i am getting run-time error back:automation error. The Interface is unknown and it stops in Set btn = IE.Document.getElementById(&quot;z_e6_mm!b&quot;)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455049488, "post_id": 35300786, "comment_id": 58313125, "body": "requires IE8+ what version have you? You may also need a ready/waiting loop for IE to allow the page to finish Loading.  ALso, verify the correct element ID from the XML."}, {"owner": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455049628, "post_id": 35300786, "comment_id": 58313204, "body": "My IE version is 8.0.7601.17514. I added a waiting loop also, for 10 seconds :Application.Wait DateAdd(&quot;s&quot;, 10, Now). How can i verify that is the correct element? i search with the button title!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455049950, "post_id": 35300786, "comment_id": 58313397, "body": "Application.Wait will not work. You need to use While: DoEvents: Loop Until IE.ReadyState = 4 and Not IE.Busy"}, {"owner": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455096978, "post_id": 35300786, "comment_id": 58332142, "body": "It seems that button id is changing every time the link is opened. Is there a way to get current button id?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455154399, "post_id": 35300786, "comment_id": 58366880, "body": "@Golemic no, the ID <i>is</i> the unique identifier, so the only way to obtain the button&#39;s ID would be to do a <code>For&#47;Next</code> loop over all of the buttons <code>getElementByTagName(&quot;button&quot;)</code> and compare some other property for equivalence. It seems you will need to do that, and just check each button&#39;s <code>innerText</code> property. I will update the answer..."}, {"owner": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455274027, "post_id": 35300786, "comment_id": 58427172, "body": "Thanks David!Could you help me more with that? Is there a link with the code i need, so i can check out?"}, {"owner": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "edited": false, "score": 0, "creation_date": 1455375613, "post_id": 35300786, "comment_id": 58467671, "body": "Worked great! Thank you David Zemens"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1455154523, "last_edit_date": 1455154523, "creation_date": 1455046836, "answer_id": 35300786, "question_id": 35300700, "link": "https://stackoverflow.com/questions/35300700/vba-hit-button-on-ie-page/35300786#35300786", "title": "VBA hit button on IE page", "body": "<p>Why don't you use the <code>getElementByID(\"z_e6_mm!b\")</code> method to return the instance of that button. The element <em>id</em> is unique within the document, no need for iteration.</p>\n\n<pre><code>Dim btn as Object\nSet btn = IE.Document.getElementByID(\"z_e6_mm!b\")\nbtn.Click\n</code></pre>\n\n<p>NOTE: May not work with certain version(s) of IE.</p>\n\n<p>Also worth noting, you could have a simple issue of case-sensitive comparison returning false, and never clicking the button, because: <code>\"Hit Me\" != \"HIT ME\"</code>.  You could control for this by forcing a <code>UCASE</code> or <code>LCASE</code> evaluation of the button's text, but that seems less reliable than using the ID property.</p>\n\n<p>Also note: that's not the element's <code>.Name</code> but it's <code>.InnerText</code></p>\n\n<p>As you observe, the ID property is changing so you can't reliably program to it. In that case, you're left with brute force iteration, and comparing some non-unique property like <code>innerText</code>:</p>\n\n<pre><code>Dim btn as Object\nFor each btn in IE.Document.getElementsByTagName(\"button\")\n    If btn.innerText = \"**HIT ME**&amp;nbsp;\" Then '&lt;~~~ MODIFY AS NEEDED  ###\n        btn.click\n        Exit For 'break out of the loop\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 40, "user_id": 4113773, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb70e1e3264f1f1fafd005915f95f546?s=128&d=identicon&r=PG&f=1", "display_name": "Golemic", "link": "https://stackoverflow.com/users/4113773/golemic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 35300786, "answer_count": 1, "score": 0, "last_activity_date": 1455154523, "creation_date": 1455046526, "question_id": 35300700, "link": "https://stackoverflow.com/questions/35300700/vba-hit-button-on-ie-page", "title": "VBA hit button on IE page", "body": "<p>What i am trying to do is to open a site, and then press a button. i can't make it work though, so i am asking for all of you experienced programmers!</p>\n\n<p>The button xml record is:</p>\n\n<pre><code>z-menu-item-inner-r\"&gt;&lt;span class=\"z-menu-item-space\"&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/a&gt;&lt;/td&gt;&lt;td id=\"z_e6_mm\" align=\"left\" z.type=\"Menuit2\" class=\"z-menu-item \" style=\"padding-left:4px;padding-right:4px;\" z.zcls=\"z-menu-item\" z.top=\"true\"&gt;&lt;a href=\"/NTS/NTSBatchJobs.zul\" class=\"z-menu-item-cnt\"&gt;&lt;table id=\"z_e6_mm!a\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"z-menu-item-body \" style=\"width: auto;\"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=\"z-menu-item-inner-l\"&gt;&lt;span class=\"z-menu-item-space\"&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=\"z-menu-item-inner-m\"&gt;&lt;div&gt;&lt;button id=\"z_e6_mm!b\" type=\"button\" class=\"z-menu-item-btn\"&gt;**HIT ME**&amp;nbsp;&lt;/button&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=\"\n</code></pre>\n\n<p>The button i am trying to press is named:\n<strong>HIT ME</strong></p>\n\n<p>The code i am using is:  </p>\n\n<pre><code>Sub IE_Auto()\n\n\n    Dim i As Long\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.Navigate \"mysite\"\n\n    Set elems = IE.Document.getElementsByTagName(\"button\")\n        For Each e In elems\n            If e.Name = \"Hit Me\" Then\n                e.Click\n                Exit For\n            End If\n     Next e\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1455046951, "post_id": 35300402, "comment_id": 58311720, "body": "&quot;Next mail item&quot; in what sense? Next in the selection? In the folder?"}, {"owner": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1455059018, "post_id": 35300402, "comment_id": 58318209, "body": "In the folder, thanks!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1455086081, "post_id": 35300402, "comment_id": 58326357, "body": "That Question is closed, what is your trying to do? also see <a href=\"http://stackoverflow.com/tour\">SO Help</a>"}, {"owner": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "edited": false, "score": 0, "creation_date": 1455107004, "post_id": 35300402, "comment_id": 58338960, "body": "Hi, I&#39;m looking for code that will (1) reply to the active email (2) add text (3) send (4) delete it (move to deleted folder) then (5) open the next email item in the folder. I need step number 5, please. The answer I referenced in my original post provides steps 1 through 3 and I figured out step 4 from another answer. Now I just need step 5. Thanks!"}, {"owner": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1455301062, "post_id": 35300402, "comment_id": 58445019, "body": "Thanks, @Om3r &amp; @niton! Om3r, that does not open the next item. Niton, I&#39;m pickin&#39; up what you&#39;re layin&#39; down but not sure if I&#39;ve found the right ID. I don&#39;t see an &quot;icon&quot; where I customize the toolbar/ribbon and everything I hover over just gives me the shortcut. I found 478 through the link/download but not sure how to incorporate it into my code."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1456179348, "last_edit_date": 1495540007, "creation_date": 1455236770, "answer_id": 35352709, "question_id": 35300402, "link": "https://stackoverflow.com/questions/35300402/reply-to-active-email-add-text-send-delete-then-open-next-mail-item/35352709#35352709", "title": "Reply to active email - add text, send, delete &amp; then open next mail item", "body": "<p>You should process Activeinspector.CurrentItem not the selection. The code in that link will behave differently than expected if you, say leave mail open, make other selections in the explorer window, come back to the original mail which is now not selected. </p>\n\n<p>To go to the next item after deleting, try simulating a click on the delete button.</p>\n\n<p>Both these ideas are demonstrated in this <a href=\"https://stackoverflow.com/a/28890421/1571407\">answer</a>.</p>\n\n<pre><code>Sub SetEditMode()\nDim myItem As Outlook.MailItem\nDim objInsp As Outlook.Inspector\nDim objActionsMenu As Office.CommandBarControl\nDim olNewMailItem As Outlook.MailItem\n\nOn Error Resume Next ' Bad coding do not do this\n\nSelect Case TypeName(Application.ActiveWindow)\n    Case \"Explorer\"\n        Set myItem = ActiveExplorer.Selection.Item(1)\n        myItem.Display\n    Case \"Inspector\"\n        Set myItem = ActiveInspector.CurrentItem\n    Case Else\nEnd Select\nIf myItem Is Nothing Then GoTo ExitProc\n'edit mode\nSet objInsp = ActiveInspector\nobjInsp.CommandBars.ExecuteMso (\"EditMessage\")\nobjActionsMenu.Execute\n\nExitProc:\nEnd Sub\n</code></pre>\n\n<p>Use this idea to refer to your mail.</p>\n\n<pre><code>Set myItem = ActiveInspector.CurrentItem\n</code></pre>\n\n<p>Use this idea to click a button.</p>\n\n<pre><code>objInsp.CommandBars.ExecuteMso (\"EditMessage\")\n</code></pre>\n\n<p>EditMessage is an Mso ID / Control ID. You can find the Mso ID for the Delete button by <a href=\"https://books.google.ca/books?id=hWN-AwAAQBAJ&amp;pg=PT2787&amp;lpg=PT2787&amp;dq=Lists%20of%20Control%20IDs&amp;source=bl&amp;ots=FBww9LfO9L&amp;sig=koCOWyF2vwbLp88X5IM9l7vXSCY&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwi5zpvz8_DKAhVB1BoKHfc1Cp04ChDoAQgkMAI#v=onepage&amp;q=Lists%20of%20Control%20IDs&amp;f=false\" rel=\"nofollow noreferrer\">hovering over the icon</a> where you add buttons to the Quick Access toolbar or a ribbon.</p>\n\n<p>You can download a list here <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=3582\" rel=\"nofollow noreferrer\">2007 Office System Document: Lists of Control IDs</a>  </p>\n\n<p><strong>Edit: 2016-02-22</strong></p>\n\n<p>Control ID may not work as I thought. Use the hover technique.</p>\n\n<pre><code>Sub Reply_ExecuteMso_DeleteOriginal()\n'\n' ** NOT working as intended **\n'\n' Simulating clicking the delete button is too fast\n'  Must slow down with a MsgBox\n'\n' Now it is the same as clicking delete manually\n'\nDim olItem As Object\nDim olReply As mailItem\nDim objInsp As Inspector\n\nSelect Case TypeName(Application.ActiveWindow)\n    Case \"Explorer\"\n        Set olItem = ActiveExplorer.Selection.Item(1)\n        olItem.Display\n    Case \"Inspector\"\n        Set olItem = ActiveInspector.currentItem\nEnd Select\n\nIf olItem Is Nothing Then GoTo ExitProc\n\nIf olItem.Class = olMail Then\n\n    Set olReply = olItem.Reply\n    olReply.Display\n\n    olReply.HTMLBody = \"Thank you!\" &amp; vbCrLf &amp; olReply.HTMLBody\n    olReply.send\n\n    olItem.Display\n    Set objInsp = ActiveInspector\n    objInsp.CommandBars.ExecuteMso (\"Delete\")\n\nEnd If\n\nMsgBox \"This slows down the processing.\"\n\nOn Error Resume Next\n' Error when no items left\nSet olItem = ActiveExplorer.Selection.Item(1)\nolItem.Display\nOn Error GoTo 0\n\nExitProc:\n    Set olItem = Nothing\n    Set olReply = Nothing\n    Set objInsp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1455412831, "post_id": 35352763, "comment_id": 58479015, "body": "@joepatrick are you selecting multiple items? Are getting any errors? also remove <code>.Send</code> from the code."}, {"owner": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "edited": false, "score": 0, "creation_date": 1456594550, "post_id": 35352763, "comment_id": 59024993, "body": "The current code works on multiple items (if selected) or just one item if it&#39;s open and therefore active and the only one selected. I need the .send for it to send. I&#39;m still just lacking the part to make it automatically open the next item in the folder succeeding the item just deleted."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "edited": false, "score": 0, "creation_date": 1456595879, "post_id": 35352763, "comment_id": 59025586, "body": "Still confused- why do you want it open- for editing?"}, {"owner": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "edited": false, "score": 0, "creation_date": 1456787827, "post_id": 35352763, "comment_id": 59100083, "body": "So i can read it. I&#39;d like it to open automatically. Like when you set your email options for &quot;after moving or deleting an open item:&quot; to &quot;open the next item&quot;."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1456795921, "last_edit_date": 1456795921, "creation_date": 1455237126, "answer_id": 35352763, "question_id": 35300402, "link": "https://stackoverflow.com/questions/35300402/reply-to-active-email-add-text-send-delete-then-open-next-mail-item/35352763#35352763", "title": "Reply to active email - add text, send, delete &amp; then open next mail item", "body": "<p><em>Remember to update Folder Name</em> </p>\n\n<p><strong><code>olFolderName = \"TEMP\"</code></strong></p>\n\n<pre><code>Sub Open_Next_olMessage()\n    Dim olNamespace As Outlook.NameSpace\n    Dim olFolder As MAPIFolder\n    Dim olItem As MailItem\n    Dim olReply As MailItem\n    Dim olFolderName As String\n    Dim olMsgBox As Integer\n    Dim Cancel As Boolean\n\n    olFolderName = \"TEMP\" '&lt;-- Update Folder Name\n\n'   // Set Inbox/SubFolder\n    Set olNamespace = Session.Application.GetNamespace(\"MAPI\")\n'                                                             --&gt; Folder Name\n    Set olFolder = olNamespace.GetDefaultFolder(olFolderInbox).Folders(olFolderName)\n\n'   // Loop through items in folder\n    For Each olItem In olFolder.Items\n        If (olItem.Class = olMail) Then\n            olItem.Display True\n\n            olMsgBox = MsgBox(\"Do you want to Reply to this Email\", vbYesNoCancel)\n            Set olReply = olItem.ReplyAll ' or Reply\n            Set olItem = olItem\n\n            If olMsgBox = vbCancel Then\n                Cancel = True ' Exit\n                Exit Sub\n            ElseIf olMsgBox = vbYes Then\n                   olReply.Display True\n            ElseIf olMsgBox = vbNo Then\n'                  do something\n            End If\n\n            olItem.Delete ' Delete Message\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5904793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10207011622281067/picture?type=large", "display_name": "Joe Patrick", "link": "https://stackoverflow.com/users/5904793/joe-patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592723719, "creation_date": 1455045443, "last_edit_date": 1592723719, "question_id": 35300402, "link": "https://stackoverflow.com/questions/35300402/reply-to-active-email-add-text-send-delete-then-open-next-mail-item", "title": "Reply to active email - add text, send, delete &amp; then open next mail item", "body": "<p>I want after replying to the active mail to delete that active mail then open the next item in the folder.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/31817632/outlook-reply-to-an-email\">this answer</a>, added <strong><code>'olItem.Delete'</code></strong> but need the 'open next mail item'.</p>\n\n<pre><code>Sub ReplyMSG()\n    Dim olItem As Outlook.MailItem\n    Dim olReply As MailItem ' Reply\n    Dim olRecip As Recipient ' Add Recipient\n    Dim objInsp As Outlook.Inspector\n    Dim objActionsMenu As Office.CommandBarControl\n\n    For Each olItem In Application.ActiveExplorer.Selection\n        Set olReply = olItem.Reply\n        olReply.HTMLBody = \"Thank you!\" &amp; vbCrLf &amp; olReply.HTMLBody\n        olReply.Send objInsp.CommandBars.ExecuteMso(478)\n        objActionsMenu.Execute\n    Next olItem\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 1803, "user_id": 5030129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d0f7c1816e64369016c23c3c04344f07?s=128&d=identicon&r=PG&f=1", "display_name": "Claudius", "link": "https://stackoverflow.com/users/5030129/claudius"}, "edited": false, "score": 0, "creation_date": 1455044125, "post_id": 35299837, "comment_id": 58310060, "body": "this is a terrible approach but here you go <a href=\"http://simeonpilgrim.com/blog/2007/12/04/compiling-and-running-code-at-runtime/\" rel=\"nofollow noreferrer\">simeonpilgrim.com/blog/2007/12/04/&hellip;</a>          post your code and we can help you get there"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455044190, "post_id": 35299837, "comment_id": 58310101, "body": "Use a <code>For Each</code> loop to loop through the sheets. And compare each sheet to the first.  If any are false then do not do the rest. Then assign a Boolean variable true or false based on the outcome.  Then you can test on that Boolean variable."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1455044565, "creation_date": 1455044565, "answer_id": 35300141, "question_id": 35299837, "link": "https://stackoverflow.com/questions/35299837/use-a-string-as-part-of-an-if-statement-vba/35300141#35300141", "title": "Use a string as part of an If statement (VBA)", "body": "<p>Try something like this. </p>\n\n<p>You can easily test against other sheet names if there are sheets you know you don't want to check against.</p>\n\n<pre><code>Dim sValue As String\nDim ws1 As Worksheet\nSet ws1 = Worksheets(\"loc(1)\")\n\nsValue = ws1.Cells(TseriesLine, 15).Value2\n\nDim bifline As Boolean\nbifline = True\n\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n\n    If ws.Name &lt;&gt; ws1.Name Then\n        If sValue &lt;&gt; ws.Cells(TseriesLine, 15).Value2 Then\n            bifline = False\n            Exit For\n        End\n    End If\n\nNext\n\nIf bifline Then\n    'more code\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 1, "last_activity_date": 1455044601, "creation_date": 1455044601, "answer_id": 35300154, "question_id": 35299837, "link": "https://stackoverflow.com/questions/35299837/use-a-string-as-part-of-an-if-statement-vba/35300154#35300154", "title": "Use a string as part of an If statement (VBA)", "body": "<p>You can loop over each sheet with the worksheet collection in each workbook object. </p>\n\n<pre><code>Function doesRangeMatch(rangeAddress As String) As Boolean\n    Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        If ThisWorkbook.Worksheets(1).Range(rangeAddress).Value &lt;&gt; ws.Range(rangeAddress).Value Then\n            doesRangeMatch = False \n            Exit Function 'early exit if match not found\n        End If\n    Next\n    doesRangeMatch = True 'if loop goes through then all must match\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5904786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2535914dc3f85761cf8cfb30c4e6c9b?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/5904786/mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1455134401, "last_edit_date": 1455134401, "creation_date": 1455047039, "answer_id": 35300835, "question_id": 35299837, "link": "https://stackoverflow.com/questions/35299837/use-a-string-as-part-of-an-if-statement-vba/35300835#35300835", "title": "Use a string as part of an If statement (VBA)", "body": "<p>Thanks everyone so much! I used a combination of suggestions to come up with the loop. Here is the solution:</p>\n\n<pre><code>For ss = 2 To numloc\n    If Worksheets(loc(1)).Cells(TseriesLine, 15) &lt;&gt; Worksheets(loc(ss)).Cells(TseriesLine, 15) Then\n        doNumMatch = False\nExit For\n    Else: doNumMatch = True\n    End If\nNext\n\nIf doNumMatch Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5904786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2535914dc3f85761cf8cfb30c4e6c9b?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/5904786/mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3461, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455134401, "creation_date": 1455043654, "last_edit_date": 1531164843, "question_id": 35299837, "link": "https://stackoverflow.com/questions/35299837/use-a-string-as-part-of-an-if-statement-vba", "title": "Use a string as part of an If statement (VBA)", "body": "<p>I have an If/Then loop in VBA that checks if the same cell in each tab are equal, and I can create a string that works in the If/Then loop given a known number of tabs (3 tabs); however, the macro needs to look at an arbitrary number of tabs and I need a dynamic If/Then statement. I tried to create a string that essentially writes the code based on the number of tabs, but I get Type Mismatch because the string is a variable.</p>\n\n<p>For example, this works given 3 tabs:</p>\n\n<pre><code>If Worksheets(loc(1)).Cells(TseriesLine, 15) = Worksheets(loc(2)).Cells(TseriesLine, 15) _\n   And Worksheets(loc(1)).Cells(TseriesLine, 15) = Worksheets(loc(3)).Cells(TseriesLine, 15) Then\n</code></pre>\n\n<p>....</p>\n\n<p>But this doesn't work:</p>\n\n<pre><code>ifline = \"Worksheets(loc(1)).Cells(TseriesLine, 15) = Worksheets(loc(2)).Cells(TseriesLine, 15) _\n   And Worksheets(loc(1)).Cells(TseriesLine, 15) = Worksheets(loc(3)).Cells(TseriesLine, 15)\"\n\nIf ifline Then ....\n</code></pre>\n\n<p>I also tried using Evalulate(ifline) and StrConv(ifline) to no success. Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 3, "creation_date": 1455042866, "post_id": 35299511, "comment_id": 58309274, "body": "Problem 1: a <code>const</code> can only be set to something const, which <code>Val</code> is not.  So that code will never work.  Your second try is better, but here I suspect with problem 2 that <code>Setup</code> is not the code name of one of your sheets?"}], "answers": [{"comments": [{"owner": {"reputation": 1271, "user_id": 1545812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a11d1e37ad8e4c29dbe7e166aac30ba0?s=128&d=identicon&r=PG", "display_name": "Timothy Alston", "link": "https://stackoverflow.com/users/1545812/timothy-alston"}, "edited": false, "score": 0, "creation_date": 1455043225, "post_id": 35299599, "comment_id": 58309479, "body": "Ah, thought because I had previously set it as worksheet it would carry across- just seen I hadn&#39;t set it as a &#39;public&#39; work sheet. Many thanks for very fast response!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455043290, "post_id": 35299599, "comment_id": 58309520, "body": "just a note that <code>Setup.Range(&quot;B8&quot;).Value</code> would work if you named the worksheet object (inside the VBE) as <code>Setup</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455044179, "post_id": 35299599, "comment_id": 58310091, "body": "@ScottHoltzman - You mean if I change the name of the worksheet in the Project view (where it&#39;s the sheet icon, then the <code>ThisWorkbook</code> icon, and modules under that), you can just do <code>Setup</code> without declaring it? Neat! I didn&#39;t know that."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455044677, "post_id": 35299599, "comment_id": 58310370, "body": "Yes. You can change it, or just refer to it as <code>Sheet1.Cells(x,y)</code>. It&#39;s a cool feature, but if obviously you can see the issues with reading code that has <code>Sheet1...</code> or <code>Sheet2 ... </code> so you have to name them meaningfully."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 3, "last_activity_date": 1455042925, "creation_date": 1455042925, "answer_id": 35299599, "question_id": 35299511, "link": "https://stackoverflow.com/questions/35299511/vba-to-remove-prefix-from-excel-tab-names/35299599#35299599", "title": "VBA to remove prefix from excel tab names", "body": "<p>Now it's crashing because you never set <code>Setup</code> as a worksheet.</p>\n\n<pre><code>Dim setup as Worksheet\nSet setup = Sheets(\"Setup\")\n</code></pre>\n\n<p>should do the trick.  Also, it looks like <code>Val</code> will change, so you wouldn't want to set it as a <code>Constant</code>.</p>\n"}], "owner": {"reputation": 1271, "user_id": 1545812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a11d1e37ad8e4c29dbe7e166aac30ba0?s=128&d=identicon&r=PG", "display_name": "Timothy Alston", "link": "https://stackoverflow.com/users/1545812/timothy-alston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 993, "favorite_count": 0, "accepted_answer_id": 35299599, "answer_count": 1, "score": 1, "last_activity_date": 1455042925, "creation_date": 1455042612, "question_id": 35299511, "link": "https://stackoverflow.com/questions/35299511/vba-to-remove-prefix-from-excel-tab-names", "title": "VBA to remove prefix from excel tab names", "body": "<p>I have an excel file with many tabs. All tabs are named such as: \"pboro bz.csv\", \"pboro fd.csv\", \"pboro ha.csv\", etc.</p>\n\n<p>I am looking to rename all of these \"bz.csv\", \"fd.csv\", \"ha.csv\" instead.</p>\n\n<p>Furthermore, depending on the data another VBA imports, the tab names may have different prefixes. I therefore have a cell (B8) in a sheet titled \"Setup\" with the prefix I wish to remove, in this case \"pboro \"</p>\n\n<p>I am trying to use this code:</p>\n\n<pre><code>Sub RemovePrefix()\n  Dim WS As Worksheet\n  Dim Val As String\n  Val = Setup.Range(\"B8\").Value\n  Const Prefix As String = Val\n  For Each WS In Worksheets\n    If WS.Name Like Prefix &amp; \"*\" Then WS.Name = Mid(WS.Name, Len(Prefix) + 1)\n  Next\nEnd Sub\n</code></pre>\n\n<p>The code crashes on the line</p>\n\n<pre><code> Const Prefix As String = Val\n</code></pre>\n\n<p>with the error \"Constant expression required\"</p>\n\n<p>I suspect this is because I am using Dim with Val, then Const with Prexif.\nHowever when I adapt the code to the following:</p>\n\n<pre><code>Sub RemovePrefix()\n  Dim WS As Worksheet\n  Dim Val As String\n  Val = Setup.Range(\"B8\").Value\n   For Each WS In Worksheets\n   If WS.Name Like Val &amp; \"*\" Then WS.Name = Mid(WS.Name, Len(Val) + 1)\n  Next\nEnd Sub\n</code></pre>\n\n<p>I receive the error \"Object required\" relating to my line of code</p>\n\n<pre><code>  Val = Setup.Range(\"B8\").Value\n</code></pre>\n\n<p>I am unsure where I am going wrong (and being a relative VBA noob probably isn't helping).</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455043621, "post_id": 35299483, "comment_id": 58309730, "body": "just tested and it works for me"}, {"owner": {"reputation": 11, "user_id": 5888565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864495285d03ee55524a082ea39013a4?s=128&d=identicon&r=PG&f=1", "display_name": "nrvander", "link": "https://stackoverflow.com/users/5888565/nrvander"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455043840, "post_id": 35299483, "comment_id": 58309870, "body": "the data is in a pivot table, would this effect anything?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455044057, "post_id": 35299483, "comment_id": 58310014, "body": "should not. can you post a screenshot of your data and your results after the code is run?"}], "owner": {"reputation": 11, "user_id": 5888565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864495285d03ee55524a082ea39013a4?s=128&d=identicon&r=PG&f=1", "display_name": "nrvander", "link": "https://stackoverflow.com/users/5888565/nrvander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455046809, "creation_date": 1455042492, "last_edit_date": 1455046809, "question_id": 35299483, "link": "https://stackoverflow.com/questions/35299483/conditionally-formatting-rows-in-vba-dynamically-colours-the-cells-incorrectly", "title": "Conditionally Formatting Rows in VBA dynamically colours the cells incorrectly", "body": "<p>I recorded a macro to conditionally format some rows in excel using vba, but when I try to run it a second time, or when I try looping it for a dynamic selection of range, it paints the cells the wrong colour and in the wrong direction.  I want the cells to be painted from red to white, high to low, but the code paints the cells orange to white, low to high. Here is my code:</p>\n\n<pre><code>Sub ConForm()\n\nSheets(\"Percentage\").Activate\n\nDim lastRow, currRow As Integer\nDim rng As Range\n\n\nlastRow = Sheets(\"Percentage\").Range(\"B250\").End(xlUp).Row\ncurrRow = 9\n\nFor currRow = 9 To (lastRow - 1)\n    'Range(\"F\" &amp; currRow &amp; \":AL\" &amp; currRow).Select\n\n    Set rng = Sheets(\"Percentage\").Range(\"F9:AL9\") '\"rng_ConForm\" &amp; currRow)\n    rng.Select\n\n    rng.FormatConditions.AddColorScale ColorScaleType:=2\n    rng.FormatConditions(1).ColorScaleCriteria(1).Type = _\n        xlConditionValueLowestValue\n    With rng.FormatConditions(1).ColorScaleCriteria(1).FormatColor\n        .Color = RGB(255, 255, 255)\n        .TintAndShade = 0\n    End With\n    rng.FormatConditions(1).ColorScaleCriteria(2).Type = _\n        xlConditionValueHighestValue\n    With rng.FormatConditions(1).ColorScaleCriteria(2).FormatColor\n        .Color = RGB(255, 0, 0)\n        .TintAndShade = 0\n    End With\n    rng.FormatConditions(1).ScopeType = xlSelectionScope\n\nNext currRow\nEnd Sub\n</code></pre>\n\n<p>Does anyone know what's going on here? Thanks</p>\n\n<p>Edit: Here is the data after running. Before being run for the first time, all conditional formatting is cleared</p>\n\n<p><strong>A) After running once</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/7QBP1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7QBP1.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>B) After running twice</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/XMeH5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XMeH5.png\" alt=\"enter image description here\"></a></p>\n"}]