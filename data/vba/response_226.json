[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1557358007, "post_id": 56050205, "comment_id": 98741828, "body": "and what is it doing instead?  To start with, the name of a <code>Sub</code> cannot include spaces."}, {"owner": {"reputation": 3, "user_id": 11472689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7bbf7161b52264e43b661f9a61bcbf?s=128&d=identicon&r=PG&f=1", "display_name": "falcon771", "link": "https://stackoverflow.com/users/11472689/falcon771"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1557418797, "post_id": 56050205, "comment_id": 98767445, "body": "@RonRosenfeld Yes, sorry, I copied my note, not the actual Sub. It is not doing anything. No error, or stop."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11472689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7bbf7161b52264e43b661f9a61bcbf?s=128&d=identicon&r=PG&f=1", "display_name": "falcon771", "link": "https://stackoverflow.com/users/11472689/falcon771"}, "edited": false, "score": 0, "creation_date": 1557418944, "post_id": 56050655, "comment_id": 98767514, "body": "THAT IS IT. Thank you so much."}], "tags": [], "owner": {"reputation": 116, "user_id": 6700974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IpF4tdyVQ-I/AAAAAAAAAAI/AAAAAAAABCE/SkmLGxCN144/photo.jpg?sz=128", "display_name": "lighthouselk", "link": "https://stackoverflow.com/users/6700974/lighthouselk"}, "is_accepted": true, "score": 0, "last_activity_date": 1557361924, "creation_date": 1557361924, "answer_id": 56050655, "question_id": 56050205, "link": "https://stackoverflow.com/questions/56050205/vba-find-first-empty-cell-and-input-text/56050655#56050655", "title": "VBA Find First Empty Cell and Input Text", "body": "<p>You can not use spaces in the Sub name.\nUse it without space or replace spaces with other valid character.</p>\n\n<pre><code>Sub AppendNotestolastpage()\n    Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    ActiveCell.Value = \"*Logo Quantity - Some items may be combined. See Account Manager.\"\n    ActiveCell.Resize(1, 20).Merge\nEnd Sub\n</code></pre>\n\n<p>Try the above code. I have changed \"ActiveCell.Resize(1, 20).Merge\" line only.</p>\n"}], "owner": {"reputation": 3, "user_id": 11472689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7bbf7161b52264e43b661f9a61bcbf?s=128&d=identicon&r=PG&f=1", "display_name": "falcon771", "link": "https://stackoverflow.com/users/11472689/falcon771"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 56050655, "answer_count": 1, "score": 0, "last_activity_date": 1557361924, "creation_date": 1557357272, "question_id": 56050205, "link": "https://stackoverflow.com/questions/56050205/vba-find-first-empty-cell-and-input-text", "title": "VBA Find First Empty Cell and Input Text", "body": "<p>I publish a simple price list. Now I need to add 'notes' at the end, after the last entry. The cell with the note will rarely be the same since we are constantly adding and removing product. I would also like to merge all the cells in that row, so when I AutoFit the formatting will not be lost.</p>\n\n<pre><code>Sub Append Notes to last page()\n    Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    ActiveCell.Value = \"*Logo Quantity - Some items may be combined. See Account Manager.\"\n    ActiveCell.Resize(1, 20).MergeCells\nEnd Sub\n</code></pre>\n\n<p>I expected this to just go to the end of the pricelist and find the first blank cell in column A and paste the text, then merge the row of cells.</p>\n\n<p>I appreciate any insight or assistance.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "edited": false, "score": 0, "creation_date": 1557411370, "post_id": 56049714, "comment_id": 98763043, "body": "The &lt;br&gt; works for creating new empty lines - thank you! Is there a way to format the line spacing of the bullet pointed items created in the for loop? E.g. set spacing before and after = 0 pt instead of auto?"}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 1, "last_activity_date": 1557353625, "creation_date": 1557353625, "answer_id": 56049714, "question_id": 56049674, "link": "https://stackoverflow.com/questions/56049674/how-to-add-or-remove-spaces-between-lines-of-text-in-an-email/56049714#56049714", "title": "How to add or remove spaces between lines of text in an email?", "body": "<p>perhaps use a line break element (<code>br</code>)?</p>\n\n<pre><code>Line 1&lt;br&gt;\nLine 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "edited": false, "score": 0, "creation_date": 1557410014, "post_id": 56049872, "comment_id": 98762233, "body": "The &lt;br&gt; works for creating new empty lines - thank you!  Is there a way to format the line spacing of the bullet pointed items created in the for loop?  E.g. set spacing before and after = 0 pt instead of auto?"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "reply_to_user": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "edited": false, "score": 0, "creation_date": 1557416918, "post_id": 56049872, "comment_id": 98766454, "body": "this is a good source for html bullets and line spacing, which method is included in my answer above.  <a href=\"https://litmus.com/community/discussions/1093-bulletproof-lists-using-ul-and-li\" rel=\"nofollow noreferrer\">litmus.com/community/discussions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": true, "score": 0, "last_activity_date": 1557354602, "creation_date": 1557354602, "answer_id": 56049872, "question_id": 56049674, "link": "https://stackoverflow.com/questions/56049674/how-to-add-or-remove-spaces-between-lines-of-text-in-an-email/56049872#56049872", "title": "How to add or remove spaces between lines of text in an email?", "body": "<p>This should do what you're looking for:</p>\n\n<pre><code>Sub Email_Budget()\n\n   Dim objOutlook As Object\n   Set objOutlook = CreateObject(\"Outlook.Application\")\n\n   Dim objEmail As Object\n   Set objEmail = objOutlook.CreateItem(olMailItem)\n\n   Dim CaseCount As Long\n   CaseCount = WorksheetFunction.CountA(Range(\"B6:B500\"))\n   'Debug.Print CaseCount\n\n   Dim i As Integer\n\n   With objEmail\n      .To = \"abc@xyz.com\"\n      .Subject = \"TEST1: May 2019 Budget\"\n      .HTMLBody = \"Karen,&lt;br&gt;&lt;br&gt;\"\n      .HTMLBody = .HTMLBody &amp; \"The potential \" &amp; MonthName(Month(ActiveSheet.Range(\"A2\"))) &amp; \" invoices are below.&lt;br&gt;\"\n      For i = 1 To CaseCount\n        If ActiveSheet.Cells(i + 5, 4).Value = \"Yes\" Then\n            .HTMLBody = .HTMLBody &amp; Application.Trim(\"&lt;ul style='list-style-type:disc;'&gt;&lt;li style=\"\"Margin: 0;\"\"&gt;\" &amp; ActiveSheet.Cells(i + 5, 2).Value &amp; \" - \" &amp; Format(ActiveSheet.Cells(i + 5, 6).Value, \"Currency\") &amp; \" (\" &amp; Format(ActiveSheet.Cells(i + 5, 8).Value, \"Currency\") &amp; \" without budget or invoicing).&lt;/li&gt;&lt;ul style = 'list-style-type:circle;'&gt;&lt;li style=\"\"Margin: 0;\"\"&gt;Last billed \" &amp; ActiveSheet.Cells(i + 5, 10) &amp; \".&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;\")\n        End If\n      Next i\n      .HTMLBody = .HTMLBody &amp; \"&lt;br&gt;Thank you,&lt;br&gt;Kurt\"\n      .Display\n   End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1128, "favorite_count": 0, "accepted_answer_id": 56049872, "answer_count": 2, "score": 0, "last_activity_date": 1608480991, "creation_date": 1557353353, "last_edit_date": 1608480991, "question_id": 56049674, "link": "https://stackoverflow.com/questions/56049674/how-to-add-or-remove-spaces-between-lines-of-text-in-an-email", "title": "How to add or remove spaces between lines of text in an email?", "body": "<p>I create an Outlook email and I want to add or remove spaces between paragraphs.</p>\n<p>I tried using vbNewLine as well as &quot; &quot; but neither make an empty line.</p>\n<p>Additionally, there is a large space after each bullet point for sentences created by my for loop. It is not an empty line, but rather the spacing Before and After the sentence (looking at the Paragraph menu) is set to &quot;Auto&quot; and I would like both to be &quot;0&quot;.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Email_Budget()\n   \n    Dim objOutlook As Object\n    Set objOutlook = CreateObject(&quot;Outlook.Application&quot;)\n   \n    Dim objEmail As Object\n    Set objEmail = objOutlook.CreateItem(olMailItem)\n   \n    Dim CaseCount As Long\n    CaseCount = WorksheetFunction.CountA(Range(&quot;B6:B500&quot;))\n    'Debug.Print CaseCount\n   \n    Dim i As Integer\n   \n    With objEmail\n        .To = &quot;abc@xyz.com&quot;\n        .Subject = &quot;TEST1: May 2019 Budget&quot;\n        .HTMLBody = &quot;Karen,&quot;\n        .HTMLBody = .HTMLBody &amp; vbNewLine\n\n        .HTMLBody = .HTMLBody &amp; &quot;The potential &quot; &amp; _\n          MonthName(Month(ActiveSheet.Range(&quot;A2&quot;))) &amp; &quot; invoices are below.&quot;\n\n        .HTMLBody = .HTMLBody &amp; vbNewLine\n        For i = 1 To CaseCount\n            If ActiveSheet.Cells(i + 5, 4).Value = &quot;Yes&quot; Then\n                .HTMLBody = .HTMLBody &amp; &quot;&lt;ul style='list-style-type:disc;'&gt;&quot; &amp; &quot;&lt;li&gt;&quot; &amp; _\n                  ActiveSheet.Cells(i + 5, 2).Value &amp; &quot; - &quot; &amp; _\n                  Format(ActiveSheet.Cells(i + 5, 6).Value, &quot;Currency&quot;) &amp; _\n                  &quot; (&quot; &amp; Format(ActiveSheet.Cells(i + 5, 8).Value, &quot;Currency&quot;) &amp; _\n                  &quot; without budget or invoicing).&quot; &amp; &quot;&lt;/li&gt;&quot; &amp; _\n                  &quot;&lt;ul style = 'list-style-type:circle;'&gt;&quot; &amp; &quot;&lt;li&gt;&quot; &amp; &quot;Last billed &quot; &amp; _\n                  ActiveSheet.Cells(i + 5, 10) &amp; &quot;.&quot; &amp; &quot;&lt;/li&gt;&quot; &amp; &quot;&lt;/ul&gt;&quot; &amp; &quot;&lt;/ul&gt;&quot;\n            End If\n        Next i\n        .HTMLBody = .HTMLBody &amp; vbNewLine\n        .HTMLBody = .HTMLBody &amp; vbNewLine\n        .HTMLBody = .HTMLBody &amp; &quot;Thank you,&quot;\n        .HTMLBody = .HTMLBody &amp; vbNewLine\n        .HTMLBody = .HTMLBody &amp; &quot;Kurt&quot;\n        .Display\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "angularjs", "vba", "getelementsbyname"], "comments": [{"owner": {"reputation": 1282, "user_id": 5842628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5115f168f54fb2bc2a86b5803acd7e18?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Hamel", "link": "https://stackoverflow.com/users/5842628/jonathan-hamel"}, "edited": false, "score": 1, "creation_date": 1557357752, "post_id": 56049534, "comment_id": 98741782, "body": "You should not be accessing DOM elements directly when using angular, but rather the underlying <code>model</code> to which your controls are bound to."}, {"owner": {"reputation": 46815, "user_id": 5535245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnjcO.jpg?s=128&g=1", "display_name": "georgeawg", "link": "https://stackoverflow.com/users/5535245/georgeawg"}, "edited": false, "score": 0, "creation_date": 1557380715, "post_id": 56049534, "comment_id": 98746569, "body": "The <code>ng-model</code> directive listens for a <code>&#39;change&#39;</code> event before updating scope with a new <code>input.value</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557383547, "post_id": 56049534, "comment_id": 98747685, "body": "please supply an example angularjs page that demonstrates this problem."}, {"owner": {"reputation": 1, "user_id": 10138698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q9umVC2wMVY/AAAAAAAAAAI/AAAAAAAADS0/BSXtEntTc5w/photo.jpg?sz=128", "display_name": "bbanexplores", "link": "https://stackoverflow.com/users/10138698/bbanexplores"}, "edited": false, "score": 0, "creation_date": 1557401205, "post_id": 56049534, "comment_id": 98757157, "body": "Yes makes sense so in this case, it will be either the model=&#39;login.user&#39;, but how do I access the underlying model? Please pardon my lack of knowledge regarding angular. Could you please share some kind of an example code that might demonstrate how the model can be accessed instead of the DOM element?"}, {"owner": {"reputation": 1, "user_id": 10138698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q9umVC2wMVY/AAAAAAAAAAI/AAAAAAAADS0/BSXtEntTc5w/photo.jpg?sz=128", "display_name": "bbanexplores", "link": "https://stackoverflow.com/users/10138698/bbanexplores"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557401387, "post_id": 56049534, "comment_id": 98757273, "body": "@QHarr, I can try to send a sceencap of the entire page but will be difficult to provide more details as this page/portal is on a client network and I can&#39;t bring it over to my laptop to share here."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557402783, "post_id": 56049534, "comment_id": 98758079, "body": "Does your code populate the input box initially?"}, {"owner": {"reputation": 1, "user_id": 10138698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q9umVC2wMVY/AAAAAAAAAAI/AAAAAAAADS0/BSXtEntTc5w/photo.jpg?sz=128", "display_name": "bbanexplores", "link": "https://stackoverflow.com/users/10138698/bbanexplores"}, "edited": false, "score": 0, "creation_date": 1557411943, "post_id": 56049534, "comment_id": 98763403, "body": "The code is not able to even read/access the login and password form fields. Populating the fields is the goal. If we are able to extract the form fields, we can then assign a predefined username/password and then populate the fields and click the enter button to login. But the first step is to access those form fields - which is where I am stuck"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557412365, "post_id": 56049534, "comment_id": 98763673, "body": "Did you try ie.document.querySelector(&quot;[label*=&#39;User Name&#39;] input&quot;).value = &quot;xyz&quot;"}, {"owner": {"reputation": 1, "user_id": 10138698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q9umVC2wMVY/AAAAAAAAAAI/AAAAAAAADS0/BSXtEntTc5w/photo.jpg?sz=128", "display_name": "bbanexplores", "link": "https://stackoverflow.com/users/10138698/bbanexplores"}, "edited": false, "score": 0, "creation_date": 1557424344, "post_id": 56049534, "comment_id": 98769951, "body": "I get this error message: Method &#39;querySelector&#39; of object &#39;JScriptTypeInfo&#39; failed"}], "owner": {"reputation": 1, "user_id": 10138698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q9umVC2wMVY/AAAAAAAAAAI/AAAAAAAADS0/BSXtEntTc5w/photo.jpg?sz=128", "display_name": "bbanexplores", "link": "https://stackoverflow.com/users/10138698/bbanexplores"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557380405, "creation_date": 1557352410, "last_edit_date": 1557380405, "question_id": 56049534, "link": "https://stackoverflow.com/questions/56049534/how-to-extract-form-fields-using-getelementby-without-having-any-of-the-attribut", "title": "How to extract Form fields using getElementBy without having any of the attributes present in the &lt;input&gt; tag", "body": "<p>I am trying to use the ie.document.getElementById method in a VBA script to access html form elements such as Username and Password fields. This method works on an html page, but does not on an angularJS page. I am trying to figure out what needs to be changed to work with the angularJS page.</p>\n\n<p>from a simple html login page, I can use this code and it works perfectly. I am able to assign the username and password values from a previous variable.</p>\n\n<pre><code>---------------------VBA code-----------------------\n    set ie = CreateObject(\"internetexplorer.application\")\n    With ie\n     .Visible = True\n     .navigate \"https://signin.lexisnexis.com\"\n    DoEvents\n     Loop\n       Set user = ie.document.getElementById(\"userid\")\n          user.Value = Username\n       Set pw = ie.document.getElementById(\"password\")\n          pw.Value = Password\n---------------------------------------------------\n</code></pre>\n\n<p>The page for the above code has this as the <code>&lt;input&gt;</code> tag:</p>\n\n<pre><code>&lt;label for=\"userid\" style=\"padding-top:20px;\"&gt; \n   ID &lt;span class=\"error\"&gt;Please enter a valid ID.&lt;/span&gt;\n   &lt;input type=\"text\" name=\"userid\" id=\"userid\" class=\"major\"\n          onblur=\"this.value=trim(this.value)\"&gt;\n   &lt;span class=\"error icon la-Warning\"&gt;&lt;/span&gt;\n&lt;/label&gt;\n</code></pre>\n\n<p>But I am trying to do the exact same thing but on a login page which is built using angularJS:\n<a href=\"https://i.stack.imgur.com/4AQxQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4AQxQ.jpg\" alt=\"helper image\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1557350808, "post_id": 56049197, "comment_id": 98739948, "body": "Something like <code>If indRefColor = cellCurrent.Font.Color and cellCurrent.value = ??? Then</code> where <code>???</code> is whatever value or string you want"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1557351003, "post_id": 56049197, "comment_id": 98740026, "body": "sigh. Life would be so much easier if people stopped manually color coding Excel cells. You can use the logic that goes on in your head to create conditional formatting. You can use the same logic to use formulas to summarise the data, then you don&#39;t need VBA at all. So, what inner rules do you follow to determine if a test has passed? That can be expressed as a formula."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1557404154, "post_id": 56049197, "comment_id": 98758839, "body": "Conditional Formatting"}], "owner": {"reputation": 1, "user_id": 10235860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b86c91ec311adf8fa61e43433210067?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt N Meli Alaybeyoglu", "link": "https://stackoverflow.com/users/10235860/kurt-n-meli-alaybeyoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557350611, "creation_date": 1557350383, "last_edit_date": 1557350611, "question_id": 56049197, "link": "https://stackoverflow.com/questions/56049197/countif-by-color-and-by-cell-value", "title": "CountIF by Color AND by Cell Value", "body": "<p>I will start by saying while I have some basic coding knowledge, I know nothing about VBA and it looks so different from other languages I've seen and used that it might as well be alien to me.</p>\n\n<p>I have a table of values in Excel that represent the impact of a test I've run (ranging from 1-12).</p>\n\n<p>In order for me to visually determine whether the test passed or not, I've highlighted the cells GREEN or RED. I had hoped that I could do some sort of Boolean AND to combine counting based on the value of the cells and it's background color. While I've found a few different functions already written for just counting by background color, I could not figure out how to modify them to also include an additional variable for the cell value. </p>\n\n<p>EXAMPLE CODE:</p>\n\n<pre><code>Function CountCellsByFontColor(rData As Range, cellRefColor As Range) As Long\n    Dim indRefColor As Long\n    Dim cellCurrent As Range\n    Dim cntRes As Long\n\n    Application.Volatile\n    cntRes = 0\n    indRefColor = cellRefColor.Cells(1, 1).Font.Color\n    For Each cellCurrent In rData\n        If indRefColor = cellCurrent.Font.Color Then\n            cntRes = cntRes + 1\n        End If\n    Next cellCurrent\n\n    CountCellsByFontColor = cntRes\nEnd Function\n</code></pre>\n\n<p>How do I modify the above to include an additional variable to match the value of the cell?</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 1, "creation_date": 1557353074, "post_id": 56049188, "comment_id": 98740667, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/70947/refreshing-all-the-pivot-tables-in-my-excel-workbook-with-a-macro\" title=\"refreshing all the pivot tables in my excel workbook with a macro\">stackoverflow.com/questions/70947/&hellip;</a>"}], "owner": {"reputation": 49, "user_id": 11049128, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156252663502686/picture?type=large", "display_name": "Shobi", "link": "https://stackoverflow.com/users/11049128/shobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1824, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557382367, "creation_date": 1557350304, "last_edit_date": 1557382367, "question_id": 56049188, "link": "https://stackoverflow.com/questions/56049188/need-to-change-data-source-for-all-pivot-tables-in-multiple-sheets", "title": "Need to change data source for all pivot tables in multiple sheets", "body": "<p>I have multiple pivot tables on 5 sheets named in the code. Data source for all of them is \"CUIC data\", which i update daily. </p>\n\n<p>I want to change the data source and refresh all the pivot tables in all of my worksheets. The code i have works for one sheet, but i dont know how to get it done for multiple pivot tables. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'PURPOSE: Automatically readjust a Pivot Table's data source range\n\nDim Data_sht As Worksheet\nDim Pivot_sht As Worksheet\nDim StartPoint As Range\nDim DataRange As Range\nDim PivotName As String\nDim NewRange As String\n\n'Set Variables Equal to Data Sheet and Pivot Sheet\n  Set Data_sht = ThisWorkbook.Worksheets(\"CUIC data\")\n  Set Pivot_sht = ThisWorkbook.Worksheets(\"Agent,Projections,Supervisor,Platinum Club - MTD,Platinum Club - YTD\")\n\n\n'Enter in Pivot Table Name\n  PivotName = (\"Projections,Supervisor,Agent,mtd,ytd\")\n\n\n'Dynamically Retrieve Range Address of Data\n  Set StartPoint = Data_sht.Range(\"A1\")\n  Set DataRange = Data_sht.Range(StartPoint, StartPoint.SpecialCells(xlLastCell))\n\n  NewRange = Data_sht.Name &amp; \"!\" &amp; _\n    DataRange.Address(ReferenceStyle:=xlR1C1)\n\n'Make sure every column in data set has a heading and is not blank (error prevention)\n  If WorksheetFunction.CountBlank(DataRange.Rows(1)) &gt; 0 Then\n    MsgBox \"One of your data columns has a blank heading.\" &amp; vbNewLine _\n      &amp; \"Please fix and re-run!.\", vbCritical, \"Column Heading Missing!\"\n    Exit Sub\n  End If\n\n'Change Pivot Table Data Source Range Address\n  Pivot_sht.PivotTables(PivotName).ChangePivotCache _\n    ThisWorkbook.PivotCaches.Create(xlDatabase, SourceData:=NewRange)\n\n\n\n'Ensure Pivot Table is Refreshed\n  Pivot_sht.PivotTables(PivotName).RefreshTable\n\n'Complete Message\n  MsgBox PivotName &amp; \"'s data source range has been successfully updated!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1557356402, "last_edit_date": 1557356402, "creation_date": 1557353101, "answer_id": 56049639, "question_id": 56049109, "link": "https://stackoverflow.com/questions/56049109/vba-sql-query-to-a-range/56049639#56049639", "title": "VBA SQL query to a range", "body": "<p>You can update your function parameter list to include an optional <code>Range</code>-type parameter:</p>\n\n<pre><code>Private Function sqlQuery(ByVal CadenaCnx As String, ByVal Consulta As String, _\n                          ByVal Tipo As TipoConsulta, _\n                          Optional rng As Range = Nothing) As Variant\n\n     'dump result to rng if needed\n\n\nEnd With\n</code></pre>\n\n<p>And then call like this:</p>\n\n<pre><code>sqlQuery \"DSN = myODBC;\", \"SELECT * FROM Table1\", TodaLaConsulta, Range(\"A1\")\n</code></pre>\n\n<p>************ original answer (I was looking at GetRows) *******</p>\n\n<p><code>GetRows</code> returns a 2-D array, so you should be able to do something like </p>\n\n<pre><code>Dim res \n\nres = sqlQuery (\"DSN = myODBC;\", \"SELECT * FROM Table1\", TodaLaConsulta)\n\nRange(\"A1\").Resize(ubound(res,1) + 1, ubound(res,2) + 1).Value = res\n</code></pre>\n\n<p>but I don't think you can do it in a single line, since you need to resize the destination range, and to do that you need the size of the result array.</p>\n\n<p>Note that GetRows returns an array which is [column, row], so you might need to transpose that before putting it on the worksheet.</p>\n"}], "owner": {"reputation": 19, "user_id": 11472291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276c6d0c9f0577ce7dfc3900453e87ba?s=128&d=identicon&r=PG&f=1", "display_name": "aronsini", "link": "https://stackoverflow.com/users/11472291/aronsini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 56049639, "answer_count": 1, "score": 0, "last_activity_date": 1557382345, "creation_date": 1557349890, "last_edit_date": 1557382345, "question_id": 56049109, "link": "https://stackoverflow.com/questions/56049109/vba-sql-query-to-a-range", "title": "VBA SQL query to a range", "body": "<p>I want the resulting query to my destiny range without define it in my function, I mean... can I call the destiny range?</p>\n\n<p>Hello, I want to make a query to sql without needing to define a range within the parameters of the function, that is:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Range (\"A1\") = sqlQuery (\"DSN = myODBC;\", \"SELECT * FROM Table1\", TodaLaConsulta)\n</code></pre>\n\n<p>When executing this line I only load one record from that range and I want the whole table, the code is:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Enum TipoConsulta\n    SoloUnRegistro = 1\n    TodaLaConsulta = 2\n    EjecutarQuery = 3\n    GuardarArray = 4\nEnd Enum\n\nPrivate Function sqlQuery(ByVal CadenaCnx As String, ByVal Consulta As String, ByVal Tipo As TipoConsulta) As Variant\n\n    Dim Cnx As New ADODB.Connection   'Connection\n    Dim RecSet As New ADODB.Recordset   'Recordset\n\n    Cnx.Open CadenaCnx\n\n    Select Case Tipo\n        Case TipoConsulta.SoloUnRegistro\n\n            RecSet.Open Consulta, Cnx\n            sqlQuery = RecSet(0)    'JUST ONE RECORD\n\n        Case TipoConsulta.TodaLaConsulta\n            RecSet.Open Consulta, Cnx\n            'HERE I WANT THE RESULTING QUERY TO MY DESTINY RANGE WITHOUT DEFINE IT IN MY FUNCTION, I MEAN... CAN I CALL THE DESTINY RANGE??\n            Range.CopyFromRecordset RecSet\n\n        Case TipoConsulta.EjecutarQuery\n            Cnx.Execute Consulta    'EXECUTE\n\n        Case TipoConsulta.GuardarArray\n            RecSet.Open Consulta, Cnx   'TO ARRAY\n            sqlQuery = RecSet.GetRows\n\n    End Select\n\n    RecSet.Close\n    Cnx.Close\n\n    Set RecSet = Nothing\n    Set Cnx = Nothing    \n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "subroutine"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1557350100, "post_id": 56049079, "comment_id": 98739695, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/how-to/set-and-clear-a-breakpoint\" rel=\"nofollow noreferrer\">Put a breakpoint</a> on the <code>metric_transfer</code> line. When it is hit, keep pressing F8."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1557351007, "post_id": 56049079, "comment_id": 98740027, "body": "<code>Call</code> is useless. Put <code>Option Explicit</code> at the top of the module. If the code doesn&#39;t compile anymore, there&#39;s a typo somewhere. Where are the procedures located? Can you <a href=\"https://stackoverflow.com/posts/56049079/edit\">edit</a> your post to include them?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1557352247, "post_id": 56049079, "comment_id": 98740433, "body": "For how you describe it, it seems like the code in the procedure <code>new_tab</code> does something that invalidates what the sub <code>metric_transfer</code> is supposed to do. You should probably debug step by step the code in <code>new_tab</code> and see what happens that make your code crash/exiting. Also, by the name of the sub <code>new_tab</code>, something tells me you&#39;re adding a new sheet to your workbook... is it maybe that <code>metric_transfer</code>&#39;s code doesn&#39;t work when the focus is on this new sheet? Please share the code inside <code>new_tab</code> to give us more clue."}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 2, "creation_date": 1557353198, "post_id": 56049079, "comment_id": 98740698, "body": "post the code for new_tab and metric_transfer"}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557408702, "post_id": 56049079, "comment_id": 98761466, "body": "Thanks for the tip @GSerg. I was using <code>Debug.Print</code> for this but this approach is far more succinct."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557409091, "post_id": 56049079, "comment_id": 98761697, "body": "Thanks @Mathieu. Option Explicit is at the top of the userform and I have enabled by default."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1557410083, "post_id": 56049079, "comment_id": 98762279, "body": "Thanks @Matteo. I had debugged it but it wasn&#39;t crashing so much as ignoring the second sub. <code>new_tab</code> was indeed doing something to invalidate the sub <code>metric_transfer</code>. Apparently, having <code>Unload Me</code> in <code>new_tab</code> caused it to skip the sub. I&#39;m not clear why but will post an answer as soon as I figure it out."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557411394, "post_id": 56049079, "comment_id": 98763060, "body": "Sounds good, but we can&#39;t see your code and there&#39;s not enough of it in the post for anyone to do anything more than try to guess what&#39;s going on. Please <a href=\"https://stackoverflow.com/posts/56049079/edit\">edit</a> your post to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1557412508, "post_id": 56049079, "comment_id": 98763763, "body": "<i>&quot;Apparently, having <code>Unload Me</code> in <code>new_tab</code> caused it to skip the sub&quot;</i>. Well, of course! If you read the documentation, you can see that <i>When an object is unloaded, it&#39;s removed from memory and all memory associated with the object is reclaimed</i>. Your macro <code>OKCommand_Click</code> is part of the userform, so if you <code>Unload</code> the user form, the memory is released and the execution of <code>OKCommand_Click</code> is stopped (that&#39;s why you never execute the second one)."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "is_accepted": true, "score": 0, "last_activity_date": 1557413201, "last_edit_date": 1557413201, "creation_date": 1557412532, "answer_id": 56061826, "question_id": 56049079, "link": "https://stackoverflow.com/questions/56049079/sub-calls-first-sub-but-does-not-call-second-sub/56061826#56061826", "title": "Sub calls First Sub but does not call second sub", "body": "<p>Many thanks to @Matteo for pointing me in the right direction. The problem that I encountered was the result of an <code>Unload Me</code> line in the <code>new_tab</code> sub. All of these procedures were on the user form. When <code>Unload Me</code> executed, it wiped the userform from memory as described <a href=\"https://www.thoughtco.com/difference-between-form1hide-and-unload-me-3424279\" rel=\"nofollow noreferrer\">here</a>. It appears that hiding the form would have been the better option with <code>form1.Hide</code>. Not only because of the issues this caused here but also because I would need information from this form at a later point. </p>\n"}], "owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 56061826, "answer_count": 1, "score": -1, "last_activity_date": 1557413201, "creation_date": 1557349708, "question_id": 56049079, "link": "https://stackoverflow.com/questions/56049079/sub-calls-first-sub-but-does-not-call-second-sub", "title": "Sub calls First Sub but does not call second sub", "body": "<p>I am trying to have a sub run a series of other subs but am not having much luck. The Sub looks like this:</p>\n\n<pre><code>Private Sub OKCommand_Click()\n\nnew_tab\nmetric_transfer\n\nEnd Sub\n</code></pre>\n\n<p>When I comment out the first sub, the second sub runs. I put in Debug.Print comments above and below the second sub and watched it run right over the sub without calling it. I tried putting <code>Call</code> and <code>Application.Run</code> in front but the former did nothing and the latter was the wrong approach. My example follows <a href=\"https://stackoverflow.com/questions/47908468/macro-for-excel-vba-will-not-run-second-sub-in-same-module\">this</a> but it is unclear if the matter was ever resolved in that case. I didn't try <a href=\"https://www.mrexcel.com/forum/excel-questions/773914-vba-main-only-runs-first-sub.html\" rel=\"nofollow noreferrer\">this</a> delay technique as it didn't appear to work for them either. Any help would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 0, "creation_date": 1557350162, "post_id": 56049053, "comment_id": 98739713, "body": "But I don&#39;t want to format it the same for every page.  So for instance, the first 9 pages that print out will have 4 total preceding zero&#39;s, and that will remain true if the user chooses to print out 10 pages, however that 10th page will only have 3 preceding zero&#39;s.  My goal is to ensure that ultimately the number being printed remains a total of 15 characters including my prefix regardless of how many pages the user wants to print."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 0, "creation_date": 1557350478, "post_id": 56049053, "comment_id": 98739841, "body": "@TylerGarretson: That&#39;s exactly what format does - this one says &quot;It has to be 5 digits, and give me enough leading 0&#39;s&quot; - 1 = 00001, 20 = 00020, 300 = 00300, 4000=04000, etc."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 1, "creation_date": 1557350573, "post_id": 56049053, "comment_id": 98739876, "body": "@TylerGarretson to verify that this is true, you can put <code>? Format(1, &quot;00000&quot;)</code> and <code>? Format(1, &quot;00000&quot;)</code> in the Immediate Window."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 0, "creation_date": 1557351757, "post_id": 56049053, "comment_id": 98740287, "body": "@TylerGarretson try <code>ActiveSheet.Range(&quot;C20&quot;).Value = &quot;C906BGM088&quot; &amp; Format$(I, &quot;00000&quot;)</code>. Also do you mean to overwrite <code>C20</code>, because that&#39;s what will happen with your code as is? And when trying the line above, you can get rid of the <code>ElseIf LabelCount &lt; 10</code> check."}, {"owner": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 0, "creation_date": 1557352403, "post_id": 56049053, "comment_id": 98740482, "body": "yes i want to overwrite C20 each time.  It seems as if the program will run for anything the users selects under 10.  However it seems to crash if I enter 10 or 11."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557353368, "post_id": 56049053, "comment_id": 98740755, "body": "Remove <code>On Error Resume Next</code>. What is the error you get, if any?"}, {"owner": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 0, "creation_date": 1557361204, "post_id": 56049053, "comment_id": 98742404, "body": "I figured it out.  I had an If statement that was only for the first 10 that I was overlooking.  This works like a charm now!  Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": true, "score": 2, "last_activity_date": 1557416314, "last_edit_date": 1557416314, "creation_date": 1557349555, "answer_id": 56049053, "question_id": 56048962, "link": "https://stackoverflow.com/questions/56048962/padding-zeros-while-printing-and-changing-values/56049053#56049053", "title": "Padding Zero&#39;s while printing and changing values", "body": "<p>You want the Format command - Format(1, \"00000\") = 00001  </p>\n\n<p>Format(123,\"00000\") = 00123</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 0, "creation_date": 1557351073, "post_id": 56049129, "comment_id": 98740059, "body": "I think you may be onto something but I&#39;m still stumbling.  I&#39;ve never padded anything before.  I&#39;ve added to my code the following:            If I &lt; 10 Then           ActiveSheet.Range(&quot;C20&quot;).Value = &quot;C906BGM0880&quot; &amp; Right(&quot;000&quot; &amp; I, 15)           ActiveSheet.PrintPreview           End If"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "edited": false, "score": 1, "creation_date": 1557352741, "post_id": 56049129, "comment_id": 98740581, "body": "No, I&#39;ve been using this construct for years, but just testing it does exactly the same as format - old habits die hard - think I&#39;ll upgrade and start using format myself :-)"}], "tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": false, "score": 0, "last_activity_date": 1557350621, "last_edit_date": 1557350621, "creation_date": 1557350021, "answer_id": 56049129, "question_id": 56048962, "link": "https://stackoverflow.com/questions/56048962/padding-zeros-while-printing-and-changing-values/56049129#56049129", "title": "Padding Zero&#39;s while printing and changing values", "body": "<p>' This might be the basis of what you need</p>\n\n<pre><code>for a = 1 to 1000\n   b = right(\"0000000000\" &amp; a,8)  ' B will always be 8 long and paaded left with 0's\nnext a\n</code></pre>\n\n<p>This works well with a text prefix too</p>\n\n<pre><code>for a = 1 to 1000\n   c = \"XYZ\" &amp; right(\"0000000000\" &amp; a,8)\nnext a\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9882554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160560717180551/picture?type=large", "display_name": "Tyler Garretson", "link": "https://stackoverflow.com/users/9882554/tyler-garretson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56049053, "answer_count": 2, "score": 0, "last_activity_date": 1557416314, "creation_date": 1557349033, "last_edit_date": 1557349241, "question_id": 56048962, "link": "https://stackoverflow.com/questions/56048962/padding-zeros-while-printing-and-changing-values", "title": "Padding Zero&#39;s while printing and changing values", "body": "<p>I'm new here but hope you all can help with a solution I'm working towards.  I'm working on an excel document and setting up a macro.  It works until I try to add some logic to pad a number with zero's.  </p>\n\n<p>I'm trying to pad zero's in a select cell where the labels are less than 10, then add my integer.  If the labels are greater than 9, I want to pad one less zero, likewise when they are greater than 99, one less from those with 10 or more.</p>\n\n<p>My program asks the user how many labels they wish to print (1-999).</p>\n\n<p>I've tried to add an IF statement within my <code>For I = 1 To LabelCount</code>:</p>\n\n<pre><code>    For I = 1 To LabelCount\n      If I &lt; 10 Then\n      ActiveSheet.Range(\"C20\").Value = \"C906BGM0880000\" &amp; I\n      ActiveSheet.PrintPreview\n      Else\n      ActiveSheet.Range(\"C20\").Value = \"C906BGM088000T\" &amp; I\n      ActiveSheet.PrintPreview\n      End If\n    Next\n</code></pre>\n\n<p>The above did not work.</p>\n\n<pre><code>Sub IncrementPrint()\n'updateby Tyler Garretson\n    Dim LabelCount As Variant\n    Dim xScreen As Boolean\n    Dim I As Long\n    On Error Resume Next\nLInput:\n    LabelCount = Application.InputBox(\"Please enter the number of copies you want to print:\")\n    If TypeName(LabelCount) = \"Boolean\" Then Exit Sub\n    If (ActiveSheet.Range(\"F11\").Value = \"\") Or (ActiveSheet.Range(\"F14\").Value = \"\") Or (ActiveSheet.Range(\"C18\").Value = \"\") Then\n        MsgBox \"Error Occurred.  Please enter values for Route, Stop, and Destination Name\", vbExclamation\n    ElseIf (LabelCount = \"\") Or (Not IsNumeric(LabelCount)) Or (LabelCount &lt; 1) Or (LabelCount &gt; 999) Then\n        MsgBox \"Error Occurred. Please enter 1 - 999\", vbExclamation\n    ElseIf LabelCount &lt; 10 Then\n        xScreen = Application.ScreenUpdating\n        Application.ScreenUpdating = False\n        For I = 1 To LabelCount\n          ActiveSheet.Range(\"C20\").Value = \"C906BGM0880000\" &amp; I\n          ActiveSheet.PrintPreview\n        Next\n\n        ActiveSheet.Range(\"C20\").ClearContents\n        Application.ScreenUpdating = xScreen\n    End If\nEnd Sub\n</code></pre>\n\n<p>User enters 11 labels that he or she wishes to print, the program prints out the following:</p>\n\n<pre><code>Label1: ABC00001\nLabel2: ABC00002\nLabel3: ABC00003\nLabel4: ABC00004\nLabel5: ABC00005\nLabel6: ABC00006\nLabel7: ABC00007\nLabel8: ABC00008\nLabel9: ABC00009\nLabel10: ABC00010\nLabel11: ABC00011\n</code></pre>\n"}, {"tags": ["excel", "vba", "cell", "target"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1557349080, "post_id": 56048951, "comment_id": 98739371, "body": "Is there a reason you can&#39;t use conditional formatting for this?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557349279, "post_id": 56048951, "comment_id": 98739442, "body": "<code>Select Case</code> perhaps - <code>Select Case Target.Address</code>, <code>Case &quot;$H$151&quot;, $H$154</code> and so on."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11472289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fs_7uQybON8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re0tp9crL91_SS863nayUoeUbBGXw/mo/photo.jpg?sz=128", "display_name": "Jonesy0712", "link": "https://stackoverflow.com/users/11472289/jonesy0712"}, "edited": false, "score": 0, "creation_date": 1557414947, "post_id": 56050643, "comment_id": 98765200, "body": "Wow works perfectly. Thank you so much for your help. I had been trying everything!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1557361767, "creation_date": 1557361767, "answer_id": 56050643, "question_id": 56048951, "link": "https://stackoverflow.com/questions/56048951/how-to-use-vba-to-format-cells-based-on-value-of-any-of-the-specified-cells/56050643#56050643", "title": "How to use VBA to format cells based on value of ANY of the specified cells?", "body": "<p>Tested:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng As Range, c As Range, blnk As Boolean\n\n    'any changed cells in the range of interest?\n    'adjust range to suit...\n    Set rng = Application.Intersect(Target, _\n              Me.Range(\"H154,H151,E3,E9\"))\n\n    If Not rng Is Nothing Then\n        'check each changed cell\n        For Each c In rng\n            blnk = (Len(c.Value) = 0) 'is it empty ?\n            c.Interior.ColorIndex = IIf(blnk, 43, xlNone)\n            c.Borders.LineStyle = IIf(blnk, xlContinuous, xlLineStyleNone)\n            If blnk Then c.Borders.ColorIndex = 43\n        Next c\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11472289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fs_7uQybON8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re0tp9crL91_SS863nayUoeUbBGXw/mo/photo.jpg?sz=128", "display_name": "Jonesy0712", "link": "https://stackoverflow.com/users/11472289/jonesy0712"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557361767, "creation_date": 1557348992, "question_id": 56048951, "link": "https://stackoverflow.com/questions/56048951/how-to-use-vba-to-format-cells-based-on-value-of-any-of-the-specified-cells", "title": "How to use VBA to format cells based on value of ANY of the specified cells?", "body": "<p>New to VBA here. I'm trying to consolidate code and avoid copy/pasting a million times. Basically if specific cells (but not adjacent: eg, not in a column or range) are blank, then the cells are color filled with a color border. When data is entered into any cell, that particular cell removes any formatting. If the cell is blanked out, the formatting returns. The cells are all independent of each other; just formatting the cell being altered.</p>\n\n<p>Here is a sample from my redundant code, which works, but can there be a way to write it once and just identify the target cells in bulk, so to speak? Put \"H154\" and \"H151\" etc on one line?</p>\n\n<p>Thank you in advance.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address(False, False) = \"H154\" Then\n    If Target.Value &lt;&gt; \"\" Then\n        Target.Interior.ColorIndex = xlNone\n        Target.Borders.LineStyle = xlLineStyleNone\n        Else: Target.Interior.Color = RGB(226, 239, 218)\n         Target.Borders.LineStyle = xlContinuous\n         Target.Borders.ColorIndex = 43\n    End If\n End If\n\n  If Target.Address(False, False) = \"H151\" Then\n    If Target.Value &lt;&gt; \"\" Then\n        Target.Interior.ColorIndex = xlNone\n        Target.Borders.LineStyle = xlLineStyleNone\n        Else: Target.Interior.Color = RGB(226, 239, 218)\n         Target.Borders.LineStyle = xlContinuous\n         Target.Borders.ColorIndex = 43\n    End If\n End If\n\nIf Target.Address(False, False) = \"E3\" Then\nIf Target.Value &lt;&gt; \"\" Then\nTarget.Interior.ColorIndex = xlNone\nTarget.Borders.LineStyle = xlLineStyleNone\nTarget.Borders.ColorIndex = xlNone\nElse: Target.Interior.Color = RGB(226, 239, 218)\nTarget.Borders.LineStyle = xlContinuous\nTarget.Borders.ColorIndex = 43\n     End If\n  End If\n\n     If Target.Address(False, False) = \"E9\" Then\nIf Target.Value &lt;&gt; \"\" Then\nTarget.Interior.ColorIndex = xlNone\nTarget.Borders.LineStyle = xlLineStyleNone\nTarget.Borders.ColorIndex = xlNone\nElse: Target.Interior.Color = RGB(226, 239, 218)\nTarget.Borders.LineStyle = xlContinuous\nTarget.Borders.ColorIndex = 43\n     End If\n  End If\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "dialog"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1557361142, "post_id": 56048661, "comment_id": 98742393, "body": "<a href=\"https://stackoverflow.com/questions/10159216/whats-wrong-with-calling-application-getopenfilename-method-in-word-vba\" title=\"whats wrong with calling application getopenfilename method in word vba\">stackoverflow.com/questions/10159216/&hellip;</a> shows how to use <code>FileDialog</code>  - if you already tried that then it would be useful to post what you tried."}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558509283, "post_id": 56048661, "comment_id": 99119824, "body": "Thank you.  I guess I missed that one. :("}], "owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557421949, "creation_date": 1557347688, "last_edit_date": 1557421949, "question_id": 56048661, "link": "https://stackoverflow.com/questions/56048661/addition-of-dialog-boxes-for-file-open-and-file-save-as-after-text-replacement", "title": "Addition of Dialog Boxes for File Open and File Save As after Text Replacement", "body": "<p>I have a script that replaces delimiters in a file provided by an outside source.  The script works fine as is, but I'd like to add the ability to Select a file using a dialog, and save a file as something else using the save as dialog after the replacements are made.  </p>\n\n<p>I've tried a few different ways found here and in the MSDN documentation and the boxes open, however no data is replaced and no file is saved. Maybe I'm not wording my search correctly. I haven't used dialog boxes in the past :(</p>\n\n<pre><code>Sub RosterDelimiters_FindReplace()\n\nDim TextFile As Integer\nDim FilePath As String\nDim FileContent As String\n\n  FilePath = \"C:\\ReplaceText\\Roster.txt\"\n  TextFile = FreeFile\n  Open FilePath For Input As TextFile\n  FileContent = Input(LOF(TextFile), TextFile)\n  Close TextFile\n  FileContent = Replace(FileContent, \";+;\", \",\")\n  FileContent = Replace(FileContent, \";\", \",\")\n  TextFile = FreeFile\n  Open FilePath For Output As TextFile\n  Print #TextFile, FileContent\n  Close TextFile\n\nEnd Sub\n</code></pre>\n\n<p>Resulting actions preferred in pseudocode:</p>\n\n<pre><code>Sub\nDialog Box Opens\nTextFile is selected\nReplacements Run\nSave As Box Opens\nFile is Named and Saved Wherever\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 9897799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Bln6.jpg?s=128&g=1", "display_name": "Jugger", "link": "https://stackoverflow.com/users/9897799/jugger"}, "edited": false, "score": 0, "creation_date": 1557351671, "post_id": 56048920, "comment_id": 98740253, "body": "Thank you for your prompt answer, Teylyn. The code works perfectly, however, I did a small edit to make the sheet selectable by name as the workbook I&#39;ll integrate this into, has a lot of sheets and the log one is not 2nd (I&#39;m still at very beginning with VBA so I hope the edit is alright)."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 112, "user_id": 9897799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Bln6.jpg?s=128&g=1", "display_name": "Jugger", "link": "https://stackoverflow.com/users/9897799/jugger"}, "edited": false, "score": 0, "creation_date": 1557364968, "post_id": 56048920, "comment_id": 98743107, "body": "I added some code efficiencies and explanations to my answer."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1557364858, "last_edit_date": 1557364858, "creation_date": 1557348881, "answer_id": 56048920, "question_id": 56048638, "link": "https://stackoverflow.com/questions/56048638/log-date-time-in-sheet2-when-editing-a-cell-in-a-specified-range-in-she/56048920#56048920", "title": "Log date &amp; time [...] in sheet2, when editing a cell in a specified range in sheet1", "body": "<p>try this</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim WorkRng As Range\nDim rng As Range\nDim nextRow As Long\n\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"B2:K10\"), Target)\n\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each rng In WorkRng\n        If Not VBA.IsEmpty(rng.Value) Then\n            nextRow = Log.Cells(Rows.Count, 1).End(xlUp).Row + 1\n            Log.Cells(nextRow, 1) = Me.Cells(rng.Row, 1)\n            Log.Cells(nextRow, 2) = Me.Cells(1, rng.Column)\n            Log.Cells(nextRow, 3) = Now\n            Log.Cells(nextRow, 3).NumberFormat = \"dd-mm-yyyy, hh:mm:ss\"\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The code identifies the row number of the next empty row in Sheet 2, then writes the values into the first three cells of that row.</p>\n\n<p>Edit: After seeing your edits to the code: You don't need to go through the hassle of declaring a worksheet variable and then setting it to the sheet. Instead, use the <code>(Name)</code> property to give the sheet a name, then you can access it from anywhere in the code via this name. I adjusted the code to reflect this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7UEoT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7UEoT.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 112, "user_id": 9897799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Bln6.jpg?s=128&g=1", "display_name": "Jugger", "link": "https://stackoverflow.com/users/9897799/jugger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56048920, "answer_count": 1, "score": 0, "last_activity_date": 1557384377, "creation_date": 1557347590, "last_edit_date": 1557384377, "question_id": 56048638, "link": "https://stackoverflow.com/questions/56048638/log-date-time-in-sheet2-when-editing-a-cell-in-a-specified-range-in-she", "title": "Log date &amp; time [...] in sheet2, when editing a cell in a specified range in sheet1", "body": "<p>I have Sheet1 looking like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/QhFmp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QhFmp.jpg\" alt=\"https://i.imgur.com/4HUV6HI.jpg\"></a></p>\n\n<p>running this code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim WorkRng As Range\nDim rng As Range\nDim xOffsetColumn As Integer\n\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"B2:K10\"), Target)\nxOffsetColumn = 11\n\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each rng In WorkRng\n        If Not VBA.IsEmpty(rng.Value) Then\n            rng.Offset(0, xOffsetColumn).Value = Now\n            rng.Offset(0, xOffsetColumn).NumberFormat = \"dd-mm-yyyy, hh:mm:ss\"\n        Else\n            rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What it does so far:</p>\n\n<ul>\n<li>when I edit anything in range <code>B2:K10</code> it adds the date &amp; time on the right side of the table</li>\n</ul>\n\n<p>What I need:</p>\n\n<ul>\n<li>when I edit anything in the range specified above, log the date &amp; time plus the corresponding step &amp; item, all into <code>Sheet2</code> starting from <code>A2</code></li>\n</ul>\n\n<p>Expected result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wcEXH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wcEXH.jpg\" alt=\"https://i.imgur.com/0gpNbhi.jpg\"></a></p>\n\n<p>And keep adding below last row over and over, never erase a record if a value is deleted from a cell in <code>Sheet1</code>. Will delete records manually if needed.</p>\n"}, {"tags": ["excel", "vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11465852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049a31c2bc9b5ece5a5ae4b5d6ef868c?s=128&d=identicon&r=PG&f=1", "display_name": "Koce", "link": "https://stackoverflow.com/users/11465852/koce"}, "edited": false, "score": 0, "creation_date": 1557417422, "post_id": 56059805, "comment_id": 98766752, "body": "The Item method to the SettingControllers collection is available to me. For example, using:   Set att = CATIA.SettingControllers.Item(&quot;CATSamAnalysisGeneralSettingC&zwnj;&#8203;trl&quot;)  I am able to get the AnalysisGeneralSettingAtt SettingController.   The problem is that I don&#39;t know what to put as argument in the Item method in order to get the TreeTabSettingAtt SettingController. That is alright though because using the ProjectionMode property of the Viewpoint3D object does exactly what I need, as you have suggested. Thank you!"}], "tags": [], "owner": {"reputation": 81, "user_id": 11406592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7936eee7323219a1e5be7da54ce4089b?s=128&d=identicon&r=PG&f=1", "display_name": "Dewydd", "link": "https://stackoverflow.com/users/11406592/dewydd"}, "is_accepted": true, "score": 0, "last_activity_date": 1557407729, "last_edit_date": 1557407729, "creation_date": 1557406075, "answer_id": 56059805, "question_id": 56048634, "link": "https://stackoverflow.com/questions/56048634/how-to-change-render-style-in-catia-v5-through-excel-vba/56059805#56059805", "title": "How to change render style in CATIA V5 through Excel VBA?", "body": "<p>The property you've located seems bound to the application settings (i.e. the ones you change from Tools>Options..). I don't know how good they are exposed to automation but from a quick debug session, it was evident that with</p>\n\n<pre><code>Set att = CATIA.SettingControllers\n</code></pre>\n\n<p>one actually gets the collection, Count property is 70 in my case, but no Item method was available! This is inconsistent with the documentation. Note that the documentation reports that the argument must be an index in long format, but passed as a string.</p>\n\n<h1><strong>Answer:</strong></h1>\n\n<p>I have instead located the \"live setting\" which is bound to the Viewpoint3D object as follows. Note that either in CATScript or CATVBA you don't need to assign the Application object (CATIA object of class Application is always available):</p>\n\n<pre><code>Set view = CATIA.ActiveWindow.ActiveViewer.Viewpoint3D\nview.ProjectionMode = catProjectionCylindric\n'or\nview.ProjectionMode = catProjectionConic\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11465852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049a31c2bc9b5ece5a5ae4b5d6ef868c?s=128&d=identicon&r=PG&f=1", "display_name": "Koce", "link": "https://stackoverflow.com/users/11465852/koce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 56059805, "answer_count": 1, "score": 0, "last_activity_date": 1557407729, "creation_date": 1557347573, "last_edit_date": 1557381940, "question_id": 56048634, "link": "https://stackoverflow.com/questions/56048634/how-to-change-render-style-in-catia-v5-through-excel-vba", "title": "How to change render style in CATIA V5 through Excel VBA?", "body": "<p>I wrote a macro that saves an image from CATIA, using the CaptureToFile method in the Viewer object. The macro works great, but only when the Render Style is \"Parallel\". Some of the designers in my company do not have the Render Style to \"Parallel\", so I want to change the Render Style to \"Parallel\" with the macro. </p>\n\n<p>There is a property in the TreeTabSettingAtt object, called RenderStyle. The documentation says that the property \"Returns or sets the value to signify \nwhether the 3D Render Style is Parallel or Perspective\". It seems to be exactly what I need. To get to that property, I need to get to the TreeTabSettingAtt object, which seems to be a SettingController in the SettingControllers collection, but I can't get to it because I don't know its object type. The latter is needed to be passed as an argument of the Item method of the setting controller collection object. Unfortunately, the Item method only takes a string, which I don't know.</p>\n\n<pre><code>sub CATMain()\n\n    Dim catia as INFITF.Application\n    Dim att as PROCESSITF.TreeTabSettingAtt\n\n    Set catia = GetObject(, \"catia.Application\")\n\n    Set att = catia.SettingControllers.Item(\"I dont know the object type of \n    TreeTabSettingAtt\")\n\n    att.RenderStyle \"Parallel\"\n\nEnd Sub\n</code></pre>\n\n<p>In the documentation, seen in the following link, the setting controller object type of many setting controller objects are listed, but some are missing including the object type for the TreeTabSettingAtt setting controller object.\n<a href=\"https://www.maruf.ca/files/caadoc/CAAScdInfTechArticles/CAAInfTabPageList.htm\" rel=\"nofollow noreferrer\">https://www.maruf.ca/files/caadoc/CAAScdInfTechArticles/CAAInfTabPageList.htm</a></p>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1557347558, "post_id": 56048484, "comment_id": 98738748, "body": "Please indent code when posting."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557348504, "post_id": 56048484, "comment_id": 98739137, "body": "I have an <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">online indenter</a>, if it helps. (it&#39;s an open-source VBIDE add-in, so you can have the indenter tool in the VBE itself too)"}, {"owner": {"reputation": 2292, "user_id": 1415462, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cb8fa8a8438ef939e1710427a1c0ec?s=128&d=identicon&r=PG", "display_name": "Slothario", "link": "https://stackoverflow.com/users/1415462/slothario"}, "edited": false, "score": 1, "creation_date": 1557352814, "post_id": 56048484, "comment_id": 98740598, "body": "It would help to give examples of the spreadsheet data you&#39;re parsing through, and the first few lines of the text file you&#39;re searching."}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557380045, "post_id": 56048484, "comment_id": 98746367, "body": "Data from imported sql into workbook that requires a match"}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557380821, "post_id": 56048484, "comment_id": 98746624, "body": "Column A A40-034 A40-035 A40-032 A40-041 A40-042 A40-040 A40-005 A40-006 A40-016 A40-018 A40-019 A40-020 A40-024 A40-025 A40-027"}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557380938, "post_id": 56048484, "comment_id": 98746670, "body": "Column G AS55 S61 S61 S61 MI24 UH1 B06 NH90 NH90 NH90 NH90 NH90 NH90 NH90 NH90"}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557381250, "post_id": 56048484, "comment_id": 98746808, "body": "An example is search Col A:  A40-040 and Col G :  NH90 , look in comma delimited  text file 7CF896,A40-040,NH90 add first text 7CF896 to Column E"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557384666, "post_id": 56048484, "comment_id": 98748166, "body": "Please not that if you <code>Dim MReg, MType As String</code> only <code>MType</code> is of type <code>String</code> but <code>MReg</code> is of type <code>Variant</code> in VBA you need to specify a type for <b>every</b> variable <code>Dim MReg As String, MType As String</code> or it is automatically <code>Variant</code> (which is the worst choice). \u2022 Please also include your addional data in the question itself instead of multiple comments (so you can format and explain it better). Screenshots can help too."}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557474514, "post_id": 56048484, "comment_id": 98784798, "body": "Thanks I amended the code above , but it still runs to slow in excel. The main issue is if there is no match then it has to check each line of the 2 million rows of data. So when I am looping 2000 times , in excel it can take up to 30 mins to complete. Is there a way to do this in python. or a better way in excel"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557503568, "post_id": 56078255, "comment_id": 98800206, "body": "I tried the VBA code and it comes up with a Run-time error 9  for arrayToWriteToSheet(writeIndex, 1) = Left$(currentLineInCsv, indexOfFirstComma) this was from row 3336"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557505023, "post_id": 56078255, "comment_id": 98800868, "body": "@JohnD, sounds like <code>arrayToWriteToSheet</code> had 3336 rows, and now the code is trying to access the 3337th row -- which doesn&#39;t exist and so gives an error. I think if the CSV contains multiple matches for a given row, then all of those matches will be added to <code>arrayToWriteToSheet</code>. But the code expects no more than 1 match, which is why it&#39;s breaking."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557505183, "post_id": 56078255, "comment_id": 98800935, "body": "Also, I think that line should be: <code>arrayToWriteToSheet(writeIndex, 1) = Left$(currentLineInCsv, indexOfFirstComma - 1)</code>, otherwise it will include the comma (have changed my code to reflect this)."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557505291, "post_id": 56078255, "comment_id": 98800984, "body": "@JohnD, are you expecting the first match only, or do you want all matches? Hope my question makes sense"}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557521852, "post_id": 56078255, "comment_id": 98807748, "body": "There will be some occaisions when there is no match of data , is this what is causing the error"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557522980, "post_id": 56078255, "comment_id": 98808095, "body": "@JohnD, no, I think the problem is that some values in columns A and G match multiple lines in the CSV (but my code assumed there would be 0 or 1 match at most). You can check by putting something like <code>Debug.Assert writeIndex  &lt;= ubound(arrayToWriteToSheet, 1)</code> after this line <code>writeIndex = writeIndex + 1</code> and then seeing if the code&#39;s execution pauses on the newly added <code>Debug.Assert</code> line."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557523407, "post_id": 56078255, "comment_id": 98808201, "body": "If there are 0 matches, no value will be written to column E. If there is 1 match, 1 value will be written to column E. If there is more than 1 match, do you only want the first match -- or do you want all matches to be written to column E?"}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557574644, "post_id": 56078255, "comment_id": 98816476, "body": "it would be great if you could not add a value if there is more than 1 match"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557617465, "post_id": 56078255, "comment_id": 98826058, "body": "@JohnD, I&#39;ve re-written my answer. My previous code had a bug (<code>arrayToWriteToSheet</code> was declared incorrectly) and the procedure&#39;s overall logic was more inefficient than I thought (as I did not <code>Exit</code> the loop once a match was found)."}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557730867, "post_id": 56078255, "comment_id": 98848081, "body": "thanks it took only 35 seconds to run using your code. I am trying work out how your code works , as I am also looking to use another search by just one code in column A looking for a match in a text file , with two columns of data. seperated by a comma. first column has unique codes that need to be matched and when matched add value in column 2 of text file  to column E. Is this possible by adapting your code"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1557772408, "post_id": 56078255, "comment_id": 98869272, "body": "@JohnD, the code is somewhat specialised to perform the lookup you described in your original post, hence it&#39;s faster (since there is less indirection/abstraction) but the code is also less reusable. So performing a different lookup would probably require re-writing the code to be more dynamic/flexible -- which I can&#39;t do at the moment. Also, there may be faster ways of doing this. I think you&#39;re basically just doing a left outer join (in terms of SQL), with your columns in <code>Sheet6</code> forming the left table and the columns in the CSV forming the right table."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1557617293, "last_edit_date": 1557617293, "creation_date": 1557493225, "answer_id": 56078255, "question_id": 56048484, "link": "https://stackoverflow.com/questions/56048484/reading-large-text-file-freezes-excel-can-it-be-done-using-python/56078255#56078255", "title": "Reading large text file freezes Excel, can it be done using Python?", "body": "<p>Whether this approach works is based on whether all of the following are true:</p>\n\n<ul>\n<li>You can specify in advance which columns in your CSV correspond to columns A and G of <code>Sheet6</code></li>\n<li>You can specify in advance which column of your CSV you want to write to column E of <code>Sheet6</code></li>\n<li>None of the values themselves in your CSV contain any new line characters or commas.</li>\n</ul>\n\n<p>I hope that all makes sense. ^</p>\n\n<pre><code>Option Explicit\n\nConst CSV_FILE_PATH As String = \"T:\\Hex\\ModeS-Mil.txt\"\nConst FIRST_ROW_CONTAINING_DATA As Long = 2 ' Exclude header row'\n\nSub FillMTextFile()\n\n    Dim csvMap As Collection\n    Set csvMap = GetMapForCsv()\n\n    Dim lastRow As Long\n    lastRow = Sheet6.Cells(Sheet6.Rows.Count, \"A\").End(xlUp).Row\n    Debug.Assert lastRow &gt;= FIRST_ROW_CONTAINING_DATA\n\n    Dim substringsInColumnA() As Variant ' This needs a better name, especially if your columns change.'\n    substringsInColumnA = Sheet6.Range(\"A\" &amp; FIRST_ROW_CONTAINING_DATA, \"A\" &amp; lastRow).Value\n\n    Dim substringsInColumnG() As Variant ' This needs a better name, especially if your columns change.'\n    substringsInColumnG = Sheet6.Range(\"G\" &amp; FIRST_ROW_CONTAINING_DATA, \"G\" &amp; lastRow).Value\n\n    Dim outputRowCount As Long\n    outputRowCount = lastRow - FIRST_ROW_CONTAINING_DATA + 1\n\n    Dim arrayToWriteToSheet() As String\n    ReDim arrayToWriteToSheet(1 To outputRowCount, 1 To 1)\n    Debug.Assert LBound(arrayToWriteToSheet, 1) = LBound(substringsInColumnA, 1)\n\n    Dim rowIndex As Long\n    For rowIndex = LBound(substringsInColumnA, 1) To UBound(substringsInColumnA, 1)\n\n        Dim substringsToJoin(0 To 1) As String ' Static, re-use every iteration'\n        substringsToJoin(0) = UCase$(CStr(substringsInColumnA(rowIndex, 1)))\n        substringsToJoin(1) = UCase$(CStr(substringsInColumnG(rowIndex, 1)))\n\n        Dim substringToSearchFor As String\n        substringToSearchFor = Join$(substringsToJoin, \",\")\n\n        arrayToWriteToSheet(rowIndex, 1) = _\n            GetCollectionItemOrDefault(someCollection:=csvMap, someKey:=substringToSearchFor)\n\n    Next rowIndex\n\n    Sheet6.Cells(FIRST_ROW_CONTAINING_DATA, \"E\").Resize(UBound(arrayToWriteToSheet, 1), UBound(arrayToWriteToSheet, 2)) = arrayToWriteToSheet\nEnd Sub\n\nPrivate Function GetMapForCsv() As Collection\n    ' This function tries to take advantage of which columns '\n    ' in the CSV to look at -- and builds a collection in which: '\n    '   \u2022 each collection key = the concatenation of columns that need to contain matches '\n    '   \u2022 each collection item = the value that we later want to look up '\n\n    Const CSV_COLUMN_TO_WRITE_TO_COLUMN_E As Long = 1 ' First column'\n    Const CSV_COLUMN_CORRESPONDING_TO_COLUMN_A As Long = 2 ' Second column'\n    Const CSV_COLUMN_CORRESPONDING_TO_COLUMN_G As Long = 3 ' Third column'\n\n    Dim outputCollection As Collection\n    Set outputCollection = New Collection\n\n    Dim fileHandle As Long\n    fileHandle = FreeFile\n\n    Open CSV_FILE_PATH For Input As #fileHandle ' Open once outside of loop.'\n    Do Until EOF(fileHandle)\n\n        ' File is probably too large to fit in memory, hence iterating line by line'\n        ' but I think this assumes there are no escaped/quoted new line characters in the values themselves'\n        Dim currentLineInCsv As String\n        Line Input #fileHandle, currentLineInCsv\n        currentLineInCsv = UCase$(currentLineInCsv)\n\n        Dim currentValues() As String\n        currentValues = Split(currentLineInCsv, \",\", -1, vbBinaryCompare)\n\n        Dim toJoin(0 To 1) As String\n        toJoin(0) = currentValues(CSV_COLUMN_CORRESPONDING_TO_COLUMN_A - 1) ' 0-based array assumed'\n        toJoin(1) = currentValues(CSV_COLUMN_CORRESPONDING_TO_COLUMN_G - 1) ' 0-based array assumed'\n\n        Dim collectionKey As String\n        collectionKey = Join$(toJoin, \",\")\n\n        Dim collectionItem As String\n        collectionItem = currentValues(CSV_COLUMN_TO_WRITE_TO_COLUMN_E - 1) ' 0-based array assumed'\n\n        On Error Resume Next\n        outputCollection.Add Item:=collectionItem, key:=collectionKey\n        On Error GoTo 0\n    Loop\n    Close #fileHandle\n\n    Set GetMapForCsv = outputCollection\nEnd Function\n\nPrivate Function GetCollectionItemOrDefault(ByVal someCollection As Collection, ByVal someKey As String, Optional ByVal defaultValue As String = vbNullString) As String\n    ' Returns the item corresponding to some key of a collection'\n    ' If the key does not exist, returns the default.'\n\n    Dim keyDoesNotExist As Boolean\n    Dim itemToReturn As String\n\n    On Error Resume Next\n    itemToReturn = someCollection(someKey)\n    keyDoesNotExist = (Err.Number &lt;&gt; 0)\n    On Error GoTo 0\n\n    If keyDoesNotExist Then itemToReturn = defaultValue\n    GetCollectionItemOrDefault = itemToReturn\nEnd Function\n</code></pre>\n\n<p>Regarding implementation, you will need to change these lines (in the code for <code>GetMapForCsv</code> function):</p>\n\n<pre><code>Const CSV_COLUMN_TO_WRITE_TO_COLUMN_E As Long = 1 ' First column'\nConst CSV_COLUMN_CORRESPONDING_TO_COLUMN_A As Long = 2 ' Second column'\nConst CSV_COLUMN_CORRESPONDING_TO_COLUMN_G As Long = 3 ' Third column'\n</code></pre>\n\n<p>so that the assignments are true for your CSV. Currently, the above assignments assume that:</p>\n\n<ul>\n<li>the second column in your CSV corresponds to the values in <code>Sheet6</code>'s column A</li>\n<li>the third column in your CSV corresponds to the values in <code>Sheet6</code>'s column G</li>\n<li>you want to look up the values in the first column of your CSV and write them to <code>Sheet6</code>'s column E.</li>\n</ul>\n\n<p>My CSV contained only 3 columns, my <code>Sheet6</code> contained 10k values to look up; and on my machine the code above took:</p>\n\n<ul>\n<li>~195.6 seconds for 10 million rows in CSV</li>\n<li>~35.2 seconds for 2 million rows in CSV</li>\n</ul>\n\n<hr>\n\n<p>Alternative approaches might include:</p>\n\n<ul>\n<li><p>Using Python. It should be possible to use a generator expression to loop over the CSV file's 2 million rows in a memory-efficient manner. I think the built-in <code>csv</code> module could handle this task, but you might also need some Python module/library to interface with Excel e.g. <code>openpyxl</code>, <code>XlsxWriter</code> (so that you can read the values in columns A and G). The Python code would probably be much shorter/easier to maintain.</p></li>\n<li><p>Using Power Query (which is has been part of Excel on Windows for several years now). You could potentially read columns A and G into one table -- and the CSV into another table. The output would probably be loaded as a table to a worksheet. Not sure how performant/efficient it would be, but it might be worth setting up your data in a way that allows you to use <code>Table.Merge</code>. Otherwise, maybe you could fall back to <code>Text.Contains</code> or something.</p></li>\n</ul>\n"}], "owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1557617293, "creation_date": 1557346839, "last_edit_date": 1557399856, "question_id": 56048484, "link": "https://stackoverflow.com/questions/56048484/reading-large-text-file-freezes-excel-can-it-be-done-using-python", "title": "Reading large text file freezes Excel, can it be done using Python?", "body": "<p>I am importing data via a SQL import code through Excel VBA to <code>sheet6</code>. I am then looping through each row of the imported data looking for a match based on two criteria. Column A and column G value being present in a line from a large text file with 2 million lines of data. If a match is found then the first value from the comma delimited text file is added to column E. </p>\n\n<p>I have tried researching Excel VBA codes, but it is really slow when looping through 5000 rows of data. It can take up to 30 mins to run. Hoping that maybe a Python solution could be the answer.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Const strFileName = \"T:\\Hex\\ModeS-Mil.txt\"\n\nSub FillMTextFile()\nDim StartTime As Double\nDim SecondsElapsed As Double\nDim strsearch As String\nDim MReg As String\nDim MType As String\nDim strLine As String\nDim f As Integer\nDim lngLine As Long\nDim blnFound As Boolean\nDim x As Long\nDim lrow As Long\nlrow = Sheet6.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nStartTime = Timer\nFor x = 2 To 3000\nMReg = Sheet6.Range(\"A\" &amp; x).Value\nMType = Sheet6.Range(\"G\" &amp; x).Value\nstrsearch = MReg &amp; \",\" &amp; MType\nf = FreeFile\nOpen strFileName For Input As #f\nDo While Not EOF(f)\nlngLine = lngLine + 1\nLine Input #f, strLine\nIf InStr(1, strLine, strsearch, vbBinaryCompare) &gt; 0 Then\nSheet6.Range(\"E\" &amp; x).Value = UCase(Split(strLine, \",\")(0))\nOn Error GoTo err\nblnFound = True\nExit Do\nEnd If\nLoop\nClose #f\nIf Not blnFound Then\nEnd If\nerr:\nNext x\nSecondsElapsed = Round(Timer - StartTime, 2)\nMsgBox \"code time \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557345986, "post_id": 56048217, "comment_id": 98738060, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\">Test or check if sheet exists</a>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1557346528, "post_id": 56048217, "comment_id": 98738275, "body": "Not your answer, but instead of <code>w.Activate</code>, try using <code>With w</code>, and use <code>.</code> notation to support qualifications."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557346722, "post_id": 56048217, "comment_id": 98738360, "body": "Related to @BigBen &#39;s link, you can use a simplified approach such that <code>If IsError(Evaluate(&quot;&#39;Fire EXT.&#39;!A1&quot;)) Then</code> before performing actions on your workbook"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1557346584, "creation_date": 1557346584, "answer_id": 56048429, "question_id": 56048217, "link": "https://stackoverflow.com/questions/56048217/perform-function-for-every-open-workbook/56048429#56048429", "title": "Perform Function for Every Open Workbook", "body": "<p>You need to fully qualify all of your references.  You can also put in a check to ensure it skips the blank workbook (see my comments in this updated code):</p>\n\n<pre><code>Sub Button1_Click()\n'\n' Button1_Click Macro\n' Fire Ext. Comments\n'\n'\nDim w As Workbook\n\n' For every open workbook...\nFor Each w In Application.Workbooks\n\n    If w.FullName &lt;&gt; ThisWorkbook.FullName Then     '&lt;-- TA: Add check to verify you're not working on the blank workbook\n\n        'TA: I removed the .Activate line, that is never necessary.  Instead, fully qualify all your references\n\n        ' Find the comments column (K12 should be the \"Comments\" column)\n        If w.Worksheets(\"FIRE EXT.\").Range(\"K12\").Value = \"Comments\" Then   '&lt;-- TA: Note that Worksheets is now qualified to w so that it is checking worksheets in the current w workbook\n\n            ' Then we loop through all cells in the specified range (anything below the header row)\n            Dim rng As Range, cell As Range\n\n            ' I'm using a range of 500 to look for values, so if a file has more than 500 rows, you'll have to look at it manually\n            Set rng = w.Worksheets(\"FIRE EXT.\").Range(\"A1:A500\")    '&lt;-- TA: Note that Range is now qualified to w.Worksheets(\"FIRE EXT.\") (if that isn't the correct sheet name, change this to the correct sheet name)\n\n            ' Now loop to change all comments\n            For Each cell In rng\n.......................\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1557346670, "creation_date": 1557346670, "answer_id": 56048452, "question_id": 56048217, "link": "https://stackoverflow.com/questions/56048217/perform-function-for-every-open-workbook/56048452#56048452", "title": "Perform Function for Every Open Workbook", "body": "<p>I wanted to type a comment, but it got pretty long.</p>\n\n<ol>\n<li>You will get an error if the Sheet Name \"FIRE EXT.\" (with the period) does not exist on the workbook you are working with. You are looping ALL workbooks, if you have one that doesn't have that sheet, it will error out.</li>\n<li>It's better to stick with <code>Sheets</code> when using the Sheet Name, and <code>Worksheets</code> when using the Sheet Number. <code>Sheets(\"SheetName\")</code> vs <code>Worksheets(1)</code></li>\n<li><p>Avoid using Activate/Select by using the assigned workbook variable, in your code, that's \"w\"</p>\n\n<pre><code>Sub Button1_Click()\nDim w As Workbook\n\n' For every open workbook...\nFor Each w In Application.Workbooks\n\n    ' Find the comments column (K12 should be the \"Comments\" column)\n    If w.Sheets(\"FIRE EXT.\").Range(\"K12\").Value = \"Comments\" Then\n\n        ' Then we loop through all cells in the specified range (anything below the header row)\n        Dim rng As Range, cell As Range\n\n        ' I'm using a range of 500 to look for values, so if a file has more than 500 rows, you'll have to look at it manually\n        Set rng = w.Sheets(\"FIRE EXT.\").Range(\"A1:A500\")\n\n        ' Now loop to change all comments\n        For Each cell In rng\n        ' Now here you dont use \"w.Sheets(\"FIRE EXT.\")\" because it is already set on `rng'\n        ' so you can just use `cell` like cell.value = \"Blah\"\n.........\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56048429, "answer_count": 2, "score": 0, "last_activity_date": 1557382290, "creation_date": 1557345672, "last_edit_date": 1557382290, "question_id": 56048217, "link": "https://stackoverflow.com/questions/56048217/perform-function-for-every-open-workbook", "title": "Perform Function for Every Open Workbook", "body": "<p>I am creating a blank workbook with a command button that upon clicking, I want it to perform actions on EVERY open workbook currently open (as I will have other workbooks that aren't blank that I want it to carry out operations on).</p>\n\n<p>I get a Subscript out of range error when I run:</p>\n\n<pre><code>Sub Button1_Click()\n'\n' Button1_Click Macro\n' Fire Ext. Comments\n'\n'\nDim w As Workbook\n\n' For every open workbook...\nFor Each w In Application.Workbooks\n\n    ' Activate the current workbook\n    w.Activate\n\n    ' Find the comments column (K12 should be the \"Comments\" column)\n    If Worksheets(\"FIRE EXT.\").Range(\"K12\").Value = \"Comments\" Then\n\n        ' Then we loop through all cells in the specified range (anything below the header row)\n        Dim rng As Range, cell As Range\n\n        ' I'm using a range of 500 to look for values, so if a file has more than 500 rows, you'll have to look at it manually\n        Set rng = Range(\"A1:A500\")\n\n        ' No loop to change all comments\n        For Each cell In rng\n.......................\n</code></pre>\n\n<p>...at the \"<strong>If Worksheets(\"FIRE EXT.\").Range(\"K12\").Value = \"Comments\" Then</strong>\" line. So I'm thinking it's starting with the blank workbook and not finding the worksheet named \"FIRE EXT.\", so what would be the best practise to first test if the activated workbook first has that sheet name, otherwise move on to the next workbook? Thanks!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>This was what worked for me, but the other responses would have worked too. Thanks everyone!</p>\n\n<pre><code>Sub Button1_Click()\n'\n' Button1_Click Macro\n' Fire Ext. Comments\n'\n'\nDim w As Workbook\n\n' For every open workbook...\nFor Each w In Application.Workbooks\n\n    ' Don't work on the current/blank workbook\n    If w.FullName &lt;&gt; ThisWorkbook.FullName Then\n\n    ' Find the comments column (K12 should be the \"Comments\" column)\n    If w.Sheets(\"FIRE EXT.\").Range(\"K12\").Value = \"Comments\" Then\n\n        ' Then we loop through all cells in the specified range (anything below the header row)\n        Dim rng As Range, cell As Range\n\n        ' I'm using a range of 500 to look for values, so if a file has more than 500 rows, you'll have to look at it manually\n        Set rng = w.Worksheets(\"FIRE EXT.\").Range(\"A13:A500\")\n\n        ' No loop to change all comments\n        For Each cell In rng\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access", "filter", "record"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557346314, "post_id": 56048047, "comment_id": 98738194, "body": "Two pieces of advice. 1. You generally should only use <code>BeforeUpdate</code> if you want to validate data before it is saved on a table. For everything else use <code>AfterUpdate</code>, <code>OnChange</code> or <code>OnLostFocus</code> depending on the exact behavior you are looking for. 2. Any form control that is used for selecting or filtering should be <code>unbound</code> and any form control that contains data used to link between two tables should be <code>locked</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557346433, "post_id": 56048047, "comment_id": 98738243, "body": "Also review <a href=\"http://allenbrowne.com/ser-62.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-62.html</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557346716, "post_id": 56048047, "comment_id": 98738355, "body": "Tab control pages do not have filter property. Forms and reports have filter property. Do subforms have relationship with main form? Master/Child Links properties of subform/subreport container should synchronize records. Must reference subform and its properties through the container control that holds form."}, {"owner": {"reputation": 107, "user_id": 11411907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mC54_rsJJEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfp1_GlJ_SRxPvNDr5-E-uTOgZ14A/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/11411907/anonymous"}, "edited": false, "score": 0, "creation_date": 1557348325, "post_id": 56048047, "comment_id": 98739062, "body": "Huh that is very unusual, it wasn&#39;t synchronized for me earlier. I deleted the relationship and retried it and it synchronizes now. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1557346462, "creation_date": 1557346462, "answer_id": 56048405, "question_id": 56048047, "link": "https://stackoverflow.com/questions/56048047/what-is-the-better-way-to-filter-out-record-selections-in-a-form-based-on-user-i/56048405#56048405", "title": "What is the better way to filter out record selections in a form based on user input? _afterupdate or _beforeupdate?", "body": "<p>Look at my note for generic advice but specifically:</p>\n\n<pre><code>Page2.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\n</code></pre>\n\n<p>is wrong. use</p>\n\n<pre><code>Page2.Filter = \"ProjectNumber = '\" &amp; Me.ProjectNumber &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 11411907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mC54_rsJJEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfp1_GlJ_SRxPvNDr5-E-uTOgZ14A/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/11411907/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 56048405, "answer_count": 1, "score": 0, "last_activity_date": 1557346462, "creation_date": 1557344944, "question_id": 56048047, "link": "https://stackoverflow.com/questions/56048047/what-is-the-better-way-to-filter-out-record-selections-in-a-form-based-on-user-i", "title": "What is the better way to filter out record selections in a form based on user input? _afterupdate or _beforeupdate?", "body": "<p>new to Access.</p>\n\n<p>Here is the form layout: <a href=\"https://i.imgur.com/LVZrs9U.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/LVZrs9U.png</a></p>\n\n<p>You can see there is 1 main project page with 6 different subforms in each tab (subform 2-7), all with their own table.</p>\n\n<p>They are linked by Project Number (primary key) and Request Number.</p>\n\n<p>The main purpose of this form is to record information for a specific project (Project Number: Unique) over the course of many meetings (Request Number: starts at 1).</p>\n\n<p>For example, I want to record important information about project 101 and this is the 4th meeting we're having about it.</p>\n\n<p>Some of the subforms could have many different records. For example, a customer could be talking about 11 different new data sources and so for project 101, request: 4, there would be 11 records for tab/subform 5.</p>\n\n<p>I want a way where when the user puts in a Project Number and a Request Number, it pulls up the existing records for those.</p>\n\n<p>I used this combobox trick for the main project management page (<a href=\"https://www.youtube.com/watch?v=rSPS24EfijI\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=rSPS24EfijI</a>), but this will not work with tabs/subforms 2-7.</p>\n\n<p>So I thought about using the following guide from Microsoft:\n<a href=\"https://support.office.com/en-us/article/locate-specific-records-in-a-database-e186238d-e4d7-4918-92a0-1236661c6f58\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/locate-specific-records-in-a-database-e186238d-e4d7-4918-92a0-1236661c6f58</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.form.filter(property)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/access.form.filter(property)</a></p>\n\n<p>Is it better to do it at the main page level:</p>\n\n<pre><code>Private Sub RequestNumber_AfterUpdate()\nPage2.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nPage2.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\nPage3.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nPage3.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\nPage4.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nPage4.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\nPage5.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nPage5.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\nPage6.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nPage6.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\nPage7.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nPage7.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\nPage2.FilterOn = True\nPage3.FilterOn = True\nPage4.FilterOn = True\nPage5.FilterOn = True\nPage6.FilterOn = True\nPage7.FilterOn = True\n\nEnd Sub\n</code></pre>\n\n<p>Or at the subform level?</p>\n\n<pre><code>Private Sub ProjectNumber_BeforeUpdate(Cancel As Integer)\n\nMe.Filter = \"ProjectNumber = 'Me.ProjectNumber.Value'\"\nMe.Filter = \"RequestNumber = 'Me.RequestNumber.Value'\"\n\n\nMe.FilterOn = True\n\nEnd Sub\n</code></pre>\n\n<p>Both options didn't work with nothing changing. Should I be calling the form name? Tab control? The page of the tab?</p>\n\n<p>Also, it shouldn't matter if I call on the project/request number in the main form or the subforms because they're all linked together, right? Aka, whatever I put in the main form gets cascaded down to the subforms.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557342774, "post_id": 56047526, "comment_id": 98736689, "body": "keep your code and add <code>If LastrowMonth = 1 Then LastrowMonth = 2</code>"}, {"owner": {"reputation": 1, "user_id": 11471884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840dcbe6578f96595ce3550b5e712236?s=128&d=identicon&r=PG&f=1", "display_name": "Mancho", "link": "https://stackoverflow.com/users/11471884/mancho"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557504738, "post_id": 56047526, "comment_id": 98800738, "body": "this worked perfectly... thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11471884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840dcbe6578f96595ce3550b5e712236?s=128&d=identicon&r=PG&f=1", "display_name": "Mancho", "link": "https://stackoverflow.com/users/11471884/mancho"}, "edited": false, "score": 0, "creation_date": 1557505456, "post_id": 56047713, "comment_id": 98801060, "body": "hi- thanks for the cleanup. i plugged in the new code, but i am getting an error message: run-time error 13- &#39;Type mismatch&#39;. when i debug, it highlights the line: Set mysheet = thisworkbook.Sheets....."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 1, "user_id": 11471884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840dcbe6578f96595ce3550b5e712236?s=128&d=identicon&r=PG&f=1", "display_name": "Mancho", "link": "https://stackoverflow.com/users/11471884/mancho"}, "edited": false, "score": 0, "creation_date": 1557511063, "post_id": 56047713, "comment_id": 98803544, "body": "Try now @Mancho and make sure there is a sheet name on that  range."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1557511039, "last_edit_date": 1557511039, "creation_date": 1557343413, "answer_id": 56047713, "question_id": 56047526, "link": "https://stackoverflow.com/questions/56047526/macro-help-to-find-lastrow-if/56047713#56047713", "title": "macro help to find LastRow IF", "body": "<p>I've clean your code a bit with worksheet reference:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    'Set Variable Parameters for Monthly Sheet\n     'Dim mySheet As String 'instead of this, create a worksheet variable like this:\n    Dim mySheet As Worksheet\n    Dim LastrowMonth As Integer\n    Dim mKey As Range\n    Dim mKeyrng As Range\n    Dim mValrng As Range\n\n    Set mySheet = ThisWorkbook.Sheets(ThisWorkbook.Sheets(\"Weekly_GL\").Range(\"AE1\")) 'this way you can reference and work cleaner:\n    With mySheet\n        LastrowMonth = .Cells(.Rows.Count, 2).End(xlUp).Row 'this is the standard to find the last row\n        If LastrowMonth = 1 Then LastrowMonth = 2 'this is what you were looking for\n        Set mKey = .Range(\"AC1\")\n        Set mKeyrng = .Range(\"AC2:AC\" &amp; LastrowMonth)\n        Set mValrng = .Range(\"AD2:AD\" &amp; LastrowMonth)\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><code>Option Explicit</code> is a good choice to avoid errors because it force you to declare all your variables. </p>\n\n<p>Using <code>With</code> allows you to reference what you are using, in this case <code>mySheet</code> just by using <code>.</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11471884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840dcbe6578f96595ce3550b5e712236?s=128&d=identicon&r=PG&f=1", "display_name": "Mancho", "link": "https://stackoverflow.com/users/11471884/mancho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557511039, "creation_date": 1557342648, "last_edit_date": 1557361734, "question_id": 56047526, "link": "https://stackoverflow.com/questions/56047526/macro-help-to-find-lastrow-if", "title": "macro help to find LastRow IF", "body": "<p>I have a macro to set LastRow by finding last empty row in column B.  However, sometimes the entire row is empty, except for Row 1 where the headers are. \nI need to set an IF statement on the LastRow variable to say IF Range B2 is NULL (or equals 0), then use B2 as parameter, to set LastRow. Else, find last row by .End(xlUp)</p>\n\n<p>I've already tried different IF statements on my variable but all leads to an error message</p>\n\n<pre><code>Sub WeeklyGL()\n\n  'Set Variable Parameters for Monthly Sheet\n     Dim mySheet As String\n     Dim LastrowMonth As Integer\n     Dim mKey As Range\n     Dim mKeyrng As Range\n     Dim mValrng As Range\n\n     mySheet = Sheets(\"Weekly_GL\").Range(\"AE1\")\n     LastrowMonth = Sheets(mySheet).Range(\"B1048576\").End(xlUp).Row --&gt; this is where i need help\n     Set mKey = Sheets(mySheet).Range(\"AC1\")\n     Set mKeyrng = Sheets(mySheet).Range(\"AC2:AC\" &amp; LastrowMonth)\n     Set mValrng = Sheets(mySheet).Range(\"AD2:AD\" &amp; LastrowMonth)\n</code></pre>\n\n<p>Last try: LastrowMonth = If Sheets(mySheet).Range(\"B2\") ISNULL Then .Range(\"B2\") Else Sheets(mySheet).Range(\"B1048576\").End(xlUp).Row</p>\n"}, {"tags": ["c++", "excel", "vba"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1557342133, "post_id": 56047363, "comment_id": 98736460, "body": "Are you familiar with the process how to register and interfaceing  a DLL for use in VBA ? If yes what did you do to do so? If you don&#39;t have a registration you might be interested about <a href=\"https://en.wikipedia.org/wiki/Side-by-side_assembly\" rel=\"nofollow noreferrer\">Side by Side assemblies</a>."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1557342802, "post_id": 56047363, "comment_id": 98736710, "body": "Did you remember to ship the compiler runtime (aka the Visual Studio redistributables) along with your program? Without the runtime libraries your program cannot run properly. That goes for <i>any</i> compiler, not just VS."}, {"owner": {"reputation": 1, "user_id": 11471812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccfb4866cea955c129734f47e5c7a78?s=128&d=identicon&r=PG&f=1", "display_name": "Ruixin", "link": "https://stackoverflow.com/users/11471812/ruixin"}, "edited": false, "score": 0, "creation_date": 1557405775, "post_id": 56047363, "comment_id": 98759781, "body": "I am not a programmer by training, unfortunately not able to digest the reference you gave. It&#39;s actually a very simple DLL trying to perform some intensive simulations which take too long to do in VBA."}, {"owner": {"reputation": 1, "user_id": 11471812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccfb4866cea955c129734f47e5c7a78?s=128&d=identicon&r=PG&f=1", "display_name": "Ruixin", "link": "https://stackoverflow.com/users/11471812/ruixin"}, "edited": false, "score": 0, "creation_date": 1557418568, "post_id": 56047363, "comment_id": 98767346, "body": "Tried the Visual Studio redistributables, and it&#39;s not working."}, {"owner": {"reputation": 1, "user_id": 11471812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccfb4866cea955c129734f47e5c7a78?s=128&d=identicon&r=PG&f=1", "display_name": "Ruixin", "link": "https://stackoverflow.com/users/11471812/ruixin"}, "edited": false, "score": 0, "creation_date": 1557424363, "post_id": 56047363, "comment_id": 98769958, "body": "resolved, using dependency walker and find two DLL need to be add to sysWOW64."}], "owner": {"reputation": 1, "user_id": 11471812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccfb4866cea955c129734f47e5c7a78?s=128&d=identicon&r=PG&f=1", "display_name": "Ruixin", "link": "https://stackoverflow.com/users/11471812/ruixin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557382234, "creation_date": 1557341892, "last_edit_date": 1557382234, "question_id": 56047363, "link": "https://stackoverflow.com/questions/56047363/c-dll-for-excel-not-able-to-work-on-other-computer", "title": "C++ DLL for Excel not able to work on other computer", "body": "<p>I built a C++ DLL, to be called from Excel-VBA, using Visual Studio 2017.  It works well on my computer with the DLL built by debug mode. When I try to use it on another computer without VS, it gives a run time <code>error 53 - file not found</code>. After some research on the web, I have tried to built the DLL under release mode. Now I'm getting run time <code>error 53 - file not found</code> on my pc with VS. The error message on the other computer is run time 'error 453 - cannot find DLL entry point'.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1557385199, "post_id": 56047178, "comment_id": 98748411, "body": "You should add this function to your question."}, {"owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "edited": false, "score": 0, "creation_date": 1557391011, "post_id": 56047178, "comment_id": 98751444, "body": "Maybe it is better to use the event <code>AfterInsert</code> or <code>AfterUpdate</code> instead of <code>Dirty</code>?"}], "owner": {"reputation": 1, "user_id": 11471603, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UUp-iQPmTJw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8zgvWh2h5pQMvOHSqDwxGIi8n8w/mo/photo.jpg?sz=128", "display_name": "bussiereg", "link": "https://stackoverflow.com/users/11471603/bussiereg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594779722, "creation_date": 1557341075, "last_edit_date": 1594779722, "question_id": 56047178, "link": "https://stackoverflow.com/questions/56047178/cannot-exit-a-form-wiithout-a-bunch-of-errors-because-required-field-is-blank", "title": "Cannot Exit a form wiithout a bunch of errors because required field is &quot;blank&quot;", "body": "<p>On my MS Access form, \nAs soon as I get to a new record, the dirty is set to true even before I start updating any field.</p>\n\n<p>The consequence is when I try to exit, I get plenty of errors because I have few required fields, even though nothing was added to the record.</p>\n\n<p>I believe this may come from a function that is checking if my record is locked or not(from a yes/no control). This function is called on loading a record.</p>\n\n<p>How do a put my record \"clean\" so I can exit without all these errors? is there a code that would do the same thing as \"esc\" to my form? Or a reset?</p>\n\n<p>TIA</p>\n\n<p>I tried to force me!dirty=false\nI tried some code form internet but nothing seems to work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557340445, "post_id": 56046962, "comment_id": 98735699, "body": "A userform doesn&#39;t &quot;reside&quot; on any worksheet, what does &quot;sheet1 has the userform&quot; mean?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557340490, "post_id": 56046962, "comment_id": 98735718, "body": "<code>Worksheets(&quot;In House Sales Sheet&quot;).Range(&quot;A1&quot;).Value = ComboBox6.Text</code>"}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557341230, "post_id": 56046962, "comment_id": 98736071, "body": "All the cells that the userform writes to is on a sheet named Sheet1."}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557341942, "post_id": 56046962, "comment_id": 98736365, "body": "Thanks Mathieu!                               Private Sub CommandButton4_Click()      Worksheets(&quot;In House Sales Sheet&quot;).Range(&quot;A1&quot;).Value = ComboBox6.Text      Sheets(&quot;In House Sales Sheet&quot;).PrintPreview      End Sub  I put your code in here.  When I run it it gets stuck on the print preview."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557342273, "post_id": 56046962, "comment_id": 98736517, "body": "You can <i>edit your question</i> if you have code to add."}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "edited": false, "score": 0, "creation_date": 1557345130, "post_id": 56046962, "comment_id": 98737750, "body": "Thanks.  I&#39;m a noob here so I still have to learn the posting protocols."}], "owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557340165, "creation_date": 1557340058, "last_edit_date": 1557340165, "question_id": 56046962, "link": "https://stackoverflow.com/questions/56046962/i-want-to-be-able-to-update-a-cell-on-different-worksheet-than-the-userform-resi", "title": "I want to be able to update a cell on different worksheet than the userform resides", "body": "<p>I want to be able to update a cell on different worksheet than the userform resides.  Sheet1 has the userform.  I want ComboBox6 from the userform to populate cell a1 on worksheet \"In House Sales Sheet.\"  I then want to print preview \"In House Sales Sheet.\"</p>\n\n<pre><code>''''''''''''''''''''''''''''''''''''''''''''''''''''Print Preview\nPrivate Sub CommandButton4_Click()\n\n   Sheets(\"In House Sales Sheet\").PrintPreview\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "edited": false, "score": 0, "creation_date": 1557339767, "post_id": 56046407, "comment_id": 98735403, "body": "Adding apostrophes instead of quotation marks when i try to define the ul style lets me run the macro, however the bullet list is still starred and not circled."}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 0, "creation_date": 1557342916, "post_id": 56046407, "comment_id": 98736766, "body": ".HTMLBody = .HTMLBody &amp; &quot;&lt;tr&gt;&lt;td&gt;&amp;bull;&lt;/td&gt;&lt;td&gt;&quot; &amp; ActiveSheet.Cells(i + 5, 2).Value &amp; &quot; - &quot; &amp; Format(ActiveSheet.Cells(i + 5, 6).Value, &quot;Currency&quot;) &amp; &quot; (&quot; &amp; Format(ActiveSheet.Cells(i + 5, 8).Value, &quot;Currency&quot;) &amp; &quot; without budget or invoicing). Last billed &quot; &amp; ActiveSheet.Cells(i + 5, 10) &amp; &quot;.&quot; &amp; &quot; &lt;/td&gt;&lt;/tr&gt;&quot;"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 0, "creation_date": 1557343024, "post_id": 56046407, "comment_id": 98736821, "body": "@PawelCzyz I think you will need the extended space and formatting capabilities of an answer to get your point across. The comment is next to unreadable."}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 0, "creation_date": 1557343569, "post_id": 56046407, "comment_id": 98737084, "body": "This is actually a line of code that might replace content of the loop. It is however a different approach. Might be useful to try it out."}, {"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "edited": false, "score": 0, "creation_date": 1557343937, "post_id": 56046407, "comment_id": 98737257, "body": "I sorted it out - It seems as though having the .Body as well as .HTMLBody wasn&#39;t working, but now all references are to .HTMLBody and the bullet points now appear as circles.  Thank you everyone!"}], "owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557341002, "creation_date": 1557337581, "last_edit_date": 1557341002, "question_id": 56046407, "link": "https://stackoverflow.com/questions/56046407/how-to-modify-bullets-in-an-outlook-email-using-an-excel-macro", "title": "How to modify bullets in an Outlook email using an Excel Macro", "body": "<p>When I run my macro, the bullet points on both the main and sub-level appear as stars instead of a normal black circle for the first bullet and a hollow circle for the sub-bullet. </p>\n\n<p>I have tried to define the style but my code gives me an error message when I add \"list-style-type:disc;\" or try to include quotation marks in general inside the &lt;> of either ul or li.</p>\n\n<p>Using w3schools I understand how this should work but it doesn't seem to cooperate in my Excel VBA. Any help would be appreciated!</p>\n\n<pre><code>Sub Email_Budget()\n\n   Dim objOutlook As Object\n   Set objOutlook = CreateObject(\"Outlook.Application\")\n\n   Dim objEmail As Object\n   Set objEmail = objOutlook.CreateItem(olMailItem)\n\n\n\n   Dim CaseCount As Long\n   CaseCount = WorksheetFunction.CountA(Range(\"B6:B500\"))\n   Debug.Print CaseCount\n\n   Dim i As Integer\n\n   With objEmail\n      .To = \"####@####.com\"\n      .Subject = \"TEST1: May 2019 Budget\"\n      .Body = \"Paul,\"\n      .Body = .Body &amp; \" \"\n      .Body = .Body &amp; \"The potential \" &amp; MonthName(Month(ActiveSheet.Range(\"A2\"))) &amp; \" invoices are below.\"\n      .Body = .Body &amp; \" \"\n      For i = 1 To CaseCount\n        If ActiveSheet.Cells(i + 5, 4).Value = \"Yes\" Then\n            .HTMLBody = .HTMLBody &amp; \"&lt;ul style=\"list-style-type:circle;\"&gt;\" &amp; \"&lt;li&gt;\" &amp; ActiveSheet.Cells(i + 5, 2).Value &amp; \" - \" &amp; Format(ActiveSheet.Cells(i + 5, 6).Value, \"Currency\") &amp; \" (\" &amp; Format(ActiveSheet.Cells(i + 5, 8).Value, \"Currency\") &amp; \" without budget or invoicing).\" &amp; \"&lt;/li&gt;\" &amp; \"&lt;ul&gt;\" &amp; \"&lt;li&gt;\" &amp; \"Last billed \" &amp; ActiveSheet.Cells(i + 5, 10) &amp; \".\" &amp; \"&lt;/li&gt;\" &amp; \"&lt;/ul&gt;\" &amp; \"&lt;/ul&gt;\"\n        End If\n      Next i\n      .Body = .Body &amp; \" \"\n      .Body = .Body &amp; \" \"\n      .Body = .Body &amp; \"Thank you,\"\n      .Body = .Body &amp; \"Karen\"\n      .Display\n</code></pre>\n\n<p>My macro says there is a syntax error and can't run the program. When I remove the quotation marks from inside the first &lt;> that defines the ul bullet style, starred bullets are still produced. Also I am noticing that I have to use quotation marks around each list identifier where the w3schools examples don't have to... Any help would be very appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1557337799, "post_id": 56046393, "comment_id": 98734443, "body": "Set <code>Application.Calculation</code> to manual then set it back to automatic when done - that will speed this up.  Optionally also set <code>ScreenUpdating</code> to False"}, {"owner": {"reputation": 5696, "user_id": 4421870, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/38f9356608b91648b260644fc7a1b6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mako212", "link": "https://stackoverflow.com/users/4421870/mako212"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557337929, "post_id": 56046393, "comment_id": 98734510, "body": "@TimWilliams Huh, that&#39;s all it was. Thank you! I marked as a duplicate because now knowing what to google, I found an existing answer."}], "owner": {"reputation": 5696, "user_id": 4421870, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/38f9356608b91648b260644fc7a1b6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mako212", "link": "https://stackoverflow.com/users/4421870/mako212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1557337995, "answer_count": 0, "score": 1, "last_activity_date": 1557337518, "creation_date": 1557337518, "question_id": 56046393, "link": "https://stackoverflow.com/questions/56046393/is-there-a-more-efficient-way-to-write-vba-with-relative-cell-reference-calculat", "closed_reason": "Duplicate", "title": "Is there a more efficient way to write VBA with relative cell reference calculations?", "body": "<p>I'm working on automating components of an Excel sheet with VBA, and I'm curious if there's a more efficient way to fill in calculations with relative cell references. This takes a few seconds to calculate over ~1,000 rows. Is there a way to do this more efficiently?</p>\n\n<p>Currently I'm doing something like this to calculate a cell value, based on the difference between two above cells:</p>\n\n<pre><code>For Each cell In rng\n    ' get the current row\n    current_row = cell.Row\n\n    ' check if we're in the cell that needs the calculation\n    If ActiveSheet.Range(\"A\" &amp; current_row) = \"criteria\" Then\n        ' take the difference of the two above cells\n        cell.Formula = \"=OFFSET(\" &amp; cell.Address &amp; \", -2, 0) - OFFSET(\" &amp; cell.Address &amp; \", -1, 0)\"\n    End If\n\nNext cell\n</code></pre>\n\n<p>Alternatively, we could just calculate in place:</p>\n\n<pre><code>cell.Value = cell.Offset(-2, 0) - cell.Offset(-1, 0)\n</code></pre>\n\n<p>But that doesn't seem to be any faster.</p>\n\n<p>The Excel format I'm stuck with is a non-standard rectangular format that I can't change, so while I know a standard columnar format would remove this issue all together, I'm trying to work within the confines of the existing format.</p>\n"}, {"tags": ["excel", "vba", "parameters", "powerquery"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557336885, "post_id": 56046013, "comment_id": 98733982, "body": "&quot;I want to avoid storing the GUID in a cell for security reasons&quot; - if that GUID is in the VBA code, it&#39;s not secure. Also that GUID is sent over HTTP as part of a URL, which isn&#39;t secure. There is no valid security concern with that GUID, it&#39;s already public."}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557337087, "post_id": 56046013, "comment_id": 98734093, "body": "I get that, but I&#39;m just looking for &quot;more secure&quot; than storing it in plain text in a cell that&#39;s easily visible. I have a login script that refreshes the GUID value upon opening the file, which automatically clears when the file is closed. This ensures the next person opening the file doesn&#39;t get access to the GUID of the previous user. This isn&#39;t the topic of my question though, so will me explaining my reasoning for NOT wanting the GUID stored in a cell help you answer my question, or are you just nitpicking?"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1557337181, "post_id": 56046013, "comment_id": 98734138, "body": "Where are you getting the GUID you need to pass in from?"}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1557337591, "post_id": 56046013, "comment_id": 98734342, "body": "I get the GUID from the API via a login function then I store it as a class variable.  I can manipulate the GUID with ease, the issue is feeding it into the Power Query source."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "is_accepted": true, "score": 2, "last_activity_date": 1557347419, "last_edit_date": 1557347419, "creation_date": 1557339358, "answer_id": 56046818, "question_id": 56046013, "link": "https://stackoverflow.com/questions/56046013/how-do-i-change-a-parameter-in-power-query-without-it-converting-the-value-to-a/56046818#56046818", "title": "How do I change a Parameter in Power Query without it converting the value to a formula?", "body": "<p>The solution was using double quotes to force a text value to the formula:</p>\n\n<pre><code>ThisWorkbook.Queries(\"GUID\").Formula = \"\"\"dogs\"\"\"\n</code></pre>\n\n<p>Here's the final version, which passes the variable through as text:</p>\n\n<pre><code>Sub RefreshQuery_Click()\n    ThisWorkbook.Queries(\"GUID\").Formula = \"\"\"\" &amp; GUID &amp; \"\"\"\"\nEnd Sub\n</code></pre>\n\n<p>To ensure the query retains the parameter property, add in the following meta data:</p>\n\n<pre><code>    ThisWorkbook.Queries(\"GUID\").Formula = \"\"\"\" &amp; GUID &amp; \"\"\"\" &amp; \" meta [IsParameterQuery=true, Type=\"\"Text\"\", IsParameterQueryRequired=true]\"\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 56046818, "answer_count": 1, "score": 2, "last_activity_date": 1557347419, "creation_date": 1557336039, "last_edit_date": 1557336898, "question_id": 56046013, "link": "https://stackoverflow.com/questions/56046013/how-do-i-change-a-parameter-in-power-query-without-it-converting-the-value-to-a", "title": "How do I change a Parameter in Power Query without it converting the value to a formula?", "body": "<p>I was following the instructions on this thread:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/52703993/how-to-change-excel-power-query-paramaters-with-vba\">How to Change Excel Power Query Paramaters with VBA</a></p>\n\n<p>which lists the following code for changing a Power Query parameter:</p>\n\n<pre><code>ThisWorkbook.Queries([ParameterName]).Formula = 'New code here\n</code></pre>\n\n<p>However it converts the value into a formula and adds \"= \" to the front of it:</p>\n\n<p><img src=\"https://imgur.com/WiL905O.png\" alt=\"Error\"></p>\n\n<p>I need to update the source of my query because the GUID expires and needs to be refreshed.</p>\n\n<pre><code>    Source = Xml.Tables(Web.Contents(\"http://api.aceproject.com/?fct=getprojects&amp;guid=\" &amp; GUID &amp; \"&amp;Filtercompletedproject=False&amp;projecttemplate=0&amp;assignedonly=True\")),\n</code></pre>\n\n<p>The only solutions I can find require using a value stored in a cell, but I want to avoid storing the GUID in a cell for security reasons.</p>\n\n<p>Using VBA how can I change either just the parameter value (without it converting into a formula) or the entire source URL?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557336269, "post_id": 56045844, "comment_id": 98733669, "body": "What&#39;s the error message, and on what line?"}, {"owner": {"reputation": 143, "user_id": 11266559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4xUfrrJm7VA/AAAAAAAAAAI/AAAAAAAADho/KsodTTn8TEE/photo.jpg?sz=128", "display_name": "Kanika Singhal", "link": "https://stackoverflow.com/users/11266559/kanika-singhal"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557336534, "post_id": 56045844, "comment_id": 98733807, "body": "Error message is Run-time error: &#39;-2147023170(800706be)&#39; - Automation Error: The remote procedure call failed. The error is inside the for loop somewhere because each time I run its changing the line inside the foor loop only."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557337330, "post_id": 56045844, "comment_id": 98734212, "body": "I might have time later to look into this in more detail, but at a first glance, the <code>currentSlide.Shapes.Paste.Select</code> looks suspect - I&#39;d avoid using <code>Select</code> (and <code>Selection</code> later on). Also the hard-coded <code>2</code> in <code>currentSlide.Shapes(2)</code> might be a red flag."}], "owner": {"reputation": 143, "user_id": 11266559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4xUfrrJm7VA/AAAAAAAAAAI/AAAAAAAADho/KsodTTn8TEE/photo.jpg?sz=128", "display_name": "Kanika Singhal", "link": "https://stackoverflow.com/users/11266559/kanika-singhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557381949, "creation_date": 1557335358, "last_edit_date": 1557381949, "question_id": 56045844, "link": "https://stackoverflow.com/questions/56045844/copying-excel-charts-to-ppt-with-vba", "title": "Copying excel charts to ppt with VBA", "body": "<p>I am trying to copy multiple pivot graphs from excel sheet to a new ppt.</p>\n\n<p>Below is the code I have tried. But, in this code after pasting the first graph it is throwing error and Power point is also crashing.</p>\n\n<pre><code>Sub ClickPpt()\n\n      'Declare the needed variables\n    Dim newPP As PowerPoint.Application\n    Dim currentSlide As PowerPoint.Slide\n    Dim Xchart As Excel.ChartObject\n     'Check if PowerPoint is active\n    On Error Resume Next\n    Err.Clear\n    Set newPP = GetObject(, \"PowerPoint.Application\")\n    On Error GoTo 0\n    'Open PowerPoint if not active\n    If newPP Is Nothing Then\n        Set newPP = New PowerPoint.Application\n    End If\n    'Create new presentation in PowerPoint\n    If newPP.Presentations.Count = 0 Then\n        newPP.Presentations.Add\n    End If\n    'Display the PowerPoint presentation\n    newPP.Visible = True\n    'Locate Excel charts to paste into the new PowerPoint presentation\n    For Each Xchart In ActiveSheet.ChartObjects\n     'Add a new slide in PowerPoint for each Excel chart\n        newPP.ActivePresentation.Slides.Add newPP.ActivePresentation.Slides.Count + 1, ppLayoutText\n        newPP.ActiveWindow.View.GotoSlide newPP.ActivePresentation.Slides.Count\n        Set currentSlide = newPP.ActivePresentation.Slides(newPP.ActivePresentation.Slides.Count)\n\n    'Copy each Excel chart and paste it into PowerPoint as an Metafile image\n        Xchart.Select\n        'ActiveChart.ChartArea.Copy\n        'currentSlide.Shapes.PasteSpecial(DataType:=ppPasteMetafilePicture).Select\n        ActiveChart.Parent.Copy\n        currentSlide.Shapes.Paste.Select\n    'Copy and paste chart title as the slide title in PowerPoint\n        'currentSlide.Shapes(1).TextFrame.TextRange.Text = cht.Chart.ChartTitle.Text\n\n    'Adjust the slide position for each chart slide in PowerPoint. Note that you can adjust the values to position the chart on the slide to your liking\n        newPP.ActiveWindow.Selection.ShapeRange.Left = 25\n        newPP.ActiveWindow.Selection.ShapeRange.Top = 150\n        currentSlide.Shapes(2).Width = 250\n        currentSlide.Shapes(2).Left = 500\n\n    Next\n\nAppActivate (\"Microsoft PowerPoint\")\nSet currentSlide = Nothing\nSet newPP = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Can someone help me with the code or provide me some code to do this process?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "edited": false, "score": 1, "creation_date": 1557336692, "post_id": 56045883, "comment_id": 98733885, "body": "@WoeIs side note, I would just eat the illegal keypress - popping a <code>MsgBox</code> is just annoying... just put a label somewhere near the textbox that makes it clear that the box expects digits."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557336777, "post_id": 56045883, "comment_id": 98733933, "body": "Also the <code>Chr(KeyAscii)</code> shouldn&#39;t be concatenated if the key is illegal... I&#39;d just put that line in a <code>TextBox.Change</code> handler (i.e. after the actual content has changed)"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557337060, "post_id": 56045883, "comment_id": 98734079, "body": "Totally agree with that last comment @MathieuGuindon. That first line of the sub would do better inside an <code>Else</code>."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 4, "last_activity_date": 1557335518, "creation_date": 1557335518, "answer_id": 56045883, "question_id": 56045819, "link": "https://stackoverflow.com/questions/56045819/my-vba-code-for-a-textbox-does-not-include-the-final-input-in-the-cell-value/56045883#56045883", "title": "My VBA code for a textbox does not include the final input in the cell value", "body": "<p>This subroutine is being activated upon the keypress, so they key hasn't registered as a entry into the textbox yet.</p>\n\n<p>You can concatenate the last character (keypress character) onto your cell value though:</p>\n\n<pre><code>Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n    Worksheets(\"Sheet1\").Range(\"A1\").Value = TextBox1.Value &amp; chr(KeyAscii)\n    If Not (KeyAscii &gt;= 48 And KeyAscii &lt;= 57) Then\n        KeyAscii = 0\n        MsgBox \"Digits only\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56045883, "answer_count": 1, "score": 0, "last_activity_date": 1557335518, "creation_date": 1557335285, "question_id": 56045819, "link": "https://stackoverflow.com/questions/56045819/my-vba-code-for-a-textbox-does-not-include-the-final-input-in-the-cell-value", "title": "My VBA code for a textbox does not include the final input in the cell value", "body": "<pre><code>Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n    Worksheets(\"Sheet1\").Range(\"A1\").Value = TextBox1.Value\n    If Not (KeyAscii &gt;= 48 And KeyAscii &lt;= 57) Then\n        KeyAscii = 0\n        MsgBox \"Digits only\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Code is used on a textbox in a userform.</p>\n\n<p>I received some help yesterday and got this helpful piece of VBA code which works nicely. However, there is a slight bug with this. The textbox is supposed to only accept digits (hence the <code>KeyAscii &gt;= 48 And KeyAscii &lt;= 57</code>) however the last input digit does not get converted to the cell.</p>\n\n<p>For instance, when you type \"1234\" in the textbox, it only writes \"123\" in the cell and omits the last digit.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557335050, "post_id": 56045556, "comment_id": 98733063, "body": "Add a reference to the <i>Microsoft Scripting Runtime</i> library, and declare <code>fso As FileSystemObject</code>. You&#39;ll get <i>IntelliSense</i>, autocompletion, compile-time validation, and you can browse the existing members in the <i>Object Browser</i> (F2). There&#39;s no reason to late-bind the scripting runtime unless you intend to run your code on a Mac."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557335128, "post_id": 56045556, "comment_id": 98733102, "body": "Alternatively, refer to <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object\" rel=\"nofollow noreferrer\">the documentation</a>; <code>FileSystemObject.CreateTextFile</code> yields a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/textstream-object\" rel=\"nofollow noreferrer\"><code>TextStream</code></a> object, which has a <code>WriteLine</code> method."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557335164, "post_id": 56045556, "comment_id": 98733116, "body": "hi, u have to write like thie fileOut.Write (&quot;#!/bin/sh -x&quot; &amp; vbCrLf &amp; vbCrLf)"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1557336028, "last_edit_date": 1557336028, "creation_date": 1557335456, "answer_id": 56045865, "question_id": 56045556, "link": "https://stackoverflow.com/questions/56045556/fileout-write-object-does-not-support-this-property-or-method/56045865#56045865", "title": "fileOut.Write object does not support this property or method", "body": "<p><code>FileSystemObject.CreateTextFile</code> yields a <code>TextStream</code> object, which does have a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/write-method\" rel=\"nofollow noreferrer\"><code>Write</code></a> <em>method</em> (it also has a <code>WriteLine</code> method)... but you're using it as if it were an assignable <em>property</em>.</p>\n\n<p>Just remove the <code>=</code> assignment operator.</p>\n\n<pre><code>fileOut.Write \"#!/bin/sh -x\" &amp; vbCrLf &amp; vbCrLf\n</code></pre>\n\n<p>(note: no need for any parentheses)</p>\n\n<hr>\n\n<p>Note that this declares <code>fileOut</code> as an <code>Object</code>, while leaving <code>fso</code> as an implicit <code>Variant</code>:</p>\n\n<pre><code>Dim fso, fileOut As Object\n</code></pre>\n\n<p>You want to declare an explicit type for all variables:</p>\n\n<pre><code>Dim fso As Object, fileOut As Object\n</code></pre>\n\n<p>...and ideally avoid declaring multiple variables in a single instruction:</p>\n\n<pre><code>Dim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nDim fileOut As Object\nSet fileOut = fso.CreateTextFile(currentWorkbookPath &amp; \"\\\" &amp; srrNumber &amp; \"_bkp.txt\", True, False)\n\nfileOut.Write content\n</code></pre>\n\n<p>Lastly, note that the <em>Microsoft Scripting Runtime</em> library has no reason to not be referenced in VBA. In the editor's Tools menu, select \"References...\" and find the type library in the list. Then work with the actual types:</p>\n\n<pre><code>Dim fso As FileSystemObject\nSet fso = New FileSystemObject\n\nDim fileOut As TextStream\nSet fileOut = fso.CreateTextFile(currentWorkbookPath &amp; \"\\\" &amp; srrNumber &amp; \"_bkp.txt\", True, False)\n\nfileOut.Write content\n</code></pre>\n\n<p>Notice when the actual object types are used, you get the list of available members when you type the <code>.</code> (dot) operator: this completely eliminates run-time error 438, forever. When you work against <code>Object</code>, member calls can only be resolved at run-time (i.e. \"late\" binding), which is more error prone especially if you're unfamiliar with the library you're using.</p>\n\n<p>There's no need to ever use late binding with the <em>Microsoft Scripting Runtime</em> library, unless you intend to run your code on a Mac.</p>\n"}], "owner": {"reputation": 23, "user_id": 2025110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b153dc603ba84098e20215293942a009?s=128&d=identicon&r=PG", "display_name": "user2025110", "link": "https://stackoverflow.com/users/2025110/user2025110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 56045865, "answer_count": 1, "score": 0, "last_activity_date": 1557336028, "creation_date": 1557334278, "question_id": 56045556, "link": "https://stackoverflow.com/questions/56045556/fileout-write-object-does-not-support-this-property-or-method", "title": "fileOut.Write object does not support this property or method", "body": "<p>I am writing a VBA project in Excel and trying to output text to a txt file. However, I encountered a \"object doesn't support this property or method\" error at the fileOut.Write. </p>\n\n<p>Would like to know if my fileOut.Write correct?</p>\n\n<pre><code>Dim fso, fileOut As Object\n\n\n\n'Begin writing backup script\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet fileOut = fso.CreateTextFile(currentWorkbookPath &amp; \"\\\" &amp; srrNumber &amp; \"_bkp.txt\", True, False)\n\n\nfileOut.Write = \"#!/bin/sh -x\" &amp; vbCrLf &amp; vbCrLf\n</code></pre>\n"}, {"tags": ["excel", "vba", "tfs", "add-in"], "comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1557334257, "post_id": 56045517, "comment_id": 98732673, "body": "When I get really really strange things like this, I&#39;ll often save, close, reset my computer, and try it again"}, {"owner": {"reputation": 21, "user_id": 10564684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b434bdf6757242aa90f747399fd2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "VbaInterm", "link": "https://stackoverflow.com/users/10564684/vbainterm"}, "reply_to_user": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1557334895, "post_id": 56045517, "comment_id": 98732989, "body": "@Selkie I just tried that as you suggested and unfortunately the issue still persists, thanks for the suggestion though"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557336475, "post_id": 56045517, "comment_id": 98733772, "body": "Does the <code>ActiveSheet</code> matter when you <code>Execute</code> the command? <code>teamQueryRange.Worksheet.Select</code> -&gt; <code>teamQueryRange.Worksheet.Activate</code>"}, {"owner": {"reputation": 21, "user_id": 10564684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b434bdf6757242aa90f747399fd2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "VbaInterm", "link": "https://stackoverflow.com/users/10564684/vbainterm"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557338587, "post_id": 56045517, "comment_id": 98734839, "body": "@MathieuGuindon, thanks for the suggestion, I tried that and still had the issue but it seems I found a solution to that run-time error which I have posted below to help others who experience that or similar (was selecting a cell in the table that is restricted from selection or editing) because my code now runs. Thanks again"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10564684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b434bdf6757242aa90f747399fd2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "VbaInterm", "link": "https://stackoverflow.com/users/10564684/vbainterm"}, "is_accepted": false, "score": 2, "last_activity_date": 1557337608, "creation_date": 1557337608, "answer_id": 56046417, "question_id": 56045517, "link": "https://stackoverflow.com/questions/56045517/how-do-i-resolve-a-vba-method-execute-of-a-tfs-excel-add-in-commandbarbutton/56046417#56046417", "title": "How do I resolve a VBA &#39;Method Execute of a [TFS Excel Add-in CommandBarButton] failed&#39; Run-time error", "body": "<p>I seem to have resolved it by selecting a different cell in the first line of my Sub Macro1 (i.e. changed 'Range(\"A<strong>1</strong>\").Select' to 'Range(\"A<strong>2</strong>\").Select'). I had been searching online for a resolution and came across this page (<a href=\"https://support.microsoft.com/en-ca/help/983119/run-time-error-2147467259-80004005-when-you-programmatically-set-a-pro\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-ca/help/983119/run-time-error-2147467259-80004005-when-you-programmatically-set-a-pro</a>) which suggested that the \"Run-time error '-2147467259 (80004005)' \" was usually associated with protected worksheets and to unprotect the worksheet as a workaround.</p>\n\n<p>Even though my worksheet itself is <em>not</em> protected, the TFS Excel Add-In query results uses the first row of the generated table area (in my case, row 1) to provide information only and so somehow is 'protecting' that row so it cant be selected or edited. I, therefore, changed my code to select a cell in the 2nd row and the code run without error and refreshed the query results. </p>\n\n<p>I wanted to share this in case anyone had the same or similar issue where this would be helpful.</p>\n"}], "owner": {"reputation": 21, "user_id": 10564684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b434bdf6757242aa90f747399fd2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "VbaInterm", "link": "https://stackoverflow.com/users/10564684/vbainterm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557337608, "creation_date": 1557334145, "last_edit_date": 1557336316, "question_id": 56045517, "link": "https://stackoverflow.com/questions/56045517/how-do-i-resolve-a-vba-method-execute-of-a-tfs-excel-add-in-commandbarbutton", "title": "How do I resolve a VBA &#39;Method Execute of a [TFS Excel Add-in CommandBarButton] failed&#39; Run-time error", "body": "<p>I am trying to write a macro to get / refresh an Azure DevOps query in Excel 2016 (via the TFS Excel Add-In / Team Ribbon) so that I can use the data pulled to run some calculations and generate a progress report. I found the code online from 2010 to refresh the team query (i.e. 'Programming for the TFS Excel Add-in' at (<a href=\"https://blogs.msdn.microsoft.com/team_foundation/2010/11/06/programming-for-the-tfs-excel-add-in/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/team_foundation/2010/11/06/programming-for-the-tfs-excel-add-in/</a>) but when I try running the macro, I get a runtime error for the \"refreshControl.Execute\" line indicating: \"Run-time error '-2147467259 (80004005)' Method 'execute' of object '_CommandBarButton' failed\". </p>\n\n<p>For some reason though, when I put in a 'Msgbox \"\" ' line before that (refreshControl.Execute) line, it runs successfully and refreshes but i'm automating the process to run without requiring human intervention (as a scheduled task) so I can't keep that msgbox in there because it will always be generated. I am using Windows 10 and Excel 2016 Professional Plus if helpful and the code is below.</p>\n\n<p>P.S. I tried adding a wait time instead of the Msgbox (in case it was a timing issue) but still got the error. (Note: manually pressing the Refresh button in the Team Ribbon works fine). A resolution or any assistance would be much appreciated.</p>\n\n<pre><code>Sub Macro1()\n\nRange(\"A1\").Select\nRefreshTeamQuery (\"Sheet1\")\n\nEnd Sub\n\nPrivate Function FindTeamControl(tagName As String) As CommandBarControl\n\nDim commandBar As commandBar\nDim teamCommandBar As commandBar\nDim control As CommandBarControl\n\nFor Each commandBar In Application.CommandBars\n    If commandBar.Name = \"Team\" Then\n        Set teamCommandBar = commandBar\n        Exit For\n    End If\nNext\n\nIf Not teamCommandBar Is Nothing Then\n    For Each control In teamCommandBar.Controls\n        If InStr(1, control.Tag, tagName) Then\n            Set FindTeamControl = control\n            Exit Function\n        End If\n    Next\nEnd If\n\nEnd Function\n\nSub RefreshTeamQuery(shtTFSExcel_Name As String)\n\nDim actvSheet As Worksheet\nDim teamQueryRange As Range\nDim refreshControl As CommandBarControl\n\nSet refreshControl = FindTeamControl(\"IDC_REFRESH\")\n\nIf refreshControl Is Nothing Then\n    MsgBox \"Could not find Team Foundation commands in Ribbon. Please make sure that the Team Foundation Excel plugin is installed.\", vbCritical\n    Exit Sub\nEnd If\n\n' Disable screen updating temporarily so that the user doesn't see us selecting a range\nApplication.ScreenUpdating = False\n\n' Capture the currently active sheet, we will need it later\nSet actvSheet = ActiveWorkbook.activeSheet\nSet teamQueryRange = Worksheets(shtTFSExcel_Name).ListObjects(1).Range\n\nteamQueryRange.Worksheet.Select\nteamQueryRange.Select\n\n'Msgbox \"\"\nrefreshControl.Execute\n\nactvSheet.Select\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 3, "creation_date": 1557333914, "post_id": 56045367, "comment_id": 98732508, "body": "is the <code>j</code> a typo? (and if you haven&#39;t been using <code>Option Explicit</code> at the top of your modules, you may want to start)"}, {"owner": {"reputation": 11, "user_id": 11471347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bd7f9b06009c9246487898c6f47b46?s=128&d=identicon&r=PG", "display_name": "rocky09", "link": "https://stackoverflow.com/users/11471347/rocky09"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1557334354, "post_id": 56045367, "comment_id": 98732713, "body": "@Mistella yes. it is a typo."}, {"owner": {"reputation": 11, "user_id": 11471347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bd7f9b06009c9246487898c6f47b46?s=128&d=identicon&r=PG", "display_name": "rocky09", "link": "https://stackoverflow.com/users/11471347/rocky09"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557334439, "post_id": 56045367, "comment_id": 98732758, "body": "@SJR  i am getting results, but it is pulling A, B but i want the First Value i.e. A to populate to all cells as long as there is Continuous Yes in the Primary Column."}, {"owner": {"reputation": 11, "user_id": 11471347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bd7f9b06009c9246487898c6f47b46?s=128&d=identicon&r=PG", "display_name": "rocky09", "link": "https://stackoverflow.com/users/11471347/rocky09"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557334828, "post_id": 56045367, "comment_id": 98732958, "body": "@SJR yes.. You are correct. I am correcting it. Damn, so many errors in the questions. My Apologies."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557335552, "post_id": 56045367, "comment_id": 98733300, "body": "No worries, you have an answer which I think is fine, pending my comment."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557334815, "post_id": 56045535, "comment_id": 98732947, "body": "Good one, but I think the first B2 should be a B1 to avoid a circular reference?"}], "tags": [], "owner": {"reputation": 4562, "user_id": 140187, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c625e8cc951231fc15116b3214fe24e?s=128&d=identicon&r=PG", "display_name": "The King", "link": "https://stackoverflow.com/users/140187/the-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1558843806, "last_edit_date": 1558843806, "creation_date": 1557334187, "answer_id": 56045535, "question_id": 56045367, "link": "https://stackoverflow.com/questions/56045367/storing-the-first-value-in-a-sequence-and-use-the-stored-values-where-the-condit/56045535#56045535", "title": "Storing the first value in a sequence and use the stored values where the condition meets", "body": "<p>Assuming cols A B C use the below formula in B2</p>\n\n<pre><code>=If(C2=\"yes\", if(B1=\"\",A1,B1),\"\")\n</code></pre>\n\n<p>Copy this to all the linea below.</p>\n\n<p>This will work as long as the first item is not primary.</p>\n\n<p>U can even include this formula in vba and do the copy paste in vba</p>\n"}, {"tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": false, "score": 1, "last_activity_date": 1557344885, "creation_date": 1557344885, "answer_id": 56048037, "question_id": 56045367, "link": "https://stackoverflow.com/questions/56045367/storing-the-first-value-in-a-sequence-and-use-the-stored-values-where-the-condit/56048037#56048037", "title": "Storing the first value in a sequence and use the stored values where the condition meets", "body": "<h2>Excel Formula</h2>\n\n<p>Here is an example of how your formula can look. This first looks to see if the primary field is \"<strong>Yes</strong>\". If so, then it checks if the previous result also was a yes, and grabs it's the result if so. Otherwise, it grabs the first value based on your example.</p>\n\n<blockquote>\n  <p>=IF($C2=\"Yes\", IF($C1=\"Yes\", $B1, $A1),\"\")</p>\n</blockquote>\n\n<p><em>Adjust this as needed!</em></p>\n\n<hr>\n\n<h2>VBA Code</h2>\n\n<p>I would suggest creating a way of finding your headers, that way it is easier to update down the road in case it changes or there are more fields added. Below I added an example of what I would attempt to do. </p>\n\n<p>I used a helper function (Inject) to build the actual formula and make it easier to read/debug if there are issues.</p>\n\n<p>Feel free to add your own custom error handling as well.</p>\n\n<blockquote>\n  <p>Just note this is one of many ways you could tackle this. I could even break this formula into even smaller components to abstract as much of it as possible.</p>\n</blockquote>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub AddResultsToTable()\n\n    Dim Ws As Worksheet\n    Set Ws = ActiveSheet\n\n    'FIND COLUMN HEADERS TO USE IN FORMULA REFERENCES\n    With Ws.UsedRange\n\n        On Error GoTo Catch\n        Dim Product As Range\n        Set Product = .Find(\"Product\")\n\n        Dim Results As Range\n        Set Results = .Find(\"Results\")\n\n        Dim Primary As Range\n        Set Primary = .Find(\"Primary\")\n\n    End With\n\n    'CREATE FORMULA. Example: =IF($C2=\"Yes\", IF($C1=\"Yes\", $B1, $A1),\"\")\n    Dim CustomFormula As String\n    CustomFormula = Inject(\"=IF(${0}='Yes', IF(${1}='Yes', ${2}, ${3}),'')\", _\n        Primary.Offset(1).Address(False, True), _\n        Primary.Address(False, True), _\n        Results.Address(False, True), _\n        Product.Address(False, True) _\n    )\n\n    'SET FIRST RANGE EQUAL TO FORMULA &amp; AUTOFILL FORMULA DOWN\n    With Results.Offset(1)\n        .Value = CustomFormula\n        .AutoFill Range(.Address, Ws.Cells(Ws.Rows.Count, Product.Column).End(xlUp).Offset(, 1))\n    End With\n\nExit Sub\nCatch:\n    'You can do your error handling here.\n    MsgBox Err.Description, vbCritical\n\nEnd Sub\n\n\n'METHOD THAT ALLOWS A STRING TO BE REPLACED WITH VARIABLES AND SPECIAL CHARACTERS\nPublic Function Inject(ByVal Source As String, ParamArray Args() As Variant) As String\n\n    '@AUTHOR: ROBERT TODAR\n    '@EXAMPLE: Inject(\"${0}, ${1}!\", \"Hello\", \"Robert\") --&gt; Hello, Robert!\n\n    'REPLACE SINGLE QUOTES WITH DOUBLE QUOTES\n    Inject = Source\n    Inject = Replace(Inject, \"'\", \"\"\"\")\n\n    'REPLACE ${#} WITH VALUES STORED IN THE VALUE IN THAT INDEX.\n    Dim Index As Integer\n    For Index = LBound(Args, 1) To UBound(Args, 1)\n        Inject = Replace(Inject, \"${\" &amp; Index &amp; \"}\", Args(Index), , , vbTextCompare)\n    Next Index\n\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11471347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bd7f9b06009c9246487898c6f47b46?s=128&d=identicon&r=PG", "display_name": "rocky09", "link": "https://stackoverflow.com/users/11471347/rocky09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558843806, "creation_date": 1557333630, "last_edit_date": 1557382188, "question_id": 56045367, "link": "https://stackoverflow.com/questions/56045367/storing-the-first-value-in-a-sequence-and-use-the-stored-values-where-the-condit", "title": "Storing the first value in a sequence and use the stored values where the condition meets", "body": "<p>I have this table and the VBA code has to fetch Value from Product where the Primary value is Yes. But, Value has to be the First Value in the Sequence.</p>\n\n<pre><code>+---------+---------+---------+\n| Product | Results | Primary |\n+---------+---------+---------+\n| A       |         |         |\n| B       |         | Yes     |\n| C       |         | Yes     |\n| D       |         |         |\n| E       |         | Yes     |\n| F       |         |         |\n| G       |         | Yes     |\n| H       |         | Yes     |\n| I       |         |         |\n+---------+---------+---------+\n</code></pre>\n\n<p>Expecting results:</p>\n\n<pre><code>+---------+---------+---------+\n| Product | Results | Primary |\n+---------+---------+---------+\n| A       |         |         |\n| B       | A       | Yes     |\n| C       | A       | Yes     |\n| D       |         |         |\n| E       | D       | Yes     |\n| F       |         |         |\n| G       | F       | Yes     |\n| H       | F       | Yes     |\n| I       |         |         |\n+---------+---------+---------+\n</code></pre>\n\n<p>I have tried this below vba code, but doesn't work as i expected.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n    Dim i As Long\n    Dim lr As Long\n\n    lr = ActiveSheet.UsedRange.Rows.Count\n\n    For i = 2 To lr\n        If Range(\"D\" &amp; i).Value = \"Yes\" Then\n            Range(\"C\" &amp; i).Value = Range(\"B\" &amp; i - 1).Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula", "calculation"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557334009, "post_id": 56045341, "comment_id": 98732555, "body": "Why not just modify your formula? Something like <code>Range(&quot;P2:P100&quot;).Fomula = &quot;=H2-IF(ISBLANK(G2),$X$1,G2)&quot;</code>. I think that&#39;s what you&#39;re getting at."}, {"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557335357, "post_id": 56045341, "comment_id": 98733214, "body": "I have just tried that formula and it gives me a large negative number when it should be &quot;3&quot;.  g = &quot;5/5/2019&quot; H = &quot; &quot; and X = &quot;5/8/2019&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1557335705, "post_id": 56045341, "comment_id": 98733372, "body": "@Byron change <code>&quot;=H2-IF(ISBLANK(G2),$X$1,G2)&quot;</code> to <code>&quot;=IF(G2&lt;&gt;&quot;&quot;&quot;&quot;,G2-IF(ISBLANK(H2),$X$1,H2),&quot;&quot;&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1557336092, "post_id": 56045341, "comment_id": 98733575, "body": "@ScottCraner isn&#39;t it H minus G, not G minus H?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557336128, "post_id": 56045341, "comment_id": 98733589, "body": "@Byron I think I meant my original formula to be <code>=IF(ISBLANK(H2),$X$1,H2)-G2</code>, my mistake."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557336155, "post_id": 56045341, "comment_id": 98733608, "body": "@BigBen yup, should be <code>&quot;=IF(G2&lt;&gt;&quot;&quot;&quot;&quot;,IF(ISBLANK(H2),$X$1,H2)-G2,&quot;&quot;&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1557336458, "post_id": 56045341, "comment_id": 98733763, "body": "Scott, this one you sent worked perfectly. Thanks. Range(&quot;P2:P100&quot;).Formula = &quot;=IF(G2&lt;&gt;&quot;&quot;&quot;&quot;,IF(ISBLANK(H2),$X$1,H2)-G2,&quot;&quot;&quot;&quot;)&quot;"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557333485, "creation_date": 1557333485, "question_id": 56045341, "link": "https://stackoverflow.com/questions/56045341/how-to-add-a-formula-to-each-cell-in-a-column-if-another-column-has-a-value", "title": "how to add a formula to each cell in a column if another column has a value", "body": "<p>i have two dates. column G has start date and column H has end date. Column P has the amount of days between the two dates.\"Formula in Vba\".\nthe formula i have works but i need it to only calculate only if there is an end date, if not use X1 \"todays date.</p>\n\n<pre><code>Sub formulas()\n\n   Range(\"P2:P100\").Formula = \"=H2:H100-G2:G100\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 663, "user_id": 7131122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRUK1MTcgY4/AAAAAAAAAAI/AAAAAAAAA_8/VlNsZARthCY/photo.jpg?sz=128", "display_name": "Christofer Weber", "link": "https://stackoverflow.com/users/7131122/christofer-weber"}, "is_accepted": false, "score": 0, "last_activity_date": 1557347416, "creation_date": 1557347416, "answer_id": 56048610, "question_id": 56045181, "link": "https://stackoverflow.com/questions/56045181/generate-passwords/56048610#56048610", "title": "Generate passwords", "body": "<p>Well, if you only want numbers, a random number between 0 and 9 can be achieved by <code>Int(Rnd() * 10)</code>.<br>\nInt() rounds down, Rnd() returns a number between 0 and &lt;1.<br>\nIf you then loop that 8 times and add the numbers after each other (with <code>&amp;</code> rather than <code>+</code>) with an <code>If</code> checking the last last added value to the one we want to add, then you have an 8 digit number with no repeating numbers.</p>\n\n<p>Then you just have to print or save them somewhere.</p>\n\n<p>Something like:</p>\n\n<pre><code>Sub random()\nDim test As Long, ran As Long, i As Long, j As Long\nFor j = 1 To 500 '- Amount of numbers to print\n    ran = 0\n    For i = 1 To 8 '- Length of random number\n        test = Int(Rnd() * 10)\n        If test = Right(ran, 1) Then\n            i = i - 1 '-Same number, try again\n        Else\n            ran = ran &amp; test '-New number, add this\n        End If\n    Next i\n    Range(\"A\" &amp; Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row).Value = ran '- Print on last row of column \"A\"\nNext j\nRange(\"A:A\").RemoveDuplicates Columns:=1 '- Remove duplicates from column \"A\"\nEnd Sub\n</code></pre>\n\n<p>This would then print 500 random 8 digit numbers starting from <code>A2</code>, or the last empty cell in column <code>A</code>. Then proceed with removing the duplicates. </p>\n\n<p>You could check for duplicates each time, and thus making sure you actually end up with the specified amount of numbers. But it's extremely slow, and the chance to get a duplicate is really small (testrun of 10.000 numbers had a single duplicate for me).</p>\n"}], "owner": {"reputation": 11, "user_id": 11471281, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PAGPsvukCEw/AAAAAAAAAAI/AAAAAAAAAbI/AQqcTt_cKoA/photo.jpg?sz=128", "display_name": "JUAN FELIPE CAMELO CANCINO", "link": "https://stackoverflow.com/users/11471281/juan-felipe-camelo-cancino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557382121, "creation_date": 1557332875, "last_edit_date": 1557382121, "question_id": 56045181, "link": "https://stackoverflow.com/questions/56045181/generate-passwords", "title": "Generate passwords", "body": "<p>I need generate passwords that do not repeat and do not have the same consecutive number, in addition to having a length of 8 digits, only numbers. All this in Visual Basic for applications Excel. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 4, "creation_date": 1557331860, "post_id": 56044877, "comment_id": 98731624, "body": "Hmmm to open files you need both the path &amp; filename, <code>Dir()</code> only gives you back the filename so you need to add the path."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557331931, "post_id": 56044877, "comment_id": 98731654, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28461614/excel-vba-using-workbook-open-with-results-of-dirdirectory\">Excel VBA using Workbook.Open with results of Dir(Directory)</a>"}, {"owner": {"reputation": 832, "user_id": 655947, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/29f3099fd1a16252881ef1246f3dbe84?s=128&d=identicon&r=PG", "display_name": "level42", "link": "https://stackoverflow.com/users/655947/level42"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557331971, "post_id": 56044877, "comment_id": 98731674, "body": "@Damian, the Path is defined though ..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1557332027, "post_id": 56044877, "comment_id": 98731692, "body": "<code>Set wb = Workbooks.Open(Filename:=SourceFolder &amp; StrFile)</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557332054, "post_id": 56044877, "comment_id": 98731702, "body": "@level42 inded, but no on the <code>workbooks.open()</code> you are seeing that debugging the <code>StrFile</code> only give you the name, to use <code>workbooks.open()</code>you need the full path, no only the name of the file."}, {"owner": {"reputation": 832, "user_id": 655947, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/29f3099fd1a16252881ef1246f3dbe84?s=128&d=identicon&r=PG", "display_name": "level42", "link": "https://stackoverflow.com/users/655947/level42"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557332511, "post_id": 56044877, "comment_id": 98731910, "body": "Thanks @Damian and BigBen. This seems to have resolved my issue!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11471274, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/93614b8b45b00ccf50767eb7dadd57a8?s=128&d=identicon&r=PG", "display_name": "user11471274", "link": "https://stackoverflow.com/users/11471274/user11471274"}, "is_accepted": false, "score": 1, "last_activity_date": 1557332167, "creation_date": 1557332167, "answer_id": 56044997, "question_id": 56044877, "link": "https://stackoverflow.com/questions/56044877/loop-through-files-file-not-found/56044997#56044997", "title": "Loop Through Files - File not found", "body": "<p>The filename returned by <code>Dir</code> does not include the source folder. Unless you can reliably use the default folder as the source folder then you need to concatenate <em>SourceFolder</em> onto the <em>StrFile</em> or risk looking in the wrong folder.</p>\n\n<pre><code>Sub LoopThroughFiles()\n\n    Dim SourceFolder As String\n    SourceFolder = \"C:\\Users\\Jeff\\Downloads\\IO\\\"\n\n    Dim StrFile As String\n    StrFile = Dir(SourceFolder &amp; \"*.xls\")\n\n    Dim wb As Workbook\n\n    Do While Len(StrFile) &gt; 0\n        Debug.Print StrFile\n        Set wb = Workbooks.Open(Filename:=SourceFolder &amp; StrFile)\n        StrFile = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 832, "user_id": 655947, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/29f3099fd1a16252881ef1246f3dbe84?s=128&d=identicon&r=PG", "display_name": "level42", "link": "https://stackoverflow.com/users/655947/level42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557382068, "creation_date": 1557331712, "last_edit_date": 1557382068, "question_id": 56044877, "link": "https://stackoverflow.com/questions/56044877/loop-through-files-file-not-found", "title": "Loop Through Files - File not found", "body": "<p>So, I have this code that I found here: <a href=\"https://stackoverflow.com/a/10382861\">https://stackoverflow.com/a/10382861</a></p>\n\n<p>And when I first found it, I modified it to actually open the files that it found:</p>\n\n<pre><code>Sub LoopThroughFiles()\n    Dim SourceFolder As String\n    SourceFolder = \"C:\\Users\\Jeff\\Downloads\\IO\\\"\n\n    Dim StrFile As String\n    StrFile = Dir(SourceFolder &amp; \"*.xls\")\n\n    Dim wb As Workbook\n\n    Do While Len(StrFile) &gt; 0\n        Debug.Print StrFile\n        Set wb = Workbooks.Open(Filename:=StrFile)\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>When I first modified this code, it worked perfectly, and would open my files for me.</p>\n\n<p>So I decided to do a bit of house keeping, and cleaned up the code a bit, removed extra spaces etc, however now when I run this exact same code, it now tells me:</p>\n\n<blockquote>\n  <p>Runtime error \"1004\"<br>\n  Cannot find file \"Excelfile.xls\"</p>\n</blockquote>\n\n<p>I've not moved any files, I've not changed any paths, I've not renamed any files. Everything is exactly the same ... and yet it cannot find the files. I've also tested hard coding the path, with the same error.</p>\n\n<p>One thing I noticed that was interesting, is even if I go back to the bare bones code:</p>\n\n<pre><code>Sub LoopThroughFiles()\n    Dim StrFile As String\n    StrFile = Dir(\"C:\\Users\\Jeff\\Downloads\\IO\\*.xls\")\n    Do While Len(StrFile) &gt; 0\n        Debug.Print StrFile\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>and simply add a <code>Debug.Print Dir</code>, right after the <code>Debug.Print StrFile</code>. It seems that the StrFile and Dir are reading the wrong file at any given time.</p>\n\n<p>First print out is \"file1.xls\" and the second print out is \"file2.xls\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/khC1M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/khC1M.png\" alt=\"enter image description here\"></a></p>\n\n<p>Just not sure if this has anything to do with it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "edited": false, "score": 1, "creation_date": 1557331638, "post_id": 56044631, "comment_id": 98731534, "body": "Can you show us your full code, where you are capturing the BB column as an array? By the column, do you mean only non-empty values? More description is needed."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "edited": false, "score": 0, "creation_date": 1557340801, "post_id": 56045474, "comment_id": 98735854, "body": "To test I ran that below on an excel with column A having 4804 rows  Sub test() Dim LastRow &#39;    LastRow = Range(&quot;A1:A&quot; &amp; Rows.Count).End(xlUp).Row    Debug.Print LastRow  End Sub  It prints 1"}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "edited": false, "score": 0, "creation_date": 1557342111, "post_id": 56045474, "comment_id": 98736447, "body": "@RalphNelson Yes, there was a typo in the code. Try now, I&#39;ve tested it and it should work."}, {"owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "edited": false, "score": 0, "creation_date": 1557342197, "post_id": 56045474, "comment_id": 98736479, "body": "Yes, that now picks up the number of the last row.   Thanks!"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1557342148, "last_edit_date": 1557342148, "creation_date": 1557334003, "answer_id": 56045474, "question_id": 56044631, "link": "https://stackoverflow.com/questions/56044631/how-to-determine-the-length-of-a-particular-array/56045474#56045474", "title": "How to determine the length of a particular array", "body": "<p>If I understand correctly, you need the last row of <code>BB</code> column. To achieve that you can use <code>.End(xlUp).Row</code>. In your code it would be like this:</p>\n\n<pre><code>LastRow = Range(\"BB\" &amp; Rows.Count).End(xlUp).Row\nRange(\"BB5:BB\" &amp; LastRow).Select\nActiveSheet.Paste\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: This will not work in case the column is completely empty.</p>\n</blockquote>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557342148, "creation_date": 1557330866, "last_edit_date": 1557333081, "question_id": 56044631, "link": "https://stackoverflow.com/questions/56044631/how-to-determine-the-length-of-a-particular-array", "title": "How to determine the length of a particular array", "body": "<p>Determine the length of a particular array.  Have tried several variations of Value but no joy.</p>\n\n<p>Within a macro I've tried:</p>\n\n<pre><code>Range(\"BB4\").Select\nSelection.Copy\nRange(\"BB5\").Select\nRange(\"BB5:BB4804\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I want the UBound of BB which can vary and not paste in a particular value such as BB4804.</p>\n\n<p>The shown code works but if the length of the array (BB column) is less or exactly 4804.  But it increases, the longer cells are dropped.</p>\n"}, {"tags": ["arrays", "excel", "vba", "listobject"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557329596, "post_id": 56044134, "comment_id": 98730526, "body": "<code>ListObject.Parent</code> returns a reference to the sheet the table is on."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557329922, "post_id": 56044134, "comment_id": 98730698, "body": "You might also consider working with the <code>DataBodyRange</code> of the table as opposed to the <code>Range</code>."}, {"owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557329943, "post_id": 56044134, "comment_id": 98730705, "body": "@BigBen: Thank you very much, I solved it!"}, {"owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557330051, "post_id": 56044134, "comment_id": 98730766, "body": "@BigBen: Yes, something with &#39;tblDestinationTable.DataBodyRange&#39; would be nicer, however how to refer then to the combination of a subset of columns with a subset of rows?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557330163, "post_id": 56044134, "comment_id": 98730837, "body": "You could use <code>DataBodyRange.Cells</code> with references to the specific row(s) and column(s) in question."}, {"owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557330603, "post_id": 56044134, "comment_id": 98731056, "body": "@BigBen: Ah yes, I figured it out with DataBodyRange.Cells and now have to adjust some code to start at the correct row. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557330339, "post_id": 56044459, "comment_id": 98730924, "body": "Or <code>With tblDestinationTable.Parent</code>"}], "tags": [], "owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "is_accepted": true, "score": 0, "last_activity_date": 1557737256, "last_edit_date": 1557737256, "creation_date": 1557330278, "answer_id": 56044459, "question_id": 56044134, "link": "https://stackoverflow.com/questions/56044134/paste-array-to-certain-rows-and-column-within-table/56044459#56044459", "title": "Paste array to certain rows and column within table", "body": "<p>Below the code that solves the issue.</p>\n\n<pre><code>Function PasteArrayToTable(tblDestinationTable As ListObject, arrSourceArray() As Variant)\n\n'Note: works for arrays starting with index = 1 (option base 1)!\n\nDim lngHeaderRowPosition As Long\nDim intHeaderColumnPosition As Long\nDim lngFirstRow As Long\nDim lngLastRow As Long\nDim intFirstColumn As Integer\nDim intLastColumn As Integer\n\n'If the array contains rows, then write them to the destination table\nIf UBound(arrSourceArray, 1) &gt; 1 Then\n\n    'Get header position of destination table\n    lngHeaderRowPosition = tblDestinationTable.HeaderRowRange.Row\n    intHeaderColumnPosition = tblDestinationTable.HeaderRowRange.Column\n\n    'Determine positions where to write array to\n    lngFirstRow = lngHeaderRowPosition + tblDestinationTable.ListRows.Count + 1\n    lngLastRow = lngFirstRow + UBound(arrSourceArray, 1) - 1\n    intFirstColumn = intHeaderColumnPosition\n    intLastColumn = intFirstColumn + UBound(arrSourceArray, 2) - 1\n\n    'Write array contents to the bottom of the destination table\n    With tblDestinationTable.Parent\n        .Range(.Cells(lngFirstRow, intFirstColumn), .Cells(lngLastRow, intLastColumn)).Value = arrSourceArray\n    End With\n\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 56044459, "answer_count": 1, "score": 0, "last_activity_date": 1557737256, "creation_date": 1557329111, "last_edit_date": 1557329266, "question_id": 56044134, "link": "https://stackoverflow.com/questions/56044134/paste-array-to-certain-rows-and-column-within-table", "title": "Paste array to certain rows and column within table", "body": "<p>I wrote a function to write the contents of a 2-dimensional array to an existing table. Nothing will be removed from the table. The new rows must be added at the bottom. The number of columns depends on the size of the 2nd dimension of the array and I take as an assumption that the table has enough columns.</p>\n\n<p>My issue is: how can I refer to the range in the table without:\na) having the sheet with the table as the active sheet and\nb) without having to reference the worksheet (like is now present in the code; see below)?</p>\n\n<p>See the code below that I tried.</p>\n\n<pre><code>Function PasteArrayToTable(tblDestinationTable As ListObject, arrSourceArray() As Variant)\n\n'Note: works for arrays starting with index = 1 (option base 1)!\n\nDim lngNewRows As Long\nDim lngHeaderRowPosition As Long\nDim intHeaderColumnPosition As Long\nDim lngFirstRow As Long\nDim lngLastRow As Long\nDim intFirstColumn As Integer\nDim intLastColumn As Integer\nDim lngNrOfRecordsAtStart As Long\n\n'Number of rows to be added\nlngNewRows = UBound(arrSourceArray, 1)\n\n'If the array contains rows, then write them to the destination table\nIf lngNewRows &gt; 1 Then\n\n    'Get header position of destination table\n    lngHeaderRowPosition = tblDestinationTable.HeaderRowRange.Row\n    intHeaderColumnPosition = tblDestinationTable.HeaderRowRange.Column\n\n    'Get number of records in table before pasting array, in order to remove afterwards an empty row if the table has 0 rows\n    lngNrOfRecordsAtStart = tblDestinationTable.ListRows.Count\n\n    'Add rows to table\n    tblDestinationTable.Resize tblDestinationTable.Range.Resize(tblDestinationTable.Range.Rows.Count + lngNewRows)\n\n    'Determine positions where to write array to\n    lngFirstRow = lngHeaderRowPosition + tblDestinationTable.ListRows.Count + 1 - lngNewRows\n    lngLastRow = lngHeaderRowPosition + tblDestinationTable.ListRows.Count\n    intFirstColumn = intHeaderColumnPosition\n    intLastColumn = intFirstColumn - 1 + UBound(arrSourceArray, 2)\n\n    'Write array to determined positions. Note: there's no check whether the table has the required number of columns, nor\n    'whether the number of lines fit on the page\n    Dim wks As Worksheet\n    Set wks = Worksheets(\"Blad1\")\n    With wks\n        .Range(.Cells(lngFirstRow, intFirstColumn), .Cells(lngLastRow, intLastColumn)).Value = arrSourceArray\n    End With\n\n    'Remove empty row if present\n    If lngNrOfRecordsAtStart = 0 Then\n        tblDestinationTable.ListRows(1).Delete\n    End If\n\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>So how to make a reference to the 'cells' in the table?</p>\n"}, {"tags": ["html", "vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557329611, "post_id": 56043915, "comment_id": 98730536, "body": "You need to build another <code>&lt;ul&gt;</code> nested beneath one of your <code>&lt;li&gt;</code> items. You can tinker with HTML here: <a href=\"https://www.w3schools.com/code/tryit.asp?filename=G3UBZA6VM2WS\" rel=\"nofollow noreferrer\">w3schools.com/code/tryit.asp?filename=G3UBZA6VM2WS</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557330106, "post_id": 56043915, "comment_id": 98730806, "body": "Pure HTML approach you can use the <code>li type</code> (<a href=\"https://www.w3schools.com/tags/att_li_type.asp\" rel=\"nofollow noreferrer\">w3schools.com/tags/att_li_type.asp</a>) or configure the <code>ul</code> element&#39;s <code>style</code> attribute like: <code>&lt;ul style=&quot;list-style-type:circle;&quot;&gt;</code>."}, {"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557330308, "post_id": 56043915, "comment_id": 98730911, "body": "Perfect - thank you!  Any advice for formatting the bullet points themselves?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557331144, "post_id": 56043915, "comment_id": 98731323, "body": "If you poke around w3 you&#39;ll find that information as well. Though it might ultimately be easier to create an empty email and then edit it via its <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.inspector.wordeditor\" rel=\"nofollow noreferrer\"><code>WordEditor</code></a>, that way you have full access to all of the defined styles &amp; formatting in MS Word, rather than trying to conjure up the raw HTML from scratch."}, {"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557331485, "post_id": 56043915, "comment_id": 98731479, "body": "Thank you everyone, much appreciated!"}, {"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557334834, "post_id": 56043915, "comment_id": 98732961, "body": "I updated my question above - we&#39;re almost there. Thanks again."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557338873, "post_id": 56043915, "comment_id": 98734985, "body": "Is the error that the code won&#39;t compile? it looks like you&#39;ve got mismatched quotes. Since the HTML <i>is</i> a string literal, and a set of double-quotes marks the beginning &amp; end of a string, you can&#39;t <i>also</i> use double-quotes <i>within</i> the HTML, unless you escape them. Or, I think you can also use single-quote within the string, like: <code>&quot;&lt;ul style=&#39;list-style-type:disc;&#39;&gt;&quot;</code>"}, {"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557339624, "post_id": 56043915, "comment_id": 98735345, "body": "When I run the code using apostrophes instead of quotation marks, the macro works and doesn&#39;t display an error message.  However, the bullet points are still stars, not circles, even though I have the definition in the first &lt;&gt; to be &quot;&lt;ul style=&#39;list-style-type:disc;&#39;&gt;&quot;."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557340910, "post_id": 56043915, "comment_id": 98735901, "body": "Can you provide more of your code so that I can see fully what you&#39;re doing? It&#39;s best to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I don&#39;t think the problem relates to this single line of code (whether I specify the list-style-type property or not, the bullets for me are the &quot;disc&quot; style, so this would seem to be the default style -- I don&#39;t even see &quot;star&quot; as one of the options in Outlook)"}, {"owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557341374, "post_id": 56043915, "comment_id": 98736130, "body": "Yes of course, I&#39;ve updated the code above."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1557342759, "creation_date": 1557342759, "answer_id": 56047551, "question_id": 56043915, "link": "https://stackoverflow.com/questions/56043915/how-to-modify-bullets/56047551#56047551", "title": "How to modify bullets?", "body": "<p>In order to create multi-level list, you can simply construct another <code>&lt;ul&gt;</code> nested beneath one of your <code>&lt;li&gt;</code> items. You can tinker with HTML here: </p>\n\n<p><a href=\"http://w3schools.com/code/tryit.asp?filename=G3UBZA6VM2WS\" rel=\"nofollow noreferrer\">http://w3schools.com/code/tryit.asp?filename=G3UBZA6VM2WS</a></p>\n\n<p>To control the list item style for an individual <code>&lt;li&gt;</code> item, specify it's <a href=\"https://www.w3schools.com/tags/att_li_type.asp\" rel=\"nofollow noreferrer\"><code>type</code> attribute</a>`.</p>\n\n<p>To set the list item style for <em>all</em> items in a list, specify the <a href=\"https://www.w3schools.com/tags/att_ul_type.asp\" rel=\"nofollow noreferrer\"><code>style</code> attribute</a> with the appropriate css, e.g.:</p>\n\n<pre><code>\"&lt;ul style='list-style-type:disc'&gt;\"\n</code></pre>\n\n<p>Note the use of single-quotes within the quoted string :) </p>\n\n<p>Finally, and I now suspect that this was your problem all along (disc style appears to be the default in Outlook, so you probably don't need to <em>specify</em> it as such):</p>\n\n<p>You can't mix <code>.Body</code> and <code>.HTMLBody</code>. You need to use one or the other. If you use <code>.Body</code>, the email will be plain text and will <strong>not</strong> accept or render HTML. So you should convert all of your <code>.Body</code> assignments to the appropriate <code>.HTMLBody</code> instead. Untested, but should be something like this:</p>\n\n<pre><code>With objEmail\n    .To = \"abc@xyz.com\"\n    .Subject = \"TEST1: May 2019 Budget\"\n    .HTMLBody = \"Kurt,\"\n    .HTMLBody = .HTMLBody &amp; \"&lt;br&gt;\"\n    .HTMLBody = .HTMLBody &amp; \"&lt;p&gt;The potential \" &amp; MonthName(Month(ActiveSheet.Range(\"A2\"))) &amp; \" invoices are below.&lt;/p&gt;\"\n    .HTMLBody = .HTMLBody &amp; \"&lt;br&gt;\"\n    For i = 1 To CaseCount\n        If ActiveSheet.Cells(i + 5, 4).Value = \"Yes\" Then\n            .HTMLBody = .HTMLBody &amp; \"&lt;ul style='list-style-type:disc;'&gt;\" &amp; \"&lt;li&gt;\" &amp; ActiveSheet.Cells(i + 5, 2).Value &amp; \" - \" &amp; Format(ActiveSheet.Cells(i + 5, 6).Value, \"Currency\") &amp; \" (\" &amp; Format(ActiveSheet.Cells(i + 5, 8).Value, \"Currency\") &amp; \" without budget or invoicing).\" &amp; \"&lt;/li&gt;\" &amp; \"&lt;ul&gt;\" &amp; \"&lt;li&gt;\" &amp; \"Last billed \" &amp; ActiveSheet.Cells(i + 5, 10) &amp; \".\" &amp; \"&lt;/li&gt;\" &amp; \"&lt;/ul&gt;\" &amp; \"&lt;/ul&gt;\"\n        End If\n    Next i\n    .HTMLBody = .HTMLBody &amp; \"&lt;br&gt;&lt;br&gt;\"\n    .HTMLBody = .HTMLBody &amp; \"&lt;p&gt;\" &amp; \"Thank you,\" &amp; \"&lt;/p&gt;\" \n    .HTMLBody = .HTMLBody &amp; \"&lt;p&gt;\" &amp; \"Karen\" &amp; \"&lt;/p&gt;\" \n    .Display\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11470923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1315db16cd2895e9db140e07bad7704b?s=128&d=identicon&r=PG&f=1", "display_name": "ASalley", "link": "https://stackoverflow.com/users/11470923/asalley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 56047551, "answer_count": 1, "score": 1, "last_activity_date": 1609815975, "creation_date": 1557328448, "last_edit_date": 1609815975, "question_id": 56043915, "link": "https://stackoverflow.com/questions/56043915/how-to-modify-bullets", "title": "How to modify bullets?", "body": "<p>How do I format the bullet point itself?</p>\n<p>The bullet points all appear as stars instead of a normal black circle for the first bullet and a hollow circle for the sub-bullet.</p>\n<p>I tried to define the style but my code gives me an error message when I add <code>list-style-type:disc;</code>.</p>\n<p>Using w3schools this is how I understand it should work.</p>\n<pre><code>Sub Email_Budget()\n   \n   Dim objOutlook As Object\n   Set objOutlook = CreateObject(&quot;Outlook.Application&quot;)\n   \n   Dim objEmail As Object\n   Set objEmail = objOutlook.CreateItem(olMailItem)\n   \n   Dim CaseCount As Long\n   CaseCount = WorksheetFunction.CountA(Range(&quot;B6:B500&quot;))\n   Debug.Print CaseCount\n   \n   Dim i As Integer\n   \n   With objEmail\n      .To = &quot;abc@xyz.com&quot;\n      .Subject = &quot;TEST1: May 2019 Budget&quot;\n      .Body = &quot;Kurt,&quot;\n      .Body = .Body &amp; &quot; &quot;\n      .Body = .Body &amp; &quot;The potential &quot; &amp; MonthName(Month(ActiveSheet.Range(&quot;A2&quot;))) &amp; &quot; invoices are below.&quot;\n      .Body = .Body &amp; &quot; &quot;\n      For i = 1 To CaseCount\n        If ActiveSheet.Cells(i + 5, 4).Value = &quot;Yes&quot; Then\n            .HTMLBody = .HTMLBody &amp; &quot;&lt;ul style='list-style-type:disc;'&gt;&quot; &amp; &quot;&lt;li&gt;&quot; &amp; ActiveSheet.Cells(i + 5, 2).Value &amp; &quot; - &quot; &amp; Format(ActiveSheet.Cells(i + 5, 6).Value, &quot;Currency&quot;) &amp; &quot; (&quot; &amp; Format(ActiveSheet.Cells(i + 5, 8).Value, &quot;Currency&quot;) &amp; &quot; without budget or invoicing).&quot; &amp; &quot;&lt;/li&gt;&quot; &amp; &quot;&lt;ul&gt;&quot; &amp; &quot;&lt;li&gt;&quot; &amp; &quot;Last billed &quot; &amp; ActiveSheet.Cells(i + 5, 10) &amp; &quot;.&quot; &amp; &quot;&lt;/li&gt;&quot; &amp; &quot;&lt;/ul&gt;&quot; &amp; &quot;&lt;/ul&gt;&quot;\n        End If\n      Next i\n      .Body = .Body &amp; &quot; &quot;\n      .Body = .Body &amp; &quot; &quot;\n      .Body = .Body &amp; &quot;Thank you,&quot;\n      .Body = .Body &amp; &quot;Karen&quot;\n      .Display\n   End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565772992, "post_id": 56043836, "comment_id": 101452736, "body": "I am confused and do not understand the problem.  It is clear what All Inbox is, but what is the default folder if it isn&#39;t the Inbox?  Why won&#39;t NewMailEx work? Rules can be trigger macros, why won&#39;t a rule work?"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1557346659, "creation_date": 1557346659, "answer_id": 56048447, "question_id": 56043836, "link": "https://stackoverflow.com/questions/56043836/how-to-monitor-a-specific-folder-not-the-default-inbox-so-it-fires-another-mac/56048447#56048447", "title": "How to monitor a specific folder (not the default inbox) so it fires another macro when items are added?", "body": "<p>Your missing <strong><code>S</code></strong> on <code>objNS.Folder</code> Should be <code>objNS.Folders(\"All Inbox\").Folders(\"Inbox\")</code></p>\n\n<p><code>Application_Startup</code> event Should be under <strong><code>ThisOutlookSession</code></strong> class module and you could also have your <code>RunRules</code> sub in the same madule.</p>\n"}], "owner": {"reputation": 13, "user_id": 9778024, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155930684583725/picture?type=large", "display_name": "Joe Scholes", "link": "https://stackoverflow.com/users/9778024/joe-scholes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592464678, "creation_date": 1557328222, "last_edit_date": 1592464678, "question_id": 56043836, "link": "https://stackoverflow.com/questions/56043836/how-to-monitor-a-specific-folder-not-the-default-inbox-so-it-fires-another-mac", "title": "How to monitor a specific folder (not the default inbox) so it fires another macro when items are added?", "body": "<p>I created a pst file called All Inbox and have rules to move all email from all other accounts into its Inbox.</p>\n\n<p>I have a macro that runs all those rules at once (RunRules) to process messages (move, print, file, etc.) from the All Inbox/Inbox folder, but I have to run it manually (I have a button on the Quick Access Toolbar). </p>\n\n<p>I want to monitor the All Inbox/Inbox folder and fire my RunRules macro.</p>\n\n<p>The code I've seen monitors the default folder. I don't know how to modify the code to specify the All Inbox/Inbox folder. </p>\n\n<p>I also don't know where to put the options, subs, etc. All in a new module?</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents objItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim objNS As Outlook.NameSpace\n    Dim objWatchFolder As Outlook.Folder\n\n    Set objNS = Application.GetNamespace(\"MAPI\")\n    Set objWatchFolder = objNS.Folder(\"All Inbox\").Folders(\"Inbox\")\n\n    Set objItems = objWatchFolder.Items\nEnd Sub\nPrivate Sub olkFolder_ItemAdd(ByVal Item As Object)\n    Dim xitem As Outlook.MailItem\n    If Item.Class = olMail Then\n        RunRules\n    End If\nEnd Sub\n</code></pre>\n\n<p>Do I specify All Inbox as a store?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 9017382, "user_type": "registered", "profile_image": "https://graph.facebook.com/1753841144917062/picture?type=large", "display_name": "Jin Zhen", "link": "https://stackoverflow.com/users/9017382/jin-zhen"}, "is_accepted": true, "score": 0, "last_activity_date": 1557763430, "last_edit_date": 1557763430, "creation_date": 1557328184, "answer_id": 56043820, "question_id": 56043640, "link": "https://stackoverflow.com/questions/56043640/subform-blocking-recordset-addnew-error-3027/56043820#56043820", "title": "Subform blocking Recordset.AddNew (Error 3027)", "body": "<p>There is nothing wrong with my code. There is a property option in the form object, it's called \"record lock\", somehow mine had \"All Records\" selected. By making it \"No locks\", the accessibility problem is gone.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eAOdW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eAOdW.png\" alt=\"Form Property Sheet\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 9017382, "user_type": "registered", "profile_image": "https://graph.facebook.com/1753841144917062/picture?type=large", "display_name": "Jin Zhen", "link": "https://stackoverflow.com/users/9017382/jin-zhen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56043820, "answer_count": 1, "score": 0, "last_activity_date": 1594779737, "creation_date": 1557327602, "last_edit_date": 1594779737, "question_id": 56043640, "link": "https://stackoverflow.com/questions/56043640/subform-blocking-recordset-addnew-error-3027", "title": "Subform blocking Recordset.AddNew (Error 3027)", "body": "<p>Having a subform displaying the same table used in recordset makes the table read only (error 3027). Getting rid of the subform fixes the problem. Similar setup works in my other form interface.</p>\n\n<p>I tried to delete the subform, which fix the accessibility problem. But that would defeat the original UX purpose.</p>\n\n<pre><code>Option Explicit\nPublic UnitRS As DAO.Recordset\nPublic ModelRS As DAO.Recordset\nPublic NameUnitRecords As String\nPublic NameModelRecords As String\n\nPublic Sub Form_Load()\n    'Initialization\n    NameUnitRecords = \"tblBatteriesMainRecordsUnits\"\n    NameModelRecords = \"tblBatteriesRecordsModels\"\nEnd Sub\n\nPrivate Sub SetUnitRecordsets()\n    'Set the path to the Battery Records table\n    Set UnitRS = CurrentDb.OpenRecordset(NameUnitRecords, dbOpenDynaset)\nEnd Sub\n\nPrivate Sub txtBatteryID_AfterUpdate()\n    'Set the recordset path for unit records\n    Call SetUnitRecordsets\n\n    'do a findfirst search for the Battery ID, using value from textbox txtBatteryID\n    UnitRS.FindFirst \"[Battery ID]=\" &amp; txtBatteryID\n\n    'If no matching record, leave the other fields empty\n    If UnitRS.NoMatch Then\n    'If there is a matching record, then, grab the model number\n    Else\n        'as there is an existing record with model number, run a search on the model number and grab the model info\n    End If\n    'close recordset\n    UnitRS.Close\n    'check if the button can be enabled\nEnd Sub\n\nPrivate Sub cmbModelNumber_AfterUpdate()\n    'Set the recordset path for model records    \n    'do a findfirst search for the Model Number, using value from combobox cmbModelNumber\n    'If no matching record, leave the other fields empty\n    If ModelRS.NoMatch Then\n     'If there is a matching record, then, grab the Model Info\n    Else\n    End If\n    'close recordset \n    'check if the button can be enabled\nEnd Sub\n\nPrivate Sub btnSaveAndCLear_Click()\n    Dim Response, strOldModelNumber\n\n    'Set the recordset path for unit records\n    Call SetUnitRecordsets\n    'Set the recordset path for model records\n    'close all related tables, queries and forms\n    DoCmd.Close acTable, NameUnitRecords, acSaveYes\n    DoCmd.Close acForm, \"frmSubBatteriesMainRecordsUnits\", acSaveYes\n\n    'If a new model record is required\n    ModelRS.FindFirst \"[Model Number]='\" &amp; cmbModelNumber &amp; \"'\"\n    If ModelRS.NoMatch Then\n        'msg box confirm model information\n        'If user chooses yes\n        If Response = vbYes Then\n            'create new model record\n            'this block could be done with \"With...End\" format for less error vulerability?\n            'nah, unless it is repetitively called, it's too much work to inplement just the .addnew part\n            'requery the two combobox to reflect newest changes\n        'User chooses no\n        Else\n            'popup a message telling the user the battery and model record is not logged, but don't clear the field.\n            Exit Sub\n        End If\n    End If\n    'need to find the record first, otherwise it will edit the first one\n    UnitRS.FindFirst \"[Battery ID]=\" &amp; txtBatteryID\n    'store the old model number value\n    strOldModelNumber = UnitRS(\"Model Number\")\n    'New record\n    If UnitRS.NoMatch Then\n        'create a new battery record\n        UnitRS.AddNew\n        UnitRS(\"Battery ID\") = Me.txtBatteryID\n    'If this is an edit on existing record\n    Else\n        'if the new value is the same as the old one\n        If strOldModelNumber = cmbModelNumber Then\n            'msgbox the same value, no change is done to the database\n            MsgBox \"the data is the same as the old record, no change is made to the record\", vbInformation, \"Same data\"\n            Exit Sub\n        Else\n            'msg box confirm edit\n            Response = MsgBox(\"Please confirm edit on existing record: \" &amp; Chr(13) &amp; Chr(10) &amp; \"BatteryID: \" &amp; txtBatteryID &amp; Chr(13) &amp; Chr(10) &amp; \"Model Number: \" &amp; cmbModelNumber, vbYesNo, \"New Model Record Dectected\")\n            'If user chooses yes\n            If Response = vbYes Then\n                'goto edit mode\n                UnitRS.Edit\n            'if user chooses no\n            Else\n                'msgbox notify the user nothing is changed in the database\n                MsgBox \"Battery and Model record not logged, you may retry logging\", vbInformation, \"Record not logged\"\n                Exit Sub\n            End If\n        End If\n    End If\n    'both changes the model number and comment field anyway\n    UnitRS(\"Model Number\") = Me.cmbModelNumber\n    UnitRS(\"Comment\") = Me.txtComment\n    'commit update\n    UnitRS.Update\n    UnitRS.Close\n\n    'clear all flieds\n    'reset all locks    \n    'requery the sub form to reflect the newest changes\n    Me.subFrmBatteryRecords.Requery\nEnd Sub\n</code></pre>\n\n<p>What I would like to achieve is to have a display in the form interface to show the content of the actual record table, so that the user knows what is in the table.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1557327036, "post_id": 56043321, "comment_id": 98728975, "body": "This event <code>Worksheet_Change2</code>  does not exist in Excel and therefore will never fire. You cannot change the names of events."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557327049, "post_id": 56043321, "comment_id": 98728984, "body": "<code>Worksheet_Change2</code> does not work because it&#39;s not an event handler. How do you know <code>Worksheet_Change</code> does not work?"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1557327080, "post_id": 56043321, "comment_id": 98728998, "body": "I find that the events often don&#39;t fire after an error has occurred (and also sometimes seemingly at random). The only way I have found to restart the events is to completely close and restart Excel."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 3, "creation_date": 1557327177, "post_id": 56043321, "comment_id": 98729046, "body": "@Gravitate If events don&#39;t fire after an error occurs then this is probably because someone used <code>Application.EnableEvents = False</code> without a correct error handling that re-activates it in case of error. \u2022 I have never discovered non-fired events after errors in Excel."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557327248, "post_id": 56043321, "comment_id": 98729090, "body": "@P\u1d07\u029c Ah, Thanks! I&#39;ll check for that."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 1, "creation_date": 1557327320, "post_id": 56043321, "comment_id": 98729131, "body": "@Gravitate see <a href=\"https://stackoverflow.com/a/53395180\">Catch user error and re-enable application.events after error</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557327645, "post_id": 56043321, "comment_id": 98729344, "body": "@Jonathan Make 100% sure your event does not run by adding a breakpoint or a massage box like <code>MsgBox &quot;I run&quot;</code> as first line in the event&#39;s code. Then write something to a cell in the workbook."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557327147, "post_id": 56043454, "comment_id": 98729034, "body": "If the OP&#39;s code does not work, your code won&#39;t either."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557327339, "post_id": 56043454, "comment_id": 98729147, "body": "@GSerg I put his 2 procedures on the same, if he means the font color wont change, this solves it. If he wants everything changed on the sheet changing the font color, taking the line out of the conditional will do too."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 2, "creation_date": 1557327464, "post_id": 56043454, "comment_id": 98729231, "body": "@Damian I don&#39;t think the OP is saying that his code isn&#39;t working correctly. I think he is saying that the event isn&#39;t firing at all, irrelevant of what code is in the event handler. Or at least that is how I read it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1557327483, "post_id": 56043454, "comment_id": 98729242, "body": "The OP is saying neither of the two handlers work. That means this united handler will not work either, because there is something else that prevents the otherwise correctly looking <code>Worksheet_Change</code> from firing."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557327962, "post_id": 56043454, "comment_id": 98729522, "body": "May he be waiting for the color procedure because the time is already there but he didn&#39;t notice? Anyway until he give us further info can&#39;t do much else. If this doesn&#39;t help i&#39;ll delete the answer."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1557326934, "creation_date": 1557326934, "answer_id": 56043454, "question_id": 56043321, "link": "https://stackoverflow.com/questions/56043321/worksheet-event-not-firing/56043454#56043454", "title": "Worksheet Event Not Firing", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n\n    Dim ThisRow As Long\n\n    If Target.Column = 14 And Target.Value = \"In Progress\" Then\n        ThisRow = Target.Row\n        Range(\"S\" &amp; ThisRow).Value = Format(Now(), \"mm/dd/yyyy\")\n        Target.Font.ColorIndex = 5\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This worked fine for me. Get used to develop using <code>Option Explicit</code>because it will force you to declare all your variables and that is the way to avoid errors.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4354933, "user_type": "registered", "profile_image": "https://graph.facebook.com/729565351/picture?type=large", "display_name": "Jonathan Semtner", "link": "https://stackoverflow.com/users/4354933/jonathan-semtner"}, "is_accepted": true, "score": 0, "last_activity_date": 1557414730, "creation_date": 1557414730, "answer_id": 56062544, "question_id": 56043321, "link": "https://stackoverflow.com/questions/56043321/worksheet-event-not-firing/56062544#56062544", "title": "Worksheet Event Not Firing", "body": "<p>Thank you so much for the quick answers!! I managed to get it to work but I am not 100% sure how I did it to be honest :)</p>\n\n<p>I think it was just excel acting strangely. At the time, I was flipping the titles just in case \"worksheet_change\" was a specific excel name (and not just a common user generated one) and it still wasn't working. Eventually, the date started popping up but the highlighting still won't work. </p>\n\n<p>I had the highlight in there because it was a test. That code was pulled directly from an MS site, so I was using it as a control group. We can go ahead and close it. Thank you all for your help!!!</p>\n"}], "owner": {"reputation": 1, "user_id": 4354933, "user_type": "registered", "profile_image": "https://graph.facebook.com/729565351/picture?type=large", "display_name": "Jonathan Semtner", "link": "https://stackoverflow.com/users/4354933/jonathan-semtner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 56062544, "answer_count": 2, "score": 0, "last_activity_date": 1557414730, "creation_date": 1557326551, "last_edit_date": 1557326968, "question_id": 56043321, "link": "https://stackoverflow.com/questions/56043321/worksheet-event-not-firing", "title": "Worksheet Event Not Firing", "body": "<p>My basic worksheet event code is not working.</p>\n\n<p>I have the following code included in my Sheet4 workbook (where I want it to run):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nIf Target.Column = 14 Then\n    ThisRow = Target.Row\n    If Target.Value = \"In Progress\" Then\n        Range(\"S\" &amp; ThisRow).Value = Format(Now(), \"mm/dd/yyyy\")\n    End If\nEnd If \nEnd Sub\n\nPrivate Sub Worksheet_Change2(ByVal Target As Range)\n    Target.Font.ColorIndex = 5\nEnd Sub\n</code></pre>\n\n<p>-This is in my \"Sheet 4\" Project (i.e. when I click right click on the tab and click \"View Code\", it pulls directly into the vba and I see my code there) </p>\n\n<p>-I have checked my trust center and all macros are enabled. The sheet is saved on my desktop, so it should be a trusted location.</p>\n\n<p>I have no idea why neither of the above code blocks are working. When I have an executable macro clicked, that works (i.e. do this when I tell this macro to run).</p>\n\n<p>Finally, this excel is saved as a macro enabled workbook.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557328345, "post_id": 56043286, "comment_id": 98729777, "body": "Previously: <a href=\"https://stackoverflow.com/questions/10917896/how-to-create-a-new-form-instance-using-the-name-of-the-form-as-a-string\" title=\"how to create a new form instance using the name of the form as a string\">stackoverflow.com/questions/10917896/&hellip;</a>"}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557328594, "post_id": 56043286, "comment_id": 98729934, "body": "@TimWilliams: Thanks, I did not see the duplicate! Ah, too bad it&#39;s not possible. Closing my question as a dupe."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557328619, "post_id": 56043286, "comment_id": 98729952, "body": "Don&#39;t. I have a draft..."}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557328664, "post_id": 56043286, "comment_id": 98729979, "body": "@MathieuGuindon: Ah, ok, then I&#39;ll wait."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557328996, "post_id": 56043286, "comment_id": 98730179, "body": "Question though: I&#39;m not very familiar with Access - would <code>Forms(&quot;formName&quot;)</code> yield a reference to the default instance if the form isn&#39;t loaded or opened?"}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557329144, "post_id": 56043286, "comment_id": 98730266, "body": "@MathieuGuindon: No, that yields a run-time error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557329801, "post_id": 56043286, "comment_id": 98730639, "body": "Ugh. Gets tricky. I&#39;ll delete my answer then, I&#39;m guessing <code>Select Case</code> was obvious, and without a default instance of the form class then the factory / <code>CallByName</code> approach doesn&#39;t hold water."}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557331632, "post_id": 56043286, "comment_id": 98731531, "body": "@MathieuGuindon: No problem, thank you for your efforts!"}], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1557329807, "answer_count": 0, "score": 1, "last_activity_date": 1594779747, "creation_date": 1557326403, "last_edit_date": 1594779747, "question_id": 56043286, "link": "https://stackoverflow.com/questions/56043286/how-do-i-create-a-new-form-instance-whose-name-i-have-in-a-string", "closed_reason": "Duplicate", "title": "How do I create a new form instance whose name I have in a string?", "body": "<p>In MS Access, there are two ways to open a new form:</p>\n\n<ol>\n<li><p><code>DoCmd.OpenForm \"myForm\"</code> - opens the \"default instance\" of a form</p></li>\n<li><p><code>Set frm = New Form_myForm : frm.Visible = True</code> - opens a <em>new</em> instance of a form.</p></li>\n</ol>\n\n<p>I need to use the second option, because I want to open multiple instances of <code>myForm</code>. (If you are unfamiliar with it, more details about this technique can be found <a href=\"http://www.allenbrowne.com/ser-35.html\" rel=\"nofollow noreferrer\">here</a>.)</p>\n\n<p>How would I do that if I have <strong>the name of the form</strong> only available as a <strong>string</strong>? I.e., I need to write some library method</p>\n\n<pre><code>Sub OpenAnotherInstanceOfForm(ByVal formName As String)\n    Dim frm As Form ' or Object, late binding is fine for me in this case\n\n    Set frm = ... ' &lt;-- What goes here?\n    frm.Visible = True\n\n    ... ' Persist the object reference, so that frm stays open. I know how to do that.\nEnd Sub\n</code></pre>\n\n<p>Here is what I have already tried:</p>\n\n<ul>\n<li><code>Set frm = CreateObject(\"Form_\" &amp; formName)</code> - Run time error 429</li>\n<li><code>Set frm = Eval(\"New Form_\" &amp; formName)</code> - Run time error 2482</li>\n</ul>\n"}, {"tags": ["excel", "vba", "function", "compilation"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 5, "creation_date": 1557326535, "post_id": 56043221, "comment_id": 98728679, "body": "You have a lot of errors there... You should use <code>Option Explicit</code> at the top of your code (outside the procedure) and try to ident all of this. I tried there but without more info there are many things wrong that I can&#39;t correct without know what are you doing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557327567, "post_id": 56043221, "comment_id": 98729295, "body": "What Damian said. Using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> will ensure indentation is standard and consistent."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1557328683, "post_id": 56043221, "comment_id": 98729994, "body": "If you don&#39;t use <code>Application.ScreenUpdating=True</code> at the end of your <code>Sub</code>, you won&#39;t see the results.  Recommend prior to the <code>MsgBox</code>.  Same is true for calculation."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9936829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25c8d55a3d6faaf92257cfbed8e2df6b?s=128&d=identicon&r=PG&f=1", "display_name": "Petrulli", "link": "https://stackoverflow.com/users/9936829/petrulli"}, "is_accepted": false, "score": 0, "last_activity_date": 1557331133, "creation_date": 1557331133, "answer_id": 56044728, "question_id": 56043221, "link": "https://stackoverflow.com/questions/56043221/compilation-error-sub-or-function-not-defined/56044728#56044728", "title": "compilation error, Sub or Function not defined", "body": "<p>This error usually occurs when the sub is in the worksheet and not in a new module. </p>\n\n<p>If it's in a module already, please check if the name of the module is different of \"module1\".</p>\n"}], "owner": {"reputation": 1, "user_id": 9574785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216256524068395/picture?type=large", "display_name": "Maxence Damarey", "link": "https://stackoverflow.com/users/9574785/maxence-damarey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557331133, "creation_date": 1557326169, "last_edit_date": 1557327398, "question_id": 56043221, "link": "https://stackoverflow.com/questions/56043221/compilation-error-sub-or-function-not-defined", "title": "compilation error, Sub or Function not defined", "body": "<p>Currently realising a project for my company to highlight anomalies in orders, I wrote this VBA code in order to compare status of orders and a day date difference between the current date and the order date . The dates are as follows on the csv : \"2019-05-06 3:11pm\"</p>\n\n<p>When I affecte the macro to a button and click on it I get this error : \"Compilation error, Sub or function not defined\" and the debugger cursor points on \"Sub Problem()\"...</p>\n\n<p>I hope you can help me!! thanks by advance :)</p>\n\n<p>here is my code :</p>\n\n<pre><code>Sub Problem()\n\nDim orderDate As Date\nDim difDate\nDim statusToUse As Range\nSet statusToUse = Range(\"C2:C100\")\nDim statusCell As Range\nDim a As String\na = \"accepted\"\nDim s As String\ns = \"shipped\"\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim l As Integer\nDim m As Integer\nDim dateToUse As Range\nSet dateToUse = Range(\"D2:D100\")\nDim dateCell As Range\nDim currentDate As String\ncurrentDate = Date\ny = Split(Split(Range(\"A1\").Value, \":\")(1), \"-\")\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nFor Each statusCell In statusToUse.Areas\nFor Each dateCell In dateToUse.Areas\n\norderDate = DateValue(Join(Array(y(2), y(1), y(0)), \"-\"))\ndifDate = DateDiff(\"d\", currentDate, orderDate)\n\nIf status = a And difDate &lt;= 7 Then\nstatus.Interior.ColorIndex = 46\ni = i + 1\n\nElseIf status = a And difDate &lt;= 2 Then\nstatus.Interior.ColorIndex = 27\nj = j + 1\n\nElseIf status = a And difDate &gt; 7 Then\nstatus.Interior.ColorIndex = 3\nk = k + 1\n\nElseIf status = s Then\nstatus.Interior.ColorIndex = 10\nl = l + 1\n\nElse\nm = m + 1\n\nEnd If\n\ni = i - j\n\nNext dateCell\nNext statusCell\n\nMsgBox \"There are\" + i + \"risky orders\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "combobox", "userform"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1557326822, "creation_date": 1557326822, "answer_id": 56043419, "question_id": 56043206, "link": "https://stackoverflow.com/questions/56043206/populate-combobox-with-two-text-fields-from-an-array/56043419#56043419", "title": "Populate Combobox with Two Text Fields from an Array", "body": "<p>Imagine this data in <code>Worksheets(\"Sheet1\")</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/zmMLy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zmMLy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Populate your combobox <code>ComboBox1</code> like this: Loop through the data and use <code>.AddItem</code> to add a combination of both data columns.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim Data() As Variant 'array\n    Data = Worksheets(\"Sheet1\").Range(\"A1:B4\").Value 'read data into array\n\n    Me.ComboBox1.Clear\n\n    Dim iRow As Long\n    For iRow = LBound(Data, 1) To UBound(Data, 1)\n        Me.ComboBox1.AddItem Data(iRow, 1) &amp; \" \" &amp; Data(iRow, 2)\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p>Then you can select your item as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MfhdI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MfhdI.png\" alt=\"enter image description here\"></a></p>\n\n<p>And you can retrieve the value <code>B 2</code> with <code>Me.ComboBox1.Text</code>:</p>\n\n<pre><code>Debug.Print Me.ComboBox1.Text 'returns B 2\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56043419, "answer_count": 1, "score": 1, "last_activity_date": 1557326822, "creation_date": 1557326134, "question_id": 56043206, "link": "https://stackoverflow.com/questions/56043206/populate-combobox-with-two-text-fields-from-an-array", "title": "Populate Combobox with Two Text Fields from an Array", "body": "<p>I'm trying to get values from 2 cells in an array to populate the text field of a combobox on a userform. The values in the array look like this:</p>\n\n<pre><code>A  1\nB  2\nC  3\nB  4\n</code></pre>\n\n<p>I would like to make a distinction between B2 and B4 in the combobox text field. The field currently populates like <code>B</code>. I would like it to populate with <code>B 2</code> instead. This question is partly related to <a href=\"https://stackoverflow.com/questions/56042084/retrieve-index-by-values-from-an-array-through-a-combobox\">this</a> question.</p>\n\n<p>I tried using <a href=\"https://www.contextures.com/Excel-VBA-ComboBox-Lists.html\" rel=\"nofollow noreferrer\">this</a> that was linked from <a href=\"https://stackoverflow.com/questions/6867461/can-a-combobox-present-more-then-one-column-on-its-textbox-part\">here</a> but couldn't get the ListCount property to work. I used <a href=\"https://www.tutorialspoint.com/vba/vba_arrays.htm\" rel=\"nofollow noreferrer\">this</a> to better understand arrays in a hope that it would provide some insight. I tried <a href=\"https://www.excel-easy.com/vba/examples/multicolumn-combo-box.html\" rel=\"nofollow noreferrer\">this</a> approach but it doesn't populate the text field. <a href=\"https://wellsr.com/vba/2017/excel/return-position-of-element-in-vba-array/\" rel=\"nofollow noreferrer\">WhereInArray</a> looks like it is more for finding a value and also appears to be unique-value-dependent. I tried <a href=\"https://stackoverflow.com/questions/29924228/retrieving-both-values-from-a-2-column-combobox-vba\">this</a> but it seems to get tripped up on the array. Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1557325710, "post_id": 56043036, "comment_id": 98728153, "body": "Note that row counting variables (<code>i</code> and <code>LastRow</code>) need to be of type <code>Long</code> because Excel has more rows than <code>Integer</code> can handle. \u2022 And <code>x</code> is not declared at all. I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1557325918, "post_id": 56043036, "comment_id": 98728284, "body": "Another thing is that your <code>With Worksheets(&quot;Data&quot;)</code> is completely useless because non of your <code>Range</code> statements starts with a dot <code>.</code> if you want your ranges to use the <code>With</code> statement you should start them with a dot like <code>.Range(&quot;Y&quot; &amp; x)</code>. Fix this for <b>all</b> your ranges inside the <code>With</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557392466, "post_id": 56044630, "comment_id": 98752298, "body": "Still note that row counting variables (<code>i</code> and <code>LastRow</code>) need to be of type <code>Long</code> because Excel has more rows than <code>Integer</code> can handle. \u2022 And <code>x</code> is not declared at all and should be <code>Dim x As Long</code> too."}], "tags": [], "owner": {"reputation": 11, "user_id": 11470578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XAZqQL_2FUc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re0TdzYBHCjMQVbBiA-_T7ykw7Smw/mo/photo.jpg?sz=128", "display_name": "Eric Martin", "link": "https://stackoverflow.com/users/11470578/eric-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1557334272, "last_edit_date": 1557334272, "creation_date": 1557330866, "answer_id": 56044630, "question_id": 56043036, "link": "https://stackoverflow.com/questions/56043036/how-do-i-set-the-value-of-a-do-while-inner-loop-nested-in-a-for-loop/56044630#56044630", "title": "How do I set the value of a do while inner loop, nested in a for loop?", "body": "<p>Changed the inner loop to a for loop with an exit option and that seems to work.</p>\n\n<pre><code>Sub Split_Dispositions_One_Line()\n        Dim LastRow As Integer\n        Dim i As Integer\n        LastRow = Worksheets(\"Data\").UsedRange.Rows.Count\n        With Worksheets(\"Data\")\n            For x = 1 To LastRow\n                If InStr(Range(\"Y\" &amp; x).Value, \"Split Disposition\") Then\n                    For i = x + 1 To LastRow\n                        If Application.WorksheetFunction.IsText(Range(\"AI\" &amp; i).Value) Then\n                            If InStr(Range(\"AI\" &amp; i).Value, \"Release to Good Inventory\") Then\n                                Range(\"AH\" &amp; i).Copy Range(\"AK\" &amp; x)\n                            ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Donate\") Then\n                                Range(\"AH\" &amp; i).Copy Range(\"AL\" &amp; x)\n                            ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Destroy, Landfill\") Then\n                                Range(\"AH\" &amp; i).Copy Range(\"AM\" &amp; x)\n                            ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Destroy, Animal Feed\") Then\n                                Range(\"AH\" &amp; i).Copy Range(\"AN\" &amp; x)\n                            ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Return To Plant\") Then\n                                Range(\"AH\" &amp; i).Copy Range(\"AO\" &amp; x)\n                            End If\n                        ElseIf IsEmpty(Range(\"AI\" &amp; i).Value) Then\n                            Exit For\n                        End If\n                    Next i\n                End If\n            Next x\n        End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11470578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XAZqQL_2FUc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re0TdzYBHCjMQVbBiA-_T7ykw7Smw/mo/photo.jpg?sz=128", "display_name": "Eric Martin", "link": "https://stackoverflow.com/users/11470578/eric-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557334272, "creation_date": 1557325566, "last_edit_date": 1557325620, "question_id": 56043036, "link": "https://stackoverflow.com/questions/56043036/how-do-i-set-the-value-of-a-do-while-inner-loop-nested-in-a-for-loop", "title": "How do I set the value of a do while inner loop, nested in a for loop?", "body": "<p>I have a report that downloads from a client's SharePoint.  The report varies in length depending on the site and time range I am running it for.  Most items come across where their information is nicely laid out in columns on one row per each item, but in the case where there is a split decision it puts the decision into multiple lines and does not keep the other necessary information in those lines.  I'm trying to take the split dispositions and find loop through the following rows to copy the quantities and paste them in the columns based on their disposition.</p>\n\n<p>I have the Outer loop set up and it works.  When I set up the inner loop it doesn't take the value of the outer loop and add 1 row to it.</p>\n\n<pre><code>Sub Split_Dispositions_One_Line()\n    Dim LastRow As Integer\n    Dim i As Integer\n    i = x + i\n    LastRow = Worksheets(\"Data\").UsedRange.Rows.Count\n    With Worksheets(\"Data\")\n        For x = 1 To LastRow\n            If InStr(Range(\"Y\" &amp; x).Value, \"Split Disposition\") Then\n                Do While Application.WorksheetFunction.IsText(Range(\"AI\" &amp; i).Value)\n                    If InStr(Range(\"AI\" &amp; i).Value, \"Release to Good Inventory\") Then\n                        Range(\"AH\" &amp; i).Copy Range(\"AK\" &amp; x)\n                    ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Donate\") Then\n                        Range(\"AH\" &amp; i).Copy Range(\"AL\" &amp; x)\n                    ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Destroy, Landfill\") Then\n                        Range(\"AH\" &amp; i).Copy Range(\"AM\" &amp; x)\n                    ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Destroy, Animal Feed\") Then\n                        Range(\"AH\" &amp; i).Copy Range(\"AN\" &amp; x)\n                    ElseIf InStr(Range(\"AI\" &amp; i).Value, \"Return To Plant\") Then\n                        Range(\"AH\" &amp; i).Copy Range(\"AO\" &amp; x)\n                    End If\n                Loop\n            End If\n        Next x\n    End With\nEnd Sub\n</code></pre>\n\n<p>My goal is to loop through the rows and when I come across \"Split Disposition\" in column Y it will then go to the inner loop, drop 1 row down from where it found \"Split Disposition\" in Y and loop through those rows and if AI contains text it will copy the value in AH and paste it to the column that corresponds to AH in the original row where it found \"Split Disposition\" in column Y.  The number of these lines varies, but they are always one after the other.</p>\n\n<p>Said differently if the loop finds \"Split Disposition\" in cell Y5, then the inner loop will start at AI6, if it has text copy AH6 and Paste into Column AK5, then if AI7 contains text it will copy AH7 and might paste it in AL5 (if that is the column that matches AH7).</p>\n"}, {"tags": ["excel", "vba", "range", "dynamic-list"], "comments": [{"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "edited": false, "score": 0, "creation_date": 1557326711, "post_id": 56042944, "comment_id": 98728778, "body": "So firstly you cannot undo anything after executing a macro. There are ways but they&#39;re very complicated IMO. See <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/ffbb5456-bc80-4c05-80f5-fb07245541aa/why-does-excel-not-allow-quotundoquot-after-a-vba-execution?forum=exceldev\" rel=\"nofollow noreferrer\">This</a>. Regarding your 2nd question, you can read a named range into an array in VBA and then set the <code>listfillrange</code> to said array. Many posts on SO on how to create an array in VBA. You will have to use a <code>for loop</code> and <code>ReDim Preserve</code>"}, {"owner": {"reputation": 29, "user_id": 10209374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02deec4c45360e6f4eefdfac4cd1b99f?s=128&d=identicon&r=PG&f=1", "display_name": "Bulbuzor", "link": "https://stackoverflow.com/users/10209374/bulbuzor"}, "reply_to_user": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "edited": false, "score": 0, "creation_date": 1557327917, "post_id": 56042944, "comment_id": 98729496, "body": "Isn&#39;t there a different way to write the macro so that it doesn&#39;t execute after every worksheet change, even those not affecting it&#39;s dynamic list? I forgot to mention in the main thread, but if my ComboBox is empty (so nothing is filtered out of columns A to C and the list is at &quot;max capacity&quot;), than my Undo works just fine, but as soon as there is something in the ComboBox (or the matching cell) from there on I can&#39;t use undo."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10209374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02deec4c45360e6f4eefdfac4cd1b99f?s=128&d=identicon&r=PG&f=1", "display_name": "Bulbuzor", "link": "https://stackoverflow.com/users/10209374/bulbuzor"}, "edited": false, "score": 0, "creation_date": 1557330570, "post_id": 56044005, "comment_id": 98731039, "body": "Unfortunately this won&#39;t refresh the dynamic list as it is being typed, strangely it won&#39;t even show the full list (only the 1st value) when clicked. In the meanwhile I&#39;ve also tried to link the dropdown appearance and update to a specific cell change (Worksheet_Change(ByVal Target As Range) / Dim KeyCells As Range / Set KeyCells = Range(&quot;D1&quot;), but that didn&#39;t work either. I&#39;ll probably just end tell the people who will be using the database to leave the combobox empty while changes are being made to the sheets."}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 29, "user_id": 10209374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02deec4c45360e6f4eefdfac4cd1b99f?s=128&d=identicon&r=PG&f=1", "display_name": "Bulbuzor", "link": "https://stackoverflow.com/users/10209374/bulbuzor"}, "edited": false, "score": 0, "creation_date": 1557361049, "post_id": 56044005, "comment_id": 98742379, "body": "You can use <code>intersect(target)</code> which should work fine"}], "tags": [], "owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1557367132, "last_edit_date": 1557367132, "creation_date": 1557328730, "answer_id": 56044005, "question_id": 56042944, "link": "https://stackoverflow.com/questions/56042944/cant-ctrlz-undo-with-combobox-referring-to-dynamic-list-with-named-range-re/56044005#56044005", "title": "Can&#39;t Ctrl+Z (undo) with ComboBox referring to dynamic list with named range, rename to array? How?", "body": "<p>To avoid your sheet updating whenever a list property is referenced you can replace the <code>combobox_change</code> event with <code>combobox_click</code>  or alternatively <code>combobox_dropdownclick</code> which updates the list in the box only when the box itself is clicked or F4 is pressed. </p>\n\n<p>If you want to use the <code>worksheet_change</code> event you could do something like this</p>\n\n<pre><code>Worksheet_change (ByVal Target as Range)\n If Not Intersect (Target, Range(\"your named range\"))  Is Nothing Then\n   Combobox1.ListfillRange = range(\"Your named range\")\n</code></pre>\n\n<p>This would only update the combobox if there's a change in the target range.</p>\n\n<p>In general you can't undo after executing VBA code and I wouldn't recommend trying to create a custom undo method.  I'd just copy the sheet and use that copy to tinker with.</p>\n"}], "owner": {"reputation": 29, "user_id": 10209374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02deec4c45360e6f4eefdfac4cd1b99f?s=128&d=identicon&r=PG&f=1", "display_name": "Bulbuzor", "link": "https://stackoverflow.com/users/10209374/bulbuzor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557367132, "creation_date": 1557325282, "last_edit_date": 1557327973, "question_id": 56042944, "link": "https://stackoverflow.com/questions/56042944/cant-ctrlz-undo-with-combobox-referring-to-dynamic-list-with-named-range-re", "title": "Can&#39;t Ctrl+Z (undo) with ComboBox referring to dynamic list with named range, rename to array? How?", "body": "<p>I have a ComboBox whose list refers to a named range that creates a dynamic list based on the matches with the linked text to the ComboBox (linked with a cell). The list has the length of the amount of matches, The ComboBox has a ComboBox_Change to refresh it. </p>\n\n<p>Now my issue is, I can't Ctrl+Z anything in the document and it makes it pretty hard to work with. I used to also have an issue of the list trigerrin with any change in the worksheet, but that seems to have stopped since I changed the named range \"zone\" to it's sheet instead of the whole Excel (even in it's own sheet strangely). The cells used in the named range do refer to another sheet.</p>\n\n<p>I had seen a link yesterday where someone mentionned it happens because every change refreshes the box, and the list should be \"cached\" as an array (<a href=\"https://stackoverflow.com/questions/23186829/why-is-a-excel-vba-combobox-change-event-triggering-every-time-one-of-its-prop\">Why is a (Excel VBA) combobox change event triggering every time one of its properties is referenced?</a>). How would I go about doing this given that my list length keeps changing, and I can't ctrl+shift+enter 500 cells at once (would that even work?)? </p>\n\n<p>Here are some codes and formulas. I freelance translated from French so there might be formula typos. Say Sheet1 is where my ComboBox is.</p>\n\n<p>Cell formula used to populate named list (not really relevant I believe)</p>\n\n<pre><code>=IFERROR(INDEX(Sheet2!$H$2:$H$501;MATCH(ROWS(Sheet1!$B$1:B1);Sheet1!$B$1:$B$503;0));\"\")\n</code></pre>\n\n<p>My ComboBox VBA is as follow :</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    ComboBox1.ListFillRange = \"DropDownList\"\n    Me.ComboBox1.DropDown\n    Range(\"H1\").Value = 1\nEnd Sub\n</code></pre>\n\n<p>The Range(\"H1\") is irrelevant for this, it is to reset a count so that my \"Next\" and \"Previous\" picture looking buttons resets.</p>\n\n<p>Named range (dynamic length), where A gives me 1/0 partial match with my \"search\" in the ComboBox, B gives me the count of how many partial matches I get and C lists the values filling the dropdown list from the other tab.</p>\n\n<p>Don't think it's helpful but here are those forumlas. No determined sheet means Sheet1. </p>\n\n<p>A : </p>\n\n<pre><code>=--ISNUMBER(IFERROR(SEARCH(Sheet1!$D$1;Sheet2!H2;1);\"\"))\n</code></pre>\n\n<p>B : </p>\n\n<pre><code>=IF(A1=1;SUMIF($A$1:A1;1);\"\")\n</code></pre>\n\n<p>C : </p>\n\n<pre><code>=Sheet1!$C$1:INDEX(Sheet1!$C$1:$C$503;MAX(Sheet1!$B$1:$B$503);1)\n</code></pre>\n\n<p>EDIT : In response to Nick, further clarification. I'm basically looking for a different way to write the macro so that it doesn't execute after every worksheet change, even those not affecting it's dynamic list. I forgot to mention in the main thread, but if my ComboBox is empty (so nothing is filtered out of columns A to C and the list is at \"max capacity\"), than my Undo works just fine, but as soon as there is something in the ComboBox (or the matching cell) from there on I can't use undo.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557332238, "post_id": 56042611, "comment_id": 98731799, "body": "This code does not cause &quot;expected end of statement error&quot;."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557332987, "post_id": 56042611, "comment_id": 98732090, "body": "Do you have another function or Variable with the name <code>Dir</code> elsewhere in your code?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "edited": false, "score": 0, "creation_date": 1557329473, "post_id": 56042662, "comment_id": 98730454, "body": "Thank you, this was helpful. I ended up switching to a powershell script though."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1557331129, "post_id": 56042662, "comment_id": 98731314, "body": "I agree <code>Dir</code> is old fashioned and <code>Scripting.FileSystemObject</code> has more functionaility. But why do you think: &quot;The Dir() Function doesn&#39;t allow you to list all files in a directory.&quot;?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557332925, "post_id": 56042662, "comment_id": 98732065, "body": "@Louis But, we have to use a <code>For Each</code> loop with an <code>If</code> check anyway - I would have considered <code>Do Until</code> to be <i>more</i> practical in this situation (even though I normally prefer <code>For</code> loops!)"}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557333271, "post_id": 56042662, "comment_id": 98732212, "body": "@Chronocidal How is <code>Do Until</code> more practical? You still have to check for two conditions and in this way the code is <i>more</i> readable."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557339407, "post_id": 56042662, "comment_id": 98735238, "body": "@Lous Because you no longer need to examine non-csv files?  <code>cAttachment = Dir(Folder &amp; &quot;\\*.csv&quot;): Do Until Len(cAttachment)&lt;4: objMessage.Attachments.Add Folder &amp; &quot;\\&quot; &amp; cAttachment, 1, 1: cAttachment= Dir(): Loop</code>"}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557343708, "post_id": 56042662, "comment_id": 98737158, "body": "@Chronocidal Yes, but like I was saying, that code is much <i>less</i> readable than mine. <i>Compactness</i> is not always the solution if you sacrifice <i>readability</i>."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557347087, "post_id": 56042662, "comment_id": 98738529, "body": "@Louis <b><i>shrug</i></b>  To each his own - I, personally, find both versions (once properly linespaced instead of one-lined with <code>:</code> as required in comments) to be equally readable:  &quot;Get the first file, and then (until we run out of files) attach the file and get the next one&quot; seems simple enough"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 1, "last_activity_date": 1557332231, "last_edit_date": 1557332231, "creation_date": 1557324292, "answer_id": 56042662, "question_id": 56042611, "link": "https://stackoverflow.com/questions/56042611/attached-all-csv-file-expected-end-of-statement-error-in-my-dir-line/56042662#56042662", "title": "Attached all csv file, Expected end of statement error&quot; in my Dir line?", "body": "<p>You can easily achieve your result without having to use the old <code>Dir()</code> <code>Function</code>. To do that you need to use <code>\"Scripting.FileSystemObject\"</code>. <br></p>\n\n<p>This is the code to discover <strong>all files</strong> with <code>.csv</code> extension in a specific folder:</p>\n\n<pre><code>Dim oFile       As Object\nDim oFSO        As Object\nDim oFolder     As Object\nDim oFiles      As Object  \n\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = oFSO.GetFolder(\"C:\\my\\Folder\\\") 'Set this accordingly\nSet oFiles = oFolder.Files\n\n'For all files in the folder\nFor Each oFile In oFiles\n    If (oFile Like \"*.csv\") Then\n        'Add this file to attachments\n        objMessage.AddAttachment oFile.Path\n    End If\nNext\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "edited": false, "score": 0, "creation_date": 1557346770, "post_id": 56048045, "comment_id": 98738379, "body": "Wow, thank you! It creates the email, attaches the required attachment but the email does not send.. Thoughts?"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1557344929, "creation_date": 1557344929, "answer_id": 56048045, "question_id": 56042611, "link": "https://stackoverflow.com/questions/56042611/attached-all-csv-file-expected-end-of-statement-error-in-my-dir-line/56048045#56048045", "title": "Attached all csv file, Expected end of statement error&quot; in my Dir line?", "body": "<p><em>Should be</em> </p>\n\n<blockquote>\n<pre><code>Folder = \"C:\\Users\\____\\Desktop\\Test Folder\\\"\ncAttachment = Dir(Folder &amp; \"*.csv\")`\n\n    '// Loop to attch\n    Do While Len(cAttachment ) &gt; 0\n        .Attachments.Add Folder &amp; cAttachment \n        Atmt_File = Dir\n    Loop\n</code></pre>\n  \n  <hr>\n</blockquote>\n\n<p><em>Full Example code</em></p>\n\n<pre><code>Option Explicit\nPrivate Sub Example()\n    Dim olMsg As Outlook.MailItem\n    Dim olRecip As Outlook.Recipient\n    Dim Atmt_Path As String\n    Dim olInsp As Outlook.Inspector\n    Dim wdDoc As Object\n    Dim rng As Object\n    Dim Atmt_File As String\n\n    '// Attachments Path.\n    Atmt_Path = \"C:\\Temp\\\"\n\n    '// Create the message.\n    Set olMsg = Application.CreateItem(olMailItem)\n\n    With olMsg\n        .Display        '// This line must be retained\n\n        Atmt_File = Dir(Atmt_Path &amp; \"*.csv\")\n\n        '// Loop to attch\n        Do While Len(Atmt_File) &gt; 0\n            .Attachments.Add Atmt_Path &amp; Atmt_File\n            Atmt_File = Dir\n        Loop\n\n        '// Cancell email if no files to send\n        If .Attachments.Count = 0 Then\n            'MsgBox \"There are no reports to attach.\", vbInformation\n            .Close 0\n            .Delete\n        Else\n\n            '// Add the To recipient(s)\n            Set olRecip = .Recipients.Add(\"0m3r@email.com\")\n            Set olRecip = .Recipients.Add(\"0m3r@email.com\")\n            olRecip.Type = olTo\n\n            '// Add the CC recipient(s)\n            Set olRecip = .Recipients.Add(\"0m3r@email.com\")\n            olRecip.Type = olCC\n\n            '// Set the Subject, Body, and Importance of the message.\n            .Subject = \"Reports - \" &amp; Format(Now, \"Long Date\")\n            .Importance = olImportanceHigh        '// High importance\n            .BodyFormat = olFormatHTML\n\n            '// Edit the message body.\n            Set olInsp = .GetInspector\n            Set wdDoc = olInsp.WordEditor\n\n            '// Set message body (to retain the signature)\n            Set rng = wdDoc.Range(0, 0)\n\n            '// add the text to message body\n            rng.Text = \"Files are Attached, Thank you\" &amp; vbCrLf &amp; vbCrLf\n\n\n            '// Resolve each Recipient's name.\n            For Each olRecip In .Recipients\n                olRecip.Resolve\n                If Not olRecip.Resolve Then\n                    olMsg.Display\n                End If\n\n            Next\n'            .Send '//This line optional\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56048045, "answer_count": 2, "score": 1, "last_activity_date": 1592464684, "creation_date": 1557324103, "last_edit_date": 1592464684, "question_id": 56042611, "link": "https://stackoverflow.com/questions/56042611/attached-all-csv-file-expected-end-of-statement-error-in-my-dir-line", "title": "Attached all csv file, Expected end of statement error&quot; in my Dir line?", "body": "<p>I'm running a script to automatically send emails with attachments. All attachments will have a <code>.csv</code> extension. </p>\n\n<p>I do not know the name of the files before hand. I am using a Dir statement but am running into some issues.</p>\n\n<p>I tried breaking the Dir statement up into different strings but that was not working either. </p>\n\n<pre><code>Dim cAttachment As String\nDim Folder As String\nDim fileCriteria As String\n\nFolder = \"C:\\Users\\____\\Desktop\\Test Folder\"\nfileCriteria = \".csv\"\ncAttachment = Dir(Folder &amp; \"\\*\" &amp; fileCriteria)\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>Dim cAttachment As String \ncAttachment = Dir(\"C:\\Users\\___\\Desktop\\Test Folder\\*.csv\")\n</code></pre>\n\n<p>I am getting an expected end of statement error on the leading parenthesis of my Dir statement. </p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1557323855, "post_id": 56042483, "comment_id": 98726921, "body": "What does the error message say - to you?"}, {"owner": {"reputation": 60275, "user_id": 1073631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b7f78513c544111980c6308b25a4ed?s=128&d=identicon&r=PG", "display_name": "sgeddes", "link": "https://stackoverflow.com/users/1073631/sgeddes"}, "edited": false, "score": 0, "creation_date": 1557323943, "post_id": 56042483, "comment_id": 98726977, "body": "You need to add <code>credit usd</code> to the <code>group by</code> clause. With that said, I think your query could be much shorter...  Sample data and expected results would be helpful."}, {"owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1557324028, "post_id": 56042483, "comment_id": 98727030, "body": "I got a message error &quot;Your query does not include the specified expression &#39;credit usd&#39; as part of an aggregate function&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1557328265, "post_id": 56042607, "comment_id": 98729721, "body": "Seem like affected with performance when I tried this Query. And another one is that, its not provide proper result as I expected. I expected to get (Account name dr) with Highest (Credit Usd) because we have many account name dr (Duplicated ACCOUNT NAME DR)  with different Credit USD."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1557328614, "post_id": 56042607, "comment_id": 98729950, "body": "@KryChulsa . . . Your question is:  &quot;I&#39;m try to select &quot;max(TxnDate) as txDate, [account name dr], [credit usd]&quot;."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1557324096, "creation_date": 1557324096, "answer_id": 56042607, "question_id": 56042483, "link": "https://stackoverflow.com/questions/56042483/how-to-fix-query-does-not-include-the-specified-expression-credit-usd-as-part/56042607#56042607", "title": "How to fix &quot;query does not include the specified expression &#39;credit usd&#39; as part of an aggregate function&quot;?", "body": "<p>If you are trying to get the most recent row for each account, then aggregation is not what comes to mind.  You can use filtering:</p>\n\n<pre><code>select t.*\nfrom [FT_Pure$] t\nwhere t.TxnDate = (select max(t2.TxnDate)\n                   from [FT_Pure$] t2\n                   where t2.[account name dr] = t.[account name dr]\n                  );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1557327903, "post_id": 56042762, "comment_id": 98729485, "body": "Such a great answer, it help me. But I still not sure whether why it&#39;s worked properly in SQL (PHPmyadmin) but return an error in VBA Excel?"}, {"owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1557331075, "post_id": 56042762, "comment_id": 98731292, "body": "It works now both VBA and SQL base on above answer but I just wondered why this error occurred?"}, {"owner": {"reputation": 829, "user_id": 3564110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/feb36e0fb33ead73945c55197f466be6?s=128&d=identicon&r=PG&f=1", "display_name": "iainc", "link": "https://stackoverflow.com/users/3564110/iainc"}, "reply_to_user": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1557331250, "post_id": 56042762, "comment_id": 98731371, "body": "It may be that PHPmyadmin is a bit more forgiving  than Excel VBA is willing to be. I&#39;d have thought it should return an error in both situations though as the error is being returned from MySQL presumably."}], "tags": [], "owner": {"reputation": 829, "user_id": 3564110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/feb36e0fb33ead73945c55197f466be6?s=128&d=identicon&r=PG&f=1", "display_name": "iainc", "link": "https://stackoverflow.com/users/3564110/iainc"}, "is_accepted": true, "score": 0, "last_activity_date": 1557324606, "creation_date": 1557324606, "answer_id": 56042762, "question_id": 56042483, "link": "https://stackoverflow.com/questions/56042483/how-to-fix-query-does-not-include-the-specified-expression-credit-usd-as-part/56042762#56042762", "title": "How to fix &quot;query does not include the specified expression &#39;credit usd&#39; as part of an aggregate function&quot;?", "body": "<p>The outer GROUP BY clause is missing [credit usd] which you have in the outer select along with [account name dr].</p>\n\n<p>Just add it in:</p>\n\n<pre><code>SELECT max(TxnDate) as txDate, [account name dr], [credit usd] from \n   (\n       SELECT t.TxnDate, t.[account name dr], t.[credit usd] FROM \n       ( \n           select [account name dr], max([credit usd]) as max_c from [FT_Pure$] GROUP BY [account name dr]\n       ) as a INNER JOIN [FT_Pure$] as t on (t.[account name dr] = a.[account name dr] and t.[credit usd] = max_c)\n   ) as ta group by ta.[account name dr], [credit usd]\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56042762, "answer_count": 2, "score": 0, "last_activity_date": 1557325175, "creation_date": 1557323769, "last_edit_date": 1557325175, "question_id": 56042483, "link": "https://stackoverflow.com/questions/56042483/how-to-fix-query-does-not-include-the-specified-expression-credit-usd-as-part", "title": "How to fix &quot;query does not include the specified expression &#39;credit usd&#39; as part of an aggregate function&quot;?", "body": "<p>I'm try to select <b>\"max(TxnDate) as txDate, [account name dr], [credit usd]\"</b> and I got an error \"query does not include the specified expression 'credit usd' as part of an aggregate function\" in excel VBA programming but in work find when I tried in SQL sever or PHPMyadmin</p>\n\n<p>I'm working on MSExcel 2013 with VBA programming</p>\n\n<pre><code>SELECT max(TxnDate) as txDate, [account name dr], [credit usd] from \n   (\n       SELECT t.TxnDate, t.[account name dr], t.[credit usd] FROM \n       ( \n           select [account name dr], max([credit usd]) as max_c from [FT_Pure$] GROUP BY [account name dr]\n       ) as a INNER JOIN [FT_Pure$] as t on (t.[account name dr] = a.[account name dr] and t.[credit usd] = max_c)\n   ) as ta group by ta.[account name dr]\n</code></pre>\n\n<p>I expect the output should list of <b>txDate, account_name_dr and Credit_Usd </b></p>\n\n<p>Here is the error message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/esfis.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/esfis.png\" alt=\"Error messsage\"></a></p>\n"}, {"tags": ["vba", "database", "ms-access", "authentication", "db2"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557338308, "post_id": 56042415, "comment_id": 98734715, "body": "So you have a working process. Seemed to have answered your own question."}, {"owner": {"reputation": 425, "user_id": 1231560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bce919d33987a5e15f41ce6f325ecc13?s=128&d=identicon&r=PG", "display_name": "Jose R", "link": "https://stackoverflow.com/users/1231560/jose-r"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557356978, "post_id": 56042415, "comment_id": 98741613, "body": "@June7 sort of.  I can fully work on the Access DB, but was wondering if there&#39;s a way to disable the cache of credentials in Access, sadly with work, you know, you have the minimum working solution and go on like in my case, hopefully someone will have an answer if disabling the Cache is possible."}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 1231560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bce919d33987a5e15f41ce6f325ecc13?s=128&d=identicon&r=PG", "display_name": "Jose R", "link": "https://stackoverflow.com/users/1231560/jose-r"}, "edited": false, "score": 0, "creation_date": 1557366916, "post_id": 56050681, "comment_id": 98743483, "body": "Thanks, I tried to use DSN-Less tables, I was able to link to them and open them correctly.  But the password caching still occurred, so I wasn&#39;t able to go down this route."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 425, "user_id": 1231560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bce919d33987a5e15f41ce6f325ecc13?s=128&d=identicon&r=PG", "display_name": "Jose R", "link": "https://stackoverflow.com/users/1231560/jose-r"}, "edited": false, "score": 0, "creation_date": 1557368084, "post_id": 56050681, "comment_id": 98743696, "body": "Your question was worth a try! Been using Access + 16 years, and been using the password/uid cache trick for about as long. As noted, you can execute logons, and they are added to the cache, but there is no way short of a re-start of the application to clear it out. You  could perhaps do a re-link code to swap the DSN- but then you just re-linking anyway. There is simply no way to get around this, since you can&#39;t clear out the cache, and this no doubt was/is the motivation for your question.  Would love to give a different answer - but it is &quot;no&quot; you can&#39;t clear the cache."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 0, "last_activity_date": 1557362183, "creation_date": 1557362183, "answer_id": 56050681, "question_id": 56042415, "link": "https://stackoverflow.com/questions/56042415/is-there-a-way-to-disable-access-cache-security-in-currentproject-accessconnecti/56050681#56050681", "title": "Is there a way to disable Access cache security in CurrentProject.AccessConnection.Properties?", "body": "<p>Unfortunately, I am not aware this is possible. </p>\n\n<p>You could however adopt (and should) adopt DSN less connections. This would  thus eliminate the need to use a DSN. (the are a pain these days - especially with locked down machines). And this would allow you to change the logon/uid without having to re-link.</p>\n\n<p>However, you STILL will quite much need two sets of tables if you need to get at both databases at the same time. You could also re-run the link code, but no doubt you been avoiding the re-link, and you want to just swap the DSN.</p>\n\n<p>So, you CAN switch user/pass without a re-link. However, if you need to switch the database your pointing to? No way around this - you have to re-link the tables.</p>\n\n<p>So, with JUST one set of linked tables, you can logon again (with different user/id), but to switch the database you pointing to, you have to re-link.</p>\n\n<p>And no, you can't clear the password cache unless you exit, and re-load access.</p>\n"}], "owner": {"reputation": 425, "user_id": 1231560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bce919d33987a5e15f41ce6f325ecc13?s=128&d=identicon&r=PG", "display_name": "Jose R", "link": "https://stackoverflow.com/users/1231560/jose-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 56050681, "answer_count": 1, "score": 0, "last_activity_date": 1594779760, "creation_date": 1557323577, "last_edit_date": 1594779760, "question_id": 56042415, "link": "https://stackoverflow.com/questions/56042415/is-there-a-way-to-disable-access-cache-security-in-currentproject-accessconnecti", "title": "Is there a way to disable Access cache security in CurrentProject.AccessConnection.Properties?", "body": "<p>I am working on an Access database that has linked tables to a DB2 database via DSN ODBC connection.</p>\n\n<p>All of the tables use the same System DSN since they're both in the same DB2 database.  To get one group of tables, I use the system DSN \"A\" with one userid and password, and for the other group of tables, I use the same system DSN \"A\" as in the first group of tables, but with another userid and password.</p>\n\n<p>This wrecked havoc in Access since if I open a table from the first group, it would cache the credentials and then if i tried to open a table from the second group without restarting Access, it would throw an <code>Invalid credentials/username</code> error.</p>\n\n<p>Using this <a href=\"https://stackoverflow.com/a/53319642/1231560\">answer</a> I was able to work my way around it: I created two different System DSN ODBC connections, one for each group of tables.  This allows me to open the tables from either group without authorization errors in the same session (e.g. wihtout having to restart Access).</p>\n\n<p>I was wondering, if there's a way in Windows 10 and Office 365 (via vba, AutoExec macro, changing the registry, policies, etc.) to change the default behaviour of <code>CurrentProject.AccessConnection.Properties(\"Cache Authentication\")</code> from <code>True</code> to <code>False</code> </p>\n\n<p>This property is <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.currentproject.connection\" rel=\"nofollow noreferrer\">readonly</a> once the database is opened.</p>\n\n<p>So another thought I had is: if you open a remote database with the cache authentication set to False and add it to your workspace in another database, can you run queries via DAO in VBA in that \"remote\" database?</p>\n\n<p>For example: Database \"A\" has all of the linked tables to DB2.  From another database \"B\" I open Database \"A\" and add it to Database \"B\"'s workspace with Cache Authentication set to false (&lt;- is this possible?) v\u00eda <code>OpenConnection</code>? or <code>OpenDatabase</code>.  Once Database \"A\" is opened from Database \"B\", would I be able to run on-the-fly queries (meaning no stored proc) in database \"B\" using VBA referencing the linked tables in Database \"A\"?</p>\n\n<p><strong>UPDATE</strong>\nAccording to <a href=\"https://books.google.com/books?id=NafXqquUxbsC&amp;pg=PA556&amp;lpg=PA556&amp;dq=currentproject+openconnection&amp;source=bl&amp;ots=6GGD7eEEq6&amp;sig=ACfU3U2zV-A0N5FJJyzXOc2ysoIetasLnw&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwjiicPCkoziAhUDSq0KHY-eCrQQ6AEwCXoECAkQAQ#v=onepage&amp;q=currentproject%20openconnection&amp;f=false\" rel=\"nofollow noreferrer\">Access 2003 VBA Programmer's Reference</a> p.556 one can't specify advanced options using <code>OpenConnection</code>\n<a href=\"https://i.stack.imgur.com/ILCn3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ILCn3.png\" alt=\"Snapshot from book\"></a></p>\n\n<p>This question has been asked before several times:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/616083/access-caching-odbc-connection-settings\">Access Caching ODBC connection settings</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7377030/clearing-access-cache\">Clearing Access Cache</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8434434/how-can-i-force-access-to-change-the-user-name-and-password-for-a-dsn-less-odbc\">How can I force Access to change the user-name and password for a DSN less ODBC connection?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/53317092/forcing-access-to-forget-a-username-and-password-for-a-linked-table\">Forcing Access to forget a username and password for a linked table</a></li>\n</ul>\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557325160, "post_id": 56042254, "comment_id": 98727799, "body": "Can you show what <code>File1</code> to <code>File4</code> looks like? obviously this is important for your question."}, {"owner": {"reputation": 64, "user_id": 11299749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b235c4bc0a0f1164f76d5267804d334c?s=128&d=identicon&r=PG&f=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/11299749/arl"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557328764, "post_id": 56042254, "comment_id": 98730036, "body": "I added an edit to show the basic file structure."}, {"owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "edited": false, "score": 0, "creation_date": 1557329122, "post_id": 56042254, "comment_id": 98730254, "body": "Can you check in the file that does not work as intended if <code>Enable background refresh</code> is checked? If that is the case, uncheck it: On the Data tab, in the Connections group, click Refresh All, and then click Connection Properties. Uncheck <b>Enable background refresh</b> check box."}, {"owner": {"reputation": 64, "user_id": 11299749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b235c4bc0a0f1164f76d5267804d334c?s=128&d=identicon&r=PG&f=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/11299749/arl"}, "edited": false, "score": 0, "creation_date": 1557337066, "post_id": 56042254, "comment_id": 98734085, "body": "That option is grayed out. The links are vlookup links between workbooks in the same folders if that helps. In my reading on this issue I can across your suggestion, but that doesn&#39;t seem to be an option that I can change.I&#39;m not completely familiar with it, but is that more for database connections or should it apply to cross wb links too?"}, {"owner": {"reputation": 30007, "user_id": 3245749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYDwR.jpg?s=128&g=1", "display_name": "TheMadTechnician", "link": "https://stackoverflow.com/users/3245749/themadtechnician"}, "edited": false, "score": 0, "creation_date": 1557357116, "post_id": 56042254, "comment_id": 98741652, "body": "When you open that workbook in PowerShell, check <code>$wb.connections</code> and see if <code>RefreshWithRefreshAll = True</code> or not."}], "owner": {"reputation": 64, "user_id": 11299749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b235c4bc0a0f1164f76d5267804d334c?s=128&d=identicon&r=PG&f=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/11299749/arl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557337750, "creation_date": 1557323066, "last_edit_date": 1557337750, "question_id": 56042254, "link": "https://stackoverflow.com/questions/56042254/refreshall-inconsistent", "title": "RefreshAll() Inconsistent", "body": "<p>Using PowerShell, I want to open several Excel workbooks, refresh all the links inside and then calculate the sheets so that when other users open them, they see the updated links and do not need to refresh the links. My script works, but not for all the sheets.</p>\n\n<p>I discovered that having the sheet set to manual Calculate prevented it from Calculating on Save and Close, so I added script to change the Calculations to Automatic and then back to Manual, but it didn't work for one of the sheets. The only difference between that sheet and the others is that is it in a different folder, but the script is able to access the folder.</p>\n\n<pre><code>$Excel = new-object -comobject excel.application\n\n$Excel.displayAlerts = $false # don't prompt the user\n$Excel.visible = $False;\n\n$wb = $Excel.workbooks.open(\"C:\\Folder1\\File1.xlsm\") \n\n$xlAutomatic = -4105\n$xlCalculationManual = -4135\n$Excel.Calculation = $xlAutomatic\n\n$wb.RefreshAll() #refresh links\n$wb.close($true) #close and save\n\n$wb = $Excel.workbooks.open(\"C:\\Folder1\\File2.xlsm\")\n$wb.RefreshAll() #refresh links\n$wb.Calculate\n$wb.close($true) #close and save\n\n$wb = $Excel.workbooks.open(\"C:\\Folder1\\File3.xlsm\")\n$wb.RefreshAll() #refresh links\n$wb.Calculate\n$wb.close($true) #close and save\n\n$wb = $Excel.workbooks.open(\"C:\\Folder1\\Folder2\\File4.xlsm\") # &lt;-----File that is not updating\n$wb.RefreshAll() #refresh links\n$wb.Calculate\n$wb.close($true) #close and save\n\n$wb = $Excel.workbooks.open(\"C:\\Folder1\\File1.xlsm\")\n$wb.RefreshAll() #refresh links\n$wb.Calculate\n\n$Excel.Calculation = $xlCalculationManual\n\n$wb.close($true) #close and save\n\n$Excel.quit()\n\nspps -n excel\n</code></pre>\n\n<p>I feel like I've got a lot of code that I don't need in here as I try to find what works.</p>\n\n<p>Edit-</p>\n\n<p>This helped me find the initial solution. I just want to understand why it only works for some of the files.\n<a href=\"https://stackoverflow.com/questions/47159268/powershell-script-open-excel-update-external-data-save-as\">Powershell Script - Open Excel, Update External Data, Save as</a></p>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1557323233, "post_id": 56042159, "comment_id": 98726525, "body": "Try Resume 1 rather than GoTo 1 .. Here&#39;s a good source of info <a href=\"http://www.cpearson.com/excel/ErrorHandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/ErrorHandling.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 11464820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a90397304663e503b1f646d4ecffc7?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Carlson", "link": "https://stackoverflow.com/users/11464820/steven-carlson"}, "is_accepted": false, "score": 0, "last_activity_date": 1557323153, "creation_date": 1557323153, "answer_id": 56042286, "question_id": 56042159, "link": "https://stackoverflow.com/questions/56042159/is-there-a-way-to-trap-a-vba-code-in-an-error-loop/56042286#56042286", "title": "Is there a way to trap a vba code in an error loop?", "body": "<p>You can have the code check to see if your path exists or not. If not, have it wait.</p>\n\n<pre><code>Do While Dir(Fichier) = \"\"\n    Application.Wait(Now() + TimeValue(\"00:00:10\"))\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1557323172, "creation_date": 1557323172, "answer_id": 56042293, "question_id": 56042159, "link": "https://stackoverflow.com/questions/56042159/is-there-a-way-to-trap-a-vba-code-in-an-error-loop/56042293#56042293", "title": "Is there a way to trap a vba code in an error loop?", "body": "<p>You don't need to wait for an error, this is what you are looking for:</p>\n\n<pre><code>Ruta = wb.Path &amp; \"\\\"\nExportar = Ruta &amp; \"datos\" &amp; Servicio &amp; \".txt\"\nFindIt = Dir(Exportar)\nWhile Len(FindIt) = 0\n    FindIt = Dir(Exportar)\nWend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11399032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bc0c7d2a7dc69b1f548cb5fb4642a3?s=128&d=identicon&r=PG&f=1", "display_name": "pralufouat", "link": "https://stackoverflow.com/users/11399032/pralufouat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557323172, "creation_date": 1557322763, "question_id": 56042159, "link": "https://stackoverflow.com/questions/56042159/is-there-a-way-to-trap-a-vba-code-in-an-error-loop", "title": "Is there a way to trap a vba code in an error loop?", "body": "<p>I'm working on a program using both Matlab and Excel. Excel gives its data to Matlab with a text file and then, once Matlab has finished its analysis, it creates a text file to be read by Excel.</p>\n\n<p>In my vision of the program, I would like to have only one sub to do everything. Therefore, I wanted to put the sub on hold to wait Matlab until the file is ready. There comes my problem, because there's no file before Matlab finishes, trying to open the file will result in an error. </p>\n\n<p>I tried to use the error handler to make a loop but it appears that VBA doesn't allow it.</p>\n\n<p>Here's my test code:</p>\n\n<pre><code>Sub Test()\n\n    Fichier = \"'filepath'\\file.txt\"\n    IndexFichier = FreeFile()\n1:\n    On Error GoTo expected   \n    Open Fichier For Input As #IndexFichier\n\n    Close #IndexFichier\n    Exit Sub\n\nexpected:\n    Err.Clear\n    Close #IndexFichier 'Don't know if useful'\n    GoTo 1\n\n\nEnd Sub\n</code></pre>\n\n<p>I expected the code to loop between \"1\" and \"expected\" but after one loop vba breaks on its own with the expected error \"file not found\". Does anyone know if there's a possibility to loop on errors or do I have to make another sub?</p>\n"}, {"tags": ["arrays", "excel", "vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1557323812, "post_id": 56042084, "comment_id": 98726903, "body": "I tend to deal with these by joining the 2 columns of data into a single array with the index column padded to a fixed length so I can take left(???, X) from the selected value"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 2, "creation_date": 1557324383, "post_id": 56042084, "comment_id": 98727289, "body": "Suppose you have 2 comboboxes: cb1 and cb2. When nothing is selected, cb1.Listindex=-1 and cb2.Listindex=-1. When something is selected in both, then cb1.value and cb2.value contains the selected value from the comboboxes. If they are identical, then you can inspect the listindices to see if they are the same."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557324640, "post_id": 56042084, "comment_id": 98727482, "body": "When a value is selected in one combobox, cant you just remove that from second combobox? thus ensuring that same value cannot be selected in both comboboxes"}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1557326931, "post_id": 56042084, "comment_id": 98728909, "body": "@Knee This is certainly viable but I expect the index is already there. I&#39;m trying to figure out how to access and retain the value of the index, if that is possible."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557327496, "post_id": 56042084, "comment_id": 98729249, "body": "@Zac I could create another array from the current array once the first one is selected but I would still need the index to ensure I&#39;m retrieving the correct column once the selection is made. In addition, removing an entry would change the cell index which means I would have to handle that when the selection is made in the second combobox."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1557328181, "post_id": 56042084, "comment_id": 98729667, "body": "@AcsErno This is what I needed. I had tried assigning these to variables but it looks like the variables were assigned the -1 value rather than the actual index. by comparing the list indices against each other directly (i.e. <code>Me.cb1.ListIndex=Me.cb2.ListIndex</code> I was able to compare them appropriately. Thank you."}], "owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557326304, "creation_date": 1557322511, "last_edit_date": 1557326304, "question_id": 56042084, "link": "https://stackoverflow.com/questions/56042084/retrieve-index-by-values-from-an-array-through-a-combobox", "title": "Retrieve Index by Values From an Array Through a ComboBox", "body": "<p>I have a transposed dynamic n x 2 array that is used to populate a combobox. The primary column alone is not descriptive enough to identify rows uniquely. I would like to use the row index to identify the untransposed column uniquely. Using both columns in the array could also be used for this but may prove problematic down the line. This question is closely related to <a href=\"https://stackoverflow.com/questions/56043206/populate-combobox-with-two-text-fields-from-an-array\">this</a> question.</p>\n\n<p>I have used <code>Me.cbo.ListIndex = 0</code> to retrieve the index value. Ideally, I'd like to assign the index of the row chosen in the combobox to a variable. The ultimate goal is to use the index in two ways:</p>\n\n<ol>\n<li>For finding the correct column to use in future calculations</li>\n<li>As a method for comparison against another combobox that uses the same array in order to ensure that the same row has not been chosen in both comboboxes</li>\n</ol>\n\n<p>To visually illustrate the above, the original data looks like this:</p>\n\n<pre><code>a  b  c  b\n1  2  3  4\nA  B  C  B\n</code></pre>\n\n<p>The transposed array looks like this:</p>\n\n<pre><code>A  1\nB  2\nC  3\nB  4\n</code></pre>\n\n<p>I would like to be able to make a distinction between selecting B2 and B4, ideally by preserving and comparing index 1 and 3 respectively (0-based).</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/listindex-property\" rel=\"nofollow noreferrer\">ListIndex</a> is from the documentation. There is no documentation that I could find about retrieving the index from the name <a href=\"https://analysistabs.com/vba-code/excel-userform/listbox/\" rel=\"nofollow noreferrer\">except</a> where the value in the selection is unique. Any Help is greatly appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557321747, "post_id": 56041813, "comment_id": 98725550, "body": "Replace <code>Selection</code> with the <code>Range</code> you&#39;ve selected."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557322152, "post_id": 56041813, "comment_id": 98725824, "body": "The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofill\" rel=\"nofollow noreferrer\">documentation</a> has a good example as well."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 1, "creation_date": 1557322472, "post_id": 56041813, "comment_id": 98726034, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 27, "user_id": 11470340, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216736916829580/picture?type=large", "display_name": "Thomas N&#248;rlund Rasmussen", "link": "https://stackoverflow.com/users/11470340/thomas-n%c3%b8rlund-rasmussen"}, "edited": false, "score": 0, "creation_date": 1557322794, "post_id": 56041813, "comment_id": 98726246, "body": "My code today looks like this     <code>Range(&quot;A30:M30&quot;).Select     Selection.AutoFill Destination:=Range(&quot;A30:M30&quot;).Resize(NumRows1), Type:=xlFillDefault</code> Now i tried replacing it with this: Worksheets(&quot;Temp&quot;).Range(&quot;A30:M30&quot;).AutoFill Destination:=Range(&quot;A30:M30&quot;).Resize(NumRows1), Type:=xlFillDefault Still no luck..."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11470340, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216736916829580/picture?type=large", "display_name": "Thomas N&#248;rlund Rasmussen", "link": "https://stackoverflow.com/users/11470340/thomas-n%c3%b8rlund-rasmussen"}, "edited": false, "score": 0, "creation_date": 1557474509, "post_id": 56045633, "comment_id": 98784797, "body": "Thank you SO much! Perfect examples! Sometimes i can get a bit confused looking at other peoples examples as there is often way more code to suit their needs. I was so close to solve it my selv as my code looked like this: &#39;Worksheets(&quot;Temp&quot;).Range(&quot;A30:M30&quot;).AutoFill Destination:=Range(&quot;A30:M30&quot;).Resize(NumRows1), Type:=xlFillDefault&#39; I fell a bit dumb, cause now i can see that &quot;all&quot; i left out was in Destination where i missed the Sheet name... Well i learned a lot and now im on the way to learn even more! :)"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1557334577, "creation_date": 1557334577, "answer_id": 56045633, "question_id": 56041813, "link": "https://stackoverflow.com/questions/56041813/how-to-autofill-in-other-sheet-without-selecting-it/56045633#56045633", "title": "How to Autofill in other Sheet without selecting it?", "body": "<p>To give you a starting point, here are some examples of using autofill on another sheet after copy/paste.</p>\n\n<p>First - Copy the range you are going to use to the other worksheet</p>\n\n<p>Second - Select the range on the worksheet you are going to autofill</p>\n\n<p>Third - When using <code>Resize</code> the number has to be bigger then the range because when selecting a range the focus is on the first cell in the range. e.g. If not  greater\nthen <code>Range(\"A1:A10\").resize(5).Select</code> the selected range will be <code>Range(\"A1:A5\")</code>, thus not autofill action.</p>\n\n<p>Different ways to <code>Resize</code> are:</p>\n\n<pre><code>Sheets(\"Sheet3\").Range(\"A1:B10\").AutoFill Destination:=Sheets(\"Sheet3\").Range(\"A1:B10\").Resize(20), Type:=xlFillDefault\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Dim lr As Long\nlr = Sheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Rows.Count\n\n'the lr must be grater then the autofill range\n\nSheets(\"Sheet3\").Range(\"A1:B10\").AutoFill Destination:=Sheets(\"Sheet3\").Range(\"A1:B10\").Resize(lr), Type:=xlFillDefault \n</code></pre>\n\n<p>You can also use the <code>With</code> statement</p>\n\n<pre><code>With Sheets(\"Sheet3\").Range(\"A1:B10\")\n    .AutoFill Destination:=.Resize(.CurrentRegion.Rows.Count + .CurrentRegion.Rows.Count), Type:=xlFillDefault\nEnd With\n\n'the `.CurrentRegion.Rows.Count' doubles the range for the autofill, you can replace the second one with a specific number e.g. `.CurrentRegion.Rows.Count + 5' \n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11470340, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216736916829580/picture?type=large", "display_name": "Thomas N&#248;rlund Rasmussen", "link": "https://stackoverflow.com/users/11470340/thomas-n%c3%b8rlund-rasmussen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 56045633, "answer_count": 1, "score": 0, "last_activity_date": 1615614048, "creation_date": 1557321599, "last_edit_date": 1557322439, "question_id": 56041813, "link": "https://stackoverflow.com/questions/56041813/how-to-autofill-in-other-sheet-without-selecting-it", "title": "How to Autofill in other Sheet without selecting it?", "body": "<p>I'm learning to avoid using <code>.Select</code> and I just cant figure out how to rewrite my <code>.AutoFill</code> code.</p>\n\n<p>I have two different sheets, one where i collect data from, paste that in the other sheet, and I need the autofill to run on the second sheet without activating it.</p>\n\n<p>This is my working code now, works because I <code>Select</code> the sheet and the cell \"A30\"</p>\n\n<pre><code>Selection.AutoFill Destination:=Range(\"A30:M30\").Resize(NumRows1), Type:=xlFillDefault\n</code></pre>\n\n<p>This works perfectly, but I would like to NOT activate the sheet and select the cell.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1557330087, "post_id": 56041664, "comment_id": 98730797, "body": "The Excel folks sometimes create what&#39;re called &quot;dictator app&quot;, code that removes all of the normal Excel UI and replaces it with only the functions the author wants the users to have. Even if that were possible in PPT (may or may not be) it&#39;d probably be impossible to override all of the keyboard shortcuts. It might be simpler to provide the same functionality in a dedicated app that displays images of the slides from the PPT presentation and allows for entering comments; this could probably be done in such a way that the app passes comments back into the password protected source PPT"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1557524262, "post_id": 56041664, "comment_id": 98808457, "body": "Another thought: save the presentation as a Picture Presentation.  This converts all of the slide content to an image, so it&#39;s not editable. Recipients can add comments (and other content/shapes) but can&#39;t alter the content from the original."}, {"owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1557689581, "post_id": 56041664, "comment_id": 98840039, "body": "Thanks Steve, I&#39;ll try that!"}], "owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557321119, "creation_date": 1557321119, "question_id": 56041664, "link": "https://stackoverflow.com/questions/56041664/powerpoint-edit-restrict-to-comments-only", "title": "Powerpoint edit-restrict to Comments only", "body": "<p>I'm trying to find a way to restrict access to a set of Powerpoint slides to allow Comments only.</p>\n\n<p>Word has this functionality built-in but Powerpoint does not seem to have this.</p>\n\n<p>No code thought of at present</p>\n\n<p>Looked at password protection of Powerpoint files</p>\n"}, {"tags": ["excel", "vba", "match"], "comments": [{"owner": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "edited": false, "score": 2, "creation_date": 1557321341, "post_id": 56041641, "comment_id": 98725279, "body": "why not use a vlookup instead ? this sounds like a case for it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1557321429, "post_id": 56041641, "comment_id": 98725326, "body": "You&#39;ve got the argument order within <code>CountIf</code> flipped. The first argument is the range, and the second is the criterion."}, {"owner": {"reputation": 131, "user_id": 4734749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cWhOM.png?s=128&g=1", "display_name": "Student201", "link": "https://stackoverflow.com/users/4734749/student201"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557322049, "post_id": 56041641, "comment_id": 98725747, "body": "@BigBen thanks, spot on"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1557325506, "last_edit_date": 1557325506, "creation_date": 1557321827, "answer_id": 56041888, "question_id": 56041641, "link": "https://stackoverflow.com/questions/56041641/how-can-i-see-which-column-a-entries-do-not-appear-in-column-b/56041888#56041888", "title": "How can I see which Column A entries do not appear in Column B?", "body": "<p>You could try:</p>\n\n<p><strong>Answer with  For Each Loop:</strong></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowC As Long\n    Dim rngA As Range, rngB As Range, cell\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set rngA = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n        Set rngB = .Range(\"B2:B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row)\n\n        For Each cell In rngA\n\n            If Application.WorksheetFunction.CountIf(rngB, cell) Then\n            Else\n                .Range(\"C\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row + 1).Value = cell.Value\n            End If\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Answer with Arrays:</strong></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowC As Long\n    Dim arrA As Variant, arrB As Variant, i As Long, y As Long\n    Dim strA As String, strB As String\n    Dim Appears As Boolean\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        arrA = Application.Transpose(.Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row))\n        arrB = Application.Transpose(.Range(\"B2:B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row))\n\n        For i = 1 To UBound(arrA)\n\n            strA = arrA(i)\n\n            Appears = False\n\n            For y = 1 To UBound(arrB)\n\n                strB = arrB(y)\n\n                If strA = strB Then\n                    Appears = True\n                    Exit For\n                Else\n                    Appears = False\n                End If\n            Next y\n\n            If Appears = False Then\n                .Range(\"C\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row + 1).Value = arrA(i)\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Answer with Dictionaries:</strong></p>\n\n<pre><code>Sub tesqt()\n\n    Dim dictA As Object, dictB As Object\n    Dim i As Long\n    Dim cell As Range\n    Dim key As Variant\n\n    Set dictA = CreateObject(\"Scripting.Dictionary\")\n    Set dictB = CreateObject(\"Scripting.Dictionary\")\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        For Each cell In .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n            If Not dictA.Exists(cell.Value) Then\n                dictA.Add key:=cell.Value, item:=dictA.Count + 1\n            End If\n        Next\n\n        For Each cell In .Range(\"B2:B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row)\n            If Not dictB.Exists(cell.Value) Then\n                dictB.Add key:=cell.Value, item:=dictB.Count + 1\n            End If\n        Next\n\n        For Each key In dictA.keys\n\n            If Not dictB.Exists(key) Then\n                 .Range(\"C\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row + 1).Value = key\n            End If\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M3cxQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M3cxQ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 131, "user_id": 4734749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cWhOM.png?s=128&g=1", "display_name": "Student201", "link": "https://stackoverflow.com/users/4734749/student201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56041888, "answer_count": 1, "score": 0, "last_activity_date": 1557325506, "creation_date": 1557321047, "last_edit_date": 1557323243, "question_id": 56041641, "link": "https://stackoverflow.com/questions/56041641/how-can-i-see-which-column-a-entries-do-not-appear-in-column-b", "title": "How can I see which Column A entries do not appear in Column B?", "body": "<p>I am trying to see which Column A entries are not in Column B and then print these entries in Column C, and the corresponding B entries in Column D.\nThis code keeps giving me \"Run time error '13': Type mismatch\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pl5ZX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pl5ZX.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\n Sub Test()\n\n  Dim LR As Long, i As Long\n  LR = 8\n\nFor i = 2 To LR\nIf WorksheetFunction.CountIf(Range(\"A\" &amp; i), Range(\"B:B\")) = 0 Then\n    Debug.Print Range(\"A\" &amp; i)\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "edited": false, "score": 0, "creation_date": 1557323620, "post_id": 56041039, "comment_id": 98726777, "body": "First I doubt that you have files and folders with the same name, the file system won&#39;t accept that. Maybe the files have extensions? Be precise when you ask! Second, is this a programming question? If yes, please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, then <a href=\"https://stackoverflow.com/posts/56041039/edit\">edit</a> your question and add your code as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What happens when you run it? What did you expect to happen instead? Any errors? If this is not about programming, the question is off-topic here."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11470177, "user_type": "registered", "profile_image": "https://graph.facebook.com/2079884768804309/picture?type=large", "display_name": "Jamal Basteen", "link": "https://stackoverflow.com/users/11470177/jamal-basteen"}, "edited": false, "score": 0, "creation_date": 1557422673, "post_id": 56041473, "comment_id": 98769197, "body": "Can use CMD to do that"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1557321624, "last_edit_date": 1557321624, "creation_date": 1557320608, "answer_id": 56041473, "question_id": 56041039, "link": "https://stackoverflow.com/questions/56041039/move-files-to-folders/56041473#56041473", "title": "Move files to folders", "body": "<p>In VBA you can move files between folders with <code>Scripting.FileSystemObject</code>. <br> \nTo do that, you can somenthing like in this <code>Sub</code>:</p>\n\n<pre><code>Sub MoveFiles()\n    Dim FSO As Object\n    Dim SourceFileName As String, DestFileName As String\n\n    Set FSO = CreateObject(\"Scripting.Filesystemobject\")\n    SourceFileName = \"C:\\Users\\myUser\\Documents\\Test.xlsx\"\n    DestFileName = \"C:\\Users\\myUser\\Desktop\\Test.xlsx\"\n\n    FSO.MoveFile Source:=SourceFileName, Destination:=DestFileName\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 11470177, "user_type": "registered", "profile_image": "https://graph.facebook.com/2079884768804309/picture?type=large", "display_name": "Jamal Basteen", "link": "https://stackoverflow.com/users/11470177/jamal-basteen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557321624, "creation_date": 1557319195, "question_id": 56041039, "link": "https://stackoverflow.com/questions/56041039/move-files-to-folders", "title": "Move files to folders", "body": "<p>I have files and folders with same name how i can move this files to folder has same name. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1557318824, "post_id": 56040849, "comment_id": 98723675, "body": "Welcome, have you looked at using the <code>Dir()</code> function with a wildcard? e.g. <code>*.csv</code> (assuming that your files will all be in the same folder each time)"}, {"owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1557319038, "post_id": 56040849, "comment_id": 98723799, "body": "I have not, I am very new to VBA and I&#39;m not exactly sure how I would use that."}, {"owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1557319410, "post_id": 56040849, "comment_id": 98724040, "body": "I think I figured it out, thank you for the help!"}, {"owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1557320732, "post_id": 56040849, "comment_id": 98724891, "body": "<code>Dim cAttachment As String  cAttachment = Dir(&quot;C:\\Users\\___\\Desktop\\Test Folder*csv*&quot;)</code> This isn&#39;t working.. thoughts? Dim cAttachment and cAttachment = are on different lines."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1557343449, "post_id": 56040849, "comment_id": 98737026, "body": "It should be cAttachment = Dir(&quot;C:\\Users___\\Desktop\\Test Folder\\*.csv&quot;).  Typing that has taught be that <code>\\*</code> gets changed to <code>*</code> so your statement might not have been as wrong as it looks.  However, the trailing * is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 1, "last_activity_date": 1557320312, "last_edit_date": 1557320312, "creation_date": 1557319250, "answer_id": 56041058, "question_id": 56040849, "link": "https://stackoverflow.com/questions/56040849/is-there-a-way-to-send-a-file-regardless-of-name-as-long-as-it-has-the-csv-exten/56041058#56041058", "title": "Is there a way to send a file regardless of name as long as it has the csv extension?", "body": "<p>You can use this code to discover <strong>all files</strong> with <code>.csv</code> extension exists in a specific folder:</p>\n\n<pre><code>Dim oFile       As Object\nDim oFSO        As Object\nDim oFolder     As Object\nDim oFiles      As Object  \n\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = oFSO.GetFolder(\"C:\\my\\Folder\\\") 'Set this accordingly\nSet oFiles = oFolder.Files\n\n'For all files in the folder\nFor Each oFile In oFiles\n    If (oFile Like \"*.csv\") Then\n        'Add this file to attachments\n        objMessage.AddAttachment oFile.Path\n    End If\nNext\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 31, "user_id": 11464921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20042097a10ba133773003f2d74b6d7e?s=128&d=identicon&r=PG&f=1", "display_name": "ross_J", "link": "https://stackoverflow.com/users/11464921/ross-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56041058, "answer_count": 1, "score": 0, "last_activity_date": 1592464695, "creation_date": 1557318631, "last_edit_date": 1592464695, "question_id": 56040849, "link": "https://stackoverflow.com/questions/56040849/is-there-a-way-to-send-a-file-regardless-of-name-as-long-as-it-has-the-csv-exten", "title": "Is there a way to send a file regardless of name as long as it has the csv extension?", "body": "<p>I will periodically be sending csv files to a client. I am wondering if there is a way to send any file within a folder as long as it has the csv extension as I will not know the name of the file ahead of time.</p>\n\n<p>I believe that I have working code that will allow my VBA script in combination with task scheduler to automatically send emails. I am just stuck on how to attach a file that I do not know the name of. </p>\n\n<pre><code>Const cSmtpUser = \"username\"                                ' *** MAKE CHANGES HERE ***\nConst cSmtpPassword = \"password\"                            ' *** MAKE CHANGES HERE ***\nConst cSmtpServer = \"smtp.xxx.yyy\"                          ' *** MAKE CHANGES HERE ***\nConst cSmtpPort = 465                                       ' *** MAKE CHANGES HERE *** (25, 465, 587 common)\nConst cFromEmail = \"xxxxxxxxx@xxx.yyy\"                      ' *** MAKE CHANGES HERE ***\nConst cToEmail = \"xxxxxxxxx@xxx.yyy\"                        ' *** MAKE CHANGES HERE ***\nConst cSubject = \"Daily Email Subject\"                      ' *** MAKE CHANGES HERE ***\nConst cEmailBody = \"See attached for todays file.\"          ' *** MAKE CHANGES HERE ***\nConst cAttachment = \"c:\\temp\\yourfile.txt\"                  ' *** MAKE CHANGES HERE ***\n\n' CDO Constants needed to send email\nConst cCdoSendUsingPickup = 1   'Send message using the local SMTP service pickup directory.\nConst cCdoSendUsingPort = 2     'Send the message using the network (SMTP over the network).\nConst cCdoAnonymous = 0         'Do not authenticate\nConst cCdoBasic = 1             'basic (clear-text) authentication\nConst cCdoNTLM = 2              'NTLM\nConst cCdoSendUsingMethod        = \"http://schemas.microsoft.com/cdo/configuration/sendusing\"\nConst cCdoSMTPServer             = \"http://schemas.microsoft.com/cdo/configuration/smtpserver\"\nConst cCdoSMTPServerPort         = \"http://schemas.microsoft.com/cdo/configuration/smtpserverport\"\nConst cCdoSMTPConnectionTimeout  = \"http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout\"\nConst cCdoSMTPAuthenticate       = \"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\"\nConst cCdoSendUserName           = \"http://schemas.microsoft.com/cdo/configuration/sendusername\"\nConst cCdoSendPassword           = \"http://schemas.microsoft.com/cdo/configuration/sendpassword\"\nConst cCdoSmtpUseSsl             = \"http://schemas.microsoft.com/cdo/configuration/smtpusessl\"\n\n' Create filesystem object\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n' Get a handle to the config object and it's fields\nSet objConfig = CreateObject(\"CDO.Configuration\")\n\n' Set config fields we care about\nWith objConfig.Fields\n    .Item(cCdoSendUsingMethod)       = cCdoSendUsingPort\n    .Item(cCdoSMTPServer)            = cSmtpServer\n    .Item(cCdoSMTPServerPort)        = cSmtpPort\n    .Item(cCdoSMTPConnectionTimeout) = 60\n    .Item(cCdoSMTPAuthenticate)      = cCdoBasic\n    .Item(cCdoSendUserName)          = cSmtpUser\n    .Item(cCdoSendPassword)          = cSmtpPassword\n    .Item(cCdoSmtpUseSsl)            = True\n    .Update\nEnd With\n\n' Create a new message\nSet objMessage = CreateObject(\"CDO.Message\")\nSet objMessage.Configuration = objConfig\n\n' Populate message fields and send it\nWith objMessage\n    .To       = cToEmail\n    .From     = cFromEmail\n    .Subject  = cSubject\n    .Textbody = cEmailBody\n    If objFSO.FileExists(cAttachment) Then\n        .AddAttachment cAttachment\n    End If\n    .Send\nEnd With\n</code></pre>\n\n<p>Hopefully I will be able to send any file within a folder as long as it has a csv extension. If that is not possible but, it is possible to send any file regardless of extension, I can make it so only csv files are in the folder.</p>\n\n<p>Thank you for the help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1557365377, "post_id": 56041916, "comment_id": 98743200, "body": "Ok So after some testing I realized that the code works perfectly when the data is not filtered, in other words I am showing all the data. Once I filter it and the row numbers are no longer consecutive I get the Run-time error 5 Invalid Procedure call or argument at the namelist_tmp code: namelist = Left(namelist_tmp, Len(namelist_tmp) - 2)"}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1557369075, "post_id": 56041916, "comment_id": 98743914, "body": "After doing a lot of research I have come to find out that WorksheetFunction.CountIf does not work with filtered data. At this point I don&#39;t know what to try."}, {"owner": {"reputation": 71, "user_id": 11446735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFBGq.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/11446735/roland"}, "reply_to_user": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1557392098, "post_id": 56041916, "comment_id": 98752063, "body": "After reading your comment I checked your code for filtered data, for me it works perfectly even for filtered data. Maybe you are using an older version of Excel? This is really strange. By the way, is it a requirement for you to start the range in E column from Row 11? I am referring to this part: <code>WorksheetFunction.CountIf(Range(&quot;E11:E&quot; &amp; myrange.Row)</code>  For your situation, maybe this could be a possible solution: <a href=\"https://stackoverflow.com/questions/37406231/excel-issue-with-countif-with-visible-cells-only\">link</a> Hope it helps."}], "tags": [], "owner": {"reputation": 71, "user_id": 11446735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFBGq.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/11446735/roland"}, "is_accepted": false, "score": 0, "last_activity_date": 1557321954, "creation_date": 1557321954, "answer_id": 56041916, "question_id": 56040805, "link": "https://stackoverflow.com/questions/56040805/using-worksheet-function-countif-for-filtered-cells/56041916#56041916", "title": "Using worksheet function countif for filtered cells", "body": "<p>I have run your code on dummy data and for me it works, I don't get any error.\nAnd this line is perfect, it should be okay:</p>\n\n<pre><code>namelist = Left(namelist_tmp, Len(namelist_tmp) - 2)\n</code></pre>\n\n<p>Can you give some more details?</p>\n"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557324818, "creation_date": 1557318512, "last_edit_date": 1557324818, "question_id": 56040805, "link": "https://stackoverflow.com/questions/56040805/using-worksheet-function-countif-for-filtered-cells", "title": "Using worksheet function countif for filtered cells", "body": "<p>I am using the code below to loop through a filtered column and collect each name of sales person as it loops through; I am using the SpecialCells(xlCellTypeVisible) which is picking up the only the visible rows. I only want the name once so I am using the countif worksheet function. Once I have the name I am storing it in a temp variable (namelist_tmp) and adding a semicolon. The end game is to create a variable (namelist) with each name separated by a semicolon so I can use it in the .to section of some email code I have.</p>\n\n<p>I am able to loop through and capture the name but when I am trying to assign the temp variable to the final variable I get a Run-time error 5 Invalid Procedure call or argument at the namelist_tmp code:\n<code>namelist = Left(namelist_tmp, Len(namelist_tmp) - 2)</code></p>\n\n<p>I an not sure if I am going about this the right way, can a kind soul help my see the error of my ways?</p>\n\n<pre><code>Sub filteredstuff()\nDim lastRow As Long, myrange As Range\nlastRow = Cells(Rows.Count, 2).End(xlUp).Row\nFor Each myrange In Range(\"E11:E\" &amp; lastRow).SpecialCells(xlCellTypeVisible)\n'At each name, use COUNTIF to look upwards and see if the name already exists.\n'If not, add name, semi-colon and space to temporary name list\n         If WorksheetFunction.CountIf(Range(\"E11:E\" &amp; myrange.Row), _\n         Range(\"E\" &amp; myrange.Row)) &lt; 2 Then\n             namelist_tmp = namelist_tmp &amp; Range(\"E\" &amp; myrange.Row).Value &amp; \"; \"\n         End If\n'Strip last semi-colon &amp; space off of temp list\n             namelist = Left(namelist_tmp, Len(namelist_tmp) - 2)\nNext myrange\nMsgBox namelist\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 11163976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f19e1a8bed4052f51a920149b5ee640?s=128&d=identicon&r=PG&f=1", "display_name": "AndyJames", "link": "https://stackoverflow.com/users/11163976/andyjames"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557318083, "post_id": 56040575, "comment_id": 98723232, "body": "@Tom can you highlight where your code is different to mine? I cannot seem to find the distinction.."}, {"owner": {"reputation": 3, "user_id": 11163976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f19e1a8bed4052f51a920149b5ee640?s=128&d=identicon&r=PG&f=1", "display_name": "AndyJames", "link": "https://stackoverflow.com/users/11163976/andyjames"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557318181, "post_id": 56040575, "comment_id": 98723295, "body": "@SJR sorry. I have edited the reference. i seem to have forgotten the bracket in my question. The code itself is correct."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557318453, "post_id": 56040575, "comment_id": 98723448, "body": "Do you have a space after the month number? Best to assign the whole string to a variable and then you can check its precise value."}, {"owner": {"reputation": 3, "user_id": 11163976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f19e1a8bed4052f51a920149b5ee640?s=128&d=identicon&r=PG&f=1", "display_name": "AndyJames", "link": "https://stackoverflow.com/users/11163976/andyjames"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1557318943, "post_id": 56040575, "comment_id": 98723739, "body": "@SJR there actually is a space after the month number! WTH!? How am i to avoid that? EDIT: silly me - as you correctly indicated, i left a space following the variable string. Thanx!"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1557319328, "post_id": 56040575, "comment_id": 98723989, "body": "You should probably handle your user input as well to ensure the user doesn&#39;t lead a trailing space. Simply <code>Trim</code>ing the value should take care of it"}, {"owner": {"reputation": 3, "user_id": 11163976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f19e1a8bed4052f51a920149b5ee640?s=128&d=identicon&r=PG&f=1", "display_name": "AndyJames", "link": "https://stackoverflow.com/users/11163976/andyjames"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1557393114, "post_id": 56040575, "comment_id": 98752671, "body": "@Tom thanks for the tip with thre Trim function! I wouldn&#39;t have thought of that!"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1557402350, "post_id": 56040575, "comment_id": 98757856, "body": "@AndyJames I had a few more suggestions that are longer then a comment to try and safeguard the input as well so have posted as an answer below"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1557402574, "last_edit_date": 1557402574, "creation_date": 1557402259, "answer_id": 56058683, "question_id": 56040575, "link": "https://stackoverflow.com/questions/56040575/workbook-reference-via-vba-doesnt-accept-variable/56058683#56058683", "title": "Workbook reference via VBA doesn&#39;t accept variable", "body": "<p>Personally I'd flesh this out a little further to avoid other mistakes from user input as well. This can be done by using a function to test the user input is the correct criteria and looping until either it is, or the user cancels</p>\n\n<pre><code>Private Function TestUserInput(v As String) As Boolean\n    TestUserInput = False\n\n    If IsNumeric(v) And Len(v) &lt;= 2 Then\n        If CLng(v) &gt; 0 And CLng(v) &lt;= 12 Then\n            TestUserInput = True\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub MonthRef()\n    Dim strMonth As String\n    Dim IsUserInputValid As Boolean\n    Dim InputBoxPrompt As String\n\n    InputBoxPrompt = \"Enter month as integer (e.g. 01 for Jan; 02 for Feb.)\"\n\n    Do\n        strMonth = Trim(InputBox(InputBoxPrompt, \"Month\"))\n\n        ' Test if strMonth is valid\n        IsUserInputValid = TestUserInput(strMonth)\n\n        ' Handle User cancelled\n        If strMonth = vbNullString Then\n            Exit Sub\n        ' If input is not valid then prompt user\n        ElseIf IsUserInputValid = False Then\n            MsgBox prompt:=\"Input not valid. \" &amp; InputBoxPrompt, Title:=\"Error\"\n        End If\n        ' Loop until input is valid or User cancels\n    Loop Until IsUserInputValid\n\n    Range(\"B4\").Formula= \"='G:\\XY\\[XY.xlsx]2019-\" &amp; Format(strMonth, \"00\") &amp; \"'!C1\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11163976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f19e1a8bed4052f51a920149b5ee640?s=128&d=identicon&r=PG&f=1", "display_name": "AndyJames", "link": "https://stackoverflow.com/users/11163976/andyjames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557402574, "creation_date": 1557317659, "last_edit_date": 1557324110, "question_id": 56040575, "link": "https://stackoverflow.com/questions/56040575/workbook-reference-via-vba-doesnt-accept-variable", "title": "Workbook reference via VBA doesn&#39;t accept variable", "body": "<p>I am trying to set up references to other workbooks, whereby the location is static: <code>G:\\XY\\XY\\[Workbook2019.xlsx]2019-04'!C1</code> </p>\n\n<p>Since these references change depending on what month it is, I want, for ease of use, set up an input-box where one can type in a number like 01 or 04 and it would exchange the month part in the reference.</p>\n\n<p>My code looks like this so far:</p>\n\n<pre><code>Sub MonthRef()\n    Dim strMonth As String\n\n    strMonth = InputBox(\"Enter month as interger (e.g. 01 for Jan; 02 for Feb.)\", \"Month\")\n    Range(\"B4\").Formula = \"='G:\\XY\\[XY.xlsx]2019-\" &amp; strMonth &amp; \" '!C1\"\nEnd Sub\n</code></pre>\n\n<p>weirdly enough, I seem to get the correct reference, but the cell wont accept the number for some reason and prompts me to select one of the sheets from a workbook.</p>\n\n<p>I cannot seem to find the problem.\nAny help is greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5787855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJ9GP.gif?s=128&g=1", "display_name": "Pony99CA", "link": "https://stackoverflow.com/users/5787855/pony99ca"}, "is_accepted": false, "score": 0, "last_activity_date": 1593818374, "creation_date": 1593818374, "answer_id": 62723713, "question_id": 56040569, "link": "https://stackoverflow.com/questions/56040569/why-do-we-need-to-use-vbobjecterror-constant-when-raising-user-defined-errors-in/62723713#62723713", "title": "Why do we need to use vbObjectError constant when raising user-defined errors in VBA?", "body": "<p>As nobody answered, I'll hazard a (hopefully educated) guess.  The &quot;error numbers&quot; generated aren't really those between 0 and 65535 (2^16-1).  Those numbers are error offsets that create a negative error code.</p>\n<p>For example, in Access, you'll often see positive error numbers (like 3146 if you can't connect to a DAO workspace).  I wouldn't call those &quot;user errors&quot;, but they are out of the &quot;system error&quot; range.</p>\n<p>Also, if the true error numbers couldn't be larger than 65535 (the largest signed 16-bit number), you wouldn't need a Long type to hold them.</p>\n<p>Finally, if you've ever noticed some error codes displayed by Microsoft products, you'll see hex codes like &quot;8xxxxxxx&quot;, which are large negative numbers in signed decimal, as if they added vbObjectError to their own internal error numbers.</p>\n<p>So your error messages between 513 and 65535 are really convenient numbers for you to use to create error codes by adding to vbObjectError.  I suppose it also makes it easier to create a type that stores error information (error number, Description, Help ID, etc.) and create an array of those types.  For example, Errors(0) would return the type with error number 513 and other information that you might need in your ERR.Raise statement.</p>\n<p>But why is vbObjectError equal to -2147221504?  I don't know.  That's not -(2^31) + 512.  In hex, it's FFFFFFFF80040000.  I guess you'll have to ask Microsoft about that one.</p>\n<p>For more information, here's another site's thoughts on this:  <a href=\"http://www.vbforums.com/showthread.php?570075-vbObjectError-what-is-it-for\" rel=\"nofollow noreferrer\">http://www.vbforums.com/showthread.php?570075-vbObjectError-what-is-it-for</a></p>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 1036274, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/p07PE.jpg?s=128&g=1", "display_name": "nunzabar", "link": "https://stackoverflow.com/users/1036274/nunzabar"}, "is_accepted": false, "score": 0, "last_activity_date": 1601756976, "creation_date": 1601756976, "answer_id": 64188698, "question_id": 56040569, "link": "https://stackoverflow.com/questions/56040569/why-do-we-need-to-use-vbobjecterror-constant-when-raising-user-defined-errors-in/64188698#64188698", "title": "Why do we need to use vbObjectError constant when raising user-defined errors in VBA?", "body": "<p>I finally found a good answer to this question. The Microsoft documentation for <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/number-property-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Err.Number</a> explains it well and provides this example:</p>\n<pre><code>' Using Number property with an error from an \n' Automation object\nDim MyError, Msg\n' First, strip off the constant added by the object to indicate one\n' of its own errors.\nMyError = Err.Number - vbObjectError\n' If you subtract the vbObjectError constant, and the number is still \n' in the range 0-65,535, it is an object-defined error code.\nIf MyError &gt; 0 And MyError &lt; 65535 Then\n    Msg = &quot;The object you accessed assigned this number to the error: &quot; _\n             &amp; MyError &amp; &quot;. The originator of the error was: &quot; _\n            &amp; Err.Source &amp; &quot;. Press F1 to see originator's Help topic.&quot;\n' Otherwise it is a Visual Basic error number.\nElse\n    Msg = &quot;This error (# &quot; &amp; Err.Number &amp; &quot;) is a Visual Basic error&quot; &amp; _\n            &quot; number. Press Help button or F1 for the Visual Basic Help&quot; _\n            &amp; &quot; topic for this error.&quot;\nEnd If\n    MsgBox Msg, , &quot;Object Error&quot;, Err.HelpFile, Err.HelpContext\n</code></pre>\n<p>The key is that you are expected to subtract the large negative number from Err.Number and do your <code>Select Case</code> on the result. 0 - 65535 means the error was generated by <code>Err.Raise</code>.</p>\n"}], "owner": {"reputation": 167, "user_id": 9639219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGPTz.jpg?s=128&g=1", "display_name": "SpaghettiCode", "link": "https://stackoverflow.com/users/9639219/spaghetticode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1601756976, "creation_date": 1557317649, "question_id": 56040569, "link": "https://stackoverflow.com/questions/56040569/why-do-we-need-to-use-vbobjecterror-constant-when-raising-user-defined-errors-in", "title": "Why do we need to use vbObjectError constant when raising user-defined errors in VBA?", "body": "<blockquote>\n  <p>Microsoft Visual Basic for Applications 7.1; Version 1088</p>\n</blockquote>\n\n<hr>\n\n<p>I created a custom error handler by following online tutorials and I've been using it for about a year now but I still don't get the part where <code>vbObjectError</code> constant is added to a number between 513-65535, which is reserved for user-defined errors. Most tutorials would recommend to use <code>Err.Raise vbOjectError + 1000</code> as an example to generate custom errors. The reason for this is to avoid overlapping with errors 0-512, which is reserved for system errors. If I have to write a code around that idea, the code would look like this:</p>\n\n<pre><code>Option Explicit\n\nSub raiseError()\n\n    On Error GoTo errorHandler\n\n    Dim x As Double\n    Dim y As Double\n\n    Let x = 4.8\n    Let y = 5.5\n\n    If x &lt;&gt; y Then\n        Err.Raise vbObjectError + 1000\n    End If\n\nerrorHandler:\n\n    Select Case Err.Number\n        Case vbEmpty\n            MsgBox \"alright!\"\n\n        Case vbObjectError + 1000\n            MsgBox (\"User-defined error '\" &amp; Err.Number &amp; \"':\" &amp; _\n            vbNewLine &amp; _\n            vbNewLine &amp; _\n            \"X is not equal to Y\")\n\n        Case Is &lt;&gt; vbObjectError + 1000\n            MsgBox \"All other errors\"\n\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>Now, quoting Microsoft from this <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/raise-method\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<p>\"Visual Basic errors (both Visual Basic-defined and user-defined errors) are in the range 0\u201365535. The range 0\u2013512 is reserved for system errors; the range 513\u201365535 is available for user-defined errors.</p>\n\n<p>When setting the Number property to your own error code in a class module, you add your error code number to the vbObjectError constant. For example, to generate the error number 513, assign vbObjectError + 513 to the Number property.\"</p>\n\n<p>But what confuses me is <code>vbObjectError</code> constant has a value of <code>-2147221504</code>. As you can see if you run the code, the sum of <code>vbObjectError</code> and <code>1000</code> or any number between <code>513\u201365535</code> is far from the range 513\u201365535, which is available for user-defined errors according to Microsoft.</p>\n\n<p>If I need to use error numbers in the range of <code>513\u201365535</code>, why not use those numbers directly like <code>Err.Raise 513</code> or <code>Err.Raise 1000</code>?</p>\n\n<p>I'd really appreciate any clarifications from you guys. Thank you all very much.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557318091, "post_id": 56040359, "comment_id": 98723236, "body": "You need to reference workbooks consistently in your code, and using Goto is not generally recommended."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11345763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nn_W_SHdKNU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhbOgB19npAZJmZjNhnbsbzAfDg/mo/photo.jpg?sz=128", "display_name": "otr_91", "link": "https://stackoverflow.com/users/11345763/otr-91"}, "edited": false, "score": 0, "creation_date": 1557397774, "post_id": 56041806, "comment_id": 98755356, "body": "Perfect! Thank you, I&#39;m still new to vba so my code is not that &quot;elegant&quot; yet haha."}, {"owner": {"reputation": 11, "user_id": 11345763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nn_W_SHdKNU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhbOgB19npAZJmZjNhnbsbzAfDg/mo/photo.jpg?sz=128", "display_name": "otr_91", "link": "https://stackoverflow.com/users/11345763/otr-91"}, "edited": false, "score": 0, "creation_date": 1557398114, "post_id": 56041806, "comment_id": 98755516, "body": "Well, it works but I get the error 9 (I wrote the if statement with err.number for each set) on all sets. However, it executes the code, but it doesn&#39;t calculate the y and m variables. So I guess I have some problem related to the range of the worksheets."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 11, "user_id": 11345763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nn_W_SHdKNU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhbOgB19npAZJmZjNhnbsbzAfDg/mo/photo.jpg?sz=128", "display_name": "otr_91", "link": "https://stackoverflow.com/users/11345763/otr-91"}, "edited": false, "score": 0, "creation_date": 1557405119, "post_id": 56041806, "comment_id": 98759369, "body": "Error 9 occures when the referred object doesn&#39;t exist, e.g. you <code>Set shSEC = wbSource.Worksheets(&quot;Seleccion_ECs&quot;)</code> when Seleccion_ECs tab doesn&#39;t exist in the workbook, or wbSource is Nothing. Run the prog step by step with F8 and check if the <code>Set</code>s are fine, e.g. after <code>Set wbsource...</code> issue the <code>?wbsource.name</code> command in the immediate window."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1557321575, "creation_date": 1557321575, "answer_id": 56041806, "question_id": 56040359, "link": "https://stackoverflow.com/questions/56040359/vba-is-there-a-way-to-compare-values-from-two-different-sheets-or-files/56041806#56041806", "title": "vba is there a way to compare values from two different sheets or files?", "body": "<p>I recommend using the following technique for referencing cells in multiple workbooks/worksheets. This is especially safe at longer processing sessions when the user may change the active workbook/worksheet, and it also save you time by less typing. </p>\n\n<pre><code>Dim wbSource as Workbook, wbDest as Workbook\nDim shSEC as Worksheet, shREQ as Worksheet\n\nSet wbSource = Thisworkbook\nSet wbDest = &lt;.... this is the reference of the other file you're gonna use&gt;\nSet shSEC = wbSource.Worksheets(\"Seleccion_ECs\")\n...\nIf shSEC.Cells(i + 1, E).Value &gt;= shREQ.Cells(40 + Z, 4).Value) ...\n</code></pre>\n\n<p>You should check success after each <code>Set</code> by inserting <code>If Err.Number &lt;&gt; 0 Then &lt;error hadler&gt;</code>so you make sure everything is fine before the loop.</p>\n\n<p>You can replace <code>GoTo ...</code> with <code>Exit For</code>. The prog will work the same way but it is a bit more elegant :)</p>\n"}], "owner": {"reputation": 11, "user_id": 11345763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nn_W_SHdKNU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhbOgB19npAZJmZjNhnbsbzAfDg/mo/photo.jpg?sz=128", "display_name": "otr_91", "link": "https://stackoverflow.com/users/11345763/otr-91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557999848, "creation_date": 1557316909, "last_edit_date": 1557317825, "question_id": 56040359, "link": "https://stackoverflow.com/questions/56040359/vba-is-there-a-way-to-compare-values-from-two-different-sheets-or-files", "title": "vba is there a way to compare values from two different sheets or files?", "body": "<p>I find some difficulties when I try to compare values of two different Workbooks. The code has to delete the rows that do not follow the if condition, that is, if the value from the workbook \"Nuevo hoja de c\u00e1lculo\" is between an interval of values from another workbook called \"Formato CO-08a\", it continues calculating a few variables (m,y_n, y) and if the value does accomplish the second if condition, then the row is deleted.</p>\n\n<p>I have also tried to do it working with sheets from the same workbook, copying in the Workbook \"Nuevo hoja de calculo\" the sheet from the workbook \"Formato CO-08a\". But it still doesn't work, as the program doesn't achieve to read the values from this copied sheet. The example I wrote below works with sheets from the same workbook, but my goal is to work with 2 different workbooks.</p>\n\n<pre><code>For i = 1 To Sheets(\"Seleccion_ECs\").listaopciones.ListCount\nLine1:\n        For Z = 0 To 7\n            Debug.Print Z\n            If (Sheets(\"Seleccion_ECs\").Cells(i + 1, E).Value &gt;= ThisWorkbook.Sheets(\"Requisitos Contenedor + ATI\").Cells(40 + Z, 4).Value) And (Sheets(\"Seleccion_ECs\").Cells(i + 1, E).Value &lt;= ThisWorkbook.Sheets(\"Requisitos Contenedor + ATI\").Cells(41 + Z, 4).Value) Then\n\n                m = (ThisWorkbook.Sheets(\"Requisitos Contenedor + ATI\").Cells(41 + Z, 2).Value - ThisWorkbook.Sheets(\"Requisitos Contenedor + ATI\").Cells(40 + Z, 2).Value) / (ThisWorkbook.Sheets(\"Requisitos Contenedor + ATI\").Cells(41 + Z, 4).Value - ThisWorkbook.Sheets(\"Requisitos Contenedor + ATI\").Cells(40 + Z, 4).Value)\n\n                y = m * (Sheets(\"Seleccion_ECs\").Cells(i + 1, E).Value - Sheets(\"Requisitos Contenedor\").Cells(40 + Z, 2).Value) + Sheets(\"Requisitos Contenedor\").Cells(40 + Z, 4).Value\n\n                y_n = Sheets(\"Seleccion_ECs\").Cells(i + 1, Q).Value\n\n                Debug.Print (\"Se ha encontrado un intervalo\")\n\n                If y_n &gt; 1.02 * y Then 'Si se sale en un 2 por ciento de la zona aceptada, se elimina la fila.\n\n                    Worksheets(\"Seleccion_ECs\").Rows(i + 1).Delete\n\n                    GoTo Line1\n\n                Else:\n\n                    i = i + 1 'Preguntar si vale esto teniendo el for i=0\n\n                    GoTo Line1\n\n                End If\n\n            End If\n\n        Next Z\n\nNext i\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1557316725, "post_id": 56040239, "comment_id": 98722476, "body": ".LoadFile() is the way to do it, double check the path is what you think it is (full paths are best)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557324089, "post_id": 56040239, "comment_id": 98727083, "body": "Please <a href=\"https://stackoverflow.com/posts/56040239/edit\">edit</a> your question and include your code and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. We cannot help you if we don&#39;t see your code (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>)."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1557367114, "post_id": 56040239, "comment_id": 98743507, "body": "You actually have a file named <code>2019AA-10000V1richtextfile.rtf</code> in the folder <code>C:\\Users\\Donkey\\Desktop\\Test One</code>?"}], "owner": {"reputation": 67, "user_id": 5954093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqYoZ.jpg?s=128&g=1", "display_name": "Momom0", "link": "https://stackoverflow.com/users/5954093/momom0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557365338, "creation_date": 1557316500, "last_edit_date": 1557365338, "question_id": 56040239, "link": "https://stackoverflow.com/questions/56040239/load-contents-of-rtf-file-into-richtextbox-control", "title": "Load contents of .rtf file into RichTextBox Control", "body": "<p>I am trying to build an Excel application with UserForms. In a UserForm, I've successfully added RichTextBoxes. I have also successfully coded a button to save all RichTextBox contents in an .rtf file.</p>\n\n<p>This is where I'm stuck:</p>\n\n<p>There does not seem to be a way to load the contents of an rtf file into a RichTextBox.</p>\n\n<p>I've flipped through 5 pages of various google searches, but none gave any clues towards Excel VBA... all were on C#...</p>\n\n<p>Speaking of C#, when I try something similar such as .rtfOne.LoadFile(filePath) I get an error:</p>\n\n<blockquote>\n  <p>Run-Time error '75':<br>\n  The specified Path/file name cannot be accessed or is invalid.</p>\n</blockquote>\n\n<p>Code I tried:</p>\n\n<pre><code>Dim filePath As String\nfilePath = \"C:\\Users\\Donkey\\Desktop\\Test One\\\" &amp; Cells(1,1)\nUserForm.richtextbox1.LoadFile(filePath &amp; \"richtextfile.rtf\")\n</code></pre>\n\n<p>I have included a MsgBox in my code to see how the compiler reads this line, it is read correctly as:</p>\n\n<pre><code>C:\\Users\\Donkey\\Desktop\\Test One\\2019AA-10000V1richtextfile.rtf\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557315840, "post_id": 56039968, "comment_id": 98722016, "body": "hi, i believe that u have to  do a copy / pastespecial. i didnt  test, but something like &quot;CCtl.Range.Text.copy&quot; and next &quot;myWkSht.Cells(i, j).PasteSpecial Paste:=xlPasteValues&quot; . good luck"}, {"owner": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557322445, "post_id": 56039968, "comment_id": 98726013, "body": "its giving compile error on text CCtl.Range.Text.copy (invalid qualifier)"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557323385, "post_id": 56039968, "comment_id": 98726624, "body": "try with CCtl.Range.Copy"}, {"owner": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557323550, "post_id": 56039968, "comment_id": 98726730, "body": "not worked. error: expected function or variable."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557324063, "post_id": 56039968, "comment_id": 98727067, "body": "ive made a word test file and theres no error. did u put             &quot;CCtl.Range.Copy&quot; and &quot;myWkSht.Cells(i, j).PasteSpecial Paste:=xlPasteValues&quot;. it gives error in witch line ?"}, {"owner": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1557325009, "post_id": 56039968, "comment_id": 98727696, "body": "Not working: I am puting like this myWkSht.Cells(i, j).Value = CCtl.Range.Text  CCtl.Range.Copy  Next  myWkSht.Cells(i, j).PasteSpecial Paste:=xlPasteValues   myWkSht.Columns.AutoFit  End With&#39;&#39;&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "edited": false, "score": 0, "creation_date": 1557387656, "post_id": 56044346, "comment_id": 98749634, "body": "thanks its working, but now the problem is its not pasting in all the bullets in single cell any idea to improve?"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "reply_to_user": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "edited": false, "score": 0, "creation_date": 1557402381, "post_id": 56044346, "comment_id": 98757872, "body": "u are selecting one control each time with &quot;For Each CCtl In .ContentControls. u must select multiple to copy all in once"}], "tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": 0, "last_activity_date": 1557329869, "creation_date": 1557329869, "answer_id": 56044346, "question_id": 56039968, "link": "https://stackoverflow.com/questions/56039968/how-do-i-transfer-formatted-text-from-word-to-excel/56044346#56044346", "title": "How do I transfer formatted text from Word to Excel?", "body": "<p>try with this block</p>\n\n<pre><code>With myDoc\n    j = 0\n    For Each CCtl In .ContentControls\n        j = j + 1\n        CCtl.Range.Copy\n        myWkSht.Cells(i, j).PasteSpecial Paste:=xlPasteValues\n    Next\n    myWkSht.Columns.AutoFit\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557329869, "creation_date": 1557315575, "last_edit_date": 1557322799, "question_id": 56039968, "link": "https://stackoverflow.com/questions/56039968/how-do-i-transfer-formatted-text-from-word-to-excel", "title": "How do I transfer formatted text from Word to Excel?", "body": "<p>The below code is copied data from MS Word (content control) to Excel. However, when I copy text with bullet and paste into Excel, it removes the bullets and pastes the text only. </p>\n\n<p>How can I copy bullets from the content control?</p>\n\n<pre><code>Sub getWordFormData()\nDim wdApp As New Word.Application\nDim myDoc As Word.Document\nDim CCtl As Word.ContentControl\nDim myFolder As String, strFile As String\nDim myWkSht As Worksheet, i As Long, j As Long\n\nmyFolder = \"enter folder path\" '&lt;&lt; enter you folder path for the word document\n\nIf Dir(myFolder &amp; \"\\\" &amp; \"*.*\") = \"\" Then\n    Application.ScreenUpdating = True\n    MsgBox \"The folder is empty.\"\n    Exit Sub\nEnd If\n\nSet myWkSht = ActiveSheet\nActiveSheet.Cells.Clear\nRange(\"A1\") = \"Test 1\"\nRange(\"B1\") = \"Test 2\"\nRange(\"A1:B1\").Font.Bold = True\n\ni = myWkSht.Cells(myWkSht.Rows.Count, 1).End(xlUp).Row\nstrFile = Dir(myFolder &amp; \"\\*.docx\", vbNormal)\n\nWhile strFile &lt;&gt; \"\"\n    i = i + 1\n\n    Set myDoc = wdApp.Documents.Open(Filename:=myFolder &amp; \"\\\" &amp; strFile, AddToRecentFiles:=False, Visible:=False)\n\n    With myDoc\n        j = 0\n        For Each CCtl In .ContentControls\n            j = j + 1\n            myWkSht.Cells(i, j) = CCtl.Range.Text\n        Next\n        myWkSht.Columns.AutoFit\n    End With\n\n    myDoc.Close SaveChanges:=False\n    strFile = Dir()\nWend\n\nwdApp.Quit\nSet myDoc = Nothing: Set wdApp = Nothing: Set myWkSht = Nothing\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1557316561, "post_id": 56039848, "comment_id": 98722383, "body": "Wouldn&#39;t it be to do with the fact that you have <code>Recordsource</code> rather than <code>RecordsetType</code> when creating the property?"}], "owner": {"reputation": 11, "user_id": 11469630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/983daf67a874602deec6a01cbd540c87?s=128&d=identicon&r=PG&f=1", "display_name": "scz11", "link": "https://stackoverflow.com/users/11469630/scz11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557315227, "creation_date": 1557315227, "question_id": 56039848, "link": "https://stackoverflow.com/questions/56039848/recordsettype-property-not-found-as-a-valid-property-in-querydefs", "title": "RecordsetType property not found as a valid property in QueryDefs", "body": "<p>I am trying to lock my queries in my MS Access 2016 frontend, so that users see only a snapshot of the queries and are not able to edit the SQL code nor the data in the queries. However I run into problems with my VBA code:</p>\n\n<pre><code>'Lock queries\nFor Each oQD In CurrentDb.QueryDefs\n    'If Left(oQD.Name, 3) = \"qry\" Then\n    If Left(oQD.Name, 1) &lt;&gt; \"~\" Then\n        Set oProp = oQD.Properties(\"RecordsetType\")\n        If Err Then\n            Set oProp = oQD.CreateProperty(\"RecordSource\", dbText, \"Snapshot\")\n            oQD.Properties.Append oProp\n        Else\n            oProp.Value = 2\n        End If\n    End If\nNext oQD\n</code></pre>\n\n<p>which returns runtime error '3270': property not found for \"RecordsetType\". Can anyone help with this?</p>\n"}, {"tags": ["vba", "ms-word", "word-contentcontrol"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1557433419, "post_id": 56066015, "comment_id": 98773887, "body": "Thank you! It works very well. Actually, it&#39;s way more complex that my current level of VBA knowledge, but I&#39;m glad I am learning new tricks. I was checking whether the control is a checkbox because I thought that using some kind of filters to the controlboxes would somehow make the process faster, instead of checking the tag through all content controls. I am still a newbie."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 1, "creation_date": 1557437097, "post_id": 56066015, "comment_id": 98775276, "body": "@MarianV. Actually, the additional check will make it execute more slowly. An <code>If</code> doesn&#39;t filter in the sense you have in mind - the <code>For</code> still loops all the controls. In the code in the question, it&#39;s looping for every tag variation; in the suggested answer, the loop executes only once. A possible &quot;filter&quot; would be to check <code>If Instr(cc.tag, &quot;ck&quot;) &lt;&gt; 0 Then</code> to jump over the <code>Select Case</code> if not a checkbox. Whether this would be faster would depend on whether the document has lots of other kinds of controls and it would be necessary to test how much it would actually bring."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1557439932, "post_id": 56066015, "comment_id": 98776192, "body": "To my better understanding of the <code>Select Case</code>, if layout of the content controls would consist in three tiers of checkboxes (chk1 -&gt; chk1_1 -&gt; chk1_1_1), what adaptation does the code need?  I\u2019ve tested and the code executes only the first occurrence of the <code>Case Is</code> where the condition is met. A workaround would be to loop twice using <code>For i = 1 to 2</code> before <code>For Each</code> line."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1557467231, "post_id": 56066015, "comment_id": 98781663, "body": "I&#39;m currently on a moble device, so can&#39;t test, but: Immediately under the first level <code>Case Is &gt; &quot;chk1&quot;</code> put another <code>Select Case</code> that tests <code>Case Is &gt; &quot;chk1_n&quot;</code> where there order of <code>n</code> is the <i>highest value</i> used to the lowest."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1557646887, "post_id": 56066015, "comment_id": 98829652, "body": "Yes, it worked, it&#39;s like a nested select case. Testing these days, I&#39;ve found out that using <code>Case &quot;chk1_&quot; To &quot;chk1_99&quot;</code> is the best approach for my code, instead of <code>Case Is &gt; &quot;chk1&quot;</code> because it gives the minimum space for error. Thank you for your input, it was very helpful."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1557428545, "creation_date": 1557428545, "answer_id": 56066015, "question_id": 56039608, "link": "https://stackoverflow.com/questions/56039608/change-state-of-content-control-checkbox-based-on-other-checkboxes-state/56066015#56066015", "title": "Change state of content control checkbox based on other checkboxes state", "body": "<p>Something like this could be easier to read and maintain.</p>\n\n<p>If the control naming is consistent there should be no need to check whether the control is a checkbox - the name will identify that.</p>\n\n<p><code>Select Case</code> is an alternative to <code>If</code> when using multiple \"or\" criteria - somewhat easier to read... And in this case it can compare the common section of the tag names for a group. \"Greater than\" will pick up the longer tag names under the upper-level control that has only the common characters.</p>\n\n<p>Note that you need work backwards through the alphabet when using this approach.</p>\n\n<p>Then, the actual actions performed each time are put in a separate procedure, called by each \"Case\".</p>\n\n<p>So, when writing the code for multiple controls you can pretty much copy/paste the <code>Case</code> then alter the two tag strings for each control set.</p>\n\n<pre><code>Sub GetCC_Set()\n    Dim cc As Word.ContentControl\n    Dim doc As Word.Document\n\n    Set doc = ActiveDocument\n    For Each cc In doc.Contentcontrols\n        Select Case cc.tag\n            Case Is &gt; \"ck2\"\n                Debug.Print 2\n                CheckItems \"ck2\", cc\n            Case Is &gt; \"ck1\"\n                Debug.Print 1\n                CheckItems \"ck1\", cc\n            Case Else\n                Debug.Print cc.tag\n        End Select\n    Next                \nEnd Sub\n\nSub CheckItems(tag As String, cc As Word.ContentControl)\n    If cc.Checked = True Then\n        cc.Parent.SelectContentControlsByTag(tag).Item(1).Checked = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 56066015, "answer_count": 1, "score": 0, "last_activity_date": 1557428545, "creation_date": 1557314453, "question_id": 56039608, "link": "https://stackoverflow.com/questions/56039608/change-state-of-content-control-checkbox-based-on-other-checkboxes-state", "title": "Change state of content control checkbox based on other checkboxes state", "body": "<p>I have a template .dotm in which I have multiple checkbox content controls. They are organised in groups as follows:</p>\n\n<pre><code>[chk_1] Attach all the items listed below:\n\n      [chk_1_1] Item A\n      [chk_1_2] Item B\n      [chk_1_3] Item C\n\n[chk_2] Send the details provided below:\n\n      [chk_2_1] Info A\n      [chk_2_2] Info B\n      [chk_2_3] Info C\n</code></pre>\n\n<p>What I'm trying to do is a method to autocheck <code>chk_1</code> if any of the subitems are checked, as some sort of failproof system, if the user forget to manually check <code>chk_1</code>.\nSo far, I've managed to do this manually, as follows:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\nDim ctl As ContentControl\nFor Each ctl In ActiveDocument.ContentControls\nIf ctl.Type = wdContentControlCheckBox Then\n    If ctl.Tag = \"chk_1_1\" or ctl.Tag = \"chk_1_2\" or ctl.Tag = \"chk_1_3\" Then\n        If ctl.Checked = True Then\n            ActiveDocument.SelectContentControlsByTag(\"chk_1\").Item(1).Checked = True\n        End If\n    End If\nEnd If         \nNext\nDim ctl2 As ContentControl\nFor Each ctl2 In ActiveDocument.ContentControls\nIf ctl2.Type = wdContentControlCheckBox Then\n    If ctl2.Tag = \"chk_2_1\" or ctl2.Tag = \"chk_2_2\" or ctl2.Tag = \"chk_2_3\" Then\n        If ctl2.Checked = True Then\n            ActiveDocument.SelectContentControlsByTag(\"chk_2\").Item(1).Checked = True\n        End If\n    End If\nEnd If         \nNext\nEnd Sub\n</code></pre>\n\n<p>This code is executed when an ActiveX button <code>btnSubmit</code> is clicked and autotick the parent checkboxes, if any of the child checkboxes are ticked.</p>\n\n<p>I want to simplify the code because, over the time, there will be multiple groups with 20+ checkboxes each and the code will be harder to write.</p>\n\n<p>Is there a way to use a string or that checks for the state of all the checkboxes that are tagged <code>chk_x_y</code> and then to modify the state <code>chk_x</code>?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557315811, "post_id": 56039999, "comment_id": 98721999, "body": "The OP says he is looking for a way avoiding a loop. &quot;I know I can loop&quot;."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1557315698, "creation_date": 1557315698, "answer_id": 56039999, "question_id": 56039589, "link": "https://stackoverflow.com/questions/56039589/is-there-simpler-way-to-check-the-borders-colorindex-of-a-range/56039999#56039999", "title": "Is there simpler way to check the Borders.ColorIndex of a range?", "body": "<p>One possible solution:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim cell As Range, rng As Range\n\n    Set rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A10\")\n\n    For Each cell In rng\n        Debug.Print cell.Borders.ColorIndex\n    Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557323971, "creation_date": 1557314397, "last_edit_date": 1557323971, "question_id": 56039589, "link": "https://stackoverflow.com/questions/56039589/is-there-simpler-way-to-check-the-borders-colorindex-of-a-range", "title": "Is there simpler way to check the Borders.ColorIndex of a range?", "body": "<p>As the title suggests. I know I can loop through all the cells within certain range to check the colorindex of each cell's borders, though I wonder if there's any simpler way to do the same task. </p>\n\n<p>Any insight would be appreciated, thank you very much!</p>\n"}, {"tags": ["excel", "vba", "caption"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1557314297, "creation_date": 1557314297, "answer_id": 56039546, "question_id": 56039274, "link": "https://stackoverflow.com/questions/56039274/assigning-captions-to-dynamic-form-controls-buttons-based-on-cell-value/56039546#56039546", "title": "Assigning captions to dynamic form controls buttons based on cell value", "body": "<p>Try this. Think it makes more sense to reference the button as you create it so you know you are referencing the correct one.</p>\n\n<pre><code>Sub AddInfo()\n\nDim butn As Button\nDim rng As Range\nDim trial As Range\nDim i As Long\n\nWith Sheets(\"Demand Overview\")\n    Set rng = .Range(\"S:S\")\n    For Each trial In .Range(\"W:W\")\n        If trial.Value &lt;&gt; \"\" Then\n            Set butn = .Buttons.Add(rng.Left, trial.Top, 150, 26)\n            i = i + 1\n            butn.Caption = .Range(\"W\" &amp; 2 * i).Value\n        End If\n    Next trial\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>By the way, I wouldn't loop through the whole of W, find the last row and limit your loop to what is necessary rather than all million rows.</p>\n"}], "owner": {"reputation": 3, "user_id": 11468929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--QUSKcJKqiA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfdWWNG4tuitBZrZGSa68UuxdEduA/mo/photo.jpg?sz=128", "display_name": "peter17", "link": "https://stackoverflow.com/users/11468929/peter17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 56039546, "answer_count": 1, "score": 0, "last_activity_date": 1557323950, "creation_date": 1557313381, "last_edit_date": 1557323950, "question_id": 56039274, "link": "https://stackoverflow.com/questions/56039274/assigning-captions-to-dynamic-form-controls-buttons-based-on-cell-value", "title": "Assigning captions to dynamic form controls buttons based on cell value", "body": "<p>I am pretty new to Excel VBA so I apologize in advance if something will be vaguely described.\nI am having a code, which inserts on the \"Demand Overview\" worksheet into column W certain number of product names (\"Product X\", \"Product Y\" etc....the number of products are dynamically changing from 1 to 100), always starting in the cell W2 and always skipping one cell between each product (like Product X would be in W2, Product Y in W4 etc.)\nWhat I would like to code in VBA, is to create a form control button for each of the product names and to change their caption to the name of the products in column W.\nI could write the code for dynamically creating as many form control buttons as many product names are in column W, however, I am struggling to assign the captions to them, since I always get the error: \"Unable to get the Buttons property of the Worksheet class\" </p>\n\n<p>The assigning logic would be that Button 1 would get the product name located in W2, Button 2 would get the product name located in W4 etc.</p>\n\n<p>Any help would be highly appreciated!\nThanks in advance! </p>\n\n<pre><code>Sub AddInfo()\n\n\nDim butn As Button\nDim rng As Range\nDim trial As Range\nDim i As Integer\n\nSheets(\"Demand Overview\").Select\nSet rng = ActiveSheet.Range(\"S:S\")\nFor Each trial In ActiveSheet.Range(\"W:W\")\n\n If trial.Value &lt;&gt; \"\" Then Set butn = ActiveSheet.Buttons.Add(rng.Left, \n trial.Top, 150, 26)\n\nNext trial\n\n'the code works until this point\n\nWith ActiveSheet\nFor i = 1 To 100\n.Buttons(\"Button\" &amp; i).Caption = Range(\"W\" &amp; 2 * i)\n Next i\n End With\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11469520, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-flI38zsdS0w/AAAAAAAAAAI/AAAAAAAAAc4/JU1k-00N9Hw/photo.jpg?sz=128", "display_name": "OskarB", "link": "https://stackoverflow.com/users/11469520/oskarb"}, "edited": false, "score": 0, "creation_date": 1557388725, "post_id": 56044438, "comment_id": 98750191, "body": "Thank you! I&#39;ll look into it."}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 1, "last_activity_date": 1557330194, "creation_date": 1557330194, "answer_id": 56044438, "question_id": 56039069, "link": "https://stackoverflow.com/questions/56039069/send-task-notifications-in-outlook/56044438#56044438", "title": "Send task notifications in Outlook?", "body": "<p>You have to generate a task within a public folder to assign it to another owner.</p>\n\n<p>To add an additional recipient, you add a new <code>Recipient</code> object and then define its type. Type <code>olUpdate</code> leads to <code>StatusUpdateRecipients</code> and Type <code>olFinalStatus</code> to <code>StatusOnCompletionRecipients</code>.</p>\n\n<pre><code>Private Sub GeneratePublicTask()\n    Dim objNamespace As Outlook.NameSpace\n    Dim objPublicFolderRoot As Outlook.Folder\n    Dim objPublicTaskFolder As Outlook.Folder\n    Dim objMyTaskFolder As Outlook.Folder\n    Dim objTask As Outlook.TaskItem\n\n    Dim objRecipientOwner As Outlook.Recipient\n    Dim objRecipientEveryStatusUpdate As Outlook.Recipient\n    Dim objRecipientFinalStatusOnly As Outlook.Recipient\n\n    Dim EmailOwner As String\n    Dim EmailEveryStatusUpdate As String\n    Dim EmailFinalStatusOnly As String\n\n    EmailOwner = \"IsOwner@ACME.com\"\n    EmailEveryStatusUpdate = \"GetsEveryUpdate@ACME.com\"\n    EmailFinalStatusOnly = \"GetsFinalStatusOnly@ACME.com\"\n\n    Set objNamespace = Application.GetNamespace(\"MAPI\")\n    Set objPublicFolderRoot = objNamespace.GetDefaultFolder(olPublicFoldersAllPublicFolders)\n    Set objPublicTaskFolder = objPublicFolderRoot.Folders(\"Public Tasks\")\n    Set objTask = objPublicTaskFolder.Items.Add(olTaskItem)\n\n    ' For local folder tests:\n    ' Set objMyTaskFolder = objNamespace.GetDefaultFolder(olFolderTasks)\n    ' Set objTask = objMyTaskFolder.Items.Add(olTaskItem)\n\n    With objTask\n        .Subject = \"Example Subject Text\"\n        .Body = \"Example Body Text\"\n        .Status = olTaskNotStarted\n        .Importance = olImportanceHigh\n        .StartDate = Date\n        .DueDate = Date + 7\n        .ReminderTime = .DueDate - 1.5\n        .Role = \"Example Role Text\"\n\n        Set objRecipientOwner = .Recipients.Add(EmailOwner)\n        'objRecipientOwner.Type = olTo ' not necessary, first is To\n\n        Set objRecipientEveryStatusUpdate = .Recipients.Add(EmailEveryStatusUpdate)\n        objRecipientEveryStatusUpdate.Type = olUpdate\n\n        Set objRecipientFinalStatusOnly = .Recipients.Add(EmailFinalStatusOnly)\n        objRecipientFinalStatusOnly.Type = olFinalStatus\n\n        .Recipients.ResolveAll\n\n        .Assign\n        '.Save\n\n        Debug.Print .Owner      ' still yourself?\n        Debug.Print .Ownership  ' 0 = olNewTask, 2 = olOwnTask, 1 = olDelegatedTask\n        Debug.Print .StatusUpdateRecipients         ' Type olUpdate\n        Debug.Print .StatusOnCompletionRecipients   ' Type olFinalStatus\n\n        .Display\n        '.Send\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11469520, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-flI38zsdS0w/AAAAAAAAAAI/AAAAAAAAAc4/JU1k-00N9Hw/photo.jpg?sz=128", "display_name": "OskarB", "link": "https://stackoverflow.com/users/11469520/oskarb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 56044438, "answer_count": 1, "score": 1, "last_activity_date": 1592464706, "creation_date": 1557312786, "last_edit_date": 1592464706, "question_id": 56039069, "link": "https://stackoverflow.com/questions/56039069/send-task-notifications-in-outlook", "title": "Send task notifications in Outlook?", "body": "<p>I'm making an Excel sheet in which the group leader writes a task then sends it to the worker.</p>\n\n<p>I have this part figured out, but every task is sent to three people. The worker, the group leader and his assistant.</p>\n\n<p>Is there a way to only send notifications about the task to the group leader and the assistant?</p>\n\n<p>I have looked into TaskItem properties and found two potential solutions:</p>\n\n<ul>\n<li>TaskItem.StatusUpdateRecipients property </li>\n<li>TaskItem.StatusOnCompletionRecipients property</li>\n</ul>\n\n<p>But I don't understand how they work. Can someone explain how they work or is there a better solution to this problem?</p>\n\n<p>This is how I used these two properties:</p>\n\n<pre><code>With objTask\n\n    .Assign\n    .Subject = Worksheets(\"Naloge\").Range(\"E\" &amp; Trow)\n    .Body = \"Some text\"\n    .Status = olTaskNotStarted\n    .Importance = olImportanceHigh\n    .StartDate = Worksheets(\"Naloge\").Range(\"B\" &amp; Trow)\n    .DueDate = Worksheets(\"Naloge\").Range(\"C\" &amp; Trow)\n    .ReminderTime = .DueDate - 1.5\n    '.Owner = Worksheets(\"Naloge\").Range(\"G\" &amp; Trow)\n    '.Role = Worksheets(\"Naloge\").Range(\"G\" &amp; Trow)\n    .Recipients.Add (EmailTo)\n    If Len(EmailCc) &gt; 1 Then\n        '.Recipients.Add (EmailCc)\n        .StatusUpdateRecipients (EmailCc)\n        .StatusOnCompletionRecipients (EmailCc)\n    End If\n    If Len(EmailVodja) &gt; 1 Then\n        .StatusOnCompletionRecipients.Add (EmailVodja)\n        .StatusUpdateRecipients.Add (EmailVodja)\n    End If\n    .Send\n    .Save\nEnd With\n</code></pre>\n\n<p>The code stops at those two properties and shows</p>\n\n<blockquote>\n  <p>Compile error: \"Invalid use of property\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1557312747, "post_id": 56038980, "comment_id": 98720278, "body": "What if you just loop and populate the listbox that way?"}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1557313795, "post_id": 56038980, "comment_id": 98720918, "body": "Do you have any references to that?"}], "answers": [{"comments": [{"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 0, "creation_date": 1557335009, "post_id": 56039489, "comment_id": 98733045, "body": "Thanks, the gif really helps"}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 0, "creation_date": 1557335495, "post_id": 56039489, "comment_id": 98733283, "body": "quick question, what is the &#39;3&#39; referring to, on the 3rd line?"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 1, "creation_date": 1557347289, "post_id": 56039489, "comment_id": 98738620, "body": "@BCLtd that\u2019s the 2nd parameter to the LEFT function which stipulates how many characters to get from the left hand side of the given text. So much to learn.  \ud83d\ude0a Glad I could help anyway."}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 2, "last_activity_date": 1557314133, "creation_date": 1557314133, "answer_id": 56039489, "question_id": 56038980, "link": "https://stackoverflow.com/questions/56038980/populate-listbox-based-on-cell-values/56039489#56039489", "title": "Populate ListBox Based on Cell Values", "body": "<p>I assume you're talking about a list box in a userform, if so, I hope this works for you ...</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    For i = 1 To 10\n        If UCase(Left(Sheet1.Cells(i, 1), 3)) = \"YES\" Then\n            ListBox1.AddItem Sheet1.Cells(i, 1)\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RL38z.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RL38z.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "reply_to_user": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 1, "creation_date": 1557385981, "post_id": 56039534, "comment_id": 98748796, "body": "lC is a counter for listbox rows, the first row num is zero"}], "tags": [], "owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "is_accepted": false, "score": 1, "last_activity_date": 1557314252, "creation_date": 1557314252, "answer_id": 56039534, "question_id": 56038980, "link": "https://stackoverflow.com/questions/56038980/populate-listbox-based-on-cell-values/56039534#56039534", "title": "Populate ListBox Based on Cell Values", "body": "<p>just an example</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Set sh = ThisWorkbook.Worksheets(1)\n    With sh\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n    lC = 0\n    With Me.ListBox1\n        .ColumnCount = 2\n        .RowSource = \"\"\n        For r = 2 To LR\n            If Left(sh.Cells(r, 1), 1) = \"P\" Then ' &lt;&lt;&lt; to changed condition\n                .AddItem\n                .List(lC, 0) = sh.Cells(r, 1)\n                .List(lC, 1) = sh.Cells(r, 2)\n                lC = lC + 1\n            End If\n        Next\n        If .ListCount = 0 Then MsgBox \"No data found\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1254, "favorite_count": 0, "accepted_answer_id": 56039489, "answer_count": 2, "score": 0, "last_activity_date": 1557323923, "creation_date": 1557312525, "last_edit_date": 1557323923, "question_id": 56038980, "link": "https://stackoverflow.com/questions/56038980/populate-listbox-based-on-cell-values", "title": "Populate ListBox Based on Cell Values", "body": "<p>I am populating a listbox based on </p>\n\n<pre><code>With lbInterviews\n   .RowSource = \"=Interviews!A2:P50\"\nEnd With\n</code></pre>\n\n<p>However, how would I do it so it only populates based on if a cell is equals to something e.g.</p>\n\n<p>Only populate this list box, if the cell in sheet: Interviews, column: F is equals to textbox1.text</p>\n"}, {"tags": ["excel", "vba", "do-loops"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 3, "creation_date": 1557311801, "post_id": 56038651, "comment_id": 98719714, "body": "All your <code>End</code> statements in the code should be <code>End If</code> statements, shouldn&#39;t they?"}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 7523634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5n0G.jpg?s=128&g=1", "display_name": "Wolfgang Jacques", "link": "https://stackoverflow.com/users/7523634/wolfgang-jacques"}, "is_accepted": false, "score": 1, "last_activity_date": 1557312085, "creation_date": 1557312085, "answer_id": 56038843, "question_id": 56038651, "link": "https://stackoverflow.com/questions/56038651/a-do-until-loop-nested-in-a-do-while-loop-that-doesnt-compile-in-excel-vba/56038843#56038843", "title": "A Do until loop nested in a do while loop that doesn&#39;t compile in excel VBA", "body": "<p>That's an easy one: It's <code>End If</code>, not <code>End</code>.</p>\n"}], "owner": {"reputation": 55, "user_id": 6847560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a575819b94371315f85da3302a41519?s=128&d=identicon&r=PG&f=1", "display_name": "Mirkaminer", "link": "https://stackoverflow.com/users/6847560/mirkaminer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1576658569, "answer_count": 1, "score": -1, "last_activity_date": 1557312085, "creation_date": 1557311376, "question_id": 56038651, "link": "https://stackoverflow.com/questions/56038651/a-do-until-loop-nested-in-a-do-while-loop-that-doesnt-compile-in-excel-vba", "closed_reason": "Not suitable for this site", "title": "A Do until loop nested in a do while loop that doesn&#39;t compile in excel VBA", "body": "<p>The code doesn't compile and shows a fault in the Do until loop. It says that there is a loop with out a do. There is more code the this and that works fine and i have Option Explicit in top of the module. The fault marker is tagging the 2 to last Loop. What am i missing?</p>\n\n<p>I've tried to put the code in a separate sub\ni've tried </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\n    intLastrowData = wbold.Worksheets(OldSheetName).Cells(Rows.Count, 1).End(xlUp).Row\n    intLastrowNew = WBnew.Worksheets(AktivtBlad).Cells(Rows.Count, 1).End(xlUp).Row\n    i = 3\n    Do While i &lt;= intLastrowNew\n        strValueA = WBnew.Cells(i, intData1).Value\n        strValueB = WBnew.Cells(i, intData2).Value\n        j = 2\n        Do Until strValueA = wbold.Worksheets(OldSheetName).Cells(j, 1).Value\n            If Not wbold.Worksheets(OldSheetName).Cells(j, 1).Value = \"\" Then\n                If strValueA = wbold.Worksheets(OldSheetName).Cells(j, 1).Value Then\n                    If strValueB = wbold.Worksheets(OldSheetName).Cells(j, 2).Value Then\n                        wbold.Worksheets(OldSheetName).Range(Cells(j, 4), Cells(j, 18)).Copy\n                        WBnew.Worksheets(AktivtBlad).Range(Cells(i, intData3)).Paste\n                        Exit Do\n                    End\n                End\n            End\n            j = j + 1\n            If intLastrowData &gt; j - 2 Then\n                Exit Do\n            End\n        Loop\n        i = i + 1\n    Loop\n</code></pre>\n\n<p>I expect it to compare the strValueA and strValueA with data from wbold.Worksheets(OldSheetName) and if it matches to copy data from wbold and pase it in WBnew.\nBut it doesn't compile the the inner Do until Loop.</p>\n"}, {"tags": ["excel", "vba", "url", "web-scraping", "automation"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11366955, "user_type": "registered", "profile_image": "https://graph.facebook.com/679594245793606/picture?type=large", "display_name": "Rich Padama", "link": "https://stackoverflow.com/users/11366955/rich-padama"}, "edited": false, "score": 0, "creation_date": 1557479822, "post_id": 56038738, "comment_id": 98787294, "body": "Is there another way without using selenium?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 11366955, "user_type": "registered", "profile_image": "https://graph.facebook.com/679594245793606/picture?type=large", "display_name": "Rich Padama", "link": "https://stackoverflow.com/users/11366955/rich-padama"}, "edited": false, "score": 0, "creation_date": 1557479890, "post_id": 56038738, "comment_id": 98787345, "body": "Which depending how good your command line is you could write a bat file with urls and simply execute a loop over that via shell in VBA"}, {"owner": {"reputation": 5, "user_id": 11366955, "user_type": "registered", "profile_image": "https://graph.facebook.com/679594245793606/picture?type=large", "display_name": "Rich Padama", "link": "https://stackoverflow.com/users/11366955/rich-padama"}, "edited": false, "score": 0, "creation_date": 1557481103, "post_id": 56038738, "comment_id": 98788079, "body": "Thanks for directing me over to that link. Looks very informative. But I dont think I want to use it though since it would require me to rework the code again since I&#39;m dealing with a list of URLs in a column."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 11366955, "user_type": "registered", "profile_image": "https://graph.facebook.com/679594245793606/picture?type=large", "display_name": "Rich Padama", "link": "https://stackoverflow.com/users/11366955/rich-padama"}, "edited": false, "score": 0, "creation_date": 1557481523, "post_id": 56038738, "comment_id": 98788320, "body": "You can use same idea but concatenate urls from sheet into the shell command"}, {"owner": {"reputation": 5, "user_id": 11366955, "user_type": "registered", "profile_image": "https://graph.facebook.com/679594245793606/picture?type=large", "display_name": "Rich Padama", "link": "https://stackoverflow.com/users/11366955/rich-padama"}, "edited": false, "score": 0, "creation_date": 1557731656, "post_id": 56038738, "comment_id": 98848382, "body": "Its not working, but its ok. I can settle with Internet Explorer."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1557479298, "last_edit_date": 1557479298, "creation_date": 1557311729, "answer_id": 56038738, "question_id": 56038240, "link": "https://stackoverflow.com/questions/56038240/batch-open-urls/56038738#56038738", "title": "Batch Open URLs", "body": "<p>You should specify the name of the sheet in front because your are implicitly working off activesheet which is bug prone. E.g. </p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row \n</code></pre>\n\n<p>From debugging it seems you are finding the wrong end row with xlUp so use xlDown (given you know there are no empty cells between urls)</p>\n\n<pre><code>Sheets(\"Common\").Range(\"J3:J\" &amp; Sheets(\"Common\").Cells(Rows.Count, 1).End(xlDown).Row)\n</code></pre>\n\n<p>If you want to use chrome consider <a href=\"https://stackoverflow.com/a/50181377/6241235\">installing selenium basic</a>. Ensure latest ChromeDriver.exe is in the selenium folder and VBE>Tools>References>Selenium Type Library reference added.</p>\n"}], "owner": {"reputation": 5, "user_id": 11366955, "user_type": "registered", "profile_image": "https://graph.facebook.com/679594245793606/picture?type=large", "display_name": "Rich Padama", "link": "https://stackoverflow.com/users/11366955/rich-padama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 56038738, "answer_count": 1, "score": 0, "last_activity_date": 1557479528, "creation_date": 1557310097, "last_edit_date": 1557479528, "question_id": 56038240, "link": "https://stackoverflow.com/questions/56038240/batch-open-urls", "title": "Batch Open URLs", "body": "<p>I have a worksheet wherein it contains a list of websites in column J, starting in row 3. I would like to have a macro wherein it would batch open all the websites in different tabs on the same browser window.\nI have the existing code below.</p>\n\n<pre><code>Sub Test()\n    Dim ie          As Object\n    Dim c           As Range\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n        .Visible = True\n\n        For Each c In Sheets(\"Common\").Range(\"J3:J\" &amp; Cells(Rows.Count, 1).End(xlUp).Row)\n            .Navigate c.Value, CLng(2048)\n        Next c\n    End With\nEnd Sub\n</code></pre>\n\n<p>It works for the most part. But somehow it would open tabs on the browser window to which there are no values on them.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "ado"], "answers": [{"comments": [{"owner": {"reputation": 2377, "user_id": 3829874, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/x6jBb.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3829874/sam"}, "edited": false, "score": 0, "creation_date": 1557332795, "post_id": 56040070, "comment_id": 98732017, "body": "Would it follow that it would be correct to call a client-side cursor &quot;disconnected&quot; and a server-side cursor &quot;connected&quot;?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 2377, "user_id": 3829874, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/x6jBb.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3829874/sam"}, "edited": false, "score": 0, "creation_date": 1557350332, "post_id": 56040070, "comment_id": 98739780, "body": "Updated the answer."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": true, "score": 1, "last_activity_date": 1557350323, "last_edit_date": 1557350323, "creation_date": 1557315941, "answer_id": 56040070, "question_id": 56037800, "link": "https://stackoverflow.com/questions/56037800/difference-between-ado-client-side-vs-server-side-cursor-when-the-sql-server-dat/56040070#56040070", "title": "Difference between ADO client-side vs server-side cursor when the SQL Server database is local?", "body": "<p>That is a bit incomplete - it's not just about the location but also the type. See, types are limited by the location. With a client-side cursor, you can have static recordset<sup>1</sup>; asking for a keyset or dynamic recordset is not legal with a client-side cursor. When you think about it, that is logical, because the server is the one that has the most current information, so it can be only the one to provide the keyset or the dynamic recordset. </p>\n\n<p>Note that one aspect about ADO is that you don't get an error if you ask for an invalid combination. Rather, it will silently substitute your \"requests\" to a valid request that the provider can serve.<sup>2</sup> Thus, you cannot trust that your requests has been honored until you've actually opened the recordset. After opening, you'll note the type/location/lock may be different from what you requested. </p>\n\n<p>With a client-side static recordset, it basically means the server serves you the data in one big chunk. As you navigate around, there is no further communication with the server for the purpose of keeping the data current. You still can talk to it for the purposes of updating or resyncing, but as the name implies, that is driven by the client.</p>\n\n<p>With a server-side keyset recordset, all you get back from the server is a chain of keys. As you navigate around the recordset, it will have to ask server for the record for that key you are on. So there's less upfront load but more chatty conversation as you work around.</p>\n\n<p>With a server-side dynamic recordset, which is the rarest -- most providers don't implement that -- server is able to notify the client about the changes including additions/deletions, but otherwise it's similar to keyset.</p>\n\n<p>So in short, location is not enough - you must consider both the location and the type together which influences how \"chatty\" your codebase will be with the server. </p>\n\n<h3>Aside -- Disconnected recordsets</h3>\n\n<p>Sometime \"client-side\" gets mixed up with \"disconnected\"... that's actually another thing, though a disconnected recordset by necessity must be a client-side recordset. After all, how could you possibly \"disconnect\" without losing the cache? As alluded to earlier, you still can perform updates on the data with a client-side static recordset; you just don't know if the data has been changed on the server since you retrieved the data at time of opening. With a server-side keyset/dynamic, you are able to check whether data has been changed as soon as you navigate to that record, rather than much earlier right at the opening of the client-side static recordset. Therefore, there is a greater chance of encountering a write conflict with a client-side recordset compared to a server-side recordset, especially if you are using the recordset for browsing around on a form. </p>\n\n<p>Disconnecting a recordset simply means no communication happens when you perform an <code>Update</code> on the recordset and server is not kept in sync. You have the option of re-connecting and committing the changes in bulk, however. </p>\n\n<p>Note that <code>LockType</code> is also affected by the location<sup>3</sup>. It is logical that a client-side recordset can never be pessimistic in their locking because to be pessimistic, you need exclusive control over that and only the server can provide that. </p>\n\n<hr>\n\n<ol>\n<li><p>According to <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/cursortype-property-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">CursorType doc</a>: </p>\n\n<blockquote>\n  <p>Only a setting of adOpenStatic is supported if the CursorLocation property is set to adUseClient.</p>\n</blockquote></li>\n<li><p>From same article:</p>\n\n<blockquote>\n  <p>If an unsupported value is set, then no error will result; the closest supported CursorType will be used instead.</p>\n  \n  <p>If a provider does not support the requested cursor type, it may return another cursor type. The CursorType property will change to match the actual cursor type in use when the Recordset object is open. </p>\n</blockquote></li>\n<li><p>From <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/locktype-property-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">LockType property article</a>:</p>\n\n<blockquote>\n  <p>The <code>adLockPessimistic</code> setting is not supported if the <code>CursorLocation</code> property is set to <code>adUseClient</code>. If an unsupported value is set, then no error will result; the closest supported <code>LockType</code> will be used instead.</p>\n</blockquote></li>\n</ol>\n"}], "owner": {"reputation": 2377, "user_id": 3829874, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/x6jBb.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3829874/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 56040070, "answer_count": 1, "score": 1, "last_activity_date": 1557350323, "creation_date": 1557308677, "last_edit_date": 1557323918, "question_id": 56037800, "link": "https://stackoverflow.com/questions/56037800/difference-between-ado-client-side-vs-server-side-cursor-when-the-sql-server-dat", "title": "Difference between ADO client-side vs server-side cursor when the SQL Server database is local?", "body": "<p>I am using SQLServer EXPRESS on a local PC to house the database and connecting with an ADO recordset from Excel/VBA. </p>\n\n<p><strong>What are the implications of using <code>adUseClient</code> vs <code>adUseServer</code> for the <code>recordset.CursorLocation</code> property?</strong></p>\n\n<p>The documentation I have found primarily deals with the pros and cons of resource availability on the server vs client BUT this is not an issue here as the server &amp; client are the same device.  </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557416990, "post_id": 56037729, "comment_id": 98766492, "body": "i&#39;ve updated answer with regex for your edited pattern."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1557462163, "last_edit_date": 1557462163, "creation_date": 1557310448, "answer_id": 56038345, "question_id": 56037729, "link": "https://stackoverflow.com/questions/56037729/json-values-extraction-from-webpage-using-msxml2-xmlhttp/56038345#56038345", "title": "JSON values extraction from webpage using MSXML2.XMLHTTP", "body": "<p>There isn't anything I can see in your code that attempts to extract this.</p>\n\n<p>You could use regex to specify the appropriate pattern to extract that string. Below, the string you are after is stored in <code>r</code> variable.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Given your edit to the required string you can change the regex to:</p>\n\n<pre><code>\\\"dimensionToAsinMap\\\" :(.*)[^\\r\\n].*\n</code></pre>\n\n<p>Try it <a href=\"https://regex101.com/r/Q1ecsq/1\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><strong>Former answer:</strong></p>\n\n<p>Try regex <a href=\"https://regex101.com/r/9aRiNr/1\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>Option Explicit\nPublic Sub GetData()\n    Dim s As String, r As String, re As Object\n    Set re = CreateObject(\"vbscript.regexp\")\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.yoursite.com?tag=stackoverfl08-20\", False\n        .send\n        s = .responseText\n    End With\n    With re\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"(\"\"dimensionToAsinMap\"\" :.(.|\\n)*)[;^\\r\\n].*return dataToReturn\"\n        If .test(s) Then\n            r = .Execute(s)(0).SubMatches(0)\n        Else\n            r = \"No match\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Locals window check:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/qy70x.png\" width=\"800\"></p>\n\n<hr>\n\n<p><strong>Regex explanation:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/zliNe.png\" width=\"500\"></p>\n"}], "owner": {"reputation": 7, "user_id": 5135699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c313f0df4df4a674ed7d0faf8a5d051?s=128&d=identicon&r=PG&f=1", "display_name": "imran satti", "link": "https://stackoverflow.com/users/5135699/imran-satti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 56038345, "answer_count": 1, "score": -1, "last_activity_date": 1557462163, "creation_date": 1557308462, "last_edit_date": 1557383690, "question_id": 56037729, "link": "https://stackoverflow.com/questions/56037729/json-values-extraction-from-webpage-using-msxml2-xmlhttp", "title": "JSON values extraction from webpage using MSXML2.XMLHTTP", "body": "<p>Currently i am able to extract values from webpage but facing issue json value extraction.</p>\n\n<p>I am using following code for other values extraction.</p>\n\n<pre><code>On Error Resume Next\nSet http = CreateObject(\"MSXML2.XMLHTTP\")\n    http.Open \"GET\", url1234, False\n    http.Send\n    html.body.innerHTML = http.ResponseText\n    brand = html.body.innerText\n    'MsgBox (brand)\n\n</code></pre>\n\n<p>Above code is not extracting following values of this url </p>\n\n<pre><code>\"\" : {\"0\":\"B0037RYT96\",\"1\":\"B0152VYOQ2\",\"2\":\"B0152WOT70\",\"3\":\"B003W0NYKS\",\"4\":\"B0152WOT8Y\",\"5\":\"B00C2O7M1M\",\"6\":\"B0037RMS6W\",\"7\":\"B0037RMI0S\",\"8\":\"B0152VYPXY\"},\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1557308184, "post_id": 56037484, "comment_id": 98717689, "body": "Is there a particular reason why you don&#39;t want to find+replace <code>.</code> with <code>&#47;</code> in the columns where your dates are?"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1557310995, "post_id": 56037484, "comment_id": 98719247, "body": "<i>&quot;The cell format of each of these is General.&quot;</i> This is your actual problem. Store your dates as dates, and then format them using the cell format options."}], "answers": [{"comments": [{"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1557310373, "post_id": 56037932, "comment_id": 98718884, "body": "If I do this, the format becomes mm/dd/yyyy. 01/02/2019 becomes 02/01/2019 for example."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1557310781, "post_id": 56037932, "comment_id": 98719128, "body": "Well that has to do with the regional settings. Select column <code>J</code> press <code>CTRL+1</code>, in the <code>Number</code> tab, under <code>Category</code> choose <code>Date</code> and set it to European format. Do you need this to be done via code?"}, {"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1557311569, "post_id": 56037932, "comment_id": 98719571, "body": "What do you mean by European format? I can&#39;t see that as an option. I tried United Kingdom, and have the same issue. Same issue with using the VBA version too."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1557312646, "post_id": 56037932, "comment_id": 98720209, "body": "So after you&#39;ve run the code if you select one cell and hit Ctrl+1 what number format (Category, Type, Location) does the cell have?"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1557312251, "last_edit_date": 1557312251, "creation_date": 1557309110, "answer_id": 56037932, "question_id": 56037484, "link": "https://stackoverflow.com/questions/56037484/converting-larges-number-of-values-to-uk-date-format-in-excel-vba/56037932#56037932", "title": "Converting larges number of values to UK date format in Excel VBA", "body": "<p>If i understand correctly and I am not missing something, you don't need VBA to do that.\nJust select column J and find and replace <code>.</code> with <code>/</code>.</p>\n\n<p>If you want to do it using VBA anyway, you can do this:</p>\n\n<pre><code>Sub test()\nDim sht As Worksheet\nDim rng As Range\nSet sht = ThisWorkbook.Worksheets(\"Report\")\nSet rng = sht.Columns(\"J\")\nrng.Replace what:=\".\", replacement:=\"/\"\nEnd Sub\n</code></pre>\n\n<p>It takes less than a second to execute for around 10k dates.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>When it's done the values will be recognized by excel as dates.\nThe format of these dates can be set to the European one. Select column <code>J</code> press <code>CTRL+1</code>, in the <code>Number</code> tab, under <code>Category</code> choose <code>Date</code> and set it to European format.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DFJT1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DFJT1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or simply add this line to he code above:</p>\n\n<pre><code>rng.NumberFormat = \"dd/mm/yyyy\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "is_accepted": true, "score": 0, "last_activity_date": 1557312761, "creation_date": 1557312761, "answer_id": 56039059, "question_id": 56037484, "link": "https://stackoverflow.com/questions/56037484/converting-larges-number-of-values-to-uk-date-format-in-excel-vba/56039059#56039059", "title": "Converting larges number of values to UK date format in Excel VBA", "body": "<p>I was able to resolve this using the answer supplied here :-</p>\n\n<p><a href=\"https://stackoverflow.com/a/30609676/1936588\">https://stackoverflow.com/a/30609676/1936588</a></p>\n\n<p>Changing</p>\n\n<pre><code>.TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, FieldInfo:=Array(0, xlYMDFormat)\n</code></pre>\n\n<p>To</p>\n\n<pre><code>.TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, FieldInfo:=Array(0, xlDMYFormat)\n</code></pre>\n"}], "owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56039059, "answer_count": 2, "score": 0, "last_activity_date": 1557312761, "creation_date": 1557307538, "question_id": 56037484, "link": "https://stackoverflow.com/questions/56037484/converting-larges-number-of-values-to-uk-date-format-in-excel-vba", "title": "Converting larges number of values to UK date format in Excel VBA", "body": "<p>I have a sheet with tens of thousands of dates in the following format :-</p>\n\n<p><code>31.01.2018</code> (so, dd.mm.yyyy)</p>\n\n<p>The cell format of each of these is General. I need to convert each of these to UK date format. \nTo do so, I am using :-</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Report\")\n    For i = 2 To Lastrow\n        DateString = .Range(\"J\" &amp; i).Value\n        Year = Right(DateString , 4)\n        Month = Mid(DateString , 4, 2)\n        Day = Left(DateString , 2)\n\n        With .Range(\"J\" &amp; i)\n            .Value = CDate(Day &amp; \"/\" &amp; Month &amp; \"/\" &amp; Year)\n            .NumberFormat = \"dd/mm/yyyy\"\n        End With\n    Next i\nEnd With\n</code></pre>\n\n<p>This takes quite a while, and I wanted to know if there was a more effective way of converting the dates?</p>\n"}, {"tags": ["excel", "vba", "rows"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557313323, "post_id": 56038296, "comment_id": 98720618, "body": "Hi @Skin, unfortunately it doesn&#39;t. It doesn&#39;t copy the formatting or formula at all from the row above."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557313684, "post_id": 56038296, "comment_id": 98720862, "body": "@Mr_Col, what about now?  Hopefully I&#39;ve interpreted it correctly."}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557314373, "post_id": 56038296, "comment_id": 98721204, "body": "Hi @Skin, thanks for the update, however it still doesn&#39;t quite perform what I need. Perhaps my explanation is not clear enough. If I double click on a cell/row it inserts a row underneath but copies the formatting and formulas of that row that was initially double clicked i.e the row above the newly inserted one. My code at the moment copies the entire row above, I just want it to copy column A:K - hope that is clearer?"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557314652, "post_id": 56038296, "comment_id": 98721364, "body": "@Mr_Col, yep, I think that&#39;s clearer.  I went a row above the double click row.  Answer updated, 3rd time lucky?!?  Actually, next question, do cells A to K have a mix of formulas and values?  If so, I&#39;ll need to make another update."}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557315051, "post_id": 56038296, "comment_id": 98721589, "body": "That&#39;s the Badger!! Thank you so much for your help!"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557315088, "post_id": 56038296, "comment_id": 98721612, "body": "@Mr_Col answer updated with a comment, take it or leave but looks like you got your answer.  Glad I could help and sorry for the iterations.  :-)"}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 0, "last_activity_date": 1557315172, "last_edit_date": 1557315172, "creation_date": 1557310274, "answer_id": 56038296, "question_id": 56036884, "link": "https://stackoverflow.com/questions/56036884/insert-a-row-and-copy-the-formatting-but-only-for-certain-columns/56038296#56038296", "title": "Insert a row and copy the formatting but only for certain columns", "body": "<p>Does this do what you want?</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If Target.Row = 1 Then Exit Sub\n\n    Cancel = True\n\n    Application.ScreenUpdating = False\n\n    With Target.Worksheet\n        .Rows(Target.Row + 1).Insert (xlDown)\n\n        .Rows(Target.Row + 1).Clear\n        .Range(\"A\" &amp; Target.Row &amp; \":K\" &amp; Target.Row).Copy\n\n        With .Range(\"A\" &amp; Target.Row + 1 &amp; \":K\" &amp; Target.Row + 1)\n            .PasteSpecial xlPasteFormats\n            .PasteSpecial xlPasteFormulas\n\n            ' Remove this code here if you DON'T want to clear the cells\n            ' that do not have formulas.\n            On Error Resume Next\n            .SpecialCells(xlCellTypeConstants).ClearContents\n            On Error GoTo 0\n        End With\n    End With\n\n    Application.CutCopyMode = False\n    Target.Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>... if so, add error checking and any additional requirements and hopefully it's good to go.</p>\n"}], "owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 56038296, "answer_count": 1, "score": 0, "last_activity_date": 1557315172, "creation_date": 1557305340, "question_id": 56036884, "link": "https://stackoverflow.com/questions/56036884/insert-a-row-and-copy-the-formatting-but-only-for-certain-columns", "title": "Insert a row and copy the formatting but only for certain columns", "body": "<p>I am using the following code to insert a row under the cell, when double clicked, and to copy the formatting and formula from above. However, I would like it to only copy the formulas and formatting from columns A:K. </p>\n\n<p>I've tried a couple of different things but keep getting errors thrown up. I'm sure this would be an easy fix for someone out there, I'm just going round and round, how should I adjust my code? - please help</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = True\n    Target.Offset(1).EntireRow.Insert\n    Target.EntireRow.Copy Target.Offset(1).EntireRow\n    On Error Resume Next\n    Target.Offset(1).EntireRow.SpecialCells(xlConstants).ClearContents\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11468943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b548c48f33cd4314389b43b4e13bc9?s=128&d=identicon&r=PG&f=1", "display_name": "ish06", "link": "https://stackoverflow.com/users/11468943/ish06"}, "edited": false, "score": 0, "creation_date": 1557387728, "post_id": 56038646, "comment_id": 98749682, "body": "I attempted to use this and I think trim is only to remove spaces unless I wasn&#39;t using it correctly."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "reply_to_user": {"reputation": 1, "user_id": 11468943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b548c48f33cd4314389b43b4e13bc9?s=128&d=identicon&r=PG&f=1", "display_name": "ish06", "link": "https://stackoverflow.com/users/11468943/ish06"}, "edited": false, "score": 0, "creation_date": 1557406865, "post_id": 56038646, "comment_id": 98760410, "body": "I&#39;ve added the <code>TRIM()</code> in order also to remove spaces (which look blank but aren&#39;t). But if you regard a space as a non-blank and you want rows with spaces not to become invisible, then don&#39;t use the &#180;TRIM()&#180; function."}, {"owner": {"reputation": 1, "user_id": 11468943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b548c48f33cd4314389b43b4e13bc9?s=128&d=identicon&r=PG&f=1", "display_name": "ish06", "link": "https://stackoverflow.com/users/11468943/ish06"}, "edited": false, "score": 0, "creation_date": 1557459634, "post_id": 56038646, "comment_id": 98779845, "body": "each cell in my worksheet has a formula in it to pull the data in from another sheet that looks similar. I tired to us this code in a vba button and it wouldn&#39;t work. I cant put this into a cell because it wouldn&#39;t allow the cell to auto populate from the other workbook."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1557311356, "creation_date": 1557311356, "answer_id": 56038646, "question_id": 56036753, "link": "https://stackoverflow.com/questions/56036753/how-to-hide-rows-that-dont-have-data-in-the-row/56038646#56038646", "title": "how to hide rows that dont have data in the row", "body": "<p>This formula checks if there is anything in row 2, simply by concatenating the whole row, trimming the result, and check if it is nothing but an empty string:</p>\n\n<pre><code>=TRIM(TEXTJOIN(\"\";FALSE;2:2))=\"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11468943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b548c48f33cd4314389b43b4e13bc9?s=128&d=identicon&r=PG&f=1", "display_name": "ish06", "link": "https://stackoverflow.com/users/11468943/ish06"}, "is_accepted": true, "score": 0, "last_activity_date": 1557719653, "creation_date": 1557719653, "answer_id": 56105551, "question_id": 56036753, "link": "https://stackoverflow.com/questions/56036753/how-to-hide-rows-that-dont-have-data-in-the-row/56105551#56105551", "title": "how to hide rows that dont have data in the row", "body": "<pre><code>Sub HideRows()\n If Range(\"d2\").Value = \"\" Then\n    If Range(\"r2\").Value = \"\" Then\n        If Range(\"af2\").Value = \"\" Then\n</code></pre>\n\n<p>Rows(\"2:2\").EntireRow.Hidden = True\n    End If\n    End If\n    End If</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 11468943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b548c48f33cd4314389b43b4e13bc9?s=128&d=identicon&r=PG&f=1", "display_name": "ish06", "link": "https://stackoverflow.com/users/11468943/ish06"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56105551, "answer_count": 2, "score": -3, "last_activity_date": 1557719653, "creation_date": 1557304886, "last_edit_date": 1557388047, "question_id": 56036753, "link": "https://stackoverflow.com/questions/56036753/how-to-hide-rows-that-dont-have-data-in-the-row", "title": "how to hide rows that dont have data in the row", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Public Sub caInvCompressRows(p_strInv As String)\r\n\r\nDim intRow As Integer\r\nDim intRowMch As Integer\r\nDim intCol As Integer\r\nDim bUsed As Boolean\r\nDim strTemp As String\r\nDim strSheet As String\r\nDim intSaveRow As Integer\r\nstrSheet = \"cordINV-\" &amp; p_strInv\r\nCall utlUnProtectSheet(strSheet, \"alcatraz\")\r\nSheets(strSheet).Select\r\nCells.Select\r\nRows.EntireRow.Hidden = False\r\nRange(\"A1\").Select\r\nintRowMch = caINV_ROW_FIRST\r\nWhile Cells(intRowMch, 1).Value &lt;&gt; \"\" Or Cells(intRowMch, 11).Value &lt;&gt; \"\"\r\n    For intRow = intRowMch + 1 To intRowMch + 6\r\n        If Cells(intRow, 1).Value = \"\" Then\r\n            If Cells(intRow, 11).Value = \"\" Then\r\n                Rows(intRow).EntireRow.Hidden = True\r\n            End If\r\n        End If\r\n    Next intRow\r\n    intRowMch = intRowMch + 9\r\nWend\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><a href=\"https://i.stack.imgur.com/em1To.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/em1To.jpg\" alt=\"excel sheet example\"></a></p>\n\n<p>I want to hide rows that don't have data in them with the use of a button. each row contains three different groups of data that change which rows would need to be hidden. all data is pulled into columns C, O and AC and the rest is populated from that.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "is_accepted": true, "score": 0, "last_activity_date": 1557306366, "last_edit_date": 1557306366, "creation_date": 1557304515, "answer_id": 56036653, "question_id": 56036539, "link": "https://stackoverflow.com/questions/56036539/how-can-i-delete-multiple-blank-csv-files/56036653#56036653", "title": "How can I delete multiple blank .csv files?", "body": "<p>You can use the DIR command to search through all files in a folder then kill any with a file size of 0.\nThe code below searches through a specified folder and lists the *.xls filenames in a sheet called Main.\nIt should be easy to adapt this and combine with your own Kill command.</p>\n\n<pre><code>Sub Directory()\n    Dim strPath As String\n    Dim strFolderPath As String\n    Dim strFileName As String\n    Dim intRow As Integer\n    Dim intColumn As Integer\n    Dim intNumber As Integer\n\n    intRow = 1\n    intColumn = 1\n    intNumber = 0\n\n    strFolderPath = \"h:\\excel\\*.xls\" 'search through H drive excel folder\n    strFileName = Dir(strFolderPath) 'Get name of first file\n    Do\n        Sheets(\"Main\").Cells(intRow, intColumn) = strFileName 'write filename\n        strFileName = Dir  'get next filename\n        intRow = intRow + 1\n    Loop Until strFileName = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1557307087, "creation_date": 1557307087, "answer_id": 56037365, "question_id": 56036539, "link": "https://stackoverflow.com/questions/56036539/how-can-i-delete-multiple-blank-csv-files/56037365#56037365", "title": "How can I delete multiple blank .csv files?", "body": "<p>You can use the <code>FileSystemObject</code> to check files in a folder, and delete them if they are of the correct type and size = 0.</p>\n\n<p>Be very careful running this as the deletions will be permanent (not recoverable).</p>\n\n<pre><code>Option Explicit\n'Set reference to Microsoft Scripting Runtime\nSub terfuge()\n    Dim FSO As FileSystemObject, FI As File, FIs As Files, FO As Folder\n    Const strBasePath As String = \"full_path_of_folder_to_search\"\n    Dim bMsg As Integer\n\nSet FSO = New FileSystemObject\nSet FO = FSO.GetFolder(strBasePath)\nSet FIs = FO.Files\n\nFor Each FI In FIs\n    If FI.Name Like \"*.csv\" Then\n        If FI.Size = 0 Then\n            bMsg = MsgBox(Prompt:=\"Are you sure you want to delete \" &amp; FI.Name &amp; \"?\", Buttons:=vbYesNoCancel)\n            Select Case bMsg\n                Case vbYes\n                    FI.Delete\n                Case vbCancel\n                    Exit Sub\n            End Select\n        End If\n    End If\nNext FI\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11468816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854b28e67753f341d94e21dd2556cbdd?s=128&d=identicon&r=PG&f=1", "display_name": "DonH", "link": "https://stackoverflow.com/users/11468816/donh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557325700, "creation_date": 1557325700, "answer_id": 56043074, "question_id": 56036539, "link": "https://stackoverflow.com/questions/56036539/how-can-i-delete-multiple-blank-csv-files/56043074#56043074", "title": "How can I delete multiple blank .csv files?", "body": "<p>Thanks both for your speedy responses, I managed to eventually get my loop going jiggling Andy's sample.\nI'd already started dabbling with his idea before Ron responded so continued with it. \nI do however like the idea of the user being asked first whether or not they would like to delete the file, so I think I'll have a stab at Ron's suggestion too and maybe learn something along the way.\nThanks again.</p>\n"}], "owner": {"reputation": 3, "user_id": 11468816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854b28e67753f341d94e21dd2556cbdd?s=128&d=identicon&r=PG&f=1", "display_name": "DonH", "link": "https://stackoverflow.com/users/11468816/donh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 56036653, "answer_count": 3, "score": 0, "last_activity_date": 1557325700, "creation_date": 1557304090, "last_edit_date": 1557308809, "question_id": 56036539, "link": "https://stackoverflow.com/questions/56036539/how-can-i-delete-multiple-blank-csv-files", "title": "How can I delete multiple blank .csv files?", "body": "<p>I have some VBA code in excel 2010 that imports multiple .csv files in to one excel workbook however, sometimes there is a rogue file that contains nothing and has a file size of zero that throws up an error, I then have to manually go to the folder and delete this and run my macro again.\nTherefore I'm after some help that will allow me to check the file size's of all .csv file contained in a folder and delete any that are zero before I import them. Is there a way I can do this? Or possibly another suggested method that would help?\nI'm very new to VBA so please be patient if I don't fully understand straight away.</p>\n\n<p>I have looked into FileLen(C:\\Test\\test.csv) = 0 Then Kill said file.\nBut this only deletes specifically the file mentioned. I would rather check all file sizes and if any are zero, kill them.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "edited": false, "score": 0, "creation_date": 1557317786, "post_id": 56037010, "comment_id": 98723061, "body": "Thanks! That idea is great and works much better. But how can I make my variable &quot;dynamic&quot;? Here is issue I&#39;m dealing with right now - my old formula was: <code>eval(SUBSTITUTE(FORMULATEXT(INDEX(MATERIALS!$A$2:$I$30,MATCH&zwnj;&#8203;($F$8,MATERIALS!$A$2&zwnj;&#8203;:$A$30,0),5)),&quot;*N4&quot;,&zwnj;&#8203;&quot;*&quot;&amp;CELL(&quot;address&quot;,S&zwnj;&#8203;48))))</code> Basically I want to look for a specific string and match it with lookup region for specific formula. The question is what should be my name range it such case?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "edited": false, "score": 0, "creation_date": 1557317806, "post_id": 56037010, "comment_id": 98723071, "body": "@Kris The <i>simplest</i> option is to have a Working column to calculate your Formula, and let your Named Range look at that (e.g. select cell B1, and create <code>=EVALUATE(A1)</code> so that it takes the text from the cell on the left and evaluates that) - see how the code inside <code>=EVALUATE(..)</code> is mostly the code that you wrote in <code>eval</code>?  Just remember to include Sheet Names (<code>Sheet2!$C3</code>) - since relative references move with the cell, fill-down is fairly simple"}, {"owner": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "edited": false, "score": 0, "creation_date": 1557318145, "post_id": 56037010, "comment_id": 98723274, "body": "sorry maybe I was not clear when explaining my issue for the first time. I edited my previous comment to be more precise to show my real issue I&#39;m dealing with. Thank you and sorry for not being enough clear"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "edited": false, "score": 0, "creation_date": 1557318397, "post_id": 56037010, "comment_id": 98723417, "body": "@Kris Select one of your cells that has an <code>=eval()</code> formula in, copy that formula and - with the cell <b>still selected</b>, create your named range with that formula (but change <code>eval(</code> to <code>EVALUATE(</code>) - it <i>should</i> work absolutely fine."}, {"owner": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "edited": false, "score": 0, "creation_date": 1557319266, "post_id": 56037010, "comment_id": 98723946, "body": "It works until I don&#39;t change reference string in cell F8 which then should be found in lookup table. Hard to explain with words, can I somehow upload worksheet with example?"}, {"owner": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "edited": false, "score": 0, "creation_date": 1557319718, "post_id": 56037010, "comment_id": 98724234, "body": "Actually it works until no other formula is used before <code>EVALUATE()</code> i.e. if not used inside IF() formula Anyway it&#39;s a huge improvement. Many thanks, that saves me a lot of headache!"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 2, "last_activity_date": 1557305803, "creation_date": 1557305803, "answer_id": 56037010, "question_id": 56036411, "link": "https://stackoverflow.com/questions/56036411/non-volatile-evaluate/56037010#56037010", "title": "Non-volatile Evaluate", "body": "<p>Instead of creating a custom <code>Eval</code> function, use the <a href=\"https://www.myonlinetraininghub.com/excel-factor-12-secret-evaluate-function\" rel=\"nofollow noreferrer\">secret, built in <code>EVALUATE</code> function</a> left over from Excel 4.0</p>\n\n<p>Create named range, called something like \"EvaluatedFormula\", and set the \"Refers to:\" to <code>=EVALUATE(SUBSTITUTE(FORMULATEXT(Sheet2!$A$1),\"B1\",\"C\" &amp; ROW()))</code></p>\n\n<p>Then, in cell A10, you just type <code>=EvaluatedFormula</code>, and BOOM! It's done.  This can calculate over 9,000 rows in a fraction of a second - <em>much</em> faster than your <code>Eval</code> UDF</p>\n"}], "owner": {"reputation": 25, "user_id": 11465494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbeb78966fdf3693ee302e0c547ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/11465494/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 2, "accepted_answer_id": 56037010, "answer_count": 1, "score": 1, "last_activity_date": 1557305803, "creation_date": 1557303679, "question_id": 56036411, "link": "https://stackoverflow.com/questions/56036411/non-volatile-evaluate", "title": "Non-volatile Evaluate", "body": "<p>I have a worksheet where all equations are. In other sheet I would like to calculate function value for different variables. Let's say in Sheet2 I have in A1 formula =125*B1^2+20*B1+222. In Sheet1 in cell A10 I have =eval(SUBSTITUTE(FORMULATEXT(Sheet2!A1),\"<em>B1\",\"</em>\"&amp;CELL(\"address\",C10))), so basically I change value of variable with different in cell C10. </p>\n\n<p>My eval function is:</p>\n\n<pre><code>Function Eval(Ref As String)\n    Application.Volatile\n    Eval = Application.ThisCell.Parent.Evaluate(Ref)\nEnd Function\n</code></pre>\n\n<p>Problem is it takes forever to calculate and I would like to achieve same results without Volatile option, but have no idea how.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 689, "user_id": 7523634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5n0G.jpg?s=128&g=1", "display_name": "Wolfgang Jacques", "link": "https://stackoverflow.com/users/7523634/wolfgang-jacques"}, "edited": false, "score": 0, "creation_date": 1557310853, "post_id": 56036342, "comment_id": 98719172, "body": "Your variable names are a bit confusing, because you name a worksheet <code>wB1</code>. And please state line and error message."}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "reply_to_user": {"reputation": 689, "user_id": 7523634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5n0G.jpg?s=128&g=1", "display_name": "Wolfgang Jacques", "link": "https://stackoverflow.com/users/7523634/wolfgang-jacques"}, "edited": false, "score": 0, "creation_date": 1557312629, "post_id": 56036342, "comment_id": 98720196, "body": "OK look wB1 is workbook Master.xlsx with sheet Data and wB2 is another workbook Report.xlsx with sheet Orders, I don\u2019t have error if I use wB1.Activate the code run successfully, the problem is I don\u2019t want to use activate and I thing I must fully qualify the code, the problem arise when I have click in another sheet of the workbook Master and then a blank range copied to workbook Report. How can I fix this to avoid activate the sheets between workbooks to copy ranges"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1557323596, "post_id": 56042114, "comment_id": 98726761, "body": "Yes!!!! That\u2019s do the trick, it work fine now I knew that I have to fully clarify the code but I miss this. It is better to declare the workbooks and the worksheets separate?"}, {"owner": {"reputation": 689, "user_id": 7523634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5n0G.jpg?s=128&g=1", "display_name": "Wolfgang Jacques", "link": "https://stackoverflow.com/users/7523634/wolfgang-jacques"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1557326523, "post_id": 56042114, "comment_id": 98728673, "body": "Well, it&#39;s a matter of taste. I would say it is not necessary but personally I would do it in this case. Please don&#39;t forget to accept my answer if it OK for you!"}], "tags": [], "owner": {"reputation": 689, "user_id": 7523634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5n0G.jpg?s=128&g=1", "display_name": "Wolfgang Jacques", "link": "https://stackoverflow.com/users/7523634/wolfgang-jacques"}, "is_accepted": true, "score": 0, "last_activity_date": 1557322603, "creation_date": 1557322603, "answer_id": 56042114, "question_id": 56036342, "link": "https://stackoverflow.com/questions/56036342/copy-between-workbooks-and-worksheets/56042114#56042114", "title": "Copy Between Workbooks and Worksheets", "body": "<p>The problem lies here:</p>\n\n<pre><code>Set DesRng = wB2.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).Resize(, 12)\n</code></pre>\n\n<p>Instead of <code>Rows.Count</code> you need to specify the worksheet here, otherwise the active worksheet is being used. So <code>wB2.Rows.Count</code> will do the trick.</p>\n\n<p>And still: you are defining work<strong>sheet</strong> variables and call them w<strong>B</strong>2. Consider renaming them to w<strong>S</strong>2 for clarity.</p>\n"}], "owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56042114, "answer_count": 1, "score": 0, "last_activity_date": 1557323911, "creation_date": 1557303386, "last_edit_date": 1557323911, "question_id": 56036342, "link": "https://stackoverflow.com/questions/56036342/copy-between-workbooks-and-worksheets", "title": "Copy Between Workbooks and Worksheets", "body": "<p>I am trying to copy a dynamic range from one workbook1 sheet1 to workbook2 sheet2. The code works but only when I have workbook1 sheet1 active, if I have workbook1 sheet2 active the code fail.</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub CopyOrders()\n\n\n    Dim wB1 As Worksheet\n    Set wB1 = Workbooks(\"Master.xlsx\").Worksheets(\"Data\")\n\n    Dim RngCe1 As Range\n    Set RngCe1 = wB1.Cells(Rows.Count, \"B\").End(xlUp).Offset(0, 11)\n\n    Dim RngCe2 As Range\n    Set RngCe2 = wB1.Range(\"A1:A7000\").FIND(\"Grand Total\", LookAt:=xlPart).Offset(-1, 23)\n\n    Dim NewRng As Range\n    Set NewRng = Range(RngCe1.Address &amp; \":\" &amp; RngCe2.Address)\n\n    Dim wB2 As Worksheet\n    Set wB2 = Workbooks(\"Report.xlsx\").Worksheets(\"Orders\")\n\n    Dim DesRng As Range\n    Set DesRng = wB2.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).Resize(, 12)\n\n    NewRng.Copy\n    DesRng.PasteSpecial xlPasteValues\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 11446735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFBGq.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/11446735/roland"}, "is_accepted": true, "score": 2, "last_activity_date": 1557309094, "creation_date": 1557309094, "answer_id": 56037924, "question_id": 56036306, "link": "https://stackoverflow.com/questions/56036306/send-automatic-email-once-only-from-shared-workbook/56037924#56037924", "title": "Send Automatic Email once only from Shared Workbook", "body": "<p>If you can select one user, from where the macro should be executed, before calling the procedure you could have a check on the user, based on the following below:</p>\n\n<pre><code>If Application.UserName = \"username\" Then\n</code></pre>\n\n<p>Hope it might be useful.</p>\n"}], "owner": {"reputation": 28, "user_id": 11425956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc525bc74909ff5495ce7527b5a3804?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/11425956/sergiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56037924, "answer_count": 1, "score": 0, "last_activity_date": 1606245842, "creation_date": 1557303265, "last_edit_date": 1606245842, "question_id": 56036306, "link": "https://stackoverflow.com/questions/56036306/send-automatic-email-once-only-from-shared-workbook", "title": "Send Automatic Email once only from Shared Workbook", "body": "<p>I have code that sends the contents of Sheet1 via email to a distribution list at a specific time in the day.<br />\nThis is a shared Workbook, so multiple users have it open at the same time.</p>\n<p>The code sends the email several times, either from the same user or from multiple users as &quot;Sender&quot; in the email. I assume because multiple users have the file open.</p>\n<p>How can I send the email only once?</p>\n<p>Sheet1 being sent in the email body:</p>\n<pre><code>Sub Email()\n\n    'Worksheets(&quot;Sheet1&quot;).Unprotect Password:=&quot;1&quot;\n\n    Dim ChartName1 As String\n    Dim dataTable As String\n    Dim rng As Range\n\n    Set appOutlook = CreateObject(&quot;outlook.application&quot;)\n    'create a new message\n    Set Message = appOutlook.CreateItem(olMailItem)\n\n    Set rng = Nothing\n    On Error Resume Next\n    'Only the visible cells in the selection\n    'Set rng = Selection.SpecialCells(xlCellTypeVisible)\n    'You can also use a fixed range if you want\n    Set rng = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:E11&quot;).SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n  \n    ChartName1 = Environ$(&quot;temp&quot;) &amp; &quot;\\Chart1.gif&quot;\n    ActiveWorkbook.Worksheets(&quot;Sheet1&quot;).ChartObjects(&quot;Chart 1&quot;).Chart.Export _\n    Filename:=ChartName1, FilterName:=&quot;GIF&quot;\n         \n    With Message\n        .Subject = &quot; Files status &quot; &amp; Format(Date, &quot;dd/mm/yyyy&quot;)\n     \n        .HTMLBody = &quot;&lt;span LANG=EN&gt;&quot; _\n          &amp; &quot;&lt;p class=style2&gt;&lt;span LANG=EN&gt;&lt;font FACE=Calibri SIZE=2&gt;&quot; _\n          &amp; &quot;Dear all,&lt;br &gt;&lt;br &gt;Please see below the Open Files status for today : &quot; _\n          &amp; &quot;&lt;br&gt;&lt;BR&gt;&quot;\n                \n        .HTMLBody = .HTMLBody &amp; rangetoHTML(rng) &amp; &quot;&lt;br&gt;&quot;\n          \n        .HTMLBody = .HTMLBody &amp; &quot;&lt;html&gt;&lt;body&gt;&lt;img src=&quot; &amp; &quot;'&quot; &amp; ChartName1 &amp; &quot;'&gt;&lt;Br&gt;&lt;Br&gt;&lt;Br/&gt;&lt;/body&gt;&lt;/html&gt;&quot;\n             \n        '  .HTMLBody = .HTMLBody &amp; &quot;&lt;br&gt;&lt;B&gt;WEEKLY REPPORT:&lt;/B&gt;&lt;br&gt;&quot; _\n        '  &amp; &quot;&lt;br&gt;Best Regards,&lt;br&gt;Ed&lt;/font&gt;&lt;/span&gt;&quot;\n            \n        .To = &quot;recipients here &quot;\n        .Cc = &quot;&quot;\n                 \n        .Display\n        .Send\n    End With\n        \n    Kill ChartName1\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    'Worksheets(&quot;Sheet1&quot;).Protect Password:=&quot;1&quot;\nEnd Sub\n</code></pre>\n<p>Function to send the Graph as picture:</p>\n<pre><code>Function rangetoHTML(rng As Range)\n    ' Changed by Ron de Bruin 28-Oct-2006\n    ' Working in Office 2000-2013\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(&quot;temp&quot;) &amp; &quot;\\&quot; &amp; Format(Now, &quot;dd-mm-yy h-mm-ss&quot;) &amp; &quot;.htm&quot;\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    rangetoHTML = ts.readall\n    ts.Close\n    rangetoHTML = Replace(rangetoHTML, &quot;align=center x:publishsource=&quot;, _\n                          &quot;align=left x:publishsource=&quot;)\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\n\nEnd Function\n</code></pre>\n<p>Code to send the file every day at 09:05 AM, included in ThisWorkbook</p>\n<pre><code>Private Sub Workbook_Open()\n    Application.OnTime TimeValue(&quot;09:05:00&quot;), &quot;Email&quot;\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "debugging", "ms-word"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557303618, "post_id": 56036286, "comment_id": 98715183, "body": "hi. why do you have Selection.Find.Execute and next  loopvar = Selection.Find.Execute. u are doing the find two times..."}, {"owner": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557303932, "post_id": 56036286, "comment_id": 98715333, "body": "Good question, I had to add loopvar because the value of <code>Selection.Find.Execute</code> was not being kept by the time I needed it. In other words, without that the macro would not go through the loop. Why does that repeat the search though, if loopvar is Boolean?"}, {"owner": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557306873, "post_id": 56036286, "comment_id": 98716954, "body": "@Luis Curado Actually that did solve the problem, I only kept <code>loopvar = Selection.Find.Execute</code> and added a direction in <code>Selection.Collapse wdEnd</code>. Thanks so much! I thought the previous would only assign a value to a variable, not treat it as another instruction to run. Oh well, TIL."}, {"owner": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557306929, "post_id": 56036286, "comment_id": 98716980, "body": "The bizarre behaviour remains unexplained though, but I guess my main problem can be considered solved..."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557315390, "post_id": 56036286, "comment_id": 98721777, "body": "glad to help you"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "edited": false, "score": 0, "creation_date": 1557323234, "post_id": 56039912, "comment_id": 98726527, "body": "Thank you for the suggestion! Did you test that though? It&#39;s not doing anything for me. I wouldn&#39;t know how to tweek the statements you&#39;re using, although I&#39;m sure they&#39;d be more efficient than mine. The ChrW was chosen by the macro recorder itself. I resorted to that because I couldn&#39;t make the other alternatives work(including with Chr(147)). Couldn&#39;t even put a bloody curly quotation mark in my VBA editor, if you believe it."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "edited": false, "score": 0, "creation_date": 1557354529, "post_id": 56039912, "comment_id": 98741025, "body": "Well, since I don&#39;t know what you&#39;re wanting to do with the found string, I can hardly be held responsible for &quot;<i>It&#39;s not doing anything for me</i>&quot; if you didn&#39;t insert the relevant code where indicated. After all, your own post and code says nothing about what reformatting is supposed to take place. And, yes, I did test it."}, {"owner": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "edited": false, "score": 0, "creation_date": 1557394227, "post_id": 56039912, "comment_id": 98753341, "body": "Like I said, I&#39;m grateful for your suggestion, and you&#39;re certainly not responsible for anything. :) But that sub isn&#39;t doing <i>anything</i> (as in, it does not even find the string, a necessary first step). So I would need first to get it to work for me, which would require me playing around with it, and as I said I wouldn&#39;t know how. I cannot add the formatting code in there because I want to process the string in a different sub, as I explained in the question. I&#39;m glad to say that with the correction from @Luis Curado the whole package is working as intended now."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "edited": false, "score": 0, "creation_date": 1557404097, "post_id": 56039912, "comment_id": 98758799, "body": "How do you know it&#39;s not doing <i>anything</i>? There&#39;s nothing in the code that would provide any form of feedback. Try inserting MsgBox .Text immediately after &#39;Do While .Find.Found&#39;. Make sure, too, that you haven&#39;t messed up the smart quotes."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1557315423, "creation_date": 1557315423, "answer_id": 56039912, "question_id": 56036286, "link": "https://stackoverflow.com/questions/56036286/why-is-vba-running-my-code-lines-out-of-order/56039912#56039912", "title": "Why is VBA running my code lines out of order?", "body": "<p>Try something along the lines of:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\u201c*\u201d\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    If .End - .Start &gt; 159 Then\n      With .Duplicate\n        .Start = .Start + 1\n        .End = .End - 1\n        'Process string here\n      End With\n    End If\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>You'll find such code far faster than your own. FWIW, the opening &amp; closing quotes in \u201c*\u201d are ASCII 147 &amp; 148, respectively - there's no need for the ChrW equivalents.</p>\n"}], "owner": {"reputation": 1, "user_id": 11468619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jFyySf7VEuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgDsaDZ5NlnYpG7a4LwfV69iYZwg/mo/photo.jpg?sz=128", "display_name": "Caio WA", "link": "https://stackoverflow.com/users/11468619/caio-wa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557315423, "creation_date": 1557303186, "question_id": 56036286, "link": "https://stackoverflow.com/questions/56036286/why-is-vba-running-my-code-lines-out-of-order", "title": "Why is VBA running my code lines out of order?", "body": "<p>I wrote a \"simple\" code to find quotations of a certain length in a Word file (which I ultimately want to format using a different sub). The parts all worked fine individually, but now the search is basically skipping strings it's supposed to find in the text and apparently running lines of code out of order.</p>\n\n<p>I tried break mode and watching the value of <code>Selection</code>, and here's where it gets weird: it keeps finding the next instance of the search parameters (selects in the document and changes the value of <code>Selection</code>) as I run each line of code, including within <code>With Selection.Find</code>, before <code>.Execute</code>!</p>\n\n<pre><code>Sub FindQuotesTest()\n\nDim quotevar As String, loopvar As Boolean\n\nFindquote:\nloopvar = False 'Doesn't seem necessary, added to try debugging\nSelection.Collapse 'Not sure if this is necessary\nSelection.Find.ClearFormatting\nWith Selection.Find\n        .MatchWildcards = True\n        .Text = ChrW(8220) &amp; \"*\" &amp; ChrW(8221) 'Any amount of text between an opening and a closing curly double quotation marks.\n        .Forward = True\n        .Wrap = wdFindStop 'To avoid a crash when reaching the end of the document\n        End With\nSelection.Find.Execute\n\nloopvar = Selection.Find.Execute\n\nWith Selection\n    .MoveStartWhile Cset:=ChrW(8220) 'Removes the opening quotation mark from selection\n    .MoveEndWhile Cset:=ChrW(8221), Count:=wdBackward 'Removes the closing quotation mark from selection\nEnd With 'I need this for the further formatting and to count the text string\n\nquotevar = Selection.Range\n\nIf Len(quotevar) &lt; 157 Then 'Repeats the search if the quote isn't long enough.\nIf loopvar = True Then GoTo Findquote 'Prevents infinite loop when reaching the end of the document by relying on wdFindstop\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>In break mode, this should find one string of text within double quotation marks at a time, and only go to the next when it reaches the <code>GoTo</code> loop, and do that until it reaches one with the designated length (should loop through <code>.Find</code> a few times).\nWhen I run the macro again, it should find the next instance of the long quotation (it seems to be finding every second one instead. In my previous attempts, the macro would only run once and would not find the next instance when run again, which doesn't happen with this code).</p>\n\n<p>The bizarre behaviour of time-travelling break mode put me off here, so I'm at a loss. Any help would be greatly appreciated! Cheers.</p>\n"}, {"tags": ["sql", "excel", "database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1557305470, "post_id": 56036125, "comment_id": 98716158, "body": "Did you try to use <code>adLockOptimistic</code> locking type? And I would select <code>adOpenDynamic</code> recordset type"}, {"owner": {"reputation": 11, "user_id": 11335965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39df72a72968329066f3da6e3791fb17?s=128&d=identicon&r=PG&f=1", "display_name": "Thore Mejlholm", "link": "https://stackoverflow.com/users/11335965/thore-mejlholm"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1560697864, "post_id": 56036125, "comment_id": 99813198, "body": "Sorry for my late response. I&#39;ve tried both of your suggestions, but the problem remains."}], "owner": {"reputation": 11, "user_id": 11335965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39df72a72968329066f3da6e3791fb17?s=128&d=identicon&r=PG&f=1", "display_name": "Thore Mejlholm", "link": "https://stackoverflow.com/users/11335965/thore-mejlholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1559131934, "creation_date": 1557302554, "last_edit_date": 1559131934, "question_id": 56036125, "link": "https://stackoverflow.com/questions/56036125/access-excel-integrationhow-to-avoid-conflicts-between-simultaneous-users", "title": "Access/ Excel integration:How to avoid conflicts between simultaneous users?", "body": "<p>I'm developing an excel tool which connects to an Access database through VBA, and data is transferred between excel and the DB upon user requests. Each user have his own version of the excel workbook, which connects to the central db. In most cases this works fine, but i have discovered some conflicts when two users are trying to connect at the same time, causing one of the users excel/VBA to crash without any VBA errorcode. </p>\n\n<p>I suspect this is caused by the database the connection somehow being interrupted by the second user. </p>\n\n<p>So my question is: \nIs there a way to \"lock\" the connection when the first user has connected and then knowing the db is in use when the second user tries to connect, so his request can be aborted/delayed, without excel crashing? </p>\n\n<p>I have included the code for one of the transactions, which moves data from excel to the database. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub ExportToAccess()\n\n''''Establish connection to DB\nSet cn = New ADODB.Connection\ncn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath &amp; \";Persist Security Info=False;\"\ncn.Open\n\n\nSet rstDbTable = New ADODB.Recordset\n\nWith rstDbTable\n\n    .Open \"AllCapacity\", cn, adOpenKeyset, adLockPessimistic, adCmdTable\n\nEnd With\n\n''''Move data''''\n'one area at the time\n\nFor area = 0 To UBound(cap_areas)\n\n    toDbArray = sh_capacity.Range(cap_areas(area)) 'Save the range in question ot the db array. starts at 1\n\n    'MsgBox (toDbArray(1, 1))\n\n    For i = 1 To UBound(toDbArray, 1) 'for all rows\n\n            rstDbTable.Filter = \"CapArea = '\" &amp; NamesArea(area) &amp; \"'\" _\n            &amp; \" AND Week = '\" &amp; week &amp; \"'\" _\n            &amp; \" AND AreaWeekID = '\" &amp; i &amp; \"'\"\n\n        If rstDbTable.EOF Then 'Check if its empty and then create new records\n            MsgBox (\"Could not find row in DB. Script is ending. CapArea =\" &amp; NamesArea(area) &amp; \". AreaWeekId = \" &amp; i)\n            Stop ' Debugger\n            GoTo EndOfCode\n\n            'rstDbTable.AddNew 'Use if we need to add new row\n\n        Else\n                'rstDbTable(\"AreaWeekID\").Value = toDbArray(i, 27)\n                'rstDbTable(\"Week\").Value = toDbArray(i, 28)\n                'rstDbTable(\"CapArea\").Value = toDbArray(i, 29)\n                'start = Timer\n\n                rstDbTable(\"MO_DA\").Value = toDbArray(i, 2)\n               ' MsgBox (Timer - start)\n\n                rstDbTable(\"MO_EV\").Value = toDbArray(i, 3)\n                rstDbTable(\"MO_NI\").Value = toDbArray(i, 4)\n                rstDbTable(\"TU_DA\").Value = toDbArray(i, 5)\n                rstDbTable(\"TU_EV\").Value = toDbArray(i, 6)\n                rstDbTable(\"TU_NI\").Value = toDbArray(i, 7)\n                rstDbTable(\"WE_DA\").Value = toDbArray(i, 8)\n                rstDbTable(\"WE_EV\").Value = toDbArray(i, 9)\n                rstDbTable(\"WE_NI\").Value = toDbArray(i, 10)\n                rstDbTable(\"TH_DA\").Value = toDbArray(i, 11)\n                rstDbTable(\"TH_EV\").Value = toDbArray(i, 12)\n                rstDbTable(\"TH_NI\").Value = toDbArray(i, 13)\n                rstDbTable(\"FR_DA\").Value = toDbArray(i, 14)\n                rstDbTable(\"FR_EV\").Value = toDbArray(i, 15)\n                rstDbTable(\"FR_NI\").Value = toDbArray(i, 16)\n                rstDbTable(\"SA_DA\").Value = toDbArray(i, 17)\n                rstDbTable(\"SA_EV\").Value = toDbArray(i, 18)\n                rstDbTable(\"SA_NI\").Value = toDbArray(i, 19)\n                rstDbTable(\"SU_DA\").Value = toDbArray(i, 20)\n                rstDbTable(\"SU_EV\").Value = toDbArray(i, 21)\n                rstDbTable(\"SU_NI\").Value = toDbArray(i, 22)\n\n\n\n        End If\n\n        rstDbTable.Update\n\n    Next i\nNext area\n\nEndOfCode:\nrstDbTable.Close\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1557302724, "creation_date": 1557302724, "answer_id": 56036171, "question_id": 56036092, "link": "https://stackoverflow.com/questions/56036092/workbooks-add-fault-1004/56036171#56036171", "title": "Workbooks.add fault 1004", "body": "<p>If you try:</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\n    Dim wk As Workbook\n\n    Set wk = Workbooks.Add\n    wk.SaveAs Filename:=(\"J:\\Planning\\Sjablonen\\Projectsjabloon.xlsm\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": true, "score": 1, "last_activity_date": 1557305750, "creation_date": 1557305750, "answer_id": 56036993, "question_id": 56036092, "link": "https://stackoverflow.com/questions/56036092/workbooks-add-fault-1004/56036993#56036993", "title": "Workbooks.add fault 1004", "body": "<p>The <code>Workbooks.Add</code> method will take an optional Template argument but it has to be XlWBATemplate constant or a file name with path.  The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.add?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm203073)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">Office Dev Centre Workbooks.Add method help</a> explains it in greater detail.  It doesn't explicitly specify the file must be a <code>.xltx</code> or <code>xltm</code> file type, it is implied in </p>\n\n<blockquote>\n  <p>If this argument is a string specifying the name of an existing Microsoft Excel file, the new workbook is created with the specified file as a template.</p>\n</blockquote>\n\n<p>If you want to use <code>Projectsjabloon.xlsm</code> as a template you'll need to save it as a macro-enabled template <code>.xltm</code> file. You can then include it in the optional Template argument:</p>\n\n<pre><code>Set wb = Workbooks.Add(\"J:\\Planning\\Sjablonen\\Projectsjabloon.xltm\")\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 56036993, "answer_count": 2, "score": 0, "last_activity_date": 1557411001, "creation_date": 1557302419, "last_edit_date": 1557323906, "question_id": 56036092, "link": "https://stackoverflow.com/questions/56036092/workbooks-add-fault-1004", "title": "Workbooks.add fault 1004", "body": "<p>I got this code:</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Add(\"J:\\Planning\\Sjablonen\\Projectsjabloon.xlsm\")\n</code></pre>\n\n<p>I run the code with a form control element and get this error:\nError 1004 Method Add of Object Sheets failed</p>\n\n<p>The path I use is on a local server and the file really exists. This was working a week ago.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 3, "last_activity_date": 1557305290, "creation_date": 1557305290, "answer_id": 56036864, "question_id": 56036067, "link": "https://stackoverflow.com/questions/56036067/using-application-onkey-to-disable-ctrl-v/56036864#56036864", "title": "Using Application.OnKey to Disable CTRL-V", "body": "<p>Only thing I can think of would be to perform a check on <code>ActiveWorkbook.Name</code> first:</p>\n\n<pre><code>Sub DisableCtrlPasteCombinations()\n    ' Disable CTRL-V\n    Application.OnKey \"^{v}\", \"PasteController\"\nEnd Sub\n\nSub PasteController()\n    IF ActiveWorkbook.Name &lt;&gt; \"WorkbookName\" THEN\n        Selection.Paste\n    END IF\n    ' Otherwise do nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11426165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b8410388ea66a24c33b78ef2976958?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Kidd", "link": "https://stackoverflow.com/users/11426165/alan-kidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557325450, "creation_date": 1557302329, "last_edit_date": 1557325450, "question_id": 56036067, "link": "https://stackoverflow.com/questions/56036067/using-application-onkey-to-disable-ctrl-v", "title": "Using Application.OnKey to Disable CTRL-V", "body": "<p>I am trying to disable <kbd>CTRL</kbd>+<kbd>V</kbd> in one of the Workbooks that I have open, but it is being disabled in all open workbooks.</p>\n\n<p>Is there a way of doing this, as I have tried using it in both the Sheet that I want to disable <kbd>CTRL</kbd>+<kbd>V</kbd> in and the ThisWorkbook, both with the same result, <kbd>CTRL</kbd>+<kbd>V</kbd> is disabled in all open Workbooks and all Sheets in those Workbooks.</p>\n\n<p>Code I have at the Sheet level:</p>\n\n<pre><code>Sub DisableCtrlPasteCombinations()\n' Disable CTRL-V\nApplication.OnKey \"^{v}\", \"\"\n' Disable CTRL-ALT-V\nApplication.OnKey \"^%{v}\", \"\"\nEnd Sub\n</code></pre>\n\n<p>Code I have tried at ThisWorkbook level:</p>\n\n<pre><code>Private Sub Workbook_Open()\n' Disable CTRL-V\nApplication.OnKey \"^{v}\", \"\"\n' Disable CTRL-ALT-V\nApplication.OnKey \"^%{v}\", \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 7523634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5n0G.jpg?s=128&g=1", "display_name": "Wolfgang Jacques", "link": "https://stackoverflow.com/users/7523634/wolfgang-jacques"}, "is_accepted": true, "score": 1, "last_activity_date": 1557300449, "creation_date": 1557300449, "answer_id": 56035605, "question_id": 56035188, "link": "https://stackoverflow.com/questions/56035188/automatic-page-breaks-while-printing-to-pdf-from-excel/56035605#56035605", "title": "Automatic page breaks while printing to pdf from Excel", "body": "<p>So if there are no pagebreaks you do not need to handle them, right? Check if there are any before going into it:</p>\n\n<pre><code> With PrintVersion.HPageBreaks\n    If .Count &gt; 0 Then\n        pb = 1\n        Do\n            ' check if first column is empty\n            Set r = PrintVersion.Cells(.Item(pb).Location.Row, 1)\n            If r.Value = \"\" Then\n                ' find previous cell in column 1 which is not empty\n                Set fnd = PrintVersion.Columns(1).Find(\"*\", r, , , , xlPrevious)\n                ' set page break 1 row above it\n                Set .Item(pb).Location = fnd.Offset(-1, 0)\n                DoEvents\n\n            End If\n            pb = pb + 1\n            If pb &gt; .Count Then Exit Do\n        Loop\n    End If\nEnd With\n</code></pre>\n\n<p>(not tested)</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 56035605, "answer_count": 1, "score": 0, "last_activity_date": 1557300449, "creation_date": 1557298871, "question_id": 56035188, "link": "https://stackoverflow.com/questions/56035188/automatic-page-breaks-while-printing-to-pdf-from-excel", "title": "Automatic page breaks while printing to pdf from Excel", "body": "<p>Here is VBA I use to automatically insert page breaks while printing to pdf. Code seems to work if there is more than one page. However if there is only page in document debugger gives an error </p>\n\n<blockquote>\n  <p>Run-time error 9: Subscript out of range</p>\n</blockquote>\n\n<p>pointing to <code>Set r = PrintVersion.Cells(.Item(pb).Location.Row, 1)</code>. Any ideas what is the problem and how to repair it?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    Sub Print()\n\n        Dim Cell As Range\n        Dim tempFolderPath As String\n        Dim filePath As String\n        Dim fileTitle As String\n        Dim fnd As Range, r As Range, pb As Variant\n        Dim PrintVersion As Worksheet\n        Dim WData As Worksheet\n        Dim rw As Range, hideRange As Range\n\n        Set PrintVersion = ThisWorkbook.Sheets(\"Print version\")\n        Set WData = ThisWorkbook.Sheets(\"Data\")\n\n        With PrintVersion.Range(\"Print_Area\")\n\n                With .Cells.Rows\n                    .WrapText = True\n                    .VerticalAlignment = xlCenter\n                    .EntireRow.AutoFit\n                End With\n\n' Hide blank rows with formulas giving as a result \"\"\n        For Each rw In .Rows\n            For Each Cell In rw.Cells\n                If Cell.HasFormula Then\n                    If Cell.Value = \"\" Then\n                        If Not rw.Hidden Then\n                            If hideRange Is Nothing Then\n                                Set hideRange = rw\n                            Else\n                                Set hideRange = Union(hideRange, rw)\n                            End If\n                            Exit For    ' no need to process rest of the row\n                       End If\n                    End If\n                End If\n            Next\n        Next\n        If Not hideRange Is Nothing Then hideRange.EntireRow.Hidden = True\n        End With\n\n' Set print area till the last cell\n        PrintVersion.PageSetup.PrintArea = PrintVersion.Range(\"A1:C\" &amp; _\n        PrintVersion.[LOOKUP(2,1/(C1:C250&lt;&gt;\"\"),ROW(C1:C250))]).Address\n\n\n           ' make sure sheet is in page break view\n            PrintVersion.Parent.Windows(1).View = xlPageBreakPreview\n\n        ' first clear any set page breaks\n        PrintVersion.ResetAllPageBreaks\n\n        ' move preposed breaks to top of segement\n        With PrintVersion.HPageBreaks\n\n            pb = 1\n            Do\n                ' check if first column is empty\n                Set r = PrintVersion.Cells(.Item(pb).Location.Row, 1)\n                If r.Value = \"\" Then\n                    ' find previous cell in column 1 which is not empty\n                    Set fnd = PrintVersion.Columns(1).Find(\"*\", r, , , , xlPrevious)\n                    ' set page break 1 row above it\n                    Set .Item(pb).Location = fnd.Offset(-1, 0)\n                    DoEvents\n\n                End If\n                pb = pb + 1\n                If pb &gt; .Count Then Exit Do\n            Loop\n        End With\n\n        ' create a path for a temporary file\n        tempFolderPath = Environ(\"Temp\")\n        fileTitle = \"CV_\" &amp; Sheets(\"Filling form\").Range(\"F7\") &amp; \"_\" &amp; Sheets(\"Filling form\").Range(\"F9\")\n        filePath = tempFolderPath &amp; \"\\\" &amp; fileTitle &amp; \".pdf\"\n\n        PrintVersion.ExportAsFixedFormat xlTypePDF, filePath, xlQualityStandard, True, , , , False\n\n        Set PrintVersion = Nothing\n        Set WData = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557296330, "post_id": 56034557, "comment_id": 98711827, "body": "Error blocks are not &quot;skipped&quot; if the code above triggers no error - execution continues onto the next lines, which is why error handling typically goes at the end of the method (somewhere below <code>Exit Sub</code>), not in the middle.  For tasks like this using a separate function might be easier to manage - eg <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists/6688482#6688482\" title=\"test or check if sheet exists\">stackoverflow.com/questions/6688131/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557296810, "post_id": 56034557, "comment_id": 98712024, "body": "You might benefit from reading <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>."}], "owner": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557296776, "creation_date": 1557295998, "last_edit_date": 1557296776, "question_id": 56034557, "link": "https://stackoverflow.com/questions/56034557/how-to-use-error-handling-for-my-excel-vba-code", "title": "How to use error handling for my Excel VBA code", "body": "<p>I am trying to add error handling for one of the code. I am assigning worksheet with specific name to the sheet objects, now I am trying to add <code>OnError</code> statements if in case user changes the names of sheets then code should gracefully exit the sub after displaying a message to correct the file names. </p>\n\n<p>But the problem is as I provide the structure as below then the sub exit code always executes even if the file name is ok.  </p>\n\n<p>The problem is, as I provide the details in the structure as below then the sub exit code always executes even if the file name is ok.</p>\n\n<pre><code>Private Sub DoSomething()\n\n    On Error GoTo CleanFail\n\n    '...code...\n\nCleanExit:\n    'cleanup code here\n    Exit Sub\n\nCleanFail:\n    If Err.Number = 9 Then 'subscript out of range\n        Err.Clear\n        Resume Next\n    Else\n        MsgBox Err.Description\n        Resume CleanExit\n    End If\nEnd Sub \n</code></pre>\n\n<pre><code>On Error GoTo ErrorFailLoad\n    Set LoadSheet = Application.ActiveWorkbook.Worksheets(\"Load_Template\")\nErrorExit:\n  End Sub\nErrorFailLoad:\n    MsgBox \"Main File name must be Load_Template. Please change and re-run Macro\"\n    Resume ErrorExit\n\n\n\nOn Error GoTo ErrorFailEquip\n    Set EquipSheet = Application.ActiveWorkbook.Worksheets(\"EQUIP\")\nErrorExit:\n  End Sub\nErrorFailEquip:\n    MsgBox \"Equipment File name must be EQUIP. Please change and re-run Macro\"\n    Resume ErrorExit\n</code></pre>\n\n<p>I expect the code to just check if the file name is not available then just show error message and exit. Actual results is code exit even after correct file name.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1557296009, "post_id": 56034382, "comment_id": 98711717, "body": "You seem to be aware of the concept of late binding, so what&#39;s the actual problem?  FYI with no Word reference you cannot use constants such as <code>wdPasteDefault</code> without either defining them in your code or substituting their numeric values.  If you use <code>Option Explicit</code> it will warn you about that type of problem."}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557296645, "post_id": 56034382, "comment_id": 98711952, "body": "Yes, I am already familiar with this one <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdpastedatatype\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/word.wdpastedatatype</a> I am just wondering how the beginning of the code should be with all the variables set correct and <code>Set objWord = CreateObject(&quot;Word.Application&quot;)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557297239, "post_id": 56034382, "comment_id": 98712191, "body": "It&#39;s just as shown in the question your code seems partially sourced from: <a href=\"https://stackoverflow.com/questions/54419143/edit-word-document-embedded-in-a-workbook-and-save-as-copy\" title=\"edit word document embedded in a workbook and save as copy\">stackoverflow.com/questions/54419143/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1557295637, "creation_date": 1557295637, "answer_id": 56034488, "question_id": 56034382, "link": "https://stackoverflow.com/questions/56034382/work-with-embedded-word-document-from-excel-late-binding/56034488#56034488", "title": "Work with embedded Word document from Excel (late binding)", "body": "<p>If you set the reference on an Office 2013 system, it will work with Office 2016 &amp; later without the need to change anything.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 56034488, "answer_count": 1, "score": 0, "last_activity_date": 1557295637, "creation_date": 1557295068, "question_id": 56034382, "link": "https://stackoverflow.com/questions/56034382/work-with-embedded-word-document-from-excel-late-binding", "title": "Work with embedded Word document from Excel (late binding)", "body": "<p>I am wondering is there a possibility to remove reference to Microsoft Word 16.0 Object Library and edit code so that it would work in both Office 2013 and Office 2016?</p>\n\n<p>This code is for opening embedded Word document, writing data into it and saving it to user desktop. After that it quitting Word application. </p>\n\n<pre><code>Sub opentemplateWord()\n    Dim sh As Shape\n    Dim objWord As Object, objNewDoc As Object ''Word.Document\n    Dim objOL As OLEObject\n    Dim wSystem As Worksheet\n    Dim cell As Range\n    Dim wdRng As Object 'Word.Range\n    Dim xlRng As Excel.Range\n    Dim tempFolderPath As String\n    Dim filePath As String\n    Dim fileTitle As String\n\n    Set wSystem = ThisWorkbook.Sheets(\"Templates\")\n        ''The shape holding the object from 'Create from file'\n        ''Object 2 is the name of the shape\n    Set sh = wSystem.Shapes(\"LetterTemplate\")\n         ''The OLE Object contained\n    Set objOL = sh.OLEFormat.Object\n         'Instead of activating in-place, open in Word\n    objOL.Verb xlOpen\n    Set objWord = objOL.Object 'The Word document\n\n    Dim objUndo As Object 'Word.UndoRecord\n        'Be able to undo all editing performed by the macro in one step\n    Set objUndo = objWord.Application.UndoRecord\n    objUndo.StartCustomRecord \"Edit In Word\"\n\n    With objWord\n        'Cover page\n    .Bookmarks(\"CoverPage\").Range.Text = ThisWorkbook.Sheets(\"Other Data\").Range(\"AK4\").Value\n\n    Set xlRng = ThisWorkbook.Sheets(\"Letter\").Range(\"G3\", ThisWorkbook.Sheets(\"Offer Letter\").Range(\"G\" &amp; Rows.Count).End(xlUp))\n\n    Set wdRng = .Range.Characters.Last\n\n    For Each cell In xlRng\n        wdRng.InsertAfter vbCr &amp; cell.Offset(0, -5).Text\n        Select Case LCase(cell.Value)\n\n    Case \"signature\"\n       Worksheets(\"Contact database\").Shapes(\"Signature\").Copy\n        With wdRng\n        .Paragraphs.Last.Range.Paste (wdPasteDefault)\n        End With\n\n    If ActiveDocument.TablesOfContents.Count = 1 Then _\n  ActiveDocument.TablesOfContents(1).Update\n\n        objWord.SaveAs2 Environ$(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; _\n        ThisWorkbook.Sheets(\"Other Data\").Range(\"AU2\").Value &amp; \".docx\"\n\n        objUndo.EndCustomRecord\n        Set objUndo = Nothing\n        objWord.Undo\n        .Application.Quit False\n\n    End With\n    Set objWord = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1557418399, "last_edit_date": 1557418399, "creation_date": 1557295097, "answer_id": 56034388, "question_id": 56033704, "link": "https://stackoverflow.com/questions/56033704/how-to-make-displayed-image-change-after-hitting-button-again-in-excel/56034388#56034388", "title": "How to make displayed image change after hitting button again in excel", "body": "<p>You need to locate the existing picture based on its position, then delete it, before inserting the next picture. </p>\n\n<p>Loop over all the pictures in the sheet and check their position - when you find one which matches where you want to insert the new picture, delete it.</p>\n\n<pre><code>Sub tester()\n    DeletePicFromCell Range(\"I3\")\nEnd Sub\n\n\nSub DeletePicFromCell(c As Range)\n    Const MARGIN As Long = 10 '&lt;&lt; how far the picture can be out of place\n    Dim shp\n    For Each shp In c.Parent.Shapes\n        If Abs(shp.Left - c.Left) &lt; MARGIN And _\n           Abs(shp.Top - c.Top) &lt; MARGIN Then\n            shp.Delete\n            Exit For '&lt;&lt; done checking\n        End If\n    Next shp\nEnd Sub\n</code></pre>\n\n<p>BTW you don't need all those blocks checking for different extensions: assuming all the potential matches are images you can do something like</p>\n\n<pre><code>Dim fName\n\nfName = Dir(pathForPicture &amp; pictureName &amp; \".*\") '&lt;&lt; match any extension\n\nIf Len(fName)&gt;0 Then\n\n    'Have a match\n    'Insert image from pathForPicture &amp; fName\n\nEnd If\n</code></pre>\n\n<p>EDIT: your original code reworked</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Const COL_PIC_NAME As Long = 1   'column where picture name is found\n    Const COL_PIC_PASTE As Long = 5  'column where picture is to be pasted\n    Const PIC_PATH As String = \"C:\\Users\\drawing\\Desktop\\pic\\\"\n\n    Dim pictureName         As String 'picture name\n    Dim pictureFile         As String 'picture file\n    Dim pictureRow          As Long   'current picture row to be processed\n    Dim sht As Worksheet\n    Dim picCell As Range\n\n    Set sht = ActiveSheet\n\n    For pictureRow = 2 To sht.Cells(sht.Rows.Count, COL_PIC_NAME).End(xlUp).Row\n\n        pictureName = sht.Cells(pictureRow, COL_PIC_NAME) 'This is the picture name\n        If Len(pictureName) &gt; 0 Then\n            pictureFile = Dir(PIC_PATH &amp; pictureName &amp; \".*\", vbNormal) 'is there a matching file?\n\n            If Len(pictureFile) &gt; 0 Then\n                Set picCell = sht.Cells(pictureRow, COL_PIC_PASTE)\n                DeletePicFromCell picCell 'delete any previous picture\n                With sht.Pictures.Insert(PIC_PATH &amp; pictureFile)\n                    .Left = picCell.Left\n                    .Top = picCell.Top\n                    .ShapeRange.LockAspectRatio = msoFalse\n                    .Height = 100\n                    .Width = 130\n                End With\n            End If 'have picture\n\n        End If 'have picname\n\n    Next pictureRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11467999, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cHi77BYx6-4/AAAAAAAAAAI/AAAAAAAAB-E/GV62SO9ZRVE/photo.jpg?sz=128", "display_name": "Hipolito Payumo Jr.", "link": "https://stackoverflow.com/users/11467999/hipolito-payumo-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557418399, "creation_date": 1557290906, "last_edit_date": 1557296673, "question_id": 56033704, "link": "https://stackoverflow.com/questions/56033704/how-to-make-displayed-image-change-after-hitting-button-again-in-excel", "title": "How to make displayed image change after hitting button again in excel", "body": "<p>My problem is when I press the command button it show the image but when I press it again the command button duplicates the image being displayed. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim pictureNameColumn   As String 'column where picture name is found\n    Dim picturePasteColumn  As String 'column where picture is to be pasted\n\n    Dim pictureName         As String 'picture name\n    Dim lastPictureRow      As Long   'last row in use where picture names are\n    Dim pictureRow          As Long   'current picture row to be processed\n    Dim pathForPicture      As String 'path of pictures\n\n    pictureNameColumn = \"A\"\n    picturePasteColumn = \"E\"\n\n    pictureRow = 2 'starts from this row\n\n    'error handler\n    On Error GoTo Err_Handler\n\n    'find row of the last cell in use in the column where picture names are\n    lastPictureRow = Cells(Rows.Count, pictureNameColumn).End(xlUp).Row\n\n    'stop screen updates while macro is running\n    Application.ScreenUpdating = False\n\n    pathForPicture = \"C:\\Users\\drawing\\Desktop\\pic\\\"\n    'loop till last row\n    Do While (pictureRow &lt;= lastPictureRow)\n\npictureName = Cells(pictureRow, \"A\") 'This is the picture name\n\n'if picture name is not blank then\nIf (pictureName &lt;&gt; vbNullString) Then\n\n    'check if pic is present\n\n    'Start If block with .JPG\n    If (Dir(pathForPicture &amp; pictureName &amp; \".jpg\") &lt;&gt; vbNullString) Then\n\n        Cells(pictureRow, picturePasteColumn).Select 'This is where picture will be inserted\n        ActiveSheet.Pictures.Insert(pathForPicture &amp; pictureName &amp; \".jpg\").Select 'Path to where pictures are stored\n\n        With Selection\n            .Left = Cells(pictureRow, picturePasteColumn).Left\n            .Top = Cells(pictureRow, picturePasteColumn).Top\n            .ShapeRange.LockAspectRatio = msoFalse\n            .ShapeRange.Height = 100#\n            .ShapeRange.Width = 130#\n            .ShapeRange.Rotation = 0#\n        End With\n    'End If block with .JPG\n\n    'Start ElseIf block with .PNG\n    ElseIf (Dir(pathForPicture &amp; pictureName &amp; \".png\") &lt;&gt; vbNullString) Then\n\n        Cells(pictureRow, picturePasteColumn).Select 'This is where picture will be inserted\n        ActiveSheet.Pictures.Insert(pathForPicture &amp; pictureName &amp; \".png\").Select 'Path to where pictures are stored\n\n        With Selection\n            .Left = Cells(pictureRow, picturePasteColumn).Left\n            .Top = Cells(pictureRow, picturePasteColumn).Top\n            .ShapeRange.LockAspectRatio = msoFalse\n            .ShapeRange.Height = 100#\n            .ShapeRange.Width = 130#\n            .ShapeRange.Rotation = 0#\n        End With\n    'End ElseIf block with .PNG\n\n    'Start ElseIf block with .BMP\n    ElseIf (Dir(pathForPicture &amp; pictureName &amp; \".bmp\") &lt;&gt; vbNullString) Then\n\n        Cells(pictureRow, picturePasteColumn).Select 'This is where picture will be inserted\n        ActiveSheet.Pictures.Insert(pathForPicture &amp; pictureName &amp; \".bmp\").Select 'Path to where pictures are stored\n\n        With Selection\n            .Left = Cells(pictureRow, picturePasteColumn).Left\n            .Top = Cells(pictureRow, picturePasteColumn).Top\n            .ShapeRange.LockAspectRatio = msoFalse\n            .ShapeRange.Height = 100#\n            .ShapeRange.Width = 130#\n            .ShapeRange.Rotation = 0#\n        End With\n    'End ElseIf block with .BMP\n\n    Else\n        'picture name was there, but no such picture\n        Cells(pictureRow, picturePasteColumn) = \"No Picture Found\"\n    End If\n\nElse\n'picture name cell was blank\nEnd If\n'increment row count\npictureRow = pictureRow + 1\n    Loop\n\n    Exit_Sub:\n    Range(\"A10\").Select\n    Application.ScreenUpdating = True\n    Exit Sub\n\n    Err_Handler:\n    MsgBox \"Error encountered. \" &amp; Err.Description, vbCritical, \"Error\"\n    GoTo Exit_Sub\n\nEnd Sub\n</code></pre>\n\n<p>What I want is when I press the button again the previous image will just be replaced by the new image base on the column A.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 11299749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b235c4bc0a0f1164f76d5267804d334c?s=128&d=identicon&r=PG&f=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/11299749/arl"}, "is_accepted": false, "score": 0, "last_activity_date": 1564759925, "creation_date": 1564759925, "answer_id": 57329559, "question_id": 56033384, "link": "https://stackoverflow.com/questions/56033384/send-email-with-a-filter-range-pasted-into-email-body-using-excel-vba/57329559#57329559", "title": "Send Email With A Filter Range Pasted Into Email Body using Excel VBA", "body": "<pre><code>Sub SendEmail_1() \n\nDim outlook As Object\nDim newEmail As Object\nDim xInp As Object\nDim pgEdit As Object\nDim pos As Integer\n\nSet outlook = CreateObject(\"Outlook.Application\")\nSet newEmail= outlook.Createitem(o)\n\n'construction email\nWith newEmail\n        .Recipients.Add (\"person@email.com\") \n        .Subject = \"Subject goes here\"\n        Set xInp = newEmail.GetInspector 'gets you into the test editor\n        Set pgEdit = xInp.WordEditor 'returns a word document object you can edit\n        'selects data we want to copy into email\n        Sheets(\"your Sheet\").Range(\"your Range\").Copy\n        'pastes the excel range over the indicator\n        pgEdit.Range(Start:=0, End:=1).PasteSpecial Placement:=wdInLine\n        Application.CutCopyMode = True\n        .display\n        .send\n        End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 608, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592464715, "creation_date": 1557288348, "last_edit_date": 1592464715, "question_id": 56033384, "link": "https://stackoverflow.com/questions/56033384/send-email-with-a-filter-range-pasted-into-email-body-using-excel-vba", "title": "Send Email With A Filter Range Pasted Into Email Body using Excel VBA", "body": "<p>I have to send an email that includes a table, in the body, that was copied from a filter table.</p>\n\n<p>The filter table's name is \"ds\" in this code.</p>\n\n<p>I use function RangetoHTML (code below) but it only copies the format, not the contents of the table:</p>\n\n<pre><code>Sub Email_Syndicate()\n\nDim OutApp As Object\nDim OutMail As Object\nDim EmailSubject As String\nDim EmailSendTo As String\nDim MailBody As String\nDim cell As Range\nDim Signature As String\nDim ds As Range\n\nSet rng = Range(Range(\"B2\"), Range(\"B\" &amp; Rows.Count).End(xlUp))\nFor Each cell In rng\nrw = cell.Row\nIf cell.Value &lt;&gt; \"\" Then\nEmailSendTo = cell.Value\nNme = cell.Offset(0, 3).SpecialCells(xlCellTypeVisible)\nxCC = cell.Offset(0, 1)\natt = cell.Offset(0, 4).Value\nEmailSubject = cell.Offset(0, 2)\nlr1 = Sheet3.Cells(Rows.Count, 1).End(xlUp).Row\nSheet3.Range(\"A1:N\" &amp; lr1).AutoFilter field:=6, Criteria1:=Sheet4.Range(\"F2\").Value\n    lr = Sheet3.Cells(Sheet3.Rows.Count, 1).End(xlUp).Row\n    Set ds = Sheet3.Range(\"A1:N\" &amp; lr).SpecialCells(xlCellTypeVisible)\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(o)\nWith OutMail\n.Display\nEnd With\nSignature = OutMail.HTMLBody\n'On Error Resume Next\nWith OutMail\n.Subject = EmailSubject\n.To = EmailSendTo\n.CC = xCC\n'.Body = MailBody\n.HTMLBody = RangetoHTML(ds) \n.Display\n.send\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nMailBody = \"\"\nEnd If\nWith Application\n    .EnableEvents = 1\n    .Calculation = xlCalculationAutomatic\nEnd With\n    Set OutMail = Nothing: Set OutApp = Nothing\n\nNext\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n    Dim fso As Object, ts As Object, TempWB As Workbook, TempFile As String\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=xlPasteAll\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteColumnWidths, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n    End With\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    TempWB.Close 0\n    Kill TempFile\n\n    Set ts = Nothing: Set fso = Nothing: Set TempWB = Nothing\n\nEnd Function \n\n</code></pre>\n\n<p>How can I copy a filter table containing full content to the email body?</p>\n"}, {"tags": ["excel", "vba", "printing"], "comments": [{"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557283288, "post_id": 56032716, "comment_id": 98708662, "body": "The error is quite clear - From Help <b>9 Subscript out of range</b> <i>The array you are trying to access contains fewer elements than you expect. For example, attempting to access the 11th element of an array dimensioned for ten elements.</i>  <b>To correct this error</b>    <i>Make sure your code contains bounds checking that ensures elements beyond the scope of the array are not referenced.</i>   <i>Re-dimension the array to a larger size that meets your needs.</i>"}, {"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557283514, "post_id": 56032716, "comment_id": 98708700, "body": "<a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa174230(v%3Doffice.11)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557283541, "post_id": 56032716, "comment_id": 98708707, "body": "From a quick internet search - <a href=\"https://support.microsoft.com/en-us/help/210663/you-receive-a-subscript-out-of-range-error-message-when-you-use-hpageb\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/87344-subscript-out-of-range-for-hpagebreaks\" rel=\"nofollow noreferrer\">here</a> - this seems potentially like a bug. It also sounds like <code>HPageBreaks.Count</code> is not 100% reliable. The first link has a possible solution which may need tweaking."}, {"owner": {"reputation": 3, "user_id": 8191499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66e19aadf3852a62d88093133e556fc2?s=128&d=identicon&r=PG&f=1", "display_name": "FKlusmann", "link": "https://stackoverflow.com/users/8191499/fklusmann"}, "reply_to_user": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557621588, "post_id": 56032716, "comment_id": 98826544, "body": "Thank you, @Noodles. The only problem is that I am not using any array (that I know of). Based on your link, I have tried: ...     ActiveSheet.ResetAllPageBreaks     ActiveSheet.Range(&quot;A61&quot;).Select     ActiveSheet.HPageBreaks.Add Before:=ActiveCell     ....&gt;  ... and still get the failure."}, {"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557622950, "post_id": 56032716, "comment_id": 98826726, "body": "You are using a collection and there is no 2nd hard page break to get the location of."}, {"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557624010, "post_id": 56032716, "comment_id": 98826865, "body": "Notice the answer you accepted is adding them."}, {"owner": {"reputation": 3, "user_id": 8191499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66e19aadf3852a62d88093133e556fc2?s=128&d=identicon&r=PG&f=1", "display_name": "FKlusmann", "link": "https://stackoverflow.com/users/8191499/fklusmann"}, "reply_to_user": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557794003, "post_id": 56032716, "comment_id": 98875533, "body": "Thank you, @Noodles. I acknowledge my ignorance as I do not understand your &quot;You are using a collection and there is no hard page break to get the location of.&quot; AcsErno &#39;s suggestion of making sure that the active cell was outside the print range did work for me."}, {"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1557794387, "post_id": 56032716, "comment_id": 98875599, "body": "The message says that you are accessing an index that doesn&#39;t exist. That is a collection or an array or an object like it that you can index. The help message was written before collections existed. Basic is 55 years old."}], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1557304285, "creation_date": 1557304285, "answer_id": 56036596, "question_id": 56032716, "link": "https://stackoverflow.com/questions/56032716/how-to-fix-runtime-9-in-a-subroutine-work-or-fails/56036596#56036596", "title": "How to fix runtime 9 in a subroutine - work or fails", "body": "<p>@BigBen is right, <code>.HPageBreaks</code> sometimes fails. Try this: </p>\n\n<pre><code>With ActiveSheet\n     .ResetAllPageBreaks\n     .HPageBreaks.Add Range(\"A61\")\n     .HPageBreaks.Add Range(\"A111\")\n     .HPageBreaks.Add Range(\"A161\")\nEnd With\n</code></pre>\n\n<p>It might also help to move ActiveCell out of the affected area before setting page breaks: </p>\n\n<pre><code>Dim sCell as String\n\nsCell = ActiveCell.Address\nRange(\"AA1111\").Activate\n....\nRange(sCell).Activate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 8191499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66e19aadf3852a62d88093133e556fc2?s=128&d=identicon&r=PG&f=1", "display_name": "FKlusmann", "link": "https://stackoverflow.com/users/8191499/fklusmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1557622146, "creation_date": 1557622146, "answer_id": 56095382, "question_id": 56032716, "link": "https://stackoverflow.com/questions/56032716/how-to-fix-runtime-9-in-a-subroutine-work-or-fails/56095382#56095382", "title": "How to fix runtime 9 in a subroutine - work or fails", "body": "<p>Thank you, @AcsErno!\nI find that this works!</p>\n\n<pre><code> Range(\"A212\").Activate     ' a cell outside print range.\n With ActiveSheet\n     .ResetAllPageBreaks\n     .HPageBreaks.Add Range(\"A61\")\n     .HPageBreaks.Add Range(\"A111\")\n     .HPageBreaks.Add Range(\"A161\")\n End With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8191499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66e19aadf3852a62d88093133e556fc2?s=128&d=identicon&r=PG&f=1", "display_name": "FKlusmann", "link": "https://stackoverflow.com/users/8191499/fklusmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56036596, "answer_count": 2, "score": 0, "last_activity_date": 1579210570, "creation_date": 1557282392, "last_edit_date": 1579210570, "question_id": 56032716, "link": "https://stackoverflow.com/questions/56032716/how-to-fix-runtime-9-in-a-subroutine-work-or-fails", "title": "How to fix runtime 9 in a subroutine - work or fails", "body": "<p>My stand-alone Workbook subroutines work for many calls, fails for these. This is the most simple example to reproduce the problem.</p>\n\n<p>Manualy seting up the print page breaks provides the expected results. These subs work for many sheets, fail for two. Many columns are hidden - which keeps the printout within the printer's limits.</p>\n\n<pre><code> this works\n\n    BMPRangeSetup\n    MyPageSetup\n    DownPageBreaks\n    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Collate _\n        :=True\n\nthis fails\n\n    CMPRangeSetup\n    MyPageSetup\n    DownPageBreaks\n    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Collate _\n        :=True\n\nBMPRangeSetup contains:\n\n    ActiveSheet.PageSetup.PrintArea = \"$A$1:$BH$210\"\n\nWhere CMPRangeSetup has:\n\n    ActiveSheet.PageSetup.PrintArea = \"$A$1:$BV$210\"\n\nthe failure shows at Range(\"A111\") \n\n    Sub DownPageBreaks()\n      ActiveSheet.ResetAllPageBreaks\n      ActiveSheet.HPageBreaks(1).Location = Range(\"A61\")\n      ActiveSheet.HPageBreaks(2).Location = Range(\"A111\")\n      ActiveSheet.HPageBreaks(3).Location = Range(\"A161\")\n    End Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1557293686, "post_id": 56031586, "comment_id": 98710989, "body": "So you want to lock specific Column after data pasted. Is it true?"}, {"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1557293785, "post_id": 56031586, "comment_id": 98711030, "body": "Or you want to prevent users from pasting copied data to that column and force them to just type data manually?"}, {"owner": {"reputation": 1, "user_id": 11467169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a95e5cac5c31d013a6413af0459ad1?s=128&d=identicon&r=PG&f=1", "display_name": "untzz", "link": "https://stackoverflow.com/users/11467169/untzz"}, "reply_to_user": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1557297624, "post_id": 56031586, "comment_id": 98712343, "body": "When copied paste data i want to lock columns (less the first column) lets say column A should be unlocked and Column B locked ..... , when is not copy paste all columns should be unlocked."}, {"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1557412766, "post_id": 56031586, "comment_id": 98763899, "body": "So When I as a user copy data from a place and come to excel, column B should be locked before I do paste. Is it true?"}, {"owner": {"reputation": 1, "user_id": 11467169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a95e5cac5c31d013a6413af0459ad1?s=128&d=identicon&r=PG&f=1", "display_name": "untzz", "link": "https://stackoverflow.com/users/11467169/untzz"}, "reply_to_user": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1557435687, "post_id": 56031586, "comment_id": 98774736, "body": "@Hammed Yes, if user inted to paste/copy. But if dont paste/copy all column should stay unloncked."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1557573074, "creation_date": 1557573074, "answer_id": 56089756, "question_id": 56031586, "link": "https://stackoverflow.com/questions/56031586/how-to-lock-specific-column-only-when-paste/56089756#56089756", "title": "How to Lock Specific Column only when Paste?", "body": "<p>Try This and feedback:</p>\n\n<p>In the VBA window, write following code in the Sheet1 code page:</p>\n\n<pre><code>Private Sub WorkSheet_Change(ByVal TargetRNG As Range)\nIf Application.CutCopyMode = xlCopy OR Application.CutCopyMode = xlCut Then\n    If Intersect(TargetRNG, Range(\"B:B\")) Then\n        Application.Undo\n    end if\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 11467169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a95e5cac5c31d013a6413af0459ad1?s=128&d=identicon&r=PG&f=1", "display_name": "untzz", "link": "https://stackoverflow.com/users/11467169/untzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557573074, "creation_date": 1557271085, "last_edit_date": 1557277599, "question_id": 56031586, "link": "https://stackoverflow.com/questions/56031586/how-to-lock-specific-column-only-when-paste", "title": "How to Lock Specific Column only when Paste?", "body": "<p>I would like to know how can I lock a specific column only when copy/paste in Worksheet Change and still make this specific column not locked when nothing is getting copy/pasted?</p>\n\n<p>What I mean is, I want, for example, Lock a specific column when <code>cutcopymode = 1</code>\nin change event, (I want to lock specific column only when copy/paste, because the column should not be locked if nothing is getting pasted) is this possible to do it? If it is, can someone provide some examples how to do this on vba?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "vbscript"], "comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 4, "creation_date": 1557274929, "post_id": 56031488, "comment_id": 98707244, "body": "that sql query should not perform faster, or slower then any other query. So, that one sql statement being slow is likely  due to the sql statement. Check indexing etc.  Dlookup() or creating executing a sql statement  is not slow, but if you repeating  the command in some loop, then sure, it going to be slow, but no slower then any other single query. The trick is then to execute one query as opposed to many."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1557304622, "post_id": 56031488, "comment_id": 98715659, "body": "<code>obConnectionVS</code> is (presumably) an ADO connection to your database. <code>Execute()</code> is a method for executing SQL statements over that connection. If there is a problem then it&#39;s most likely with the SQL query, not the <code>Execute()</code> method itself. Try running the statement directly in Access for comparison."}], "owner": {"reputation": 141, "user_id": 2901200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/126f6edd8c6cf4843dec1e315c2b50e5?s=128&d=identicon&r=PG&f=1", "display_name": "user101998", "link": "https://stackoverflow.com/users/2901200/user101998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557297948, "creation_date": 1557270098, "last_edit_date": 1557297948, "question_id": 56031488, "link": "https://stackoverflow.com/questions/56031488/what-does-objconnectionvs-execute-do-and-if-there-are-replacements-for-the-same", "title": "What does objConnectionVS.Execute do and if there are replacements for the same function", "body": "<p>I have a user-defined function that queries a MS Access database, and it is very slow. I drilled down the line that is causing the issue, and it turns out to be the following: <code>Set rsTable = objConnectionVS.Execute(strSQL)</code>. StrSQL is a string of SQL code. </p>\n\n<p>The function takes about 1 second to run, and every other line returned 0 seconds with the timer function. (Thus I assume this line is the problem). </p>\n\n<p>I did some google search and could not find the exact function <code>objConnectionVS</code>. I was able to find <code>objConnection</code>, but deleting the \"VS\" causes an error.</p>\n\n<p>I am wondering if there are some resources where I can look up the function, and also if there are replacements for the <code>objConnectionVS</code> that is faster.</p>\n\n<p>Lastly, I wonder if switching to SQL Server will be feasible and whether it'd be much faster (assuming that I still use Excel to query). And how much time and effort will it take to move database to SQL Server and set up queries in Excel (I have no knowledge of SQL or SQL Server and will need to start from scratch, but I only need to run some SQL code from Excel).</p>\n"}, {"tags": ["excel", "vba", "match"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1557269062, "post_id": 56031292, "comment_id": 98706151, "body": "<code>COUNTIF</code> will do"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4734749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cWhOM.png?s=128&g=1", "display_name": "Student201", "link": "https://stackoverflow.com/users/4734749/student201"}, "edited": false, "score": 0, "creation_date": 1557269430, "post_id": 56031383, "comment_id": 98706243, "body": "Thanks for answering so quickly! I have tried to run this but I am getting &quot;Run time error &#39;13&#39;: Type mismatch&quot;  .   Any ideas please?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 131, "user_id": 4734749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cWhOM.png?s=128&g=1", "display_name": "Student201", "link": "https://stackoverflow.com/users/4734749/student201"}, "edited": false, "score": 1, "creation_date": 1557269689, "post_id": 56031383, "comment_id": 98706291, "body": "I may have swapped the criteria - AFK right now, can check in 30"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1557269190, "creation_date": 1557269190, "answer_id": 56031383, "question_id": 56031292, "link": "https://stackoverflow.com/questions/56031292/vba-to-see-which-column-a-entries-do-not-appear-in-column-b/56031383#56031383", "title": "VBA. To see which Column A entries do not appear in Column B", "body": "<pre><code>Option Explicit\n\nSub Test()\n\nDim LR As Long, i As Long\nLR = 8\n\nFor i = 2 To LR\n    If WorksheetFunction.CountIf(Range(\"A\" &amp; i), Range(\"B:B\")) = 0 Then\n        Debug.Print Range(\"A\" &amp; i)\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 11467339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d518f6c521ab7629fc0b0b9236b9cc?s=128&d=identicon&r=PG&f=1", "display_name": "Palinnalip", "link": "https://stackoverflow.com/users/11467339/palinnalip"}, "is_accepted": true, "score": 2, "last_activity_date": 1557276188, "creation_date": 1557276188, "answer_id": 56032095, "question_id": 56031292, "link": "https://stackoverflow.com/questions/56031292/vba-to-see-which-column-a-entries-do-not-appear-in-column-b/56032095#56032095", "title": "VBA. To see which Column A entries do not appear in Column B", "body": "<p>A slow but thorough way:</p>\n\n<pre><code>Sub compareColumns()\n\n    Dim r As Range\n    Dim s As Range\n    Dim firstCol As Range\n    Dim secCol As Range\n\n    Dim match As Boolean\n\n    Set firstCol = Range(\"A1:A8\")\n    Set secCol = Range(\"B1:B8\")\n\n    For Each r In firstCol\n        match = False\n\n        For Each s In secCol\n            If r.Value = s.Value Then\n                match = True\n                Exit For\n            End If\n        Next s\n\n    Debug.Print r.Address &amp; \"has a match = \" &amp; match\n\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 4734749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cWhOM.png?s=128&g=1", "display_name": "Student201", "link": "https://stackoverflow.com/users/4734749/student201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56032095, "answer_count": 2, "score": 0, "last_activity_date": 1557276188, "creation_date": 1557268604, "question_id": 56031292, "link": "https://stackoverflow.com/questions/56031292/vba-to-see-which-column-a-entries-do-not-appear-in-column-b", "title": "VBA. To see which Column A entries do not appear in Column B", "body": "<p><a href=\"https://i.stack.imgur.com/3wIMm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3wIMm.png\" alt=\"\"></a></p>\n\n<p>I am trying to write VBA code to determine which entries in column A do not appear in column B, and then print these entries.</p>\n\n<pre><code> Sub Checker()\n Dim endrow As Integer\n\n endrow = 8\n\n\n For i = 2 To endrow\n\n Next i\n End Sub\n</code></pre>\n\n<p>I think the next step is to use an if statement with the worksheet function match, to first take the \"345A\" and compare it with each entry in Column B in turn.  But haven't any success implementing.</p>\n\n<p>Any help would be appreciated, thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1557265811, "post_id": 56030820, "comment_id": 98705338, "body": "Are you sure nobody removed the filters from the header?"}, {"owner": {"reputation": 1, "user_id": 11466937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6kCpBRLZ8aY/AAAAAAAAAAI/AAAAAAAAABg/b6v-qmUGEFM/photo.jpg?sz=128", "display_name": "Robat", "link": "https://stackoverflow.com/users/11466937/robat"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557434364, "post_id": 56030820, "comment_id": 98774264, "body": "Thanks for the question. I am certain that no one messed with the filters."}], "owner": {"reputation": 1, "user_id": 11466937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6kCpBRLZ8aY/AAAAAAAAAAI/AAAAAAAAABg/b6v-qmUGEFM/photo.jpg?sz=128", "display_name": "Robat", "link": "https://stackoverflow.com/users/11466937/robat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557265410, "creation_date": 1557265232, "last_edit_date": 1557265410, "question_id": 56030820, "link": "https://stackoverflow.com/questions/56030820/run-time-error-1004-autofilter-of-method-range-class-failed", "title": "Run time error &#39;1004&#39; AutoFilter of method range class failed", "body": "<p>I'm trying to filter column M (aka field 13) to 0 values so I can delete them, but keep getting the error autofilter method of Range class failed.</p>\n\n<pre><code>Range(\"M2\").Formula = \"=IF(K2&lt;4,1,0)\"\nRange(\"M2\").Copy\nRange(\"M2:M\" &amp; LR).PasteSpecial xlPasteFormulas\nRange(\"M:M\").Copy\nRange(\"M:M\").PasteSpecial xlPasteValues\n\nRange(\"K:M\").NumberFormat = \"##,##0\"\n\nCells.AutoFilter _\n    field:=13, _\n    Criteria1:=0\n</code></pre>\n\n<p>This macro worked without fail since it was written (a couple years) and just in the last couple weeks it would stop at this error. The source code has not been touched so not sure why it would stop working. I'd appreciate any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1557263653, "post_id": 56030451, "comment_id": 98704674, "body": "as a new user, please take the <a href=\"https://stackoverflow.com/tour\">tour</a>, then learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Edit your question before it gets closed."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11466620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d68b695119a5ed900e2af804d01b713?s=128&d=identicon&r=PG&f=1", "display_name": "rimon", "link": "https://stackoverflow.com/users/11466620/rimon"}, "edited": false, "score": 0, "creation_date": 1557343475, "post_id": 56031901, "comment_id": 98737040, "body": "Thank you Mr. Roy Brander! Yes, I have 9 sheets, each of them has 60 rows and AZ columns. If putting all data in one sheet will make it easier I can do that. Pivot Table tool can summarize my data put could it compare them the way I want? Because summarizing them is not important for me, instead comparing each cell is what matters. Any more information could be helpful Mr. Roy. Thank you again!"}, {"owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "reply_to_user": {"reputation": 3, "user_id": 11466620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d68b695119a5ed900e2af804d01b713?s=128&d=identicon&r=PG&f=1", "display_name": "rimon", "link": "https://stackoverflow.com/users/11466620/rimon"}, "edited": false, "score": 0, "creation_date": 1557360259, "post_id": 56031901, "comment_id": 98742245, "body": "There&#39;s nothing that can produce the long string of letters and punctuation marks you specified, but a pivot table could show the 9 values that are all in (say) cell C7, as a column of 9 values - and then sort those, so that you can see which are equal and which are greater than the next;  I wondered if that might eliminate the need for your string of sorted sheet names and &quot;=;&quot; marks.    It would also be much easier to write a macro to produce that string if you already had the sorted list.    HOWEVER, my question was whether you have a lot of different things to do or just this one job."}, {"owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "reply_to_user": {"reputation": 3, "user_id": 11466620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d68b695119a5ed900e2af804d01b713?s=128&d=identicon&r=PG&f=1", "display_name": "rimon", "link": "https://stackoverflow.com/users/11466620/rimon"}, "edited": false, "score": 0, "creation_date": 1557360410, "post_id": 56031901, "comment_id": 98742272, "body": "If you just have this one thing to do, then the work to move the data into a pivot table is not worth it; less time to just write the longer macro that does what I outlined in my answer.    This isn&#39;t a code-writing service, but if the steps outlined in my answer don&#39;t seem to be within your ability, I could provide some code fragments for the harder steps.  Oh, and I see you&#39;re new here.   It&#39;s polite to &quot;thank&quot; answers that you feel are useful by  clicking on that little up-arrow beside the useful answer, to indicate it WAS rated as an answer, and not a bad thing."}, {"owner": {"reputation": 3, "user_id": 11466620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d68b695119a5ed900e2af804d01b713?s=128&d=identicon&r=PG&f=1", "display_name": "rimon", "link": "https://stackoverflow.com/users/11466620/rimon"}, "edited": false, "score": 0, "creation_date": 1557427976, "post_id": 56031901, "comment_id": 98771597, "body": "I actually did voted your answer but I get this message: &quot;Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score.&quot; As appreciation of your efforts I will accept your answer so you earns +15 reputation I guess."}, {"owner": {"reputation": 3, "user_id": 11466620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d68b695119a5ed900e2af804d01b713?s=128&d=identicon&r=PG&f=1", "display_name": "rimon", "link": "https://stackoverflow.com/users/11466620/rimon"}, "edited": false, "score": 0, "creation_date": 1557428926, "post_id": 56031901, "comment_id": 98771997, "body": "I&#39;m a VBA beginner. What I&#39;ve tried is oppening a new sheet and in the first cell of it I wrote: =D!B2,O!B2,H!B2 And then I dragged the handle to copy the formula to all cells in the new sheet. Now each cell has all the prices. However, I still need to do the comparison work manually."}], "tags": [], "owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "is_accepted": true, "score": 0, "last_activity_date": 1557273972, "creation_date": 1557273972, "answer_id": 56031901, "question_id": 56030451, "link": "https://stackoverflow.com/questions/56030451/function-or-code-to-compare-multiple-sheets-in-excel-and-display-them-sorted-in/56031901#56031901", "title": "Function or code to compare multiple sheets in Excel and display them sorted in ascending order in a new sheet", "body": "<p>What's tough about this one is that Excel ranges can't really cross worksheets, it isn't really 3D.  So in VBA you'll probably end up with:</p>\n\n<ul>\n<li>An Array of sheet names for your 3 (or more?) sheets to be compared</li>\n<li>A loop to pull the values from a given 2D address across the array of sheets into an Array</li>\n<li>Sort the Array (which isn't a thing, you have to dump the array into a temp range somewhere and sort that, along with a list of sheet names)</li>\n<li>A loop to go down the sorted array's temp range, naming the sheets in order and putting in either an equals sign or semicolon depending on the next value</li>\n<li>which all constructs a string of the type in your output sheet.</li>\n</ul>\n\n<p>...I'd do all that as an Excel function, then copy the function into all the cells of Sheet4, since the names of sheets1-3 are hard-coded into the function.</p>\n\n<p>If you want to be able to do this for any arbitrary list of sheets, trickier still.</p>\n\n<p>But before we get into that, do you have a lot of this 3D data processing to do?  Because Excel has a powerful tool for multi-dimensional data, called a Pivot Table, and your data is eminently suitable for putting into a pivot table, and this would allow you to \"pivot\" the data so that \"which supplier\" becomes a column or row, rather than sheet.</p>\n\n<p>Pivot tables have a learning curve, but they're the way to go for this kind of problem.</p>\n"}], "owner": {"reputation": 3, "user_id": 11466620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d68b695119a5ed900e2af804d01b713?s=128&d=identicon&r=PG&f=1", "display_name": "rimon", "link": "https://stackoverflow.com/users/11466620/rimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1557298265, "accepted_answer_id": 56031901, "answer_count": 1, "score": 0, "last_activity_date": 1557298254, "creation_date": 1557263078, "last_edit_date": 1557298254, "question_id": 56030451, "link": "https://stackoverflow.com/questions/56030451/function-or-code-to-compare-multiple-sheets-in-excel-and-display-them-sorted-in", "closed_reason": "Needs more focus", "title": "Function or code to compare multiple sheets in Excel and display them sorted in ascending order in a new sheet", "body": "<p>I have a workbook which has let's say 3 similar worksheets. Each from different supplier. I want to compare them to find out who is cheaper and who is the cheapest with each and every item. \nFor example:</p>\n\n<p>Worksheet 1 (D) (stands for David)</p>\n\n<pre><code>    A            B             C             D\n    1            quality 1     quality 2     quality 3    .....\n    2 Apple      20            30            40\n    3 Orange     25            33            46\n</code></pre>\n\n<p>Worksheet 2 (O) (stands for Oliver)</p>\n\n<pre><code>    A            B             C             D\n    1            quality 1     quality 2     quality 3    .....\n    2 Apple      18            30            35\n    3 Orange     25            35            46\n</code></pre>\n\n<p>Worksheet 3 (H) (stands for Harry)</p>\n\n<pre><code>    A            B             C             D\n    1            quality 1     quality 2     quality 3    .....\n    2 Apple      22            33            44\n    3 Orange     20            36            39\n</code></pre>\n\n<p>I expect the output to be something like this:</p>\n\n<p>Worksheet 4 (sorted by the cheapest)</p>\n\n<pre><code>    A            B             C             D\n    1            quality 1     quality 2     quality 3    .....\n    2 Apple      O;D;H         D=O;H         O;D;H\n    3 Orange     H;D=O         D;O;H         H;D=O\n</code></pre>\n\n<p>Thanks in advance for your time and consideration.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1557263196, "post_id": 56030046, "comment_id": 98704503, "body": "Try the other way around, have the template only with the first Row of formulas. When the second workbook with the data is used, get the Last Row and FillDown the formulas to that row on the template."}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1557267568, "post_id": 56030046, "comment_id": 98705771, "body": "As Ricardo A suggests .... and the accepted answer in this post provides a solution <a href=\"https://stackoverflow.com/questions/55961909/how-to-copy-paste-the-formulas-of-row-2-into-lower-rows-if-column-a-isnt-empty/55962037#55962037\" title=\"how to copy paste the formulas of row 2 into lower rows if column a isnt empty\">stackoverflow.com/questions/55961909/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 7944629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b6bf76b0f21e3f01343d3ce2a6ed35?s=128&d=identicon&r=PG&f=1", "display_name": "Morphasis", "link": "https://stackoverflow.com/users/7944629/morphasis"}, "edited": false, "score": 0, "creation_date": 1557327217, "post_id": 56030046, "comment_id": 98729070, "body": "Ricardo and Knee - thanks for the replies and thinking about a different approach.  I appreciate it.  However, I couldn&#39;t use your solution because I also need to be able to sort the columns in each worksheet once populated, which means each row of formulas requires absolute references that remain connected with the same cells after sorting has changed their order (i.e. if I copy the row down, every row would point at the same set of cells as the first row).  I do really appreciate the idea, which would have worked if not for the need to sort...unless you know a way to also work around that?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7944629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b6bf76b0f21e3f01343d3ce2a6ed35?s=128&d=identicon&r=PG&f=1", "display_name": "Morphasis", "link": "https://stackoverflow.com/users/7944629/morphasis"}, "edited": false, "score": 0, "creation_date": 1557328427, "post_id": 56031264, "comment_id": 98729826, "body": "Gary&#39;s Student - this is awesome (magic in just a few lines).  One question...this seems set up to only run on active worksheets.  Is there a way to have it work across the entire workbook?  I hoped to have a button in one worksheet that I click to clear hidden cells for the entire workbook.  Or, you may have a better idea.  I found this code that is supposed to loop through and activate all worksheets, but I&#39;ve used loops before that can take a long time to run.  Regardless of your reply, know that I am very appreciative and still find a way to pay this forward."}, {"owner": {"reputation": 31, "user_id": 7944629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b6bf76b0f21e3f01343d3ce2a6ed35?s=128&d=identicon&r=PG&f=1", "display_name": "Morphasis", "link": "https://stackoverflow.com/users/7944629/morphasis"}, "edited": false, "score": 1, "creation_date": 1557328437, "post_id": 56031264, "comment_id": 98729832, "body": "Sub loop_through_all_worksheets()  Dim ws As Worksheet Dim starting_ws As Worksheet Set starting_ws = ActiveSheet &#39;remember which worksheet is active in the beginning  For Each ws In ThisWorkbook.Worksheets     ws.Activate     &#39;do whatever you need     ws.Cells(1, 1) = 1 &#39;this sets cell A1 of each sheet to &quot;1&quot; Next  starting_ws.Activate &#39;activate the worksheet that was originally active  End Sub"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1557268399, "creation_date": 1557268399, "answer_id": 56031264, "question_id": 56030046, "link": "https://stackoverflow.com/questions/56030046/how-can-i-clear-the-contents-of-only-hidden-cells-in-excel-and-not-delete-the/56031264#56031264", "title": "How can I clear the contents of (only) hidden cells in Excel (and not delete them)?", "body": "<p>To clear the contents of hidden cells:</p>\n\n<pre><code>Sub KlearHidden()\n    Dim r As Range\n\n    For Each r In ActiveSheet.UsedRange\n        If r.EntireRow.Hidden Or r.EntireColumn.Hidden Then\n            r.Clear\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7944629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b6bf76b0f21e3f01343d3ce2a6ed35?s=128&d=identicon&r=PG&f=1", "display_name": "Morphasis", "link": "https://stackoverflow.com/users/7944629/morphasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557295962, "creation_date": 1557260884, "last_edit_date": 1557295962, "question_id": 56030046, "link": "https://stackoverflow.com/questions/56030046/how-can-i-clear-the-contents-of-only-hidden-cells-in-excel-and-not-delete-the", "title": "How can I clear the contents of (only) hidden cells in Excel (and not delete them)?", "body": "<p>(context:  I know a lot about writing complex formulas in Excel, but have very basic understanding of VBA.  I am amazed that I couldn't find a solution to the problem I am trying to solve on my own which makes we wonder if there is something in Excel that makes it impossible to do).  I would like to imagine many others would find this as beneficial as I will because I'm sure lots of people get bloated Excel templates.</p>\n\n<p>I have an Excel template with a variety of cells across a variety of worksheets with pre-populated formulas that update based on dumping a changing set of data into one worksheet.  I use the template for different 'projects' that do not all require the use of all the cells pre-populated with formulas.  So, once new data is imported, certain unused rows and columns are hidden (either manually or with a VBA macro) because they are not needed.</p>\n\n<p>I would like to find a way to clear the contents (i.e. the formulas) in all the hidden cells to reduce the overall file size.  My files quickly get over 100 MB, but perhaps 80% of the cells that contain formulas are not used for any particular project and could be cleared.</p>\n\n<p>I'm not a VBA expert, but I've searched for this through Google, thinking it would be an easy snippet of VBA to find, but after literally hours of going deep into Google search result ranks, I haven't found a single good result that sent me in the direction of a solution. </p>\n\n<p>There is a lot of content about how to use VBA to <em>delete</em> hidden rows or columns, but I can't do that with my workbook (I need the the rows and columns to remain for other formulas and formats to work).  I just want to remove the unused formulas in hidden cells.</p>\n\n<p>I understand that I can use the following to clear contents and/or clear formats</p>\n\n<pre><code>Sheets(\"Test\").Range(\"A1:C3\").ClearContents\nSheets(\"Test\").Range(\"A1:C3\").ClearFormats\n</code></pre>\n\n<p>and I use this line to hide cells:</p>\n\n<pre><code>Range.Hidden = True\n</code></pre>\n\n<p>So, how can I get the range for the <code>ClearContents</code> function be be defined as hidden cells (or to have it only act on hidden cells)?  And, how can this be done efficiently...I've learned that running a loop can take a great deal of time as it progressing through rows or columns to perform a task.</p>\n\n<p>I would like to have a solution that allows for this process:</p>\n\n<ol>\n<li>Import new data</li>\n<li>Hide unneeded rows and columns</li>\n<li>Push a macro button to clear all formulas from all cells within a certain <code>Range(A3:TY53)</code> across all worksheets</li>\n</ol>\n\n<p>Any help or pointing me to an existing solution I wasn't able to find on my own would be greatly appreciated.</p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "edited": false, "score": 0, "creation_date": 1557266660, "post_id": 56030588, "comment_id": 98705547, "body": "Thanks @QHarr!!  The lastest help:  If I use the second example and need to download (or click the button on the up of the page), how would I do?  Item: &quot;Clique aqui para fazer o download do arquivo .XLS&quot;"}, {"owner": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "edited": false, "score": 1, "creation_date": 1557319264, "post_id": 56030588, "comment_id": 98723944, "body": "Answer Accepted, Thx"}, {"owner": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "edited": false, "score": 0, "creation_date": 1557350513, "post_id": 56030588, "comment_id": 98739852, "body": "I don&#39;t know why, but the updated that you suggested did not work if I run normally the code (using the F5). I mean if I use F8 to see the step-by-step, the code works, but the previous example not.  And the Function Application.SendKeys &quot;%{S}&quot; to complete the download as well did not work. Do you have any ideia? QHarr"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "edited": false, "score": 0, "creation_date": 1557351443, "post_id": 56030588, "comment_id": 98740186, "body": "You need to indicate which line fails on. If works with f8 then put a pause before the line that fails e.g Application.Wait Now + TimeSerial(0,0,2)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "edited": false, "score": 0, "creation_date": 1557383331, "post_id": 56030588, "comment_id": 98747613, "body": "Increase the number 2 to a higher number of seconds if required."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1557320880, "last_edit_date": 1557320880, "creation_date": 1557263818, "answer_id": 56030588, "question_id": 56030005, "link": "https://stackoverflow.com/questions/56030005/how-to-insert-a-value-in-a-html-space-box-by-vba/56030588#56030588", "title": "how to insert a value in a html space box by vba", "body": "<p><strong>Internet Explorer:</strong></p>\n\n<p>It is inside an iframe. You could initially navigate direct to the src source for the iframe with</p>\n\n<pre><code>.Navigate2 http://estatisticas.cetip.com.br/astec/series_v05/paginas/lum_web_v05_template_informacoes_di.asp?str_Modulo=completo&amp;int_Idioma=1&amp;int_Titulo=6&amp;int_NivelBD=2\n</code></pre>\n\n<p>Or, select the iframe element and navigate to its src</p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References: Microsoft Internet Controls\nPublic Sub NavigateLinks()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"http://www.b3.com.br/pt_br/market-data-e-indices/indices/indices-de-segmentos-e-setoriais/serie-historica-do-di.htm\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        .Navigate2 .document.getElementById(\"bvmf_iframe\").src\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        With .document\n            .querySelector(\"[name='DT_DIA_DE']\").Value = \"02\"\n            .querySelector(\"[name='DT_MES_DE']\").Value = \"01\"\n            .querySelector(\"[name='DT_ANO_DE']\").Value = \"2018\"\n            .querySelector(\"[href*='EnvioChecaDados']\").Click\n        End With\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>XHR (XMLHttpRequest):</strong></p>\n\n<p>The page does a POST form XHR request to this url:</p>\n\n<pre><code>http://estatisticas.cetip.com.br/astec/series_v05/paginas/lum_web_v04_10_03_consulta.asp\n</code></pre>\n\n<p>You could attempt to replicate that request and avoid a browser altogether. If you manually make the request on the page and inspect the network tab via dev tools (F12 - Chrome), you will find that url. The POST form parameters are all shown including the date parts:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1eOfn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1eOfn.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Click download:</p>\n\n<pre><code>.document.querySelector(\".primary-text a\").click\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 56030588, "answer_count": 1, "score": 2, "last_activity_date": 1557320880, "creation_date": 1557260726, "last_edit_date": 1557298234, "question_id": 56030005, "link": "https://stackoverflow.com/questions/56030005/how-to-insert-a-value-in-a-html-space-box-by-vba", "title": "how to insert a value in a html space box by vba", "body": "<p>I am trying to insert a specific value at 3 differents space boxes. However, I did not find a example that works with the site which I am using.</p>\n\n<p>Site: <a href=\"http://www.b3.com.br/pt_br/market-data-e-indices/indices/indices-de-segmentos-e-setoriais/serie-historica-do-di.htm\" rel=\"nofollow noreferrer\">http://www.b3.com.br/pt_br/market-data-e-indices/indices/indices-de-segmentos-e-setoriais/serie-historica-do-di.htm</a></p>\n\n<pre><code>Sub Download()\n\nDim user, password As Variant\n\nApplication.ScreenUpdating = False\n\n'Planilha Ativa\nWorksheets(\"Realizado\").Activate\n\n'Abrir a p\u00e1gina da BMF\nSet ie = CreateObject(\"InternetExplorer.Application\")\n    ie.navigate \"http://www.b3.com.br/pt_br/market-data-e-indices/indices/indices-de-segmentos-e-setoriais/serie-historica-do-di.htm\"\n    ie.Visible = True\n\nie.Document.all.Item(\"DT_DIA_DE\").Value = \"02\"\nie.Document.all.Item(\"DT_MES_DE\").Value = \"01\"\nie.Document.all.Item(\"DT_ANO_DE\").Value = \"2019\"\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1557266779, "post_id": 56029803, "comment_id": 98705569, "body": "if excel for mac has Tools-&gt;Options-&gt;Editor then <i>maybe</i> what you are looking for is to uncheck &quot;Auto list members&quot; (or perhaps another option) on that tab."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557298166, "post_id": 56029803, "comment_id": 98712577, "body": "I&#39;ve never seen anything like that. Are you sure there are no plugins/add-ins installed in Excel?"}, {"owner": {"reputation": 1, "user_id": 11466596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5d6d4d9e192dfe2ede69f9dd2642e6?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/11466596/eric"}, "reply_to_user": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1557955544, "post_id": 56029803, "comment_id": 98944626, "body": "hi @Stax thanks for your suggestion, I tried but it doesn&#39;t work ..."}, {"owner": {"reputation": 1, "user_id": 11466596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5d6d4d9e192dfe2ede69f9dd2642e6?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/11466596/eric"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557956152, "post_id": 56029803, "comment_id": 98944827, "body": "hi @P\u1d07\u029c yes, I tried to turn off all add-ins but the problem still remains"}], "owner": {"reputation": 1, "user_id": 11466596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5d6d4d9e192dfe2ede69f9dd2642e6?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/11466596/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593588737, "creation_date": 1557259743, "last_edit_date": 1593588737, "question_id": 56029803, "link": "https://stackoverflow.com/questions/56029803/how-to-turn-off-pop-up-box-in-vba-excel-on-macbook", "title": "How to turn off pop-up box in VBA Excel on Macbook", "body": "<p>Whenever I typed any text on VBA Excel, the pop-up box automatically appears as the photo. Do you know how to turn it off?\nI am using Office 2019 for Mac.</p>\n\n<p><a href=\"https://i.stack.imgur.com/62F16.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/62F16.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried to turn off some options in Tools -> references and Excel -> Reference but it does not work.</p>\n"}, {"tags": ["excel", "vba", "xlsm"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1557259761, "post_id": 56029715, "comment_id": 98703146, "body": "You have <code>Range</code> twice for some reason?  Just get rid of one: <code>FirstRow = Range(&quot;C6&quot;).Value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10914510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b740267647c3f54c444b73be096932?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo100", "link": "https://stackoverflow.com/users/10914510/jimbo100"}, "edited": false, "score": 0, "creation_date": 1557304161, "post_id": 56032167, "comment_id": 98715430, "body": "thanks - I&#39;m still getting my head around the Range thing!"}], "tags": [], "owner": {"reputation": 103, "user_id": 11467339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d518f6c521ab7629fc0b0b9236b9cc?s=128&d=identicon&r=PG&f=1", "display_name": "Palinnalip", "link": "https://stackoverflow.com/users/11467339/palinnalip"}, "is_accepted": true, "score": 0, "last_activity_date": 1557276955, "creation_date": 1557276955, "answer_id": 56032167, "question_id": 56029715, "link": "https://stackoverflow.com/questions/56029715/cut-and-paste-a-set-of-rows-to-allow-a-new-blank-row/56032167#56032167", "title": "Cut and paste a set of rows to allow a new blank row", "body": "<p>There is a mix up in your variable types\nFirstRow = Range(Range(\"C6\").Value) will return a RANGE OBJECT (actually it will error because there is no \"set\").</p>\n\n<p>FirstRow = Range(\"C6\").Value will return an INTEGER OR STRING.</p>\n\n<p>++++++++++++++++++++++++++++++++++</p>\n\n<p>I've done something similar, it isn't the most stellar code, but maybe it will give you some ideas. </p>\n\n<pre><code>Sub AddParticipant()\n\n    Dim msgChoice As VbMsgBoxResult\n    Dim NewName As String\n    Dim TargetCell As Range\n\n    'Set Up\n    ThisWorkbook.Save\n\n    If Range(\"LastParticipant\").Value &lt;&gt; \"\" Then\n        MsgBox \"The roster is full. You cannot add anymore participants.\", vbCritical\n        Exit Sub\n    End If\n\n    'Get Name\n    NewName = Application.InputBox( _\n               Prompt:=\"Type the participant's name as you would like it to appear on \n                         this sheet.\", _\n               Title:=\"Participant's Name\", _\n               Type:=2)\n\n        'Error Message\n        If NewName = \"\" Then\n            MsgBox (\"You did not enter a name.\")\n            Exit Sub\n        End If\n\n    'Get Location (with Data Validation)\nGetTargetCell:\n    Set TargetCell = Application.InputBox _\n           (Prompt:=\"Where would you like to put this person? (Select a cell in \n                 column A)\", _\n            Title:=\"Cell Select\", _\n            Type:=8)\n    If TargetCell.Count &gt; 1 Then\n        MsgBox \"Select a single cell in Column A\"\n        GoTo GetTargetCell\n    End If\n\n    If TargetCell.Column &lt;&gt; 1 Then\n        MsgBox \"Select a single cell in Column A\"\n        GoTo GetTargetCell\n    End If\n\n    If TargetCell.Offset(-1, 0) = \"\" Then\n        MsgBox \"You must pick a contiguous cell. No blank spaces allowed!\"\n        GoTo GetTargetCell\n    End If\n\n\n    If TargetCell &lt;&gt; \"\" Then\n\n        'Do stuff to populate rows or shift data around\n\n    Else\n        'If they picked a blank cell, you can insert new data\n        TargetCell.Value = NewName\n\n    End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 10914510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b740267647c3f54c444b73be096932?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo100", "link": "https://stackoverflow.com/users/10914510/jimbo100"}, "is_accepted": false, "score": 0, "last_activity_date": 1557304029, "creation_date": 1557304029, "answer_id": 56036511, "question_id": 56029715, "link": "https://stackoverflow.com/questions/56029715/cut-and-paste-a-set-of-rows-to-allow-a-new-blank-row/56036511#56036511", "title": "Cut and paste a set of rows to allow a new blank row", "body": "<p>Thanks!! I'd been too liberal with the 'Range'.  Code is now:</p>\n\n<p>Dim rActive As Range\nDim FirstRow As Integer\nDim LastRow As Integer</p>\n\n<p>Set rActive = ActiveCell</p>\n\n<p>Application.ScreenUpdating = False</p>\n\n<p>FirstRow = Range(\"C6\").Value</p>\n\n<p>LastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row</p>\n\n<p>With Range(FirstRow &amp; \":\" &amp; LastRow)\n.Copy</p>\n\n<p>With .Offset(1, 0)\n.PasteSpecial xlPasteAll</p>\n\n<p>On Error Resume Next</p>\n\n<p>End With</p>\n\n<p>End With</p>\n\n<p>rActive.Select</p>\n\n<p>Application.CutCopyMode = False</p>\n\n<p>Application.ScreenUpdating = True</p>\n\n<p>It works perfectly!  Just need to do the rest of it now...</p>\n"}], "owner": {"reputation": 5, "user_id": 10914510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b740267647c3f54c444b73be096932?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo100", "link": "https://stackoverflow.com/users/10914510/jimbo100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56032167, "answer_count": 2, "score": 0, "last_activity_date": 1557304029, "creation_date": 1557259309, "last_edit_date": 1557259624, "question_id": 56029715, "link": "https://stackoverflow.com/questions/56029715/cut-and-paste-a-set-of-rows-to-allow-a-new-blank-row", "title": "Cut and paste a set of rows to allow a new blank row", "body": "<p>I am putting together a project management excel spreadsheet (my company won't fork out for licenses for everyone to have access to anything like MS Project or suchlike, and I'd like something everyone can use), and would like the user to be able to add or delete rows wherever they specify (I'm using a userform to make it easier to use).  I am having issues copying, cutting and pasting rows to allow for a new blank row.</p>\n\n<p>I want the user to specify the row number where they want to place a new row (with all associated formulae and formatting).  At present I'm using Cell \"C6\" to input the Row number.  I'm using a modified variant of code I've successfully used previously which allowed me to copy and paste a new blank row at the bottom of a spreadsheet.  I'd like my modified code to copy all rows in the range between the row specified in cell \"C6\" and the last full row, then offset by one row and paste e.g. if the first row value is 14, and the last row is 50, copy the range(14:50), offset to row 15 and paste. </p>\n\n<p>Once I get this bit right I'll then do the rest of the code to copy/paste and clear into row 14 to give me a new blank formatted row.  I'm hoping the code to delete a row will be something along the lines of this in reverse, but I'll get to that later.  </p>\n\n<p>At the moment I'm consistently getting an error which I just don't understand - I've tried everything I know to resolve this, and carried out numerous Google searches, but nothing is working!</p>\n\n<p>The error keeps highlighting the 'FirstRow' as an issue, but I've got a number in the cell - I'm at a loss:</p>\n\n<pre><code>Dim rActive As Range\nDim FirstRow As Integer\nDim LastRow As Integer\n\nSet rActive = ActiveCell\n\nApplication.ScreenUpdating = False\n\nFirstRow = Range(Range(\"C6\").Value)\n\nLastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nWith Range(FirstRow &amp; \":\" &amp; LastRow)\n.Copy\n\nWith Range(FirstRow).Offset(1, 0)\n.PasteSpecial xlPasteAll\n\nOn Error Resume Next\n\nEnd With\n\nEnd With\n\nrActive.Select\n\nApplication.CutCopyMode = False\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I can see that the correct range is selected and copied, but there is an issue with the subsequent offset.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1557258602, "creation_date": 1557258602, "answer_id": 56029570, "question_id": 56029462, "link": "https://stackoverflow.com/questions/56029462/vba-code-to-add-line-break-to-beginning-and-end-of-every-excel-row-with-text/56029570#56029570", "title": "VBA code to add line break to beginning and end of every Excel row with text", "body": "<p>replace:</p>\n\n<pre><code>Cells(i, \"D\").Value = Cells(i, \"D\").Value &amp; vbCrLf\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Cells(i, \"D\").Value = vbCrLf &amp; Cells(i, \"D\").Value &amp; vbCrLf\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 5120270, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/fb5ff26dae2e4339610226995ff05ef4?s=128&d=identicon&r=PG", "display_name": "Larry", "link": "https://stackoverflow.com/users/5120270/larry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 56029570, "answer_count": 1, "score": 0, "last_activity_date": 1557260555, "creation_date": 1557258095, "last_edit_date": 1557260555, "question_id": 56029462, "link": "https://stackoverflow.com/questions/56029462/vba-code-to-add-line-break-to-beginning-and-end-of-every-excel-row-with-text", "title": "VBA code to add line break to beginning and end of every Excel row with text", "body": "<p>I use the following code to add a line break at the <strong>end</strong> of every row in my worksheet:</p>\n\n<pre><code>Sub copyAndNewLine()\ncopy column C to D\nColumns(\"C\").Copy Destination:=Columns(\"D\")\n\n'loop through all cells in D and add new line\nFor i = 2 To Cells(Rows.Count, \"D\").End(xlUp).Row\n    Cells(i, \"D\").Value = Cells(i, \"D\").Value &amp; vbCrLf\nNext i\nEnd Sub\n</code></pre>\n\n<p>Is there a way to also loop through all cells in D and add a line break to the <strong>beginning</strong> of every cell? Basically, I'm doing this to create some visual space at the top and bottom of the text in each row.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-forms"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1557680546, "post_id": 56029382, "comment_id": 98837686, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/193222/discussion-on-question-by-douk-how-can-i-include-a-select-all-option-in-my-com\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557307521, "post_id": 56035950, "comment_id": 98717311, "body": "The fields of the two queries are matched. Take a look again.  The problem reside somewhere else."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557309358, "post_id": 56035950, "comment_id": 98718323, "body": "Look again. No star (that selects all fields)."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557335700, "post_id": 56035950, "comment_id": 98733366, "body": "The asterisk is within quote marks so it is seen as text, not special character. Query with asterisk tested and works. Has a record with asterisk and field is treated as text, not number."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557335988, "post_id": 56035950, "comment_id": 98733520, "body": "@June7: You are right. Thanks. However, returning a text star for an unknown ID makes little sense."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557336554, "post_id": 56035950, "comment_id": 98733821, "body": "I think OP wants the * to cause all records to return. It does work with parameterized query. Criteria <code>LIKE Forms!formname!comboboxname</code> under ID field in query will see the * from combobox as wildcard and all records return. Selecting another value returns only matching records. So this answer does not resolve question."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1557301843, "creation_date": 1557301843, "answer_id": 56035950, "question_id": 56029382, "link": "https://stackoverflow.com/questions/56029382/how-can-i-include-a-select-all-option-in-my-combo-box/56035950#56035950", "title": "How can I include a &quot;Select All&quot; option in my combo box?", "body": "<p>The fields of the two queries must match:</p>\n\n<pre><code>SELECT \n    Sous_Compte.Sous_Compte_ID, Sous_Compte.Numero_Sous_Master, Sous_Compte.Prenom &amp; \" \" &amp; Sous_Compte.Nom AS Nom \nFROM \n    Sous_Compte\nUNION \nSELECT \n    0, \"(All)\", \"\"\nFROM\n    Sous_Compte\nORDER BY \n    Sous_Compte.Numero_Sous_Master;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557695478, "post_id": 56101752, "comment_id": 98841441, "body": "Thanks @June7 it worked for me. I really appreciate your help. I will Use docmd solution for the report later on and let you know."}, {"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557831042, "post_id": 56101752, "comment_id": 98888631, "body": "the docmd.openReport solution works perfectly. Thanks again, God Bless you."}, {"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557923696, "post_id": 56101752, "comment_id": 98928315, "body": "Sorry to bother you again. I added the form you helped me with (let&#39;s call it Form A) to a Navigation Form and it is not working properly on the Navigation Form. The problem occurs whenever I change the value of the combo box or whenever I move to the TAB that has Form A on my Navigation Form. It ask to &quot;Enter Parameter value&quot;, my guess is that the reference to the combo box on Form A not longer works on the Navigation Form. How can I make the combo box work on the Navigation Form?"}, {"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557923895, "post_id": 56101752, "comment_id": 98928434, "body": "I wish there was another way to contact you, so I wouldn&#39;t bring up more questions to this post. Thanks in advance."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557924930, "post_id": 56101752, "comment_id": 98929097, "body": "I never use Navigation Form but tested. The query works fine. VBA <code>Me.NavigationSubform.Requery</code> works. Start a new question if you still have issues."}, {"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557926573, "post_id": 56101752, "comment_id": 98930183, "body": "in what event did you put Me.NavigationSubform.Requery?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557926767, "post_id": 56101752, "comment_id": 98930333, "body": "Combobox AfterUpdate. Same options as with normal form."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557927448, "post_id": 56101752, "comment_id": 98930790, "body": "Again, works for me. Can&#39;t replicate error, can&#39;t advise solution."}, {"owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557928927, "post_id": 56101752, "comment_id": 98931750, "body": "When I put the code in the AfterUpdate of the combo box mine gave the following error: &quot;Compiler Error: Method or data member not found&quot;."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "edited": false, "score": 0, "creation_date": 1557944165, "post_id": 56101752, "comment_id": 98939979, "body": "Then you need to edit this question or start a new question and give details - SQL statement and code and names of objects. It all works for me."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1557683108, "last_edit_date": 1557683108, "creation_date": 1557682242, "answer_id": 56101752, "question_id": 56029382, "link": "https://stackoverflow.com/questions/56029382/how-can-i-include-a-select-all-option-in-my-combo-box/56101752#56101752", "title": "How can I include a &quot;Select All&quot; option in my combo box?", "body": "<p>Setting Master/Child Links properties won't work because * character can't be a key value. But can reference combobox in a dynamic parameterized query, such as: </p>\n\n<p><code>SELECT * FROM tablename WHERE ID LIKE Forms!formname!comboboxname;</code> </p>\n\n<p>Then that query can be RecordSource of a form. </p>\n\n<p>After selecting item from combobox, must refresh/requery form. Can use combobox AfterUpdate event or a button Click event. If using a single form then simply: <code>Me.Requery</code>. If using a subform, must reference through the subform container control: <code>Me.subformcontainername.Requery</code>. (Note this is correcting my comment that subform would fail when opening - a subform will work.)</p>\n\n<p>This dynamic parameterized query can also be the RecordSource of a report. Or if you don't want this same query as report RecordSource, can use WHERE CONDITION argument of OpenReport method:</p>\n\n<p><code>DoCmd.OpenReport \"reportname\", , , \"ID LIKE Forms!formname!comboboxname\"</code></p>\n"}], "owner": {"reputation": 27, "user_id": 11002718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e932d749c465b405ad72d2234c9a99b?s=128&d=identicon&r=PG&f=1", "display_name": "Douk", "link": "https://stackoverflow.com/users/11002718/douk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 56101752, "answer_count": 2, "score": 0, "last_activity_date": 1594779772, "creation_date": 1557257760, "last_edit_date": 1594779772, "question_id": 56029382, "link": "https://stackoverflow.com/questions/56029382/how-can-i-include-a-select-all-option-in-my-combo-box", "title": "How can I include a &quot;Select All&quot; option in my combo box?", "body": "<p>I have a combo box that has the list of my distributors, when I select a distributor in the combo box I have a sub-form that list the transactions of that specific distributor.  </p>\n\n<p>Now I want to include a <code>\"Select All\"</code> option in the combo box that will display all the transactions of my distributors. I tried to do it through the <code>UNION</code> Query and so far it hasn't worked.</p>\n\n<p>Here is the code below:</p>\n\n<pre><code>SELECT Sous_Compte.Sous_Compte_ID, Sous_Compte.Numero_Sous_Master, Sous_Compte.Prenom &amp; \" \" &amp; Sous_Compte.Nom AS Nom \nFROM Sous_Compte\n\nUNION SELECT \"*\" AS Sous_Compte_ID, \"(All)\" as Numero_Sous_Master, \" \" AS Nom from Sous_Compte\n\nORDER BY Sous_Compte.Numero_Sous_Master;\n</code></pre>\n\n<p>And this the error message I get whenever I select <code>\"(All)\"</code>:</p>\n\n<blockquote>\n  <p>This expression is typed incorrectly, or it is too complex to be\n  evaluated. For example, a numeric expression may contain too many\n  complicated elements. Try simplifying the expression by assigning\n  parts of the expression to variables.</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557267747, "post_id": 56029366, "comment_id": 98705818, "body": "Relationship Builder appends _x to a tablename that is included more than once. I am guessing code needs to somehow use this same alias name. That or it cannot be accommodated at all because what you have is non-normalized structure. Why is this procedure necessary?"}, {"owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557278394, "post_id": 56029366, "comment_id": 98707785, "body": "I&#39;m using an ODBC data source that requires hundreds of relationships to exist in order to link two tables with the relevant data. I can do it by hand but was hoping there was a way I could automate the process. This code is just to test 225 of the necessary connections. I&#39;ve not seen any way to import the relationships that already exist in the ODBC source."}, {"owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557278870, "post_id": 56029366, "comment_id": 98707853, "body": "The relationship builder does add what appears to be a new table with _x but if you double click on the relationship, you can use the &quot;Edit Relationship&quot; pop up and add a second row which can link the same field to a second foreign field with no issues. This is where I&#39;m running into trouble replicating the process with VBA."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557283272, "post_id": 56029366, "comment_id": 98708658, "body": "Those additional rows in the link editor would be for compound keys. Compound key is not what you are doing. So you did &#39;add a second row which can link the same field to a second foreign field&#39;? Then close the builder and reopen. What do you see?"}, {"owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557343599, "post_id": 56029366, "comment_id": 98737101, "body": "Using the example in the screen shot above, when I click Edit Relationship I see Table/Query: &quot;Account&quot; and Related Table/Query: &quot;ARRRefundCreditCardRefundAppliedTo&quot;. Below that I see the fields &quot;ListID&quot; joined to &quot;RefundFromAccountRefListID&quot; and an additional row for &quot;ListID&quot; joined to &quot;ARAccountRefListID&quot;. It shows a Relationship Type of One-To-Many, which I believe is what I&#39;m trying to accomplish. When I click OK, I see the relationship as shown in the screenshot above."}, {"owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557355395, "post_id": 56029366, "comment_id": 98741249, "body": "After a little additional testing, I retract my above statement that I want to do what you referred to as compound keys. That is definitely not giving me the right result.  Any further thoughts on your first note about appending the _x to the table name?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557357094, "post_id": 56029366, "comment_id": 98741647, "body": "Try some code that checks if table name already in a relationship, and if it is append the _x suffix."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557373117, "post_id": 56029366, "comment_id": 98744661, "body": "Maybe save table names to a collection object and search the collection to determine if table name already there? How many of this type of relationship are there? If you know exactly which fields need this, tailor the code to handle those specific relationships."}, {"owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557412878, "post_id": 56029366, "comment_id": 98763952, "body": "Looks like the issue was actually having a unique Rel.Name field. The default assigned name appears to just be the table and foreign table. so all I had to add was .Name with a unique name formula in the Add relationship function. Now I have all the relationships and just have to figure out how to make a useful query out of it. Thank you for the help! I will post final function."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "is_accepted": true, "score": 0, "last_activity_date": 1557413092, "creation_date": 1557413092, "answer_id": 56062015, "question_id": 56029366, "link": "https://stackoverflow.com/questions/56029366/automating-the-creation-of-table-relations-in-access-using-vba/56062015#56062015", "title": "Automating the creation of table relations in Access using VBA", "body": "<p>This is the function that ultimately worked for me. Probably not the best error handling but it did successfully create all the relationships I needed when using the sub in my original post.  </p>\n\n<pre><code>Public Function AddRelationship(strRelCount As String, strTable As String, strFTable As String, strField As String, strFField As String, Optional intAttribute As DAO.RelationAttributeEnum = 2)\n\n    On Error GoTo ErrHandler\n\n    Dim db As Database\n    Dim Rel As DAO.Relation\n    Dim errorCount\n\n    Set db = CurrentDb\n    Set Rel = db.CreateRelation(strField, strTable, strFTable, dbRelationDontEnforce)\n\n    With Rel\n        .Fields.Append .CreateField(strField)\n        .Fields(strField).ForeignName = strFField\n        .Attributes = intAttribute\n        .Name = Trim(strRelCount + Left(strTable + strField + strFTable + strFField, 43))\n\n\n    End With\n\n    db.Relations.Append Rel\n\n    Exit Function\n\nErrHandler:\n\n    On Error GoTo NextError\n    errorCount = 1\n\n    strTable = strTable + \"_\" + Str(errorCount)\n\n    Set db = CurrentDb\n    Set Rel = db.CreateRelation(strField, strTable, strFTable, dbRelationDontEnforce)\n\n    With Rel\n        .Fields.Append .CreateField(strField)\n        .Fields(strField).ForeignName = strFField\n        .Attributes = intAttribute\n        .Name = Trim(strRelCount + Left(strTable + strField + strFTable + strFField, 43))\n\n    End With\n\n    db.Relations.Append Rel\n\n    Exit Function\n\nNextError:\n    errorCount = 2\n\n    On Error GoTo FinalError\n\n    strTable = strTable + \"_\" + Str(errorCount)\n\n    Set db = CurrentDb\n    Set Rel = db.CreateRelation(strField, strTable, strFTable, dbRelationDontEnforce)\n\n    With Rel\n        .Fields.Append .CreateField(strField)\n        .Fields(strField).ForeignName = strFField\n        .Attributes = intAttribute\n        .Name = Trim(strRelCount + Left(strTable + strField + strFTable + strFField, 43))\n\n    End With\n\n    db.Relations.Append Rel\n\n    Exit Function\n\nFinalError:\n\n    MsgBox Err.Description + \" \" + strTable + \" \" + strField + \" \" + strFTable + \" \" + strFField\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6115324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52759c8ba7ad0378d8c3219ec3769897?s=128&d=identicon&r=PG&f=1", "display_name": "Ian ", "link": "https://stackoverflow.com/users/6115324/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 56062015, "answer_count": 1, "score": 2, "last_activity_date": 1594887680, "creation_date": 1557257663, "last_edit_date": 1594779787, "question_id": 56029366, "link": "https://stackoverflow.com/questions/56029366/automating-the-creation-of-table-relations-in-access-using-vba", "title": "Automating the creation of table relations in Access using VBA", "body": "<p>I am trying to automate the creation of all relationships in a database using VBA. </p>\n\n<p>I have successfully found the code that can create individual relations and loop through a CSV to connect all single relations. The issue I'm encountering is when one field in the table needs to be linked to two foreign fields. I see I can do this manually but am having trouble locating where in the object the second relation is linked.</p>\n\n<p><img src=\"https://i.stack.imgur.com/NVVYD.jpg\" alt=\"Two Foreign Fields in Access DB Relationship Design View\"> </p>\n\n<pre><code>Public Function AddRelationship(strTable As String, strFTable As String, _ \n    strField As String, strFField As String, Optional intAttribute As DAO.RelationAttributeEnum = 2)\n\n    On Error GoTo ErrHandler\n\n    Dim db As Database\n    Dim rel As DAO.Relation\n    Dim errorCount\n\n    Set db = CurrentDb\n    Set rel = db.CreateRelation(strField, strTable, strFTable,_ dbRelationDontEnforce)\n\n    With rel\n        .Fields.Append .CreateField(strField)\n        .Fields(strField).ForeignName = strFField\n        .Attributes = intAttribute\n\n    End With\n\n    db.Relations.Append rel\n\n    Exit Function\n\nErrHandler:\n\n    MsgBox Err.Description + \" \" + strTable + \" \" + strField + \" \" +_  strFTable + \" \" + strFField\nEnd Function\n\n\nSub DeleteandAddAllRelationships()\n\n    Dim db As Database\n    Dim totalRelations As Integer\n    Dim appExcel As Excel.Application\n    Dim myWorkbook As Excel.Workbook\n    Dim rows As Integer\n    Dim columns As Integer\n    Dim relationsToAdd() As String\n    Dim i As Integer\n    Dim j As Integer\n\n\n    Set appExcel = CreateObject(\"Excel.Application\")\n    Set myWorkbook =_ appExcel.Workbooks.Open(\"C:\\Users\\ian.ebersole\\Desktop\\Relationships2.xlsx\")\n    Set db = CurrentDb()\n\n    totalRelations = db.Relations.Count\n    appExcel.Visible = False\n\n    rows = 225\n    columns = 7\n\n    ReDim relationsToAdd(rows, columns)\n\n    For i = 1 To 225\n        For j = 1 To columns\n            relationsToAdd(i, j) = myWorkbook.Sheets(1).Cells(i, j)\n        Next j\n    Next i\n\n    myWorkbook.Close\n    Set appExcel = Nothing\n    Set myWorkbook = Nothing\n\n\n    If totalRelations &gt; 0 Then\n        For i = totalRelations - 1 To 0 Step -1\n            db.Relations.Delete (db.Relations(i).Name)\n        Next i\n    End If\n\n    For i = 2 To 225\n        Call AddRelationship(relationsToAdd(i, 1), relationsToAdd(i, 4),_ relationsToAdd(i, 2), relationsToAdd(i, 5))\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>It will successfully loop through any relations that are one field to one foreign field but will fail if the same field needs to be linked to a second field in the same table.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1557259425, "post_id": 56029335, "comment_id": 98703010, "body": "Hello and welcome to Stack Overflow.  Unfortunately, this isn&#39;t a &quot;code for me&quot; site, we help with specific problems you&#39;re encountering in your code.  If you are looking for a place to start, google the following: <code>Excel VBA Loop over each cell in a range</code>, <code>Excel VBA Split Function</code>.  From there you should be able to put something together to attempt accomplishing this.  If you get stuck and have a specific question, feel free to come back and edit your question so we can address what stumped you."}, {"owner": {"reputation": 53, "user_id": 11466291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59528cddfd2343d4088e96d4847bb330?s=128&d=identicon&r=PG&f=1", "display_name": "Trading Post LLC", "link": "https://stackoverflow.com/users/11466291/trading-post-llc"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1557260537, "post_id": 56029335, "comment_id": 98703486, "body": "Pointing me in the right direction is definitely helpful, thank you!  I will try to get something together and go from there!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1557270211, "post_id": 56029335, "comment_id": 98706388, "body": "Pretty simple to do with Power Query (found in Excel 2010+).  Delete the row where column 2 is empty; split column 2 using the comma; then select column 1 and <code>unpivot other columns</code>"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1557277688, "post_id": 56029335, "comment_id": 98707685, "body": "If this is not going to a repeated process, I expect you could do this easier without coding/vba like I think @RonRosenfeld is suggesting. I only code vba to avoid doing tasks repetitively, but for doing something once, generally excel already has a good function built it,"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1557278374, "post_id": 56029335, "comment_id": 98707782, "body": "@FreeSoftwareServers Actually, once he develops the Query, it can be used repeatedly, easily, should the underlying data change. The Query remains an integral part of the workbook."}], "owner": {"reputation": 53, "user_id": 11466291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59528cddfd2343d4088e96d4847bb330?s=128&d=identicon&r=PG&f=1", "display_name": "Trading Post LLC", "link": "https://stackoverflow.com/users/11466291/trading-post-llc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557258152, "creation_date": 1557257423, "last_edit_date": 1557258152, "question_id": 56029335, "link": "https://stackoverflow.com/questions/56029335/how-to-turn-a-row-with-csv-into-a-column-of-unique-rows-with-repeating-informati", "title": "How to turn a row with csv into a column of unique rows with repeating information", "body": "<p>I'm converting information from my Brick-and-Morter store into a web store using Excel as my main powerhouse for translation of format.  My POS database is Dataflex 3.1c, and the web store uses Maria (SQL). (All of that in case somebody knows a connector for these two disparate products, none so far have done the job). What I need to do right now is take a two column spreadsheet using CSV, and turn it into a two column spreadsheet that separates out the CSV values and repeats the identifier number per row. Example below. Notice no row breaks when a value is not transferred (number 19), and the repeated column one identifier in Table 2. The two tables are stored on separate worksheets, so that should make it easier, I would think. I do assume this will be answerable in VBA, but I really don't know.  Thank you for all of your help, fellows! My apologies on the poor editing of the tables, Table 1 has no spaces in between the rows either.</p>\n\n<p>Table 1 (Current setup):</p>\n\n<pre><code>Column1    Column2\n17         70,89,90,91\n18         101,91,89,90,44\n19\n20         99,89,70,101\n</code></pre>\n\n<p>Table 2 (Desired results):</p>\n\n<pre><code>Column1    Column2\n17         70\n17         89\n17         90\n17         91\n18         101\n18         91\n18         89\n18         90\n18         44\n20         99\n20         89\n20         70\n20         101\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557255835, "post_id": 56028948, "comment_id": 98701508, "body": "Maybe put <code>Application.Quit</code> after <code>MsgBox (&quot;Hello World&quot;)</code> in your macro?"}, {"owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1557257073, "post_id": 56028948, "comment_id": 98702030, "body": "@dwirony, You are awesome! I updated my Python code to only run the macro and I made Excel quit the application via the VBA macro. It now runs perfectly!"}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "edited": false, "score": 0, "creation_date": 1557337118, "post_id": 56030757, "comment_id": 98734109, "body": "When I run your code I get this error: name &#39;win32com&#39; is not defined."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "edited": false, "score": 0, "creation_date": 1557337664, "post_id": 56030757, "comment_id": 98734381, "body": "I missed the import."}, {"owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "edited": false, "score": 0, "creation_date": 1557341286, "post_id": 56030757, "comment_id": 98736090, "body": "Awesome! It worked!  However, I did get a python error that says:  pywintypes.com_error: (-2147417848, &#39;The object invoked has disconnected from its clients.&#39;, None, None)"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "edited": false, "score": 0, "creation_date": 1557344862, "post_id": 56030757, "comment_id": 98737623, "body": "I should&#39;ve <code>set xl = None</code> before <code>del xl</code>."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1557344915, "last_edit_date": 1557344915, "creation_date": 1557264869, "answer_id": 56030757, "question_id": 56028948, "link": "https://stackoverflow.com/questions/56028948/python-interactions-with-excel-macros/56030757#56030757", "title": "Python Interactions with Excel Macros", "body": "<p>The comment from dwirony is a workaround that is definitely usable. However you really want to go the right way about this or you may end up with a hanged excel process and memory leaks.</p>\n\n<p>In my opinion the correct way would be:</p>\n\n<pre><code>import win32com.client\n\nxl = win32com.client.Dispatch(\"Excel.Application\")\n\nreport = xl.Workbooks.Open(\"C:\\Desktop\\Reader.xlsm\")\nxl.Application.Run('Reader')\nreport.Close False\nxl.Application.Quit()\nxl = None\ndel xl\n\nprint(\"The job is done\")\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 56030757, "answer_count": 1, "score": 0, "last_activity_date": 1557344915, "creation_date": 1557255612, "question_id": 56028948, "link": "https://stackoverflow.com/questions/56028948/python-interactions-with-excel-macros", "title": "Python Interactions with Excel Macros", "body": "<p>I would like to quit my Excel application from my Python code. My Python code opens an excel book, runs a macro, then closes the book. However, the Excel application is still running. How can I quit Excel?</p>\n\n<p>This is the error I get from Python IDLE:</p>\n\n<pre><code>(-2147417848, 'The object invoked has disconnected from its clients.', None, None)\n</code></pre>\n\n<p>Here is my Python Code:</p>\n\n<pre><code>import xl\n\n\nreport = xl.Workbook(r\"C:\\Desktop\\Reader.xlsm\")\nprint(report)\n\nreport.xlWorkbook.Application.Run('Reader')\n\nreport.xlWorkbook.Close(SaveChanges=False)\nreport.xlWorkbook.Application.Quit()\n\nprint(\"The job is done\")\n</code></pre>\n\n<p>Here is my Excel macro:</p>\n\n<pre><code>Public Sub Reader()\n\nMsgBox (\"Hello World\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1557255783, "creation_date": 1557255783, "answer_id": 56028987, "question_id": 56028932, "link": "https://stackoverflow.com/questions/56028932/i-want-to-hide-or-show-rows-based-on-a-value-placed-in-a-previous-cell/56028987#56028987", "title": "I want to hide or show rows based on a value placed in a previous cell", "body": "<p>I think you're looking for a <code>Worksheet_Change()</code> event - try placing this in the corresponding Sheet module under Microsoft Excel Objects:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$B$6\" Then\n        If Target.Value = \"no\" Then\n            Rows(\"7:8\").EntireRow.Hidden = True\n        Else\n            Rows(\"7:8\").EntireRow.Hidden = False\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11466392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbecd6ddf12ceae7237da70577650931?s=128&d=identicon&r=PG&f=1", "display_name": "Reinman", "link": "https://stackoverflow.com/users/11466392/reinman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557297730, "creation_date": 1557255552, "last_edit_date": 1557297730, "question_id": 56028932, "link": "https://stackoverflow.com/questions/56028932/i-want-to-hide-or-show-rows-based-on-a-value-placed-in-a-previous-cell", "title": "I want to hide or show rows based on a value placed in a previous cell", "body": "<p>I have an interactive worksheet where I have people input yes or no answers. I have a grouping of questions that if someone answers no in the first one, the next two are not required. How do I create a function that will hide the rows once a no is given?</p>\n\n<p>I am relatively new to advanced functionality in Excel so I have mostly been looking at different forms of code that my colleagues have provided.</p>\n\n<pre><code>    ActiveSheet.Range(\"B6\") = \"no\"\n    Rows(\"7:8\").EntireRow.Hidden = False\nEnd Function\n</code></pre>\n"}]