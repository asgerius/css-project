[{"tags": ["vba"], "comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531950755, "post_id": 51411481, "comment_id": 89794574, "body": "Did you reset the cell contents/style before you ran the code for the second time?"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1532002565, "post_id": 51411481, "comment_id": 89815766, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/51411481/edit\">edit your question</a> to include more information."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1532002720, "post_id": 51422457, "comment_id": 89815869, "body": "This isn&#39;t an answer. Instead, it belongs either as a comment or as an edit to your question."}], "tags": [], "owner": {"reputation": 1, "user_id": 8935365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24133a5362ba29146e20624cd3359a24?s=128&d=identicon&r=PG&f=1", "display_name": "SlowlyButSurely", "link": "https://stackoverflow.com/users/8935365/slowlybutsurely"}, "is_accepted": false, "score": -1, "last_activity_date": 1532002476, "creation_date": 1532002476, "answer_id": 51422457, "question_id": 51411481, "link": "https://stackoverflow.com/questions/51411481/vba-addindent-propert/51422457#51422457", "title": "VBA addindent propert", "body": "<p>I actually had a column of numbers in A so changed the cell ref to the next row before running to compare.</p>\n\n<p>A1 both lines of code ran\nA2 just the first\nA3 just the second.</p>\n\n<p>Could it be that excel already has the prop switched to true by default which is why no change visible?</p>\n"}], "owner": {"reputation": 1, "user_id": 8935365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24133a5362ba29146e20624cd3359a24?s=128&d=identicon&r=PG&f=1", "display_name": "SlowlyButSurely", "link": "https://stackoverflow.com/users/8935365/slowlybutsurely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532002476, "creation_date": 1531950585, "question_id": 51411481, "link": "https://stackoverflow.com/questions/51411481/vba-addindent-propert", "title": "VBA addindent propert", "body": "<p>Does anyone know what this does as I have used the example in the help section to alter a cell value commenting out the addindent part and leaving it in and the result is the same or appears to be. The code given is,</p>\n\n<pre><code>With Worksheets(\"Sheet1\").Range(\"A1\")\n  . HorizontalAlignment = xlhalig distributed\n  .AddIndent = True\nEnd With\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1532039082, "creation_date": 1532039082, "answer_id": 51432524, "question_id": 51411421, "link": "https://stackoverflow.com/questions/51411421/searching-for-words-in-heading-and-then-deleting-the-heading-where-the-word-is/51432524#51432524", "title": "Searching for words in heading, and then deleting the heading where the word is found", "body": "<p>You could use code like:</p>\n\n<pre><code>Sub DeleteHeadingBlocks()\nApplication.ScreenUpdating = False\nDim Rng As Range, i As Long, ArrRls\nArrRls = Array(\"Animal\", \"Vegetable\", \"Mineral\")\nFor i = 0 To UBound(ArrRls)\n  With ActiveDocument.Range\n    With .Find\n      .ClearFormatting\n      .Replacement.ClearFormatting\n      .Text = ArrRls(i)\n      .Style = wdStyleHeading1\n      .Replacement.Text = \"\"\n      .Forward = True\n      .Format = True\n      .Wrap = wdFindStop\n      .MatchWildcards = False\n      .Execute\n    End With\n    Do While .Find.Found\n      Set Rng = .Paragraphs(1).Range\n      Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n      Rng.Delete\n      .Find.Execute\n    Loop\n  End With\nNext\nSet Rng = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>As coded, macro assumes you're working with the 'Heading 1' Style. The array used by the macro provides for three terms (\"Animal\", \"Vegetable\", \"Mineral\"); you can delete/replace the unwanted terms, or add more.</p>\n"}], "owner": {"reputation": 3, "user_id": 10102095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862f990a25fff05c8bf132b4e1832444?s=128&d=identicon&r=PG&f=1", "display_name": "alext", "link": "https://stackoverflow.com/users/10102095/alext"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1593865302, "accepted_answer_id": 51432524, "answer_count": 1, "score": -3, "last_activity_date": 1593865298, "creation_date": 1531950319, "last_edit_date": 1593865298, "question_id": 51411421, "link": "https://stackoverflow.com/questions/51411421/searching-for-words-in-heading-and-then-deleting-the-heading-where-the-word-is", "closed_reason": "Needs more focus", "title": "Searching for words in heading, and then deleting the heading where the word is found", "body": "<p>I would like to create a code that will search a through headings in a document for a specific word, and delete the heading with the specific word, and everything associated with it.</p>\n\n<p>For example:</p>\n\n<p>If the heading I'm looking for is \"Animals\", and the subheadings are \"Cats\" and \"Dogs\" then:</p>\n\n<p><strong>Pre Macro</strong></p>\n\n<ol>\n<li>Text</li>\n<li>Animals\n\n<ol>\n<li>Cats</li>\n<li>Dogs</li>\n</ol></li>\n<li>Fruit\n\n<ol>\n<li>Cherries</li>\n<li>Bananas</li>\n</ol></li>\n</ol>\n\n<p><strong>Post Macro</strong></p>\n\n<ol>\n<li>Text</li>\n<li>Fruit\n\n<ol>\n<li>Cherries</li>\n<li>Bananas</li>\n</ol></li>\n</ol>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "macos", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1531950054, "post_id": 51411358, "comment_id": 89794295, "body": "Sounds like you need non-volatile alternatives to volatile functions."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531950128, "post_id": 51411358, "comment_id": 89794333, "body": "<i>&#39;Volatile functions recalculate whenever anything in the entire workbook changes, not just when something that affects their outcome changes. Examples of volatile functions are INDIRECT, OFFSET, TODAY, NOW, RAND and RANDBETWEEN. Some sub-functions of the CELL and INFO worksheet functions will make them volatile as well.&#39;</i> And if a volatile function is within a range referenced by a non-volatile function, the non-volatile recals as well."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 3, "creation_date": 1531950218, "post_id": 51411358, "comment_id": 89794363, "body": "You can set calculation of formulas to manual for a worksheet ... Here&#39;s a link ... <a href=\"https://support.office.com/en-us/article/change-formula-recalculation-iteration-or-precision-73fc7dac-91cf-4d36-86e8-67124f6bcce4\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9872606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b123029a95ac6f4a2c72b62aeb8440?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Roberts", "link": "https://stackoverflow.com/users/9872606/jonathan-roberts"}, "edited": false, "score": 0, "creation_date": 1532008115, "post_id": 51411615, "comment_id": 89819680, "body": "That worked perfectly, don&#39;t know why this was so hard to find on google. Thanks"}], "tags": [], "owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "is_accepted": true, "score": 0, "last_activity_date": 1531951426, "creation_date": 1531951426, "answer_id": 51411615, "question_id": 51411358, "link": "https://stackoverflow.com/questions/51411358/pause-updating-formulas-in-excel/51411615#51411615", "title": "Pause updating formulas in excel", "body": "<p>You may try : Formulas > Calculation options > Manual .</p>\n\n<p>Hope that helps. (:</p>\n"}, {"tags": [], "owner": {"reputation": 1355, "user_id": 9354364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fead7c5cae374d54a1e080e0975e4ce?s=128&d=identicon&r=PG&f=1", "display_name": "Hunaidkhan", "link": "https://stackoverflow.com/users/9354364/hunaidkhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1532081025, "creation_date": 1532081025, "answer_id": 51440085, "question_id": 51411358, "link": "https://stackoverflow.com/questions/51411358/pause-updating-formulas-in-excel/51440085#51440085", "title": "Pause updating formulas in excel", "body": "<p>you can go to  <em>Excel Options> Formulas > Calculation options > Manual</em> .</p>\n\n<p>When you want to update the formulas just click <strong>F9</strong> button which will manually update all the formulas. </p>\n\n<p>I hope this Helps </p>\n"}], "owner": {"reputation": 63, "user_id": 9872606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b123029a95ac6f4a2c72b62aeb8440?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Roberts", "link": "https://stackoverflow.com/users/9872606/jonathan-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 51411615, "answer_count": 2, "score": 0, "last_activity_date": 1593599401, "creation_date": 1531949958, "last_edit_date": 1593599401, "question_id": 51411358, "link": "https://stackoverflow.com/questions/51411358/pause-updating-formulas-in-excel", "title": "Pause updating formulas in excel", "body": "<p>I am looking for a way to prevent formulas in my spreadsheet from automatically updating unless I trigger them. This is a massive spreadsheet with literally millions of formulas that all attempt to update every time any cell is updated, which lags out my system a lot. I was hoping to create what I imagine will likely be a vba macro which will disable formulas from updating entirely, and add a button which can be pressed to then force formulas to update. </p>\n\n<p>If this is not possible (I am finally learning that excel has more limitations that I first thought), I could then use some advice on how to potentially smooth the formula updating process. There is no way to trim the program or reduce the number of formulas present, and using multiple sheets to communicate would just make everything look too sloppy. Any advice is appreciated, though a direct answer to the first paragraph is preferred.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1148, "user_id": 5285732, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206841923263165/picture?type=large", "display_name": "Meir Gabay", "link": "https://stackoverflow.com/users/5285732/meir-gabay"}, "edited": false, "score": 1, "creation_date": 1531949658, "post_id": 51411086, "comment_id": 89794132, "body": "Is it mandatory to use macros? Have you tried conditional formatting?"}, {"owner": {"reputation": 1148, "user_id": 5285732, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206841923263165/picture?type=large", "display_name": "Meir Gabay", "link": "https://stackoverflow.com/users/5285732/meir-gabay"}, "edited": false, "score": 0, "creation_date": 1531949844, "post_id": 51411086, "comment_id": 89794202, "body": "Check my solution, it might solve your query <a href=\"https://stackoverflow.com/questions/40765719/how-to-highlight-the-cell-by-conditional-formatting-by-comparing-two-columns-ign/40767157#40767157\" title=\"how to highlight the cell by conditional formatting by comparing two columns ign\">stackoverflow.com/questions/40765719/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10101989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648feb7b56407c29946ee58898b2b98b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10101989/sai"}, "edited": false, "score": 0, "creation_date": 1532008661, "post_id": 51411339, "comment_id": 89820103, "body": "Hi Thank you for the response. Actually I want to highlight the column if both the columns are zero also . but I think I  can do that by adding a condition Via VBA. Thank you so much for your time . :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 21, "user_id": 10101989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648feb7b56407c29946ee58898b2b98b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10101989/sai"}, "edited": false, "score": 0, "creation_date": 1532008931, "post_id": 51411339, "comment_id": 89820293, "body": "@Sai - Try <code>=OR(AND($A2&lt;&gt;0,$B2&lt;&gt;0,$A2&lt;&gt;&quot;&quot;,$B2&lt;&gt;&quot;&quot;),AND($A2=0,$B2=0,$A2&lt;&gt;&zwnj;&#8203;&quot;&quot;,$B2&lt;&gt;&quot;&quot;))</code>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1531949865, "creation_date": 1531949865, "answer_id": 51411339, "question_id": 51411086, "link": "https://stackoverflow.com/questions/51411086/excel-macro-to-validate-2-columns-based-on-cell-values/51411339#51411339", "title": "Excel Macro to validate 2 columns based on cell values", "body": "<p>Don't use VBA, use the built-in Conditional Formatting.</p>\n\n<p>Assuming those columns are A and B, let's say <code>A2:A10</code> and the Credit is <code>B2:B10</code>.</p>\n\n<p>Go to Conditional Formatting, New Rule.</p>\n\n<p>Select \"Use a formula to determine ...\" and type in <code>=AND($A2&lt;&gt;0,$B2&lt;&gt;0,$A2&lt;&gt;\"\",$B2&lt;&gt;\"\")</code>. Then click \"Format\" and Fill Red.</p>\n\n<p>Then click \"Ok\", \"Ok\" and change \"Applies to\" range to <code>$A$2:$B$10</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VRXvQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VRXvQ.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 10101989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648feb7b56407c29946ee58898b2b98b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10101989/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 51411339, "answer_count": 1, "score": 0, "last_activity_date": 1531949865, "creation_date": 1531948537, "last_edit_date": 1531949461, "question_id": 51411086, "link": "https://stackoverflow.com/questions/51411086/excel-macro-to-validate-2-columns-based-on-cell-values", "title": "Excel Macro to validate 2 columns based on cell values", "body": "<p>I am at initial stage in creating Macros. I know how to validate one column at a time, but not sure about validating a column reference to other column in the same row. Hope someone will help me with this!</p>\n\n<p>Scenario: validate 2 columns in a spreadsheet (debit and credit columns). </p>\n\n<p>Condition: For every filled row, I should have one of the two column values as \"0\",\nhighlight both the columns if non of the column value is \"0\".</p>\n\n<p><img src=\"https://i.stack.imgur.com/5l3Fs.jpg\" alt=\"Attached is the sample data\"></p>\n"}, {"tags": ["vba", "excel", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1531948432, "last_edit_date": 1531948432, "creation_date": 1531948321, "answer_id": 51411049, "question_id": 51410984, "link": "https://stackoverflow.com/questions/51410984/vba-if-cells-do-not-equal-values-then-delete/51411049#51411049", "title": "vba if cells do not equal values then delete", "body": "<p>You must compare/evaluate each time.</p>\n\n<pre><code>If cell.Value &lt;&gt; \"order_number\" And cell.Value &lt;&gt; \"tax_details\" And cell.Value &lt;&gt; \"etc\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 1, "creation_date": 1531948591, "post_id": 51411055, "comment_id": 89793689, "body": "Rather than using an arbitrary range, I suggest using <code>For Each rngCell in Rows(1).SpecialCells(xlCellTypeValues)</code> to ensure that you will always get all cells with values in them. If there is any data after GZ1, this will ignore it."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1531948730, "post_id": 51411055, "comment_id": 89793740, "body": "That&#39;s a much nicer way. <code>Range(&quot;A1&quot;).End(&quot;xlToRight&quot;)</code> may be of use here too. As long as it&#39;s not straight <code>Row(1)</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1531949214, "post_id": 51411055, "comment_id": 89793944, "body": "You will need to loop right to left, or risk missing some deletions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531949893, "post_id": 51411055, "comment_id": 89794226, "body": "It would be better to Union the deletion set and delete them all later. You&#39;re examining the column headers from left to right."}, {"owner": {"reputation": 21, "user_id": 9968202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bsQxxtscUbw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BueFGGT1eWJ28R3pitrFZtGd91w/mo/photo.jpg?sz=128", "display_name": "Justin Horne", "link": "https://stackoverflow.com/users/9968202/justin-horne"}, "edited": false, "score": 0, "creation_date": 1532009250, "post_id": 51411055, "comment_id": 89820529, "body": "Thanks for all the pointers. Is there a way to loop right to left with the For Each function?"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1531948337, "creation_date": 1531948337, "answer_id": 51411055, "question_id": 51410984, "link": "https://stackoverflow.com/questions/51410984/vba-if-cells-do-not-equal-values-then-delete/51411055#51411055", "title": "vba if cells do not equal values then delete", "body": "<p>You are close. </p>\n\n<ol>\n<li>Your <code>For</code> loop must be ended with a <code>Next</code> statement </li>\n<li>your <code>Then</code> must occur on the same line as your <code>If</code> to be valid and should be closed with an <code>End If</code> (unless you do a one-liner)</li>\n<li>You must test your conditions separately with an <code>AND</code> separating them</li>\n<li><code>Cell</code> is already a keyword here (subclass of a <code>Range</code>) so change that variable to <code>rngCell</code> or something different. </li>\n<li><code>Rows(\"1\")</code> would be better as an explicit range otherwise it will literally loop through every column in that row. That's a lot of columns.</li>\n</ol>\n\n<hr>\n\n<pre><code>Sub Macro1\n    Dim rngCell As Range\n    For Each rngCell In Range(\"A1:GZ1\").Cells\n        If rngCell.Value &lt;&gt;  \"order_number\" And rngCell.Value &lt;&gt;  \"tax_details\" AND rngCell.Value &lt;&gt; \"etc\" Then \n             rngCell.EntireColumn.delete\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "is_accepted": false, "score": 0, "last_activity_date": 1531948447, "creation_date": 1531948447, "answer_id": 51411071, "question_id": 51410984, "link": "https://stackoverflow.com/questions/51410984/vba-if-cells-do-not-equal-values-then-delete/51411071#51411071", "title": "vba if cells do not equal values then delete", "body": "<p>In order to test multiple conditions, you use logical operators(AND, OR, NOT, etc) to create a single logical statement(i.e. a single value for all 3). If you want any of the conditions to work, use \"or\" and if you need all 3 conditions to be met, use AND. </p>\n\n<pre><code>If cell.Value &lt;&gt;  \"order_number\", \"tax_details\", \"etc\"\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>If cell.Value &lt;&gt; \"order_number\" OR cell.value &lt;&gt; \"tax_details\"  OR cell.value &lt;&gt; \"etc\" then\n</code></pre>\n\n<p>To delete the entire column that way, you'd need to reference which column you're trying to delete. If you're iterating over the rows, you'd access it by</p>\n\n<pre><code>Cell.EntireColumn.delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9968202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bsQxxtscUbw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BueFGGT1eWJ28R3pitrFZtGd91w/mo/photo.jpg?sz=128", "display_name": "Justin Horne", "link": "https://stackoverflow.com/users/9968202/justin-horne"}, "edited": false, "score": 0, "creation_date": 1532009043, "post_id": 51411249, "comment_id": 89820367, "body": "trying to under the syntax of the &quot;For&quot; line. Why did you use &quot;end(xltoleft).column instead of &quot;end(xltoright)&quot;? If you&#39;re stepping backward wouldn&#39;t your beginning column need to be the last one? Or am I missing something? Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21, "user_id": 9968202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bsQxxtscUbw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BueFGGT1eWJ28R3pitrFZtGd91w/mo/photo.jpg?sz=128", "display_name": "Justin Horne", "link": "https://stackoverflow.com/users/9968202/justin-horne"}, "edited": false, "score": 0, "creation_date": 1532026208, "post_id": 51411249, "comment_id": 89830805, "body": "I don&#39;t start from A1 and look right. I start at XFD1 (.cells(1, <b>.columns.count</b>)) and look left. Much more reliable in all situations."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1531949411, "creation_date": 1531949411, "answer_id": 51411249, "question_id": 51410984, "link": "https://stackoverflow.com/questions/51410984/vba-if-cells-do-not-equal-values-then-delete/51411249#51411249", "title": "vba if cells do not equal values then delete", "body": "<p>No other response seems to be addressing the fact that you looping left-to-right while deleting columns. Delete rows from bottom to top and delete columns from right to left or you risk skipping over cells/columns.</p>\n\n<pre><code>Sub Macro1\n    Dim i as long\n\n    with worksheets(\"sheet1\")\n        For i=.cells(1, .columns.count).end(xltoleft).column to 1 step-1\n            select case lcase(.cells(1, i).value)\n                case \"order_number\", \"tax_details\", \"etc\"\n                    'do nothing\n                case else\n                    .columns(i).entirecolumn.delete\n            end select\n        next i\n    end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9968202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bsQxxtscUbw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1BueFGGT1eWJ28R3pitrFZtGd91w/mo/photo.jpg?sz=128", "display_name": "Justin Horne", "link": "https://stackoverflow.com/users/9968202/justin-horne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7641, "favorite_count": 0, "accepted_answer_id": 51411249, "answer_count": 4, "score": 1, "last_activity_date": 1532006863, "creation_date": 1531947958, "last_edit_date": 1532006863, "question_id": 51410984, "link": "https://stackoverflow.com/questions/51410984/vba-if-cells-do-not-equal-values-then-delete", "title": "vba if cells do not equal values then delete", "body": "<p>I'm fairly new to VBA and I can't seem to figure this one out through google.</p>\n\n<p>I'm trying to run through a worksheet and use an If statement to delete unnecessary columns, based on their row 1 values. I'm trying to do it like this:</p>\n\n<pre><code>    Sub Macro1\n    Dim cell As Range\n    For Each cell In Rows(\"1\")\n    If cell.Value &lt;&gt;  \"order_number\", \"tax_details\", \"etc\"\n    Then .EntireColumn.delete\n    End Sub\n</code></pre>\n\n<p>But I can't seem to figure out how to use the \"If cell.Value\" statement with multiple values, nor how to delete the columns that I don't want. Any help is much appreciated. </p>\n\n<p>Cheers, </p>\n\n<p>Justin</p>\n\n<p>Edit: Thanks for all the responses guys, everything was super helpful. Fixed the problem and I learned a lot.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1531947817, "post_id": 51410926, "comment_id": 89793383, "body": "Is there no other information with that error?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531948557, "post_id": 51410926, "comment_id": 89793677, "body": "I don&#39;t know why this question was marked as a duplicate, since the issue here is <i>not</i> because OP needs <code>Set</code> - it&#39;s an <code>AutoFilter</code> associated error."}, {"owner": {"reputation": 1, "user_id": 10101709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bqmU82FeeJ0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oat78jO_kvSwg8y8uyV9emk5KMfg/mo/photo.jpg?sz=128", "display_name": "Marco Levy", "link": "https://stackoverflow.com/users/10101709/marco-levy"}, "edited": false, "score": 0, "creation_date": 1531948684, "post_id": 51410926, "comment_id": 89793724, "body": "Yes the error says Run-time error &#39;91&#39;: Object variable or With block variable not set"}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1531949700, "creation_date": 1531949700, "answer_id": 51411299, "question_id": 51410926, "link": "https://stackoverflow.com/questions/51410926/run-time-error-91/51411299#51411299", "title": "Run-time error &#39;91&#39;", "body": "<p>You will get that error when there is no <code>AutoFilter</code> set on the sheet.  To handle that wrap you code if a test for presence of the filter, this this</p>\n\n<pre><code>If ActiveWorkbook.Worksheets(\"Celine HB\").AutoFilterMode Then\n    ' your code\nElse\n    'No Filter set, what now?\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10101709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bqmU82FeeJ0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oat78jO_kvSwg8y8uyV9emk5KMfg/mo/photo.jpg?sz=128", "display_name": "Marco Levy", "link": "https://stackoverflow.com/users/10101709/marco-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1531990513, "answer_count": 1, "score": -1, "last_activity_date": 1531949700, "creation_date": 1531947721, "question_id": 51410926, "link": "https://stackoverflow.com/questions/51410926/run-time-error-91", "closed_reason": "Not suitable for this site", "title": "Run-time error &#39;91&#39;", "body": "<p>I recorded a macro with subtotals and when i run it this is the error i am getting.  The error is associated with the first line </p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Celine HB\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Celine HB\").AutoFilter.Sort.SortFields.Add Key:= _\n        Range(\"E1:E301\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _\n        :=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Celine HB\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1531945640, "post_id": 51410376, "comment_id": 89792391, "body": "Share the code what you have tried until now."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1531946915, "post_id": 51410376, "comment_id": 89792957, "body": "What does &#39;without success&#39; mean - error message, wrong results, nothing happens? What effort have you done to debug? You need to describe specific issue, not just post code asking &#39;what is wrong&#39;. Review code from this site for examples <a href=\"http://www.accessmvp.com/KDSnell/EXCEL_MainPage.htm\" rel=\"nofollow noreferrer\">accessmvp.com/KDSnell/EXCEL_MainPage.htm</a>"}, {"owner": {"reputation": 19, "user_id": 10101740, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156614529818530/picture?type=large", "display_name": "Mecredes BZ", "link": "https://stackoverflow.com/users/10101740/mecredes-bz"}, "edited": false, "score": 0, "creation_date": 1532012456, "post_id": 51410376, "comment_id": 89822888, "body": "With the code above, I am able to get the data the way I want into the clipboard but I cannot figure out how to get it from the clipboard into my access table."}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1531956082, "creation_date": 1531956082, "answer_id": 51412253, "question_id": 51410376, "link": "https://stackoverflow.com/questions/51410376/how-can-i-set-up-a-button-to-add-transform-data-from-the-clipboard/51412253#51412253", "title": "How can I set up a button to add &amp; transform data from the clipboard?", "body": "<p>Changing to a monospaced font reveals that data is transposed into 4 space delimited columns.   </p>\n\n<p><a href=\"https://i.stack.imgur.com/HZ4CJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HZ4CJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Using <code>Range.TextToColumns()</code> to split and <code>WorksheetFunction.Transpose(.UsedRange.Value)</code> to transpose the data, we get a standard table with 11 columns by 3 rows.</p>\n\n<pre><code>+------------------------+--------------+-------------------+-------------------------+-----------+-----------------------+---------------------------+-----------------------------+-------------------------------+----------------------------+----------------+---------------------------+---------------------+--------------------------+-----------------------+------------------------+---------------------+----------------------+-----------------------+-------------------------+-----------------+-----------------------+-----------------+------------------------+----------------------+------------------+---------------+-------------------------+-----------------+----------------------+------------------------+-------------------+----------------------+----------------------+---------------+---------------+--------------+\n|       Component        | Color, Urine | Appearance, Urine | Specific Gravity, Urine | Urine pH  | Protein Semiquant, UA | Glucose, Urine, Semiquant | Ketones, Urine, Qualitative | Bilirubin, Urine, Qualitative | Hemoglobin Pigments, Urine | Nitrite, Urine | Leukocyte Esterase, Urine | Urobilinogen, Urine | White Blood Cells, Urine | White Blood Cells, UA | Red Blood Cells, Urine | Red Blood Cells, UA | Hyaline Casts, Urine | Granular Casts, Urine | Epithelial Cells, Urine | Bacteria, Urine | Mucous Threads, Urine | Crystals, Urine | White Blood Cell Count | Red Blood Cell Count |    Hemoglobin    |  Hematocrit   | Mean Corpuscular Volume | Mean Corpus Hgb | Mean Corpus Hgb Conc | RBC Distribution Width |  Platelet Count   | Mean Platelet Volume | Nucleated RBC Number | Neutrophil %  | Lymphocytes % |  Monocyte %  |\n+------------------------+--------------+-------------------+-------------------------+-----------+-----------------------+---------------------------+-----------------------------+-------------------------------+----------------------------+----------------+---------------------------+---------------------+--------------------------+-----------------------+------------------------+---------------------+----------------------+-----------------------+-------------------------+-----------------+-----------------------+-----------------+------------------------+----------------------+------------------+---------------+-------------------------+-----------------+----------------------+------------------------+-------------------+----------------------+----------------------+---------------+---------------+--------------+\n| Latest Ref Rng &amp; Units |              |                   | 1.003 - 1.030           | 4.6 - 8.0 | Negative              | Negative mg/dL            | Negative                    | Negative                      | Negative                   | Negative       | Negative                  | 0.2 - 1.0 mg/dL     | 0 - 5 /[HPF]             | 0 - 27 /uL            | 0 - 5 /[HPF]           | 0 - 27 /uL          | 0 - 1 /[LPF]         | None seen /[LPF]      | /[HPF]                  | None-few /[HPF] | None-few /[LPF]       | None-few /[HPF] | 4.50 - 11.00 K/cu mm   | 4.00 - 5.20 M/cu mm  | 12.0 - 15.0 g/dL | 36.0 - 46.0 % | 80.0 - 100.0 fL         | 26.0 - 34.0 pg  | 31.0 - 37.0 g/dL     | 11.5 - 14.5 %          | 150 - 350 K/cu mm | 9.2 - 12.7 fL        | 0.00 - 0.01 K/cu mm  | 40.0 - 70.0 % | 24.0 - 44.0 % | 2.0 - 11.0 % |\n| 12/19/2016             | Yellow       | Clear             | 1.012                   | 6         | Negative              | Negative                  | Negative                    | Negative                      | Small (A)                  | Negative       | Moderate (A)              | &lt;=1.0               | 0                        | 1                     | 1                      | 3                   | 0                    | 0                     | &lt;1                      | None            | Rare                  | None            |                        |                      |                  |               |                         |                 |                      |                        |                   |                      |                      |               |               |              |\n| 1/24/2017              |              |                   |                         |           |                       |                           |                             |                               |                            |                |                           |                     |                          |                       |                        |                     |                      |                       |                         |                 |                       |                 | 1.82 (L)               | 4.71                 | 12.6             | 39.3          | 83.4                    | 26.8            | 32.1                 | 13.1                   | 165               | 12.5                 | 0                    | 42.4          | 37.9          | 16.5 (H)     |\n|                        |              |                   |                         |           |                       |                           |                             |                               |                            |                |                           |                     |                          |                       |                        |                     |                      |                       |                         |                 |                       |                 |                        |                      |                  |               |                         |                 |                      |                        |                   |                      |                      |               |               |              |\n|                        |              |                   |                         |           |                       |                           |                             |                               |                            |                |                           |                     |                          |                       |                        |                     |                      |                       |                         |                 |                       |                 |                        |                      |                  |               |                         |                 |                      |                        |                   |                      |                      |               |               |              |\n+------------------------+--------------+-------------------+-------------------------+-----------+-----------------------+---------------------------+-----------------------------+-------------------------------+----------------------------+----------------+---------------------------+---------------------+--------------------------+-----------------------+------------------------+---------------------+----------------------+-----------------------+-------------------------+-----------------+-----------------------+-----------------+------------------------+----------------------+------------------+---------------+-------------------------+-----------------+----------------------+------------------------+-------------------+----------------------+----------------------+---------------+---------------+--------------+\n</code></pre>\n\n<h2>Code</h2>\n\n<pre><code>Sub RealignData()\n    Dim data As Variant\n    With Worksheets(\"Sheet1\")\n\n        .UsedRange.TextToColumns Destination:=.Range(\"A1\"), DataType:=xlFixedWidth, FieldInfo:=Array(Array(0, 1), Array(79, 1), Array(128, 1), Array(154, 1)), TrailingMinusNumbers:=True\n        data = WorksheetFunction.Transpose(.UsedRange.Value)\n        .UsedRange.ClearContents\n        Range(\"A1\").Resize(UBound(data), UBound(data, 2)).Value = data\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>This should make the data easier to work with.  As far as getting it into Access there are better way then copy and paste.  I recommend learning how to use <code>Adodb.Recordset.AddNew</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 10101740, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156614529818530/picture?type=large", "display_name": "Mecredes BZ", "link": "https://stackoverflow.com/users/10101740/mecredes-bz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532014156, "creation_date": 1531945205, "last_edit_date": 1532014156, "question_id": 51410376, "link": "https://stackoverflow.com/questions/51410376/how-can-i-set-up-a-button-to-add-transform-data-from-the-clipboard", "title": "How can I set up a button to add &amp; transform data from the clipboard?", "body": "<p>I am trying to create a button on an access form that would copy the information of an excel file, and paste it into an access table that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xR6Op.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xR6Op.png\" alt=\"enter image description here\"></a></p>\n\n<p>An example excel file I'm trying to paste from is \n<a href=\"https://sss2018.wixsite.com/accessquestion\" rel=\"nofollow noreferrer\">here on this site</a> (click the excel icon).</p>\n\n<p>The problem is that the format on the data of the excel file is completely off, it doesn't align with how I set up my data labels on the Access table. What I want to do is select the Excel data and copy it, then in access use a button that, on click, gets the information from the clipboard, arranges the rows, eliminates extra spaces and arranges columns etc, and puts the information on the Access table in an orderly manner.</p>\n\n<p>I just started learning vba and I have been trying everything I can think of for days now without success, meaning that I am able to get the data in the way I want to into the clipboard but I cannot get it from the clipboard into the access able. \nPlease help! Thank you!</p>\n\n<p>Code I have so far</p>\n\n<pre><code>Sub cmdCopy_Click()\nDim objData As New MSForms.DataObject\n\nDim strText As String\nDim i As Long\nDim j As Long\nDim k As Long\nDim m As Long\nDim ComponentNumber As Integer\nDim ComponentText As String\nDim ComponentBlock(100) As Long\nDim ComponentContent(100) As String\nDim ComponentCount As Integer\nDim ComponentStart As Long\nDim ComponentEnd As Long \nDim ComponentLength As Integer\nDim SearchChar As String\nDim Component(100, 2) As Long\nDim LineArray(8000) As String\nDim labname As Integer\nDim TestString As String\nDim ReferenceRangeStart As Integer\nDim Position As String\nDim ColumnDatePosition(6) As Integer\nDim ColumnDateCount As Integer\nDim ComponentBlockLength As Long\nDim PreliminaryArray(10000, 10) As Variant\nComponentCount = 0\n'get text from Clipboard\nobjData.GetFromClipboard\nstrText = objData.GetText()\n ' replace double empty lines with single\nStrLength = Len(strText)\nstrText = Replace(strText, Chr(13) &amp; Chr(10) &amp; Chr(13) &amp; Chr(10), Chr(13) &amp; \nChr(10))\nFor i = 10 To StrLength\nIf Mid(strText, i, 9) = \"Component\" Then\nComponentBlock(ComponentCount) = i\nComponentCount = ComponentCount + 1\ni = i + 9\nEnd If\nNext i\n ' separate clipboard into component blocks\nComponentStart = 1\nFor i = 0 To ComponentCount - 1\nComponentContent(i) = Mid(strText, ComponentStart, ComponentBlock(i) - ComponentStart)\nComponentStart = ComponentBlock(i)\nNext i\nTotalBlocks = i - 1\n' determine column spacing\nSearchChar = Chr(13) &amp; Chr(10)\nArrayLength = 0\nFor k = 0 To TotalBlocks\nNext k\nComponentLength = InStr(ComponentContent(k), SearchChar) + 1\n'Determine where Reference Range starts\nReferenceRangeStart = InStr(1, ComponentContent(k), \"Latest\")\n'Determine position of each date column\nColumnDateCount = 0\nFor m = 0 To 6\nColumnDatePosition(m) = 0\nNext m\nComponentLength = InStr(ComponentContent(k), SearchChar) + 1\n'Determine where Reference Range starts\nReferenceRangeStart = InStr(1, ComponentContent(k), \"Latest\")\n'Determine position of each date column\nColumnDateCount = 0\n\nFor i = ReferenceRangeStart + 7 To ComponentLength - 10\nPosition = Mid(ComponentContent(k), i, 6)\nIf Position Like \"##/##/\" Then\nColumnDatePosition(ColumnDateCount) = i\ni = i + 6\nColumnDateCount = ColumnDateCount + 1\nEnd If\nIf Position Like \"#/##/#\" Then\nColumnDatePosition(ColumnDateCount) = i\ni = i + 6\nColumnDateCount = ColumnDateCount + 1\nEnd If\nIf Position Like \"#/#/##\" Then\nColumnDatePosition(ColumnDateCount) = i\ni = i + 6\nColumnDateCount = ColumnDateCount + 1\nEnd If\nIf Position Like \"##/#/#\" Then\nColumnDatePosition(ColumnDateCount) = i\ni = i + 6\nColumnDateCount = ColumnDateCount + 1\nEnd If\n   Next i\n'Debug.Print ColumnDatePosition(0), ColumnDatePosition(1), ColumnDatePosition(2), ColumnDatePosition(3), ColumnDatePosition(4), ColumnDatePosition(5)\n'Length of component line is ComponentLength\n'Reference Range starts at ReferenceRangeStart\n'ColumnDateCount indicates how many date columns of labs are present\n'ColumnDatePosition(ColumnDateCount) stores the date positions\n'ComponentContent(ComponentCount) represents the text block for each component block\n'Mid(ComponentContent(0), ColumnDatePosition(1), 10), Mid(ComponentContent(0), ColumnDatePosition(2), 10), Mid(ComponentContent(0), ColumnDatePosition(3), 10)\n\nLineLength = Len(ComponentContent(k)) / ComponentLength\nFor i = 1 To LineLength\nIf Mid(ComponentContent(k), (i - 1) * ComponentLength + 1, 9) &lt;&gt; \"Component\" \nAnd Not Asc(Mid(ComponentContent(k), (i - 1) * ComponentLength + 1, 1)) = 32 \nThen\n        j = 0\n        Do While ColumnDatePosition(j + 1) &gt; 0\n        If Asc(Mid(ComponentContent(k), ColumnDatePosition(j) + (i - 1) * ComponentLength, 1)) &lt;&gt; 32 Then\n            'ArrayLength,0 is component(lab name)\n            PreliminaryArray(ArrayLength, 0) = Mid(ComponentContent(k), (i - 1) * ComponentLength + 1, ReferenceRangeStart - 1)\n            DateLength = ColumnDatePosition(j + 1) - ColumnDatePosition(j)\n            ReferenceLength = ColumnDatePosition(0) - ReferenceRangeStart\n            'ArrayLength,1 is reference range\n            PreliminaryArray(ArrayLength, 1) = Mid(ComponentContent(k), ReferenceRangeStart + (i - 1) * ComponentLength, ReferenceLength)\n            'ArrayLength,2 is date\n            PreliminaryArray(ArrayLength, 2) = Mid(ComponentContent(k), ColumnDatePosition(j), 10)\n            PreliminaryArray(ArrayLength, 2) = CDate(PreliminaryArray(ArrayLength, 2))\n            'ArrayLength,3 is lab value\n            PreliminaryArray(ArrayLength, 3) = Mid(ComponentContent(k), ColumnDatePosition(j) + (i - 1) * ComponentLength, DateLength)\n            ArrayLength = ArrayLength + 1\n        End If\n        j = j + 1\n        Loop\n        If Asc(Mid(ComponentContent(k), ColumnDatePosition(j) + (i - 1) * ComponentLength, 1)) &lt;&gt; 32 Then\n        PreliminaryArray(ArrayLength, 0) = Mid(ComponentContent(k), (i - 1) * ComponentLength + 1, ReferenceRangeStart - 1)\n        PreliminaryArray(ArrayLength, 1) = Mid(ComponentContent(k), ReferenceRangeStart + (i - 1) * ComponentLength, ColumnDatePosition(0) - ReferenceRangeStart)\n        PreliminaryArray(ArrayLength, 2) = Mid(ComponentContent(k), ColumnDatePosition(j), 10)\n        PreliminaryArray(ArrayLength, 2) = CDate(PreliminaryArray(ArrayLength, 2))\n        PreliminaryArray(ArrayLength, 3) = Mid(ComponentContent(k), ColumnDatePosition(j) + (i - 1) * ComponentLength, ComponentLength - ColumnDatePosition(j) - 2)\n        ArrayLength = ArrayLength + 1\n        End If\nEnd If\n</code></pre>\n\n<p>Next i</p>\n"}, {"tags": ["vba", "ms-word", "arguments"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1531946851, "creation_date": 1531946851, "answer_id": 51410755, "question_id": 51410218, "link": "https://stackoverflow.com/questions/51410218/acceptable-arguments-in-vba/51410755#51410755", "title": "Acceptable Arguments in VBA", "body": "<p>Only an individual index value (number) is a valid argument for the <code>Sections</code> collection. You can affect only one <code>Section</code> at a time for working with a Header/Footer.</p>\n\n<p>In order to make your code a bit less verbose - so you wouldn't have to write out the code for every section - you could create an array of the section index numbers, then use <code>For...Next</code> to affect each Footer you want to change.</p>\n\n<p>Or you could put the code for modifying a Footer in a separate procedure (<code>Sub</code>) and call it for each section.</p>\n"}], "owner": {"reputation": 3, "user_id": 9509514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "rdavid", "link": "https://stackoverflow.com/users/9509514/rdavid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 51410755, "answer_count": 1, "score": 0, "last_activity_date": 1593731002, "creation_date": 1531944500, "last_edit_date": 1593731002, "question_id": 51410218, "link": "https://stackoverflow.com/questions/51410218/acceptable-arguments-in-vba", "title": "Acceptable Arguments in VBA", "body": "<p>In VBA: If I am writing any code similar to the below:</p>\n\n<pre><code>With ActiveDocument.Sections(1) \n .Footers(wdHeaderFooterPrimary).PageNumbers.Add _ \n PageNumberAlignment:=wdAlignPageNumberLeft, _ \n FirstPage:=True \nEnd With\n</code></pre>\n\n<p>For the \".Sections()\" part on the first line...what are acceptable arguments to put in the ()? \nI am trying to have the code affect multiple sections (not just Section 1). Do I need to use Range somehow or is there another way?\nthx</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531944628, "post_id": 51410158, "comment_id": 89791906, "body": "Is this question different from the prior one that looked very similar? Where does the type mismatch occur? You also have left screen-updating off and not included the function which you call."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531944653, "post_id": 51410158, "comment_id": 89791913, "body": "@QHarr , yes xD . I guess I could update that one."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1531951926, "post_id": 51410158, "comment_id": 89795018, "body": "Where does the type mismatch occur? Where can we find sample data? These are essential in order to solve the problem. Next time include those right away please."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1531954925, "post_id": 51410158, "comment_id": 89795822, "body": "@Luuklag , type mismatch doesnt occur in this code. Just thought someone may have experience with a problem column."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1531955061, "post_id": 51410158, "comment_id": 89795856, "body": "Then please edit your question to avoid the confusion."}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594210266, "creation_date": 1531944179, "last_edit_date": 1594210266, "question_id": 51410158, "link": "https://stackoverflow.com/questions/51410158/vba-formatting-unknown-issue-causing-vba-to-not-work", "title": "VBA, formatting/unknown issue causing vba to not work", "body": "<p>1) My vba copies and pastes columns from sheet a to sheet b (a table) . </p>\n\n<p>2) My next vba code is ran ontop of this table and I get an error.</p>\n\n<p>However if I copy and paste the problem header and data manually from sheet A to Sheet B my macro(2) will work.</p>\n\n<p>Also I should mention this particular column causing the problem is a column with dates. But I have tried both formats, general and date, ive tried using a formula (=SheetA!BU1:) and pasted down into sheet 2, and I've tried a macro to copy and paste the one column.. nothing works!</p>\n\n<p>Not sure if it is my code, table, format, etc. </p>\n\n<p>Here is my copy and paste macro, the type mismatch does not occur here but in my other code that is not included.</p>\n\n<pre><code>Sub importtodatabase(from_ws, to_ws)\n    Dim rng As Range, trgtCell As Range\n    Dim src As Worksheet\n    Dim trgt As Worksheet\n    Set src = Worksheets(from_ws)\n    Set trgt = Worksheets(to_ws)\n    Dim row_num As Integer\n    Dim Max_row_data As Integer\n    Dim source_tab As String\n    Application.ScreenUpdating = False\n\n    Sheets(to_ws).Select\n    Max_row_data = get_max_row(\"\")\n\n    If Max_row_data &lt;&gt; 2 Then\n        Max_row_data = Max_row_data + 1\n    End If\n\n    Sheets(\"Mappings\").Select\n    max_row = get_max_row(\"\")\n\n\n    With src\n        For Each rng In Intersect(.Rows(1), .UsedRange).SpecialCells(xlCellTypeConstants)\n            For row_num = 2 To max_row\n                If from_ws = Range(\"BU\" &amp; row_num).value Then\n                    If rng = Range(\"BV\" &amp; row_num).value Then\n                        rng = Range(\"BW\" &amp; row_num).value\n                        Exit For\n                    End If\n                End If\n            Next row_num\n\n            Set trgtCell = trgt.Rows(1).Find(rng.value, LookIn:=xlValues, lookat:=xlWhole)\n\n            'If .Range(rng.Offset(1), .Cells(ws.Rows.Count, \"A\").End(xlUp).row\n\n                If Not trgtCell Is Nothing Then\n                    .Range(rng.Offset(1), .Cells(.Rows.count, rng.Column).End(xlUp)).copy\n                    With trgt\n                        .Cells(Max_row_data, trgtCell.Column).PasteSpecial xlPasteValues\n                    End With\n                End If\n            'End If\n        Next rng\n    End With\n    Application.ScreenUpdating = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531945640, "post_id": 51410020, "comment_id": 89792393, "body": "&quot;excel-vba-mac&quot; tag based on your screenshots. On each lab schedule sheet, are the most recent dates in the same range (C12:E12)?"}, {"owner": {"reputation": 1, "user_id": 10101545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad100498ef103e9fead5ea76c3b2367?s=128&d=identicon&r=PG&f=1", "display_name": "CJ17", "link": "https://stackoverflow.com/users/10101545/cj17"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531946748, "post_id": 51410020, "comment_id": 89792868, "body": "Ahh yes, I&#39;ve had to make a example sheet on my personal laptop but the actual workbook will be on windows. Yes they are the most recent dates, I plan on hiding that row but it was the most simple way I could think of getting the most recent date for each column"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531946867, "post_id": 51410020, "comment_id": 89792932, "body": "But is the table on each schedule sheet in the same range? Maybe you can use <code>INDIRECT</code>."}, {"owner": {"reputation": 1, "user_id": 10101545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad100498ef103e9fead5ea76c3b2367?s=128&d=identicon&r=PG&f=1", "display_name": "CJ17", "link": "https://stackoverflow.com/users/10101545/cj17"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531947497, "post_id": 51410020, "comment_id": 89793232, "body": "Yes it is. I tried using indirect earlier but couldn&#39;t get it to link to the LabNo whenever I created a new sheet. Basically I want to create a button that will fetch/update the dates on the summary sheet for every LabNo/Schedule on it"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531947678, "post_id": 51410020, "comment_id": 89793319, "body": "What do you mean by &quot;link to the LabNo whenever I created a new sheet&quot;? Do you want VBA to list out all the Lab Schedules (L1234, etc.) on the Summary Sheet or are you typing those in manually? If you do the INDIRECT right you should be able to drag formulas down."}, {"owner": {"reputation": 1, "user_id": 10101545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad100498ef103e9fead5ea76c3b2367?s=128&d=identicon&r=PG&f=1", "display_name": "CJ17", "link": "https://stackoverflow.com/users/10101545/cj17"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531948076, "post_id": 51410020, "comment_id": 89793487, "body": "Oh I think I understand how I can use that now. I&#39;d insert new columns in the Summary sheet that would give the constant cell reference for the column headings within the Lab Schedules. Hopefully should work the way I want it to! Thanks for your help!"}], "owner": {"reputation": 1, "user_id": 10101545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad100498ef103e9fead5ea76c3b2367?s=128&d=identicon&r=PG&f=1", "display_name": "CJ17", "link": "https://stackoverflow.com/users/10101545/cj17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594031054, "creation_date": 1531943529, "last_edit_date": 1594031054, "question_id": 51410020, "link": "https://stackoverflow.com/questions/51410020/pull-dates-from-undefined-number-of-sheets-to-summary-sheet-matching-the-sheet-n", "title": "Pull dates from undefined number of sheets to Summary sheet matching the sheet name to the data", "body": "<p>I'm creating a spreadsheet for work that compiles all of our lab schedules for any given job. The spreadsheet consists of a summary sheet that will give the important information from every lab schedule, and a sheet for every single lab schedule. We could get a variable number of these lab schedules in for a given job so we could be working with 2 sheets or 10 sheets (not including the summary sheet), etc. Hopefully that gives you a bit of an insight into what we need it for.</p>\n<p>I've been trying to patch together a code to pull the dates from every lab schedule sheet through to the summary sheet. The dates would need to go into a table matching both the column heading (i.e. Due Date, Received Date, etc) and the 'Lab No'(also the name of the tabs i.e. L1234). With regards to the dates, ignore the 'Geo, Chem, Wac' as I've taken the most recent date out of the three and put that below them. I've attached a few images of the workbook so you can see what sort of structure I've got.</p>\n<p>Lab Schedule Sheet:</p>\n<p><img src=\"https://i.stack.imgur.com/Cdy70.png\" alt=\"Lab Schedule Sheet\" /></p>\n<p>Summary Sheet:</p>\n<p><img src=\"https://i.stack.imgur.com/yXTTx.png\" alt=\"Summary Sheet\" /></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8685931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214598844466424/picture?type=large", "display_name": "Irina", "link": "https://stackoverflow.com/users/8685931/irina"}, "edited": false, "score": 0, "creation_date": 1531951870, "post_id": 51410329, "comment_id": 89794999, "body": "That worked wonders, thanks!  I have another issue with the same data now though,  instead of finding first instance of a string, I need to find a last instance of that string, and then continue finding those unique values, then I need to copy data from adjacent columns in the row above, and paste in the row below, continuing in that fashion down the list. In this example I would concatenate columns A,B and C, find last value that matches, and then copy down the data from row above. Sample data attached:"}, {"owner": {"reputation": 17, "user_id": 8685931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214598844466424/picture?type=large", "display_name": "Irina", "link": "https://stackoverflow.com/users/8685931/irina"}, "edited": false, "score": 0, "creation_date": 1531952856, "post_id": 51410329, "comment_id": 89795267, "body": "Country\tCurrency\tTerm (in Months)\t5\t6\t7 Austria\tEUR\t12\t11.59\t12.75\t14.04 Austria\tEUR\t12\t11.59\t12.75\t14.04 Austria\tEUR\t12\t7.61\t9.34\t10.5 Austria\tEUR\t12\t7.38\t9.23\t10.27 Austria\tEUR\t12\tnull\tnull\tnull Austria\tEUR\t24\t8.3\t9.37\t10.55 Austria\tEUR\t24\t4.91\t5.77\t6.68 Austria\tEUR\t24\t4.8\t5.66\t6.57 Austria\tEUR\t24\tnull\tnull\tnull"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 17, "user_id": 8685931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214598844466424/picture?type=large", "display_name": "Irina", "link": "https://stackoverflow.com/users/8685931/irina"}, "edited": false, "score": 0, "creation_date": 1531955516, "post_id": 51410329, "comment_id": 89795984, "body": "If you have a new scenario, it&#39;s best to open a new question and explain the issue there :)"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1531944982, "creation_date": 1531944982, "answer_id": 51410329, "question_id": 51409969, "link": "https://stackoverflow.com/questions/51409969/excel-vba-find-first-position-of-unique-value-copy-values-from-row-below-and-pa/51410329#51410329", "title": "excel vba find first position of unique value, copy values from row below and paste in row above", "body": "<p>Not the cleanest solution, but a solution.</p>\n\n<p>Create a concatenated value of columns A &amp; B, then after taking care of the first row, we move down the rows to find the next unique value. Note - this is only set for 20 rows of data at the moment. You'll need <code>lastrow</code> to make this dynamic.</p>\n\n<pre><code>Sub Test()\n\nDim myuniquevalue As String, nextvalue As String\n\nmyuniquevalue = Cells(2, 1).Value &amp; Cells(2, 2).Value\nRange(Cells(2, 3), Cells(2, 5)).Value = Range(Cells(3, 3), Cells(3, 5)).Value\n\nFor i = 2 To 20\n    nextvalue = Cells(i, 1).Value &amp; Cells(i, 2).Value\n\n    If myuniquevalue &lt;&gt; nextvalue Then\n        myuniquevalue = nextvalue\n        Range(Cells(i, 3), Cells(i, 5)).Value = Range(Cells(i + 1, 3), Cells(i + 1, 5)).Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Kzcqa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kzcqa.png\" alt=\"img1\"></a></p>\n"}], "owner": {"reputation": 17, "user_id": 8685931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214598844466424/picture?type=large", "display_name": "Irina", "link": "https://stackoverflow.com/users/8685931/irina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531944982, "creation_date": 1531943326, "last_edit_date": 1531944818, "question_id": 51409969, "link": "https://stackoverflow.com/questions/51409969/excel-vba-find-first-position-of-unique-value-copy-values-from-row-below-and-pa", "title": "excel vba find first position of unique value, copy values from row below and paste in row above", "body": "<p>I've looked all over but haven't found an answer yet.  I have a set of data where I need to find a first unique value concatenated in column A and B, then move over to row below, copy information from column C:E, and paste it in row above.  Then repeat for next unique value.  </p>\n\n<p>I can probably figure out the copy and paste part, but haven't figured out how to find each unique value and it's position.  </p>\n\n<p>Below is the sample of data.  So basically I need to find first AustriaEUR, move to next row, copy to values from column 1,2, and 3, and paste in row above, then move on to Australia, etc.  </p>\n\n<pre><code>Country     Currency    1       2       3\nAustria     EUR         null    null    null\nAustria     EUR         8.16    8.39    8.73\nAustria     EUR         7.94    8.16    8.5\nAustria     EUR         7.26    7.49    7.83\nAustria     EUR         6.24    6.47    7.06\nAustralia   AUD         null    null    null\nAustralia   AUD         8.37    8.59    8.93\nAustralia   AUD         8.14    8.37    8.71\nAustralia   AUD         7.46    7.69    8.03\nAustralia   AUD         7.35    7.58    7.91\nAustralia   AUD         6.47    6.53    6.61\nBelgium     EUR         null    null    null\nBelgium     EUR         8.16    8.39    8.73\nBelgium     EUR         7.94    8.16    8.5\nBelgium     EUR         7.26    7.49    7.83\nBelgium     EUR         6.24    6.47    7.06\nBelgium     EUR         4.87    5.1     5.43\nBelgium     EUR         4.15    4.37    4.71\nBelgium     EUR         3.93    4.15    4.48\n</code></pre>\n\n<p>Any help would be greatly appreciated.  </p>\n"}, {"tags": ["vba", "outlook", "user-input", "mailitem"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531947584, "post_id": 51409358, "comment_id": 89793273, "body": "<a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">xyproblem.info</a> Appears you want to reference an active or selected item."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10101460, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RQ43T9ZpEdo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rHVCexat6lWn9asRSfjn85D9L_9Q/mo/photo.jpg?sz=128", "display_name": "Jorge_JP", "link": "https://stackoverflow.com/users/10101460/jorge-jp"}, "is_accepted": false, "score": 0, "last_activity_date": 1532094910, "creation_date": 1532094910, "answer_id": 51444140, "question_id": 51409358, "link": "https://stackoverflow.com/questions/51409358/outlook-vba-how-to-get-email-item-from-user-input/51444140#51444140", "title": "Outlook VBA - How to get email item from user input", "body": "<p>I figured that working with Active MailItem is the way to go, as @niton suggested as well. I used a coding very similar to the one in <a href=\"http://www.outlookcode.com/codedetail.aspx?id=50\" rel=\"nofollow noreferrer\">this post</a>, although I had to develop the handlers in case the user has other types of Objects active at the moment (AppointmentItems, for instance) or have multiple items selected. Final solution wasn't that much elegant - I was wishing for some sort of system input box where the user could point to the mail or something, but this works.</p>\n"}], "owner": {"reputation": 1, "user_id": 10101460, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RQ43T9ZpEdo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rHVCexat6lWn9asRSfjn85D9L_9Q/mo/photo.jpg?sz=128", "display_name": "Jorge_JP", "link": "https://stackoverflow.com/users/10101460/jorge-jp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532094910, "creation_date": 1531940804, "question_id": 51409358, "link": "https://stackoverflow.com/questions/51409358/outlook-vba-how-to-get-email-item-from-user-input", "title": "Outlook VBA - How to get email item from user input", "body": "<p>Although Im quite experienced with Excel VBA, Im not so much in regards of Outlook VBA (started yesterday, literally), so Im uncertain on how to get this simple task accomplished:</p>\n\n<p>I created some coding to get a specific e-mail from the Inbox and then parse it and forward - that part is all good and well. Currently the code autodetects and retrieve the e-mail item using a set of parameters to filter through the Inbox. However, now I need to expand this code so that it can work with <em>any</em> e-mail item, and not only with that specific e-mail. </p>\n\n<p><strong>My idea is to get the user to input which e-mail item he/she wants to parse and forward</strong>, instead of getting the code to look in a specific place. How can that be done? The user input methods that I use regularly are InputBox (which returns a string) and GetOpenFileName, none of them suitable to pointing to a mail item within Outlook. </p>\n\n<p>I thought about making the code work with the currently open e-mail item, but often the users have several e-mail items opened at once - forcing them to leave only one open for the code to work is not viable. Also, the code will be ran by people who have little to no IT expertise, so requesting things such as paths is also not an option. Is there any method for this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "edited": false, "score": 1, "creation_date": 1531940628, "post_id": 51409274, "comment_id": 89789969, "body": "You might want to include the code you have so it is easier to help you."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1531940941, "post_id": 51409274, "comment_id": 89790150, "body": "This question is probably better suited to SuperUser, but in order to add 8.5 hours to a date/time value, add <code>+(8.5&#47;24)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9285030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-slnlICjzrzY/AAAAAAAAAAI/AAAAAAAACx8/IBwbxt__AbA/photo.jpg?sz=128", "display_name": "Manish Madahar", "link": "https://stackoverflow.com/users/9285030/manish-madahar"}, "edited": false, "score": 0, "creation_date": 1531951817, "post_id": 51409390, "comment_id": 89794976, "body": "Thanks, I appreciate your help. I was able to figure it out."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1531940934, "creation_date": 1531940934, "answer_id": 51409390, "question_id": 51409274, "link": "https://stackoverflow.com/questions/51409274/macros-on-excel/51409390#51409390", "title": "Macros on Excel", "body": "<p>Try,</p>\n\n<pre><code>with worksheets(\"sheet1\").range(\"D4:D400\")\n    .formula = \"=c4+time(8, 30, 0)\"\n    'optionally revert the formulas to the returned values\n    '.value = .value\nend with\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1531940995, "creation_date": 1531940995, "answer_id": 51409405, "question_id": 51409274, "link": "https://stackoverflow.com/questions/51409274/macros-on-excel/51409405#51409405", "title": "Macros on Excel", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dateadd-function\" rel=\"nofollow noreferrer\"><code>dateAdd()</code></a> to do this:</p>\n\n<pre><code>Sub addtime()\n    For Each rngCell In Sheet1.Range(\"C1:C400\")\n        rngCell.Offset(, 1).Value = DateAdd(\"n\", 30, DateAdd(\"h\", 8, rngCell))\n    Next rngCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9285030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-slnlICjzrzY/AAAAAAAAAAI/AAAAAAAACx8/IBwbxt__AbA/photo.jpg?sz=128", "display_name": "Manish Madahar", "link": "https://stackoverflow.com/users/9285030/manish-madahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1531948499, "creation_date": 1531940487, "last_edit_date": 1531948499, "question_id": 51409274, "link": "https://stackoverflow.com/questions/51409274/macros-on-excel", "title": "Macros on Excel", "body": "<p>I need some help with macros in Excel. What I am trying to do is add 8 and 1/2 hours of time to range of cells. So, in one range of cells have different times like 7:00 AM or 3:30 PM and the cell next to it I would like to add 8 and 1/2 hour to it. I couldn't figure out how to add time using macros. I need it for range of cells. So add 8 and 1/2 hours to range(\"C4:C400\") and put the value to range(\"D4:D400\"). In range(\"C4:C400\") the value is 7:00 AM or 3:30 PM, so adding 8 and 1/2 hours to range(\"D4:D400\") would be 3:30 PM or 12:00 AM.</p>\n\n<p>I would really really appreciate if someone could help me with this. \nThanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1531942075, "creation_date": 1531942075, "answer_id": 51409669, "question_id": 51409108, "link": "https://stackoverflow.com/questions/51409108/select-variable-blank-cell-range-in-column-in-vba/51409669#51409669", "title": "Select variable blank cell range in column in VBA", "body": "<p>Try this. The pictures show the before and after so you can check if it's correct. You'll probably need to adjust the details for your precise set up.</p>\n\n<p>This uses SpecialCells to loop through the blank areas and concatenate the corresponding cells before deleting the Area (a contiguous block of empty cells).</p>\n\n<pre><code>Sub BlankCell()\n\nDim j As Long, s As String, r As Range\n\nWith Columns(\"C\").SpecialCells(xlCellTypeBlanks)\n    For j = .Areas.Count To 1 Step -1\n        For Each r In .Areas(j)\n            s = s &amp; r.Offset(, 1) &amp; vblf\n        Next r\n        .Areas(j)(1).Offset(-1, 2) = Trim(s)\n        s = vbNullString\n        .Areas(j).EntireRow.Delete\n    Next j\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>BEFORE</p>\n\n<p><a href=\"https://i.stack.imgur.com/wCxmH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wCxmH.png\" alt=\"enter image description here\"></a></p>\n\n<p>AFTER</p>\n\n<p><a href=\"https://i.stack.imgur.com/8t6Hn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8t6Hn.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10101401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cf6982d7d8c3e6d8542d13aa32aa23?s=128&d=identicon&r=PG&f=1", "display_name": "Kelsey", "link": "https://stackoverflow.com/users/10101401/kelsey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531942075, "creation_date": 1531939917, "last_edit_date": 1531941873, "question_id": 51409108, "link": "https://stackoverflow.com/questions/51409108/select-variable-blank-cell-range-in-column-in-vba", "title": "Select variable blank cell range in column in VBA", "body": "<p>I have a code that contains blank cells throughout a certain column. I want to be able to select the unknown length of only blank cells (offset 2 columns). I currently have multiple if statements that are filtered based on how many blanks, but the variable number of blanks could make this too complex.</p>\n\n<p>Example:\nWhen it encounters these two blanks (6 &amp; 7) I want to concatenate the contents, two columns to the right, of those rows (6 &amp; 7) and paste in the cell above and one column to the right of the revisions/comments/blanks (and then I delete the row(s) of revisions/comments, so here, 6 &amp; 7 get deleted). I have this part figured out, shown from picture <a href=\"https://i.stack.imgur.com/TjuLI.png\" rel=\"nofollow noreferrer\">1</a> to <a href=\"https://i.stack.imgur.com/GPtlO.png\" rel=\"nofollow noreferrer\">2</a>.</p>\n\n<p>These blank cells occur randomly throughout and are variable in length, sometimes there are no revisions/comments, sometimes two rows, five rows, etc...</p>\n\n<p>So rather than having many many if statements for how ever many rows are revisions/comments, I am looking for code that can select any variable length of blank cells and transfer that information all to one cell (the one directly to the right of the original line of information).</p>\n\n<p>Here is the part of my code that does this so far:</p>\n\n<pre><code>Sub BlankCell()\n\n'Delete all header rows (except top row)\nDim i, LastRow As Integer\ni = 2\nLastRow = Cells.SpecialCells(xlCellTypeLastCell).Row\nDo While i &lt;= LastRow\n    If Cells(i, 2).Value = \"Line\" Then\n        Rows(i).EntireRow.Delete\n    End If\n    i = i + 1\nLoop\n\n'Select first cell\nRange(\"C2\").Select\n\n'Loop through column C to find empty cells\n'Copy and paste column E contents (concatenated) to column F and delete row(s) of clarifications\nDo While Not IsEmpty(\"C\")\n\n    'If there are three rows of comments\n    If IsEmpty(ActiveCell.Offset(1, 0)) And IsEmpty(ActiveCell.Offset(2, 0)) Then\n        Range(ActiveCell.Offset(0, 2), Range(ActiveCell.Offset(1, 2), ActiveCell.Offset(2, 2))).Select\n        ActiveCell.Offset(-1, 1) = ActiveCell.Offset(0, 0).Value &amp; Chr(10) &amp; ActiveCell.Offset(1, 0).Value &amp; Chr(10) &amp; ActiveCell.Offset(2, 0).Value\n        Selection.EntireRow.Delete\n    'If there are two rows of comments\n    ElseIf IsEmpty(ActiveCell.Offset(1, 0)) Then\n        Range(ActiveCell.Offset(0, 2), ActiveCell.Offset(1, 2)).Select\n        ActiveCell.Offset(-1, 1) = ActiveCell.Offset(0, 0).Value &amp; Chr(10) &amp; ActiveCell.Offset(1, 0).Value\n        Selection.EntireRow.Delete\n    'If there is one row of comments\n    Else\n        ActiveCell.Offset(0, 2).Select\n        ActiveCell.Offset(-1, 1) = ActiveCell.Offset(0, 0).Value\n        Selection.EntireRow.Delete\nEnd If\n\n'Find next blank in column C\nNextBlank = Range(\"C1:C\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nRange(\"C\" &amp; NextBlank).Select\n\n'Exit loop once to the end of the table\nIf IsEmpty(ActiveCell.Offset(0, -1)) And IsEmpty(ActiveCell.Offset(1, -1)) Then\n    Exit Do\nEnd If\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "edited": false, "score": 0, "creation_date": 1531941458, "post_id": 51409192, "comment_id": 89790383, "body": "Thank you both worked! And you&#39;re right, I think I will stick with the second example"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1531940163, "creation_date": 1531940163, "answer_id": 51409192, "question_id": 51408991, "link": "https://stackoverflow.com/questions/51408991/passing-table-name-and-field-name-as-strings-to-function/51409192#51409192", "title": "Passing table name and field name as strings to function", "body": "<p>To use variables in these cases, you use parentheses:</p>\n\n<pre><code>If IsNull(myTable(fieldName)) Then\n</code></pre>\n\n<p>But note that a more efficient way is to use a query:</p>\n\n<pre><code>x = DCount(\"*\", tableName, \"[\" &amp; fieldName &amp; \"] IS NULL\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1531941198, "creation_date": 1531941198, "answer_id": 51409459, "question_id": 51408991, "link": "https://stackoverflow.com/questions/51408991/passing-table-name-and-field-name-as-strings-to-function/51409459#51409459", "title": "Passing table name and field name as strings to function", "body": "<pre><code>foo!bar\n</code></pre>\n\n<p>This notation is \"bang notation\". The <code>bar</code> part <em>looks</em> like a normal identifier, but to VBA it's a string literal - that's why you can't do this:</p>\n\n<pre><code>If IsNull(myTable![ &amp; fieldName &amp; ]) Then\n</code></pre>\n\n<p>Bang notation <code>foo!bar</code> is the equivalent of <code>foo.DefaultItemPropertyWithStringIndexer(\"bar\").DefaultProperty</code>. So:</p>\n\n<pre><code>If IsNull(myTable.Fields(fieldName).Value) Then\n</code></pre>\n\n<p>Should work just fine. The shorter <code>myTable(fieldName)</code> notation is exactly the same, except with all these explicit member calls made implicit. I personally prefer code that <em>says what it does</em>, and <em>does what it says</em>.</p>\n\n<p>As far as Access goes however, <a href=\"https://stackoverflow.com/a/51409192/1188513\">using a query to query a table</a> is the way to go.</p>\n"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 51409192, "answer_count": 2, "score": 3, "last_activity_date": 1531941198, "creation_date": 1531939499, "last_edit_date": 1531940249, "question_id": 51408991, "link": "https://stackoverflow.com/questions/51408991/passing-table-name-and-field-name-as-strings-to-function", "title": "Passing table name and field name as strings to function", "body": "<p>I have a database with many tables and I am trying to check a given table for Null values. Rather than writing a function for each table I am attempting to pass the table name and field name as strings to one function (so that one function works on all tables). </p>\n\n<p>I am able accomplish this with the table name but not with the field name. I recieve a runtime error of \"Item not found in this collection\"</p>\n\n<pre><code>Public myDb As DAO.Database\nPublic myTable As DAO.Recordset\n\nPublic Sub verifyFields()\n    checkNull \"Table Name\", \"Field Name\"\nEnd Sub\n\n\nPublic Sub checkNull(ByVal tableName As String, ByVal fieldName As String)\n\n    Set myDb = CurrentDb\n    '============\n    'Table Name | 'Check if Column \"Field Name\" for null values\n    '============\n    Set myTable = CurrentDb.OpenRecordset(tableName)\n    myTable.MoveFirst\n    Do Until myTable.EOF\n        If IsNull(myTable![ &amp; fieldName &amp; ]) Then'&lt;--Error is thrown here\n            x = x + 1\n            blanksFound = True\n        End If\n        myTable.MoveNext\n    Loop\n    If blanksFound = True Then\n        aaa = MsgBox(x &amp; \" Blanks found.\", vbOKOnly, blankField.Name)\n    End If\n</code></pre>\n\n<p>The locals window shows that both strings were passed, but I still get the runtime error. Am I overlooking something?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1531939792, "post_id": 51408985, "comment_id": 89789498, "body": "Please show us the code that you have written so far."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1531939953, "post_id": 51408985, "comment_id": 89789605, "body": "These look nearly the same except there is one extra header above and in between the two blocks. Is that the only difference?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1531940060, "post_id": 51408985, "comment_id": 89789665, "body": "Try using the Macro Recorder to get you started. It writes terrible, but functional code. Once you have something that works once, you can attempt to put it in a loop and come back to ask a very specific question."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1531944603, "post_id": 51408985, "comment_id": 89791894, "body": "Do you want a table for every instance of ID?"}, {"owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1532102624, "post_id": 51408985, "comment_id": 89863086, "body": "Thanks for all your responses. @PGCodeRider you are correct I want a table (ListObjects.Add) for every instance of ID."}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1532366553, "post_id": 51408985, "comment_id": 89937307, "body": "I know it&#39;s not what you&#39;re asking, but this seems to be a very bad design overall. Especially when I see your other comment saying you want to eventually pass each table through to PowerQuery. I don&#39;t know the final goal here, but you might be better off transforming the output somehow to be more relational. Maybe convert each 4-row sub-table into a single row then make one table of the whole thing. Something along those lines would allow for easier maintenance / growth too. Just my 2 cents...."}, {"owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "reply_to_user": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1532379119, "post_id": 51408985, "comment_id": 89943117, "body": "Thanks for your comment @John Bustos. I&#39;m basically converting pages of a report into database format. My strategy (only because this is how I have been doing it manually) is to make each data table into a Table object, send each table into Power Query, unipivot each data table using this M code (<a href=\"https://www.thebiccountant.com/2017/06/19/unpivot-by-number-of-columns-and-rows-in-powerbi-and-powerquery-in-excel/\" rel=\"nofollow noreferrer\">thebiccountant.com/2017/06/19/&hellip;</a>), and then appending every single table (now that they have been processed to have the same format). Any help or advice would be greatly appreciated."}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1532438413, "post_id": 51408985, "comment_id": 89967524, "body": "William, again, I don&#39;t know the scope of your project, but it may make more sense to just write a good looping program in VBA to unpivot and normalize the data for you form the get-go, but without knowing more, I can&#39;t promise that&#39;s the best way to go - Just based upon what you&#39;re saying, I think that&#39;s the way I would go. Good luck!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532102870, "post_id": 51410325, "comment_id": 89863196, "body": "Thanks for your help, this is definitely what I was looking for. However, when I run this code, the first table (first instance of ID) successfully generates but then it throws a runtime error 1004: a table cannot overlap another table. It seems like Excel is not moving on to the next ID but is rather trying to generate another table on top of the first one. How can I resolve this issue?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532298571, "post_id": 51410325, "comment_id": 89907830, "body": "@William I updated code to avoid the crossover of tables. Assuming this works, please accept the answer. Thanks."}, {"owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532365508, "post_id": 51410325, "comment_id": 89936807, "body": "Thanks for your response, @PGCodeRider, unfortunately this is still throwing the same runtime 1004 error. Wish I knew more to try to debug the code. I was also looking into trying to use the FIND function to identify the starting and ending row numbers (every table starts with a cell in column A containing &quot;ID&quot; and ends with a cell in column A containing &quot;Comments&quot;), since the tables are not necessarily all 4 rows tall...but I still can&#39;t figure out how to write the code."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532365580, "post_id": 51410325, "comment_id": 89936841, "body": "@William Do you need headers? (i.e. COlumn1 and column2?)"}, {"owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532365846, "post_id": 51410325, "comment_id": 89936979, "body": "I don&#39;t think so; my next step is to pass each Table object into Power Query, which is another question for another day, but yeah I don&#39;t think I need headers for that; so long as the entire contents of the target range is in the body of the output Table object, it should work fine."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532366180, "post_id": 51410325, "comment_id": 89937142, "body": "@William I updated the code to not have headers. Assuming the rows and columns match your example consistently, that should always work."}, {"owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "edited": false, "score": 0, "creation_date": 1532378555, "post_id": 51410325, "comment_id": 89942888, "body": "Thanks @PGCodeRider, code runs great! Thanks for getting me started, now I just have to figure out how to calculate the size of the table (since it won&#39;t always be 4 rows tall). Question for next time."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 0, "last_activity_date": 1532366117, "last_edit_date": 1532366117, "creation_date": 1531944957, "answer_id": 51410325, "question_id": 51408985, "link": "https://stackoverflow.com/questions/51408985/excel-vba-loop-through-spreadsheet-creating-tables-based-on-query/51410325#51410325", "title": "Excel VBA - loop through spreadsheet creating tables based on query", "body": "<p>Here's a highly customized solution. It assumes table always 4 rows and two columns.</p>\n\n<pre><code>Sub easyGoofy()\nDim WS As Worksheet, rCell As Range, i As Integer, rStart As Long\n\nFor Each WS In ActiveWorkbook.Sheets\ni = 0\nrStart = 1\n\nstartSearch:\n    If Not Intersect(WS.UsedRange.Cells, WS.Rows(rStart &amp; \":\" &amp; Rows.Count)) Is Nothing Then\n\n        For Each rCell In Intersect(WS.UsedRange.Cells, WS.Rows(rStart &amp; \":\" &amp; Rows.Count)).Cells\n            If UCase(rCell.Value) = \"ID\" And UCase(rCell.Offset(1, 0).Value) = \"DATE\" Then\n\n                WS.ListObjects.Add(xlSrcRange, Range(rCell, rCell.Offset(3, 1)), , xlYes).Name = \"TBL_\" &amp; i\n                rStart = WS.ListObjects(\"TBL_\" &amp; i).DataBodyRange.Rows.Count + 1 + rStart\n                 i = i + 1\n\n                GoTo startSearch\n\n            End If\n        Next rCell\n\n    End If\n\nNext WS\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10101408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6e504f33b6bc31a44d8710f75c80b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/10101408/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 51410325, "answer_count": 1, "score": 0, "last_activity_date": 1532366117, "creation_date": 1531939476, "last_edit_date": 1531939897, "question_id": 51408985, "link": "https://stackoverflow.com/questions/51408985/excel-vba-loop-through-spreadsheet-creating-tables-based-on-query", "title": "Excel VBA - loop through spreadsheet creating tables based on query", "body": "<p>I'm hoping to loop through a worksheet and create Tables based on certain indexes. Essentially my table is structured as follows:</p>\n\n<pre><code>ID | 101\nDate | 2018-07-18\nProduct | Banana\nComments | \n\nID | 102\nDate | 2018-07-18\nProduct | Apple\nComments |\n</code></pre>\n\n<p>And I'm just hoping to write a code that will loop through the worksheet and make one Table for every ID to Comments. I'm included links to screenshots showing my initial table, and the desired outcome of the code.</p>\n\n<p>Before:\n<img src=\"https://i.stack.imgur.com/d0AwE.png\" alt=\"Before\"> </p>\n\n<p>After:\n<img src=\"https://i.stack.imgur.com/IQVTU.png\" alt=\"After\"></p>\n\n<p>Thanks again for your advice.</p>\n"}, {"tags": ["excel", "vba", "user-interface", "combobox", "activex"], "comments": [{"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1531942883, "post_id": 51408875, "comment_id": 89791080, "body": "having trouble replication this, do you have any worksheet events or combo box events set up?"}, {"owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "reply_to_user": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1531943419, "post_id": 51408875, "comment_id": 89791328, "body": "I&#39;ve replicated the issue in a totally fresh workbook. Note that I am using an ActiveX ComboBox, that has a linked cell whose value does not have this &#39;flicker&#39; issue -- only the actual ComboBox has this issue. Another note is that the ComboBox uses a list range to populate its values."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1531945646, "post_id": 51408875, "comment_id": 89792396, "body": "ok was able to replicate"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "edited": false, "score": 0, "creation_date": 1531947224, "post_id": 51410797, "comment_id": 89793112, "body": "haha interesting timing-- I answered my own question above just now. <code>LostFocus</code> was the solution"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "edited": false, "score": 0, "creation_date": 1531947536, "post_id": 51410797, "comment_id": 89793249, "body": "had not refreshed screen for a bit and did not see anything. I am going to try and slow down program, isolate this a bit further, maybe with application.sleep or something and try to capture idk have to look into this"}], "tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": false, "score": 1, "last_activity_date": 1531947373, "last_edit_date": 1531947373, "creation_date": 1531947043, "answer_id": 51410797, "question_id": 51408875, "link": "https://stackoverflow.com/questions/51408875/excel-activex-combobox-displays-previous-value-issue/51410797#51410797", "title": "Excel ActiveX ComboBox Displays Previous Value Issue", "body": "<p>Will start from here:</p>\n\n<p>I created a comboBox with various fruits as items inside.</p>\n\n<p>I clicked on pear. Then pineapple. then clicked on cell A1, firing the lost focus event.</p>\n\n<pre><code>Private Sub ComboBox1_LostFocus()\n    Debug.Print ComboBox1.Value\n    Debug.Print ComboBox1.Value\n    Debug.Print ComboBox1.Value\nEnd Sub\n</code></pre>\n\n<p>This was text in my immediate window:\npineapple\npineapple\npineapple</p>\n\n<p>This makes me think that it is a rendering issue, not a value change, though maybe it is happening so fast that my debug.print doesn't catch it. </p>\n\n<p>Interestingly if you make the calls from inside VBA, the flash does not occur:</p>\n\n<pre><code>Sub Main()\n    ComboBox1.Value = \"mango\"\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Nor if you just run</p>\n\n<pre><code>    ComboBox1.Value = \"mango\"\n</code></pre>\n\n<p>then click on the worksheet and select a cell</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "is_accepted": true, "score": 1, "last_activity_date": 1531947131, "creation_date": 1531947131, "answer_id": 51410804, "question_id": 51408875, "link": "https://stackoverflow.com/questions/51408875/excel-activex-combobox-displays-previous-value-issue/51410804#51410804", "title": "Excel ActiveX ComboBox Displays Previous Value Issue", "body": "<p>Added a <code>LostFocus</code> event to the ComboBox that had a line that selected a cell. This removed the \"flicker\" to the previous value when another cell on the sheet was selected, and also caused the ComboBox value to \"flicker\" back to the new value after \"flickering\" to the old value when a command button was clicked after changing the ComboBox's value...</p>\n\n<p>Therefore this solved my issue (mostly -- was unable to prevent the \"flicker\" from happening upon running another macro via command button, but at least the value does not remain stuck at the old value while the other macro runs)</p>\n\n<p>Idea came from this thread: <a href=\"https://stackoverflow.com/questions/29362456/what-event-is-triggered-when-user-selects-value-from-drop-down-combobox-activex\">What event is triggered when user selects value from drop down ComboBox (ActiveX)?</a></p>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 11998874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60571d681ad0df53b8fd9790608cc05?s=128&d=identicon&r=PG&f=1", "display_name": "tomatoeshift", "link": "https://stackoverflow.com/users/11998874/tomatoeshift"}, "is_accepted": false, "score": 0, "last_activity_date": 1595585522, "creation_date": 1595585522, "answer_id": 63071505, "question_id": 51408875, "link": "https://stackoverflow.com/questions/51408875/excel-activex-combobox-displays-previous-value-issue/63071505#63071505", "title": "Excel ActiveX ComboBox Displays Previous Value Issue", "body": "<p>I have one solution that is sort of a work around.</p>\n<p>I inserted an ActiveX Label to the worksheet (on the same location as the ComboBox) and set the labels <code>visible</code> state to <code>False</code>.</p>\n<p>Everytime the drop-down box closes, the focus is set on the invisible label</p>\n<p>First a global variable.</p>\n<pre class=\"lang-vbs prettyprint-override\"><code> Public DropDownBegin As Boolean\n</code></pre>\n<p>Then the sub-routine</p>\n<pre class=\"lang-vbs prettyprint-override\"><code>Private Sub ComboBox1_DropButtonClick()\n    DropDownBegin = Not DropDownBegin\n    If Not DropDownBegin Then\n        ActiveSheet.Shapes(&quot;Label1&quot;).OLEFormat.Object.TopLeftCell.Select\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "accepted_answer_id": 51410804, "answer_count": 3, "score": 3, "last_activity_date": 1595585522, "creation_date": 1531939016, "last_edit_date": 1531945126, "question_id": 51408875, "link": "https://stackoverflow.com/questions/51408875/excel-activex-combobox-displays-previous-value-issue", "title": "Excel ActiveX ComboBox Displays Previous Value Issue", "body": "<p>Issue with Embedded ActiveX ComboBox form on a spreadsheet where:</p>\n\n<ul>\n<li>Upon changing the value in the ComboBox, the value changes properly</li>\n<li><p>However, when a cell/shape is selected on the sheet, the ComboBox value reverts back to the previous value for a split second before going back to the new value</p></li>\n<li><p>Problem because: If a button for a macro is pressed after changing the ComboBox value, the old ComboBox value is displayed while the macro is running, rather than the new value</p></li>\n</ul>\n\n<p><strong>Question</strong>: <strong>Is there a way to force this event (reverting to old value before going displaying new value) programmatically?</strong></p>\n\n<p>I've tried using the following in the Change event for the ComboBox, as well as within the macro that is called by another shape on the sheet:</p>\n\n<ul>\n<li>Calculating the worksheet</li>\n<li>Selecting/Activating a cell</li>\n<li>ScreenUpdating = false, ScreenUpdating = true</li>\n</ul>\n\n<p>Did a bit more searching and have found this question <a href=\"https://stackoverflow.com/questions/47765242/excel-activex-combobox-shows-previous-selection-when-losing-focus\">Excel ActiveX Combobox shows previous selection when losing focus</a> with the same issue</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6755141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qYVz0GRk6do/AAAAAAAAAAI/AAAAAAAAALg/Hi_sQRIROSI/photo.jpg?sz=128", "display_name": "Mike Beal", "link": "https://stackoverflow.com/users/6755141/mike-beal"}, "edited": false, "score": 0, "creation_date": 1532021208, "post_id": 51428347, "comment_id": 89828433, "body": "Thank you for responding. TL;DR yes. An employee would enter their initials into that column, signifying that the part has been done, and after they put in the password, the row should be moved to the end of the table."}, {"owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "reply_to_user": {"reputation": 9, "user_id": 6755141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qYVz0GRk6do/AAAAAAAAAAI/AAAAAAAAALg/Hi_sQRIROSI/photo.jpg?sz=128", "display_name": "Mike Beal", "link": "https://stackoverflow.com/users/6755141/mike-beal"}, "edited": false, "score": 0, "creation_date": 1532021363, "post_id": 51428347, "comment_id": 89828509, "body": "So then if &quot;H:H&quot; is always in the target range, intersect will never return <code>nothing</code> and your conditional will always be true which will lead to the <code>show</code> routine always being called. Unless I&#39;m misunderstanding something."}, {"owner": {"reputation": 9, "user_id": 6755141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qYVz0GRk6do/AAAAAAAAAAI/AAAAAAAAALg/Hi_sQRIROSI/photo.jpg?sz=128", "display_name": "Mike Beal", "link": "https://stackoverflow.com/users/6755141/mike-beal"}, "edited": false, "score": 0, "creation_date": 1532021567, "post_id": 51428347, "comment_id": 89828599, "body": "Right, duh. I&#39;m not sure how I would get around this, any suggestions?"}], "tags": [], "owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "is_accepted": false, "score": 0, "last_activity_date": 1532020057, "creation_date": 1532020057, "answer_id": 51428347, "question_id": 51408713, "link": "https://stackoverflow.com/questions/51408713/how-do-i-move-a-row-with-a-recently-edited-cell-to-bottom/51428347#51428347", "title": "How do I move a row with a recently edited cell to bottom?", "body": "<p>Userform2 is probably popping up because this <code>If Not Intersect(Target, Range(\"H:H\")) Is Nothing Then</code> is always evaluating to true. Does the range being passed into worksheet change always contain \"H\"?</p>\n"}], "owner": {"reputation": 9, "user_id": 6755141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qYVz0GRk6do/AAAAAAAAAAI/AAAAAAAAALg/Hi_sQRIROSI/photo.jpg?sz=128", "display_name": "Mike Beal", "link": "https://stackoverflow.com/users/6755141/mike-beal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532021445, "creation_date": 1531938360, "last_edit_date": 1532021445, "question_id": 51408713, "link": "https://stackoverflow.com/questions/51408713/how-do-i-move-a-row-with-a-recently-edited-cell-to-bottom", "title": "How do I move a row with a recently edited cell to bottom?", "body": "<p>So far, I have an excel sheet that displays information about parts and in column 'H' there is an initial column that when someone puts their initials in that column it indicates that the part is finished. The row with the new initials should go to the bottom of the data. However, before this happens I have already set up a userform, 'UserForm2' in which the user will put in a password. So, if I could get some guidance on how to go about doing that when they press the 'OkayButton', that would be amazing! </p>\n\n<p>Edit: I have tried moving it down with the worksheet change event, but I can't figure out how to get it to work.</p>\n\n<p>Edit2(defunct): I have sort of figured it out; However, the code that I've indicated below I have added is giving me a invalid qualifier error.</p>\n\n<p>Edit3: Some progress! The newly changed code below does what I it to now; However the 'userform2' keeps popping up after it has been copied to the bottom, I'm not entirely sure why and if anyone would happen to know how to fix it and could tell me that would be much appreciated!</p>\n\n<p>Edit4: It works!... For the most part. The error that was in the previous edit is still popping up. Again, the updated code is below.</p>\n\n<p>Userform2:</p>\n\n<pre><code>    Private Sub CancelButton_Click()\n        Application.EnableEvents = False\n        Application.Undo\n        Application.EnableEvents = True\n        Unload Me\n    End Sub\n    Private Sub OkayButton_Click()\n        IniPass = \"pass\"\n        If Me.PasswordIn.Value = IniPass Then\n            Unload Me\n        Else\n            MsgBox \"Incorrect Password\"\n        End If\n    End Sub\n    Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n        If CloseMode = vbFormControlMenu Then\n            Cancel = True\n            MsgBox \"Please use the Cancel button to close the password window!\"\n        End If\n    End Sub\n</code></pre>\n\n<p>Sheet1(LookUp):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    LooupValue = Target.Value\n    part = Application.VLookup(LooupValue, MasterSheet.Range(\"A:AO\"), 7, False)\n    desc = Application.VLookup(LooupValue, MasterSheet.Range(\"A:AO\"), 9, False)\n    cust = Application.VLookup(LooupValue, MasterSheet.Range(\"A:AO\"), 10, False)\n    due = Application.VLookup(LooupValue, MasterSheet.Range(\"A:AO\"), 13, False)\n\n    If Not Application.Intersect(Range(\"A:A\"), Target) Is Nothing Then\n        Range(Target.Address).Offset(0, 3).Value = part\n        Range(Target.Address).Offset(0, 4).Value = desc\n        Range(Target.Address).Offset(0, 5).Value = cust\n        Range(Target.Address).Offset(0, 6).Value = due\n    End If\n\n    If Not Intersect(Target, Range(\"H:H\")) Is Nothing Then\n        UserForm2.Show\n        Application.EnableEvents = False\n        lastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n        Sheet1.Rows(Target.Row).Cut Sheet1.Rows(lastRow).Offset(1, 0)\n        Application.EnableEvents = True\n        Application.CutCopyMode = False\n        On Error Resume Next\n            Range(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1531938309, "post_id": 51408388, "comment_id": 89788656, "body": "Welcome to SO, unfortunately what you ask isn&#39;t how this site works. For more details see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1531939170, "post_id": 51408388, "comment_id": 89789139, "body": "Thanxs #Luuklag. Edited the comment to ask specific query"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1531946821, "post_id": 51408388, "comment_id": 89792909, "body": "What column should the filename be in?"}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1532015984, "post_id": 51408388, "comment_id": 89825465, "body": "@luuklag : Added a screenshot below for the desired output I require.  the filename is required in Column A of both the worksheets of the master workbook. Please help in adding the relevant code!"}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1532023085, "post_id": 51408388, "comment_id": 89829331, "body": "@luuklag : Deleted the answer below and updated the query above with the screenshot. Thanxs for the tip buddy!"}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1532104417, "post_id": 51408388, "comment_id": 89864008, "body": "Need this urgently. Please help anybody. Would be very grateful.. Please.."}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1532247619, "post_id": 51408388, "comment_id": 89895374, "body": "@luuklag - Did some minor fine tuning on the code. Have got the desired output. Thanxs for the help..God bless you. Thanxs a lot.. This had been haunting me for a while.."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "edited": false, "score": 0, "creation_date": 1532166456, "post_id": 51448835, "comment_id": 89879024, "body": "Thanxs @luuklag : I pasted the code code just beneath the End With. However, it is showing a compile Error: &quot; Invalid qualifier&quot; on myfile.Name.. Any advise.."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "edited": false, "score": 0, "creation_date": 1532172858, "post_id": 51448835, "comment_id": 89880669, "body": "You could try without the <code>.value</code>."}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "edited": false, "score": 0, "creation_date": 1532188572, "post_id": 51448835, "comment_id": 89884882, "body": "Did the following changes &lt;1&gt;Range(&quot;A1:M&quot; &amp; lRow).Copy ws2.Range(&quot;B&quot; &amp; Rows.Count).End(xlUp)(1) &lt;/1&gt; &lt;2&gt; lRowA = ws2.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row &lt;/2&gt; &lt;3&gt; ws2.Range(ws2.Cells(lRowA, 1), ws2.Cells(PasteRows, 1)) = wb.Name &lt;/3&gt;. Now, encountering another problem. The last row of the workbooks are not getting pasted in the master worksheets. For e.x - if Workbook A is having 15 rows, Workbook B is having 15 rows. Then the rows getting pasted for Workbook A is 14 and for workbook B (last workbook in the folder) as 15."}, {"owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "edited": false, "score": 0, "creation_date": 1532189064, "post_id": 51448835, "comment_id": 89884997, "body": "the last row of the workbooks is getting omitted while pasting in the master worksheet. However, the last column of the last workbook in the folder is getting pasted. Seems like some problem in the loop due to the above modifications.."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "edited": false, "score": 0, "creation_date": 1532194170, "post_id": 51448835, "comment_id": 89886416, "body": "Then remove the -1 part in PasteRows"}], "tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": false, "score": 0, "last_activity_date": 1532113044, "creation_date": 1532113044, "answer_id": 51448835, "question_id": 51408388, "link": "https://stackoverflow.com/questions/51408388/vba-code-to-paste-multiple-cells-from-one-worksheet-into-another-with-the-filena/51448835#51448835", "title": "VBA Code to paste multiple cells from one worksheet into another with the filenames", "body": "<p>In your code to copy replace the <code>A</code> with a <code>B</code> for the paste range.</p>\n\n<pre><code>With wb.Sheets(\"Profit-Loss\")\n        lRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        .Range(\"A2:M\" &amp; lRow).Copy ws2.Range(\"B\" &amp; Rows.Count).End(xlUp)(2)\nEnd With\n</code></pre>\n\n<p>Now your data gets pasted from column B onwards.</p>\n\n<p>To get the name of the file you copied from you can use <code>myFile.name</code>. You want to paste that on the same rows you just copied your data to, so lets make use of the things you calculated to determine what to copy (<code>lRow</code>), together with the last empty row in column A.</p>\n\n<pre><code>Dim lRowA as Long\nDim PasteRows as Long\nlRowA = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp)\nPasteRows = lRowA + lRow -1 ' the -1 is to compensate for the fact that your copy area starts on row 2.\n\nws2.Range(ws2.Cells(lRowA,1),ws2.Cells(PasteRows,1)).value = myFile.name\n</code></pre>\n\n<p>You can use above code to fill column A with the filename. Place it directly after your end with (twice) and change the appropriate ws names (ws2/ws3) to match the code in your with statement.</p>\n"}], "owner": {"reputation": 21, "user_id": 10101187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580e4e7c12c36070df24688ac27d0aad?s=128&d=identicon&r=PG&f=1", "display_name": "Jaisy B", "link": "https://stackoverflow.com/users/10101187/jaisy-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556282636, "creation_date": 1531937056, "last_edit_date": 1556282636, "question_id": 51408388, "link": "https://stackoverflow.com/questions/51408388/vba-code-to-paste-multiple-cells-from-one-worksheet-into-another-with-the-filena", "title": "VBA Code to paste multiple cells from one worksheet into another with the filenames", "body": "<p>I am new on doing the VBA codes. So not familiar with coding as such. Just copied few code snippets. However, not getting the desired output.</p>\n\n<p>What I have done need is looped through excel files in a folder and pasted the desired data from the worksheets into the master worksheet.</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim lRow As Long\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim y As Workbook\n\n'Optimize Macro Speed\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\nSet FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n    .Title = \"C:\\Users\\check\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\nmyPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\nmyExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\nmyFile = Dir(myPath &amp; myExtension)\n\nSet y = Workbooks.Open(\"C:\\Users\\Super\\Desktop\\Master\")\nSet ws2 = y.Sheets(\"Conso P-L\")\nSet ws3 = y.Sheets(\"Conso Expenses\")\n\n'Loop through each Excel file in folder\nDo While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n    Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    With wb.Sheets(\"Profit-Loss\")\n        lRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        .Range(\"A2:M\" &amp; lRow).Copy ws2.Range(\"A\" &amp; Rows.Count).End(xlUp)(2)\n    End With\n    Application.CutCopyMode = False\n\n    With wb.Sheets(\"Expenses\")\n        lRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        .Range(\"A2:M\" &amp; lRow).Copy ws3.Range(\"A\" &amp; Rows.Count).End(xlUp)(2)\n    End With\n    Application.CutCopyMode = False\n    wb.Close SaveChanges:=True\n    'Get next file name\n    myFile = Dir\nLoop\n\n'Message Box when tasks are completed\nMsgBox \"Task Complete!\"\n\nResetSettings:\n'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>However, the problem is I need to add a column in the master worksheets to get the filenames of the source data (excluding the .xls or .xlsx), I am not able to figure out where to tweak the code!!</p>\n\n<p>Added a screenshot below for the desired output I require. the filename is required in Column A of both the worksheets of the master workbook. </p>\n\n<p><a href=\"https://i.stack.imgur.com/MAD37.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MAD37.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Appreciate if anybody can help please..</p>\n"}, {"tags": ["vba", "ms-access", "select", "append", "case"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1531939473, "post_id": 51408278, "comment_id": 89789301, "body": "Does <code>[DateExpire]</code> belong to <code>State</code> or <code>tblLicenses</code>?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1531942065, "post_id": 51408278, "comment_id": 89790674, "body": "A working select query joining the information from a single state and <code>tblLicenses</code> would also be helpful.  It would be much easier to start from a working query than to edit someone&#39;s edits."}], "answers": [{"tags": [], "owner": {"reputation": 1411, "user_id": 4121863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43e77d8245591671b702eda73a4f3a2a?s=128&d=identicon&r=PG", "display_name": "AdamsTips", "link": "https://stackoverflow.com/users/4121863/adamstips"}, "is_accepted": false, "score": 0, "last_activity_date": 1531944569, "creation_date": 1531944569, "answer_id": 51410241, "question_id": 51408278, "link": "https://stackoverflow.com/questions/51408278/access-append-query-in-vba-from-multiple-sources-into-one-table-access-2010/51410241#51410241", "title": "Access Append Query In VBA From Multiple Sources Into One Table, Access 2010", "body": "<p>It sounds like you are dealing with input sources that use different column names for the same information, and you are working to merge it all into a single table. I will make the assumption that you are dealing with 50 text files that are updated every so often.</p>\n\n<p>Here is one way you could approach this project...</p>\n\n<p>Use VBA to build a collection of file names (using <code>Dir()</code> in a specific folder). Then loop through the collection of file names, doing the following:</p>\n\n<ol>\n<li>Add the file as a linked table using VBA, preserving the column names.</li>\n<li>Loop through the columns in the <code>TableDef</code> object and set variables to the actual names of the columns. (See example code below)</li>\n<li>Build a simple SQL statement to insert from the linked table into a single tables that lists all current license expiration dates.</li>\n</ol>\n\n<p>Here is some example code on how you might approach this:</p>\n\n<pre><code>Public Sub Example()\n\n    Dim dbs As Database\n    Dim tdf As TableDef\n    Dim fld As Field\n    Dim strLic As String\n    Dim strExp As String\n    Dim strSQL As String\n\n    Set dbs = CurrentDb\n    Set tdf = dbs.TableDefs(\"tblLinked\")\n\n    ' Look up field names\n    For Each fld In tdf.Fields\n        Select Case fld.Name\n            Case \"LICENSE\", \"LICENSE NO\", \"License Num\"\n                strLic = fld.Name\n            Case \"EXPIRATION\", \"EXPIRATION DATE\", \"EXP\"\n                strExp = fld.Name\n        End Select\n    Next fld\n\n    If strLic = \"\" Or strExp = \"\" Then\n        MsgBox \"Could not find field\"\n        Stop\n    Else\n        ' Build SQL to import data\n        strSQL = \"insert into tblCurrent ([State], [License],[Expiration]) \" &amp; _\n            \"select [State], [\" &amp; strLic &amp; \"], [\" &amp; strExp &amp; \"] from tblLinked\"\n        dbs.Execute strSQL, dbFailOnError\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Now with your new table that has all the new data combined, you can build your more complex grouping query to produce your final output. I like this approach because I prefer to manage the more complex queries in the visual builder rather than in VBA code.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10101209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066070c4853d1eefb9db38e53cfa0f87?s=128&d=identicon&r=PG&f=1", "display_name": "J Lowe", "link": "https://stackoverflow.com/users/10101209/j-lowe"}, "is_accepted": false, "score": 0, "last_activity_date": 1532116052, "creation_date": 1532116052, "answer_id": 51449438, "question_id": 51408278, "link": "https://stackoverflow.com/questions/51408278/access-append-query-in-vba-from-multiple-sources-into-one-table-access-2010/51449438#51449438", "title": "Access Append Query In VBA From Multiple Sources Into One Table, Access 2010", "body": "<p>Thanks for your input. I came up with a variation of your idea:</p>\n\n<p>I created table (\"tblStateScripts\"), from which the rs!(fields) contained the various column names</p>\n\n<pre><code>Dim rs As DAO.Recordset\nDim DB As Database\n\nSet DB = CurrentDb\nSet rs = DB.OpenRecordset(\"tblStateScripts\")\n\n\nIf Not rs.EOF Then\n    Do\n        CurrentDb.Execute \" INSERT INTO TEST (  StLicense, OldExpDate, NewExpDate ) \" _\n             &amp; \" SELECT State.StateLicense as StLicense, DateExpire AS OldExpDate, State.dateexpired AS NewExpDate \" _\n                    &amp; \" FROM ( SELECT \" &amp; rs!FldLicenseState &amp; \" AS StateLicense, \" &amp; rs!FldExpDate &amp; \" AS DateExp \" &amp; \" FROM \" &amp; rs!TblState  \" _\n                    &amp; \" RIGHT JOIN tblLicenses ON (State.StateLicense = tblLicenses.VetLicense) \" _\n             &amp; \" GROUP BY  State.StateLicense, DateExpire, State.dateexpired \" _\n             &amp; \" HAVING (((LicenseNum) Like '*\" &amp; rs!StateCode &amp; \"*') ; \"\n    rs.MoveNext\n    Loop Until rs.EOF\nEnd If\nrs.Close\nSet rs = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10101209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066070c4853d1eefb9db38e53cfa0f87?s=128&d=identicon&r=PG&f=1", "display_name": "J Lowe", "link": "https://stackoverflow.com/users/10101209/j-lowe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 742, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532116052, "creation_date": 1531936564, "last_edit_date": 1532014189, "question_id": 51408278, "link": "https://stackoverflow.com/questions/51408278/access-append-query-in-vba-from-multiple-sources-into-one-table-access-2010", "title": "Access Append Query In VBA From Multiple Sources Into One Table, Access 2010", "body": "<p>I hardly ever post for help and try to figure it out on my own, but now I\u2019m stuck. I\u2019m just trying to append data from multiple tables to one table. The source tables are data sets for each American State and the append query is the same for each State, except for a nested select script to pull from each State table. So I want to create a VBA script that references a smaller script for each state, rather than an entire append script for each state. I\u2019m not sure if I should do a SELECT CASE, or FOR TO NEXT or FOR EACH NEXT or DO LOOP or something else.</p>\n\n<p>Here\u2019s what I have so far:</p>\n\n<p>tblLicenses is a table that has the field LicenseState from which I could pull a list of the states.</p>\n\n<hr>\n\n<pre><code>Function StateScripts()\n\n    Dim rst As DAO.Recordset\n    Dim qryState As String\n    Dim StateCode As String\n    Set rst = CurrentDb.OpenRecordset(\"SELECT LicenseState FROM tblLicenses GROUP BY LicenseState;\")\n\n'    and I've tried these, but they don't work\n\n'    qryState = DLookup(\"LicenseState\", \"tblLicenses\")\n\n'    qryState = \"SELECT LicenseState INTO Temp FROM tblLicenses GROUP BY LicenseState;\"\n\n'    DoCmd.RunSQL qryState\n\n\n    Select Case qryState\n        Case \"CT\"\n            StateCode = \"CT\"\n            StateScripts = \" SELECT [LICENSE NO] AS StateLicense, [EXPIRATION DATE] AS dateexpired FROM CT \"\n        Case \"AK\"\n            StateCode = \"AK\"\n            StateScripts = \" SELECT [LICENSE] AS StateLicense, [EXPIRATION] AS dateexpired FROM AK \"\n        Case \"KS\"\n            StateCode = \"KS\"\n            StateScripts = \" SELECT [LicenseNum] AS StateLicense, [ExpDate] AS dateexpired FROM KS \"\n    End Select\n\n    CurrentDb.Execute \" INSERT INTO TEST (  StLicense, OldExpDate, NewExpDate ) \" _\n         &amp; \" SELECT State.StateLicense as StLicense, DateExpire AS OldExpDate, State.dateexpired AS NewExpDate \" _\n         &amp; \" FROM ( \" &amp; StateScripts &amp; \" ) AS State \" _\n         &amp; \" RIGHT JOIN tblLicenses ON (State.StateLicense = tblLicenses.LicenseNum) \" _\n         &amp; \" GROUP BY  State.StateLicense, DateExpire, State.dateexpired \" _\n         &amp; \" HAVING (((LicenseNum) Like '*\" &amp; StateCode &amp; \"*') ; \" \nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531938109, "post_id": 51408219, "comment_id": 89788526, "body": "Your <code>getProcs</code> procedure isn&#39;t <i>getting</i> anything, and function <code>all_dataArray</code> isn&#39;t <i>returning</i> anything, so <code>procArr</code> gets assigned to an <code>Empty</code> variant. Also you simply cannot parse VBA code without a lexer. Without context, it is impossible to tell whether <code>bar = fizz(foo)</code> is invoking <code>fizz</code> and passing <code>foo</code> as a parameter, or if it&#39;s pulling index <code>foo</code> from array <code>fizz</code>. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can help you identify what&#39;s calling what. Not sure anything else can. Full disclaimer: I own the repository and manage this open-source project."}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531938251, "post_id": 51408219, "comment_id": 89788620, "body": "Hi Mathieu, I believe getProcs isn&#39;t getting anything because VBComp is setting to your VBComponent(2), which may not mean anything to your current workbook. Would suggest you change &quot;2&quot; with the name of an actual component with a codemodule.  I see what you&#39;re saying about the lexer. Perhaps I should be moving towards fully self contained modules."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531938453, "post_id": 51408219, "comment_id": 89788745, "body": "I haven&#39;t executed your code. I mean everything in <code>getProcs</code> is local, and it&#39;s a <code>Sub</code> procedure, therefore whatever it does, dies at <code>End Sub</code>. &quot;GetSomething&quot; should be a function that returns something. <code>all_dataArray</code> is assigning its <code>arr</code> byref argument, which points to the very same array pointer being assigned at the call site - which is extremely unsettling. Regardless, sorry to say, your efforts are doomed. You will not be able to parse VBA code with procedural VBA code. We&#39;re 4 years into an actual parser with a grammar written against the language specs, and still hit edge cases."}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531938877, "post_id": 51408219, "comment_id": 89788987, "body": "I think we&#39;re getting caught up on the naming of a simple example sub. The point of it is to add all procs to the procArr, which it does. You are correct in that it probably isn&#39;t worth my time."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1531939434, "post_id": 51408219, "comment_id": 89789271, "body": "I find myself questioning the logic of automating code reuse by copy and paste.  Just put all the common code in an add-in and reference it."}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 1, "creation_date": 1531939608, "post_id": 51408219, "comment_id": 89789381, "body": "Hey Comintern. I actually do that exactly for code used solely by myself. This project is coming from a place where I want to create a &quot;self-contained&quot; project that can be sent around without the need to install an add-in on each computer."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1531941346, "post_id": 51408219, "comment_id": 89790335, "body": "Fair enough.  If they&#39;re already in common modules, I&#39;m confused as to why you&#39;re trying to parse your own code. I&#39;d just use the <code>VBComponent.Export</code> and <code>VBComponent.Import</code> functions instead. Whatever you do, be careful of naming collisions..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531941384, "post_id": 51408219, "comment_id": 89790353, "body": "Gosh, I completely missed the <code>all_dataArray = arr</code> assignment at the very bottom. Ignore my above comments about <code>all_dataArray</code> returning <code>Empty</code>."}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1531941422, "post_id": 51409374, "comment_id": 89790367, "body": "Mathieu, appreciate your response. I believe you have understood my question fully and have answered it. It also seems you are much further along the path to answering what seems to be a very comprehensive task. It&#39;s unfortunate that there isn&#39;t a clear way of doing it. Mostly because of VBA support. I will check out your project and see if it will help me. Thanks again"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1531941618, "post_id": 51409374, "comment_id": 89790470, "body": "@Citanaf if you do any C#, I&#39;ll happily take a pull request that makes a feature that exports all the callers of a given procedure, or even of all procedures in a given module. Given Rubberduck&#39;s thorough understanding of VBA code, it should be pretty trivial to implement. PS - you&#39;ll want to grab the latest pre-release, not the old 2.2 release from last April (much has improved since then)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1531940871, "creation_date": 1531940871, "answer_id": 51409374, "question_id": 51408219, "link": "https://stackoverflow.com/questions/51408219/vba-identifying-subs-and-functions-called-from-other-subs-procedures/51409374#51409374", "title": "VBA - Identifying subs and functions called from other subs/procedures", "body": "<p>Identifying the members/procedures of a module is only one step, and it's as far as the VBIDE API is going to be helpful.</p>\n\n<p>The next step is to determine where the procedure calls are, and in order to successfully do this, you need to take the text of the module, and <em>somehow</em> determine what's a procedure call, and which procedure is being called: in order to reliably do this, you're going to need to \"programmatically understand\" the VBA code as well as VBA itself.</p>\n\n<p>The only way to do this, is to turn the text into a stream of <em>tokens</em> (that's what a <em>lexer</em> does), turn that stream of tokens into a tree structure (that's what a <em>parser</em> does), then traverse these trees and populate a <em>symbol table</em> that contains information about what's declared in what scope and which scopes can \"see\" it. Then you need to traverse the parse trees again, locate the nodes representing procedure calls, find the name in your symbol table, and <em>resolve</em> the identifier reference to a specific symbol, in accordance with VBA's language scoping rules.</p>\n\n<p>The <em>tokenizing</em> step needs to take into account pesky annoying things like comments, line continuations, and precompiler directives.</p>\n\n<p>Once you've resolved identifier references, all you need to do is iterate the references to each procedure in your symbol table, and list their respective parent scope/procedure - then you know who's calling who.</p>\n\n<p>I cannot think of any other reliable way to do this... and I can't imagine doing this in VBA. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>'s parser is somewhere in the ballpark of 45,000 lines of C# code, <em>generated</em> by processing an Antlr4 grammar designed to VBA's language specifications. And that's not even the preprocessor and resolver parts, which have their very own challenges and complexities.</p>\n\n<hr>\n\n<p>That said no, an \"All\" module isn't best practice. In fact it's a sure-shot way to get a dumping bag of whatever: if a module (or class) is a <code>FooUtils</code>, a <code>FooManager</code>, a <code>FooHelper</code>, or any other such vaguely-scoped loose term that basically stands for \"whatever stuff I couldn't fit anywhere else\", something is wrong with the design.</p>\n\n<p>I don't know what your \"commonly used\" functions are, but it's likely that what you need is just further modularization. Extract these helper methods into more specialized modules/classes - a <code>ListObjectExtensions</code> module clearly states what's in scope for it, so you shouldn't expect to find e.g. a <code>Get1DArrayFromRange</code> function in there.</p>\n"}, {"comments": [{"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1531959779, "post_id": 51411936, "comment_id": 89796941, "body": "Awesome, I&#39;ll see if I can use any of these. I&#39;m pretty sure I won&#39;t be able to solve it completely (as shown in my accepted answer), but this may point me in the right direction/speed things up. Appreciate it!"}, {"owner": {"reputation": 595, "user_id": 1237786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f88fc95f445f0659730a2ad63c45f16a?s=128&d=identicon&r=PG", "display_name": "anefeletos", "link": "https://stackoverflow.com/users/1237786/anefeletos"}, "reply_to_user": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1531960424, "post_id": 51411936, "comment_id": 89797085, "body": "The most important question is If you really need it as you mention that can also ... satisfy similar needs in other projects.  If you not paid for this I am not sure that worths the effort."}], "tags": [], "owner": {"reputation": 595, "user_id": 1237786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f88fc95f445f0659730a2ad63c45f16a?s=128&d=identicon&r=PG", "display_name": "anefeletos", "link": "https://stackoverflow.com/users/1237786/anefeletos"}, "is_accepted": false, "score": 1, "last_activity_date": 1531993564, "last_edit_date": 1531993564, "creation_date": 1531953513, "answer_id": 51411936, "question_id": 51408219, "link": "https://stackoverflow.com/questions/51408219/vba-identifying-subs-and-functions-called-from-other-subs-procedures/51411936#51411936", "title": "VBA - Identifying subs and functions called from other subs/procedures", "body": "<p>I have implemented it in the past but with no perfect results. It helped me to get an incomplete (or sometimes overloaded) list of dependencies and for the rest let the compiler complain to fix...</p>\n\n<p>Also huge effort - rarely need it. In fact if you are doing good job in programming you try to split every function to small independed functions. So finally when you ask for dependecies of a single function, it turn outs that the answer is usuall almost your entire project!</p>\n\n<p>This code is a whole module with references to custom general functions of other modules, for extracting token lists, concatanating arrays etc.</p>\n\n<p>Any way I post some <strong>abstracts</strong> of functions I used. I don't know if could be helpfull.</p>\n\n<p>Good luck! </p>\n\n<p>1.</p>\n\n<pre><code>Function GetComponentProcDependences(Optional ComponentName As String = \"Module1\", Optional ProjectName As String = \"\")\n[...]\nobjProject = VBAEditor.VBProjects.item(ProjectName)\n[...]\nPutativeDependences = Quicksort(ProjectFunctionList(objProject, False, False), True)\n[...]\nallreadyincluded = ComponentMethodsList(ReferencesComponent, False, False)\n[...]\nFor Each item In allreadyincluded \nCall FindProcDependences(CStr(item), ProjectName, PutativeDependences, allreadyincluded)\nNext\nGetComponentProcDependences = allreadyincluded\nEnd Function\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Function ProjectFunctionList(Optional objProject As VBIDE.VBProject = Nothing, Optional Titles As Boolean = True, Optional args As Boolean = True)\n[...]\nFor Each objComponent In objProject.VBComponents\n    cs = ComponentMethodsList(objComponent, Titles, args)\n[...]\n ProjectFunctionList= ArrayConcatenate(ex, cs)\n[...]\nEnd Function\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>    Public Function ComponentMethodsList(objComponent As VBIDE.VBComponent, Optional inclTitle As Boolean = True, Optional args As Boolean = True)\n    [...]\n     Dim objCode As VBIDE.CodeModule\n    [...]\n    Do While iLine &lt; objCode.CountOfLines\n    sProcName = objCode.ProcOfLine(iLine, pk)\n    [...]\n                    pclc = objCode.ProcCountLines(sProcName, pk)\n                    pblc = objCode.ProcBodyLine(sProcName, pk)\n    [...]\n   pcl = Replace(objCode.Lines(pblc, decllines), \" _\", \"\") 'etc\n    [...]\n     Call AddToListSub(IIf(inclTitle, objComponent.Name &amp; \".\", \"\") &amp; sProcName &amp; \n    IIf(args, \"#\" &amp; pcl, \"\"), res)\n    [...]\n    iLine = iLine + pclc\n    [...]\n    Loop\n    ComponentMethodsList = res\n    End Function\n</code></pre>\n\n<p>4.</p>\n\n<pre><code>Sub FindProcDependences(ProcName As String, ProjectName As String, PutativeDependences, Optional allreadyincluded = Nothing)\n\n\ncompcode = GetProcCode(ProcName, ProjectName) '\nresidue = Array(\"=\", \"\"\"\", \"-\", \"+\", \";\", \"(\", \")\", \"&amp;\", \" \", \",\", vbTab, vbCr, vbLf, \".\")\ncompcode = MassReplace(compcode, \"+\", residue)\nDo\ni0 = Len(compcode)\ncompcode = Replace(compcode, \"++\", \"+\")\nLoop While i0 &lt;&gt; Len(compcode)\ntokens = tokenizer(compcode, False, \"+\", allreadyincluded)\nDim temparis()\nFor Each item In tokens\nIf ArrayContains(item, PutativeDependences, \"bool\") And Not ArrayContains(item, allreadyincluded) Then\nCall AddToArrayListIfUnique(item, temparis)\nEnd If\nNext\n\n[...]\n\nallreadyincluded = ArrayConcatenate(allreadyincluded, temparis)\n\nFor Each item In temparis\nCall FindProcDependences(CStr(item), ProjectName, PutativeDependences, allreadyincluded)  'Recursive calls\nNext\n\nEnd Sub\n</code></pre>\n\n<p>5.</p>\n\n<pre><code>Public Function GetProcCode(ProcName As String, Optional ProjectName As String = \"\")\nDim objComponent As VBIDE.VBComponent\nDim objCode As VBIDE.CodeModule\nSet objComponent = FindComponentContainsProc(ProcName, ProjectName)\nSet objCode = objComponent.CodeModule\niLine = objComponent.CodeModule.ProcStartLine(ProcName, vbext_pk_Proc)\npclc = objCode.ProcCountLines(ProcName, pk)\nGetProcCode = objCode.Lines(iLine, pclc)\nSet objComponent = Nothing\nSet objCode = Nothing\nEnd Function\n</code></pre>\n\n<p>6.</p>\n\n<pre><code>Function FindComponentContainsProc(ProcName As String, Optional ProjectName As String = \"\", Optional ProcKind As VBIDE.vbext_ProcKind = vbext_pk_Proc) As VBIDE.VBComponent\n[...]\nDim objComponent As VBIDE.VBComponent\nFor Each objComponent In objProject.VBComponents\npupProcLine = 0\nDim objCode As VBIDE.CodeModule\nSet objCode = objComponent.CodeModule\nOn Error Resume Next\npupProcLine = objCode.ProcStartLine(ProcName, ProcKind)\nIf pupProcLine &gt; 0 Then Exit For\nNext\n[...]\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 1, "accepted_answer_id": 51409374, "answer_count": 2, "score": 1, "last_activity_date": 1531993564, "creation_date": 1531936343, "question_id": 51408219, "link": "https://stackoverflow.com/questions/51408219/vba-identifying-subs-and-functions-called-from-other-subs-procedures", "title": "VBA - Identifying subs and functions called from other subs/procedures", "body": "<p>Struggling to come up with a title for this one. I have a project which contains around 20 forms / 10 code &amp; class modules. This project has multiple functions which fit together nicely to solve specific purposes, but can also be segmented to satisfy similar needs in other projects. Those other projects may not necessarily need the other components. </p>\n\n<p>An example of this may be: One part of the project can create a powerpoint, while another part of the project may be able to send emails. This project uses both, however another project may only need one of those functions.</p>\n\n<p>I have tried my best to separate these functions into their self contained modules. However, I have placed functions that are commonly used in a separate module (\"All\") so that I am able to utilize the same code without repeating in various places. I am self-taught so if this isn't a best practice, let me know.</p>\n\n<p>The issue is that I now want to be able to export certain modules from one project to the other. I am building a tool which will let me distribute these modules as fully functional packages that will work without any setup on the destination file. In order to accomplish this, I need to understand where my subs/functions are pointing. How interconnected are my modules? If I exported, lets say the PowerPoint module, does that module try and access something in my \"All\" module? If that's the case, I would need to also export any relevant code from that module to the new workbook.</p>\n\n<p>If the first tier of procedures are the ones listed in the target module, then the second tier of procedures would be the ones called via the T1 procedures. This means that T3 procedures are called from T2 procedures and so on... </p>\n\n<p>How would I write a Loop function that needs to go deeper and deeper? The exit condition is most certainly when all T1 procedures have been fully explored.</p>\n\n<p>The below code simply gets me a list of procedures in the target module and adds them to an array.</p>\n\n<pre><code>Sub getProcs()\n\nDim VBProj As VBIDE.VBProject\nDim VBComp As VBIDE.VBComponent\nDim VBMod As VBIDE.CodeModule\nDim lineNum As Integer\nDim lineText As String\nDim lineCount As Integer\nDim procArr As Variant\nDim procName As String\nDim ProcKind As VBIDE.vbext_ProcKind\n\n'Set Target Objects\nSet VBProj = ThisWorkbook.VBProject\nSet VBComp = VBProj.VBComponents(2)\nSet VBMod = VBComp.CodeModule\nWith VBMod\n    If .CountOfLines &gt; 0 Then\n        lineNum = .CountOfDeclarationLines + 1\n        Do Until lineNum &gt;= .CountOfLines\n            procName = .ProcOfLine(lineNum, ProcKind)\n            procArr = all_dataArray(procArr, procName)\n            lineNum = .ProcStartLine(procName, ProcKind) + _\n                    .ProcCountLines(procName, ProcKind) + 1\n        Loop\n    End If\nEnd With\nEnd Sub\n\nFunction all_dataArray(arr As Variant, arrVal As Variant) As Variant\n'Add item to array\nIf IsEmpty(arr) Or Not IsArray(arr) Then\n    arr = Array(arrVal)\nElse\n    ReDim Preserve arr(0 To UBound(arr) + 1)\n    arr(UBound(arr)) = arrVal\nEnd If\nall_dataArray = arr\nEnd Function\n</code></pre>\n\n<p>Perhaps I am going about this all wrong, happy to hear any advice.\nThanks for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531936285, "post_id": 51408059, "comment_id": 89787601, "body": "Are you sure the <code>.Sheets(i)</code> in question is a <code>Worksheet</code> and not another sheet type?"}, {"owner": {"reputation": 51, "user_id": 9997061, "user_type": "registered", "profile_image": "https://graph.facebook.com/479229482536030/picture?type=large", "display_name": "Alexa", "link": "https://stackoverflow.com/users/9997061/alexa"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531936841, "post_id": 51408059, "comment_id": 89787874, "body": "For Each ws In WB2.Worksheets         ws.Cells.AutoFilter     Next  is giving 1004 error saying autofilter method of range class failed even though the same works on other books."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531937146, "post_id": 51408059, "comment_id": 89788038, "body": "Test <code>If .AutoFilterMode</code> and then maybe use <code>.Autofiler.ShowAllData</code>? Or however you prefer to clear the filter: <a href=\"https://stackoverflow.com/questions/21761027/excel-2013-vba-clear-all-filters-macro\" title=\"excel 2013 vba clear all filters macro\">stackoverflow.com/questions/21761027/&hellip;</a>"}], "owner": {"reputation": 51, "user_id": 9997061, "user_type": "registered", "profile_image": "https://graph.facebook.com/479229482536030/picture?type=large", "display_name": "Alexa", "link": "https://stackoverflow.com/users/9997061/alexa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531935722, "creation_date": 1531935722, "question_id": 51408059, "link": "https://stackoverflow.com/questions/51408059/run-time-error-438-object-doesnt-support-this-property-or-method-for-filter", "title": "Run-time error &#39;438&#39;: object doesn&#39;t support this property or method for filter removal", "body": "<p>I have multiple books with multiple sheets that I'm copying data from. Sometimes filters are applied and someone forgets to remove it. It gets all wonky if I try to copy filtered data so I'm trying to remove filters in it is filtered.</p>\n\n<pre><code>With WB2\n    For i = 1 To .Sheets.Count\n        With .Sheets(i)\n            If .AutoFilterMode Then\n                .Cells.AutoFilter\n            End If\n        End With\n    Next\nEnd With\n</code></pre>\n\n<p>I'm getting a 438 error with \"If .AutoFilterMode Then\" highlighted.</p>\n\n<p>I've used this block of code on other books before it and it passes and gets stuck on this one.</p>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531935388, "post_id": 51407914, "comment_id": 89787125, "body": "You&#39;re going to want to abandon this line of web scraping in favor of xlm http. Instantiating and scraping with InternetExplorer slams the processor; xlm touches it."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531936804, "post_id": 51407914, "comment_id": 89787855, "body": "@Jeeped is spot on.  The images that you link in your post are not that helpful. Do the PDGA numbers and Locations span columns instead of rows??  A screenshot of the numbers would help.  Dynamic Range Names would make the numbers easier to work with."}], "answers": [{"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1531935662, "creation_date": 1531935662, "answer_id": 51408044, "question_id": 51407914, "link": "https://stackoverflow.com/questions/51407914/web-scraping-from-excel-list-of-pdga-numbers-using-vba/51408044#51408044", "title": "Web-scraping from Excel List of PDGA Numbers using VBA", "body": "<p><a href=\"https://i.stack.imgur.com/0uMpW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0uMpW.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub test()\n\n    Dim IE As New InternetExplorer\n    Dim Doc As HTMLDocument\n    Dim lastRow As Long, i As Long\n    Dim sDD As String\n\n    IE.Visible = False\n\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To lastRow\n\n        IE.navigate \"https://www.pdga.com/player/\" &amp; Range(\"PDGA\").Cells(i).Value\n\n        Do\n        DoEvents\n        Loop Until IE.readyState = READYSTATE_COMPLETE\n\n        Set Doc = IE.document\n\n        sDD = Trim(Doc.getElementsByTagName(\"li\")(127).outerText)\n        Range(\"Location\").Cells(i) = sDD\n    Next\n\n     Set IE = Nothing\n     Set Doc = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1531942058, "last_edit_date": 1531942058, "creation_date": 1531938070, "answer_id": 51408633, "question_id": 51407914, "link": "https://stackoverflow.com/questions/51407914/web-scraping-from-excel-list-of-pdga-numbers-using-vba/51408633#51408633", "title": "Web-scraping from Excel List of PDGA Numbers using VBA", "body": "<p>If you have a specific list of players then you loop and issue XHR requests to get the info. Here I have the PDGA# in an array which is looped:</p>\n\n<pre><code>playerPDGA = Array(1, 5, 23, 46, 789, 567)\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim sResponse As String, html As New HTMLDocument, playerPDGA(), results(), i As Long\n    playerPDGA = Array(1, 5, 23, 46, 789, 567)\n    ReDim results(0 To UBound(playerPDGA), 0 To 1)\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        For i = LBound(playerPDGA) To UBound(playerPDGA)\n            .Open \"GET\", \"https://www.pdga.com/player/\" &amp; playerPDGA(i), False\n            .send\n            sResponse = StrConv(.responseBody, vbUnicode)\n            sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n            With html\n                .body.innerHTML = sResponse\n                results(i, 0) = .querySelector(\".pane-content &gt; h1\").innerText\n                results(i, 1) = .querySelector(\".location\").innerText\n            End With\n        Next i\n    End With\n    ActiveSheet.Cells(1, 1).Resize(UBound(results, 1) + 1, UBound(results, 2) + 1) = results\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>For any page listing players:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim sResponse As String, html As New HTMLDocument\n    Application.ScreenUpdating = False\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.pdga.com/players/\", False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n    Dim nameList As Object, cityList As Object, stateList As Object, countryList As Object, r As Long\n    With html\n        .body.innerHTML = sResponse\n        Set nameList = .querySelectorAll(\".views-field.views-field-nothing\")\n        Set cityList = .querySelectorAll(\".views-field.views-field-City.city\")\n        Set stateList = .querySelectorAll(\".views-field.views-field-StateProv.state\")\n        Set countryList = .querySelectorAll(\".views-field.views-field-Country.country\")\n\n    End With\n    With ActiveSheet\n        Dim i As Long\n        For i = 0 To nameList.Length - 1\n            r = r + 1\n            .Cells(r, 1) = nameList.item(i).innerText\n            .Cells(r, 2) = Trim$(cityList.item(i).innerText &amp; Chr$(32) &amp; stateList.item(i).innerText &amp; Chr$(32) &amp; countryList.item(i).innerText)\n        Next i\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Reference:</strong></p>\n\n<p>HTML Object library</p>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1531942062, "creation_date": 1531942062, "answer_id": 51409664, "question_id": 51407914, "link": "https://stackoverflow.com/questions/51407914/web-scraping-from-excel-list-of-pdga-numbers-using-vba/51409664#51409664", "title": "Web-scraping from Excel List of PDGA Numbers using VBA", "body": "<p>You can achieve your desired output in several ways. Here is one of such.</p>\n\n<pre><code>Sub FetchData()\n    Dim Http As New XMLHTTP60, Html As New HTMLDocument\n    Dim post As HTMLDivElement, Idic As New Scripting.Dictionary\n    Dim key As Variant, N$, CT$, S$, C$, R&amp;\n\n    With Http\n        .Open \"GET\", \"https://www.pdga.com/players/\", False\n        .send\n        Html.body.innerHTML = .responseText\n    End With\n\n    For Each post In Html.querySelector(\"table.views-table tbody\").getElementsByTagName(\"tr\")\n        N = post.querySelector(\"a[title]\").innerText\n        CT = post.querySelector(\".city\").innerText\n        S = post.querySelector(\".state\").innerText\n        C = post.querySelector(\".country\").innerText\n        Idic(N &amp; \"|\" &amp; CT &amp; \" \" &amp; S &amp; \" \" &amp; C) = 1\n    Next post\n\n    For Each key In Idic.Keys\n        R = R + 1: Cells(R, 1) = Split(key, \"|\")(0)\n        Cells(R, 2) = Split(key, \"|\")(1)\n    Next key\nEnd Sub\n</code></pre>\n\n<p>Reference to add to the library:</p>\n\n<pre><code>Microsoft XML, v6.0\nMicrosoft HTML Object Library\nMicrosoft Scripting Runtime\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10100841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa4e1b1396d7e02e3d65afccf3e080e?s=128&d=identicon&r=PG&f=1", "display_name": "bdbart", "link": "https://stackoverflow.com/users/10100841/bdbart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531942062, "creation_date": 1531935089, "question_id": 51407914, "link": "https://stackoverflow.com/questions/51407914/web-scraping-from-excel-list-of-pdga-numbers-using-vba", "title": "Web-scraping from Excel List of PDGA Numbers using VBA", "body": "<p>I have a list of numbers (PDGA Numbers) in MS Excel.  I would like to automatically search the PDGA website (<a href=\"https://www.pdga.com/players/\" rel=\"nofollow noreferrer\">https://www.pdga.com/players/</a>) from the list and automatically paste the player's location next to the corresponding PDGA Number.  Currently, I am able to search the number and paste the location individually, but not the entire list.</p>\n\n<p>First I select an excel cell and 'Define Name' as PDGA, and another as Location.\n<a href=\"https://imgur.com/AcGtuX8\" rel=\"nofollow noreferrer\">https://imgur.com/AcGtuX8</a></p>\n\n<p>Then I basically followed this YouTube video. <a href=\"https://www.youtube.com/watch?v=7sZRcaaAVbg\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=7sZRcaaAVbg</a></p>\n\n<p>And ultimately got this VBA code to work. (Make sure the proper VBA References are checked)\n<a href=\"https://imgur.com/a/OYSM7Am\" rel=\"nofollow noreferrer\">https://imgur.com/a/OYSM7Am</a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n If Target.Column = Range(\"PDGA\").Column Then\n Dim IE As New InternetExplorer\n    IE.Visible = False\n            IE.navigate \"https://www.pdga.com/player/\" &amp; Range(\"PDGA\").Value\n    Do\n    DoEvents\n    Loop Until IE.readyState = READYSTATE_COMPLETE\n    Dim Doc As HTMLDocument\n    Set Doc = IE.document\n    Dim sDD As String\n    sDD = Trim(Doc.getElementsByTagName(\"li\")(127).outerText)\n    Range(\"Location\").Value = sDD\n\n    End If\n   End Sub\n</code></pre>\n\n<p>I think I need some For Each loop, but I'm not sure. It should look like this when completed.\n<a href=\"https://imgur.com/a/qOiW4JJ\" rel=\"nofollow noreferrer\">https://imgur.com/a/qOiW4JJ</a></p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531934305, "post_id": 51407661, "comment_id": 89786586, "body": "maybe <code>Range(&quot;B2:B&quot; &amp; findLastRow).Select</code> ?"}, {"owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "edited": false, "score": 0, "creation_date": 1531934489, "post_id": 51407661, "comment_id": 89786666, "body": "Fixed that part, thank you!  However I still receive the error &quot;Argument Not Optional&quot;"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1531934559, "post_id": 51407661, "comment_id": 89786696, "body": "In calling the formula in your <code>Sub</code>, you are omitting the <code>col</code> argument.  <code>Range(&quot;B2:B&quot; &amp; findLastRow(&quot;B&quot;))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "edited": false, "score": 0, "creation_date": 1531935646, "post_id": 51407818, "comment_id": 89787248, "body": "I received an &quot;Invalid Qualifier&quot; error for findLastRow"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "edited": false, "score": 0, "creation_date": 1531937240, "post_id": 51407818, "comment_id": 89788087, "body": "Looks like I missed a closing bracket ad you should probably be looking for the last row in column A, not column B. Use the last row from column A to extend the range in column B."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1531945662, "post_id": 51407818, "comment_id": 89792401, "body": "@Jeeped: Would <code>col.End(xlUp).Row</code> be just as valid?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1531946146, "post_id": 51407818, "comment_id": 89792606, "body": "@AJD Only if called as <code>findLastRow(.cells(.rows.count, &quot;A&quot;))</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1531937256, "last_edit_date": 1531937256, "creation_date": 1531934775, "answer_id": 51407818, "question_id": 51407661, "link": "https://stackoverflow.com/questions/51407661/using-a-function-within-a-sub-procedure-vba/51407818#51407818", "title": "Using a Function within a Sub Procedure VBA", "body": "<p>Don't use ActiveSheet in a function. You have a perfect opportunity to pass in a range that has a defined parent worksheet rather than a string representing the column letter.</p>\n\n<pre><code>Public Function findLastRow(col As range) As Long 'making the macro available to all Sub Procedures\n\n        Dim lastRow As Long\n        With col.parent\n            lastRow = .Cells(.rows.count, col.column).End(xlUp).Row 'finding the last possible row disregarding blanks\n        End With\n\n        findLastRow = lastRow\n\nEnd Function\n\nSub Open_INV()\n    Workbooks.OpenText Filename:= _\n        \"C:\\Users\\MonthEnd_Close\\Import_Files\\INV\", _\n        Origin:=437, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n        xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False _\n        , Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n        TrailingMinusNumbers:=True\n\n    with activeworkbook.worksheets(1)\n        .Range(\"B2:B\" &amp; findLastRow(.range(\"A2\"))).Formula = \"=TRIM(A2)\"\n    end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 51407818, "answer_count": 1, "score": 1, "last_activity_date": 1531937491, "creation_date": 1531934217, "last_edit_date": 1531937491, "question_id": 51407661, "link": "https://stackoverflow.com/questions/51407661/using-a-function-within-a-sub-procedure-vba", "title": "Using a Function within a Sub Procedure VBA", "body": "<p>I don't think I'm searching the right terms as I imagine this answer has to be somewhere but I am new to functions and trying to figure out how to get this to work:</p>\n\n<p>How can I get my function <code>findLastRow</code> to be used where I say <code>Range(\"B2\" &amp; findLastRow).Select</code> ?  The current error I recieve is <strong>Argument Not Optional</strong> and it highlights <code>findLastRow</code></p>\n\n<pre><code>Public Function findLastRow(col As String) As Long 'making the macro available to all Sub Procedures\n\n        Dim lastRow As Long\n        With ActiveSheet\n            lastRow = ActiveSheet.Cells(1048576, col).End(xlUp).Row 'finding the last possible row disregarding blanks\n        End With\n\n        findLastRow = lastRow\nEnd Function\n\nSub Open_INV()\n\n    ChDir \"C:\\Users\\MonthEnd_Close\\Import_Files\"\n    Workbooks.OpenText Filename:= _\n        \"C:\\Users\\MonthEnd_Close\\Import_Files\\INV\", _\n        Origin:=437, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n        xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False _\n        , Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n        TrailingMinusNumbers:=True\n\n    On Error Resume Next\n\n    Range(\"B2\").Formula = \"=TRIM(A2)\"\n    Range(\"B2\").Copy\n    Range(\"B2:B\" &amp; findLastRow).Select\n    Selection.PasteSpecial xlPasteFormulas\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vb.net", "excel", "vbscript"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531934392, "post_id": 51407627, "comment_id": 89786627, "body": "Works for me (with a test file).  How is the above related to clicking a .vbs file? I ran it as a vba macro inside of Excel."}, {"owner": {"reputation": 11, "user_id": 9676779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda55e957143817bad62ead0aee9ba81?s=128&d=identicon&r=PG&f=1", "display_name": "Deni", "link": "https://stackoverflow.com/users/9676779/deni"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531935632, "post_id": 51407627, "comment_id": 89787239, "body": "Yeah sorry I am teaching myself all things VB and I assumed that I could run the macro command as a VBScript. I will check how to get it to work as a vbs script"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1531943584, "creation_date": 1531943584, "answer_id": 51410034, "question_id": 51407627, "link": "https://stackoverflow.com/questions/51407627/vbscript-running-shell-command-script-works-but-does-nothing/51410034#51410034", "title": "VBscript running shell command script works but does nothing", "body": "<p>You could open notepad and put the following in and save as .vbs</p>\n\n<pre><code>Option Explicit\nSub Example() \n  Dim xlApp \n  Dim xlBook \n  Set xlApp = CreateObject(\"Excel.Application\") \n  Set xlBook = xlApp.Workbooks.Open(\"C:\\Desktop\\CompanyAlerts.xlsm\", 0, True) \n  xlApp.Application.Visible = True\n    'xlApp.Quit \n   ' Set xlBook = Nothing \n ' Set xlApp = Nothing\nEnd Sub \n</code></pre>\n\n<p>You can then right-click and run, or call this vbs from command line.</p>\n"}], "owner": {"reputation": 11, "user_id": 9676779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda55e957143817bad62ead0aee9ba81?s=128&d=identicon&r=PG&f=1", "display_name": "Deni", "link": "https://stackoverflow.com/users/9676779/deni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 51410034, "answer_count": 1, "score": -3, "last_activity_date": 1531943584, "creation_date": 1531934102, "last_edit_date": 1531943531, "question_id": 51407627, "link": "https://stackoverflow.com/questions/51407627/vbscript-running-shell-command-script-works-but-does-nothing", "title": "VBscript running shell command script works but does nothing", "body": "<p>I am trying to write a code to open an excel file by clicking a .vbs file but although the code executes the file does not get opened. When I type the same command in the CMD the file opens up perfectly. What am I doing wrong? </p>\n\n<pre><code>Sub RunMacro()\n    CreateObject(\"WScript.Shell\").Run(\"C:\\Desktop\\CompanyAlerts.xlsm\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016", "vbe"], "comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531932797, "post_id": 51407232, "comment_id": 89785740, "body": "Very strange. There should be property names after the &#39;.&#39; ... Have you tried recording the macro?"}, {"owner": {"reputation": 113, "user_id": 9674156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b4666591140094c55187095f1d0179?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Haran", "link": "https://stackoverflow.com/users/9674156/jay-haran"}, "reply_to_user": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531932903, "post_id": 51407232, "comment_id": 89785790, "body": "Yes, I have tried recording the macro. It throws a syntax error when I run the macro which is expected. It is very strange the tutorials I am following don&#39;t seem to have this issue."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531933065, "post_id": 51407232, "comment_id": 89785890, "body": "I&#39;ve not seen that before. It&#39;s certainly not normal behaviour. Let&#39;s see if anyone else has any input before I suggest reinstalling office!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531933997, "post_id": 51407232, "comment_id": 89786440, "body": "The only foreignkeycolumn I know of is a property of ModelRelationship. What are you trying to do?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1531934919, "post_id": 51407232, "comment_id": 89786872, "body": "That is not valid code. what procedure are you trying to have the macro recorder accomplish?  (i.e. steps necessary to reproduce what you have done)"}, {"owner": {"reputation": 113, "user_id": 9674156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b4666591140094c55187095f1d0179?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Haran", "link": "https://stackoverflow.com/users/9674156/jay-haran"}, "edited": false, "score": 0, "creation_date": 1531952053, "post_id": 51407232, "comment_id": 89795059, "body": "I am just doing random stuff like changing size of a font, filling a box. Just to try out recording some macros via the record key, but it must be the setting of my excel or something it doesn&#39;t record the macro effectively and the recorded looks like the one above. I am very new to VBA this is the first thing I tried to do. Just to record macros and read the code."}, {"owner": {"reputation": 113, "user_id": 9674156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b4666591140094c55187095f1d0179?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Haran", "link": "https://stackoverflow.com/users/9674156/jay-haran"}, "edited": false, "score": 0, "creation_date": 1532079621, "post_id": 51407232, "comment_id": 89849179, "body": "I got over the issue by downgrading to excel 13 it would be good if someone could figure out what the issue I was having with excel 16 was because no one could help me."}], "owner": {"reputation": 113, "user_id": 9674156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b4666591140094c55187095f1d0179?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Haran", "link": "https://stackoverflow.com/users/9674156/jay-haran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1565896141, "creation_date": 1531932604, "last_edit_date": 1565896141, "question_id": 51407232, "link": "https://stackoverflow.com/questions/51407232/when-recording-in-excel-2016-there-are-lines-in-red-with-just-a-on-the-left", "title": "When recording in Excel 2016 there are lines in red with just a &quot;.&quot; on the left of the equal sign", "body": "<p>When I record macros the code does not work and there are several lines highlighted in red which have just a \".\" on the left side of the equal sign.</p>\n\n<p>It appears to me that the macro is doing something along the lines of just registering my changes and not assigning the default settings by itself.</p>\n\n<p><a href=\"https://i.stack.imgur.com/k2dFV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k2dFV.png\" alt=\"enter image description here\"></a></p>\n\n<p>I got over the issue by downgrading to Excel 13 from Excel 16.</p>\n"}, {"tags": ["excel", "vba", "select"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 1, "creation_date": 1531944333, "post_id": 51407280, "comment_id": 89791778, "body": "Thank you!  Yes, that worked.  It&#39;s way over my head so I&#39;ll try researching to learn.  If I want to change the column that is sorted do I just change the Cells(#)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531944719, "post_id": 51407280, "comment_id": 89791941, "body": "No, that was shorthand for the cell in the top-left corner of the range and probably should have included the column number as well like <code>.cells(1, 1)</code>. To change the key1 column to W you would use <code>.cells(1, 23)</code> or perhaps <code>.cells(1, &quot;W&quot;)</code>."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531946527, "post_id": 51407280, "comment_id": 89792782, "body": "Can I add a secondary Sort by adding another line .Sort Key2:= or how does that work?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531946872, "post_id": 51407280, "comment_id": 89792934, "body": "Did you inadvertently erase the comma? <code>.Sort Key1:=.Cells(1, &quot;B&quot;), Order1:=xlAscending, _</code> works for me."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531946935, "post_id": 51407280, "comment_id": 89792968, "body": "Yes, my fault.  I had edited my question to a new once I saw that.  Trying to add a secondary sort and should be good to go.  Really appreciate your time."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531946986, "post_id": 51407280, "comment_id": 89792994, "body": "BTW, what kind of Jeep?  I DD a &#39;85 CJ7."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531947216, "post_id": 51407280, "comment_id": 89793105, "body": "Started my addiction with an &#39;86 CJ (last year with removable doors) and now a &#39;97 TJ (first year with round headlights after YJ). Been building it and wrecking it for about 12 years now."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531947295, "post_id": 51407280, "comment_id": 89793140, "body": "How do I sort on column C and then secondary level column B?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531947380, "post_id": 51407280, "comment_id": 89793184, "body": "<code>Key1:=.Cells(1, &quot;C&quot;), Order1:=...</code> then <code>Key2:=.Cells(1, &quot;B&quot;), Order2:=...</code> get rid of the key3 line."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531947431, "post_id": 51407280, "comment_id": 89793199, "body": "Thanks for the update. I&#39;m topless and doorless most of the time thanks to our weather.  No AC, no heat and no power brakes but easily choose it over our luxury sedan..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531947581, "post_id": 51407280, "comment_id": 89793270, "body": "Just curious, do you carry a copy of the exclusion regulation that states you don&#39;t need doors? I used to and had to use it twice to get out of a ticket when driving in the city."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531947977, "post_id": 51407280, "comment_id": 89793445, "body": "No I don&#39;t.  From what I&#39;ve studied, it&#39;s legal in Texas.  I&#39;ve read of others in different states having issues though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 0, "creation_date": 1531948164, "post_id": 51407280, "comment_id": 89793524, "body": "Yes, it&#39;s legal because they came with removable doors. Legal on the left coast of Canada as well. However, that doesn&#39;t prevent a ticket unless you can prove on the roadside that you are exempt. Worked for me."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "edited": false, "score": 1, "creation_date": 1531948847, "post_id": 51407280, "comment_id": 89793790, "body": "Guess the cops are pretty cool around my area then.  I nervously approached 4 of them standing around my CJ and overhead them comment about how awesome it would be to patrol in it.  In 6 years I haven&#39;t had any issues."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1531947079, "last_edit_date": 1531947079, "creation_date": 1531932801, "answer_id": 51407280, "question_id": 51407082, "link": "https://stackoverflow.com/questions/51407082/excel-vba-select-entire-rows-in-between-2-named-cells-or-rows-for-sorting/51407280#51407280", "title": "Excel VBA - Select Entire Rows In-Between 2 Named Cells or Rows for Sorting", "body": "<p>Try,</p>\n\n<pre><code>With Worksheets(\"OVERALL\")\n    With .Range(.Cells(.Range(\"BorderFirstRow\").Row + 1, \"A\"), _\n                .Cells(.Range(\"BorderLastRow\").Row - 1, \"W\"))\n        .Sort Key1:=.Cells(1), Order1:=xlAscending, _\n              Orientation:=xlTopToBottom, Header:=xlNo\n    End With\nEnd With\n</code></pre>\n\n<p>To sort with secondary keys,</p>\n\n<pre><code>With Worksheets(\"OVERALL\")\n    With .Range(.Cells(.Range(\"BorderFirstRow\").Row + 1, \"A\"), _\n                .Cells(.Range(\"BorderLastRow\").Row - 1, \"W\"))\n        .Sort Key1:=.Cells(1, \"A\"), Order1:=xlAscending, _\n              Key2:=.Cells(1, \"C\"), Order2:=xlDescending, _\n              Key3:=.Cells(1, \"B\"), Order3:=xlAscending, _\n              Orientation:=xlTopToBottom, Header:=xlNo\n    End With\nEnd With\n</code></pre>\n\n<p>Sort on column A as primary then column C then column B.</p>\n\n<p>This method of sorting only allows up to three keys but you can pre-sort on additional secondary keys first.</p>\n"}], "owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 1, "accepted_answer_id": 51407280, "answer_count": 1, "score": 1, "last_activity_date": 1531947079, "creation_date": 1531932006, "last_edit_date": 1531934977, "question_id": 51407082, "link": "https://stackoverflow.com/questions/51407082/excel-vba-select-entire-rows-in-between-2-named-cells-or-rows-for-sorting", "title": "Excel VBA - Select Entire Rows In-Between 2 Named Cells or Rows for Sorting", "body": "<p>New to macros in Excel. </p>\n\n<p>My worksheet named \"OVERALL\" has projects listed out in rows with various data in columns. I'm trying to create macro buttons that sort the projects based on the various data cells.</p>\n\n<p>Since I will be adding projects to the group frequently and didn't want to update the macros with the correct cells to sort, I've been trying to use Named Cells or Named Rows but have gotten in a rut.</p>\n\n<p>The projects I add sometimes have to be at the very beginning, very end or somewhere in the middle so I've defined upper and bottom border rows to help the macro identify where the data selection starts and stops. In the macro, I'm hoping to be able to select the entire rows in-between the border rows in case additional data columns are added in the future.</p>\n\n<p>If I record a macro, this is the code I get;</p>\n\n<p>`Sub SortProjectNameA2Z()</p>\n\n<pre><code>Rows(\"14:149\").Select\nActiveWorkbook.Worksheets(\"OVERALL\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"OVERALL\").Sort.SortFields.Add Key:=Range( _\n    \"A14:A149\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"OVERALL\").Sort\n    .SetRange Range(\"A14:W149\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nRange(\"A11\").Select\nApplication.CutCopyMode = False`\n</code></pre>\n\n<p>Row 14 is the entire row below the Upper Border Row = \"BorderFirstRow\".</p>\n\n<p>Row 149 is the entire row above the Lower Border Row = \"BorderLastRow\"</p>\n\n<p>I've also named the first cell of the Upper Border Row as \"BorderCellFirst\" and the first cell of the Lower Border Row as \"BorderCellLast\" if that helps?</p>\n\n<p>I've found a way to select the rows <em>between</em> the border rows; <code>Range(\"BorderCellFirst:BorderCellLast\").EntireRow.Select</code>\nbut I haven't found a way to select the entire rows <em>in-between</em> the border rows or border cells that did not include the border rows.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["vba", "if-statement", "sum"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531931813, "post_id": 51406977, "comment_id": 89785240, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-sum-method-excel\" rel=\"nofollow noreferrer\"><code>WorksheetFunction.Sum</code></a> - there&#39;s no <code>Sheets.Sum</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": true, "score": 0, "last_activity_date": 1531933001, "creation_date": 1531933001, "answer_id": 51407336, "question_id": 51406977, "link": "https://stackoverflow.com/questions/51406977/how-to-use-sum-in-an-if-statement-in-vba/51407336#51407336", "title": "How to use Sum in an IF Statement in VBA", "body": "<p>Use this instead:</p>\n\n<pre><code>Application.WorksheetFunction.Sum (Sheets(\"Cost Sheet\").Range(Cells(25, 4), Cells(30, 4)))\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9860524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "xVias", "link": "https://stackoverflow.com/users/9860524/xvias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 51407336, "answer_count": 1, "score": 0, "last_activity_date": 1531933001, "creation_date": 1531931572, "question_id": 51406977, "link": "https://stackoverflow.com/questions/51406977/how-to-use-sum-in-an-if-statement-in-vba", "title": "How to use Sum in an IF Statement in VBA", "body": "<p>All i'm trying to do is find out if a range is > 0 using VBA but i'm having trouble with summing the range, when I run it I get the error 438</p>\n\n<p>Here is my Code;</p>\n\n<pre><code>If cbAC.Value = True And Sheets(\"Cost Sheet\").Sum(Range(Cells(25, 4), Cells(30, 4))).Value &gt; 0 Then\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1531933311, "post_id": 51406926, "comment_id": 89786051, "body": "@Jeeped <code>[tTeEsStT]</code> matches a single char that is either <code>t</code>, <code>T</code>, <code>e</code>, <code>E</code>, <code>s</code> or <code>S</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531933486, "post_id": 51406926, "comment_id": 89786156, "body": "Yes, you&#39;re right of course; my bad."}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1531933665, "last_edit_date": 1531933665, "creation_date": 1531933251, "answer_id": 51407400, "question_id": 51406926, "link": "https://stackoverflow.com/questions/51406926/does-excel-vba-regex-have-an-ignore-case-flag/51407400#51407400", "title": "Does (Excel) VBA Regex have an ignore case flag?", "body": "<p>There is no way to use inline modifiers in VBA regex, it does not support them, nor does it use regex delimiter notation like <code>/test/i</code> since all patterns should be provided using string literals. </p>\n\n<p>See the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/scripting-articles/ee236359%28v%3Dvs.84%29#constructing-a-regular-expression\" rel=\"nofollow noreferrer\"><em>Constructing a Regular Expression</em> Micorsoft reference</a>:</p>\n\n<blockquote>\n  <p>In Visual Basic Scripting Edition (VBScript), a pair of quotation marks (<code>\"\"</code>) delimit regular expressions.</p>\n</blockquote>\n\n<p>Actually, these are not delimiters, but just string literal \"boundaries\".</p>\n\n<p>Then, in the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/scripting-articles/ee236360(v%3dvs.84)#flags\" rel=\"nofollow noreferrer\"><em>Flags</em> section</a>, it is written:</p>\n\n<blockquote>\n  <p>In VBScript, you can specify these flags by setting the equivalent properties to <strong>True</strong>.</p>\n</blockquote>\n\n<p>So, no way to use the flags inside a pattern. There is also a similar mentioning of that in the <a href=\"https://www.regular-expressions.info/vbscript.html\" rel=\"nofollow noreferrer\"><em>VBScript\u2019s Regular Expression Support</em> article at regular-expressions.info</a>:</p>\n\n<blockquote>\n  <ul>\n  <li>No <a href=\"https://www.regular-expressions.info/modifiers.html\" rel=\"nofollow noreferrer\">mode modifiers</a> to set matching options within the regular expression.</li>\n  </ul>\n</blockquote>\n\n<p>You may programmatically or manually turn test to <code>[tT][eE][sS][tT]</code> though. Still, it will require some manipulation with the code if you want to do it dynamically.</p>\n"}], "owner": {"reputation": 344, "user_id": 3761310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x1nkA.jpg?s=128&g=1", "display_name": "DukeSilver", "link": "https://stackoverflow.com/users/3761310/dukesilver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 51407400, "answer_count": 1, "score": 2, "last_activity_date": 1531933665, "creation_date": 1531931351, "question_id": 51406926, "link": "https://stackoverflow.com/questions/51406926/does-excel-vba-regex-have-an-ignore-case-flag", "title": "Does (Excel) VBA Regex have an ignore case flag?", "body": "<p>So I know that the Excel VBA regex object has an <code>ignoreCase</code> property, but is there a way to signify this with a flag in the regex pattern? I tried <code>/i</code>, <code>?i</code>, etc. and wasn't able to find something that worked.</p>\n\n<p>For example, I have:</p>\n\n<ul>\n<li>test</li>\n<li>Test</li>\n<li>TeSt</li>\n</ul>\n\n<p>I'd like some pattern that can match either all three, or just \"test\". <code>test</code> works for the latter, but these all return no results, when I would like them to return a match for all three entries:</p>\n\n<ul>\n<li><code>test/i</code></li>\n<li><code>(test)/i</code></li>\n<li><code>/test/i</code></li>\n</ul>\n\n<p>I currently have a checkbox on my userform that toggles <code>ignoreCase</code> but I'd like to regain that real estate if possible.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531931113, "post_id": 51406823, "comment_id": 89784782, "body": "<a href=\"https://stackoverflow.com/questions/51174829/vba-manual-transpose/51181924#51181924\" title=\"vba manual transpose\">stackoverflow.com/questions/51174829/vba-manual-transpose/&hellip;</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1531931513, "post_id": 51406823, "comment_id": 89785040, "body": "type mismatch on your transpose line, correct?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1531931742, "post_id": 51406823, "comment_id": 89785185, "body": "You can manually transpose by creating an appropriately sized and dimenstioned array, and looping to &quot;manually&quot; copy.  BUT, neither Excel nor the Windows API can handle longer path names.  Excel is limited to about 216 characters; and the Windows API to 260 characters. So be certain about which line is throwing the error."}, {"owner": {"reputation": 70, "user_id": 5033941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-twxpjruVe8s/AAAAAAAAAAI/AAAAAAAAAB8/rz-lZ0K8sYg/photo.jpg?sz=128", "display_name": "Derek M", "link": "https://stackoverflow.com/users/5033941/derek-m"}, "edited": false, "score": 0, "creation_date": 1531934132, "post_id": 51406823, "comment_id": 89786514, "body": "Yes dwirony, it occurs at the end inside &quot;with sh&quot; statement."}], "owner": {"reputation": 70, "user_id": 5033941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-twxpjruVe8s/AAAAAAAAAAI/AAAAAAAAAB8/rz-lZ0K8sYg/photo.jpg?sz=128", "display_name": "Derek M", "link": "https://stackoverflow.com/users/5033941/derek-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531930966, "creation_date": 1531930966, "question_id": 51406823, "link": "https://stackoverflow.com/questions/51406823/excel-vba-manual-transpose", "title": "Excel VBA Manual Transpose", "body": "<p>The below code works until used on a directory with paths over 255 characters.<br>\nRuntime error 13 mismatch occurs.<br>\nI have a hunch that the built in .transpose operation does not support 255 characters.<br>\nHow can I manually do this operation?<br></p>\n\n<p>My other crawler is not recursive, so I have never had this issue.<br>\nAt this point I'm wondering if recursive efficiency is worth it.<br>\nAlso the UNC path output is a requirement, shortening it to drive letter is a not an option.<br></p>\n\n<pre><code>Option Explicit\nSub CreateFileStructureReport()\n\nDim Msheet As String\nDim minNum As Integer\nMsheet = Application.ActiveWorkbook.Path\nApplication.Calculation = xlCalculationManual\nCall GetFileList\nApplication.Calculation = xlCalculationAutomatic\nRange(\"A2\").Select\n\nEnd Sub\n\n\n  Sub GetFileList()\n    Dim ans As String\n    Dim strFolder As String\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim myResults As Variant\n    Dim lCount As Long\n\n    ans = Application.CommandBars(\"Web\").Controls(\"Address:\").Text\n    If ans = \"\" Then Exit Sub\n    ans = Left(ans, InStrRev(ans, \"\\\"))\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set objFolder = objFSO.GetFolder(ans)\n\n    'the variable dimension has to be the second one\n    ReDim myResults(0 To 6, 0 To 0)\n\n    ' place make some headers in the array\n\n    myResults(0, 0) = \"Extension\"\n    myResults(1, 0) = \"Bytes\"\n    myResults(2, 0) = \"Created\"\n    myResults(3, 0) = \"Modified Info\"\n    myResults(4, 0) = \"Last Accessed\"\n    myResults(5, 0) = \"File Name\"\n    myResults(6, 0) = \"\\\\Root\\T01\\T02\\T03\\T04\\T05\\T06\\T07\\T08\\T09\\T10\\T11\\T12\\T13\\T14\\T15\\T16\\T17\\T18\\T19\\T20\"\n\n    'Send the folder to the recursive function\n    FillFileList objFolder, myResults, lCount\n\n    ' Dump these to a worksheet\n    DumpToWorksheet myResults\n\n    'tidy up\n    Set objFSO = Nothing\n\n    End Sub\n\nPrivate Sub FillFileList(objFolder As Object, ByRef myResults As Variant, ByRef lCount As Long, Optional strFilter As String)\n\n    Dim i As Integer\n    Dim objFile As Object\n    Dim fsoSubFolder As Object\n    Dim fsoSubFolders As Object\n\n    'load the array with all the files\n    For Each objFile In objFolder.Files\n        lCount = lCount + 1\n        ReDim Preserve myResults(0 To 6, 0 To lCount)\n\n        myResults(0, lCount) = objFile.Type\n        myResults(1, lCount) = objFile.Size\n        myResults(2, lCount) = objFile.DateCreated\n        myResults(3, lCount) = objFile.DateLastModified\n        myResults(4, lCount) = objFile.DateLastAccessed\n        myResults(5, lCount) = objFile.Name\n        myResults(6, lCount) = objFile.Path\n\n    Next objFile\n\n    'recursively call this function with any subfolders\n\n    Set fsoSubFolders = objFolder.SubFolders\n    DoEvents\n    For Each fsoSubFolder In fsoSubFolders\n        FillFileList fsoSubFolder, myResults, lCount\n    Next fsoSubFolder\n\nEnd Sub\n\nPrivate Sub DumpToWorksheet(varData As Variant, Optional mySh As Worksheet)\n\n    Dim iSheetsInNew As Integer\n    Dim sh As Worksheet, wb As Workbook\n    Dim myColumnHeaders() As String\n    Dim l As Long, NoOfRows As Long\n\n    If mySh Is Nothing Then\n        'make a workbook if we didn't get a worksheet\n        iSheetsInNew = Application.SheetsInNewWorkbook\n        Application.SheetsInNewWorkbook = 1\n        Set wb = Application.Workbooks.Add\n        Application.SheetsInNewWorkbook = iSheetsInNew\n        Set sh = wb.Sheets(1)\n    Else\n        Set mySh = sh\n    End If\n\n    'since we switched the array dimensions, have to transpose\n    With sh\n        Range(.Cells(1, 1), .Cells(UBound(varData, 2) + 1, UBound(varData, 1) + 1)) = _\n            Application.WorksheetFunction.Transpose(varData)\n\n        .UsedRange.Columns.AutoFit\n    End With\n\n    Set sh = Nothing\n    Set wb = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "console", "stdout", "xlwings"], "answers": [{"comments": [{"owner": {"reputation": 1360, "user_id": 1618041, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a532f7f1a6acec773e7433446044fb2?s=128&d=identicon&r=PG", "display_name": "rhaskett", "link": "https://stackoverflow.com/users/1618041/rhaskett"}, "edited": false, "score": 0, "creation_date": 1531954864, "post_id": 51410638, "comment_id": 89795801, "body": "I&#39;m not using UDFs currently, but it seems pretty easy to move over.  I&#39;ll give it a shot thanks."}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "reply_to_user": {"reputation": 1360, "user_id": 1618041, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a532f7f1a6acec773e7433446044fb2?s=128&d=identicon&r=PG", "display_name": "rhaskett", "link": "https://stackoverflow.com/users/1618041/rhaskett"}, "edited": false, "score": 0, "creation_date": 1531995725, "post_id": 51410638, "comment_id": 89811166, "body": "@rhaskett I&#39;ve updated my answer to reflect <code>RunPython</code> also."}, {"owner": {"reputation": 1360, "user_id": 1618041, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a532f7f1a6acec773e7433446044fb2?s=128&d=identicon&r=PG", "display_name": "rhaskett", "link": "https://stackoverflow.com/users/1618041/rhaskett"}, "edited": false, "score": 0, "creation_date": 1532014755, "post_id": 51410638, "comment_id": 89824648, "body": "Even better.  Appreciated."}], "tags": [], "owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "is_accepted": true, "score": 3, "last_activity_date": 1531995702, "last_edit_date": 1531995702, "creation_date": 1531946355, "answer_id": 51410638, "question_id": 51406629, "link": "https://stackoverflow.com/questions/51406629/can-i-have-xlwings-display-console-output/51410638#51410638", "title": "Can I Have xlwings Display Console Output?", "body": "<p>If you are using UDFs, then there is a simple possibility: By default xlwings uses the <code>pythonw</code> interpreter. Just change it to <code>python</code> and the console window will pop up.</p>\n\n<p>For <code>RunPython</code> you'd need to hack the source code of the addin currently, see <a href=\"https://github.com/ZoomerAnalytics/xlwings/issues/639\" rel=\"nofollow noreferrer\">here</a>. Basically search for <code>WindowStyle</code> and set it to 1 instead of 0. It should be easy to make this a config at some point.</p>\n"}], "owner": {"reputation": 1360, "user_id": 1618041, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a532f7f1a6acec773e7433446044fb2?s=128&d=identicon&r=PG", "display_name": "rhaskett", "link": "https://stackoverflow.com/users/1618041/rhaskett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 51410638, "answer_count": 1, "score": 0, "last_activity_date": 1531995702, "creation_date": 1531930332, "last_edit_date": 1531932108, "question_id": 51406629, "link": "https://stackoverflow.com/questions/51406629/can-i-have-xlwings-display-console-output", "title": "Can I Have xlwings Display Console Output?", "body": "<p>Is it possible for xlwings to pop up a console while running a script from VBA and show stdout?</p>\n\n<p>I know xlwings writes the stdout to a logfile which is useful, but I'd like to give users some updates while they are waiting for their calculation to finish.  The debugger kind of does this but seems like overkill.</p>\n"}, {"tags": ["excel", "vba", "image", "embed"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 3, "creation_date": 1531930206, "post_id": 51406551, "comment_id": 89784270, "body": "No offence but if you&#39;ve &quot;consulted [your] IT VBA specialists&quot; you should have a solution by now. If not, does your company have any openings for a VBA dev who actually knows VBA? :D . Just use the paths in the hyperlinks to import the files."}, {"owner": {"reputation": 89, "user_id": 8472728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GZ0CTP8NuP8/AAAAAAAAAAI/AAAAAAAAEW8/ATYpK7YYug0/photo.jpg?sz=128", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/8472728/chrisd"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1531930313, "post_id": 51406551, "comment_id": 89784347, "body": "VBA expertise is not huge here. There are literally hundreds of files, hence trying to avoid manual option. But thank you."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1531930403, "post_id": 51406551, "comment_id": 89784408, "body": "Ok, that was flippant, apologies. My point was this is simple and there are many solutions already. Take a look at this for example, it should help: <a href=\"https://www.extendoffice.com/documents/excel/4212-excel-insert-image-from-url.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>"}, {"owner": {"reputation": 89, "user_id": 8472728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GZ0CTP8NuP8/AAAAAAAAAAI/AAAAAAAAEW8/ATYpK7YYug0/photo.jpg?sz=128", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/8472728/chrisd"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1531930630, "post_id": 51406551, "comment_id": 89784526, "body": "Ha - np :)  Ref that link: I think it was that piece of code which got me into this mess in the first place.  This is a different requirement: I need to embed previously inserted linked images."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1531931200, "post_id": 51406551, "comment_id": 89784839, "body": "Can you please <a href=\"https://stackoverflow.com/posts/51406551/edit\">edit</a> your question to include the code you used to insert the pictures, and what you&#39;ve tried to solve your issue? Also, where did the image links come from in the fist place (a generated list perhaps?)"}, {"owner": {"reputation": 89, "user_id": 8472728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GZ0CTP8NuP8/AAAAAAAAAAI/AAAAAAAAEW8/ATYpK7YYug0/photo.jpg?sz=128", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/8472728/chrisd"}, "edited": false, "score": 0, "creation_date": 1531931693, "post_id": 51406551, "comment_id": 89785151, "body": "Added the code, for what it&#39;s worth. The image links are generated by user selecting file name from a drop-down menu. This file name is picked up by the script shown above and the Pictures.Insert method used."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1531932814, "post_id": 51406551, "comment_id": 89785752, "body": "I&#39;m not sure there&#39;s any easy way to identify   the source of a linked image without dissecting the source XML for the workbook.  Steps here, but it would take some work to automate this...   <a href=\"https://stackoverflow.com/questions/37145369/change-path-to-picture-links-in-excel\" title=\"change path to picture links in excel\">stackoverflow.com/questions/37145369/&hellip;</a>"}, {"owner": {"reputation": 89, "user_id": 8472728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GZ0CTP8NuP8/AAAAAAAAAAI/AAAAAAAAEW8/ATYpK7YYug0/photo.jpg?sz=128", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/8472728/chrisd"}, "edited": false, "score": 0, "creation_date": 1531933021, "post_id": 51406551, "comment_id": 89785864, "body": "I am beginning to fear this. I was hoping perhaps there might be an &#39;embedimages=TRUE&#39; parameter for SaveAs, but it seems not."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531934982, "post_id": 51406551, "comment_id": 89786912, "body": "Can you copy/paste the inserted images and delete the linked version?"}, {"owner": {"reputation": 89, "user_id": 8472728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GZ0CTP8NuP8/AAAAAAAAAAI/AAAAAAAAEW8/ATYpK7YYug0/photo.jpg?sz=128", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/8472728/chrisd"}, "edited": false, "score": 0, "creation_date": 1531941962, "post_id": 51406551, "comment_id": 89790620, "body": "Thanks \u2013 I&#39;ll try this later and let you know."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1531935983, "creation_date": 1531935983, "answer_id": 51408128, "question_id": 51406551, "link": "https://stackoverflow.com/questions/51406551/embed-images-previously-inserted-using-pictures-insert/51408128#51408128", "title": "Embed images previously inserted using Pictures.Insert", "body": "<p>You could copy the images and replace them with a pasted copy:</p>\n\n<pre><code>Sub Macro1()\n\n    Unlink ActiveSheet.Shapes(1)\n\nEnd Sub\n\n\nSub Unlink(s)\n\n    Dim t, l, h, w, ws\n    With s\n        Set ws = .DrawingObject.Parent\n        t = .Top\n        l = .Left\n        h = .Height\n        w = .Width\n        .Copy\n        'might need to adjust the paste format...\n        ws.PasteSpecial Format:=\"Picture (PNG)\", _\n                   Link:=False, DisplayAsIcon:=False\n    End With\n\n    With ws.Shapes(ws.Shapes.Count)\n        .Top = t\n        .Left = l\n        .Height = h\n        .Width = w\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8472728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GZ0CTP8NuP8/AAAAAAAAAAI/AAAAAAAAEW8/ATYpK7YYug0/photo.jpg?sz=128", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/8472728/chrisd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1531935983, "creation_date": 1531930020, "last_edit_date": 1531932783, "question_id": 51406551, "link": "https://stackoverflow.com/questions/51406551/embed-images-previously-inserted-using-pictures-insert", "title": "Embed images previously inserted using Pictures.Insert", "body": "<p>I've built a template which helps users insert images.</p>\n\n<p>In VBA I used <strong>Pictures.insert</strong>, however I've subsequently discovered that this method sneakily inserts a LINK to the image by default instead of embedding it. Obviously this means that it cannot be viewed by 3rd parties who are not connected to our network.</p>\n\n<p>So, while I've now fixed the <em>templates</em>, there are a couple of hundred files across various folders which have already been set up and filled with linked images.</p>\n\n<p>What <em>I think</em> I need is a VBA script which will go through every worksheet in every visible workbook in a chosen folder system and 'convert' all linked images to embedded (nb. some images have been inserted manually so are not linked)</p>\n\n<p>I've consulted my IT contact and searched here and elsewhere online but I can't find a solution. </p>\n\n<p>Does anyone have any thoughts, please?</p>\n\n<p>Simple sample attached.\n<a href=\"https://drive.google.com/open?id=17m8JaBQbTV7FVcWvWC-zBnzgUfqRi2r5\" rel=\"nofollow noreferrer\">ImageLink Excel doc saved on Google Drive</a></p>\n\n<hr>\n\n<p>Here's the code I used to INSERT the image, if it's any help. The logic for generating the URL was handled in the spreadsheet:</p>\n\n<pre><code>Sub InsertImage()\n' This script inserts the image file referenced by the active cell\n' Via https://www.extendoffice.com/documents/excel/4212-excel-insert-image-from-url.html\n\nDim Rng As Range\nDim filenam As String\n\nOn Error Resume Next\n\nApplication.ScreenUpdating = False\n\nSet Rng = Selection\n\nSheets(\"Sheet1\").Range(\"activefile\").Value = Rng.Value\n\nfilenam = Range(\"filenurl\").Value\n\nActiveSheet.Pictures.Insert(filenam).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531930955, "post_id": 51406419, "comment_id": 89784705, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i> This is a site where programmers <i>write their own code</i> and share issues with a <i>specific</i> problem after trying to solve it on their own. If, after <b><a href=\"//meta.stackoverflow.com/questions/261592\">doing more research</a></b>, you have a <i>specific</i> problem, please <a href=\"https://stackoverflow.com/posts/51406419/edit\">edit</a> your post to share <a href=\"//stackoverflow.com/help/mcve\">examples of your code</a> and some background info. Some good reading to get you started: &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as tips <b><a href=\"//codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">here</a></b> and <b><a href=\"//meta.stackoverflow.com/questions/347937/\">here</a></b>"}, {"owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532021415, "post_id": 51406419, "comment_id": 89828531, "body": "sorry totally forgot the code"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1532022482, "post_id": 51428901, "comment_id": 89829055, "body": "I suggest a revision to your answer, to make the code a bit more legible and to take advantage of boolean expressions :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1532022450, "last_edit_date": 1532022450, "creation_date": 1532022108, "answer_id": 51428901, "question_id": 51406419, "link": "https://stackoverflow.com/questions/51406419/excel-vba-if-listbox-selected-value-2-then-show-textbox4-else-hide-textbox/51428901#51428901", "title": "Excel vba : If Listbox selected value = 2 then show textbox4 else hide textbox", "body": "<p>Found it</p>\n\n<pre><code>Private Sub OUtypes_Change()\nIf OUtypes = \"Multi Split\" Then\nLabel18.Visible = True\nMultisplit.Visible = True\nElse\nLabel18.Visible = False\nMultisplit.Visible = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Edit: This can be consolidated to be a bit more legible, by using booleans:</p>\n\n<pre><code>Private Sub OUtypes_Change()\n\n    visible = (OUtypes = \"Multi Split\") ' Boolean expression\n    Label18.Visible = visible\n    Multisplit.Visible = visible\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4343040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Hnv.gif?s=128&g=1", "display_name": "eVinx", "link": "https://stackoverflow.com/users/4343040/evinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 51428901, "answer_count": 1, "score": 0, "last_activity_date": 1594206878, "creation_date": 1531929557, "last_edit_date": 1594206878, "question_id": 51406419, "link": "https://stackoverflow.com/questions/51406419/excel-vba-if-listbox-selected-value-2-then-show-textbox4-else-hide-textbox", "title": "Excel vba : If Listbox selected value = 2 then show textbox4 else hide textbox", "body": "<p>I have a listbox with values from a sheet called <code>Database OUtypes</code>. Values are:</p>\n\n<ol>\n<li>Single Split</li>\n<li>Multi Split</li>\n<li>City Multi</li>\n</ol>\n\n<p>I want a \"MultiSplit\"(textbox) that shows when value <code>2</code> is selected in listbox and hide when the other values are selected.</p>\n\n<p>How can i do that ?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton3_Click()\nUnload Me\nMenu.Show\nEnd Sub\n\nPrivate Sub userform_activate()\nApplication.DisplayAlerts = False\nDim cell As Range\nWith Worksheets(\"Database Bedrijf\")\nFor Each cell In .Range(\"B1:B1000\" &amp; .cells(Rows.Count, 3).End(xlUp).Row)\nIf Not IsEmpty(cell) Then Bedrijf.AddItem cell.Value\nNext cell\nEnd With\nWith Worksheets(\"Database Freon\")\nFor Each cell In .Range(\"B1:B1000\" &amp; .cells(Rows.Count, 3).End(xlUp).Row)\nIf Not IsEmpty(cell) Then Freontype.AddItem cell.Value\nNext cell\nEnd With\nWith Worksheets(\"Database OUtypes\")\nFor Each cell In .Range(\"B2:B1000\" &amp; .cells(Rows.Count, 3).End(xlUp).Row)\nIf Not IsEmpty(cell) Then OUtypes.AddItem cell.Value\nNext cell\nEnd With\n'''This declares the data type of the variable \"LstRw'\nDim LstRw As Long\n'''This defines what the variable \"LstRw' is to refer to. _\n   (The row number of the last used cell in column A.)\nLstRw = cells(Rows.Count, \"A\").End(xlUp).Row\n'''This tells the textbox named ID to equal the value of the last used cell in Col.A after adding 1 to it.\nID.caption = cells(LstRw, \"A\").Value + 1\nEnd Sub\n\n\nPrivate Sub Freontypes_Change()\n\n    gwp.Text = Application.VLookup(Freontype.Value, Worksheets(\"Database Freon\").Range(\"B2:C1000\"), 2, False)\n\nEnd Sub\n\nPrivate Sub Bedrijf_Change()\nDim RowMax As Integer\nDim wsh As Worksheet\nDim countExit As Integer\nDim CellCombo2 As String\nDim i As Integer\n\nSet wsh = ThisWorkbook.Sheets(\"Database Klant\")\nRowMax = wsh.cells(Rows.Count, \"B\").End(xlUp).Row\n'find last row of sheet in column A\n\nKlant.Clear\n'clear all value of comboBox2\n\nWith Klant\n    For i = 2 To RowMax\n        If wsh.cells(i, \"B\").Value = Bedrijf.Text Then\n        'Just show value of mapping with column A\n        .AddItem wsh.cells(i, \"C\").Value\n        Else\n        End If\n    Next i\nEnd With\nEnd Sub\nPrivate Sub Freoninhoud_Change()\n    If Freoninhoud.Text = \"\" Then\n        MsgBox \"Vul iets in\"\n        Exit Sub\n    Else\n     Co2.Text = CDbl(Replace(Me.Freoninhoud.Text, \".\", \",\")) * gwp.Text\n    End If\nEnd Sub\n\nPrivate Sub Userform_Initialize()\n    Status.AddItem \"Goed\"\n    Status.AddItem \"Slecht\"\n    Status.AddItem \"Defect\"\n\nDim RowMax As Integer\nDim wsh As Worksheet\nDim countExit As Integer\nDim CellCombo1 As String\nDim i As Integer\nDim j As Integer\n\nSet wsh = ThisWorkbook.Sheets(\"Database Bedrijf\")\nRowMax = wsh.cells(Rows.Count, \"B\").End(xlUp).Row\n'find last row of sheet in column A\n\nBedrijf.Clear\n'clear all value of comboBox1\n\nWith Bedrijf\n\n    For i = 2 To RowMax\n    'Run each row of column A\n\n    countExit = 0\n    CellCombo1 = wsh.cells(i, \"B\").Value\n\n            For j = i To 2 Step -1\n            'just show value not duplicate\n\n            If CellCombo1 = wsh.cells(j, \"A\").Value Then\n            countExit = countExit + 1\n            End If\n            Next j\n        If countExit = 0 Then\n\n        ElseIf countExit &gt; 1 Then\n            Else\n            .AddItem CellCombo1\n            End If\n    Next i\n\nEnd With\nEnd Sub\n\n\nPrivate Sub CommandButton1_Click()\nDim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Database OU\")\n    lRow = ws.cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        With ws\n        .cells(lRow, 1).Value = ID.caption\n        .cells(lRow, 2).Value = Bedrijf.Value\n        .cells(lRow, 3).Value = Klant.Value\n        .cells(lRow, 4).Value = Ruimte.Value\n        .cells(lRow, 5).Value = Merk.Value\n        .cells(lRow, 6).Value = Types.Value\n        .cells(lRow, 7).Value = Multisplit.Value\n        .cells(lRow, 8).Value = Model.Value\n        .cells(lRow, 9).Value = Serienummer.Value\n        .cells(lRow, 10).Value = Bouwjaar.Value\n        .cells(lRow, 11).Value = Afvoer.Value\n        .cells(lRow, 12).Value = Freontype.Value\n        .cells(lRow, 13).Value = Freoninhoud.Value\n        .cells(lRow, 14).Value = Co2.Text\n        .cells(lRow, 15).Value = Installatienummer.Value\n        .cells(lRow, 16).Value = Adres.Value\n        .cells(lRow, 17).Value = Status.Value\n    End With\n    Unload Me\n    Menu.Show\nEnd Sub\nPrivate Sub CommandButton2_Click()\nDim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Database OU\")\n    lRow = ws.cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        With ws\n        .cells(lRow, 1).Value = ID.caption\n        .cells(lRow, 2).Value = Bedrijf.Value\n        .cells(lRow, 3).Value = Klant.Value\n        .cells(lRow, 4).Value = Ruimte.Value\n        .cells(lRow, 5).Value = Merk.Value\n        .cells(lRow, 6).Value = Types.Value\n        .cells(lRow, 7).Value = Multisplit.Value\n        .cells(lRow, 8).Value = Model.Value\n        .cells(lRow, 9).Value = Serienummer.Value\n        .cells(lRow, 10).Value = Bouwjaar.Value\n        .cells(lRow, 11).Value = Afvoer.Value\n        .cells(lRow, 12).Value = Freontype.Value\n        .cells(lRow, 13).Value = Freoninhoud.Value\n        .cells(lRow, 14).Value = Co2.Text\n        .cells(lRow, 15).Value = Installatienummer.Value\n        .cells(lRow, 16).Value = Adres.Value\n        .cells(lRow, 17).Value = Status.Value\n    End With\n    Unload Me\n    Outoevoegen.Show\nEnd Sub\n\n\nPrivate Sub Userform_QueryClose(Cancel As Integer, closemode As Integer)\nIf closemode = vbFormControlMenu Then\n    MsgBox \"Sorry gebruik de Sluiten knop\"\n    Cancel = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "user-defined-types", "autoexec"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 5, "creation_date": 1531928549, "post_id": 51405980, "comment_id": 89783126, "body": "Arent you missing an excel object model reference?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1531929785, "post_id": 51405980, "comment_id": 89784008, "body": "How are you specifying the xlbook parameter?"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 3, "creation_date": 1531930077, "post_id": 51405980, "comment_id": 89784175, "body": "As Doug said, go into Tools&gt;References and Add Excel"}, {"owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "edited": false, "score": 0, "creation_date": 1531940865, "post_id": 51405980, "comment_id": 89790103, "body": "I am specifying the xlBook as an Object"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1532016329, "post_id": 51405980, "comment_id": 89825696, "body": "If you don&#39;t want to set the reference to Excel (why? if you have Outlook and Office already?), you&#39;ll need to do <code>Public Sub WFR_Style(xlBook As Object)</code>"}], "owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532080171, "creation_date": 1531928245, "last_edit_date": 1532080171, "question_id": 51405980, "link": "https://stackoverflow.com/questions/51405980/vba-access-user-defined-type-not-defined-when-running-my-autoexec-macro", "title": "VBA Access User-Defined Type not Defined when Running my AutoExec Macro", "body": "<p>I am trying to test out my code that I have written, and when I go to run my AutoExec macro, I get the error </p>\n\n<blockquote>\n  <p>\"User-defined type not Defined\" </p>\n</blockquote>\n\n<p>on the following line of code:</p>\n\n<pre><code>Public Sub WFR_Style(xlBook As Excel.Workbook)\n</code></pre>\n\n<p>I have the following references set up under my Tools->References:</p>\n\n<ul>\n<li>Microsoft Access 16.0 Object Library</li>\n<li>OLE Automation</li>\n<li>Microsoft ActiveX Data Objects 6.1 Library</li>\n<li>Microsoft Outlook 16.0 Object Library</li>\n<li>Microsoft Office 16.0 Access database engine object library</li>\n<li>Visual Basic for Applications</li>\n</ul>\n\n<p>Am I missing any? </p>\n"}, {"tags": ["excel", "vba", "filtering"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1531928554, "post_id": 51405871, "comment_id": 89783131, "body": "<code>xlfiltervalues</code> is for when you supply an array of filter values. You aren&#39;t doing that so remove the operator argument."}, {"owner": {"reputation": 336, "user_id": 1268096, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe44f97581f87362589676aaeeabb29b?s=128&d=identicon&r=PG", "display_name": "Ramrod", "link": "https://stackoverflow.com/users/1268096/ramrod"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1531929288, "post_id": 51405871, "comment_id": 89783618, "body": "Hi Rory, I removed the Operator argument as you suggested and I am receiving the same error."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1531932583, "post_id": 51405871, "comment_id": 89785641, "body": "<code>Criteria1:=</code>, not <code>Criteria</code>"}, {"owner": {"reputation": 336, "user_id": 1268096, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe44f97581f87362589676aaeeabb29b?s=128&d=identicon&r=PG", "display_name": "Ramrod", "link": "https://stackoverflow.com/users/1268096/ramrod"}, "edited": false, "score": 0, "creation_date": 1531934615, "post_id": 51405871, "comment_id": 89786723, "body": "Hi BigBen, please make that an answer. That was surprisingly simple."}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 1268096, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe44f97581f87362589676aaeeabb29b?s=128&d=identicon&r=PG", "display_name": "Ramrod", "link": "https://stackoverflow.com/users/1268096/ramrod"}, "edited": false, "score": 0, "creation_date": 1531934921, "post_id": 51407830, "comment_id": 89786874, "body": "Thanks BigBen, that completely eluded me. That&#39;s a rather embarrassing minor omission!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1531934801, "creation_date": 1531934801, "answer_id": 51407830, "question_id": 51405871, "link": "https://stackoverflow.com/questions/51405871/dynamic-table-filtering-gives-error-1004/51407830#51407830", "title": "Dynamic Table Filtering Gives Error 1004", "body": "<p>Just a small typo: <code>Criteria1:=...</code> instead of <code>Criteria:=...</code>\nSee the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-autofilter-method-excel\" rel=\"nofollow noreferrer\"><code>Range.AutoFilter</code></a> method for more detail.</p>\n\n<p>Note that you shouldn't use the Operator argument as mentioned by @Rory in the comments.</p>\n"}], "owner": {"reputation": 336, "user_id": 1268096, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe44f97581f87362589676aaeeabb29b?s=128&d=identicon&r=PG", "display_name": "Ramrod", "link": "https://stackoverflow.com/users/1268096/ramrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 51407830, "answer_count": 1, "score": 0, "last_activity_date": 1594210226, "creation_date": 1531927909, "last_edit_date": 1594210226, "question_id": 51405871, "link": "https://stackoverflow.com/questions/51405871/dynamic-table-filtering-gives-error-1004", "title": "Dynamic Table Filtering Gives Error 1004", "body": "<p>I followed a pretty simple VBA dynamic filtering tutorial for Tables - but I have no VBA experience and am unable to figure out why I'm receiving Error 1004 - Application-defined or object-defined error.</p>\n\n<p>For reference, I have a Table in my Active Worksheet called \"AcronymList\"</p>\n\n<p>My VBA filter code is as follows:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n'Filter acronyms in AcronymList Table.\nActiveSheet.ListObjects(\"AcronymList\").Range.AutoFilter Field:=1, Criteria:=\"*\" &amp; [A3] &amp; \"*\", Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>Any time I add / remove text from my A3 ActiveX TextBox, the error occurs. </p>\n\n<p>Thanks for any pointers.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531928084, "post_id": 51405811, "comment_id": 89782817, "body": "You want it to ONLY remove characters 0,1,2,3,4,5,6,7,8 and 9?"}, {"owner": {"reputation": 11, "user_id": 10088615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nNQJ4epO5VY/AAAAAAAAAAI/AAAAAAAAABs/Om2HeikBI8w/photo.jpg?sz=128", "display_name": "Tardisgx", "link": "https://stackoverflow.com/users/10088615/tardisgx"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531943383, "post_id": 51405811, "comment_id": 89791316, "body": "I probably shouldn&#39;t have included that other UDF at all.  I need to remove non-numeric characters i.e keeping just 1,2,3,4,5,6,7,8,9,0"}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1531934344, "post_id": 51406048, "comment_id": 89786600, "body": "With <code>.Replace</code>, if you want to return the original string if <code>.Pattern</code> is not present, you can omit the <code>If .Test(\u2026</code> portion.  Just use <code>Result = .Replace(str, vbNullString)</code> by itself"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1531935014, "last_edit_date": 1531935014, "creation_date": 1531928494, "answer_id": 51406048, "question_id": 51405811, "link": "https://stackoverflow.com/questions/51405811/need-excel-udf-to-remove-nonnumeric-characters/51406048#51406048", "title": "Need Excel UDF to remove nonnumeric characters", "body": "<p>One of these should do.</p>\n\n<pre><code>Function keepNums(str As String)\n    Static rgx As Object\n\n    'with rgx as static, it only has to be created once; beneficial when filling a long column with this UDF\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n    keepNums = vbNullString\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"[^0-9]\"\n        keepNums = .Replace(str, vbNullString)\n    End With\nEnd Function\n\nFunction delNums(str As String)\n    Static rgx As Object\n\n    'with rgx as static, it only has to be created once; beneficial when filling a long column with this UDF\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n    delNums = vbNullString\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"[0-9]\"\n        delNums = .Replace(str, vbNullString)\n    End With\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531930347, "post_id": 51406204, "comment_id": 89784372, "body": "Is it just me or is it hard to understand whether the op wants to keep numbers or get rid of them?"}, {"owner": {"reputation": 11, "user_id": 10088615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nNQJ4epO5VY/AAAAAAAAAAI/AAAAAAAAABs/Om2HeikBI8w/photo.jpg?sz=128", "display_name": "Tardisgx", "link": "https://stackoverflow.com/users/10088615/tardisgx"}, "edited": false, "score": 0, "creation_date": 1531943515, "post_id": 51406204, "comment_id": 89791377, "body": "I probably shouldn&#39;t have included that other UDF at all. I&#39;ve edited it out now the request should be clearer I need to remove non-numeric characters i.e keeping just 1,2,3,4,5,6,7,8,9,0"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1531987972, "last_edit_date": 1531987972, "creation_date": 1531928977, "answer_id": 51406204, "question_id": 51405811, "link": "https://stackoverflow.com/questions/51405811/need-excel-udf-to-remove-nonnumeric-characters/51406204#51406204", "title": "Need Excel UDF to remove nonnumeric characters", "body": "<p>Here are both routines, one to remove all numeric characters, and the other to remove everything but numeric characters:</p>\n\n<pre><code>Function deleteNumeric(strSource As String) As String\n    Dim delChar As Integer\n    For delChar = 48 To 57 ' ASCII code 48 is '0', through to 57 for '9'\n        strSource = Replace(strSource, Chr(delChar), \"\")\n    Next\n    deleteNumeric = strSource\nEnd Function\n\nFunction keepNumeric(strSource As String) As String\n    Dim indxChar As Long, eachChar As String\n    For indxChar = 1 To Len(strSource)\n        eachChar = Asc(Mid(strSource, indxChar, 1))\n        If eachChar &gt; 47 And eachChar &lt;= 57 Then\n        keepNumeric = keepNumeric &amp; Chr(eachChar)\n        End If\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10088615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nNQJ4epO5VY/AAAAAAAAAAI/AAAAAAAAABs/Om2HeikBI8w/photo.jpg?sz=128", "display_name": "Tardisgx", "link": "https://stackoverflow.com/users/10088615/tardisgx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1594210377, "answer_count": 2, "score": -3, "last_activity_date": 1594210373, "creation_date": 1531927743, "last_edit_date": 1594210373, "question_id": 51405811, "link": "https://stackoverflow.com/questions/51405811/need-excel-udf-to-remove-nonnumeric-characters", "closed_reason": "Needs more focus", "title": "Need Excel UDF to remove nonnumeric characters", "body": "<p>I don't have a list of what classifies as a non-numeric.\nPlease help </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 4, "creation_date": 1531928144, "post_id": 51405731, "comment_id": 89782857, "body": "This question is asked almost every day now and we have tons on SO!"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1531928293, "post_id": 51405731, "comment_id": 89782955, "body": "What to do when duplicate question is asked  <a href=\"https://meta.stackexchange.com/questions/10841/how-should-duplicate-questions-be-handled\" title=\"how should duplicate questions be handled\">meta.stackexchange.com/questions/10841/&hellip;</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531928395, "post_id": 51405731, "comment_id": 89783024, "body": "Not sure this question is for SO as OP doesn&#39;t have an issue with his code, they just want to know a better way to do this. Possible for one of the sister sites where code is reviewed"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1531928512, "post_id": 51405731, "comment_id": 89783097, "body": "@TDJ: also, take a look at <a href=\"https://msdn.microsoft.com/en-us/vba/vba-excel\" rel=\"nofollow noreferrer\">MSDN: Excel VBA reference</a> and <a href=\"http://www.cpearson.com/Excel/Topic.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s excellent site</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1531928074, "post_id": 51405868, "comment_id": 89782814, "body": "Maybe next time! ;)"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1531928709, "post_id": 51405868, "comment_id": 89783219, "body": "OP code will stop if there is an empty cell in column A."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1531928967, "post_id": 51405868, "comment_id": 89783408, "body": "@VincentG From the sounds of it he doesn&#39;t have empty cells in column A, but according to his question he wanted to &quot;paste it down as many rows that are filled in column A&quot;, which sounds like the typical fill down to last row situation."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 4, "last_activity_date": 1531928018, "last_edit_date": 1531928018, "creation_date": 1531927901, "answer_id": 51405868, "question_id": 51405731, "link": "https://stackoverflow.com/questions/51405731/avoiding-select-with-copy-and-paste-vba/51405868#51405868", "title": "Avoiding Select with Copy and Paste VBA", "body": "<p>All of that code can be translated to this:</p>\n\n<p><code>Range(\"B1:B\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).Value = Range(\"B1\").Value</code></p>\n\n<p>We're making the <code>Range</code> of cells <code>B1</code> through <code>B</code> and the last row of cells in column <code>A</code> (which we get by using <code>Cells(Rows.Count, \"A\").End(xlUp).Row</code>) equal to the value in cell <code>B1</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gsMhz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gsMhz.png\" alt=\"img1\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531928077, "post_id": 51405915, "comment_id": 89782815, "body": "Nope. OP wants the value in B1 down, not the values in column A."}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531928195, "post_id": 51405915, "comment_id": 89782895, "body": "Yeah you are right, I read the question wrong.  Looks like dwirony already got the answer for him."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 0, "last_activity_date": 1531928093, "last_edit_date": 1531928093, "creation_date": 1531928035, "answer_id": 51405915, "question_id": 51405731, "link": "https://stackoverflow.com/questions/51405731/avoiding-select-with-copy-and-paste-vba/51405915#51405915", "title": "Avoiding Select with Copy and Paste VBA", "body": "<p>You could do this: </p>\n\n<pre><code>Sub copyPaste()\nDim lastRow As Long\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nSheets(\"Sheet1\").Range(\"B1:B\" &amp; lastRow).Value = Sheets(\"Sheet1\").Range(\"A1:A\" &amp; lastRow).Value\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "edited": false, "score": 0, "creation_date": 1531929348, "post_id": 51406242, "comment_id": 89783668, "body": "Thank you, this is very helpful."}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 3, "last_activity_date": 1531929073, "creation_date": 1531929073, "answer_id": 51406242, "question_id": 51405731, "link": "https://stackoverflow.com/questions/51405731/avoiding-select-with-copy-and-paste-vba/51406242#51406242", "title": "Avoiding Select with Copy and Paste VBA", "body": "<p>Others have provided direct solutions to your code.  But to your question on being \"Coached\" on how to avoid Select, this is what is happening...</p>\n\n<p>Consider .Select as storing a Reference to whatever it's attached to.</p>\n\n<pre><code>Range(\"B1\").Select \n</code></pre>\n\n<p>is saying store a reference to the Range: B1.</p>\n\n<pre><code>Selection.Copy\n</code></pre>\n\n<p>is saying use that reference, and call the function Copy</p>\n\n<p>Instead of using the reference, you can access it directly.</p>\n\n<pre><code>Range(\"B1\").Copy\n</code></pre>\n\n<p>Now since your copying and pasting you have two different references, your source and your destination.  So you can apply the value directly from source to destination, without invoking copy and paste functions.</p>\n\n<pre><code>Range(&lt;DestinationRange&gt;).value = Range(&lt;SourceRange&gt;).value\n</code></pre>\n\n<p>The offset functions are simply saying Start at the Range specified, and move over the specified number of column(s) or row(s), and use this cell as your reference.</p>\n"}], "owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1612, "favorite_count": 0, "accepted_answer_id": 51405868, "answer_count": 3, "score": 2, "last_activity_date": 1594210238, "creation_date": 1531927476, "last_edit_date": 1594210238, "question_id": 51405731, "link": "https://stackoverflow.com/questions/51405731/avoiding-select-with-copy-and-paste-vba", "title": "Avoiding Select with Copy and Paste VBA", "body": "<p>I am trying to reduce my usage of select. I have been referencing the article below but I am not entirely sure how to implement it in this scenario. To practice I have the working set of code below that I use to copy the value in B1 and paste it down as many rows that are filled in column A. If someone could coach me through how to avoid this bad habit in order to write more effective and efficient code, I would greatly appreciate it!</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">How to avoid using Select in Excel VBA</a></p>\n\n<pre><code>    Range(\"B1\").Select\n    Selection.Copy\n    ActiveCell.Offset(0, -1).Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(0, 1).Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(Selection, \"B1\").Select\n    ActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1531931711, "last_edit_date": 1531931711, "creation_date": 1531930326, "answer_id": 51406627, "question_id": 51405702, "link": "https://stackoverflow.com/questions/51405702/vba-paste-data-after-other-vba-copied-data/51406627#51406627", "title": "VBA Paste Data After Other VBA Copied Data", "body": "<p>You do not need to use <code>J</code>. Just offset your <code>i</code> value in your first loop to produce desired <code>J</code> value. </p>\n\n<hr>\n\n<p><strong>On your first loop:</strong><br>\n<code>i = 15</code><br>\n<code>J = 12</code> which is the same is <code>i - 3</code>. </p>\n\n<p>Therefore, you can swap out every instance of <code>J</code> with <code>i - 3</code>. </p>\n\n<p>Next, you can pass <code>i</code> as a parameter (input) into <code>ESTDEUDA</code> using the below method. </p>\n\n<pre><code>Sub ActualizarFondos()\n\nDim i As Integer\n\nFor i = 15 To 26\n    With Sheets(\"Reporte\")\n        If .Cells(i, \"C\").Value &gt; 0 Then\n            .Range(.Cells(i, \"C\"), .Cells(i, \"B\")).Copy\n            ThisWorkbook.Sheets(\"WHATSHEET\").Range(\"Z\" &amp; i - 3).PasteSpecial Paste:=xlPasteValues\n\n            Call ESTDEUDA(i)\n\n        End If\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub ESTDEUDA(i As Integer)\n\nDim x As Long\n\nFor x = 3 To 6\n    With Sheets(\"FondosEstrategia\")\n        If .Cells(x, \"F\").Value &gt; 0 Then\n            .Range(.Cells(x, \"E\"), .Cells(x, \"F\")).Copy\n            Sheets(\"Reporte\").Range(\"Z\" &amp; i - 3).PasteSpecial Paste:=xlPasteValues\n        End If\n    End With\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Also, you need to qualify your instances of <code>Range</code> and <code>Cells</code> with a direct sheet. You should avoid relying to <code>Active</code> or <code>Selected</code> sheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 10100294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a750e1d79226822ff7f59e90afde35f?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montiel", "link": "https://stackoverflow.com/users/10100294/alejandro-montiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531931711, "creation_date": 1531927345, "question_id": 51405702, "link": "https://stackoverflow.com/questions/51405702/vba-paste-data-after-other-vba-copied-data", "title": "VBA Paste Data After Other VBA Copied Data", "body": "<p>I'm trying to have a \"Called Sub\" paste data after the last row used in the one that is calling the code.</p>\n\n<p>However, I can only manage to have the first sub to paste the first data selected and when \"ESTDEUDA\" is called it pastes the other data on information first used.</p>\n\n<pre><code>Sub ActualizarFondos()\n\n'Deuda\nJ = 12\n\nFor i = 15 To 26\nSheets(\"Reporte\").Activate\n\nIf Cells(i, \"C\").Value &gt; 0 Then\nRange(Cells(i, \"C\"), Cells(i, \"B\")).Copy\n\nActiveSheet.Range(Cells(J, \"Z\"), Cells(J, \"AA\")).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n\n'Call ESTDEUDA\n\nJ = J + 1\n\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub ESTDEUDA()\n\nJ = 12\n\nFor i = 3 To 6\nSheets(\"FondosEstrategia\").Activate\n\nIf Cells(i, \"F\").Value &gt; 0 Then\nRange(Cells(i, \"E\"), Cells(i, \"F\")).Select\nRange(Cells(i, \"E\"), Cells(i, \"F\")).Copy\n\n\nSheets(\"Reporte\").Activate\nRange(Cells(J, \"Z\"), Cells(J, \"AA\")).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nJ = J + 1\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>I'd like to know what can be done in order to have the information from sheet \"FondosEstrategia\" to be pasted after the infomation pasted from sheet \"Reporte\".</p>\n\n<p>Is there any way that a kind of J = J +1 is applied to \"ESTDEUDA\" in order to paste after J = J +1 from \"ActualizarFondos\".</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10100468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1518dadc4fabeb6b509d65e6cc5f0a95?s=128&d=identicon&r=PG&f=1", "display_name": "Basho", "link": "https://stackoverflow.com/users/10100468/basho"}, "edited": false, "score": 0, "creation_date": 1531984902, "post_id": 51406080, "comment_id": 89804336, "body": "Thank you that&#39;s perfect !"}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": true, "score": 0, "last_activity_date": 1531928584, "creation_date": 1531928584, "answer_id": 51406080, "question_id": 51405609, "link": "https://stackoverflow.com/questions/51405609/copy-content-from-closed-work-book-column/51406080#51406080", "title": "Copy content from closed work book column", "body": "<p>This is a lot easier way to do that:</p>\n\n<pre><code>Sub copyColData00()\n    Dim lastRow As Long\n    Dim wkBk1 As Workbook, wkBk2 As Workbook\n    Dim wkSht As Object\n    Dim mnt As String\n\n    mnt = InputBox(\"Enter Filename\")\n    Set wkBk1 = ActiveWorkbook\n    Set wkBk2 = Workbooks.Open(\"\\\\n\\Documents\\\" &amp; mnt &amp; \".xlsx\")\n    lastRow = wkBk2.Sheets(1).Range(\"R\" &amp; Rows.Count).End(xlUp).Row\n\n    wkBk1.Sheets(1).Range(\"R1:R\" &amp; lastRow).Value = wkBk2.Sheets(1).Range(\"R1:R\" &amp; lastRow).Value 'change which sheet you want for wkBk1\n\n    wkBk2.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10100468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1518dadc4fabeb6b509d65e6cc5f0a95?s=128&d=identicon&r=PG&f=1", "display_name": "Basho", "link": "https://stackoverflow.com/users/10100468/basho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13, "favorite_count": 0, "accepted_answer_id": 51406080, "answer_count": 1, "score": 0, "last_activity_date": 1531928584, "creation_date": 1531927051, "question_id": 51405609, "link": "https://stackoverflow.com/questions/51405609/copy-content-from-closed-work-book-column", "title": "Copy content from closed work book column", "body": "<p>As said in the title I'm trying to copy data from a column into a new workbook as its a weekly report where the data I add in this column remains valid.</p>\n\n<pre><code>Sub copyColData00()\n\nDim lastRow As Long\n\nDim myApp As Excel.Application\n\nDim wkBk As Workbook\n\nDim wkSht As Object\n\nDim mnt As String\n\n\n\nSet myApp = CreateObject(\"Excel.Application\")\n\nmnt = InputBox(\"Enter Filename\")\n\nSet wkBk = Workbooks.Open(\"\\\\n\\Documents\\\" &amp; mnt &amp; \".xlsx\")\n\nlastRow = wkBk.Sheets(1).Range(\"R\" &amp; Rows.Count).End(xlUp).Row\n\nwkBk.Sheets(1).Range(\"R1:R\" &amp; lastRow).Copy\n\nmyApp.DisplayAlerts = False\n\nwkBk.Close\n\nmyApp.Quit\n\nSet wkBk = Nothing\n\nSet myApp = Nothing\n\nSet wkBk = ActiveWorkbook\n\nSet wkSht = wkBk.Sheets(\"Sheet1\")\n\nwkSht.Activate\n\nRange(\"R1\").Select\n\nwkSht.Paste\n\nExit Sub\n\n\n\nEnd Sub\n</code></pre>\n\n<p>My problem is that I want it to past it directly while there I get a prompt that ask if I want to copy all the data in the clip board or not and my second problem is that at\n Set wkSht = wkBk.Sheets(\"Sheet1\")\nIt gives me the error subscript out of range I've trouble understanding what happens there if someone could help it would be nice! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1531927088, "post_id": 51405564, "comment_id": 89782161, "body": "<i>I&#39;m struggling to export the users selection into a variable to be used later on</i>. OK, I think you&#39;re on the right track re: scope. Can you show us the code from &quot;later on&quot; where you&#39;re trying to use the value from the <code>cboIP.Value</code>? Why not have the <code>cmdOK_Click()</code> button call the dependent procedure(s) and pass the value as parameter?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531927884, "post_id": 51405704, "comment_id": 89782693, "body": "You&#39;re on the right track. But since the state is stored in the global/default instance of the form, that <code>Unload Me</code> basically resets the state to its initial default, making the calling code unable to retrieve the correct/intended state. Avoiding <code>Unload Me</code> and avoiding forms&#39; default instance fixes this."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531927986, "post_id": 51405704, "comment_id": 89782760, "body": "So, change <code>Unload Me</code> to <code>Me.Hide</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531928024, "post_id": 51405704, "comment_id": 89782795, "body": "Exactly! I wrote <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">an article</a> about this a little while back."}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 1, "last_activity_date": 1531928320, "last_edit_date": 1531928320, "creation_date": 1531927354, "answer_id": 51405704, "question_id": 51405564, "link": "https://stackoverflow.com/questions/51405564/obtaining-a-single-variable-from-a-userform-in-visual-basic/51405704#51405704", "title": "Obtaining a single variable from a userform in Visual Basic", "body": "<p>You need to add a <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/writing-a-property-procedure\" rel=\"nofollow noreferrer\">public property</a> to your form ...</p>\n\n<pre><code>Private m_OptionChoice as String\n\nProperty Let OptionChoice(value As String)\n    m_OptionChoice = value\nEnd Property\n\nProperty Get OptionChoice() As String\n    OptionChoice = m_OptionChoice\nEnd Property\n</code></pre>\n\n<p>And then change your OK button code to ...</p>\n\n<pre><code>Public Sub cmdOK_Click()\n    OptionChoice = cboIP.Value\n    MsgBox \"Combo Box Value \" &amp; uOption\n    'Above line used to see if variable has been assigned\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Now when your form closes, you can access the OptionChoice via <code>ufrmIPSelection.OptionChoice</code>. Eg change ...</p>\n\n<pre><code>MsgBox \"Option captured is \" &amp; uOption\n</code></pre>\n\n<p>to ...</p>\n\n<pre><code>MsgBox \"Option captured is \" &amp; ufrmIPSelection.OptionChoice\n</code></pre>\n\n<hr>\n\n<p>Finally, as suggested in Mathieu Guindon's comment below, you need to replace <code>Unload Me</code> with <code>Me.Hide</code>. Thanks Mathieu!</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9072251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565ccf812b8b6c0268c97b030ef15b5e?s=128&d=identicon&r=PG&f=1", "display_name": "jsjw97", "link": "https://stackoverflow.com/users/9072251/jsjw97"}, "edited": false, "score": 0, "creation_date": 1532010832, "post_id": 51406420, "comment_id": 89821715, "body": "This and 3.1415&#39;s answer have fixed my predicament! Thanks for your assistance."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1531929558, "creation_date": 1531929558, "answer_id": 51406420, "question_id": 51405564, "link": "https://stackoverflow.com/questions/51405564/obtaining-a-single-variable-from-a-userform-in-visual-basic/51406420#51406420", "title": "Obtaining a single variable from a userform in Visual Basic", "body": "<p><code>Unload Me</code> essentially says \"destroy this object\". But a form's <em>default instance</em> isn't just any other object - it's a global instance that's automatically re-created by VBA whenever it's referenced again, if it's ever destroyed. But the re-created instance can't magically remember what the previous state was: the re-created instance therefore has whatever the inital / design-time state was.</p>\n\n<p>Another thing that destroys a form and its state, is the little [X] button in the top-right corner.</p>\n\n<p>A modal form is essentially a <em>dialog</em> - and a dialog can either be accepted, or cancelled. When the user dismisses your dialog by clicking that little [X] button, they're telling your program that they wish to cancel whatever that dialog was intended to be doing.</p>\n\n<p>For this reason, it's important that a dialog does nothing other than <em>collect data</em> from the user. The basic code-behind boilerplate for a <code>UserForm</code> with an <kbd>Ok</kbd> and a <kbd>Cancel</kbd> button, might look like this:</p>\n\n<pre><code>Option Explicit\nPrivate cancelled As Boolean\n\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = cancelled\nEnd Property\n\nPrivate Sub OkButton_Click()\n    Hide\nEnd Sub\n\nPrivate Sub CancelButton_Click()\n    OnCancel\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        Cancel = True\n        OnCancel\n    End If\nEnd Sub\n\nPrivate Sub OnCancel()\n    cancelled = True\n    Hide\nEnd Sub\n</code></pre>\n\n<p>Handling the <code>QueryClose</code> event allows us to cancel the destruction of the form and the resetting of its state when the user clicks that [X] button.</p>\n\n<p>Now the calling code can do this:</p>\n\n<pre><code>ufrmIPSelection.Show\nIf ufrmIPSelection.IsCancelled Then Exit Sub\n</code></pre>\n\n<p>But since that's storing the state in the form's global/default instance, it's a much better idea to do this:</p>\n\n<pre><code>With New ufrmIPSelection\n    .Show\n    If .IsCancelled Then Exit Sub\nEnd With\n</code></pre>\n\n<p>That way every usage of the form is nicely insulated, and the form instance and its state only live as long as it <em>needs</em> to (i.e. it's gone at <code>End With</code>).</p>\n\n<p>You could go ahead and query the individual controls' state from the calling code, but a much cleaner approach would be to <em>encapsulate</em> that state, using properties (a bit like suggested in <a href=\"https://stackoverflow.com/a/51405704/1188513\">3.1415's answer</a>); these properties only need to be <em>read</em> from the calling code, so only a <code>Propery Get</code> member is needed:</p>\n\n<pre><code>Public Property Get SelectedIPType() As String\n    SelectedIPType = cboIP.Value\nEnd Property\n</code></pre>\n\n<p>And now the calling code can do this:</p>\n\n<pre><code>With New ufrmIPSelection\n    .Show\n    If .IsCancelled Then Exit Sub\n    MsgBox .SelectedIPType\nEnd With\n</code></pre>\n\n<p>The next step would be to extract an actual stateful class to encapsulate the <em>model</em>, so as to completely <em>decouple</em> the form from the data.</p>\n\n<p>Read more about forms' default instance in <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a>, an article I wrote a few months ago (the basic code-behind boilerplate snippet is taken from there).</p>\n"}], "owner": {"reputation": 65, "user_id": 9072251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565ccf812b8b6c0268c97b030ef15b5e?s=128&d=identicon&r=PG&f=1", "display_name": "jsjw97", "link": "https://stackoverflow.com/users/9072251/jsjw97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 51406420, "answer_count": 2, "score": 1, "last_activity_date": 1531929558, "creation_date": 1531926920, "question_id": 51405564, "link": "https://stackoverflow.com/questions/51405564/obtaining-a-single-variable-from-a-userform-in-visual-basic", "title": "Obtaining a single variable from a userform in Visual Basic", "body": "<p>I have little VB knowledge but was hoping to figure this out without any help, but <em>alas!</em></p>\n\n<p>I have a spread sheet that shows the layout of HP blades inside a chassis. Currently I have set-up a macro (I right-clicked view code on the sheet) whereby you click on a specific 'blade' (really a few merged cells) and an inputbox appears, asking the user which IP they'd like - this then looks for exact matches (e.g. O - OAM, I - iLO) and depending on the option selected - assigns a value in a case statement. For example: O - OAM IP would assign the number 2 - which performs a VLOOKUP and looks in column 2 to return an IP address to the users clipboard.</p>\n\n<p>I'm trying to change the inputbox to a userform. I've created one and have a simple dropdown with the available options.</p>\n\n<p>I'm struggling to export the users selection into a variable to be used later on. </p>\n\n<p>All of my efforts so far result in a variable being assigned following completion of the 'userform' and pressing the 'OK' button. But that variable is then not assigned in the sheet's code area. I assume it's something to do with scope and assignment. </p>\n\n<p>Code for the worksheet </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"D57:H80\")) Is Nothing Then\n    Dim HostName As String\n    Dim ColIndex As Integer\n    Dim NodeIP As String\n    HostName = ActiveCell.Value\n    ufrmIPSelection.Show\n    'uOption = InputBox(\"Option Required\" &amp; vbCrLf &amp; \"o = OAM IP\" &amp; vbCrLf &amp; \"i = iLO IP\", \"User selection required\")\n    'uOption\n    MsgBox \"Option captured is \" &amp; uOption\n        Select Case uOption\n            Case \"OAM IP\"\n                ColIndex = 2\n            Case \"iLO IP\"\n                ColIndex = 3\n        End Select\n    MsgBox \"Column referenced is \" &amp; ColIndex\n    NodeIP = Application.VLookup(HostName, Sheet7.Range(\"A1:C503\"), ColIndex, False)\n    MsgBox \"Hostname is \" &amp; HostName\n    MsgBox \"Node IP is \" &amp; NodeIP\nEnd If\nEnd Sub\n</code></pre>\n\n<p>and code for the userform OK button</p>\n\n<pre><code>Public Sub cmdOK_Click()\n    uOption = cboIP.Value\n    MsgBox \"Combo Box Value \" &amp; uOption\n    'Above line used to see if variable has been assigned\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531927274, "post_id": 51405541, "comment_id": 89782288, "body": "Is myArray1 = (1, 2, 3, 4) supposed to be a 4-D array or a 1-D array with 4 elements? (&#39;cause that isn&#39;t how you write either)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1531928982, "post_id": 51405541, "comment_id": 89783419, "body": "What the end goal? Are you trying to only insert values into Main Artray that already or dont exist? Havign a more clear picture of what youre trying to achieve might help get at better results/answers"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1531929404, "post_id": 51405541, "comment_id": 89783714, "body": "@Jeeped they are all 1-D arrays."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1531929588, "post_id": 51405541, "comment_id": 89783869, "body": "@DougCoats Basically want to compare elements of each array, mainArray and myArray. If there are two or more elements in myArray for each element in mainArray then either remove the duplicates or make a new array with only elements that appear once."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531941596, "post_id": 51405541, "comment_id": 89790457, "body": "Your last comment greatly changes the scope of your question essentially making it a completely new question. The conditions you&#39;ve added should be incorporated into your question through an <a href=\"https://stackoverflow.com/posts/51405541/edit\">edit</a> and even added into the title."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 9748211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Franksta", "link": "https://stackoverflow.com/users/9748211/franksta"}, "is_accepted": false, "score": -1, "last_activity_date": 1531929409, "last_edit_date": 1531929409, "creation_date": 1531927044, "answer_id": 51405606, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba/51405606#51405606", "title": "Combining Multiple Arrays in VBA", "body": "<p>If you are working with one-dimensional arrays you could use a collection instead. It is much better at handling dynamic sizing.</p>\n\n<p>You can declare a collection and then add each of the elements in the arrays to it. Then you will have one large list with all of the values.</p>\n\n<pre><code>Dim coll As New Collection\ncoll.Add MyArray(j)\n</code></pre>\n\n<p>Here is a good to collections introduction:\n<a href=\"https://excelmacromastery.com/excel-vba-collections/\" rel=\"nofollow noreferrer\">https://excelmacromastery.com/excel-vba-collections/</a></p>\n"}, {"comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1531939279, "post_id": 51405715, "comment_id": 89789190, "body": "Since OP has 46 arrays, with <code>Redim Preserve</code>, you&#39;re creating a new array at least 46 times, which can likely cause a sever performance hit."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1531941108, "post_id": 51405715, "comment_id": 89790227, "body": "@Zack - 46 arrays * 5 elements per array would be around 250 reinitializations. This cannot be a performance hit in 2018. If we make the reinitializations around half million times, then yeah, it would be a bit slower and making the initialization once would be faster. However, my idea was to show how the combining of the array is done."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1531941350, "post_id": 51405715, "comment_id": 89790338, "body": "There&#39;s no guarantee that the average array in OP&#39;s actual code only holds 5 elements."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1531981673, "post_id": 51405715, "comment_id": 89802565, "body": "@Zack the average array holds around 15-20 elements, times by 46, so roughly 900 reinitialisations. Hardly a slow down at all."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1531927894, "last_edit_date": 1531927894, "creation_date": 1531927410, "answer_id": 51405715, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba/51405715#51405715", "title": "Combining Multiple Arrays in VBA", "body": "<p>Using your data this is how to create one array out of many:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myA, myB, myC, myD, myE\n    myA = Array(1, 2, 3, 4)\n    myB = Array(5, 6, 7)\n    myC = Array(8, 9)\n    myD = Array(10, 11, 12, 13, 14)\n    myE = Array(101, 102, 103)\n\n    Dim myCombine As Variant\n    Dim myNew() As Variant\n\n    Dim myElement As Variant\n    Dim myArr As Variant\n    Dim cnt As Long\n\n    myCombine = Array(myA, myB, myC, myD, myE)\n\n    For Each myArr In myCombine\n        For Each myElement In myArr\n            ReDim Preserve myNew(cnt)\n            myNew(cnt) = myElement\n            cnt = cnt + 1\n        Next\n    Next\n\n    For cnt = LBound(myNew) To UBound(myNew)\n        Debug.Print myNew(cnt)\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>The \"building\" of the new array is facilitated through <code>ReDim Preserve</code>, which keeps the old values in the array whenver the dimension of the array changes. And if you want to do something with these arrays, you may use 3 nested loops (a bit slow) and have some check:</p>\n\n<pre><code>Dim cnt2 As Long\nFor cnt = LBound(myNew) To UBound(myNew)\n    For cnt2 = LBound(myCombine) To UBound(myCombine)\n        For Each myElement In myCombine(cnt2)\n            If myElement = myNew(cnt) Then\n                Debug.Print myElement &amp; vbTab &amp; \" from \" &amp; vbTab &amp; cnt2\n            End If\n        Next myElement\n    Next cnt2\nNext cnt\n</code></pre>\n\n<p>This is what you get on the immediate window:</p>\n\n<pre><code>1    from   0\n2    from   0\n3    from   0\n4    from   0\n5    from   1\n6    from   1\n7    from   1\n8    from   2\n9    from   2\n10   from   3\n11   from   3\n12   from   3\n13   from   3\n14   from   3\n101  from   4\n102  from   4\n103  from   4\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1531928186, "creation_date": 1531928186, "answer_id": 51405963, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba/51405963#51405963", "title": "Combining Multiple Arrays in VBA", "body": "<p>Alternate 'brick-by-brick' approach.</p>\n\n<pre><code>Option Explicit\n\nSub combineArrays()\n    Dim myArray1 As Variant, myArray2 As Variant, myArray3 As Variant\n    Dim myArray4 As Variant, myArray46 As Variant\n\n    ReDim mainArray(0) As Variant\n\n    myArray1 = Array(1, 2, 3, 4)\n    myArray2 = Array(5, 6, 7)\n    myArray3 = Array(8, 9)\n    myArray4 = Array(10, 11, 12, 13, 14)\n    '...\n    myArray46 = Array(101, 102, 103)\n\n    mainArray = buildMainArray(myArray1, mainArray)\n    mainArray = buildMainArray(myArray2, mainArray)\n    mainArray = buildMainArray(myArray3, mainArray)\n    mainArray = buildMainArray(myArray4, mainArray)\n    mainArray = buildMainArray(myArray46, mainArray)\n    ReDim Preserve mainArray(UBound(mainArray) - 1)\n\n    Debug.Print Join(mainArray, \",\")\n\nEnd Sub\n\nFunction buildMainArray(arr As Variant, marr As Variant)\n    Dim i As Long\n\n    For i = LBound(arr) To UBound(arr)\n        marr(UBound(marr)) = arr(i)\n        ReDim Preserve marr(UBound(marr) + 1)\n    Next i\n\n    buildMainArray = marr\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "is_accepted": false, "score": 0, "last_activity_date": 1531938948, "last_edit_date": 1531938948, "creation_date": 1531933180, "answer_id": 51407380, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba/51407380#51407380", "title": "Combining Multiple Arrays in VBA", "body": "<p>Perhaps this ...</p>\n\n<pre><code>'To determine if a multi-dimension array is allocated (or empty)\n'Works for any-dimension arrays, even one-dimension arrays\nPublic Function isArrayAllocated(ByVal aArray As Variant) As Boolean\n\nOn Error Resume Next\nisArrayAllocated = IsArray(aArray) And Not IsError(LBound(aArray, 1)) And LBound(aArray, 1) &lt;= UBound(aArray, 1)\nErr.Clear: On Error GoTo 0\n\nEnd Function\n\n    'To determine the number of items within any-dimension array\n    'Returns 0 when array is empty, and -1 if there is an error\n    Public Function itemsInArray(ByVal aArray As Variant) As Long\n    Dim item As Variant, UBoundCount As Long\n\n    UBoundCount = -1\n    If IsArray(aArray) Then\n        UBoundCount = 0\n        If isArrayAllocated(aArray) Then\n            For Each item In aArray\n                UBoundCount = UBoundCount + 1\n            Next item\n        End If\n    End If\n    itemsInArray = UBoundCount\n\n    End Function\n\n        'To determine the number of dimensions of an array\n        'Returns -1 if there is an error\n        Public Function nbrDimensions(ByVal aArray As Variant) As Long\n        Dim x As Long, tmpVal As Long\n\n        If Not IsArray(aArray) Then\n            nbrDimensions = -1\n            Exit Function\n        End If\n\n        On Error GoTo finalDimension\n        For x = 1 To 65536 'Maximum number of dimensions (size limit) for an array that will work with worksheets under Excel VBA\n            tmpVal = LBound(aArray, x)\n        Next x\n\n        finalDimension:\n        nbrDimensions = x - 1\n        Err.Clear: On Error GoTo 0\n\n        End Function\n\n        '****************************************************************************************************\n        ' To merge an indefinite number of one-dimension arrays together into a single one-dimension array\n        ' Usage: mergeOneDimArrays(arr1, arr2, arr3, ...)\n        ' Returns an empty array if there is an error\n        ' Option Base 0\n        '****************************************************************************************************\n        Public Function mergeOneDimArrays(ParamArray infArrays() As Variant) As Variant\n        Dim x As Long, y As Long, UBoundCount As Long, newUBoundCount As Long\n        Dim tmpArr As Variant, allArraysOK As Boolean\n\n        UBoundCount = 0\n        allArraysOK = True\n        For x = LBound(infArrays) To UBound(infArrays)\n            If Not IsArray(infArrays(x)) Or Not nbrDimensions(infArrays(x)) = 1 Then\n                allArraysOK = False\n                Exit For\n            End If\n            UBoundCount = UBoundCount + itemsInArray(infArrays(x))\n        Next x\n        If allArraysOK Then\n            ReDim tmpArr(0 To UBoundCount - 1)\n            UBoundCount = 0\n            For x = LBound(infArrays) To UBound(infArrays)\n                For y = LBound(infArrays(x)) To UBound(infArrays(x))\n                    tmpArr(UBoundCount) = infArrays(x)(y)\n                    UBoundCount = UBoundCount + 1\n                Next y\n            Next x\n            newUBoundCount = itemsInArray(tmpArr)\n            If newUBoundCount = UBoundCount Then\n                mergeOneDimArrays = tmpArr\n            Else\n                mergeOneDimArrays = Array()\n            End If\n            Erase tmpArr\n        Else\n            mergeOneDimArrays = Array()\n        End If\n\n        End Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 1, "last_activity_date": 1531935611, "last_edit_date": 1531935611, "creation_date": 1531935205, "answer_id": 51407942, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba/51407942#51407942", "title": "Combining Multiple Arrays in VBA", "body": "<p>The issue with using <code>Redim Preserve</code> to combine arrays is it can be an <a href=\"http://www.aspheute.com/english/20001025.asp\" rel=\"nofollow noreferrer\">expensive</a> <a href=\"https://arstechnica.com/civis/viewtopic.php?f=20&amp;t=653952\" rel=\"nofollow noreferrer\">operation</a>, since you're basically re-creating the array everytime it's called. Since you have 46 arrays you're combining, you may very well be waiting a while.</p>\n\n<p>Instead, you can loop over the arrays to figure out the total number of elements you need, dimension out your master array, then loop over the arrays again to do the actual assignment/merging. Something like this:</p>\n\n<pre><code>  ' encapsulates code to determine length of an individual array\n  ' note that because arrays can have different LBounds in VBA, we can't simply use\n  ' Ubound to determine array length\n  Public Function GetArrayLength(anArray As Variant) As Integer\n     If Not IsArray(anArray) Then\n        GetArrayLength = -1\n     Else\n        GetArrayLength = UBound(anArray) - LBound(anArray) + 1\n     End If\n  End Function\n\n  Public Function CombineArrays(ParamArray arraysToMerge() As Variant) As Variant\n     ' index for looping over the arraysToMerge array of arrays,\n     ' and then each item in each array\n     Dim i As Integer, j As Integer\n\n     ' variable to store where we are in the combined array\n     Dim combinedArrayIndex As Integer\n\n     ' variable to hold the number of elements in the final combined array\n     Dim CombinedArrayLength As Integer\n\n     ' we don't initialize the array with an array-length until later,\n     ' when we know how long it needs to be.\n     Dim combinedArray() As Variant\n\n     ' we have to loop over the arrays twice:\n     ' First, to figure out the total number of elements in the combined array\n     ' second, to actually assign the values\n     ' otherwise, we'd be using Redim Preserve, which can get quite expensive\n     ' because we're creating a new array everytime we use it.\n     CombinedArrayLength = 0\n     For i = LBound(arraysToMerge) To UBound(arraysToMerge)\n        CombinedArrayLength = CombinedArrayLength + GetArrayLength(arraysToMerge(i))\n     Next i\n\n     ' now that we know how long the combined array has to be,\n     ' we can properly initialize it.\n     ' you can also use the commented code instead, if you prefer 1-based arrays.\n     ReDim combinedArray(0 To CombinedArrayLength - 1)\n     ' Redim combinedArray(1 to CombinedArrayLength)\n\n     ' now that the combinedarray is set up to store all the values in the arrays,\n     ' we can begin actual assignment\n     combinedArrayIndex = LBound(combinedArray)\n     For i = LBound(arraysToMerge) To UBound(arraysToMerge)\n        For j = LBound(arraysToMerge(i)) To UBound(arraysToMerge(i))\n           combinedArray(combinedArrayIndex) = arraysToMerge(i)(j)\n           combinedArrayIndex = combinedArrayIndex + 1\n        Next j\n     Next i\n\n     ' assign the function to the master array we've been using\n     CombineArrays = combinedArray\n  End Function\n</code></pre>\n\n<p>To use this function, you'd do something like the following:</p>\n\n<pre><code>  Public Sub TestArrayMerge()\n     Dim myArray1() As Variant\n     Dim myArray2() As Variant\n     Dim myArray3() As Variant\n     Dim myArray4() As Variant\n     Dim combinedArray As Variant\n\n     myArray1 = Array(1, 2, 3, 4)\n     myArray2 = Array(5, 6, 7)\n     myArray3 = Array(8, 9)\n     myArray4 = Array(10, 11, 12, 13, 14)\n\n     combinedArray = CombineArrays(myArray1, myArray2, myArray3, myArray4)\n\n     If IsArray(combinedArray) Then\n        Debug.Print Join(combinedArray, \",\")\n     End If\n  End Sub\n</code></pre>\n\n<p>Regarding your last bit, that you're using an inner loop to combine the values in your final combined array: Your inner loop doesn't need to start at <code>LBound(myArray)</code>. For any value of <code>i</code>, you've already compared it to the elements before it (e.g., when <code>i = 2</code>, it's already been compared to the first element). So you really just need:</p>\n\n<pre><code>    For i = LBound(combinedArray) To UBound(combinedArray) - 1\n        For j = i + 1 To UBound(combinedArray)\n           ' do whatever you need\n        Next j\n     Next i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 4, "last_activity_date": 1531936602, "creation_date": 1531936602, "answer_id": 51408287, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba/51408287#51408287", "title": "Combining Multiple Arrays in VBA", "body": "<p>Since you write in your comments that your end goal is to create an array of unique elements, you might be best served using a dictionary, where you can test for uniqueness as you add each element to dictionary.  Something like:</p>\n\n<pre><code>Option Explicit\nFunction uniqueArr(ParamArray myArr() As Variant) As Variant()\n    Dim dict As Object\n    Dim V As Variant, W As Variant\n    Dim I As Long\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\nFor Each V In myArr 'loop through each myArr\n    For Each W In V 'loop through the contents of each myArr\n        If Not dict.exists(W) Then dict.Add W, W\n    Next W\nNext V\n\n\nuniqueArr = dict.keys\n\nEnd Function\n\nSub tester()\n    Dim myArray1, myArray2, myArray3, myArray4, myArray5\n    myArray1 = Array(1, 2, 3, 4)\n    myArray2 = Array(5, 6, 7, 8)\n    myArray3 = Array(9, 10, 11, 12, 13, 14)\n    myArray4 = Array(15, 16)\n    myArray5 = Array(1, 3, 25, 100)\n\nDim mainArray\n\nmainArray = uniqueArr(myArray1, myArray2, myArray3, myArray4, myArray5)\n\nEnd Sub\n</code></pre>\n\n<p>If you run <code>Tester</code>, you will see <code>mainArray</code> contains:</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n25\n100\n</code></pre>\n"}], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4638, "favorite_count": 0, "accepted_answer_id": 51408287, "answer_count": 6, "score": 2, "last_activity_date": 1594210221, "creation_date": 1531926852, "last_edit_date": 1594210221, "question_id": 51405541, "link": "https://stackoverflow.com/questions/51405541/combining-multiple-arrays-in-vba", "title": "Combining Multiple Arrays in VBA", "body": "<p>I am currently trying to combine 46 arrays in to a single array. I have scoured the internet, to no prevail and am hoping someone here can help. I did find the below page, but I need to be able to look through each element of the new array in a nested for loop, so using the method below doesn't quite get me to my end goal.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/47155960/excel-vba-combine-multiple-arrays-into-one\">Excel vba - combine multiple arrays into one</a></p>\n\n<p>Basically, I need to combine my set of 46 arrays in such a way that I can then loop through each element using a nested for loop. ie.</p>\n\n<p>Set of arrays:</p>\n\n<pre><code>myArray1 = (1, 2, 3, 4)\nmyArray2 = (5, 6, 7)\nmyArray3 = (8, 9)\nmyArray4 = (10, 11, 12, 13, 14)\n.\n.\n.\nmyArray46 = (101, 102, 103)\n</code></pre>\n\n<p>Combine them to form new array:</p>\n\n<pre><code>myNewArray = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14... 101, 102, 103)\n</code></pre>\n\n<p>Loop through in nested for loop to check each element against my main array:</p>\n\n<pre><code>For i = LBound(mainArray) to UBound(mainArray)\n    For j = LBound(myArray) to UBound(myArray)\n\n    If mainArray(i) = myArray(j) Then\n    'do something\n    End If\n\n    Next j\nNext i\n</code></pre>\n\n<p>Any help and/ or guidance with this is greatly appreciated!</p>\n"}, {"tags": ["vba", "macos", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10100334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd350b72c6be85ec22e6514c9917ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10100334/andrew"}, "edited": false, "score": 0, "creation_date": 1531934384, "post_id": 51405608, "comment_id": 89786620, "body": "Would you happen to know if there is a way for the Mac version of Excel to detect if an add-in is installed?"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1531927048, "creation_date": 1531927048, "answer_id": 51405608, "question_id": 51405439, "link": "https://stackoverflow.com/questions/51405439/how-to-check-if-excel-add-in-is-installed-for-macintosh-users-with-vba/51405608#51405608", "title": "How to check if Excel Add-in is installed for Macintosh Users with VBA", "body": "<p>Your code would give that message if you have any other add-in installed, since it shows the message for any add-in that doesn't have Vena in its name. I'd suggest something like:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nrw = 0\nflag = 0\nIf InStr(Application.OperatingSystem, \"Macintosh\") Then\n    For Each ad In Application.AddIns\n        If InStr(1, ad.Name, \"Vena\", vbtextcompare) Then\n            MsgBox \"Vena add-in is installed.\"\n            flag = 1\n            Exit For\n        End If\n    Next\n    If flag = 0 then MsgBox \"Vena add-in is not installed.\"\nElse\n    MsgBox \"Vena is not compatible with your Operating System.\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10100334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd350b72c6be85ec22e6514c9917ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10100334/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 51405608, "answer_count": 1, "score": 0, "last_activity_date": 1531927048, "creation_date": 1531926539, "last_edit_date": 1531926757, "question_id": 51405439, "link": "https://stackoverflow.com/questions/51405439/how-to-check-if-excel-add-in-is-installed-for-macintosh-users-with-vba", "title": "How to check if Excel Add-in is installed for Macintosh Users with VBA", "body": "<p>Using VBA, I am able to detect if a specific add-in is installed for Windows Microsoft Office - Excel, but the same code is unable to detect when executed in MacOS Microsoft Office - Excel.</p>\n\n<p>Below is a sample of my code I try to execute in Microsoft Excel 2016 for Macintosh.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nrw = 0\nflag = 0\nIf InStr(Application.OperatingSystem, \"Macintosh\") Then\nFor Each ad In Application.AddIns\n    If flag &gt; 0 Then\n        Exit For\n    Else\n        If InStr(ad.Name, \"Vena\") Then\n            MsgBox \"Vena add-in is installed.\"\n            flag = 1\n        Else\n            MsgBox \"Vena add-in is not installed.\"\n        End If\n        rw = rw + 1\n    End If\nNext\nElse\nMsgBox \"Vena is not compatible with your Operating System.\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>In the MacOS Microsoft Office environment, the Excel Add-in is installed.  However, when I execute the code, I am notified that the add-in is not installed. Screenshot of error message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oUUIA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oUUIA.png\" alt=\"img1\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1531991672, "post_id": 51405285, "comment_id": 89808309, "body": "Thank you, this is exactly what I was trying to do hopefully, it&#39;s the most efficient way to accomplish what I want - I&#39;m sure I&#39;ll figure that out as I get a bit better at VBA!"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 2, "last_activity_date": 1531926091, "creation_date": 1531926091, "answer_id": 51405285, "question_id": 51405200, "link": "https://stackoverflow.com/questions/51405200/vba-reference-another-sheet-using-indirect/51405285#51405285", "title": "VBA reference another sheet using indirect", "body": "<pre><code>ActiveSheet.Range(\"B2\").Formula = \"=INDIRECT(\"\"'\"\"&amp;B$1&amp;\"\"'!\"\"&amp;$A2)\"\n</code></pre>\n\n<p>You can put that in a <code>Sub</code> and then run it (press f5 whilst the caret/cursor is inside the <code>Sub</code>), then enter sheet name in B1, cell reference in A2. Eg...</p>\n\n<pre><code>Public Sub TestVBAIndirect()\n    ActiveSheet.Range(\"B2\").Formula = \"=INDIRECT(\"\"'\"\"&amp;B$1&amp;\"\"'!\"\"&amp;$A2)\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531926416, "post_id": 51405350, "comment_id": 89781709, "body": "You can &#39;escape&#39; the double quote by typing two in a row - no need to use CHAR(34). :0) Also, It&#39;s <code>Chr(34)</code> ... CHAR doesn&#39;t exist. And you&#39;re referencing the contents of the cells, rather than the address of the cell which isn&#39;t what the OP asked for! Sorry to criticise!!"}, {"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1531991616, "post_id": 51405350, "comment_id": 89808272, "body": "Thank you, but unfortunately, this wasn&#39;t 100% what I was after. Appreciate your answer though!"}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 2, "last_activity_date": 1531926279, "creation_date": 1531926279, "answer_id": 51405350, "question_id": 51405200, "link": "https://stackoverflow.com/questions/51405200/vba-reference-another-sheet-using-indirect/51405350#51405350", "title": "VBA reference another sheet using indirect", "body": "<p>you can do <code>sheets(\"Sheet1\").Range(\"B2\").Formula = \"=Indirect(\" &amp; CHAR(34) &amp;  \"'\" &amp; CHAR(34) &amp; sheets(\"Sheet1\").Range(\"B1\").Value &amp; CHAR(34) &amp;  \"'!\" &amp; CHAR(34) &amp; sheets(\"Sheet1\").Range(\"A2\").Value &amp; \")\"</code> char(34) is the character code for \"</p>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1531929055, "post_id": 51405378, "comment_id": 89783462, "body": "How ironic is it that this post just came up in my Low Quality Posts review queue... I&#39;m saying &quot;Looks OK&quot; here."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1531926356, "creation_date": 1531926356, "answer_id": 51405378, "question_id": 51405200, "link": "https://stackoverflow.com/questions/51405200/vba-reference-another-sheet-using-indirect/51405378#51405378", "title": "VBA reference another sheet using indirect", "body": "<p>Try,</p>\n\n<pre><code>activesheet.cells(2, \"B\").formula = \"=INDIRECT(TEXT(B1, \"\"'@'!\"\")&amp;A1)\"\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2186, "favorite_count": 0, "accepted_answer_id": 51405285, "answer_count": 3, "score": 0, "last_activity_date": 1531926356, "creation_date": 1531925874, "question_id": 51405200, "link": "https://stackoverflow.com/questions/51405200/vba-reference-another-sheet-using-indirect", "title": "VBA reference another sheet using indirect", "body": "<p>Bit of a novice at VBA...</p>\n\n<p>I am trying to insert an indirect fx using VBA. </p>\n\n<p>I would insert <code>=INDIRECT(\"'\"&amp;B$1&amp;\"'!\"&amp;$A2)</code> into cell <code>B2</code>, cell <code>B1</code> contains the other sheet reference, and <code>A2</code> contains the cell reference. </p>\n\n<p>How can I acomplish this using VBA? </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 1, "creation_date": 1531925970, "post_id": 51405146, "comment_id": 89781356, "body": "Take a look at this answer ... it&#39;s the same thing, except it is copying it into a word document, rather than an email ... <a href=\"https://stackoverflow.com/a/51330579/5040941\">stackoverflow.com/a/51330579/5040941</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1531933885, "creation_date": 1531933885, "answer_id": 51407577, "question_id": 51405146, "link": "https://stackoverflow.com/questions/51405146/vba-paste-excel-range-as-unformatted-unicode-text-into-outlook-body/51407577#51407577", "title": "VBA Paste Excel Range as Unformatted Unicode Text into Outlook Body?", "body": "<p>Omitting the table object will require you to have to specify the numbers of characters per column.</p>\n\n<h2>Sample Data</h2>\n\n<p><a href=\"https://i.stack.imgur.com/E4ng6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E4ng6.jpg\" alt=\"enter image description here\"></a></p>\n\n<h2>Output</h2>\n\n<p><a href=\"https://i.stack.imgur.com/89pZ8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/89pZ8.jpg\" alt=\"enter image description here\"></a></p>\n\n<h2>Test</h2>\n\n<pre><code>Sub testTextTableEmail()\n    Dim mailItem As Object, Source As Range\n    Dim Body As String\n    With Worksheets(\"Sheet1\")\n        Set Source = .Range(\"A1:G15\")\n    End With\n\n    Body = getRangeTextTable(Source, 20, 10, 10, 10, 10, 10, 10)\n    Set mailItem = getMailItem\n\n    If Not mailItem Is Nothing Then\n        With mailItem\n            .to = \"\"\n            .CC = \"\"\n            .Subject = \"\"\n            .HTMlBody = Body\n            .Display\n            '.Send\n            '.Save\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n\n<h2>Functions</h2>\n\n<pre><code>Function getRangeTextTable(Source As Range, ParamArray ColumnCharCounts() As Variant) As String\n    Dim c As Long, n As Long\n    Dim cell As Range\n    Dim result() As String\n    ReDim result(Source.Count + Source.Rows.Count)\n\n    For Each cell In Source\n        n = n + 1\n        result(n) = Space(ColumnCharCounts(c))\n        LSet result(n) = cell.Value\n\n        c = c + 1\n        If c &gt; UBound(ColumnCharCounts) Then\n            c = 0\n            n = n + 1\n            result(n) = vbNewLine\n        End If\n    Next\n    getRangeTextTable = \"&lt;pre&gt;\" &amp; Join(result) &amp; \"&lt;/pre&gt;\"\nEnd Function\n\nFunction getMailItem() As Object\n    Dim mailApp As Object, mailItem As Object\n    Dim Body As String\n    On Error Resume Next\n    Set mailApp = CreateObject(\"Outlook.Application\")\n    On Error GoTo 0\n\n    If mailApp Is Nothing Then\n        MsgBox \"Could not create Outlook.Application\", vbCritical, \"Acton Cancelled\"\n        Exit Function\n    End If\n\n    On Error Resume Next\n    Set mailItem = mailApp.CreateItem(0)\n    On Error GoTo 0\n\n    If mailItem Is Nothing Then\n        MsgBox \"Could not create Outlook.MailItem\", vbCritical, \"Acton Cancelled\"\n        Exit Function\n    End If\n\n    Set getMailItem = mailItem\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7808247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2097500e4ac52f492883c1c0eab0b13?s=128&d=identicon&r=PG&f=1", "display_name": "toniggg", "link": "https://stackoverflow.com/users/7808247/toniggg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531933885, "creation_date": 1531925722, "question_id": 51405146, "link": "https://stackoverflow.com/questions/51405146/vba-paste-excel-range-as-unformatted-unicode-text-into-outlook-body", "title": "VBA Paste Excel Range as Unformatted Unicode Text into Outlook Body?", "body": "<p>How can I paste Excel Range into Outlook Email as plain text - I don't want the formatting and don't want the table object. It is the equivalent of copying a range of say 3 columns and 2 rows and opening outlook email body and doing Ctrl + Alt + V an selecting Paste Special as Unformatted Unicode Text.</p>\n\n<p>The below snippet is a popular code which paste the range as HTML.</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body(sendTo As String, emailSub As String, rangeBody As Range)\n\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = rangeBody\n\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .To = sendTo\n    .CC = \"\"\n    .Subject = emailSub\n    .HTMLBody = RangetoHTML(rng)\n    .Display   'or use .Display\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "function", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531927081, "post_id": 51405219, "comment_id": 89782154, "body": "I think the information is useful, but your answer is incomplete without fixing the glaring issue in the <code>Lastcolumn = ...</code> line."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 1, "last_activity_date": 1531925922, "creation_date": 1531925922, "answer_id": 51405219, "question_id": 51405051, "link": "https://stackoverflow.com/questions/51405051/excel-vba-need-help-to-drag-formula/51405219#51405219", "title": "Excel Vba: Need help to drag formula", "body": "<p>You need to use: <code>Range(Cells(51,1), Cells(51,Lastcolumn).Formula = \"=Trim(A1)</code> Because your lastcolumn is variable is numeric you need to use the cells function in the range.  The first number is for row number and the second is for the column.</p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1531926085, "creation_date": 1531926085, "answer_id": 51405283, "question_id": 51405051, "link": "https://stackoverflow.com/questions/51405051/excel-vba-need-help-to-drag-formula/51405283#51405283", "title": "Excel Vba: Need help to drag formula", "body": "<p>I believe the following will do what you expect it to, the code you used to get the Last Column wasn't right:</p>\n\n<pre><code>Sub foo()\n    Dim ws As Worksheet: Set ws = Sheets(\"COPY\")\n    LastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n    'get the last Column on Row 1 with data\n    ws.Range(ws.Cells(51, 1), ws.Cells(51, LastCol)).Formula = \"=Trim(A1)\"\n    'add formula from column A to the last Column\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1531926950, "creation_date": 1531925406, "question_id": 51405051, "link": "https://stackoverflow.com/questions/51405051/excel-vba-need-help-to-drag-formula", "title": "Excel Vba: Need help to drag formula", "body": "<p>I need help placing a formula in row 51 from column A to AE on sheet \"COPY\". The formula is \"Trim(A1)\" and needs to be dragged until \"Trim(AE1)\" while still being in row 51 (A51:AE51)</p>\n\n<p>This is what I have so far, but its pulling up an error on \"lascolumn = range...\"</p>\n\n<pre><code>Sub INSERT_TRIM_COPY()\nSheets(\"COPY\").Select\nDim Lastcolumn As Long\nLastcolumn = Range(\"A:AE\" &amp; Columns.Count).End(xlToRight).Column\nRange(\"A51:AE51\" &amp; Lastcolumn).FORMULA = \"=TRIM(A1)\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "edited": false, "score": 1, "creation_date": 1531925434, "post_id": 51404877, "comment_id": 89781020, "body": "What have you got so far ?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531925459, "post_id": 51404877, "comment_id": 89781039, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i> This is a site where programmers <i>write their own code</i> and share issues with a <i>specific</i> problem after trying to solve it on their own. If, after <b><a href=\"//meta.stackoverflow.com/questions/261592\">doing more research</a></b>, you have a <i>specific</i> problem, please <a href=\"https://stackoverflow.com/posts/51404877/edit\">edit</a> your post to share <a href=\"//stackoverflow.com/help/mcve\">examples of your code</a> and some background info about your project. Some good reading to get you started: &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as tips <b><a href=\"//codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">here</a></b> and <b><a href=\"//meta.stackoverflow.com/questions/347937/\">here</a></b>"}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": true, "score": 1, "last_activity_date": 1531925638, "creation_date": 1531925638, "answer_id": 51405112, "question_id": 51404877, "link": "https://stackoverflow.com/questions/51404877/simple-vba-select-query/51405112#51405112", "title": "Simple VBA Select Query", "body": "<p>Here is one way to do it:</p>\n\n<pre><code> sSQL = \"SELECT Variable FROM GroupTable \" \n Set rs = CurrentDb.OpenRecordset(sSQL)\n On Error GoTo resultsetError \n dbValue = rs!Variable\n MsgBox dbValue, vbOKOnly, \"RS VALUE\"\nresultsetError:\n MsgBox \"Error Retrieving value from database\",VbOkOnly,\"Database Error\"\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5180262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/029d15bce8729b5e17bb766139e5bedc?s=128&d=identicon&r=PG&f=1", "display_name": "Karim Fawaz", "link": "https://stackoverflow.com/users/5180262/karim-fawaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 51405112, "answer_count": 1, "score": -6, "last_activity_date": 1532014454, "creation_date": 1531924841, "last_edit_date": 1532014454, "question_id": 51404877, "link": "https://stackoverflow.com/questions/51404877/simple-vba-select-query", "title": "Simple VBA Select Query", "body": "<p>I have a form on MS Access with a button in it, and when I press that button I want to run a SELECT query <code>\"SELECT * FROM City\"</code>.</p>\n\n<p>All the questions on here are very complicated, I just want a simple few lines of code to do that.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1531925449, "post_id": 51404806, "comment_id": 89781035, "body": "You already have code in there that moves worksheets from one workbook to another.  Are you getting an error?  You may want to format your questions a little better."}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "reply_to_user": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1531926034, "post_id": 51404806, "comment_id": 89781407, "body": "Yes . It keeps Returning an error from the line -           Workbooks(originalwb).ws.Move Before:=Workbooks(wb2name).Worksheets(Sheets.Count)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531929359, "post_id": 51405454, "comment_id": 89783676, "body": "Thanks. it still didn&#39;t move the sheets to the requested workbooks."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531931057, "post_id": 51405454, "comment_id": 89784765, "body": "OK - what <i>does</i> it do?  Any errors - anything at all?  Are your worksheets literally names &quot;MD*&quot; etc, or do you mean &quot;begins with MD&quot;?"}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531934086, "post_id": 51405454, "comment_id": 89786487, "body": "They  begin with MD, PRIME NMD."}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531935975, "post_id": 51405454, "comment_id": 89787424, "body": "Thanks. still shows errors. &quot;object variable or block variable not set &quot; Runtime error 91 at the line - Set wbTarget = Workbooks(wb2name)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531936051, "post_id": 51405454, "comment_id": 89787460, "body": "Then there&#39;s no open workbook with name <code>wb2name</code>.  Did you need to open it?"}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531938219, "post_id": 51405454, "comment_id": 89788600, "body": "They  are open. In fact, even though the move doesn&#39;t work, the workbook files wb1name and wb2name are open at the background."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531938660, "post_id": 51405454, "comment_id": 89788867, "body": "Are they open in the same instance of Excel though?"}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531940738, "post_id": 51405454, "comment_id": 89790027, "body": "Yes they are. do they need to be activated ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531946449, "post_id": 51405454, "comment_id": 89792741, "body": "No, they don&#39;t need to be activated.  However if you&#39;re getting that error message it does indicate that there&#39;s a problem with the value of <code>wb2name</code>: try using <code>Debug.Print wb2name</code> and see if it&#39;s what you expect."}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1532003728, "post_id": 51405454, "comment_id": 89816532, "body": "Debug.Print wb2name returns correctly ( i.e the accurate workbook&#39;s name )"}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1532008710, "post_id": 51405454, "comment_id": 89820143, "body": "Hello, you didn&#39;t indicate the variable type for the wbtarget you adopted."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1532011336, "post_id": 51405454, "comment_id": 89822081, "body": "I left it as Variant, but adding <code>As Workbook</code> won&#39;t fix your problem."}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1532083684, "post_id": 51405454, "comment_id": 89851609, "body": "With a few adjustments to some variables(including the Thisworkbook object), IT WORKED. Thanks."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1531926591, "creation_date": 1531926591, "answer_id": 51405454, "question_id": 51404806, "link": "https://stackoverflow.com/questions/51404806/how-do-i-move-worksheets-in-a-workbook-to-two-other-opennewly-created-workbook/51405454#51405454", "title": "How do I move worksheets in a workbook to two other open(newly created) workbooks based on two criteria Refer to the code below?", "body": "<pre><code>Dim wbTarget\n\nFor Each ws In Workbooks(originalwb).Worksheets\n\n    If Len(ws.Name) &gt; 6 Then\n\n        If ws.Name Like \"NMD*\" Then\n            Set wbTarget = Workbooks(wb2name)\n        ElseIf ws.Name Like \"PRIME*\" Or ws.Name Like \"MD*\" Then\n            Set wbTarget = Workbooks(wb1name)\n        End If\n        If Not wbTarget Is Nothing Then\n            ws.Move Before:=wbTarget.Worksheets(wbTarget.Sheets.Count)\n            Set wbTarget = Nothing\n        End If       \n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531930058, "post_id": 51405557, "comment_id": 89784160, "body": "Thanks. still shows errors. &quot;object variable or block variable not set &quot; Runtime error 91."}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531931268, "post_id": 51405557, "comment_id": 89784875, "body": "Is it still giving you that error on the same line?"}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "reply_to_user": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1531931433, "post_id": 51405557, "comment_id": 89784982, "body": "Oh, and are your other workbooks open??? If they aren&#39;t actually open then you need to either leave them open while this is running or add code to open the workbooks before the loop starts."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 0, "last_activity_date": 1531926900, "creation_date": 1531926900, "answer_id": 51405557, "question_id": 51404806, "link": "https://stackoverflow.com/questions/51404806/how-do-i-move-worksheets-in-a-workbook-to-two-other-opennewly-created-workbook/51405557#51405557", "title": "How do I move worksheets in a workbook to two other open(newly created) workbooks based on two criteria Refer to the code below?", "body": "<p>This should fix your issue.  I am using a for loop to loop through all the worksheets: </p>\n\n<pre><code>Sub transfersheets()\n\nDim originalwb As String, ws As Worksheet, wb1name As String, wb2name As String\noriginalwb = ThisWorkbook.Name\n\nwb1name = Workbooks(originalwb).Worksheets(\"source\").Range(\"B2\").Value &amp; \" \" &amp; \"MD\" &amp; \" \" &amp; \"&amp;\" &amp; \" \" &amp; \"Prime\" &amp; \" \" &amp; \"Rdg. Sht.\" &amp; \" \" &amp; \"&amp;\" &amp; \" \" &amp; \"Direct.\" &amp; \" \" &amp; UCase(Format(Date, \"mmmm yyyy\")) &amp; \".xlsx\"\nwb2name = Workbooks(originalwb).Worksheets(\"source\").Range(\"B2\").Value &amp; \" \" &amp; \"Non\" &amp; \" \" &amp; \"MD\" &amp; \" \" &amp; \"Rdg. Sht.\" &amp; \" \" &amp; \"&amp;\" &amp; \" \" &amp; \"Direct.\" &amp; \" \" &amp; UCase(Format(Date, \"mmmm yyyy \")) &amp; \".xlsx\"\n\n'Workbooks(originalwb).Activate\nApplication.ScreenUpdating = False\nFor i = 1 To Workbooks(originalwb).Worksheets.Count\n\n    If Len(Worksheet.Name) &gt; 6 And Worksheet.Name = \"NMD*\" Then\n     Workbooks(originalwb).Sheets(i).Move Before:=Workbooks(wb2name).Worksheets(Sheets.Count)\n\n\n     ElseIf Len(Worksheet.Name) &gt; 6 And Worksheet.Name = \"PRIME*\" Then\n     Workbooks(originalwb).Sheets(i).Move Before:=Workbooks(wb1name).Worksheets(Sheets.Count)\n\n     ElseIf Len(Worksheet.Name) &gt; 6 And Worksheet.Name = \"MD*\" Then\n     Workbooks(originalwb).Sheets(i).Move Before:=Workbooks(wb1name).Worksheets(Sheets.Count)\n    End If\n'End If\nNext i\n    Workbooks(wb1name).Save\n    Workbooks(wb1name).Close\n\n\n    Workbooks(wb2name).Save\n    Workbooks(wb2name).Close\n\n    Workbooks(originalwb).Worksheets(\"source\").Range(\"AA:AG\").ClearContents\n\n    MsgBox \"The Reading Sheets &amp; Direct Customers' Lists has  Been Successfully  Prepared.\"\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1531926900, "creation_date": 1531924595, "last_edit_date": 1531924702, "question_id": 51404806, "link": "https://stackoverflow.com/questions/51404806/how-do-i-move-worksheets-in-a-workbook-to-two-other-opennewly-created-workbook", "title": "How do I move worksheets in a workbook to two other open(newly created) workbooks based on two criteria Refer to the code below?", "body": "<pre><code>Sub transfersheets()\nDim originalwb As String, ws As Worksheet, wb1name As String, wb2name As String\n\noriginalwb = ThisWorkbook.Name\n\nwb1name = Workbooks(originalwb).Worksheets(\"source\").Range(\"B2\").Value &amp; \" \" &amp; \"MD\" &amp; \" \" &amp; \"&amp;\" &amp; \" \" &amp; \"Prime\" &amp; \" \" &amp; \"Rdg. Sht.\" &amp; \" \" &amp; \"&amp;\" &amp; \" \" &amp; \"Direct.\" &amp; \" \" &amp; UCase(Format(Date, \"mmmm yyyy\")) &amp; \".xlsx\"\nwb2name = Workbooks(originalwb).Worksheets(\"source\").Range(\"B2\").Value &amp; \" \" &amp; \"Non\" &amp; \" \" &amp; \"MD\" &amp; \" \" &amp; \"Rdg. Sht.\" &amp; \" \" &amp; \"&amp;\" &amp; \" \" &amp; \"Direct.\" &amp; \" \" &amp; UCase(Format(Date, \"mmmm yyyy \")) &amp; \".xlsx\"\n\n'Workbooks(originalwb).Activate\nApplication.ScreenUpdating = False\nFor Each Worksheet In Workbooks(originalwb).Worksheets\n\n'If Len(ws.Name) &gt; 6 Then\n\n    If Len(Worksheet.Name) &gt; 6 And Worksheet.Name = \"NMD*\" Then\n     Workbooks(originalwb).ws.Move Before:=Workbooks(wb2name).Worksheets(Sheets.Count)\n\n\n     ElseIf Len(Worksheet.Name) &gt; 6 And Worksheet.Name = \"PRIME*\" Then\n     Workbooks(originalwb).ws.Move Before:=Workbooks(wb1name).Worksheets(Sheets.Count)\n\n     ElseIf Len(Worksheet.Name) &gt; 6 And Worksheet.Name = \"MD*\" Then\n     Workbooks(originalwb).ws.Move Before:=Workbooks(wb1name).Worksheets(Sheets.Count)\n    End If\n'End If\nNext\n    Workbooks(wb1name).Save\n    Workbooks(wb1name).Close\n\n\n    Workbooks(wb2name).Save\n    Workbooks(wb2name).Close\n\n    Workbooks(originalwb).Worksheets(\"source\").Range(\"AA:AG\").ClearContents\n\n    MsgBox \"The Reading Sheets &amp; Direct Customers' Lists has  Been Successfully  Prepared.\"\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "charts", "axis"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1531924770, "post_id": 51404788, "comment_id": 89780533, "body": "Couple things I&#39;d look in to: what&#39;s the number format on the X-Axis, and also are you displaying Minor Tick Marks on the X-Axis?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1531925165, "post_id": 51404788, "comment_id": 89780802, "body": "Also, consider using a Line chart rather than a Scatterplot. That might have something to do with it actually."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1531925383, "post_id": 51404788, "comment_id": 89780976, "body": "Also, I just run your code and it does not produce that chart: <a href=\"https://imgur.com/ZuUCXhW\" rel=\"nofollow noreferrer\">imgur.com/ZuUCXhW</a>"}], "owner": {"reputation": 1, "user_id": 10100219, "user_type": "registered", "profile_image": "https://graph.facebook.com/2289646324386346/picture?type=large", "display_name": "Martin Gravel", "link": "https://stackoverflow.com/users/10100219/martin-gravel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531924691, "creation_date": 1531924544, "last_edit_date": 1531924691, "question_id": 51404788, "link": "https://stackoverflow.com/questions/51404788/vba-chart-x-axis-has-repeating-values-and-does-not-line-up-with-data", "title": "VBA chart X-Axis has repeating values and does not line up with data", "body": "<p>I am using some VBA code to have a dynamic line graph. The X-axis is the month and the Y-axis the amounts of Pass and Fail during that month. What I have found so far is that if my data has multiple months (10 - 12 months in it) then the graph appears to be fine. However if I only have two months (see picture) the A-axis will repeat values and the graph points don't line up properly with the month that they should. Anyone experience something like this before?</p>\n\n<p>Here's the code I am using</p>\n\n<pre><code>Dim sh As Worksheet\nSet sh = Worksheets(\"Summary\")\n\nWith sh\n    LR = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nDim cht1 As CHART\nSet cht1 = sh.Shapes.AddChart.CHART\n\nFor q = 1 To 2\n    With cht1\n        .Axes(xlValue).MinimumScale = 0\n        .ChartType = xlXYScatterLines\n        .SeriesCollection.NewSeries\n        .SeriesCollection(q).Name = sh.Cells(2, q + 1)\n        .SeriesCollection(q).XValues = sh.Range(sh.Cells(3, 1), sh.Cells(LR, 1))\n        .SeriesCollection(q).Values = sh.Range(sh.Cells(3, q + 1), sh.Cells(LR, q + 1))\n        .SeriesCollection(q).MarkerSize = 6\n        .SeriesCollection(q).Border.ColorIndex = 11 - q\n        .SeriesCollection(q).Trendlines.Add\n        With .SeriesCollection(q).Trendlines(1)\n            .Border.ColorIndex = 43 * (2 - q) + 3 * (q - 1)\n            .Border.Weight = xlMedium\n            .Border.LineStyle = xlDash\n            .Border.LineStyle = xlContinuous\n        End With\n        .HasTitle = True\n        .ChartTitle.Text = sh.Cells(1, 2)\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"DATE\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"AMOUNT\"\n    End With\nNext\n\nWith cht1.Parent\n    .Top = sh.Cells(LR + 2, 1).Top\n    .Left = sh.Cells(LR + 2, 1).Left\n    .Height = sh.Range(sh.Cells(LR + 2, 1), sh.Cells(LR + 20, 1)).Height\n    .Width = sh.Range(sh.Cells(LR + 2, 1), sh.Cells(LR + 2, 8)).Width\n    H = .Height\n    W = .Width\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9La0q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9La0q.png\" alt=\"\"></a></p>\n\n<p>Thank you,\nMartin</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531924068, "post_id": 51404356, "comment_id": 89779992, "body": "To be honest I can&#39;t really see why <code>Set refRng = Tabelle2.Range(&quot;A1&quot;, Range(&quot;A&quot; &amp; Rows.count).End(xlUp))</code> isn&#39;t working, but I would write is as <code>Set refRng = Tabelle2.Range(&quot;A1:A&quot;&amp; Range(&quot;A&quot; &amp; Rows.count).End(xlUp).Row)</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531924280, "post_id": 51404356, "comment_id": 89780159, "body": "Never use <code>On Error Resume Next</code> without proper error handling. This line just hides <b>all</b> error messages but the errors still occur, you just cannot see them. Remove that line completely and see if you get any errors. If so tell which and where. You cannot debug/fix a code if you use <code>On Error Resume Next</code> like you did."}, {"owner": {"reputation": 13, "user_id": 10099948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/856cc2fc97b8a923d5917acd96e79efe?s=128&d=identicon&r=PG&f=1", "display_name": "M.Schedl", "link": "https://stackoverflow.com/users/10099948/m-schedl"}, "edited": false, "score": 0, "creation_date": 1531925104, "post_id": 51404356, "comment_id": 89780756, "body": "I added some debug values to the OP, seems like the dynamic function doesn&#39;t give me correct values for the VLookup."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531925869, "post_id": 51404356, "comment_id": 89781275, "body": "Is it only Error 400 without a message text? In which line does the error occur when debug the code going through it step-by-step (with F8). During debug you can also check the values of your variables in each state by selecting the variable and press Shift+F9."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531927247, "post_id": 51404356, "comment_id": 89782268, "body": "Why do you start your dynamic range with <code>A1</code> but your static range with <code>A2</code>?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531927430, "post_id": 51404356, "comment_id": 89782392, "body": "Also why do you have a <code>With cd</code> statement? It looks like you fully qualify everything anyways - looks like you could just remove that."}, {"owner": {"reputation": 13, "user_id": 10099948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/856cc2fc97b8a923d5917acd96e79efe?s=128&d=identicon&r=PG&f=1", "display_name": "M.Schedl", "link": "https://stackoverflow.com/users/10099948/m-schedl"}, "edited": false, "score": 0, "creation_date": 1531985462, "post_id": 51404356, "comment_id": 89804668, "body": "The A1 was just a mistake, the correct one is A2. You are right the With cd statement is not needed, I deleted it."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10099948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/856cc2fc97b8a923d5917acd96e79efe?s=128&d=identicon&r=PG&f=1", "display_name": "M.Schedl", "link": "https://stackoverflow.com/users/10099948/m-schedl"}, "is_accepted": false, "score": 0, "last_activity_date": 1531990116, "creation_date": 1531990116, "answer_id": 51418207, "question_id": 51404356, "link": "https://stackoverflow.com/questions/51404356/vba-vlookup-dynamic-range/51418207#51418207", "title": "VBA VLookup Dynamic Range", "body": "<p>I found the answer myself:</p>\n\n<p>To get the range variable is used this:</p>\n\n<pre><code> Dim Lastrow              As Integer\n\n\n         Lastrow = Tabelle2.Cells(Rows.count, 2).End(xlUp).Row\n         Set refRng = Tabelle2.Range(\"A2:A\" &amp; Lastrow)\n</code></pre>\n\n<p>For some reason with this it actually moves to the 2nd function as it finds values in c.value which doesn't work with the Cells parameter.</p>\n"}], "owner": {"reputation": 13, "user_id": 10099948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/856cc2fc97b8a923d5917acd96e79efe?s=128&d=identicon&r=PG&f=1", "display_name": "M.Schedl", "link": "https://stackoverflow.com/users/10099948/m-schedl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531990116, "creation_date": 1531923373, "last_edit_date": 1531927437, "question_id": 51404356, "link": "https://stackoverflow.com/questions/51404356/vba-vlookup-dynamic-range", "title": "VBA VLookup Dynamic Range", "body": "<p>First off:<br>\nOn sheet1 I have a set of data on column A and a datatype on column F.<br>\nOn sheet2 I have a huge list with the same data on column A and the same datatype on column B as on F above. Each data point in column A is set with a data type on column B   </p>\n\n<p>Now my question:<br>\nThe code I wrote compares the data in sheet2(A2:A2978) with the data in sheet1(A3:A271).<br>\nIf they ARE NOT the same then it gives me a MsgBox with an Error and goes to the next data point.<br>\nIf they ARE the same it goes and checks if sheet2(B2:B2978) is the same as sheet1(F3:F271).<br>\nIf they ARE NOT the same again an error and it continues.<br>\nIf they ARE the same it just goes to the next data point in the A column.   </p>\n\n<p>This code works for now. The problem is that I want to make the sheet1 and 2 to a dynamic range since I want to later change the code so I can use it on differen excel files with different amount of rows and the main file where I take the data from can also change.<br>\nI tried to do it with:  </p>\n\n<pre><code>Set refRng = Tabelle2.Range(\"A1\", Range(\"A\" &amp; Rows.count).End(xlUp))\n</code></pre>\n\n<p>instead of  </p>\n\n<pre><code>Set refRng = Tabelle2.Range(\"A2:A2978\")  \n</code></pre>\n\n<p>But as soon as I do that the code doesn't go to the next cycle anymore it just stays in the compare A column.<br>\nThe VLookup looks as follows:  </p>\n\n<pre><code>strTextSearch = WorksheetFunction.VLookup(c.Value, refRng, 1, False)  \n</code></pre>\n\n<p>And this is the whole code which works completly fine except for dynamic range: </p>\n\n<pre><code>Sub CompareData()    \n    Dim strTextSearch        As String\n    Dim strTextMain          As String\n    Dim strText              As String\n    Dim count                As Long\n    Dim refRng               As Range\n    Dim tarRng               As Range\n\n    On Error Resume Next\n\n    '// Change range to data you want to target\n    Set tarRng = Tabelle1.Range(Cells(3, 2), Cells(271, 2))\n\n    For Each c In tarRng       \n        With c\n            count = count + 1\n\n            Set refRng = Tabelle2.Range(\"A2:A2978\")\n\n            'c.value is the value you compare to\n            strTextSearch = WorksheetFunction.VLookup(c.Value, refRng, 1, False)\n\n            'If the values match\n            If c.Value &lt;&gt; vbNullString And strTextSearch = c.Value Then\n                Call CompareDataType(count, c)\n            Else\n                MsgBox \"Error First Loop: \" + c\n                Call CompareDataType(count, c)\n            End If\n        End With\n    Next\nEnd Sub\n\n\nSub CompareDataType(count, c)\n    Dim strTextSearchDT        As String\n    Dim strTextMainDT         As String\n    Dim strTextDT              As String\n    Dim cd                As Excel.Range\n\n    On Error Resume Next\n\n    '// Change range to data you want to compare\n    For Each cd In Tabelle1.Range(Cells(count + 2, 6), Cells(271, 6))\n        With cd\n            'Set the range from where you take the data\n            strTextSearchDT = WorksheetFunction.VLookup(cd.Value, Tabelle2.Range(\"B2:B2978\"), 1, False)\n\n            'If the values match\n            If cd.Value &lt;&gt; vbNullString And strTextSearchDT = cd.Value Then\n                'MsgBox \"Success i guess: \" + cd\n                Exit For\n            Else\n                MsgBox \"Group Data Type Wrong: \" + c + \" \" + cd\n                Exit For          \n            End If     \n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>Sry for the ugly formatting, I deleted all the debug.Print so it looks kinda weird.<br>\nI hope you can help me or give me a hint how I can make this dynamic, I tried to do it with cells and without, but as soon as i set it with .row.count it wouldn't work anymore.</p>\n\n<p>EDIT1: If I get rid of <code>On Error Resume Next</code> I get error 400<br>\nHere what the debug looks like with defined A:A values</p>\n\n<pre><code>count 1 \ncount 2 \ncount 3 \ncount 4 \nc.Value: CellBalAhSumNvm\ncount 5 \nc.Value: BalCurrAvgPerCellNvm\ncount 6 \nc.Value: CellBalAhSumAvgNvm\n</code></pre>\n\n<p>Here what it looks like with the dynamic one:  </p>\n\n<pre><code>count 1 \ncount 2 \ncount 3 \ncount 4 \ncount 5 \n</code></pre>\n\n<p>It just coninues on with the A column and doesn't even consider going to the 2nd function, seems like c.value isn't getting the right value or something like that.</p>\n\n<p>Regards,\nMathias</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3363, "user_id": 8230810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dCeAX.jpg?s=128&g=1", "display_name": "James Whiteley", "link": "https://stackoverflow.com/users/8230810/james-whiteley"}, "edited": false, "score": 0, "creation_date": 1531925800, "post_id": 51404181, "comment_id": 89781232, "body": "What have you tried so far?"}, {"owner": {"reputation": 11, "user_id": 10094232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb704b0dbb49359cd81ca8b45c9aad3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Urquidi", "link": "https://stackoverflow.com/users/10094232/alex-urquidi"}, "reply_to_user": {"reputation": 3363, "user_id": 8230810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dCeAX.jpg?s=128&g=1", "display_name": "James Whiteley", "link": "https://stackoverflow.com/users/8230810/james-whiteley"}, "edited": false, "score": 0, "creation_date": 1531926262, "post_id": 51404181, "comment_id": 89781575, "body": "Basically I had it working for a data validation list perfectly and my range was an actual cell and what is said. But, now that I am trying to have multiple selections the list box does not really have a range in a cell that i know how to change. The problem I have right now is that even tho my excel sheet has things in the list box, I don&#39;t know how to have that list in the code also"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531927523, "post_id": 51404181, "comment_id": 89782459, "body": "How is your listbox being populated?"}, {"owner": {"reputation": 11, "user_id": 10094232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb704b0dbb49359cd81ca8b45c9aad3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Urquidi", "link": "https://stackoverflow.com/users/10094232/alex-urquidi"}, "edited": false, "score": 0, "creation_date": 1531928441, "post_id": 51404181, "comment_id": 89783046, "body": "I created my list box by going into the developer tab, controls, insert, and then selected list box. I open its properties and I populated it by filling List fill range. I also enabled multiSelect to 1 and list style too"}], "owner": {"reputation": 11, "user_id": 10094232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb704b0dbb49359cd81ca8b45c9aad3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Urquidi", "link": "https://stackoverflow.com/users/10094232/alex-urquidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594210244, "creation_date": 1531922900, "last_edit_date": 1594210244, "question_id": 51404181, "link": "https://stackoverflow.com/questions/51404181/how-do-i-make-a-listbox-activex-basically-a-drop-checklist-to-show-hidden-rows", "title": "How do I make a ListBox activeX (basically a drop checklist) to show hidden rows", "body": "<p>Basically I have created a List box with a total of 4 items. You can select multiple items in this sheet and I will like to make it so that each selection would show hidden rows, while being able to make multiple selections.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub ListBox1_Click()\n\nEnd Sub\n\nPrivate Sub worksheet_change(ByVal target As Range)\n\nApplication.EnableEvents = False\n    Union(Rows(\"20:30\"), Rows(\"51:56\")).EntireRow.Hidden = True\n    If Not Application.Intersect(Range(\"ListBox1\"), Range(target.Address)) Is Nothing Then\n        Select Case target.Value\n            Case \"Asset Transfer\"\n                Rows(\"20:22\").EntireRow.Hidden = False\n            Case \"Fund Lineup\"\n                Rows(\"27:30\").EntireRow.Hidden = False\n            Case \"Plan Merge\"\n                Rows(\"23:26\").EntireRow.Hidden = False\n            Case \"Loans\"\n                Rows(\"51:56\").EntireRow.Hidden = False\n        End Select\n    End If\n    Set target = Range(\"bulk\")\n\n    If target.Value = \"Yes\" Then\n        Range(\"C60\") = InputBox(\"Please enter the number of labor hours'\")\n        Range(\"D60\") = InputBox(\"Enter Percentage Increase'\")\n    End If\n        Set target = Range(\"AutoEnrollment\")\n\n    If target.Value = \"Yes\" Then\n        Range(\"C59\") = InputBox(\"Please enter the number of employees'\")\n    End If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1531922741, "post_id": 51404029, "comment_id": 89779071, "body": "Have you checked what i.value actually looks like?"}, {"owner": {"reputation": 281, "user_id": 10099944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f53f902f29401ddbb1ce3f918a97e5?s=128&d=identicon&r=PG&f=1", "display_name": "Muska", "link": "https://stackoverflow.com/users/10099944/muska"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1531986511, "post_id": 51404029, "comment_id": 89805279, "body": "I think it&#39;s String but not sure. When replace Month(Now) with &quot;7&quot; (July) then macro works. When I put 7 it doesn&#39;t work. Anyways macro works for now i.Value=Month(now). The funny thing is that I created 2 seperate spreadsheets - one based on data (placed in one of the sheets) and second on data model and used the SAME macro for both. For simple data it works - for data model - no. Maybe here is the point?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1532005978, "post_id": 51404029, "comment_id": 89818058, "body": "You can get the type by stepping your macro to that line and then typing  ?TYPENAME(i.value) in your immediate pane and hitting enter. Or you can change the test to: Cstr(i.Value) = CStr(Month(Now))"}], "answers": [{"tags": [], "owner": {"reputation": 281, "user_id": 10099944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f53f902f29401ddbb1ce3f918a97e5?s=128&d=identicon&r=PG&f=1", "display_name": "Muska", "link": "https://stackoverflow.com/users/10099944/muska"}, "is_accepted": false, "score": 0, "last_activity_date": 1532085861, "creation_date": 1532085861, "answer_id": 51441460, "question_id": 51404029, "link": "https://stackoverflow.com/questions/51404029/cant-select-deselect-an-item-on-a-slicer-vba/51441460#51441460", "title": "Can&#39;t select/deselect an item on a Slicer - VBA", "body": "<p>Ok, I digged into the topic and now know that .SlicerCacheLevel.SlicerItems let me get into item on slicer list. Now the problem is that I can't select specific month on the slicer list. Let's say we have 5 elements on a list (March, April, May, June, July) which means that array consists of 5 elements (1 to 5). So, if we have July now (7) I can't in any way select 7 on a slicer. Looping through doesn't work out as well. How can it be solved? Look at my code:</p>\n\n<pre><code>Sub Archive()\n\nDim i As SlicerItem\nDim varrSlicerItems As Variant\nDim k As Long\n\n\n    With ActiveWorkbook.SlicerCaches(\"Slicer_Month\")\n\n        ReDim varrSlicerItems(1 To .Slicers(\"Month\").SlicerCacheLevel.SlicerItems.Count)\n\n        For Each i In .Slicers(1).SlicerCacheLevel.SlicerItems\n            k = k + 1\n            varrSlicerItems(k) = i.Name\n        Next i\n\n        'and ERROR occurs here...\n         .VisibleSlicerItemsList = Array(varrSlicerItems(Month(Date)))\n\n\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 10099944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f53f902f29401ddbb1ce3f918a97e5?s=128&d=identicon&r=PG&f=1", "display_name": "Muska", "link": "https://stackoverflow.com/users/10099944/muska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532085861, "creation_date": 1531922450, "last_edit_date": 1531929663, "question_id": 51404029, "link": "https://stackoverflow.com/questions/51404029/cant-select-deselect-an-item-on-a-slicer-vba", "title": "Can&#39;t select/deselect an item on a Slicer - VBA", "body": "<p>the problem is that whenever I run the macro nothing really happens on the slicer - I mean no item is selected. I need to filter by month - automatically, depending on the current date. What's wrong with the code?\nI need to underscore that my pivot tables are created on data model:</p>\n\n<pre><code>Sub Archive()\n\n    Dim i As SlicerItem\n    Dim ostWierszWS As Long\n    Dim zakres As Range\n    Dim zakres_ws As Range\n    Dim WS As Worksheet\n\n    Application.ScreenUpdating = False\n\n    For Each i In ActiveWorkbook.SlicerCaches(\"Slicer_Month\").SlicerItems\n        If i.Value = Month(Now) Then\n            i.Selected = True\n        Else\n            i.Selected = False\n        End If\n    Next i\n\n    On Error Resume Next\n\n    Set WS = Worksheets(\"Archive\")\n    Set zakres = Worksheets(\"aaa\").Range(\"D7:D10\")\n    ostWierszWS = WS.Cells(Rows.Count, 3).End(xlUp).Row + 1\n    Set zakres_ws = WS.Cells(ostWierszWS, 3)\n\n    zakres.Copy\n    zakres_ws.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlPasteSpecialOperationNone, skipblanks:=False, Transpose:=True\n\n    Set WS = Nothing\n\n    Application.ScreenUpdating = True\n    On Error GoTo 0\n    Sheets(\"aaa\").Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531922274, "post_id": 51403731, "comment_id": 89778744, "body": "Which line errors? What is the intention behind a line such as <code>ws.Range (&quot;AD2&quot;)</code>?"}, {"owner": {"reputation": 21, "user_id": 10039208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4kBysZqs_30/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p1PaQsMFyV2beAiW0m_4fSkEE67g/mo/photo.jpg?sz=128", "display_name": "DK7", "link": "https://stackoverflow.com/users/10039208/dk7"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531922571, "post_id": 51403731, "comment_id": 89778947, "body": "Ws. Range (&quot;AD1&quot;) is where the error pops up. That is basically the empty cells where the calculation should start."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531922774, "post_id": 51403731, "comment_id": 89779093, "body": "well, because <code>ws.Range (&quot;AD1&quot;)</code> does nothing at all. It is no valid syntax. Read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. This will fix your issues."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 4, "last_activity_date": 1531922782, "creation_date": 1531922782, "answer_id": 51404142, "question_id": 51403731, "link": "https://stackoverflow.com/questions/51403731/vba-excel-applying-a-simple-division-across-tabs/51404142#51404142", "title": "VBA Excel applying a simple division across tabs", "body": "<p>Lose the Selects which are inefficient and unnecessary and your code can be shortened to</p>\n\n<pre><code>Sub Macro2()\n\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n     ws.Range(\"AD1\").Value = \"In %\"\n     ws.Range(\"AD1\").Font.Bold = True\n     With ws.Range(\"AD2:AD91\")\n        .FormulaR1C1 = \"=RC[-2]/R2C28\"\n        .Style = \"Percent\"\n        .NumberFormat = \"0.0%\"\n        .Font.Bold = True\n     End With\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10039208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4kBysZqs_30/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p1PaQsMFyV2beAiW0m_4fSkEE67g/mo/photo.jpg?sz=128", "display_name": "DK7", "link": "https://stackoverflow.com/users/10039208/dk7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531922782, "creation_date": 1531921726, "last_edit_date": 1531921989, "question_id": 51403731, "link": "https://stackoverflow.com/questions/51403731/vba-excel-applying-a-simple-division-across-tabs", "title": "VBA Excel applying a simple division across tabs", "body": "<p>the following code runs the invalid use of property error. I am just trying to apply a simple division across 50 tabs. its basically dividing each cell value with one cell value at the top.</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n  Dim ws As Worksheet`\n   For Each ws In ThisWorkbook.Worksheets\n         ws.Range (\"AD1\")\n         ActiveCell.FormulaR1C1 = \"In %\"\n         ws.Range (\"AD1\")\n         Selection.Font.Bold = True\n         ws.Range (\"AD2\")\n         Application.CutCopyMode = False\n         Application.CutCopyMode = False\n         ActiveCell.FormulaR1C1 = \"=RC[-2]/R2C28\"\n         ws.Range (\"AD2\")\n         Selection.Copy\n         ws.Range (\"AD2:AD91\")\n         Application.CutCopyMode = False\n         Selection.FillDown\n         Selection.Style = \"Percent\"\n         Selection.NumberFormat = \"0.0%\"\n         Selection.Font.Bold = True\n         ws.Range (\"AD2\")\n    Next ws\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531921300, "post_id": 51403512, "comment_id": 89778001, "body": "Do you mean fill across? That code can&#39;t work as the destination must include the source? Are you copying a variable number of rows from column A to B?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921426, "post_id": 51403512, "comment_id": 89778103, "body": "You could look at <code>UsedRange</code>"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1531945848, "post_id": 51403512, "comment_id": 89792489, "body": "<code>FillDown</code> or <code>FillAcross</code> are worth investigating."}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921400, "post_id": 51403582, "comment_id": 89778080, "body": "I think OP is looking for total columns and not rows. Which is just a variant of your answer"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921542, "post_id": 51403582, "comment_id": 89778197, "body": "It&#39;s kind of unclear. I thoguht so as well originally, but it kind of defeats the purpose if he directly references next column (B) as the fill range."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531921633, "post_id": 51403582, "comment_id": 89778268, "body": "@SJR yeah that&#39;s just oversight on my part, as I copied OP&#39;s code instead of transcribing it myself. Will edit in a sec"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531922420, "post_id": 51403582, "comment_id": 89778841, "body": "@Zac edited my answor to accomodate last column being used as well. But I still find it kind of funky in practical use."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531922551, "post_id": 51403582, "comment_id": 89778926, "body": "Not sure what OP wants now because now I think they have changed it to look for number of rows.. atleast you&#39;ve covered both :)"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 2, "last_activity_date": 1531922050, "last_edit_date": 1531922050, "creation_date": 1531921349, "answer_id": 51403582, "question_id": 51403512, "link": "https://stackoverflow.com/questions/51403512/auto-fill-feature-vba/51403582#51403582", "title": "Auto Fill Feature VBA", "body": "<p>Change your code to this:</p>\n\n<pre><code>Dim lr as Long\nlr = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nSet sourceRange = WorkSheets(\"Sheet1\").Range(\"A1:A\" &amp; lr)\nSet fillRange = sourceRange.Resize(, sourceRange.Columns.Count + 1)\nsourceRange.AutoFill Destination:=fillRange\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Note, as it's unclear from your question, if you also wish to detect last column,\nthen: </p>\n\n<pre><code>Dim lc as Long\nlc = Sheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>will detect it for you, you can adjust your sourcerange, and set your fillRange to be the rightmost adjacent column</p>\n\n<pre><code>Set sourceRange = WorkSheets(\"Sheet1\").Range(Cells(1,1), Cells(lr, lc))\nSet fillRange = sourceRange.Resize(, sourceRange.Columns.Count + 1)\nsourceRange.AutoFill Destination:=fillRange\n</code></pre>\n\n<p>will do the trick!</p>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531921531, "post_id": 51403607, "comment_id": 89778188, "body": "Even better if you can do dispense with the Selects."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089003"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531921722, "post_id": 51403607, "comment_id": 89778343, "body": "@SJR What do you mean dispense with the selects? I just tried this code and it worked for me."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531921769, "post_id": 51403607, "comment_id": 89778372, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089003"}, "edited": false, "score": 0, "creation_date": 1531921982, "post_id": 51403607, "comment_id": 89778543, "body": "Are you meaning to set a range as opposed to using select?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1531922590, "post_id": 51403607, "comment_id": 89778958, "body": "@BRPOR In general it&#39;s best to avoid <code>.Select</code>  altogether (causes a lot of unexpected behaviour and so on). The code will work, but it is teaching a bad habit. I really like the question SJR linked to, one of the latter answers pretty nicely explains not only how you should avoid it, but also why you should avoid it"}], "tags": [], "owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1531921396, "creation_date": 1531921396, "answer_id": 51403607, "question_id": 51403512, "link": "https://stackoverflow.com/questions/51403512/auto-fill-feature-vba/51403607#51403607", "title": "Auto Fill Feature VBA", "body": "<p>The best way I found to circumvent this issue is as follows </p>\n\n<pre><code>Range(\"B1\").Select\nSelection.Copy\nActiveCell.Offset(0, -1).Select\nSelection.End(xlDown).Select\nActiveCell.Offset(0, 1).Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nSelection.Copy\nRange(Selection, \"B1\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>Doesn't quite auto fill but should do the job for you.</p>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1531921462, "creation_date": 1531921462, "answer_id": 51403638, "question_id": 51403512, "link": "https://stackoverflow.com/questions/51403512/auto-fill-feature-vba/51403638#51403638", "title": "Auto Fill Feature VBA", "body": "<p>Here's a guess as not sure what you are trying to do.</p>\n\n<pre><code>Sub x()\n\nDim SourceRange As Range, fillRange As Range\n\nWith Worksheets(\"Sheet1\")\n    Set SourceRange = .Range(\"A1\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n    Set fillRange = .Range(\"A1\").Resize(SourceRange.Rows.Count, 2)\nEnd With\n\nSourceRange.AutoFill Destination:=fillRange\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10089003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 51403582, "answer_count": 3, "score": 1, "last_activity_date": 1531922050, "creation_date": 1531921152, "last_edit_date": 1531921668, "question_id": 51403512, "link": "https://stackoverflow.com/questions/51403512/auto-fill-feature-vba", "title": "Auto Fill Feature VBA", "body": "<p>I am trying to auto fill down from the first cell that I have in cell B1 based on how many rows are in column A.  Any I ideas on how to account for this. Thanks!</p>\n\n<pre><code>Set sourceRange = Worksheets(\"Sheet1\").Range(\"A1:A20\") \nSet fillRange = Worksheets(\"Sheet1\").Range(\"B1:B20\") \nsourceRange.AutoFill Destination:=fillRange\n</code></pre>\n"}, {"tags": ["c#", "vba", "sdk", "historian", "proficy"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 1372125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d13a4bb8d1e3cb035fb439c54effd6?s=128&d=identicon&r=PG", "display_name": "Vegard Innerdal", "link": "https://stackoverflow.com/users/1372125/vegard-innerdal"}, "reply_to_user": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1531922774, "post_id": 51403459, "comment_id": 89779094, "body": "Try to set a breakpoint and inspect the <code>Collectors</code>object. Also figure out what type <code>Items</code>is."}], "tags": [], "owner": {"reputation": 329, "user_id": 1372125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d13a4bb8d1e3cb035fb439c54effd6?s=128&d=identicon&r=PG", "display_name": "Vegard Innerdal", "link": "https://stackoverflow.com/users/1372125/vegard-innerdal"}, "is_accepted": false, "score": 0, "last_activity_date": 1531921008, "creation_date": 1531921008, "answer_id": 51403459, "question_id": 51403320, "link": "https://stackoverflow.com/questions/51403320/browsetags-method-collector-object-vba-vs-c/51403459#51403459", "title": "BrowseTags method (Collector object) | VBA vs C#", "body": "<p>The parenthesis in VBA is an indexer. Try to replace <code>.Collectors.Item.(\"...\")</code> with <code>.Collectors.Item.[\"...\"]</code></p>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1531980150, "post_id": 51412621, "comment_id": 89801776, "body": "I would assume this method only finds tags that are allready added to the Histroian server. The other BrowseTags methode on the Collector object finds all tags from the collector added or not added to Historian, I&#39;m fairly sure this methode is equal to the &quot;Search Historian Tag Database&quot; within Historian Administrator where I would like to use the &quot;Add Tags From Collector&quot; browse methode."}], "tags": [], "owner": {"reputation": 645, "user_id": 1657427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4ba309579160b9a1df089052df11ae?s=128&d=identicon&r=PG", "display_name": "fuzzy_logic", "link": "https://stackoverflow.com/users/1657427/fuzzy-logic"}, "is_accepted": false, "score": 0, "last_activity_date": 1531961095, "last_edit_date": 1531961095, "creation_date": 1531959361, "answer_id": 51412621, "question_id": 51403320, "link": "https://stackoverflow.com/questions/51403320/browsetags-method-collector-object-vba-vs-c/51412621#51412621", "title": "BrowseTags method (Collector object) | VBA vs C#", "body": "<p>If you check the source code for the video link you provided (I.e. The client SDK sample), they aren't using the collectors to query the tags.</p>\n\n<p>cmdBrowseTags_Click is using the ITags \"Query\" method to 'Browse Tags'.</p>\n\n<p>Here is the GE provided help doco example included in \"iHistClientAccessAPI.chm\":</p>\n\n<pre><code>TagQueryParams query = new TagQueryParams();\nList&lt;Tag&gt; list = new List&lt;Tag&gt;(), temp = null;\n\nquery.Criteria.TagnameMask = \"*\";\n\n// simple query\nconnection.ITags.Query(ref query, out list);\n\n// paged query\nlist.Clear();\nquery.PageSize = 100; // return at most 100 results per request\nwhile (connection.ITags.Query(ref query, out temp))\n  list.AddRange(temp);\nlist.AddRange(temp);\n</code></pre>\n\n<p>I prefer something like this (includes the server connection for completeness):</p>\n\n<pre><code>ServerConnection serverConnection = new ServerConnection(\nnew ConnectionProperties\n{\n    ServerHostName = \"MyHistorianHostName\",\n    Username = \"MyUserName\",\n    Password = \"MyPassword\",\n    ServerCertificateValidationMode = CertificateValidationMode.None\n});\n\nserverConnection.Connect();\n\nif (serverConnection.IsConnected())\n{\n    List&lt;Tag&gt; tagList = new List&lt;Tag&gt;();\n    TagQueryParams tagQueryParams = new TagQueryParams\n    {\n        Criteria = new TagCriteria { TagnameMask = \"*\" }, // Wilcard, get all tags.\n        Categories = Tag.Categories.All, // Change this to Basic fo mimimal info.\n        PageSize = 100 // The batch size of the while loop below..\n    };\n\n    bool isQuery = true;\n    while (isQuery)\n    {\n        isQuery = serverConnection.ITags.Query(ref tagQueryParams, out var tags);\n        tagList.AddRange(tags);\n    }\n\n    // At this point, tagList contains a list of all tags that matched your wildcard filter.\n    // To filter to a specific collector, you could then do something like:\n    var collectorTagList = tagList.Where(t =&gt; t.CollectorName == \"MyCollector\");\n}\n</code></pre>\n\n<p>Goodluck :)</p>\n"}], "owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 524, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1531961095, "creation_date": 1531920624, "last_edit_date": 1531922093, "question_id": 51403320, "link": "https://stackoverflow.com/questions/51403320/browsetags-method-collector-object-vba-vs-c", "title": "BrowseTags method (Collector object) | VBA vs C#", "body": "<p>For a while i've been trying to make a standalone program in c#, which uses the BrowseTags function from iHistorian_SDK. (iFix 5.8 and Historian 7.0)</p>\n\n<p>First I made this function in VBA where it works great, but due to VBA being single threaded, I want to moive it out of VBA.</p>\n\n<p>My VBA code that works today:</p>\n\n<pre><code>Public connectedServer As Object\nPublic myServerManager As Object\n\n\nPrivate Sub TestBrowseFunction()    \n    Call BrowseTagsFromHistorianCollector(\"SVNF-IFIX-HIS01\", \"SVNF-IFIX-SCA01_iFIX\")    \nEnd Sub\n\nPublic Function BrowseTagsFromHistorianCollector(ByVal HistServer As String, ByVal HistCollector As String, Optional AdditionsOnly As Boolean = False, Optional SourceFilter As String = \"*\", Optional DescriptionFilter As String = \"*\")\n    On Error Resume Next\n    Dim MyTags As Variant\n    Dim Tag As Variant\n\n    Set connectedServer = Nothing\n    Set MyServerManager = CreateObject(\"iHistorian_SDK.ServerManager\")\n    DoEvents\n\n    'Make sure Historian is installed correctly'\n    If MyServerManager Is Nothing Then\n        Err.Raise 0, , \"Error Creating iHistorian Server Manager - please check to see if Historain Client is correctly installed on your system\", vbOKOnly, \"test\"\n        Exit Function\n    End If\n\n    'Create iHistorian server object'\n    Set connectedServer = CreateObject(\"iHistorian_SDK.Server\")\n\n    'Check to see if the connection is established, else connect.'\n    If CheckConnection = False Then connectedServer.Connect (HistServer)\n    If CheckConnection = True Then\n\n        'Browse the collector for tags.'\n        Set MyTags = connectedServer.collectors.Item(HistCollector).BrowseTags(AdditionsOnly, SourceFilter, DescriptionFilter)\n\n        'Loop all the tags from the collector'\n        For Each Tag In MyTags.Item\n            'INSERT CODE TO DO FOR EACH TAG HERE!'\n            Debug.Print Tag.tagName\n        Next\n\n    End If\n\nEnd Function\n\n\n\n' make sure that we are connected to a server'\nPublic Function CheckConnection() As Boolean\n    On Error GoTo errc\n\n    If connectedServer Is Nothing Then\n        CheckConnection = False\n        Exit Function\n    End If\n\n    If Not connectedServer.Connected Then\n        CheckConnection = False\n        Exit Function\n    End If\n\n    If connectedServer.ServerTime &lt; CDate(\"1/1/1970\") Then\n        CheckConnection = False\n        Exit Function\n    End If\n\n    CheckConnection = True\nExit Function\n\nerrc:\n  CheckConnection = False\nEnd Function\n</code></pre>\n\n<p>This works great.\nBut in my attempt to convert the same function over to C# i keep getting errors.</p>\n\n<p>First i connect to my historian server, which is pretty painless.</p>\n\n<pre><code>            tsStatus.Text = \"Connecting to \" + HistServer;\n            try\n            {\n                connectedServer = new iHistorian_SDK.Server();\n                connectedServer.Connect(HistServer);\n                tsStatus.Text = \"Connected to \" + HistServer;\n            }\n            catch (Exception ex)\n            {\n                Debug.Print(\"Server connection threw exception: \" + ex);\n                tsStatus.Text = \"Failed connecting to \" + HistServer;\n            }\n</code></pre>\n\n<p>My status label before i try to connect:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Geb4S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Geb4S.png\" alt=\"Before Connection\"></a></p>\n\n<p>My status label after i try to connect:</p>\n\n<p><a href=\"https://i.stack.imgur.com/joGLB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/joGLB.png\" alt=\"After connection\"></a></p>\n\n<p>After the connection is established, I would like to be able to do something like what i've done in VBA.</p>\n\n<pre><code>Set MyTags = connectedServer.collectors.Item(HistCollector).BrowseTags(AdditionsOnly, SourceFilter, DescriptionFilter)\n</code></pre>\n\n<p>My c# attempt goes as follows </p>\n\n<pre><code>            iHistorian_SDK.TagRecordset MyTags;\n            MyTags = new iHistorian_SDK.TagRecordset();\n\n            MyTags = connectedServer.Collectors.Item(\"SVNF-IFIX-SCA01_iFIX\").BrowseTags(false, \"*\", \"*\");\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kZ48D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kZ48D.png\" alt=\"Error\"></a></p>\n\n<p>Does anyone know how I can come around this, or if it's even possible in C# to browse tags with the same methode of the collector object.</p>\n\n<p>I've seen <a href=\"https://youtube.com/watch?v=wi5q9Ava_Bc\" rel=\"nofollow noreferrer\">this</a> video a few times so I would assume it's possible, they just skip the code where they actually browse tags.</p>\n\n<p>Thanks in advance\n/T</p>\n"}, {"tags": ["vba", "excel", "array-formulas"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921038, "post_id": 51403308, "comment_id": 89777792, "body": "Can you provide an example of your <code>Dates</code> sheet?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1531921052, "post_id": 51403308, "comment_id": 89777807, "body": "If the data is in Excel, the are VBA methods for finding the last cell with data. If the data is in an array in VBA, you can use the <code>UBound(array,1)-LBound(array,1)</code> to find the size of the array."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921169, "post_id": 51403308, "comment_id": 89777886, "body": "@Zac On that sheets there is only a series of identifiers in the first row, which are sent to the API."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1531921196, "post_id": 51403308, "comment_id": 89777907, "body": "@Mistella the data is in neither. It uses the identifiers in the sheet to get data from the API (factset)."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1531921281, "post_id": 51403308, "comment_id": 89777980, "body": "When API returns the data, where is that data stored?"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921432, "post_id": 51403308, "comment_id": 89778110, "body": "@Zac it is pasted directly to the worksheet, in any selected cell. If only one cell is selected, only one item of the array appears. If 2 cells are selected, 2 items appear, and so on."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921592, "post_id": 51403308, "comment_id": 89778235, "body": "Could you not use <code>UsedRange</code> to find out how many cells are populated in <code>the sheet</code>?"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531921697, "post_id": 51403308, "comment_id": 89778322, "body": "@Zac So far I could get 2 different outputs: if I go into the API and insert the formula, then it will past properly, all items included. If I run it from vba, just acessing the API, it will only past 1 cell, because that is what my macro is configured to select. I tried UsedRange also, but it shows shows the row with the formula is used, nothing more."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531923871, "post_id": 51403308, "comment_id": 89779848, "body": "Could you show an example function call with the actual values, not cell references please? Perhaps the one that generated your 5 dates shown at the top."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1531924064, "post_id": 51403308, "comment_id": 89779987, "body": "@QHarr the value in B1 is &quot;US09069NAF50&quot;"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1533959376, "post_id": 51403308, "comment_id": 90549790, "body": "The formula array you are referring is <code>=FDS(&quot; &amp; Cells(1, i).Address(0, 0) &amp; &quot;,&quot;&quot;FI_(CALL,,DATE,,DATE)&quot;&quot;)</code>? It&#39;s entered in worksheet <code>Call Prices</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1534143372, "post_id": 51403439, "comment_id": 90587523, "body": "The problem is, I don&#39;t have the initial  dates for every item, it comes from the API, so I could not pass it to an array."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 0, "last_activity_date": 1531920974, "creation_date": 1531920974, "answer_id": 51403439, "question_id": 51403308, "link": "https://stackoverflow.com/questions/51403308/how-to-output-an-excel-array-without-knowing-how-many-items-it-has/51403439#51403439", "title": "How to output an excel array without knowing how many items it has", "body": "<p>You can pull the dates into an array and then loop through each of the items in the array.  </p>\n\n<pre><code>Sub datesArray()\n   vDates As Variant\n\n   vDates = Sheets(\"Sheets1\").Range(\"A1:A5\")\n\n   For i = 1 To UBound(vDates)\n    'your code\n   Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531921307, "creation_date": 1531920602, "last_edit_date": 1531921307, "question_id": 51403308, "link": "https://stackoverflow.com/questions/51403308/how-to-output-an-excel-array-without-knowing-how-many-items-it-has", "title": "How to output an excel array without knowing how many items it has", "body": "<p><strong>Scenario:</strong> I have a code that connects to an API (in this case Factset) and retrieves some data. The data output of the formula is an array of dates, which can have any number of dates inside. </p>\n\n<p><strong>Issue:</strong> Currently, my code puts the formula into the sheets and updates. The problem is, for an excel array to work (as far as I understand), I have to select as many cells as output items and press \"ctrl+shift+enter\". The problem is, for each item in my list, I don't know precisely how many output values will be, so I cannot pre-select that range, therefore my output just get the first data row of the array.</p>\n\n<p>For example, the output should be:</p>\n\n<pre><code>15.01.2018\n15.02.2018\n15.03.2018\n15.04.2018\n15.05.2018\n</code></pre>\n\n<p>but since I don't know there will be 5 dates for that item, my current output is only:</p>\n\n<pre><code>15.01.2018\n</code></pre>\n\n<p><strong>Question:</strong> Is there a possible way to do this, without having the final number of data rows that will be in the output? If so, how could I do it?</p>\n\n<p><strong>Code so far:</strong></p>\n\n<pre><code>For i = 2 To numberofitems + 1\n    If wb.Worksheets(\"Dates\").Cells(1, i).Value &lt;&gt; \"\" Then\n        wb.Worksheets(\"Call Prices\").Cells(2, i).Formula = \"=FDS(\" &amp; Cells(1, i).Address(0, 0) &amp; \",\"\"FI_(CALL,,DATE,,DATE)\"\")\"\n        Application.Goto ActiveWorkbook.Sheets(\"Dates\").Cells(2, i)\n        Application.SendKeys(\"^+{ENTER}\")    \n    End If\nNext i\n</code></pre>\n\n<p><strong>Obs:</strong> I also read some other posts with the .FormulaArray property, but could not understand how to use it without preselecting the range.</p>\n\n<p>Obs2: The data is retrieved form the API (factset), so it is neither on the sheet nor in a VBA array. Since the data will come from the API, I don't know beforehand how many items it will have.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1531920647, "post_id": 51403221, "comment_id": 89777469, "body": "Have you considered <code>VLookUp</code>?"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1531920728, "post_id": 51403221, "comment_id": 89777538, "body": "you can also try index() with match()"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10062009, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-49QpW1MLmIg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pGX8QjNKEEnZhiYXAZdF_BIRfX0w/mo/photo.jpg?sz=128", "display_name": "Kunal", "link": "https://stackoverflow.com/users/10062009/kunal"}, "edited": false, "score": 0, "creation_date": 1531921341, "post_id": 51403335, "comment_id": 89778036, "body": "Thanks for the guidance but i checked that it compares cell vs cell and column vs columns but in my case there may be chances that data in row2 in sheet1 is coming at row3 so that tool will show not matching whereas it is there but at different row. Can you suggest something to cater this. Thanks"}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "reply_to_user": {"reputation": 11, "user_id": 10062009, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-49QpW1MLmIg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pGX8QjNKEEnZhiYXAZdF_BIRfX0w/mo/photo.jpg?sz=128", "display_name": "Kunal", "link": "https://stackoverflow.com/users/10062009/kunal"}, "edited": false, "score": 0, "creation_date": 1531922840, "post_id": 51403335, "comment_id": 89779130, "body": "Just updated by above answer to include a coded version"}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 0, "last_activity_date": 1531922783, "last_edit_date": 1531922783, "creation_date": 1531920660, "answer_id": 51403335, "question_id": 51403221, "link": "https://stackoverflow.com/questions/51403221/comparing-2-excel-sheet-with-common-key/51403335#51403335", "title": "Comparing 2 excel sheet with common key", "body": "<p>I know you are asking for code to do this, but if you are using Excel 2013 or later there is an add-on called Inquire that does this for you.  If you go to File > Options > Add-Ins > COM Add-ins > check Inquire.</p>\n\n<p>If you open both worksheets click on the Inquire ribbon and then select compare files.  It will compare the two files and create a new workbook with the results.</p>\n\n<p>There is also a lot of other cool functionality with this tool and you don't need to code anything.</p>\n\n<p>This is the code you could try instead:</p>\n\n<pre><code>Sub wsCompare()\n    Dim ws1 As Worksheet, ws2 As Worksheet, wsResults As Worksheet\n    Dim strKey As String\n    Dim lngFindKey As Long\n    Dim rngFindKey As Range\n\n    Set ws1 = Sheets(\"Sheet1\") 'set this to your first worksheet with data\n    Set ws2 = Sheets(\"Sheet2\") 'set this to your second worksheet with data\n    Set wsResults = Sheets(\"Sheet3\") 'set this to the worksheet with the results in it\n\n    For i = 1 To 4000 'update this to be the first row containing an ID to the last\n        strKey = ws1.Range(\"A\" &amp; i).Value\n        Set rngFindKey = ws2.Range(\"A:A\").Find(WHAT:=strKey)\n        lngFindKey = rngFindKey.Row\n\n        For x = 1 To 35\n            If x = 1 Then\n                wsResults.Range(\"A\" &amp; i).Value = strKey\n            Else\n                'add code to calc your difference assuming all numerical values do something like this\n                wsResults.Range(Cells(i, x)).Value = ws2.Range(Cells(longFindKey, x)).Value - ws1.Range(Cells(i, x)).Value\n            End If\n        Next x\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10062009, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-49QpW1MLmIg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pGX8QjNKEEnZhiYXAZdF_BIRfX0w/mo/photo.jpg?sz=128", "display_name": "Kunal", "link": "https://stackoverflow.com/users/10062009/kunal"}, "edited": false, "score": 0, "creation_date": 1531922214, "post_id": 51403796, "comment_id": 89778706, "body": "Thanks Solar Mike, that might be really helpful but when I have 30000 rows and 40 columns and i want to get the summary in another sheet, will this be useful, if yes then how. Thanks"}], "tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1531922664, "last_edit_date": 1531922664, "creation_date": 1531921873, "answer_id": 51403796, "question_id": 51403221, "link": "https://stackoverflow.com/questions/51403221/comparing-2-excel-sheet-with-common-key/51403796#51403796", "title": "Comparing 2 excel sheet with common key", "body": "<p>Well, put this together just to show what you can do with match, the result is the position of the result in the list.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GUV2c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GUV2c.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit: just to show how the formula changes when dealing with other sheets, ie data lists on sheets 1 and 2 with the match on sheet 3:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JgTY5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JgTY5.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 10062009, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-49QpW1MLmIg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pGX8QjNKEEnZhiYXAZdF_BIRfX0w/mo/photo.jpg?sz=128", "display_name": "Kunal", "link": "https://stackoverflow.com/users/10062009/kunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531922783, "creation_date": 1531920366, "last_edit_date": 1531921947, "question_id": 51403221, "link": "https://stackoverflow.com/questions/51403221/comparing-2-excel-sheet-with-common-key", "title": "Comparing 2 excel sheet with common key", "body": "<p>I am trying to compare to excel sheets with data 40000 rows and 35 columns.\nThere is common key in column A but data in both sheets are not same like.</p>\n\n<p>in sheets 1 there may be </p>\n\n<pre><code>A\nB\nC\nD\n</code></pre>\n\n<p>and in sheet2 there may be</p>\n\n<pre><code>A\nC\nD\nE\n</code></pre>\n\n<p>So I want to compare both and provide the difference in summary sheet.\nI have written code but don't know how to complete it.</p>\n\n<pre><code>Option Explicit\n\nSub Compare_Two_Excel_Files_Highlight_Differences()\n    'Define Object for Excel Workbooks to Compare\n    Dim sh As Integer, ShName As String, lColIdx As Long, sIdx As Long, ssh As String\n    Dim F1_Workbook As Workbook, F2_Workbook As Workbook, statmsg As String, trialcnt As Long\n    Dim iRow As Double, iCol As Double, iRow_Max As Double, iCol_Max As Double\n    Dim File1_Path As String, File2_Path As String, F1_Data As String, F2_Data As String, Header As String\n\n\n    'Assign the Workbook File Name along with its Path\n    File1_Path = ThisWorkbook.Sheets(\"Settings\").Cells(2, 2)\n    File2_Path = ThisWorkbook.Sheets(\"Settings\").Cells(3, 2)\n    iRow_Max = ThisWorkbook.Sheets(\"Settings\").Cells(4, 2)\n    iCol_Max = ThisWorkbook.Sheets(\"Settings\").Cells(5, 2)\n    lColIdx = ThisWorkbook.Sheets(\"Settings\").Cells(6, 2).Interior.ColorIndex\n\n    'Open Files To Compare\n    Set F2_Workbook = Workbooks.Open(File2_Path)\n    Set F1_Workbook = Workbooks.Open(File1_Path)\n\n'    Windows(\"File1_Path.xlsx\").Activate\n'    Columns(\"A:A\").Select\n'    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n'    Range(\"A1\").Select\n'    ActiveCell.FormulaR1C1 = \"Key\"\n'    Range(\"A2\").Select\n'    Windows(\"File2_Path.xlsx\").Activate\n'    Columns(\"A:A\").Select\n'    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n'    Range(\"A1\").Select\n'    ActiveCell.FormulaR1C1 = \"Key\"\n'    Range(\"A2\").Select\n\n\n    'With F1_Workbook object, now it is possible to pull any data from it\n    'Read Data From Each Sheets of Both Excel Files &amp; Compare Data\n    sIdx = 1\n'   trialcnt = 1\n    Header = 1\n    ThisWorkbook.Sheets(\"Summary\").Cells.Clear\n    ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 3) = F1_Workbook.Name\n    ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 4) = F2_Workbook.Name\n    ThisWorkbook.Sheets(\"Summary\").Activate\n    statmsg = Application.StatusBar\n    For sh = 1 To F1_Workbook.Sheets.Count\n        ShName = F1_Workbook.Sheets(sh).Name\n        ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 1) = ShName\n        ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 2) = \"Identical Sheets\"\n        ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 2).Interior.Color = vbWhite\n        Application.StatusBar = statmsg &amp; \" ,Processing Sheet: \" &amp; ssh\n\n    '    If ThisWorkbook.Sheets(\"Settings\").Cells(4, 2) = 0 Then iRow_Max = F1_Workbook.Sheets(ShName).Range(\"A:A\").SpecialCells(xlLastCell).Row\n    '    If ThisWorkbook.Sheets(\"Settings\").Cells(5, 2) = 0 Then iCol_Max = F1_Workbook.Sheets(ShName).Range(\"A:A\").SpecialCells(xlLastCell).Column\n    '    For iRow = 1 To iRow_Max\n    '    For iCol = 1 To iCol_Max\n    '        F1_Data = F1_Workbook.Sheets(ShName).Cells(iRow, iCol)\n    '        F2_Data = F2_Workbook.Sheets(ShName).Cells(iRow, iCol)\n\n\n        'Compare Data From Excel Sheets &amp; Highlight the Mismatches\n        '   Find row number\n\n        Dim Row As Long\n        Dim i As Integer\n    For i = 2 To ThisWorkbook.Sheets(\"Settings\").Cells(4, 2).Value\n\n        On Error Resume Next\n        Row = Application.WorksheetFunction.Match(F1_Workbook.Sheets(ShName).Cells(i, 1).Value, F1_Workbook.Sheets(ShName).Range(\"A1:A200\"), 0)\n\n\n        On Error GoTo 0\n\n        If lRow &gt; 0 Then\n        'code\n\n\n'        If ThisWorkbook.Sheets(\"Settings\").Cells(4, 2) = 0 Then iRow_Max = F1_Workbook.Sheets(ShName).Range(\"A:A\").SpecialCells(xlLastCell).Row\n'        If ThisWorkbook.Sheets(\"Settings\").Cells(5, 2) = 0 Then iCol_Max = F1_Workbook.Sheets(ShName).Range(\"A:A\").SpecialCells(xlLastCell).Column\n'        For iRow = 1 To iRow_Max\n'        For iCol = 1 To iCol_Max\n\n\n        F1_Data = F1_Workbook.Sheets(ShName).Cells(i, iCol)\n        F2_Data = F2_Workbook.Sheets(ShName).Cells(Row, iCol)\n\n\n            If F1_Data &lt;&gt; F2_Data Then\n  '             F1_Workbook.Sheets(ShName).Cells(iRow, iCol).Interior.ColorIndex = lColIdx\n                ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 2) = \"Mismatch Found\"\n                ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 2).Interior.ColorIndex = lColIdx\n                If ssh &lt;&gt; F1_Workbook.Sheets(sh).Name Then\n                    sIdx = sIdx + 1\n                    ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 3) = F1_Workbook.Sheets(sh).Name\n                    ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 4) = F2_Workbook.Sheets(sh).Name\n                    ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 1) = F1_Workbook.Sheets(ShName).Cells(1, 1).Value\n                    ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 2) = \"Field\"\n                    ssh = F1_Workbook.Sheets(sh).Name\n\n                End If\n                sIdx = sIdx + 1\n            '   ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 1) = F1_Workbook.Sheets(ShName).Cells(iRow, iCol).Address\n                ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 2) = F1_Workbook.Sheets(ShName).Cells(Header, iCol).Value\n                ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 1) = F1_Workbook.Sheets(ShName).Cells(iRow, 1).Value\n                ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 3) = F1_Data\n                ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 4) = F2_Data\n                ThisWorkbook.Sheets(\"Summary\").Cells(sIdx, 2).Select\n            End If\n   '     Next iCol\n\n\n        ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 2) = ThisWorkbook.Sheets(\"Settings\").Cells(7 + sh, 2) &amp; \" (\" &amp; iRow_Max &amp; \"-Rows , \" &amp; iCol_Max &amp; \"-Cols Compared)\"\n  '  Next sh\n\n    Next i\nEnd If\nTrial_Exit:\n    '''''Process Completed\n    F2_Workbook.Close savechanges:=False\n    F1_Workbook.Close savechanges:=True\n    Set F2_Workbook = Nothing\n    Set F1_Workbook = Nothing\n    ThisWorkbook.Sheets(\"Settings\").Activate\n    MsgBox \"Task Completed\"\n    Application.StatusBar = statmsg\n\n '   End With\n '   ThisWorkbook.Sheets(\"Settings\").Cells(1, 4).Font.Color = vbRed\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sum"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531920034, "post_id": 51403012, "comment_id": 89776968, "body": "You haven&#39;t asked for a value. Your code checks if your range <code>IsNumeric</code> (I suspect that this is always returning FALSE and so your total will always be &quot;&quot; (as you&#39;ve declared <code>TotalNp</code> as a Variant). So you are not getting anything returned. Are your columns in this range set as Text?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10093163"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1531920068, "post_id": 51403012, "comment_id": 89776996, "body": "@pnuts I&#39;m new to VBA, unfortunately I don&#39;t know what that is."}, {"owner": {"reputation": 113, "user_id": 7731623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TCREW.jpg?s=128&g=1", "display_name": "Nandan A", "link": "https://stackoverflow.com/users/7731623/nandan-a"}, "edited": false, "score": 0, "creation_date": 1531920224, "post_id": 51403012, "comment_id": 89777113, "body": "you should have been asked this in yesterdays question. Don&#39;t created duplicate questions.  <a href=\"https://stackoverflow.com/questions/51379712/macro-to-sum-values-from-another-workbook-with-multiple-sheets/51380681#51380681\" title=\"macro to sum values from another workbook with multiple sheets\">stackoverflow.com/questions/51379712/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10093163"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531920415, "post_id": 51403012, "comment_id": 89777280, "body": "@Zac The range is set as Numbers. Is it fine if I remove the condition and just keep the sum equation?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10093163"}, "reply_to_user": {"reputation": 113, "user_id": 7731623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TCREW.jpg?s=128&g=1", "display_name": "Nandan A", "link": "https://stackoverflow.com/users/7731623/nandan-a"}, "edited": false, "score": 0, "creation_date": 1531920474, "post_id": 51403012, "comment_id": 89777333, "body": "@NandanA This is for a different purpose, and in this case I&#39;m summing a range rather than a single cell."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10093163"}, "edited": false, "score": 0, "creation_date": 1531920843, "post_id": 51403162, "comment_id": 89777659, "body": "Thank you!  It returned the same value for each cell in the output column. I think my logic in this code isn&#39;t right. I want to sum all B3 values across 120 sheets, and then do that for the entire column."}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1531921312, "post_id": 51403162, "comment_id": 89778011, "body": "In that case the update I just made to the code should work.  I thought you were trying to sum the whole range not row by row"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10093163"}, "edited": false, "score": 0, "creation_date": 1531925288, "post_id": 51403162, "comment_id": 89780898, "body": "Many thanks. I think in the last part you meant (&quot;T&quot; &amp; X + 1)? I put that and it&#39;s working perfectly. Thanks again @vba_sql_programmer"}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1531925708, "post_id": 51403162, "comment_id": 89781176, "body": "@Lavender_Lady haha yeah that was it.  If it works don&#39;t forget to check the answer as working for you so that other people don&#39;t keep trying to answer the question."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": true, "score": 0, "last_activity_date": 1531921290, "last_edit_date": 1531921290, "creation_date": 1531920201, "answer_id": 51403162, "question_id": 51403012, "link": "https://stackoverflow.com/questions/51403012/how-to-sum-a-range-of-values-from-multiple-worksheets/51403162#51403162", "title": "How to sum a range of values from multiple worksheets", "body": "<p>In that case try this:</p>\n\n<pre><code>Sub FAggreg1PNFAWO()\nDim Aggreg1PNFAWO As Workbook, myWB As Workbook\nDim WS_Count As Integer, i As Integer\nDim filePath As String\nDim TotalNp As Variant\n\nSet myWB = ActiveWorkbook\nfilePath = \"Directory\"\n\nSet Aggreg1PNFAWO = Workbooks.Open(filePath, ReadOnly:=True)\nWS_Count = Aggreg1PNFAWO.Worksheets.Count\n\nFor X = 3 To 292\n    For i = 1 To WS_Count\n        If IsNumeric(Sheets(i).Range(\"B\" &amp; X)) Then\n           TotalNp = TotalNp + Sheets(i).Range(\"B\" &amp; X).Value\n        End If\n    Next\n    myWB.Activate\n    myWB.ActiveSheet.Range(\"T\" &amp; i + 1).Value = TotalNp\n    TotalNp = 0\n    Aggreg1PNFAWO.Activate\nNext X\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 7731623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TCREW.jpg?s=128&g=1", "display_name": "Nandan A", "link": "https://stackoverflow.com/users/7731623/nandan-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1531921806, "last_edit_date": 1531921806, "creation_date": 1531921445, "answer_id": 51403631, "question_id": 51403012, "link": "https://stackoverflow.com/questions/51403012/how-to-sum-a-range-of-values-from-multiple-worksheets/51403631#51403631", "title": "How to sum a range of values from multiple worksheets", "body": "<p>Here you can use <code>SUM</code> function to do this. In the below answer am assuming <code>B293</code> cell as empty and using it for summation. If you have some data in that cell then pick some other empty cell then try this.</p>\n\n<pre><code>Sub Sum()\n\nDim Project1P As Workbook\n    Dim WS_Count As Integer\n    Dim i As Integer\n    Dim V As Variant\n\n    Set Project1P = Workbooks.Open(\"C:\\Users\\Nandan\\Desktop\\SO\\SO1.xlsx\")\n    WS_Count = Project1P.Worksheets.Count\n    sumrange (WS_Count)\n\nEnd Sub\n\nFunction sumrange(TotalSheets As Integer)\n\n     Dim reserves As Variant\n\n     For i = 1 To TotalSheets\n       Sheets(i).range(\"B\" &amp; 293).Formula = \"=SUM(B3:B292)\"\n     Next\n\n     For i = 1 To TotalSheets\n      reserves = reserves + Sheets(i).range(\"B\" &amp; 293)\n     Next\n\n     For i = 1 To TotalSheets\n      Sheets(i).range(\"B\" &amp; 293).Clear\n     Next  \n\n    MsgBox \"Total of all sheets :\" &amp; reserves\n\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10093163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51403162, "answer_count": 2, "score": 0, "last_activity_date": 1531922172, "creation_date": 1531919734, "last_edit_date": 1531922172, "question_id": 51403012, "link": "https://stackoverflow.com/questions/51403012/how-to-sum-a-range-of-values-from-multiple-worksheets", "title": "How to sum a range of values from multiple worksheets", "body": "<p>I want to sum the same range of values (say B3:B292) in 120 worksheets such that:  \u03a3B3, \u03a3B4, \u03a3B5 ...... \u03a3B292.</p>\n\n<p>I am not getting an error for the below VBA code, but it's also not returning any values.</p>\n\n<pre><code> Sub FAggreg1PNFAWO()\n\n Dim Aggreg1PNFAWO As Workbook\n Dim WS_Count As Integer\n Dim filePath As String\n Dim i As Integer\n Dim TotalNp As Variant\n\n filePath = \"Directory\"\n\n Set Aggreg1PNFAWO = Workbooks.Open(filePath, ReadOnly:=True)\n WS_Count = Aggreg1PNFAWO.Worksheets.Count\n\n\nFor i = 1 To WS_Count\n'Sheets(i).range(\"B3:B292\") &lt;&gt; \"\" And\nIf IsNumeric(Sheets(i).range(\"B3:B292\")) Then\n    TotalNp = TotalNp + Sheets(i).range(\"B3:B292\")\nEnd If\nNext\nActiveWorkbook.Close\nThisWorkbook.Activate\nActiveSheet.range(\"T4:T293\").Value = TotalNp\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531920447, "post_id": 51402980, "comment_id": 89777306, "body": "Don&#39;t really understand your issue.. is it that you cannot select more than 3-4 ranges in a sheet from another workbook? Also, this <code>other</code> workbook, is that macro enabled and has macro&#39;s?"}, {"owner": {"reputation": 1, "user_id": 10069434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cfbe0775ed54ce1269ed332bb4a588?s=128&d=identicon&r=PG&f=1", "display_name": "yFaye", "link": "https://stackoverflow.com/users/10069434/yfaye"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531976749, "post_id": 51402980, "comment_id": 89800554, "body": "Workbook1 is macro enabled and has the above code with action button. Workbook2 is were all my data sets are. I can&#39;t select more than 4 data range from workbook2. But if i regular copy paste the data into workbook1 and then hit the action button for range select , i&#39;m able to select multiple ranges."}, {"owner": {"reputation": 1, "user_id": 10069434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cfbe0775ed54ce1269ed332bb4a588?s=128&d=identicon&r=PG&f=1", "display_name": "yFaye", "link": "https://stackoverflow.com/users/10069434/yfaye"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1531976876, "post_id": 51402980, "comment_id": 89800603, "body": "also if I copy the data sets from workbook2 and paste it in new workbook(not saved), the multiple range select macro works. Problem only occurs in workbook2 multiple selection."}], "owner": {"reputation": 1, "user_id": 10069434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cfbe0775ed54ce1269ed332bb4a588?s=128&d=identicon&r=PG&f=1", "display_name": "yFaye", "link": "https://stackoverflow.com/users/10069434/yfaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531919639, "creation_date": 1531919639, "question_id": 51402980, "link": "https://stackoverflow.com/questions/51402980/transpose-multiple-data-range", "title": "Transpose multiple data range", "body": "<p>I am stuck with the transpose selection criteria using the below code. Currently using as application.inbox for range selection for selecting the target range of data. But the problem arises when i select multiple range (using Ctrl), i'm only able to select only 3-4 data range in another excel(the code being in different excel than the working data range excel). But when i use the same vba-enable excel for selecting multiple data range, i can select many ranges simultaneously. Don't know where is the problem occurring.\ni'm not getting any error message while selecting data from different excel, it just that the previous selection gets deselect.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Range1 As Range, Range2 As Range, Rng As Range\nDim rowIndex As Integer\nxTitleId = \"Transpose\"\nSet Range1 = Application.Selection\nSet Range1 = Application.InputBox(\"Source Ranges:\", xTitleId, Range1.Address, \nType:=8)\nSet Range2 = Application.InputBox(\"Convert to (single cell):\", xTitleId, \nType:=8)\nrowIndex = 0\nApplication.ScreenUpdating = False\nFor Each Rng In Range1.Rows\n    Rng.Copy\n    Range2.Offset(rowIndex, 0).PasteSpecial Paste:=xlPasteAll, \nTranspose:=True\n    rowIndex = rowIndex + Rng.Columns.Count\nNext\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1531921154, "post_id": 51402831, "comment_id": 89777875, "body": "Actually it&#39;s because you have included a \\  in the file copy but not the creation of the directory. So you are trying to copy to O:\\docs\\process\\365  and not O:\\docs\\process365\\"}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1531923103, "post_id": 51402831, "comment_id": 89779313, "body": "You are right! That was part of my problem. But If I change the code to FileCopy f.SelectedItems(i), &quot;O:\\docs\\process&quot; &amp; (me.ID) Still have an error, this time error 75 Path/file access error"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1531924363, "post_id": 51402831, "comment_id": 89780241, "body": "You then need to add the \\ and a file name or <i>.</i> . It would help in your debugging if you created the full save path into a string variable and used debug.print to view it in the immediate windows."}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1531927144, "post_id": 51402831, "comment_id": 89782201, "body": "Very confused:  If in immediate window I print &quot;O:\\docs\\process&quot; &amp; (me.ID) It returns exactly what I want: O:\\docs\\process345 But still have the same error Thanks for your help."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1531927317, "post_id": 51402831, "comment_id": 89782315, "body": "That is a folder path, not a document name. You need to copy flibble.doc to <code>O:\\docs\\process345\\*.*</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531927573, "post_id": 51402831, "comment_id": 89782484, "body": "The <code>Destination</code> parameter of <code>FileCopy</code> must include the file name. Both parameters must be full paths."}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1531928004, "post_id": 51402831, "comment_id": 89782780, "body": "The file I want to copy is f.SelectedItems(i) how do I put that in the destination?"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1531935460, "post_id": 51402831, "comment_id": 89787156, "body": "What does the sFile variable end up holding after you assign it with <code>Filename(f.SelectedItems(i), sPath)</code>? Because from what I am seeing, there is never a Set value to <code>sPath</code>. It looks like it should come back as <code>Mid(strPath, InStrRev(strPath, &quot;\\&quot;) + 1)</code>, which should give you the proper file name. If that is the case, you can just use <code>sFile</code> for your file reference. So, it would be something like <code>FileCopy f.SelectedItems(i), &quot;O:\\docs\\process&quot; &amp; (me.ID) &amp; &quot;\\&quot; &amp; sFile</code> (assuming f.SelectedItems(i) returns the full path and filename)"}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1531936747, "post_id": 51402831, "comment_id": 89787827, "body": "Yes @jiggles ! f.SelectedItems(i) returns the full path and filename Now I can see this clearly. I am trying this first thing in the morning and will post how it goes. Thanks a lot!"}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1531986706, "post_id": 51402831, "comment_id": 89805386, "body": "Yes its working perfectly! <code>FileCopy f.SelectedItems(i), &quot;O:\\docs\\process&quot; &amp; (me.ID) &amp; &quot;\\&quot; &amp; sFile</code> I appreciate Everyone&#39;s help. So many important details learned."}], "answers": [{"tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1531935439, "last_edit_date": 1531935439, "creation_date": 1531935116, "answer_id": 51407920, "question_id": 51402831, "link": "https://stackoverflow.com/questions/51402831/copy-a-file-to-a-folder-created-with-a-table-field-as-part-of-the-name/51407920#51407920", "title": "Copy a file to a folder created with a table field as part of the name", "body": "<p>add a Slash and add the FileName</p>\n\n<pre><code>Private Sub Comando356_Click()\n' lets say my current record has an ID field value 345\n' The routine will check if folder O:\\docs\\process345 exists\n' If the folder does not exist, then the folder is created:\n\nIf \nLen(Dir(\"O:\\docs\\process\" &amp; (Me.ID), vbDirectory)) = 0 Then\nMkDir \"O:\\docs\\process\" &amp; (Me.ID)\nEnd If\n\n\u2018 So far it works perfectly: if the folder does not exist, is created\n\nDim f As Object\nSet f = Application.FileDialog(3)\nf.AllowMultiSelect = False\nIf f.Show Then\n    For i = 1 To f.SelectedItems.Count\n        sFile = Filename(f.SelectedItems(i), sPath)\n\n' My problem is the next line: folder O:\\docs\\process345 exists but I get an error 76 \u201cPath not Found\u201d       \n\n'   add some debugging\nDebug.Print (\"in=\" &amp; f.SelectedItems(i) &amp; \"  out=\" &amp;  \"O:\\docs\\process\" &amp; (me.ID) &amp; \"\\\" &amp; sFile)\n'   add a Slash and add the FileName\nFileCopy f.SelectedItems(i), \"O:\\docs\\process\" &amp; (me.ID) &amp; \"\\\" &amp; sFile  ' &lt;&lt;&lt;&lt;\n\n    Next\nEnd If\nEnd Sub\n\nPublic Function Filename(ByVal strPath As String, sPath) As String\n    sPath = Left(strPath, InStrRev(strPath, \"\\\"))\n    Filename = Mid(strPath, InStrRev(strPath, \"\\\") + 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 51407920, "answer_count": 1, "score": 1, "last_activity_date": 1531935439, "creation_date": 1531919237, "last_edit_date": 1531926886, "question_id": 51402831, "link": "https://stackoverflow.com/questions/51402831/copy-a-file-to-a-folder-created-with-a-table-field-as-part-of-the-name", "title": "Copy a file to a folder created with a table field as part of the name", "body": "<p>I found some VBA routines here in and I tried to adapt them to my situation.\nIt works fine but when I try to copy a file to a folder that has been created using in its name a constant \u201cprocess\u201d and a variable [ID] field, I get an error message.</p>\n\n<p>The error is in this line</p>\n\n<p>FileCopy f.SelectedItems(i), \"O:\\docs\\process\\ \" &amp; (me.ID)</p>\n\n<pre><code>Private Sub Comando356_Click()\n' lets say my current record has an ID field value 345\n' The routine will check if folder O:\\docs\\process345 exists\n' If the folder does not exist, then the folder is created:\n\nIf \nLen(Dir(\"O:\\docs\\process\" &amp; (Me.ID), vbDirectory)) = 0 Then\nMkDir \"O:\\docs\\process\" &amp; (Me.ID)\nEnd If\n\n\u2018 So far it works perfectly: if the folder does not exist, is created\n\nDim f As Object\nSet f = Application.FileDialog(3)\nf.AllowMultiSelect = False\nIf f.Show Then\n    For i = 1 To f.SelectedItems.Count\n        sFile = Filename(f.SelectedItems(i), sPath)\n\n' My problem is the next line: folder O:\\docs\\process345 exists but I get an error 76 \u201cPath not Found\u201d       \n\nFileCopy f.SelectedItems(i), \"O:\\docs\\process\" &amp; (me.ID)\n\n    Next\nEnd If\nEnd Sub\n\nPublic Function Filename(ByVal strPath As String, sPath) As String\n    sPath = Left(strPath, InStrRev(strPath, \"\\\"))\n    Filename = Mid(strPath, InStrRev(strPath, \"\\\") + 1)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531920441, "post_id": 51402659, "comment_id": 89777299, "body": "How are you removing the old range?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1531920561, "post_id": 51402659, "comment_id": 89777400, "body": "Instead of removing the Named Range I would suggest you look into creating a Dynamic Named Range by using the Offset Counta Counta formula."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531920594, "post_id": 51402659, "comment_id": 89777424, "body": "And (following on from Xabier&#39;s comment) why?"}, {"owner": {"reputation": 2648, "user_id": 6230407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgdHF.jpg?s=128&g=1", "display_name": "Marco Vos", "link": "https://stackoverflow.com/users/6230407/marco-vos"}, "edited": false, "score": 0, "creation_date": 1531921063, "post_id": 51402659, "comment_id": 89777821, "body": "This code should work. Is the name of your worksheet 1 or is it the first sheet? If it&#39;s an index you should remove the quotationmarks."}, {"owner": {"reputation": 23, "user_id": 8312492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa9f8dfe42261e3fb8def04e8b717d6?s=128&d=identicon&r=PG&f=1", "display_name": "Hotbready", "link": "https://stackoverflow.com/users/8312492/hotbready"}, "edited": false, "score": 0, "creation_date": 1531922348, "post_id": 51402659, "comment_id": 89778795, "body": "I&#39;m removing the old range by removing the old sheets, remove range, move new sheets into my workbook and then recreate a range. Yes, my sheets name is 1. I know that my code should work, i&#39;m suspecting something with PivotCache or something like that"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8312492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa9f8dfe42261e3fb8def04e8b717d6?s=128&d=identicon&r=PG&f=1", "display_name": "Hotbready", "link": "https://stackoverflow.com/users/8312492/hotbready"}, "is_accepted": false, "score": 0, "last_activity_date": 1531934860, "creation_date": 1531934860, "answer_id": 51407841, "question_id": 51402659, "link": "https://stackoverflow.com/questions/51402659/pivot-table-not-refreshing-when-named-range-is-changing-vba/51407841#51407841", "title": "Pivot table not refreshing when named range is changing [VBA]", "body": "<p>I just found out that I had to use the \"Offset\" function when recreating my named range.</p>\n\n<pre><code>Dim x As String\n'Retrieve the pre-built Offset function\nx = Worksheets(\"SYS_Parameter\").Range(\"I27\")\n'Create a name\nActiveWorkbook.Names.Add Name:=\"zTest\", RefersTo:=x\n</code></pre>\n\n<p>So in my previous code, if I replace \"FP_Area\" by \"x\", it's working perfectly.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 23, "user_id": 8312492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa9f8dfe42261e3fb8def04e8b717d6?s=128&d=identicon&r=PG&f=1", "display_name": "Hotbready", "link": "https://stackoverflow.com/users/8312492/hotbready"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531934860, "creation_date": 1531918730, "question_id": 51402659, "link": "https://stackoverflow.com/questions/51402659/pivot-table-not-refreshing-when-named-range-is-changing-vba", "title": "Pivot table not refreshing when named range is changing [VBA]", "body": "<p>I have a pivot table which use a named range (\"FP_Area\") as data source. I have a code that update this named range by remove it and recreate with fresh data.</p>\n\n<p>My problem is when I refresh my pivot table with the following code, it does not refresh properly and used old data from old named range (\"FP_Area\")</p>\n\n<p>Here's how I update my pivot table:</p>\n\n<pre><code>Sub Test1_Refresh()\n\n    Dim Pivot_sht As Worksheet\n    Dim PivotName As String\n\n   'Set Variables Equal to Data Sheet and Pivot Sheet\n    Set Pivot_sht = ThisWorkbook.Worksheets(\"1\")\n\n   'Enter in Pivot Table Name\n    PivotName = \"Test1\"\n\n   'Change Pivot Table Data Source Range Address\n    Pivot_sht.PivotTables(PivotName).ChangePivotCache _\n        ThisWorkbook.PivotCaches.Create( _\n            SourceType:=xlDatabase, _\n                 SourceData:=\"FP_Area\")\n\n   'Ensure Pivot Table is Refreshed\n    Pivot_sht.PivotTables(PivotName).RefreshTable\nEnd Sub\n</code></pre>\n\n<p>However, it still use the old \"FP_Area\" data.</p>\n\n<p>I'm using this version: \n     Microsoft Excel 2010 (14.0.7109.5000) Part of Microsoft Office Professional \n     Plus 2018</p>\n\n<p>Thanks,\nMax</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1531919534, "post_id": 51402559, "comment_id": 89776566, "body": "Put the columns that you want to remain unchanged in to an array -- this should be arguably faster / more efficient than making a copy of the Range or Sheet object. Then use the built in method(s) to <code>Sort</code> the range. Of course this will affect all of the columns, but you&#39;ve got the array from earlier, so just dump the array back to the sheet for the unchanged columns."}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1531919612, "post_id": 51402559, "comment_id": 89776636, "body": "Thanks, @DavidZemens, I was thinking even the opposite, to make a new range with just the sorting column and the column I want sorted, do the sort and then paste back column 2. Just hoping there&#39;s a better way still..."}], "answers": [{"comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1531919958, "post_id": 51402998, "comment_id": 89776906, "body": "Sorry, @GarysStudent, but will this only work for integers in the Sort Order column. That was just a very over-simplified example. It could be decimal values too..."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 1, "creation_date": 1531920501, "post_id": 51402998, "comment_id": 89777353, "body": "@JohnBustos  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1531920478, "last_edit_date": 1531920478, "creation_date": 1531919697, "answer_id": 51402998, "question_id": 51402559, "link": "https://stackoverflow.com/questions/51402559/vba-sort-a-single-column-based-upon-values-in-another-non-adjacent-column/51402998#51402998", "title": "VBA - Sort a single column based upon values in another, non-adjacent column", "body": "<p>With the sort order in column <strong>A</strong> and the data in column <strong>C</strong>, in <strong>E2</strong> enter:</p>\n\n<pre><code>=INDEX(C:C,MATCH(ROWS($1:1),A:A,0))\n</code></pre>\n\n<p>and copy downward:</p>\n\n<p><a href=\"https://i.stack.imgur.com/50gpu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/50gpu.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If the values in column <strong>A</strong> are not simple sequential integers, then we can use a \"helper column\".  In <strong>F2</strong> enter:</p>\n\n<pre><code>=MIN(A:A)\n</code></pre>\n\n<p>and in <strong>F3</strong> enter the <strong>array formula</strong>:</p>\n\n<pre><code>=MIN(IF(A:A&gt;F2,A:A,\"\"))\n</code></pre>\n\n<p>and copy downwards.  <strong>Array formulas</strong> must be entered with <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> rather than just the <kbd>Enter</kbd> key.  If this is done correctly, the formula will appear with curly braces around it in the Formula Bar.</p>\n\n<p>Then in <strong>E2</strong> enter:</p>\n\n<pre><code>=INDEX(C:C,MATCH(F2,A:A,0))\n</code></pre>\n\n<p>and copy downward:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EcPvi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EcPvi.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that the \"helper\" is really just a sorted version of column <strong>A</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1531920211, "post_id": 51403134, "comment_id": 89777107, "body": "Thank you. This is very possibly the easiest way... Just wish Excel had a native way to sort non-contiguous columns."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 3, "last_activity_date": 1531920117, "creation_date": 1531920117, "answer_id": 51403134, "question_id": 51402559, "link": "https://stackoverflow.com/questions/51402559/vba-sort-a-single-column-based-upon-values-in-another-non-adjacent-column/51403134#51403134", "title": "VBA - Sort a single column based upon values in another, non-adjacent column", "body": "<p>As per David Zemens comments, you can do this as follows:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheet1\n'declare and set the Worksheet you are working with, amend as require\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on Column A\n\nArr = ws.Range(\"B2:B\" &amp; LastRow) 'add values from column B into an Array\n\n    ws.Sort.SortFields.Clear\n    ws.Sort.SortFields.Add2 Key:=Range(\"A1\"), _\n        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ws.Sort\n        .SetRange Range(\"A2:C\" &amp; LastRow)\n        .Header = xlNo\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    'sort on column A\nws.Range(\"B2:B\" &amp; LastRow).Value = Arr 'add the values of the array back into Column B\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1531921823, "post_id": 51403486, "comment_id": 89778410, "body": "Really interesting!!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1531922366, "post_id": 51403486, "comment_id": 89778805, "body": "@JohnBustos made a small revision to reduce the number of <code>.Value</code> assignments on the worksheet :)"}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 1, "creation_date": 1531922763, "post_id": 51403486, "comment_id": 89779082, "body": "I do like this, but feel like the line <code>sortedValues(i) = .Index(originalValues, .Match(sortList(i), sortOrder, False), 1)</code> could end up being pretty costly... VERY cool implementation / idea, though. I ended up going with a different solution, but thank you so much for even thinking of something quite so out-the-box!!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1531922335, "last_edit_date": 1531922335, "creation_date": 1531921079, "answer_id": 51403486, "question_id": 51402559, "link": "https://stackoverflow.com/questions/51402559/vba-sort-a-single-column-based-upon-values-in-another-non-adjacent-column/51403486#51403486", "title": "VBA - Sort a single column based upon values in another, non-adjacent column", "body": "<p>Here's another way, just for fun, using the <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.arraylist(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"nofollow noreferrer\"><code>System.Collections.ArrayList</code></a> to leverage its built-in <code>Sort</code> method.</p>\n\n<p>Should be self-explanatory, but if not, here goes...</p>\n\n<p>We cache the original values of <code>colToSort</code> in <code>originalValues</code> array, and define our ArrayList using the \"Sort Order\" column, then apply the <code>Sort</code> method to the <code>sortList</code> object.</p>\n\n<p>Still haven't sorted anything on the worksheet, but now we can iterate the <code>sortList</code> and <code>Index</code> against the <code>originalValues</code> to write out to the sheet:</p>\n\n<pre><code>Option Explicit\n\nSub sortThis()\nDim sortList As Object\nDim i As Long\nDim sortOrder As Range\nDim colToSort As Range\nDim originalValues\n\nSet sortList = CreateObject(\"System.Collections.ArrayList\")\nSet sortOrder = Range(\"A2:A5\")\nSet colToSort = Range(\"C2:C5\")\n\noriginalValues = colToSort.Value\nReDim sortedValues(UBound(originalValues))\n\nFor i = 1 To sortOrder.Cells.Count\n    sortList.Add (sortOrder.Cells(i).Value2)\nNext\n\nsortList.Sort\n\nWith Application\n    For i = 0 To sortList.Count - 1\n        sortedValues(i) = .Index(originalValues, .Match(sortList(i), sortOrder, False), 1)\n    Next\n    colToSort.Value = .Transpose(sortedValues)\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "is_accepted": true, "score": 0, "last_activity_date": 1531937165, "last_edit_date": 1531937165, "creation_date": 1531922530, "answer_id": 51404061, "question_id": 51402559, "link": "https://stackoverflow.com/questions/51402559/vba-sort-a-single-column-based-upon-values-in-another-non-adjacent-column/51404061#51404061", "title": "VBA - Sort a single column based upon values in another, non-adjacent column", "body": "<p>Although @DavidZemens, @Xabier and @GarysStudent supplied really good answers - Both using VBA and Excel functions, I ended up making up my own that:</p>\n\n<ol>\n<li>Copied only the (1) Column to sort by (<code>Sort Order</code>) &amp; (2) Column to be sorted (<code>Col2</code>) into a new, blank range.</li>\n<li>Sorted that range based upon the first column</li>\n<li>Copied the second column back over the original column I wanted sorted</li>\n</ol>\n\n<p>The reason I went with that implementation is because:</p>\n\n<ol>\n<li>It allowed for any kind of values in the <code>Sort Order</code> column</li>\n<li>It allowed me to extend it to multiple columns / allow for looping (which I needed) by paramaterizing it.</li>\n</ol>\n\n<p>Here's my solution:</p>\n\n<pre><code>Sub Tester()\n\n' The data we want sorted and the column to sort by:\nDim SortByCol As Range\nDim ToSortCol As Range\n    Set SortByCol = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A7\")\n    Set ToSortCol = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"C1:C7\")\n\n\n' An empty range to use for copying / pasting to:\nDim SortRange As Range\n    Set SortRange = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1\")\n\n    DoSort SortByCol, ToSortCol, SortRange\nEnd Sub\n\n\nSub DoSort(SortByCol As Range, ToSortCol As Range, SortRange As Range)\n\n    ' Copy our data to sort into a contiguous range so we can sort using Excel's native sort functionality:\n    Union(SortByCol, ToSortCol).Copy SortRange\n\n    ' Reset the SortRange to the entire pasted in region:\n    Set SortRange = SortRange.CurrentRegion\n\n    ' Sort the SortRange:\n    With SortRange.Parent.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=SortRange.Range(\"A1:A\" &amp; SortRange.Rows.Count), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\n        .SetRange SortRange\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    ' Copy the second column back into the ToSort Column:\n    SortRange.Columns(2).Copy ToSortCol\n\n    SortRange.Clear\nEnd Sub\n</code></pre>\n\n<p>However, I will say the other solutions presented were perfect, but my specific situation was best handled using the code above.</p>\n\n<p>Thanks again to @DavidZemes, @Xabier and @GarysStudent!!</p>\n"}], "owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 1, "accepted_answer_id": 51404061, "answer_count": 4, "score": 0, "last_activity_date": 1531937165, "creation_date": 1531918462, "last_edit_date": 1531919075, "question_id": 51402559, "link": "https://stackoverflow.com/questions/51402559/vba-sort-a-single-column-based-upon-values-in-another-non-adjacent-column", "title": "VBA - Sort a single column based upon values in another, non-adjacent column", "body": "<p>Suppose I have the following range in an Excel (2016) worksheet:</p>\n\n<pre><code>Sort Order:    Col1:    Col2:\n3              A        A\n4              B        B\n2              C        C\n1              D        D\n</code></pre>\n\n<p>And <strong>I want to leave all the other columns unchanged</strong>, but sort <code>Col2</code> based upon the values in the <code>Sort Order</code> column. So the final result would be:</p>\n\n<pre><code>Sort Order:    Col1:    Col2:\n3              A        D\n4              B        C\n2              C        A\n1              D        B\n</code></pre>\n\n<p>In words, I want to sort a specific column based upon another, non-adjacent column's values without affecting any other column in my range.</p>\n\n<p>I know I could go the route of making a copy of the range and pasting back the original values in everything but the column I want sorted, but I'm not a HUGE fan of that one if I can get away without having to do that. Otherwise, I'd imagine I could import the range in as an array and implement my own sort procedure from that point (if you have simple code to do this, though, please do share), but I'm hoping there's an easier way.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531918644, "post_id": 51402485, "comment_id": 89775929, "body": "Can you write <code>MsgBox tbl.Name</code> on the line before the error?"}, {"owner": {"reputation": 81, "user_id": 9891975, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vib500", "link": "https://stackoverflow.com/users/9891975/vib500"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1531918722, "post_id": 51402485, "comment_id": 89775995, "body": "I add a watch: &quot;Sal_Vol_Ret_Mec&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1531918935, "post_id": 51402485, "comment_id": 89776155, "body": "Is there any reason not to use the <code>DataBodyRange</code> of each <code>tbl</code>?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1531919089, "post_id": 51402485, "comment_id": 89776251, "body": "@vib500 - how exactly your table looks like? Probably it would be quite helpful to provide a screenshot, or simply try from scratch. <code>Set Rng = Range(tbl.name)</code> works quite ok for me. Or try <code>Set Rng = Range(tbl.DataBodyRange.Address)</code> as proposed by @BigBen."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1531919160, "post_id": 51402485, "comment_id": 89776303, "body": "@Vityata - no need to use <code>Range</code> or <code>Address</code> - just <code>For each c in tbl.DataBodyRange</code>."}, {"owner": {"reputation": 81, "user_id": 9891975, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vib500", "link": "https://stackoverflow.com/users/9891975/vib500"}, "edited": false, "score": 0, "creation_date": 1531919257, "post_id": 51402485, "comment_id": 89776376, "body": "I put Set Rng = tbl.DataBodyRange and it worked like a charm. I just understood: in very few tables, I have only one column, but the range of only one column was not OK..IDK. Whatever, it&#39;s working :). thanks a lot"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1531919682, "last_edit_date": 1531919682, "creation_date": 1531919316, "answer_id": 51402862, "question_id": 51402485, "link": "https://stackoverflow.com/questions/51402485/error-with-set-range-data-table/51402862#51402862", "title": "Error with Set range data table", "body": "<p>I guess the problem is that the parent (The Worksheet) of <code>.Range()</code> is not defined explicitly. Thus, it looks for the Table on the <code>ActiveSheet</code> or on the Sheet, where the code is. Thus, it was working yesterday, probably before the <code>ActiveSheet</code> was different.</p>\n\n<p>As a rule of a thumb in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> - make sure that you always declare the Worksheet of a <code>Range</code>, <code>Cell</code>, <code>Column</code>, <code>Row</code> or any other <code>Range</code> object. In this case:</p>\n\n<pre><code>For Each tbl In Worksheets(\"Assumptions\").ListObjects\n        Set Rng = Worksheets(\"Assumptions\").Range(tbl.name)\n        For Each c In Rng\n            If Not IsEmpty(c.Value) Then\n                Worksheets(brand).Range(c.Address).Value = c.Value\n            End If\n        Next\nNext tbl\n</code></pre>\n\n<p>or if you like this one:</p>\n\n<pre><code>Set Rng = Worksheets(tbl.Parent.Name).Range(tbl.Name)\n</code></pre>\n\n<p>and if you are working with multiple Excel files, something like this is possible \n(but probably not advisable):</p>\n\n<pre><code>Set Rng = Workbooks(tbl.Parent.Parent.Name).Worksheets(tbl.Parent.Name).Range(tbl.Name)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1531919649, "creation_date": 1531919649, "answer_id": 51402985, "question_id": 51402485, "link": "https://stackoverflow.com/questions/51402485/error-with-set-range-data-table/51402985#51402985", "title": "Error with Set range data table", "body": "<p>Use already existing object components of a <code>ListObject</code> - in your case <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/listobject-databodyrange-property-excel\" rel=\"nofollow noreferrer\">ListObject.DataBodyRange</a> - instead of <code>Set Rng = Range(tbl.Name)</code>.</p>\n\n<pre><code>For Each tbl In Worksheets(\"Assumptions\").ListObjects\n    For each c in tbl.DataBodyRange\n    ...\n    Next c\nNext tbl\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 9891975, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vib500", "link": "https://stackoverflow.com/users/9891975/vib500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 51402985, "answer_count": 2, "score": 1, "last_activity_date": 1531919682, "creation_date": 1531918229, "question_id": 51402485, "link": "https://stackoverflow.com/questions/51402485/error-with-set-range-data-table", "title": "Error with Set range data table", "body": "<p>I have an error when I run this macro and even with the debug procedure, I'm unable to find what is wrong</p>\n\n<pre><code>Sub Update(brand)\n\nDim c As Range\nDim tbl As ListObject\nDim Rng As Range\nDim i As Integer\n\nbrand = brand &amp; \"_Param\"\n\nFor Each tbl In Worksheets(\"Assumptions\").ListObjects\n        Set Rng = Range(tbl.name)\n        For Each c In Rng\n            If Not IsEmpty(c.Value) Then\n                Worksheets(brand).Range(c.Address).Value = c.Value\n            End If\n        Next\nNext tbl\n\n\nEnd Sub\n</code></pre>\n\n<p>the issue comme from <code>Set Rng = Range(tbl.name)</code>\nI got the error message: Method range of object _global failed</p>\n\n<p>I used this kind of code a lot few days ago and I don't get why it's not working anymore</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 2, "creation_date": 1531919194, "post_id": 51402218, "comment_id": 89776332, "body": "Without seeing the code - which I suspect is extensive from your description, I wonder if this is a &quot;object left open&quot; type problem which is gobbling memory eventually causing Access to hang. Sometime a DoEvents in a suitable place can force background events to process in a more orderly fashion."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1531928242, "post_id": 51402218, "comment_id": 89782933, "body": "Again, some representative code and database structure (and some sample data) would help us. However, could you please clarify whether you&#39;re creating new tables, or populating existing ones? Your question mentions both."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1531928432, "post_id": 51402218, "comment_id": 89783039, "body": "Are you saying the &quot;object left open&quot; is the new file I create after converting each original xml file? If this is the case is there anyway to close a created textfile(in the script) after creating it?   I specified textfile because I my program creates textfiles, that upon the dataset completion, I batch rename to xml."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1531928461, "post_id": 51402218, "comment_id": 89783059, "body": "Always populating existing tables.  Just creating new records in multiple tables."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1531928802, "post_id": 51402218, "comment_id": 89783287, "body": "And to add to Minty&#39;s suspicions, I also believe that problem lies within the usage of memory and its affects on my machine&#39;s computing ability.  The representative code does not matter at this point, but as a general overview of what my codes does in relationship to the problem I am describing, I will lay it out below in a sort flow chart."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1531928842, "post_id": 51402218, "comment_id": 89783315, "body": "In a loop, Take in the next existing XML file, Parse it, Convert it, Add it to the Tables as the next incremented new file, Save It, repeat 1 million times (for each existing file)"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1531936407, "post_id": 51402218, "comment_id": 89787656, "body": "Is there some reason you cannot post your code, or some variation of it? It should not really be that extensive based on what it is doing, a relatively simple <code>recordset</code> movement and single increment with a file parser isn&#39;t really huge. I can tell you for sure, that no one can solve this problem without more information than is currently being shared. It certainly seems to me that there is a bug in the code somewhere though. In answer to your &quot;question&quot;, Access will hang with any sort of looping process no matter how trivial, but it won&#39;t affect the way anything is processed in the least."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "is_accepted": false, "score": 0, "last_activity_date": 1531936093, "creation_date": 1531936093, "answer_id": 51408152, "question_id": 51402218, "link": "https://stackoverflow.com/questions/51402218/why-cant-access-keep-up-with-my-vba-code-in-regards-to-building-tables-in-acces/51408152#51408152", "title": "Why can&#39;t access keep up with my VBA code in regards to building tables in access from existing xml files using vba?", "body": "<p>Don't ask me how I figured it out but through your answers, talking to colleagues, searching for related questions, and redefining the meaning of life, I found the answer!</p>\n\n<p>The problem was not with my code but with how fast my system executed the code compared to how fast Access executed the .Update function.  My program was getting ahead of the completion of Access's .Update table function to a point where my incrementor would \"hang up\" and not see the new table entry because it was not there yet.  </p>\n\n<p>I added a few millisecond pause after the .Update and poof, perfectly working incrementor and table updating combo.  I will be narrowing the delay time down to the minimum needed shortly, but my question is answered; Access program processing is slower than VBA code calculations by a lot.  Thanks Everyone!</p>\n"}], "owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531936093, "creation_date": 1531917443, "last_edit_date": 1531919316, "question_id": 51402218, "link": "https://stackoverflow.com/questions/51402218/why-cant-access-keep-up-with-my-vba-code-in-regards-to-building-tables-in-acces", "title": "Why can&#39;t access keep up with my VBA code in regards to building tables in access from existing xml files using vba?", "body": "<p>The situation more in depth:</p>\n\n<p>I am dealing with around one million existing xml files and I have created a program in <code>VBA</code>, within Access 2016 that converts these files to a different type of xml with a new file name, and then saves them to the new file name in a different folder.</p>\n\n<p>As the program builds these new files it also adds entries to about 15 access tables within the database in which the VBA code for the program exists.<br>\nThe only issue that I am having is that as my code increments the new file name and attempts to add it to the main access table, access \"hangs up\" and repeats several random increment numbers, a random amount of times which ruins the talbe output and does not allow repeated new file names to save (or they save over the original).</p>\n\n<p>Each time I run the program the result is different, but when I put a stop in my code after the completion of each file conversion and creation and manually cycle through each files by hitting play and refreshing the table with the increment problem, the increment in my talbe works perfect and the results are consistent.</p>\n\n<p>I guess what I am asking is, is it normal for when using VBA code to build tables from existing files, for access to \"hang up\" when adding a new record to a table using an incrementor?</p>\n\n<p>If not, could I add a refresh of the table after I add a new record entry or before I save the new file to alleviate the issue, and how do I code that refesh  of a table?  (I already use .Update upon the completion of .AddNew)</p>\n\n<p>Or, could I add a pause in similiar locations to allow access to catch up before VBA continues its calculations and processing?</p>\n"}, {"tags": ["vba", "excel", "auto-populate", "auto-populating"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10099482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NuG7gWu5wYg/AAAAAAAAAAI/AAAAAAAAAOI/1JEvGkCsr9k/photo.jpg?sz=128", "display_name": "Lou", "link": "https://stackoverflow.com/users/10099482/lou"}, "edited": false, "score": 0, "creation_date": 1531923552, "post_id": 51402927, "comment_id": 89779614, "body": "Can I integrate the if function in the cell function? I am not quiet understanding this cell(contents, function)"}, {"owner": {"reputation": 31, "user_id": 10099482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NuG7gWu5wYg/AAAAAAAAAAI/AAAAAAAAAOI/1JEvGkCsr9k/photo.jpg?sz=128", "display_name": "Lou", "link": "https://stackoverflow.com/users/10099482/lou"}, "edited": false, "score": 0, "creation_date": 1531924170, "post_id": 51402927, "comment_id": 89780067, "body": "works like a charm. is there a way to integrate this function in vba so it populates all the rows?"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 31, "user_id": 10099482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NuG7gWu5wYg/AAAAAAAAAAI/AAAAAAAAAOI/1JEvGkCsr9k/photo.jpg?sz=128", "display_name": "Lou", "link": "https://stackoverflow.com/users/10099482/lou"}, "edited": false, "score": 0, "creation_date": 1531924919, "post_id": 51402927, "comment_id": 89780627, "body": "Cell is a function that can return information on the cell.  The way it is used in this case was to return the contents of the cell.  For more information: <a href=\"https://www.excelfunctions.net/Excel-Cell-Function.html\" rel=\"nofollow noreferrer\">Excel Cell Function</a>"}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": true, "score": 0, "last_activity_date": 1531920982, "last_edit_date": 1531920982, "creation_date": 1531919475, "answer_id": 51402927, "question_id": 51402087, "link": "https://stackoverflow.com/questions/51402087/auto-populating-rows-from-another-sheet-conditional-to-a-specific-cell-value/51402927#51402927", "title": "Auto populating rows from another sheet conditional to a specific cell value", "body": "<p>What your looking for is the INDIRECT function</p>\n\n<p>As an example:</p>\n\n<pre><code>=CELL(\"contents\",INDIRECT(\"Sheet1!B5\"))\n</code></pre>\n\n<p>This always pick up the value in Sheet1 Cell B5, regardless of changes in Sheet1.</p>\n\n<p>For more information: <a href=\"http://www.contextures.com/xlFunctions05.html\" rel=\"nofollow noreferrer\">Excel INDIRECT Function</a></p>\n\n<hr>\n\n<p>Edit: To directly answer the question with INDIRECT.</p>\n\n<pre><code>=IF(OR(INDIRECT(\"'Le 2250'!C48\")=\"Nouveau locataire\",INDIRECT(\"'Le 2250'!C48\")=\"D\u00e9c\u00e8s\"),CELL(\"contents\",INDIRECT(\"'Le 2250'!B48\")),\"\")\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10099482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NuG7gWu5wYg/AAAAAAAAAAI/AAAAAAAAAOI/1JEvGkCsr9k/photo.jpg?sz=128", "display_name": "Lou", "link": "https://stackoverflow.com/users/10099482/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 51402927, "answer_count": 1, "score": 0, "last_activity_date": 1531920982, "creation_date": 1531917086, "last_edit_date": 1531917261, "question_id": 51402087, "link": "https://stackoverflow.com/questions/51402087/auto-populating-rows-from-another-sheet-conditional-to-a-specific-cell-value", "title": "Auto populating rows from another sheet conditional to a specific cell value", "body": "<p>Hello i am trying to autopopulate rows from another sheet if a specific value if found in a specific cell. So far, i managed to do it manually by adding this line in Sheet #2 for each cell.</p>\n\n<p><code>=IF(OR('Le 2250'!$C48=\"Nouveau locataire\",'Le 2250'!$C48=\"D\u00e9c\u00e8s\", 'Le 2250'!$C48=\"Retention\"), 'Le 2250'!$B48,\"\")</code></p>\n\n<p>I am trying to create a vba script that will generate each column in Sheet#2, and that will dynamically update regarding if i add a row in Sheet 1 or delete it.</p>\n\n<p>Sheet1 is: </p>\n\n<p><a href=\"https://i.stack.imgur.com/88FME.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/88FME.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet2 is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VHB9X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VHB9X.png\" alt=\"enter image description here\"></a></p>\n\n<p>Your help is appreciated</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 21, "user_id": 10099182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a198b0c9214955b0664c7e8df41e93c3?s=128&d=identicon&r=PG&f=1", "display_name": "TSpagh", "link": "https://stackoverflow.com/users/10099182/tspagh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531914629, "creation_date": 1531914629, "question_id": 51401305, "link": "https://stackoverflow.com/questions/51401305/excel-udf-precedence-udf-in-add-in-takes-precedence-over-udf-in-workbook-itself", "title": "Excel UDF precedence: UDF in add-in takes precedence over UDF in workbook itself", "body": "<p>I have my own Excel User Defined Functions (UDFs) which are in an Excel add-in file (.xlam) attached to my Excel.</p>\n\n<p>When I deliver workbooks to clients I copy the necessary VBA modules into the final workbook (let's call this the \"workbook+VBA\").</p>\n\n<p>If I disconnect my master add-in from Excel (via the Excel VBA Add-ins dialogue) and then open the \"workbook+VBA\" then everything is OK.</p>\n\n<p>However, if my master add-in is still connected to Excel, then Excel will give precedence to linking to the UDF in the add-in rather than the same named UDF included in the \"workbook+VBA\" itself.</p>\n\n<p>If I save the \"workbook+VBA\", disconnect the master add-in and then reopen the \"workbook+VBA\", then all the Excel cell formulas calling the UDFs will be prefixed with the full path to my master add-in .xlam file.</p>\n\n<p>This behavior was introduced with Excel 2007. Prior to this Excel gave precedence to the UDF included in the workbook itself above the same named UDF in an add-in.</p>\n\n<p>Is there any way in which this order of precedence can be reversed so that the workbook itself takes precedence as UDF source?</p>\n\n<p>Searches for this topic have been unsuccessful.</p>\n"}, {"tags": ["vba", "pdf", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531948843, "post_id": 51401092, "comment_id": 89793787, "body": "&quot;Object&quot; appears to be incorrect <code>Set pmkr2 = a</code>"}, {"owner": {"reputation": 31, "user_id": 10037123, "user_type": "registered", "profile_image": "https://graph.facebook.com/2201094346836453/picture?type=large", "display_name": "dhofma", "link": "https://stackoverflow.com/users/10037123/dhofma"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531982162, "post_id": 51401092, "comment_id": 89802810, "body": "Thank you for your help, but im still getting the same error. The types of the objects still dont match, pmkr2 is of the type PDFMaker and a of the type Variant/Object/COMAddin"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10037123, "user_type": "registered", "profile_image": "https://graph.facebook.com/2201094346836453/picture?type=large", "display_name": "dhofma", "link": "https://stackoverflow.com/users/10037123/dhofma"}, "edited": false, "score": 0, "creation_date": 1532432027, "post_id": 51431844, "comment_id": 89962856, "body": "It still doesnt work! I wasnt able to test it untill today, but now i tested it and i got an runtime error 438 (Object doesn&#39;t support this property or method) at the line <code>pmkr2.GetCurrentConversionSettings stng</code>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 31, "user_id": 10037123, "user_type": "registered", "profile_image": "https://graph.facebook.com/2201094346836453/picture?type=large", "display_name": "dhofma", "link": "https://stackoverflow.com/users/10037123/dhofma"}, "edited": false, "score": 0, "creation_date": 1532454150, "post_id": 51431844, "comment_id": 89978206, "body": "The runtime-error 13 (type mismatch) is as far as I can go without that add-in. You could try a new question describing the current different problem."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1532093796, "last_edit_date": 1532093796, "creation_date": 1532034997, "answer_id": 51431844, "question_id": 51401092, "link": "https://stackoverflow.com/questions/51401092/use-pdfmaker-with-ms-outlook/51431844#51431844", "title": "Use PDFMaker with MS Outlook", "body": "<p>Try being less specific in the declaration.</p>\n\n<pre><code>Sub getAnObject()\n\n    Dim pmkr2 As Object\n    Dim a As Object\n    Dim srchString As String\n\n    srchString = \"PDFMAKER\"\n\n    Set pmkr2 = Nothing\n\n    For Each a In Application.COMAddIns\n\n        Debug.Print \"a.Description: \" &amp; a.Description\n\n        If InStr(UCase(a.Description), srchString) &gt; 0 Then\n\n            If MsgBox(\"Is this what you want? \" &amp; vbCr &amp; vbCr &amp; a.Description, vbYesNo + vbQuestion) = vbYes Then\n                Set pmkr2 = a\n                Exit For\n            End If\n\n        End If\n\n    Next\n\n    If pmkr2 Is Nothing Then\n        Debug.Print \"Cannot find the object using search string \" &amp; srchString\n    Else\n        Debug.Print \"Object found: \" &amp; pmkr2.Description\n    End If\n\n    Set pmkr2 = Nothing ' Discontinue association.\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10037123, "user_type": "registered", "profile_image": "https://graph.facebook.com/2201094346836453/picture?type=large", "display_name": "dhofma", "link": "https://stackoverflow.com/users/10037123/dhofma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1532093796, "creation_date": 1531913951, "question_id": 51401092, "link": "https://stackoverflow.com/questions/51401092/use-pdfmaker-with-ms-outlook", "title": "Use PDFMaker with MS Outlook", "body": "<p>i want to use the Adobe PDFMaker add-in with MS Outlook 2013.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44723984/saving-multiple-e-mails-to-pdf-with-pdfmaker/51400870#51400870\">Saving multiple e-mails to pdf with PDFMAKER</a></p>\n\n<p>I've seen this post and tried the code, but i get an runtime-error 13 (type mismatch) at the line</p>\n\n<pre><code>Set pmkr2 = a.Object\n</code></pre>\n\n<p>It seems like the object coming from a.Object is not an PDFMaker object. <a href=\"https://i.stack.imgur.com/Y5yXw.png\" rel=\"nofollow noreferrer\">See this picture</a>\nI am using Adobe Acrobat DC 18.2816.\nHere is my whole code:</p>\n\n<pre><code>    Sub ConvertToPDFWithLinks()\n   Dim pmkr2 As AdobePDFMakerForOffice.PDFMaker\n   'Set pmkr2 = Application.COMAddIns.Item(6).Object ' Assign object reference.\n   Set pmkr2 = Nothing\n\n   For Each a In Application.COMAddIns\n      If InStr(UCase(a.Description), \"PDFMAKER\") &gt; 0 Then\n        Set pmkr2 = a.Object\n        Exit For\n      End If\n   Next\n\n   If pmkr2 Is Nothing Then\n      MsgBox \"Cannot Find PDFMaker add-in\", vbOKOnly, \"\"\n      Exit Sub\n   End If\n\n   Dim pdfname As String\n   pdfname = \"C:\\stuff\\stuff\\tester.pdf\"\n\n   Dim stng As AdobePDFMakerForOffice.ISettings\n   pmkr2.GetCurrentConversionSettings stng\n\n   stng.AddBookmarks = True\n   stng.AddLinks = True\n   stng.AddTags = True\n   stng.ConvertAllPages = True\n   stng.CreateFootnoteLinks = True\n   stng.CreateXrefLinks = True\n   stng.OutputPDFFileName = pdfname\n   stng.PromptForPDFFilename = False\n   stng.ShouldShowProgressDialog = True\n   stng.ViewPDFFile = False\n\n   pmkr2.CreatePDFEx stng, 0\n\n   Set pmkr2 = Nothing ' Discontinue association.\nEnd Sub\n</code></pre>\n\n<p>It would be very nice if someone would be able to help me, thank you in advance!</p>\n"}, {"tags": ["vba", "vb.net", "com", "com-interop", "com-interface"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531914074, "post_id": 51400382, "comment_id": 89772788, "body": "Try to copy your dll and tlb files to <code>C:\\Windows\\SysWOW64</code> directory and in VBA editor add reference to tlb from this directory. Don&#39;t forget to check the checkbox in VBA references dialog."}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531988622, "post_id": 51400382, "comment_id": 89806448, "body": "Thank you, when I try to do that nothing happens, maybe because my library is already registered so nothing is added to the available references list in VBA editor, My library is there but it is not referring to C:\\Windows\\SysWOW64 maybe I should de-register my library first?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531991978, "post_id": 51400382, "comment_id": 89808516, "body": "Have you tried to scroll down and look for the name <code>ShwDolphin</code> in <code>References</code> dialog of VBA editor? Or do you see checkbox checked beside this name already? It is <i>two step</i> process inside of the referenecens dialog. Firs add, then select."}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531992842, "post_id": 51400382, "comment_id": 89809109, "body": "It is there without me adding it, Visual studio 2017 did that job, When I try to add it manually like you said, nothing new is added."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531993323, "post_id": 51400382, "comment_id": 89809457, "body": "I have no idea what is wrong on your computer. If the checkbox in references dialog is checked the component should be loaded and should write the result into output. I have tested it on my PC and it works."}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531993453, "post_id": 51400382, "comment_id": 89809551, "body": "Did you use the VB code exactly like above? without adding interface?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531993686, "post_id": 51400382, "comment_id": 89809732, "body": "Yes exactly your vb-code like above. Interface is not necessary, an default will be created, although it is good practice. It should work as it is, at least on my pc it works. When you get it working you should look at the tutorials and define your own interface."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531994097, "post_id": 51400382, "comment_id": 89810034, "body": "Try to add the tlb and dll to <code>C:\\Windows\\System32</code> as well, I not sure where the vba is looking for it. Select the <code>tlb</code> then and check the checkbox finally."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531994695, "post_id": 51400382, "comment_id": 89810471, "body": "I have edited your question and added the <code>com</code> tag. Maybe some <code>com</code> expert will see it and give you some advice."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1531995366, "post_id": 51400382, "comment_id": 89810930, "body": "@dee, you&#39;re wrong. To be able to use .net library within vba, you need to use interfaces!"}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531995780, "post_id": 51400382, "comment_id": 89811213, "body": "Thanks to both of you, Maybe I&#39;ll try on another machine."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1532027667, "post_id": 51400382, "comment_id": 89831490, "body": "Have a look <a href=\"https://richnewman.wordpress.com/2007/04/15/a-beginners-guide-to-calling-a-net-library-from-excel/\" rel=\"nofollow noreferrer\">here</a>, it might help. And of course check the bitness problem which is mentioned in answer of Joseph."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531988423, "post_id": 51400570, "comment_id": 89806355, "body": "Thank you for your answer, I think I was missing that point but unfortunately this did not fix my problem, still the same error message :("}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531988768, "post_id": 51400570, "comment_id": 89806528, "body": "It&#39;s impossible! Can you describe how you&#39;ve created your dll step by step? Seems, you&#39;re doing something wrong. Note: that you need to refer to *tlb file in VBA."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531990258, "post_id": 51400570, "comment_id": 89807427, "body": "Take a look here: <a href=\"http://www.geeksengine.com/article/create-dll.html\" rel=\"nofollow noreferrer\">How to: Create a DLL by CSharp or VB.Net for VBA</a>"}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531992499, "post_id": 51400570, "comment_id": 89808877, "body": "I followed every single step in that article and still the same error message. Maybe there is something wrong with my machine?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531994579, "post_id": 51400570, "comment_id": 89810394, "body": "What version of VS do you have?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531995659, "post_id": 51400570, "comment_id": 89811126, "body": "@SchwanAbdulkareem, close and re-open VS with admin privileges. Then try to compile you library again. Adn please, read this: <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/app-domains/how-to-install-an-assembly-into-the-gac\" rel=\"nofollow noreferrer\">How to: Install an Assembly into the Global Assembly Cache</a>. MSDN states: <code>Only strong-named assemblies can be installed into the GAC. For information about how to create a strong-named assembly</code>."}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531995851, "post_id": 51400570, "comment_id": 89811266, "body": "Visual Studio 2017."}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531996034, "post_id": 51400570, "comment_id": 89811386, "body": "I did that already and my class library is registered correctly. I also tried to use my library in another vb project and it worked correctly."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531996482, "post_id": 51400570, "comment_id": 89811687, "body": "@SchwanAbdulkareem, Did VS create <code>ShwDolphin.tlb</code> file?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531996653, "post_id": 51400570, "comment_id": 89811813, "body": "Did you add reference in VBA to this <code>tlb</code> file or to <code>dll</code>?"}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531996763, "post_id": 51400570, "comment_id": 89811900, "body": "The reference is added automatically to the list, I just checked the box."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1531996947, "post_id": 51400570, "comment_id": 89812023, "body": "Remove that reference from VBA project and add it again. Click <code>Tools-&gt;References..</code> then click <code>Browse</code> button and go to your <code>ShwDolphin</code> project folder. Find <code>Debug</code> folder and select <code>ShwDolphin.tlb</code> file and click <code>OK</code>. Save xlsm file, close it and re-open again."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1531913606, "last_edit_date": 1531913606, "creation_date": 1531912416, "answer_id": 51400570, "question_id": 51400382, "link": "https://stackoverflow.com/questions/51400382/not-able-to-use-my-simple-vb-class-library-in-vba/51400570#51400570", "title": "Not able to use my simple VB class library in VBA", "body": "<p>To be able to use custom .NET class in VBA, a *.dll must expose methods (and properties) to COM automation. What this means to you? You have to create an interface.</p>\n\n<pre><code>Public Interface IAddition\n    Function Add(No1 As Long, No2 As Long) As Long\nEnd Interface\n\nPublic Class Addition\n    Implements IAddition\n    Public Function Add(No1 As Long, No2 As Long) As Long Implements IAddition.Add\n        Return No1 + No2\n    End Function\nEnd Class\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>Private Sub Command0_Click()\nDim myCalc As ShwDolphin.IAddition\nSet myCalc = New ShwDolphin.Addition\nDim Num As Long\nNum = myCalc.Add(2, 5)\nDebug.Print Num\nEnd Sub\n</code></pre>\n\n<p>For further details, follow the instruction provided in my past answer: <a href=\"https://stackoverflow.com/questions/29563448/generics-and-com-visible-net-libraries/29565409#29565409\">Generics and Com Visible .NET libraries</a></p>\n\n<p>You might be interested in this article too: <a href=\"https://www.codeproject.com/Articles/555660/Extend-your-VBA-code-with-Csharp-VB-NET-or-Cpluspl\" rel=\"nofollow noreferrer\">Extend your VBA code with C#, VB.NET, or C++/CLI</a></p>\n\n<p>Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "reply_to_user": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1532092770, "post_id": 51424917, "comment_id": 89856798, "body": "If an answer works, it is customary to mark it as Answered."}, {"owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "edited": false, "score": 0, "creation_date": 1532097136, "post_id": 51424917, "comment_id": 89859742, "body": "Thank you, I was not aware of that."}], "tags": [], "owner": {"reputation": 5085, "user_id": 1181353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zqKlZ.jpg?s=128&g=1", "display_name": "Joseph Willcoxson", "link": "https://stackoverflow.com/users/1181353/joseph-willcoxson"}, "is_accepted": true, "score": 2, "last_activity_date": 1532009590, "creation_date": 1532009590, "answer_id": 51424917, "question_id": 51400382, "link": "https://stackoverflow.com/questions/51400382/not-able-to-use-my-simple-vb-class-library-in-vba/51424917#51424917", "title": "Not able to use my simple VB class library in VBA", "body": "<p>Reading the comments, my guess is that you have a difference in what I call \"bitness\". Default projects in Visual Studio are generally 32-bits. If you build a 32-bit COM DLL, it can only be loaded by 32-bit processes.  If your Office installation is 64-bit, it will never work.  What you will need to do is build/register it for 64-bits.</p>\n\n<p>Now, if you build for MSIL and not any specific processor (x86 or x64), you don't have to really rebuild for 64-bits. All that is necessary is to register for 64-bits. (The default build configuration is MSIL.)</p>\n\n<p>So you need to use the 64-bit regasm in C:\\windows\\Microsoft.NET\\Framework64\\v4.0.30319\\regasm.exe</p>\n\n<p>use that regasm with options of /tlb /codebase \"thenameofyour.dll\"</p>\n\n<p>If you built x64 and Office is 32-bit, then do the opposite: use the 32-bit regasm, but odds are that you are using defaults which is 32-bit.</p>\n\n<p>You can also look at this answer:<a href=\"https://stackoverflow.com/questions/27691710/activex-cant-create-object-by-vbs-but-can-by-classic-asp/27713698#27713698\">activex can&#39;t create object by vbs but can by classic asp</a></p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "is_accepted": false, "score": 1, "last_activity_date": 1532080541, "creation_date": 1532080541, "answer_id": 51439942, "question_id": 51400382, "link": "https://stackoverflow.com/questions/51400382/not-able-to-use-my-simple-vb-class-library-in-vba/51439942#51439942", "title": "Not able to use my simple VB class library in VBA", "body": "<p>So after much frustration, I was able to make it work by doing the following:</p>\n\n<p>1- Make a new project with the same code (It was easier than removing previous dlls).</p>\n\n<p>2- Disable \"Register for COM interop\" option in project properties of Visual Studio.</p>\n\n<p>3- Build project.</p>\n\n<p>4- Use use the 64-bit regasm in C:\\windows\\Microsoft.NET\\Framework64\\v4.0.30319\\regasm.exe to register my assembly.</p>\n\n<p>5- Add reference to the generated tlb file in the VBA editor.</p>\n\n<p>Thanks to everyone for your generous help, thanks to this community.\nI don't know why I had to do this way, but I'm using 64-bit windows and 64-bit office.\nAlso like @dee said adding interface was not necessary, it just worked.</p>\n"}], "owner": {"reputation": 83, "user_id": 10099116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQ1raW7Cc6U/AAAAAAAAAAI/AAAAAAAAArk/2f_o1hOPeJc/photo.jpg?sz=128", "display_name": "Schwan Abdulkareem", "link": "https://stackoverflow.com/users/10099116/schwan-abdulkareem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 2, "accepted_answer_id": 51424917, "answer_count": 3, "score": 3, "last_activity_date": 1532080541, "creation_date": 1531911800, "last_edit_date": 1531994629, "question_id": 51400382, "link": "https://stackoverflow.com/questions/51400382/not-able-to-use-my-simple-vb-class-library-in-vba", "title": "Not able to use my simple VB class library in VBA", "body": "<p>So this is my first post in this great community and I'm an absolute beginner, I'm sure I'll get good advice from here.</p>\n\n<p>I mad this simple VB class library in Visual Studio 2017</p>\n\n<pre><code>Public Class Addition\n    Public Function Add(No1 As Long, No2 As Long) As Long\n        Return No1 + No2\n    End Function\nEnd Class\n</code></pre>\n\n<p>I made it COM visible and checked Register for COM interop. and build the project.</p>\n\n<p>In my access VBA project, I've added the reference to my Dll without a problem and put the following code behind the click event of a button.</p>\n\n<pre><code>Private Sub Command0_Click()\nDim myCalc As ShwDolphin.Addition\nSet myCalc = New ShwDolphin.Addition\nDim Num As Long\nNum = myCalc.Add(2, 5)\nDebug.Print Num\nEnd Sub\n</code></pre>\n\n<p>\"ShwDolphin\" is VB assembly name.</p>\n\n<p>But I always get this error message\n\"Runtime error 429 Active X component can't create an object\"</p>\n\n<p>Can you please tell me what I'm doing wrong here?\nThis is driving me crazy.</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["vba", "image", "excel", "image-scaling"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 3, "creation_date": 1531914801, "post_id": 51400088, "comment_id": 89773331, "body": "Can you provide links to set of images with different rotation?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1531915383, "post_id": 51400088, "comment_id": 89773753, "body": "Check this: <a href=\"https://www.mrexcel.com/forum/excel-questions/596910-rotate-object-vba.html\" rel=\"nofollow noreferrer\">Rotate Shape Object in VBA</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1532305186, "post_id": 51400088, "comment_id": 89908786, "body": "@martin <a href=\"https://stackoverflow.com/a/50634741/445425\">Is this in any way related?</a>  Note: as  Maciej commented, it would be nice if you added some sample pic&#39;s"}], "answers": [{"comments": [{"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1533032097, "post_id": 51480383, "comment_id": 90186475, "body": "+ When adding picture in Excel, rotation from EXIF is already used in Excel, so you can act accordingly"}, {"owner": {"reputation": 1332, "user_id": 1675724, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/pDYqk.jpg?s=128&g=1", "display_name": "Brethlosze", "link": "https://stackoverflow.com/users/1675724/brethlosze"}, "edited": false, "score": 0, "creation_date": 1538778114, "post_id": 51480383, "comment_id": 92277500, "body": "In Excel 2013, when <code>.Rotation</code> is not available, check for <code>.ShapeRange.Rotation</code>"}, {"owner": {"reputation": 1332, "user_id": 1675724, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/pDYqk.jpg?s=128&g=1", "display_name": "Brethlosze", "link": "https://stackoverflow.com/users/1675724/brethlosze"}, "edited": false, "score": 0, "creation_date": 1538779972, "post_id": 51480383, "comment_id": 92277908, "body": "Nevertheless i still have a problem. For reproducing it, just choose a Top Left cell in the <code>B</code> column. When doing the correction <code>(W-H)&#47;2</code>, the &quot;Phantom&quot; rotated margin blocks the picture, and a proper left displacement is not possible. Is there a way to fix this? By removing the EXIF rotation (i.e. <a href=\"https://superuser.com/questions/57317/editing-jpeg-exif-properties\">FastStone Viewer</a> ), the issue is circumvented"}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 3, "last_activity_date": 1532353660, "creation_date": 1532353660, "answer_id": 51480383, "question_id": 51400088, "link": "https://stackoverflow.com/questions/51400088/excel-vba-image-exif-orientation/51480383#51480383", "title": "Excel VBA Image EXIF Orientation", "body": "<p>You have to check the rotation to see if you have to adjust height or Width (Top or Left)</p>\n\n<p>Adjust your loop as follows:</p>\n\n<pre><code>For Each oCell In oRange\n        If Dir(sloct &amp; oCell.Text) &lt;&gt; \"\" And oCell.Value &lt;&gt; \"\" Then\n          Set oPicture = osheet.Shapes.AddPicture(Filename:=sloct &amp; oCell, LinktoFile:=msoFalse, savewithdocument:=msoTrue, Left:=oCell.Left + 10, Top:=oCell.Top + 10, Width:=-1, Height:=-1)\n\n          With oPicture\n                .LockAspectRatio = True\n            If .Rotation = 0 Or .Rotation = 180 Then\n                .Height = 200\n                 oCell.RowHeight = .Height + 20\n                 oCell.ColumnWidth = .Width / 4\n                .Top = oCell.Top\n                .Left = oCell.Left\n            Else\n                .Width = 200\n                oCell.RowHeight = .Width + 20\n                oCell.ColumnWidth = .Height / 4\n                .Top = oCell.Top + ((.Width - .Height) / 2)\n                .Left = oCell.Left - ((.Width - .Height) / 2)\n            End If\n\n           End With\n        Else\n            oCell.Offset(0, 1).Value = \"\"\n        End If\n        Next oCell\n</code></pre>\n"}], "owner": {"reputation": 1067, "user_id": 6906943, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YB1cQmsqIoo/AAAAAAAAAAI/AAAAAAAABWU/3KUADXQN6P0/photo.jpg?sz=128", "display_name": "Martin Sing", "link": "https://stackoverflow.com/users/6906943/martin-sing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1749, "favorite_count": 3, "accepted_answer_id": 51480383, "answer_count": 1, "score": 13, "last_activity_date": 1532353660, "creation_date": 1531910946, "last_edit_date": 1531971890, "question_id": 51400088, "link": "https://stackoverflow.com/questions/51400088/excel-vba-image-exif-orientation", "title": "Excel VBA Image EXIF Orientation", "body": "<p>Made this macro that inserts images from the active directory into an excel spreadsheet and scales it down to fit in the cell. It works pretty well except for images that come from a source were their orientation/rotation is defined in the EXIF data. So in: </p>\n\n<ul>\n<li>In Windows Explorer - Not rotated </li>\n<li>Window Picture viewer - Not rotated</li>\n<li>IE - Not Rotated</li>\n<li>Chrome - Rotated</li>\n<li>EXCEL - Rotated</li>\n</ul>\n\n<p>It's all due to <a href=\"https://www.howtogeek.com/254830/why-your-photos-dont-always-appear-correctly-rotated/\" rel=\"noreferrer\">some legacy issue</a> from the camera that the image was taken from. Somebody post a <a href=\"https://stackoverflow.com/questions/46650664/how-can-i-read-jpeg-exif-orientation-tags-in-a-ms-word-macro?noredirect=1&amp;lq=1\">similar problem</a> but it got labelled as a duplicate, incorrectly, and has been ignored since. I did find this <a href=\"https://forum.oberonplace.com/showthread.php?t=8076\" rel=\"noreferrer\">obscure post</a> were somebody linked an exif reader class, I tested it and it gave me the same <code>Orientation</code> value for all my images. </p>\n\n<p><strong>The Problems</strong>: the photo gets rotated properly (YAY!), but its <strong>position</strong> is 35-80 columns to the right (Boo!) and/or 200 rows down, and the scaling is off because it mixes the width and height fields (Boo! x2).</p>\n\n<p>Here's my Code:</p>\n\n<pre><code>For Each oCell In oRange\n        If Dir(sLocT &amp; oCell.Text) &lt;&gt; \"\" And oCell.Value &lt;&gt; \"\" Then\n        'Width and Height set to -1 to preserve original dimensions.\n            Set oPicture = oSheet.Shapes.AddPicture(Filename:=sLocT &amp; oCell, LinktoFile:=msoFalse, savewithdocument:=msoTrue, Left:=oCell.Left + 10, Top:=oCell.Top + 10, Width:=-1, Height:=-1)\n\n            oPicture.LockAspectRatio = True\n\n        'Scales it down  \n            oPicture.Height = 200\n        'Adds a nice margin in the cell, useless             \n            oCell.RowHeight = oPicture.Height + 20\n            oCell.ColumnWidth = oPicture.Width / 4\n        Else\n\n            oCell.Offset(0, 1).Value = \"\"\n        End If\n        Next oCell\n</code></pre>\n\n<p>Image dimensions can be variable from unknown sources (but I'm pretty sure we can blame Samsung on this one). Looking for a solution and/or an explanation without the need of a 3rd party application.</p>\n\n<p>Here's a <a href=\"https://drive.google.com/file/d/1k2LeTxvpmCqT4rMGB0jWGX3YChdcDrqE/view?usp=sharing\" rel=\"noreferrer\">sample of the images</a> to try out, the first image works properly, the others don't. </p>\n"}, {"tags": ["vba", "excel", "select-case"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1531911659, "post_id": 51400028, "comment_id": 89771277, "body": "You have a stray <code>Else</code> at the bottom of your code. That is basically a typo which answers the question in your title. You seem to have an unrelated question as well, but please don&#39;t try to ask multiple questions at once."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "edited": false, "score": 0, "creation_date": 1531924124, "post_id": 51401569, "comment_id": 89780028, "body": "Oh, thats slick creating a variable for &quot;thisCurrency&quot;...thanks.  I&#39;ll give that a go when I get into the office tomorrow!"}, {"owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "edited": false, "score": 0, "creation_date": 1531962710, "post_id": 51401569, "comment_id": 89797526, "body": "That does not seem to have worked.....still getting the same error regarding the index function."}, {"owner": {"reputation": 26, "user_id": 10035951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SlX8uvlBaiQ/AAAAAAAAAAI/AAAAAAAACUU/ZMHi4bUhHHc/photo.jpg?sz=128", "display_name": "Martin Morse", "link": "https://stackoverflow.com/users/10035951/martin-morse"}, "reply_to_user": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "edited": false, "score": 0, "creation_date": 1531988190, "post_id": 51401569, "comment_id": 89806244, "body": "It may be breaking if the PL number listed in column F is not one in the range called AR_PL_Nums. In that instance, the <code>Match</code> function will return an error and therefore cause the <code>index</code> function to fail. You should either check that all PL numbers in column F can be found in AR_PL_Nums, or simply ignore. A simple solution to this would be to add <code>On Error Resume Next</code> just above the <code>For y...</code> line, and <code>On Error Goto 0</code> on the line after <code>Next y</code>."}], "tags": [], "owner": {"reputation": 26, "user_id": 10035951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SlX8uvlBaiQ/AAAAAAAAAAI/AAAAAAAACUU/ZMHi4bUhHHc/photo.jpg?sz=128", "display_name": "Martin Morse", "link": "https://stackoverflow.com/users/10035951/martin-morse"}, "is_accepted": false, "score": 1, "last_activity_date": 1531936947, "last_edit_date": 1531936947, "creation_date": 1531915425, "answer_id": 51401569, "question_id": 51400028, "link": "https://stackoverflow.com/questions/51400028/how-can-i-loop-this-index-match/51401569#51401569", "title": "How can I loop this index match?", "body": "<p>Create a range holding the currency and format,such as </p>\n\n<p><a href=\"https://i.stack.imgur.com/afc5a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/afc5a.png\" alt=\"Table of currencies\"></a></p>\n\n<p>And name the range \"currencies\". Then change the Select Case section of your macro to...</p>\n\n<pre><code>For y = 5 To lastrow\n    Set thisCurrency = Range(Application.WorksheetFunction.Index(Rng1, Application.WorksheetFunction.Match(Range(\"F\" &amp; y), Rng2, 0)))\n    Samwks.Range(\"AB\" &amp; y).NumberFormat = Application.WorksheetFunction.VLookup(thisCurrency, Range(\"currencies\"), 2, False)\nNext y\n</code></pre>\n\n<p>This has the advantage that you can add new currencies or change formats without making any changes in the macro.</p>\n"}], "owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531962672, "creation_date": 1531910755, "last_edit_date": 1531962672, "question_id": 51400028, "link": "https://stackoverflow.com/questions/51400028/how-can-i-loop-this-index-match", "title": "How can I loop this index match?", "body": "<p>Ok, so I have this macro here that is filling cells with an index match function in columns AB and AC.  (this part is fine)</p>\n\n<p>Then it is meant to format those values in column AC into their correct currencies based on the information in a range called AR_Curr in another workbook by matching them to the PL numbers for those shipments (this part is not working and just generates either \"Run-time error '1004': Unable to get the Index property of the WorksheetFunction class\" or \"Run-time error '1004': Unable to get the Match property of the WorksheetFunction class\" whenever I try to run it.</p>\n\n<p>Finally it copys all the values now populating the cells and pastes them in as values and centers them.</p>\n\n<p>Could someone please tell me how I can make this select case function work dynamically by searching for an index match to determine the associated currency?  I'm at my wits end here.</p>\n\n<pre><code>Sub Payment_YN_Call()\n'\n' Payment_YN_Call Macro\n'\nDim answer1 As Integer\nDim answer2 As Integer\nDim answer3 As Integer\n\nanswer1 = MsgBox(\"Did you update the named ranges for INV_Nums on this sheet?\", vbYesNo + vbQuestion, \"Payment Update\")\nIf answer1 = vbYes Then\n    answer2 = MsgBox(\"Do you have the AR Balance sheet open?\", vbYesNo + vbQuestion, \"Payment Update\")\n    If answer2 = vbYes Then\n        answer3 = MsgBox(\"Did you update the AR_PL_Nums, AR_Paid, and AR_Unpaid Ranges on the AR Balance Sheet?\", vbYesNo + vbQuestion, \"Payment Update\")\n        If answer3 = vbYes Then\n\n                Dim i As Integer\n                Dim Rng1 As Range\n                Dim Rng2 As Range\n                Dim ARwkb As Excel.Workbook\n                Dim ARwks As Excel.Worksheet\n                Dim Samwkb As Excel.Workbook\n                Dim Samwks As Excel.Worksheet\n\n                Set Samwkb = Excel.Workbooks(\"Samples - one sheet\")\n                Set Samwks = Samwkb.Worksheets(\"samples shipment\")\n                Set ARwkb = Excel.Workbooks(\"AR balance.xlsx\")\n                Set ARwks = ARwkb.Worksheets(\"Total Trading\")\n\n                For i = 6 To Range(\"INV_Nums\").Count + 5\n\n                    If IsEmpty(Range(\"AB\" &amp; i)) Then\n                        Range(\"AB\" &amp; i).Select\n                            ActiveCell.FormulaR1C1 = _\n                                \"=IFERROR(IF(INDEX('[AR balance.xlsx]Total trading'!AR_Unpaid,MATCH(RC[-2],'AR balance.xlsx'!AR_Invoice_Nums,0))=0,\"\"PAID\"\",\"\"UNPAID\"\"),\"\"\"\")\"\n                    End If\n\n                If IsEmpty(Range(\"AC\" &amp; i)) Then\n                    Range(\"AC\" &amp; i).Select\n                        ActiveCell.FormulaR1C1 = _\n                            \"=IFERROR(IF(RC[-1]=\"\"PAID\"\",INDEX('AR balance.xlsx'!AR_Paid,MATCH(RC[-3],'AR balance.xlsx'!AR_Invoice_Nums)),\"\"\"\"),\"\"\"\")\"\n                End If\n\n                Next i\n\n\n                Set Rng1 = ARwks.Range(\"AR_Curr\")\n                Set Rng2 = ARwks.Range(\"AR_PL_Nums\")\n                Dim lastrow As Long, x As Long\n                lastrow = Range(\"INV_Nums\").Count + 5\n                    For y = 5 To lastrow\n                        Select Case Range(Application.WorksheetFunction.Index(Rng1, Application.WorksheetFunction.Match(Range(\"F\" &amp; y), Rng2, 0)))\n\n                            Case \"USD\"\n                                Samwks.Range(\"AB\" &amp; y).NumberFormat = \"$#,##0.00_);($#,##0.00)\"\n                            Case \"RMB\"\n                                Samwks.Range(\"AB\" &amp; y).NumberFormat = \"[$\u00a5-zh-CN]#,##0.00;[$\u00a5-zh-CN]-#,##0.00\"\n                            Case \"EUR\"\n                                Samwks.Range(\"AB\" &amp; y).NumberFormat = \"[$\u20ac-x-euro2] #,##0.00_);([$\u20ac-x-euro2] #,##0.00)\"\n                            Case \"GBP\"\n                                Samwks.Range(\"AB\" &amp; y).NumberFormat = \"[$\u00a3-en-GB]#,##0.00;-[$\u00a3-en-GB]#,##0.00\"\n                            Case \"HKD\"\n                                Samwks.Range(\"AB\" &amp; y).NumberFormat = \"[$HK$-zh-HK]#,##0.00_);([$HK$-zh-HK]#,##0.00)\"\n                            Case \"JPY\"\n                                Samwks.Range(\"AB\" &amp; y).NumberFormat = \"[$\u00a5-ja-JP]#,##0.00;-[$\u00a5-ja-JP]#,##0.00\"\n                        End Select\n                    Next y\n\n\n\n                Columns(\"AB:AC\").Select\n                    Selection.Copy\n                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                        :=False, Transpose:=False\n\n                Columns(\"AB:AC\").Select\n                    Application.CutCopyMode = False\n                    With Selection\n                        .HorizontalAlignment = xlCenter\n                        .VerticalAlignment = xlCenter\n                        .Orientation = 0\n                        .AddIndent = False\n                        .IndentLevel = 0\n                        .ShrinkToFit = False\n                        .ReadingOrder = xlContext\n                    End With\n\n\n\nElse\nEnd If\nEnd If\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 0, "last_activity_date": 1531910058, "creation_date": 1531910058, "answer_id": 51399808, "question_id": 51399740, "link": "https://stackoverflow.com/questions/51399740/vlookup-vba-automatisation/51399808#51399808", "title": "Vlookup vba automatisation", "body": "<p>Change your top row formula to <code>=VLOOKUP(A2;sheet2!$A$2:$G$712;4)</code>, select the cell you enetered the formula into, and then drag the formula down by using the little square in the bottom right hand corner of the cell you entered the formula into.</p>\n"}, {"tags": [], "owner": {"reputation": 72, "user_id": 10069235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4c7d0a28ae42ba96868165fccead0e?s=128&d=identicon&r=PG", "display_name": "pawrick", "link": "https://stackoverflow.com/users/10069235/pawrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1531910822, "creation_date": 1531910822, "answer_id": 51400051, "question_id": 51399740, "link": "https://stackoverflow.com/questions/51399740/vlookup-vba-automatisation/51400051#51400051", "title": "Vlookup vba automatisation", "body": "<p>If you want to do it entirely in VBA, you can autofill using</p>\n\n<pre><code>Dim source As Range(\"A1\")\nDim destination As Range(\"A1:A10\")\nsource.AutoFill Destination:=destination\n</code></pre>\n\n<p>This will autofill from A1 to A10, as an example. You can also specify the autofill type with Type:</p>\n\n<pre><code>Dim source As Range(\"A1\")\nDim destination As Range(\"A1:A10\")\nsource.AutoFill Destination:=destination Type:=xlFillLinearTrend\n</code></pre>\n\n<p>The default type is <code>xlFillDefault</code>, which tries to find a pattern automatically and use the according fill type. Other types can be looked up <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlautofilltype-enumeration-excel\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 7, "user_id": 10098879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea80e8a3cf2390449258a43d37adcb9?s=128&d=identicon&r=PG&f=1", "display_name": "iliassTr", "link": "https://stackoverflow.com/users/10098879/iliasstr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1531913686, "creation_date": 1531909887, "last_edit_date": 1531913686, "question_id": 51399740, "link": "https://stackoverflow.com/questions/51399740/vlookup-vba-automatisation", "title": "Vlookup vba automatisation", "body": "<p>I'm a beginner in VBA programmation, I want to create a button to help me search the price of a product from <code>column A</code> of <code>sheet1</code> and to search for the price of that product from <code>sheet2</code>, <code>column D</code> of the same workbook.</p>\n\n<p>The <code>vlookup</code> formula I use is:</p>\n\n<pre><code>=VLOOKUP(A2;sheet2!A2:G712;4)\n</code></pre>\n\n<p>My issue is that I have more than 100000 products and I want to use a button to simplify the process.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 134, "user_id": 1565951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J67yv.jpg?s=128&g=1", "display_name": "Antonio Rodulfo", "link": "https://stackoverflow.com/users/1565951/antonio-rodulfo"}, "edited": false, "score": 0, "creation_date": 1531912110, "post_id": 51399661, "comment_id": 89771536, "body": "Is it possible to have a dataset valid for this code?"}], "answers": [{"tags": [], "owner": {"reputation": 404, "user_id": 6445909, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ed5578df506ea24f73c59e8fc7fca753?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Welsch", "link": "https://stackoverflow.com/users/6445909/christian-welsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1531912300, "creation_date": 1531912300, "answer_id": 51400519, "question_id": 51399661, "link": "https://stackoverflow.com/questions/51399661/loop-process-for-each-cell-in-column/51400519#51400519", "title": "Loop Process for each cell in Column", "body": "<p>You can use <code>For ... Next</code> to loop through each cell in column Y. For example this loops through Cells Y1 to Y100:</p>\n\n<pre><code>'[...]\n\nDim i as Long\nDim first_row As Long\nDim last_row As Long\n\nfirst_row = 1\nlast_row = 100\n\nFor i = first_row To last_row\n  e_name = Range(\"A\" &amp; i)\n  LValue = \"Your\" &amp; e_name\n  Segment = Application.WorksheetFunction.VLookup(LValue, Sheets(\"Temp\").Range(\"C:N\"), 12, True)\n  Range(\"Y\" &amp; i).Value = Segment\nNext i\n\n'[...]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10098888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V-4EuPrV7zo/AAAAAAAAAAI/AAAAAAAAACQ/u1CDo_pShso/photo.jpg?sz=128", "display_name": "Radu Patranoiu", "link": "https://stackoverflow.com/users/10098888/radu-patranoiu"}, "edited": false, "score": 0, "creation_date": 1531913152, "post_id": 51400608, "comment_id": 89772188, "body": "Thank you for looking over the code. The error i get is due to the fact that &quot;Temp&quot; does not exist as in my code, the page is created after in sheet Raw Data i filter by Cell C3 and paste the details filtered. in this page the vlookup is performed and after the result is displayed that page is deleted."}, {"owner": {"reputation": 1, "user_id": 10098888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V-4EuPrV7zo/AAAAAAAAAAI/AAAAAAAAACQ/u1CDo_pShso/photo.jpg?sz=128", "display_name": "Radu Patranoiu", "link": "https://stackoverflow.com/users/10098888/radu-patranoiu"}, "edited": false, "score": 0, "creation_date": 1531915939, "post_id": 51400608, "comment_id": 89774158, "body": "Basically, I need to repeat each time the filtering based on inputs on Col C as well.  The cycle is that one page is filtered based on Col C, then information is pasted into a new sheet. The vlookup is performed in the new sheet and after we have the result, the new sheet is deleted. After this cycle, i want to go down with the next row, repeating the entire process of filtering and vlookuping."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1531913211, "last_edit_date": 1531913211, "creation_date": 1531912511, "answer_id": 51400608, "question_id": 51399661, "link": "https://stackoverflow.com/questions/51399661/loop-process-for-each-cell-in-column/51400608#51400608", "title": "Loop Process for each cell in Column", "body": "<p>This will do it. It will keep moving from A3 down until there is no more data and write to the same row but on column Y.</p>\n\n<p>Paste the below into the bottom, replacing everything after the <code>ActiveSheet.Paste</code>:</p>\n\n<pre><code>Dim e_name As String\nDim LValue As String\nDim c As Range\n\nWith Sheets(\"Exception Data\")\n\n    For Each c In .Range(\"A3\", \"A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n        e_name = c.Value\n        LValue = \"Your\" &amp; e_name\n        Segment = Application.WorksheetFunction.VLookup(LValue, Sheets(\"Temp\").Range(\"C:N\"), 12, True)\n        c.Offset(0, 24).Value = Segment ' write to column A, offset by 24 to the right - column Y\n    Next\n\nEnd With\n\nApplication.DisplayAlerts = False\nSheets(\"Temp\").Delete\nApplication.DisplayAlerts = False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10098888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V-4EuPrV7zo/AAAAAAAAAAI/AAAAAAAAACQ/u1CDo_pShso/photo.jpg?sz=128", "display_name": "Radu Patranoiu", "link": "https://stackoverflow.com/users/10098888/radu-patranoiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531913211, "creation_date": 1531909665, "question_id": 51399661, "link": "https://stackoverflow.com/questions/51399661/loop-process-for-each-cell-in-column", "title": "Loop Process for each cell in Column", "body": "<p>i have created the below code which is performing some tasks of filtering and then valookup based on a concatenated key.\nCould you please help me to loop the code for each cell on Col Y?\nThe code work on Cell Y3.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sheets(\"CAT Raw Data\").Activate\nRows(\"1:1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$Y$9633\").AutoFilter Field:=6, Criteria1:=Sheets(\"Exception Data\").Range(\"C3\")\n\n  Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n Dim Data2 As Worksheet\n    With ThisWorkbook\n        Set Data = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        Data.Name = \"Temp\"\n    End With\n\nActiveSheet.Paste\n\n\nSheets(\"Exception Data\").Activate\nDim e_name As String\nDim LValue As String\n\n\ne_name = Range(\"A3\")\nLValue = \"Your\" &amp; e_name\n\n\nSegment = Application.WorksheetFunction.VLookup(LValue, Sheets(\"Temp\").Range(\"C:N\"), 12, True)\n\nRange(\"y3\").Value = Segment\nApplication.DisplayAlerts = False\nSheets(\"Temp\").Delete\nApplication.DisplayAlerts = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 72, "user_id": 10069235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4c7d0a28ae42ba96868165fccead0e?s=128&d=identicon&r=PG", "display_name": "pawrick", "link": "https://stackoverflow.com/users/10069235/pawrick"}, "edited": false, "score": 0, "creation_date": 1531909411, "post_id": 51399305, "comment_id": 89769909, "body": "If you want to get the value from &quot;C6&quot; from the sheet &quot;Control&quot; you&#39;d just write <code>month = Sheets(&quot;Control&quot;).Range(&quot;C6&quot;).Value</code>. The syntax for your renaming is correct, but you&#39;d only change the name of the sheet called &quot;month&quot; and that&#39;s it. Is that what you want? Also, for the automated updating I recommend using events."}, {"owner": {"reputation": 271, "user_id": 9569786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MTT", "link": "https://stackoverflow.com/users/9569786/mtt"}, "reply_to_user": {"reputation": 72, "user_id": 10069235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4c7d0a28ae42ba96868165fccead0e?s=128&d=identicon&r=PG", "display_name": "pawrick", "link": "https://stackoverflow.com/users/10069235/pawrick"}, "edited": false, "score": 0, "creation_date": 1531910474, "post_id": 51399305, "comment_id": 89770561, "body": "Thanks @pawrick Yes, that is what I want. And I want this name to change when the user clicks on the &quot;Refresh&quot; button from the Control tab, which event should I use?"}, {"owner": {"reputation": 72, "user_id": 10069235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4c7d0a28ae42ba96868165fccead0e?s=128&d=identicon&r=PG", "display_name": "pawrick", "link": "https://stackoverflow.com/users/10069235/pawrick"}, "edited": false, "score": 0, "creation_date": 1531911290, "post_id": 51399305, "comment_id": 89771035, "body": "Which button exactly do you mean by refresh button? If you mean the calculate button then it&#39;s just the <code>Calculate</code> event from the according worksheet. Or you could just make your own button if you want the user to press a button anyways."}, {"owner": {"reputation": 292, "user_id": 7501821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7044faa0544b9c43911120ff60600d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Souza", "link": "https://stackoverflow.com/users/7501821/daniel-souza"}, "reply_to_user": {"reputation": 72, "user_id": 10069235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4c7d0a28ae42ba96868165fccead0e?s=128&d=identicon&r=PG", "display_name": "pawrick", "link": "https://stackoverflow.com/users/10069235/pawrick"}, "edited": false, "score": 0, "creation_date": 1531915345, "post_id": 51399305, "comment_id": 89773722, "body": "@pawrick maybe he has some external data to refresh with the month as a part of it. If it&#39;s the case, it&#39;s worksheet change event"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1531916844, "post_id": 51401961, "comment_id": 89774722, "body": "Dammit, beat me to it.  I&#39;d add you can change the worksheets codename in the sheets properties where you have a <code>(Name)</code> property for the codename and a <code>Name</code> property for the tab name."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1531918675, "post_id": 51401961, "comment_id": 89775952, "body": "@DarrenBartrup-Cook ...and I&#39;m not sure but I <i>think</i> the <code>CodeName</code> always starts with <code>Sheet</code> - but i&#39;m not sure if that includes all cases like imported/created/merged worksheets...?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1531919721, "post_id": 51401961, "comment_id": 89776705, "body": "When you create a new sheet the code name is always <code>Sheetx</code> where the <i>x</i> is the sheet number.  You can change this in the <i>Properties</i> window (F4 to open) to anything you like (within naming convention rules).  I&#39;d expect an imported sheet to have the same codename it was in the source workbook - no doubt there&#39;s something in there to handle naming conflicts when importing."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 3, "last_activity_date": 1531918556, "last_edit_date": 1531918556, "creation_date": 1531916648, "answer_id": 51401961, "question_id": 51399305, "link": "https://stackoverflow.com/questions/51399305/variable-name-of-a-worksheet/51401961#51401961", "title": "Variable name of a worksheet", "body": "<p>It sounds like you want to be able to always refer to the same worksheet, regardless of the worksheet's name changing (as shown on the worksheet's tab) .</p>\n\n<p>This is where the worksheets' <strong><code>CODENAME</code> Property</strong> comes in handy.</p>\n\n<p>Let's say you have an object variable declare for your worksheet like <code>Dim ws As Worksheet</code>.  You can refer to a worksheet three basic ways. </p>\n\n<hr>\n\n<blockquote>\n  <h2>...by <code>Name</code> :</h2>\n  \n  <blockquote>\n    <p><strong>Set object variable:</strong></p>\n\n<pre><code>Set ws = Sheets(\"Sheet1\")\n</code></pre>\n  </blockquote>\n  \n  <p>The worksheet name is the only worksheet identifier that can be changed to whatever you want, which (as you're probably aware) is done like:  </p>\n\n<pre><code>ws.Name = \"NewSheetname\"  \n</code></pre>\n  \n  <p>...or alternatively, like:  </p>\n\n<pre><code>Sheets(\"Sheet1\").Name = \"NewSheetName\"  \n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <h2>...by <code>Index</code> Number :</h2>\n  \n  <p>The index number identifies <em>the position of the worksheet's \"tab\"</em>, compared to the others (and cannot be changed without changing the order of the worksheets)  </p>\n  \n  <blockquote>\n    <p><strong>Set object variable:</strong>  </p>\n\n<pre><code>Set ws = Sheets(1)  \n</code></pre>\n  </blockquote>\n  \n  <p>...then you could (still) change the worksheets name like:</p>\n\n<pre><code>ws.Name = \"NewSheetname\"  \n</code></pre>\n  \n  <p>...or you could change the name by referring to the worksheet index number like:  </p>\n\n<pre><code>Sheets(1).Name = \"NewSheetName\"\n</code></pre>\n  \n  <p><strong>NOTE:</strong> If the worksheet is moved (or another worksheet is inserted before it), <strong>the Index number will change!</strong>  Therefore, it's usually not the preferred method of referring to a worksheet. </p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <h2>...by <code>CodeName</code> :</h2>\n  \n  <p>The CodeName is how Excel refers to the worksheets internally.  It is the original name that Excel gave the worksheet, and it does not change since it is a read-only property.</p>\n  \n  <blockquote>\n    <p><strong>Set object variable:</strong>  </p>\n\n<pre><code>Set ws = Sheet1  \n</code></pre>\n  </blockquote>\n  \n  <p>...then you could (still) change the worksheets name like:</p>\n\n<pre><code>ws.Name = \"NewSheetname\"  \n</code></pre>\n  \n  <p>...or you could change the name by referring to the worksheet codename like:  </p>\n\n<pre><code>Sheet1.Name = \"NewSheetName\"\n</code></pre>\n  \n  <p>You can check a worksheets' <strong><code>CodeName</code></strong> property like:</p>\n\n<pre><code>MsgBox Sheets(\"YourSheetName\").CodeName\n</code></pre>\n  \n  <p>...or, if <code>ws</code> is already referencing the worksheet:</p>\n\n<pre><code>MsgBox ws.CodeName\n</code></pre>\n</blockquote>\n\n<p>So, in your case, you could change the name of your worksheet as often as you like, with:</p>\n\n<pre><code>Sheet2.Name = \"NewNameHere\"\n</code></pre>\n\n<p>...just keep referring to it as <code>Sheet2</code>.</p>\n\n<hr>\n\n<p><strong>One more example</strong> to clarify the difference:</p>\n\n<ul>\n<li>Create a new workbook.  (It will automatically have worksheet named <code>Sheet1</code>.)  </li>\n<li><p>Change the worksheet name to \"Sheet1999\", either manually (by double-clicking the name on it's tab) or programmatically (with <code>Sheet1.Name=\"Sheet1999\"</code>)</p></li>\n<li><p>Now, if you want to find out how many rows on that sheet have been used, you use use either:  </p>\n\n<pre><code>MsgBox Sheets(\"Sheet1999\").UsedRange.Rows.Count\n</code></pre>\n\n<p><em>...or:</em></p>\n\n<pre><code>MsgBox Sheet1.UsedRange.Rows.Count\n</code></pre></li>\n</ul>\n\n<hr>\n\n<blockquote>\n  <h1><em>A note about <code>Sheets</code> versus <code>Worksheets</code>:</em></h1>\n</blockquote>\n\n<p>When referring to a worksheet <code>Sheets</code> and <code>Worksheets</code> can <em>usually</em> be used interchangeably, so for example these two lines do the <strong>same thing</strong>:</p>\n\n<pre><code>Worksheets(\"mySheet\").Calculate\n\nSheets(\"mySheet\").Calculate\n</code></pre>\n\n<p><strong>The difference</strong> is that:</p>\n\n<ul>\n<li><p>the <code>Worksheets</code> object searches <strong>the <code>Worksheets</code> Collection</strong> for a matching <em>Name</em>, <em>Index</em>, or <em>CodeName</em>.</p></li>\n<li><p>the <code>Sheets</code> object searches <strong>the <code>Worksheets</code> Collection **and</strong> the <code>Charts</code> Collection** for a matching <em>Name</em>, <em>Index</em>, or <em>CodeName</em>.</p></li>\n</ul>\n\n<p>Therefore, the only time it would be a problem is if you have <strong>a chart and a worksheet with the same name</strong>.  </p>\n\n<p>So, <strong>don't ever name a chart the same as a worksheet</strong>, and then you won't have to worry about it, and can go on saving 4 keystrokes any time you refer to a <em><code>Sheet</code></em>...  :)</p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/worksheet-object-excel\" rel=\"nofollow noreferrer\"><strong><code>Worksheet</code> Object</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/library/office/dn301176.aspx\" rel=\"nofollow noreferrer\"><strong><code>Worksheet</code> Properties</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/library/office/dn301177.aspx\" rel=\"nofollow noreferrer\"><strong><code>Worksheet</code> Methods</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/sheets-object-excel\" rel=\"nofollow noreferrer\"><strong><code>Sheets</code> Object</strong></a></p></li>\n</ul>\n"}], "owner": {"reputation": 271, "user_id": 9569786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MTT", "link": "https://stackoverflow.com/users/9569786/mtt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531929808, "creation_date": 1531908633, "last_edit_date": 1531929808, "question_id": 51399305, "link": "https://stackoverflow.com/questions/51399305/variable-name-of-a-worksheet", "title": "Variable name of a worksheet", "body": "<p>I want to name a worksheet in excel as the value inside cell \"C6\" in the tab named \"Control\". I am new to VBA and what I tried was typing this on a module.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'\n' Macro2 Macro\n'\n\n'\n    Dim month As String\n    month = Sheet2.Range(\"C5\")\n    Sheets(\"Month\").Name = month\nEnd Sub\n</code></pre>\n\n<p>Moreover, I do not know whether the name will be updated automatically. I do not want to have to run a macro to change the worksheet name...</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531907920, "post_id": 51398909, "comment_id": 89768938, "body": "What is a floating reference?"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531907992, "post_id": 51398909, "comment_id": 89768983, "body": "@Vityata &quot;i&quot;, since it changes in the loop."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1531908055, "post_id": 51398909, "comment_id": 89769020, "body": "Can you take a look here and try to do the steps - <a href=\"https://stackoverflow.com/questions/49363434/excel-vba-formula-german-french-italian-russian-dutch-foreign-function/49363501#49363501\" title=\"excel vba formula german french italian russian dutch foreign function\">stackoverflow.com/questions/49363434/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1531908841, "post_id": 51399106, "comment_id": 89769518, "body": "Instead of using replace, consider using the parameters of <code>Address</code> to return a relative reference (ie without <code>$</code>&#39;s)"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1531909131, "post_id": 51399106, "comment_id": 89769708, "body": "Thanks @chrisneilsen, wasn&#39;t aware of that. Will update my answer :0)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1531909174, "post_id": 51399106, "comment_id": 89769733, "body": "Do not write a formula into <code>.value</code> - use <code>.formula</code> instead"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1531909259, "post_id": 51399106, "comment_id": 89769797, "body": "@FunThomas. You are quite right. I was focusing on the right hand side far too much!"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 1, "last_activity_date": 1531909276, "last_edit_date": 1531909276, "creation_date": 1531908055, "answer_id": 51399106, "question_id": 51398909, "link": "https://stackoverflow.com/questions/51398909/writing-a-formula-with-concatenated-parts-into-a-cell/51399106#51399106", "title": "Writing a formula with concatenated parts into a cell", "body": "<pre><code>wb.Worksheets(\"Dates\").Cells(i,2).formula = \"=FS(\" &amp; Cells(1, i).Address(0,0) &amp; \";\"\"FI(DATE,,DATE)\"\")\"\n</code></pre>\n\n<p>There may be a better way to convert the column number to a letter (which is the problem you are having, along with the double quotes)!</p>\n"}, {"comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531909568, "post_id": 51399429, "comment_id": 89770002, "body": "I think it should be <code>adr = cells(1, i).address(false, false)</code> as it&#39;s the column that&#39;s changing, not the row"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1531909684, "post_id": 51399429, "comment_id": 89770068, "body": "@Pi: Probably you&#39;re right - copied this part from OP."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1531909778, "last_edit_date": 1531909778, "creation_date": 1531908994, "answer_id": 51399429, "question_id": 51398909, "link": "https://stackoverflow.com/questions/51398909/writing-a-formula-with-concatenated-parts-into-a-cell/51399429#51399429", "title": "Writing a formula with concatenated parts into a cell", "body": "<p>Working with formulas in VBA is a little bit tricky:</p>\n\n<ul>\n<li><p>To write a formula, use the <code>range.formula</code> property, not the <code>.value</code>.  </p></li>\n<li><p>You have to write the formula as if you are using an english Excel. Parameter-separator is comma (not semicolon). </p></li>\n<li>If a formula needs a quote, double it so that the VBA compiler understands that you want a quote within a string.</li>\n<li>I find it helpfull to write a formula into a variable before assigning it - you can check in the debugger if it is exactly how it should before assigning it.</li>\n<li>To check how the formula should look like, write it into a cell, change to the VBA-editor, open the <em>immediate window</em> and write <code>? activecell.formula</code></li>\n</ul>\n\n<p>Try (untested as the formula you need is not valid to us):</p>\n\n<pre><code>with wb.Worksheets(\"Dates\")\n  dim f as string, adr as string\n  adr = cells(i, 1).address(false, false)   ' get rid of Dollar signs\n  f = \"=FS(\" &amp; adr &amp; \",\"\"FI(DATE,,DATE)\"\")\"\n  .Cells(i, 2).formula = f\nend with\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51399429, "answer_count": 2, "score": 0, "last_activity_date": 1531909778, "creation_date": 1531907477, "question_id": 51398909, "link": "https://stackoverflow.com/questions/51398909/writing-a-formula-with-concatenated-parts-into-a-cell", "title": "Writing a formula with concatenated parts into a cell", "body": "<p><strong>Scenario:</strong> I have a code that should write a formula to a worksheet cells. This formula is for an API to retrieve some value. My formula is inside a loop (this is done for multiple columns) and references the first row for an identifier.</p>\n\n<p><strong>The original formula:</strong></p>\n\n<pre><code>=FS(B1;\"FI(DATE,,DATE)\")\n</code></pre>\n\n<p><strong>The modified formula with the floating reference (inside the loop):</strong></p>\n\n<pre><code>For i = 1 To lColumn\n    If wb.Worksheets(\"Dates\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        wb.Worksheets(\"Dates\").Cells(i,2).value = \"=FS(\" &amp; i &amp; \"1;\"FI(DATE,,DATE)\")\"\n    End If\nNext i\n</code></pre>\n\n<p>Where lColumn is some pre-defined number.</p>\n\n<p><strong>Issue:</strong> I keep getting the \"Unexpected end of statement\" error in the formula part of the loop.</p>\n\n<p><strong>What I already tried:</strong> I tried different variations, repositioning the \"s and 's, for example:</p>\n\n<pre><code>wb.Worksheets(\"Dates\").Cells(i,2).value = \"'\"=FS(\" &amp; i &amp; \"1;\"FI(DATE,,DATE)\")\"\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>wb.Worksheets(\"Dates\").Cells(i,2).value = \"'=FS(\" &amp; i &amp; \"1;\"FI(DATE,,DATE)\")\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>wb.Worksheets(\"Dates\").Cells(i,2).value = \"'\"\"=FS(\" &amp; i &amp; \"1;\"FI(DATE,,DATE)\")\"\n</code></pre>\n\n<p>and so on. But the error still persists.</p>\n\n<p><strong>Question:</strong> What is the proper way to do this operation?</p>\n"}, {"tags": ["excel", "vba", "copy", "paste", "worksheet"], "comments": [{"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 1, "creation_date": 1531908352, "post_id": 51398821, "comment_id": 89769207, "body": "you cannot copy both. you have to copy -&gt; insert -&gt; copy -&gt; insert. set different workbooks to do this w/o activeworkbook and select."}], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "edited": false, "score": 0, "creation_date": 1531931108, "post_id": 51399328, "comment_id": 89784777, "body": "Hey @Yavuz Topal, it&#39;s not cool to edit your question to something completely different. My answer looks irrelevant now and it got unaccepted. You should post new question and keep the old one."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 1, "creation_date": 1531944370, "post_id": 51399328, "comment_id": 89791791, "body": "hi Kirszu, I am really sorry about this. I will keep it in mind for the next time. It won&#39;t happen again."}, {"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "reply_to_user": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1531995131, "post_id": 51399328, "comment_id": 89810758, "body": "No problem! It is just a good habit to keep StackOveflow clear :)"}], "tags": [], "owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "is_accepted": true, "score": 0, "last_activity_date": 1531908701, "creation_date": 1531908701, "answer_id": 51399328, "question_id": 51398821, "link": "https://stackoverflow.com/questions/51398821/vba-renaming-the-relevant-sheet-in-excel/51399328#51399328", "title": "VBA, Renaming the relevant sheet in Excel", "body": "<p>You are right about first copied values being overwritten by the second.\nSo you have to first copy first value -> paste first value -> copy second value -> paste second value</p>\n\n<p>Something like this:</p>\n\n<pre><code>Dim wb As Workbook\nDim ws as worksheet\n\nSet wb = Workbooks.Add\nSet ws = wb.Worksheets(\"Sheet1\")\n\nSheets(\"Hypothekenbanken\").Range(\"A11:P57\").Copy\nws.Range(\"A2\").PasteSpecial\nSheets(\"Landesbanken\").Range(\"A11:P41\").Copy\nws.Range(\"A3\").PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51399328, "answer_count": 1, "score": 0, "last_activity_date": 1531930096, "creation_date": 1531907223, "last_edit_date": 1531930096, "question_id": 51398821, "link": "https://stackoverflow.com/questions/51398821/vba-renaming-the-relevant-sheet-in-excel", "title": "VBA, Renaming the relevant sheet in Excel", "body": "<p>I am using twice the command \"Workbooks.Open Filename...\" in order to open the file (which were already open the first time) from which to be copied from.</p>\n\n<p>Is there an other economical solution without mentioning it twice but instead refering to the already open workbook? Furtheremore, the command:   ActiveSheet.Name = \"Spread\" doesnt rename in the pasted sheet. It does so only when I bring that relevant Sheets in front. </p>\n\n<pre><code> Sub CopyAndPaste()\n\n Dim wb As Workbook\n Dim ws As Worksheet\n\n Set wb = Workbooks.Add\n Set ws = wb.Worksheets(\"Tabelle1\")\n\n datDatum = Now\n\n\n Workbooks.Open        \n Filename:=\"C:\\Users\\........xls\" *'the source file'*\n\n Sheets(\"Hypothekenbanken\").Range(\"A11:P57\").Copy\n ws.Range(\"A2\").PasteSpecial\n ActiveSheet.Name = \"Spread\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1531918106, "creation_date": 1531918106, "answer_id": 51402438, "question_id": 51398788, "link": "https://stackoverflow.com/questions/51398788/sum-of-weekdays-calculate-filtered-data/51402438#51402438", "title": "Sum of weekdays, calculate filtered data", "body": "<p>This should do what you're after:  </p>\n\n<pre><code>=SUMPRODUCT(--(WEEKDAY(Usages!$AB$2:$AB$2029,2)=A2)*SUBTOTAL(3,OFFSET(Usages!$AB$2:$AB$2029,ROW(Usages!$AB$2:$AB$2029)-MIN(ROW(Usages!$AB$2:$AB$2029)),,1)))  \n</code></pre>\n\n<p>Plenty of examples on the internet.</p>\n"}], "owner": {"reputation": 61, "user_id": 8829737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49431c001f0256a7ec92032acbf28a81?s=128&d=identicon&r=PG&f=1", "display_name": "bobby", "link": "https://stackoverflow.com/users/8829737/bobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 51402438, "answer_count": 1, "score": 0, "last_activity_date": 1594210250, "creation_date": 1531907116, "last_edit_date": 1594210250, "question_id": 51398788, "link": "https://stackoverflow.com/questions/51398788/sum-of-weekdays-calculate-filtered-data", "title": "Sum of weekdays, calculate filtered data", "body": "<p>This formula </p>\n\n<pre><code> =SUMPRODUCT(--(WEEKDAY(Usages!$AB$2:$AB$2029,2)=A2))\n</code></pre>\n\n<p>is used to calculate the number of days that appeared in a list.</p>\n\n<p>Is there a way to only calculate the filtered data?\nLooking for something similar to a subtotal function</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531906535, "post_id": 51398373, "comment_id": 89767994, "body": "What are the values of the variables when the error occurs?  (Click <code>Debug</code> on the error and hover your mouse over each of the variables on the yellow highlighted line of code.)"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531909826, "post_id": 51398470, "comment_id": 89770158, "body": "You are absolutely right for the concatenation, but if this was the problem, the error would have been <code>13 - type mismatch</code>."}, {"owner": {"reputation": 1, "user_id": 10063634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08adce7136862c34a43bdb833a265171?s=128&d=identicon&r=PG&f=1", "display_name": "Gery120", "link": "https://stackoverflow.com/users/10063634/gery120"}, "edited": false, "score": 0, "creation_date": 1531911396, "post_id": 51398470, "comment_id": 89771108, "body": "Thank you for the hint but that wasn&#39;t the issue"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531918717, "post_id": 51398470, "comment_id": 89775992, "body": "@Vityata Oh I see. Thanks for pointing that out - I&#39;m still learning VBA aswell ;)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531918781, "post_id": 51398470, "comment_id": 89776043, "body": "@DirtyDeffy - you are welcome. Actually the errors in VBA are quite helpful concerning the problem."}], "tags": [], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "is_accepted": false, "score": 2, "last_activity_date": 1531918750, "last_edit_date": 1531918750, "creation_date": 1531906247, "answer_id": 51398470, "question_id": 51398373, "link": "https://stackoverflow.com/questions/51398373/vba-runtime-error-1004-application-defined-or-object-defined-error-after-quart/51398470#51398470", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d after quarter of loop is done", "body": "<p>Try this:</p>\n\n<pre><code> ws.Cells(1, a) = (thing &amp; \" \" &amp; Country)\n</code></pre>\n\n<p>When concatenating set variables with a string, you need to use <code>&amp;</code> instead of <code>+</code></p>\n\n<p>Edit: As pointed out by Vityata, this is a nice tip, but it doesn't fix the issue at hand.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10063634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08adce7136862c34a43bdb833a265171?s=128&d=identicon&r=PG&f=1", "display_name": "Gery120", "link": "https://stackoverflow.com/users/10063634/gery120"}, "edited": false, "score": 0, "creation_date": 1531911665, "post_id": 51398598, "comment_id": 89771285, "body": "The issue occures when it sets the value of the cell to &quot;CIA XK&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 10063634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08adce7136862c34a43bdb833a265171?s=128&d=identicon&r=PG&f=1", "display_name": "Gery120", "link": "https://stackoverflow.com/users/10063634/gery120"}, "edited": false, "score": 0, "creation_date": 1531913398, "post_id": 51398598, "comment_id": 89772358, "body": "@Gery120 - have you tried to change the <code>Long</code> to an <code>Integer</code>?"}, {"owner": {"reputation": 1, "user_id": 10063634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08adce7136862c34a43bdb833a265171?s=128&d=identicon&r=PG&f=1", "display_name": "Gery120", "link": "https://stackoverflow.com/users/10063634/gery120"}, "edited": false, "score": 0, "creation_date": 1531914789, "post_id": 51398598, "comment_id": 89773317, "body": "Yes but that wasn&#39;t the Problem..i figured it out i was using a old word version so here was a limit on colums"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1531906593, "creation_date": 1531906593, "answer_id": 51398598, "question_id": 51398373, "link": "https://stackoverflow.com/questions/51398373/vba-runtime-error-1004-application-defined-or-object-defined-error-after-quart/51398598#51398598", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d after quarter of loop is done", "body": "<p>Change your code like this:</p>\n\n<pre><code>For Each thing In things\n    For Each Country In Countries\n        Debug.Print things + \" \" + Country\n        ws.Cells(1, a) = thing + \" \" + Country\n        a = a + 1\n    Next Country\nNext thing\n</code></pre>\n\n<p>Thus you would see what exactly causes the error. Press <kbd>Ctrl</kbd> + <kbd>G</kbd> to see the log. </p>\n\n<p>The <code>+</code> is not a good concatenation sign, however, it may \"work\" if both <code>thing</code> and <code>Country</code> are numbers. The correct concatenation in VBA is with the <code>&amp;</code>.</p>\n\n<p>Another possible mistake is the usage of <code>Integer</code> - to be on the safe side with vba, use long.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10063634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08adce7136862c34a43bdb833a265171?s=128&d=identicon&r=PG&f=1", "display_name": "Gery120", "link": "https://stackoverflow.com/users/10063634/gery120"}, "is_accepted": false, "score": 0, "last_activity_date": 1531914907, "creation_date": 1531914907, "answer_id": 51401398, "question_id": 51398373, "link": "https://stackoverflow.com/questions/51398373/vba-runtime-error-1004-application-defined-or-object-defined-error-after-quart/51401398#51401398", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d after quarter of loop is done", "body": "<p>On a old Excel version there is a limit for columns at about 250</p>\n"}], "owner": {"reputation": 1, "user_id": 10063634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08adce7136862c34a43bdb833a265171?s=128&d=identicon&r=PG&f=1", "display_name": "Gery120", "link": "https://stackoverflow.com/users/10063634/gery120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531918750, "creation_date": 1531906044, "last_edit_date": 1531908111, "question_id": 51398373, "link": "https://stackoverflow.com/questions/51398373/vba-runtime-error-1004-application-defined-or-object-defined-error-after-quart", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d after quarter of loop is done", "body": "<p>hi I'm new to VBA and i have this weird error that accures quater through a loop which does nearly the same ever time.</p>\n\n<pre><code>Sub tabele_to_database()\nDim ws As Worksheet\nDim Countries As New Collection\nDim things As New Collection\nDim Row As Boolean\nDim Coloum As Boolean\nDim i As Integer\nDim a As Integer\n\nSet ws = ThisWorkbook.Sheets.Add(After:= _\n        ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n\nRow = True\nColoum = True\ni = 2\nWhile Row\n\n    Countries.Add Sheets(\"payment terms\").Cells(1, i).Value\n\n    i = i + 1\n    If IsEmpty(Sheets(\"payment terms\").Cells(1, i)) Then\n        Row = False\n    End If\nWend\n\ni = 2\nWhile Coloum\n\n    things.Add CStr(Sheets(\"payment terms\").Cells(i, 1).Value)\n    i = i + 1\n    If IsEmpty(Sheets(\"payment terms\").Cells(i, 1)) Then\n        Coloum = False\n    End If\n\nWend\n\na = 1\n\nFor Each thing In things\n\n    For Each Country In Countries\n        ws.Cells(1, a) = (thing + \" \" + Country)\n\n        a = a + 1\n    Next Country\nNext thing\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The error is in</p>\n\n<pre><code> ws.Cells(1, a) = (thing + \" \" + Country)\n</code></pre>\n\n<p>about quarter through the proccess.</p>\n\n<p>the variables are a = 257 which is the amount of coloumns it printed\nthing is the thing in the 7t row and country the country in the 36th so eveything should be fine</p>\n\n<p>I know that thing and things aren't good names but I am at a internship and have no clue about most things.</p>\n\n<p>It's for work but i am at a internship so i have no clue and I \"learned\" VBA just for this.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1531913884, "post_id": 51398062, "comment_id": 89772660, "body": "Please provide more context - code that you&#39;ve tried so that we can repro."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1531914626, "post_id": 51398062, "comment_id": 89773188, "body": "And what is it, more exactly, you&#39;re trying to do? Change the color of the underlying text? Or the way the revision is displayed?"}, {"owner": {"reputation": 11, "user_id": 10097926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06f5543f26c8e90cc5f35367120ec173?s=128&d=identicon&r=PG&f=1", "display_name": "Robson", "link": "https://stackoverflow.com/users/10097926/robson"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1531977107, "post_id": 51398062, "comment_id": 89800679, "body": "I added some more information."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1532010576, "creation_date": 1532010576, "answer_id": 51425276, "question_id": 51398062, "link": "https://stackoverflow.com/questions/51398062/vba-word-property-revision-style-dosnt-work/51425276#51425276", "title": "VBA Word: Property Revision.Style dosn&#39;t work", "body": "<p>As you say, it's not possible to set the color for revisions per author, explicitly. It simply is <em>not</em> possible. </p>\n\n<p>I believe that <code>Revisions.Style</code> is <em>not</em> for changing how a revision looks (color or anything else). I believe it's meant to return <code>Style</code> information, such as the name of the style and the various properties (analog to <code>Range.Style</code>). The error is because Word hasn't recorded such information, probably because it doesn't recognize the related style types...</p>\n\n<p>There are two related(?) <code>Revision.Type</code> enums: <code>wdRevisionStyle</code>  and <code>wdRevisionStyleDefinition</code>. In a quick test - formatting using a style, creating a style and changing a style definition - I was not able to return either of these revision types. But according to the Language Reference they mean:</p>\n\n<blockquote>\n  <p>wdRevisionStyle            8 Style changed.<br>\n  wdRevisionStyleDefinition 13 Style definition changed.</p>\n</blockquote>\n\n<p>In my tests, the type of revision returned for applying a style is <code>wdRevisionParagraphProperty</code> and changing a style definition is not recorded as a Revision.</p>\n\n<p>For <code>Revision.Style</code> to return information I believe you'd need to test whether the <code>Revision.Type</code> is either of the above and only then would there be a valid object in <code>Revision.Style</code>.</p>\n\n<p>I'm looking at Word 2010.</p>\n"}], "owner": {"reputation": 11, "user_id": 10097926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06f5543f26c8e90cc5f35367120ec173?s=128&d=identicon&r=PG&f=1", "display_name": "Robson", "link": "https://stackoverflow.com/users/10097926/robson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532025738, "creation_date": 1531905217, "last_edit_date": 1532025738, "question_id": 51398062, "link": "https://stackoverflow.com/questions/51398062/vba-word-property-revision-style-dosnt-work", "title": "VBA Word: Property Revision.Style dosn&#39;t work", "body": "<p>When I try to change some styles (e.g. textcolor) in a revisions object I get a <code>Run-Time error '5852'</code> (requested object is not available). I've used <code>ActiveDocument.Revisions(i).Style</code> ... Other properties are available (author, creator, type, ...). Btw: I really want change the style from the revision (not the ordinary text). Tested in Word 2010 &amp; 2016</p>\n\n<p>edit: a bit more detailed:</p>\n\n<p>I try to change the color of the revisions that is displayed. Word sets it automically by default. But you can't choose which color Word assigns to reviewers (<a href=\"https://support.office.com/en-us/article/advanced-track-changes-options-in-word-2016-for-mac-42ff9070-0aca-4ced-9755-7fbd69b72859?omkt=en-001&amp;ui=en-US&amp;rs=en-001&amp;ad=US\" rel=\"nofollow noreferrer\">See this link</a>)</p>\n\n<p>Unfortunately this is exactly what I want to do. So I tried it with VBA and actually there is the property style available for the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/revision-object-word\" rel=\"nofollow noreferrer\">revision object</a>, but I get an <code>error 5852</code> in line with <code>ActiveDocument.Revisions(i).Style</code></p>\n\n<pre><code>Sub test()\n    i = 1\n    While i &lt;= ActiveDocument.Revisions.Count\n        Debug.Print \"Revision \" &amp; i &amp; \" Author: \" &amp; ActiveDocument.Revisions(i).Author 'works\n        Debug.Print \"Revision \" &amp; i &amp; \" Creator: \" &amp; ActiveDocument.Revisions(i).Creator 'works\n        Debug.Print \"Revision \" &amp; i &amp; \" Date: \" &amp; ActiveDocument.Revisions(i).Date 'works\n        Debug.Print \"Revision \" &amp; i &amp; \" FormatDescription: \" &amp; ActiveDocument.Revisions(i).FormatDescription 'works...\n        Debug.Print \"Revision \" &amp; i &amp; \" Range: \" &amp; ActiveDocument.Revisions(i).Range 'work\n        Debug.Print \"Revision \" &amp; i &amp; \" Style: \" &amp; ActiveDocument.Revisions(i).Style 'error 5852\n        Debug.Print \"Revision \" &amp; i &amp; \" Type: \" &amp; ActiveDocument.Revisions(i).Type 'works\n        i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n\n<p>Does anyone know why this error occurs?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8478062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ead4c1ce13e108ed697718c3b22ff5?s=128&d=identicon&r=PG&f=1", "display_name": "7thGen", "link": "https://stackoverflow.com/users/8478062/7thgen"}, "edited": false, "score": 1, "creation_date": 1531906032, "post_id": 51398038, "comment_id": 89767656, "body": "I like this approach. I will study this furthermore. I want to have more options in doing VBA. THANK YOU!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1531905122, "creation_date": 1531905122, "answer_id": 51398038, "question_id": 51397973, "link": "https://stackoverflow.com/questions/51397973/add-iferror-function-to-vba/51398038#51398038", "title": "Add Iferror Function to VBA", "body": "<p>Add before the row with <code>Next</code>:</p>\n\n<pre><code>If IsError(Worksheets(\"Educational Service Report\").Cells(d, 16)) Then\n    Worksheets(\"Educational Service Report\").Cells(d, 16) = \"\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 2, "last_activity_date": 1531905181, "creation_date": 1531905181, "answer_id": 51398050, "question_id": 51397973, "link": "https://stackoverflow.com/questions/51397973/add-iferror-function-to-vba/51398050#51398050", "title": "Add Iferror Function to VBA", "body": "<p>Something like below would do that for you, a nested application function:</p>\n\n<pre><code>For d = 2 To lastrowx2\n\nWorksheets(\"Educational Service Report\").Cells(d, 16).Value = Application.IfError( _\n    Application.VLookup(Worksheets(\"Educational Service Report\").Cells(d, 15).Value, _\n    Worksheets(\"Educational Service Report\").Range(\"X:Y\"), 2, 0), \"\")\n\nNext d\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8478062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ead4c1ce13e108ed697718c3b22ff5?s=128&d=identicon&r=PG&f=1", "display_name": "7thGen", "link": "https://stackoverflow.com/users/8478062/7thgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 51398038, "answer_count": 2, "score": 1, "last_activity_date": 1531909611, "creation_date": 1531904949, "last_edit_date": 1531909611, "question_id": 51397973, "link": "https://stackoverflow.com/questions/51397973/add-iferror-function-to-vba", "title": "Add Iferror Function to VBA", "body": "<p>How do you inject the iferror function on this code?</p>\n\n<pre><code>For d = 2 To lastrowx2\n\nWorksheets(\"Educational Service Report\").Cells(d, 16).Value = Application.WorksheetFunction.VLookup( _\nWorksheets(\"Educational Service Report\").Cells(d, 15).Value, _\nWorksheets(\"Educational Service Report\").Range(\"X:Y\"), 2, 0)\n\nNext\n</code></pre>\n\n<p>I just want a null value cells (d, 16) if it is an error.</p>\n"}, {"tags": ["vba", "outlook", "ldap", "exchange-server"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1531921744, "post_id": 51397941, "comment_id": 89778353, "body": "What profile? Local Outlook profile as seen in Control Panel | Mail | Show Profiles? Or the GAL user creation date?"}, {"owner": {"reputation": 1, "user_id": 10098430, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i8kqTp4mDaI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pLl6yXRTQFb6L5mF0uLZl5TmOHHQ/mo/photo.jpg?sz=128", "display_name": "Ben Reid", "link": "https://stackoverflow.com/users/10098430/ben-reid"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1532011986, "post_id": 51397941, "comment_id": 89822557, "body": "I would be happy with either (truthfully on the basis that I don\u2019t know the difference...) as I only want this date to check for a years employment in the business. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1532012349, "creation_date": 1532012349, "answer_id": 51425909, "question_id": 51397941, "link": "https://stackoverflow.com/questions/51397941/find-outlook-exchange-profile-creation-date-using-vb/51425909#51425909", "title": "Find outlook exchange profile creation date using VB", "body": "<p>You can read PR_CREATION_TIME (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x30070040</code>) from the <code>AddressEntry</code> object using <code>AddressEntry.PropetyAccessor.GetProperty</code>.</p>\n\n<p>Fot the current (Outlook profile wise) user, <code>AddressEntry</code> can be retrieved from <code>Application.Session.CurrentUser.AddressEntry</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10098430, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i8kqTp4mDaI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pLl6yXRTQFb6L5mF0uLZl5TmOHHQ/mo/photo.jpg?sz=128", "display_name": "Ben Reid", "link": "https://stackoverflow.com/users/10098430/ben-reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532012349, "creation_date": 1531904872, "question_id": 51397941, "link": "https://stackoverflow.com/questions/51397941/find-outlook-exchange-profile-creation-date-using-vb", "title": "Find outlook exchange profile creation date using VB", "body": "<p>My first question, so take it easy on me please, but constructive feedback on asking questions properly more than welcome \ud83d\ude0a</p>\n\n<p>I program in a bespoke scripting language for a case management system, but occasionally need to step out to get other information. In the environment I am currently working in I have no admin rights and minimal server access. </p>\n\n<p>I want to be able to pull exchange profile creation dates into the CMS to check users have been here over a year. I can\u2019t work out the LDAP connection string, none of the power shell examples I have seen (dswuery, dsget etc) work and the only other method I can think that I have left to do this in is VB. </p>\n\n<p>I assume I should be able to do this by getting a recipient and finding the creation date, but my attempts at this have been unsuccessful. Any pointers, tips, guidance or code snippets would be greatly appreciated! </p>\n\n<p>Thanks, </p>\n"}, {"tags": ["vba", "autofilter"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10098428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8195ef684d5e2c5449bd719c27027a0?s=128&d=identicon&r=PG&f=1", "display_name": "David A", "link": "https://stackoverflow.com/users/10098428/david-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1532101660, "creation_date": 1532101660, "answer_id": 51446186, "question_id": 51397777, "link": "https://stackoverflow.com/questions/51397777/autofilter-a-table-in-another-sheet-based-on-selected-cell-value-where-autofilte/51446186#51446186", "title": "Autofilter a table in another sheet based on selected cell value where autofilter needs to be &#39;contains&#39;", "body": "<p>solved!</p>\n\n<p>Criteria1:=\"<em>\" &amp; ActiveCell.Value &amp; \"</em>\"</p>\n"}], "owner": {"reputation": 1, "user_id": 10098428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8195ef684d5e2c5449bd719c27027a0?s=128&d=identicon&r=PG&f=1", "display_name": "David A", "link": "https://stackoverflow.com/users/10098428/david-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532101660, "creation_date": 1531904416, "last_edit_date": 1531904575, "question_id": 51397777, "link": "https://stackoverflow.com/questions/51397777/autofilter-a-table-in-another-sheet-based-on-selected-cell-value-where-autofilte", "title": "Autofilter a table in another sheet based on selected cell value where autofilter needs to be &#39;contains&#39;", "body": "<p>i'm not that familiar with VBA, so i've referenced this solution '<a href=\"https://stackoverflow.com/questions/35231790/clicking-a-hyperlink-in-excel-to-set-autofilter-on-a-different-sheet#\">Clicking a hyperlink in Excel to set autofilter on a different sheet</a>', however what i need the autofilter to do is to look within the target column on the sheet for cells which contain the value selected</p>\n\n<p>this is what im using which is fine for autofiltering where the exact value matches the target, but if the target contains multiple values in the field then it doesnt include them in the filter:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If ActiveCell.Column = 3 Then\n    Sheet1.ListObjects(\"target\").Range.AutoFilter Field:=17, Criteria1:=ActiveCell.Value\n    Sheet1.Activate\n    End If\nEnd Sub\n</code></pre>\n\n<p>I think i need to somehow change the 'Sheet1.ListObjects(\"target\").Range.AutoFilter Field:=17, Criteria1:=ActiveCell.Value' part to look in Field 17 where value contains, eg:</p>\n\n<p>if field 17 looked link this and the ActiveCell.Value i selected was 'AA' the VBA im using would only show 2 entries instead of the 4 rows where it actually is</p>\n\n<h2>Field 17 (the below should show in a column layout not row btw)</h2>\n\n<p>AA, AB\nAA\nAA\nAC\nAF, AA, AB</p>\n\n<p>many thanks!</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1532247558, "post_id": 51397761, "comment_id": 89895354, "body": "As long as the text formatting can identify it uniquely and conclusively as a code example rather than something else, this should be possible to do throughout a presentation or, with more work, in multiple presentations.  But this is a &quot;help you fix your code&quot; site, not a &quot;write it for you&quot; site, so you&#39;ll need to have a go at it first and ask here about problems that arise."}, {"owner": {"reputation": 1667, "user_id": 2895087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAhqy.jpg?s=128&g=1", "display_name": "Albert Godfrind", "link": "https://stackoverflow.com/users/2895087/albert-godfrind"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1532348736, "post_id": 51397761, "comment_id": 89925819, "body": "I only use those styles (menlo or consolas) for text boxes that contain code (I never use them for anything else). I am not asking for anyone to &quot;write it for me&quot;. Mostly I want to know if there is some kind of &quot;global search/replace&quot; in Powerpoint that gets me there: I have found nothing of the like ... If you are hinting that I should use VBA or any other scripting that is fine as long as the learning curve is not longer than the time it takes me to do all the changes manually (probably a few hours)."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1532503168, "post_id": 51397761, "comment_id": 89994312, "body": "There&#39;s nothing in Powerpoint&#39;s feature set that will help with this but as long as the text is in text boxes or text placeholders and isn&#39;t grouped with other shapes or part of smart-art or the like, a bit of VBA wouldn&#39;t be very difficult to write. Say, to look at the font of each shape with text and if it&#39;s menlo, convert it to consolas. Or vice versa. If there&#39;s likely to be consolas/menlo text in the same text box as other text, it gets a wee bit trickier. I can give you a bit of VBA to get you started if you like."}, {"owner": {"reputation": 1667, "user_id": 2895087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAhqy.jpg?s=128&g=1", "display_name": "Albert Godfrind", "link": "https://stackoverflow.com/users/2895087/albert-godfrind"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1532528442, "post_id": 51397761, "comment_id": 90011288, "body": "Thanks, A bit of VBA to get me started would be great. I have never touched that ... My text is always in isolated text boxes."}], "answers": [{"comments": [{"owner": {"reputation": 1667, "user_id": 2895087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAhqy.jpg?s=128&g=1", "display_name": "Albert Godfrind", "link": "https://stackoverflow.com/users/2895087/albert-godfrind"}, "edited": false, "score": 0, "creation_date": 1533140801, "post_id": 51532105, "comment_id": 90240635, "body": "Thanks a lot. It works great. I did one more thing in the code: I used it to also remove the shading from the text boxes, and added some counting. Thanks again. I am going to keep this code around !"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1667, "user_id": 2895087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAhqy.jpg?s=128&g=1", "display_name": "Albert Godfrind", "link": "https://stackoverflow.com/users/2895087/albert-godfrind"}, "edited": false, "score": 0, "creation_date": 1533247701, "post_id": 51532105, "comment_id": 90289007, "body": "@AlbertGodfrind As I said, it was just a starter. I kind of figured you&#39;d run with it.  Great!"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1532585618, "creation_date": 1532585618, "answer_id": 51532105, "question_id": 51397761, "link": "https://stackoverflow.com/questions/51397761/how-can-i-replace-a-style-in-a-presentation-with-another-one/51532105#51532105", "title": "How can I replace a style in a presentation with another one?", "body": "<p>Here's a starter:</p>\n\n<pre><code>Option Explicit\n\n' Edit these to reflect the names of the fonts\n' you want to change from and to:\nConst ChangeFromFont As String = \"Consolas\"\nConst ChangeToFont As String = \"Courier New\"\n\nSub ChangeFontName()\n\n    Dim oSh As Shape\n    Dim oSl As Slide\n\n    For Each oSl In ActivePresentation.Slides\n    For Each oSh In oSl.Shapes\n        If oSh.HasTextFrame Then\n        If oSh.TextFrame.HasText Then\n            With oSh.TextFrame.TextRange\n                If UCase(.Font.Name) = UCase(ChangeFromFont) Then\n                    .Font.Name = ChangeToFont\n                End If\n            End With\n        End If\n        End If\n    Next\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1667, "user_id": 2895087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAhqy.jpg?s=128&g=1", "display_name": "Albert Godfrind", "link": "https://stackoverflow.com/users/2895087/albert-godfrind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1593768011, "creation_date": 1531904358, "last_edit_date": 1593768011, "question_id": 51397761, "link": "https://stackoverflow.com/questions/51397761/how-can-i-replace-a-style-in-a-presentation-with-another-one", "title": "How can I replace a style in a presentation with another one?", "body": "<p>I have a number of presentations where I show code examples. Each one is a lesson in a course. </p>\n\n<p>I have not been very systematic: in some presentations I use the <code>menlo</code> style. In others I use <code>consolas</code>. I also sometimes mix both in the same presentation. Bad, bad me!</p>\n\n<p>I now would like to make everything more consistent. Going through each and every slide in every presentation to change the style is my punishment. </p>\n\n<p>But is there a way to make that change global ? I mean is there a way to replace a style globally in a presentation ? In multiple presentations ? </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2045, "user_id": 56688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee1220e0ff47d2ad071d6c377ada7965?s=128&d=identicon&r=PG", "display_name": "pritaeas", "link": "https://stackoverflow.com/users/56688/pritaeas"}, "edited": false, "score": 2, "creation_date": 1531904413, "post_id": 51397740, "comment_id": 89766511, "body": "Because your insert query creates them. Remove the spaces between the single and double quotes."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1531910104, "post_id": 51397740, "comment_id": 89770330, "body": "I have to add that seems a very strange use of TempVars, what is the source of that data you have stored into tempvars ?"}, {"owner": {"reputation": 1, "user_id": 10098397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0mn_xAEeLaM/AAAAAAAAAAI/AAAAAAAAAAA/9rEnTOxQYgY/photo.jpg?sz=128", "display_name": "MrMulligan", "link": "https://stackoverflow.com/users/10098397/mrmulligan"}, "edited": false, "score": 0, "creation_date": 1532002670, "post_id": 51397740, "comment_id": 89815839, "body": "Thanks Pritaeas, that made the trick, and I thought I had tried that already\u2026. Minty: Your question implies that using tempvars is not very professional  way of doing this, and I appreciate that. The source varies and I tried to make it look nice and neat only."}], "owner": {"reputation": 1, "user_id": 10098397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0mn_xAEeLaM/AAAAAAAAAAI/AAAAAAAAAAA/9rEnTOxQYgY/photo.jpg?sz=128", "display_name": "MrMulligan", "link": "https://stackoverflow.com/users/10098397/mrmulligan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594631888, "creation_date": 1531904311, "last_edit_date": 1594631888, "question_id": 51397740, "link": "https://stackoverflow.com/questions/51397740/insert-into-adds-leading-and-trailing-spaces", "title": "INSERT INTO adds leading and trailing spaces", "body": "<p>Why does INSERT INTO add leading and trailing spaces to strings in the following:</p>\n\n<pre><code>    CurrentDb.Execute \"INSERT INTO [Rounds] ([Round ID],[Cource ID],[Round Date],[Tee Time],[Handicap Round],[Player ID],[Player HCP],[Slope],[Tee],[Holes Played],[Comments],[Green Fee],[GF Term])\" &amp; _\n                                    \" VALUES (' \" &amp; TempVars!tvNewRoundID &amp; \" ',' \" &amp; TempVars!tvCourceID &amp; \" ',' \" &amp; TempVars!tvRoundDate &amp; \" ',' \" &amp; TempVars!tvTeeTime &amp; \" ',' \" &amp; TempVars!tvHandicapRound &amp; \" ',' \" &amp; TempVars!tvPlayerID &amp; \" ',' \" &amp; [Forms]![Data Entry Form]![txtPlayerHCP] &amp; \" ',' \" &amp; TempVars!tvPlayerSlope &amp; \" ',' \" &amp; TempVars!tvTeeName &amp; \" ',' \" &amp; TempVars!tvHolesPlayed &amp; \" ',' \" &amp; TempVars!tvComments &amp; \" ',' \" &amp; TempVars!tvGreenFee &amp; \" ',' \" &amp; TempVars!tvGreenFeeTerm &amp; \" ' );\" \n</code></pre>\n\n<p>Declarations are like this:\nPublic tvNewRoundID As TempVars\nPublic tvRoundDate As TempVars\nPublic tvTeeName As Variant etc. </p>\n\n<p>The problem applies for strings only, everything else works fine. I have tried by trimming before INSERT INTO with no avail, the spaces appear in the table.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531904901, "post_id": 51397641, "comment_id": 89766855, "body": "<code>Autosave</code>, I suspect. Disable it if is really causing significant issues that outweigh the benefits."}, {"owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531906385, "post_id": 51397641, "comment_id": 89767880, "body": "Yes it does matter but I think reason is still different. May be with Windows or something. Because it happens with browser also. Leave 5 minit open and inactive you browser with some website, when you get back to it.. it perform the same kind of freezing."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1531906562, "post_id": 51397641, "comment_id": 89768017, "body": "Probably not a question for an Excel-vba forum then. Maybe check what the PC is doing, using Task Manager and/or discuss with your network / I.T. people. Best of luck!"}, {"owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531912062, "post_id": 51397641, "comment_id": 89771494, "body": "@CLR No buddy, it&#39;s definitely a question for an Excel VBA forum only because I required solution for excel and may have excel bas some features which will have facility which makes these things settle down  and only excel VBA users can know..?! So I&#39;m in a right place."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1531912870, "post_id": 51397641, "comment_id": 89771959, "body": "You&#39;ve just said yourself <i>May be with Windows or something</i>.. From personal experience using <b>Excel</b> for the last 20 years or so, the most common reason for lockups <i>matching your description</i> is Autosave kicking in - sometimes combined/conflicting with other vba Events. You&#39;re asking too broad a question for this forum if you&#39;re talking about outside Excel. <b>This is a forum where posters put forward their code and ask for help getting it to work the way they intend</b>, not really a discussion board for the finer points of using large files across a network."}], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593770160, "creation_date": 1531904026, "last_edit_date": 1593770160, "question_id": 51397641, "link": "https://stackoverflow.com/questions/51397641/xlsm-files-freezes-over-activating-after-long-hrs-of-inactivity", "title": ".xlsm files freezes over activating after long hrs of inactivity", "body": "<p>Like suppose, your .xlsm file is about more than 5 mb</p>\n<p>It has more than 20 sub procedures any many more. Many inbuilt formulas &amp; functions are used in the background on the excel sheet. Yes, more than 20 Excel sheets. So this is how large Excel VBA Application looks like.</p>\n<p>Now, I found one issue with the large application, It stops working or freezes or not respond when your application is open in your system for more than few hrs without having any action on it!</p>\n<p>Yes, and as soon as you activate your workbook after a long hr of other work, workbook almost freezes or showing not responding. and we need to close the excel file anyhow for further any process.</p>\n<p>It's very common encounters who has worked on large excel files. Please discuss here the reasons, causes, and solutions.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "tsql", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531905495, "post_id": 51397495, "comment_id": 89767271, "body": "The 10-rows-at-a-time is for fetching data from Sql Server into Access, not for inserting."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531905520, "post_id": 51397495, "comment_id": 89767286, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25863473/how-to-increase-performance-for-bulk-inserts-to-odbc-linked-tables-in-access\">How to increase performance for bulk INSERTs to ODBC linked tables in Access?</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531905553, "post_id": 51397495, "comment_id": 89767311, "body": "(While the question is about Oracle, the answer is for SQL Server.) -- See also <a href=\"https://stackoverflow.com/questions/32759978/how-to-increase-performance-for-bulk-inserts-to-odbc-linked-tables-in-access-for\" title=\"how to increase performance for bulk inserts to odbc linked tables in access for\">stackoverflow.com/questions/32759978/&hellip;</a>"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1531942453, "post_id": 51397495, "comment_id": 89790845, "body": "Why use Access tables at all? Whatever you do with the access table can be done with a second SQL table linked to access, assuming it is not possible to do what you need with just a single table."}, {"owner": {"reputation": 91, "user_id": 5806136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23884428220b940bd68c2d1ca9c8cf3e?s=128&d=identicon&r=PG&f=1", "display_name": "m.falconelli", "link": "https://stackoverflow.com/users/5806136/m-falconelli"}, "edited": false, "score": 0, "creation_date": 1531986737, "post_id": 51397495, "comment_id": 89805410, "body": "Hi, because I cannot import excel files into SQL Sever as functions like OPENDATASOURCE or OPENROWSET are blocked.then for same simple operation Access is strangely faster."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 3, "last_activity_date": 1532034817, "creation_date": 1532034817, "answer_id": 51431809, "question_id": 51397495, "link": "https://stackoverflow.com/questions/51397495/how-to-speed-up-tables-transfer-between-access-and-sql-server-using-vba/51431809#51431809", "title": "How to speed up tables transfer between Access and SQL Server using VBA?", "body": "<p>Why are functions like OPENDATASOURCE or OPENROWSET are blocked?  Do you work in a bank?  </p>\n\n<p>I can't say for sure which solution is the absoute fastest, but you may want to consider exporting all Access tables as separate CSV files (or Excel files), and then run a small script to load each of those files into SQL Server.</p>\n\n<p>Here is some VBA code that saves separate tables as separate files.</p>\n\n<pre><code>Dim obj As AccessObject, dbs As Object\nSet dbs = Application.CurrentData\nFor Each obj In dbs.AllTables\nIf Left(obj.Name, 4) &lt;&gt; \"MSys\" Then\nDoCmd.TransferText acExportDelim, , obj.Name, obj.Name &amp; \".csv\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, obj.Name, obj.Name &amp; \".xls\", True\nEnd If\nNext obj\n</code></pre>\n\n<p>Now, you can very easily, and very quickly, load CSV files into SQL Server using Bulk Insert.</p>\n\n<pre><code>Create TestTable\n\nUSE TestData\nGO\nCREATE TABLE CSVTest\n(ID INT,\nFirstName VARCHAR(40),\nLastName VARCHAR(40),\nBirthDate SMALLDATETIME)\nGO\n\nBULK\nINSERT CSVTest\nFROM 'c:\\csvtest.txt'\nWITH\n(\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\nGO\n--Check the content of the table.\nSELECT *\nFROM CSVTest\nGO\n--Drop the table to clean up database.\nDROP TABLE CSVTest\nGO\n</code></pre>\n\n<p><a href=\"https://blog.sqlauthority.com/2008/02/06/sql-server-import-csv-file-into-sql-server-using-bulk-insert-load-comma-delimited-file-into-sql-server/\" rel=\"nofollow noreferrer\">https://blog.sqlauthority.com/2008/02/06/sql-server-import-csv-file-into-sql-server-using-bulk-insert-load-comma-delimited-file-into-sql-server/</a></p>\n\n<p>Also, you may want to consider one of these options.</p>\n\n<p><a href=\"https://www.online-tech-tips.com/ms-office-tips/ms-access-to-sql-database/\" rel=\"nofollow noreferrer\">https://www.online-tech-tips.com/ms-office-tips/ms-access-to-sql-database/</a></p>\n\n<p><a href=\"https://support.office.com/en-us/article/move-access-data-to-a-sql-server-database-by-using-the-upsizing-wizard-5d74c0df-c8cd-4867-8d07-e6e759d72924\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/move-access-data-to-a-sql-server-database-by-using-the-upsizing-wizard-5d74c0df-c8cd-4867-8d07-e6e759d72924</a></p>\n"}], "owner": {"reputation": 91, "user_id": 5806136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23884428220b940bd68c2d1ca9c8cf3e?s=128&d=identicon&r=PG&f=1", "display_name": "m.falconelli", "link": "https://stackoverflow.com/users/5806136/m-falconelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 2, "accepted_answer_id": 51431809, "answer_count": 1, "score": 2, "last_activity_date": 1532034817, "creation_date": 1531903644, "last_edit_date": 1531904971, "question_id": 51397495, "link": "https://stackoverflow.com/questions/51397495/how-to-speed-up-tables-transfer-between-access-and-sql-server-using-vba", "title": "How to speed up tables transfer between Access and SQL Server using VBA?", "body": "<p>I am trying to move tables from access to SQL Server programmatically.\nI have some limitation in the system permissions, ie: I cannot use OPENDATASOURCE or OPENROWSET. </p>\n\n<p>What I want to achieve is to transfer some table from Access to SQL Server and then work on that tables through vba (excel)/python and T-SQL.</p>\n\n<p>The problem is in the timing that it is required to move the tables.\nMy current process is:</p>\n\n<ol>\n<li>I work with vba macros, importing data from excel and making same transformation in access, to then import into the SQL Server</li>\n<li>destroy the table in the server: \"DROP TABLE\"</li>\n<li>re-importing the table with DoCmd.TransferDatabase</li>\n</ol>\n\n<p>What I have notice is that the operation seems to be done based on a batch of rows and not directly. It is taking 1 minutes and half each 1000 rows. The same operation on Access it would have taken few seconds.</p>\n\n<p>I understood that it is a specific way of SQL Server to use import by batches of 10 rows, probably to have more access on data: <a href=\"https://technet.microsoft.com/en-us/library/bb188204(v=sql.90).aspx\" rel=\"nofollow noreferrer\">Micorsoft details</a></p>\n\n<p>But in the above process I just want a copy the table from access to the SQL as fast as possible as then I would avoid cross platform links and I will perform operation only on the SQL Server.</p>\n\n<p>Which would be the faster way to achieve this goal?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531903733, "post_id": 51397480, "comment_id": 89766055, "body": "<code>Range(&quot;B1&quot;).CurrentRegion</code> ... do you have values in A or are they in B? If so you will need <code>Cells(var, 2)</code>. As it stands your code is circular as both sides refer to the same cell."}, {"owner": {"reputation": 3, "user_id": 10098359, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pJrGp3Th2XI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osyjNhJTj4izk6CoKiBfc20wkSMA/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10098359/james"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1531904231, "post_id": 51397480, "comment_id": 89766398, "body": "Thanks. That was it!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1531903824, "creation_date": 1531903824, "answer_id": 51397559, "question_id": 51397480, "link": "https://stackoverflow.com/questions/51397480/why-does-range-value-left-not-work/51397559#51397559", "title": "Why Does Range.Value = Left(....) not work?", "body": "<p>Most probably you are not declaring something completely - either the worksheet, or the rows in the current region. Start with something as simple as this one to see how it works:</p>\n\n<pre><code>Public Sub HereComesTheCode()\n\n    Dim r As Long: r = 10\n    Dim i As Long\n    Dim wks As Worksheet: Set wks = Worksheets(1)\n\n    For i = 2 To r\n        With wks\n            .Range(\"A\" &amp; i) = Left(.Cells(i, 1), 1)\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1531904499, "creation_date": 1531904499, "answer_id": 51397811, "question_id": 51397480, "link": "https://stackoverflow.com/questions/51397480/why-does-range-value-left-not-work/51397811#51397811", "title": "Why Does Range.Value = Left(....) not work?", "body": "<p>This would be an alternative method, scanning the cells in B and writing the first letter of each cell into the cell to the left of it:</p>\n\n<pre><code>Dim c As Range\nFor Each c In Range(\"B1\", \"B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row).Cells\n    c.Offset(0, -1).Value = Left(c.Text, 1)\nNext\n</code></pre>\n\n<p>Note: Strictly speaking, it would be good practice to qualify your ranges though:</p>\n\n<pre><code>Dim c As Range\nWith Worksheets(\"YOUR_SHEET_NAME_HERE\")\nFor Each c In .Range(\"B1\", \"B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row).Cells\n    c.Offset(0, -1).Value = Left(c.Text, 1)\nNext\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10098359, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pJrGp3Th2XI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osyjNhJTj4izk6CoKiBfc20wkSMA/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10098359/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531904499, "creation_date": 1531903607, "question_id": 51397480, "link": "https://stackoverflow.com/questions/51397480/why-does-range-value-left-not-work", "title": "Why Does Range.Value = Left(....) not work?", "body": "<p>I am very new to VBA, so this probably has a very simple answer!</p>\n\n<p>I am trying to use the Left function to produce a string of the first digit of the cells in a column, but for reasons which I don't understand, when I use Range.Value = Left(...) it does not put the values that I have got from Left(...) into the cell.</p>\n\n<p>I am left with a blank column A when the code has finished running. </p>\n\n<p>Can anyone explain why this is happening and suggest how to fix it. </p>\n\n<p>The code I wrote is:</p>\n\n<pre><code>Dim r As Integer\nDim var As Variant\nr = Range(\"B1\").CurrentRegion.Rows.Count\n\nFor var = 2 To r\n    Range(\"A\" &amp; var).Value = Left(Cells(var, 1).Text, 1)\nNext var\n</code></pre>\n\n<p>Thanks so much.</p>\n"}, {"tags": ["vba", "powerpoint", "userform"], "comments": [{"owner": {"reputation": 3329, "user_id": 2070111, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/WG0vD.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/2070111/nick"}, "edited": false, "score": 1, "creation_date": 1531903707, "post_id": 51397325, "comment_id": 89766036, "body": "When you say &#39;does not work&#39;, do you mean nothing happens or is there an error, etc.?"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1531905421, "post_id": 51397325, "comment_id": 89767218, "body": "I&#39;m assuming <code>qlist(cntr)</code>is your variable, when and where is it defined/set in your code?"}, {"owner": {"reputation": 25, "user_id": 10098272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea1599c35a36f8ea46cc5fa8357af8?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy.L", "link": "https://stackoverflow.com/users/10098272/jimmy-l"}, "edited": false, "score": 0, "creation_date": 1531907959, "post_id": 51397325, "comment_id": 89768968, "body": "There is no error shown up. It simply does not do anything when I click the button. yes, qlist is an array of integers which is declared in the module as a public variant. qlist is created when the first form is active and it will be used for the rest of the application. cntr is also a public integer which accumulated every time a button is clicked."}, {"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1532254661, "post_id": 51397325, "comment_id": 89896910, "body": "Please move your solution to an answer of its own, thank you."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1612127365, "post_id": 51397325, "comment_id": 116663484, "body": "Why did you use <code>CallByName(UserForms, &quot;Add&quot;, VbMethod, FormName)</code>? That would simply be <code>UserForms.Add(FormName)</code>."}], "owner": {"reputation": 25, "user_id": 10098272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea1599c35a36f8ea46cc5fa8357af8?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy.L", "link": "https://stackoverflow.com/users/10098272/jimmy-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1532254638, "creation_date": 1531903148, "last_edit_date": 1592644375, "question_id": 51397325, "link": "https://stackoverflow.com/questions/51397325/show-vba-userform-with-variables-in-userform-name", "title": "Show VBA userform with variables in userform name", "body": "<p>I am doing a PPT where I need to click buttons to show various Forms.</p>\n<p>I have created a public function in the main module.</p>\n<pre><code>Public Function ShowForm(FormName As String)\n    Dim oneForm As Object\n    For Each oneForm In UserForms\n        If oneForm.Name = FormName Then\n            oneForm.Show\n            End\n        End If\n    Next oneForm\nEnd Function\n</code></pre>\n<p>And used it in the button below:</p>\n<pre><code>Private Sub NextPage_Click()\n\nShowForm (&quot;SU0&quot; &amp; qlist(cntr))\ncntr = cntr + 1\n\nEnd Sub\n</code></pre>\n<p>But the function does not work. Did I miss anything or is there a better way of doing this?</p>\n<hr />\n<h1>Solved</h1>\n<p>Google is the key...</p>\n<p>I have changed the function in the module and everything works fine now.</p>\n<pre><code>Public Function ShowForm(FormName As String)\n    Dim oneForm As Object\n    Set oneForm = CallByName(UserForms, &quot;Add&quot;, VbMethod, FormName)\n    oneForm.Show\nEnd Function\n</code></pre>\n<p>Note that in order to handle multiple userforms, the &quot;ShowModal&quot; property of those forms needs to be set to FALSE.</p>\n"}, {"tags": ["excel", "vba", "ms-word", "readonly", "readonly-attribute"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1531903195, "post_id": 51397314, "comment_id": 89765661, "body": "Is the file located on a server, where someone else is already accessing?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1531911925, "post_id": 51397314, "comment_id": 89771429, "body": "You should also show us more of your code - the parts that initiate Excel, for example. And do you have a reference to the Excel libary in the Word VBA project?"}, {"owner": {"reputation": 23, "user_id": 10071300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc53939143bdc2cdc3bbdb58fbd289f?s=128&d=identicon&r=PG&f=1", "display_name": "Jander Friebe", "link": "https://stackoverflow.com/users/10071300/jander-friebe"}, "edited": false, "score": 0, "creation_date": 1531917005, "post_id": 51397314, "comment_id": 89774835, "body": "The references are all activated and the file is on an local folder. Excel itself is initiated in on Sub-Level, while this is just a Function. However it works now somehow... If I were to save the &quot;Parameters&quot; file with .save, it gives me an error, but at least I can write in the File now. I don&#180;t even want to save it, so everything is fine now. Even though I didn&#180;t changed anything in the code about this topic. (That&#39;s what I think at least) But thank you for your time:)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1532010677, "post_id": 51397314, "comment_id": 89821597, "body": "Sometimes, restarting the application(s) or Windows can have good effects on &quot;odd&quot; behavior :-) Glad it&#39;s working!"}], "owner": {"reputation": 23, "user_id": 10071300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc53939143bdc2cdc3bbdb58fbd289f?s=128&d=identicon&r=PG&f=1", "display_name": "Jander Friebe", "link": "https://stackoverflow.com/users/10071300/jander-friebe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531911862, "creation_date": 1531903104, "last_edit_date": 1531911862, "question_id": 51397314, "link": "https://stackoverflow.com/questions/51397314/vba-word-excel-file-keeps-opening-in-readonly-mode", "title": "VBA Word: Excel file keeps opening in ReadOnly Mode", "body": "<p>As mentioned in the title, an Excel file, which I open from a Word macro keeps  opening in ReadyOnly Mode, no matter what I try.  </p>\n\n<p>Here is the code which causes the behavior:  </p>\n\n<pre><code>Dim wbProcess As Workbook\nDim strDatei As String\n\nstrDatei = ActiveDocument.Path &amp; \"\\Parameters.xlsx\"   \nSet wbProcess = Workbooks.Open(strDatei, IgnoreReadOnlyRecommended:=True, ReadOnly:=False)  \n\nExcel.Application.Visible = True\n</code></pre>\n\n<p>Or could it be some other settings, not in VBA specific?  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531903080, "post_id": 51397242, "comment_id": 89765588, "body": "I would say replace all the spaces with blanks, but it will delete all the spaces even those you need"}, {"owner": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1531905233, "post_id": 51397242, "comment_id": 89767120, "body": "Please have a look at <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531906350, "post_id": 51397242, "comment_id": 89767858, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i> Below are some links with tips to get you started. See the <b><a href=\"https://stackoverflow.com/help/on-topic\">help center</a></b> then if, after <a href=\"//meta.stackoverflow.com/q/261592\"><i>doing more research</i></a>, you have a <i>specific</i> problem, you can <a href=\"https://stackoverflow.com/posts/51397242/edit\">edit</a> your post to share your <b><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b> as well as sample(s) of your data and some background info. Some good reading to get you started: &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as tips <a href=\"//codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\"><b>here</b></a> and <a href=\"//meta.stackoverflow.com/questions/347937/\"><b>here</b></a> Plus, here&#39;s the <a href=\"//stackoverflow.com/editing-help\"><b>Formatting FAQ</b></a>. Good Luck!"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1531908523, "creation_date": 1531908523, "answer_id": 51399270, "question_id": 51397242, "link": "https://stackoverflow.com/questions/51397242/excel-data-letters-between-space-how-to-remove/51399270#51399270", "title": "Excel data letters between space how to remove?", "body": "<p>It's hard to tell since you posted an image with your example (instead of text within your question) but if I understand, you're trying to remove spaces from text, unless they are next to a comma, so this:</p>\n\n<pre><code>A B C D, E F G\n</code></pre>\n\n<p>...becomes:</p>\n\n<pre><code>ABCD, EFG\n</code></pre>\n\n<hr>\n\n<p>If that's the goal, then you just need to nest two replace functions. </p>\n\n<p>For example, if the text is in cell <code>A1</code> you could...</p>\n\n<h2>Excel:</h2>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(A1,\" \",\"\"),\",\",\", \")\n</code></pre>\n\n<h2>VBA:</h2>\n\n<pre><code>[A1]=Replace(Replace([A1],\" \",\"\"),\",\",\", \")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10093509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xjuYqxRG1cM/AAAAAAAAAAI/AAAAAAAAHSE/tFgYBL4DNdw/photo.jpg?sz=128", "display_name": "nagu samineni", "link": "https://stackoverflow.com/users/10093509/nagu-samineni"}, "edited": false, "score": 0, "creation_date": 1531979602, "post_id": 51399431, "comment_id": 89801571, "body": "hi, LOOKING space remove between letters only"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 0, "last_activity_date": 1531909000, "creation_date": 1531909000, "answer_id": 51399431, "question_id": 51397242, "link": "https://stackoverflow.com/questions/51397242/excel-data-letters-between-space-how-to-remove/51399431#51399431", "title": "Excel data letters between space how to remove?", "body": "<p>As @Aneta pointed out, you could just replace all the spaces with nothing, but then you end up removing spaces that you actually need (eg the ones that separate words).</p>\n\n<p>For instance, 'TEM PL ATE STD TAG.CDL' would end up becoming 'TEMPLATESTDTAG.CDL'.</p>\n\n<p>You could get fancy and use a dictionary to look the words up, but in the case of the word 'TEMPLATE', it could end up being split like this 'TEMP LATE', where both words would be found in a dictionary, making the problem indeterminate.</p>\n\n<p>Another option you have would be to create a dictionary of expected words, remove all the spaces, and then parse each string, looking for matches in your dictionary. Of course, that also becomes unworkable if you have the words 'TEMPLATE', 'TEMP' and 'LATE' in your dictionary since this is once again indeterminate.</p>\n\n<p>Ultimately, unless you have a fixed list of expected csv items, no algorithm in the world is going to know where the spaces really belong!</p>\n"}], "owner": {"reputation": 9, "user_id": 10093509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xjuYqxRG1cM/AAAAAAAAAAI/AAAAAAAAHSE/tFgYBL4DNdw/photo.jpg?sz=128", "display_name": "nagu samineni", "link": "https://stackoverflow.com/users/10093509/nagu-samineni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1531909000, "creation_date": 1531902873, "last_edit_date": 1531908390, "question_id": 51397242, "link": "https://stackoverflow.com/questions/51397242/excel-data-letters-between-space-how-to-remove", "title": "Excel data letters between space how to remove?", "body": "<p>Please look my data first field, my output required second field data format without space in letters</p>\n\n<p><a href=\"https://i.stack.imgur.com/Sh0Xn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yGOLD.png\" alt=\"img\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531902471, "post_id": 51397008, "comment_id": 89765194, "body": "Is <code>ElseIf Range(&quot;i10&quot;) &lt;&gt; &quot;&quot; And Range(&quot;K22&quot;).Value &gt; 0.5 Then</code> correct? It doesn&#39;t follow the same pattern as other criteria."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5039381, "user_type": "registered", "profile_image": "https://graph.facebook.com/839044109514251/picture?type=large", "display_name": "Deb  ", "link": "https://stackoverflow.com/users/5039381/deb"}, "edited": false, "score": 0, "creation_date": 1531903803, "post_id": 51397091, "comment_id": 89766092, "body": "Thanks a lot! Also how can i get the code to say something like &quot;The error is in cell C8&quot; etc. So i need to know the cell number basically"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 31, "user_id": 5039381, "user_type": "registered", "profile_image": "https://graph.facebook.com/839044109514251/picture?type=large", "display_name": "Deb  ", "link": "https://stackoverflow.com/users/5039381/deb"}, "edited": false, "score": 0, "creation_date": 1531921466, "post_id": 51397091, "comment_id": 89778137, "body": "@DevDeb If you&#39;re only using hard-coded ranges, than you can simply adjust the msgbox string for each If-statement."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1531902431, "creation_date": 1531902431, "answer_id": 51397091, "question_id": 51397008, "link": "https://stackoverflow.com/questions/51397008/i-need-to-show-a-msgbox-and-exit-sub-if-the-cells-contain-anything-other-than-nu/51397091#51397091", "title": "I need to show a msgbox and exit sub if the cells contain anything other than numbers. Right now it gives a blank", "body": "<p>Try IsNumeric which is true for blanks or numbers/dates.</p>\n\n<pre><code>if not isnumeric(Range(\"i10\")) then\n    msgbox \"something\"\n    exit sub\nend if\nIf Range(\"i10\") &lt;&gt; \"\" And Range(\"i10\").Value &lt;= 0.25 Then\n    ...\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5039381, "user_type": "registered", "profile_image": "https://graph.facebook.com/839044109514251/picture?type=large", "display_name": "Deb  ", "link": "https://stackoverflow.com/users/5039381/deb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531902431, "creation_date": 1531902147, "question_id": 51397008, "link": "https://stackoverflow.com/questions/51397008/i-need-to-show-a-msgbox-and-exit-sub-if-the-cells-contain-anything-other-than-nu", "title": "I need to show a msgbox and exit sub if the cells contain anything other than numbers. Right now it gives a blank", "body": "<p>'This code needs to throw an error message if the cells contain any charactar        </p>\n\n<p>If Range(\"i10\") &lt;> \"\" And Range(\"i10\").Value &lt;= 0.25 Then</p>\n\n<pre><code>            Range(\"i10\").Copy Range(\"K22\")\n            Range(\"K22\").Interior.ColorIndex = 4\n            Ws.Cells(22, 11).Borders.LineStyle = XlLineStyle.xlContinuous\n\n    ElseIf Range(\"i10\") &lt;&gt; \"\" And Range(\"K22\").Value &gt; 0.5 Then\n            Range(\"i10\").Copy Range(\"K22\")\n            Range(\"K22\").Interior.ColorIndex = 3\n            Ws.Cells(22, 11).Borders.LineStyle = XlLineStyle.xlContinuous\n    Else\n\n    If Range(\"i10\") &lt;&gt; \"\" And Range(\"i10\").Value &gt; 0.25 And Range(\"i10\").Value &lt;= 0.5 Then\n        Range(\"i10\").Copy Range(\"K22\")\n        Range(\"K22\").Interior.ColorIndex = 6\n        Ws.Cells(22, 11).Borders.LineStyle = XlLineStyle.xlContinuous\n\n    End If\n  End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531902423, "post_id": 51396939, "comment_id": 89765159, "body": "How many rows are there in columns <code>B</code> and <code>G</code>? At the moment <code>LSearchrow</code> is always <code>2</code>, so you never move down the column <code>B</code>."}, {"owner": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531916455, "post_id": 51396939, "comment_id": 89774472, "body": "Column B and G respectively has 2160 and 14 values. I have set LSearchrow to 2 as it starts to pick values from row 2."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531920305, "post_id": 51397165, "comment_id": 89777184, "body": "I have tried to run it but actually it is not giving any output. Can you please paste the whole code so that I will figure out what I am doing wrong?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531920414, "post_id": 51397165, "comment_id": 89777278, "body": "@AnujMavlankar - I guess your comment is for the other answer? This is the whole code."}, {"owner": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531921252, "post_id": 51397165, "comment_id": 89777958, "body": "Vityata, I have tried your code snippet but it is not working."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531921299, "post_id": 51397165, "comment_id": 89777998, "body": "@AnujMavlankar - which part is not working? Are you receiving wrong values? Where? An error? Where?"}, {"owner": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531921525, "post_id": 51397165, "comment_id": 89778177, "body": "It doesnot give any error but also it doesn&#39;t produce any output. Could you please suggest."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531921650, "post_id": 51397165, "comment_id": 89778287, "body": "@AnujMavlankar - are you sure? Can you try step-by-step with F8? Probably your worksheet is not the first one? <code>wks1</code> is referring to the first one in Excel."}, {"owner": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531922519, "post_id": 51397165, "comment_id": 89778908, "body": "I have tried again and still being the same. My data lies in first sheet only and second sheet where it is expected to paste the matching rows is empty."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "reply_to_user": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "edited": false, "score": 0, "creation_date": 1531922998, "post_id": 51397165, "comment_id": 89779233, "body": "@Anuj I thing that the problem is that there is only one loop and Vityata is expecting to find match on the same row. But considering your comment to the original question (2161 rows in column B and 15 rows in column G), it won&#39;t be the case."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1531921680, "last_edit_date": 1531921680, "creation_date": 1531902667, "answer_id": 51397165, "question_id": 51396939, "link": "https://stackoverflow.com/questions/51396939/copying-matching-rows-in-two-columns-in-excel/51397165#51397165", "title": "Copying matching rows in two columns in excel", "body": "<pre><code>Public Sub HereComesTheCode()\n\n    Dim copyToRow As Long: copyToRow = 2\n    Dim wks1 As Worksheet: Set wks1 = Worksheets(1)\n    Dim wks2 As Worksheet: Set wks2 = Worksheets(2)\n    Dim i As Long\n\n    For i = 2 To 15            \n        If wks1.Cells(i, \"B\") = wks1.Cells(i, \"G\") And wks1.Cells(i, \"B\") &lt;&gt; \"\" Then\n\n            wks1.Range(wks1.Cells(i, \"B\"), wks1.Cells(i, \"G\")).Copy\n            wks2.Cells(copyToRow, \"B\").PasteSpecial xlPasteAll\n            copyToRow = copyToRow + 1\n            Application.CutCopyMode = False                \n        End If                \n    Next i \n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>Declare the variables as <code>Long</code>, not as <code>Integer</code>;</li>\n<li><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></li>\n<li>Declare less variables, you do not need them all;</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "is_accepted": false, "score": 0, "last_activity_date": 1531918502, "creation_date": 1531918502, "answer_id": 51402572, "question_id": 51396939, "link": "https://stackoverflow.com/questions/51396939/copying-matching-rows-in-two-columns-in-excel/51402572#51402572", "title": "Copying matching rows in two columns in excel", "body": "<p>I assume that the matching values don't have to be in the same row.</p>\n\n<pre><code>For i = 2 To Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n  searchTerm = Range(\"G\" &amp; i).Text\n  For LSearchRow = 1 To Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n  If Range(\"B\" &amp; CStr(LSearchRow)).Value = searchTerm Then\n     Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Copy\n     Sheets(\"Sheet2\").Select\n     Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n     ActiveSheet.Paste\n     LCopyToRow = LCopyToRow + 1\n     Sheets(\"Sheet1\").Select\n  End If\n  Next LSearchRow\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10098129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S8zdx3AziTM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7w1_wjqADl_p38S3EsXLBidOqEg/mo/photo.jpg?sz=128", "display_name": "Anuj", "link": "https://stackoverflow.com/users/10098129/anuj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531930367, "creation_date": 1531901913, "last_edit_date": 1531930367, "question_id": 51396939, "link": "https://stackoverflow.com/questions/51396939/copying-matching-rows-in-two-columns-in-excel", "title": "Copying matching rows in two columns in excel", "body": "<p>What I am trying to achieve is to search a list of texts in column G with column B of the same excel sheet (Sheet1) and if any match occurs then that whole row must be copied and paste it in another sheet(Sheet2). Actually I have tried a lot to debug the code but it is not working. Any help would be greatly appreciated! I have attached the code below.</p>\n\n<p>Thank You\nAnuj</p>\n\n<pre><code>Sub SearchForString()\n\n   Dim LSearchRow As Integer\n   Dim LCopyToRow As Integer\n   Dim searchTerm As String\n\n   On Error GoTo Err_Execute\n\n\n   LSearchRow = 2\n   LCopyToRow = 2\n\n\n  For i = 2 To 15\n      searchTerm = Range(\"G\" &amp; i).Text\n      If Range(\"B\" &amp; CStr(LSearchRow)).Value = searchTerm Then\n\n\n         Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n         Selection.Copy\n\n\n         Sheets(\"Sheet2\").Select\n         Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n         ActiveSheet.Paste\n\n\n         LCopyToRow = LCopyToRow + 1\n\n\n         Sheets(\"Sheet1\").Select\n\n      End If\n\nNext i\n\nLSearchRow = LSearchRow + 1\n\n   Application.CutCopyMode = False\n   Range(\"A3\").Select\n\n   MsgBox \"All matching data has been copied!\"\n\n   Exit Sub\n\nErr_Execute:\n   MsgBox \"An error occurred!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10098125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8e6a61202522c05855a7fe5affb8e3?s=128&d=identicon&r=PG&f=1", "display_name": "Bunk Moreland", "link": "https://stackoverflow.com/users/10098125/bunk-moreland"}, "is_accepted": false, "score": 0, "last_activity_date": 1531980902, "creation_date": 1531980902, "answer_id": 51415575, "question_id": 51396808, "link": "https://stackoverflow.com/questions/51396808/how-do-i-add-a-specific-attachment-name-to-subject-when-replying-forwarding-send/51415575#51415575", "title": "How do I add a specific attachment name to subject when replying/forwarding/sending?", "body": "<p>Sorry, it looks like I found a solution for this myself. Here's the updated script:</p>\n\n<pre><code>Private WithEvents Mail As Outlook.MailItem \nPrivate WithEvents Inspectors As Outlook.Inspectors\n\nPrivate Sub Application_Startup()   \nSet Inspectors = Application.Inspectors \nEnd Sub\n\nPrivate Sub Inspectors_NewInspector(ByVal Inspector As Inspector)   \n  If TypeOf Inspector.CurrentItem Is Outlook.MailItem Then\n    Set Mail = Inspector.CurrentItem   \n  End If \nEnd Sub\n\nPrivate Sub Mail_AttachmentAdd(ByVal Attachment As Attachment)   \n  If Attachment.DisplayName Like \"*Quote*\" Then\n    Mail.Subject = Mail.Subject &amp; \" / \" &amp; Attachment.DisplayName   \n  End If \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10098125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8e6a61202522c05855a7fe5affb8e3?s=128&d=identicon&r=PG&f=1", "display_name": "Bunk Moreland", "link": "https://stackoverflow.com/users/10098125/bunk-moreland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531980902, "creation_date": 1531901464, "question_id": 51396808, "link": "https://stackoverflow.com/questions/51396808/how-do-i-add-a-specific-attachment-name-to-subject-when-replying-forwarding-send", "title": "How do I add a specific attachment name to subject when replying/forwarding/sending?", "body": "<p>I'm new here, but I became very interested in VBA and macros to help me keep my mailbox organized.\nThe situation in short - I'm working in a translation office and whenever a client requests a translation, I'm sending them a quote for our services (Quote XXXX.pdf).</p>\n\n<p>I found the following string to add the attachment name to the mail subject:</p>\n\n<pre><code>Private WithEvents Mail As Outlook.MailItem\nPrivate WithEvents Inspectors As Outlook.Inspectors\n\nPrivate Sub Application_Startup()\n  Set Inspectors = Application.Inspectors\nEnd Sub\n\nPrivate Sub Inspectors_NewInspector(ByVal Inspector As Inspector)\n  If TypeOf Inspector.CurrentItem Is Outlook.MailItem Then\n    Set Mail = Inspector.CurrentItem\n  End If\nEnd Sub\n\nPrivate Sub Mail_AttachmentAdd(ByVal Attachment As Attachment)\n  Mail.Subject = \" / (\" &amp; Attachment.DisplayName &amp; \")\"\nEnd Sub\n</code></pre>\n\n<p>HOWEVER it only replaces the old subject with the attachment name (and adds \" / ()\" to it) no matter what is being attached. My Mail Signature also contains a small image file, so sometimes the name of the image is being copied to the subject line.</p>\n\n<p>I have 2 questions and would highly appreciate any help with them:</p>\n\n<ol>\n<li>How do I make it ADD the attachment name, not replace the old subject so it looks like </li>\n</ol>\n\n<blockquote>\n  <p>Old subject text / (Quote XXXX.pdf)</p>\n</blockquote>\n\n<ol start=\"2\">\n<li>How do I make this macro applicable only to the quotes (add attachment name to subject only if attachment contains \"Quote\")?</li>\n</ol>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1531902874, "creation_date": 1531902874, "answer_id": 51397243, "question_id": 51396737, "link": "https://stackoverflow.com/questions/51396737/search-for-header-name-exactly/51397243#51397243", "title": "Search for Header name exactly", "body": "<p>You are missing a parameter for Find: </p>\n\n<pre><code>Dim rngHeaders As Range \n\nSet rngHeaders = Range(\"1:1\") \nSet ws = ActiveSheetSet \n\nSet rngUsernameHeader = rngHeaders.Find(What:=\"Account Name\",After:=Cells(1,1), LookAt:=xlWhole)\n\nIf Not rngUsernameHeader Is Nothing Then rngUsernameHeader.Offset(0, 1).EntireColumn.Insert \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 9774758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5717b64d19998334ecc5979f1d7f326?s=128&d=identicon&r=PG&f=1", "display_name": "FlameHorizon", "link": "https://stackoverflow.com/users/9774758/flamehorizon"}, "is_accepted": false, "score": 1, "last_activity_date": 1531902966, "creation_date": 1531902966, "answer_id": 51397270, "question_id": 51396737, "link": "https://stackoverflow.com/questions/51396737/search-for-header-name-exactly/51397270#51397270", "title": "Search for Header name exactly", "body": "<p>Please refer to Find function documentation: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel</a>.</p>\n\n<p>You are looking for LookIn parameter. This parameter should be set to xlValues value which will enable function to search through cells based on their values.</p>\n"}], "owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51397243, "answer_count": 2, "score": 0, "last_activity_date": 1594206918, "creation_date": 1531901175, "last_edit_date": 1594206918, "question_id": 51396737, "link": "https://stackoverflow.com/questions/51396737/search-for-header-name-exactly", "title": "Search for Header name exactly", "body": "<p>I have created a macro to search for Header name and insert a column, but the macro searches for the words containing what has been given in the command instead of searching the exact Header Name.</p>\n\n<pre><code>'Looks in entire first row.\nDim rngHeaders As Range Set rngHeaders = Range(\"1:1\")\n\n'To set this to a specific sheetname, use Set ws = Sheets(\"Sheetname\")\nSet ws = ActiveSheetSet \nSet rngUsernameHeader = rngHeaders.Find(What:=\"Account Name\",After:=Cells(1,1))\n\nIf rngUsernameHeader Is Nothing Then\n\nElse \n    rngUsernameHeader.Offset(0, 1).EntireColumn.Insert \nendif\n</code></pre>\n"}, {"tags": ["database", "vba", "excel"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531902851, "post_id": 51396673, "comment_id": 89765433, "body": "Can you share some examples of your &#39;database&#39; and the receipts?"}, {"owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531905088, "post_id": 51396673, "comment_id": 89767017, "body": "good point, done!"}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531911097, "post_id": 51396673, "comment_id": 89770920, "body": "Does it mean that in your products column you can have more products and you want to slit them?"}, {"owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531911179, "post_id": 51396673, "comment_id": 89770972, "body": "yeah, but thats not a problem for me because I made another macro that does that"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "is_accepted": true, "score": 2, "last_activity_date": 1531911203, "creation_date": 1531911203, "answer_id": 51400179, "question_id": 51396673, "link": "https://stackoverflow.com/questions/51396673/macro-to-reconstruct-receipts-from-database/51400179#51400179", "title": "Macro to reconstruct receipts from database", "body": "<p>I think that this can help you to start:</p>\n\n<pre><code>Sub From_DB()\nDim i As Long\nDim col As Integer\nDim DB_Sheet, Rec_Sheet As Object\n\nSet DB_Sheet = ThisWorkbook.Worksheets(\"Database\")\nSet Rec_Sheet = ThisWorkbook.Worksheets(\"Receipts\")\ncol = 1\nFor i = 2 To DB_Sheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    If DB_Sheet.Rows(i).Hidden = False Then\n        Rec_Sheet.Cells(1, col) = DB_Sheet.Cells(i, 3)\n        Rec_Sheet.Cells(2, col) = DB_Sheet.Cells(i, 1)\n        Rec_Sheet.Cells(3, col) = DB_Sheet.Cells(i, 2)\n        Rec_Sheet.Cells(4, col) = DB_Sheet.Cells(i, 5)\n        Rec_Sheet.Cells(5, col) = DB_Sheet.Cells(i, 4)\n    col = col + 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 51400179, "answer_count": 1, "score": -3, "last_activity_date": 1531911203, "creation_date": 1531900993, "last_edit_date": 1531904916, "question_id": 51396673, "link": "https://stackoverflow.com/questions/51396673/macro-to-reconstruct-receipts-from-database", "title": "Macro to reconstruct receipts from database", "body": "<p>I need some help with a database I am trying to create on excel. Currently, I managed to build a system where I paste on to the excel sheet a receipt, then a macro extract certain pieces of information and stores it in another sheet, something like this;</p>\n\n<pre><code>BUYER  SELLER  DATE  PRODUCTS  CURRENCY\nA      B       123   abc        USD\nD      E       456   def        GBP\n</code></pre>\n\n<p>Now, I can search this database using simple filtering. What I would to do now is, once I have filtered and am left with, lets say, 5 entries, I would like those to be reconstructed in another sheet, looking like the receipts do originally e.g </p>\n\n<pre><code>123           456\nA             D\nB             E\nUSD           GBP\na             d\nb             e\nc             f\n</code></pre>\n\n<p>I know I need to loop through each row and once in a row, loop through each column to extract the required piece of information(e.g date, products etc).\nI have looked around and couldn't find anything.\nAny help would be appreciated, thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531900863, "post_id": 51396569, "comment_id": 89764262, "body": "If you run step by step with F8 on which line do you get the error? Do you have something in your code declared as <code>Integer</code>? If yes, declare it as <code>Long</code>."}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1531902448, "post_id": 51396569, "comment_id": 89765175, "body": "@Vityata please see my updated question. It is already defined as &quot;Long&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531904119, "post_id": 51397257, "comment_id": 89766309, "body": "Hi again! Sorry, I just checked. Now I am able to debug, and this is where it ends:  <code>ABHBooked = ABHdataFile.Sheets(&quot;Booked&quot;).Range(&quot;B5:&quot; &amp; ColumnName &amp; Cells(Rows.Count, &quot;B&quot;).End(xlUp).row).Value</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531904216, "post_id": 51397257, "comment_id": 89766388, "body": "@oliverbj - is <code>ABHBooked</code> an <code>Integer</code>?"}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531904258, "post_id": 51397257, "comment_id": 89766410, "body": "just updated my question. ABHBooked is defined in another function as variant: <code>Public ABHBooked As Variant</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531904399, "post_id": 51397257, "comment_id": 89766499, "body": "@oliverbj - have you tried to copy and paste my function to your code?"}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531904610, "post_id": 51397257, "comment_id": 89766638, "body": "Yes, unfortunately it still gives me &quot;oveflow&quot;. I have updated my OP to include the debug, where the codes &quot;breaks&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531904923, "post_id": 51397257, "comment_id": 89766875, "body": "@oliverbj - what is the value of <code>ColumnName</code>?"}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905036, "post_id": 51397257, "comment_id": 89766970, "body": "ColumnName = <code>&quot;CD&quot;</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905190, "post_id": 51397257, "comment_id": 89767087, "body": "@oliverbj - try to hard code it and see what happens - <code>ABHBooked = ABHdataFile.Sheets(&quot;Booked&quot;).Range(&quot;B5:CD10&quot;)</code>"}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905269, "post_id": 51397257, "comment_id": 89767136, "body": "Should I also include the <code>Cells(Rows.Count...</code> in this ?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905370, "post_id": 51397257, "comment_id": 89767195, "body": "@oliverbj - nope, just try the hard-coded values. If it works, try to include the stuff."}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 1, "creation_date": 1531905434, "post_id": 51397257, "comment_id": 89767228, "body": "When I just use <code>ABHBooked = ABHdataFile.Sheets(&quot;Booked&quot;).Range(&quot;B5:CD10&quot;)</code> it runs fine. <b>NO</b> Overflow error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905519, "post_id": 51397257, "comment_id": 89767285, "body": "@oliverbj - cool. Then change <code>CD10</code> to the real row number. Check what exactly <code>Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row</code> is returning, hardcode it and try again."}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905627, "post_id": 51397257, "comment_id": 89767356, "body": "So first like this? <code>ABHBooked = ABHdataFile.Sheets(&quot;Booked&quot;).Range(&quot;B5:CD5522&quot;)</code>? (CD5522 is the last row)."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905653, "post_id": 51397257, "comment_id": 89767381, "body": "@oliverbj - yes."}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905707, "post_id": 51397257, "comment_id": 89767428, "body": "If I hardcode <code>.Range(B5:CD5522)</code> it gives me <code>Overflow</code> error again"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905835, "post_id": 51397257, "comment_id": 89767509, "body": "@oliverbj - cool. Now write <code>Dim ABHBooked2 as Variant</code> on the top of the sub and use it like this - <code>ABHBooked2 = ABHdataFile.Sheets(&quot;Booked&quot;).Range(&quot;B5:CD5522&quot;)</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531905973, "post_id": 51397257, "comment_id": 89767609, "body": "@oliverbj - What are the values inside <code>B5:CD5522</code>?"}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531906004, "post_id": 51397257, "comment_id": 89767637, "body": "A lot of cells with dates, and the rest just text. The dates are formatted as custom: <code>dd-mm-yy hh:mm</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531906100, "post_id": 51397257, "comment_id": 89767698, "body": "@oliverbj - if you try it on a new excel, only this <code>ABHBooked = ABHdataFile.Sheets(&quot;Booked&quot;).Range(&quot;B5:CD5522&quot;)</code> would it work?"}, {"owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531906154, "post_id": 51397257, "comment_id": 89767727, "body": "No unfortunately not. However if I set <code>Range(&quot;B5:CD100&quot;)</code> it gives me error. As soon as I change it to <code>CD5522</code> it gives me the error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "edited": false, "score": 0, "creation_date": 1531906271, "post_id": 51397257, "comment_id": 89767814, "body": "@oliverbj - really, if you try in a completely new Excel file, it does not work again?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1531902927, "creation_date": 1531902927, "answer_id": 51397257, "question_id": 51396569, "link": "https://stackoverflow.com/questions/51396569/excel-vba-overflow-error-on-range-select/51397257#51397257", "title": "Excel VBA - Overflow error on Range select", "body": "<p>The function gives error whenever the ColumnNumber is less than 1. Thus, introduce a small check and it should work:</p>\n\n<pre><code>Function ColumnLetter(ColumnNumber As Long) As String\n    Dim n As Long\n    Dim c As Byte\n    Dim s As String\n\n    If ColumnNumber &lt; 1 Then\n        ColumnLetter = \"NAN\"\n        Exit Function\n    End If\n\n    n = ColumnNumber\n    Do\n        c = ((n - 1) Mod 26)\n        s = Chr(c + 65) &amp; s\n        n = (n - c) \\ 26\n    Loop While n &gt; 0\n    ColumnLetter = s\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "is_accepted": true, "score": 0, "last_activity_date": 1531910195, "creation_date": 1531910195, "answer_id": 51399848, "question_id": 51396569, "link": "https://stackoverflow.com/questions/51396569/excel-vba-overflow-error-on-range-select/51399848#51399848", "title": "Excel VBA - Overflow error on Range select", "body": "<p>The problem was not that my variable wasn't stored as <code>long</code>, but rather the format of my selection.</p>\n\n<p>This fixed the issue:</p>\n\n<pre><code>Selection.NumberFormat = \"General\u201d\n</code></pre>\n"}], "owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 51399848, "answer_count": 2, "score": 1, "last_activity_date": 1531910195, "creation_date": 1531900663, "last_edit_date": 1531905056, "question_id": 51396569, "link": "https://stackoverflow.com/questions/51396569/excel-vba-overflow-error-on-range-select", "title": "Excel VBA - Overflow error on Range select", "body": "<p>I am having an error when I try to select cells from a sheet:</p>\n\n<pre><code>  Dim ABHdataPath As String\n  Dim ABHdataFile As Excel.Workbook\n\n  ABHdataFile.Sheets(\"Booked\").Activate ' make sure program starts from correct sheet\n        ColumnName = ColumnLetter(ABHdataFile.Sheets(\"Booked\").Cells(5, Columns.Count).End(xlToLeft).Column)\n        ABHbooked = ABHdataFile.Sheets(\"Booked\").Range(\"B5:\" &amp; ColumnName &amp; Cells(Rows.Count, \"B\").End(xlUp).row).Value\n</code></pre>\n\n<p>When running above line, I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TymFY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TymFY.png\" alt=\"enter image description here\"></a></p>\n\n<p>It doesn't give me any option to debug the code, so I find it hard to locate the error.</p>\n\n<p><strong>EDIT</strong>\nI have been able to debug my code, this is where it ends:</p>\n\n<pre><code>ABHBooked = ABHdataFile.Sheets(\"Booked\").Range(\"B5:\" &amp; ColumnName &amp; Cells(Rows.Count, \"B\").End(xlUp).row).Value\n</code></pre>\n\n<p><strong>Debug:</strong></p>\n\n<blockquote>\n  <p>ABHBooked = Empty</p>\n  \n  <p>Rows.Count = 1048576</p>\n  \n  <p>xlUp = -4162</p>\n  \n  <p>ColumnName = CD</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "sum"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1531898493, "post_id": 51395634, "comment_id": 89762891, "body": "Can&#39;t you use SUMIFS?"}, {"owner": {"reputation": 3838, "user_id": 1033684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sKoNw.jpg?s=128&g=1", "display_name": "Rob Sedgwick", "link": "https://stackoverflow.com/users/1033684/rob-sedgwick"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531904809, "post_id": 51395634, "comment_id": 89766780, "body": "@SJR my thoughts too. A classic case where VBA is unnecessary and much slower than the inbuilt functions? See this link: <a href=\"https://www.ablebits.com/office-addins-blog/2014/11/12/excel-sumifs-sumif-multiple-criteria/\" rel=\"nofollow noreferrer\">ablebits.com/office-addins-blog/2014/11/12/&hellip;</a>"}, {"owner": {"reputation": 68, "user_id": 10097642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69aec64d435ce6dcb2fa6e18a47559e?s=128&d=identicon&r=PG&f=1", "display_name": "Ronio", "link": "https://stackoverflow.com/users/10097642/ronio"}, "edited": false, "score": 0, "creation_date": 1531979669, "post_id": 51395634, "comment_id": 89801588, "body": "i should use that, but i wanted to know, how to do it differently"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "is_accepted": false, "score": 0, "last_activity_date": 1531901868, "creation_date": 1531901868, "answer_id": 51396927, "question_id": 51395634, "link": "https://stackoverflow.com/questions/51395634/vba-suming-values-based-on-multiple-conditions/51396927#51396927", "title": "vba - suming values based on multiple conditions", "body": "<p>What about this? Hope, I didn't miss any of your original conditions:</p>\n\n<pre><code>Select Case Cells(Row, 2)\nCase \"0922\", \"09604\"\n    all = all + Cells(Row, 4)\nCase \"09223\", \"09224\"\n    voc = voc + Cells(Row, 4)\nCase \"0950\"\n    cvc = cvc + Cells(Row, 4)\nCase \"0113\"\n    Select Case Cells(Row, 3)\n       Case \"00164381\", \"42137004\"\n          ms1 = ms1 + Cells(Row, 4)\n       Case \"00164381\"\n          ms2 = ms2 + Cells(Row, 4)\n    End Select\nCase \"0980\"\n    Select Case Cells(Row, 3)\n        Case \"00164381\", \"42137004\"\n           ms1 = ms1 + Cells(Row, 4)\n        Case \"00151866\"\n           mv = mv + Cells(Row, 4)\n        Case \"00164348\", \"30807506\"\n            metped = metped + Cells(Row, 4)\n        Case \"31797857\", \"42134943\"\n            ssi = ssi + Cells(Row, 4)\n        Case \"30853923\"\n            nsc = nsc + Cells(Row, 4)\n        Case \"17314852\"\n           siov = siov + Cells(Row, 4)\n    End Select\nCase \"0810\"\n    Select Case Cells(Row, 3)\n        Case \"00164381\"\n            ms2 = ms2 + Cells(Row, 4)\n        Case \"30853923\"\n            nsc = nsc + Cells(Row, 4)\n        End Select\nCase \"0820\"\n    If Cells(Row, 3) = \"00164381\" Then\n        ms2 = ms2 + Cells(Row, 4)\n    End If\nEnd Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 0, "last_activity_date": 1531904543, "creation_date": 1531904543, "answer_id": 51397831, "question_id": 51395634, "link": "https://stackoverflow.com/questions/51395634/vba-suming-values-based-on-multiple-conditions/51397831#51397831", "title": "vba - suming values based on multiple conditions", "body": "<p>If by a more \"<strong>elegant solution</strong>\" you mean sucks less than: Yes, here is a more elegant solution.</p>\n\n<p>The idea is to write a function that will take 1 to 3 conditions and return a value if a matching value is found for each condition in the corresponding categories else the function will return 0. </p>\n\n<h2>getConditionalValue():Function</h2>\n\n<p>Returns a value if conditions are in Category values</p>\n\n<pre><code>Function getConditionalValue(value As Double, _\n                             Optional Condition1 As String, Optional Category1 As Variant, _\n                             Optional Condition2 As String, Optional Category2 As Variant, _\n                             Optional Condition3 As String, Optional Category3 As Variant) As Double\n\n    If Not IsMissing(Category1) Then If UBound(Filter(Category1, Condition1, True, vbBinaryCompare)) = -1 Then Exit Function\n    If Not IsMissing(Category2) Then If UBound(Filter(Category2, Condition2, True, vbBinaryCompare)) = -1 Then Exit Function\n    If Not IsMissing(Category3) Then If UBound(Filter(Category3, Condition3, True, vbBinaryCompare)) = -1 Then Exit Function\n\n    getConditionalValue = value\nEnd Function\n</code></pre>\n\n<h2>Refactored Loop</h2>\n\n<pre><code>Do Until Sheets(\"data\").Cells(row, 1).value = \"\"\n    all = all + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0922\", \"09604\"))\n\n    voc = voc + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"09223\", \"09224\"))\n\n    cvc = cvc + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0950\"))\n\n    ms1 = ms1 + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0113\", \"0980\"), _\n                                    Cells(row, 3), Array(\"00164381\", \"42137004\"))\n\n    ms2 = ms2 + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0133\", \"0810\", \"0820\"), _\n                                    Cells(row, 3), Array(\"00164381\"))\n\n    mv = mv + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0980\"), _\n                                  Cells(row, 3), Array(\"00151866\"))\n\n    metped = metped + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0980\"), _\n                                          Cells(row, 3), Array(\"00164348\", \"30807506\"))\n\n    ssi = ssi + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0980\"), _\n                                    Cells(row, 3), Array(\"31797857\", \"42134943\"))\n\n    nsc = nsc + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0810\", \"0980\"), _\n                                    Cells(row, 3), Array(\"30853923\"))\n\n    siov = siov + getConditionalValue(Cells(row, 4), Cells(row, 2).value, Array(\"0980\"), _\n                                      Cells(row, 3), Array(\"17314852\"))\nLoop\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 10097642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69aec64d435ce6dcb2fa6e18a47559e?s=128&d=identicon&r=PG&f=1", "display_name": "Ronio", "link": "https://stackoverflow.com/users/10097642/ronio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 51397831, "answer_count": 2, "score": 1, "last_activity_date": 1531904543, "creation_date": 1531897661, "question_id": 51395634, "link": "https://stackoverflow.com/questions/51395634/vba-suming-values-based-on-multiple-conditions", "title": "vba - suming values based on multiple conditions", "body": "<p>I would like to write a function, which will sums values based on multiple criteria. Here is my attempt, but I realized, I cannot use same value multiple times for \u201ccase\u201d procedure.</p>\n\n<p>I could separate every sum value to different function, but I will need like 40 sums values.( 3 different categories of conditions, from every category sometimes you use one condition, sometimes multiple)\nDo you have any better ideas or elegant solution?</p>\n\n<p>Thank you</p>\n\n<pre><code>Function suma_data() As Variant\nDim row As Integer\nrow = 2\nDim returnVals(10) As Double\nDim all As Double\nDim voc As Double\nDim cvc As Double\nDim ms1 As Double\nDim ms2 As Double\nDim mv As Double\nDim metped As Double\nDim ssi As Double\nDim nsc As Double\nDim siov As Double\n\n\nSheets(\"data\").Select\nDo Until Sheets(\"data\").Cells(row, 1).Value = \"\"\n    Select Case Cells(row, 2).Value\n        Case Is = \"0922\", \"09604\"\n           all = all + Cells(row, 4)\n        Case Is = \"09223\", \"09224\"\n            voc = voc + Cells(row, 4)\n        Case Is = \"0950\"\n            cvc = cvc + Cells(row, 4)\n        Case Is = \"0113\", \"0980\"\n            If Cells(row, 3) = \"00164381\" Or Cells(row, 3) = \"42137004\" Then\n                ms1 = ms1 + Cells(row, 4)\n            End If\n        Case Is = \"0133\", \"0810\", \"0820\"\n            If Cells(row, 3) = \"00164381\" Then\n                ms2 = ms2 + Cells(row, 4)\n        Case Is = \"0980\"\n            If Cells(row, 3) = \"00151866\" Then\n                mv = mv + Cells(row, 4)\n            End If\n        Case Is = \"0980\"\n            If Cells(row, 3) = \"00164348\" Or Cells(row, 3) = \"30807506\" Then\n                metped = metped + Cells(row, 4)\n            End If\n        Case Is = \"0980\"\n            If Cells(row, 3) = \"31797857\" Or Cells(row, 3) = \"42134943\" Then\n                ssi = ssi + Cells(row, 4)\n            End If\n        Case Is = \"0810\", \"0980\"\n            If Cells(row, 3) = \"30853923\" Then\n                nsc = nsc + Cells(row, 4)\n            End If\n        Case Is = \"0980\"\n            If Cells(row, 3) = \"17314852\" Then\n                siov = siov + Cells(row, 4)\n            End If\n\n    End Select\n    row = row + 1\nLoop\nreturnVals(1) = all\nreturnVals(2) = voc\nreturnVals(3) = cvc\nreturnVals(4) = ms1\nreturnVals(5) = ms2\nreturnVals(6) = mv\nreturnVals(7) = metped\nreturnVals(8) = ssi\nreturnVals(9) = nsc\nreturnVals(10) = siov\nsuma_data = returnVals\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531897589, "post_id": 51395151, "comment_id": 89762277, "body": "Just use the <a href=\"https://support.office.com/en-us/article/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7\" rel=\"nofollow noreferrer\">Text to Columns Wizard</a> to split text by comma into columns."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1531917670, "post_id": 51395151, "comment_id": 89775278, "body": "To return just the <code>suburb, postcode</code>, you should be extracting the data after the last comma.  You can use:  <code>TRIM(RIGHT(SUBSTITUTE(A1,&quot;,&quot;,REPT(&quot; &quot;,99)),99))</code> for that.  But to split the address into all the relevant segments, you will need to split on the comma, and then apply logic to each segment to determine whether it is a <code>Street Number</code>, <code>Street Name</code>, etc.  That is probably best done using VBA, since you seem to have much variation in your data. You may also need a lookup table to validate some of the data."}], "answers": [{"tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1531903802, "creation_date": 1531903802, "answer_id": 51397551, "question_id": 51395151, "link": "https://stackoverflow.com/questions/51395151/extract-from-string-delimited-by-one-or-more-commas/51397551#51397551", "title": "Extract from string delimited by one or more commas", "body": "<p>So, just to show a method using functions while Peh shows a better method:</p>\n\n<p><a href=\"https://i.stack.imgur.com/57XUj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/57XUj.png\" alt=\"enter image description here\"></a></p>\n\n<p>The trim() removes leading or trailing spaces,\nThe +1 is to not pick up the comma after the find() gets its position.</p>\n\n<p>By using find() to drive a second find() you can split out all of the parts, but it gets cumbersome... Left for you to try...</p>\n"}], "owner": {"reputation": 1, "user_id": 9785847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44353d9b9db71043e8bcaca37f95724a?s=128&d=identicon&r=PG&f=1", "display_name": "Bardia.Alavi", "link": "https://stackoverflow.com/users/9785847/bardia-alavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3574, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610887550, "creation_date": 1531896031, "last_edit_date": 1610887550, "question_id": 51395151, "link": "https://stackoverflow.com/questions/51395151/extract-from-string-delimited-by-one-or-more-commas", "title": "Extract from string delimited by one or more commas", "body": "<p>I am trying to extract text after the first comma and potentially the remaining commas.</p>\n<p>My text is addresses and some have lot numbers, units numbers ... I don't need.<br />\nI compare my addresses to a database with a specific format.</p>\n<p>For example: <em>37 neptune Street, REVESBY NSW 2212</em></p>\n<p>The formula:</p>\n<pre><code>=RIGHT(B2,FIND(&quot;,&quot;,B2,1)-1) \n</code></pre>\n<p>returns <em>REVESBY NSW 2212</em>. This is what I want.</p>\n<p>If I have <em>LADY GOWRIE CHILD CARE CENTRE, Ground Floor 1, 16 Spears Drive, DUBBO NSW 2830</em>.<br />\nI get <em>Spears Drive, DUBBO NSW 2830</em>.<br />\nThe formula is giving me everything to right of the second comma.</p>\n<p>I want to extract data separately before each comma. So I can have <em>Street Number</em>, <em>Street Name</em>, <em>suburb</em>, <em>Post Code</em>.</p>\n<p>My data for every cell is a bit different.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10074714, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pwm5t2dLhJI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5dl7NFqc2ftA6bKjKkYg9ju4loA/mo/photo.jpg?sz=128", "display_name": "Flow", "link": "https://stackoverflow.com/users/10074714/flow"}, "edited": false, "score": 0, "creation_date": 1531896558, "post_id": 51395060, "comment_id": 89761660, "body": "I was not aware of that functionality! Many thanks, it fixed it!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 5, "last_activity_date": 1531895700, "creation_date": 1531895700, "answer_id": 51395060, "question_id": 51394908, "link": "https://stackoverflow.com/questions/51394908/delete-header-row-of-csv-import-after-first-import/51395060#51395060", "title": "Delete header row of CSV import after first import", "body": "<p>You need to add one of the properties that the macro recorder does not auto-magically include. The <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/querytable-textfilestartrow-property-excel\" rel=\"noreferrer\">QueryTable.TextFileStartRow Property </a> allows you to skip a number of rows at the top of the text file.</p>\n\n<p>This may be best passed in as a parameter.</p>\n\n<pre><code>...\nR = 1\nFName = Dir(\"C:\\VBA\\CSVs\\*.csv\")\nDo While FName &lt;&gt; \"\"\n    ImportCsvFile FName, Sheets(\"CSV data\").Cells(R, 1), abs(r&lt;&gt;1)+1\n    R = Sheets(\"CSV data\").UsedRange.Rows.Count + 1\n    FName = Dir\nLoop\n\nSub ImportCsvFile(FileName As Variant, Position As Range, startRow as long)\n  With Sheets(\"CSV data\").QueryTables.Add(Connection:= _\n      \"TEXT;\" &amp; \"C:\\VBA\\CSVs\\\" &amp; FileName, Destination:=Position)\n      .TextFileStartRow = startRow   '&lt;~~ new parameter\n      .FieldNames = True\n      .RowNumbers = False\n      .FillAdjacentFormulas = False\n      .RefreshOnFileOpen = False\n      .BackgroundQuery = True\n      .RefreshStyle = xlInsertDeleteCells\n      .SavePassword = False\n      .SaveData = True\n      .AdjustColumnWidth = True\n      .TextFilePromptOnRefresh = False\n      .TextFilePlatform = xlMacintosh\n      .TextFileStartRow = 1\n      .TextFileParseType = xlDelimited\n      .TextFileTextQualifier = xlTextQualifierDoubleQuote\n      .TextFileConsecutiveDelimiter = False\n      .TextFileTabDelimiter = True\n      .TextFileSemicolonDelimiter = False\n      .TextFileCommaDelimiter = False\n      .TextFileSpaceDelimiter = False\n      .TextFileOtherDelimiter = \",\"\n      .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n      .Refresh BackgroundQuery:=False\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10074714, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pwm5t2dLhJI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5dl7NFqc2ftA6bKjKkYg9ju4loA/mo/photo.jpg?sz=128", "display_name": "Flow", "link": "https://stackoverflow.com/users/10074714/flow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51395060, "answer_count": 1, "score": 2, "last_activity_date": 1531895700, "creation_date": 1531895080, "question_id": 51394908, "link": "https://stackoverflow.com/questions/51394908/delete-header-row-of-csv-import-after-first-import", "title": "Delete header row of CSV import after first import", "body": "<p>I have been working on getting a piece of code, which is working and imports all CSV files from a given directory. </p>\n\n<pre><code>Sub ImportAllCsv()\n  Dim FName As Variant, R As Long\n\n  Application.DisplayAlerts = False\n    On Error Resume Next\n  ThisWorkbook.Sheets(\"CSV data\").Delete\n    On Error GoTo 0\n  Application.DisplayAlerts = True\n  ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"CSV data\"\n\n  R = 1\n  FName = Dir(\"C:\\VBA\\CSVs\\*.csv\")\n  Do While FName &lt;&gt; \"\"\n    ImportCsvFile FName, Sheets(\"CSV data\").Cells(R, 1)\n    R = Sheets(\"CSV data\").UsedRange.Rows.Count + 1\n    FName = Dir\n\n  Loop\nEnd Sub\n\nSub ImportCsvFile(FileName As Variant, Position As Range)\n  With Sheets(\"CSV data\").QueryTables.Add(Connection:= _\n      \"TEXT;\" &amp; \"C:\\VBA\\CSVs\\\" &amp; FileName, Destination:=Position)\n      .FieldNames = True\n      .RowNumbers = False\n      .FillAdjacentFormulas = False\n      .RefreshOnFileOpen = False\n      .BackgroundQuery = True\n      .RefreshStyle = xlInsertDeleteCells\n      .SavePassword = False\n      .SaveData = True\n      .AdjustColumnWidth = True\n      .TextFilePromptOnRefresh = False\n      .TextFilePlatform = xlMacintosh\n      .TextFileStartRow = 1\n      .TextFileParseType = xlDelimited\n      .TextFileTextQualifier = xlTextQualifierDoubleQuote\n      .TextFileConsecutiveDelimiter = False\n      .TextFileTabDelimiter = True\n      .TextFileSemicolonDelimiter = False\n      .TextFileCommaDelimiter = False\n      .TextFileSpaceDelimiter = False\n      .TextFileOtherDelimiter = \",\"\n      .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n      .Refresh BackgroundQuery:=False\n  End With\nEnd Sub\n</code></pre>\n\n<p>This piece of code works, however one thing I cannot seem to get implemented is to get rid of the header row of all CSV files <strong>EXCEPT</strong> the first imported CSV.</p>\n\n<p><strong>Expected result</strong> </p>\n\n<p>Get the code to exclude the header rows for all the CSV files that are imported after the first file. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531895334, "post_id": 51394833, "comment_id": 89761073, "body": "You&#39;re asking us how you are going to do it? What have you tried?"}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "is_accepted": true, "score": 0, "last_activity_date": 1532423578, "creation_date": 1532423578, "answer_id": 51494848, "question_id": 51394833, "link": "https://stackoverflow.com/questions/51394833/cut-certain-range-in-a-row-and-insert-below-the-same-row/51494848#51494848", "title": "Cut certain range in a row and insert below the same row", "body": "<p>I found my answer after a few days later of trial and error. Hopefully it can help others. Thank you.</p>\n\n<pre><code>Sub Test()\nFor i = 2 To 1000\n\n\n   If ThisWorkbook.Worksheets(3).Cells(i, 2) = \"\" Then\n   Exit For\n   End If\n\n    For j = 7 To 1000 Step 4\n\n\n        If ThisWorkbook.Worksheets(3).Cells(i, j).Value = \"\" Then\n            Exit For\n            Else\n            ThisWorkbook.Worksheets(3).Cells(i, j).Resize(, 8).Cut\n            i = i + 1\n            ThisWorkbook.Worksheets(3).Range(\"A\" &amp; i).Insert xlShiftDown\n            End If\n\n            Next\n\n       Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 51494848, "answer_count": 1, "score": -2, "last_activity_date": 1551390110, "creation_date": 1531894735, "last_edit_date": 1551390110, "question_id": 51394833, "link": "https://stackoverflow.com/questions/51394833/cut-certain-range-in-a-row-and-insert-below-the-same-row", "title": "Cut certain range in a row and insert below the same row", "body": "<p>My Excel raw data.</p>\n\n<pre><code>        A   B   C   D   E   F\n   1.   A1  B1  C1      E1  F1\n   2.   A2  B2  C2      E2  F2\n   3.   A3  B3  C3      E3  F3\n   4.   A4  B4  C4      E4  F4\n</code></pre>\n\n<p>I want to cut E1 and F1 then insert it below the same line.</p>\n\n<p>The output should be as per below.</p>\n\n<pre><code>        A   B   C   D   E   F\n   1.   A1  B1  C1      \n   2.   E1  F1\n   3.   A2  B2  C2\n   4.   E2  F2  \n   5.   A3  B3  C3\n   6.   E3  F3\n   7.   A4  B4  C4\n   8.   E4  F4\n</code></pre>\n"}, {"tags": ["vba", "excel", "datepicker", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1531895514, "post_id": 51394765, "comment_id": 89761158, "body": "Did you try something like <code>Me.DATE1.Text = dateVariable</code> ?  You might need some formatting depending on how the value is returned from the date picker"}, {"owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531895705, "post_id": 51394765, "comment_id": 89761240, "body": "holy night!!! You are amazing!!! one simple line... Thank you so very much!!!!!! That just save me a mountain of headache!"}], "owner": {"reputation": 45, "user_id": 10097577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b874019a90f4f51a0e4e89ebc64a193f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roy", "link": "https://stackoverflow.com/users/10097577/daniel-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531894498, "creation_date": 1531894498, "question_id": 51394765, "link": "https://stackoverflow.com/questions/51394765/filling-a-text-box-inside-of-a-userform-from-a-date-picker-form", "title": "Filling a text box inside of a userform from a date picker form", "body": "<p>So i have a userform named NEW1 and in it i have a text box named DATE1. </p>\n\n<p>In NEW1 i have a small control that opens a date picker. From this picker I need the date i select to populate the text box. This is the code i have so far.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    dateVariable = CalendarForm.GetDate( _\n        SelectedDate:=Range(\"H34\").value, _\n        FirstDayOfWeek:=Monday, _\n        DateFontSize:=12, _\n        TodayButton:=True, _\n        OkayButton:=True, _\n        ShowWeekNumbers:=False, _\n        BackgroundColor:=RGB(243, 249, 251), _\n        HeaderColor:=RGB(147, 205, 2221), _\n        HeaderFontColor:=RGB(255, 255, 255), _\n        SubHeaderColor:=RGB(223, 240, 245), _\n        SubHeaderFontColor:=RGB(31, 78, 120), _\n        DateColor:=RGB(243, 249, 251), _\n        DateFontColor:=RGB(31, 78, 120), _\n        TrailingMonthFontColor:=RGB(155, 194, 230), _\n        DateHoverColor:=RGB(223, 240, 245), _\n        DateSelectedColor:=RGB(202, 223, 242), _\n        SaturdayFontColor:=RGB(0, 176, 240), _\n        SundayFontColor:=RGB(0, 176, 240), _\n        TodayFontColor:=RGB(0, 176, 80))\n        If dateVariable &lt;&gt; 0 Then Range(\"B5\") = dateVariable\n\nEnd Sub\n</code></pre>\n\n<p>so the calendar function does what it needs to, the part i need to change is the last string where it targets B5. It needs to target userform NEW1 and text box DATE1 to populate the text box DATE1.</p>\n\n<p>please help!!!!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531897615, "post_id": 51394095, "comment_id": 89762299, "body": "If you open a multi-page report in print preview, it is never finished, until you go to the last page. -- I&#39;d simply use <a href=\"https://stackoverflow.com/questions/469347/is-there-an-equivalent-to-thread-sleep-in-vba\">Sleep</a>."}, {"owner": {"reputation": 135, "user_id": 3954806, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5270c19b74e547dde6bc845f86e29225?s=128&d=identicon&r=PG&f=1", "display_name": "CurtisD", "link": "https://stackoverflow.com/users/3954806/curtisd"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531898561, "post_id": 51394095, "comment_id": 89762925, "body": "I don&#39;t really want to open the report in print preview.  It could be hidden or in the background.  I simply want the report to close after the last item is printed.  Is there a way to do that?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1531900367, "post_id": 51394095, "comment_id": 89763966, "body": "Then print to <a href=\"https://stackoverflow.com/questions/313111/is-there-a-dev-null-on-windows\">NUL</a> or a PDF printer driver. -- Perhaps if you&#39;d explain <i>why</i> you want to do this, we could give better ideas."}, {"owner": {"reputation": 135, "user_id": 3954806, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5270c19b74e547dde6bc845f86e29225?s=128&d=identicon&r=PG&f=1", "display_name": "CurtisD", "link": "https://stackoverflow.com/users/3954806/curtisd"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531901238, "post_id": 51394095, "comment_id": 89764452, "body": "OK.  The report contains VBA code that writes data to a file (in addition to printing a report).  This report has been run hundreds of times and has created a very large file, because each time it runs more data gets added to the file.  That file was accidentally deleted.  I would now like to programmatically run that report so that it will run all those previous reports again.  I can do that in a loop using some VBA code, but I need to return to that VBA code after each running of the report.  So I need to close the report as soon as it has printed."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1531901685, "post_id": 51394095, "comment_id": 89764734, "body": "Then NUL should work perfectly. Set up a dummy printer in Windows that prints to NUL, and assign this printer to the report. And open the report with <code>acViewNormal</code>."}, {"owner": {"reputation": 135, "user_id": 3954806, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5270c19b74e547dde6bc845f86e29225?s=128&d=identicon&r=PG&f=1", "display_name": "CurtisD", "link": "https://stackoverflow.com/users/3954806/curtisd"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1531902541, "post_id": 51394095, "comment_id": 89765239, "body": "All right!  That was the solution.  I did not realize that acViewNormal resulted in the closing of the report.  Thank you so much!"}], "owner": {"reputation": 135, "user_id": 3954806, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5270c19b74e547dde6bc845f86e29225?s=128&d=identicon&r=PG&f=1", "display_name": "CurtisD", "link": "https://stackoverflow.com/users/3954806/curtisd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531891263, "creation_date": 1531891263, "question_id": 51394095, "link": "https://stackoverflow.com/questions/51394095/access-2007-programmatically-run-report-multiple-times", "title": "Access 2007 - Programmatically Run Report Multiple Times", "body": "<p>I am using Access 2007.  I want to use VBA code that will programmatically\nrun an Access Report a series of times.  Something like this:</p>\n\n<pre><code>Dim eid$(5)\neid$(1)=\"001\":eid$(2)=\"021\":eid$(3)=\"043\":eid$(4)=\"052\":eid$(5)=\"067\"\nfor i=1 to 5\n   Forms![frmWork]!txtEid=eid$(i)\n   DoCmd.OpenReport \"rptEmployees\", acViewPreview\nnext i\n</code></pre>\n\n<p>The report uses a query that contains:</p>\n\n<pre><code>WHERE (employee.eid)=Forms![frmWork]!txtEid\n</code></pre>\n\n<p>After the report appears on the screen I want it to immediately close - without the user\nclicking Close Print Preview - and return to the VBA loop so another report can be generated.</p>\n\n<p>You may wonder why I'm doing this?  Let's just say I'm experimenting.</p>\n\n<p>My question is...how can I get the report to close?  Is there an event that occurs\nwhen a report has finished printing?  </p>\n\n<p>If I knew how many records (n) were output by the query I could put a counter\nin the report's Detail_Print() code.  When the counter reached n I could have the report close.\nCan I determine how many records are in the query results when the report opens?</p>\n\n<p>Thanks very much.</p>\n"}]