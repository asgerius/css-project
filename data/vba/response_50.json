[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1450908840, "creation_date": 1450908840, "answer_id": 34444539, "question_id": 34444480, "link": "https://stackoverflow.com/questions/34444480/excel-vba-to-open-a-file-using-range-as-the-directory/34444539#34444539", "title": "Excel Vba to open a file using .range as the directory", "body": "<pre><code>Workbooks.Open Filename:=\"C:\\WORK\\\" &amp; Range(\"A1\").Value &amp; \"\\fileexample.xlsx\"\n</code></pre>\n\n<p>FYI you don't need to use <code>ChDir</code> if you're passing the full file path to <code>Open</code></p>\n"}], "owner": {"reputation": 73, "user_id": 4080275, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b2aa482e32ecdfe20163e8a48caae2a7?s=128&d=identicon&r=PG&f=1", "display_name": "tim", "link": "https://stackoverflow.com/users/4080275/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2092, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1451506784, "creation_date": 1450908525, "question_id": 34444480, "link": "https://stackoverflow.com/questions/34444480/excel-vba-to-open-a-file-using-range-as-the-directory", "title": "Excel Vba to open a file using .range as the directory", "body": "<p>I have a macro that needs to open files but the problem is everyday it is in a new folder labeled according to the day. Example today would be C:\\WORK\\122315\\fileexample.xlsx</p>\n\n<p>How I usually open files with dates is by entering the date in cell A1 as a TEXT \"122315\" then use Date1 = Range(\"A1\").Value in vba. My question is what do I do if the date is not in the file, but in the subfolder?</p>\n\n<pre><code>    Date1 = Range(\"A1\").Value\n\n    ChDir \"C:\\WORK\\Date1\"\n    Workbooks.Open Filename:= _\n    \"C:\\WORK\\Date1\\fileexample.xlsx\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1450910789, "post_id": 34444416, "comment_id": 56631618, "body": "How does column A get populated?"}, {"owner": {"reputation": 23, "user_id": 5606531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153315196568175/picture?type=large", "display_name": "kya", "link": "https://stackoverflow.com/users/5606531/kya"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1450912160, "post_id": 34444416, "comment_id": 56632081, "body": "The number of rows in column A per unique &#39;User ID&#39; is determined by the number of trials each user completed in a task.  Each user completed a variable number of trials.  (For purposes of clarity I have omitted a set of columns which reflect unique trial data)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5606531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153315196568175/picture?type=large", "display_name": "kya", "link": "https://stackoverflow.com/users/5606531/kya"}, "edited": false, "score": 0, "creation_date": 1450924182, "post_id": 34445050, "comment_id": 56635017, "body": "This worked perfectly. Thanks for the elegant, well-commented solution.  (The only adjustment that I had to make was to change A2 to A1 in the tempRange definition, otherwise an out-of-index error was thrown when rowEnd = lastRow)."}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 0, "last_activity_date": 1450911860, "creation_date": 1450911860, "answer_id": 34445050, "question_id": 34444416, "link": "https://stackoverflow.com/questions/34444416/fill-blank-cells-above-and-below-based-on-a-condition-in-another-column/34445050#34445050", "title": "Fill blank cells above and below based on a condition in another column", "body": "<p>Perhaps try something like the below?</p>\n\n<pre><code>Sub FillValues()\n\n    Dim tempRange As Range, tempArray As Variant, rowStart As Long, rowEnd As Long, lastRow As Long, lastCol As Long\n    Dim i As Long, j As Long, tempValue As Variant\n\n    ' The assumption is that we are starting in row 2, and go as far down as there are cells in Column A\n    ' Also that we are using Column A as a reference.\n    ' So we start by getting this range and assigning it to our variable.\n    lastRow = Range(\"A\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\n    lastCol = ActiveSheet.UsedRange.Columns.Count\n    Set tempRange = Intersect(ActiveSheet.UsedRange, Range(\"A2:A\" &amp; lastRow).EntireRow)\n\n    ' We are going to assume that we are not concerned about pasting formats etc.\n    '(If we are concerned with that, we would need to change our code)\n    'Set the tempArray to be this range that we acquired above.\n    tempArray = tempRange.Value\n\n    rowStart = 1\n    While rowStart &lt;= lastRow\n\n        rowEnd = rowStart\n\n        ' First get the rows we are going to be looking at\n        ' Keep iterating rowEnd until we find a new value, or we reach the end\n        While tempArray(rowEnd, 1) = tempArray(rowStart, 1) And rowEnd &lt; lastRow\n            rowEnd = rowEnd + 1\n        Wend\n        ' If we did reach a new value, go back one to get the real row range.\n        If Not tempArray(rowEnd, 1) = tempArray(rowStart, 1) Then rowEnd = rowEnd - 1\n\n        ' Now that we have a range, we loop over the row range and column range.\n\n        ' For each column\n        For j = 2 To lastCol\n\n            ' Cycle through the rows to find an acceptable value\n            tempValue = \"\"\n            For i = rowStart To rowEnd\n                If Not Len(tempArray(i, j)) = 0 Then tempValue = tempArray(i, j): Exit For\n            Next i\n\n            ' If we found a value, populate the whole section accordingly\n            If Not Len(tempValue) = 0 Then\n                For i = rowStart To rowEnd\n                    tempArray(i, j) = tempValue\n                Next i\n            End If\n\n        Next j\n\n        ' After we did this for each column, we now need to iterate to the next section\n        rowStart = rowEnd + 1\n\n    Wend\n\n    ' Finally we put the new data back into the sheet\n    tempRange = tempArray\n\n    ' And clear the variables\n    Set tempRange = Nothing: Set tempArray = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5606531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153315196568175/picture?type=large", "display_name": "kya", "link": "https://stackoverflow.com/users/5606531/kya"}, "edited": false, "score": 0, "creation_date": 1450917611, "post_id": 34445104, "comment_id": 56633612, "body": "Apologies, in my effort to be simple and generalizable, I believe I have been confusing.  The values that I&#39;ve described (id_value1, b_value2, *_value*, etc.) refer to variables (all integers, except id_value), not string literals. Also in my specific case, the actual columns in question range from I:KX. Again, I was trying to be generalizable, which may have been ultimately unhelpful.  Your input is very much appreciated though, I&#39;m glad for help from the stackoverflow wizard of VBA!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1450912552, "last_edit_date": 1450912552, "creation_date": 1450912228, "answer_id": 34445104, "question_id": 34444416, "link": "https://stackoverflow.com/questions/34444416/fill-blank-cells-above-and-below-based-on-a-condition-in-another-column/34445104#34445104", "title": "Fill blank cells above and below based on a condition in another column", "body": "<p>This simple formula fill with a subsequent reversion from formula to value should suffice.</p>\n\n<pre><code>Sub blah()\n    With Worksheets(\"Sheet7\")\n        With .Cells(1, 1).CurrentRegion\n            If CBool(Application.CountBlank(.Cells)) Then\n                With .Cells.SpecialCells(xlCellTypeBlanks)\n                    .FormulaR1C1 = _\n                      \"=LOWER(SUBSTITUTE(RC1, \"\"id_\"\", SUBSTITUTE(ADDRESS(1, COLUMN(), 4, 1) &amp; CHAR(95), 1, \"\"\"\")))\"\n                End With\n            End If\n            .Cells = .Cells.Value\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>I hope that your actual data follows the pattern exhibited by your sample data.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/YoUUd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YoUUd.png\" alt=\"zz_value4\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 5606531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153315196568175/picture?type=large", "display_name": "kya", "link": "https://stackoverflow.com/users/5606531/kya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1429, "favorite_count": 0, "accepted_answer_id": 34445050, "answer_count": 2, "score": 2, "last_activity_date": 1450913110, "creation_date": 1450908222, "last_edit_date": 1495541747, "question_id": 34444416, "link": "https://stackoverflow.com/questions/34444416/fill-blank-cells-above-and-below-based-on-a-condition-in-another-column", "title": "Fill blank cells above and below based on a condition in another column", "body": "<p>I have the following columns and values:</p>\n\n<pre><code>User ID     Input B    Input C    Input D     ...   Input ZZ\n\nid_value1              c_value1                     \nid_value1                                          \nid_value1                         d_value1          zz_value1\nid_value1   b_value1                                \nid_value2   b_value2                                \nid_value2                                           zz_value2\nid_value2              c_value2   d_value2          \nid_value2                                           \nid_value2                                           \nid_value3              c_value3                     \nid_value3   b_value3              d_value3          zz_value3\nid_value4                                           \nid_value4   b_value4                                        \nid_value4                                           zz_value4\nid_value4              c_value4   d_value4\nid_value4                      \n</code></pre>\n\n<p>And I want to achieve the following:</p>\n\n<pre><code>User ID     Input B    Input C    Input D     ...   Input ZZ\n\nid_value1   b_value1   c_value1   d_value1          zz_value1\nid_value1   b_value1   c_value1   d_value1          zz_value1\nid_value1   b_value1   c_value1   d_value1          zz_value1\nid_value1   b_value1   c_value1   d_value1          zz_value1\nid_value1   b_value1   c_value1   d_value1          zz_value1\nid_value2   b_value2   c_value2   d_value2          zz_value2\nid_value2   b_value2   c_value2   d_value2          zz_value2\nid_value2   b_value2   c_value2   d_value2          zz_value2\nid_value2   b_value2   c_value2   d_value2          zz_value2\nid_value2   b_value2   c_value2   d_value2          zz_value2\nid_value3   b_value3   c_value3   d_value3          zz_value3\nid_value3   b_value3   c_value3   d_value3          zz_value3\nid_value4   b_value4   c_value4   d_value4          zz_value4\nid_value4   b_value4   c_value4   d_value4          zz_value4\nid_value4   b_value4   c_value4   d_value4          zz_value4\nid_value4   b_value4   c_value4   d_value4          zz_value4\nid_value4   b_value4   c_value4   d_value4          zz_value4\n</code></pre>\n\n<p>The goal is this:</p>\n\n<p>Within each set of rows with the same value in column A (these rows are contiguous), use the single instances of values present in columns B:ZZ to fill any blank cells in those columns both up and down. </p>\n\n<p>Put another way, for any value in columns B:ZZ, fill that value both up and down until the value in column A changes. </p>\n\n<p>Put yet another way, for any blank cell, find a nonblank cell above or below with a matching value in rc1 and take that cell's value.</p>\n\n<p>My pseudocode approach would be as follows:</p>\n\n<pre><code>for each blankcell:\n    find nonblank above\n    if nonblank.rc1 == blankcell.rc1:\n       blankcell == nonblank\n    else find nonblank below\n    if nonblank.rc1 == blankcell.rc1:\n       blankcell == nonblank\n    else do nothing\n</code></pre>\n\n<p>This seems relatively straightforward, but I don't know how to implement it in VBA. </p>\n\n<p>I've been trying to tinker with <a href=\"https://stackoverflow.com/a/30009534\">@Jeeped's code</a> for solving a similar problem, but haven't been successful.</p>\n\n<pre><code>Private Sub FillColBlanksSpecial2()\n\n    Dim wks As Worksheet\n    Dim rng As Range\n    Dim rng2 As Range\n    Dim blnk As Range\n    Dim LastRow As Long\n    Dim col As Long\n    Dim lRows As Long\n    Dim lLimit As Long\n\n    Dim lCount As Long\n    On Error Resume Next\n\n    lRows = 2\n    lLimit = 1000\n\n    Set wks = ActiveSheet\n        With wks\n            With .Cells(1, 1).CurrentRegion\n                With .Columns(\"B:ZZ\")\n                    If CBool(Application.CountBlank(.Cells)) Then\n                        For Each blnk In .SpecialCells(xlCellTypeBlanks)\n                            blnk.FormulaR1C1 = \"=if(countifs(r1c1:r[-1]c1, rc1, r1c:r[-1]c, \"\"&lt;&gt;\"\"), index(r1c:r[-1]c, match(rc1, r1c1:r[-1]c2, 0)), if(countifs(r[1]c1:r9999c1, rc1, r[1]c:r9999c, \"\"&lt;&gt;\"\"), index(r[1]c:r9999c, min(index(row(r:r9998)-row(r[-1])+((r[1]c1:r9999c1&lt;&gt;rc1)+not(len(r[1]c:r9999c)))*1e+99, , ))), r[-1]c))\"\n\n                            blnk.Value = blnk.Value\n                        Next blnk\n                    End If\n                End With\n            End With\n        End With\nEnd Sub\n</code></pre>\n\n<p>As I understand it, this code fills upwards based on the value in column A, but downwards until it finds any new value (not dependent on the column A condition). I'm also hesitant to employ the code as I don't have an understanding of the logic of the min() function.</p>\n\n<p>Any insight in to how to implement my pseudocode approach or any alternative approach would be greatly appreciated.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450908484, "post_id": 34444399, "comment_id": 56630740, "body": "What&#39;s happening when you run it?  you don&#39;t really explain the problem you are having. Looks like you need a <code>with</code> and <code>end with</code> statement."}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450909208, "post_id": 34444399, "comment_id": 56631017, "body": "It highlights &quot;TextFrame&quot; and says &quot;Method or data member not found&quot;"}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450909522, "post_id": 34444399, "comment_id": 56631159, "body": "<code>Sub Font()          With ActivePresentation            With .TextFrame.TextRange.Font              .Size = 48              .Name = &quot;Bauhaus 93&quot;              .Bold = True               .Color.RGB = RGB(255, 127, 255)                End With           End With     End Sub</code>"}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450909590, "post_id": 34444399, "comment_id": 56631185, "body": "^ the above code using <code>with</code> and <code>end with</code> had the same issue as well."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450910226, "post_id": 34444399, "comment_id": 56631414, "body": "What &quot;same issues&quot; ?  What error are you getting ?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450919120, "post_id": 34445810, "comment_id": 56633999, "body": "when I ran the code this time, it says &quot;the specified value is out of range&quot; then highlights the line &quot;With shp.TextFrame.TextRange.Font&quot;. Any ideas? I also don&#39;t know what you mean with the Type 14 and placeholder stuff - could you please explain? Sorry, I just was introduced to VBA today so don&#39;t really know terms yet."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450919898, "post_id": 34445810, "comment_id": 56634178, "body": "Did you copy and paste my entire code (plus the darn &#39;End Sub&#39; that fell outside)? If not, then you must either do that or show the EXACT code you are now trying to use. Re the &#39;Type 14&#39; comment, your code was looping through EVERY control on the slide - not just text -- so some &#39;shapes&#39; may not have a &#39;Text&#39; property. In the line &#39;If shp.Type = msoPlaceholder Then&#39; that is checking the shape type for a type of 14 (which equates to msoPlaceholder). Possibly there are other shape types that have a font you want to change, which means you need to also check for those types as well."}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450922017, "post_id": 34445810, "comment_id": 56634609, "body": "I did copy and paste the entire code (including the &#39;End Sub&#39; that fell outside). The deck which I am using right now has not special shapes. It&#39;s just 4 white slides with 3 random sentences on each slide. I wanted to keep it super simple right now as I test out different codes. But thank you for explaining the Type comment - that will definitely be useful as I progress."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450922587, "post_id": 34445810, "comment_id": 56634708, "body": "Based upon another post I found (<a href=\"http://stackoverflow.com/questions/18715951/run-time-error-1004-the-specified-value-is-out-of-range\" title=\"run time error 1004 the specified value is out of range\">stackoverflow.com/questions/18715951/&hellip;</a>) you can try inserting line &quot;On Error Resume Next&quot; just before the &quot;With...&quot; and see what happens. I will keep looking... Is there only one shape on the slide? That can cause it..."}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1450917770, "creation_date": 1450917770, "answer_id": 34445810, "question_id": 34444399, "link": "https://stackoverflow.com/questions/34444399/using-vba-in-powerpoint-to-change-font/34445810#34445810", "title": "Using VBA in PowerPoint to change font", "body": "<p>The code below should work. Note that your original didn't test the 'Type' of shape, or as @Tim pointed out, you were missing the 'With ...'</p>\n\n<p>Also, my test of a text shape had a Type of 14, which is a 'placeholder'. You may need to check for additional types if the code doesn't change some fonts you want changed.  </p>\n\n<pre><code>Option Explicit\n\nSub FontChange()\n\nDim sld As Slide\nDim shp As Shape\n\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n    If shp.Type = msoPlaceholder Then\n        With shp.TextFrame.TextRange.Font\n            .Size = 12\n            .Name = \"Bauhaus 93\"\n            .Bold = False\n            .Color.RGB = RGB(255, 127, 255)\n        End With\n    End If\n    Next shp\nNext sld\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1450969970, "creation_date": 1450969970, "answer_id": 34454747, "question_id": 34444399, "link": "https://stackoverflow.com/questions/34444399/using-vba-in-powerpoint-to-change-font/34454747#34454747", "title": "Using VBA in PowerPoint to change font", "body": "<p>A few mods to Wayne's version in the event that you want to change text that's not in placeholders. And a few tests to make sure that the shape in question a) CAN contain text (shapes like lines cannot) and if so b) that it HAS some text to modify.</p>\n\n<pre><code>Option Explicit\n\nSub FontChange()\n\nDim sld As Slide\nDim shp As Shape\n\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n    If shp.HasTextFrame Then  ' Not all shapes do\n    If shp.TextFrame.HasText Then  ' the shape may contain no text\n        With shp.TextFrame.TextRange.Font\n            .Size = 12\n            .Name = \"Bauhaus 93\"\n            .Bold = False\n            .Color.RGB = RGB(255, 127, 255)\n        End With\n    End If\n    End If\n    Next shp\nNext sld\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9578, "favorite_count": 1, "accepted_answer_id": 34454747, "answer_count": 2, "score": 2, "last_activity_date": 1569254341, "creation_date": 1450908144, "question_id": 34444399, "link": "https://stackoverflow.com/questions/34444399/using-vba-in-powerpoint-to-change-font", "title": "Using VBA in PowerPoint to change font", "body": "<p>How do I use VBA to make the font consistent throughout a PowerPoint presentation?</p>\n\n<p>I'm new to VBA, so the code I used could be completely wrong but here it is:</p>\n\n<pre><code>Sub FontChange()\n\n  Dim sld As Slide\n  Dim shp As Shape\n\n   For Each sld In ActivePresentation.Slides\n       For Each shp In sld.Shapes\n       shp.TextFrame.TextRange.Font\n\n         .Size = 12\n\n         .Name = \"Bauhaus 93\"\n\n         .Bold = False\n\n         .Color.RGB = RGB(255, 127, 255)\n    Next shp\n   Next sld\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for the help.</p>\n"}, {"tags": ["windows", "vba", "shell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 1, "creation_date": 1450908838, "post_id": 34443952, "comment_id": 56630870, "body": "@findwindow might be helpful here lol, look into the windows api <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633499(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1450909459, "post_id": 34443952, "comment_id": 56631135, "body": "If a process (for example a messagebox) is hosted in an external application, your process (VBA) can access its object only through an API (Application Programming Interface). If the developers of this application have developed a VBA api, look for it on the web (or tell us the name of the application and we can try to help you finding it). Otherwise, your best chance is to &quot;hack&quot; the application (like sending a key, or finding the window etc.). But it will always be a &quot;hack&quot;: as soon as something doesn&#39;t go as you expect, your code will likely fail."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1450909584, "post_id": 34443952, "comment_id": 56631183, "body": "P.s. &quot;as soon as something doesn&#39;t go as you expect&quot; means: the window is not on the right place, the focus is somewhere else, the process doesn&#39;t start etc. You can try to handle many possibilities but not all. Cause Shell, SendKeys, FindWindow etc. are Windows API (i.e. a way of VBA to access the methods of the Windows operating framework)."}, {"owner": {"reputation": 518, "user_id": 3924272, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/1b01be61acf18c3d7b41427d4c655cf5?s=128&d=identicon&r=PG&f=1", "display_name": "edition", "link": "https://stackoverflow.com/users/3924272/edition"}, "edited": false, "score": 0, "creation_date": 1450911313, "post_id": 34443952, "comment_id": 56631810, "body": "I&#39;m currently writing and testing the code to answer your question"}], "answers": [{"tags": [], "owner": {"reputation": 518, "user_id": 3924272, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/1b01be61acf18c3d7b41427d4c655cf5?s=128&d=identicon&r=PG&f=1", "display_name": "edition", "link": "https://stackoverflow.com/users/3924272/edition"}, "is_accepted": true, "score": 1, "last_activity_date": 1450914757, "last_edit_date": 1450914757, "creation_date": 1450914343, "answer_id": 34445414, "question_id": 34443952, "link": "https://stackoverflow.com/questions/34443952/vba-how-to-control-message-boxes-from-another-program/34445414#34445414", "title": "vba How to control message boxes from another program?", "body": "<h2>How to Interact with a Button on a Dialog</h2>\n\n<p>Well, there is a way of sending a <code>WM_COMMAND</code> message to common buttons on a dialog box effectively closing it:</p>\n\n<pre><code>Declare Function SendMessageA Lib \"user32\" (ByVal hWnd As Long, ByVal Msg As Integer, ByVal wParam As Long, ByVal lParam As Long) As Long\nDeclare Function FindWindowA Lib \"user32\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nConst WM_COMMAND As Integer = 273\nConst WM_CLOSE As Integer = 16\nConst IDOK As Integer = 1\nConst IDCANCEL As Integer = 2\n\nSub ShowDialogs()\n    If Shell(\"C:\\Users\\myself\\dialogs.exe\") &lt;&gt; 0 Then\n        Dim hWnd As Long\n        hWnd = FindWindowA(\"#32770\", \"Info\")\n        Debug.Print hWnd\n        SendMessageA hWnd, WM_COMMAND, IDOK, 0\n    End If\nEnd Sub\n</code></pre>\n\n<h2>Important Notes:</h2>\n\n<ul>\n<li><p>I had to use Spy++ to find out what class name Windows gives to message box dialogs.</p></li>\n<li><p>The Windows SDK headers contained useful constants, especially the value for <code>WM_COMMAND</code> which was obtained from WinUser.h.</p></li>\n<li><p>Each time a dialog is a created, you will need to obtain the handle for the window again using <code>FindWindowA</code>, as shown in the preceding code.</p></li>\n</ul>\n"}], "owner": {"reputation": 328, "user_id": 3203246, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ff559ad8929b01e3ef1a0c743f670743?s=128&d=identicon&r=PG&f=1", "display_name": "johnzilla", "link": "https://stackoverflow.com/users/3203246/johnzilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2410, "favorite_count": 0, "accepted_answer_id": 34445414, "answer_count": 1, "score": 0, "last_activity_date": 1450914757, "creation_date": 1450905878, "question_id": 34443952, "link": "https://stackoverflow.com/questions/34443952/vba-how-to-control-message-boxes-from-another-program", "title": "vba How to control message boxes from another program?", "body": "<p>So I want to use </p>\n\n<p><code>pid = Shell(MyApp, 1)</code></p>\n\n<p>with VBA to automate the use of a crappy external program. This program unfortunately has all sorts of annoying dialog boxes and popups that must be clicked. Is there any way to directly control each dialog box to ensure that the \"OK\" button is pressed rather than \"Cancel\"? </p>\n\n<p>Currently I am using </p>\n\n<pre><code>AppActivate pid\nApplication.SendKeys (\"%R\")\n</code></pre>\n\n<p>But this command can only guarantee the \"OK\" of the initial pop-up dialog. Subsequent pop-ups may not be clicked, especially because I'm not sure how to guarantee focus on the new popup. Is there a way to find the child process ID's of any new popups? Is there any way to directly \"click\" a particularly labeled control button?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 1, "creation_date": 1450905970, "post_id": 34443956, "comment_id": 56629614, "body": "You can also run a <code>pastespecial pastevalues</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 4, "creation_date": 1450906008, "post_id": 34443956, "comment_id": 56629625, "body": "@nutsch - True, but if we&#39;re trying to avoid Copy/Paste (clipboard), then you wouldn&#39;t do <code>PasteSpecial</code>."}, {"owner": {"reputation": 1, "user_id": 5712564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f6-lazkz9Q4/AAAAAAAAAAI/AAAAAAAAKvA/2oXIEvgF1pM/photo.jpg?sz=128", "display_name": "ARG", "link": "https://stackoverflow.com/users/5712564/arg"}, "edited": false, "score": 1, "creation_date": 1455502665, "post_id": 34443956, "comment_id": 58503167, "body": "Hello Bruce, apologies for the late reply here - I had issues logging in for some time. Thank you very much for this. Really appreciate it. Aaron"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 5, "last_activity_date": 1450905893, "creation_date": 1450905893, "answer_id": 34443956, "question_id": 34443932, "link": "https://stackoverflow.com/questions/34443932/copying-without-the-clipboard-and-without-formatting/34443956#34443956", "title": "Copying Without the Clipboard and Without Formatting", "body": "<p>Just set the two ranges' values equal to the other:</p>\n\n<p><code>workbookWeeklyTrain1.Sheets(\"Train1\").Range(\"C5:D16\").Value = workbookDailyTrain1.Sheets(\"Day\").Range(\"A13:B24\").Value</code></p>\n"}], "owner": {"reputation": 1, "user_id": 5712564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f6-lazkz9Q4/AAAAAAAAAAI/AAAAAAAAKvA/2oXIEvgF1pM/photo.jpg?sz=128", "display_name": "ARG", "link": "https://stackoverflow.com/users/5712564/arg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450906527, "creation_date": 1450905803, "last_edit_date": 1531161705, "question_id": 34443932, "link": "https://stackoverflow.com/questions/34443932/copying-without-the-clipboard-and-without-formatting", "title": "Copying Without the Clipboard and Without Formatting", "body": "<p>I've found a way to copy ranges from one workbook to another in Excel 2013/2016 without using the clipboard.</p>\n\n<p>The problem is that the formatting of the source data is also being copied as well. I only wanted to copy the values.</p>\n\n<p>I am combining data from daily workbooks into a weekly workbook. There are two workbooks:</p>\n\n<ol>\n<li><p><code>workbookDailyTrain1</code> (one daily workbook every 24 hours, each has 2 sheets: \"Day\" and \"Night\")</p></li>\n<li><p><code>workbookWeeklyTrain1</code> (this has 1 sheet: \"Train1\")</p></li>\n</ol>\n\n<p>Here is the line in question:</p>\n\n<pre><code>workbookDailyTrain1.Sheets(\"Day\").Range(\"A13:B24\").Copy workbookWeeklyTrain1.Sheets(\"Train1\").Range(\"C5:D16\")\n</code></pre>\n\n<p>Is there a way to modify this line of code to make it such that the range values only are being copied across? The destination workbook has its own formatting which has to be kept at all times for the purposes of SharePoint Server deployment.</p>\n"}, {"tags": ["string", "vba", "ms-access", "split"], "comments": [{"owner": {"reputation": 5248, "user_id": 4377809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4Unb.png?s=128&g=1", "display_name": "Il Vic", "link": "https://stackoverflow.com/users/4377809/il-vic"}, "edited": false, "score": 0, "creation_date": 1450903798, "post_id": 34443316, "comment_id": 56628713, "body": "You should specify where you are stuck"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1450903852, "post_id": 34443316, "comment_id": 56628737, "body": "There is no such thing as <code>individual records under a common field</code>. Either you are trying to do something that databases don&#39;t do or you are using the wrong terms to describe your problem.  Each record on a database table has a unique value for each field. You cannot store multiple values in a single field unless you do it using multiple records.  If that is what you are trying to do then you must iterate through the members of the array <code>strStorePhrase</code> and use an <code>INSERT</code> statement for each member. And strStorePhrase needs to be declared as an array: <code>Dim strStorePhrase() As String</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 3, "creation_date": 1450904010, "post_id": 34443316, "comment_id": 56628801, "body": "Here is one problem in your code: <code>strStorePhrase = Split(NewPhrase)</code> That&#39;s a problem because <code>Split()</code> returns an array and <code>strStorePhrase</code> is a plain <code>String</code> variable ... so can&#39;t accept an array."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "edited": false, "score": 0, "creation_date": 1450993789, "post_id": 34447063, "comment_id": 56658383, "body": "Thanks for all your help Hambone (it&#39;s very appreciated), I&#39;m stuck with these two lines.  How do I set my parameters correctly?  I&#39;m just a little confused as to what P1 actually is.    sql = &quot;parameters P1 text; INSERT INTO [FieldSplice] (words) VALUES ([P1])&quot;  Set query = CurrentDb.CreateQueryDef(&quot;FsInsert&quot;, sql)  Is there anything else I can provide you that would make this easier for you to understand?  This is the first question I&#39;ve ever posted on stackoverflow."}, {"owner": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "edited": false, "score": 0, "creation_date": 1450994530, "post_id": 34447063, "comment_id": 56658525, "body": "I managed to get your code to work. One thing to note, I had to change the &quot;Set query =&quot; statement in your code to &quot;set qdf =&quot;.  Do you know why?  Here is the final code:  Private Sub Command8_Click()  Dim textPhrase As String Dim words() As String Dim i As Integer  textPhrase = phrase words = Split(textPhrase, &quot; &quot;)  SQL = &quot;parameters P1 text;INSERT INTO [FieldSplice] (words) VALUES ([P1])&quot;  Set qdf = CurrentDb.CreateQueryDef(&quot;FsInsert&quot;, SQL)  For i = LBound(words) To UBound(words)   qdf.Parameters(&quot;P1&quot;).Value = words(i)   qdf.Execute Next i  CurrentDb.QueryDefs.Delete (&quot;FsInsert&quot;) End Sub"}, {"owner": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "edited": false, "score": 0, "creation_date": 1450994555, "post_id": 34447063, "comment_id": 56658528, "body": "Thanks so much for your help by the way.  Happy holidays."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "edited": false, "score": 0, "creation_date": 1450997581, "post_id": 34447063, "comment_id": 56659163, "body": "<code>qdf</code> is just the variable name...  it looks like I forgot to <code>Dim</code> my variable named &quot;query&quot; as a QueryDef.  My mistake.  Maybe you had query defined elsewhere as a string, which is why it didn&#39;t work but qdf didn&#39;t?  As far as P1, that&#39;s just the name of the bind variable.  You can name it anything you want.  P1 is sort of generic -- Parameter 1.  As long as the variable is consistent between the two statements, it can be anything you want.  At any rate, I&#39;m glad you got it to work.  Thanks for the kind words, and have a great Christmas"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "edited": false, "score": 0, "creation_date": 1450998238, "post_id": 34447063, "comment_id": 56659295, "body": "By the way, here is a more comprehensive example of parameters in Access where multiple columns are inserted:  <a href=\"http://stackoverflow.com/questions/34023850/vba-why-is-my-insert-code-not-working/34033843#34033843\" title=\"vba why is my insert code not working\">stackoverflow.com/questions/34023850/&hellip;</a>  Bear in mind Access parameters are very different (not as straight-forward in my opinion) than normal parameters for a RDBMS using ADO.net"}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 4, "last_activity_date": 1450929461, "creation_date": 1450929461, "answer_id": 34447063, "question_id": 34443316, "link": "https://stackoverflow.com/questions/34443316/how-to-split-a-string-and-store-in-ms-access-table/34447063#34447063", "title": "How to Split a String and Store in MS Access table", "body": "<p>I'm a little unclear on why you have the ADODB connection...  is this connecting to an external database?  If so, that makes sense, but then you are missing some code to get the insert to work properly.</p>\n\n<p>If this is just an internal (native) Access table, then I don't think you need any of that.  Here is a simple example of how you would take a string, split it into words (based on a space) and then insert those into your table:</p>\n\n<pre><code>Dim textPhrase As String\nDim words() As String\nDim i As Integer\n\ntextPhrase = \"This is a test\"\nwords = Split(textPhrase, \" \")\n\nsql = \"parameters P1 text; INSERT INTO [FieldSplice] (words) VALUES ([P1])\"\n\nSet query = CurrentDb.CreateQueryDef(\"FsInsert\", sql)\n\nFor i = LBound(words) To UBound(words)\n  query.Parameters(\"P1\").Value = words(i)\n  query.Execute\nNext i\n\nCurrentDb.QueryDefs.Delete (\"FsInsert\")\n</code></pre>\n\n<p>One other note of interest -- you don't need to declare the insert each time.  You can set a parameter, assign values to the parameter and execute the insert command multiple times.  This is included in my example above.</p>\n\n<p>Your code was trying to say:</p>\n\n<pre><code>insert into [table] (field) values (\"value1\", \"value2\", \"value3\")\n</code></pre>\n\n<p>Which you can't do.  That has to be done as three inserts, unless your database supports array inserts (Oracle, for example).</p>\n\n<p>The multiple fields only works like this:</p>\n\n<pre><code>insert into [table] (field1, field2) values (\"value1\", \"value2\")\n</code></pre>\n\n<p>Where each value corresponds to a column in the table.</p>\n"}], "owner": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6835, "favorite_count": 0, "accepted_answer_id": 34447063, "answer_count": 1, "score": 1, "last_activity_date": 1612610524, "creation_date": 1450902972, "last_edit_date": 1450903740, "question_id": 34443316, "link": "https://stackoverflow.com/questions/34443316/how-to-split-a-string-and-store-in-ms-access-table", "title": "How to Split a String and Store in MS Access table", "body": "<p>I would like to be able to split a string of text that has been entered into a textbox on a MS Access form and store the split strings as separate records under the same field.  This is the code I have so far, but I keep running into problems at every corner.  I'm fairly new to this, but have been learning quickly.  Any help is appreciated.</p>\n\n<p>Here is what I'd like to accomplish:  If I enter the following text into a text box (\"this is a sentence\") and click submit.  I would like each other the words to be stored as individual records under a common field.  Seems simple, but it's causing quite a few headaches.</p>\n\n<pre><code>Private Sub Submit_Click()\n\n    Dim SetDBConnection As ADODB.Connection\n    Set SetDBConnection = CurrentProject.Connection\n\n    Dim strInsertRecord As String\n\n    Dim strNewPhrase As String\n    Dim strStorePhrase As String\n\n    strNewPhrase = textPhrase\n    strStorePhrase = Split(NewPhrase)\n\n    strInsertRecord = \"INSERT INTO [FieldSplice] (words) VALUES (\" &amp; strStorePhrase &amp; \")\"\n    SetDBConnection.Execute strInsertRecord\n\n    textPhrase.Value = Null\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 1, "creation_date": 1450903365, "post_id": 34442837, "comment_id": 56628522, "body": "So this means that 27188, 27328 and 27437 all also get deleted?"}], "answers": [{"comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 1, "creation_date": 1450903397, "post_id": 34443004, "comment_id": 56628540, "body": "Do you need that last part, <code>and r2.requestid = r.requestid</code>?"}, {"owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1450904571, "post_id": 34443004, "comment_id": 56629048, "body": "@Hambone I ran that query - it&#39;s taking too long in progress. Still in progress. Is that ok?"}, {"owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "edited": false, "score": 0, "creation_date": 1450907754, "post_id": 34443004, "comment_id": 56630426, "body": "@GordonLinoff I ran that query - it&#39;s taking too long in progress. Still in progress. Is that ok?"}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "edited": false, "score": 0, "creation_date": 1450930019, "post_id": 34443004, "comment_id": 56636218, "body": "@Akkitech . . . If of interest, ask another question about how to speed the query."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1450901476, "creation_date": 1450901476, "answer_id": 34443004, "question_id": 34442837, "link": "https://stackoverflow.com/questions/34442837/access-query-to-delete-data-based-on-complex-criteria/34443004#34443004", "title": "Access Query to Delete data based on Complex criteria", "body": "<p>You can identify the one to delete using <code>NOT IN</code> and some string manipulation:</p>\n\n<pre><code>delete from raw as r\n    where requestid not in (select requestid\n                            from raw as r2\n                            where r2.ActionBy = \"Harford, Claran\" and\n                                  r2.requestid = r.requestid\n                           );\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34443004, "answer_count": 1, "score": 0, "last_activity_date": 1450902050, "creation_date": 1450900705, "last_edit_date": 1450902050, "question_id": 34442837, "link": "https://stackoverflow.com/questions/34442837/access-query-to-delete-data-based-on-complex-criteria", "title": "Access Query to Delete data based on Complex criteria", "body": "<p>I'm using Access 2013. I've a Table name - <code>Raw</code> and its Fields are:</p>\n\n<pre><code>requestid   - Number\nFormname    - Short Text\nTimestamp   - Date/Time\nType        - Short Text\nActionBy    - Short Text\n</code></pre>\n\n<p><code>Raw</code> table contains all the data. Same request ID will be having different <code>Types</code> and <code>actionby</code>. I want to delete all the rows for those request ID where any of the <code>actionby</code> for a particular request ID is not matching my user. If matching, leave all the rows.</p>\n\n<p>Example - In the screenshot, request ID 27176 is having Ciaran in actionby. Hence, it should not delete any of the rows for request ID 27176.</p>\n\n<p>However for request ID 27434, ciaran is not in Actionby so delete all the rows for 27176. Hope I'm able to give a glimpse of what I needed. \n<a href=\"https://i.stack.imgur.com/siRRj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/siRRj.png\" alt=\"Raw Table Data\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450900722, "post_id": 34442728, "comment_id": 56627345, "body": "<code>TstCount</code> less or equal then 6?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450900934, "post_id": 34442728, "comment_id": 56627435, "body": "<code>all values are properly set</code> Assuming that&#39;s true, perhaps you should qualify your <code>worksheet</code>? Pass a workbook as an argument into the function."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450901221, "post_id": 34442728, "comment_id": 56627555, "body": "Add <code>Debug.Print nSumRow, nTester</code> just before the failing line.  What do you get"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450902342, "post_id": 34442728, "comment_id": 56628071, "body": "it also fails using <code>.Cells(1,1)</code>... I assume that may not be the reason :/"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1450903243, "post_id": 34442728, "comment_id": 56628465, "body": "Debug 101 - If you don&#39;t know what is causing your error, get rid of your <code>On Error GoTo</code> statements!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1450904062, "post_id": 34442728, "comment_id": 56628821, "body": "A function should return a value, not write values into a variety of other cells. Change it to a sub (keeping the parameter)."}, {"owner": {"reputation": 11, "user_id": 5712370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbbda74d4cce065f7cbbcd06d1781?s=128&d=identicon&r=PG&f=1", "display_name": "P. Beatt", "link": "https://stackoverflow.com/users/5712370/p-beatt"}, "edited": false, "score": 0, "creation_date": 1450962600, "post_id": 34442728, "comment_id": 56648047, "body": "Added Debug.printjust before fail point:  nSumRow = 7, nTester=14, tstcount = 1, Asums(tstcount) = 2"}, {"owner": {"reputation": 11, "user_id": 5712370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbbda74d4cce065f7cbbcd06d1781?s=128&d=identicon&r=PG&f=1", "display_name": "P. Beatt", "link": "https://stackoverflow.com/users/5712370/p-beatt"}, "edited": false, "score": 0, "creation_date": 1450962730, "post_id": 34442728, "comment_id": 56648095, "body": "Change calling to SUB and called from a function.  No Change"}, {"owner": {"reputation": 11, "user_id": 5712370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbbda74d4cce065f7cbbcd06d1781?s=128&d=identicon&r=PG&f=1", "display_name": "P. Beatt", "link": "https://stackoverflow.com/users/5712370/p-beatt"}, "edited": false, "score": 0, "creation_date": 1450962788, "post_id": 34442728, "comment_id": 56648121, "body": "Called SUB with Worksheet as a passed variable.  No Change"}, {"owner": {"reputation": 11, "user_id": 5712370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbbda74d4cce065f7cbbcd06d1781?s=128&d=identicon&r=PG&f=1", "display_name": "P. Beatt", "link": "https://stackoverflow.com/users/5712370/p-beatt"}, "edited": false, "score": 0, "creation_date": 1450962906, "post_id": 34442728, "comment_id": 56648183, "body": "Removing ON ERROR would not allow the detection of an error (Debug 101)"}], "owner": {"reputation": 11, "user_id": 5712370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbbda74d4cce065f7cbbcd06d1781?s=128&d=identicon&r=PG&f=1", "display_name": "P. Beatt", "link": "https://stackoverflow.com/users/5712370/p-beatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452127108, "creation_date": 1450900175, "last_edit_date": 1531161705, "question_id": 34442728, "link": "https://stackoverflow.com/questions/34442728/excel-2016-vba-not-writing-to-unlocked-cell", "title": "Excel 2016 VBA not writing to unlocked cell", "body": "<p>I am running Excel 2016 on Windows 10.</p>\n\n<p>I have a very simple macro that reads data on a worksheet and produces a series of summary values which it write to specific cells on the sheet.  The failing instruction is:  <strong>.Cells(nSumRow, nTester).Value = aSums(TstCount)</strong></p>\n\n<p>When this command is executed the system returns error code 1004.  It also fails if the command is written:  <strong>Activesheet.Cells(nSumRow, nTester).Value = aSums(TstCount)</strong></p>\n\n<p>Debug shows all values are properly set,</p>\n\n<p>Using debug I have attempted to write to .Cells(1,1), it also fails.</p>\n\n<p>The sheet if NOT protected and cells are NOT locked.</p>\n\n<p>Any Ideas??</p>\n\n<pre><Code>\nFunction ProcessData(rData As Range) As String\n    Dim nAreaRow As Long                ' The current row within a range\n    Dim nColumn As Long             '\n    Dim nTotalMutations As Long     ' The total allele variance\n    Dim nUniqueMarkers As Long      ' Number of unique markers with a mutation\n    Dim nFirstMarker As Long        ' Column of DYS393\n    Dim nLastMarker As Long         ' Column of DYS565\n    Dim nModal As Long              ' The Row where the Modal values are shown\n    Dim aMarkers() As Long          ' Container for the count of deviations\n    Dim nArea As Long               ' The current range being processed\n    Dim nTester As Long             ' Colunn for the Number of Haplotypes processed\n    Dim nRaw                        ' Column for the Total(Raw) Mutations found in the range\n    Dim nUnique                     ' Column for the Number of Unique Markers with Mutation\n    Dim nAvg                        ' Column for the average Number of Mutations per Tester\n    Dim nSumRow As Long             ' Row where the summary values are to be placed\n    Dim aSums() As Long\n    Const TstCount = 1\n    Const TstUnique = 2\n    Const TstRaw = 3\n    Const TstAvg = 4\n\n        'Initialize common work variables\n        nFirstMarker = GetColumn(\"393\", ActiveSheet)\n        nLastMarker = GetColumn(\"565\", ActiveSheet)\n        nModal = GetRow(\"393\", ActiveSheet) + 1\n        nTester = GetColumn(\"Testers\", ActiveSheet)\n        nRaw = GetColumn(\"Raw\", ActiveSheet)\n        nUnique = GetColumn(\"Unique\", ActiveSheet)\n        nAvg = GetColumn(\"Avg\", ActiveSheet)\n        nSumRow = ActiveCell.Row\n        ReDim aMarkers(nLastMarker + 1)\n        ReDim aSums(6)\n\n        With Worksheets(\"Sheet1\")\n            On Error GoTo ERROR_Submittal\n            ' Process all Ranges that were selected\n            For nArea = 1 To rData.Areas.Count\n                ' Process all rows in this area\n                For nAreaRow = 1 To rData.Areas(nArea).Rows.Count\n                    ' If there are no more rows, exit the loop and process the next range\n                    If IsError(rData.Areas(nArea).Item(nAreaRow, 1).Value) Then Exit For\n                    ' if this is not an empty row then\n                    If Not IsEmpty(rData.Areas(nArea).Item(nAreaRow, 1).Value) Then\n                        ' Bump the count of rows/Testors processed\n                        aSums(TstCount) = aSums(TstCount) + 1\n                        ' scan all of the defined markers\n                        For nX = nFirstMarker To nLastMarker Step 1\n                            ' compute up the Allele diversity\n                            aMarkers(nX) = Abs(.Cells(nModal, nX).Value - .Cells(rData.Areas(nArea).Item(nAreaRow, 1).Row, nX).Value)\n                        Next nX\n                        For nX = LBound(aMarkers) To UBound(aMarkers)\n                            If aMarkers(nX) > 0 Then\n                                aSums(TstUnique) = aSums(TstUnique) + 1\n                                aSums(TstRaw) = aSums(TstRaw) + aMarkers(nX)\n                                aSums(TstAvg) = Application.WorksheetFunction.RoundUp(aSums(TstRaw) / aSums(TstCount), 0)\n                            End If\n                        Next nX\n                    End If\n                Next nAreaRow\n            Next nArea\n            .Cells(nSumRow, nTester).Value = aSums(TstCount)\n            .Cells(nSumRow, nRaw).Value = aSums(TstRaw)\n            .Cells(nSumRow, nUnique).Value = aSums(TstUnique)\n            .Cells(nSumRow, nAvg).Value = aSums(TstAvg)\n    End With\nEXIT_Function:\n    Exit Function\n\nERROR_Submittal:\n    GoTo EXIT_Function\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1450901380, "post_id": 34442469, "comment_id": 56627624, "body": "You should learn to use the documentation in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff743835.aspx\" rel=\"nofollow noreferrer\">PowerPoint Object Model</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450901940, "post_id": 34442964, "comment_id": 56627908, "body": "if doing it as an own sob you could directly <code>Exit Sub</code> it and skip the whole <code>found</code>-part ^^"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450902051, "post_id": 34442964, "comment_id": 56627945, "body": "@DirkReichel absolutely"}, {"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1450903643, "post_id": 34442964, "comment_id": 56628654, "body": "Your code is checking if the name of the shape is &#39;Title&#39; and that is not the same as the slide title."}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450903659, "post_id": 34442964, "comment_id": 56628665, "body": "Is there a way to do it without naming the shape as &quot;Title&quot;? Could I just loop through and say capitalize the first letter of each word in shape 1 of each slide?"}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450903725, "post_id": 34442964, "comment_id": 56628687, "body": "I am totally new to VBA so apologies if these are dumb/basic questions"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1450903831, "post_id": 34442964, "comment_id": 56628732, "body": "@ShyamPillai great, I&#39;ve upvoted your answer. This is pretty much the first time I&#39;m seeing any VBA written specifically for PowerPoint (I&#39;ve always wondered what one would want to automate with VBA in PowerPoint), and I don&#39;t know that object model like the palm of my hand."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450903881, "post_id": 34442964, "comment_id": 56628752, "body": "@change33 I wouldn&#39;t do that, it assumes shape 1 of each slide contains your title - it&#39;s often best to not assume stuff when writing code (that said, my code assumes title shape is named &quot;Title&quot;, so...) ;-)"}, {"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 1, "creation_date": 1450903993, "post_id": 34442964, "comment_id": 56628795, "body": "@Mat&#39;sMug: From creation of decks to slideshows, you would be surprised at the usage. :-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1450901267, "creation_date": 1450901267, "answer_id": 34442964, "question_id": 34442469, "link": "https://stackoverflow.com/questions/34442469/vba-for-capitalizing-title-slides/34442964#34442964", "title": "VBA for capitalizing title slides", "body": "<p>A <code>Slide</code> object doesn't have a <code>Title</code> property. You need to look for the <code>Shape</code> object that contains the title text.</p>\n\n<p>Iterate the <code>.Shapes</code> collection and use its <code>Name</code> to know when you've found the one that contains your title (then you can exit the loop).</p>\n\n<p>This assumes you've named the title shape \"Title\" or something.</p>\n\n<pre><code>Dim sld As Slide, shp As Shape\nDim found As Boolean\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n        If shp.Name = \"Title\" Then\n            found = True\n            shp.TextFrame.TextRange.ChangeCase ppCaseTitle\n        End If\n        If found Then Exit For\n    Next\n    If found Then Exit For\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1450904466, "post_id": 34443423, "comment_id": 56628982, "body": "@change33 note that the best way to say &quot;thank you so much&quot; on this site, is to tick that checkmark (and, once you get to 15 rep, to vote up)."}], "tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": true, "score": 1, "last_activity_date": 1450903459, "creation_date": 1450903459, "answer_id": 34443423, "question_id": 34442469, "link": "https://stackoverflow.com/questions/34442469/vba-for-capitalizing-title-slides/34443423#34443423", "title": "VBA for capitalizing title slides", "body": "<p>The Title object is available on the Shapes object, which maps on to the placeholder title for the slide. I would also use the HasTitle property to check if the slide has a title or not.</p>\n\n<pre><code>Sub Capitalize()\nDim sld As Slide\n\nFor Each sld In ActivePresentation.Slides\n    If sld.Shapes.HasTitle Then\n        sld.Shapes.Title.TextFrame.TextRange.ChangeCase ppCaseTitle\n    End If\nNext sld\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 34443423, "answer_count": 2, "score": 1, "last_activity_date": 1450903459, "creation_date": 1450899022, "last_edit_date": 1450900681, "question_id": 34442469, "link": "https://stackoverflow.com/questions/34442469/vba-for-capitalizing-title-slides", "title": "VBA for capitalizing title slides", "body": "<p>I want to use VBA to capitalize each word in the titles of all my PowerPoint slides.</p>\n\n<p>So far this is the code I am using: </p>\n\n<pre><code>Sub Capitalize()\n    Dim sld As Slide\n\n    For Each sld In ActivePresentation.Slides\n            sld.Title.TextFrame.TextRange.ChangeCase ppCaseTitle\n        Next sld\nEnd Sub\n</code></pre>\n\n<p>It's giving me an error by highlighting the \"Title\" and saying \"Method or data member not found\"</p>\n\n<p>Any help would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["shell", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 22206, "user_id": 114226, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/8zmez.png?s=128&g=1", "display_name": "PeterMmm", "link": "https://stackoverflow.com/users/114226/petermmm"}, "edited": false, "score": 0, "creation_date": 1450899146, "post_id": 34442384, "comment_id": 56626613, "body": "I may recommend to kick off  <code>chrome</code> and use something light-weight like <a href=\"http://gnuwin32.sourceforge.net/packages/wget.htm\" rel=\"nofollow noreferrer\">wget</a> if you cannot include the download completely in <a href=\"http://stackoverflow.com/questions/15644254/connect-to-web-service-in-ms-access-with-vba\">your code</a>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450899837, "post_id": 34442384, "comment_id": 56626944, "body": "Your code tries to write to the Program Files directory, which is not allowed when UAC is enabled. Error 5 is <i>Access denied</i>. Presumably, you&#39;ve not got UAC enabled on your own machine (shame on you) but it&#39;s enabled on the new machine."}, {"owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "edited": false, "score": 0, "creation_date": 1450900173, "post_id": 34442384, "comment_id": 56627087, "body": "Ken, so are you saying if I moved the chrome executable to the desktop, or even the network, that it would fix it?"}, {"owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "edited": false, "score": 0, "creation_date": 1450900374, "post_id": 34442384, "comment_id": 56627189, "body": "I just remapped it to the desktop. No dice. And UAC is disabled on both machines."}, {"owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "edited": false, "score": 0, "creation_date": 1450900931, "post_id": 34442384, "comment_id": 56627430, "body": "Peter, I had attempted that previously. As I recall I switched to this method because of something that wasn&#39;t working before."}, {"owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "edited": false, "score": 0, "creation_date": 1450903087, "post_id": 34442384, "comment_id": 56628387, "body": "Would the fact that the new computer is running 64-bit OS whereas the old one is 32-bit?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450951658, "post_id": 34442384, "comment_id": 56643423, "body": "You <i>have</i> checked <code>chromePath</code>, have you? 32-bit Chrome would be in &quot;C:\\Program Files (x86)\\&quot; ."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450951809, "post_id": 34442384, "comment_id": 56643486, "body": "The parentheses around the Shell argument are syntactically wrong, even if it works when there is only one argument. The correct syntax is <code>Shell &quot;cmdline&quot;</code> or <code>result = Shell(&quot;cmdline&quot;)</code>."}, {"owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "edited": false, "score": 0, "creation_date": 1450964711, "post_id": 34442384, "comment_id": 56648890, "body": "Thanks Andre, even when it&#39;s a URL path? I guess I&#39;m confused regarding that. I&#39;ve seen the <code>result = Shell(&quot;cmdline&quot;)</code> before, but only on file paths, not URL&#39;s. The above script was the only URL based one I could find."}, {"owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "edited": false, "score": 0, "creation_date": 1450965072, "post_id": 34442384, "comment_id": 56649050, "body": "And, yes I actually put chrome at the location in the path."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "is_accepted": true, "score": 0, "last_activity_date": 1450978226, "creation_date": 1450978226, "answer_id": 34456111, "question_id": 34442384, "link": "https://stackoverflow.com/questions/34442384/access-db-throwing-runtime-5-shell-error-when-run-in-access-2013-but-not-in-acce/34456111#34456111", "title": "Access dB Throwing Runtime 5 Shell Error when Run in Access 2013 but not in Access 2010", "body": "<p>After more searching, the 64-bit doesn't play well with the 32-bit. Switched over to a 32-bit OS and Office, and everything is working fine. Apparently having that miss-match causes a lot of random issues. </p>\n"}], "owner": {"reputation": 115, "user_id": 4550623, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YC979.jpg?s=128&g=1", "display_name": "Lucas Sitterly", "link": "https://stackoverflow.com/users/4550623/lucas-sitterly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 34456111, "answer_count": 1, "score": 0, "last_activity_date": 1594642975, "creation_date": 1450898585, "last_edit_date": 1594642975, "question_id": 34442384, "link": "https://stackoverflow.com/questions/34442384/access-db-throwing-runtime-5-shell-error-when-run-in-access-2013-but-not-in-acce", "title": "Access dB Throwing Runtime 5 Shell Error when Run in Access 2013 but not in Access 2010", "body": "<p>Ok, I'm Stumped. I built a dB that pulls data from Yahoo Finance API to compile a report. Built in Access 2010 and housed on out network. Everything was working like gravy. Well now, I have a dedicated computer, that this is going to run from. After setting it up, I am getting Runtime 5 with the \"Shell\" line highlighted in the code below:</p>\n\n<pre><code>Public Function RunYahooAPI()\n\nDim chromePath As String\n\n  chromePath = \"\"\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\"\"\"\n\n Shell (chromePath &amp; \" -url http://download.finance.yahoo.com/d/quotes.csv?s=CVX%2CXOM%2CHP%2CSLB%2CPBA%2CATR%2CECL%2CNVZMY&amp;f=nsl1op&amp;e=.csv\")\n\nEnd Function\n</code></pre>\n\n<p>Things I have checked so far from searching online:</p>\n\n<ol>\n<li>Ran it as a Sub vs Function. No change</li>\n<li>Disabled my Anti-virus software. No change</li>\n<li>Checked references. All match the 2010</li>\n<li>Took out the spaces in the Shell. No change</li>\n<li>Added \"\"\" around the url. No change</li>\n<li>Also logged directly on the computer to try vs RC. No change</li>\n</ol>\n\n<p>I really am at my wits end on this. Hoping a second set of eyes can set me straight.</p>\n\n<p>I should probably also mention I am running this all through a remote connection.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1450898281, "post_id": 34442233, "comment_id": 56626204, "body": "<code>.body = body &amp; vbNewLine &amp; vbNewLine &amp; signature</code> What&#39;s <code>body</code>? You mean <code>.body</code>?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450898950, "post_id": 34442233, "comment_id": 56626538, "body": "@findwindow should have probably included that lol.  just named a string variable body that contains the little standardized text for the body."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450899084, "post_id": 34442233, "comment_id": 56626598, "body": "Uh so you&#39;re setting signature before you have set <code>.body</code> so signature has to be empty? Why don&#39;t you set a string to signature like you did to body?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1450901744, "post_id": 34442233, "comment_id": 56627807, "body": "try <code>.htmlbody</code> instead of <code>.body</code> (in all instances). You&#39;ll then probably need to replace <code>&amp; vbNewLine &amp; vbNewLine &amp;</code> with <code>&amp; &quot;&lt;br&gt;&lt;br&gt;&quot; &amp;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1450902051, "post_id": 34443072, "comment_id": 56627944, "body": "just an FYI, there is no need to get the html file containing the signature. The OP&#39;s original code should work if <code>.htmlbody</code> is used instead of <code>.body</code>. Just thought it worth sharing because I used to use this method as well, until I learned about the method the OP is using (but with htmlbody). It&#39;s much cleaner and easier :)"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450902808, "post_id": 34443072, "comment_id": 56628258, "body": "@ScottHoltzman your solution worked!  Thanks very much.  Quick question for you though.  Now that I did .HTMLBody my text looks a bit funky.  The first line which is hello, looks to be a size or two larger and Bold.  The rest is a bit small as well.  I&#39;m not an html guy.  How can I fix this?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1450903009, "post_id": 34443072, "comment_id": 56628344, "body": "@StormsEdge - Glad it worked. Look in the answer provided by Simon Wray where he wraps the text in <code>&lt;BODY style=font-size ... </code> you can set font style, color, type, etc. here for all the text. Make sure you close with the <code>&lt;&#47;BODY&gt;</code> at the end."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450903101, "post_id": 34443072, "comment_id": 56628396, "body": "@ScottHoltzman Will do!  was just investigating that now.  Thanks!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 1, "creation_date": 1450903176, "post_id": 34443072, "comment_id": 56628430, "body": "@StormsEdge - you can use most available html tags. If you can&#39;t find something, there&#39;s a slew of stuff online about it. Or worse case, post another SO question :)"}], "tags": [], "owner": {"reputation": 192, "user_id": 4903736, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-qq1_NX5szB4/AAAAAAAAAAI/AAAAAAAAAAA/djRU3LH0sC4/photo.jpg?sz=128", "display_name": "Simon Wray", "link": "https://stackoverflow.com/users/4903736/simon-wray"}, "is_accepted": true, "score": 2, "last_activity_date": 1450901867, "creation_date": 1450901867, "answer_id": 34443072, "question_id": 34442233, "link": "https://stackoverflow.com/questions/34442233/signature-not-appearing-in-excel-automated-email/34443072#34443072", "title": "Signature not appearing in excel automated email", "body": "<p>I suspect that the Signature is not initially added to a new Email, but a later step in Outlook then adds it to the Email. So your code is just creating an Email item with an empty Body.</p>\n\n<p>I have used these two routines to get the Signature from the .html file it is contained in and then add that to the Email, done as html so I'm using <code>.HTMLBody</code> instead of <code>.Body</code>.</p>\n\n<pre><code>Private Sub btnGenerateEmail_Click()\n\nDim OutApp As Outlook.Application\nDim OutMail As Outlook.MailItem\nDim nRow As Integer\nDim tblEmailTo As ListObject\nDim tblEmailCC As ListObject\nDim sToEmail As String\nDim sCCEmail As String\nDim sSalutation As String\nDim dteEffectiveDate  As Date\nDim sSignature As String\n\nOn Error GoTo EH\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nSet OutMail = OutApp.CreateItem(olMailItem)\n\nSet tblEmailTo = ThisWorkbook.Sheets(\"Ref\").ListObjects(\"TblEmailTo\")\nSet tblEmailCC = ThisWorkbook.Sheets(\"Ref\").ListObjects(\"TblEmailCC\")\n\nFor nRow = 1 To tblEmailTo.ListRows.Count\n    sToEmail = sToEmail &amp; tblEmailTo.DataBodyRange(nRow, 1).Value &amp; \"; \"\nNext nRow\n\nIf tblEmailTo.ListRows.Count = 1 Then\n    sSalutation = \"Hi \" &amp; Mid(sToEmail, 1, InStr(1, sToEmail, \".\") - 1) &amp; \",\"\nElse\n    sSalutation = \"Hi All,\"\nEnd If\n\nFor nRow = 1 To tblEmailCC.ListRows.Count\n    sCCEmail = sCCEmail &amp; tblEmailCC.DataBodyRange(nRow, 1).Value &amp; \"; \"\nNext nRow\n\ndteEffectiveDate = Range(\"C\" &amp; mnDataStartRow).Value\n\nsSignature = GetCorpEmailSig()\n\nOutMail.To = sToEmail\nOutMail.CC = sCCEmail\nOutMail.Subject = \"My Email Subject as at \" &amp; Format(dteEffectiveDate, \"mmmm dd yyyy\")\nOutMail.HTMLBody = \"&lt;BODY style=font-size:11pt;font-family:Calibri&gt;\" &amp; sSalutation &amp; _\n                                            \"&lt;br&gt;&lt;br&gt;My main email body text&lt;br&gt;&lt;br&gt;Regards,\" &amp; _\n                                            \"&lt;br&gt;\" &amp; Mid(Application.UserName, InStr(1, Application.UserName, \",\") + 2) &amp; \"&lt;/BODY&gt;\" &amp; sSignature\n\nIf Dir(GetOutputPath) &lt;&gt; \"\" Then\n    OutMail.Attachments.Add (GetOutputPath)\nEnd If\n\nOutMail.Display\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nExit Sub\n\nPrivate Function GetCorpEmailSig() As String\n\nDim sSigFilename As String\nDim fso As Object\nDim ts As Object\n\nsSigFilename = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\My Company Name.htm\"\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(sSigFilename).OpenAsTextStream(1, -2)\nGetCorpEmailSig = ts.ReadAll\nts.Close\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 34443072, "answer_count": 1, "score": 3, "last_activity_date": 1450901867, "creation_date": 1450897965, "last_edit_date": 1450899002, "question_id": 34442233, "link": "https://stackoverflow.com/questions/34442233/signature-not-appearing-in-excel-automated-email", "title": "Signature not appearing in excel automated email", "body": "<p>Have been banging my head against this for a while now. </p>\n\n<p>Created an routine to send end of day emails to customers with multiple pdf attachments.  All of that is working, but for some reason the signature does not appear automatically like it normally does.  I tried to capture it by setting signature = outMail.body and adding it to my standard body later on, but that doesn't seem to be working.  If I open an email the normal way the signature shows up automatically as it should.  Thanks in advance.</p>\n\n<p>**In additional \"body\" used in the .body line is just a var string that contains the text for the body of the email.</p>\n\n<pre><code>'Initial signature capture\n        With outMail\n            .Display\n        End With\n\n        signature = outMail.body\n\n        With outMail\n            .To = firmEmail\n            .Subject = ******\n            .body = body &amp; vbNewLine &amp; vbNewLine &amp; signature\n\n            Do While continue = True\n\n                'Get attachments\n                If reportsByFirm.Cells(row_counter, firmcol) = cFirm Or reportsByFirm.Cells(row_counter, firmcol) = iFirm Then\n                    pdfLocation = getPDFs(cFirm, iFirm, row_counter, reportsByFirm, trMaster, trSeparate, trName, reportDate)\n                    .Attachments.Add (pdfLocation)\n                    row_counter = row_counter + 1\n\n                ElseIf row_counter &lt; lRowReportsByFirm Then\n                    row_counter = row_counter + 1\n\n                ElseIf row_counter &gt;= lRowReportsByFirm Then\n                    continue = False\n                End If\n            Loop\n            .Display\n        End With\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba", "odbc"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450903325, "post_id": 34442291, "comment_id": 56628504, "body": "@Rdster: you can also try adding an explicit <code>;Trusted_Connection=No</code>"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 1, "last_activity_date": 1450898180, "creation_date": 1450898180, "answer_id": 34442291, "question_id": 34442002, "link": "https://stackoverflow.com/questions/34442002/force-ms-access-odbc-connection-to-use-sql-server-authentication/34442291#34442291", "title": "Force MS Access ODBC Connection to use SQL Server Authentication", "body": "<p>Here is a trusted connection from Access to SQL Server:</p>\n\n<pre><code>strConnectString = \"Driver={SQL Server};\" &amp; _\n                   \"Server=\" &amp; strDSN &amp; \";\" &amp; _\n                   \"Database=\" &amp; strDatabase &amp; \";\" &amp; _\n                    \"Trusted_Connection=yes\"\n</code></pre>\n\n<p>Or for SQL Server Authentication:</p>\n\n<pre><code>strConnectString = \"Driver={SQL Server};\" &amp; _\n                   \"Server=\" &amp; strDSN &amp; \";\" &amp; _\n                   \"Database=\" &amp; strDatabase &amp; \";\" &amp; _\n                   \"User Id=,myUID&gt;;Password=&lt;MyPWD&gt;\" \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1451002729, "post_id": 34444498, "comment_id": 56660151, "body": "What occurs is any table you open, then Access will cache the information. From that point on EVEN a re-link will re-use that cached information. The VERY important concept is thus to ensure that when you launch Access that no table EVER opened or used BEFORE you re-link. So no startup forms etc. can be allowed. In fact this effect can be put to good use since you do NOT need to include UID/PASSWORD in the SQL link string. How this works is explained here: <a href=\"http://blogs.office.com/b/microsoft-access/archive/2011/04/08/power-tip-improve-the-security-of-database-connections.aspx\" rel=\"nofollow noreferrer\">blogs.office.com/b/microsoft-access/archive/2011/04/08/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": true, "score": 0, "last_activity_date": 1450908582, "creation_date": 1450908582, "answer_id": 34444498, "question_id": 34442002, "link": "https://stackoverflow.com/questions/34442002/force-ms-access-odbc-connection-to-use-sql-server-authentication/34444498#34444498", "title": "Force MS Access ODBC Connection to use SQL Server Authentication", "body": "<p>What ended up working for me was starting it over from scratch.</p>\n\n<ul>\n<li>I blew out the existing UserDSN from the ODBC connection.</li>\n<li>Then opened my DB and ran the CreateDSNConnection code</li>\n<li>That put the UserDSN back in, and was set to use SQL Server Authentication, but was using my Windows login</li>\n<li>Deleted all linked tables and views</li>\n<li>Recreated the links for tables and views using the Generic SQL login account and checked the Save password option</li>\n<li>Compacted &amp; Repaired</li>\n<li>Sent to a user to test...it worked</li>\n</ul>\n\n<p>I had tried every one of these steps multiple times...except for the first one.  I'm guessing that there was something corrupted in the UserDSN file???  I have no idea.  But deleting it and starting over completely resolved the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 15036, "user_id": 2893376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rDwgj.jpg?s=128&g=1", "display_name": "gofr1", "link": "https://stackoverflow.com/users/2893376/gofr1"}, "is_accepted": false, "score": 0, "last_activity_date": 1450962736, "creation_date": 1450962736, "answer_id": 34453346, "question_id": 34442002, "link": "https://stackoverflow.com/questions/34442002/force-ms-access-odbc-connection-to-use-sql-server-authentication/34453346#34453346", "title": "Force MS Access ODBC Connection to use SQL Server Authentication", "body": "<pre><code>Dim CurConn As ADODB.Connection\nSet CurConn = New ADODB.Connection\nCurConn.Open \"Provider=myProvider;\" &amp; _\n             \"Server=myServer;\" &amp; _\n             \"Database=myDatabase;\" &amp; _\n             \"Trusted_Connection=no;\" &amp; _\n             \"User Id=myUsername;\" &amp; _\n             \"Password=myPassword;\"\n</code></pre>\n\n<p>This, how I do it in Access VBA.</p>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2593, "favorite_count": 1, "accepted_answer_id": 34444498, "answer_count": 3, "score": 0, "last_activity_date": 1450962736, "creation_date": 1450896914, "question_id": 34442002, "link": "https://stackoverflow.com/questions/34442002/force-ms-access-odbc-connection-to-use-sql-server-authentication", "title": "Force MS Access ODBC Connection to use SQL Server Authentication", "body": "<p>I'm using the following code that is run from my Autoexec macro to make the ODBC connection.</p>\n\n<pre><code>'Name     :   CreateDSNConnection\n'Purpose  :   Create a DSN to link tables to SQL Server\n'Parameters\n'     sServer: Name of SQL Server that you are linking to\n'     sDatabase: Name of the SQL Server database that you are linking to\n'     sUsername: Name of the SQL Server user who can connect to SQL Server, leave blank to use a Trusted Connection\n'     sPassword: SQL Server user password\nPublic Function CreateDSNConnection(sServer As String, sDatabase As String, sUsername As String, sPassword As String) As Boolean\nDim sConnect As String\nOn Error GoTo CreateDSNConnection_Err\n\n  If Len(sUsername) = 0 Then\n    '//Use trusted authentication if stUsername is not supplied.\n    sConnect = \"Description=DBTraining\" &amp; vbCr &amp; \"SERVER=\" &amp; sServer &amp; vbCr &amp; \"DATABASE=\" &amp; sDatabase &amp; vbCr &amp; \"Trusted_Connection=Yes\"\n  Else\n    sConnect = \"Description=DBTraining\" &amp; vbCr &amp; \"SERVER=\" &amp; sServer &amp; vbCr &amp; \"DATABASE=\" &amp; sDatabase\n  End If\n\n  DBEngine.RegisterDatabase \"DBTraining\", \"SQL Server\", True, sConnect\n\n  'Add error checking.\n  CreateDSNConnection = True\n  Debug.Print \"Connection made\"\n  Exit Function\n\nCreateDSNConnection_Err:\n  CreateDSNConnection = False\n  MsgBox \"CreateDSNConnection encountered an unexpected error: \" &amp; Err.Description, vbCritical, \"Unexpected Error!\"\n\nEnd Function\n</code></pre>\n\n<p>Pretty standard stuff...but it seems that the ODBC connection is always setup as using Windows auth and I need it setup to use SQL Server auth.  I've tried dropping in the <code>UID=</code> and <code>PWD=</code>, but it still tries to use Windows.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450897731, "post_id": 34441654, "comment_id": 56625901, "body": "Have you placed a breakpoint on the failing line and examined the content of &#39;Me.cboLoginName.Value&#39; ... and I assume that is numeric, else you need quotes around the string."}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450906384, "post_id": 34441654, "comment_id": 56629792, "body": "Everything worked fine before I added JobTitle to qry for the combobox. There were only EmployeeID, Employee Name: [FirstName] &amp; &quot; &quot; &amp; [LastName]. But I needed to have JobTitle for other things. Probably code doesn&#39;t know which field to take."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450906662, "post_id": 34441654, "comment_id": 56629915, "body": "Put the breakpoint in, view the content of Me.cboLoginName.Value. It may not be what you expect ... i.e. adding a column to the combobox may have shifted your column alignment... soundls like &#39;Admin&#39; is a job title????"}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450906914, "post_id": 34441654, "comment_id": 56630047, "body": "me.cboLoginName.Value = admin.  And &quot;Admin&quot; it is a username"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450907402, "post_id": 34441654, "comment_id": 56630265, "body": "So, does that translate into: Find the &#39;password&#39; field in table &#39;tblEmployees&#39; where the &#39;EmployeeID&#39; = &#39;Admin&#39;? Is &#39;EmployeeID&#39; a numeric field? If not, I earlier suggested quotes; but now knowing it is alpha, you need quotes. But I think the issue is with using the wrong column (you did say Admin is a user name and not an &#39;EmpID&#39;)"}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450908035, "post_id": 34441654, "comment_id": 56630540, "body": "EmployeeID is autonumber, &quot;Admin&quot; is a Last name and no first name, but other employees have First and Last. I tried to use quotes for Me.cboLoginName.Value as <code>If Me.tbxPassword.Value = DLookup(&quot;[Password]&quot;, &quot;tblEmployees&quot;, &quot;[EmployeeID]=&#39;&quot; &amp; Me.cboLoginName.Value &amp; &quot;&#39;&quot;) Then</code>"}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450908437, "post_id": 34441654, "comment_id": 56630719, "body": "Yes, I think it uses wrong column. And that&#39;s why I tried to change code to .."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450908505, "post_id": 34441654, "comment_id": 56630748, "body": "Let&#39;s reset now: (1) EmpID is an AutoNumber, which means it is numeric - not alpha; (2) Your combobox column contains &#39;Admin&#39;, which is NOT numeric; (3) Either you are using: (a) the wrong combobox column, or (b) the wrong field to search the table with. I would use the breakpoint, then in the immediate window, check column 0, 1, 2, 3... until you find the EmpID, then use that column in your DLookup."}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450908635, "post_id": 34441654, "comment_id": 56630795, "body": "<code>If IsNull(Me.cboLoginName.Column(1)) Or Me.cboLoginName = &quot;&quot; Then MsgBox &quot;You must select an employee name.&quot;, vbOKOnly, &quot;Required data&quot; Me.cboLoginName.Column(1).SetFocus Exit Sub End If If IsNull(Me.tbxPassword) Or Me.tbxPassword = &quot;&quot; Then MsgBox &quot;You must enter a password&quot;, vbOKOnly, &quot;Required data&quot; Me.tbxPassword.SetFocus Exit Sub End If  If Me.tbxPassword.Value = DLookup(&quot;Password&quot;, &quot;tblEmployees&quot;, &quot;[EmployeeID]=&quot; &amp; Me.cboLoginName.Value) Then  Me.Visible = False &#39;DoCmd.OpenForm &quot;frmAllCrossings&quot; DoCmd.OpenForm &quot;frmEntry&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1450915910, "post_id": 34444692, "comment_id": 56633221, "body": "THank you, I will try this, and let you know how it will work"}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451926358, "post_id": 34444692, "comment_id": 56937149, "body": "When I added this code before the DLookup it showed me i=4 (but I have only 3 columns (0,1,2) in my query in the combobox)."}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451927720, "post_id": 34444692, "comment_id": 56937884, "body": "When I am trying this <code>If Me.tbxPassword.Value = DLookup(&quot;[Password]&quot;, &quot;tblEmployees&quot;, &quot;[EmployeeID]= &#39;&quot; &amp; Me.cboLoginName.Column(1) &amp; &quot;&#39;&quot;) Then</code> I am receiving Run-time error 3464 (Data type mismatch in criteria expression)."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451930738, "post_id": 34444692, "comment_id": 56939561, "body": "I think we are having a problem understanding one another. You say there are only three columns in your query, yet above you say you added &#39;JobTitle&#39;, which would have been the 4th. You also say my code shows &#39;i=4&#39;, but you never mention the other data like &quot;Column n contains &#39;????&#39; Please show the entire results ... you have a mismatch between your query, combobox and which column you are selecting. This code is wrong: &quot;DLookup(&quot;Password&quot;, &quot;tblEmployees&quot;, &quot;[EmployeeID]=&quot; &amp; Me.cboLoginName.Value)&quot; - unless cboLoginName contains the EmployeeID - or you specify the correct column."}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451933213, "post_id": 34444692, "comment_id": 56940934, "body": "Yes, I added &quot;Job Title&quot; and it is a 3rd column. And I mentioned that my query contains 3 columns in my question - in very beginning. Also, when I add your code to my existing one before DLookup, it doesn&#39;t give me exact result, just the same error with highlighted line - nothing new), and when I hover mouse <code>&quot; &amp; i &amp;  &quot;</code>it shows me i=4. Also <code>DLookup(&quot;Password&quot;, &quot;tblEmployees&quot;, &quot;[EmployeeID]=&quot; &amp; Me.cboLoginName.Value)</code> works perfectly without new added Job Title field to the query (where cboLoginName contains the EmployeeID and Employee Name: [FirstName] &amp; &quot; &quot; &amp; [LastName]  columns)."}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451933411, "post_id": 34444692, "comment_id": 56941028, "body": "I am just trying to find a solution, not to make you confused. I am working with vba not for a long time, that&#39;s why asking people here for help."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451934132, "post_id": 34444692, "comment_id": 56941433, "body": "You need to look in the &#39;Immediate Window&#39; for the results of my &#39;Debug.Print&#39; Since you see &#39;I=4&#39;, that means there have been THREE prior displays made to the Immediate Window. It is very important as to what value is shown for 0, 1, and 2. I&#39;m guessing you added &#39;JobTitle&#39; to the query BEFORE the EmployeeID and EmployeeName fields? If so, that is the issue: you need to change &quot;.Column(1)&quot; to &quot;.Column(2)&quot;, but it would be really simple if you could confirm that by showing the results from the Immediate Window."}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451934324, "post_id": 34444692, "comment_id": 56941540, "body": "No, it is last one. I added a screenshot of my query to the question. Immediate window shows me <code>Column 0 contains &#39;8&#39;</code> <code>Column 1 contains &#39;admin &#39;</code> <code>Column 2 contains &#39;test test&#39;</code>  (8 - EmployeeID, admin - Employee Name: [FirstName] &amp; &quot; &quot; &amp; [LastName], test test - job title)"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451936409, "post_id": 34444692, "comment_id": 56942611, "body": "(1) What is the setting for &#39;Bound Column&#39; for cboLoginName? It should be 1. (2) Is table field EmployeeID defined as a numeric field?"}, {"owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "edited": false, "score": 0, "creation_date": 1451938146, "post_id": 34444692, "comment_id": 56943536, "body": "The settings for &quot;Bound Column&#39; for cboLoginName was 2 (I think I changed it accidentally because it was suppose to be 1). So, I changed it back to 1 and now it works! Thank you very much for your patience and help!"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 0, "last_activity_date": 1450909625, "creation_date": 1450909625, "answer_id": 34444692, "question_id": 34441654, "link": "https://stackoverflow.com/questions/34441654/run-time-error-2471-access-vba/34444692#34444692", "title": "Run-time error 2471 access vba", "body": "<p>Since I don't know the rowsource of your combobox or the number of columns your control specifies, paste the following code before your DLookup and see which column you should be using:</p>\n\n<pre><code>Dim i As Integer\nFor i = 0 To Me.cboLoginName.ColumnCount\n    Debug.Print \"Column \" &amp; i &amp; \" contains '\" &amp; Me.cboLoginName.Column(i) &amp; \"'\"\nNext i\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5441998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4d54962022ffb003d619e04c535e5e4?s=128&d=identicon&r=PG&f=1", "display_name": "O.Baklanova", "link": "https://stackoverflow.com/users/5441998/o-baklanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1636, "favorite_count": 0, "accepted_answer_id": 34444692, "answer_count": 1, "score": 0, "last_activity_date": 1451926725, "creation_date": 1450895341, "last_edit_date": 1451926725, "question_id": 34441654, "link": "https://stackoverflow.com/questions/34441654/run-time-error-2471-access-vba", "title": "Run-time error 2471 access vba", "body": "<p>Please, HELP\nI have a login form where Combo box contains 3 fields (EmployeeID, Employee Name: [FirstName] &amp; \" \" &amp; [LastName], JobTitle - qry picked). In dropdown list is only one field shown (properties set 0', 1', 0' width). Also frmLogin contains a text box to enter a password and there are two hidden text boxes (Name and JobTitle for other functions to perform). When I choose the UserName, hidden boxes are populated; however, when I enter password, the popup window shows up with Run-time error \u20182471\u2019 - The expression you entered as a query parameter produced the following error: \u2018admin\u2019.</p>\n\n<p>Here is a code to log in.</p>\n\n<pre><code>Private Sub cmdLogin_Click()\n\nIf IsNull(Me.cboLoginName) Or Me.cboLoginName = \"\" Then\nMsgBox \"You must select an employee name.\", vbOKOnly, \"Required data\"\nMe.cboLoginName.SetFocus\nExit Sub\nEnd If\n\nIf IsNull(Me.tbxPassword) Or Me.tbxPassword = \"\" Then\nMsgBox \"You must enter a password\", vbOKOnly, \"Required data\"\nMe.tbxPassword.SetFocus\nExit Sub\nEnd If\n'next line is highlighted as error\nIf Me.tbxPassword.Value = DLookup(\"Password\", \"tblEmployees\", \"[EmployeeID]=\" &amp; Me.cboLoginName.Value) Then\nMe.Visible = False\nDoCmd.OpenForm \"frmEntry\"\nElse\n\nMsgBox \"Invalid employee name / password combination. Please try again.\", vbOKOnly, \"Invalid Entry!\"\nMe.tbxPassword.SetFocus\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/YyKR5.jpg\" rel=\"nofollow\">Query for the combobox</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117, "user_id": 5711614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/202f38c51ff768ea2746401fd8bdd455?s=128&d=identicon&r=PG&f=1", "display_name": "dan6657", "link": "https://stackoverflow.com/users/5711614/dan6657"}, "edited": false, "score": 0, "creation_date": 1450894523, "post_id": 34441331, "comment_id": 56624397, "body": "Sorry I should&#39;ve elaborated more i&#39;ve edited my original question."}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1450894577, "post_id": 34441331, "comment_id": 56624428, "body": "In your for each line you need to give it a collection. <code>For Each cell In Range(&quot;D32:AE32&quot;).Cells</code> will give you all the cells in that range. I&#39;ll elaborate in an answer."}, {"owner": {"reputation": 117, "user_id": 5711614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/202f38c51ff768ea2746401fd8bdd455?s=128&d=identicon&r=PG&f=1", "display_name": "dan6657", "link": "https://stackoverflow.com/users/5711614/dan6657"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1450894680, "post_id": 34441331, "comment_id": 56624479, "body": "Awesome, but how would I get the values to update throughout the row?"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5711614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/202f38c51ff768ea2746401fd8bdd455?s=128&d=identicon&r=PG&f=1", "display_name": "dan6657", "link": "https://stackoverflow.com/users/5711614/dan6657"}, "edited": false, "score": 0, "creation_date": 1450895309, "post_id": 34441489, "comment_id": 56624779, "body": "This seems to only change column D. Not s(when s32 is 0 and s15 is 2) I&#39;ll work with it though thanks!"}], "tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": true, "score": 2, "last_activity_date": 1450957851, "last_edit_date": 1450957851, "creation_date": 1450894645, "answer_id": 34441489, "question_id": 34441331, "link": "https://stackoverflow.com/questions/34441331/for-each-loop-ranges-vba-excel-macro/34441489#34441489", "title": "For Each Loop Ranges VBA Excel Macro", "body": "<p>Try this, you're on the right track:  </p>\n\n<pre><code>Sub ChgValues()\n    Dim c As Range, d As Range\n\n    For Each c In Range(\"D15:AE15\")\n        Set d = c.Offset(17, 0)\n        If c.Value = 0 And d.Value = 2 Then\n            c.Value = 1\n            d.Value = 1\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p><strong>edit:</strong><br>\nThe above code will check for a 0 in row 15 and a 2 in row 32, for all columns from D to AE. If the values could also be the other way around (2 in row 15, 0 in row 32) then an additional comparison is needed:  </p>\n\n<p>change</p>\n\n<pre><code>If c.Value = 0 And d.Value = 2 Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If (c.Value = 0 And d.Value = 2) or (c.Value = 2 And d.Value = 0) Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "is_accepted": false, "score": 1, "last_activity_date": 1450894675, "creation_date": 1450894675, "answer_id": 34441495, "question_id": 34441331, "link": "https://stackoverflow.com/questions/34441331/for-each-loop-ranges-vba-excel-macro/34441495#34441495", "title": "For Each Loop Ranges VBA Excel Macro", "body": "<p>You need to give the for each loop a collection and then check values.</p>\n\n<pre><code>Dim cell As Range\nFor Each cell In Range(\"D15:AE15\").Cells\n    If cell.Value = 0 And cell.Offset(17).Value = 2 Then\n        cell.Value = 1\n        cell.Offset(17).Value = 1\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5711614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/202f38c51ff768ea2746401fd8bdd455?s=128&d=identicon&r=PG&f=1", "display_name": "dan6657", "link": "https://stackoverflow.com/users/5711614/dan6657"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4555, "favorite_count": 0, "accepted_answer_id": 34441489, "answer_count": 2, "score": 0, "last_activity_date": 1450958740, "creation_date": 1450893872, "last_edit_date": 1450894967, "question_id": 34441331, "link": "https://stackoverflow.com/questions/34441331/for-each-loop-ranges-vba-excel-macro", "title": "For Each Loop Ranges VBA Excel Macro", "body": "<pre><code>If Range(\"D32\").Value = 2 Then\n   If Range(\"D15\").Value = 0 Then\n      Range(\"D15\").Value = 1\n      Range(\"D32\").Value = 1\n   End If\nEnd If\n</code></pre>\n\n<p>I've been trying to figure out how to put these values within a for each loop.</p>\n\n<p>Basically if D15->AE15 = 2 and D32->AE32 = 0 change both of the values to 1.</p>\n\n<p>I thought about repeating the above nested IF statement for every cell.. but that would take a bit of time.</p>\n\n<pre><code>For Each c In Worksheets(\"sheet1\").Range(\"D32:AE32\").Value\n\nIf Range(\"D32\") = 2 Then\n\n\nRange(\"D15\").Value = 1\nRange(\"D32\").Value = 1\n\nEnd If\nNext c\n</code></pre>\n\n<p>That works for one cell. However i'm stumped on how to get it to check the whole row and then change the corresponding column values for 15 and 32 when one is 2.</p>\n"}, {"tags": ["html", "vba", "variables"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450894417, "post_id": 34441156, "comment_id": 56624345, "body": "Would help to provide an example of what the final link should look like.  It&#39;s not clear from your code."}, {"owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450902312, "post_id": 34441156, "comment_id": 56628056, "body": "Thanks, I can see from your answer the quotation marks were missing in some places."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1450895776, "creation_date": 1450895776, "answer_id": 34441731, "question_id": 34441156, "link": "https://stackoverflow.com/questions/34441156/outlook-vba-variable-into-html-body/34441731#34441731", "title": "Outlook VBA variable into HTML Body", "body": "<pre><code>.HTMLBody = \"&lt;style&gt; body{color:black;font-family:Arial;font-size: 12pt;} &lt;/style&gt;\" &amp; _\n      \"&lt;HTML&gt;&lt;body&gt;Dear Member,&lt;br&gt;&lt;br&gt;&amp;emsp;\" &amp; _\n      \"The following document is ready for your review. \" &amp; _\n     \"&lt;a href= 'http://www.bluewave.com/\" &amp; strTrackingNumber &amp; \"'&gt;Tracking \" &amp; _\n      strTrackingNumber &amp; \".&lt;/a&gt;&lt;/body&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11480, "favorite_count": 0, "accepted_answer_id": 34441731, "answer_count": 1, "score": 1, "last_activity_date": 1450895776, "creation_date": 1450893110, "last_edit_date": 1450894793, "question_id": 34441156, "link": "https://stackoverflow.com/questions/34441156/outlook-vba-variable-into-html-body", "title": "Outlook VBA variable into HTML Body", "body": "<p>I created an Macro in MS Outlook for an email. The user inputs an answer to a question which results in a variable storing that data as a string. An email is then generated in HTML with a hyperlink containing that variable. I can't seem to figure out how to concatenate the variable \"strTrackingNumber\" into the complete hyperlink. Any suggestions?</p>\n\n<hr>\n\n<pre><code>Option Explicit\nSub TestFile\n\nDim strTrackingNumber as String\nstrTrackingNumber = InputBox(\"Please input the Tracking Number\")\nSet objMsg = Application.CreateItem(olMailItem)\n\n With objMsg\n  .To = \"mickey.smith@surfer.com\"\n  .CC = \"\"\n  .BCC = \"\"\n  .Subject = \"Forecast\"\n  .Categories = \"\"\n  .BodyFormat = olFormatHTML ' send HTML message\n  .HTMLBody = \"&lt;style&gt; body{color:black;font-family:Arial;font-size: 12pt;}\" &amp; _\n\"&lt;HTML&gt;&lt;body&gt;Dear Member,&lt;br&gt;&lt;br&gt;&amp;emsp;The following document is ready for your review.\"&lt;a href= 'http://www.bluewave.com/' &amp; strTrackingNumber&gt;Tracking &amp; strTrackingNumber.&lt;/a&gt;&lt;/body&gt;\n\n.Display\nEnd With\nSet objMsg = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Output link should look like this: <a href=\"http://www.bluewave.com/Tracking\" rel=\"nofollow\">http://www.bluewave.com/Tracking</a> Number\ne.g. <a href=\"http://www.bluewave.com/RA-15-30922\" rel=\"nofollow\">http://www.bluewave.com/RA-15-30922</a></p>\n"}, {"tags": ["vba", "excel", "window", "user32"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450892330, "post_id": 34440961, "comment_id": 56623264, "body": "Someone called? XD Check the first question I ever asked."}, {"owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450892724, "post_id": 34440961, "comment_id": 56623493, "body": "Hi Findwindow can you help me with the solution"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450892970, "post_id": 34440961, "comment_id": 56623624, "body": "Maybe try <code>instr</code>? I don&#39;t know."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450893578, "post_id": 34440961, "comment_id": 56623925, "body": "just an idea - can you find a way to loop through all the windows and return their names, then use an <code>Instr</code> to check for the name you are looking for?"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450900233, "post_id": 34440961, "comment_id": 56627119, "body": "What I do is I create a collection of Arrays which include the handle (hwnd) and the title for all the windows that are currently open.  Then I use various methods (Instr also works) to loop through the collection and find the partial matches that way.  I don&#39;t know if there is an easier way to do that."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "edited": false, "score": 0, "creation_date": 1450924015, "post_id": 34445538, "comment_id": 56634990, "body": "Thanks Comintem. Your code worked for me, just did some minor modification in the code and it worked."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "edited": false, "score": 0, "creation_date": 1486125919, "post_id": 34445538, "comment_id": 71223107, "body": "@RAJATHEVAR, then you can accept the solution as an answer."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 6, "last_activity_date": 1450963680, "last_edit_date": 1450963680, "creation_date": 1450915289, "answer_id": 34445538, "question_id": 34440961, "link": "https://stackoverflow.com/questions/34440961/how-to-locate-the-window-using-findwindow-function-in-windowapi-using-vba/34445538#34445538", "title": "How to locate the window using findwindow function in windowapi using vba?", "body": "<p>One way you can do this is with the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633497%28v=vs.85%29.aspx\" rel=\"noreferrer\">EnumWindows</a> API function.  Since it operates via a callback function, you'll need to cache both the criteria and the results somewhere that has scope beyond the calling function:</p>\n\n<pre><code>Public Declare Function EnumWindows Lib \"user32\" (ByVal lpEnumFunc As Long, _\n                                                  ByVal param As Long) As Long\nPublic Declare Function IsWindowVisible Lib \"User32\" (ByVal hWnd As Long) As Long\nPublic Declare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" _\n                                                 (ByVal hwnd As Long, _\n                                                  ByVal lpString As String, _\n                                                  ByVal cch As Long) As Long\nPublic Const MAX_LEN = 260\n\nPublic results As Dictionary\nPublic criteria As String\n\nPublic Sub Example()\n    criteria = \"win32*\"\n    Set results = New Dictionary\n    Call EnumWindows(AddressOf EnumWindowCallback, &amp;H0)\n    Dim result As Variant\n    For Each result In results.Keys\n        Debug.Print result &amp; \" - \" &amp; results(result)\n    Next result\nEnd Sub\n\nPublic Function EnumWindowCallback(ByVal hwnd As Long, ByVal param As Long) As Long\n    Dim retValue As Long\n    Dim buffer As String       \n    If IsWindowVisible(hwnd) Then\n        buffer = Space$(MAX_LEN)\n        retValue = GetWindowText(hwnd, buffer, Len(buffer))\n        If retValue Then\n            If buffer Like criteria Then\n                results.Add hwnd, Left$(buffer, retValue)\n            End If\n        End If\n    End If\n    EnumWindowCallback = 1\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "is_accepted": false, "score": 2, "last_activity_date": 1450924237, "creation_date": 1450924237, "answer_id": 34446521, "question_id": 34440961, "link": "https://stackoverflow.com/questions/34440961/how-to-locate-the-window-using-findwindow-function-in-windowapi-using-vba/34446521#34446521", "title": "How to locate the window using findwindow function in windowapi using vba?", "body": "<p>The below code worked for me. Just Declared IsWindowVisible Function and Added Microsoft scripting runtime library to my project.</p>\n\n<pre><code>Public Declare Function EnumWindows Lib \"User32\" (ByVal lpEnumFunc As Long, _\n                                                  ByVal param As Long) As Long\nPublic Declare Function GetWindowText Lib \"User32\" Alias \"GetWindowTextA\" _\n                                                 (ByVal hWnd As Long, _\n                                                  ByVal lpString As String, _\n                                                  ByVal cch As Long) As Long\nPublic Declare Function IsWindowVisible Lib \"User32\" (ByVal hWnd As Long) As Long\nPublic Const MAX_LEN = 260\n\nPublic results As Dictionary\nPublic criteria As String\n\nPublic Sub Example()\n    criteria = \"win32\"\n    Set results = New Dictionary\n    Call EnumWindows(AddressOf EnumWindowCallback, &amp;H0)\n    Dim result As Variant\n    For Each result In results.Keys\n        Debug.Print result &amp; \" - \" &amp; results(result)\n    Next result\nEnd Sub\n\nPublic Function EnumWindowCallback(ByVal hWnd As Long, ByVal param As Long) As Long\n    Dim retValue As Long\n    Dim buffer As String\n    If IsWindowVisible(hWnd) Then\n        buffer = Space$(MAX_LEN)\n        retValue = GetWindowText(hWnd, buffer, Len(buffer))\n        If retValue Then\n\n            If InStr(1, buffer, criteria, vbTextCompare) &gt; 0 Then\n                results.Add hWnd, Left$(buffer, retValue)\n            End If\n        End If\n    End If\n    EnumWindowCallback = 1\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8122, "favorite_count": 1, "accepted_answer_id": 34445538, "answer_count": 2, "score": 6, "last_activity_date": 1450963680, "creation_date": 1450892183, "last_edit_date": 1531164843, "question_id": 34440961, "link": "https://stackoverflow.com/questions/34440961/how-to-locate-the-window-using-findwindow-function-in-windowapi-using-vba", "title": "How to locate the window using findwindow function in windowapi using vba?", "body": "<p>I am currently trying to find a way to check whether a window is open or not using Findwindow Function. I am able to find the window if i know the entire name of the window. In the below  code i know that the name of the window is \"win32api - Notepad\" so i can easily find the window however i want to know whether it is possible to identify the window if i know only part name like \"win32*\".</p>\n\n<pre><code>Public Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nSub runapplication()\n\n\nhwnd = FindWindow(vbNullString, \"win32api - Notepad\")\nMsgBox (hwnd)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 3, "creation_date": 1450889583, "post_id": 34440192, "comment_id": 56621711, "body": "<code>AdjColWidth</code> must be less than or equal to 255.  I&#39;m assuming your getting an error, and I&#39;m assuming it is <code>AdjColWidth</code> is greater than what is allowed."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450889779, "post_id": 34440192, "comment_id": 56621831, "body": "@Demetri you nailed it right on the head.   Here is a link to the limits for excel <a href=\"https://support.office.com/en-my/article/Excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\" rel=\"nofollow noreferrer\">support.office.com/en-my/article/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450890067, "post_id": 34440192, "comment_id": 56622009, "body": "Shouldn&#39;t <code>AdjColWidth = WinWidth - RangeWidth &#47; 2</code> be <code>AdjColWidth = (WinWidth - RangeWidth) &#47; 2</code> ? I mean I know there are limits, but on a 1080p screen a column nearly expands to the whole width at 100% zoom - the number produced by the second formula should be quite a bit smaller (but as you guys say you should check that it&#39;s less than 255 before setting it)."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1450890205, "post_id": 34440192, "comment_id": 56622098, "body": "@NickDewitt   yes  otherwise the division happens before the subtraction"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450890250, "post_id": 34440192, "comment_id": 56622115, "body": "Yeah and you get a larger number than you expect - added to my comment above"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 1, "creation_date": 1450890585, "post_id": 34440192, "comment_id": 56622296, "body": "It&#39;s also worth noting that <code>Activewindow.UsableWidth</code> is in points, whereas one unit of <code>columnwidth</code> is equal to the width of one character in the Normal style"}, {"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450891993, "post_id": 34440192, "comment_id": 56623067, "body": "I think you guys are absolutely right about the error coming fram greather than 255. So i have to make an if that states that if AdjColWidth&gt;=255 set to 254 or something. About the issue raised by Nick Points vs Character. Any ideas on how to solve that?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450966773, "post_id": 34450833, "comment_id": 56649749, "body": "This look promising. Will give it a try and report Back as soon as i get some free time and all the christmas presents are opened. Happy christmas holiday everyone :)"}, {"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1451068238, "post_id": 34450833, "comment_id": 56672672, "body": "It worked great. The last thing to figure out is to run this every time a user changes the active window size or use zoom. Im not actually sure its possible to make this a realtime thing."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": true, "score": 3, "last_activity_date": 1450951001, "creation_date": 1450951001, "answer_id": 34450833, "question_id": 34440192, "link": "https://stackoverflow.com/questions/34440192/excel-vba-calculate-and-set-column-width/34450833#34450833", "title": "Excel VBA calculate and set column width", "body": "<p>Based on my comments, something like below should work. I worked out the ratio of points to columnwidth directly in the code, as this could change based on the font size of the normal style.</p>\n\n<pre><code>Sub TestWH()\n\n'Get widths\nWinWidth = ActiveWindow.UsableWidth\n\n'work out the ratio between pixels and columnwidth\nratio = ActiveSheet.Columns(1).ColumnWidth / ActiveSheet.Columns(1).Width\n\nRangeWidth = ActiveSheet.Range(\"B1:AE1\").Width\n\n'work out the size in columnwidth values\nadjcolwidth = ((WinWidth - RangeWidth) / 2) * ratio\n\n'If less than 4 then set to 4\nIf adjcolwidth &lt; 4 Then\n    Range(\"A:A\").ColumnWidth = 4\nElseIf adjcolwidth &lt; 255 Then\n    Range(\"A:A\").ColumnWidth = adjcolwidth\nElse\n    'what do you want to do if it's greater than 255?\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7203, "favorite_count": 2, "accepted_answer_id": 34450833, "answer_count": 1, "score": 3, "last_activity_date": 1450951001, "creation_date": 1450889046, "last_edit_date": 1450889434, "question_id": 34440192, "link": "https://stackoverflow.com/questions/34440192/excel-vba-calculate-and-set-column-width", "title": "Excel VBA calculate and set column width", "body": "<p>I'm trying the center the range from B:AE in the center of the screen by adjusting the width of column A.</p>\n\n<p>I'm able to change the width by adding the width as number instead of using AdjColWidth</p>\n\n<pre><code>Sub TestWH()\n\n'Get widths\nWinWidth = ActiveWindow.UsableWidth\nRangeWidth = ActiveSheet.Range(\"B1:AE1\").Width\nAdjColWidth = WinWidth - RangeWidth / 2\n\n'If less than 4 then set to 4\nIf AdjColWidth &lt; 4 Then\n    Range(\"A:A\").ColumnWidth = 4\nElse\n    Range(\"A:A\").ColumnWidth = AdjColWidth\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "with-statement"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450889294, "post_id": 34440065, "comment_id": 56621531, "body": "Great solution! I was able to add it right below my code line that is copying the data over. The only issue, it did color one line of my existing data in blue and didn&#39;t color the last line of my new data. Any idea how to get the highlighting to shift down by 1 line?"}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "reply_to_user": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450889545, "post_id": 34440065, "comment_id": 56621685, "body": "VBA will only do what you tell it to do.  I didn&#39;t spend much time with your code to figure out exactly where to color.  <code>Cells(j, 5) </code> is just a reference to the &quot;j&quot;th row and 5th column.  You can put any expression that evaluates to an integer there (like <code>Cells(j + 1, 5)</code>).  Looks like you also are printing something on <code>laws.Cells(RowMaster, k) = .Cells(i,k)</code> so that might be appropriate too."}, {"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450889768, "post_id": 34440065, "comment_id": 56621819, "body": "Awesome, I was able to add the +1 in the existing code and it worked perfect. Thanks again."}, {"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450890836, "post_id": 34440065, "comment_id": 56622446, "body": "How would I color the entire row of new data if I wanted to? Assume there are 5 columns? As you know, it currently is just highlighting the cell in the 5th column of each row."}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "reply_to_user": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450891532, "post_id": 34440065, "comment_id": 56622829, "body": "Lucky for you, the Range object has a <code>Range.EntireRow</code> property, which, predictably, refers to the entire row contained by the range.  <code>Cells(i,j)</code> is a Range object.  So you can use <code>Cells(i,j).EntireRow.Interior.Color</code>  For a reference guide to the Range object, see the following: <a href=\"https://msdn.microsoft.com/EN-US/library/office/dn301006.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/EN-US/library/office/dn301006.aspx</a>"}, {"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450891917, "post_id": 34440065, "comment_id": 56623034, "body": "The only issue with doing that (which seems to be the same result as laws.Rows(j)..Interior.Color = 8210719) is it highlights the ENTIRE row well beyond where my data ends column wise. Is there a way to limit it to only 5 columns width?"}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "reply_to_user": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1450893213, "post_id": 34440065, "comment_id": 56623755, "body": "To combine multiple cells into a range, you can use the <code>Range</code> function, and pass the start and end cell. <code>Range(laws.Cells(i,1), laws.Cells(i,5)).Interior.Color</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450894909, "post_id": 34440065, "comment_id": 56624583, "body": "<code>Cells(i, j).Resize(1, 5).Interior.Color = ...</code>"}], "tags": [], "owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "is_accepted": true, "score": 0, "last_activity_date": 1450888558, "creation_date": 1450888558, "answer_id": 34440065, "question_id": 34439976, "link": "https://stackoverflow.com/questions/34439976/highlight-new-data-being-copied-over/34440065#34440065", "title": "Highlight new data being copied over", "body": "<p>You can change the background of a cell using the <code>Range.Interior.Color</code> property.  It's a little tricky to figure out what number to put in there to get the right color.  I will usually find the color I want first, then determine the corresponding number, by selecting it and typing <code>?Selection.Interior.Color</code> into the immediate window, which will print the number immediately below.</p>\n\n<p>Try <code>laws.Cells(j, 5).Interior.Color = 8210719</code> on for size.</p>\n"}], "owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 34440065, "answer_count": 1, "score": 0, "last_activity_date": 1450888558, "creation_date": 1450888184, "last_edit_date": 1450888430, "question_id": 34439976, "link": "https://stackoverflow.com/questions/34439976/highlight-new-data-being-copied-over", "title": "Highlight new data being copied over", "body": "<p>I have the below coding that if there isn't a match, it copies over the \"new\" information (columns 1 to 9). Can someone please suggest code to add to highlight each new row of data that is added so I can easily discern between the existing data and new rows? Thanks!</p>\n\n<pre><code>Sub CompareSheets()\n\nDim laws As Worksheet\nSet laws = Sheets(\"LookAhead\")\nDim galreqws As Worksheet\nSet galreqws = Sheets(\"galreq\")\n\nDim RowsMaster As Integer, Rows2 As Integer\nRowsMaster = laws.Cells(1048576, 1).End(xlUp).Row\nRows2 = galreqws.Cells(1048576, 1).End(xlUp).Row\n' Get the number of used rows for each sheet\n\n\nWith Worksheets(\"galreq\")\n    For i = 2 To Rows2\n    ' Loop through Sheet 2\n        For j = 2 To RowsMaster\n        ' Loop through the Master sheet\n            If .Cells(i, 4) = laws.Cells(j, 4) And .Cells(i, 6) = laws.Cells(j, 6) And .Cells(i, 8) = laws.Cells(j, 8) Then\n            ' If a match is found:\n                laws.Cells(j, 5) = .Cells(i, 5)\n                ' Copy in contact info\n                Exit For\n                ' No point in continuing the search for that company\n            ElseIf j = RowsMaster Then\n            ' If we got to the end of the Master sheet\n            ' and haven't found a company match\n                RowsMaster = RowsMaster + 1\n                ' Increment the number of rows\n                For k = 1 To 9 ' Change 3 to however many fields Sheet2 has\n                    laws.Cells(RowsMaster, k) = .Cells(i, k)\n                    ' Copy the data from Sheet2 in on the bottom row of Master\n                Next\n            End If\n        Next j\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1450891117, "post_id": 34439641, "comment_id": 56622599, "body": "Problem is, that you will have overlapping week numbers around New Year. Can&#39;t you use the <i>ISO 8601</i> week numbers which work around this?"}, {"owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1450893820, "post_id": 34439641, "comment_id": 56624044, "body": "@Gustav, I just googled ISO 8601 week numbers to find out what actually it is. Is there any way you could direct me in the right direction with regards to how and what I need to do? Thank you"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450897216, "post_id": 34439641, "comment_id": 56625687, "body": "You don&#39;t need to relate weeks combo to year combo. So what do you want for week 1 of 2016? (1) The partial week that starts on Friday, Jan 1, or the full week that starts on Sunday Jan 3? Using ISO standard, Jan 1, 2016 is week 53."}, {"owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450897568, "post_id": 34439641, "comment_id": 56625834, "body": "@WayneG.Dunn: Alright. To my understanding, the first week of 2016 starts on January 3, 2016"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1450897840, "post_id": 34439641, "comment_id": 56625954, "body": "The crucial point is that ISO 8601 weeks begin Monday. Can you accept that?"}, {"owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1450898273, "post_id": 34439641, "comment_id": 56626196, "body": "@Gustav: From researching, I realized that ISO 8601 weeks begin on Monday, and my task requires me to start my week on a Sunday. Is there any work-around with this? Thank you all for your patience and sharing."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1450908216, "post_id": 34439641, "comment_id": 56630626, "body": "No, then you have to define your own method."}, {"owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1450908336, "post_id": 34439641, "comment_id": 56630679, "body": "@Gustav: Alright, thank you. Then I guess I might have to adjust to the ISO 8061 week number. Thanks again"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "edited": false, "score": 0, "creation_date": 1450907966, "post_id": 34442146, "comment_id": 56630514, "body": "Thank you for your input. I&#39;m trying to fully understand the VBA function you have provided. It&#39;s my first time using the &quot;Public Function&quot; . Could you please explain to me the last two lines, thus &quot;FirstThursday&quot; and &quot;WeekStartDate&quot;? Thus, the logic behind the equation? And also, does this code go into my After-update event of my <i>&quot;Week number&quot;</i> combo box? Or simply put, how do I use the function? I&#39;m sorry, I&#39;m just new to this.. :-( Thanks once again"}, {"owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "edited": false, "score": 0, "creation_date": 1451395752, "post_id": 34442146, "comment_id": 56764954, "body": "Thank you for your response. @Gord Thompson.. Even though I really wanted my week to start on a Sunday, I think I can be flexible on letting it start on a Monday (per ISO 8601). Thank you for your time and great clarification. I appreciate you and everyone else on here helping to share their great knowledge and expertise."}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1450912537, "last_edit_date": 1450912537, "creation_date": 1450897560, "answer_id": 34442146, "question_id": 34439641, "link": "https://stackoverflow.com/questions/34439641/populate-week-start-and-week-end-dates-given-the-year-and-week-number-in-ms-acce/34442146#34442146", "title": "Populate Week Start and Week End dates given the Year and Week Number in MS Access", "body": "<p>You can use a VBA function to calculate the week's start date. For example, with a form like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/g2M7I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g2M7I.png\" alt=\"frmWeekStart.png\"></a></p>\n\n<p>you can use form code like this</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPrivate Sub cboWeekNum_AfterUpdate()\n    UpdateStartEndDates\nEnd Sub\n\nPrivate Sub cboYear_AfterUpdate()\n    UpdateStartEndDates\nEnd Sub\n\nPrivate Sub UpdateStartEndDates()\n    Me.txtWeekStart.Value = WeekStartDate(Me.cboYear.Value, Me.cboWeekNum.Value)\n    Me.txtWeekEnd.Value = DateAdd(\"d\", 6, Me.txtWeekStart.Value)\nEnd Sub\n\nPrivate Function WeekStartDate(yyyy As Integer, ww As Integer) As Date\n    ' per ISO 8601, week starts on Monday\n    Dim Jan1 As Date\n    Jan1 = DateSerial(yyyy, 1, 1)\n    Dim Jan1Weekday As Integer\n    Jan1Weekday = Weekday(Jan1, vbThursday)\n    Dim FirstThursday As Date\n    ' per standard, Week 1 contains the first Thursday of the year\n    FirstThursday = DateAdd(\"d\", IIf(Jan1Weekday = 1, 0, 8 - Jan1Weekday), Jan1)\n    ' back up 3 days to Monday, then add 7 days for each week after Week 1\n    WeekStartDate = DateAdd(\"d\", -3 + (7 * (ww - 1)), FirstThursday)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5247913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5df4f99d4bc54ace93e3c7c0616e0d78?s=128&d=identicon&r=PG", "display_name": "b2amen", "link": "https://stackoverflow.com/users/5247913/b2amen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 34442146, "answer_count": 1, "score": 0, "last_activity_date": 1594642979, "creation_date": 1450887073, "last_edit_date": 1594642979, "question_id": 34439641, "link": "https://stackoverflow.com/questions/34439641/populate-week-start-and-week-end-dates-given-the-year-and-week-number-in-ms-acce", "title": "Populate Week Start and Week End dates given the Year and Week Number in MS Access", "body": "<p><br/>I have a combo box on access form from which a user can select a particular year, say 2014 from a drop-down. Another combo box exists on this form which has a drop-down of the week numbers from 1 to 53. These two combo boxes are not linked. (Or do I have to link/bound them?)<br/><br/>\nAlso, there are two text boxes named, <em>\"WeekStart\"</em> and <em>\"WeekEnd\"</em> on this form. <br/><br/> \nWhat I want to do is to have the week start and end dates for the selected week number and year to be populated in the <em>\"WeekStart\"</em> and <em>\"WeekEnd\"</em> textboxes. I'm starting my week on a Sunday. I put this code in the <em>\"After Update\"</em> event of the <em>\"week number\"</em> combo box.   </p>\n\n<blockquote>\n  <p><code>Me.WeekStart = DateSerial(Me.cboYear, 1, Me.cboWeekNum * 7)</code></p>\n</blockquote>\n\n<p>But I know this is not right, and I'm stucked. Any help would be appreciated. And also, is it essential that I bound the week number to the year? If so, how do I go about that too. Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450887012, "post_id": 34439574, "comment_id": 56620097, "body": "You don&#39;t need VBA for a dropdown and you can just do an <code>if</code> statement to force a <code>n</code>."}, {"owner": {"reputation": 1, "user_id": 5711795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc6fb202f04555a4f0fb1c6f9055edf?s=128&d=identicon&r=PG&f=1", "display_name": "Kilbury", "link": "https://stackoverflow.com/users/5711795/kilbury"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450887435, "post_id": 34439574, "comment_id": 56620364, "body": "But I need to have the option to manually select &quot;y&quot; or &quot;n&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450887437, "post_id": 34439574, "comment_id": 56620368, "body": "Hmm, how do you mean @findwindow? if he&#39;s using data validation for the dropdown in column 3 to set the value to &quot;y&quot; or &quot;n&quot; manually, how can he use a formula in that cell?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450887971, "post_id": 34439574, "comment_id": 56620702, "body": "Formula overrides data validation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 1, "creation_date": 1450888231, "post_id": 34439574, "comment_id": 56620878, "body": "Er no, if you have a cell with a formula and data validation for a list of &quot;y,n&quot; set up, and the user clicks the cell and chooses &quot;y&quot; the formula gets overwritten. He might have cases where neither cell is 0 and he wants the user to enter &quot;n&quot;.. you could do it in another column with <code>IF(OR(A1=0,B1=0),&quot;n&quot;,C1)</code> but not in the same cell."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450888377, "post_id": 34439574, "comment_id": 56620965, "body": "@NickDewitt Secret helper cell... containing the formula... and add conditional formatting with <code>&quot;n&quot;</code> if formula outputs n... if you know what I mean... and simply checking for the secret cell instead of the one with dropdown..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450888638, "post_id": 34439574, "comment_id": 56621117, "body": "Doing too many things at once."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450888741, "post_id": 34439574, "comment_id": 56621182, "body": "know that feeling lol, well I have added an example without using VBA to my answer anyway so both options are there, but he did ask for vba so ill leave the event driven option there too"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5711795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc6fb202f04555a4f0fb1c6f9055edf?s=128&d=identicon&r=PG&f=1", "display_name": "Kilbury", "link": "https://stackoverflow.com/users/5711795/kilbury"}, "edited": false, "score": 0, "creation_date": 1450889256, "post_id": 34439794, "comment_id": 56621510, "body": "This works brilliantly. Only problem I have is that if I change the &quot;n&quot; vale back to a &quot;y&quot; value without changing the &quot;0&quot; value in the other cell it crashes my excel. Is there any way to prevent this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 1, "user_id": 5711795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc6fb202f04555a4f0fb1c6f9055edf?s=128&d=identicon&r=PG&f=1", "display_name": "Kilbury", "link": "https://stackoverflow.com/users/5711795/kilbury"}, "edited": false, "score": 0, "creation_date": 1450889436, "post_id": 34439794, "comment_id": 56621606, "body": "I added a line before and after changing the cell to stop events firing, cos you were probably entering an infinite loop (oops!) :D"}, {"owner": {"reputation": 1, "user_id": 5711795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc6fb202f04555a4f0fb1c6f9055edf?s=128&d=identicon&r=PG&f=1", "display_name": "Kilbury", "link": "https://stackoverflow.com/users/5711795/kilbury"}, "edited": false, "score": 0, "creation_date": 1450893482, "post_id": 34439794, "comment_id": 56623877, "body": "Genius, Thank you so much!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 1, "user_id": 5711795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc6fb202f04555a4f0fb1c6f9055edf?s=128&d=identicon&r=PG&f=1", "display_name": "Kilbury", "link": "https://stackoverflow.com/users/5711795/kilbury"}, "edited": false, "score": 0, "creation_date": 1450894872, "post_id": 34439794, "comment_id": 56624573, "body": "No problem, but can you mark this as the answer please"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": false, "score": 0, "last_activity_date": 1450889400, "last_edit_date": 1450889400, "creation_date": 1450887577, "answer_id": 34439794, "question_id": 34439574, "link": "https://stackoverflow.com/questions/34439574/excel-vba-script-forced-value-by-value-in-another-cell/34439794#34439794", "title": "Excel VBA script &quot;forced value by value in another cell&quot;", "body": "<p><strong>OPTION 1 (No code)</strong></p>\n\n<p>You can add a fourth column, and set your other sheets to look at that column. If your values are in column A &amp; B, your data validation is in column C, then you could do some simple logic in column D and use that value as the reference:</p>\n\n<p><code>=IF(OR(A1=0,B1=0),\"n\",C1)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/8ZgTW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8ZgTW.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>OPTION 2 - VBA</strong></p>\n\n<p>Use the change event on the worksheet to check the values in the row when any of the cells change, and update to \"n\" if either value is equal to 0:</p>\n\n<p>Put this code inside the the module for the worksheet object you want it to run on (not in it's own module).</p>\n\n<p>note: I have set this to only run on columns 1-3 (<code>Target.Column &lt;=3</code>), you will need to change this if your columns are in different places.</p>\n\n<p>Also, I added the <code>application.enableevents</code> lines to stop the cell change triggering another cell change event and entering an infinite loop.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim ws As Worksheet\nSet ws = Target.Worksheet\n\nIf Target.Column &lt;= 3 Then\n    If ws.Cells(Target.Row, 1) = 0 Or ws.Cells(Target.Row, 2) = 0 Then\n        Application.EnableEvents = False\n        ws.Cells(Target.Row, 3) = \"n\"\n        Application.EnableEvents = True\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5711795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc6fb202f04555a4f0fb1c6f9055edf?s=128&d=identicon&r=PG&f=1", "display_name": "Kilbury", "link": "https://stackoverflow.com/users/5711795/kilbury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450889400, "creation_date": 1450886804, "last_edit_date": 1450889324, "question_id": 34439574, "link": "https://stackoverflow.com/questions/34439574/excel-vba-script-forced-value-by-value-in-another-cell", "title": "Excel VBA script &quot;forced value by value in another cell&quot;", "body": "<p>I have an excel spreadsheet with 3 columns that drive calculations in a separate section. Two of the columns are manual input and the third is a dropdown menu where you can select \"y\" or \"n\". I am trying to write a VBA code that allows you to select \"y\" or \"n\" from the dropdown menu, but if either of the manual entry columns are \"0\" it will automatically force a value of \"n\".</p>\n"}, {"tags": ["vba", "excel", "amazon-web-services", "web-scraping", "xmlhttprequest"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451503779, "post_id": 34439422, "comment_id": 56813551, "body": "Could you please slightly rework your question to make it more clear. Add what your code does, and what it does wrong, and also add description for the worksheet screenshot, and purpose of each column on it (what is given, and what is to be found)."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451568231, "post_id": 34439422, "comment_id": 56835762, "body": "Hey @omegastripes, I edited quite a few things in the questions. Please let me know if anything else needs clarification. I was pretty close on solving the puzzle, but I&#39;m not sure what I&#39;m missing."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1451393038, "post_id": 34443914, "comment_id": 56763335, "body": "It definitely helps, and it&#39;s a great solution, but VBA is what I&#39;m looking for. I tried it out and it works perfectly. I&#39;ll just have to tweak it some so that the code will exclude all that excess data in the second column. Definitely gave me some direction in the code - thank you, kind user."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1451484942, "post_id": 34443914, "comment_id": 56803702, "body": "Would you be able to assist me in trying to just using XML to reference the ASIN code? I&#39;m doing a small project on trying to obtain the position number (result number) of each product after the search page has loaded. I&#39;ve attached a screenshot of the spreadsheet for a list of product examples I&#39;ve pulled from one seller. Also, a few notes would be very helpful - I have almost no experience with XML."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1451487533, "post_id": 34443914, "comment_id": 56805095, "body": "Thank you! I&#39;m also working on trying to tweak the code. I&#39;m just having to re-learn the syntax for all of this. Loops are going to be a bit of a challenge, haha."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1451588318, "post_id": 34443914, "comment_id": 56843466, "body": "I got the bloody thing to work. It was just one snippet of code that I had to remove, and guess which one it was? The TDelement.ID. All I need to do now is to insert a function which allows the page to advance until Excel is able to find the ASIN number and afterwards move onto the next search term."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 3, "last_activity_date": 1452012320, "last_edit_date": 1452012320, "creation_date": 1450905717, "answer_id": 34443914, "question_id": 34439422, "link": "https://stackoverflow.com/questions/34439422/amazon-sales-data-with-excel-vba/34443914#34443914", "title": "Amazon Sales Data (with Excel VBA)", "body": "<p>Here is the example which downloads products from Amazon for each search query presented on the sheet <code>Terms</code>, and populates the sheet <code>Products</code> with ASINs and descriptions. It uses XHR, so IE isn't needed. The code is as follows: </p>\n\n<pre><code>Sub Test()\n    lngRow = 1\n    ' search each term\n    For Each strTerm In Sheets(\"Terms\").UsedRange\n        lngPage = 1\n        Do\n            ' HTTP GET request of the search result page\n            strUrl = \"https://www.amazon.com/s/ref=nb_sb_noss_2?page=\" &amp; lngPage &amp; \"&amp;keywords=\" &amp; EncodeUriComponent(strTerm)\n            Set objXHR = CreateObject(\"MSXML2.XMLHttp\")\n            objXHR.Open \"GET\", strUrl, False\n            objXHR.Send\n            strResp = objXHR.ResponseText\n            ' split response to array by items\n            arrResp = Split(strResp, \"&lt;li id=\"\"result_\")\n            ' process each item on the page\n            For i = 1 To UBound(arrResp)\n                strItem = arrResp(i)\n                ' extract ASIN\n                strTmp = Split(strItem, \"data-asin=\"\"\")(1)\n                strTmp = Split(strTmp, \"\"\"\")(0)\n                Sheets(\"Products\").Cells(lngRow, 1).NumberFormat = \"@\"\n                Sheets(\"Products\").Cells(lngRow, 1).Value = strTmp\n                ' extract the product description\n                strTmp = Split(\"&lt;li id=\"\"result_\" &amp; strItem, \"&lt;/li&gt;\")(0) &amp; \"&lt;/li&gt;\"\n                Sheets(\"Products\").Cells(lngRow, 2).Value = GetInnerText(strTmp)\n                ' show current item\n                Sheets(\"Products\").Cells(lngRow, 1).Select\n                ' next row\n                lngRow = lngRow + 1\n            Next\n            ' adjust sheet\n            Sheets(\"Products\").Columns.AutoFit\n            Sheets(\"Products\").Rows.AutoFit\n            ' next page\n            lngPage = lngPage + 1\n        Loop Until UBound(arrResp) = 0 ' empty search result\n    Next\nEnd Sub\n\nFunction EncodeUriComponent(strText)\n    Static objHtmlfile As Object\n    If objHtmlfile Is Nothing Then\n        Set objHtmlfile = CreateObject(\"htmlfile\")\n        objHtmlfile.parentWindow.execScript \"function encode(s) {return encodeURIComponent(s)}\", \"jscript\"\n    End If\n    EncodeUriComponent = objHtmlfile.parentWindow.encode(strText)\nEnd Function\n\nFunction GetInnerText(strHtmlContent)\n    Dim objHtmlFile, objBody\n    Set objHtmlFile = CreateObject(\"htmlfile\")\n    objHtmlFile.write strHtmlContent\n    Set objBody = objHtmlFile.getElementsByTagName(\"body\")(0)\n    GetInnerText = Trim(objBody.innerText)\nEnd Function\n</code></pre>\n\n<p>I placed on the <code>Terms</code> sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JAQWw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JAQWw.png\" alt=\"terms\"></a></p>\n\n<p>Results on the <code>Product</code> sheet contain 571 items:</p>\n\n<p><a href=\"https://i.stack.imgur.com/x3db7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x3db7.png\" alt=\"products\"></a></p>\n\n<p>It's not a complete answer, but I hope it helps you.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "is_accepted": false, "score": 0, "last_activity_date": 1451588509, "creation_date": 1451588509, "answer_id": 34550632, "question_id": 34439422, "link": "https://stackoverflow.com/questions/34439422/amazon-sales-data-with-excel-vba/34550632#34550632", "title": "Amazon Sales Data (with Excel VBA)", "body": "<p>Through trial and error, I finally solved this bloody thing. I just had to take out part of the code which included the \"And InStr(TDelement.ID, \"result\")\" and then everything ran smooth as butter. </p>\n"}], "owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2667, "favorite_count": 1, "accepted_answer_id": 34443914, "answer_count": 2, "score": 1, "last_activity_date": 1524350612, "creation_date": 1450886289, "last_edit_date": 1524350612, "question_id": 34439422, "link": "https://stackoverflow.com/questions/34439422/amazon-sales-data-with-excel-vba", "title": "Amazon Sales Data (with Excel VBA)", "body": "<p>I'm trying to obtain the result number (in the HTML code) of each keyword I search by means of Excel VBA. Narrowing down the criteria by className, id, and data-asin, but that last one is proving to be tricky since VBA doesn't support that reference library yet. </p>\n\n<p>What this code is structured to do:</p>\n\n<ol>\n<li><p>Go onto amazon.com and go to the search bar.</p></li>\n<li><p>The loop starts with column C. Pull a search term from the SearchTerm1 column and search.</p></li>\n<li><p>Once the results page is loaded, try and find the specified product by className, ID (both found in the HTML code), and ASIN number (this number is pulled from column B in order to match the data-asin value on the search results page). Without all 3 criteria, excel won't be able to find the product if it's listed on the first results page.</p></li>\n<li>If the product is found on the first page, grab its result position (eg. \"result_0\" for the first result and result_1 for the second) and puts it in column D (SRank1).</li>\n<li>If the product is not found, the loop keeps going anyways until the search term column is empty.</li>\n<li>If the product is not found on the first page, continue advancing pages and searching for the specified product in order to grab the \"search rank\" of the item.</li>\n<li>The same steps are repeated for columns SearchTerm2, 3, and 4.</li>\n</ol>\n\n<p>The screenshot below is the code only pulling based on the className and ID criteria, and it pulls the last product result from the page, which is not what my goal for analysation of how products are doing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7cNco.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7cNco.png\" alt=\"The code only pulls the last &quot;search rank&quot; from the page of results, not the result position of the actual product.\"></a></p>\n\n<p>The code included only pulls the product rank if the product is the first result on the search page, which means something is finally working, but is missing a step or two to grab all of the product positions from the page.\n<a href=\"https://i.stack.imgur.com/7hA8U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7hA8U.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fV7su.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fV7su.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help or push in the right direction would be highly appreciated. I wish VBA were more versatile for these kinds of sales research things. It's done wonders so far, but I may be reaching its limit. Code is below.</p>\n\n<pre><code>Sub AmazonSearchRank()\n\n    Dim MyHTML_Element As IHTMLElement\n    Dim MyURL As String\n\n    Dim AASearchRank As Workbook\n    Dim AAws As Worksheet\n    Dim InputSearchOrder As HTMLInputElement\n    Dim elems As IHTMLElementCollection\n    Dim TDelement As HTMLTableCell\n\n    Dim InputSearchButton As HTMLInputButtonElement\n    Dim IE As InternetExplorer\n    Dim AASearchTerms As Workbook\n    Dim SearchTermsSheet As Worksheet\n\n    Dim x As Integer\n    Dim i As Long\n\n    MyURL = \"https://www.amazon.com\"\n    Set IE = New InternetExplorer\n    With IE\n        .Silent = True\n        .Navigate MyURL\n        .Visible = True\n        Do\n            DoEvents\n        Loop Until .ReadyState = READYSTATE_COMPLETE\n    End With\n    Set HTMLDoc = IE.Document\n\n    Set AASearchRank = Application.Workbooks.Open(\"C:\\Users\\CompanyName\\Desktop\\Automation Anywhere\\Sample_Items_For_SearchRank.xls\")\n    Set AAws = AASearchRank.Worksheets(\"Sheet1\")\n\n    Set InputSearchButton = HTMLDoc.getElementById(\"nav-search-submit-text\")\n    Set InputSearchOrder = HTMLDoc.getElementById(\"twotabsearchbox\")\n    If Not InputSearchOrder Is Nothing Then\n        InputSearchButton.Click\n        Do\n            DoEvents\n        Loop Until IE.ReadyState = READYSTATE_COMPLETE\n    End If\n\n    x = 2\n    If AAws.Range(\"D\" &amp; x).Value = \"\" Then\n        Do Until AAws.Range(\"B\" &amp; x) = \"\"\n            Set InputSearchOrder = HTMLDoc.getElementById(\"twotabsearchtextbox\")\n            InputSearchOrder.Value = AAws.Range(\"C\" &amp; x)\n\n            Set InputSearchButton = HTMLDoc.getElementsByClassName(\"nav-input\")(0)\n            InputSearchButton.Click\n              Do\n                DoEvents\n            Loop Until IE.ReadyState = READYSTATE_COMPLETE\n            Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n            Set elems = HTMLDoc.getElementsByClassName(\"s-result-item celwidget\")\n            i = 2\n            For Each TDelement In elems\n                If TDelement.className = \"s-result-item celwidget\" And InStr(TDelement.ID, \"result\") InStr(TDelement.innerHTML, AAws.Range(\"B\" &amp; x).Value) Then\n                    AAws.Range(\"D\" &amp; x).Value = TDelement.ID\n                    i = i + 1\n                End If\n            Next\n        x = x + 1\n        Loop\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1450909259, "post_id": 34439374, "comment_id": 56631048, "body": "Could you show a screenshot of the raw table data before the macro runs? I can&#39;t figure out which data is where on the worksheet after the text to columns rips up the first column."}, {"owner": {"reputation": 75, "user_id": 5104582, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70b53947d3eaa59131176d25470f3074?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5104582/ben"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1451317532, "post_id": 34439374, "comment_id": 56734360, "body": "@SilentRevolution I&#39;ve included a screen shot of it. I was not sure of a simpler way to do the text to columns other than to record a macro and do it manually."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1451327545, "post_id": 34439374, "comment_id": 56739132, "body": "Doing something while recording a macro and then looking at the code is the way to learn if you ask me. I&#39;ll take a look at the screenshot when you post it. You could use the <code>split</code> function if you have a constant delimiter (a separating character) like a <code>,</code> or <code>-</code> or any other character between your bits of data."}, {"owner": {"reputation": 75, "user_id": 5104582, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70b53947d3eaa59131176d25470f3074?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5104582/ben"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1451341273, "post_id": 34439374, "comment_id": 56745021, "body": "@silentrevolution I just added the screenshot. It took awhile to work."}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1451439025, "creation_date": 1451439025, "answer_id": 34521685, "question_id": 34439374, "link": "https://stackoverflow.com/questions/34439374/vba-to-reorder-and-repeat-certain-text-columns/34521685#34521685", "title": "VBA to reorder and repeat certain text columns", "body": "<p>I'm sorry to say that I found the original code difficult to work with and I could not get the data in the right place with the column to text part.  I therefore have written new code for your problem. This code will go through your data as you presented it on your screenshot and will output on a second sheet, for the code to run your workbook must have at least 2 sheets.</p>\n\n<p>Instead of using text to columns I used <code>split</code> function, all your data is separated by a \" \" (space). I have taken into account the possibility of an activity consisting of more than 1 word. <br> After the split is performed on an item e.g. <code>1530 Practice Test 1800</code>, the number of array elements is checked, if the number is greater than 3 (0 to 2), the times are stripped from the array (they are always the first and last element), the rest of the elements are then joined, and the times re-added at position 0 and 2 leaving the activity in 1.</p>\n\n<p>The output is now in one long continuous string per day as I assumed that that was your plan. If you want the data to be output with each item in a different cell, you can remove the marked code at the end.</p>\n\n<pre><code>Sub GetSchedules()\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Dim DataWs As Worksheet, OutputWS As Worksheet\n    Dim DataArray() As String, temp1 As String, temp2 As String, temp3 As String\n    Dim i As Long, j As Long, k As Long, l As Long, m As Long\n    Dim EmptyRows As Long, WorkingRow As Long, StartRow As Long, EndRow As Long, NextStartRow As Long, FinalRow As Long\n\n    Set DataWs = ThisWorkbook.Worksheets(1)\n    Set OutputWS = ThisWorkbook.Worksheets(2)\n\n    StartRow = 1: l = 1: FinalRow = 1\n\n    Do Until StartRow &gt; FinalRow\n        For i = 1 To DataWs.Cells(StartRow, DataWs.Columns.Count).End(xlToLeft).Column\n            EmptyRows = 0\n            WorkingRow = StartRow\n            Do Until EmptyRows = 2\n                If DataWs.Cells(WorkingRow, i) = Empty Then\n                    EmptyRows = EmptyRows + 1\n                End If\n                WorkingRow = WorkingRow + 1\n            Loop\n            EndRow = WorkingRow - 2\n\n            If WorkingRow &gt; NextStartRow Then NextStartRow = WorkingRow\n\n            If DataWs.Cells(DataWs.Rows.Count, i).End(xlUp).Row &gt; FinalRow Then\n                FinalRow = DataWs.Cells(DataWs.Rows.Count, i).End(xlUp).Row\n            End If\n\n            m = 1\n            For j = StartRow To EndRow\n                DataArray() = Split(DataWs.Cells(j, i), \" \")\n                If UBound(DataArray) &gt; 2 Then\n                    temp1 = DataArray(0)\n                    temp2 = DataArray(UBound(DataArray))\n                    DataArray(0) = Empty\n                    DataArray(UBound(DataArray)) = Empty\n                    temp3 = Join(DataArray, \" \")\n                    ReDim DataArray(2)\n                    DataArray(0) = temp1\n                    DataArray(1) = temp3\n                    DataArray(2) = temp2\n                End If\n\n                For k = 0 To UBound(DataArray)\n\n                    OutputWS.Cells.NumberFormat = \"@\"\n                    If m &lt; 4 Then\n                        OutputWS.Cells(l, m).Value = DataArray(k)\n                    ElseIf m &lt; 7 Then\n                        If IsNumeric(DataArray(k)) Then\n                            OutputWS.Cells(l, m - 2).Value = DataArray(k)\n                        Else\n                            OutputWS.Cells(l, m + 1).Value = DataArray(k)\n                            OutputWS.Cells(l, m + 4).Value = DataArray(k)\n                            m = m + 1\n                        End If\n                    Else\n                        If IsNumeric(DataArray(k)) And k = 0 Then\n                            OutputWS.Cells(l, m - 1).Value = DataArray(k)\n                        ElseIf IsNumeric(DataArray(k)) And k = 2 Then\n                            OutputWS.Cells(l, m - 3).Value = DataArray(k)\n                        ElseIf Not IsNumeric(DataArray(k)) Then\n                            OutputWS.Cells(l, m + 1).Value = DataArray(k)\n                            If Not UBound(DataArray) = 1 Then OutputWS.Cells(l, m + 4).Value = DataArray(k)\n                            m = m + 1\n                        End If\n                    End If\n                    m = m + 1\n                Next k\n            Next j\n            OutputWS.Cells(l, m - 3).Value = OutputWS.Cells(l, m - 4)\n            OutputWS.Cells(l, m - 4).Value = OutputWS.Cells(l, m - 7)\n            l = l + 1\n        Next i\n        StartRow = NextStartRow\n    Loop\n\n    Dim ResultArray() As String\n\n    'If you want every item in a different cell rather than one long continuous string,\n    'remove the code from the next \"With OutputWs\" to the next \"End With\"\n    With OutputWS\n        For i = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row\n            ReDim ResultArray(1 To .Cells(i, .Columns.Count).End(xlToLeft).Column)\n            For j = 1 To .Cells(i, .Columns.Count).End(xlToLeft).Column\n                ResultArray(j) = .Cells(i, j)\n            Next j\n            .Rows(i).ClearContents\n            .Cells(i, 1) = Join(ResultArray, \" \")\n        Next i\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5104582, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70b53947d3eaa59131176d25470f3074?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5104582/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528973076, "creation_date": 1450886157, "last_edit_date": 1528973076, "question_id": 34439374, "link": "https://stackoverflow.com/questions/34439374/vba-to-reorder-and-repeat-certain-text-columns", "title": "VBA to reorder and repeat certain text columns", "body": "<p>I have the following table of raw data:</p>\n\n<blockquote>\n  <p>1995 (1)<br>\n  (23:00)</p>\n  \n  <p>Math 0630 <br>\n  0830 Break 0930 <br>\n  1000 English 1200 <br>\n  1200 Lunch 1300 <br>\n  1330 Free <br></p>\n</blockquote>\n\n<p>I need to have it read like this:</p>\n\n<blockquote>\n  <p>1995 (1) (23:00) 0630 Math 0830 0930 Math Break 1000 1200 Break English 1200 1300 English Lunch 1300 1330 Lunch Free</p>\n</blockquote>\n\n<p>Right now my Macro code has it reading like this:</p>\n\n<blockquote>\n  <p>1995 (1) (23:00) Math 0630 0830 Break 0930 1000 English 1200 1200 Lunch 1300 1330 Free </p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Macro4()\n'\n' Macro4 Macro\n'\n\n'\n    Sheets(\"Sheet2\").Select\n    Cells.Select\n    Range(\"D29\").Activate\n    Selection.ClearContents\n    Selection.End(xlUp).Select\n    Selection.End(xlToLeft).Select\n    Sheets(\"Sheet1\").Select\n\n\n'\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlFixedWidth, _\n        FieldInfo:=Array(Array(0, 1), Array(1, 1), Array(16, 1), Array(21, 1), Array(37, 1), _\n        Array(42, 1), Array(58, 1), Array(63, 1), Array(79, 1), Array(84, 1), Array(100, 1), Array( _\n        105, 1), Array(121, 1), Array(129, 1)), TrailingMinusNumbers:=True\n    Rows(\"1:6\").Select\n    Selection.Delete Shift:=xlUp\n    Columns(\"A:A\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"B:B\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"C:C\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"D:D\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"E:E\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"F:F\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"G:G\").Select\n    Selection.Delete Shift:=xlToLeft\n    Selection.Delete Shift:=xlToLeft\n\nDim lastRow&amp;, g&amp;\nDim findStr$\n\nfindStr = \"Planning of\"\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor g = lastRow To 1 Step -1 ' change this to 2 if you have headers\n    If Cells(g, 1).Value = findStr Then\n        'Range(Rows(i), Rows(i - 4)).Select\n        Range(Rows(g), Rows(g - 4)).EntireRow.Delete\n    End If\nNext g\n\nDim arr() As Variant\nDim p As Integer, i&amp;\nDim ws As Worksheet\nDim tws As Worksheet\nDim t As Integer\nDim c As Long\nDim u As Long\n\n\n\nSet ws = ActiveSheet\nSet tws = Worksheets(\"Sheet2\")\ni = 1\nWith ws\nDo Until i &gt; 100000\n    u = 0\n    For c = 1 To .Cells(1, .Columns.Count).End(xlToLeft).Column\n        'If c = .Cells(1, .Columns.Count).End(xlToLeft).Column And .Cells(i, c) &lt;&gt; \"\" Then\n        ReDim arr(0) As Variant\n        p = 0\n        t = 0\n            Do Until .Cells(i + p, c) = \"\" And t = 1\n                If .Cells(i + p, c) = \"\" Then\n                    t = 1\n\n                Else\n                    arr(UBound(arr)) = .Cells(i + p, c)\n                    ReDim Preserve arr(UBound(arr) + 1)\n                End If\n                p = p + 1\n            Loop\n\n        If p &gt; u Then\n            u = p\n\n        End If\n        If c = .Cells(1, .Columns.Count).End(xlToLeft).Column Then\n            If .Cells(i + p, c).End(xlDown).Row &gt; 100000 And .Cells(i + p, 1).End(xlDown).Row &lt; 100000 Then\n                i = .Cells(i + u, 1).End(xlDown).Row\n            Else\n                i = .Cells(i + p, c).End(xlDown).Row\n            End If\n\n        End If\n        tws.Cells(tws.Rows.Count, 1).End(xlUp).Offset(1).Resize(, UBound(arr) + 1) = arr\n\n    Next c\n\nLoop\nEnd With\nWith tws\n    .Rows(1).Delete\n    For i = .Cells(1, 1).End(xlDown).Row To 2 Step -1\n        If Left(.Cells(i, 1), 4) &lt;&gt; Left(.Cells(i - 1, 1), 4) Then\n            .Rows(i).EntireRow.Insert\n        End If\n    Next i\nEnd With\n\n'\n' Macro6 Macro\n'\n\n'\n    Sheets(\"Sheet2\").Select\n    Range(\"A1:M67\").Select\n    Selection.Copy\n    Sheets(\"Output\").Select\n    Range(\"A3\").Select\n    ActiveSheet.Paste\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Screenshot of Data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/gYRK6.jpg\" alt=\"Screenshot of Data\"></p>\n"}, {"tags": ["vba", "dictionary"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1450886042, "creation_date": 1450886042, "answer_id": 34439344, "question_id": 34439317, "link": "https://stackoverflow.com/questions/34439317/vba-dictionary-class/34439344#34439344", "title": "VBA Dictionary class", "body": "<p>Add the following reference to your VBA project:</p>\n\n<pre><code>Tools --&gt; References --&gt; Microsoft Scripting Runtime\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 324, "user_id": 6421449, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-byMP_uB_itg/AAAAAAAAAAI/AAAAAAAAF9c/zan1F_ZCbwI/photo.jpg?sz=128", "display_name": "zatbusch", "link": "https://stackoverflow.com/users/6421449/zatbusch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466623646, "creation_date": 1466623646, "answer_id": 37976684, "question_id": 34439317, "link": "https://stackoverflow.com/questions/34439317/vba-dictionary-class/37976684#37976684", "title": "VBA Dictionary class", "body": "<p>You can also use late binding ...</p>\n\n<pre><code>Dim MyList as Object\nSet MyList = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<p>Then your Function will need to look like this :</p>\n\n<pre><code>Function MyFunction() as Object\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5711790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13cdcde7b6860be525f11b1ec463eccd?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierD", "link": "https://stackoverflow.com/users/5711790/olivierd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 34439344, "answer_count": 2, "score": 0, "last_activity_date": 1466623646, "creation_date": 1450885940, "last_edit_date": 1450887486, "question_id": 34439317, "link": "https://stackoverflow.com/questions/34439317/vba-dictionary-class", "title": "VBA Dictionary class", "body": "<p>I just upload Microsoft Excel and my VBA doesn't propose me Dictionary when I want to create my function.</p>\n\n<pre><code>Function MyFunction() As Dictionary\n</code></pre>\n\n<p>Should I download any kind of add-in?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ms-access", "enums", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1450891327, "post_id": 34440407, "comment_id": 56622709, "body": "True. Neither can you use the Enum in expressions in SQL of a query. Best advice is to skip the macros. There even is a wizard for converting them to VBA."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1450889869, "creation_date": 1450889869, "answer_id": 34440407, "question_id": 34439027, "link": "https://stackoverflow.com/questions/34439027/using-enums-as-arguments-in-vba/34440407#34440407", "title": "Using Enums as arguments in vba", "body": "<p>I'm pretty sure you can't. Your options are:</p>\n\n<p>Good: get rid of the macro and do it in VBA.</p>\n\n<p>Meh: use the value from the enum as parameter, i.e. <code>getConfiguration(1)</code></p>\n"}], "owner": {"reputation": 13, "user_id": 5711632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314db380848e8dbfe5f47a621974d8b?s=128&d=identicon&r=PG&f=1", "display_name": "akw11", "link": "https://stackoverflow.com/users/5711632/akw11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "accepted_answer_id": 34440407, "answer_count": 1, "score": 1, "last_activity_date": 1498209294, "creation_date": 1450885050, "last_edit_date": 1498209294, "question_id": 34439027, "link": "https://stackoverflow.com/questions/34439027/using-enums-as-arguments-in-vba", "title": "Using Enums as arguments in vba", "body": "<p>I'm using Access 2000 and am trying to call a VBA function procedure using the RunCode action.\nHow can I use an Enum as an argument for that function call?</p>\n\n<p>(I've simplified the code in the following example, so we can focus on the important parts)</p>\n\n<p><br/></p>\n\n<p>The Enum is in a module named <em>Configuration_Enum</em>:</p>\n\n<pre><code>Public Enum configuration\n  val1 = 1\n  val2 = 2\nEnd Enum\n</code></pre>\n\n<p>The function using that enum is in the module <em>Configuration_Module</em>:</p>\n\n<pre><code>Public Function getConfiguration(config As configuration) As Int\n  getConfiguration = config\nEnd Funtion\n</code></pre>\n\n<p>I can call the function using the Enum as an argument without problems via VBA:</p>\n\n<pre><code>getConfiguration( Configuration_Enum.val1 )\n</code></pre>\n\n<p><br/></p>\n\n<p>Now I want to make that function-call using vba (using the RunCode action), but it's not working:</p>\n\n<pre><code>getConfiguration( [Modules]![Configuration_Enum].[val1] )  \n</code></pre>\n\n<p>Unfortunately I'm using a German Version of Access and there is no Error-Id, so I can only give you my translation of the error message: </p>\n\n<blockquote>\n  <p>The Object doesn't contain the automation object 'val1'.</p>\n  \n  <p>You've tried to run a Visual-Basic Procedure to set an Object-Property.\n  However automatization-processes have no access to that property.</p>\n</blockquote>\n\n<p><br/></p>\n\n<p>Is the thing I'm trying to accomplish even possible or am I just doint it wrong?</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 39, "user_id": 5711639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734e90b259a2f0457db613c607a09d5d?s=128&d=identicon&r=PG&f=1", "display_name": "gstnem", "link": "https://stackoverflow.com/users/5711639/gstnem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 635, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1450883574, "creation_date": 1450883574, "question_id": 34438600, "link": "https://stackoverflow.com/questions/34438600/excel-window-moved-event", "title": "Excel window moved event", "body": "<p>I am looking to detect any changes to the size or position of my application window. For detecting changes in size this has been working well in my \"ThisWorkbook\" module:</p>\n\n<pre><code>Private Sub Workbook_WindowResize(ByVal Wn As Window)\n\n'Stuff here\n\nEnd Sub\n</code></pre>\n\n<p>but it doesn't detect when the window is moved (i.e. if it ins't full screen and it is dragged around) or if the window is \"snapped\" to the top, left or right (i.e. when you drag a window to the left of your screen and it automatically fills the left hand side of the screen). Is there an equivalent for moving of the screen? something like this would be awesome;</p>\n\n<pre><code>Private Sub Workbook_WindowMove(ByVal Wn As Window)\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "activexobject", "createoleobject", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": true, "score": 1, "last_activity_date": 1450884833, "creation_date": 1450884833, "answer_id": 34438965, "question_id": 34438411, "link": "https://stackoverflow.com/questions/34438411/remove-border-from-oleobject-on-sheet-in-excel-with-vba/34438965#34438965", "title": "Remove border from OLEObject on sheet in Excel with VBA", "body": "<p>Aha..! A lot more searching and I found the answer to my own question:</p>\n\n<pre><code>sht.OLEObjects(\"RadioB_1\").ShapeRange.Fill.Transparency = 1\n</code></pre>\n\n<p>ShapeRange was listed on that MS page, however the name of it is misleading, and there is still nowhere in official documentation which actually lists all the properties and what they do! Anyway - I decided to post the answer to my own question for the benefit of anyone looking for this in future.</p>\n"}], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "accepted_answer_id": 34438965, "answer_count": 1, "score": 1, "last_activity_date": 1450884833, "creation_date": 1450882948, "last_edit_date": 1531164843, "question_id": 34438411, "link": "https://stackoverflow.com/questions/34438411/remove-border-from-oleobject-on-sheet-in-excel-with-vba", "title": "Remove border from OLEObject on sheet in Excel with VBA", "body": "<p>I'm using VBA to generate an Excel sheet which includes ActiveX form controls. However the documentation available for the object properties is rather sketchy. I notice that when I create, for example, an OptionButton control, the object includes a solid white border. I can manually go into Design Mode; right-click; \"Format Object\", then under the \"Colors and Lines\" tab in the dialogue box, change Fill (Automatic) to \"No Fill\". See the following example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QxquU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QxquU.jpg\" alt=\"Format Object dialogue box\"></a></p>\n\n<p>However I have yet to work out how to do this through code. Please see the following:</p>\n\n<pre><code>Dim sht as Sheet\nSet sht = [WorkbookObject].Sheets(1)\nWith sht\n    .OLEObjects.Add(ClassType:=\"Forms.OptionButton.1\", Left:=4.5, Top:=34.5, Width:=105, Height:=15).Name = \"RadioB_1\"\n    With .OLEObjects(\"RadioB_1\").Object\n        .Caption = \"First Option\"\n        .GroupName = \"ColumnFilter\"\n        .BackColor = RGB (128, 128, 128)\n        .BackStyle = 1\n    End With\n    ' The above all works fine, however I can't find the correct property\n    ' for the border fill. I have tried various properties for\n    ' .OLEObjects(\"RadioB_1\") and for .OLEObjects(\"RadioB_1\").Object\n    ' however I can't find the correct property.\nEnd With\n</code></pre>\n\n<p>Excel's Object Browser doesn't give me much of a clue. </p>\n\n<p>I have also looked at\n<a href=\"https://msdn.microsoft.com/en-US/library/microsoft.office.tools.excel.oleobject_properties%28v=vs.80%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">MSDN's Article on OLE Object Properties</a>, however there doesn't appear to be anything to address what I need.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": true, "score": 1, "last_activity_date": 1450883021, "creation_date": 1450883021, "answer_id": 34438438, "question_id": 34438354, "link": "https://stackoverflow.com/questions/34438354/run-timer-error-13-vba-macro-excel-type-mismatch/34438438#34438438", "title": "Run timer error 13 VBA Macro Excel &#39;type mismatch&#39;", "body": "<p>The error is straightforward, you're using the <code>&lt;&gt;</code> operator to compare the string value <code>\"E15\"</code> to an integer value, this is a nonsensical operation in VBA as strings cannot be compared directly to numbers.</p>\n\n<p>I believe your <em>intention</em> is to get the <strong>value of the cell E15</strong>  and then compare that to zero. To do that your code should look like this:</p>\n\n<pre><code>Dim e15CellValue\ne15CellValue = Cells.Item( 15, \"E\" ).Value\n</code></pre>\n\n<p>VBA has the concept of \"default properties\" so that can be abbreviated down to just:</p>\n\n<pre><code>Cells( 15, \"E\" )\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>If Cells( 15, \"E\" ) &lt;&gt; h Then\n     ' do stuff\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": false, "score": 1, "last_activity_date": 1450883112, "creation_date": 1450883112, "answer_id": 34438461, "question_id": 34438354, "link": "https://stackoverflow.com/questions/34438354/run-timer-error-13-vba-macro-excel-type-mismatch/34438461#34438461", "title": "Run timer error 13 VBA Macro Excel &#39;type mismatch&#39;", "body": "<p>You can do:</p>\n\n<pre><code>Sub Test()\n\n    Const h As Integer = 0\n    Const y As String = \"LD\"\n\n    If Range(\"E15\").Value &lt;&gt; h Then\n        Range(\"E15\") = Application.WorksheetFunction.CountIf(Range(\"E6:E12\"), y)\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5711614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/202f38c51ff768ea2746401fd8bdd455?s=128&d=identicon&r=PG&f=1", "display_name": "dan6657", "link": "https://stackoverflow.com/users/5711614/dan6657"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 34438438, "answer_count": 2, "score": 0, "last_activity_date": 1450883112, "creation_date": 1450882716, "last_edit_date": 1450882822, "question_id": 34438354, "link": "https://stackoverflow.com/questions/34438354/run-timer-error-13-vba-macro-excel-type-mismatch", "title": "Run timer error 13 VBA Macro Excel &#39;type mismatch&#39;", "body": "<p>Trying to do a few simple cell counts and the if statement i'm using is getting a runtime error.</p>\n\n<p><code>h</code> (integer)is equal to <code>0</code></p>\n\n<p><code>y</code> (String) is equal to <code>\"LD\"</code> (which is what it's counting)</p>\n\n<p>i'm asking it if the cell is not <code>0</code> then run the count</p>\n\n<p><code>(E6:E12)</code> Is where its counting into <code>E15</code></p>\n\n<pre><code>If (\"E15\" &lt;&gt; h) Then ' The runtime error is on this line\nRange(\"E15\") = Application.WorksheetFunction.CountIf(Range(\"E6:E12\"), y)\n</code></pre>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1450882579, "post_id": 34438224, "comment_id": 56617395, "body": "We might benefit from seeing more of your code."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450883087, "post_id": 34438224, "comment_id": 56617676, "body": "You also may benefit <i>a lot</i> in terms of performance by ditching the double vlookup embedded into an IF statement and using <code>Index(Match)</code> instead. It&#39;s a lot faster and more efficient overall. And I am pretty sure the <code>Variant</code> array does not work for the <i>specific</i> error reason you get. the <code>vlookup</code> formula expects an <code>Excel Range Object</code> as the 2nd argument, and you are not giving it that."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450888308, "post_id": 34438224, "comment_id": 56620921, "body": "The most likely reason for a type mismatch is that your lookup value isn&#39;t found. But your premise is flawed, it is likely that using the range will be faster than using the array version especially if you use <code>Worksheetfunction.Vlookup</code>"}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1452172091, "post_id": 34438224, "comment_id": 57056979, "body": "@MattCremeens: Sure that would help, but the code is rather complex, I cannot just copy that here. I will try to create a small example and post that."}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452172725, "post_id": 34438224, "comment_id": 57057423, "body": "@ScottHoltzman: The problem is the amount of lookups. Index match is not as fast as the double-true VLookup (but surley faster than the &quot;usual&quot; VLookup). My knowledge comes from this post: <a href=\"http://analystcave.com/excel-vlookup-vs-index-match-vs-sql-performance/\" rel=\"nofollow noreferrer\">EXCEL: VLOOKUP vs INDEX MATCH vs SQL vs VBA</a>. I actually implemented the problem with Index(Match) and this accepts an array - I was wondering why VLookup would not, when Index(Match) does. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194701.aspx\" rel=\"nofollow noreferrer\">Microsoft documentation</a> states that the type has to be a &quot;Table_Array&quot;"}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452173124, "post_id": 34438224, "comment_id": 57057717, "body": "@Rory: I know that the values are found, because when I just use the range (without loading it to memory) the code works. I don&#39;t think my premise is flawed - by loading code to memory one can speed-up the performance according to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff726673%28v=office.14%29.aspx#xlFasterVBA\" rel=\"nofollow noreferrer\">microsoft documentation</a>. If I got this wrong please explain what I am doing wrong."}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "edited": false, "score": 0, "creation_date": 1452199547, "post_id": 34438224, "comment_id": 57075228, "body": "Note: I gave up on this problem for the moment (gave up on double-true VLookup version) and implemented the problem using dictionaries (load ranges into arrays and then fill the lookup data into dictionary from in-memory array, then lookup the keys (which are also loaded into in-memory array) in the dictionary). The problem mentioned above was not solved, but for the moment the dictionary version is performant enough as solution, so the problem above is not relevant any more ;)"}], "owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 910, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450882257, "creation_date": 1450882257, "last_edit_date": 1531164843, "question_id": 34438224, "link": "https://stackoverflow.com/questions/34438224/excel-vba-vlookup-on-array-from-range-as-variant-throws-type-mismatch", "title": "Excel VBA: VLookup on array from range as Variant throws &quot;Type mismatch&quot;", "body": "<p>Following Problem:\nI am running VLookups on big data (using <a href=\"https://fastexcel.wordpress.com/2012/03/29/vlookup-tricks-why-2-vlookups-are-better-than-1-vlookup/\" rel=\"nofollow\">double-true VLookup</a>), thus I would like to load the data into an array first.</p>\n\n<p>VLookup statement:</p>\n\n<pre><code>Application.VLookup(vLookUpKey, vLookUpRange, 1, True)\n</code></pre>\n\n<p>The following piece of code loads a range into the memory as array:</p>\n\n<pre><code>Dim vLookUpRange As Variant\nvLookUpRange = dataSheet.Range(dataSheet.Cells(2, 1), dataSheet.Cells(30000, 10)).Value\n</code></pre>\n\n<p>When defining the above lookup-range as Range it looks like this:</p>\n\n<pre><code>Dim vLookUpRange As Range\nSet vLookUpRange = dataSheet.Range(dataSheet.Cells(2, 1), dataSheet.Cells(30000, 10))\n</code></pre>\n\n<p>When it is defined as range the below VLookup runs without a problem (but slow, since I access the sheet all the time). If I use the version where it is loaded into an array as Variant it Throws a \"Type mismatch\" error. </p>\n\n<p>Any ideas what could be the problem? </p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1450881803, "post_id": 34438028, "comment_id": 56616906, "body": "Just use <code>xlbook.Close True</code>."}, {"owner": {"reputation": 11, "user_id": 5711552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e4151e16b67f786393eb001b7142fa?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/5711552/derek"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450881955, "post_id": 34438028, "comment_id": 56616998, "body": "Thank you for the help. I had been doing xlbook.close; however that errorred out, so I switched to close xlbook. The xls.workbooks(1).close true; however does not work. Xlbook now refers to the .txt fie so I am not sure how to close out of the excel file."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450882059, "post_id": 34438028, "comment_id": 56617062, "body": "So, is it working for you with true at end?"}, {"owner": {"reputation": 11, "user_id": 5711552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e4151e16b67f786393eb001b7142fa?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/5711552/derek"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450882371, "post_id": 34438028, "comment_id": 56617268, "body": "Ignore my last comment. Everythings works not with the true. Thank you."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1451134372, "post_id": 34438028, "comment_id": 56684284, "body": "@Derek Please add how you could solve the problem in the answer below. This will help other users to solve the same problems when they visit a Question with a answer."}], "owner": {"reputation": 11, "user_id": 5711552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e4151e16b67f786393eb001b7142fa?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/5711552/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594642983, "creation_date": 1450881603, "last_edit_date": 1594642983, "question_id": 34438028, "link": "https://stackoverflow.com/questions/34438028/controlling-excel-and-txt-files-through-access-vba", "title": "Controlling Excel and TXT Files through ACCESS VBA", "body": "<p>I am trying to open an EXCEL file, edit it, and then save it as a .txt file through ACCESS VBA. Here is the code that I currently have:</p>\n\n<pre><code>Set xls = New Excel.Application\nSet xlbook = xls.Workbooks.Open(xlpath, ReadOnly:=True)\nSet xlsheet = xlbook.Sheets(\"Extract\")\nxlsheet.Rows(1).EntireRow.Delete\nxlsheet.Range(\"A1:\" &amp; xlsheet.Range(\"A1\").End(xlDown).Address).Sort xlsheet.Range(\"A1\"), xlAscending\nxlbook.SaveAs OutputDir &amp; dARR(i) &amp; \".txt\", xlText\nClose xlbook\nxls.Workbooks(1).Close\n</code></pre>\n\n<p>The problem that I am having is that I am unable to close the .txt or excel file. The bottom two lines of the code error out. </p>\n"}, {"tags": ["forms", "vba", "excel", "multipage"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450881241, "post_id": 34437709, "comment_id": 56616590, "body": "first, welcome to SO. Second, please show us your coding efforts to accomplish this on your own. This is not a &quot;code-writing&quot; service, but rather a forum to get solutions to existing code that does not work. For more information see <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>. Third, have you even tried searching on google for a solution?"}, {"owner": {"reputation": 21, "user_id": 5139387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b267ceebb2c3f5693d93791b31c52ec6?s=128&d=identicon&r=PG&f=1", "display_name": "DRicke", "link": "https://stackoverflow.com/users/5139387/dricke"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450881462, "post_id": 34437709, "comment_id": 56616704, "body": "I have tried both     <code>Private Sub GetFormButton_Click() Form1.Show   With MultiPage1 Value = 0</code>    and      <code>Private Sub BackToExclu_Click() With MultiPage1     .Value = (.Value - 1) Mod (.Pages.Count) End With End Sub</code>  and neither seemed to work.    I have tried Googling but I wasn&#39;t sure exactly if what I was asking was correct and a lot of the results I got back were to do with Access 2003, didn&#39;t know if VBA worked the same in both modules (and the language &amp; syntax seemed a bit different)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450881984, "post_id": 34437709, "comment_id": 56617015, "body": "thanks. I put your code in the original question."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1450882588, "creation_date": 1450882588, "answer_id": 34438320, "question_id": 34437709, "link": "https://stackoverflow.com/questions/34437709/open-a-vba-multi-tab-form-in-excel-to-a-specific-tab/34438320#34438320", "title": "Open a VBA Multi Tab Form in Excel to a specific tab", "body": "<p>You were very close, actually :)</p>\n\n<p>If you place the code into the <code>Initiliaze Event</code> within the userform itself, it will always display the first page of the multi-page control any time the form is loaded.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n     Me.MultiPage1.Value = 0\n\nEnd Sub\n</code></pre>\n\n<p>To place this code into the UserForm Module, right click on the <code>UserForm</code> object in the VBE and click <code>View Code</code>.</p>\n\n<p>Then your button click code would just be:</p>\n\n<pre><code>Private Sub GetFormButton_Click() \n    Form1.Show \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5139387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b267ceebb2c3f5693d93791b31c52ec6?s=128&d=identicon&r=PG&f=1", "display_name": "DRicke", "link": "https://stackoverflow.com/users/5139387/dricke"}, "edited": false, "score": 0, "creation_date": 1450886175, "post_id": 34438504, "comment_id": 56619592, "body": "Thanks guys.  Looks like so far, it&#39;s working.  I&#39;ll save and reopen a few times to make sure it&#39;s functioning as it should."}], "tags": [], "owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1450883259, "creation_date": 1450883259, "answer_id": 34438504, "question_id": 34437709, "link": "https://stackoverflow.com/questions/34437709/open-a-vba-multi-tab-form-in-excel-to-a-specific-tab/34438504#34438504", "title": "Open a VBA Multi Tab Form in Excel to a specific tab", "body": "<p>Open y</p>\n\n<ol>\n<li>open your excel workbook</li>\n<li>find your form</li>\n<li>right click the name of the form</li>\n<li>select \"show program code\"</li>\n</ol>\n\n<p>In the programcode for the form enter the code below:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n  MultiPage1.Pages(\"IDTab\").Enabled = True\nEnd Sub\n</code></pre>\n\n<p>Mind you: MultiPage1 might be called differently in your form. MultiPage1 is the default name of the container holding the tabbed pages in my excel workbook. In the properety window you can find the actual name of that container.</p>\n"}], "owner": {"reputation": 21, "user_id": 5139387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b267ceebb2c3f5693d93791b31c52ec6?s=128&d=identicon&r=PG&f=1", "display_name": "DRicke", "link": "https://stackoverflow.com/users/5139387/dricke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3805, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1450883259, "creation_date": 1450880562, "last_edit_date": 1450882434, "question_id": 34437709, "link": "https://stackoverflow.com/questions/34437709/open-a-vba-multi-tab-form-in-excel-to-a-specific-tab", "title": "Open a VBA Multi Tab Form in Excel to a specific tab", "body": "<p>I'm confident this is going to be a very easy answer for anyone with VBA knowledge (which I don't have).  I have a form built for Excel in VBA.  It's a multitab form and I want to have the form consistently open on the first tab when the \"Open Form X\" button is clicked in Excel.  Let's call the form \"Form1\" and the tab \"IDTab\" </p>\n\n<p>I have tried the following code but neither has worked:</p>\n\n<pre><code>Private Sub GetFormButton_Click() \n    Form1.Show With MultiPage1 Value = 0 \nEnd Sub\n</code></pre>\n\n<p>AND</p>\n\n<pre><code>Private Sub BackToExclu_Click() \n\n With MultiPage1 \n    .Value = (.Value - 1) Mod (.Pages.Count) \n End With \n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450878410, "post_id": 34436972, "comment_id": 56614926, "body": "you dim TrMaster as worksheet, but you don&#39;t assign a value to it using set. Or is it a global variable?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450878567, "post_id": 34436972, "comment_id": 56615025, "body": "Luuklag TrMaster is passed in as a parameter from the main Sub.  Does it still need to be set in the function even though it is set in the sub?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450879066, "post_id": 34436972, "comment_id": 56615328, "body": "try adding an <code>After</code> argument to the <code>Find</code> function to ensure it searches from the top down each time:  <code>trMaster.Columns(2).Find(What:=tempDeal, After:=trMaster.Cells(1,2)).Address </code> Furthemore, ensure you declare <code>dealNum</code> and <code>tempDeal</code> as String variables."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450879176, "post_id": 34436972, "comment_id": 56615404, "body": "@ScottHoltzman Just gave that a try.  Error still persisting.  Unsure why it would randomly show up after multiple successful iterations."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450879211, "post_id": 34436972, "comment_id": 56615434, "body": "@StormsEdge, please see my additional comment that I just editing in. It&#39;s <b>best</b> practice to <b>always</b> declare all variable types as <i>specifically</i> as possible."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450879460, "post_id": 34436972, "comment_id": 56615578, "body": "@ScottHoltzman Done!  That makes a lot of sense.  Still have the error, but can see why that&#39;s a lot safer."}, {"owner": {"reputation": 258, "user_id": 1582568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674c7c60f49b427d1b8f8d5c175221e4?s=128&d=identicon&r=PG", "display_name": "user1582568", "link": "https://stackoverflow.com/users/1582568/user1582568"}, "edited": false, "score": 0, "creation_date": 1450879617, "post_id": 34436972, "comment_id": 56615674, "body": "where is trLocation defined? what type is it, if it is an object then you should use &quot;set&quot; to assign it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450879686, "post_id": 34436972, "comment_id": 56615717, "body": "@StormsEdge - that goes for <code>trLocation</code> as well. But see @MacroMans answer below. He&#39;s got a great point, as well. :) I was kind of assuming that you always knew the value would be with there ... which probably was a wrong assumption!"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450879931, "post_id": 34436972, "comment_id": 56615866, "body": "@ScottHoltzman The value should always be found.  The value is being referenced from a sheet that pulls it from trMaster at a different point in the spreadsheet so it&#39;s mere existence indicates that it should be found, but it&#39;s best practice indeed!"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450879882, "post_id": 34437343, "comment_id": 56615833, "body": "great point @Macro Man. I was thinking about this but was assuming OP <i>knew</i> that the value would be there for sure. One point in your code, shouldn&#39;t <code>trLocation = trLocation.Address</code> be <code>trLocation = testLocation.Address</code>?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450879948, "post_id": 34437343, "comment_id": 56615873, "body": "Yes it should! good spot ;) I was <b><i>obviously</i></b> just making sure you were paying attention! haha"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1450880280, "post_id": 34437343, "comment_id": 56616045, "body": "This is a great suggestion and a good addition to the code either way, but still experiencing the error =[.  Thank you though!  Still getting stuck on same line of execution.  Also, just for further color, the deal number will always exist.  It wouldn&#39;t be initialized to search for it if it didn&#39;t exist in the first place.  Luckily the sheet i&#39;m building off of has some good chains of logic built into it."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1450880345, "post_id": 34437343, "comment_id": 56616076, "body": "@StormsEdge If you&#39;ve used my code then you shouldn&#39;t have that line anymore?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1450880490, "post_id": 34437343, "comment_id": 56616155, "body": "@MacroMan Sorry!  I had a typo in the code lol.  It worked as we would expect.  It posts that it cannot find the temp deal, but the problem is that I am looking at the temp deal number.  It definitely exists.  Any idea why that might be?  Thank you for all of your help by the way!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1450880670, "post_id": 34437343, "comment_id": 56616252, "body": "Obviously I don&#39;t know what the format of the number is but look for any extra spaces before/after the number or check the formatting of the column <i>(i.e. make sure it&#39;s not formatted as &quot;Text&quot;)</i> - If it&#39;s a whole number try using something like <code>CLng(Trim(tempDeal))</code> - there <b><i>will</i></b> be a difference <i>(Excel doesn&#39;t have the ability to just &#39;not like&#39; something!).</i> You just need to find it! :)"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1450881036, "post_id": 34437343, "comment_id": 56616472, "body": "@MacroMan Haha that&#39;s true!  Imagine how much trouble I might have if it had a temperament....It would be ignoring me for forgetting to Dim all of my variables! =p.  I tried CLng(Trim(tempDeal)) and that didn&#39;t seem to fix the problem.  I am looking at the columns and it&#39;s formatted as &quot;general number&quot;."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1450881082, "post_id": 34437343, "comment_id": 56616490, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/98824/discussion-between-macro-man-and-stormsedge\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1450879957, "last_edit_date": 1450879957, "creation_date": 1450879314, "answer_id": 34437343, "question_id": 34436972, "link": "https://stackoverflow.com/questions/34436972/error-91-occurring-during-iterations-randomly/34437343#34437343", "title": "Error 91 occurring during iterations randomly", "body": "<p>Your code assumes that <code>trLocation</code> is always found, if it isn't found then you will receive an error because you don't have a range to return the <code>.Address</code> property for.</p>\n\n<p>Try testing the result first:</p>\n\n<pre><code>Dim testLocation As Excel.Range\n\nSet testLocation = trMaster.Columns(2).Find(tempDeal)\n\nIf Not testLocation Is Nothing Then\n    trLocation = testLocation.Address\n    '// Rest of code here...\nElse\n    MsgBox \"Cannot find \"\"\" &amp; tempDeal &amp; \"\"\"!\"\n    Exit Function\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 34437343, "answer_count": 1, "score": 1, "last_activity_date": 1450879957, "creation_date": 1450878015, "question_id": 34436972, "link": "https://stackoverflow.com/questions/34436972/error-91-occurring-during-iterations-randomly", "title": "Error 91 occurring during iterations randomly", "body": "<p>Interesting problem here.  This line of  code works through multiple iterations until it reaches a point where it throws an Run-time error 91 at me: \"Object Variable or With block variable not set\".  This is occurring in a function designed to find a deal number.  The entire program is an end of day email generation program that sends attachments to various different counter-parties.  The error occurs on the ** line. For additional color, temp deal is not empty when execution is attempted.  There doesn't appear to be any extraneous trailing or leading spaces either. Thanks in advance!</p>\n\n<pre><code>    Function getPDFs(cFirm As Variant, iFirm As Variant, row_counter As Variant, reportsByFirm As Worksheet, trMaster As Worksheet, trSeparate As Variant, trName As Variant, reportDate As Variant) As String\n\n    dealCol = 1\n    Dim locationArray() As String\n    Dim DealArray() As String\n    cDes = \"_vs._NY\"\n    iDes = \"_vs._IC\"\n    filePath = \"X:\\Office\\Confirm Drop File\\\"\n    dealNum = reportsByFirm.Cells(row_counter, dealCol)\n    FileType = \".pdf\"\n\n    If InStr(1, dealNum, \"-\") &gt; 0 Then\n\n        DealArray() = Split(dealNum, \"-\")\n        tempDeal = DealArray(LBound(DealArray))\n\n    Else\n        tempDeal = dealNum\n\n    End If\n\n    'Finds deal location in spread sheet for further detail to obtain file path\n    **trLocation = trMaster.Columns(2).Find(What:=tempDeal).Address\n    locationArray() = Split(trLocation, \"$\")\n    trRow = locationArray(UBound(locationArray))\n\n    'Formats client names for 20 characters and removes punctuation (\".\") in order to stay within convention of file naming\n    cFirmFormatted = Trim(Left(cFirm, 20))\n    iFirmFormatted = Trim(Left(iFirm, 20))\n\n    'Finds clearing method\n    clMethod = trMaster.Cells(trRow, 6).Value\n\n    Select Case clmethod\n        Case \"Clport\"\n\n            'Prevents naming convention issues with punctuations in the name\n            If InStr(1, cFirmFormatted, \".\") &gt; 0 Then\n                cFirmFormatted = Replace(cFirmFormatted, \".\", \"\")\n            End If\n\n            getPDFs = filePath &amp; cFirmFormatted &amp; \"\\\" &amp; reportDate &amp; \"_\" &amp; dealNum &amp; \"_\" &amp; cFirmFormatted &amp; cDes &amp; FileType\n\n        Case \"ICE\"\n\n            If InStr(1, iFirmFormatted, \".\") &gt; 0 Then\n                iFirmFormatted = Replace(iFirmFormatted, \".\", \"\")\n            End If\n\n            getPDFs = filePath &amp; iFirmFormatted &amp; \"\\\" &amp; reportDate &amp; \"_\" &amp; dealNum &amp; \"_\" &amp; iFirmFormatted &amp; iDes &amp; FileType\n    End Select\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "loops", "ms-access"], "comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1450876972, "post_id": 34436574, "comment_id": 56614095, "body": "Have you tried creating a query with <code>Checked = &quot;True&quot;</code> criteria?"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1450877172, "post_id": 34436574, "comment_id": 56614198, "body": "I&#39;ve thought about it - It&#39;s what I&#39;m going to do if there isn&#39;t a filter option, but ideally I&#39;d just filter out the data"}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 1, "creation_date": 1450877322, "post_id": 34436574, "comment_id": 56614287, "body": "<code>RecordSet</code> does have a <code>Filter</code> property but I&#39;m pretty sure it is more efficient to use a sql statement with a <code>WHERE</code> clause."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451403938, "post_id": 34436574, "comment_id": 56769335, "body": "Why are you opposed to using a query as the data source for the recordset?"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1455120323, "post_id": 34436574, "comment_id": 58348955, "body": "I didn&#39;t want to have to run an update query on the main table from the query that showed the unchecked items to mark them as checked. It was just easier to filter the table and iterate through to create the queries and mark them as checked if I stayed in one table."}], "answers": [{"comments": [{"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1451056543, "post_id": 34437661, "comment_id": 56669781, "body": "Yeah my mistake with the move first inside - I was throwing out a concept.  I ideally don&#39;t want to run off of a query -- this post is asking for an alternative to that - I&#39;ll clean up the question to reflect and clarify that goal. Thank you"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1451082346, "post_id": 34437661, "comment_id": 56675876, "body": "@Schalton: Sorry, but this doesn&#39;t make much sense. You must filter the records either with the recordset (by using a WHERE clause, see my answer) or in the loop (see your question). There is no other way."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1451404217, "post_id": 34437661, "comment_id": 56769503, "body": "He could open an ADO Recordset, and then set its <code>Filter</code> property.  That works as I think he intends.  But I don&#39;t understand why it makes sense to do it that way.  It should be more efficient to load only the target rows in the first place --- as you suggested."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1455120415, "post_id": 34437661, "comment_id": 58349029, "body": "@Andre, you not understanding &amp; it not making sense are not the same thing. HansUp thank you. I ended up sorting the field then exiting the sub when I reached a row marked as checked."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1450880358, "creation_date": 1450880358, "answer_id": 34437661, "question_id": 34436574, "link": "https://stackoverflow.com/questions/34436574/vba-looping-through-filtered-table-in-access/34437661#34437661", "title": "VBA - Looping through filtered table in access", "body": "<p>Simply open your recordset with a query that has a WHERE clause.</p>\n\n<pre><code>Dim rs As Recordset\nDim S As String\n\nS = \"SELECT foo, morefoo FROM bar WHERE [Checked] = 0\"\n' Or if Checked is a Text column:\nS = \"SELECT foo, morefoo FROM bar WHERE [Checked] &lt;&gt; 'True'\"\n\nSet rs = CurrentDb.OpenRecordset(S)\nDo While Not rs.EOF\n    ' code\n\n    rs.MoveNext\nLoop\n</code></pre>\n\n<p>(BTW, your <code>Move First</code> inside the loop would create an endless loop...)</p>\n"}, {"tags": [], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "is_accepted": true, "score": 0, "last_activity_date": 1573988201, "creation_date": 1573988201, "answer_id": 58899768, "question_id": 34436574, "link": "https://stackoverflow.com/questions/34436574/vba-looping-through-filtered-table-in-access/58899768#58899768", "title": "VBA - Looping through filtered table in access", "body": "<p>I ended up sorting the field then exiting the sub when I reached a row marked as checked.</p>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 58899768, "answer_count": 2, "score": -1, "last_activity_date": 1573988201, "creation_date": 1450876569, "last_edit_date": 1451056599, "question_id": 34436574, "link": "https://stackoverflow.com/questions/34436574/vba-looping-through-filtered-table-in-access", "title": "VBA - Looping through filtered table in access", "body": "<p>Access 2013 32 Bit / Windows 7 64 Bit</p>\n\n<p>I have a table of keys and based on the key value my vba will run some queries and populate other fields in the table - I call this \"Checking\" I have a \"Checked\" Column in the table and have to break the processing of this list into several batches (and more records are constantly added) so I'd like to filter out the \"Checked\" ones. I'd like to do this <strong>WITHOUT</strong> using a separate query</p>\n\n<p>I'm using the traditional loop w/ a condition:\n(My code works this is just a mock up ignore syntax here please)</p>\n\n<pre><code>Move First\nDo Until EOF\nif Table(\"Checked\") = \"True\" Then goto NextRow\n    &lt;Code&gt;\nNextRow:\n    Move Next\nLoop\n</code></pre>\n\n<p>I'd like to continue with this method, but filter out all of the <code>\"Checked\" = True</code> on the onset</p>\n"}, {"tags": ["vba", "excel", "character", "counting"], "comments": [{"owner": {"reputation": 12083, "user_id": 5414452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJKg0.jpg?s=128&g=1", "display_name": "jogo", "link": "https://stackoverflow.com/users/5414452/jogo"}, "edited": false, "score": 1, "creation_date": 1450876674, "post_id": 34436462, "comment_id": 56613938, "body": "If <code>Len(&quot;Joe&quot;) &gt;2</code> then you do the same as for &quot;Mark&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 1702721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8602790c53ef498630b9439fca2197b?s=128&d=identicon&r=PG", "display_name": "T Kelly", "link": "https://stackoverflow.com/users/1702721/t-kelly"}, "is_accepted": false, "score": 1, "last_activity_date": 1450876733, "creation_date": 1450876733, "answer_id": 34436625, "question_id": 34436462, "link": "https://stackoverflow.com/questions/34436462/excel-vba-build-a-function-to-highlight-cells-that-exceed-character-limit/34436625#34436625", "title": "Excel VBA - Build a function to highlight cells that exceed character limit", "body": "<p>This works for me. I think the problem might be your line of code:</p>\n\n<pre><code>Cells(1, 1).Interior.ColorIndex = 200\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>Cells(i, 1).Interior.ColorIndex = 200\n</code></pre>\n\n<p>See below:</p>\n\n<pre><code>For i = 2 To 5\nIf Len(Sheet1.Cells(i, 1).Value) &gt; 2 Then\nSheet1.Cells(i, 1).Interior.ColorIndex = 37\nEnd If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 7, "last_activity_date": 1450876815, "creation_date": 1450876815, "answer_id": 34436650, "question_id": 34436462, "link": "https://stackoverflow.com/questions/34436462/excel-vba-build-a-function-to-highlight-cells-that-exceed-character-limit/34436650#34436650", "title": "Excel VBA - Build a function to highlight cells that exceed character limit", "body": "<p>You can do this without VBA and just use Excel's built-in <a href=\"http://www.contextures.com/xlCondFormat01.html\" rel=\"nofollow noreferrer\">Conditional Formatting</a></p>\n\n<ol>\n<li>Select your range</li>\n<li>Click Alt + O, D to bring up Conditional Formatting Rules Manager\n<a href=\"https://i.stack.imgur.com/6xVz7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6xVz7.png\" alt=\"enter image description here\"></a></li>\n<li>Click New Rule</li>\n<li>Select <code>Use a formulato determine which cells to format</code></li>\n<li>Enter the formula <code>=LEN(E4)&gt;2</code> (formula based on example below) and click <code>Format</code> to fill the cell with the color of your choose.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/5RHwt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5RHwt.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"6\">\n<li>The end result will look like the screenshot below, except with your needed ranges.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/46FKU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/46FKU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5708685, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154360774782506/picture?type=large", "display_name": "echalmers", "link": "https://stackoverflow.com/users/5708685/echalmers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1570, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450876815, "creation_date": 1450876217, "question_id": 34436462, "link": "https://stackoverflow.com/questions/34436462/excel-vba-build-a-function-to-highlight-cells-that-exceed-character-limit", "title": "Excel VBA - Build a function to highlight cells that exceed character limit", "body": "<p>I have a column in an excel sheet that has a character limit. I want to be able to press an Active X Command button and have the function highlight all the cells that exceed the character limit. For example if the character limit is 3, the name Mark would be highlighted, but the name Joe would not be. Anyone know how to go about this?</p>\n\n<p>This is what I have right now but it doesn't work. I'm brand new to this.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nFor i = 2 To 5\nIf Len(Cells(i, 1).Value) &gt; 2 Then\nCells(1, 1).Interior.ColorIndex = 200\nEnd If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["html", "excel", "internet-explorer", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450877358, "post_id": 34436415, "comment_id": 56614310, "body": "change your do loop where you tell the code to wait while IE loads to <code>Loop While MyBrowser.ReadyState &lt;&gt; 4 or MyBrowser.Busy</code>"}, {"owner": {"reputation": 23, "user_id": 2862057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6ff7b3a00770861a07c11e19d1a7d8a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/2862057/prasanna"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450877800, "post_id": 34436415, "comment_id": 56614557, "body": "Hi Scott thank you for the reply... i tried the above code but still its not working... What i guess is that vba code execution is more speedy than IE webpage load time... do i need to increase the time span of wait function...??? Will it help...???"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450878324, "post_id": 34436415, "comment_id": 56614870, "body": "Yes, the code execution is in VBA is <i>independent</i> of the browser load time, so you have to account for that, as you already are. Increasing the wait time inside the loop won&#39;t matter matter, because it will keep looping while IE is not ready. I am posting the code I use for this in an answer. It works for me quit well in an application I frequently use."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 2862057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6ff7b3a00770861a07c11e19d1a7d8a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/2862057/prasanna"}, "edited": false, "score": 0, "creation_date": 1450879545, "post_id": 34437150, "comment_id": 56615628, "body": "Let me try with your code by this week end... and i&#39;ll let you know the results by Sunday.... thank you again scoot... happy weekend... and merry Christmas.... in advance...."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 23, "user_id": 2862057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6ff7b3a00770861a07c11e19d1a7d8a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/2862057/prasanna"}, "edited": false, "score": 0, "creation_date": 1450879751, "post_id": 34437150, "comment_id": 56615746, "body": "Merry Christmas to you too @Prasanna! Happy weekend and may the joy in your heart spread throughout you and your life this holiday season and beyond :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1450878680, "creation_date": 1450878680, "answer_id": 34437150, "question_id": 34436415, "link": "https://stackoverflow.com/questions/34436415/webpage-login-not-working-using-excel-vba/34437150#34437150", "title": "Webpage login not working Using excel VBA", "body": "<p>This is the method I use to allow IE to load in an application that frequently works with webpages in IE. I have come to this after a lot of trial and error and it works consistently now - though I have seen many ways to accomplish this.</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n\nSub IEWait(IE As Object)\n'assumes IE is loaded as InternetExplorer.Application\")\n\nWith IE\n    Do While .Busy Or .ReadyState &lt;&gt; 4: Sleep (100): Loop\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>You can add this to your code by</p>\n\n<ol>\n<li>Placing the Public Declare at the top of your module window before any <code>Sub</code> are defined.</li>\n<li>Incorporating it into your code as shown below.</li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>With MyBrowser\n     .Silent = True \n     .Navigate MyURL\n     .Visible = True\n\n     Do While .Busy or .Readystate &lt;&gt; 4: Sleep (100): Loop\n\n     Set HTMLDoc = .document\n\n     '... rest of code\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "is_accepted": false, "score": 0, "last_activity_date": 1451415543, "creation_date": 1451415543, "answer_id": 34517287, "question_id": 34436415, "link": "https://stackoverflow.com/questions/34436415/webpage-login-not-working-using-excel-vba/34517287#34517287", "title": "Webpage login not working Using excel VBA", "body": "<p>Scott hit the nail on the head.  </p>\n\n<pre><code>Sub Test() \n\nDim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n    .Visible = True\n    .Navigate \"http://www.marketwatch.com/investing/stock/aapl/analystestimates\" ' should work for any URL\n    Do Until .ReadyState = 4: DoEvents: Loop\n\n. . .  YOUR CODE HERE  . . .\n\nEnd With\nEnd Sub \n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Sub DumpData()\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\n\nURL = \"http://finance.yahoo.com/q?s=sbux&amp;ql=1\"\n\n'Wait for site to fully load\nIE.Navigate2 URL\nDo While IE.Busy = True\n   DoEvents\nLoop\n\n    . . .  YOUR CODE HERE  . . .\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2862057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6ff7b3a00770861a07c11e19d1a7d8a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/2862057/prasanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 582, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451415543, "creation_date": 1450876023, "last_edit_date": 1531164843, "question_id": 34436415, "link": "https://stackoverflow.com/questions/34436415/webpage-login-not-working-using-excel-vba", "title": "Webpage login not working Using excel VBA", "body": "<p>I am working on project to download the dump from website and save it on the path specified using Excel vba.</p>\n\n<p>Code is working perfectly when u do the debug or execute line by line by pressing \"F8\".</p>\n\n<p>but when you execute the whole program by pressing \"F5\" or clicking on button after assigning macro to it. its not working.</p>\n\n<p>need your precious advise to resolve this issue.</p>\n\n<p>Thanks in Advance,\nPrasanna</p>\n\n<p>VBA Code used to login.</p>\n\n<pre><code>Sub Login()\n\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\nDim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\n\n\nMyURL = \"URL\"\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.Navigate MyURL\nMyBrowser.Visible = True\n\nDo\nApplication.Wait DateAdd(\"s\", 5, Now)\nLoop Until MyBrowser.READYSTATE = READYSTATE_COMPLETE\nApplication.Wait DateAdd(\"s\", 5, Now)\nSet HTMLDoc = MyBrowser.document\n    HTMLDoc.all.Country_Code.Value = \"Country_Code\"\n    HTMLDoc.all.Login.Value = \"UserName\" \n    HTMLDoc.all.passwd.Value = \"Password\" \n    HTMLDoc.all.Item(\"B1\").Click\n\n        For Each MyHTML_Element In HTMLDoc.getElementsByName(\"B1\")\n            If MyHTML_Element.Type = \"button\" Then MyHTML_Element.Click: Exit For\n        Next\n\nEnd sub\n</code></pre>\n\n<p>Sample HTML code of webpage for login.</p>\n\n<pre><code>                &lt;table border=0&gt;\n\n                    &lt;tr&gt;\n                        &lt;td&gt;Country:&lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"text\" name=\"country_code\" maxlength=2\n                                 onblur=\"this.value=this.value.toUpperCase();Form1_action(this.value)\"&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n\n                    &lt;tr&gt;\n                        &lt;td&gt;Language:&lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;select name=\"idioma\"  disabled  &gt;\n                                &lt;option value=\"uk|es\" onblur=\"document.Form1.login.focus()\"&gt;ENGLISH&lt;/option&gt;\n&lt;option value=\"sp|es\" onblur=\"document.Form1.login.focus()\"&gt;SPANISH&lt;/option&gt;\n&lt;option value=\"fr|en-us\" onblur=\"document.Form1.login.focus()\"&gt;FRENCH&lt;/option&gt;\n&lt;option value=\"it|en-us\" onblur=\"document.Form1.login.focus()\"&gt;ITALIAN&lt;/option&gt;\n&lt;option value=\"de|de\" onblur=\"document.Form1.login.focus()\"&gt;GERMAN&lt;/option&gt;\n\n                            &lt;/select&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n\n                    &lt;tr&gt;\n                        &lt;td&gt;Login:&lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"text\" name=\"login\" maxlength=10 value=\"\"  disabled &gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n\n                    &lt;tr&gt;\n                        &lt;td&gt;Password:&lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"password\" autocomplete=\"off\" name=\"passwd\" maxlength=10 value=\"\"  disabled  onkeypress=\"var okp=(event.which)?event.which:event.keyCode; if(okp==13) SiteRedirect(this.form)\"&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n\n                &lt;/table&gt;\n\n                &lt;br&gt;\n\n                &lt;center&gt;\n                    &lt;input type=\"button\" name=\"B1\" value=\"Sign In\"\n                        onclick=\"SiteRedirect()\"\n                         disabled \n                        style=\"width:80pt\"\n                        &gt;\n\n                &lt;/center&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 3, "creation_date": 1450875769, "post_id": 34436257, "comment_id": 56613484, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24250718/append-new-record-in-excel-using-vba\">Append new record in Excel using VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": false, "score": 0, "last_activity_date": 1450886239, "creation_date": 1450886239, "answer_id": 34439405, "question_id": 34436257, "link": "https://stackoverflow.com/questions/34436257/how-do-i-compare-two-columns-in-different-sheets-for-non-existing-values-and-the/34439405#34439405", "title": "How do I compare two columns in different sheets for non existing values and then copy them to the main sheet?", "body": "<p>Not sure of what your logic would be, but here are some VBA Pointers:</p>\n\n<p>To compare columns in different sheets:</p>\n\n<p>If Sheets(\"Sheet1\").Range(\"ColRow\").Value &lt;> Sheets(\"Sheet2\").Range(\"Col2Row2\").Value Then...</p>\n\n<p>Or you could replace the sheet names with (1) and (2) [or whatever order they are in the workbook].</p>\n\n<p>For instance:\n    If Sheets(1).Range(\"A2\").Value &lt;> Sheets(2).Range(\"C7\").Value Then ...</p>\n\n<p>Assignment to a cell works similarly. You can use a variable as an index:</p>\n\n<pre><code>Dim i1 as integer\nDim i2 as integer\ni2 = 7\nFor i1 = 1 to 50\n    If Sheets(1).Range(\"A\" + CStr(i1)).Value &lt;&gt; Sheets(2).Range(\"C\" + CStr(i2)).Value Then\n        Sheets(1).Range(\"B\" + Cstr(i1)).Value = Sheets(2).Range(\"C\" + CStr(i2)).Value\n    End If\n\n    i2 = i2 + 1\nNext i1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5711183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2755f99d8f169f4d29a0db5647937b7b?s=128&d=identicon&r=PG&f=1", "display_name": "kunkulis", "link": "https://stackoverflow.com/users/5711183/kunkulis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450886239, "creation_date": 1450875534, "last_edit_date": 1450875975, "question_id": 34436257, "link": "https://stackoverflow.com/questions/34436257/how-do-i-compare-two-columns-in-different-sheets-for-non-existing-values-and-the", "title": "How do I compare two columns in different sheets for non existing values and then copy them to the main sheet?", "body": "<p>Firstly, I am no expert with VBA, just searching for similar situation copying them, changing the code a bit and hoping for the best.</p>\n\n<p>So I need to make a macro that compares two sheets. One of the sheets is the one that contains history information and all the specific names in Column A, where in the other sheet I paste daily information, where the specific names is always in column C and starts with row 7. The existing names could disappear or new names could be added and there will be duplicates.</p>\n\n<p>What I need is for the code to first compare these two Columns for new names, if such are found copy them and past them in the history sheets A columns 2nd row, the existing names get moved down, so that they don't get deleted.</p>\n\n<p>In short words saying If duplicate do nothing, else copy to history sheet.</p>\n\n<p>Thank you in advance for all the help</p>\n"}, {"tags": ["sql", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1450876152, "post_id": 34436151, "comment_id": 56613677, "body": "Given that you can only assign a single value to that field, what is the reason for trying to break it down first?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1450878317, "creation_date": 1450878317, "answer_id": 34437059, "question_id": 34436151, "link": "https://stackoverflow.com/questions/34436151/error-3075-when-breaking-down-long-text-for-update-query/34437059#34437059", "title": "Error 3075 When breaking down long text for update query", "body": "<p>This code is called <em>after</em> the execute, and does not make any sense:</p>\n\n<pre><code>For p = 1 To n   'Add each 255 char piece as the parameters\n    strSQL.Parameters(\"prm_val\" &amp; p) = Mid(varValue, (p - 1) * 255 + 1, 255)\nNext p\n</code></pre>\n\n<p>as <code>strSQL</code> doesn't take parameters.</p>\n\n<p>Adjust this code and move it inte the code before calling execute.</p>\n\n<p>Or use the query you have commented out.</p>\n"}], "owner": {"reputation": 11, "user_id": 5711211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb362ca72457bc84e45f22fc8af191d?s=128&d=identicon&r=PG&f=1", "display_name": "Mekenzie Buhr", "link": "https://stackoverflow.com/users/5711211/mekenzie-buhr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450878317, "creation_date": 1450875157, "last_edit_date": 1450878223, "question_id": 34436151, "link": "https://stackoverflow.com/questions/34436151/error-3075-when-breaking-down-long-text-for-update-query", "title": "Error 3075 When breaking down long text for update query", "body": "<p>The Description field is a long text field with over 255 characters. so I'm trying to break it down before I update it. My error reads: </p>\n\n<blockquote>\n  <p>Run-Time error '3075 Syntax error (missing Operator) in query\n  expression \"titlename'Set Description = '([prm_val1] &amp;\n  [prm_val2].....[prm_val7])\".</p>\n</blockquote>\n\n<p>Here's my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>l = Len(Me.Description)\nIf l Mod 255 = 0 Then   'For length exactly a multiple of 255 (255, 510, 765...)\n    n = l / 255\nElse\n    n = Int(l / 255) + 1\nEnd If\n\nsp = \"[prm_val1]\"\nIf n &gt; 1 Then 'If &gt;255 chars tap on concatenated parameters as needed\n     For p = 2 To n\n         sp = sp &amp; \" &amp; [prm_val\" &amp; p &amp; \"]\"\n     Next p\n End If\n\n'UpdateDescription = \"UPDATE AllProjects \" &amp; _\n'\"Set Description='\" &amp; sp &amp; \"'\" &amp; _\n'\" WHERE ID =\" &amp; Me.ID\n'CurrentDb.Execute UpdateDescription\n\n 'For p = 1 To n   'Add each 255 char piece as the parameters\n     'qdf.Parameters(\"prm_val\" &amp; p) = Mid(varValue, (p - 1) * 255 + 1, 255)\n 'Next p\n 'qdf.Execute\n\n\n\n    DoCmd.SetWarnings False\n    strSQL = \"UPDATE AllProjects \" &amp; _\n     \"Set Title='\" &amp; Me.Title &amp; \"'\" &amp; _\n     \"Set Description='(\" &amp; sp &amp; \")'\" &amp; _\n     \",Department='\" &amp; Me.Department &amp; \"'\" &amp; _\n     \",Priority='\" &amp; Me.Priority &amp; \"'\" &amp; _\n     \",Status='\" &amp; Me.Status &amp; \"'\" &amp; _\n     \",[Create Date]='\" &amp; Me.CreateDate &amp; \"'\" &amp; _\n     \",[% Complete]='\" &amp; Me.PerComplete &amp; \"'\" &amp; _\n     \",[File Location]='\" &amp; Me.FileLocation &amp; \"'\" &amp; _\n     \",[Update Notes]='\" &amp; Me.UpdateNotes &amp; \"'\" &amp; _\n     \",Leader='\" &amp; Me.Leader &amp; \"'\" &amp; _\n     \",[Target Date]='\" &amp; Me.TargetDate &amp; \"'\" &amp; _\n     \",[Complete Date]='\" &amp; Me.CompleteDate &amp; \"'\" &amp; _\n     \",Category='\" &amp; Me.Category &amp; \"'\" &amp; _\n     \",Feedback='\" &amp; Me.Feedback &amp; \"'\" &amp; _\n     \",[File Location 2]='\" &amp; Me.FileLocation2 &amp; \"'\" &amp; _\n     \",[File Location 3]='\" &amp; Me.FileLocation3 &amp; \"'\" &amp; _\n     \",[Strategic Initiatives]='\" &amp; Me.StrategicInitiatives &amp; \"'\" &amp; _\n     \" WHERE ID =\" &amp; Me.ID\n     CurrentDb.Execute strSQL\n\n     For p = 1 To n   'Add each 255 char piece as the parameters\n             strSQL.Parameters(\"prm_val\" &amp; p) = Mid(varValue, (p - 1) * 255 + 1, 255)\n         Next p\n    DoCmd.SetWarnings True\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "db2"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 2, "creation_date": 1450874041, "post_id": 34435785, "comment_id": 56612416, "body": "Databases support remote links to other databases.  You can run these queries inside a single database."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1450874482, "post_id": 34435785, "comment_id": 56612695, "body": "Even if one of them is a DB2 database? And does it require any special user rights? I am not system administrator..."}, {"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1450876283, "post_id": 34435785, "comment_id": 56613746, "body": "One is db2.  What&#39;s the other one?"}, {"owner": {"reputation": 11986, "user_id": 812837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l9uC.jpg?s=128&g=1", "display_name": "Clockwork-Muse", "link": "https://stackoverflow.com/users/812837/clockwork-muse"}, "edited": false, "score": 0, "creation_date": 1450876350, "post_id": 34435785, "comment_id": 56613773, "body": "No, you&#39;d need to be an administrator, for several reasons.  Regardless &quot;yes, it&#39;s possible in VBA&quot;.  I wouldn&#39;t be surprised if there was a LINQ extension already.  Note that it&#39;s going to be far slower to do in the application layer than a linked DB."}], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450873882, "creation_date": 1450873882, "last_edit_date": 1531164843, "question_id": 34435785, "link": "https://stackoverflow.com/questions/34435785/functions-similar-to-left-join-in-vba", "title": "Functions similar to &quot;LEFT JOIN&quot; in VBA?", "body": "<p>I am looking to gather some data, which is stored in two different databases (one MS-SQL and one DB2), which has an ID column in common. However, from what I know, it is not possible in any way to join these in SQL, due to the different databases. </p>\n\n<p>So my question is, if it is possible to join them in VBA (which is where I will be using the data), with a result similar to that a \"LEFT JOIN\" would produce, if the tables were all located in the same database?</p>\n\n<p>I hope you can be of assistance. Merry X-mas and a Happy New Year!</p>\n"}, {"tags": ["ms-access", "vba", "bing-maps"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450902593, "post_id": 34435063, "comment_id": 56628181, "body": "I would assume that the vast majority of the 1/3 second per postcode is spent waiting for the HTTP request to return. I don&#39;t think there is anything you can do about this."}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450905148, "post_id": 34435063, "comment_id": 56629298, "body": "Yes you&#39;re right, but is there a way it could be batched to send like 1,000 postcodes over in one go?"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1005, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450901074, "creation_date": 1450871360, "last_edit_date": 1450901074, "question_id": 34435063, "link": "https://stackoverflow.com/questions/34435063/batch-request-bing-maps-route-api-from-within-microsoft-access", "title": "Batch request Bing Maps Route API from within Microsoft Access", "body": "<p>My question centres on using a batch request to resolve the distance between a single postcode in relation to many others, using the Microsoft Bing Maps API within a Microsoft Access database.</p>\n\n<p>I have two tables within the database, <code>I_BasePostcode</code> and <code>I_Postcodes</code>. The <code>I_BasePostcode</code> holds a single postcode for a point of interest (a hospital in this case) and the <code>I_Postcodes</code> hold thousands (up to 30,000) of other postcodes as well as their respective distances from the <code>I_BasePostcode</code>.</p>\n\n<p>The <code>I_BasePostcode</code> looks like:</p>\n\n<pre><code>+----------+\n| Postcode |\n+----------+\n| LS1 3EX  |\n+----------+\n</code></pre>\n\n<p>and an extract from the <code>I_Postcodes</code> table looks like:</p>\n\n<pre><code>+----------+--------------------+\n| Postcode | DistanceFromBase   |\n+----------+--------------------+\n| SW13 9EE |                200 |\n| SW13 9EF |                201 |\n| SW13 9EP |                205 |\n+----------+--------------------+\n</code></pre>\n\n<p>The VBA code which makes this possible is:</p>\n\n<pre><code>Const BASEURL As String = \"http://dev.virtualearth.net/REST/V1/Routes/Driving\"\nConst BINGKEY As String = \"It's a secret\"\n\nPublic Function GetDistance(FirstLocation As String, SecondLocation As String)\n\n    Dim JSON As Object\n    Dim EditedLocation As String\n\n    ' Parse the JSON output\n    Set JSON = JsonConverter.ParseJson(HttpRequestToBing(FirstLocation, SecondLocation))\n\n    ' If we get an error on the first pass it's because of Bing not liking 8 digit postcodes\n    If JSON(\"statusCode\") &lt;&gt; 200 Then\n        If Len(SecondLocation) = 8 Then\n            EditedLocation = Left(SecondLocation, 4)\n            Set JSON = JsonConverter.ParseJson(HttpRequestToBing(FirstLocation, EditedLocation))\n        End If\n        If Len(SecondLocation) = 7 Then\n            EditedLocation = Left(SecondLocation, 3)\n            Set JSON = JsonConverter.ParseJson(HttpRequestToBing(FirstLocation, EditedLocation))\n        End If\n    End If\n\n    ' Catch any errors from the second pass\n    If JSON(\"statusCode\") &lt;&gt; 200 Then GoTo ErrorHandl\n\n    ' Nasty Bing JSON formatting makes accessing the distance difficult\n    GetDistance = Trim(JSON(\"resourceSets\")(1)(\"resources\")(1)(\"travelDistance\"))\n\n    Exit Function\n\nErrorHandl:\n    GetDistance = \"\"\n\nEnd Function\n\nFunction HttpRequestToBing(FirstLocation As String, SecondLocation As String)\n\n    Dim BingURL As String\n    Dim http As Object\n\n    ' Setup the Map URL\n    BingURL = BASEURL &amp; \"?wp.0=\" &amp; URLEncode(FirstLocation) &amp; \"&amp;wp.1=\" &amp; URLEncode(SecondLocation) &amp; \"&amp;avoid=minimizeTolls&amp;du=mi&amp;key=\" &amp; BINGKEY\n\n    ' Setup the request and authorization\n    Set http = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    http.Open \"GET\", BingURL, False\n    http.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    http.send\n\n    HttpRequestToBing = http.responseText\n\nEnd Function\n</code></pre>\n\n<p>Please note I have some additional modules which parse the JSON output which are not part of the scope of my question and I've not included them.</p>\n\n<p>Finally, the query I use to match the postcodes in <code>I_Postcodes</code> to Microsoft Bing is:</p>\n\n<pre><code>UPDATE I_Postcodes, I_BasePostcode \nSET I_Postcodes.DistanceFromBase = GetDistance([I_BasePostcode].[Postcode],[I_Postcodes].[Postcode])\nWHERE (((I_Postcodes.DistanceFromBase) Is Null));\n</code></pre>\n\n<p>Whilst my query works, it takes about 50 minutes to parse 9,000 postcodes and I'm wondering if there is a way this can be batched to be more efficient?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1450871898, "post_id": 34434670, "comment_id": 56611176, "body": "Do you actually have an Excel worksheet? Where is it defined? What is this function supposed to do? --- It seems you have copied code written for Excel to Access, it doesn&#39;t work like that."}, {"owner": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450872174, "post_id": 34434670, "comment_id": 56611331, "body": "I wrote all this code by myself. It&#39;s supposed to take a column, cell by cell, of credit card numbers and write in the cell near to it, the 4 last digits."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450872402, "post_id": 34434670, "comment_id": 56611466, "body": "Ok. But in Access there are no cells. If your data is in a <b>table</b>, your task can be done with a simple UPDATE query, using the <code>Right()</code> function."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1450872707, "post_id": 34434670, "comment_id": 56611636, "body": "Add <code>Option Explicit</code> on the line after <code>Option Compare Database</code> and fix everything the compiler complains about."}, {"owner": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450873132, "post_id": 34434670, "comment_id": 56611878, "body": "@HansUp thanks but It still give an error &quot;variable not defined&quot; on and the &quot;ws&quot; bold"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1450873426, "post_id": 34434670, "comment_id": 56612069, "body": "@DvirNaim: please clarify: is your data in an <b>Access table</b> or in an <b>Excel worksheet</b>?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1450875070, "post_id": 34434670, "comment_id": 56613046, "body": "Have down-voted as we still don&#39;t know if it&#39;s an Access table or Excel worksheet - the OP doesn&#39;t seem to want to supply that vital bit of information."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1450870706, "post_id": 34434722, "comment_id": 56610457, "body": "Hi! First of all - big thanks for your answer. It Doesn&#39;t let me write End While. And even if write just End It still an error."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1450870927, "post_id": 34434722, "comment_id": 56610598, "body": "That&#39;s not the problem. <code>While i ... Wend</code> is syntactically ok, although it would be better readable to write <code>While i &lt;&gt; 0 ... Wend</code>. -- <code>End While</code> doesn&#39;t even exist."}], "tags": [], "owner": {"reputation": 37, "user_id": 1848965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3000f815704bdb3cb7ab10d24f1abd8?s=128&d=identicon&r=PG", "display_name": "Jasbeer Singh", "link": "https://stackoverflow.com/users/1848965/jasbeer-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1450870749, "last_edit_date": 1450870749, "creation_date": 1450870241, "answer_id": 34434722, "question_id": 34434670, "link": "https://stackoverflow.com/questions/34434670/access-error-sub-or-function-not-defined/34434722#34434722", "title": "access error &quot;sub or function not defined&quot;", "body": "<p>Please check your code </p>\n\n<pre><code>While i\n temp = Cells(i, column).Value\n last = Right(temp, 4)\n Cells(i, 1).offset(, column).Value = last\n i = i + 1\n If Cells(i, column).Value &lt; 1 Then\n i = 0\nEnd If\n**Wend**  \n</code></pre>\n\n<p>This is not the Wend, this might be End While.</p>\n\n<p>Regards\nJasbeer Singh</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "edited": false, "score": 1, "creation_date": 1450871217, "post_id": 34434901, "comment_id": 56610760, "body": "Thanks! It works! But there is still an error - &quot;Run-time Error &#39;424&#39;: Object Required&quot;"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "edited": false, "score": 1, "creation_date": 1450871487, "post_id": 34434901, "comment_id": 56610913, "body": "@DvirNaim: What works? Please edit your question and update the code. And indicate the line where the error occurs."}, {"owner": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "edited": false, "score": 1, "creation_date": 1450871714, "post_id": 34434901, "comment_id": 56611066, "body": "Hi. Thanks again. Done"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1450870828, "creation_date": 1450870828, "answer_id": 34434901, "question_id": 34434670, "link": "https://stackoverflow.com/questions/34434670/access-error-sub-or-function-not-defined/34434901#34434901", "title": "access error &quot;sub or function not defined&quot;", "body": "<p><code>Cells</code> is an Excel object, it doesn't exist in Access.</p>\n\n<p>If you have a worksheet variable, use it as qualifier:</p>\n\n<pre><code>ws.Cells\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "is_accepted": false, "score": 0, "last_activity_date": 1450872703, "last_edit_date": 1450872703, "creation_date": 1450872229, "answer_id": 34435293, "question_id": 34434670, "link": "https://stackoverflow.com/questions/34434670/access-error-sub-or-function-not-defined/34435293#34435293", "title": "access error &quot;sub or function not defined&quot;", "body": "<p>I think you forgot to add an Microsoft Excel 15.0 Object Library reference in your project (Tools> References and then check the library I mentionned).\nThen try to instanciate an Excel Object as follow:</p>\n\n<pre><code>Option Compare Database\n\nFunction Ashray()\n\nDim last As String\nDim i As Integer\nDim column As Integer\nDim temp As String\nDim ws As Excel.Application\nDim wsht as ws.Workbook\n\nSet wsht = Workbooks(\"yourWorkbook.xls\").Sheets(\"yourSheet\")\ncolumn = 2\ni = 1\n\nWhile i &gt; 0\ntemp = wsht.Cells(i, column).Value\nlast = Right(temp, 4)\nwsht.Cells(i, 1).offset(, column).Value = last\ni = i + 1\nIf wsht.Cells(i, column).Value &lt; 1 Then\ni = 0\nEnd If\nWend\n\nEnd Function\n</code></pre>\n\n<p>You have to add the library to the Access project, else it will not find the Excel workbook you're trying to access.</p>\n\n<p>Regards.</p>\n"}], "owner": {"reputation": 149, "user_id": 5710906, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/80b52e2e8aca40de78d56725c7290a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/5710906/dvir-naim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 34434901, "answer_count": 3, "score": 0, "last_activity_date": 1450872703, "creation_date": 1450870044, "last_edit_date": 1450871649, "question_id": 34434670, "link": "https://stackoverflow.com/questions/34434670/access-error-sub-or-function-not-defined", "title": "access error &quot;sub or function not defined&quot;", "body": "<p>I have an error in VBA access running.\nWhen I run this code</p>\n\n<pre><code>Option Compare Database\n\nFunction Ashray()\n\nDim last As String\nDim i As Integer\nDim column As Integer\nDim temp As String\n\ncolumn = 2\ni = 1\n\nWhile i &gt; 0\ntemp = ws.Cells(i, column).Value\nlast = Right(temp, 4)\nws.Cells(i, 1).offset(, column).Value = last\ni = i + 1\nIf ws.Cells(i, column).Value &lt; 1 Then\ni = 0\nEnd If\n\nWend\nEnd Function\n</code></pre>\n\n<p>I get the error <code>Run-time Error '424': Object Required</code> with the <code>temp = ws.Cells(i, column).Value</code> bold.</p>\n\n<p>I will be happy for some help..</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3623, "user_id": 1679286, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68e12b1da713bc49ac140d8fdac4f518?s=128&d=identicon&r=PG", "display_name": "winner_joiner", "link": "https://stackoverflow.com/users/1679286/winner-joiner"}, "edited": false, "score": 0, "creation_date": 1450868747, "post_id": 34434210, "comment_id": 56609231, "body": "It depence on the Code and What you want to do. You could post your Code here <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a> they are very helpful. :)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450868773, "post_id": 34434210, "comment_id": 56609258, "body": "just going for speed, doing all in one macro would be the fastest,,, however... if you cant read it, it wont help :)"}, {"owner": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "reply_to_user": {"reputation": 3623, "user_id": 1679286, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68e12b1da713bc49ac140d8fdac4f518?s=128&d=identicon&r=PG", "display_name": "winner_joiner", "link": "https://stackoverflow.com/users/1679286/winner-joiner"}, "edited": false, "score": 0, "creation_date": 1450868843, "post_id": 34434210, "comment_id": 56609306, "body": "@winner_joiner No! At Code Review we need actual code. To review. Questions without code are <a href=\"http://codereview.stackexchange.com/help/on-topic\">very off-topic</a>."}, {"owner": {"reputation": 3623, "user_id": 1679286, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68e12b1da713bc49ac140d8fdac4f518?s=128&d=identicon&r=PG", "display_name": "winner_joiner", "link": "https://stackoverflow.com/users/1679286/winner-joiner"}, "reply_to_user": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "edited": false, "score": 1, "creation_date": 1450868935, "post_id": 34434210, "comment_id": 56609365, "body": "@Mast that&#39;s why I meant, post <b>the code</b>"}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 1, "creation_date": 1450869258, "post_id": 34434210, "comment_id": 56609571, "body": "depend much to how are your if, ex you need to check only a boolean result or your IF are complex?? can be that use some Select Case and with jump to goto:...., but  like other guys wrote, without code isn&#39;t possible to suggest you a good way."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 3, "creation_date": 1450869343, "post_id": 34434210, "comment_id": 56609624, "body": "Hard to tell without looking at your code. However, you could create a function that expects an interface (using implements in a class). So you can possibly separate your code into classes which get passed into the function and will be called back. By doin this it removes your logic into more modularised classes which may be easier to manage. Will be slower than a macro switch statement or ifs. But more possibly more manageable. Depends on your code..."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1450869465, "post_id": 34434210, "comment_id": 56609719, "body": "All, posted initial version of the code."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1450869983, "post_id": 34434210, "comment_id": 56610004, "body": "What does the data look like and what are the results you want?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1450871310, "post_id": 34434210, "comment_id": 56610816, "body": "@DirkReichel are you sure there is really a significant speed difference between one long macro and a properly modularized one? I don&#39;t think a simple <code>call</code>, <code>Sub</code> and <code>End Sub</code> will add measurable amount of execution time to any code."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 3, "creation_date": 1450871417, "post_id": 34434210, "comment_id": 56610873, "body": "@Fabrizio Man, suggesting jumps and GoTo? Is it 1975 again? GoTo is a spawn of satan, please don&#39;t write things like this on a programmer&#39;s help site! OP asked for help and best practices. GoTo is the worst possible &quot;practice&quot;."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450871448, "post_id": 34434210, "comment_id": 56610892, "body": "i never said it will be a huge impact... but going down to each bit which is need to be calculated, it is faster to do all in one macro... while i wouldn&#39;t do it this way ;)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1450871508, "post_id": 34434210, "comment_id": 56610930, "body": "@vacip you have my full support to your statement :)"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1450871636, "post_id": 34434210, "comment_id": 56611017, "body": "As a general thought, <a href=\"https://en.wikipedia.org/wiki/Modular_programming\" rel=\"nofollow noreferrer\">modular programming</a> is a good idea. So I say split it to well-named subs. It will be a lot easier to follow the general flow of the program, will be easier to manage and change parts of it. If you chose not to split your code, make sure to use proper indentation. You can use tools like <a href=\"http://www.rubberduck-vba.com/\" rel=\"nofollow noreferrer\">Rubber Duck</a> to refactor your macro, and <a href=\"https://www.add-ins.com/macro-products-for-Microsoft-Excel/how-to-indent-vba-code/how-to-indent-vba-code.htm\" rel=\"nofollow noreferrer\">Smart Indenter</a> to auto-indent it."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450871781, "post_id": 34434210, "comment_id": 56611104, "body": "however... to get a real &quot;speed boost&quot; put your ranges into a variable and read/change it there..."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1450872346, "post_id": 34434210, "comment_id": 56611431, "body": "My guess is that your code will be too long by a factor of 200 or even 2000. When you have 200 clauses you are probably doing a lot of copying and pasting code with relatively little editing after each paste. If so, that which you paste is a function or sub which is waiting to be written (suitably abstracted of course)."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1450872465, "post_id": 34434210, "comment_id": 56611496, "body": "<code>If Cells(j, 8) &lt;&gt; &quot;&quot; Then                 Cells(j, 8) = Cells(j, 9) &amp; &quot; &quot; &amp; Cells(j, 8)                 Cells(j, 9).ClearContents                 Cells(j, 8).Style = &quot;Input&quot;             ElseIf Cells(j, 8) = &quot;&quot; Then                 Cells(j, 7) = Cells(j, 9) &amp; &quot; &quot; &amp; Cells(j, 7)                 Cells(j, 7).Style = &quot;Input&quot;                 Cells(j, 9).ClearContents             End If</code> It could be wise to make use of If NOT Isempty(Cells(j,8)) in this case for the first if statement, and don&#39;t do elseif, but just else for the second part. This should speed things up as well."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 3, "creation_date": 1450873250, "post_id": 34434210, "comment_id": 56611957, "body": "If it&#39;s working then may be better suited to [Code Review [vba] ]9http://codereview.stackexchange.com/questions/tagged/vba?s&zwnj;&#8203;ort=newest).  For SO it&#39;s probably off-topic because, as the number and content of comments indicate, the answer is going to be opinion based."}, {"owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "edited": false, "score": 2, "creation_date": 1450873705, "post_id": 34434210, "comment_id": 56612227, "body": "I agree with vacip, better to split it up. You have obvious sub-procedures, one for each country. I work on the basis of trying to keep my procedures to being no longer than what I can see on the screen without scrolling. The calls will add an overhead, but should not be as significant as other factors, such as screen interaction."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1450876451, "post_id": 34434210, "comment_id": 56613821, "body": "@vacip hi, is not 1975, in that year I had three years, now someone more. And let me know how is a better way to exit from on loop to jump to a next step code ?!?! I&#39;m open to any upgrade but I not think I&#39;m old, certainly practical and fast, perhaps nostalgic memories Pascal ;-)"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1450900171, "post_id": 34434210, "comment_id": 56627085, "body": "@Fabrizio I didn&#39;t mean to seem arrogant. Back in the day at my university they would fail you for so much as mentioning <code>GoTo</code> (except for the Assembly and other machine level courses). <b>Using goto</b> statement makes the logic of the program complex and tangled, creates &quot;spaghetti code&quot; that is hard to follow, understand and maintain. In the late 1960&#39;s, maybe 1970&#39;s they have shown that whatever you want to do can be done without <code>GoTo</code>. (B&#246;hm-Jacopini theorem.) Dijkstra was also pushing this agenda, and it is more or less generally accepted today."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1450900264, "post_id": 34434210, "comment_id": 56627132, "body": "Now, exiting loops and other structures is a bit grey area. Theoretical programmers (I have seen them, they exist), mathematicians would say: <i>just do the freaking exit conditions properly, then you don&#39;t need breaks!</i> And they would be right. But I admit, sometimes using a simple <code>Break</code> to get out of a loop is easier. Like using <code>Exit sub</code> looks better than putting one more <code>if</code> around your whole code. Still, it is &quot;considered harmful&quot;, and whenever I do it, I feel a bit ashamed. <a href=\"https://xkcd.com/292/\" rel=\"nofollow noreferrer\">Example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1450896013, "last_edit_date": 1450896013, "creation_date": 1450892048, "answer_id": 34440926, "question_id": 34434210, "link": "https://stackoverflow.com/questions/34434210/excel-vba-best-practice-one-long-macro-or-multiple-small-macros/34440926#34440926", "title": "Excel VBA Best Practice: One long macro or multiple small macros?", "body": "<p>Just getting rid of a lot of repeating factors in your code would help a lot with readability.  For example use some range variables to remove all that repeating <code>Cells(j, xx)</code> - that will tidy up your code a lot and it's easier to maintain/refactor tidy code.</p>\n\n<pre><code>Dim rw As Range, c8, c9, c10\nSet rw = Rows(j)\n\n'use better variable names here...\nSet c8 = rw.Cells(8)\nSet c9 = rw.Cells(9)\nSet c10 = rw.Cells(10)\n\nIf c10 = \"AT\" Then\n\nElseIf c10 = \"BE\" Then\n\n    If c9 &lt;&gt; \"\" Then\n\n        If Left(c9, 2) = \"B-\" And IsNumeric(Right(c9, 1)) And Len(c9) = 6 Then\n            c8 = c9 &amp; \" \" &amp; c8\n            c9.ClearContents\n            c8.Style = \"input\"\n        ElseIf IsNumeric(Left(c9, 2)) And IsNumeric(Right(c9, 1)) = True Then\n            c9 = \"B-\" &amp; c9\n            c8 = c9 &amp; \" \" &amp; c8\n            c9.ClearContents\n            c8.Style = \"input\"\n        ElseIf IsNumeric(Right(c9, 2)) And Left(c9, 2) &lt;&gt; \"B-\" Then\n            c9 = Trim(Right(c9, 6) &amp; \" \" &amp; Left(c9, Len(c9) - 6))\n            c9.Style = \"Input\"\n        End If\n\n    End If\n</code></pre>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 34440926, "answer_count": 1, "score": 0, "last_activity_date": 1450896013, "creation_date": 1450868542, "last_edit_date": 1450870732, "question_id": 34434210, "link": "https://stackoverflow.com/questions/34434210/excel-vba-best-practice-one-long-macro-or-multiple-small-macros", "title": "Excel VBA Best Practice: One long macro or multiple small macros?", "body": "<p>Looking for some suggestions on best practice for writing a macro. I am currently writing one that, when complete, will have about 200 IF/ELSE clauses. Each of these clauses will have about 10 IF/ELSE subclauses.</p>\n\n<p>From an arrangement point of view, it will be very messy.</p>\n\n<p>However, from a best practice point of view, would it be better to have:</p>\n\n<ul>\n<li>each of the clauses to call another macro, which will contain the subclauses?</li>\n<li>leave the subclauses within the overall body of the main macro?</li>\n</ul>\n\n<p>Also, how would each of these options affect the speed of the macro (as in would option 1 be slower or faster than option 2)? The spreadsheet it is working on will have some 50k rows, and about 13 columns.</p>\n\n<p>Edit 1:</p>\n\n<p>This is a sample of the beginning of the code (very long and messy):</p>\n\n<pre><code>If Cells(j, 10) = \"AT\" Then\n\n    ElseIf Cells(j, 10) = \"BE\" Then                           ' Belgian formatting\n        If Cells(j, 9) &lt;&gt; \"\" Then\n            If Left(Cells(j, 9), 2) = \"B-\" And IsNumeric(Right(Cells(j, 9), 1)) = True And Len(Cells(j, 9)) = 6 Then\n                Cells(j, 8) = Cells(j, 9) &amp; \" \" &amp; Cells(j, 8)\n                Cells(j, 9).ClearContents\n                Cells(j, 8).Style = \"input\"\n            ElseIf IsNumeric(Left(Cells(j, 9), 2)) = True And IsNumeric(Right(Cells(j, 9), 1)) = True Then\n                Cells(j, 9) = \"B-\" &amp; Cells(j, 9)\n                Cells(j, 8) = Cells(j, 9) &amp; \" \" &amp; Cells(j, 8)\n                Cells(j, 9).ClearContents\n                Cells(j, 8).Style = \"input\"\n            ElseIf IsNumeric(Right(Cells(j, 9), 2)) = True And Left(Cells(j, 9), 2) &lt;&gt; \"B-\" Then\n                Cells(j, 9) = Trim(Right(Cells(j, 9), 6) &amp; \" \" &amp; Left(Cells(j, 9), Len(Cells(j, 9)) - 6))\n                Cells(j, 9).Style = \"Input\"\n            End If\n        End If\n\n    ElseIf Cells(j, 10) = \"CH\" Then                                             ' Swiss formatting\n        If Len(Cells(j, 9)) = 4 Then\n            Cells(j, 9) = \"CH-\" &amp; Cells(j, 9)\n            Selection.Style = \"Input\"\n'            ElseIf Len(Cells(j, 9)) = 7 And Left(Cells(j, 9), 2) = \"CH\" Then       Fix to include moving the post codes before the city name\n'                Selection.Style = \"Neutral\"\n        End If\n\n    ElseIf Cells(j, 10) = \"DE\" Then                                             ' German formatting\n        If Left(Cells(j, 9), 1) &lt;&gt; \"D\" Then\n            Cells(j, 9) = \"D-\" &amp; Cells(j, 9)\n            Selection.Style = \"Neutral\"\n        End If\n        If IsNumeric(Right(Cells(j, 9), 5)) = True And Len(Cells(j, 9)) = 7 Then\n            If Cells(j, 8) &lt;&gt; \"\" Then\n                Cells(j, 8) = Cells(j, 9) &amp; \" \" &amp; Cells(j, 8)\n                Cells(j, 9).ClearContents\n                Cells(j, 8).Style = \"Input\"\n            ElseIf Cells(j, 8) = \"\" Then\n                Cells(j, 7) = Cells(j, 9) &amp; \" \" &amp; Cells(j, 7)\n                Cells(j, 7).Style = \"Input\"\n                Cells(j, 9).ClearContents\n            End If\n        ElseIf IsNumeric(Right(Cells(j, 9), 5)) And Len(Cells(j, 9)) &gt; 8 Then\n            If Mid(Cells(j, 9), Len(Cells(j, 9) - 7), 1) = \"D\" Then\n                Cells(j, 9) = Trim(Right(Cells(j, 9), 7) &amp; \" \" &amp; Left(Cells(j, 9), Len(Cells(j, 9)) - 7))\n                Cells(j, 9).Style = \"Input\"\n            End If\n        Else\n            Cells(j, 9).Style = \"Bad\"\n        End If\n\n    ElseIf Cells(j, 10) = \"IE\" Then                                         ' Irish formatting\n        If Cells(j, 9) &lt;&gt; \"\" Then\n            If IsNumeric(Right(Cells(j, 9), 1)) = True And (Len(Cells(j, 9)) = 9 Or Len(Cells(j, 9)) = 8) Then\n            ElseIf (Len(Cells(j, 9)) &lt;&gt; 8 Or Len(Cells(j, 9)) &lt;&gt; 9) And Left(Cells(j, 9), 6) = \"DUBLIN\" Then\n                If Mid(Cells(j, 9), Len(Cells(j, 9)) - 1, 1) = \" \" Then\n                    Cells(j, 9) = Left(Cells(j, 9), 6) &amp; \" \" &amp; Right(Cells(j, 9), 1)\n                    Cells(j, 9).Style = \"Input\"\n                ElseIf Mid(Cells(j, 9), Len(Cells(j, 9)) - 2, 1) = \" \" Then\n                    Cells(j, 9) = Left(Cells(j, 9), 6) &amp; \" \" &amp; Right(Cells(j, 9), 2)\n                    Cells(j, 9).Style = \"Input\"\n                End If\n            ElseIf Left(Cells(j, 9), 1) = \"A\" Or Left(Cells(j, 9), 1) = \"B\" Or Left(Cells(j, 9), 1) = \"E\" Or Left(Cells(j, 9), 1) = \"F\" _\n                Or Left(Cells(j, 9), 1) = \"H\" Or Left(Cells(j, 9), 1) = \"I\" Or Left(Cells(j, 9), 1) = \"J\" Or Left(Cells(j, 9), 1) = \"N\" _\n                Or Left(Cells(j, 9), 1) = \"O\" Or Left(Cells(j, 9), 1) = \"P\" Or Left(Cells(j, 9), 1) = \"Q\" Or Left(Cells(j, 9), 1) = \"B\" _\n                Or Left(Cells(j, 9), 1) = \"U\" Or Left(Cells(j, 9), 1) = \"V\" Or Left(Cells(j, 9), 1) = \"W\" Or Left(Cells(j, 9), 1) = \"X\" _\n                Or Left(Cells(j, 9), 1) = \"Y\" Or Left(Cells(j, 9), 1) = \"Z\" Then\n                Cells(j, 9).Style = \"Bad\"\n            ElseIf Len(Cells(j, 9)) &gt; 16 Then\n                Cells(j, 9).Style = \"Bad\"\n            ElseIf (Len(Cells(j, 9)) &lt;&gt; 8 Or Len(Cells(j, 9)) &lt;&gt; 9) And Left(Cells(j, 9), 6) &lt;&gt; \"DUBLIN\" Then\n            End If\n        End If\n        If Cells(j, 8) = \"DUBLIN\" And Left(Cells(j, 9), 6) = \"DUBLIN\" Then\n            Cells(j, 8).ClearContents\n        ElseIf Cells(j, 7) = \"DUBLIN\" And Left(Cells(j, 9), 6) = \"DUBLIN\" Then\n            Cells(j, 7).ClearContents\n        ElseIf Cells(j, 8) = \"CORK\" And Left(Cells(j, 9), 4) = \"CORK\" Then\n            Cells(j, 8).ClearContents\n        End If\n\n        ElseIf Cells(j, 10) = \"US\" Then                                         ' US formatting\n        b = Len(Cells(j, 9))\n        If Cells(j, 10) = \"US\" And b &lt; 5 And b &gt; 1 Then\n            Cells(j, 9).Select\n            Selection.NumberFormat = \"@\"\n            If b = 4 Then\n                Cells(j, 9) = \"0\" &amp; Cells(j, 9)\n            Else\n                Cells(j, 9) = \"00\" &amp; Cells(j, 9)\n            End If\n        ElseIf Cells(j, 10) = \"US\" And Mid(Cells(j, 9), 3, 1) = \" \" And Len(Cells(j, 9)) = 7 Then\n            Cells(j, 9) = Left(Cells(j, 9), 3) &amp; \"0\" &amp; Right(Cells(j, 9), 4)\n        End If\n        If Len(Cells(j, 8)) = 2 And Cells(j, 9) &lt;&gt; \"\" And Len(Cells(j, 9)) &gt;= 5 Then\n            Cells(j, 8) = Cells(j, 8) &amp; \" \" &amp; Cells(j, 9)\n            Cells(j, 9).ClearContents\n            Range(Cells(j, 8), Cells(j, 9)).Style = \"Neutral\"\n        ElseIf Len(Cells(j, 9)) = 8 Or Len(Cells(j, 9)) = 12 Then\n            e = Application.Match(Left(Cells(j, 9), 2), Worksheets(\"Codes\").Range(\"G:G\"), 0)\n            If Selection.Style &lt;&gt; \"Neutral\" And Not IsError(e) Then\n                Selection.Style = \"Input\"\n            End If\n        ElseIf (Len(Cells(j, 9)) &gt;= 5) And (Len(Cells(j, 8)) - 2) &gt;= 0 Or (Len(Cells(j, 7)) - 2) &gt;= 0 Then\n            If Mid(Cells(j, 7), Len(Cells(j, 7)) - 2, 1) = \" \" And Cells(j, 8) = \"\" Then\n                Cells(j, 9) = Right(Cells(j, 7), 2) &amp; \" \" &amp; Cells(j, 9)\n                Cells(j, 7) = Trim(Left(Cells(j, 7), Len(Cells(j, 7)) - 2))\n                Range(Cells(j, 7), Cells(j, 9)).Style = \"Neutral\"\n            ElseIf Mid(Cells(j, 8), Len(Cells(j, 8)) - 2, 1) = \" \" And Len(Cells(j, 8)) - 2 &gt;= 0 And IsNumeric(Right(Cells(j, 8), 1)) = False Then\n                e = Application.Match(Right(Cells(j, 8), 2), Worksheets(\"Codes\").Range(\"G:G\"), 0)\n                If Not IsError(e) Then\n                    Cells(j, 9) = Right(Cells(j, 8), 2) &amp; \" \" &amp; Cells(j, 9)\n                    Cells(j, 8) = Trim(Left(Cells(j, 8), Len(Cells(j, 8)) - 2))\n                    Cells(j, 9).Style = \"Input\"\n                    Cells(j, 8).Style = \"Neutral\"\n                End If\n            ElseIf Mid(Cells(j, 8), 3, 1) = \" \" And Len(Cells(j, 8)) - 2 &gt;= 0 And IsNumeric(Right(Cells(j, 8), 3)) = True Then\n                e = Application.Match(Left(Cells(j, 8), 2), Worksheets(\"Codes\").Range(\"G:G\"), 0)\n                If Not IsError(e) Then\n                    If Cells(j, 8).Style &lt;&gt; \"Neutral\" Or Cells(j, 8).Style &lt;&gt; \"Input\" Then\n                        Cells(j, 8).Style = \"Input\"\n                        Cells(j, 9).Style = \"input\"\n                    End If\n                End If\n            ElseIf Selection.Style &lt;&gt; \"Neutral\" Then\n                Range(Cells(j, 8), Cells(j, 9)).Style = \"Bad\"\n            End If\n        Else\n            If Selection.Style &lt;&gt; \"Neutral\" Then\n                Selection.Style = \"Bad\"\n            End If\n        End If\n\n    End If\n</code></pre>\n\n<p>Edit 2:</p>\n\n<p>The data is in the format ADD1 (Cells(j,5), ADD2 (..6), ADD3 (...7), ADD4 (..8), ADD5 (...9, normally a post code which needs formatting), and ADD6 (..10, the ISO country code). </p>\n\n<p>The point of the code is to check each line, and if the post code is in the correct format for the country (such as the US, Ireland, Austria, etc.) then it does nothing. However, if there is parts missing or in the incorrect order, it will go and either fix the fault (add in details, remove repeated data, move data around, or concatenate the data into a field), or highlight the data as being faulty.</p>\n\n<p>As each country has different rules, and some countries have more than 1 rule, it gets very messy.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1450867165, "last_edit_date": 1450867165, "creation_date": 1450866668, "answer_id": 34433635, "question_id": 34433469, "link": "https://stackoverflow.com/questions/34433469/convert-decimal-to-percentage/34433635#34433635", "title": "Convert decimal to percentage", "body": "<p>Divide the number by 100 and format as a percentage.</p>\n\n<p><code>=A1/100</code></p>\n\n<p>Edit - to check which is formatted as a percentage and which isn't use:\n<code>=IF(CELL(\"format\",A1)=\"P0\",A1,A1/100)</code> - P0 indicates a percentage format.\nThe formula will display all the numbers without percentages, so 150% will display as 1.5, as will 150.<br>\nThen it's just a case of formatting the entire column back to percentages.</p>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "edited": false, "score": 0, "creation_date": 1450867571, "post_id": 34433656, "comment_id": 56608536, "body": "Thank you for the answer but it still not working, now I&#39;m getting 39683% instead of 3,9683%"}, {"owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "edited": false, "score": 0, "creation_date": 1450867745, "post_id": 34433656, "comment_id": 56608625, "body": "Unfortunately I can&#39;t change the source"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "edited": false, "score": 0, "creation_date": 1450867822, "post_id": 34433656, "comment_id": 56608682, "body": "hah... that may be the problem... so you need something different... try my last option"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 2, "last_activity_date": 1450867889, "last_edit_date": 1450867889, "creation_date": 1450866744, "answer_id": 34433656, "question_id": 34433469, "link": "https://stackoverflow.com/questions/34433469/convert-decimal-to-percentage/34433656#34433656", "title": "Convert decimal to percentage", "body": "<p>change</p>\n\n<pre><code>actCell.value = Format(actCell, \"#.####%\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>actCell.value = Format(actCell / 100, \"#.####%\")\n</code></pre>\n\n<p>However, if it is no real % value you neet to change it to</p>\n\n<pre><code>actCell.value = Format(actCell, \"#.####\"\"%\"\"\")\n</code></pre>\n\n<p>or if you cant change the values try</p>\n\n<pre><code>actCell.Offset.NumberFormat = \"#.####\"\"%\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6459, "favorite_count": 1, "accepted_answer_id": 34433656, "answer_count": 2, "score": 3, "last_activity_date": 1450867889, "creation_date": 1450866137, "question_id": 34433469, "link": "https://stackoverflow.com/questions/34433469/convert-decimal-to-percentage", "title": "Convert decimal to percentage", "body": "<p>I'm receiving data like below from an external source </p>\n\n<p><a href=\"https://i.stack.imgur.com/7axwe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7axwe.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I need is to convert all highlighted data to percentage and I can't lost the part after the comma. \nHere is what I have tried so far:</p>\n\n<pre><code>For Each actCell In shRecipiente.ListObjects(\"tblRecipiente\").ListColumns(\"All-In Rate\").DataBodyRange\n    If Not (Right(actCell.NumberFormat, 1) = \"%\") Then\n        actCell.Value = Format(actCell, \"#.####%\")\n    End If\nNext actCell\n</code></pre>\n\n<p>But I'm getting for example 396,83% instead of 3,9683%</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "edited": false, "score": 0, "creation_date": 1450867552, "post_id": 34433583, "comment_id": 56608530, "body": "so you&#39;re saying if I explicitly associate the range with the desired sheet, then it should work?"}, {"owner": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "edited": false, "score": 0, "creation_date": 1450868370, "post_id": 34433583, "comment_id": 56608999, "body": "tried your activesheet solution, now they both don&#39;t work"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "edited": false, "score": 0, "creation_date": 1450869261, "post_id": 34433583, "comment_id": 56609576, "body": "mmm... give me a minute. in the mean time, does the other method work?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "edited": false, "score": 0, "creation_date": 1450869698, "post_id": 34433583, "comment_id": 56609853, "body": "Hmm, the Activesheet version works for me. The thing is that the Range you feed to the Table adding method must come from the sheet where you are putting the Table."}, {"owner": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "edited": false, "score": 0, "creation_date": 1450871680, "post_id": 34433583, "comment_id": 56611043, "body": "your edit worked, though it&#39;s weird because I have tried to activate the worksheet from within the function and that doesn&#39;t seem to work"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "edited": false, "score": 0, "creation_date": 1450871865, "post_id": 34433583, "comment_id": 56611152, "body": "True, because you select ranges outside of the makeTable Sub. So you&#39;d have to make sure the arguments passed are interpreted on the same sheet too."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 2, "last_activity_date": 1450869845, "last_edit_date": 1450869845, "creation_date": 1450866476, "answer_id": 34433583, "question_id": 34433431, "link": "https://stackoverflow.com/questions/34433431/cannot-create-table-vba-excel/34433583#34433583", "title": "Cannot create table VBA excel", "body": "<p>Your TableRange is on the ActiveSheet(wherever that is).\nYou are trying to create a table on sheet (\"Finance Tracker\") with a range taken from the activesheet.</p>\n\n<p>Depending on what you really need, you can either change the maketable sub like this:</p>\n\n<pre><code>ActiveSheet.ListObjects.Add(xlSrcRange, TableRange, ,xlYes).name = TableSheet\n</code></pre>\n\n<p>Or change the call like this:</p>\n\n<pre><code>Call makeTable(\"Finance Tracker\", sheets(\"Finance Tracker\").range(sheet(\"Finance Tracker\").Cells(21, 1), sheet(\"Finance Tracker\").Cells(LastFinance, 23)))\n</code></pre>\n\n<p>Just make sure everything is happening on the same sheet.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>One more thing to try (works for me this way aswell):</p>\n\n<pre><code>Worksheets(\"Uber Tracker\").Activate\nCall makeTable(\"Uber Tracker\", Range(Cells(7, 1), Cells(10, 42)))\nWorksheets(\"Finance Tracker\").Activate\nCall makeTable(\"Finance Tracker\", Range(Cells(21, 1), Cells(30, 23)))\n</code></pre>\n\n<p>Just make sure the Range you use to create a table is on the same sheet where the Table is being added. There are many ways to do this, these are just a few examples.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1450868281, "creation_date": 1450868281, "answer_id": 34434138, "question_id": 34433431, "link": "https://stackoverflow.com/questions/34433431/cannot-create-table-vba-excel/34434138#34434138", "title": "Cannot create table VBA excel", "body": "<p>You could also just use the address of whichever range is passed to the routine:</p>\n\n<pre><code>Sheets(TableSheet).ListObjects.Add(xlSrcRange, Sheets(TableSheet).Range(TableRange.Address), ,xlYes).name = TableSheet\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 1902692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/002a2eaf2bef8acfda3ba85a457da53f?s=128&d=identicon&r=PG", "display_name": "user1902692", "link": "https://stackoverflow.com/users/1902692/user1902692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 34433583, "answer_count": 2, "score": 0, "last_activity_date": 1450869845, "creation_date": 1450866054, "question_id": 34433431, "link": "https://stackoverflow.com/questions/34433431/cannot-create-table-vba-excel", "title": "Cannot create table VBA excel", "body": "<p>When I run this function        </p>\n\n<pre><code>    Call makeTable(\"Uber Tracker\", range(Cells(7, 1), Cells(LastUber, 42)))\n    Call makeTable(\"Finance Tracker\", range(Cells(21, 1), Cells(LastFinance, 23)))\n</code></pre>\n\n<p>The first call works fine, but the second shows error 1004 worksheet range must be on the same sheet as the table being created.</p>\n\n<pre><code>    Sub makeTable(TableSheet As String, TableRange As range)\n        On Error GoTo errorHandler\n        Sheets(TableSheet).ListObjects.Add(xlSrcRange, TableRange, ,xlYes).name = TableSheet\n\n    errorHandler:\n        If Err.Number &lt;&gt; 0 Then\n            Debug.Print \"Error number :\" + CStr(Err.Number) + \" reason: \" + Err.Description\n        End If\n\n    End Sub\n</code></pre>\n\n<p>What is wrong? I have checked which sheet it is selecting, and it should be correct, same for the range.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450866088, "post_id": 34433145, "comment_id": 56607612, "body": "the whole column <code>H</code> or just for the rows having nothing in column <code>H</code>?"}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450866698, "post_id": 34433145, "comment_id": 56608008, "body": "If the row has nothing in column H I want that row to move, if there is something in column H I want the row to stay."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452082700, "post_id": 34433145, "comment_id": 57010800, "body": "So what happened with this?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450868782, "post_id": 34434117, "comment_id": 56609263, "body": "Thanks... That works good to separate it and put it on another page, but I also need it to disappear from the original page if that is possible?"}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450869756, "post_id": 34434117, "comment_id": 56609890, "body": "it is moving it to a new page rather than a different place on the same page too."}], "tags": [], "owner": {"reputation": 258, "user_id": 1582568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674c7c60f49b427d1b8f8d5c175221e4?s=128&d=identicon&r=PG", "display_name": "user1582568", "link": "https://stackoverflow.com/users/1582568/user1582568"}, "is_accepted": false, "score": 1, "last_activity_date": 1450868228, "creation_date": 1450868228, "answer_id": 34434117, "question_id": 34433145, "link": "https://stackoverflow.com/questions/34433145/vba-code-for-moving-a-row-based-on-criteria/34434117#34434117", "title": "VBA code for moving a row based on criteria", "body": "<p>Try this for a starting point</p>\n\n<pre><code>Option Explicit\nConst FIRST_ROW As Long = 2\nConst LAST_ROW As Long = 100\nConst FIRST_SOURCE_COL As Long = 2 'column B\nConst LAST_SOURCE_COL As Long = 9 'column I\nConst TRIG_COL As Long = 8 'column H\nConst GAP As Long = 2 'columns gap between original data and moved data\n\nSub moveit()\nDim r As Long\nDim c As Long\nConst DIST As Long = LAST_SOURCE_COL - FIRST_SOURCE_COL + GAP + 1\n\nFor r = FIRST_ROW To LAST_ROW\n    'check if we need to move\n    If Cells(r, TRIG_COL).Value = \"\" Then\n    'move the data\n        For c = FIRST_SOURCE_COL To LAST_SOURCE_COL\n            Cells(r, c + DIST).Value = Cells(r, c).Value\n            Cells(r, c).Value = \"\"\n        Next\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450870151, "post_id": 34434433, "comment_id": 56610115, "body": "Move Blanks doesn&#39;t seem to do anything... sorry"}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450870952, "post_id": 34434433, "comment_id": 56610609, "body": "Column H , Row 23 is blank - I am looking at it now... 1-22 are populated, but nothing is moving over...."}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450871475, "post_id": 34434433, "comment_id": 56610908, "body": "Yes, Column B will always be populated, its Column H that could be blank - thats the one I want it to check before it moves the full row over..  if that makes sense (I&#39;m just learning!!!)"}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450871795, "post_id": 34434433, "comment_id": 56611113, "body": "I can&#39;t see a picture sorry! all i see is the word Before then the word After"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450871981, "post_id": 34434433, "comment_id": 56611223, "body": "<a href=\"http://i.stack.imgur.com/ni5f6.jpg\" rel=\"nofollow noreferrer\">Before</a> and <a href=\"http://i.stack.imgur.com/8iyjO.jpg\" rel=\"nofollow noreferrer\">After</a>...maybe this will work"}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450872085, "post_id": 34434433, "comment_id": 56611281, "body": "still nothing just a blank page! - possibly my permissions at work won&#39;t allow it?"}, {"owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450876744, "post_id": 34434433, "comment_id": 56613989, "body": "Yes it does match exactly. Don&#39;t understand why its not working. Nothing happens at all!"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "edited": false, "score": 0, "creation_date": 1450877059, "post_id": 34434433, "comment_id": 56614142, "body": "lets see a screen shot"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1450870505, "last_edit_date": 1450870505, "creation_date": 1450869264, "answer_id": 34434433, "question_id": 34433145, "link": "https://stackoverflow.com/questions/34433145/vba-code-for-moving-a-row-based-on-criteria/34434433#34434433", "title": "VBA code for moving a row based on criteria", "body": "<p>Move the blanks,</p>\n\n<pre><code>Sub MoveBlanks()\n    Dim lRws As Long, sh As Worksheet, x\n\n    Set sh = Sheets(\"Sheet2\")\n\n    With sh\n        lRws = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        For x = lRws To 2 Step -1\n            If .Cells(x, \"H\") = \"\" Then\n                .Range(.Cells(x, \"B\"), .Cells(x, \"I\")).Cut .Cells(.Rows.Count, \"L\").End(xlUp).Offset(1)\n                .Range(.Cells(x, \"B\"), .Cells(x, \"I\")).Delete Shift:=xlUp\n            End If\n        Next x\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Before</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ni5f6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ni5f6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>After</strong>\n<a href=\"https://i.stack.imgur.com/8iyjO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8iyjO.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5710632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b51d0ddc0523162bbaba639a27391b2?s=128&d=identicon&r=PG&f=1", "display_name": "mistybev", "link": "https://stackoverflow.com/users/5710632/mistybev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450870505, "creation_date": 1450865221, "last_edit_date": 1450865550, "question_id": 34433145, "link": "https://stackoverflow.com/questions/34433145/vba-code-for-moving-a-row-based-on-criteria", "title": "VBA code for moving a row based on criteria", "body": "<p>I am new to StackExchange and VBA and I have tried to find an answer to this but I'm having issues!!!</p>\n\n<p>I have a spreadsheet where information is input and appears in Sheet 2, columns B-I. What I would like it to do is that if Column H is blank, it moves the whole row into column L to S. So my data will be split into 2 separate places on the same sheet based on whether H is empty or populated.</p>\n\n<p>The information in column H will be different every time so i can't specify what will be in the column, but there are times when there will be nothing input into column H and that is when I want it to move.</p>\n\n<p>Can anyone tell me how to achieve this?\nMany thanks\nBev</p>\n"}, {"tags": ["ms-access", "vba", "rgb"], "answers": [{"tags": [], "owner": {"reputation": 44607, "user_id": 833073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b2e4376123477a31727c54096d1d117?s=128&d=identicon&r=PG", "display_name": "fthiella", "link": "https://stackoverflow.com/users/833073/fthiella"}, "is_accepted": false, "score": 1, "last_activity_date": 1450866405, "last_edit_date": 1450866405, "creation_date": 1450865166, "answer_id": 34433125, "question_id": 34433014, "link": "https://stackoverflow.com/questions/34433014/access-vba-argument-not-optional-backcolor/34433125#34433125", "title": "Access VBA - Argument not optional - backcolor", "body": "<p>The Dlookup function accepts these arguments:</p>\n\n<ul>\n<li>FieldName: a field, calculation, control on a form, or function that you wish to return;</li>\n<li>TableName: the set of records. This can be a table or a query name;</li>\n<li>Criteria (Optional): It is the WHERE clause to apply to the TableName.</li>\n</ul>\n\n<p>And the RGB functions accepts these three:</p>\n\n<ul>\n<li>red: the red component of the color;</li>\n<li>green: the green component of the color;</li>\n<li>blue: the blue component of the color.</li>\n</ul>\n\n<p>I would suggest you to use three different columns for the component color in your table:</p>\n\n<pre><code>ID | ColourR | ColourG | ColourB | SelectedScheme\n---|---------|---------|---------|---------------\n1  | 136     |207      | 39      | Yes\n</code></pre>\n\n<p>Your event can be written as this:</p>\n\n<pre><code>Me.boxheader.BackColor = RGB(\n  DLookup(\"ColourR\", \"SchemaTableName\", \"SelectedScheme=TRUE\"),\n  DLookup(\"ColourG\", \"SchemaTableName\", \"SelectedScheme=TRUE\"),\n  DLookup(\"ColourB\", \"SchemaTableName\", \"SelectedScheme=TRUE\")\n)\n</code></pre>\n\n<p>this will select the color from the table SchemaTableName where the field SelectedScheme is set to true.</p>\n"}, {"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1450865425, "creation_date": 1450865425, "answer_id": 34433217, "question_id": 34433014, "link": "https://stackoverflow.com/questions/34433014/access-vba-argument-not-optional-backcolor/34433217#34433217", "title": "Access VBA - Argument not optional - backcolor", "body": "<p>Arguments of RGB function are numeric, not string, and there should be 3 of them:</p>\n\n<pre><code>RGB(136,207,39)\n</code></pre>\n\n<p>You are trying to pass one string argument.\nYou can use <code>Split</code> function for extracting color values from string:</p>\n\n<pre><code>Me.boxheader.BackColor = RGB(Split(RGBcolor,\",\")(0),Split(RGBcolor,\",\")(1),Split(RGBcolor,\",\")(2))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1450871912, "creation_date": 1450871912, "answer_id": 34435208, "question_id": 34433014, "link": "https://stackoverflow.com/questions/34433014/access-vba-argument-not-optional-backcolor/34435208#34435208", "title": "Access VBA - Argument not optional - backcolor", "body": "<p>The <code>RGB()</code> function expects 3 numbers, but your code supplies a single string value.  That is the cause of the <em>\"Argument not optional\"</em> compile error.  </p>\n\n<p>Construct a new string which includes the <code>RGB()</code> function plus your string of numbers.  Submit that new string to <code>Eval()</code> ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.boxheader.BackColor = Eval(\"RGB(\" &amp; RBGcolor &amp; \")\")\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 4007699, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/93f9766ce5adb803e434905b4fe66da3?s=128&d=identicon&r=PG&f=1", "display_name": "Max Thorley", "link": "https://stackoverflow.com/users/4007699/max-thorley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1450871968, "creation_date": 1450864824, "last_edit_date": 1450871968, "question_id": 34433014, "link": "https://stackoverflow.com/questions/34433014/access-vba-argument-not-optional-backcolor", "title": "Access VBA - Argument not optional - backcolor", "body": "<p>I have a table where the user can select a colour scheme for their database</p>\n\n<pre><code>ID | Colour     | SelectedScheme\n---|------------|--------------\n1  | 136,207,39 | Yes\n</code></pre>\n\n<p>Then on my form I have the following on the current events tab</p>\n\n<pre><code>Dim RGBcolor As Long\nRBGcolor = DLookup(\"Colour\", \"SelectedScheme\")\nMe.boxheader.BackColor = RGB(RGBcolor)\n</code></pre>\n\n<p>but I'm getting the Argument not optional error. any idea?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1450865999, "post_id": 34432910, "comment_id": 56607557, "body": "Just create a blank form? I&#39;m not sure I understand your question. Just use the New form button, add controls etc. Then no query or database will be linked to the form, so nothing will be inserted nowhere unless you do something with VBA."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1450890815, "creation_date": 1450890815, "answer_id": 34440651, "question_id": 34432910, "link": "https://stackoverflow.com/questions/34432910/vba-access-and-forms/34440651#34440651", "title": "VBA access and forms", "body": "<p>Your form must be <strong>unbound</strong>, i.e. its <code>RecordSource</code> must be empty.</p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 10140353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f44816c13d6678a2c6d07254e212e31d?s=128&d=identicon&r=PG&f=1", "display_name": "Duncan Drake", "link": "https://stackoverflow.com/users/10140353/duncan-drake"}, "is_accepted": false, "score": 0, "last_activity_date": 1532716994, "creation_date": 1532716994, "answer_id": 51563805, "question_id": 34432910, "link": "https://stackoverflow.com/questions/34432910/vba-access-and-forms/51563805#51563805", "title": "VBA access and forms", "body": "<p>Your form can be bound or not bound to a table / query.\nThis means that the controls on your form may be bound to a field of that table / query.</p>\n\n<p>But you can also have controls in the same form which are not bound.</p>\n\n<p>Example:\nYou can make a form in which the body has a list view of the records of the table. In this section the controls would be bound to a field.</p>\n\n<p>In the header of the table instead you may have controls that are not bound and that could be used either to filter the records shown or to add new records. You may want to add records this way rather than let users insert data directly in order to add checks or do any other kind of processing before actually adding the data in a new record. </p>\n"}], "owner": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1532716994, "creation_date": 1450864526, "last_edit_date": 1450887341, "question_id": 34432910, "link": "https://stackoverflow.com/questions/34432910/vba-access-and-forms", "title": "VBA access and forms", "body": "<p>I created a database in Access and there are some type of records in some tables that requires a particular inserting, so I decided to use VBA to handle this.</p>\n\n<p><strong>The problem is</strong> that if i create a form with some controls which i want to refer and use their values as criteria for queries, the form is still a way to insert data. So the query works but the data i inserted are added directly from the form too, creating duplicates.</p>\n\n<p><strong>The question is</strong>, is there a way to create a form that has controls only for text input but does nothing to record , leaving inserting, deleting , updating all to queries in VBA?\nI tried to put \"no\" on propriety \"add records\" in the form but it gets totally blank with no controls.</p>\n"}, {"tags": ["vba", "memory", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1450871626, "post_id": 34434931, "comment_id": 56611005, "body": "I&#39;ve tried to run it on another PC(with half the RAM as mine) and it works OK with the same document and action :S. Therefore, with that procedure RAM usage by Word only reaches about 80 MB :S:S:S  ad told you, if I launch it, it crashes while doing &quot;Selection.clearformatting&quot;, but if I run it step by step, it doesn&#39;t crash"}, {"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1451292806, "post_id": 34434931, "comment_id": 56722482, "body": "Tried and it worked. Indeed the problem was a missed pointer to the document."}, {"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1451300683, "post_id": 34434931, "comment_id": 56726327, "body": "Too quick...it happens again. It always happens in <code>Selection.ClearFormatting</code> and don&#39;t know why. And if I use debug after getting error, it continues without problem."}, {"owner": {"reputation": 341, "user_id": 5685736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1048322038560967/picture?type=large", "display_name": "Pav El", "link": "https://stackoverflow.com/users/5685736/pav-el"}, "reply_to_user": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1451340077, "post_id": 34434931, "comment_id": 56744560, "body": "I&#39;ve added another suggestion."}, {"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1451372984, "post_id": 34434931, "comment_id": 56753903, "body": "As told before, it happens randomly and only ni my PC. If i run this macro on this document in other PC, it doesn&#39;t give an error. It may be some kind of problem with user profile."}, {"owner": {"reputation": 341, "user_id": 5685736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1048322038560967/picture?type=large", "display_name": "Pav El", "link": "https://stackoverflow.com/users/5685736/pav-el"}, "reply_to_user": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1451381470, "post_id": 34434931, "comment_id": 56757597, "body": "are office versions same? what office do you use, and what&#39;s on the other PC?"}], "tags": [], "owner": {"reputation": 341, "user_id": 5685736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1048322038560967/picture?type=large", "display_name": "Pav El", "link": "https://stackoverflow.com/users/5685736/pav-el"}, "is_accepted": false, "score": 1, "last_activity_date": 1451341504, "last_edit_date": 1451341504, "creation_date": 1450870936, "answer_id": 34434931, "question_id": 34432577, "link": "https://stackoverflow.com/questions/34432577/vba-macro-error-5113/34434931#34434931", "title": "VBA Macro: Error 5113", "body": "<p>In those rare instances when you get the error, does the script do anything at all to the document and then stops halfway, or does it fail to start altogether?</p>\n\n<p>One thing I can think of is that occasionally, when you execute the script, a document that is active is not the one you intend to apply changes to, hence the error. And later when you rerun in, the document somehow is made active. If your script fails to start, that\u2019s probably the reason. </p>\n\n<p>in reply to yor comment:\nWhen the error happens, how many documents did you have open at that time? Is the error replicable? In other words, if you run the script again (not step-by-step and without activating the target document) do you get the same error?\nI would start with something like:</p>\n\n<pre><code>Dim mydoc As Document \nSet mydoc = Application.Documents(\"mydocname.docx\")\n\nFor i = mydoc.InlineShapes.Count To 1 Step -1\n\n        mydoc.InlineShapes(i).Select\n        Selection.ClearFormatting\n        Selection.Style = mydoc.Styles(\"Normal\")\n        Selection.Range.InsertAfter Chr(13)\n\nNext i\n</code></pre>\n\n<p>In reply to your <em>too quick</em> comment:</p>\n\n<p>From what you've told me so far, I thing that one of the inline shapes in your document, when selected, doesn't support <em>ClearFormatting</em> method. Inline shapes come in different types (see <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221989%28v=office.11%29.aspx\" rel=\"nofollow\">this</a> for details, at the end they list all the types). So this is what happens: your script reformats inline shapes one-by-one till it stumbles on one that can't be CelarFormatted, that it stops and reports an error. When you continue in debug mode, you basically tell it to 'step over' the 'bad' object. All remaining inline shapes are fine and your script finishes the rest of the document. \nTo solve the problem you need to nail down that inline shape and see what's so spacial about it. Then you can add an <em>If - Then</em> condition to your script so it avoid such inline shapes. </p>\n"}], "owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451341504, "creation_date": 1450863558, "question_id": 34432577, "link": "https://stackoverflow.com/questions/34432577/vba-macro-error-5113", "title": "VBA Macro: Error 5113", "body": "<p>I'm having a trouble that randomly appears, once a week/2 weeks. It happens with this code:</p>\n\n<pre><code>Sub ImagenesToNormal()\n'Procedimiento para pasar las imagenes a estilo de texto normal\n    Dim i As Integer\n    For i = ActiveDocument.InlineShapes.Count To 1 Step -1\n\n        ActiveDocument.InlineShapes(i).Select\n        Selection.ClearFormatting\n        Selection.Style = ActiveDocument.Styles(\"Normal\")\n        Selection.Range.InsertAfter Chr(13)\n\n    Next i\nEnd Sub\n</code></pre>\n\n<p>For example, the last time, document had 39 pictures(this was an OCR Abbyy-ed document). If I execute this, error appears, but memory isn't even at half of 4gb total(including OS and more crap running). Even CPU is only at 42%, but I get this error. If I run it step by step, error doesn't happen. And even if I reboot, problem wont happen anymore.</p>\n\n<p>I've searched around the web and I don't find any solution/cause.  </p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1486697, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cf2fea9886063d5dffe806e5f7c78af9?s=128&d=identicon&r=PG", "display_name": "Iuli", "link": "https://stackoverflow.com/users/1486697/iuli"}, "edited": false, "score": 0, "creation_date": 1452071482, "post_id": 34433851, "comment_id": 57003886, "body": "One question, please. The code is working but why does this code copy all the graphs from the slides and put its in one slide which I pressed click? thanks!"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 133, "user_id": 1486697, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cf2fea9886063d5dffe806e5f7c78af9?s=128&d=identicon&r=PG", "display_name": "Iuli", "link": "https://stackoverflow.com/users/1486697/iuli"}, "edited": false, "score": 0, "creation_date": 1452101224, "post_id": 34433851, "comment_id": 57023444, "body": "I&#39;m not sure I understand luli. The code shouldn&#39;t be copying anything. It just loops through all shapes of all slides and tries to ungroup any that are of type &quot;picture&quot;. How are you calling the sub?"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 2, "last_activity_date": 1450867380, "creation_date": 1450867380, "answer_id": 34433851, "question_id": 34432550, "link": "https://stackoverflow.com/questions/34432550/any-vba-code-to-align-the-picture-from-powerpoint/34433851#34433851", "title": "Any VBA code to align the picture from PowerPoint?", "body": "<p>Microsoft stores complex vector objects in WMF or EMF formats and in order to edit them one needs to convert them to native MSO drawing objects (vectors). The process to do this is to ungroup them and this code will do it for your entire presentation:</p>\n\n<pre><code>Option Explicit\n\n' ===================================================================\n' Purpose : Loop through each shape of each slide in a presentation\n'           and ungroup and WMF files, thereby converting them to\n'           MSO drawing objects that can be edited.\n' Author  : Jamie at YOUpresent Ltd. http://youpresent.co.uk/\n' ===================================================================\nSub ConvertAllMetafilePicturestoGroups()\n  Dim oSld As Slide\n  Dim oShp As Shape\n  For Each oSld In ActivePresentation.Slides\n    For Each oShp In oSld.Shapes\n      On Error Resume Next ' In case picture is a bitmap and not a WMF vector\n      If oShp.Type = msoPicture Then oShp.Ungroup\n      On Error GoTo 0\n    Next\n  Next\n  ' Clean up\n  Set oShp = Nothing: Set oSld = Nothing\nEnd Sub\n</code></pre>\n\n<p>You can ungroup a second time if you want/need to.</p>\n"}], "owner": {"reputation": 133, "user_id": 1486697, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cf2fea9886063d5dffe806e5f7c78af9?s=128&d=identicon&r=PG", "display_name": "Iuli", "link": "https://stackoverflow.com/users/1486697/iuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "accepted_answer_id": 34433851, "answer_count": 1, "score": 1, "last_activity_date": 1450867380, "creation_date": 1450863474, "question_id": 34432550, "link": "https://stackoverflow.com/questions/34432550/any-vba-code-to-align-the-picture-from-powerpoint", "title": "Any VBA code to align the picture from PowerPoint?", "body": "<p>I have a PowerPoint document with 239 slides. I have to align the picture from every slide making the following two steps: </p>\n\n<p><strong>1.</strong> Right click and select <em>Edit Picture</em></p>\n\n<p><strong>2.</strong> Then Press <em>YES</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/5cQgV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5cQgV.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/9AFMM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9AFMM.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>My question:</strong> Is there any macro (vba code) to do all this job automatically?\nThanks! </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1409, "user_id": 3848720, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aOWBm.png?s=128&g=1", "display_name": "tdsymonds", "link": "https://stackoverflow.com/users/3848720/tdsymonds"}, "is_accepted": false, "score": 0, "last_activity_date": 1450882474, "creation_date": 1450882474, "answer_id": 34438286, "question_id": 34431756, "link": "https://stackoverflow.com/questions/34431756/combine-data-of-multiple-rows-from-multiple-tables-in-single-row-and-show-multip/34438286#34438286", "title": "combine data of multiple rows from multiple tables in single row and show multiple rows of data based on input", "body": "<p>I'm a little unclear about some of your question, but perhaps you could adapt this solution to work for you?</p>\n\n<p><a href=\"http://thinketg.com/how-to-return-multiple-match-values-in-excel-using-index-match-or-vlookup/\" rel=\"nofollow\">http://thinketg.com/how-to-return-multiple-match-values-in-excel-using-index-match-or-vlookup/</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "is_accepted": false, "score": 0, "last_activity_date": 1451410721, "creation_date": 1451410721, "answer_id": 34516094, "question_id": 34431756, "link": "https://stackoverflow.com/questions/34431756/combine-data-of-multiple-rows-from-multiple-tables-in-single-row-and-show-multip/34516094#34516094", "title": "combine data of multiple rows from multiple tables in single row and show multiple rows of data based on input", "body": "<p>I think this is what you want.  </p>\n\n<p>ColA ColB\na   1\nb   2\nc   3\na   4\nb   5\nc   6\na   7\nb   8\n    9\n    10\n    11\n    7\n    8\n    9\n    9\n    16\n    17\n    18\n    19\n    20</p>\n\n<p>In Cell E1, enter c (this is the value you are looking up).<br>\nIn Cell F1, enter the function below and hit Ctrl+Shift+Enter.</p>\n\n<p>=IF(ROWS(B$1:B1)&lt;=COUNTIF($A$1:$A$20,$E$1),INDEX($B$1:$B$20,SMALL(IF($A$1:$A$20=$E$1,ROW($A$1:$A$20)-ROW($E$1)+1),ROWS(B$1:B1))),\"\")</p>\n"}], "owner": {"reputation": 11, "user_id": 5709927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e22464de5ea25261975d480c049158e?s=128&d=identicon&r=PG&f=1", "display_name": "Floris Janssen", "link": "https://stackoverflow.com/users/5709927/floris-janssen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451410721, "creation_date": 1450860495, "last_edit_date": 1450862676, "question_id": 34431756, "link": "https://stackoverflow.com/questions/34431756/combine-data-of-multiple-rows-from-multiple-tables-in-single-row-and-show-multip", "title": "combine data of multiple rows from multiple tables in single row and show multiple rows of data based on input", "body": "<p>I have a problem regarding making a data table that incorporates data of two other data tables, depending on what the input is in the input sheet.</p>\n\n<p>These are my sheets:</p>\n\n<ol>\n<li><p>sheet 1) <a href=\"http://i.stack.imgur.com/o5QAT.png\" rel=\"nofollow\">Data table 1</a></p></li>\n<li><p>sheet 2) <a href=\"http://i.stack.imgur.com/otEUK.png\" rel=\"nofollow\">Data table 2</a></p></li>\n<li><p>sheet 3) Input sheet:\nIn this sheet  one fills in the origin, destination, and month.</p></li>\n<li><p>sheet 4) Output sheet:</p>\n\n<ul>\n<li>Row(s) with characteristics that are a combination of the data in data table 1 and data table 2: 1 column for each characteristic in the row:\n(General; Month; Origin; feature 1; feature 2; month max; month min; Transit point; feature 1; feature 2; feature 3; month max; month min; Destination; feature 1; feature 2; month max; month min;) => feature 3 of origin and destination don't have to be incorporated in the output!</li>\n</ul></li>\n</ol>\n\n<p>Depending on the month, origin and destination filled in in the input sheet; the output has to list all the possible rows (routes) with that origin and that destination and the temperatures in that month at the origin, transit point and destination.</p>\n\n<p>I have tried <code>VLOOKUP(MATCH)</code>, but that only helps for 1 row. not if I want to list all possible rows..</p>\n\n<p>I don't think this problem is that difficult, but I am really a rookie in Excel. Maybe it could work with a simple macro..</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450860688, "post_id": 34431434, "comment_id": 56604495, "body": "I think your best bet would be to import the file names to an array, and then seperate the names on the &quot;_&quot; character. Then create an extra column in the array that concatenates the first and third column of the array. Here are now your filenames. Now you loop over the array and check if there is already a file of which the name is equal to the fourth column of the array. If not create it by copying the worksheet to a new book. If it is present copy the worksheet to the existing book."}, {"owner": {"reputation": 13, "user_id": 5496268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096abe7a2d31122d1baa99eade238fd8?s=128&d=identicon&r=PG&f=1", "display_name": "user52363", "link": "https://stackoverflow.com/users/5496268/user52363"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450862640, "post_id": 34431434, "comment_id": 56605545, "body": "Hello Luuklag, thanks for the reply. Do I import the name into a string? How do you go about separating the &quot;_&quot; though ?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450863419, "post_id": 34431434, "comment_id": 56606000, "body": "Have a look at the Split function: <a href=\"http://www.exceltrick.com/formulas_macros/vba-split-function/\" rel=\"nofollow noreferrer\">exceltrick.com/formulas_macros/vba-split-function</a>"}], "owner": {"reputation": 13, "user_id": 5496268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096abe7a2d31122d1baa99eade238fd8?s=128&d=identicon&r=PG&f=1", "display_name": "user52363", "link": "https://stackoverflow.com/users/5496268/user52363"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455380237, "creation_date": 1450859087, "last_edit_date": 1455380237, "question_id": 34431434, "link": "https://stackoverflow.com/questions/34431434/merging-workbooks-in-a-folder-into-a-central-workbook-based-on-name-and-date-of", "title": "Merging workbooks in a folder into a central workbook based on name and date of file", "body": "<p>I have multiple files, always with one sheet, in a folder. I need to merge these separate files into a central workbook with multiple sheets, called the same as original workbook, based on the name and date of the original files.</p>\n\n<p>For example, in a folder I may have the following files:</p>\n\n<pre><code>Fund1809_Equity_20140917\nFund1809_FI_20140917\nFund1809_Unlisted_20140917\nFund1809_Equity_20141221\nFund1809_FI_20141221\nFund780_Equity_20140917\nFund68092_Equity_20140917\n</code></pre>\n\n<p>I need to place all files with the same fund name and date into a workbook. Therefore, the expected result should be 4 workbooks:</p>\n\n<ol>\n<li><p>Fund1089_20140917 with \"Equity\", \"FI\" and \"Unlisted\" tabs</p></li>\n<li><p>Fund1089_20141221 with \"Equity\" and \"FI\" tabs</p></li>\n<li><p>Fund780_20140917 with \"Equity\" tab</p></li>\n<li>Fund68092_20140917 with \"Equity\" tab</li>\n</ol>\n\n<p>I have code that sorts based on the first 4 characters of the fund name. Thus, I'm running into problems as the length of the fund code is not fixed to 4 and it also does not sort according to date. Here is my code:</p>\n\n<pre><code>Sub test()\nConst TO_DELETE_SHEET_NAME As String = \"toBeDeleted\"\n'------------------------------------------------------------------\nDim settingSheetsNumber As Integer\nDim settingDisplayAlerts As Boolean\nDim dict As Object\nDim wkbSource As Excel.Workbook\nDim wks As Excel.Worksheet\nDim filepath As String\nDim code As String * 4\nDim wkbDestination As Excel.Workbook\nDim varKey As Variant\nDim sourceFolder As String\nDim destinationFolder As String\n'------------------------------------------------------------------\n\n'Change [SheetsInNewWorkbook] setting of Excel.Application object to\n'create new workbooks with a single sheet only.\nWith Excel.Application\n    settingDisplayAlerts = .DisplayAlerts\n    settingSheetsNumber = .SheetsInNewWorkbook\n    .SheetsInNewWorkbook = 1\n    .DisplayAlerts = False\n    .ScreenUpdating = False\nEnd With\n\nSet dict = VBA.CreateObject(\"Scripting.Dictionary\")\n\nsourceFolder = \"C:\\Users\\ThomasK\\Desktop\\Test\\\"\ndestinationFolder = \"C:\\Users\\ThomasK\\Desktop\\\"\nfilepath = Dir(sourceFolder)\n\n'Loop through each Excel file in folder\nDo While filepath &lt;&gt; \"\"\n\n    If VBA.Right$(filepath, 5) = \".xlsx\" Then\n\n        Set wkbSource = Excel.Workbooks.Open(sourceFolder &amp; filepath)\n        Set wks = wkbSource.Worksheets(1)\n        code = VBA.Left$(wkbSource.Name, 4)\n\n        'If this code doesn't exist in the dictionary yet, add it.\n        If Not dict.exists(code) Then\n            Set wkbDestination = Excel.Workbooks.Add\n            wkbDestination.Worksheets(1).Name = TO_DELETE_SHEET_NAME\n            Call dict.Add(code, wkbDestination)\n        Else\n            Set wkbDestination = dict.Item(code)\n        End If\n\n        Call wks.Copy(Before:=wkbDestination.Worksheets(1))\n        wkbDestination.Worksheets(1).Name = VBA.Mid$(filepath, 6)\n\n        Call wkbSource.Close(False)\n\n    End If\n\n    filepath = Dir\n\nLoop\n\n'Save newly created files.\nFor Each varKey In dict.keys\n    Set wkbDestination = dict.Item(varKey)\n\n    'Remove empty sheet.\n    Set wks = Nothing\n    On Error Resume Next\n    Set wks = wkbDestination.Worksheets(TO_DELETE_SHEET_NAME)\n    On Error GoTo 0\n\n    If Not wks Is Nothing Then wks.Delete\n\n    Call wkbDestination.SaveAs(Filename:=destinationFolder &amp; varKey &amp; \".xlsx\")\n\n    Call wkbDestination.Close(True)\n\nNext varKey\n\n'Restore Excel.Application settings.\nWith Excel.Application\n    .DisplayAlerts = settingDisplayAlerts\n    .SheetsInNewWorkbook = settingSheetsNumber\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Is regex needed to identify the fund name?</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450858654, "post_id": 34430695, "comment_id": 56603596, "body": "it is not clear what you want... having range and amount variable, there is nothing to search for... if you are searching for the smallest range which fits to 70% of the values that would be different..."}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "edited": false, "score": 0, "creation_date": 1450859120, "post_id": 34430695, "comment_id": 56603784, "body": "i dont understand yr question. are you looking for normal distribution of the data ?"}, {"owner": {"reputation": 7, "user_id": 5044521, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ljz-rCZzRIg/AAAAAAAAAAI/AAAAAAAAAJE/2QgazlsLGB4/photo.jpg?sz=128", "display_name": "Mehul Patel", "link": "https://stackoverflow.com/users/5044521/mehul-patel"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450859200, "post_id": 34430695, "comment_id": 56603815, "body": "@Dirk - yeah it will be helpful if you can provide solution for smallest range which fits to 70% of the values."}, {"owner": {"reputation": 7, "user_id": 5044521, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ljz-rCZzRIg/AAAAAAAAAAI/AAAAAAAAAJE/2QgazlsLGB4/photo.jpg?sz=128", "display_name": "Mehul Patel", "link": "https://stackoverflow.com/users/5044521/mehul-patel"}, "edited": false, "score": 0, "creation_date": 1450859351, "post_id": 34430695, "comment_id": 56603885, "body": "@Erik - no, not normal distribution just looking for the two values where most of the data is concentrated like between 2018.5 to 2020.5 in my data set."}, {"owner": {"reputation": 7, "user_id": 5044521, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ljz-rCZzRIg/AAAAAAAAAAI/AAAAAAAAAJE/2QgazlsLGB4/photo.jpg?sz=128", "display_name": "Mehul Patel", "link": "https://stackoverflow.com/users/5044521/mehul-patel"}, "edited": false, "score": 0, "creation_date": 1450859900, "post_id": 34430695, "comment_id": 56604118, "body": "may be data with the highest occurrence, I can use MODE function but there are some problems with it like it will treat 2020.00 &amp; 2020.05 differently but actually there is a very little percentage difference between them that&#39;s why it may mislead."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5044521, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ljz-rCZzRIg/AAAAAAAAAAI/AAAAAAAAAJE/2QgazlsLGB4/photo.jpg?sz=128", "display_name": "Mehul Patel", "link": "https://stackoverflow.com/users/5044521/mehul-patel"}, "edited": false, "score": 0, "creation_date": 1450965355, "post_id": 34432348, "comment_id": 56649149, "body": "thanks a lot mate for sharing this code. It is amazing. Solves 90% of my problem."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 7, "user_id": 5044521, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ljz-rCZzRIg/AAAAAAAAAAI/AAAAAAAAAJE/2QgazlsLGB4/photo.jpg?sz=128", "display_name": "Mehul Patel", "link": "https://stackoverflow.com/users/5044521/mehul-patel"}, "edited": false, "score": 0, "creation_date": 1451110449, "post_id": 34432348, "comment_id": 56679789, "body": "@MehulPatel what are the missing 10%?"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1451128267, "last_edit_date": 1451128267, "creation_date": 1450862805, "answer_id": 34432348, "question_id": 34430695, "link": "https://stackoverflow.com/questions/34430695/in-excel-how-to-calculate-range-with-maximum-numbers-falling-inside-it/34432348#34432348", "title": "In excel, how to calculate range with maximum numbers falling inside it?", "body": "<p><strike>What you desire isn't possible with the worksheet functions as they are. you would need to create a table (having one dimension as lower cut and one dimension with upper cut to delete the lowest/highest till you got your range... but you would need to do so every time the size changes (and the formulas would be.... don't think about it...</strike> (still assuming you need the whole range)</p>\n\n<p>You can do it by formula: (all Values in A:A)</p>\n\n<pre><code>C1:  0.7 (at least x % values need to be included / 1 = 100%)\nC2:  =MAX(IF(MIN(SMALL(A:A,ROUNDUP(COUNTIF(A:A,\"&lt;&gt;\")*C1,0)+ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))-1)-SMALL(A:A,ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))))=(SMALL(A:A,ROUNDUP(COUNTIF(A:A,\"&lt;&gt;\")*C1,0)+ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))-1)-SMALL(A:A,ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1)))),SMALL(A:A,ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))),0))\nC3:  =MAX(IF(MIN(SMALL(A:A,ROUNDUP(COUNTIF(A:A,\"&lt;&gt;\")*C1,0)+ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))-1)-SMALL(A:A,ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))))=(SMALL(A:A,ROUNDUP(COUNTIF(A:A,\"&lt;&gt;\")*C1,0)+ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))-1)-SMALL(A:A,ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1)))),SMALL(A:A,ROUNDUP(COUNTIF(A:A,\"&lt;&gt;\")*C1,0)+ROW(INDIRECT(\"1:\"&amp;ROUNDDOWN(COUNTIF(A:A,\"&lt;&gt;\")*(1-C1),0)+1))-1)))  \n</code></pre>\n\n<blockquote>\n  <p>Formulas in <code>C2/C3</code> are array formulas and must be confirmed with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd></p>\n</blockquote>\n\n<p><code>C2</code> will show the lower value and <code>C3</code> the upper one. You can get the number of values used with <code>=COUNTIF(A:A,\"&lt;&gt;\")</code> and the count of numbers in the calculation with <code>=ROUNDUP(COUNTIF(A:A,\"&lt;&gt;\")*C1,0)</code>.</p>\n\n<hr>\n\n<p>But there is still the way to do so with a UDF like this:<br>\nOpen up the VBA-window (hit <kbd>Alt</kbd>+<kbd>F11</kbd>). Then click at \"Insert\" and then \"Module\". Copy/paste the code below into your Module.</p>\n\n<pre><code>Option Explicit\n\nPublic Function getValRange(rng As Range, amountVal As Double) As String\n  Set rng = Intersect(rng, rng.Parent.UsedRange)\n\n  Dim cellsVal As Variant\n  Dim cellsCount As Long\n\n  For Each cellsVal In rng.Value\n    If IsNumeric(cellsVal) And Len(cellsVal) &gt; 0 Then cellsCount = cellsCount + 1\n  Next\n\n  Dim cellsNow As Long\n  cellsNow = cellsCount\n  cellsVal = rng.Value\n  amountVal = amountVal / 100\n\n  Dim AverageVal As Double\n  Dim maxVal As Double\n  Dim minVal As Double\n  Dim valToDel As Double\n\n  Dim x As Long, y As Long\n\n  While (cellsNow / cellsCount) &gt; amountVal\n\n    AverageVal = Application.WorksheetFunction.Average(cellsVal)\n    maxVal = Application.WorksheetFunction.Max(cellsVal)\n    minVal = Application.WorksheetFunction.Min(cellsVal)\n\n    If (maxVal - AverageVal) &gt; (AverageVal - minVal) Then\n      valToDel = maxVal\n    Else\n      valToDel = minVal\n    End If\n\n    For x = 1 To UBound(cellsVal)\n      For y = 1 To UBound(cellsVal, 2)\n\n        If cellsVal(x, y) = valToDel Then\n          cellsVal(x, y) = \"\"\n          Exit For\n        End If\n\n      Next y\n    Next x\n\n    cellsNow = cellsNow - 1\n  Wend\n\n  maxVal = Application.WorksheetFunction.Max(cellsVal)\n  minVal = Application.WorksheetFunction.Min(cellsVal)\n\n  getValRange = minVal &amp; \" - \" &amp; maxVal\n\nEnd Function\n</code></pre>\n\n<p>Then simply put in the cell something like this:</p>\n\n<pre><code>=getValRange(A1:A150,70)\n</code></pre>\n\n<p>to get the lowest and the highest values as string like <code>2018.2 - 2021</code>. (calculated for your numbers)</p>\n\n<p>It simply checks for the value having the highest difference to the average and then excludes it. Repeating this till the number of cells is less or equal to the set percentage. However, going for a percentage lower then 50% it may fail. For cases like this you would need something like \"brute force\" (which may have long calculation-times)</p>\n\n<hr>\n\n<p>To get the best solution for a set amount of values, you can use this:</p>\n\n<pre><code>Public Function getValRange(rng As Range, amountVal As Double) As String\n  If rng.Cells.Count &lt; 2 Or amountVal &lt;= 0 Or amountVal &gt;= 100 Then Exit Function\n\n  Set rng = Intersect(rng, rng.Parent.UsedRange)\n\n  Dim cellsVal As Variant\n  Dim allVal() As Variant\n  ReDim allVal(1 To rng.Cells.Count)\n  Dim i As Long\n\n  'get all values in in 1d-array\n  For Each cellsVal In rng.Value\n    If IsNumeric(cellsVal) And Len(cellsVal) &gt; 0 Then\n      i = i + 1\n      allVal(i) = cellsVal\n    End If\n  Next\n  ReDim Preserve allVal(1 To i)\n\n  'sort 1d-array\n  For i = 2 To UBound(allVal)\n    If allVal(i) &lt; allVal(i - 1) Then\n      cellsVal = allVal(i)\n      allVal(i) = allVal(i - 1)\n      allVal(i - 1) = cellsVal\n      i = 1\n    End If\n  Next\n\n  'get value count to be used\n  amountVal = Application.RoundUp((UBound(allVal) / 100) * amountVal, 0)\n\n  Dim clsrange(1) As Variant\n  'get the closest range\n  clsrange(0) = allVal(amountVal) - allVal(1)\n  clsrange(1) = allVal(1) &amp; \" - \" &amp; allVal(amountVal)\n  For i = 2 To UBound(allVal) - amountVal\n    If (allVal(amountVal + i - 1) - allVal(i)) &lt; clsrange(0) Then\n      clsrange(0) = allVal(amountVal + i - 1) - allVal(i)\n      clsrange(1) = allVal(i) &amp; \" - \" &amp; allVal(amountVal + i - 1)\n    End If\n  Next\n\n  getValRange = clsrange(1)\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>A completely different approach would be using the sort option. Lets assume the columns <code>B:E</code> are empty. Copy column <code>A</code> to <code>B</code> and then sort column <code>B</code>.<br>\nGet the amound of cells you want to check for (lets say 50 for now). In <code>C1</code> you put <code>=B50-B1</code> in <code>D1</code> <code>=B1</code> and in <code>D1</code> comes <code>=B50</code>. And then copy it down till it reaches the range with empty cells (having 150 cells, will end at <code>C101</code>, autofill simply <code>C1:E1</code> downs till column <code>E</code> starts to get empty). Now for column <code>C</code> use conditional formatting with the formula <code>=C1=MIN(C:C)</code>... then check for the formatted cell, it will tell you the smallest range having the min and max in column <code>D</code> and <code>E</code>.</p>\n"}], "owner": {"reputation": 7, "user_id": 5044521, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ljz-rCZzRIg/AAAAAAAAAAI/AAAAAAAAAJE/2QgazlsLGB4/photo.jpg?sz=128", "display_name": "Mehul Patel", "link": "https://stackoverflow.com/users/5044521/mehul-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451128267, "creation_date": 1450855700, "last_edit_date": 1531161705, "question_id": 34430695, "link": "https://stackoverflow.com/questions/34430695/in-excel-how-to-calculate-range-with-maximum-numbers-falling-inside-it", "title": "In excel, how to calculate range with maximum numbers falling inside it?", "body": "<p>I have this data set in excel column; I want to find where most of the data was clouded e.g. around 100 values of this set fell between 2018.5 to 2020.5 But it is manual work. What can be the formula for searching these value. I tried using Average &amp; Std. Deviation but they have some flaws &amp; not always accurate. And the range must be as narrow as possible, say if I have total number of values in the set equal to 150 then more than 60%-70% i.e 90-105 of these values should come under that determined range.</p>\n\n<pre><code>2025\n2023.75\n2023\n2020.15\n2020.3\n2018.35\n2017.5\n2017.95\n2016\n2019.45\n2020\n2022.4\n2022.25\n2018.2\n2018.05\n2019.3\n2022\n2021.45\n2021.45\n2019.8\n2020\n2019.25\n2019.35\n2019.85\n2019.4\n2018.25\n2019.55\n2020\n2020\n2020.05\n2020\n2020\n2021\n2019.8\n2019.8\n2020\n2020.05\n2019.9\n2021\n2019.1\n2019.1\n2015.5\n2015.5\n2018.5\n2017.25\n2018.85\n2018.85\n2018.85\n2017.05\n2019\n2020.05\n2020\n2020\n2020\n2019.7\n2019.65\n2019.65\n2020\n2019\n2018.05\n2020\n2019.4\n2020\n2020.05\n2017.4\n2020\n2020\n2020\n2019.95\n2019.95\n2019.95\n2018\n2019.85\n2019.85\n2019.7\n2020\n2020\n2020\n2020\n2020\n2019.75\n2019.6\n2019.75\n2019.75\n2019.95\n2019.95\n2019.95\n2020\n2020\n2020\n2020\n2019.35\n2019.35\n2019.95\n2019.95\n2020\n2019.95\n2020\n2020\n2020\n2021.7\n2020\n2021\n2020\n2020\n2020\n2020\n2019.95\n2020\n2019.85\n2019.8\n2019\n2019.8\n2019.8\n2019.8\n2020\n2019.9\n2019.9\n2020\n2020\n2019.8\n2019.3\n2019.85\n2020\n2019.1\n2018\n2017.5\n2015.05\n2009\n2008\n2011.5\n2011\n2011\n2014.65\n2011\n2010\n2009.05\n2005.65\n2005\n1998.1\n2000\n1999\n2001.7\n2000.95\n2002\n2005\n2006.7\n2004.4\n2004.85\n2006.8\n2007.45\n2006\n2010\n2012.5\n2012.2\n2008.8\n2007.4\n2007.55\n2005.35\n2005.4\n2006.9\n2008.05\n2003.85\n2002.6\n2004.85\n2002.35\n2006\n2006\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450860980, "post_id": 34430625, "comment_id": 56604658, "body": "Thanks @Tim Williams, I used to use, for example: <code>Range(ws.Cells(1,1),ws.Cells(10,10))</code> NOT <code>ws.Range(ws.Cells(1,1),ws.Cells(10,10))</code> , is that OK? . (ws is the worksheet)."}, {"owner": {"reputation": 3, "user_id": 5613050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2590007e0317531a00081abdb95c39?s=128&d=identicon&r=PG&f=1", "display_name": "Drew Phillips", "link": "https://stackoverflow.com/users/5613050/drew-phillips"}, "edited": false, "score": 0, "creation_date": 1450885523, "post_id": 34430625, "comment_id": 56619172, "body": "Thank you! Works perfectly now!!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1450890220, "post_id": 34430625, "comment_id": 56622105, "body": "@Fadi - that will work in a regular module, but would fail in a worksheet module for any worksheet other than <code>ws</code>, since the scope for an unqualified <code>Range()</code> in a worksheet module is always the worksheet itself."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450922150, "post_id": 34430625, "comment_id": 56634642, "body": "@TimWilliams, thank you, I learned new lesson from your comment, very helpful."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1450855741, "last_edit_date": 1450855741, "creation_date": 1450855391, "answer_id": 34430625, "question_id": 34430379, "link": "https://stackoverflow.com/questions/34430379/application-defined-or-object-defined-error-excel-vba-rangecells/34430625#34430625", "title": "application defined or object defined error - Excel VBA .range(cells", "body": "<p>Without a qualifying worksheet, your <code>Cells()</code> will refer to the Activesheet: if that isn't \"5\" then they don't match the <code>Range()</code> and that will trigger the error you're getting.</p>\n\n<p>Try:</p>\n\n<pre><code>With Workbooks(filenm17).Sheets(\"5\")\n    .Range(.Cells(67, CLng(findstring16) + 2), _\n           .Cells(440, CLng(findstring16) + 2)).Value = firstarray\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5613050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2590007e0317531a00081abdb95c39?s=128&d=identicon&r=PG&f=1", "display_name": "Drew Phillips", "link": "https://stackoverflow.com/users/5613050/drew-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 34430625, "answer_count": 1, "score": 0, "last_activity_date": 1450855741, "creation_date": 1450854384, "last_edit_date": 1531164843, "question_id": 34430379, "link": "https://stackoverflow.com/questions/34430379/application-defined-or-object-defined-error-excel-vba-rangecells", "title": "application defined or object defined error - Excel VBA .range(cells", "body": "<p>I have a line of code that is displaying the application defined or object defined error, I have no idea why. </p>\n\n<pre><code>filenm17 = \"DSR Consolidated\"\nfindstring16 = \"21\"\n</code></pre>\n\n<p>filenm17 and findstring16 are both defined as strings. I tried removing findstring16 and replacing it with the formula to get findstring16 (it's a cell reference .value) but that still didn't work.</p>\n\n<pre><code>Workbooks(filenm17).Sheets(\"5\").Range(Cells(67, findstring16 + 2), _\n                               Cells(440, findstring16 + 2)) = firstarray\n</code></pre>\n\n<p>Please help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 53258, "user_id": 52598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijK5b.png?s=128&g=1", "display_name": "Lieven Keersmaekers", "link": "https://stackoverflow.com/users/52598/lieven-keersmaekers"}, "edited": false, "score": 0, "creation_date": 1450852725, "post_id": 34429931, "comment_id": 56601036, "body": "Don&#39;t know vba well enough but if this is a one-time thing, you don&#39;t need vba for this?! Add a new column and paste all the values of your D column to it and replace the D column with a formula like <code>if(A1=&#39;TOOTBRUSH&#39;;&#39;BATTERY&#39;, E1)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450852968, "post_id": 34429931, "comment_id": 56601134, "body": "What&#39;s wrong with your existing code?  Are you getting an error?"}, {"owner": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1450853378, "post_id": 34429931, "comment_id": 56601286, "body": "williams :        its not making any changes in my original file but if i am copying certain data starting from toothbrush batt and pasting it in other sheet than there it is woking"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1450858583, "post_id": 34429931, "comment_id": 56603574, "body": "Please try to use informative titles for the benefit of future readers, and <i>really</i> do leave out &quot;urgent&quot; and other forms of begging - all questions are of equal importance here."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1450856286, "post_id": 34430008, "comment_id": 56602585, "body": "if used above code then it will find only 1 st value and make change and stop..i have many TOOTHBRUSH BATT VALUES"}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "reply_to_user": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1450857988, "post_id": 34430008, "comment_id": 56603336, "body": "in that case, you should try using auto filter. will be faster"}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "reply_to_user": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1450858036, "post_id": 34430008, "comment_id": 56603356, "body": "although above code can be loop by adding some looping logic, but is not a fast way to do it"}], "tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1450858482, "last_edit_date": 1450858482, "creation_date": 1450852793, "answer_id": 34430008, "question_id": 34429931, "link": "https://stackoverflow.com/questions/34429931/how-to-search-and-replace-using-vba-in-excel/34430008#34430008", "title": "How to search and replace using VBA in Excel?", "body": "<pre><code>nRow = Worksheets(1).Range(\"A:A\").Find(What:=\"*TOOTHBRUSH BATT*\", after:=Range(\"A1\"), LookIn:=xlFormulas, LookAt _\n        :=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Row\n\nWorksheets(1).Cells(nRow,\"D\") = \"BATTERY\"\n</code></pre>\n\n<p>By using auto filter (below code not tested)</p>\n\n<pre><code>Worksheets(1).autofiltermode = false\nWorksheets(1).Range(\"A:B\").autofilter\nWorksheets(1).AutoFilter.Range.AutoFilter Field:=1, Criteria1:=\"*TOOTHBRUSH BATT*\"\n\ndim nRng as range\n\nIf Worksheets(1).AutoFilter.Range.Offset(1,0).Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n     set nRng  = Worksheets(1).AutoFilter.Range.Offset(1,0).Columns(2).Resize(Worksheets(1).AutoFilter.Range.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible)\n     nRng.value = \"BATTERY\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": 0, "last_activity_date": 1450867002, "creation_date": 1450867002, "answer_id": 34433739, "question_id": 34429931, "link": "https://stackoverflow.com/questions/34429931/how-to-search-and-replace-using-vba-in-excel/34433739#34433739", "title": "How to search and replace using VBA in Excel?", "body": "<p>This is Similar to Eric's Answer.</p>\n\n<pre><code>' Declare range  to set to the first cell we find\nDim find as Range\nset find = Range(\"A:A\").Cells.Find(What:=\"TOOTHBRUSH BATT\")\n\n' This is the cell Address (in case it keeps looping back to beginning)\nDim addy as string\nif not find is nothing then addy = find.address\n\n' If we've found a cell then Keep Do something with it\nDo while not find is nothing\n    find.Value = \"BATTERY\"\n\n\n    ' Find the next Cell\n    set find = Range(\"A:A\").Cells.Find(What:=\"TOOTHBRUSH BATT\", After:= find)\n    ' If the next found cell is the first one then exit sub/function\n    if find.address = addy then exit sub\nLoop\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1478, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1450867002, "creation_date": 1450852451, "last_edit_date": 1531161705, "question_id": 34429931, "link": "https://stackoverflow.com/questions/34429931/how-to-search-and-replace-using-vba-in-excel", "title": "How to search and replace using VBA in Excel?", "body": "<p>I am new to VBA Excel programming. Consider an Excel sheet with nxn values. My task is to search for text called \"TOOTHBRUSH BATT\" from A column. A column consists of multiple \"TOOTHBRUSH \" value.</p>\n\n<p>Once the value is found suppose in cell A11 then I need to change text in D11 ie corresponding D column to \"BATTERY\". D11 will already have some text, I need to replace that text with \"BATTERY\"</p>\n\n<p>My code is</p>\n\n<pre><code>Sub replacement()\n\n    Dim S  As String\n    Dim H  As String\n\n    S = \"TOOTHBRUSH BATT\"\n\n    For i = 1 To Range(\"A1\").End(xlDown).Row\n        If Range(\"A\" &amp; i) = S Then\n            Range(\"D\" &amp; i) = \"BATTERY\"\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "cursor-position"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450852963, "post_id": 34429924, "comment_id": 56601130, "body": "the pos comes from the &quot;first&quot; screen (top left corner)... if the second is over or left from it you will get negative numbers..."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450854666, "post_id": 34429924, "comment_id": 56601869, "body": "but to get the resolution you need something like <code>Declare PtrSafe Function GetSystemMetrics Lib &quot;User32&quot; (ByVal nIndex As Long) As Long</code> and then get with <code>GetSystemMetrics(0)</code>  and <code>GetSystemMetrics(1)</code> the size of the first monitor while having <code>GetSystemMetrics(78)</code> and <code>GetSystemMetrics(79)</code> holding the sum of both (if they are left/right you get the sum of x and the higher y)"}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450900679, "post_id": 34429924, "comment_id": 56627325, "body": "@DirkReichel thanks for the GetSystemMetrics(78) and (79)! That may be what I need. I don&#39;t suppose you know how to figure out the monitor setup through VBA do you (primary on left/right or top/bottom)?."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450901200, "post_id": 34429924, "comment_id": 56627548, "body": "there lots of guides always refering to the same VB script which I am not able to make it work (all I ever reached was crashing excel)... 78/79 just gives the max ranges (while 0/1 gets you to the primary)... youd need to calculate to get the pos and size of the second screen... but that&#39;s more like guessing :/ maybe you are able to adopt <a href=\"http://www.developerfusion.com/thread/49351/vb-dual-screen/\" rel=\"nofollow noreferrer\">THIS</a> to VBA (as said, I wasn&#39;t able to)"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1468732325, "creation_date": 1468732325, "answer_id": 38418106, "question_id": 34429924, "link": "https://stackoverflow.com/questions/34429924/get-screen-size-similar-to-cursorpos-excel-vba/38418106#38418106", "title": "Get screen size similar to CursorPos (Excel VBA)", "body": "<p>You can access WMI through VBA and for getting system configuration data then, personally, I think that this is less esoteric and less unstable than coding against the Win32 APIs. WMI classes are better documented in MSDN and once you learn the technique to talk to one class, you can access the whole range of system information that is exposed.</p>\n\n<p>Here's an example of the querying the <a href=\"https://msdn.microsoft.com/en-us/library/aa394122(v=vs.85).aspx\" rel=\"nofollow\">Win32_DesktopMonitor</a> class:</p>\n\n<pre><code>Option Explicit\n\nSub GetMonitorInfo()\n\n    'WMI query\n    Dim objWmiInterface As Object\n    Dim objWmiQuery As Object\n    Dim objWmiQueryItem As Object\n    Dim strWQL As String\n    'outputs\n    Dim strDeviceId As String\n    Dim strScreenName As String\n    Dim varScreenHeight As Variant\n    Dim varScreenWidth As Variant\n\n    'run query\n    strWQL = \"Select * From Win32_DesktopMonitor\"\n    Set objWmiInterface = GetObject(\"winmgmts:root/CIMV2\")\n    Set objWmiQuery = objWmiInterface.ExecQuery(strWQL)\n    'iterate output\n    For Each objWmiQueryItem In objWmiQuery\n        strDeviceId = objWmiQueryItem.DeviceId\n        strScreenName = objWmiQueryItem.Name\n        varScreenHeight = objWmiQueryItem.ScreenHeight\n        varScreenWidth = objWmiQueryItem.ScreenWidth\n        Debug.Print strDeviceId\n        Debug.Print strScreenName\n        Debug.Print varScreenHeight\n        Debug.Print varScreenWidth\n        Debug.Print \"\"\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>In my case, I have a laptop with dual monitors attached. The laptop lid is closed so I guess that is why <code>ScreenHeight</code> and <code>ScreenWidth</code> are <code>Null</code> for the first item:</p>\n\n<pre><code>DesktopMonitor1\nDefault Monitor\nNull\nNull\n\nDesktopMonitor2\nDefault Monitor\n 1080 \n 1920 \n\nDesktopMonitor3\nGeneric PnP Monitor\n 1080 \n 1920 \n</code></pre>\n"}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1163, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468732325, "creation_date": 1450852395, "last_edit_date": 1531164843, "question_id": 34429924, "link": "https://stackoverflow.com/questions/34429924/get-screen-size-similar-to-cursorpos-excel-vba", "title": "Get screen size similar to CursorPos (Excel VBA)", "body": "<p>Using the User32 Lib and the functions:</p>\n\n<pre><code>Public Declare Function GetCursorPos Lib \"User32\" (lpPoint As POINTAPI) As Long\nPublic Type POINTAPI\nx As Long\ny As Long\nEnd Type\nPublic pos As POINTAPI\n</code></pre>\n\n<p>You can see the pixel location of the cursor with:</p>\n\n<pre><code>GetCursorPos pos\nDebug.Print(\"X: \" &amp; pos.x &amp; \" Y: \" &amp; pos.y)\n</code></pre>\n\n<p>My question is, is it possible to see the screen size using the same method as the GetCursorPos? My reason being that dual monitors can cause that function to return negative values. For example, one setup may be this between two monitors on the left/right:</p>\n\n<pre><code>'Not sure if true or not\nMinX: -1920\nMaxX: 1920\nMinY: -1080\nMaxY: 1080\n</code></pre>\n\n<p>I'm basically asking how to use something similar to GetCursorPos, but to retrieve the borders of the screens.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1450851315, "post_id": 34429495, "comment_id": 56600431, "body": "<code>strPath = enviro &amp; &quot;C:\\Desktop\\Project\\SR History File.xlsx&quot;</code> should be <code>strPath = enviro &amp; &quot;\\Desktop\\Project\\SR History File.xlsx&quot;</code> - are you getting any errors?"}, {"owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1450854016, "post_id": 34429495, "comment_id": 56601572, "body": "Thanks for the reply. I still cant see the macro when I press F5. Is this because of any setting or is it because of the code?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1450855493, "post_id": 34429495, "comment_id": 56602227, "body": "its the code - to see it, change <code>Sub CopyToExcel(olItem As Outlook.MailItem)</code> to <code>Sub CopyToExcel()</code> and add the following to <code>Dim olItem As Outlook.MailItem</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1450874403, "creation_date": 1450874403, "answer_id": 34435936, "question_id": 34429495, "link": "https://stackoverflow.com/questions/34429495/macro-doesnt-show-in-list/34435936#34435936", "title": "Macro doesn&#39;t show in list", "body": "<p>The code cannot run without a parameter, olItem. </p>\n\n<p>Open a mailitem then run this, which will be in the list.</p>\n\n<pre><code>Option Explicit\n\nSub CopyToExcel_Test\n    Dim currItem as mailitem\n    Set currItem = ActiveInspector.currentitem\n\n    CopyToExcel currItem\n\nExitRoutine:\n    Set currItem = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1592870573, "creation_date": 1450850170, "last_edit_date": 1592870573, "question_id": 34429495, "link": "https://stackoverflow.com/questions/34429495/macro-doesnt-show-in-list", "title": "Macro doesn&#39;t show in list", "body": "<p>I want to export messages to Excel. However, when I try running the macro, I don't see it in the list.</p>\n\n<p>I just copied the code below from <a href=\"http://www.slipstick.com/developer/vba-copy-outlook-email-excel-workbook\" rel=\"nofollow noreferrer\">http://www.slipstick.com/developer/vba-copy-outlook-email-excel-workbook</a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nConst xlUp As Long = -4162\n\nSub CopyToExcel(olItem As Outlook.MailItem)\n   Dim xlApp As Object\n   Dim xlWB As Object\n   Dim xlSheet As Object\n   Dim rCount As Long\n   Dim bXStarted As Boolean\n   Dim strPath As String\n\n   Dim M1 As Object\n   Dim M As Object\n   Dim lgLastRow As Long 'specify the last data row\n\n   lgLastRow = Range(\"A1048576\").End(xlUp).Row 'Take Note: very useful!!\n\n   enviro = CStr(Environ(\"username\"))\n\n   'the path of the workbook\n   strPath = enviro &amp; \"C:\\Desktop\\Project\\SR History File.xlsx\"\n   On Error Resume Next\n   Set xlApp = GetObject(, \"Excel.Application\")\n   If Err &lt;&gt; 0 Then\n       Application.StatusBar = \"Please wait while Excel source is opened ... \"\n       Set xlApp = CreateObject(\"Excel.Application\")\n       bXStarted = True\n   End If\n   On Error GoTo 0\n\n   'Open the workbook to input the data\n   Set xlWB = xlApp.Workbooks.Open(strPath)\n   Set xlSheet = xlWB.Sheets(\"Sheet1\")\n\n   'Find the next empty line of the worksheet\n    rCount = lgLastRow = Range(\"A1048576\").End(xlUp).Row + 1\n\n   xlSheet.Range(\"A\" &amp; rCount) = olItem.SentOn\n   xlSheet.Range(\"B\" &amp; rCount) = olItem.SenderEmailAddress\n   xlSheet.Range(\"C\" &amp; rCount) = olItem.Subject\n\n   xlWB.Close 1\n   If bXStarted Then\n       xlApp.Quit\n   End If\n   Set M = Nothing\n   Set M1 = Nothing\n   Set Reg1 = Nothing\n   Set xlApp = Nothing\n   Set xlWB = Nothing\n   Set xlSheet = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "save"], "comments": [{"owner": {"reputation": 4137, "user_id": 2774914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/RjqK5.jpg?s=128&g=1", "display_name": "diziaq", "link": "https://stackoverflow.com/users/2774914/diziaq"}, "edited": false, "score": 1, "creation_date": 1450847994, "post_id": 34429078, "comment_id": 56599243, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/15886130/save-a-worksheet-with-form-save-as-location-in-excel-vba\">Save a worksheet with form Save As location in Excel VBA</a>"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1450849936, "post_id": 34429078, "comment_id": 56599893, "body": "Having a path ending with <code>...\\ </code> there is no need for <code>...th1 &amp; &quot;\\&quot; &amp; File...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450852726, "post_id": 34429586, "comment_id": 56601037, "body": "Run-time error &#39;1004&#39;:  Microsoft Excel cannot access the file &#39;C:\\Main Folder\\Folder A\\Filename1.xls. There are several possible reasons:  The file name or path does not exist. The file is being used by another program. The workbook you are trying to save has the same name as a currently open workbook."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450852816, "post_id": 34429586, "comment_id": 56601070, "body": "does the folder exist? is the file being used by another user/process?"}, {"owner": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450853120, "post_id": 34429586, "comment_id": 56601181, "body": "Yes, all folders already exist and prepared... that&#39;w why I&#39;m getting confused with it that I still get the error message, but if I use Thisworkbook.path instead if Filepath1, I get Sheet1 saved... but error on sheet 2"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450853190, "post_id": 34429586, "comment_id": 56601209, "body": "i didnt got any errors... will run some tests again... just a sec"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450853602, "post_id": 34429586, "comment_id": 56601398, "body": "there may be the normal behavior of not working in certain path... pls try the code in the edit and then go to your profile &quot;C:\\Users\\&#91;profilename]\\Main Folder\\ &quot;"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1450853620, "last_edit_date": 1450853620, "creation_date": 1450850764, "answer_id": 34429586, "question_id": 34429078, "link": "https://stackoverflow.com/questions/34429078/how-can-i-save-worksheet-a-to-folder-a-and-worksheet-b-to-folder-b/34429586#34429586", "title": "How can I save Worksheet A to folder A and worksheet B to folder B?", "body": "<p>your code works fine for me this way</p>\n\n<pre><code>FilePath1 = \"C:\\Main Folder\\Folder A\\\"\nFilePath2 = \"C:\\Main Folder\\Folder B\\\"\n\nSheets(\"Sheet1\").Copy\nFilename = ControlNumber.Value\nActiveWorkbook.SaveAs FilePath1 &amp; Filename &amp; \".xls\"\nActiveWorkbook.Close savechanges:=False\n\nSheets(\"Sheet2\").Copy\nFilename = ControlNumber.Value\nActiveWorkbook.SaveCopyAs FilePath2 &amp; Filename &amp; \".xls\"\nActiveWorkbook.Close savechanges:=False\n</code></pre>\n\n<p>what errors do you get?</p>\n\n<p>for testing i set:</p>\n\n<pre><code>Dim ControlNumber As Range\nSet ControlNumber = Sheet1.Cells(1, 1)\nDim FilePath1 As String, FilePath2 As String, Filename As String\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>On Error Resume Next\nMkDir Environ(\"USERPROFILE\") &amp; \"\\Main Folder\"\nMkDir Environ(\"USERPROFILE\") &amp; \"\\Main Folder\\Folder A\\\"\nMkDir Environ(\"USERPROFILE\") &amp; \"\\Main Folder\\Folder B\\\"\nOn Error GoTo 0\n\nFilePath1 = Environ(\"USERPROFILE\") &amp; \"\\Main Folder\\Folder A\\\"\nFilePath2 = Environ(\"USERPROFILE\") &amp; \"\\Main Folder\\Folder B\\\"\n\nSheets(\"Sheet1\").Copy\nFilename = ControlNumber.Value\nActiveWorkbook.SaveAs FilePath1 &amp; Filename &amp; \".xls\"\nActiveWorkbook.Close savechanges:=False\n\nSheets(\"Sheet2\").Copy\nFilename = ControlNumber.Value\nActiveWorkbook.SaveCopyAs FilePath2 &amp; Filename &amp; \".xls\"\nActiveWorkbook.Close savechanges:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450851415, "post_id": 34429587, "comment_id": 56600468, "body": "oh uh... like my comment? :D"}, {"owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450851889, "post_id": 34429587, "comment_id": 56600673, "body": "absolutely didn&#39;t saw your comment or else would have just liked it."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450851952, "post_id": 34429587, "comment_id": 56600702, "body": "everything is fine ^^"}, {"owner": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450852390, "post_id": 34429587, "comment_id": 56600882, "body": "Run-time error &#39;1004&#39;:  Microsoft Excel cannot access the file &#39;C:\\Main Folder\\Folder A\\Filename1.xls. There are several possible reasons:  The file name or path does not exist. The file is being used by another program. The workbook you are trying to save has the same name as a currently open workbook."}, {"owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "edited": false, "score": 0, "creation_date": 1450852791, "post_id": 34429587, "comment_id": 56601058, "body": "check whether the file with the same name already exist in the specified location."}, {"owner": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "edited": false, "score": 0, "creation_date": 1450853171, "post_id": 34429587, "comment_id": 56601202, "body": "Folder A and Folder B are both empty."}, {"owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "edited": false, "score": 0, "creation_date": 1450854250, "post_id": 34429587, "comment_id": 56601680, "body": "is there a file named Filename1 already opened. if yes then kindly close that excel file and rerun the macro"}], "tags": [], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "is_accepted": false, "score": 0, "last_activity_date": 1450850765, "creation_date": 1450850765, "answer_id": 34429587, "question_id": 34429078, "link": "https://stackoverflow.com/questions/34429078/how-can-i-save-worksheet-a-to-folder-a-and-worksheet-b-to-folder-b/34429587#34429587", "title": "How can I save Worksheet A to folder A and worksheet B to folder B?", "body": "<p>You have included path seperator twice i.e in Filepath as well as while saving the file. remove \"/\" from Filename or while saving</p>\n\n<pre><code>FilePath1 = \"C:\\Main Folder\\Folder A\\\"\n ActiveWorkbook.SaveCopyAs FilePath1 &amp; \"\\\" &amp; Filename &amp; \".xls\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5709754, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153791013114133/picture?type=large", "display_name": "Edd Tuazon", "link": "https://stackoverflow.com/users/5709754/edd-tuazon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1450854537, "creation_date": 1450847845, "last_edit_date": 1450850640, "question_id": 34429078, "link": "https://stackoverflow.com/questions/34429078/how-can-i-save-worksheet-a-to-folder-a-and-worksheet-b-to-folder-b", "title": "How can I save Worksheet A to folder A and worksheet B to folder B?", "body": "<p>How can I save Sheet1 to Folder A and Sheet2 to Folder B in VBA Excel?<br>\nIn my workbook I have 4 worksheets C back end and worksheet D is the interface. </p>\n\n<p>Folder path are:</p>\n\n<ul>\n<li><code>C:\\Main Folder\\Folder A\\</code></li>\n<li><p><code>C:\\Main Folder\\Folder B\\</code></p>\n\n<pre><code>FilePath1 = \"C:\\Main Folder\\Folder A\\\"\nFilePath2 = \"C:\\Main Folder\\Folder B\\\"\n\nSheets(\"Sheet1\").Copy\nFilename = ControlNumber.Value\nActiveWorkbook.SaveCopyAs FilePath1 &amp; \"\\\" &amp; Filename &amp; \".xls\"\nActiveWorkbook.Close savechanges:=False\n\nSheets(\"Sheet2\").Copy\nFilename = ControlNumber.Value\nActiveWorkbook.SaveCopyAs FilePath2 &amp; \"\\\" &amp; Filename &amp; \".xls\"\n</code></pre></li>\n</ul>\n"}, {"tags": ["vba", "excel", "winapi"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1450868780, "post_id": 34428911, "comment_id": 56609261, "body": "What is the objective of this? there are better ways to capture an area of the screen without using an external tool.  You OS decection code would not detect Windows 10.  You setcursorpos X coords are offscreen."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1450868813, "post_id": 34428911, "comment_id": 56609285, "body": "<i>tell me what they&#39;re called</i> - They are API declarations that allow you to call functions and services provided by the operating system API (Win32)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450886486, "post_id": 34428911, "comment_id": 56619784, "body": "There are much better ways of capturing an area of the screen from code than trying to kludge-automate SnippingTool, even from Excel VBA."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1450895362, "post_id": 34428911, "comment_id": 56624812, "body": "This is running on either Windows 7 or Windows 8. I suppose saying Windows 8+ is false. The X coords are correct when referencing the secondary monitor on the left side (Application that needs snipping on left monitor, Excel application on right monitor)."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450895444, "post_id": 34428911, "comment_id": 56624846, "body": "@KenWhite, do you have any tips on how to do that in Excel VBA and use the GetCursorPos coordinates as the snip boundaries?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1450899574, "post_id": 34428911, "comment_id": 56626819, "body": "You would use <code>GetCursorPos</code>, calculate the rectangle around that position, and pass the coordinates of that rectangle to your procedure that captures the screen area. As far as that procedure, there are existing questions here that demonstrate how to do that; you&#39;d just have to provide the VBA declarations of the API calls necessary and then port that code."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1452138230, "post_id": 34428911, "comment_id": 57039610, "body": "@KenWhite I appreciate your insight, but you provide no helpful content. I have looked for &quot;existing questions here&quot; and found no procedures that are compatible with secondary monitors."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1452139469, "post_id": 34428911, "comment_id": 57039937, "body": "Strange. I have Delphi code that does exactly that, and it works on either primary, secondary, or tertiary monitors. (I haven&#39;t tried it with more than three, but I see no reason it wouldn&#39;t work with them as well.) I ported the code to Delphi from C code I found here last year. (I&#39;m not sure if I saved the link or not. I&#39;d look tomorrow to see, but you don&#39;t find suggestions for a clear solution <i>helpful content</i>.)"}], "answers": [{"tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": false, "score": 5, "last_activity_date": 1452779725, "last_edit_date": 1452779725, "creation_date": 1452270098, "answer_id": 34681566, "question_id": 34428911, "link": "https://stackoverflow.com/questions/34428911/snipping-tool-does-not-start-a-snip-while-running-excel-macro/34681566#34681566", "title": "Snipping Tool does not start a snip while running Excel Macro?", "body": "<p>The short version is: <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/735c8f26-2129-4b46-8c1a-aad385cab2ed/multithreading-in-vba-for-excel\" rel=\"nofollow\">VBA in Excel is single-threaded</a>.</p>\n\n<p>If you have a VBA macro running in your session of Excel.exe, it's the only VBA code running in your session of the host application: and if it isn't the code that runs your snipper, your snipper isn't running.</p>\n\n<p>The definitive answer is: <strong>do this in some other tool</strong>. The suggestion from Microsoft in the link above is Visual Studio Tools for Office, and that's the place to start. Furthermore, your problem isn't just a matter of threading and the need for a separate process: VBA's ability to run event-driven code isn't really fast enough to deal with the firehouse of window message traffic that comes from a moving mouse cursor.</p>\n\n<p>If you have to do it in VBA, you can mitigate the problems you're seeing by stripping out everything which places your code in a 'sleep' or locked state that blocks incoming traffic: not just 'sleep' (which can probably be replaced by an Application.Wait), the WMI script (which can be replaced with API calls for process enumeration), and the MsgBox calls (which can be replaced by the shell 'Popup' function, which non-modal and non-blocking).</p>\n\n<p>But the bottom line is still the same: this might work in VBA, for certain values of 'working' that resemble teaching a dog to walk on his hind legs: </p>\n\n<p><em>\" 'tis not done well; but you are surprised to find it done at all\"</em>.</p>\n"}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3365, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1452779725, "creation_date": 1450846673, "last_edit_date": 1452137873, "question_id": 34428911, "link": "https://stackoverflow.com/questions/34428911/snipping-tool-does-not-start-a-snip-while-running-excel-macro", "title": "Snipping Tool does not start a snip while running Excel Macro?", "body": "<p>I want to automatically snip an area of the screen. I'm using these libraries and definitions:</p>\n\n<pre><code>'------ I don't own these functions. Copied them from the Internet. ------\nPublic Declare Function GetCursorPos Lib \"User32\" (lpPoint As POINTAPI) As Long\nPublic Declare Function SetCursorPos Lib \"user32\" (ByVal x As Long, ByVal y As Long) As Long\nPublic Declare Sub mouse_event Lib \"user32\" (ByVal dwFlags As Long, ByVal dx As Long, ByVal dy As Long, ByVal cButtons As Long, ByVal dwExtraInfo As Long)\nPublic Const MOUSEEVENTF_LEFTDOWN = &amp;H2\nPublic Const MOUSEEVENTF_LEFTUP = &amp;H4\n'The following two functions are for retrieving the color under mouse pointer\nPublic Declare Function GetWindowDC Lib \"User32\" (ByVal hwnd As Long) As Long\nPublic Declare Function GetPixel Lib \"gdi32\" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long) As Long\n\nPublic Function IsExeRunning(sExeName As String, Optional sComputer As String = \".\") As Boolean\nOn Error GoTo Error_Handler\nDim objProcesses    As Object\n\nSet objProcesses = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\" &amp; sComputer &amp; \"\\root\\cimv2\").ExecQuery(\"SELECT * FROM Win32_Process WHERE Name = '\" &amp; sExeName &amp; \"'\")\nIf objProcesses.Count &lt;&gt; 0 Then IsExeRunning = True\n\nError_Handler_Exit:\nOn Error Resume Next\nSet objProcesses = Nothing\nExit Function\n\nError_Handler:\nMsgBox \"The following error has occured.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"Error Number: IsExeRunning\" &amp; vbCrLf &amp; _\n        \"Error Description: \" &amp; Err.Description, _\n        vbCritical, \"An Error has Occured!\"\nResume Error_Handler_Exit\nEnd Function\n</code></pre>\n\n<p>I first have a calibration macro to set up where the mouse should start (see image for reference) <a href=\"https://i.stack.imgur.com/MwHZB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MwHZB.png\" alt=\"Artcam Example\"></a></p>\n\n<pre><code>'Calibrate mouse positions for GetColor sub below\n'I realize I could just use two corner points, but I didn't think of that until after this was used.\nSub CalibrateColorPositions()\n\nMsgBox \"Please hover over the top center of the ArtCam work area (just under the top ruler) and press Enter.\", vbOKOnly\nGetCursorPos pos\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Top Y\", pos.y\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Top X\", pos.x\n\nMsgBox \"Please hover over the right center of the ArtCam work area (just left of the scrollbar) and press Enter.\", vbOKOnly\nGetCursorPos pos\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Right Y\", pos.y\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Right X\", pos.x\n\nMsgBox \"Please hover over the bottom center of the ArtCam work area (just above the scrollbar) and press Enter.\", vbOKOnly\nGetCursorPos pos\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Bottom Y\", pos.y\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Bottom X\", pos.x\n\nMsgBox \"Please hover over the left center of the ArtCam work area (just right of the ruler) and press Enter.\", vbOKOnly\nGetCursorPos pos\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Left Y\", pos.y\nSaveSetting \"Will's Program Sheet\", \"CP Calibration\", \"Left X\", pos.x\n\nMsgBox \"Thanks! Calibration finished!\", vbOKOnly\nEnd Sub\n</code></pre>\n\n<p>I then have this in a Sub (I believe the problem occurs at the very end):</p>\n\n<pre><code>Sub GetColor()\nDim sTmp As String\nDim lColor As Long\nDim lDC As Long\nDim vSide As Integer\nDim TranslateX As Double, TranslateY As Double\nDim CurrentPosX As Long, CurrentPosY As Long\nDim TopX As Long, TopY As Long, RightX As Long, RightY As Long, BottomX As Long, BottomY As Long, LeftX As Long, LeftY As Long\nDim FinalTop As Long, FinalRight As Long, FinalBottom As Long, FinalLeft As Long\n\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = False\nDim windowStyle As Integer: windowStyle = 1\n\nTopX = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Top X\", 0)\nIf TopX = 0 Then\nCalibrateColorPositions 'Set calibration coordinates and exit sub\nExit Sub\nEnd If\n\n'Retrieve calibrated coordinates and set them to variables\nTopY = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Top Y\", 0)\nRightX = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Right X\", 0)\nRightY = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Right Y\", 0)\nBottomX = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Bottom X\", 0)\nBottomY = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Bottom Y\", 0)\nLeftX = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Left X\", 0)\nLeftY = GetSetting(\"Will's Program Sheet\", \"CP Calibration\", \"Left Y\", 0)\n\nsTmp = \"535353\" 'Our ArtCam programs have a gray background\n\n'Run four times (Top, Right, Bottom, and Left)\nFor vSide = 1 To 4\nSelect Case vSide\nCase 1\n'Move mouse to position\nCurrentPosX = TopX\nCurrentPosY = TopY\n'Which direction should the mouse move?\nTranslateX = 0\nTranslateY = 10\nCase 2\nCurrentPosX = RightX\nCurrentPosY = RightY\nTranslateX = -10\nTranslateY = 0\nsTmp = \"535353\"\nCase 3\nCurrentPosX = BottomX\nCurrentPosY = BottomY\nTranslateX = 0\nTranslateY = -10\nsTmp = \"535353\"\nCase 4\nCurrentPosX = LeftX\nCurrentPosY = LeftY\nTranslateX = 10\nTranslateY = 0\nsTmp = \"535353\"\nEnd Select\n\nWhile sTmp = \"535353\" 'If color under mouse is still gray, translate mouse.\n\nCurrentPosX = CurrentPosX + TranslateX\nCurrentPosY = CurrentPosY + TranslateY\nSetCursorPos CurrentPosX, CurrentPosY\n\nlDC = GetWindowDC(0)\nGetCursorPos pos\nlColor = GetPixel(lDC, pos.x, pos.y)\n\nsTmp = Right$(\"000000\" &amp; Hex(lColor), 6)\nDebug.Print (\"R:\" &amp; Right$(sTmp, 2) &amp; \" G:\" &amp; _\n     Mid$(sTmp, 3, 2) &amp; \" B:\" &amp; Left$(sTmp, 2))\nWend\n'Once it has detected a different color, save that position for later.\nSelect Case vSide\nCase 1\nFinalTop = CurrentPosY\nCase 2\nFinalRight = CurrentPosX\nCase 3\nFinalBottom = CurrentPosY\nCase 4\nFinalLeft = CurrentPosX\nEnd Select\nNext\n'Start Snipping Tool (and automatically start snip if necessary)\nApplication.CutCopyMode = False\nwsh.Run \"C:\\Windows\\sysnative\\SnippingTool.exe\"\nx = 0\nSelect Case Mid(Application.OperatingSystem, 21)\nCase 6.02\nDo Until IsExeRunning(\"SnippingTool.exe\") = True Or x = 500\nx = x + 1\nLoop\nSleep (350)\n'--------PROBLEM IS ASSUMED HERE-------\nAppActivate \"Snipping Tool\", True\nApplication.SendKeys \"^N\", True\nEnd Select\n\nSetCursorPos FinalLeft - 10, FinalTop - 10\nmouse_event MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0\nSetCursorPos FinalRight + 10, FinalBottom + 10\nmouse_event MOUSEEVENTF_LEFTUP, 0, 0, 0, 0\nEnd Sub\n</code></pre>\n\n<p>The Snipping Tool overlay never shows up and the mouse just selects everything between the coordinates. The overlay appears if the mouse events aren't there, but I NEED the mouse events to make this work!</p>\n\n<p>EDIT: I've made <em>some</em> headway. I was able to get it to snip, <strong>but</strong> it's extremely unreliable. I use SetCursorPos to click the New on Snipping Tool manually and works. Perhaps someone can figure out a more reliable method or provide some tips? Changed code below:</p>\n\n<pre><code>'--------PROBLEM IS ASSUMED HERE-------\n'AppActivate \"Snipping Tool\", True\n'testageNew\nEnd Select\n\nsnipposition 'Manually click New (Sub below)\n\nSleep (500) 'Add some delay for it to start.\n\n'Click and hold the top left to the bottom right position (AKA, take snip)\nSetCursorPos FinalLeft - 10, FinalTop - 10\nmouse_event MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0\nSetCursorPos FinalRight + 10, FinalBottom + 10\nmouse_event MOUSEEVENTF_LEFTUP, 0, 0, 0, 0\nEnd Sub\n\nSub snipposition()\n'Made separate Sub for user to test coordinates without running whole Sub.\nSetCursorPos 850, 250 'Coordinates of Snipping Tool New button.\nmouse_event MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0 'Click it.\nmouse_event MOUSEEVENTF_LEFTUP, 0, 0, 0, 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450850397, "post_id": 34429482, "comment_id": 56600049, "body": "It may not have showed, but I did spend a few hours on this... Sorry if I caused offense.  I appreciate the time you spent answering, and I&#39;m glad it ended up being trivial."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450850643, "post_id": 34429482, "comment_id": 56600137, "body": "Please, nothing to apologise for. But it&#39;s always worth putting all of your explorations in the question as it gives us a guide to how you&#39;re thinking about solving a problem ... a) you&#39;ll get more responses that way, and b) we can construct solutions that tie in with your line of thinking."}, {"owner": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450851001, "post_id": 34429482, "comment_id": 56600289, "body": "Thanks again. I think I will end up doing this specific task manually since it will end up taking much less time, but I will be sure to teach myself VBA properly sometime over the next few years so that my contributions are more meaningful."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450851307, "post_id": 34429482, "comment_id": 56600427, "body": "No problem. Before you do the task manually, just try pasting this code and running it - provided the data is sound it should work for you."}, {"owner": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450851930, "post_id": 34429482, "comment_id": 56600691, "body": "I just did after changing some variables, and got &quot;Compile error:  Invalid outside procedure (Sheet4 0:0)&quot;  I used &quot;Sub DateFix ()&quot; and &quot;End Sub&quot; at the beginning and end, so I suspect I misunderstood the nature of these functions. Not as analogous to &lt;html&gt; and &lt;/html&gt; as I thought."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450852189, "post_id": 34429482, "comment_id": 56600796, "body": "That&#39;s a shame. It&#39;s most likely an issue with the <code>dataCells</code> definition or the data itself. You might be right in that doing it manually will be quicker."}, {"owner": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "edited": false, "score": 0, "creation_date": 1450852341, "post_id": 34429482, "comment_id": 56600859, "body": "Thanks again for the time you put in!"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1450850121, "creation_date": 1450850121, "answer_id": 34429482, "question_id": 34428576, "link": "https://stackoverflow.com/questions/34428576/find-specific-cells-change-value-of-adjacent-cell-value-depends-on-location-e/34429482#34429482", "title": "Find specific cells, change value of adjacent cell, value depends on location (Excel for Mac, 15.6)", "body": "<p>I think it's fair to say your question doesn't show much effort at solving this problem and the code snippet simply places a dash next to a \"Phrase\" cell. However, for a wider audience the question is interesting because it highlights the difference between automating an Excel keystroke task and writing code to process data which is then written in an Excel worksheet. Both use VBA but the former is simply a programmatic record of keystrokes and the latter is an algorithmic solution.</p>\n\n<p>The telling phrase in your question is: <em>I use this formula in the 2nd column ... and then drag this down to cells in the relevant section. I'm trying to automate this process</em>. It would be possible to do this by using VBA to reproduce a bunch of worksheet functions but it's fiddly and could become complicated. I'll leave someone else to answer that as they'd need to spend more time on the answer than you have on the question (one of my <em>don't do</em> rules!).</p>\n\n<p>If, on the other hand, you step away from trying to automate keystrokes and towards VBA for data processing, the problem becomes very trivial. It's a really good example of how VBA, in just a few lines, can solve problems that Excel functions might take pages to do, and probably not reliably.</p>\n\n<p>So here's the code as a VBA solution. It'll need some data checking lines added to deal with blank cells, non-dates, etc. but I'll hand that task back to you:</p>\n\n<pre><code>Dim ws As Worksheet\nDim firstCell As Range\nDim lastCell As Range\nDim dataCells As Range\nDim v As Variant\nDim output() As Variant\nDim r As Long\nDim refDate As Long\n\n'Define the range to be worked\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\") 'amend as required\nSet firstCell = ws.Range(\"A1\") 'amend as required\nSet lastCell = ws.Cells(ws.Rows.Count, \"A\").End(xlUp) 'amend as required\nSet dataCells = ws.Range(firstCell, lastCell)\n\n'Read the values and size the output array\nv = dataCells.Value2 'use Value2 to avoid date format issues\nReDim output(1 To UBound(v, 1), 1 To 1)\n\n'Loop through the values, resetting the reference date on each \"Phrase\"\nFor r = 1 To UBound(v, 1)\n    If v(r, 1) = \"Phrase\" Then\n        output(r, 1) = \"-\"\n        refDate = v(r + 1, 1)\n    Else\n        output(r, 1) = v(r, 1) - refDate\n    End If\nNext\n\n'Write output into next column\ndataCells.Offset(, 1).Value = output\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5709594, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207942601350228/picture?type=large", "display_name": "Sunny Peddada", "link": "https://stackoverflow.com/users/5709594/sunny-peddada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2484, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450850121, "creation_date": 1450844301, "last_edit_date": 1450846035, "question_id": 34428576, "link": "https://stackoverflow.com/questions/34428576/find-specific-cells-change-value-of-adjacent-cell-value-depends-on-location-e", "title": "Find specific cells, change value of adjacent cell, value depends on location (Excel for Mac, 15.6)", "body": "<p>this is my first post here, I know I'm articulating this poorly.</p>\n\n<p>I'm trying to find cells containing a specific phrase in a column of dates. This phrase marks the beginning of a section. I then want to state the number of days elapsed from the first date in each section to other dates in the section. The values returned should show up in the adjacent column. Below is an example of the columns.</p>\n\n<p><a href=\"http://i.stack.imgur.com/IzpBS.png\" rel=\"nofollow\">Dates and Elapsed number of days in adjacent column</a></p>\n\n<p>I use this formula in the 2nd column: </p>\n\n<pre><code>=A15-$A$15\n</code></pre>\n\n<p>And then drag this down to cells in the relevant section. <strong>I'm trying to automate this process.</strong></p>\n\n<p>I found this code on this site and changed it a little bit to get this:</p>\n\n<pre><code>For Each cCell In Range(\"A1,A900\")\ncCell.Select\n\nIf ActiveCell.Value = \"Phrase\" Then\n  ActiveCell.Offset(1, 1).Value = \"-\"\nEnd If\nNext cCell\n</code></pre>\n\n<p>So my struggle is what to say in the 2nd Value field. I somehow need to get each section to subtract the first date of each section (the date right under \"Phrase\"). </p>\n\n<p>Another challenge is to copy that first adjacent cell that was changed, and then paste special into the cells below, but stopping once the next \"Phrase\" appears.</p>\n\n<p>I'll elaborate any way I can. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450842572, "post_id": 34428288, "comment_id": 56597611, "body": "Good luck. You can do it.... if you ever have any questions, come back here and ask, ok? :)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5687764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6ed62c384cdbdf97a91c4cb416a804?s=128&d=identicon&r=PG&f=1", "display_name": "Abd", "link": "https://stackoverflow.com/users/5687764/abd"}, "edited": false, "score": 0, "creation_date": 1450887787, "post_id": 34428959, "comment_id": 56620577, "body": "This worked i would also like it to color those tabs that have XXYY in green"}, {"owner": {"reputation": 23, "user_id": 5687764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6ed62c384cdbdf97a91c4cb416a804?s=128&d=identicon&r=PG&f=1", "display_name": "Abd", "link": "https://stackoverflow.com/users/5687764/abd"}, "edited": false, "score": 0, "creation_date": 1450897161, "post_id": 34428959, "comment_id": 56625664, "body": "Its coloring all tabs not the ones with XXYY"}, {"owner": {"reputation": 23, "user_id": 5687764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6ed62c384cdbdf97a91c4cb416a804?s=128&d=identicon&r=PG&f=1", "display_name": "Abd", "link": "https://stackoverflow.com/users/5687764/abd"}, "edited": false, "score": 0, "creation_date": 1450897324, "post_id": 34428959, "comment_id": 56625731, "body": "I figured it out i just had to move its position below the if statement. Thanks very much!!!"}], "tags": [], "owner": {"reputation": 208, "user_id": 5615421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e5Rqn.png?s=128&g=1", "display_name": "Herry Markowitz", "link": "https://stackoverflow.com/users/5615421/herry-markowitz"}, "is_accepted": true, "score": 2, "last_activity_date": 1450898251, "last_edit_date": 1450898251, "creation_date": 1450846989, "answer_id": 34428959, "question_id": 34428288, "link": "https://stackoverflow.com/questions/34428288/macro-to-loop-through-all-sheets-in-the-workbook-test-if-a-cell-has-a-certain-v/34428959#34428959", "title": "Macro to loop through all sheets in the workbook, test if a cell has a certain value. If yes, copy certain data to be pasted", "body": "<p>Try...</p>\n\n<pre><code>Sub Macro1()\nWorksheets.Add Before:=Sheets(1)\nActiveSheet.Name = \"Consolidate\"\nFor i = 2 To Worksheets.Count\nSheets(i).Select\n\nIf Sheets(i).Range(\"A1\").Value Like \"*XXYY*\" Then\n    Sheets(i).Rows(\"7:7\").Select\n    Sheets(i).Tab.Color = 5287936\n    Sheets(i).Range(Selection, Sheets(i).Range(\"A\" &amp; Rows.Count).End(xlUp)).Select\n    Selection.Copy Destination:=Sheets(\"Consolidate\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\nEnd If\nNext i\nSheets(\"Consolidate\").Select\nSheets(\"Consolidate\").Rows(\"2:9\").Insert\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5687764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6ed62c384cdbdf97a91c4cb416a804?s=128&d=identicon&r=PG&f=1", "display_name": "Abd", "link": "https://stackoverflow.com/users/5687764/abd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1494, "favorite_count": 0, "accepted_answer_id": 34428959, "answer_count": 1, "score": 0, "last_activity_date": 1455204760, "creation_date": 1450842152, "last_edit_date": 1531161705, "question_id": 34428288, "link": "https://stackoverflow.com/questions/34428288/macro-to-loop-through-all-sheets-in-the-workbook-test-if-a-cell-has-a-certain-v", "title": "Macro to loop through all sheets in the workbook, test if a cell has a certain value. If yes, copy certain data to be pasted", "body": "<p>I am currently working on a project that requires the following:</p>\n\n<p>Looping through all worksheets in a workbook, if cell A1 value equal XXYY then select row 7 ctrl down until end of content then copy</p>\n\n<p>Consolidate all the copied data into one worksheet starting from row 10 in the consolidated worksheet</p>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450841638, "post_id": 34428038, "comment_id": 56597411, "body": "Have you checked in a debugger to see if there actually <i>are</i> divisions by zero?  It&#39;s possible that when the debugger asserts that it&#39;s just highlighting the wrong line of code."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450844026, "post_id": 34428038, "comment_id": 56597975, "body": "I&#39;m not sure, but give this a try: <code>If CDbl(Val(TQM)) &lt; CDbl(Val(Cbox.Cells(3, 1))) Then</code> and <code>TQ1 = CDbl(Val(Q1.Value))</code>."}, {"owner": {"reputation": 11, "user_id": 5680567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7af46283d875dc5141e70ba3e364641?s=128&d=identicon&r=PG&f=1", "display_name": "KidButters", "link": "https://stackoverflow.com/users/5680567/kidbutters"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450846355, "post_id": 34428038, "comment_id": 56598688, "body": "There is no dividing throughout the whole sub, so there should be no divisions by zero anywhere @Comintern."}, {"owner": {"reputation": 11, "user_id": 5680567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7af46283d875dc5141e70ba3e364641?s=128&d=identicon&r=PG&f=1", "display_name": "KidButters", "link": "https://stackoverflow.com/users/5680567/kidbutters"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450846365, "post_id": 34428038, "comment_id": 56598695, "body": "I was trying to avoid going through and adjusting every line of code if i can @Fadi. I even got a divisible by zero error on    ActiveCell.Offset(0, 9).Value = TotBox"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450848423, "post_id": 34428038, "comment_id": 56599372, "body": "@KidButters, I faced similar problems a few years ago when I design my workbook in windows 8 and it worked without problems at all , but when tried to use this workbook on windows 7 these errors appeared. and every time the error message popup I go to the vba line and change it to CDbl , Cstr , etc, and now it works fine on both windows, but really didn&#39;t know why this errors in windows 7 , so i posted my comment maybe can help. so sorry about that."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1450850543, "post_id": 34428038, "comment_id": 56600097, "body": "In my experience , an integer overflow causes mayhem and code execution jumps to random lines in the code - check the locals window as you step through the code and watch out for integers , change to long"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1450852907, "post_id": 34428038, "comment_id": 56601106, "body": "I should say a variable overflow- it doesn&#39;t need to be only an integer that&#39;s out of bounds"}], "owner": {"reputation": 11, "user_id": 5680567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7af46283d875dc5141e70ba3e364641?s=128&d=identicon&r=PG&f=1", "display_name": "KidButters", "link": "https://stackoverflow.com/users/5680567/kidbutters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1450840346, "creation_date": 1450840346, "question_id": 34428038, "link": "https://stackoverflow.com/questions/34428038/vba-excel-random-divisible-by-zero-errors", "title": "VBA Excel Random &#39;divisible by zero&#39; errors", "body": "<p>I have a VBA Userform that calculates a freight quote that is rather long and complicated. When i run the macro that calculates the quote I keep getting</p>\n\n<blockquote>\n  <p>Run Time error 11: 'Divisible By Zero'</p>\n</blockquote>\n\n<p>on random lines. I debug and the line the error is referring to is something like:</p>\n\n<pre><code>If TQM &lt; Cbox.Cells(3, 1) Then\n</code></pre>\n\n<p>or</p>\n\n<pre><code>TQ1 = Q1.Value\n</code></pre>\n\n<p>where</p>\n\n<pre><code>Dim TQM, TQ1 as Double\ndim Q1 as Control 'refers to Combobox on form. Value in Q1 must be number,\n                  'this is checked earlier in sub, cannot reach this point otherwise\n</code></pre>\n\n<p>Without making changes, I click resume and the sub continues as if there was no error at all. Is this a problem with excel vba on OS x? Is there some way of fixing this issue without going through each potential point of error (which could be many) and putting in an On error statement?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450836256, "post_id": 34427444, "comment_id": 56596129, "body": "Is the sheet sorted on column A when the code is run?"}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450836599, "post_id": 34427444, "comment_id": 56596217, "body": "Hi. Yes. Column A is list of numbers, but they are formatted as text. So maybe a line to make it number values is missing. Still I get the same results/issues whether I turn it into # or not. These numbers go from smallest to largest hence the duplicates are one under another."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1450837805, "post_id": 34427611, "comment_id": 56596522, "body": "Like a charm. I started learning VBA recently due to need and improved a lot of dumb repetitive things but still need to get into routine with using some of the stuff you mentioned and revise lots of my code. Hence I really really appreciate explaining what you did and how you cut down the time. It works and was done in cca 3 seconds. Thank you for a prompt answer mate."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1450837681, "last_edit_date": 1450837681, "creation_date": 1450837127, "answer_id": 34427611, "question_id": 34427444, "link": "https://stackoverflow.com/questions/34427444/excel-vba-optimizing-code-to-delete-rows-based-on-a-duplicate-in-a-column/34427611#34427611", "title": "Excel VBA: Optimizing code to delete rows based on a duplicate in a column", "body": "<p>The concept is right, but remember that when you delete rows, <code>Cells(n1 + 1, 1)</code> isn't going to be the same thing as it was before you deleted a row.  The solution is to simply reverse the loop and test rows from bottom to top:</p>\n\n<pre><code>Sub DeleteDup()\n    Dim last As Long\n    Dim current As Long\n    Dim sheet As Worksheet\n\n    Set sheet = Worksheets(\"Sheet1\")\n    With sheet\n        last = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        For current = last To 1 Step -1\n            If .Cells(current + 1, 1).Value = .Cells(current, 1).Value Then\n                .Rows(current).Delete\n            End If\n        Next current\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that you can use the loop counter to index <code>.Rows</code> instead of using the <code>Selection</code> object to improve performance fairly significantly.  Also, if you grab a reference to the <code>Worksheet</code> and toss the whole thing in a <code>With</code> block you don't have to continually dereference <code>Worksheets(\"Sheet1\")</code>, which will also improve performance.</p>\n\n<p>If it still runs too slow, the next step would be to flag rows for deletion, sort on the flag, delete the entire flagged range in one operation, then sort back to the original order.  I'm guessing the code above should be fast enough for ~6K rows though.</p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 2, "last_activity_date": 1450839688, "creation_date": 1450839688, "answer_id": 34427957, "question_id": 34427444, "link": "https://stackoverflow.com/questions/34427444/excel-vba-optimizing-code-to-delete-rows-based-on-a-duplicate-in-a-column/34427957#34427957", "title": "Excel VBA: Optimizing code to delete rows based on a duplicate in a column", "body": "<p>The easiest way would be to delete all rows at once. Also to increase speed, you better do your checks with variables and not with the real cell values like this:</p>\n\n<pre><code>Sub DeleteDup()\n\n  Dim LastRowcheck As Long\n  Dim i As Long\n  Dim rows_to_delete As Range\n  Dim range_to_check As Variant\n\n  With Worksheets(\"Sheet1\")\n    LastRowcheck = .Cells(Rows.Count, 1).End(xlUp).Row\n    range_to_check = .Range(\"A1:A\" &amp; LastRowcheck).Values\n\n    For i = 1 To LastRowcheck - 1\n      If range_to_check(i, 1) = range_to_check(i + 1, 1) Then\n        If rows_to_delete Is Nothing Then\n          Set rows_to_delete = .Cells(i, 1)\n        Else\n          Set rows_to_delete = Union(.Cells(i, 1), rows_to_delete)\n        End If\n      End If\n    Next n1\n  End With\n\n  rows_to_delete.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 1, "accepted_answer_id": 34427611, "answer_count": 2, "score": 0, "last_activity_date": 1450839688, "creation_date": 1450836091, "question_id": 34427444, "link": "https://stackoverflow.com/questions/34427444/excel-vba-optimizing-code-to-delete-rows-based-on-a-duplicate-in-a-column", "title": "Excel VBA: Optimizing code to delete rows based on a duplicate in a column", "body": "<p>I am trying to come up with a lean and error-proofed macro to delete rows containing duplicate values in a column A. I have two solutions and both have their advantages. None of them are exactly what I want. </p>\n\n<p><strong>I need rows containing duplicates deleted but leaving the last row that contained the duplicate.</strong> </p>\n\n<ol>\n<li><p>This one is awesome. It has no loop and works instantaneously. The problem is that it deletes subsequent rows containing duplicates hence leaving the first occurrence of the duplicate (And I need the last/ or second - most show up only twice)</p>\n\n<p><code>Sub Delete()\n    ActiveSheet.Range(\"A:E\").RemoveDuplicates Columns:=1, Header:=xlNo\nEnd Sub</code></p></li>\n<li><p>This one goes from the bottom and deletes duplicates. It lasts longer than the first one ( I have around 6k rows) But the issue with this one is that it doesnt delete them all. Some duplicates are left and they are deleted after I run the same code again. Even smaller number of duppes is still left. Basically need to run it up to 5 times and then I end up with clean list. </p>\n\n<p>`</p>\n\n<p>Sub DeleteDup()</p>\n\n<pre><code>  Dim LastRowcheck As Long, n1 As Long, rowschecktodelete As Long\n\n  LastRowcheck = Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n  For n1 = 1 To LastRowcheck\n    With Worksheets(\"Sheet1\").Cells(n1, 1)\n      If Cells(n1, 1) = Cells(n1 + 1, 1) Then\n        Worksheets(\"Sheet1\").Cells(n1, 1).Select\n        Selection.EntireRow.Delete\n     End If\n   End With\n  Next n1\n\n  End Sub\n</code></pre></li>\n</ol>\n\n<p>`\nIs there a way to improve any of these to work well or is there a better solution? Any info is greatly appreciated. Thanks </p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450834043, "post_id": 34427121, "comment_id": 56595646, "body": "What is a &quot;business month&quot;?"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450834279, "post_id": 34427121, "comment_id": 56595688, "body": "The business days in a month, basically Monday to Friday.."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1450834382, "creation_date": 1450834382, "answer_id": 34427230, "question_id": 34427121, "link": "https://stackoverflow.com/questions/34427121/excel-vba-comparing-between-a-given-date-and-given-date-2-months/34427230#34427230", "title": "Excel VBA Comparing between a given date and (given date - 2 months)", "body": "<p>Here is how to get the last day of a month:</p>\n\n<pre><code>Sub LastDayOfMonth()\n    Dim d As Date\n    mnth = 12\n    yr = 2015\n    d = DateSerial(yr, mnth + 1, 0)\n    MsgBox d\nEnd Sub\n</code></pre>\n\n<p>You must then subtract two months from that date.  If the result falls on a Saturday or Sunday,  you must decide if you want to go forward to the next Monday or backward to the previous Friday.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1450835153, "last_edit_date": 1450835153, "creation_date": 1450834531, "answer_id": 34427247, "question_id": 34427121, "link": "https://stackoverflow.com/questions/34427121/excel-vba-comparing-between-a-given-date-and-given-date-2-months/34427247#34427247", "title": "Excel VBA Comparing between a given date and (given date - 2 months)", "body": "<p>To find the last day of the month, you can find the first day of the next month and subtract a day:</p>\n\n<pre><code>Dim last As Date\nDim current As Date\n\ncurrent = Now\nlast = DateSerial(Year(current), Month(current), 1) - 1\nDebug.Print last\n</code></pre>\n\n<p>To get the last business day of a month, just subtract days until it falls on a weekday:</p>\n\n<pre><code>Do While Weekday(last, vbMonday) &gt; 5\n    last = last - 1\nLoop\nDebug.Print last\n</code></pre>\n\n<p>Combining the 2 ideas and extracting it as a function gets you this:</p>\n\n<pre><code>Private Sub Example()\n\n    Debug.Print LastBizDayOfMonth(Year(Now), Month(Now) - 1)\n    Debug.Print LastBizDayOfMonth(Year(Now), Month(Now) - 2)\n\nEnd Sub\n\nPrivate Function LastBizDayOfMonth(inYear As Integer, inMonth As Integer) As Date\n    LastBizDayOfMonth = DateSerial(inYear, inMonth + 1, 1) - 1\n    Do While Weekday(LastBizDayOfMonth, vbMonday) &gt; 5\n        LastBizDayOfMonth = LastBizDayOfMonth - 1\n    Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 34427247, "answer_count": 2, "score": 0, "last_activity_date": 1450835153, "creation_date": 1450833563, "last_edit_date": 1531164843, "question_id": 34427121, "link": "https://stackoverflow.com/questions/34427121/excel-vba-comparing-between-a-given-date-and-given-date-2-months", "title": "Excel VBA Comparing between a given date and (given date - 2 months)", "body": "<p>I am writing a code to ensure that the data date of a system is not later than 2 business month-end date. For instance, if the job run date for the system is 23/12/2015, the valid data date is 30/10/2015 and 30/11/2015. The dates involved are only business days. </p>\n\n<p>I have this code below: </p>\n\n<pre><code>If DateDiff(\"m\", dataDate, jobRunDate) &gt; 2 Then\n    MsgBox \"Error in dataDate\"\nEnd If\n</code></pre>\n\n<p>However, I do not know how to find:</p>\n\n<ol>\n<li>The last day of the month</li>\n<li>Compute 2 business month back</li>\n</ol>\n\n<p>Any help will be greatly appreciated. Thanks!  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1450831177, "post_id": 34426747, "comment_id": 56594999, "body": "Your instruction is doing too many things. Break it down into smaller steps, see exactly which call is blowing up."}, {"owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1450831536, "post_id": 34426747, "comment_id": 56595079, "body": "@Mat&#39;sMug What do you mean? Care to explain?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1450831721, "post_id": 34426747, "comment_id": 56595132, "body": "Is that all of the code?  I can&#39;t replicate."}, {"owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450831954, "post_id": 34426747, "comment_id": 56595198, "body": "@Comintern No. But the codes above should be able to run independently."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1450832011, "post_id": 34426747, "comment_id": 56595211, "body": "@mrwave - The code above <i>does</i> run independently.  Can you post code that <i>doesn&#39;t</i> run?"}, {"owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450832538, "post_id": 34426747, "comment_id": 56595340, "body": "@Comintern the codes that I chose not to post are not relevant to the codes above"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1450832664, "post_id": 34426747, "comment_id": 56595378, "body": "@mrwave people are trying to help you. They&#39;re telling you that the &quot;relevant code&quot; you posted does not produce the broken behavior you&#39;re asking us to help you fix. Seems like <i>some</i> of the missing code <i>is</i> relevant..."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "edited": false, "score": 0, "creation_date": 1450831998, "post_id": 34426866, "comment_id": 56595206, "body": "alright i&#39;ll try it out. Will let you know if I find anything"}], "tags": [], "owner": {"reputation": 577, "user_id": 3951289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtKWS.jpg?s=128&g=1", "display_name": "Shep", "link": "https://stackoverflow.com/users/3951289/shep"}, "is_accepted": false, "score": 1, "last_activity_date": 1450831269, "creation_date": 1450831269, "answer_id": 34426866, "question_id": 34426747, "link": "https://stackoverflow.com/questions/34426747/error-1004-methold-range-of-worksheet-failed/34426866#34426866", "title": "Error 1004 methold &quot;range&quot; of &#39;worksheet&#39;_ failed", "body": "<p>As the error states, your range definition is wrong.</p>\n\n<p>Look at this line as a correct example:</p>\n\n<pre><code>If (malesheet.Range(\"A\" &amp; i).value = ...\n</code></pre>\n\n<p>Notice the range will resolve as A1, A2,.. etc</p>\n\n<p>For the line throwing the error, what cells is the range referring to ?</p>\n\n<pre><code>malesheet.Range(\"A\" &amp; malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1).End(xlUp).Row\n</code></pre>\n\n<p>Try break up the parts of that operation to confirm the values are as expected.\nSet break-points or write the values to other cells for debugging:\ne.g.</p>\n\n<pre><code>Dim temp = xlLastCell     '(does this value exist)\nDim temp2 = xlUp    '(does this value exist)\nDim temp3 = malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row '(does this return an int)\nDim temp4 = malesheet.Range(\"A1\").End(xlUp).Row   '(does this work)\nDim temp5 = malesheet.Range(\"A\" &amp; 1 + 1)   '(does this work)\n</code></pre>\n\n<p>Once you have confirmed the underlying values, you can hard code the values for a test of the range.</p>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1450831803, "creation_date": 1450831803, "answer_id": 34426924, "question_id": 34426747, "link": "https://stackoverflow.com/questions/34426747/error-1004-methold-range-of-worksheet-failed/34426924#34426924", "title": "Error 1004 methold &quot;range&quot; of &#39;worksheet&#39;_ failed", "body": "<p>I believe that below code you try to find out the last row.\nBut I think it will not work</p>\n\n<pre><code>lastrmale = malesheet.Range(\"A\" &amp; malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1).End(xlUp).Row\n</code></pre>\n\n<p>it suppose is</p>\n\n<pre><code>lastrmale  = malesheet.cells.SpecialCells(xlLastCell).Row + 1\n</code></pre>\n\n<p>by the way either cells or Range(\"A1\") both are same</p>\n\n<pre><code>malesheet.cells.SpecialCells(xlLastCell).Row + 1  = malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1\n</code></pre>\n\n<p>or the method I love the most</p>\n\n<pre><code>lastrmale = malesheet.Range(\"A:A\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "edited": false, "score": 0, "creation_date": 1450833997, "post_id": 34427033, "comment_id": 56595638, "body": "Ahhh okay I get it now. Thanks a bunch :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1450832733, "creation_date": 1450832733, "answer_id": 34427033, "question_id": 34426747, "link": "https://stackoverflow.com/questions/34426747/error-1004-methold-range-of-worksheet-failed/34427033#34427033", "title": "Error 1004 methold &quot;range&quot; of &#39;worksheet&#39;_ failed", "body": "<p>The line that's blowing up is an assignment. The right side of that assignment is a <em>value expression</em>; value expressions can be pretty much as long as you can make them, VBA won't feel a thing. But the longer they are, the harder they are to read, maintain, and fix when they break:</p>\n\n<blockquote>\n<pre><code>lastrmale = malesheet.Range(\"A\" &amp; malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1).End(xlUp).Row\n</code></pre>\n</blockquote>\n\n<p>You have no less than 6 member calls in that expression:</p>\n\n<ul>\n<li><code>malesheet.Range(\"A\" &amp; ...)</code></li>\n<li><code>malesheet.Range(\"A1\")</code> </li>\n<li><code>[Range].SpecialCells(xlLastCell)</code></li>\n<li><code>[Range].Row</code></li>\n<li><code>[Range].End(xlUp)</code></li>\n<li><code>[Range].Row</code></li>\n</ul>\n\n<p>Make yourself a function that takes a <code>Range</code> or a <code>Worksheet</code> and returns a <code>Long</code> representing the last row.</p>\n\n<p>Now you have:</p>\n\n<pre><code>lastrmale = malesheet.Range(\"A\" &amp; FindLastRow(malesheet.Range(\"A1\")) + 1).Row\n</code></pre>\n\n<p>Which could also be:</p>\n\n<pre><code>Dim rename_me As Long\nrename_me = FindLastRow(malesheet.Range(\"A1\")\nlastrmale = malesheet.Range(\"A\" &amp; rename_me + 1).Row\n</code></pre>\n\n<p>Which seems silly, since the row number you're after would simply be <code>rename_me + 1</code>.</p>\n"}], "owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 34427033, "answer_count": 3, "score": 0, "last_activity_date": 1450835348, "creation_date": 1450830430, "last_edit_date": 1450835348, "question_id": 34426747, "link": "https://stackoverflow.com/questions/34426747/error-1004-methold-range-of-worksheet-failed", "title": "Error 1004 methold &quot;range&quot; of &#39;worksheet&#39;_ failed", "body": "<p>Hi all I can't seem to solve this error.</p>\n\n<p>The error is on line : <code>lastrmale = malesheet.Range(\"A\" &amp; malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1).End(xlUp).Row</code> <BR/></p>\n\n<p>The codes above searches sheet \"male\" and \"female\" for matches on column A, K and M. If all 3 columns matches, the row from both sheets is then copied and pasted on sheet \"Mix\" . <BR/></p>\n\n<p>Does anyone know the solution to this? Any help is appreciated !</p>\n\n<pre><code>Dim lastr As Long\nDim lastrmale As Long\nDim lastrfemale As Long\nDim lastrmix As Long\nDim malesheet As Worksheet\nDim Femalesheet As Worksheet\nDim mixsheet As Worksheet\nDim i As Long\nSet malesheet = Worksheets(\"Male\")\nSet Femalesheet = Worksheets(\"Female\")\nSet mixsheet = Worksheets(\"mix\")\nlastrmale = malesheet.Range(\"A\" &amp; malesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1).End(xlUp).Row\n\nlastrfemale = Femalesheet.Range(\"A\" &amp; Femalesheet.Range(\"A1\").SpecialCells(xlLastCell).Row + 1).End(xlUp).Row\n\nlastr = WorksheetFunction.Min(lastrmale, lastrfemale)\nlastrmix = 2\nFor i = 2 To lastr\n\n    If (malesheet.Range(\"A\" &amp; i).value = Femalesheet.Range(\"A\" &amp; i).value) And (malesheet.Range(\"K\" &amp; i).value = Femalesheet.Range(\"K\" &amp; i).value) And (malesheet.Range(\"M\" &amp; i).value = Femalesheet.Range(\"M\" &amp; i).value) Then\n\n        malesheet.Rows(i &amp; \":\" &amp; i).Copy\n        mixsheet.Range(\"A\" &amp; lastrmix).PasteSpecial xlPasteAll\n    lastrmix = lastrmix + 1\n    Femalesheet.Rows(i &amp; \":\" &amp; i).Copy\n        mixsheet.Range(\"A\" &amp; lastrmix).PasteSpecial xlPasteAll\n    lastrmix = lastrmix + 1\n\n    End If\nNext\n</code></pre>\n"}, {"tags": ["sql", "vba", "filter"], "comments": [{"owner": {"reputation": 1296, "user_id": 5031496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IqU0t.jpg?s=128&g=1", "display_name": "Free Url", "link": "https://stackoverflow.com/users/5031496/free-url"}, "reply_to_user": {"reputation": 2602, "user_id": 5565170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d110c1241538fcf7c1fd6b6ebfa6153f?s=128&d=identicon&r=PG&f=1", "display_name": "Stidgeon", "link": "https://stackoverflow.com/users/5565170/stidgeon"}, "edited": false, "score": 0, "creation_date": 1450829784, "post_id": 34426568, "comment_id": 56594656, "body": "@Stidgeon I have checked for that. Earliest date for result it is pulling up is &quot;6/16/2014&quot; [without quotes] which is copied directly from field. I believe my date query matches this format though I know this field is labeled &quot;Date/Time&quot; and the date_ data member is declared a date variable."}, {"owner": {"reputation": 1296, "user_id": 5031496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IqU0t.jpg?s=128&g=1", "display_name": "Free Url", "link": "https://stackoverflow.com/users/5031496/free-url"}, "reply_to_user": {"reputation": 2602, "user_id": 5565170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d110c1241538fcf7c1fd6b6ebfa6153f?s=128&d=identicon&r=PG&f=1", "display_name": "Stidgeon", "link": "https://stackoverflow.com/users/5565170/stidgeon"}, "edited": false, "score": 0, "creation_date": 1450830463, "post_id": 34426568, "comment_id": 56594822, "body": "as an update, changing the relationship operator for the date field to &lt;= produces zero results, even when there should be some. I feel like this must be some kind of trivial thing such as formatting, as Stidgeon said. Any ideas?"}], "answers": [{"comments": [{"owner": {"reputation": 1296, "user_id": 5031496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IqU0t.jpg?s=128&g=1", "display_name": "Free Url", "link": "https://stackoverflow.com/users/5031496/free-url"}, "edited": false, "score": 0, "creation_date": 1450879167, "post_id": 34427123, "comment_id": 56615393, "body": "Thanks barrowc, this has solved my problem. I am not sure why the &#39;#&#39;s are necessary, will look up. Thanks again!"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 1, "last_activity_date": 1450833571, "creation_date": 1450833571, "answer_id": 34427123, "question_id": 34426568, "link": "https://stackoverflow.com/questions/34426568/incorrect-sql-query-for-date/34427123#34427123", "title": "Incorrect Sql query for date", "body": "<p>Try <strong>#mm/dd/yyyy#</strong> as the date literal format (regardless of which order is used in your regional settings) so, assuming you were looking for 1st July 2015, use this fragment:</p>\n\n<pre><code>\"[Date] &gt;= #\" &amp; Format(date, \"mm/dd/yyyy\") &amp; \"#;\"\n</code></pre>\n"}], "owner": {"reputation": 1296, "user_id": 5031496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IqU0t.jpg?s=128&g=1", "display_name": "Free Url", "link": "https://stackoverflow.com/users/5031496/free-url"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 34427123, "answer_count": 1, "score": -2, "last_activity_date": 1450833571, "creation_date": 1450829157, "last_edit_date": 1450832668, "question_id": 34426568, "link": "https://stackoverflow.com/questions/34426568/incorrect-sql-query-for-date", "title": "Incorrect Sql query for date", "body": "<p>I have an SQL query I am working through excel 2013 accessing an access db. Query is working correctly except it isn't filtering out the date. It should have zero results but has 23 instead. I have hand-checked the db to ensure the correct record count. I feel like I am missing something obvious, but this query is pulling results from the date field from before 07/01/2015 and I have tried reversing the relation operator \">\".</p>\n\n<pre><code>date_ = \"07/01/2015\"\n'SQL query\nstrSql = \"SELECT [Field1] FROM [Table1] WHERE [Field1] like '%\" &amp; field1 &amp; \"%' AND [\" &amp; x &amp; \"] = true AND [Date] &gt;= \" &amp; date_ &amp; \";\"\n</code></pre>\n\n<p>This is the printed Sql query: </p>\n\n<pre><code>SELECT [Field1] FROM [Table1] WHERE [Field1] like '%255793%' AND [field2] = true AND [Date] &gt;= 7/1/2015;\n</code></pre>\n\n<p>Ideas?</p>\n\n<p>And please let me know if more code is needed.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "unicode"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1450832633, "post_id": 34426537, "comment_id": 56595369, "body": "<a href=\"http://stackoverflow.com/q/33113161/4088852\">Possibly related</a>. I&#39;m guessing that the status bar isn&#39;t using a fixed width font, so you&#39;ll have to find 2 characters that have the same width in the font being used."}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 3, "last_activity_date": 1468743300, "last_edit_date": 1468743300, "creation_date": 1468733696, "answer_id": 38418214, "question_id": 34426537, "link": "https://stackoverflow.com/questions/34426537/progress-bar-in-status-bar-a-blank-and-a-filled-in-char-are-not-equal-width/38418214#38418214", "title": "Progress bar in Status bar, a blank and a filled in char are not equal width", "body": "<p>There's a Unicode block from U+25A0 to U+25FF called Geometric Shapes. There are some matching pairs of black/ white shapes in there that will successfully work for your progress bar implementation.</p>\n\n<p>In the test code below, some pairs work and some do not!. Personally I like the last example (pairing U+25AE and U+25AD).</p>\n\n<pre><code>Option Explicit\n\nSub TestNewProgBar()\n    Dim lngCounter As Long\n    Dim lngMax As Long\n    Dim strFilledChar As String\n    Dim strNotFilledChar As String\n\n    'iterations\n    lngMax = 100000\n\n    'small squares - works\n    strFilledChar = ChrW(&amp;H25AA)\n    strNotFilledChar = ChrW(&amp;H25AB)\n    For lngCounter = 1 To lngMax\n        Call NewProgressBar(\"Small squares\", lngCounter, lngMax, strFilledChar, strNotFilledChar)\n    Next\n\n    'large squares - doesn't work\n    strFilledChar = ChrW(&amp;H25A0)\n    strNotFilledChar = ChrW(&amp;H25A1)\n    For lngCounter = 1 To lngMax\n        Call NewProgressBar(\"Large squares\", lngCounter, lngMax, strFilledChar, strNotFilledChar)\n    Next\n\n    'large squares 2 - doesn't work (but opposite effect)\n    strFilledChar = ChrW(&amp;H25A3)\n    strNotFilledChar = ChrW(&amp;H25A1)\n    For lngCounter = 1 To lngMax\n        Call NewProgressBar(\"Large squares 2\", lngCounter, lngMax, strFilledChar, strNotFilledChar)\n    Next\n\n    'mixed vertical/ horizontal rectangles - works!\n    strFilledChar = ChrW(&amp;H25AE)\n    strNotFilledChar = ChrW(&amp;H25AD)\n    For lngCounter = 1 To lngMax\n        Call NewProgressBar(\"Mixed rectangles\", lngCounter, lngMax, strFilledChar, strNotFilledChar)\n    Next\n\nEnd Sub\n\nSub NewProgressBar(strMyMessage As String, lngCurrentVal As Long, lngMaxVal As Long, strFilledChar As String, strNotFilledChar As String)\n    Dim lngFilledIn As Long\n    Dim lngNotFilledIn As Long\n    Dim strStatus As String\n\n    If lngCurrentVal &gt;= lngMaxVal Then\n        Application.StatusBar = strMyMessage &amp; \": Complete\"\n    Else\n        lngFilledIn = Round((lngCurrentVal / lngMaxVal) * 100, 0)\n        lngNotFilledIn = (100 - lngFilledIn)\n        strStatus = strMyMessage &amp; \": \" &amp; _\n            String(lngFilledIn, strFilledChar) &amp; _\n            String(lngNotFilledIn, strNotFilledChar) &amp; _\n            \"| \" &amp; lngFilledIn &amp; \"%\"\n        Application.StatusBar = strStatus\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 8269695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d2b76558e86fb017341f7140ec2d66?s=128&d=identicon&r=PG", "display_name": "squidgeny", "link": "https://stackoverflow.com/users/8269695/squidgeny"}, "is_accepted": false, "score": 3, "last_activity_date": 1499417574, "last_edit_date": 1499417574, "creation_date": 1499416877, "answer_id": 44966339, "question_id": 34426537, "link": "https://stackoverflow.com/questions/34426537/progress-bar-in-status-bar-a-blank-and-a-filled-in-char-are-not-equal-width/44966339#44966339", "title": "Progress bar in Status bar, a blank and a filled in char are not equal width", "body": "<p><strong>Edit:</strong> </p>\n\n<p>To follow up on my 'aside' below, I did some experimenting, and Comintern was onto something when s/he provided a link to <a href=\"https://stackoverflow.com/questions/33113161/excel-statusbar-font-size-changing-unintentionally\">this issue</a>. The problem described above is to do with <em>ScreenUpdating</em>. If Screenupdating is set to false when the status bar is changed, the character widths of ChrW(9608) and ChrW(9620) are the same.</p>\n\n<p>I've no idea why, but it does the trick. So you'll want to do the following:</p>\n\n<pre><code>Application.Screenupdating = False\n\n'code which changes the status bar\n\nApplication.Screenupdating = True\n</code></pre>\n\n<hr>\n\n<p>(my previous comment continues below)</p>\n\n<p>I prefer this pairing:</p>\n\n<pre><code>strFilledChar = ChrW(&amp;H2588) 'a black rectangle, \"Full Block\"\nstrUnfilledChar = ChrW(&amp;H2584) 'an array of sparse dots, \"Light Shade\"\n</code></pre>\n\n<p>Or this one:</p>\n\n<pre><code>strFilledChar = ChrW(&amp;H2588) 'a black rectangle, \"Full Block\"\nstrUnfilledChar = ChrW(&amp;H2500) 'a horizontal line, \"Block Drawings Light Horizontal\"\n</code></pre>\n\n<p><em>(as an aside, I encountered the same problem as described in the question whereby ChrW(9608) and ChrW(9620) have different widths - but only in <strong>one</strong> of my workbooks. In another workbook, they have the same widths and so the progress bar displays properly. I have no idea why.)</em></p>\n"}], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 38418214, "answer_count": 2, "score": 2, "last_activity_date": 1499417574, "creation_date": 1450829018, "last_edit_date": 1468751051, "question_id": 34426537, "link": "https://stackoverflow.com/questions/34426537/progress-bar-in-status-bar-a-blank-and-a-filled-in-char-are-not-equal-width", "title": "Progress bar in Status bar, a blank and a filled in char are not equal width", "body": "<p>I am playing around creating code for a progress bar that runs in the Excel Status Bar. I want to replace my old dated userform with the 2 rectangles (which worked but I would sooner a less obtrusive method now).</p>\n\n<p>Problem: The width of the chars I am using to signify \"Filled In\" and \"Not Filled in\" are slightly different, when using 100 of them you can see the percentage at the end appears to shift right as the progress increases.</p>\n\n<p>Here is some working sample code to show you exactly what I mean:</p>\n\n<pre><code>Sub TestNewProgBar()\nDim X As Long\nFor X = 1 To 100000\n    Call NewProgressBar(\"Testing\", X, 100000)\nNext\nEnd Sub\n\nSub NewProgressBar(MyMessage As String, CurrentVal As Long, MaxVal As Long)\nDim FilledIn As Long, NotFilledIn As Long\nIf CurrentVal &gt;= MaxVal Then\n    Application.StatusBar = MyMessage &amp; \": Complete\"\nElse\n    FilledIn = Round((CurrentVal / MaxVal) * 100, 0)\n    NotFilledIn = (100 - FilledIn)\n    Application.StatusBar = MyMessage &amp; \": \" &amp; Application.WorksheetFunction.Rept(ChrW(9608), FilledIn) &amp; Application.WorksheetFunction.Rept(ChrW(9620), NotFilledIn) &amp; \"| \" &amp; FilledIn &amp; \"%\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Run <code>TestNewProgBar</code> and look at the status bar.</p>\n\n<p>Is this going to be a simple case of choosing a different Unicode symbol or are there forces beyond my control at work here?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5709201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c01cc8ab455e75d69ce9e697557acd?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5709201/matt"}, "edited": false, "score": 0, "creation_date": 1450888398, "post_id": 34426711, "comment_id": 56620982, "body": "Well that explains why it fails, thanks. Can you help me with a way to work around that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 5709201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c01cc8ab455e75d69ce9e697557acd?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5709201/matt"}, "edited": false, "score": 0, "creation_date": 1450890405, "post_id": 34426711, "comment_id": 56622200, "body": "I can&#39;t think of any way to do it other than with a hidden column and a formula to show the last 100 characters, or storing the text in a cell comment and using VBA to populate it back to the cell on selection."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1450830168, "creation_date": 1450830168, "answer_id": 34426711, "question_id": 34426533, "link": "https://stackoverflow.com/questions/34426533/hiding-characters-in-excel-i-get-the-error-unable-to-set-the-numberformat-prop/34426711#34426711", "title": "Hiding Characters in Excel, I get the error: Unable to set the NumberFormat property of the Range class", "body": "<p>From:</p>\n\n<p><a href=\"https://support.office.com/en-my/article/Excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\" rel=\"nofollow\">https://support.office.com/en-my/article/Excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3</a></p>\n\n<blockquote>\n  <p>Number formats in a workbook</p>\n  \n  <p>Between 200 and 250, depending on the language version of Excel that\n  you have installed</p>\n</blockquote>\n\n<p>In my Excel 2010 this fails on the 207th format:</p>\n\n<pre><code>Sub Tester()\n    Dim c As Range\n    For Each c In Range(\"A1:A1000\")\n        c.NumberFormat = \";;;\"\"\" &amp; c.Address(False, False) &amp; \"\"\"\"\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5709201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c01cc8ab455e75d69ce9e697557acd?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5709201/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450830199, "creation_date": 1450828991, "last_edit_date": 1450830199, "question_id": 34426533, "link": "https://stackoverflow.com/questions/34426533/hiding-characters-in-excel-i-get-the-error-unable-to-set-the-numberformat-prop", "title": "Hiding Characters in Excel, I get the error: Unable to set the NumberFormat property of the Range class", "body": "<p>I just want my <code>cells</code> to have only the last 100 characters showing.</p>\n\n<p>Here is my Code:</p>\n\n<pre><code>Sub HideCharacters()\n    Dim DQ As String, mesage As String\n    On Error GoTo Errorcatch\n    DQ = Chr(34)\n    For Each r In Selection\n        mesage = Right(r.Value, 100)\n        mesage = DQ &amp; mesage &amp; DQ\n        r.NumberFormat = \";;;\" &amp; mesage\n    Next r\nErrorcatch:\nMsgBox Err.Description\nEnd Sub\n</code></pre>\n\n<p>The code works for a while then as I add more worksheets and apply the macro to them, I start to get the error: \"<code>Unable to set the NumberFormat property of the Range class</code>\", how can I fix this?</p>\n\n<p>Thank you in advance,\n-Matt</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1450828887, "post_id": 34426430, "comment_id": 56594428, "body": "Just to make sure I understand correctly, the code in Workbook A executes as expected, but the Workbook B reopens 15 seconds after you initially opened it?"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1450831225, "creation_date": 1450831225, "answer_id": 34426863, "question_id": 34426430, "link": "https://stackoverflow.com/questions/34426430/stop-workbook-from-running-cancelled-timed-code/34426863#34426863", "title": "Stop workbook from running &#39;cancelled&#39; Timed code", "body": "<p>Some quick testing shows the timer seems to be running within the context of the Workbook that the macro resides in - not the Workbook that you executed it from. So, you need to do one of 2 things - either quit the Excel application completely (probably not convenient) or reset the timer from the Worksheet you're running the code from.</p>\n\n<p>I.e., in WorkbookA:</p>\n\n<pre><code>Dim book As Workbook\n\nSet book = Workbooks.Open(\"WorkbookB.xlsm\")\nbook.Save\nApplication.Run book.Name &amp; \"!StopTimer\"\nbook.Close\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5709143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d06877d4416965eae28f85ffc8d16a?s=128&d=identicon&r=PG&f=1", "display_name": "LazyBM", "link": "https://stackoverflow.com/users/5709143/lazybm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480806399, "creation_date": 1450828294, "last_edit_date": 1525816189, "question_id": 34426430, "link": "https://stackoverflow.com/questions/34426430/stop-workbook-from-running-cancelled-timed-code", "title": "Stop workbook from running &#39;cancelled&#39; Timed code", "body": "<p>Edit: I've managed to solve the problem below by using <code>Application.EnableEvents = False</code> in Workbook A to stop the <code>Workbook_Open()</code> code from running in Workbook B but am still stumped by the problem if anybody care to explain?</p>\n\n<p>I've got Workbook A opening, editing, saving and closing Workbook B. As Workbook B is used by multiple users, I made it switch to Read-Only mode upon opening and display a pop-up message. However, when running the code from Workbook A, I want to stop the message box from opening. I used <code>Application.OnTime</code> to change Workbook B to Read-Only upon opening and to cancel the pending code upon saving within 10 seconds.</p>\n\n<p>Problem: The code works when I open Workbook B directly and save within 10 seconds but when running a code from Workbook A to <code>open=&gt;edit=&gt;save=&gt;close Workbook B</code>, Workbook B will open by itself even after it is closed.</p>\n\n<p>After doing much research and trial and error by trying to use Public variables and Referencing VBA project, I settled on <code>Application.OnTime</code> using the resource below:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/OnTime.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/OnTime.aspx</a></p>\n\n<p>Below is a sample of my code.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nCall StopTimer\n\nEnd Sub\n\nPrivate Sub Workbook_Open()\n\nCall StartTimer\n\nEnd Sub\n\n\n\nPublic RunWhen As Double\nPublic Const cRunWhat = \"Change_File_Access\"\nPublic Const cRunIntervalSeconds = 15\nPublic DatabaseWB As Workbook\n\nSub StartTimer()\n\nRunWhen = Now + TimeSerial(0, 0, cRunIntervalSeconds)\nApplication.OnTime EarliestTime:=RunWhen, Procedure:=cRunWhat, _\n    Schedule:=True\n\nEnd Sub\n\nSub StopTimer()\n\nMsgBox RunWhen\nOn Error Resume Next\nApplication.OnTime EarliestTime:=RunWhen, Procedure:=cRunWhat, _\n    Schedule:=False\n\nEnd Sub\n\nSub Change_File_Access()\n\nIf Not Workbooks(\"WorkbookB.xlsm\").ReadOnly Then Workbooks(\"WorkbookB.xlsm\").ChangeFileAccess xlReadOnly\nMsgBox \"This file is set as Read-Only\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "sharepoint", "sharepoint-2010"], "comments": [{"owner": {"reputation": 660, "user_id": 4744219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IaL3b.jpg?s=128&g=1", "display_name": "Arcan.NET", "link": "https://stackoverflow.com/users/4744219/arcan-net"}, "edited": false, "score": 0, "creation_date": 1450831789, "post_id": 34426154, "comment_id": 56595151, "body": "Visual Studio is completely out of the question?  You can make some very nice Access like applications that can work seamlessly with SharePoint using some relatively simple code these days.  There are OData and VBA methodologies for working with SharePoint in Access, but there are limitations and problems to that approach.  This is a good place to start if that&#39;s all you can do tho:  <a href=\"http://stackoverflow.com/questions/14399050/access-sharepoint-library-through-microsoft-access?rq=1\" title=\"access sharepoint library through microsoft access\">stackoverflow.com/questions/14399050/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3411, "user_id": 1595350, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/71f08ffccf9fa18d45ace1b1f984335c?s=128&d=identicon&r=PG", "display_name": "STORM", "link": "https://stackoverflow.com/users/1595350/storm"}, "is_accepted": false, "score": 0, "last_activity_date": 1450859183, "creation_date": 1450859183, "answer_id": 34431461, "question_id": 34426154, "link": "https://stackoverflow.com/questions/34426154/what-is-the-best-way-to-work-with-access-and-sharepoint/34431461#34431461", "title": "What is the best way to work with Access and SharePoint?", "body": "<p>You have two options:</p>\n\n<p>1) You can create a database with Microsoft Access and publish it to Microsoft SharePoint 2010 using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff402351(v=office.14).aspx\" rel=\"nofollow\">Access Services</a></p>\n\n<p>2) You can create Sharepoint Lists and link them in Microsoft Access and work with them like tables and use VBA inside Microsoft Access</p>\n"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450859183, "creation_date": 1450826807, "question_id": 34426154, "link": "https://stackoverflow.com/questions/34426154/what-is-the-best-way-to-work-with-access-and-sharepoint", "title": "What is the best way to work with Access and SharePoint?", "body": "<p>I'm a contractor currently working with the DOD. I work primarily with VBA and Microsoft Office (2013) to produce \"Desktop Tools\" because this is the level of scope in the culture here.  Rarely are the clients accessing their products from a fully integrated system that connects all of their data. One reason for this are the many disparate systems that require username and password to get and collect data.  So office products like MS Access, Excel and PowerPoint are the meat and potatoes of their reporting and dashboards.  There has been a second life to a career using only VBA which I thought was long gone.  My facility uses SharePoint 2010 and often want to see their products, like a \"Desktop Access database with user security implemented\" - on SharePoint. We often turn to PowerPoint to meet that need, but it is not as robust and requires a lot of manual intervention, and since many of the front end interfaces that I have built have complex form validation as well as comprehensive report views it seems to leave a lot to be considered. </p>\n\n<p>I've only worked with Visual Studio between 2005 - 2009 and I know a lot has changed.  I know SharePoint has also evolved extensively.  </p>\n\n<p>I have also heard about InfoPath, but read that I need Visual Studio if I want true control especially with data input. I have also considered the Web App component in MS Access but have many security limitations on that side that I have never considered going through with them.  What are my options with SharePoint 2010 and Desktop MS Access that have all the bells and whistles available to me in VBA if I don't have access to Visual Studio or anything else besides VBA?      </p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1450824810, "post_id": 34425584, "comment_id": 56593076, "body": "What database are you using? MySQL or Access?"}, {"owner": {"reputation": 260, "user_id": 343600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85143a143a603454eea6e6bf273e54ce?s=128&d=identicon&r=PG", "display_name": "Jan Steinman", "link": "https://stackoverflow.com/users/343600/jan-steinman"}, "edited": false, "score": 0, "creation_date": 1450829530, "post_id": 34425584, "comment_id": 56594595, "body": "If you have the freedom to choose databases, MariaDB (a MySQL fork) will allow you to to VIRTUAL columns that will automagically maintain inter-field relationships. I do something very similar in a labour-logging table, where the DATETIME out minus the DATETIME in automagically sets the value of the HOURS field."}, {"owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "edited": false, "score": 0, "creation_date": 1450829722, "post_id": 34425584, "comment_id": 56594638, "body": "I&#39;m using access 2013...so could you help with it? Can we use any udf?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "edited": false, "score": 0, "creation_date": 1450868066, "post_id": 34431561, "comment_id": 56608829, "body": "And how will I use this function in my query.?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1450873004, "post_id": 34431561, "comment_id": 56611812, "body": "They will also need the code for your <code>Years()</code> function."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450874936, "post_id": 34431561, "comment_id": 56612952, "body": "@HansUp: Oops, thanks. I&#39;ve added it, though probably not of much use in this context."}, {"owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "edited": false, "score": 0, "creation_date": 1450898589, "post_id": 34431561, "comment_id": 56626372, "body": "@Gustav Thanks!!! <code>FormatYearDayHourMinuteSecondDiff</code>is working. tk you for the help."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1450874879, "last_edit_date": 1450874879, "creation_date": 1450859671, "answer_id": 34431561, "question_id": 34425584, "link": "https://stackoverflow.com/questions/34425584/update-column-c-with-the-difference-of-column-a-b-timevalue/34431561#34431561", "title": "Update Column C with the difference of Column A &amp; B (Timevalue)", "body": "<p>Use a function like this:</p>\n\n<pre><code>Public Function FormatYearDayHourMinuteSecondDiff( _\n  ByVal datTimeStart As Date, _\n  ByVal datTimeEnd As Date, _\n  Optional ByVal strSeparatorDate As String = \" \", _\n  Optional ByVal strSeparatorTime As String = \":\") _\n  As String\n\n' Returns count of years, days, hours, minutes and seconds of difference\n' between datTimeStart and datTimeEnd converted to\n' years, days, hours and minutes and seconds as a formatted string\n' with an optional choice of date and/or time separator.\n'\n' Should return correct output for a negative time span but\n' this is not fully tested.\n'\n' Example:\n'   datTimeStart: #2006-05-24 10:03:02#\n'   datTimeEnd  : #2009-04-17 20:01:18#\n'   returns     : 2 328 09:58:16\n'\n' 2007-11-06. Cactus Data ApS, CPH.\n\n  Const cintSecondsHour As Integer = 60&amp; * 60&amp;\n\n  Dim intYears      As Integer\n  Dim intDays       As Integer\n  Dim intSeconds    As Integer\n  Dim intHours      As Integer\n  Dim datTime       As Date\n  Dim strDatePart   As String\n  Dim strTimePart   As String\n  Dim strYDHMS      As String\n\n  intYears = Years(datTimeStart, datTimeEnd)\n  datTimeStart = DateAdd(\"yyyy\", intYears, datTimeStart)\n  intDays = DateDiff(\"h\", datTimeStart, datTimeEnd) \\ 24\n  datTimeStart = DateAdd(\"d\", intDays, datTimeStart)\n  intHours = DateDiff(\"h\", datTimeStart, datTimeEnd)\n  datTimeStart = DateAdd(\"h\", intHours, datTimeStart)\n  intSeconds = DateDiff(\"s\", datTimeStart, datTimeEnd)\n\n  ' Format year and day part.\n  strDatePart = CStr(intYears) &amp; strSeparatorDate &amp; CStr(intDays)\n  datTime = TimeSerial(intHours, 0, intSeconds Mod cintSecondsHour)\n  ' Format hour, minute and second part.\n  strTimePart = Format(datTime, \"hh\\\" &amp; strSeparatorTime &amp; \"nn\\\" &amp; strSeparatorTime &amp; \"ss\")\n  strYDHMS = strDatePart &amp; \" \" &amp; IIf(datTime &lt; 0, \"-\", \"\") &amp; strTimePart\n\n  FormatYearDayHourMinuteSecondDiff = strYDHMS\n\nEnd Function\n</code></pre>\n\n<p>Just modify <code>strDatePart</code> and <code>strTimePart</code> to fit your need.</p>\n\n<p>Then in your query:</p>\n\n<pre><code>NewOpen_Time: FormatYearDayHourMinuteSecondDiff([New],[Opened])\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>The calculation of years you can just remove, as I guess it will not be relevant here, or you can use this function:</p>\n\n<pre><code>' Returns the difference in full years between Date1 and Date2.\n'\n' Calculates correctly for:\n'   negative differences\n'   leap years\n'   dates of 29. February\n'   date/time values with embedded time values\n'   any date/time value of data type Date\n'\n' Optionally returns negative counts rounded down to provide a\n' linear sequence of year counts.\n' For a given Date1, if Date2 is decreased stepwise one year from\n' returning a positive count to returning a negative count, one or two\n' occurrences of count zero will be returned.\n' If LinearSequence is False, the sequence will be:\n'   3, 2, 1, 0,  0, -1, -2\n' If LinearSequence is True, the sequence will be:\n'   3, 2, 1, 0, -1, -2, -3\n'\n' If LinearSequence is False, reversing Date1 and Date2 will return\n' results of same absolute Value, only the sign will change.\n' This behaviour mimics that of Fix().\n' If LinearSequence is True, reversing Date1 and Date2 will return\n' results where the negative count is offset by -1.\n' This behaviour mimics that of Int().\n\n' DateAdd() is used for check for month end of February as it correctly\n' returns Feb. 28th when adding a count of years to dates of Feb. 29th\n' when the resulting year is a common year.\n'\n' 2015-11-24. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function Years( _\n    ByVal Date1 As Date, _\n    ByVal Date2 As Date, _\n    Optional ByVal LinearSequence As Boolean) _\n    As Long\n\n    Dim YearCount   As Long\n    Dim DayCount    As Long\n\n    DayCount = DateDiff(\"d\", Date1, Date2)\n\n    If DayCount = 0 Then\n        ' The dates are equal.\n    Else\n        ' Find difference in calendar years.\n        YearCount = DateDiff(\"yyyy\", Date1, Date2)\n        ' For positive resp. negative intervals, check if the second date\n        ' falls before, on, or after the crossing date for a 1 year period\n        ' while at the same time correcting for February 29. of leap years.\n        If DayCount &gt; 0 Then\n            If DateDiff(\"d\", DateAdd(\"yyyy\", YearCount, Date1), Date2) &lt; 0 Then\n                YearCount = YearCount - 1\n            End If\n        Else\n            If DateDiff(\"d\", DateAdd(\"yyyy\", -YearCount, Date2), Date1) &lt; 0 Then\n                YearCount = YearCount + 1\n            End If\n            ' Offset negative count of years to continuous sequence if requested.\n            If LinearSequence = True Then\n                YearCount = YearCount - 1\n            End If\n        End If\n    End If\n\n    ' Return count of years as count of full year periods.\n    Years = YearCount\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5636933, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bd84117bbb64bbfd16597b2b0ea6afa3?s=128&d=identicon&r=PG&f=1", "display_name": "Akkitech", "link": "https://stackoverflow.com/users/5636933/akkitech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 34431561, "answer_count": 1, "score": 0, "last_activity_date": 1450874879, "creation_date": 1450823725, "last_edit_date": 1450847840, "question_id": 34425584, "link": "https://stackoverflow.com/questions/34425584/update-column-c-with-the-difference-of-column-a-b-timevalue", "title": "Update Column C with the difference of Column A &amp; B (Timevalue)", "body": "<p>I'm looking for <code>UPDATE</code> query to update 3rd column with the difference of first two column. Below is my data.</p>\n\n<pre><code>Table name - Report\n\nField Name - Data Type\n--------------------\nNew           - Date/Time\nOpened        - Date/Time\nNewOpen_Time  - Date/Time\n</code></pre>\n\n<p><code>NewOpen_Time</code> is to be updated with the difference of <code>Opened - NEW</code>.</p>\n\n<p>Both the columns contains data in below format</p>\n\n<p><code>New = 11/18/2015 4:42:46 AM</code></p>\n\n<p><code>Opened = 11/18/2015 4:51:22 AM</code></p>\n\n<p>and I want column <code>NewOpen_Time</code> to be updated in below format.</p>\n\n<p><code>NewOpen_Time = 0 days, 0 hrs, 8 mins, 36 secs</code></p>\n\n<p>Any help would be highly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 52, "user_id": 5708261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abd7b2b8ce5e97330950c6b6e467ac?s=128&d=identicon&r=PG&f=1", "display_name": "pengdiddy", "link": "https://stackoverflow.com/users/5708261/pengdiddy"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450822664, "post_id": 34425326, "comment_id": 56592205, "body": "data and skuvp are defined as Worksheets. They are set as follows: Set data = Workbooks(&quot;weekly Brand snapshot report.xlsx&quot;).Sheets(&quot;SKU Data&quot;) and Set skuvp = Workbooks(&quot;weekly Brand snapshot report.xlsx&quot;).Sheets(&quot;SKU VP&quot;)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1450823244, "post_id": 34425326, "comment_id": 56592456, "body": "Try replacing <code>xlCellTypeVisible</code> with its converted value <code>12</code> so that the line reads <code>data.Range(&quot;B2:B16354&quot;).SpecialCells(12).Copy Destination:=skuvp.Range(&quot;N2&quot;)</code>  Do you get the same error if you do that?"}, {"owner": {"reputation": 52, "user_id": 5708261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abd7b2b8ce5e97330950c6b6e467ac?s=128&d=identicon&r=PG&f=1", "display_name": "pengdiddy", "link": "https://stackoverflow.com/users/5708261/pengdiddy"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1450823652, "post_id": 34425326, "comment_id": 56592624, "body": "@tigeravatar when I did your fix it had a different error. the error code says Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1450824627, "post_id": 34425326, "comment_id": 56593022, "body": "hmm... hard to tell if that&#39;s from your <code>data</code> worksheet or your <code>skuvp</code> worksheet because they&#39;re both used in that line of code.  Try introducing a new line of code to see if it runs or not, it&#39;s just a check for the range address generated by the specialcells: <code>MsgBox data.Range(&quot;B2:B16354&quot;).SpecialCells(12).Address</code> and see if you get the new error or if it shows a messagebox with the <i>expected</i> address"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 1, "creation_date": 1450824994, "post_id": 34425326, "comment_id": 56593142, "body": "Is there always visible data when <code>SpecialCells(xlCellTypeVisible)</code> is invoked?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450825354, "post_id": 34425326, "comment_id": 56593271, "body": "@Demetri I thought about that but given 16353 rows...pretty sad not to have at least <i>one</i> XD"}, {"owner": {"reputation": 52, "user_id": 5708261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abd7b2b8ce5e97330950c6b6e467ac?s=128&d=identicon&r=PG&f=1", "display_name": "pengdiddy", "link": "https://stackoverflow.com/users/5708261/pengdiddy"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450826699, "post_id": 34425326, "comment_id": 56593733, "body": "@Demetri the code that is triggering the error has over 9000 rows still visible at that point"}, {"owner": {"reputation": 52, "user_id": 5708261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abd7b2b8ce5e97330950c6b6e467ac?s=128&d=identicon&r=PG&f=1", "display_name": "pengdiddy", "link": "https://stackoverflow.com/users/5708261/pengdiddy"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1450828878, "post_id": 34425326, "comment_id": 56594426, "body": "@tigeravatar the msgbox code ran fine and displayed the ranges that were still visible."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1450831218, "post_id": 34425326, "comment_id": 56595004, "body": "@pengdiddy, try: <code>data.Range(&quot;B2:B16354&quot;).SpecialCells(12).Cells.Copy</code> ."}, {"owner": {"reputation": 52, "user_id": 5708261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abd7b2b8ce5e97330950c6b6e467ac?s=128&d=identicon&r=PG&f=1", "display_name": "pengdiddy", "link": "https://stackoverflow.com/users/5708261/pengdiddy"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1450893920, "post_id": 34425326, "comment_id": 56624098, "body": "@fadi your code seems to have done the trick. I&#39;ve ran it multiple times trying to trigger the error and it hasn&#39;t had an issue. Thank you everyone for your help."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450927903, "post_id": 34425326, "comment_id": 56635768, "body": "@pengdiddy, You are welcome, happy that helps."}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 0, "last_activity_date": 1450928443, "last_edit_date": 1450928443, "creation_date": 1450927693, "answer_id": 34446874, "question_id": 34425326, "link": "https://stackoverflow.com/questions/34425326/unable-to-get-the-specialcells-property-of-the-range-class-for-xlcelltypevisible/34446874#34446874", "title": "unable to get the Specialcells property of the range class for xlcelltypevisible", "body": "<p>So, from comments it seems that the problem is solved by using <code>.Cells</code> :</p>\n\n<pre><code>data.Range(\"B2:B16354\").SpecialCells(xlCellTypeVisible).Cells.Copy Destination:=skuvp.Range(\"N2\")\n</code></pre>\n"}], "owner": {"reputation": 52, "user_id": 5708261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abd7b2b8ce5e97330950c6b6e467ac?s=128&d=identicon&r=PG&f=1", "display_name": "pengdiddy", "link": "https://stackoverflow.com/users/5708261/pengdiddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5954, "favorite_count": 0, "accepted_answer_id": 34446874, "answer_count": 1, "score": 4, "last_activity_date": 1450928443, "creation_date": 1450822458, "last_edit_date": 1450822837, "question_id": 34425326, "link": "https://stackoverflow.com/questions/34425326/unable-to-get-the-specialcells-property-of-the-range-class-for-xlcelltypevisible", "title": "unable to get the Specialcells property of the range class for xlcelltypevisible", "body": "<p>I have an Excel VBA macro that I run once a week. I have a piece of code that filters out for different data and then copies the remaining cells to a different worksheet</p>\n\n<p>Here is the portion of effected code:</p>\n\n<pre><code>dim data as worksheet\ndim sku vp as worksheet\nSet skuvp = Workbooks(\"weekly Brand snapshot report.xlsx\").Sheets(\"SKU VP\")\nset data = Workbooks(\"weekly Brand snapshot report.xlsx\").Sheets(\"SKU Data\")\n\ndata.Range(\"A1\").AutoFilter Field:=4, Criteria1:=\"Foods\", Operator:=xlFilterValues\ndata.Range(\"Onsales[[Product]]\").SpecialCells(xlCellTypeVisible).Copy Destination:=skuvp.Range(\"B2\")\nskuvp.Range(\"foods\").Sort key1:=skuvp.Range(\"C1\"), order1:=xlDescending, Header:=xlYes\ndata.ShowAllData\n\ndata.Range(\"A1\").AutoFilter Field:=4, Criteria1:=\"Treats\", Operator:=xlFilterValues\ndata.Range(\"Onsales[[Product]]\").SpecialCells(xlCellTypeVisible).Copy Destination:=skuvp.Range(\"H2\")\nskuvp.Range(\"treats\").Sort key1:=skuvp.Range(\"I1\"), order1:=xlDescending, Header:=xlYes\ndata.ShowAllData\n\ndata.Range(\"A1\").AutoFilter Field:=3, Criteria1:=\"Hardgoods\", Operator:=xlFilterValues\ndata.Range(\"B2:B16354\").SpecialCells(xlCellTypeVisible).Copy Destination:=skuvp.Range(\"N2\")\nskuvp.Range(\"hard\").Sort key1:=skuvp.Range(\"O1\"), order1:=xlDescending, Header:=xlYes\ndata.ShowAllData\n\ndata.Range(\"A1\").AutoFilter Field:=3, Criteria1:=\"Specialty\", Operator:=xlFilterValues\ndata.Range(\"B2:B16354\").SpecialCells(xlCellTypeVisible).Copy Destination:=skuvp.Range(\"T2\")\nskuvp.Range(\"spcl\").Sort key1:=skuvp.Range(\"U1\"), order1:=xlDescending, Header:=xlYes\ndata.ShowAllData\n</code></pre>\n\n<p>Data and skuvp are set as worksheets. </p>\n\n<p>This code ran fine the very first time I ran it.  However, it began having an error after that. The error appears on this line:</p>\n\n<pre><code>data.Range(\"B2:B16354\").SpecialCells(xlCellTypeVisible).Copy Destination:=skuvp.Range(\"N2\")\n</code></pre>\n\n<p>The error it gives is \"Unable to get the Specialcells property of the range class.\"</p>\n\n<p>I originally had the range in that code set the table column \"Onsales[[Product]]\" as the range like the previous 2 times I used the code but changed it to a set range to see if that would fix the issue. </p>\n\n<p>Why is this code having an error on that line when the same basic code works a few lines earlier? </p>\n\n<p>I've searched stackoverflow and other online sources for a solution without success. </p>\n"}, {"tags": ["vba", "email", "outlook", "dismiss", "reminders"], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1450831788, "post_id": 34426844, "comment_id": 56595150, "body": "If this is the answer, do not accept. Delete the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5708954"}, "edited": false, "score": 0, "creation_date": 1450847143, "post_id": 34426844, "comment_id": 56598961, "body": "That doesn&#39;t seem to apply here -- basically, the script is supposed to convert ANY triggered reminder to e-mail, so I&#39;m not seeking to test based on a caption."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1450848177, "post_id": 34426844, "comment_id": 56599294, "body": "The answer is really the same. You are processing the first reminder found then Exiting. To process every reminder drop the Exit For. I think though you will have to figure out how to identify the reminder that triggers each email and cancel only that one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5708954"}, "edited": false, "score": 0, "creation_date": 1450880086, "post_id": 34426844, "comment_id": 56615944, "body": "How is for each reminder in Outlook.Reminders processing only the first one?"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1450831049, "last_edit_date": 1495535493, "creation_date": 1450831049, "answer_id": 34426844, "question_id": 34425028, "link": "https://stackoverflow.com/questions/34425028/outlook-reminders-to-e-mail-script-but-cant-dismiss/34426844#34426844", "title": "Outlook Reminders to E-Mail Script -- But Can&#39;t Dismiss", "body": "<p>You are looking at the first found reminder then quitting with</p>\n\n<pre><code>Exit For\n</code></pre>\n\n<p>As in the example you found <a href=\"https://stackoverflow.com/questions/13283989/dismiss-outlook-reminder\">Dismiss Outlook reminder</a> you will need something like</p>\n\n<pre><code>For Each objRem In objRems\n    If objRem.Caption = \"TESTING\" Then ' &lt;--\n        If objRem.IsVisible Then\n            objRem.Dismiss\n        End If\n        Exit For\n    End If\nNext objRem\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1450986803, "creation_date": 1450986803, "answer_id": 34457348, "question_id": 34425028, "link": "https://stackoverflow.com/questions/34425028/outlook-reminders-to-e-mail-script-but-cant-dismiss/34457348#34457348", "title": "Outlook Reminders to E-Mail Script -- But Can&#39;t Dismiss", "body": "<p>Cancel parameter in the BeforeReminderShow event handler needs to be <code>ByRef</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5708954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 34426844, "answer_count": 2, "score": 0, "last_activity_date": 1450986803, "creation_date": 1450821102, "last_edit_date": 1495542864, "question_id": 34425028, "link": "https://stackoverflow.com/questions/34425028/outlook-reminders-to-e-mail-script-but-cant-dismiss", "title": "Outlook Reminders to E-Mail Script -- But Can&#39;t Dismiss", "body": "<p>I have looked into previous answers and tried many variations on the below, but I cannot seem to get it to work.</p>\n\n<p>Basically, the purpose of the script below is to turn Outlook reminders into e-mail messages.</p>\n\n<p>However, I cannot seem to programmatically dismiss the reminders.  I've looked into prior answers to these questions (such as <a href=\"https://stackoverflow.com/questions/13283989/dismiss-outlook-reminder\">this one</a>) and attempted to implement them, but they don't seem to succeed in this configuration.</p>\n\n<pre><code>' declare this object withEvents displaying all the events\nPrivate WithEvents olRemind As Outlook.Reminders\nPrivate Sub Application_Reminder(ByVal Item As Object)\n  Dim objMsg As MailItem\n  Dim objRem As Reminder\n  Dim olRemind As Reminders\n  Set olRemind = Outlook.Reminders\n  Set objMsg = Application.CreateItem(olMailItem)\n  objMsg.To = \"*ADDRESS REMOVED FROM EXAMPLE*\"\n  objMsg.subject = \"MHReminder: \" + Item.subject\n  objMsg.Body = Item.Body\n  Set objMsg.SaveSentMessageFolder = Session.GetDefaultFolder(olFolderDeletedItems)\n  objMsg.Send\n  Set objMsg = Nothing\nEnd Sub\n\nPrivate Sub olRemind_BeforeReminderShow(Cancel As Boolean)\n\n    For Each objRem In olRemind\n        If objRem.IsVisible = True Then\n            objRem.Dismiss\n            Cancel = True\n        End If\n    Exit For\n    Next objRem\n\nEnd Sub\n</code></pre>\n\n<p>I'm a bit more of a \"kludge-and-splice\" programmer than a true programmer, so would appreciate anyone pointing out my (hopefully obvious) errors.</p>\n\n<p>Thank you ...</p>\n"}, {"tags": ["vba", "automation", "avaya"], "comments": [{"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "reply_to_user": {"reputation": 230, "user_id": 5543713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04843317cc517d62d219e6f09ce81911?s=128&d=identicon&r=PG&f=1", "display_name": "Rhubenni Telesco", "link": "https://stackoverflow.com/users/5543713/rhubenni-telesco"}, "edited": false, "score": 0, "creation_date": 1457708793, "post_id": 34424835, "comment_id": 59543415, "body": "I have not actually solved the problem.   I have worked around it thus far, but would really love to have a more permanent solution.   I have found that if I run 3 days worth or reports, exit Excel and exit Avaya, then reopen Avaya, sign back in, then reopen Excel, I can repeat this process over and over.   Still, not quite what I want.   I tried to move the loop in so that I could reuse the same objects without constantly creating and destroying the objects, but then it would only spit out a maximum of 4 results or sometimes 12 and I could not figure out why for the life of me."}, {"owner": {"reputation": 230, "user_id": 5543713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04843317cc517d62d219e6f09ce81911?s=128&d=identicon&r=PG&f=1", "display_name": "Rhubenni Telesco", "link": "https://stackoverflow.com/users/5543713/rhubenni-telesco"}, "edited": false, "score": 0, "creation_date": 1458048913, "post_id": 34424835, "comment_id": 59677061, "body": "I also tried it, I have a loop that opens and closes the CMS every 10 interactions, managed to keep a reasonable stability, however still hangs sometimes =( . (Sorry for the poorly english)"}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "reply_to_user": {"reputation": 230, "user_id": 5543713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04843317cc517d62d219e6f09ce81911?s=128&d=identicon&r=PG&f=1", "display_name": "Rhubenni Telesco", "link": "https://stackoverflow.com/users/5543713/rhubenni-telesco"}, "edited": false, "score": 0, "creation_date": 1458050152, "post_id": 34424835, "comment_id": 59678002, "body": "When you say you open and close the CMS every 10 interactions, do you mean the CMS server, application. connection or all of them?   Would it be possible for you to share your code (removing your personal info like username and password, of course)?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1552293480, "post_id": 34424835, "comment_id": 96938947, "body": "@Fred if you are still in need of this I could give you some piece of my code that works this out."}], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 860, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1450820284, "creation_date": 1450820284, "question_id": 34424835, "link": "https://stackoverflow.com/questions/34424835/cms-automation-in-vba-stalls-after-63-iterations", "title": "CMS automation in VBA stalls after 63 iterations", "body": "<p>I am writing an automation script as I have a need to run a report on 16 separate split skills each day for a period of 6 months.  The script works, with one problem.   It will run 63 iterations (i.e. 3 days at 16 = 48 + 15 = 63).   After the 15th loop (63rd overall iteration) it will give an error: \"microsoft excel is waiting for another application to complete an OLE action\"   It would appear to me, though I could very easily be wrong, that either I am overloading a variable or possibly not fully closing something on the CMS side.   The fact that it is the 63rd iteration (64-1) seems awfully suspicious, but I am not sure what I could be overloading as far as variables going.   I don't have any 8-bit variables (unless I am missing something).  Also, I should point out that after running the macro, I am uanble to log back into the CMS app manually without restarting, so my hunch is that I am not fully closing something and that maybe there is a limit on the number of instances allowed in CMS.   I included the script below, except that the names of the skills, server address, username and password have been removed for security reasons.  Any help would be greatly appreciated.   </p>\n\n<pre><code>Public Sub Single_CMS_Report_Extract()\n\nOn Error Resume Next\n\n' Add the files specified below to the References section:\n' Tools -&gt; References -&gt; Browse to the CMS directory,\n' e.g.: \"C:\\Program Files\\Avaya\\CMS Supervisor R14\"\nDim cmsApplication As ACSUP.cvsApplication 'acsApp.exe\nDim cmsServer As ACSUPSRV.cvsServer 'acsSRV.exe\nDim cmsConnection As ACSCN.cvsConnection 'cvsconn.dll\nDim cmsCatalog As ACSCTLG.cvsCatalog 'cvsctlg.dll\nDim cmsReport As Object 'ACSREP.cvsReport 'acsRep.exe\n\nDim myLog As String, myPass As String, myServer As String\nDim reportPath As String, reportName As String, reportPrompt(1 To 2, 1 To 3) As String\nDim exportPath As String, exportName As String\n\nDim StartRunTime, EndRunTime As Date\n\nDim DayToRun, EndDate As Date\nDim Skill(1 To 16) As String\n\nMsgBox (\"Please ensure CMS open and logged in prior to continuing\")\nStartRunTime = Now\n\n'Start Date\nDayToRun = \"12/16/2015\"\n'End Date\nEndDate = \"12/21/2015\"\n\n\n\nSkill(1) = \"XXXXXXXX\"\nSkill(2) = \"XXXXXXXX\"\nSkill(3) = \"XXXXXXXX\"\nSkill(4) = \"XXXXXXXX\"\nSkill(5) = \"XXXXXXXX\"\nSkill(6) = \"XXXXXXXX\"\nSkill(7) = \"XXXXXXXX\"\nSkill(8) = \"XXXXXXXX\"\nSkill(9) = \"XXXXXXXX\"\nSkill(10) = \"XXXXXXXX\"\nSkill(11) = \"XXXXXXXX\"\nSkill(12) = \"XXXXXXXX\"\nSkill(13) = \"XXXXXXXX\"\nSkill(14) = \"XXXXXXXX\"\nSkill(15) = \"XXXXXXXX\"\nSkill(16) = \"XXXXXXXX\"\n\nWhile DayToRun &lt; (EndDate + 1)\n\n\n\n\n    For i = 1 To 16\n\n        ' Assigns Variables\n        myLog = \"myuser\"\n        myPass = \"mypass\"\n        myServer = \"xx.xx.xx.xx\"\n        'reportPath is the tab and \"Category\" that the report is found in Avaya\n        reportPath = \"Historical\\Split/Skill\\\"\n        reportName = \"Summary Interval\"\n\n        'list of input names requested.....\n        reportPrompt(1, 1) = \"Split/Skill\"\n        reportPrompt(1, 2) = \"Date\"\n        reportPrompt(1, 3) = \"Times\"\n\n        'list of responses being used for input\n        reportPrompt(2, 1) = Skill(i)\n        reportPrompt(2, 2) = DayToRun\n        reportPrompt(2, 3) = \"00:00-23:30\"\n\n        'path and name of exported report file\n        exportPath = \"H:\\Avaya data\\\"\n        If i &lt;&gt; 5 Then\n            exportName = Month(DayToRun) &amp; \"-\" &amp; Day(DayToRun) &amp; \"-\" &amp; Skill(i) &amp; \".csv\"\n        Else\n            exportName = Month(DayToRun) &amp; \"-\" &amp; Day(DayToRun) &amp; \"- DL-Toll Free\" &amp; \".csv\"\n        End If\n\n        ' Open the CMS Application, launches acsApp.exe\n        ' If a CMS Supervisor console is already open,\n        ' the existing acsApp.exe is used.\n        Set cmsApplication = CreateObject(\"ACSUP.cvsApplication\")\n        Set cmsServer = CreateObject(\"ACSUPSRV.cvsServer\")\n        Set cmsConnection = CreateObject(\"ACSCN.cvsConnection\")\n        cmsConnection.bAutoRetry = True\n\n        ' Connetsc to the server, launches acsSRV.exe &amp; ACSTrans.exe (2x)\n        If cmsApplication.CreateServer(myLog, myPass, \"\", myServer, False, \"ENU\", cmsServer, cmsConnection) Then\n        If cmsConnection.login(myLog, myPass, myServer, \"ENU\", \"\", False) Then\n        End If\n        End If\n\n        ' Gets collection of Reports available on cmsServer\n        Set cmsCatalog = cmsServer.Reports\n        If cmsServer.Connected = False Then cmsServer.Reports.ACD = 1\n\n        ' Sets parameters for report, launches ACSRep.exe (2x)\n        cmsCatalog.CreateReport cmsCatalog.Reports.Item(reportPath &amp; reportName), cmsReport\n\n\n\n        If cmsReport.SetProperty(reportPrompt(1, 1), reportPrompt(2, 1)) And cmsReport.SetProperty(reportPrompt(1, 2), reportPrompt(2, 2)) And cmsReport.SetProperty(reportPrompt(1, 3), reportPrompt(2, 3)) Then\n        End If\n\n        ' Runs report and extracts results  --- the 44 is the field delimiter\n        cmsReport.ExportData exportPath &amp; exportName, 44, 0, False, False, True\n\n\n        ' Kills active report &amp; server\n        If Not cmsServer.Interactive Then\n        cmsServer.ActiveTasks.Remove cmsReport.TaskID\n        cmsApplication.Servers.Remove cmsServer.ServerKey\n        End If\n\n        ' Logs out\n        cmsReport.Quit\n        cmsConnection.Logout\n        cmsConnection.Disconnect\n        cmsServer.Connected = False\n\n        ' Releases objects\n        Set cmsReport = Nothing\n        Set cmsCatalog = Nothing\n        Set cmsConnection = Nothing\n        Set cmsServer = Nothing\n        Set cmsApplication = Nothing\n\n\n    Next\n    i = Nothing\n    DayToRun = DateAdd(\"d\", 1, DayToRun)\n    Wend\n\nEndRunTime = Now\nMsgBox (\"Run-time = \" &amp; Minute(EndRunTime - StartRunTime) &amp; \":\" &amp; Second(EndRunTime - StartRunTime))\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "find", "vba"], "comments": [{"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1450820453, "post_id": 34424585, "comment_id": 56591307, "body": "The first bit of your script works - I&#39;ve translated it into something else with the same structure and it works.  What do you mean when you say &quot;it doesn&#39;t work&quot;? You get an error message? I fyou debug.print rFoundCell after the search (or better yet, watch it in the locals) what happens? Does it actually find something or not? The problem is in your FIND, not with the is nothing part.  You would make the syntax simpler by doing &quot;If rFounCell is nothing then (...) &quot; instead of a double negation like you have now..."}, {"owner": {"reputation": 147, "user_id": 5692872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee51bdd7cc5ba9356aef4d7070e3dfd?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaLlama", "link": "https://stackoverflow.com/users/5692872/ninjallama"}, "edited": false, "score": 0, "creation_date": 1450820823, "post_id": 34424585, "comment_id": 56591468, "body": "I think that it skips the error box because it exits the <code>For lLoop=1 to...</code> if it does not find a match so it skips the line where you say <code>Else MsgBox (rValue.Value &amp; &quot; not found.&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 5692872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee51bdd7cc5ba9356aef4d7070e3dfd?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaLlama", "link": "https://stackoverflow.com/users/5692872/ninjallama"}, "is_accepted": false, "score": 1, "last_activity_date": 1450821519, "creation_date": 1450821519, "answer_id": 34425125, "question_id": 34424585, "link": "https://stackoverflow.com/questions/34424585/error-capture-while-using-find-is-not-identifing-error/34425125#34425125", "title": "Error capture while using .Find is not identifing error", "body": "<p>I believe that your code is skipping the If statement that generates the error box if there is not a match.</p>\n\n<p>This is due to <code>For lLoop = 1 To WorksheetFunction.CountIf(.Cells, rValue.Value)</code> exiting when there is no matches because it equates to <code>For lLoop = 1 To 0</code> </p>\n\n<p>I moved all of your error message code into an If statement above the lLoop as follows:</p>\n\n<pre><code>    If WorksheetFunction.CountIf(.Cells, rValue.Value) = 0 Then\n        MsgBox (rValue.Value &amp; \" not found.\")\n        GoTo end_search\n    End If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450821519, "creation_date": 1450819174, "last_edit_date": 1531164843, "question_id": 34424585, "link": "https://stackoverflow.com/questions/34424585/error-capture-while-using-find-is-not-identifing-error", "title": "Error capture while using .Find is not identifing error", "body": "<p>When .Find does not find a result, I want an error msg.  I have used the method that is almost universally recommended online, but it is not working.  When a value is not found, nothing happens.  There should be a msg box identified the error.</p>\n\n<pre><code>If Not rFoundCell Is Nothing Then\n  MsgBox \"val: \" &amp; rValue.Value &amp; \"   Matching Cell: \" &amp;     rFoundCell.Address\n  Cells(Range(rFoundCell.Address).Row,     Range(rFoundCell.Address).Column).Select\nElse\n   MsgBox (rValue.Value &amp; \" not found.\")\n   GoTo end_search\nEnd If  \n</code></pre>\n\n<p>I've tried the other way as well:<br>\n<code>If rFoundCell Is Nothing Then</code><br>\n   Display a msg \"not found\"<br>\n<code>else</code><br>\n  Keep going.<br>\nThat didn't work either.  What am i missing?<br>\nFull code follows:  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim PostRng As Range\nDim PendRng As Range\nDim rValue As Range\nDim lLoop As Long\nDim rFoundCell As Range\nDim INTRng As Range\n\nSet PostRng = Range(\"g:g\")\nSet PendRng = Range(\"k:k\")\n\n'\"Intersect\" will ensure your current cell lies on correct column.\nSet INTRng = Intersect(Target, PostRng)\n\n'IF conditions to trigger code.\n'This IF confirms only one cell changed. -- I think\nIf Target.Columns.Count = 1 And Target.Rows.Count = 1 Then\n    If Not INTRng Is Nothing And LCase(Target.Text) = \"y\" Then\n'This block will return the range &amp; value on the row where \"y\" or \"Y\" are entered.\n        Set rValue = Target.Offset(0, -3)        'Returns value in Col D\n        If rValue = 0 Or rValue = \"\" Then Set rValue = Target.Offset(0, -2)\nDebug.Print \"Target \"; Target\nDebug.Print \"rvalue.value \"; rValue.Value\n\n'This will loop through a different column, to find the value identified above, and return its cell address in the other column.\n      With PendRng\n        Set rFoundCell = .Cells(1, 1)\n        For lLoop = 1 To WorksheetFunction.CountIf(.Cells, rValue.Value)\n            Set rFoundCell = .Find(What:=rValue.Value, _\n               After:=rFoundCell, _\n               LookIn:=xlValues, _\n               LookAt:=xlPart, _\n               SearchOrder:=xlByRows, _\n               SearchDirection:=xlNext, _\n               MatchCase:=False)\nDebug.Print \"rfoundcell \" &amp; rFoundCell\n        If Not rFoundCell Is Nothing Then\n            MsgBox \"val: \" &amp; rValue.Value &amp; \"   Matching Cell: \" &amp;     rFoundCell.Address\n'This will use the cell address identified above to move the active cell to that address.\n'Have to convert the address to row/column to use in Cell.Select.\n        Cells(Range(rFoundCell.Address).Row,     Range(rFoundCell.Address).Column).Select\n        Else\n            MsgBox (rValue.Value &amp; \" not found.\")\n            GoTo end_search\n        End If\n        Next lLoop\n        End With\n    End If\nEnd If\nend_search:\nEnd Sub\n</code></pre>\n\n<p>Received help w/ this code here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/30536810/execute-a-subroutine-when-a-user-enters-a-trigger-into-a-cell\">Execute a subroutine when a user enters a trigger into a cell</a></p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1450830083, "post_id": 34424584, "comment_id": 56594727, "body": "FYI, the documentation in MSDN for this was very tricky.  However, after looking through it and submitting an incomplete answer, I finally thought to use the recorder in Excel and then modify it for PowerPoint, which is where I found the final solution.  Worth knowing in case you have other similar issues in the future."}], "answers": [{"comments": [{"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1450865434, "post_id": 34426201, "comment_id": 56607185, "body": "Ok I will try the 2nd answer. Thanks"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 1, "last_activity_date": 1450829931, "last_edit_date": 1450829931, "creation_date": 1450827029, "answer_id": 34426201, "question_id": 34424584, "link": "https://stackoverflow.com/questions/34424584/powerpoint-vba-set-datarange-for-datalabels/34426201#34426201", "title": "Powerpoint VBA - Set DataRange for DataLabels", "body": "<p>****EDIT**** See other answer.  I am leaving this here because it provides some information about several objects that could be used, but doesn't actually solve the problem.</p>\n\n<p>This is not a complete answer to the issue, but this is too long for a comment.</p>\n\n<p>I've searched through the documentation for the Datalabels and was unable to figure out how to do this (I assume that you want to be able to define the range that the labels come from using VBA).  I was able to \"check\" the checkbox, but couldn't figure out where the range that is attached to it is.  The appropriate code to check.</p>\n\n<p>To check the checkbox, use this code:</p>\n\n<pre><code> myChart.SeriesCollection(i).ApplyDataLabels\n</code></pre>\n\n<p>where i is the series in question and myChart is a Chart object referencing your chart.  There are a bunch of parameters to this method that will allow you to show different items (percentages, values, etc.), but none of the parameters is a range.</p>\n\n<p>This defaults to the values of the series if you do not enter any of the optional parameters</p>\n\n<p>It is then possible to turn this on and off using:</p>\n\n<pre><code>myChart.SeriesCollection(i).DataLabels.ShowRange = True/False\n</code></pre>\n\n<p>It is possible to change the caption of the Datalabels using:</p>\n\n<pre><code>myChart.SeriesCollection(i).DataLabels(j).Caption = \"MY CAPTION\"\n</code></pre>\n\n<p>This will change the caption one at a time, and it will replace the value that the \"ApplyDataLabels\" method puts in there.  It would be possible to loop through the range to set the values, but this is likely not what you are looking for. </p>\n\n<p>There's also this:</p>\n\n<pre><code>myChart.SeriesCollection(i).HasDataLabels = True\n</code></pre>\n\n<p>but this just seems to turn them on and off and resets the captions that you may have put in there.</p>\n\n<p>MSDN link uses both the hasdatalabels property and the applydatalabels method, but it is not clear why they are using both: <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff745965.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/ff745965.aspx</a></p>\n\n<p>Hopefully this can at least give you something to start with.</p>\n"}, {"comments": [{"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1450865416, "post_id": 34426674, "comment_id": 56607172, "body": "Seems to be a great answer. I will try this in couple of hours. Thanks"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 2, "last_activity_date": 1450829891, "creation_date": 1450829891, "answer_id": 34426674, "question_id": 34424584, "link": "https://stackoverflow.com/questions/34424584/powerpoint-vba-set-datarange-for-datalabels/34426674#34426674", "title": "Powerpoint VBA - Set DataRange for DataLabels", "body": "<p>The code to accomplish this is as follows:</p>\n\n<pre><code>Dim myChart As Chart\nDim mySerCol As SeriesCollection\nDim strRange As String\n\nstrRange = \"=Sheet1!$F$2:$F$5\" 'To hold the range for the new labels\n\nSet myChart = ....[put in code to get the appropriate chart]\nSet mySerCol = myChart.SeriesCollection(i)\nmySerCol.ApplyDataLabels 'Turn on the datalabels for this series\n\n'The next line sets the range to get the values from\nmySerCol.Format.TextFrame2.TextRange.InsertChartField msoChartFieldRange _\n               , strRange, 0\nmySerCol.ShowRange = True 'Show the values from the range\nmySerCol.ShowValue = False 'Do not show the actual values of the points\n</code></pre>\n\n<p>Note that this will only do this for one of the series.  To do the other ones, loop through i in the myChart.SeriesCollections(i) line.</p>\n"}], "owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1593806915, "creation_date": 1450819174, "last_edit_date": 1593806915, "question_id": 34424584, "link": "https://stackoverflow.com/questions/34424584/powerpoint-vba-set-datarange-for-datalabels", "title": "Powerpoint VBA - Set DataRange for DataLabels", "body": "<p>I have no idea how to set DataRange for DataLabels using VBA.\nPowerpoint does not have recording capabilities as well.</p>\n\n<p><strong>Can anybody tell me to do this using VBA please?</strong>\n<a href=\"https://i.stack.imgur.com/HeFqv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HeFqv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "if-statement", "vb-like-operator"], "comments": [{"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "reply_to_user": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1450822786, "post_id": 34424423, "comment_id": 56592262, "body": "it highlights the whole if, or block"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1450823508, "post_id": 34424795, "comment_id": 56592571, "body": "Great works perfectly but the message box does not display number of cells changed. It says 0 when numerous changes were made. Thanks though."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1450826886, "post_id": 34424795, "comment_id": 56593802, "body": "It wasn&#39;t clear what you intended with that Msgbox.  See my updates above."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1450826831, "last_edit_date": 1450826831, "creation_date": 1450820121, "answer_id": 34424795, "question_id": 34424423, "link": "https://stackoverflow.com/questions/34424423/go-through-column-and-replace-if-containing-these-values-if-not-leave-as-is/34424795#34424795", "title": "Go through column and replace if containing these values. If not leave as is", "body": "<p>Untested:</p>\n\n<pre><code>Sub Drops()\n    Dim i As Long, z As Long, arr, v, n As Long\n    Dim numEdits As Long\n\n    numEdits = 0\n    arr = Array(\"Customer Dropoff\", \"RE-Ships No pick up charge\", _\n                \"Undeliverable Publication Mail (NO P/U CHARGE)\") 'etc\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    With Sheets(\"Input\")\n        i = .Cells(Rows.Count, \"L\").End(xlUp).Row\n\n        For z = i To 2 Step -1\n\n            v = .Cells(z, \"L\").Value\n            If IsError(v) Then\n                'ignore error ?\n            Else\n                For n = LBound(arr) To UBound(arr)\n                    If v Like \"*\" &amp; arr(n) &amp; \"*\" Then\n                        .Cells(z, \"L\").Value = 0\n                        numEdits = numEdits + 1\n                        Exit For\n                    End If\n                Next n\n            End If\n\n        Next z\n\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\n    MsgBox numedits &amp; \" Row(s) changed!\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 34424795, "answer_count": 1, "score": 1, "last_activity_date": 1553884247, "creation_date": 1450818393, "last_edit_date": 1553884247, "question_id": 34424423, "link": "https://stackoverflow.com/questions/34424423/go-through-column-and-replace-if-containing-these-values-if-not-leave-as-is", "title": "Go through column and replace if containing these values. If not leave as is", "body": "<p>I want to go through column L and replace cells containing these text fields to 0. If not I want to leave as is. The code runs but stops at the first <code>#N/A</code> that it encounters.</p>\n\n<pre><code>Sub Drops()\n    Dim i&amp;, z&amp;\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n\n        With Sheets(\"Input\")\n            i = .Cells(Rows.Count, \"L\").End(xlUp).Row\n            For z = i To 2 Step -1\n                If (.Cells(z, \"L\").Value2 Like \"*Customer Dropoff*\" _\n                    Or .Cells(z, \"L\").Value2 Like \"*RE-Ships No pick up charge*\" _\n                        Or .Cells(z, \"L\").Value2 Like \"*Undeliverable Publication Mail (NO P/U CHARGE)*\" _\n                            Or .Cells(z, \"L\").Value2 Like \"*RETURNS*\" _\n                                Or .Cells(z, \"L\").Value2 Like \"*K2 Fed Ex*\" _\n                                    Or .Cells(z, \"L\").Value2 Like \"*WorldNet Shipping*\" _\n                                        Or .Cells(z, \"L\").Value2 Like \"*OSM (NO P/U COST)*\" _\n                                            Or .Cells(z, \"L\").Value2 Like \"*TEST PICK UP*\") Then\n\n                    .Cells(z, \"L\").Value2 = 0\n                End If\n            Next z\n            z = .Cells(Rows.Count, \"L\").End(xlUp).Row\n        End With\n\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\n    MsgBox i - z &amp; \" Rows has been changed!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1450820753, "post_id": 34424332, "comment_id": 56591439, "body": "It looks perfectly correct. How doesnt it work? What error is it displaying?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1450821517, "post_id": 34424332, "comment_id": 56591785, "body": "@Lankymart it means hide the column if the cell&#39;s value is &quot;&quot;HIDE&quot;. If that&#39;s what the code is meant to do, then it works fine and it is perfectly correct. I dont have my Crystal ball to know what is the intent of the OP, that&#39;s why I ask. But the code is VB-correct, there is no syntax error in it."}], "answers": [{"comments": [{"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 1, "creation_date": 1450821004, "post_id": 34424432, "comment_id": 56591559, "body": ".Value = True evaluates to True.  if you remove that logic, then you are no longer checking the value of the cell!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1450818440, "creation_date": 1450818440, "answer_id": 34424432, "question_id": 34424332, "link": "https://stackoverflow.com/questions/34424332/hiding-columns-based-on-cell-value-using-vba/34424432#34424432", "title": "Hiding columns based on cell value using VBA", "body": "<p>Change your line to <code>.EntireColumn.Hidden = True</code>.</p>\n\n<p>You don't need to say the Value is hidden, simply the <code>EntireColumn</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 7677928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5334e48ef9f7115924b4b2cc695222ed?s=128&d=identicon&r=PG&f=1", "display_name": "Enrico", "link": "https://stackoverflow.com/users/7677928/enrico"}, "is_accepted": false, "score": 0, "last_activity_date": 1490009901, "creation_date": 1490009901, "answer_id": 42902601, "question_id": 34424332, "link": "https://stackoverflow.com/questions/34424332/hiding-columns-based-on-cell-value-using-vba/42902601#42902601", "title": "Hiding columns based on cell value using VBA", "body": "<p>Your code works perfect here for me. All is correct. Maybe ist an idea to change the logic to</p>\n\n<pre><code>With cell\n    If .Value = \"HIDE\" Then\n        .EntireColumn.Hidden = True\n    Else\n        .EntireColumn.Hidden = False\n    End If\nEnd With\n</code></pre>\n\n<p>This is better to debug and understand why it works or not. Generally it is difficult to find a bug without the real data. Seems your bug is inside your data. Please check this carefully or post your data here.</p>\n"}], "owner": {"reputation": 41, "user_id": 5586811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92049ec1c16986bca23a2e9360fde5d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick ", "link": "https://stackoverflow.com/users/5586811/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1008, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1490009901, "creation_date": 1450818004, "last_edit_date": 1450821146, "question_id": 34424332, "link": "https://stackoverflow.com/questions/34424332/hiding-columns-based-on-cell-value-using-vba", "title": "Hiding columns based on cell value using VBA", "body": "<p>I am trying to hide columns based on a cell value.  This code works perfectly to hide rows but when I try and manipulate it to hide columns, it doesn't work. Any ideas? </p>\n\n<pre><code>Sub HideColumns()\n\n    Dim WS_Count As Integer\n    Dim I As Integer\n    Dim cell As Range\n\n    WS_Count = ActiveWorkbook.Worksheets.Count\n    For I = 1 To WS_Count\n\n        For Each cell In Sheets(I).Range(\"P33:Y33\")\n            With cell\n                .EntireColumn.Hidden = .Value = \"HIDE\"\n            End With\n        Next\n    Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "object", "dictionary"], "comments": [{"owner": {"reputation": 13687, "user_id": 1136527, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/LpVhn.jpg?s=128&g=1", "display_name": "Alex McMillan", "link": "https://stackoverflow.com/users/1136527/alex-mcmillan"}, "edited": false, "score": 0, "creation_date": 1450817006, "post_id": 34424089, "comment_id": 56589873, "body": "Have you thought about using a class module with a representation of the content you want to use, then instantiating one in Module A?"}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1450817014, "post_id": 34424089, "comment_id": 56589875, "body": "Can you give some example of how you envision the two macros would interact?"}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1450830747, "last_edit_date": 1450830747, "creation_date": 1450828561, "answer_id": 34426475, "question_id": 34424089, "link": "https://stackoverflow.com/questions/34424089/objects-dictionary-for-global-variables/34426475#34426475", "title": "Objects/dictionary for global variables", "body": "<p>I'm wary of the vagueness of \"run the macros in those workbooks\", but I'll proceed with caution... :)</p>\n\n<p>Let's say you have your workbooks, Master.xls and Child1-3.xls.  They all have a reference set to the Windows Scripting Runtime library.</p>\n\n<ul>\n<li>Master has a Settings worksheet and some VBA</li>\n<li>Child1-3 each have two worksheets, DataDump and Settings</li>\n<li>Child1-3 each have a public module with a VBA proc to be run (name is known)</li>\n</ul>\n\n<p>The Master Settings w/s is populated thusly:</p>\n\n<pre><code>A1 = SettingName      B1 = SettingValue\nA2 = Setting1         B2 = Value1\nA3 = Setting2         B3 = Value2\nA4 = Setting3         B4 = Value3\n</code></pre>\n\n<p>(note that column C is empty and E always has a trailing \\)</p>\n\n<pre><code>D1 = WBName         E1 = WBPath        F1 = ProcName\nD2 = Child1.xls     E2 = C:\\Temp\\      F2 = MaryJo\nD3 = Child2.xls     E3 = C:\\Temp\\      F3 = MaryLou\nD4 = Child3.xls     E4 = C:\\Temp\\      F4 = DaisyLou\n</code></pre>\n\n<p>There's the setup, now the execution.</p>\n\n<p>Within a proc (\"Bob\") in Master write something like this:</p>\n\n<pre><code>Public Sub Bob\n    Dim dctSetting As Dictionary\n    Dim wkbCurrent As Workbook\n    Dim rngWkbook  As Range\n    Dim rngSetting As Range\n\n    Set rngSetting = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\")\n    Set dctSetting = New Dictionary\n    Do Until rngSetting = \"\"\n        dctSetting.Add rngSetting.Value, rngSetting.Offset(0, 1).Value\n    Loop\n\n    Set rngWkBook = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"D2\")\n    Do Until rngWkBook.Value = \"\"\n        Set wkbCurrent = Workbooks.Open(rngWkBook.Offset(0,1) &amp; rngWkBook)\n        Application.Run \"'\" &amp; rngWkBook &amp; \"'!\" &amp; rngWkBook.Offset(0,2), \n                        dctSetting\n        Set wkbCurrent.Saved = True\n        wkbCurrent.Close False\n        Set rngWkBook = rngWkBook.Offset(1,0)\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Each of Child1-3 has their respective procs (MaryJo, MaryLou, DaisyLou), with the limitation of this approach being that each of those procs has to accept one param (best to make it a dictionary, I guess).</p>\n\n<p>Each child's proc doesn't <em>have</em> to use all three settings, or even any of them.  By using a dictionary, you can check for the existence of a setting prior to using it.  So in each of the child procs there would be something like:</p>\n\n<pre><code>Public Sub MaryLou(dctSettings as Dictionary)\n    Dim strMyValue As String\n\n    If dctSettings.Exists(\"TheNameOfTheMasterSettingIWantToUse\") Then\n        strMyValue = dctSettings(\"TheNameOfTheMasterSettingIWantToUse\")\n\n        ' Your code runs here with the populated variable\n    End If\nEnd Sub\n</code></pre>\n\n<p>You'll need to do extra stuff like check for the child w/b at the specified path - at a bare minimum!</p>\n"}], "owner": {"reputation": 1, "user_id": 5708751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060b596360ffc4e40c8514a8773af24b?s=128&d=identicon&r=PG&f=1", "display_name": "General covariance", "link": "https://stackoverflow.com/users/5708751/general-covariance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450830747, "creation_date": 1450816797, "question_id": 34424089, "link": "https://stackoverflow.com/questions/34424089/objects-dictionary-for-global-variables", "title": "Objects/dictionary for global variables", "body": "<p>I am writing a macro that will sit in workbook A.</p>\n\n<p>Workbook A's primary function will be to open workbooks 1-5, and run the macros in those workbooks. However in order to run the macros in workbooks 1-5 I will need to pass inputs to workbooks 1-5 from workbook A.</p>\n\n<p>I would like to define a dictionary or an object in workbook A, which will pass an entire set of inputs to each workbook 1-5. And the macros in workbooks 1-5 will only grab the necessary inputs.</p>\n\n<p>How can I acheive this? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 147, "user_id": 5692872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee51bdd7cc5ba9356aef4d7070e3dfd?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaLlama", "link": "https://stackoverflow.com/users/5692872/ninjallama"}, "edited": false, "score": 0, "creation_date": 1450819369, "post_id": 34424047, "comment_id": 56590883, "body": "Can you just hide the sheet with the tracked changes so nobody knows that it exists?  If that is not a valid action then it would not be too hard to just copy the contents of that sheet to another workbook."}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "reply_to_user": {"reputation": 147, "user_id": 5692872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee51bdd7cc5ba9356aef4d7070e3dfd?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaLlama", "link": "https://stackoverflow.com/users/5692872/ninjallama"}, "edited": false, "score": 0, "creation_date": 1450908981, "post_id": 34424047, "comment_id": 56630932, "body": "Thanks, NinjaLlama. The &quot;Track changes&quot; feature needs to be activated by the person using file A. And when that person saves and closes file A, this sheet containing the change history will disappear as well (Although if you open file A again and activate &quot;Track Changes&quot;, you will get the same change history. My difficulty lies in writing a code in file B to open file A and activate &quot;Track Changes&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450909131, "post_id": 34430592, "comment_id": 56630992, "body": "Thanks Vegard. Similar to my reply to NinjaLlama, the problem is with the &quot;Track Changes&quot; feature in file A. It needs to be activated manually when while file A is being open. Once file A is saved, this sheet containing the change history is gone. So if I use code in file B to open file A, there is no &quot;Change history&quot; sheet there. I would like to use code to activate it from file B."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450910484, "post_id": 34430592, "comment_id": 56631522, "body": "Directly answering your question is beyond the scope I can contribute in. Part of me doubts that it is possible using &quot;native&quot; tools alone. I wrote a manual diff tool for excel files, however... if you&#39;d be content with comparing &quot;before&quot; and &quot;after&quot; versions of the file, it&#39;s easily accomplished using only simple VBA."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450910599, "post_id": 34430592, "comment_id": 56631556, "body": "Actually, I don&#39;t know why I assumed that you can&#39;t put macros into file A. Can you put macros into file A?"}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450913024, "post_id": 34430592, "comment_id": 56632370, "body": "File A is a shared file. Anyone who know macros can compromise my Change History. Furthermore, if someone turns off the &quot;Track Changes&quot; feature while opening file A, the change history before this access is wiped out, even if that person turns it on back before saving the file. This, again, compromises the Change History."}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450913113, "post_id": 34430592, "comment_id": 56632404, "body": "Also, file A is a corporate-wide shared file. Making it a macro file may pose unpredictable problems in the future."}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450913407, "post_id": 34430592, "comment_id": 56632494, "body": "Also, comparing &quot;before&quot; and &quot;after&quot; was also on my mind. But I need to implement this action to unforeseeable number of files with large sizes (in the order or MegaByte). Periodically duplicating these files (daily, at least) will exhaust the resource pretty soon."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1450940949, "post_id": 34430592, "comment_id": 56639325, "body": "You can password protect the VBA portion of a file. This will prevent anyone from changing your code or adding new code. I bet you can also use VBA to prevent the change history from being disabled, but I don&#39;t (yet) know how."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1450855265, "creation_date": 1450855265, "answer_id": 34430592, "question_id": 34424047, "link": "https://stackoverflow.com/questions/34424047/periodically-store-changes-of-shared-workbook-into-an-isolated-workbook/34430592#34430592", "title": "Periodically store changes of shared workbook into an isolated workbook", "body": "<p>Using your private workbook, you can use macros to open the shared workbook and copy the sheet into the private workbook again.</p>\n\n<p>EDIT: Sorry, I missed the part about saving it into a file C.</p>\n\n<p>Here is to get you started:</p>\n\n<pre><code>Sub wbCopy()\n    Dim sharedWb, myWb As Workbook\n    Dim sharedWs As Worksheet\n\n    Set myWb = New Workbook\n\n    Workbooks.Open Filename:=\"192.168.0.10\\sharedWorkbook.xls\", ReadOnly:=True\n    Set sharedWb = \"sharedWorkbook.xls\"\n    Set sharedWs = sharedWb.Worksheets(2)\n\n    sharedWs.Copy myWb.Worksheets(Sheets.Count)\n\n    Workbooks(\"sharedWorkbook.xls\").Close\n\n    myWb.SaveAs Filename:=\"File C.xls\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1452231954, "post_id": 34645800, "comment_id": 57086047, "body": "Thank you, Chris, for answering. I have found a solution some time back. Very similar to your advice here !"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1452129347, "creation_date": 1452129347, "answer_id": 34645800, "question_id": 34424047, "link": "https://stackoverflow.com/questions/34424047/periodically-store-changes-of-shared-workbook-into-an-isolated-workbook/34645800#34645800", "title": "Periodically store changes of shared workbook into an isolated workbook", "body": "<p>When you open the Shared WB, update the change info, then copy the History sheet</p>\n\n<pre><code>Sub Demo()\n    Dim wbShared As Workbook\n    Dim wbHistory As Workbook\n\n    Set wbHistory = Application.Workbooks.Open( _\n      Filename:=\"\\\\Path\\To\\Your\\History\\FileC.xlsx\", _\n      Password:=\"Password\")\n\n    Set wbShared = Application.Workbooks.Open( _\n      FileName:=\"\\\\Path\\To\\Your\\Shared\\FileA.xlsx\")\n\n    ' Generate History Sheet (maybe change xlAllChanges to suit needs)\n    With wbShared\n        .HighlightChangesOptions _\n          When:=xlAllChanges, _\n          Who:=\"Everyone\"\n        .ListChangesOnNewSheet = True\n    End With\n\n    ' Copy out History to FileC\n    wbShared.Worksheets(\"History\").Copy After:=wbHistory.Sheets(wbHistory.Sheets.Count)\n\n    ' Clean Up\n    wbShared.Close False\n    wbHistory.Close True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 34645800, "answer_count": 2, "score": -1, "last_activity_date": 1452129347, "creation_date": 1450816602, "last_edit_date": 1531161705, "question_id": 34424047, "link": "https://stackoverflow.com/questions/34424047/periodically-store-changes-of-shared-workbook-into-an-isolated-workbook", "title": "Periodically store changes of shared workbook into an isolated workbook", "body": "<p>I have two workbooks, a shared \"xlsx\" file A which stores data and no-sharing \"xlsm\" file B which contains my macros. I would like maintain periodic  tracking of changes in file A and password-protect this change history. I know there is a \"Track Changes\" feature in file A and it could create a separate sheet containing the change history. However, this sheet is within workbook A, which is being shared. Is there a way to write a macro in B to periodically extract this change history from A, put it into a \"xlsx\" file C with password?</p>\n\n<p>The point here is I would like to prevent the change history to be compromised. Only I have access to it. Note that I can not make file A \"macro enabled\" and write macro in it.</p>\n\n<p>Thank.</p>\n"}, {"tags": ["performance", "vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450816510, "post_id": 34423866, "comment_id": 56589617, "body": "Why don&#39;t you just find the number of rows and then hide them?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1450816680, "post_id": 34423866, "comment_id": 56589700, "body": "Why loop? Do them all at once.  <code>ActiveSheet.Rows(&quot;17:3017&quot;).EntireRow.Hidden = True</code> and <code>Rows(&quot;17:3017&quot;).RowHeight = 12</code>"}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 5670717, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/537ba256ced9e3871c0fc664836bad64?s=128&d=identicon&r=PG", "display_name": "bgalea", "link": "https://stackoverflow.com/users/5670717/bgalea"}, "is_accepted": false, "score": -1, "last_activity_date": 1450817154, "last_edit_date": 1495539877, "creation_date": 1450817154, "answer_id": 34424162, "question_id": 34423866, "link": "https://stackoverflow.com/questions/34423866/excel-vba-hide-3000-rows-optimizing/34424162#34424162", "title": "Excel VBA hide 3000 rows optimizing", "body": "<p>Here's an old post of mine. <a href=\"https://stackoverflow.com/questions/26071366/how-to-speed-up-multiple-replacement-using-vba-in-word\">How to speed up multiple replacement using VBA in Word?</a></p>\n\n<p>Remember MINIMISE DOTS.</p>\n\n<p>Read the post as it lists 4 performance killers.</p>\n\n<blockquote>\n  <p><strong>Minimise Dots</strong></p>\n  \n  <p>So if you are interested in performance minimise dots (each dot is a lookup), especially in loops.</p>\n  \n  <p>There are two ways. One is to set objects to the lowest object if you are going to access more than once.</p>\n  \n  <p>eg (slower)</p>\n  \n  <p><code>set xlapp = CreateObject(\"Excel.Application\")</code></p>\n  \n  <p><code>msgbox xlapp.worksheets(0).name</code> </p>\n  \n  <p>(faster because you omitt a dot every time you use the object)</p>\n  \n  <p><code>set xlapp = CreateObject(\"Excel.Application\")</code></p>\n  \n  <p><code>set wsheet = xlapp.worksheets(0)</code></p>\n  \n  <p><code>msgbox wsheet.name</code></p>\n  \n  <p>The second way is <code>with</code>. You can only have one <code>with</code> active at a time.</p>\n  \n  <p>This skips 100 lookups.</p>\n  \n  <p><code>with wsheet</code></p>\n  \n  <p><code>For x = 1 to 100</code></p>\n\n<pre><code>    `msgbox .name`\n</code></pre>\n  \n  <p><code>Next</code></p>\n  \n  <p><code>end with</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450891248, "post_id": 34426404, "comment_id": 56622663, "body": "That made a huge difference. Perfect score inn all ways :) Thanx for taking the time. Only fault i found was this part:"}, {"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450891298, "post_id": 34426404, "comment_id": 56622690, "body": "With Range(entireRange).SpecialCells(xlCellTypeVisible).EntireRow         .AutoFit         If .Height &lt; 20 Then             .RowHeight = 12         End If     End With"}, {"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450891432, "post_id": 34426404, "comment_id": 56622767, "body": "The ide was to autofit to detect if some rows needed to be more than 12 in height. And rest of the rows i wanted to be 12 in height..."}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "reply_to_user": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450894129, "post_id": 34426404, "comment_id": 56624213, "body": "I thought I had included that part exactly as it was. Should I correct something?"}, {"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450897924, "post_id": 34426404, "comment_id": 56626001, "body": "The problem im looking to solve is that is when im setting the height to 12 on all visible rows the rows that need text wrapping also get 12 in height. The reason for not using autofit on all is that it makes unnecessary heigh rows. Previosly my solution was to autofit all, then loop thru and check height, the rows that was less than 20 hight i knew was only one line, and could set to 12 height. Rows with height greather than 20 i knew was 2 lines or more and could just leave as autofitet. Hope that explained what that code mentioned in prevoisly comment was about."}, {"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1450899530, "post_id": 34426404, "comment_id": 56626794, "body": "<code>code</code>    With Range(entireRange).SpecialCells(xlCellTypeVisible).EntireRow         .AutoFit     End With          For I = 3019 To 20 Step -1         If Rows(I).Height &lt; 16 And Rows(I).Hidden = False Then             Rows(I).RowHeight = 13         End If         If Rows(I).Height &gt; 16 And Rows(I).Hidden = False Then             Rows(I).RowHeight = Rows(I).Height + 2         End If     Next I"}], "tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": true, "score": 2, "last_activity_date": 1450828116, "creation_date": 1450828116, "answer_id": 34426404, "question_id": 34423866, "link": "https://stackoverflow.com/questions/34423866/excel-vba-hide-3000-rows-optimizing/34426404#34426404", "title": "Excel VBA hide 3000 rows optimizing", "body": "<p>The following code uses 2 optimisations:<br>\n- calculate each row's state only once, not twice, by saving the previously computed value for the next iteration<br>\n- collect all empty rows in one range object and format this in one step. Format the rest of the range by addressing the \"visible\" cells (via SpecialCells).</p>\n\n<pre><code>Sub Worksheet_Activate()\n    ' optimized for performance\n    Const entireRange = \"B17:J3017\"\n\n    Dim rowptr As Range\n    Dim emptyrows As Range\n    Dim I As Long\n    Dim thisRowIsEmpty As Boolean, nextRowIsEmpty As Boolean\n\n    On Error GoTo ExitHandling\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    'Hide Operations columns if no values\n    If Worksheets(\"BasicData\").Range(\"CheckOperationsZero\").Value = \"Yes\" Then\n        Columns(\"I:J\").EntireColumn.Hidden = True\n    Else\n        Columns(\"I:J\").EntireColumn.Hidden = False\n    End If\n\n    'Hide empty rows, dont hide if row belowe is not empty, autofit for better viewing\n    Rows(\"17:3017\").EntireRow.Hidden = False\n    Set emptyrows = Cells(5000, 1)\n    Set rowptr = Range(\"B3017:J3017\")\n    nextRowIsEmpty = Application.WorksheetFunction.CountIf(rowptr, vbNullString) &gt;= 9\n    For I = 3016 To 18 Step -1\n        Set rowptr = rowptr.Offset(-1, 0)\n        thisRowIsEmpty = Application.WorksheetFunction.CountIf(rowptr, vbNullString) &gt;= 9\n        If thisRowIsEmpty And nextRowIsEmpty Then\n            Set emptyrows = Application.Union(emptyrows, rowptr)\n        End If\n        nextRowIsEmpty = thisRowIsEmpty\n    Next I\n\n    If Not emptyrows Is Nothing Then\n        With emptyrows\n            .RowHeight = 12\n            .EntireRow.Hidden = True\n        End With\n    End If\n    With Range(entireRange).SpecialCells(xlCellTypeVisible).EntireRow\n        .AutoFit\n        If .Height &lt; 20 Then\n            .RowHeight = 12\n        End If\n    End With\n\nExitHandling:\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Exit Sub\n\nErrorHandling:\n    MsgBox Err.Description\n    Resume ExitHandling\nEnd Sub\n</code></pre>\n\n<p>On my notebook this code will run in 0.15 s instead of 2.0 s, so the speedup is roughly 10:1.</p>\n"}], "owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 34426404, "answer_count": 2, "score": 1, "last_activity_date": 1450828116, "creation_date": 1450815702, "question_id": 34423866, "link": "https://stackoverflow.com/questions/34423866/excel-vba-hide-3000-rows-optimizing", "title": "Excel VBA hide 3000 rows optimizing", "body": "<p>My first question :)</p>\n\n<p>Have a sheet with 3000 lines that needs to be checked and hided every time the sheet is activated.</p>\n\n<p>Normally only 100 lines are to be visible but I had to make sure it always was enough lines. (Just in case).</p>\n\n<p>I have this code that works well but are a little slow. Tips for speeding it up would be great.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nOn Error GoTo ExitHandling\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n        'Hide Operations columns if no values\n        If Worksheets(\"BasicData\").Range(\"CheckOperationsZero\").Value = \"Yes\" Then\n            Columns(\"I:J\").EntireColumn.Hidden = True\n        Else\n            Columns(\"I:J\").EntireColumn.Hidden = False\n        End If\n\n        'Hide empty rows, dont hide if row belowe is not empty, autofit for better viewing\n        ActiveSheet.Rows(\"17:3017\").EntireRow.Hidden = False\n        For I = 3016 To 18 Step -1\n            If Application.WorksheetFunction.CountIf(Range(\"B\" &amp; I &amp; \":J\" &amp; I), vbNullString) &gt;= 9 And Application.WorksheetFunction.CountIf(Range(\"B\" &amp; I + 1 &amp; \":J\" &amp; I + 1), vbNullString) &gt;= 9 Then\n                Rows(I).RowHeight = 12\n                Rows(I).EntireRow.Hidden = True\n            Else\n                Rows(I).EntireRow.AutoFit\n                    If Rows(I).Height &lt; 20 Then\n                        Rows(I).RowHeight = 12\n                    End If\n            End If\n        Next I\n\nExitHandling:\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Exit Sub\n\nErrorHandling:\n    MsgBox Err.Description\n    Resume ExitHandling\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "function", "ms-access", "error-handling"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1450815479, "post_id": 34423662, "comment_id": 56589142, "body": "Have you tried adding error handling to your GetId function? Try returning the error."}, {"owner": {"reputation": 51, "user_id": 5279609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/addib.jpg?s=128&g=1", "display_name": "Mike Humphreys", "link": "https://stackoverflow.com/users/5279609/mike-humphreys"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1450966954, "post_id": 34423662, "comment_id": 56649821, "body": "The function in question is a general use function and throws a specific error for handling by a calling procedure. However, when the calling procedure is an sql string or embedded in a query, it escapes the error handling in the calling procedure as outlined. As per Andre&#39;s response below, it&#39;s probably best to avoid using functions that can throw errors directly in queries."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1450822231, "creation_date": 1450822231, "answer_id": 34425263, "question_id": 34423662, "link": "https://stackoverflow.com/questions/34423662/vba-error-in-sql-function-call-escapes-error-trap/34425263#34425263", "title": "VBA Error in sql function call escapes error trap", "body": "<p>My take on the observed behavior is this:</p>\n\n<p>When you run <code>\"Select * FROM MyTable WHERE MyTable.Id = GetId()\"</code>, <code>GetId()</code> is evaluated by the query engine, not by <code>Test()</code>, so the error handler in <code>Test()</code> cannot catch the runtime error. It's the same as if you would put the SQL into a query and run that.</p>\n\n<p>When you do <code>\"Select * FROM MyTable WHERE MyTable.Id = \" &amp; GetId()</code>, <code>GetId()</code> <em>is</em> evaluated by <code>Test()</code>.<br>\nThis would be the \"normal\" way to run your example (open a recordset in a VBA function), IMO.</p>\n\n<p>But you can also use VBA functions like <code>GetId()</code> in queries. You only need to make sure that either the function is simple enough that it <em>can't</em> trigger a runtime error, or that the function has its own error handler.</p>\n\n<p>If the function is run only once (in the WHERE clause), a MsgBox is acceptable as error handler. If the function is run for every row (i.e. it's in the SELECT clause), this can make for a truly horrible user experience. :p<br>\nSo make sure that in this case the function <em>returns</em> an error code or NULL or whatever is applicable, like vacip wrote.</p>\n"}], "owner": {"reputation": 51, "user_id": 5279609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/addib.jpg?s=128&g=1", "display_name": "Mike Humphreys", "link": "https://stackoverflow.com/users/5279609/mike-humphreys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1450822231, "creation_date": 1450814765, "last_edit_date": 1450821044, "question_id": 34423662, "link": "https://stackoverflow.com/questions/34423662/vba-error-in-sql-function-call-escapes-error-trap", "title": "VBA Error in sql function call escapes error trap", "body": "<p>When an sql query makes a call to a vba function and that function raises an error, the error handling code fails to handle the error.</p>\n\n<p>See example below. The call to GetId() in the strSql generates an error when the <code>Set rst = db.OpenRecordset(strSql)</code> is executed. \nThis error is not handled by the <code>On Error GoTo Err_Test</code> error handler!</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetId() As Long\n    Err.Raise 11     'Divide by zero error\nEnd Function\n\nPublic Function Test() As String\n\n    On Error GoTo Err_Test\n    Dim db As DAO.Database\n    Dim rst As DAO.Recordset\n    Dim strSql As String\n\n    Set db = CurrentDb()\n    strSql = \"Select * FROM MyTable WHERE MyTable.Id = GetId()\"\n    Set rst = db.OpenRecordset(strSql)\n    Test = rst!name\n\nExit_Test:\n    If Not rst Is Nothing Then\n        rst.Close\n        Set rst = Nothing\n    End If\n    Set db = Nothing\n    Exit Function\n\nErr_Test:\n    MsgBox Error$\n    Resume Exit_Test\nEnd Function\n</code></pre>\n\n<p>Why does the error escape the error handler and is there some way to handle it gracefully when the sql makes a call to a vba function that generates an exception?</p>\n\n<p>I know that removing the function call from the sql string as shown below, will enable the error handler to trap the error. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim id as Long\nid = GetId()\nstrSql = \"Select * FROM MyTable WHERE MyTable.Id = \" &amp; id\n</code></pre>\n\n<p>Is this the only way? If so, should one avoid using function calls in sql query strings to avoid unhandled exceptions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450815592, "post_id": 34423516, "comment_id": 56589193, "body": "Perhaps using <a href=\"http://www.contextures.com/xlNames01.html\" rel=\"nofollow noreferrer\">Dynamic Named Ranges</a> to set your chart data source(s) can assist greatly here. Admittedly, this may be unrelated to your <i>true</i> question, but I thought it may avoid some VBA code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450815769, "post_id": 34423516, "comment_id": 56589290, "body": "Why close the <code>ActiveWindow</code>? What if you just did <code>Activesheet.Close SaveChanges:=True</code>.  I&#39;m just thinking out loud, but wouldn&#39;t closing the active window close the excel instance? Or is it the same as <code>Activesheet</code> in this use?"}, {"owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1450815960, "post_id": 34423516, "comment_id": 56589365, "body": "Yeah @BruceWayne both <code>ActiveWindow</code> and <code>Activesheet</code> do the same here.."}], "owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450821803, "creation_date": 1450814196, "last_edit_date": 1450821803, "question_id": 34423516, "link": "https://stackoverflow.com/questions/34423516/chart-label-doesnt-update-after-running-resizing-range-macro", "title": "Chart label doesn&#39;t update after running resizing range&#39; macro", "body": "<p>I have a Power Point presentation which ~200 slides. Each slide have one chart, which data is updated monthly by a link to a master xlsx file. In order to not show empty values (future months) in the charts, I have to open the data editor (chart right click > Edit data...) of every chart and select the range until the current month.</p>\n\n<p>I wrote a macro for it in Power Point:</p>\n\n<pre><code>Sub Refresh_slides()\n\nFor i = 1 To ActivePresentation.Slides.Count\n\n    Set ObjSlide = ActivePresentation.Slides(i)\n\n    On Error Resume Next\n\n        Set mychart = ObjSlide.Shapes(\"Chart 3\").Chart\n        mychart.Select\n        mychart.ChartData.Activate\n        Set wb = mychart.ChartData.Workbook\n        Set ws = wb.Worksheets(1)\n\n        Application.Run \"Refresh_slides_AUX.xlsm!atual_slide\"\n\n        wb.Close True\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p><code>Refresh_slides_AUX.xlsm</code> is an auxiliary macro worksheet to select the correct range of each chart (necessary because Power Point VBA, as long as I know, don't have an option to do it):</p>\n\n<pre><code>Sub atual_slide()\n\nWindows(\"Gr\u00e1fico no Microsoft PowerPoint\").Activate\nActiveSheet.ListObjects(\"Table1\").Resize Range(\"$A$1:$I$23\")\nActiveWindow.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n\n<p>It works fine, but even after the range is resized the chart label doesn't reflect this change in source data. How can I force the appearance of the chart label to update? Seems like something is missing between lines</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").Resize Range(\"$A$1:$I$23\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code> ActiveWindow.Close SaveChanges:=True\n</code></pre>\n\n<p>like a \"refresh\" or \"reset\", but I can't figure it out...</p>\n\n<p>Any ideas?</p>\n\n<p>PS. By \"label\" I mean a data table (don't know how they call it in english) which is a label option in Office. Eg. below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NGauk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NGauk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "combobox", "focus", "userform"], "comments": [{"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1450811959, "post_id": 34422920, "comment_id": 56587453, "body": "The code you posted has <code>Me.ComboBox1.SetFocus</code> before <code>Show_Information_Click</code>, have you tried it after?"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1450812195, "post_id": 34422920, "comment_id": 56587588, "body": "Also, to avoid any change of focus, does your situation allow you to encapsulate your <code>Show_Information_Click</code> code inside a third Sub, perhaps <code>Show_Information_Inner</code>, and call that sub from both <code>Show_Information_Click</code> and <code>ComboBox1_KeyDown</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 0, "last_activity_date": 1450812104, "creation_date": 1450812104, "answer_id": 34423010, "question_id": 34422920, "link": "https://stackoverflow.com/questions/34422920/excel-userform-return-focus-to-combobox-after-hitting-enter/34423010#34423010", "title": "Excel Userform - Return Focus to ComboBox after hitting enter", "body": "<p>Have a look at the <a href=\"https://msdn.microsoft.com/en-us/library/aa733550(v=vs.60).aspx\" rel=\"nofollow\">tab order</a> and tab stop properties, they might help you (unless you want to use multiple controls, and want to use tab key to move between them).</p>\n\n<p>For example, you can set the Tab stop property to False for every control on the form except your ComboBox. This way, after hitting enter, the focus returns there immediately.</p>\n\n<p>You can set these from the properties window, no need to use code (but of course you can set them from code too).</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 5660083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8d44403381356215896ae1fd0accb97e?s=128&d=identicon&r=PG&f=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5660083/rich"}, "edited": false, "score": 0, "creation_date": 1450813832, "post_id": 34423255, "comment_id": 56588440, "body": "Thank you!  This will come in handy with something I have lined up for the project on another form!  However, I need to run Show_Information_Click in order for the Userform to work as that&#39;s what populates information in various places on it.  I don&#39;t see the program running using the code above???"}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1469395450, "post_id": 34423255, "comment_id": 64504887, "body": "+1. This is the ONLY solution that actually works in Excel 2016, if you want to resolve loss of focus after various keydowns, such as arrow down and enter, and you have several comboboxes in a userform with the tabstop property set to true. I tried all the proposed solutions here, but to no avail [<a href=\"http://stackoverflow.com/questions/15442620/re-focusing-on-an-excel-userform-combobox]\" title=\"re focusing on an excel userform combobox%5d\">stackoverflow.com/questions/15442620/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1450813135, "creation_date": 1450813135, "answer_id": 34423255, "question_id": 34422920, "link": "https://stackoverflow.com/questions/34422920/excel-userform-return-focus-to-combobox-after-hitting-enter/34423255#34423255", "title": "Excel Userform - Return Focus to ComboBox after hitting enter", "body": "<p><code>SetFocus</code> is not the way to go, because anyway, the framework will change the focus <em>after</em> the execution of your routine. Instead, you can cancel the key's effect so that the focus wont change, like this:</p>\n\n<pre><code>Private Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = vbKeyReturn Then\n         KeyCode = 0\n         'Whatever other code that does not affect the focus again...\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5660083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8d44403381356215896ae1fd0accb97e?s=128&d=identicon&r=PG&f=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5660083/rich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2225, "favorite_count": 0, "accepted_answer_id": 34423010, "answer_count": 2, "score": 0, "last_activity_date": 1450813135, "creation_date": 1450811760, "question_id": 34422920, "link": "https://stackoverflow.com/questions/34422920/excel-userform-return-focus-to-combobox-after-hitting-enter", "title": "Excel Userform - Return Focus to ComboBox after hitting enter", "body": "<p>I tried this:</p>\n\n<pre><code>Private Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = vbKeyReturn Then\n         Me.ComboBox1.SetFocus\n         Show_Information_Click\n    End If\nEnd Sub\n</code></pre>\n\n<p>Unfortunately when I hit enter, the \"focus\" shifts from the ComboBox1 to a CommandButton that I am using as a \"Back\" button for my form.  </p>\n\n<p>My ComboBox1 takes a user input name (which it autocompletes thankfully).  The person presses enter and a button right below it (which can be clicked instead) activates.  When the button has done it's thing, the \"Back\" button on my form is now the \"focus\" so that if the person hits enter again, it uses the \"Back\" button.  I would like to set focus back to the ComboBox1 so that when the user hits enter, it runs the code and returns focus to ComboBox1 so that they can type another name if they desire and go again.  </p>\n\n<p>I even tried putting the Me.ComboBox1.SetFocus at then end of the CommandButton's sequence of events and the \"Back\" button is still selected.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1450808049, "post_id": 34421997, "comment_id": 56585407, "body": "You have been here long enough to know you have to show effort."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450808081, "post_id": 34421997, "comment_id": 56585429, "body": "<code>Range(&quot;B3&quot;,Range(&quot;B3&quot;).End(xlDown))</code> will return go down to the first blank cell.  like hitting ctrl-downarrow."}, {"owner": {"reputation": 109, "user_id": 5446908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db0d47597bec4ae8febb30d39fcf4022?s=128&d=identicon&r=PG&f=1", "display_name": "Grinsummer", "link": "https://stackoverflow.com/users/5446908/grinsummer"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450810842, "post_id": 34421997, "comment_id": 56586881, "body": "Thank  you very much Scott @Scott Craner! I tried: Set rng = Range(&quot;B3&quot;, Range(&quot;B3).End(xlDown)), and then: rng.Select. But when I run the VBA, it highlights rng.Select and says error...May I know what&#39;s wrong?"}, {"owner": {"reputation": 109, "user_id": 5446908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db0d47597bec4ae8febb30d39fcf4022?s=128&d=identicon&r=PG&f=1", "display_name": "Grinsummer", "link": "https://stackoverflow.com/users/5446908/grinsummer"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450810949, "post_id": 34421997, "comment_id": 56586935, "body": "I am sorry findwindow @findwindow - but I could not find any solutions for this and all other codes I wrote were unrelated... I normally show efforts but I will definitely try harder next time."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1450812399, "post_id": 34421997, "comment_id": 56587691, "body": "Range(Range(&quot;B3&quot;),Range(&quot;B3&quot;).End(xlDown)) maybe? (Didn&#39;t try, should work though.) Just record a freaking ctrl-shift-down, man! :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450813334, "post_id": 34421997, "comment_id": 56588183, "body": "@Grinsummer When you write <code>Set rng = Range(&quot;B3&quot;, Range(&quot;B3).End(xlDown))</code> do you qualify it to a <i>specific</i> worksheet, since you wrote <i>in each worksheet</i>. This is important as you may get unexpected results if the active sheet is not the one you suppose it."}], "answers": [{"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 1, "last_activity_date": 1450813571, "creation_date": 1450813571, "answer_id": 34423357, "question_id": 34421997, "link": "https://stackoverflow.com/questions/34421997/select-the-first-range-of-contiguous-data-in-a-column/34423357#34423357", "title": "Select the first range of contiguous data in a column", "body": "<p>Just to give you idea, try :  </p>\n\n<pre><code>Columns(\"B\").Find(\"\", Cells(Rows.Count, \"B\")).Select\n</code></pre>\n\n<p>This will select the first blank cell in column B.<br>\nNow if you want this cell reference, simply use :  </p>\n\n<pre><code>MsgBox ActiveCell.Address\n</code></pre>\n\n<p>And this will give you <strong><code>$B$6</code></strong> (Assuming your data start from A1).  </p>\n\n<p><strong>*NOTE</strong>: You need to twik it use it with your code.</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 5446908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db0d47597bec4ae8febb30d39fcf4022?s=128&d=identicon&r=PG&f=1", "display_name": "Grinsummer", "link": "https://stackoverflow.com/users/5446908/grinsummer"}, "is_accepted": false, "score": 1, "last_activity_date": 1451341387, "creation_date": 1451341387, "answer_id": 34501652, "question_id": 34421997, "link": "https://stackoverflow.com/questions/34421997/select-the-first-range-of-contiguous-data-in-a-column/34501652#34501652", "title": "Select the first range of contiguous data in a column", "body": "<p>Found out a solution for this, which works for me:</p>\n\n<pre><code>Dim last As Long\nDim rng As Range\nDim I as integer\n\nWS_Count = ActiveWorkbook.Worksheets.Count\n\nFor I = 8 to WS_Count\n\nlast = Worksheets(I).Cells(3, \"B\").End(xlDown).Row\nSet rng = Worksheets(I).Range(\"B3:B\" &amp; last)\n\nNext I\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5446908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db0d47597bec4ae8febb30d39fcf4022?s=128&d=identicon&r=PG&f=1", "display_name": "Grinsummer", "link": "https://stackoverflow.com/users/5446908/grinsummer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1451341387, "creation_date": 1450807880, "last_edit_date": 1450808026, "question_id": 34421997, "link": "https://stackoverflow.com/questions/34421997/select-the-first-range-of-contiguous-data-in-a-column", "title": "Select the first range of contiguous data in a column", "body": "<p>I am trying to, in each worksheet, select and copy only the first range of the contiguous data in column B (e.g. B3:B5 with values 3, 5, 2 in the table below) before any blanks.<br>\nThe length of the values vary across worksheets, but the data I want always start from cell \"B3\".<br>\nI don't want any values under Heading5 or in other columns. In some worksheets, there is no Heading5 and values beneath it.<br>\nI read some posts about Intersect and ActiveCell properties, but I don't know how to apply them.. New to VBA - thank you for your help!</p>\n\n<pre><code>A        B        C\nHeading1 Heading2 Heading3\n2        3        6\n3        5        8\n4        2        4\n\nHeading4 Heading5 Heading6\n24       67       2\n25       34       5\n4        6        12\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450806211, "post_id": 34421515, "comment_id": 56584532, "body": "just a thought ... what if you put a hard <code>Application.Wait</code> statement after the data refresh?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450809837, "post_id": 34421515, "comment_id": 56586337, "body": "no luck with <code>application.wait</code>. adding a <code>MsgBox</code> and forcing a wait that way doesn&#39;t help either."}, {"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 1, "creation_date": 1450811920, "post_id": 34421515, "comment_id": 56587433, "body": "Try by (re)setting data source range of the pivot in code before refresh."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "reply_to_user": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1450817967, "post_id": 34421515, "comment_id": 56590278, "body": "@PankajR, <code>Sheets(&quot;Pivots&quot;).PivotTables(&quot;Pivot1&quot;).PivotCache.SourceData = &quot;Table1&quot;</code> (etc) - no change"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1450820571, "post_id": 34421515, "comment_id": 56591367, "body": "Could it be that the data didn&#39;t change for that particular table and so it refreshed but you don&#39;t notice a difference?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1450820859, "post_id": 34421515, "comment_id": 56591487, "body": "the code actually changes the dates returned by the queries. I can see the tables have changed to the selected dates, and all but one of the pivot tables."}], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1450811687, "post_id": 34421982, "comment_id": 56587312, "body": "I don&#39;t suppose you have your automatic calculations turned off."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1450815521, "post_id": 34421982, "comment_id": 56589157, "body": "I have it off, but after the refresh of the pivot tables, I execute this sequence of commands: <code>Application.CalculateFullRebuild :  Application.ScreenUpdating = True :  Application.Calculation = xlCalculationAutomatic</code>"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1450818073, "post_id": 34421982, "comment_id": 56590325, "body": "If you keep calculations on, does it make a difference?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1450820432, "post_id": 34421982, "comment_id": 56591296, "body": "no, and refreshing after the full recalc doesn&#39;t work either."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1450807826, "creation_date": 1450807826, "answer_id": 34421982, "question_id": 34421515, "link": "https://stackoverflow.com/questions/34421515/excel-not-refreshing-all-pivot-tables/34421982#34421982", "title": "excel not refreshing all pivot tables", "body": "<p>Try something like</p>\n\n<pre><code>Sub refreshTables()\nDim pt As PivotTable\nDim ws As Worksheet\nFor Each ws In Worksheets\n    For Each pt In ws.PivotTables\n        pt.RefreshTable\n    Next pt\nNext ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1163, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1450807826, "creation_date": 1450805925, "question_id": 34421515, "link": "https://stackoverflow.com/questions/34421515/excel-not-refreshing-all-pivot-tables", "title": "excel not refreshing all pivot tables", "body": "<p>I am trying to refresh pivot tables using vba.<br>\nI have code that modifies the underlying table query, and refreshes the query.<br>\nOnce that is done, it refreshes the pivot tables, which in turn will refresh a summary sheet. For some reason, the final pivot table is not being refreshed. It will refresh normally.</p>\n\n<p>Methods tried:</p>\n\n<p>1.</p>\n\n<pre><code>Dim PC As PivotCache\nFor Each PC In ThisWorkbook.PivotCaches\n    While DateDiff(\"s\", PC.RefreshDate, Now) &gt; 60\n    PC.Refresh\n    Wend\nNext\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Sheets(\"Pivots\").PivotTables(\"Pivot1\").PivotCache.Refresh\nSheets(\"Pivots\").PivotTables(\"Pivot2\").PivotCache.Refresh\nSheets(\"Pivots\").PivotTables(\"Pivot3\").PivotCache.Refresh\nSheets(\"Pivots\").PivotTables(\"Pivot4\").PivotCache.Refresh\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>ThisWorkbook.RefreshAll\n</code></pre>\n\n<p>I have tried including a <code>DoEvents</code> before refreshing pivot tables, after the refresh of the tables has occurred.<br>\nI have also tried copying the file to another file, and recreating it there. the effect stays, it simply moves to whichever pivot table it considers the last one created.\nFile size is 279Kb as xlsb, and 336 Kb as xlsm.<br>\nData for the tables is coming from SQL server 2012, and all tables are on the same excel sheet. The tables are updated, but the pivot is not.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450806432, "post_id": 34421469, "comment_id": 56584634, "body": "What kind of hyperlinks?  <code>Insert&gt;&gt;Hyperlink</code> or <code>=HYPERLINK()</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 4, "last_activity_date": 1450807040, "creation_date": 1450807040, "answer_id": 34421799, "question_id": 34421469, "link": "https://stackoverflow.com/questions/34421469/remapping-excel-links-vba/34421799#34421799", "title": "Remapping Excel links VBA", "body": "<p>You could just replace the folder path in the address for all hyperlinks</p>\n\n<pre><code>Sub FixHyperLinks()\n    Dim hLink As Hyperlink\n\n    For Each hLink In Me.Hyperlinks\n        hLink.Address = Replace(hLink.Address, \"folder1/\", \"folder1/EXTRA_FOLDER/\")\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450807040, "creation_date": 1450805732, "question_id": 34421469, "link": "https://stackoverflow.com/questions/34421469/remapping-excel-links-vba", "title": "Remapping Excel links VBA", "body": "<p>I have a file with ~ 3000 links to other files. This file along with the linked files are being moved to a new location.</p>\n\n<p>When I moved the files and the excel file, the path automatically got updated, however a new folder was introduced, and this folder was not added in the hyperlinks of excel.</p>\n\n<p>Example: </p>\n\n<pre><code>Excel link: folder1/folder2/folder3/file.txt\nActual path: folder1/EXTRA_FOLDER/folder2/folder3/file.txt\n</code></pre>\n\n<p>How would I go about adding that one hyperlink in? Using VBA, how would I access hyperlinks?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1450804104, "post_id": 34420953, "comment_id": 56583361, "body": "Works for me using a static/literal range."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1450804176, "post_id": 34420953, "comment_id": 56583410, "body": "Well, I need a variable range XD So my <code>range</code> syntax is incorrect..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450804244, "post_id": 34420953, "comment_id": 56583456, "body": "What do you mean by &quot;doesn&#39;t work&quot;?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450804328, "post_id": 34420953, "comment_id": 56583494, "body": "@Rory sum is not replaced by subtotal. Edit: also tried without <code>lookat</code> and <code>matchcase</code> XD"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450805312, "post_id": 34420953, "comment_id": 56584008, "body": "@findwindow - are you trying to replace the syntax in formulas?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450805463, "post_id": 34420953, "comment_id": 56584093, "body": "Yea, trying to replace sum formulas with subtotal formula."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1450805464, "post_id": 34420953, "comment_id": 56584094, "body": "I understand you need a variable range.  But I don&#39;t know how you&#39;re getting <code>lastRow</code> (you didn&#39;t provide that other than to just tell us to trust you), so my point is that if the static range works, then you can narrow your debugging efforts."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450805586, "post_id": 34420953, "comment_id": 56584167, "body": "@findwindow - I am 99.9% sure its not replacing the SUM with Subtotal, because it would result in a bad formula syntax. Since <code>=Subtotal(function_num,ref1,[ref2]...)</code> is different syntax than <code>=SUM(number1,[number2]...)</code>. Excel is smart enough to know that your replace statement will lead to bad formula."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450805688, "post_id": 34420953, "comment_id": 56584231, "body": "I suggest you try it without the macro, doing it manually - I think you might find that, because the required variables are different, it will not allow you to do it manually, and I&#39;m guessing something similar may be happening in your macro.  You may want to first replace the equal sign with something (like [Equal] for example) then replace things in the formula, then change it back to an equal sign."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450805693, "post_id": 34420953, "comment_id": 56584233, "body": "Actually, just noticed by doing <code>ctrl+f</code> on sheet reveals the match entire cell contents option checked.... now to figure out how to uncheck that."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450805863, "post_id": 34420953, "comment_id": 56584342, "body": "Ok... setting <code>SearchFormat</code> to true or false doesn&#39;t change result XD UGH ;_;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450805920, "post_id": 34420953, "comment_id": 56584372, "body": "@findwindow - you already have match entire cell contents to False. See my answer to understand the true cause of the issue."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450806026, "post_id": 34421506, "comment_id": 56584428, "body": "Oh yea, two different formulas. DUH XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450806125, "post_id": 34421506, "comment_id": 56584481, "body": "Hmmm changing to <code>what:=&quot;SUM(&quot;, replacement:=&quot;Subtotal(9,&quot;</code> still fails. I think I need to uncheck the <code>match entire cell contents</code> option but HOW Edit: lol stupid. I took off that argument. Works now yaaaay &lt;3"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1450805857, "creation_date": 1450805857, "answer_id": 34421506, "question_id": 34420953, "link": "https://stackoverflow.com/questions/34420953/replace-method-for-range/34421506#34421506", "title": "Replace method for range", "body": "<p>Since you are trying to change actual formulas with your replacement statement, this will not work because the result will be a formula with too few arguments, with the <code>SUBTOTAL</code> formula.</p>\n\n<p>You can test this by trying it manually. You can also test this by replacing <code>SUM</code> with <code>AVERAGE</code>. In that case, your code will work flawlessly since the formula argument syntax is identical.</p>\n\n<p>If you really want to turn a <code>SUM</code> into a <code>SUBTOTAL</code>, you'll have to adjust for the syntax difference in your <code>Replace</code> statement, or find another way to go about it.</p>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450806793, "post_id": 34421646, "comment_id": 56584807, "body": "Ah I guess you could also use replace function instead of method."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450807944, "post_id": 34421646, "comment_id": 56585357, "body": "@findwindow  yes but my approach needs a loop, which is distasteful."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1450806471, "creation_date": 1450806471, "answer_id": 34421646, "question_id": 34420953, "link": "https://stackoverflow.com/questions/34420953/replace-method-for-range/34421646#34421646", "title": "Replace method for range", "body": "<p>Consider something like:</p>\n\n<pre><code>Sub qwertyx()\n      With ActiveSheet\n         lastRow = 10\n         For Each r In .Range(\"H3:I\" &amp; (lastRow - 1))\n            r.Formula = Replace(r.Formula, \"SUM(\", \"SUBTOTAL(9,\")\n         Next r\n      End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 34421506, "answer_count": 2, "score": 1, "last_activity_date": 1450806471, "creation_date": 1450803824, "last_edit_date": 1531161705, "question_id": 34420953, "link": "https://stackoverflow.com/questions/34420953/replace-method-for-range", "title": "Replace method for range", "body": "<p>The range is qualified to the correct sheet. <code>lastRow</code> is correct. Why doesn't this work??</p>\n\n<pre><code>.Range(\"H3:I\" &amp; lastRow - 1).Replace what:=\"SUM\", replacement:=\"Subtotal\", _\nlookat:=xlPart, MatchCase:=True\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": true, "score": 5, "last_activity_date": 1450802764, "creation_date": 1450802764, "answer_id": 34420632, "question_id": 34420389, "link": "https://stackoverflow.com/questions/34420389/vba-binary-file-cause-overflow/34420632#34420632", "title": "vba binary file cause overflow", "body": "<p>The problem is you are not putting a delimiter on the end of your <code>lol</code> assignment lines. So when they are split, the last 2 digits of the previous line are concatenated with the first 2 line of the next.</p>\n\n<p>The error occurs here:</p>\n\n<pre><code>lol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|01\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\n</code></pre>\n\n<p>When this is parsed, there is no separator between <code>01</code> and <code>00</code> (on the next line) so the value of <code>0100</code> produces the overflow.</p>\n\n<p>End each of your <code>lol</code> assignment lines with a <code>|</code> and the error should go away.</p>\n"}, {"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 1, "last_activity_date": 1450804690, "last_edit_date": 1450804690, "creation_date": 1450804353, "answer_id": 34421100, "question_id": 34420389, "link": "https://stackoverflow.com/questions/34420389/vba-binary-file-cause-overflow/34421100#34421100", "title": "vba binary file cause overflow", "body": "<p>Jason has the right answer, but I'm not sure building up a string and splitting it to get an array is the best way. You might consider just filling an array directly.</p>\n\n<pre><code>Private lol(1 To 4656) As String\n\nSub HexStringToBinaryFile()\n\n    Dim i As Long\n    Dim handle As Long\n\n    lol50\n\n    handle = FreeFile\n    Open \"C:\\test.bin2\" For Binary As #handle\n        For i = LBound(lol) To UBound(lol)\n            Put #handle, , CByte(\"&amp;H\" &amp; lol(i))\n        Next i\n    Close #handle\n\nEnd Sub\nSub lol50()\n\n    Dim i As Long\n\n    For i = 1 To 4656\n        lol(i) = \"00\"\n    Next i\n\n    For i = 9 To 4656 Step 16\n        lol(i) = \"40\"\n    Next i\n\n    lol(4000) = \"01\"\n    lol(4416) = \"02\"\n    lol(4656) = \"03\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 666, "user_id": 906967, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8a3dd53d323a53d5cca4f752c60713f4?s=128&d=identicon&r=PG", "display_name": "isoman", "link": "https://stackoverflow.com/users/906967/isoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 34420632, "answer_count": 2, "score": 0, "last_activity_date": 1450804690, "creation_date": 1450801990, "last_edit_date": 1531164843, "question_id": 34420389, "link": "https://stackoverflow.com/questions/34420389/vba-binary-file-cause-overflow", "title": "vba binary file cause overflow", "body": "<p>I'm trying to write this data to a binary file using a macro in word.\nIf I run this I get this error <strong>\"Execution error Overflow (Error 6)\"</strong> on the line   <em>Put #handle, , CByte(\"&amp;H\" &amp; output(i))</em></p>\n\n<p>How can I fix this?\nThanks.</p>\n\n<pre><code>Sub HexStringToBinaryFile()\n\n\n    lol50\n\n    Dim output() As String\n    output = Split(lol, \"|\")\n\n    Dim handle As Long\n    handle = FreeFile\n    Open \"C:\\test.bin2\" For Binary As #handle\n\n    Dim i As Long\n    For i = LBound(output) To UBound(output)\n\n        Put #handle, , CByte(\"&amp;H\" &amp; output(i))\n\n    Next i\n\n    Close #handle\n\nEnd Sub\n  Sub lol50()\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|01\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|02\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|00\"\nlol = lol &amp; \"00|00|00|00|00|00|00|00|40|00|00|00|00|00|00|03\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "checkbox", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450801844, "post_id": 34420221, "comment_id": 56581996, "body": "How about this: <code>If Me.CheckBox4.Value = 0 Then</code> ... but make sure you have the correct name of the checkbox object (see in the Properties box). In other words, it&#39;s Caption <b>Check Box 4</b> may be different then it&#39;s <i>object name</i>."}, {"owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450802571, "post_id": 34420221, "comment_id": 56582458, "body": "When I try this `Me.Checkbox4.Value, I receive error &quot;Method or data member not found.&quot;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450802958, "post_id": 34420221, "comment_id": 56582698, "body": "Yes, please see my answer. I posted that comment before you edited your post to note it was a form control."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450803749, "post_id": 34420221, "comment_id": 56583173, "body": "The values for a Form checkbox are <code>xlOn</code>, <code>xlMixed</code> or <code>xlOff</code>"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450803011, "post_id": 34420640, "comment_id": 56582734, "body": "this is not an acceptable answer on SO. If you want to link to a previous question, put that in the comments of the OP. (Then delete this as an answer)."}], "tags": [], "owner": {"reputation": 147, "user_id": 5692872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee51bdd7cc5ba9356aef4d7070e3dfd?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaLlama", "link": "https://stackoverflow.com/users/5692872/ninjallama"}, "is_accepted": false, "score": 0, "last_activity_date": 1450803299, "last_edit_date": 1495541245, "creation_date": 1450802792, "answer_id": 34420640, "question_id": 34420221, "link": "https://stackoverflow.com/questions/34420221/unchecked-checkbox-value-does-not-result-in-zero-value/34420640#34420640", "title": "Unchecked checkbox value does not result in zero value", "body": "<p>I would determine if the form checkbox is not checked in the following manner:</p>\n\n<pre><code>If Not ActiveSheet.Shapes(\"Check Box 1\").ControlFormat.Value = 1 Then\n\n    MsgBox (\"unchecked\")\n\nEnd If\n</code></pre>\n\n<p>I referred to the following answer on how to detect checked value for Form or ActiveX controls: <a href=\"https://stackoverflow.com/a/11991419/5692872\">https://stackoverflow.com/a/11991419/5692872</a></p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1450802926, "creation_date": 1450802926, "answer_id": 34420692, "question_id": 34420221, "link": "https://stackoverflow.com/questions/34420221/unchecked-checkbox-value-does-not-result-in-zero-value/34420692#34420692", "title": "Unchecked checkbox value does not result in zero value", "body": "<p>Change </p>\n\n<p><code>If ActiveSheet.Shapes(\"Check Box 4\").ControlFormat.Value = 0</code></p>\n\n<p>To </p>\n\n<p><code>If ActiveSheet.Shapes(\"Check Box 4\").ControlFormat.Value = -4146</code> </p>\n\n<p>-4146 is the numerical equivalent to an unchecked Form Control check box. To test if the check box is indeed checked, use <code>= 1</code> instead of <code>= -4146</code></p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "is_accepted": false, "score": 0, "last_activity_date": 1450803329, "creation_date": 1450803329, "answer_id": 34420816, "question_id": 34420221, "link": "https://stackoverflow.com/questions/34420221/unchecked-checkbox-value-does-not-result-in-zero-value/34420816#34420816", "title": "Unchecked checkbox value does not result in zero value", "body": "<p>I found these both work by changing:<br>\n<code>If ActiveSheet.Shapes(\"Check Box 4\").ControlFormat.Value = 0</code><br>\nto:<br>\n<code>If ActiveSheet.Shapes(\"Check Box 4\").ControlFormat.Value &lt;&gt; 1</code><br>\nor<br>\n<code>If ActiveSheet.Shapes(\"Check Box 4\").ControlFormat.Value = xloff</code></p>\n"}], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1758, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1450803329, "creation_date": 1450801424, "last_edit_date": 1531164843, "question_id": 34420221, "link": "https://stackoverflow.com/questions/34420221/unchecked-checkbox-value-does-not-result-in-zero-value", "title": "Unchecked checkbox value does not result in zero value", "body": "<p>In Excel 2010, VBA, when the checkbox is unchecked, the code should not run.  However it is running when the checkbox is unchecked.  What am I missing?  </p>\n\n<p>EDIT:  The unchecked checkbox results in \"-4146\" in the Immediate window.  So I changed the <code>IF</code> condition to <code>&lt;&gt; 1</code>.   Isn't an unchecked checkbox supposed to be equal to zero?</p>\n\n<p>EDIT 2:  I forgot to mention, this is a FORM CONTROL checkbox.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'delete range on the active row from column I to column M and shift up\n'I=9, M = 13\nDim delAnswer As VbMsgBoxResult\nConst WS_Range As String = \"I:M\"\n\n'Checks to see if user wants macro turned on\nIf ActiveSheet.Shapes(\"Check Box 4\").ControlFormat.Value = 0 Then Exit Sub\nOn Error GoTo ws_exit\nApplication.EnableEvents = False\n\n'Check to see if user is in applicable range for macro to run\nIf Not Intersect(ActiveCell, Me.Range(WS_Range)) Is Nothing Then\n\n'Ask user to confirm running macro\nWith Target\naR = ActiveCell.Row\ndelAnswer = MsgBox(\"Delete I\" &amp; aR &amp; \":M\" &amp; aR &amp; \"?\", vbYesNo)\n\n'Macro - deletes range of cells on the active row\nIf delAnswer = vbYes Then\nRange(\"I\" &amp; ActiveCell.Row).Resize(, 5).Delete Shift:=xlUp\n\nElse: GoTo ws_exit\nEnd If\nEnd With\nEnd If\n\nws_exit:\nApplication.EnableEvents = True\n'Debug.Print Selection.Address(ReferenceStyle:=xlA1, RowAbsolute:=False, ColumnAbsolute:=False)\n'Debug.Print \"ar is \" &amp; aR\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "edited": false, "score": 1, "creation_date": 1450801511, "post_id": 34420188, "comment_id": 56581785, "body": "is this vba or vb.net? why have you tagged both?"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1450801536, "post_id": 34420188, "comment_id": 56581802, "body": "Not for nothing but rather than rebuilding the dataset, you can use a DataView for things like that."}, {"owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "edited": false, "score": 0, "creation_date": 1450801543, "post_id": 34420188, "comment_id": 56581809, "body": "Did someone say little bobby tables?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1450801605, "post_id": 34420188, "comment_id": 56581841, "body": "<code>#</code> delimits a literal date: <code>WHERE datefield = #mm&#47;dd&#47;yyyy#</code>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1450801656, "post_id": 34420188, "comment_id": 56581875, "body": "You are vulnerable to SQL injection, type <code>&#39;</code> into nmtxt and see what happens"}, {"owner": {"reputation": 11, "user_id": 5696354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rGYVEnzUvtw/AAAAAAAAAAI/AAAAAAAAAB8/eHdOLTNUuC4/photo.jpg?sz=128", "display_name": "Bar\u0131\u015f Ta\u015fy&#252;rek", "link": "https://stackoverflow.com/users/5696354/bar%c4%b1%c5%9f-ta%c5%9fy%c3%bcrek"}, "edited": false, "score": 0, "creation_date": 1450802545, "post_id": 34420188, "comment_id": 56582444, "body": "its for vba i accidently tagged it. Now its untagged. the thing is when i want to search customers by date of birth it needs to be string to be able to find relevant match cause those searches going to be including wildcards like ( starting with and including /dob%  /%dob%)"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1450851140, "post_id": 34420188, "comment_id": 56600351, "body": "Try: <code>CStr(your_date)</code> ."}, {"owner": {"reputation": 11, "user_id": 5696354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rGYVEnzUvtw/AAAAAAAAAAI/AAAAAAAAAB8/eHdOLTNUuC4/photo.jpg?sz=128", "display_name": "Bar\u0131\u015f Ta\u015fy&#252;rek", "link": "https://stackoverflow.com/users/5696354/bar%c4%b1%c5%9f-ta%c5%9fy%c3%bcrek"}, "edited": false, "score": 0, "creation_date": 1450984643, "post_id": 34420188, "comment_id": 56655957, "body": "solved with little bit research (&quot;Convert(dob, &#39;System.String&#39;) LIKE &#39;&quot; &amp; dob.Text &amp; &quot;%&#39;&quot;)"}], "owner": {"reputation": 11, "user_id": 5696354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rGYVEnzUvtw/AAAAAAAAAAI/AAAAAAAAAB8/eHdOLTNUuC4/photo.jpg?sz=128", "display_name": "Bar\u0131\u015f Ta\u015fy&#252;rek", "link": "https://stackoverflow.com/users/5696354/bar%c4%b1%c5%9f-ta%c5%9fy%c3%bcrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450801948, "creation_date": 1450801316, "last_edit_date": 1450801948, "question_id": 34420188, "link": "https://stackoverflow.com/questions/34420188/visual-basic-with-ms-access-2003-date-to-string-need-ideas", "title": "Visual Basic with MS Access 2003 date to string need ideas", "body": "<p>I have a database and from that i am pulling a date value but in my software i need to convert it to a string value so i can put it into textboxes etc. \nfor the name and surname i have this line of code:</p>\n\n<pre><code>CustomerDataGridView.DataSource = \n    Me.CFSDataSet.Customer.Select((\"name LIKE'\" &amp; nmtxt.Text &amp; \"%' AND surname LIKE'\" &amp; sntxt.Text &amp; \"%'\"))\n</code></pre>\n\n<p>i need to do this for the dob but since its not a string and cannot be bothered like any other data types, my only idea is the conversion but i couldnt be able to do it.\nThanks</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450802240, "post_id": 34420132, "comment_id": 56582248, "body": "<code>PivotTableOptions &gt; Data</code> tab. Make sure that <code>Retain items deleted from the data source &gt; Number of items to retain per field:</code> is set to <b>None</b>. Otherwise the Cache will keep old values from the past that may have been there stored and will check them in your values, even though you do not see them in your data."}, {"owner": {"reputation": 43, "user_id": 5696735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80531fa78a92851587307759c03f4778?s=128&d=identicon&r=PG&f=1", "display_name": "Emmerson", "link": "https://stackoverflow.com/users/5696735/emmerson"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450807652, "post_id": 34420132, "comment_id": 56585217, "body": "@ScottHoltzman - Thank you very much. This resoled the error I was having."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1450802425, "post_id": 34420457, "comment_id": 56582364, "body": "with all due to respect, this doesn&#39;t really offer an answer to the user&#39;s question at all, it just refactors his code to make it more simple / readable."}], "tags": [], "owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1450802220, "creation_date": 1450802220, "answer_id": 34420457, "question_id": 34420132, "link": "https://stackoverflow.com/questions/34420132/run-time-1004-error-when-comparing-pivot-item-values/34420457#34420457", "title": "Run-time 1004 error when comparing pivot item values", "body": "<p>The code doesn't need any particular dates to be there, it checks a range. I didn't get an error but it can be simplified, there is no need to check for blank.</p>\n\n<pre><code>Dim ws As Worksheet, pt As PivotTable, pf As PivotField, pi As PivotItem\nDim dCurrentDate As Date, dPastDate As Date\n\n    dCurrentDate = Date\n    dPastDate = Date - 15\n\n    Set ws = Sheets(\"Sheet2\")\n    Set pt = ws.PivotTables(\"PivotTable1\")\n    Set pf = pt.PivotFields(\"Date\")\n\n    With pf\n       .ClearAllFilters\n       For Each pi In pf.PivotItems\n\n            pi.Visible = Trim(pi.Value) &lt;= dCurrentDate And Trim(pi.Value) &gt;= dPastDate\n       Next\n    End With\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5696735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80531fa78a92851587307759c03f4778?s=128&d=identicon&r=PG&f=1", "display_name": "Emmerson", "link": "https://stackoverflow.com/users/5696735/emmerson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450802367, "creation_date": 1450801154, "last_edit_date": 1531164843, "question_id": 34420132, "link": "https://stackoverflow.com/questions/34420132/run-time-1004-error-when-comparing-pivot-item-values", "title": "Run-time 1004 error when comparing pivot item values", "body": "<p>I am currently working on a set of code to set a pivot table filter to a certain date range. In the code below the date range is from 12/7/2015 to 12/22/2015. In the data only dates 12/7,8,11,18 exist. The code will properly flag those items in the filer, omitting and dates before 12/7 as intended, but somehow it pulls in a 12/21/2015 date and then give me the run time error at the Bolded code row. There is no 12/21/2015 in my data at all. It is also saying that pi.visible should be false and I think that's where the error is happening because there is no 12/21/2015 for it to flag as visible or not. Any advice?</p>\n\n<pre><code>Dim ws As Worksheet, pt As PivotTable, pf As PivotField, pi As PivotItem\nDim dCurrentDate As Date, dPastDate As Date\n\ndCurrentDate = Date\ndPastDate = Date - 15\n\nSet ws = Sheets(\"Sheet2\")\nSet pt = ws.PivotTables(\"PivotTable1\")\nSet pf = pt.PivotFields(\"Date\")\n\nWith pf\n   .ClearAllFilters\n   For Each pi In pf.PivotItems\n   If pi.Value = \"(blank)\" Then\n   Else\n        If pi.Value &lt;= dCurrentDate And pi.Value &gt;= dPastDate Then\n             **pi.Visible = True**\n        Else\n             pi.Visible = False\n        End If\n    End If\n   Next\nEnd With\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 1, "creation_date": 1450802455, "post_id": 34420123, "comment_id": 56582389, "body": "what error do you receive?"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1450802637, "post_id": 34420123, "comment_id": 56582504, "body": "Once it&#39;s open is it still a file object or can it be manipulated as just a workbook?"}, {"owner": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "edited": false, "score": 0, "creation_date": 1450803015, "post_id": 34420123, "comment_id": 56582737, "body": "I get a &quot;Type mismatch&quot; error. Is seems referring to &quot;File&quot; as a workbook is what the problem is. If &quot;File&quot; is not a workbook type, what would it be? Is it a &quot;file object&quot; as justkrys suggested? And then why would the workbooks.open line work?"}], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "edited": false, "score": 0, "creation_date": 1450804959, "post_id": 34421143, "comment_id": 56583820, "body": "Thanks for the help. Unfortunately wb = Workbooks.Open(Filename:=File) is still giving an &quot;Object variable or With block variable not set&quot; error. I have wb defined as a workbook in the sub"}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "reply_to_user": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "edited": false, "score": 1, "creation_date": 1450805123, "post_id": 34421143, "comment_id": 56583909, "body": "My fault.  When working with objects, one needs the <code>Set</code> keyword.  See correction."}], "tags": [], "owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "is_accepted": false, "score": 1, "last_activity_date": 1450805051, "last_edit_date": 1525816150, "creation_date": 1450804484, "answer_id": 34421143, "question_id": 34420123, "link": "https://stackoverflow.com/questions/34420123/open-multiple-files-in-subfolders/34421143#34421143", "title": "Open Multiple files in Subfolders", "body": "<p>Added some comments to the code, to try to help.  </p>\n\n<p>As for working with the opened workbook, I would place <code>Dim wb as Workbook</code> at the top of the <code>DoFolder</code> sub and replace the line <code>Workbooks.Open Filename:=File</code> with <code>Set wb = Workbooks.Open(Filename:=File)</code>  Now <code>wb</code> is a workbook object, on which you can call <code>wb.Activate</code> or <code>wb.Worksheets</code> etc.</p>\n\n<blockquote>\n<pre><code>Sub DoFolderPart1()\n\n    Dim FileSystem As Object\n    Dim HostFolder As String\n\n    HostFolder = \"K:\\Data Directories\\Acquisitions\"\n\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    DoFolder FileSystem.GetFolder(HostFolder)\nEnd Sub\n\nSub DoFolder(Folder)\n    ' Declaring your variables\n    Dim SubFolder\n    Dim strName As String\n    Dim pos As Integer\n\n    ' Looping through your folders recursively\n    ' We go into each folder until we find a folder with only files\n    For Each SubFolder In Folder.SubFolders\n\n        DoFolder SubFolder\n\n    Next\n    ' If we find only files or we have already opened all of the subfolders\n    Dim File\n        strName = Folder.name   '&lt;-- Store the folder name\n        ' Find the string \"June 2015\" in the folder name and store the\n        ' starting location as \"pos\"\n        pos = InStr(strName, \"June 2015\")\n        If pos &gt; 0 Then                         '&lt;-- If we found \"June 2015\"...\n            For Each File In Folder.Files'       &lt;-- Go through each file\n                If Right(File, 4) = \"xlsx\" Then '&lt;-- if it's excel\n                    Workbooks.Open Filename:=File '    open it\n                    'I want to put code here\n\n                End If\n            Next\n       End If\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>Chip Pearson has some <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">good guides</a> for VBA:</p>\n"}, {"comments": [{"owner": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "edited": false, "score": 1, "creation_date": 1450805393, "post_id": 34421267, "comment_id": 56584050, "body": "Ahhhh, that makes sense. Doing this: Set wb = Workbooks.Open(FileName:=File) also seemed to work to set the Workbook to a variable for use. Your explanation is great though!"}], "tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": true, "score": 2, "last_activity_date": 1450804942, "creation_date": 1450804942, "answer_id": 34421267, "question_id": 34420123, "link": "https://stackoverflow.com/questions/34420123/open-multiple-files-in-subfolders/34421267#34421267", "title": "Open Multiple files in Subfolders", "body": "<p>The problem is <code>File</code> contains the <em>full path</em> of the file, not just the file name. You will need to extract the file name only if you want to reference it from the <code>Workbooks</code> Excel object:</p>\n\n<pre><code>If Right(File, 4) = \"xlsx\" Then\n    Workbooks.Open fileName:=File\n    'I want to put code here\n\n    Dim fileName As String\n    fileName = CreateObject(\"Scripting.FileSystemObject\").GetFileName(File)\n\n    Workbooks(fileName).Activate\n    ' ... Do other stuff ...\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 34421267, "answer_count": 2, "score": 2, "last_activity_date": 1450805051, "creation_date": 1450801137, "last_edit_date": 1450803405, "question_id": 34420123, "link": "https://stackoverflow.com/questions/34420123/open-multiple-files-in-subfolders", "title": "Open Multiple files in Subfolders", "body": "<p>So far, I have been able to get the code to have all files opened in sub folders of the same name. The sub folder common name is June 2015, in the main \"acquisitions\" directory.</p>\n\n<pre><code>Sub DoFolderPart1()\n\n    Dim FileSystem As Object\n    Dim HostFolder As String\n\n    HostFolder = \"K:\\Data Directories\\Acquisitions\"\n\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    DoFolder FileSystem.GetFolder(HostFolder)\nEnd Sub\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    Dim strName As String\n    Dim pos As Integer\n\n    For Each SubFolder In Folder.SubFolders\n\n        DoFolder SubFolder\n\n    Next\n\n    Dim File\n        strName = Folder.name\n        pos = InStr(strName, \"June 2015\")\n        If pos &gt; 0 Then\n            For Each File In Folder.Files\n                If Right(File, 4) = \"xlsx\" Then\n                    Workbooks.Open Filename:=File\n                    'I want to put code here\n\n                End If\n            Next\n       End If\nEnd Sub\n</code></pre>\n\n<p>As can be seen, I was given this code by a kind person, but there was no comments on it. I'm quite new to VBA, and I'm having trouble figuring out why there are two different subs and what everything does.</p>\n\n<p>I keep running into a problem where I can't perform any operations on the \"File\" after opening it. Any idea what could be causing this? For instance, there is a \"type mismatch\" error if I place Workbooks(File).Activate after \"File\" is opened. (This is just an example, as I am aware there are very few circumstance where .Activate should be used.)</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1450824159, "creation_date": 1450824159, "answer_id": 34425669, "question_id": 34420031, "link": "https://stackoverflow.com/questions/34420031/view-a-replicated-access-2000-database-in-access-2016/34425669#34425669", "title": "View a replicated Access 2000 database in Access 2016", "body": "<p>You'll need Access 2010 or lower to open it.</p>\n\n<p>If the database doesn't contain confidential data, you could upload it to a file hoster and some good soul might convert it for you.</p>\n\n<p>If it does, you will have to go scouting for a used copy of an old version, I'm afraid.</p>\n"}], "owner": {"reputation": 1, "user_id": 5707877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ded19b19dd8daaa33cb2be297313ff71?s=128&d=identicon&r=PG&f=1", "display_name": "AntoDN", "link": "https://stackoverflow.com/users/5707877/antodn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450824159, "creation_date": 1450800839, "question_id": 34420031, "link": "https://stackoverflow.com/questions/34420031/view-a-replicated-access-2000-database-in-access-2016", "title": "View a replicated Access 2000 database in Access 2016", "body": "<p>I've an old replicated Access 2000 database. I want to get to the code and some of the forms as I'd like to revive parts of it, and also see how I dealt with things back then. </p>\n\n<p>I have the Access 2000 CD, but it was an upgrade from Access 97 and the Access 97 CD is too damaged now to load. Access 2016, which I have now, won't open replicated databases.</p>\n\n<p>Is there any way I can open or convert the .mdb file? I only need to view it in design mode.</p>\n"}, {"tags": ["excel", "vba", "scripting"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5707869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac9675ddf01c6993b4bbe2495eadc4ab?s=128&d=identicon&r=PG&f=1", "display_name": "RMcCartan", "link": "https://stackoverflow.com/users/5707869/rmccartan"}, "edited": false, "score": 0, "creation_date": 1450800991, "post_id": 34419682, "comment_id": 56581417, "body": "Thank you very much Alex K. Worked first time."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1450799653, "creation_date": 1450799653, "answer_id": 34419682, "question_id": 34419466, "link": "https://stackoverflow.com/questions/34419466/excel-vba-to-save-file-name-as-csv-and-cell-value/34419682#34419682", "title": "Excel VBA to save file name as CSV and Cell Value", "body": "<p>If B2 is XXX this produces XXX.CSV (with a loop!)</p>\n\n<pre><code>Sub WriteCSVFile()\n    Dim My_filenumber As Integer\n    Dim i As Long\n    Dim logSTR As String, fileName as String\n\n    My_filenumber = FreeFile\n\n    For i = 2 To 73\n        logSTR = logSTR &amp; Cells(i, \"B\").Value &amp; \" , \"\n    Next\n\n    fileName = \"T:\\Typing\\Client Information\\\" &amp; Range(\"B2\").Value &amp; \".csv\"\n\n    Open fileName For Append As #My_filenumber\n        Print #My_filenumber, logSTR\n    Close #My_filenumber\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "is_accepted": false, "score": 0, "last_activity_date": 1450799930, "last_edit_date": 1495542196, "creation_date": 1450799930, "answer_id": 34419763, "question_id": 34419466, "link": "https://stackoverflow.com/questions/34419466/excel-vba-to-save-file-name-as-csv-and-cell-value/34419763#34419763", "title": "Excel VBA to save file name as CSV and Cell Value", "body": "<p>As I understood, all you want now is save the file as \"B2.csv\"</p>\n\n<p>Maybe this question it answers to your question,  take a look:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26178913/saving-excel-worksheet-to-csv-with-file-name-from-a-cell-using-a-macro\">Saving excel worksheet to CSV with\nfile name from a cell using a macro\n</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5707869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac9675ddf01c6993b4bbe2495eadc4ab?s=128&d=identicon&r=PG&f=1", "display_name": "RMcCartan", "link": "https://stackoverflow.com/users/5707869/rmccartan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1450799930, "creation_date": 1450798955, "last_edit_date": 1450799276, "question_id": 34419466, "link": "https://stackoverflow.com/questions/34419466/excel-vba-to-save-file-name-as-csv-and-cell-value", "title": "Excel VBA to save file name as CSV and Cell Value", "body": "<p>I have a macro to export a range of cells to csv which is fine, I now need it to call the file as a cell value, preferably B2.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Macro:</p>\n\n<pre><code>Sub WriteCSVFile()\n\n    Dim My_filenumber As Integer Dim logSTR As String\n\n    My_filenumber = FreeFile\n\n    logSTR = logSTR &amp; Cells(2, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(3, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(4, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(5, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(6, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(7, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(8, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(9, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(10, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(11, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(12, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(13, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(14, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(15, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(16, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(18, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(19, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(20, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(21, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(22, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(23, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(24, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(25, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(26, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(27, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(28, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(29, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(30, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(31, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(32, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(33, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(35, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(36, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(37, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(38, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(39, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(40, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(41, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(42, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(45, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(46, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(47, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(48, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(49, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(50, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(51, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(52, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(54, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(55, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(56, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(57, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(58, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(59, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(60, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(61, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(62, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(63, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(64, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(66, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(67, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(68, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(69, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(70, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(71, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(72, \"B\").Value &amp; \" , \" \n    logSTR = logSTR &amp; Cells(73, \"B\").Value &amp; \" , \"\n\n    Open \"T:\\Typing\\Client Information\\Test1.csv\" For Append As\n    #My_filenumber\n        Print #My_filenumber, logSTR Close #My_filenumber\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1450798642, "post_id": 34419209, "comment_id": 56579864, "body": "I&#39;d suggest <code>rng2.Value2 = rng1.value2</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1450799518, "post_id": 34419209, "comment_id": 56580468, "body": "<a href=\"http://excelexperts.com/array-speed-range-vs-array\" rel=\"nofollow noreferrer\">range v array</a> may help"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450803025, "post_id": 34420182, "comment_id": 56582744, "body": "I can&#39;t say I am surprised, much like the case of find and replace often being the most efficient way of doing most things in word - when it comes to interacting with office apps via vba, the obvious way is rarely the most efficient. Thank god we can now do it all with linq to xml :)"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1450803487, "post_id": 34420182, "comment_id": 56583007, "body": "@NickDewitt Yea, perhaps Copy/Paste can be quicker because it&#39;s more superficial.  Further testing shows that it&#39;s ~40% slower when the array is entirely filled with equations... btw, just curious, can you see any reason why this answer has been down voted?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450803641, "post_id": 34420182, "comment_id": 56583098, "body": "Nah it&#39;s more efficient because it&#39;s not written in vba, office handles the clipboard a bit differently to other programs anyway - especially when pasting between office apps. I wonder if it&#39;s even quicker to just move the underlying xml (I would guess so) - no time to test right now. I don&#39;t know why, but I guess it&#39;s because you are <code>pretty sure</code> instead of <code>have tested and come up with the answer</code>"}, {"owner": {"reputation": 143, "user_id": 4587965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87a49e4895da61d4c3ba1b220118654d?s=128&d=identicon&r=PG&f=1", "display_name": "Ivo", "link": "https://stackoverflow.com/users/4587965/ivo"}, "edited": false, "score": 0, "creation_date": 1450858902, "post_id": 34420182, "comment_id": 56603698, "body": "Thank you for the time spent. I guess I should start using value2 more often."}], "tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 4, "last_activity_date": 1450804179, "last_edit_date": 1450804179, "creation_date": 1450801303, "answer_id": 34420182, "question_id": 34419209, "link": "https://stackoverflow.com/questions/34419209/vba-excel-efficient-way-to-transfer-a-large-range/34420182#34420182", "title": "(VBA-Excel) Efficient way to transfer a large range", "body": "<p>I'm pretty sure your second option is best, but formatting won't be transferred. You may want to consider using <code>Value2</code> instead, there is a performance improvement over using <code>Value</code>.</p>\n\n<pre><code>rng2.Value2 = rng1.value2\n</code></pre>\n\n<p><strong>Edit 1</strong></p>\n\n<p>After doing some testing, I'm surprised to see that copy/paste can be faster, about 5 times faster with the testing below, but this is with a mostly empty range. Also, <code>Value2</code> reaches an out of memory error sooner. That being said, <code>Value2</code> is cleaner code and it doesn't wipe out your clipboard contents, something to think about.</p>\n\n<pre><code>Public Declare Function GetTickCount Lib \"kernel32.dll\" () As Long\nSub test()\n    Dim r1, r2 As Range\n    Dim t As Long\n\n    Set r1 = Sheets(\"S1\").Range(\"A1:Z100000\")\n    Set r2 = Sheets(\"S2\").Range(\"A1:Z100000\")\n\n    'Method1\n    t = GetTickCount\n    r1.Copy\n    r2.PasteSpecial xlValues\n    Debug.Print GetTickCount - t\n\n    'Method 2\n    t = GetTickCount\n    r2.Value2 = r1.Value2\n    Debug.Print GetTickCount - t\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit 2</strong></p>\n\n<p>Previous testing was with a mostly empty range. Filling the range with a Table and filing the table with content shows that <code>Value2</code> is ~40% faster at handling the full range, but it always handles the full range. I suspect that the difference may be that Copy/Paste has the advantage of being more superficial and thereby realizes a performance gain if empty cells are present.</p>\n"}], "owner": {"reputation": 143, "user_id": 4587965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87a49e4895da61d4c3ba1b220118654d?s=128&d=identicon&r=PG&f=1", "display_name": "Ivo", "link": "https://stackoverflow.com/users/4587965/ivo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1926, "favorite_count": 1, "accepted_answer_id": 34420182, "answer_count": 1, "score": 3, "last_activity_date": 1450804179, "creation_date": 1450798158, "last_edit_date": 1531164843, "question_id": 34419209, "link": "https://stackoverflow.com/questions/34419209/vba-excel-efficient-way-to-transfer-a-large-range", "title": "(VBA-Excel) Efficient way to transfer a large range", "body": "<p>I was wondering, which would be more efficient for a transfer of a large range of cells (about 100 000 cells - 10 000 x 10) between workbooks or worksheets:<br>\n1. Copying and pasting as values:<br></p>\n\n<pre><code>rng1.Copy\nrng2.PasteSpecial xlValues\nApplication.CutCopyMode=False\n</code></pre>\n\n<p><br>\n2. Passing only the values with .Value:<br></p>\n\n<pre><code>rng2.Value = rng1.value\n'The ranges will be predefined to be the same size\n</code></pre>\n\n<p><br>\nThanks for the help in advance!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1450801538, "post_id": 34419008, "comment_id": 56581804, "body": "You can&#39;t assign a Double to an array in Excel VBA either. This must not be the working Excel VBA function."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1450803550, "post_id": 34419008, "comment_id": 56583052, "body": "Sorry, it is working in Excel, I just corrected that first line, thank you"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1450804655, "post_id": 34419008, "comment_id": 56583644, "body": "Ah, got it. What are you going to pass into the function from Access? A recordset? In Excel the <code>Range.Value</code> property (<code>Value</code> is the default property so it&#39;s what you&#39;re calling when you don&#39;t supply a property) can be passed a Variant to make a two-dim array. But there is not <code>Range</code> property in Access."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 1, "creation_date": 1450804885, "post_id": 34419008, "comment_id": 56583770, "body": "If you will arrange the data in an array and pass that in place of the range, you can take advantage of this info: <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/ArraysAndRanges.aspx</a>.  Or, pass a recordset (DBA for most of us).  Either way, you have some learning to do for the methods of Access."}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1190, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1450805023, "creation_date": 1450797600, "last_edit_date": 1450805023, "question_id": 34419008, "link": "https://stackoverflow.com/questions/34419008/calculating-exponential-moving-average-in-access-vba", "title": "Calculating Exponential Moving Average In Access VBA", "body": "<p>In Excel VBA, I have a working function to calculate an Exponentially Weighted Moving Average, following <a href=\"http://www.value-at-risk.net/exponentially-weighted-moving-average-ewma/\" rel=\"nofollow\">http://www.value-at-risk.net/exponentially-weighted-moving-average-ewma/</a> </p>\n\n<p>I want to convert this function to Access VBA to use with some data I have in Access. </p>\n\n<p>I have data of the form:</p>\n\n<pre><code>BucketDate     InterpRate\n8/17/2015      5.56992228328638E-03 \n8/18/2015      5.64693660341032E-03 \n8/19/2015      5.72395092353427E-03 \n8/20/2015      5.80096524365821E-03 \n8/21/2015      5.87797956378215E-03 \n8/22/2015      5.9549938839061E-03 \n8/23/2015      6.03200820403004E-03 \n8/24/2015      6.10902252415399E-03 \n  ...              ...\n</code></pre>\n\n<p>for 76 datapoints. The VBA subroutine is as follows:</p>\n\n<pre><code>Function EWMA(InterpRate As Range, Lambda As Double, _\n                 MarkDate As Date, MaturityDate As Date) As Double\n\n    Dim vZeros() As Variant\n    Dim Price1 As Double, Price2 As Double\n    Dim SumWtdRtn As Double\n    Dim I As Long\n    Dim m As Double\n\n    Dim LogRtn As Double, RtnSQ As Double, WT As Double, WtdRtn As Double\n\nvZeros = InterpRate\n\nm = Month(MaturityDate) - Month(MarkAsOfDate)\n\nFor I = 2 To UBound(vZeros, 1)\n\n    Price1 = Exp(-vZeros(I - 1, 1) * (m / 12))\n\n    Price2 = Exp(-vZeros(I, 1) * (m / 12))\n\n    LogRtn = Log(Price1 / Price2)\n\n    RtnSQ = LogRtn ^ 2\n\n    WT = (1 - Lambda) * Lambda ^ (I - 2)\n\n    WtdRtn = WT * RtnSQ\n\n    SumWtdRtn = SumWtdRtn + WtdRtn\n\nNext I\n\nEWMA = SumWtdRtn ^ (1 / 2)\n\nEnd Function\n</code></pre>\n\n<p>However, I cannot pass InterpRate into an array to use to calculate the exponentially weighted moving average. How can I change this in order to calculate the exponential moving average?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450796223, "post_id": 34418590, "comment_id": 56578269, "body": "What line does the error occur on?"}, {"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450796406, "post_id": 34418590, "comment_id": 56578396, "body": "Line 15, taking into account comments too. The one where I attempt to assign a range to an array &quot;srcYears  = srcWkb.Worksheets(c)...&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1450796468, "post_id": 34418590, "comment_id": 56578435, "body": "Don&#39;t <code>ReDim</code> the array?"}, {"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1450796529, "post_id": 34418590, "comment_id": 56578471, "body": "Nope. Still the same thing even though I commented the &quot;ReDim..&quot; line out"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1450796558, "post_id": 34418590, "comment_id": 56578500, "body": "<code>Dim srcYears()</code> instead of <code>As Double</code>."}, {"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1450796664, "post_id": 34418590, "comment_id": 56578559, "body": "@david-zemens Why is that? Im just curious; I was always thought to put data type when declaring a variable (maybe I should use Variant?)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1450796683, "post_id": 34418590, "comment_id": 56578580, "body": "I don&#39;t know, but I have some better answer I will write, give me a moment."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1450797656, "post_id": 34418590, "comment_id": 56579212, "body": "The <code>Value</code> property of a range returns a <code>Variant</code> and you can only assign one array to another if they are of the same type."}], "answers": [{"comments": [{"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1450797287, "post_id": 34418777, "comment_id": 56578974, "body": "I&#39;m getting a Compile error &quot;Invalid qualifier&quot; error on srcYears.Value (third line from the bottom up)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1450797520, "post_id": 34418777, "comment_id": 56579125, "body": "Ahhh, my bad. <code>Dim srcYears as Range</code>, and I will revise."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 4, "last_activity_date": 1450797554, "last_edit_date": 1450797554, "creation_date": 1450796839, "answer_id": 34418777, "question_id": 34418590, "link": "https://stackoverflow.com/questions/34418590/i-get-an-array-type-mismatch-in-excel-and-vba/34418777#34418777", "title": "I get an array &quot;Type mismatch&quot; in Excel and VBA", "body": "<p>If you do <code>Dim srcYears() As Variant</code>, then your code will work. I am not certain about why you can't declare it as a strongly typed array (e.g., <code>As Double</code>) but I'm guessing that a range's <code>.Value</code>, which can be represented as an array, cannot be handled this way, because the <code>.Value</code> array is not necessarily of that data type, and will not be coerced to that type by an assignment.  My guess is that a <code>Range.Value</code> is <em>always</em> of type Variant, because a range can contain string, numeric, or error values.</p>\n\n<p>You can assign directly from one range to another:</p>\n\n<pre><code> Dim srcYears as Range\n\n For C = 1 To L\n    '## not needed: ReDim srcYears(26, 0)\n    Set srcYears = srcWkb.Worksheets(C).Range(\"A3:A28\")\n\n    Set destYears = destWkb.Worksheets(10).Range(\"A2\").Offset(z, 0)\n    '## resize the destination range to ensure it _\n        accommodates the source Range, then assign directly.\n    destYears.Resize(26,1).Value = srcYears.Value\n    z = z + 26\n Next C\n</code></pre>\n"}], "owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450798881, "creation_date": 1450796182, "last_edit_date": 1450798881, "question_id": 34418590, "link": "https://stackoverflow.com/questions/34418590/i-get-an-array-type-mismatch-in-excel-and-vba", "title": "I get an array &quot;Type mismatch&quot; in Excel and VBA", "body": "<p>I get \"Type mismatch\" when trying to copy a simple one column into an array and back into another column. Here's my code (just the relevant bit):</p>\n\n<pre><code>Sub CopyRangesViaArrays()\n\n 'Declaring variables\n Dim srcWkb As Workbook\n Dim destWkb As Workbook\n\n Dim srcYears() As Double\n Dim destYears As Range\n\n Dim L As Long\n\n Set srcWkb = Workbooks(\"Arrivals.xlsx\")\n Set destWkb = Workbooks(\"OvernightStays.xlsm\")\n\n L = srcWkb.Worksheets.Count\n z = 0\n\n 'Looping through src Workbook sheets\n For C = 1 To L\n    ReDim srcYears(26, 0)\n    srcYears = srcWkb.Worksheets(C).Range(\"A3:A28\")\n\n    Set destYears = destWkb.Worksheets(10).Range(\"A2\").Offset(z, 0)\n    destYears.Value = srcYears\n    z = z + 26\n Next C\n</code></pre>\n\n<p>As you probably see, I'm also having trouble with offsetting the destination range by the number of years taken into an array (there are 43 Sheets so there will be 43 different srcRanges taken up into an array and written to the destRange).</p>\n\n<p>Many thanks!</p>\n\n<p><strong>EDIT:</strong> \nI've also tried this as per instructions</p>\n\n<pre><code>Dim srcYears As Range\nDim destYears As Range\n</code></pre>\n\n<p>Breaks at this line:</p>\n\n<pre><code>destYears.Resize(26, 1).Value = srcYears.Value\n</code></pre>\n\n<p>I tried omitting the last .Value from the problematic line - still nothing.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 1, "creation_date": 1450795856, "post_id": 34418419, "comment_id": 56578019, "body": "Is it possible to change the input format at all?  Excel will treat these time ranges as numbers, so calculating the number of hours requires extra steps.  I would prefer there be a start-time and an end-time given.  Also, is VBA an option, or you literally only want excel formulas?"}, {"owner": {"reputation": 299, "user_id": 5181561, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-q6WgufgSsTA/AAAAAAAAAAI/AAAAAAAAAT8/04yKGn_HmdY/photo.jpg?sz=128", "display_name": "changer", "link": "https://stackoverflow.com/users/5181561/changer"}, "reply_to_user": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1450795952, "post_id": 34418419, "comment_id": 56578093, "body": "VBA is ok. Better do not change format (split string by &#39;-&#39; is not big deal)"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1450796066, "post_id": 34418419, "comment_id": 56578165, "body": "what is the pay rate from 03:00 - 09:00 or should it be 00:00 - 09:00 (the 20$/hour bucket)?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1450796659, "post_id": 34418419, "comment_id": 56578553, "body": "<code>etc.</code> is hard to code for. Decide on an input format for the pay buckets(e.g. array of 24 values)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1450796821, "post_id": 34418419, "comment_id": 56578663, "body": "Also -- is it possible for shifts to start in the middle of an hour (e.g.  09:45)?"}, {"owner": {"reputation": 299, "user_id": 5181561, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-q6WgufgSsTA/AAAAAAAAAAI/AAAAAAAAAT8/04yKGn_HmdY/photo.jpg?sz=128", "display_name": "changer", "link": "https://stackoverflow.com/users/5181561/changer"}, "edited": false, "score": 0, "creation_date": 1450797021, "post_id": 34418419, "comment_id": 56578797, "body": "Only xx:00 format (00:00, 01:00, 02:00, .. 23:00)"}], "answers": [{"tags": [], "owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "is_accepted": false, "score": 1, "last_activity_date": 1450798263, "creation_date": 1450798263, "answer_id": 34419254, "question_id": 34418419, "link": "https://stackoverflow.com/questions/34418419/how-to-count-hours-in-excel/34419254#34419254", "title": "How to count hours in excel", "body": "<p>Do this in VBA!  It is native to excel and is easy to learn.  Functionally, I would loop through the table, write a function to calculate the dollars earned based on the info given.  If you want your results to be live updating (like a formula in excel) you can write a <a href=\"http://www.excel-easy.com/vba/examples/user-defined-function.html\" rel=\"nofollow\">user defined function</a>.  A helpful function might be an <code>HoursIntersect</code> function, as below:</p>\n\n<pre><code>Public Function HoursIntersect(Period1Start As Date, Period1End As Date, _\n                               Period2Start As Date, Period2End As Date) _\n                               As Double\nDim result As Double\n\n' Check if the ends are greater than the starts.  If they are, assume we are rolling over to\n' a new day\nIf Period1End &lt; Period1Start Then Period1End = Period1End + 1\nIf Period2End &lt; Period2Start Then Period2End = Period2End + 1\n\nWith WorksheetFunction\nresult = .Min(Period1End, Period2End) - .Max(Period1Start, Period2Start)\nHoursIntersect = .Max(result, 0) * 24\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Then you can determine the start and end time by splitting the value on the \"-\" character.  Then multiply each payment schedule by the hours worked within that time:</p>\n\n<pre><code>DollarsEarned = DollarsEarned + 20 * HoursIntersect(StartTime, EndTime, #00:00:00#, #03:00:00#)\nDollarsEarned = DollarsEarned + 10 * HoursIntersect(StartTime, EndTime, #09:00:00#, #21:00:00#)\nDollarsEarned = DollarsEarned + 15 * HoursIntersect(StartTime, EndTime, #21:00:00#, #00:00:00#)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1450799168, "last_edit_date": 1450799168, "creation_date": 1450798829, "answer_id": 34419427, "question_id": 34418419, "link": "https://stackoverflow.com/questions/34418419/how-to-count-hours-in-excel/34419427#34419427", "title": "How to count hours in excel", "body": "<p>Here is a non-VBA solution. It's a pretty nasty formula, but it works. I am sure it could be made even easier to use and understand with some more ingenuity:</p>\n\n<p>Assuming the spreadsheet is set up like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R0C5b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R0C5b.png\" alt=\"Data Grid\"></a></p>\n\n<p>Enter this formula in cell G1 and drag down for your data set:</p>\n\n<pre><code>=IF(ISBLANK(B2),\"\",IF(LEFT(B2,2)&lt;MID(B2,FIND(\"-\",B2)+1,2),SUMIFS($P$2:$P$24,$Q$2:$Q$24,\"&gt;=\"&amp;LEFT(B2,2),$Q$2:$Q$24,\"&lt;=\"&amp;MID(B2,FIND(\"-\",B2)+1,2)),SUMIF($Q$2:$Q$24,\"&lt;=\"&amp;MID(B2,FIND(\"-\",B2)+1,2),$P$2:$P$24)+SUMIF($Q$2:$Q$24,\"&gt;=\"&amp;LEFT(B2,2),$P$2:$P$24)))\n</code></pre>\n\n<p>To explain the formula in detail:</p>\n\n<ol>\n<li><code>IF(ISBLANK(B2),\"\"</code> will return a empty string if there is no time for a given person / day combination.</li>\n<li><code>LEFT(B2,2)</code> extracts the start-time into an hour.</li>\n<li><code>Mid(B2,Find(\"-\",B2)+1,2)</code> extracts the end-time into an hour.</li>\n<li><code>IF(LEFT(B2,2)&lt;MID(B2,FIND(\"-\",B2)+1,2)</code> will check if the start-time is less than the end-time (meaning no over-night work). If the start-time is less than the end-time, it will use this formula to calculate the total cost per hour: <code>SUMIFS($P$2:$P$24,$Q$2:$Q$24,\"&gt;=\"&amp;LEFT(B3,2),$Q$2:$Q$24,\"&lt;=\"&amp;MID(B3,FIND(\"-\",B3)+1,2))</code></li>\n<li>If the start-time is higher than the end-time (meaning overnight work), it will use this formula to calculate: <code>SUMIF($Q$2:$Q$24,\"&lt;=\"&amp;MID(B3,FIND(\"-\",B3)+1,2),$P$2:$P$24)+SUMIF($Q$2:$Q$24,\"&gt;=\"&amp;LEFT(B3,2),$P$2:$P$24)</code></li>\n<li>The use of the <code>Find(\"-\",[cell])</code> splits the start-and- end times into values excel can use to do math against the Time / Cost table.</li>\n<li>The formula in column Q of the Time / Cost table is <code>=VALUE(MID(O2,FIND(\"-\",O2)+1,2))</code> and turns the ending hour to consider the cost into a value Excel can use to add, instead of having the text from your original source format.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 9666, "user_id": 1419175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PRKSW.jpg?s=128&g=1", "display_name": "Dave Sexton", "link": "https://stackoverflow.com/users/1419175/dave-sexton"}, "is_accepted": false, "score": 1, "last_activity_date": 1450799529, "creation_date": 1450799529, "answer_id": 34419644, "question_id": 34418419, "link": "https://stackoverflow.com/questions/34418419/how-to-count-hours-in-excel/34419644#34419644", "title": "How to count hours in excel", "body": "<p>I have a method that uses nothing but formulas. First create a lookup table which contains every hour and rate in say columns K &amp; L, something like this:</p>\n\n<pre><code>K       L\n08:00   15\n09:00   10\n10:00   10\n11:00   10\n12:00   10\n13:00   10\n14:00   10\n15:00   10\n16:00   10\n17:00   10\n18:00   10\n19:00   10\n20:00   10\n21:00   15\n22:00   15\n23:00   15\n</code></pre>\n\n<p>Make sure you enter the hours as text by entering a single quote before the digits.</p>\n\n<p>Then if your hours were in cell B2 you could then use this formula to calculate the total:\n    =SUM(INDIRECT(\"L\"&amp;MATCH(LEFT(B2,5),K2:K40,0)&amp;\":L\"&amp;MATCH(RIGHT(B2,5),K2:K40,0)))</p>\n\n<p>All the formula is doing is getting the left and right text of your work time, using MATCH to find their positions in the lookup table which is used to create a range address which is then passed to SUM via the INDIRECT function.</p>\n\n<p>If you need to worry about minutes all you need to do is create a bigger lookup table which holds every minute of the day. You may need to add some extra logic if your work days span midnight.</p>\n"}], "owner": {"reputation": 299, "user_id": 5181561, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-q6WgufgSsTA/AAAAAAAAAAI/AAAAAAAAAT8/04yKGn_HmdY/photo.jpg?sz=128", "display_name": "changer", "link": "https://stackoverflow.com/users/5181561/changer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 34419427, "answer_count": 3, "score": 2, "last_activity_date": 1450799529, "creation_date": 1450795528, "last_edit_date": 1531161705, "question_id": 34418419, "link": "https://stackoverflow.com/questions/34418419/how-to-count-hours-in-excel", "title": "How to count hours in excel", "body": "<p>I have xls file in following format</p>\n\n<pre><code>Name    1              2             3            4\nJohn    09:00-21:00                  09:00-21:00\nAmy                    21:00-09:00                09:00-21:00\n</code></pre>\n\n<p>Where 1,2,3,4 and so on represent days of current month,\n09:00-21:00 - working hours.</p>\n\n<p>I want to calculate salary based on the following conditions:</p>\n\n<pre><code>09:00-21:00 - 10$/hour\n21:00-00:00 - 15$/hour\n00:00-03:00 - 20$/hour\netc.\n</code></pre>\n\n<p>and so on (<strong>every hour</strong> can have it's own cost, for example 03:00-04:00 - 20$/hour, 04:00-05:00 - 19$/hour, etc.)</p>\n\n<p>How can i accomplish this using only Excel (functions or VBA)?</p>\n\n<p>P.S. Easy way: export to csv and process in python/php/etc.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 2830753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cKof1.jpg?s=128&g=1", "display_name": "Valiante", "link": "https://stackoverflow.com/users/2830753/valiante"}, "edited": false, "score": 0, "creation_date": 1450814041, "post_id": 34419630, "comment_id": 56588534, "body": "Yes, this would work, and it&#39;s something I tried, but as mentioned the original workbook has thousands of rows, so looping through each cell in the range is a massive performance hit, and simply not an option I&#39;m afraid. Unfiltered, setting the values of the entire objValues range simultaneously is almost instant, even with thousands of rows."}, {"owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "reply_to_user": {"reputation": 927, "user_id": 2830753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cKof1.jpg?s=128&g=1", "display_name": "Valiante", "link": "https://stackoverflow.com/users/2830753/valiante"}, "edited": false, "score": 0, "creation_date": 1450814786, "post_id": 34419630, "comment_id": 56588865, "body": "Understandable. Unfortunately, VLookup simply doesn&#39;t support using filtered ranges. A way around this would be to use a hidden column (or sheet) and copy the filtered range to this column, then set that range as the lookup values."}], "tags": [], "owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "is_accepted": false, "score": 0, "last_activity_date": 1450799482, "creation_date": 1450799482, "answer_id": 34419630, "question_id": 34418350, "link": "https://stackoverflow.com/questions/34418350/vba-application-vlookup-on-filtered-range-returns-same-value-after-first-filter/34419630#34419630", "title": "VBA: Application.VLookup on Filtered Range returns same value after first filtered row", "body": "<p>If you don't need the lookup performed for the hidden rows as well, you can set the range of <code>objValues</code> and <code>objResult</code> to only include visible cells in the range, then perform the lookup for each cell in the filtered range:</p>\n\n<pre><code>Set objValues = ThisWorkbook.Sheets(\"Lookup Results\").Range(\"A2\", \"A13\").SpecialCells(xlCellTypeVisible)\nSet objResult = ThisWorkbook.Sheets(\"Lookup Results\").Range(\"B2\", \"B13\").SpecialCells(xlCellTypeVisible)\nSet objSource = ThisWorkbook.Sheets(\"Lookup Source\").Range(\"A1\", \"B13\")\n\nFor Each c In objResult\n    c.Value = Application.VLookup(c.Offset(0, -1), objSource, 2, False)\nNext\n</code></pre>\n\n<p>EDIT: Note that you don't need to set objValues at all in this case.</p>\n"}], "owner": {"reputation": 927, "user_id": 2830753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cKof1.jpg?s=128&g=1", "display_name": "Valiante", "link": "https://stackoverflow.com/users/2830753/valiante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450799482, "creation_date": 1450795257, "question_id": 34418350, "link": "https://stackoverflow.com/questions/34418350/vba-application-vlookup-on-filtered-range-returns-same-value-after-first-filter", "title": "VBA: Application.VLookup on Filtered Range returns same value after first filtered row", "body": "<p>This is a simplified version of a much larger workbook, which demonstrates the issue I'm having;</p>\n\n<p><a href=\"https://dl.dropboxusercontent.com/u/33942680/VBA%20Filtered%20vLookup%20Example.xlsm\" rel=\"nofollow\">VBA Filtered vLookup Example.xlsm</a></p>\n\n<pre><code>Sub LookupMonths()\n    Set objValues = ThisWorkbook.Sheets(\"Lookup Results\").Range(\"A2\", \"A13\")\n    Set objResult = ThisWorkbook.Sheets(\"Lookup Results\").Range(\"B2\", \"B13\")\n    Set objSource = ThisWorkbook.Sheets(\"Lookup Source\").Range(\"A1\", \"B13\")\n    objResult.Value = Application.VLookup(objValues, objSource, 2, False)\nEnd Sub\n</code></pre>\n\n<p>As the original workbook has thousands of rows, I'd opted to use a range as the first argument (lookup_value).  This works fine if the data is unfiltered.  However I have a number of rows I don't wish to update, so these are filtered out based on their contents.  In this example, I've manually filtered out months 3, 8 and 11.  As you can see, this results in a number of months returning January/February only.</p>\n\n<p>I've tried creating a filtered range based on <strong>xlCellTypeVisible</strong> (as per the below) but this doesn't appear to have any impact.</p>\n\n<pre><code>Set objFilteredResult = objResult.SpecialCells(xlCellTypeVisible)\nobjFilteredResult.Value = Application.VLookup(objValues, objSource, 2, False)\n</code></pre>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 1897, "user_id": 783388, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gm7eC.jpg?s=128&g=1", "display_name": "Johanness", "link": "https://stackoverflow.com/users/783388/johanness"}, "edited": false, "score": 0, "creation_date": 1450795990, "post_id": 34418092, "comment_id": 56578116, "body": "Have you seen this: <a href=\"http://stackoverflow.com/questions/25488687/parse-html-content-in-vba\" title=\"parse html content in vba\">stackoverflow.com/questions/25488687/parse-html-content-in-v&zwnj;&#8203;ba</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5568140, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a1fad6aea9c3b86c3f26c30a1f3a076d?s=128&d=identicon&r=PG&f=1", "display_name": "Joonas", "link": "https://stackoverflow.com/users/5568140/joonas"}, "edited": false, "score": 0, "creation_date": 1451910781, "post_id": 34418596, "comment_id": 56927403, "body": "Thank you for the quick reply. I just realized I didn&#39;t ask the question clear enough, I have about 30 000 companies I need to search and all of their links are different.Thus I don&#39;t know what the substring I&#39;m extracting is going to be. I only know what the substrings around the link I&#39;m extracting are - as they are the same every time. Sorry about the mistake."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1450796193, "creation_date": 1450796193, "answer_id": 34418596, "question_id": 34418092, "link": "https://stackoverflow.com/questions/34418092/extracting-a-specific-element-from-website-source-code-in-vba/34418596#34418596", "title": "Extracting a specific element from website source code in VBA", "body": "<p>How about this:</p>\n\n<pre><code>Sub ExtractLink()\n\nDim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nWith IE\n\n    .Navigate \"http://finder.fi/yrityshaku/nokia+oyj\"\n\n    Do\n        DoEvents\n    Loop While .Busy Or .Readystate &lt;&gt; 4\n\n    .Visible = True\n\n    Dim oDoc As Object\n    Set oDoc = .document\n\n    With oDoc\n\n        Dim cLinks As Object, iLink As Object, sText As String\n        sText = \"Tietoliikennepalveluja%2C+tietoliikennelaitteita/Nokia+Oyj/TAMPERE\"\n\n        Set cLinks = .links\n\n        For Each iLink In cLinks\n\n            If InStr(1, iLink.Href, sText) Then\n\n                Debug.Print Replace(iLink.Href, \"http://finder.fi\", \"\")\n\n            End If\n\n        Next\n\n    End With\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5568140, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a1fad6aea9c3b86c3f26c30a1f3a076d?s=128&d=identicon&r=PG&f=1", "display_name": "Joonas", "link": "https://stackoverflow.com/users/5568140/joonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1057, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450796193, "creation_date": 1450794468, "question_id": 34418092, "link": "https://stackoverflow.com/questions/34418092/extracting-a-specific-element-from-website-source-code-in-vba", "title": "Extracting a specific element from website source code in VBA", "body": "<p>I'm trying to extract a specific link from a website and I'm having trouble pulling into a String.</p>\n\n<p>The link to the source code is this: view-source:<a href=\"http://finder.fi/yrityshaku/Nokia+oyj\" rel=\"nofollow\">http://finder.fi/yrityshaku/Nokia+oyj</a> this is the part I'm looking at:</p>\n\n<pre><code>&lt;div class=\"itemName\"&gt;\n\n\n\n\n\n      &lt;!-- Yritysnimi --&gt;\n\n        &lt;!-- Aukeaa aina yhteystiedot-v\u00c3?lilehdelle --&gt;\n        &lt;a href=\"/Tietoliikennepalveluja%2C+tietoliikennelaitteita/Nokia+Oyj/TAMPERE/yhteystiedot/159838\" class=\"resultGray\"&gt;\n</code></pre>\n\n<p>I want to extract the Substring:</p>\n\n<pre><code>/Tietoliikennepalveluja%2C+tietoliikennelaitteita/Nokia+Oyj/TAMPERE/yhteystiedot/159838\n</code></pre>\n\n<p>I've tried to use browserIE.Document.body.innerText but it seems to only copy parts of the source code that are plain text on the original website.</p>\n\n<p>I've researched some but I haven't found a suitable solution yet. Some have suggested pulling just an element from the source code and others copying the whole source code into a string variable. As a person who's not too expert in vba I'd prefer pulling the whole code into a string as I think this way would be easier to understand. </p>\n\n<p>Original website (in finnish) <a href=\"http://finder.fi/yrityshaku/nokia+oyj\" rel=\"nofollow\">http://finder.fi/yrityshaku/nokia+oyj</a></p>\n\n<p>A BIG THANK YOU in advance!</p>\n"}, {"tags": ["forms", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5640041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b75bcfaa2c02f2393a2dbc1b659b8b4?s=128&d=identicon&r=PG&f=1", "display_name": "JER", "link": "https://stackoverflow.com/users/5640041/jer"}, "edited": false, "score": 0, "creation_date": 1451557930, "post_id": 34428166, "comment_id": 56831607, "body": "I really appreciate your reply - thank you so much! I will try all this out now (will let you know how it goes)."}], "tags": [], "owner": {"reputation": 19, "user_id": 5501829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f6b9de5d99b1c067cdb750fc372b150a?s=128&d=identicon&r=PG&f=1", "display_name": "finazrosli", "link": "https://stackoverflow.com/users/5501829/finazrosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1450841229, "creation_date": 1450841229, "answer_id": 34428166, "question_id": 34418025, "link": "https://stackoverflow.com/questions/34418025/how-to-apply-two-filters-to-a-split-form-to-robustly-update-records-in-a-table/34428166#34428166", "title": "How to apply two filters to a split form to robustly update records in a table", "body": "<p><strong>Answer for question 1</strong></p>\n\n<p>1.Open form Design View </p>\n\n<p>2.Click at the table at the bottom of your form</p>\n\n<p>3.Open Property Sheet for that table </p>\n\n<p>4.Open Data at Property Sheet. You will see <strong>Link Master Fields</strong> and <strong>Link Child Fields</strong>. Click at <strong>...</strong> sign and it will appear <strong>Subform Field Linker</strong>. Fill in the master and child field's column as you desired (eg. LA, color, place). Then the form will show the result.</p>\n\n<p><strong>Answer for Question 2</strong></p>\n\n<p>You have to use vba code under UPDATE RECORD button. For clearing the form after saving the record, use  <code>DoCmd.OpenForm \"your form name\",,,,acFormAdd</code></p>\n\n<p><strong>Example answer for question 2:</strong></p>\n\n<pre><code>Private Sub TESTSAVE_Click()    \n\nIf MsgBox(\"Changes have been made to this record.\" _\n    &amp; vbCrLf &amp; vbCrLf &amp; \"Do you want to save these changes?\" _\n    , vbYesNo, \"Changes Made\") = vbYes Then\n        DoCmd.RunCommand acCmdSaveRecord\n\nDoCmd.Close\nDoCmd.OpenForm \"NewATN2\",,,,acFormAdd\n\n    Else\n        DoCmd.RunCommand acCmdUndo\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5640041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b75bcfaa2c02f2393a2dbc1b659b8b4?s=128&d=identicon&r=PG&f=1", "display_name": "JER", "link": "https://stackoverflow.com/users/5640041/jer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459415667, "creation_date": 1450794255, "last_edit_date": 1459415667, "question_id": 34418025, "link": "https://stackoverflow.com/questions/34418025/how-to-apply-two-filters-to-a-split-form-to-robustly-update-records-in-a-table", "title": "How to apply two filters to a split form to robustly update records in a table", "body": "<p>I am storing data on eye colour, for example. I have a table about  containing 100's of contact details for people in many different local authorities (LA). These contact details change frequently and a team of users will update the table when necessary. </p>\n\n<p>I want to make a split form to do this for us. The idea is to be able to use a drop-down menu for both the LA (location) and the eye colour in the form, to filter the table below to show only the relevant contact details. </p>\n\n<p>The user can then quickly find the correct record, click on it, this will autofill the rest of the form, and any details can be changed and then saved.</p>\n\n<p>My problem is that I can't make the form robust enough to not erroneously overprint existing contact details, and I can't get a two step filter process to work. The contact details for previous records don't seem to clear, even when filtering for different places, so it is easy to muddle up and overprint records.</p>\n\n<p>Here is a screen shot of the form so far:</p>\n\n<p>example of the split form, filtered for records from Broadland but not by colour yet</p>\n\n<p><a href=\"https://i.stack.imgur.com/JEMD0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JEMD0.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the VBA</p>\n\n<pre><code>    Option Compare Database\n\nPrivate Sub Detail_Click()\n\nEnd Sub\n\nPrivate Sub LA_AfterUpdate()\n\nMe.Filter = \"[LA] = \" &amp; Chr(34) &amp; Me.LA &amp; Chr(34)\nMe.FilterOn = True\n\nEnd Sub\n\n\nPrivate Sub UpdateRecord_Click()\nRunCommand acCmdSaveRecord\n     Me.Requery\nEnd Sub\n</code></pre>\n\n<p>If anyone could help with:</p>\n\n<ol>\n<li>How do I filter for colour as well as place? </li>\n<li>How can I make the form save the amended record and then clear the form so that no records are overprinted?</li>\n<li>If I filter for one thing and click to bring up the full record, how can I make the form drop this record and change to a different one if I decide to re-filter and pick a different record</li>\n</ol>\n\n<p>I would be very grateful! Thank you in advance. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450795407, "post_id": 34418272, "comment_id": 56577739, "body": "You need to double up the quotes within the formula. ;)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1450795597, "post_id": 34418272, "comment_id": 56577845, "body": "Also, I&#39;d probably use <code>&quot;=LEFT(Input!R[-2]C[-92]&amp;&quot;&quot; &quot;&quot;,FIND(&quot;&quot; &quot;&quot;,Input!R[-2]C[-92])-1)&quot;</code> in case there isn&#39;t always a space in the original text. :)"}, {"owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1450795649, "post_id": 34418272, "comment_id": 56577872, "body": "Hi, Thank you for your response. This is causing a Compile error: Expected: end of statementafter the find(&quot;   Any thoughts?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1450795774, "post_id": 34418272, "comment_id": 56577950, "body": "@JDRows did you note the revision where we had to double the quotes?"}, {"owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1450796433, "post_id": 34418272, "comment_id": 56578416, "body": "Sorry to be a pain how do I make it so that if there is no space to return the value of the cell?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1450797133, "post_id": 34418272, "comment_id": 56578869, "body": "I am reasonably certain that if you play with your formula on a worksheet, you wlil be able to figure it out. You&#39;ll need to enclose your formula within an <code>IFERROR</code> formula..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1450797472, "post_id": 34418272, "comment_id": 56579092, "body": "SOmething like <code>=IFERROR(FIND(&quot; &quot;,Input!R[-2]C[-92]),Input!R[-2]C[-92], __the rest of your fomula__)</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1450798745, "post_id": 34418272, "comment_id": 56579946, "body": "@JDRows You could use what I put in my second comment."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 5, "last_activity_date": 1450795423, "last_edit_date": 1495541245, "creation_date": 1450795018, "answer_id": 34418272, "question_id": 34417920, "link": "https://stackoverflow.com/questions/34417920/vba-find-left-until-space-using-formular1c1/34418272#34418272", "title": "VBA find left until space using FormulaR1C1", "body": "<p>Instead of hard-coding <code>2</code> as the second argument for the <code>LEFT</code> function, use the <code>FIND</code> function:</p>\n\n<pre><code>\"=LEFT(Input!R[-2]C[-92],FIND(\"\" \"\",Input!R[-2]C[-92])-1)\"\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">learn to avoid <code>Select</code></a>. It's often unnecessary, and a main cause of errors.</p>\n\n<p>Your code can be simplified I think to a <em>single</em> statement:</p>\n\n<pre><code>Range(\"EB5:EB\" &amp; rownumfinal).FormulaR1C1 = _\n    \"=LEFT(Input!R[-2]C[-92],FIND(\"\" \"\",Input!R[-2]C[-92])-1)\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450795423, "creation_date": 1450793974, "last_edit_date": 1450794902, "question_id": 34417920, "link": "https://stackoverflow.com/questions/34417920/vba-find-left-until-space-using-formular1c1", "title": "VBA find left until space using FormulaR1C1", "body": "<p>I currently have a piece of VBA code that looks for the first two characters on the left which is:</p>\n\n<pre><code>Range(\"EB5\").Select\nActiveCell.FormulaR1C1 = \"=LEFT(Input!R[-2]C[-92],2)\"\nRange(\"EB5\").Select\nSelection.AutoFill Destination:=Range(\"EB5:EB\" &amp; rownumfinal)\n</code></pre>\n\n<p>I however want this to find the characters on the left until there is a space.</p>\n\n<p>Could anyone advise on how to do this?</p>\n"}]