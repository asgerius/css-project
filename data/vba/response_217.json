[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1551916943, "post_id": 55034038, "comment_id": 96820617, "body": "trimming your code to show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> will help us help you easier"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1551917298, "post_id": 55034038, "comment_id": 96820704, "body": "When adding charts via code it&#39;s a good idea to first remove any &quot;default&quot; series which might have been added, then explicitly add the data you want to be displayed.  You set the data for <code>ch</code>, but not for <code>ch1</code>"}], "owner": {"reputation": 45, "user_id": 6655922, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/13371fb8da8afe697011514b8ab555b7?s=128&d=identicon&r=PG&f=1", "display_name": "Faical", "link": "https://stackoverflow.com/users/6655922/faical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551945968, "creation_date": 1551916692, "last_edit_date": 1551945968, "question_id": 55034038, "link": "https://stackoverflow.com/questions/55034038/how-can-i-visualize-specific-columns-using-excel-vba", "title": "How can I visualize specific columns using Excel VBA", "body": "<p>I built the following VBA code that automatically creates the PIVOT table and the charts on a new worksheet. \nThe Pivot table is fine. The Bar chart is fine too. However, the Pie Chart (chart 2) is picking the \"closed\" column data (Column 1 in the Pivot table) from the Pivot table. I want it to pick the Grand total column, which is column 3 in the PT. </p>\n\n<p>I tried to change the range on the top of the code, but it didn't work. I also removed the bar chart and executed with the PT and the Pie chart only and still same problem (the data is reading from the \"Closed\" column only). </p>\n\n<p>Attachment: Contains screenshot of the output. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Tpsls.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tpsls.png\" alt=\"A screenshot of the output\"></a></p>\n\n<p>Here is my code below: </p>\n\n<pre><code>  Sub PT_C_RiskType_Status()\n\n\n    'Defining the variables\n\n    Dim pc As PivotCache\n    Dim ws As Worksheet\n    Dim pt As PivotTable\n    Dim sh As Shape\n    Dim sh1 As Shape\n    Dim ch As Chart\n    Dim ch1 As Chart\n\n     Set pc = ThisWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=\"DataSource\", _\n    Version:=xlPivotTableVersion15)\n\n    Set ws = Sheets.Add\n\n    ws.Select\n    Cells(3, 1).Select\n    Range(\"A3\").Select\n\n     'Create the pivot table\n      Set pt = pc.CreatePivotTable(TableDestination:=ws.Name &amp; \"!R3C1\", TableName:=\"Pivottable\")\n\n     'Adding the data fields\n       pt.AddDataField _\n        Field:=pt.PivotFields(\"Status\"), _\n        Function:=XlConsolidationFunction.xlCount\n        'Adding the fields\n       pt.AddFields _\n        RowFields:=\"Risk Type\", _\n        ColumnFields:=\"Status\", _\n        PageFields:=Array(\"Date Received\", \"Risk Level\")\n\n    'Adding formatting options\n  pt.DataFields(1).NumberFormat = \"0\"\n\n     'Adding Filters for the pivot\n\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Date Received\")\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n    ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Date Received\"). _\n        EnableMultiplePageItems = True\n\n\n        With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Risk Level\")\n        .PivotItems(\"N/A\").Visible = False\n    End With\n    ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Risk Level\"). _\n        EnableMultiplePageItems = True\n\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Risk Type\")\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Status\")\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n     'Adding chart\n    Set sh = ws.Shapes.AddChart2( _\n                XlChartType:=XlChartType.xlColumnStacked, _\n                Width:=350, Height:=300)\n\n    Set sh1 = ws.Shapes.AddChart2( _\n                XlChartType:=XlChartType.xlPie, _\n                Width:=200, Height:=200)\n\n    Set ch1 = sh1.Chart\n    Set ch = sh.Chart\n    'The position of the chart (the Column Stacked Chart)\n    ch.SetSourceData pt.TableRange1\n    sh.Top = pt.TableRange1.Top\n    sh.Left = pt.TableRange1.Left + pt.TableRange1.Width + 10\n    'The position of the chart1 (The Pie Chart)\n    sh1.Left = sh.Left - sh.Width\n    'Formatting for chart and chart1\n    'Colors the area for \"Opened\" status\n\n    ch.FullSeriesCollection(2).Select\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent4\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = 0.400000006\n        .Transparency = 0\n        .Solid\n    End With\n 'Colors the area for \"Closed\" status\n    ch.FullSeriesCollection(1).Select\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent3\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = -0.25\n        .Transparency = 0\n        .Solid\n    End With\n   'Formatting the labels inside the bars\n    'Adding data labels to the bars\n      ch.ApplyDataLabels (xlDataLabelsShowValue)\n   'Formatting Chart1 (Pie Chart)\n\n\n    ch1.ChartTitle.Select\n    Selection.Delete    'Delete the title\n\n    'Changing the color of the second portion of the chart\n    ch1.FullSeriesCollection(1).Select\n    ch1.FullSeriesCollection(1).Points(2).Select\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent4\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = 0.400000006\n        .Transparency = 0\n        .Solid\n    End With\n   ' Moving the chart to the bottom of the pivot table\n    ActiveSheet.Shapes(\"Chart 2\").IncrementLeft 2.5\n    ActiveSheet.Shapes(\"Chart 2\").IncrementTop 97.5\n\nEnd Sub\n</code></pre>\n\n<p>Please advise. </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba", "match"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1551915568, "post_id": 55033748, "comment_id": 96820287, "body": "Always best to include whatever code you&#39;ve already tried, along with a description of what problem(s) you ran into."}], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1551918288, "creation_date": 1551918288, "answer_id": 55034250, "question_id": 55033748, "link": "https://stackoverflow.com/questions/55033748/excel-vba-vlookup-on-a-specific-column-in-a-named-table-and-replacing-value-if/55034250#55034250", "title": "Excel VBA: vLookup on a specific column in a Named Table and replacing value if it matches with multiple criteria and wildcard", "body": "<p>If the first 2 letters are unique to a manager like on your example, remove the # sign from the Managers table and on the resources table use the formula:</p>\n\n<pre><code>=IFERROR(VLOOKUP(LEFT(A2,2)&amp;\"*\",Sheet2!A:B,2,FALSE),\"Not found\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5431977, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207556152049370/picture?type=large", "display_name": "Adam Jackson", "link": "https://stackoverflow.com/users/5431977/adam-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55034250, "answer_count": 1, "score": 0, "last_activity_date": 1551918288, "creation_date": 1551914485, "question_id": 55033748, "link": "https://stackoverflow.com/questions/55033748/excel-vba-vlookup-on-a-specific-column-in-a-named-table-and-replacing-value-if", "title": "Excel VBA: vLookup on a specific column in a Named Table and replacing value if it matches with multiple criteria and wildcard", "body": "<p>I'd like to create a macro that will take the name of the resource and do a vLookup (or similar action) on another table to find the matching resource manager's info, then replace the NULL manager name and email address in the first table with the manager info that corresponds to that Resource. The end goal is to complete my table with the Generic Resource's manager and their email address. </p>\n\n<p>I have a table on Sheet1 named \"Resources\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/ycAkx.png\" rel=\"nofollow noreferrer\">\"Resources\" table</a></p>\n\n<p>I also have a table on Sheet2 named \"ManagerLookup\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/mHYcT.jpg\" rel=\"nofollow noreferrer\">\"ManagerLookup\" table</a></p>\n\n<p>How can I loop through each Resource Name in my table to match the resources up with their correct manager? I'm only looking to replace the manager fields for which I have a match on the Resource Name. I can't only perform vlookup on rows with a \"NULL\" Manager name, since my data does not only use \"NULL\" for missing manager names (sometimes it's different).</p>\n\n<p>I've searched for hours and can't find anything, but I need a clean way to do this. Also worth noting is that the \"Resources\" table doesn't ever get larger than about 500 rows so processing time is not a factor here. I'm using Excel 2016.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1551913268, "post_id": 55033511, "comment_id": 96819595, "body": "Can you explain what you&#39;re trying to do, not so much the code but in broader terms? I take it you understand that <code>Union</code> doesn&#39;t work across sheets, but it&#39;s not exactly clear what you want to do with <code>NewRange</code> or <code>MyCount</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551914083, "post_id": 55033511, "comment_id": 96819868, "body": "If Union across sheets <i>did</i> work, then what would you be doing with that range?"}, {"owner": {"reputation": 1, "user_id": 11162483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc6371a3bb42861b6836bf3b5b4d7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rogers", "link": "https://stackoverflow.com/users/11162483/sam-rogers"}, "edited": false, "score": 0, "creation_date": 1551914854, "post_id": 55033511, "comment_id": 96820104, "body": "Hi. Thank you both for replying!  I&#39;m looking for a specific phrase in a cell and if Excel finds it, I&#39;m having it paste data from specific columns in that row into specific columns in a consolidated summary sheet. Like for instance if any of the cells in column D in the sheet named &quot;GL&quot; have the phrase &quot;Computer Checks&quot; in them, I&#39;m pasting the date, the journal entry number, the payee, the check number, and the amount elsewhere. The other example is the other side with more or less the same information. I can then use formulas to check for a match between the data sets."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1551916755, "post_id": 55033511, "comment_id": 96820579, "body": "Do you want to paste the data from GL sheet in the consolidated sheet, then the data from BS sheet under the GL data, and so forth? If so, just write the data after looping through the sheet. Alternatively, you can load data directly into an array, then write the array to the consolidated sheet when done."}, {"owner": {"reputation": 1, "user_id": 11162483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc6371a3bb42861b6836bf3b5b4d7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rogers", "link": "https://stackoverflow.com/users/11162483/sam-rogers"}, "edited": false, "score": 0, "creation_date": 1551917118, "post_id": 55033511, "comment_id": 96820658, "body": "They&#39;re side by side columns so that I can &quot;show the work&quot; and have it be easily interpreted by others. My goal is to have one big macro so that they don&#39;t have to remember which order to do them in. I want co-workers to see what data is needed to do the cross check but don&#39;t necessarily want them to start cutting and pasting or vlookup&#39;ing the workbook to hell because that leads to data falling through the cracks."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1551923941, "post_id": 55033511, "comment_id": 96822182, "body": "I presume you hope to save time by creating a range of preselected cells, effectively excluding unqualified cells from further processing. However, by processing row by row you could have finished the job with the same effort it takes to create the Union range."}, {"owner": {"reputation": 1, "user_id": 11162483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc6371a3bb42861b6836bf3b5b4d7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rogers", "link": "https://stackoverflow.com/users/11162483/sam-rogers"}, "edited": false, "score": 0, "creation_date": 1551937303, "post_id": 55033511, "comment_id": 96825359, "body": "My goal is to find all the checks in a general ledger, find all the checks in a bank statement, paste them in a separate checks reconciliation tab, and then paste the resulting checks issued but not yet cashed into a separate outstanding checks tab. There&#39;s ways to do this manually and using vlookups or index/match but one is prone to error and the other requires a user that has a good grasp of intermediate formulas. The macros might have extraneous language but I haven&#39;t been provided with an alternate solution that does what I need with minimal end user input."}], "owner": {"reputation": 1, "user_id": 11162483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc6371a3bb42861b6836bf3b5b4d7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rogers", "link": "https://stackoverflow.com/users/11162483/sam-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551912921, "creation_date": 1551912921, "question_id": 55033511, "link": "https://stackoverflow.com/questions/55033511/excel-vba-alternatives-to-application-union-across-sheets", "title": "Excel VBA: Alternatives to &quot;Application.Union&quot; across sheets?", "body": "<p>Below are two examples of code that I'm hoping to incorporate into one macro but I know Application.Union has its limits. I tried setting up an AllAreas and Idx type of deal but couldn't get the syntax correct for the ranges. Could someone please take a look at this and let me know how best to condense it into one macro? Any help would be appreciated. Thanks.</p>\n\n<pre><code>For Each cell In Worksheets(\"GL\").Range(\"D1:D2000\")\n    If cell.Value = \"Computer Checks\" Then\n        If MyCount = 1 Then Set NewRange = cell.Offset(0, 1)\n        Set NewRange = Application.Union(NewRange, cell.Offset(0, 1))\n        MyCount = MyCount + 1\n    End If\nNext cell\n\nFor Each cell In Worksheets(\"BS\").Range(\"D1:D2000\")\n    If cell.Value = \"CHECK PAID\" Then\n        If MyCount = 1 Then Set NewRange = cell.Offset(0, -3)\n        Set NewRange = Application.Union(NewRange, cell.Offset(0, -3))\n        MyCount = MyCount + 1\n    End If\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551916643, "post_id": 55033465, "comment_id": 96820544, "body": "The problem seems pretty clear - you can&#39;t save a workbook using the same name as an already-open workbook (and you never close any of the workbooks you&#39;ve created in the loop).  Are you really using the same name each time?"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551920368, "post_id": 55033465, "comment_id": 96821389, "body": "@TimWilliams yes I do have 7 names to be refreshed and copy pasted into the new workbook. It is the reason you see the change value = 8 in the code. So each time looping to the same condition, refresh cell value to 7,6,5,4... and for each of them create a new worksheet with different name into the same workbook, which is then saved locally."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551920455, "post_id": 55033465, "comment_id": 96821408, "body": "<code>Workbooks.Add</code> creates a new workbook, not a new worksheet."}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551920678, "post_id": 55033465, "comment_id": 96821452, "body": "@TimWilliams would that allow to have the 8 worksheets all into the same workbook? or should I move then the save as path at the end of the code?"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553615958, "post_id": 55033465, "comment_id": 97446755, "body": "@TimWilliams thanks Tim. I was able to correct the error thanks to your guidance, now I face a new error from the code for the paste special view. Anyway appreciated the help greatly."}], "owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553615914, "creation_date": 1551912656, "last_edit_date": 1553615914, "question_id": 55033465, "link": "https://stackoverflow.com/questions/55033465/vba-copy-pastespecial-method-of-range-class-failed-1004", "title": "VBA copy pastespecial method of range class failed 1004", "body": "<p>Re-editing the post due to a new issue. This time, I passed the issue on creating a new workbook, but now, the past special value do not work properly. \nI need to copy paste 8 times the same sheets into a new one, with each refreshed by a different Geographies (i.e. Europe, North America etc..).\nI get each time a - Run time error '1004' as specified in the title. I'd like to paste as value, formats and column widths as the initial sheet has formulas. How can I update the vba to make it work? :-) Thank you in advance Team.</p>\n\n<pre><code>Sub Export()\nDim lRow, lCol As Integer\nWorkbooks.Add\nPath = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\"\nActiveWorkbook.SaveAs Path &amp; \"GMCommits.xlsm\",    FileFormat:=XlFileFormat.xlOpenXMLWorkbookMacroEnabled\nWorkbooks(\"1\").Activate\nSheets(\"1\").Select\nRange(\"E4\").Value = \"8\" \nApplication.Calculate\n\nSheets(\"2\").Select\nlRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nlCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor Each cell In Range(Cells(1, \"C\"), Cells(1, lCol))\nUnion(Range(\"C1:AE\" &amp; lRow), Range(Cells(1, cell.Column), Cells(lRow, cell.Column))).Copy\n\nWorkbooks(\"2\").Activate\nRange(\"A1\").PasteSpecial Paste:=xlPasteFormats\nRange(\"A1\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nRange(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\nNext cell\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>The code is stopping at the second Range A1 pastespecial. \nThe VBA routine is to refresh 8 times the value from the Geographies, and copy paste it into a new sheets in the workbook 2 then finish the module by End sub.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551911831, "post_id": 55033276, "comment_id": 96819013, "body": "Will be slightly faster if you <code>Exit For</code> after finding a match.  Do you really have hundreds of thousands of contacts ?  You could try building a lookup dictionary (stored as a Global variable) with sender as key and contact as value - once it was built then lookups would be fast."}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 1, "creation_date": 1551912306, "post_id": 55033276, "comment_id": 96819185, "body": "I&#39;m not sure but maybe the example on the bottom of this page will help:<a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa220093(v%3Doffice.11)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/devel&zwnj;&#8203;oper/&hellip;</a> It seems like it&#39;s possible to use some kind of query over the entire item collection."}, {"owner": {"reputation": 1, "user_id": 11162413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538002322940577/picture?type=large", "display_name": "Brandon Trujillo", "link": "https://stackoverflow.com/users/11162413/brandon-trujillo"}, "edited": false, "score": 0, "creation_date": 1551912438, "post_id": 55033276, "comment_id": 96819241, "body": "Estimated to be about 750k but could even be higher. Is a lookup dictionary something I can create in VBA for outlook?"}, {"owner": {"reputation": 1, "user_id": 11162413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538002322940577/picture?type=large", "display_name": "Brandon Trujillo", "link": "https://stackoverflow.com/users/11162413/brandon-trujillo"}, "reply_to_user": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1551914237, "post_id": 55033276, "comment_id": 96819917, "body": "@AlexdeJong. rewrote the code to implement what you sent and it ran in &lt;1second! I am still not sure of how it will handle 750K as opposed to 10K, but it massively improved the solution. Thanks!"}, {"owner": {"reputation": 1, "user_id": 11162413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538002322940577/picture?type=large", "display_name": "Brandon Trujillo", "link": "https://stackoverflow.com/users/11162413/brandon-trujillo"}, "edited": false, "score": 0, "creation_date": 1551919934, "post_id": 55033276, "comment_id": 96821301, "body": "looking like I am not going to be able to upload all the contact into outlook :( . Anyone have insight on how I could make an excel solution work?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1551941301, "post_id": 55033276, "comment_id": 96826656, "body": "@BrandonTrujillo Speed of sending mails also depends on the speed performance of Outlook. Could you consider splitting your massive job in separate parts. Auto Forwarding to addresses in contacts list is a reasonably fast option. However exchange server normally does not allow auto forwarding.withot following a special procedure. While servers at Gmail allow auto forwarding. You can set rules for auto forwarding which permits from whom to whom for various conditions and reduce your massive list to a smaller size for which VBA may be considered. Any thoughts of yours on this."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1552012210, "post_id": 55033276, "comment_id": 96860876, "body": "Can you post your updated code?"}, {"owner": {"reputation": 1, "user_id": 11162413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538002322940577/picture?type=large", "display_name": "Brandon Trujillo", "link": "https://stackoverflow.com/users/11162413/brandon-trujillo"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1552063548, "post_id": 55033276, "comment_id": 96882520, "body": "@0m3r I apologize, but once I found out I couldn&#39;t get enough contacts in Outlook I scrapped it. If you are looking for use of the find code though, I would be happy to try and reconstruct."}, {"owner": {"reputation": 1, "user_id": 11162413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538002322940577/picture?type=large", "display_name": "Brandon Trujillo", "link": "https://stackoverflow.com/users/11162413/brandon-trujillo"}, "edited": false, "score": 0, "creation_date": 1552063552, "post_id": 55033276, "comment_id": 96882522, "body": "In the meantime I have a solution that I added to the bottom of my post. I was able to get into excel. The one weird thing I did was since it was taking way to long to do a loop search in excel, I decided to make excel do the work, so I but a vlookup formula in cell D1 with C1 as the lookup value. I then have the script set the value of C1 to the sendersEmail address. Then I pull the value of D1. I still feel like there is a better way, but this script runs in ~2seconds with &gt;750K emails in the table."}], "owner": {"reputation": 1, "user_id": 11162413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538002322940577/picture?type=large", "display_name": "Brandon Trujillo", "link": "https://stackoverflow.com/users/11162413/brandon-trujillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592688829, "creation_date": 1551911640, "last_edit_date": 1592688829, "question_id": 55033276, "link": "https://stackoverflow.com/questions/55033276/outlook-script-forward-emails-based-on-excel-data-table", "title": "Outlook Script: Forward emails based on Excel data table", "body": "<p>I am trying to solve for the following. </p>\n\n<p>I have an inbox that accepts emails from hundreds of thousands of senders. Each sender has an assigned account rep. </p>\n\n<p>I want an outlook script that will intelligently forward the incoming emails to their proper account rep. </p>\n\n<p>My initial thought was to write an Outlook script that referenced an Excel sheet that would contain 2 columns </p>\n\n<p>(1 for the senders email address and 1 for the email to send it to) but after many failed attempts at getting Outlook to talk to Excel, I decided to try it using outlook contacts. </p>\n\n<p>I came up with the following script.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TestForward(Item As Outlook.MailItem)\n\n  Dim Folder As Outlook.MAPIFolder\n  Dim Items As Outlook.Items\n  Dim obj As Object\n  Dim Contact As Outlook.ContactItem\n  Dim emailSender As String\n  Dim TPOCustomer\n  Dim HMC As String\n  Dim olNs As Outlook.NameSpace\n  Dim olApp As Outlook.Application\n\n  Set olApp = New Outlook.Application\n  Set olNs = olApp.GetNamespace(\"MAPI\")\n\n\n\n  emailSender = Item.SenderEmailAddress\n\n  Set Folder = olNs.GetDefaultFolder(olFolderContacts).Folders(\"TPO HMC\").Folders(\"test\")\n  If Folder Is Nothing Then Exit Sub\n  If Folder.DefaultItemType = olContactItem Then\n  Dim i As Integer\n    Set Items = Folder.Items\n    For Each obj In Items\n      If TypeOf obj Is Outlook.ContactItem Then\n        Set Contact = obj\n        TPOCustomer = Contact.FirstName\n        If TPOCustomer = emailSender Then\n          HMC = Contact.Email1Address\n          Set myForward = Item.Forward\n          myForward.Recipients.Add HMC\n          myForward.Send\n        End If\n      End If\n    Next\n  End If\n\n\nEnd Sub\n</code></pre>\n\n<p>'********************************************************************</p>\n\n<p>It works, but runs incredibly slow. It takes about 60-90 seconds to process 1 email with only 10k test contacts. I imagine if I make it search through hundreds of thousands it will crash my email.</p>\n\n<p>I am open to any suggestions to solve the original problem. I am still thinking referencing Excel is the way to go. Sorry for the sloppy code I am a VB novice and this is my first time trying to use it for an Outlook script</p>\n\n<pre><code>'Creating Public variables to handle Outlook Application\n  Dim olNs As Outlook.NameSpace\n  Dim olApp As Outlook.Application\n  Dim Folder As Outlook.MAPIFolder\n  Dim Items As Outlook.Items\n  Dim obj As Object\n  Dim emailSender As String\n  Dim TPOCustomer\n  Dim HMC As String\n\n\n'Public Function to Create and search through Excel Document\nPublic Function openExcel()\n\n'Create the Excel instance\n     Dim xlApp As Object\n     Dim sourceWB\n     Dim sourceWS\n\n     Set xlApp = CreateObject(\"Excel.Application\")\n\n     With xlApp\n         .Visible = False\n         .EnableEvents = True\n     End With\n\n'Set path of Excel workbook\n     strFile = \"\\\\azt2nsf701z1.wellsfargo.net\\C_MTGCRS_Users\\U495570\\My Documents\\testTPO3.xlsx\"\n\n'Set workbook and worksheet\n     Set sourceWB = xlApp.Workbooks.Open(strFile, , False, , , , , , , True)\n     Set sourceWS = sourceWB.Worksheets(\"testTPO\")\n\n\n\n\nsourceWS.Range(\"C1\").Value = emailSender\n\nsourceWS.Range(\"D1\").Calculate\nHMC = sourceWS.Range(\"D1\").Value\n\n\n\n     sourceWB.Activate\n\n\n\n\n\n End Function\n\n\nSub TestForward(Item As Outlook.MailItem)\n\n 'Set Outlook Application\n  Set olApp = New Outlook.Application\n  Set olNs = olApp.GetNamespace(\"MAPI\")\n\n 'Set the email Sender\n  emailSender = Item.SenderEmailAddress\n\nCall openExcel\n\n'Forward the email\nSet myForward = Item.Forward\nmyForward.Recipients.Add HMC\nmyForward.Send\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551910033, "post_id": 55032836, "comment_id": 96818403, "body": "Entering that formula in a worksheet named March only returned an error for me."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1551910927, "post_id": 55032836, "comment_id": 96818693, "body": "@dwirony was the workbook saved? If not this will definitely return an error."}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 2, "creation_date": 1551911066, "post_id": 55032836, "comment_id": 96818738, "body": "Look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event. Intersect on that page is a useful concept if you know the column that will have dates."}, {"owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551923270, "post_id": 55032836, "comment_id": 96822030, "body": "@dwirony It&#39;s working for me 100% with French month (try &quot;Mars&quot; instead of &quot;March&quot;). I don&#39;t know if it&#39;s language related, but I&#39;m confident it&#39;s working."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "edited": false, "score": 0, "creation_date": 1551922923, "post_id": 55033639, "comment_id": 96821963, "body": "Thanks for your work! Unfortunately I can&#39;t seem to make anything work. It returns &quot;Compile error : ambiguous name detected : Worksheet_Change&quot;. I&#39;m gonna dive deeper and try to make it work :). The main function should be in a module and the worksheet change portion on the sheet with dates right ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "edited": false, "score": 0, "creation_date": 1551923502, "post_id": 55033639, "comment_id": 96822088, "body": "Yes. Sounds like you have another worksheet change instance, which you shouldn&#39;t."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1551913825, "creation_date": 1551913825, "answer_id": 55033639, "question_id": 55032836, "link": "https://stackoverflow.com/questions/55032836/autofill-date-by-referring-only-one-number-with-excel-vba/55033639#55033639", "title": "Autofill date by referring only one number with excel VBA", "body": "<p>This may need modified to fit your needs, but maybe a solution like this using the <code>Worksheet_Change</code> event.</p>\n\n<p><em>Worksheet Change portion:</em></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo SafeExit:\n    Application.EnableEvents = False\n        If Target.Cells.Count = 1 Then ' \n            If Not Intersect(Target, Me.Columns(\"A\")) Is Nothing Then 'change as needed\n                Target.Value = DateFromDay(Me.Name, Target.Value)\n            End If\n        End If\nSafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><em>Main Function</em></p>\n\n<pre><code>Public Function DateFromDay(monthName As String, dayNum As Integer) As Date\n    On Error Resume Next\n    DateFromDay = DateValue(dayNum &amp; \" \" &amp; monthName &amp; \" \" &amp; Year(Now()))\nEnd Function\n</code></pre>\n\n<p>You might consider the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\"><code>Workbook_SheetChange</code></a> event as well to add this functionality to multiple sheets.</p>\n"}], "owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551945670, "creation_date": 1551909592, "last_edit_date": 1551945670, "question_id": 55032836, "link": "https://stackoverflow.com/questions/55032836/autofill-date-by-referring-only-one-number-with-excel-vba", "title": "Autofill date by referring only one number with excel VBA", "body": "<p><strong>What if we could fill a date by only referring a number ?</strong> This type of feature would improve user-friendliness in some excel scenarios. </p>\n\n<p>For instance : In March sheet, when I type \"7\" in a given dates column, the cell in which I inserted the value would return \"07/03/19\" (or 03/07/19). </p>\n\n<p>If possible, this means I need to specify in the VBA code the month and year for this sheet, and change this variable for every single sheet (february etc.). If the sheet names are months names (Eg \"March\"), there could even be a way to do it with a one solution VBA code. The following formula takes advantages of it, so I guess VBA could do it to. </p>\n\n<pre><code>=MONTH(DATEVALUE(MID(CELL(\"filename\";$A$1);FIND(\"]\";CELL(\"filename\";$A$1))+1;255)&amp;\" 1\"))\n</code></pre>\n\n<p>Enter this formula in a sheet named \"March\" and it will return \"3\".</p>\n\n<p>I have been looking for a simple way to do this, but there is none to my knowledge (until you bring your light :)). Data validation feature won't help as far as I know. Also, it's important that the cell in which the number is inserted autofill itself (not another cell).</p>\n\n<p>Is this at least possible ? I bet yes. I've been told to look at event function, but I know too little with VBA.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "edited": false, "score": 0, "creation_date": 1552079383, "post_id": 55038066, "comment_id": 96889620, "body": "Thanks - will give this a try."}, {"owner": {"reputation": 436, "user_id": 1391084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db2f2b28d7d1c2050787050a6e54e93?s=128&d=identicon&r=PG", "display_name": "ashdiggedy", "link": "https://stackoverflow.com/users/1391084/ashdiggedy"}, "reply_to_user": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "edited": false, "score": 0, "creation_date": 1552525510, "post_id": 55038066, "comment_id": 97047162, "body": "Glad to hear it!  One more thing, if you are displaying the same exact fields in each of the 50 pivot tables AND each pivot table is just filtered differently, you might want to consider creating a single pivot table with &quot;slicers&quot; to quickly filter the data. I have gotten into the habit of taking this approach whenever asked to provide separate views into the same data...and more often then not, people are pleased with the results."}], "tags": [], "owner": {"reputation": 436, "user_id": 1391084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db2f2b28d7d1c2050787050a6e54e93?s=128&d=identicon&r=PG", "display_name": "ashdiggedy", "link": "https://stackoverflow.com/users/1391084/ashdiggedy"}, "is_accepted": true, "score": 1, "last_activity_date": 1551943120, "creation_date": 1551943120, "answer_id": 55038066, "question_id": 55032609, "link": "https://stackoverflow.com/questions/55032609/vba-to-create-multiple-pivot-tables/55038066#55038066", "title": "VBA to Create Multiple Pivot Tables", "body": "<p>You could simplify things by using code to create 1 new sheet with a base pivot table, then copy that sheet 49 times. From that point, it wouldn't be too difficult to rename the sheets and reference the respective pivot tables using additional code, especially if there's only a single pivot table per sheet.</p>\n"}], "owner": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55038066, "answer_count": 1, "score": 0, "last_activity_date": 1551943120, "creation_date": 1551908461, "question_id": 55032609, "link": "https://stackoverflow.com/questions/55032609/vba-to-create-multiple-pivot-tables", "title": "VBA to Create Multiple Pivot Tables", "body": "<p>I have a requirement to create 50 'base' pivot tables out of the same data sheet, so was hoping to write a VBA script to create 50 worksheets and the pivot tables for each. I tried to record a macro capturing the first 5 or so, but when I tried to run it, it crashed due to length of script. (I don't have the error message anymore but can reproduce if needed.) Can this be done with a loop? And if so, can someone please help? Thanks.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 2, "creation_date": 1551930103, "post_id": 55032327, "comment_id": 96823597, "body": "Check the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/open-method-ado-recordset?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs</a>, especially if you have undesired behavior and/or errors.  The default cursor type and lock type are <code>adOpenForwardOnly</code> and <code>adLockReadOnly</code>.  You need to set those values to something appropriate for updates and deletions."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1552041631, "post_id": 55032327, "comment_id": 96870957, "body": "Also, check in form properties if the form allows deletions. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.form.allowdeletions\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "is_accepted": true, "score": 1, "last_activity_date": 1552105299, "last_edit_date": 1592644375, "creation_date": 1552103798, "answer_id": 55073831, "question_id": 55032327, "link": "https://stackoverflow.com/questions/55032327/records-cannot-be-deleted-with-this-form-access-error/55073831#55073831", "title": "Records cannot be deleted with this form access error", "body": "<p>The reason the ADO bound form was not editable is not because of cursor type or lock type  but because of cursor location. Adding</p>\n<pre><code>rs.CursorLocation = adUseClient\n</code></pre>\n<p>did the job for me.</p>\n<p>Also in <a href=\"https://social.msdn.microsoft.com/Forums/en-US/cb739128-11b3-4304-99d0-bfd6905c80de/is-this-documentation-right-client-side-cursors-recommended-for-ado-connections-to-sqlserver?forum=accessdev\" rel=\"nofollow noreferrer\">this</a> discussion thread Dirk Goldgar writes:</p>\n<blockquote>\n<p>One possible consideration is that, if you're binding an Access form\nto an ADO recordset, I've found that using a server-side cursor makes\nthe form read-only.</p>\n</blockquote>\n<p>So far, I have not found any explanation on why this is the case. Please reply if anyone knows why server side cursor bound to Access form makes it uneditable.</p>\n<p>EDIT 1:</p>\n<p>Also Made Sure that you are using currentproject.connection and not an ADO connection string</p>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 55073831, "answer_count": 1, "score": 1, "last_activity_date": 1552105299, "creation_date": 1551907236, "question_id": 55032327, "link": "https://stackoverflow.com/questions/55032327/records-cannot-be-deleted-with-this-form-access-error", "title": "Records cannot be deleted with this form access error", "body": "<p>I have made a search box in Access that will set the Access form's recordset to ADO recordset once the result is found.</p>\n\n<p>The code is</p>\n\n<pre><code>rs.Open \"select * from main where Name= '\" &amp; Me.txtSearch.Value &amp; \"';\", CurrentProject.Connection, adOpenDynamic, adLockOptimistic\nSet Me.Recordset = rs\n</code></pre>\n\n<p>This lets me find the records much faster than default Access <code>ctrl+f</code> method which is slower with linked tables.</p>\n\n<p>However, it looks like I cannot delete the records that were found using the search field that I made.</p>\n\n<p>If i try to delete it, I get:</p>\n\n<blockquote>\n  <p>Records cannot be deleted with this form access</p>\n</blockquote>\n\n<p>at the bottom of the form.</p>\n\n<p>Is there a way to have deletable ADO record bound to Access form?</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551908677, "post_id": 55032298, "comment_id": 96817822, "body": "Hmm, try putting it in <code>A3</code>, leaving room for the &quot;pivot filter&quot; area. Side note, <code>Pivot</code> is a confusing name for a <code>Worksheet</code> variable - I&#39;d probably go with <code>sheet</code>, or <code>pivotSheet</code>."}, {"owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551908810, "post_id": 55032298, "comment_id": 96817889, "body": "I have tried A3 before but it does not work. I will make the sheet name changes as suggested."}], "answers": [{"comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "edited": false, "score": 0, "creation_date": 1551923292, "post_id": 55034621, "comment_id": 96822035, "body": "Then it is most likely your data.  If you do not have a contiguous region in <code>Sheets(&quot;CJI Data&quot;)</code> starting in <code>Range(&quot;A2&quot;)</code> that has column headings and row headings than you will get an error, otherwise the syntax is correct."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1551922226, "last_edit_date": 1551922226, "creation_date": 1551921514, "answer_id": 55034621, "question_id": 55032298, "link": "https://stackoverflow.com/questions/55032298/vba-pivot-table-dynamic-range/55034621#55034621", "title": "VBA Pivot Table dynamic range", "body": "<p>Why do you need .Address and R1C1?</p>\n\n<pre><code>Set PCache = ActiveWorkbook.PivotCaches.Create (xlDatabase, Sheets(\u201cCJI Data\u201d).Range(\u201cA2\u201d).CurrentRegion)\n</code></pre>\n\n<p>Also, no need to delete the table if the data expands, that is why you use a dynamic range.  Just refresh the table.</p>\n"}], "owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551922226, "creation_date": 1551907097, "last_edit_date": 1551908851, "question_id": 55032298, "link": "https://stackoverflow.com/questions/55032298/vba-pivot-table-dynamic-range", "title": "VBA Pivot Table dynamic range", "body": "<p>I am trying to create a VBA code for a pivot table whose rows and columns could change in future. I have used below code but I am getting a runtime error 1004 at set ptable stage. I would also like to add a code here delete worksheet \"Pivot\" if it exists and then create a new one so all data can be captured. Please can you advise. </p>\n\n<pre><code>Dim Pivot As Worksheet\nDim pCache As PivotCache\nDim pTable As PivotTable\nDim lastRows As Long\nSet Pivot = Worksheets.Add\nSet pCache = ActiveWorkbook.PivotCaches.Create(xlDatabase, Sheets(\"CJI Data\").Range(\"A2\").CurrentRegion.Address(ReferenceStyle:=xlR1C1))\nSet pTable = pCache.CreatePivotTable(Pivot.Range(\"A1\"))\n</code></pre>\n\n<p>Thanks,\nR</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551905224, "post_id": 55031791, "comment_id": 96816371, "body": "What do you want to do, copy or cut the active cell up 1 and 1 to the right? You should have a look at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10129873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dta9QqFA6gw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pj4V0znOZO3K9pD7_zXyM6JlLGlA/mo/photo.jpg?sz=128", "display_name": "Cody_15243", "link": "https://stackoverflow.com/users/10129873/cody-15243"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551905483, "post_id": 55031791, "comment_id": 96816469, "body": "I suppose it doesn&#39;t matter whether I copy or cut the cell and move it up 1 right 1 because I am ultimately removing the row that the cell was cut or copied from entirely. I assume that there&#39;s not that much of a difference between cutting and copying in terms of code (aside from the obvious cut vs. copy). I have a for loop written that gets rid of the rows after everything is copied, I just cant figure out how to do the initial copying or cutting."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1551906336, "creation_date": 1551906336, "answer_id": 55032124, "question_id": 55031791, "link": "https://stackoverflow.com/questions/55031791/copy-paste-same-sheet-and-process-but-for-the-entire-spreadsheet/55032124#55032124", "title": "Copy-Paste - Same Sheet and Process, but for the entire spreadsheet", "body": "<p>Something like this? This is a one-off operation, but could be broadened if there some broader pattern exists.</p>\n\n<pre><code>Sub x()\n\nWith ActiveCell\n    .Offset(-1, 1).Value = .Value\n    .EntireRow.Delete\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10129873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dta9QqFA6gw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pj4V0znOZO3K9pD7_zXyM6JlLGlA/mo/photo.jpg?sz=128", "display_name": "Cody_15243", "link": "https://stackoverflow.com/users/10129873/cody-15243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551945642, "creation_date": 1551904761, "last_edit_date": 1551945642, "question_id": 55031791, "link": "https://stackoverflow.com/questions/55031791/copy-paste-same-sheet-and-process-but-for-the-entire-spreadsheet", "title": "Copy-Paste - Same Sheet and Process, but for the entire spreadsheet", "body": "<p>I'm new to VBA coding (I mostly work with R) and I am having trouble writing a macro to copy and paste. Specifically, I can do the first command fine, but when I go to the next row to do the same thing, it reverts back to the initial cell. </p>\n\n<p>Here's the code that I'm working with:</p>\n\n<pre><code>Keyboard Shortcut: Ctrl+h\n\nRange(\"B2\").Copy Range(\"C1\")\nRange(\"B4\").Copy Range(\"C3\")\nRange(\"B6\").Copy Range(\"C5\")\n</code></pre>\n\n<p>And so on...\nThis does exactly what I want it to do, but I was wondering if there is a way to generalize it so that I can highlight the first cell of each \"block\" that I wish to do this to (i.e., A1,A2,B1,B2,C1,C2 etc.) and just use the keyboard shortcut. I got it to work partially using:</p>\n\n<pre><code> Sub Format()\n\n' Format Macro\n\n' Keyboard Shortcut: Ctrl+h\n\n  Selection.Cut\n  ActiveCell.Offset(-1, 1).Range(\"A1\").Select\n  ActiveSheet.Paste\n  ActiveCell.Offset(1, -1).Range(\"A1\").Select\n  Selection.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>But that always reverts back to the initial cell (A1 in this case) once I move on to the next block. </p>\n\n<p>Thanks for your help! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1551904734, "post_id": 55031722, "comment_id": 96816157, "body": "Exactly what does &quot;doesn&#39;t work&quot; stand for? Also, <code>lastRow</code> should be declared <code>As Long</code>, not <code>As Integer</code>. Worksheets can have many times more rows than can fit in a 16-bit signed integer type."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 1, "creation_date": 1551905189, "post_id": 55031722, "comment_id": 96816361, "body": "You will need to post the code for your function as it is obviously the problem."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551905526, "post_id": 55031722, "comment_id": 96816482, "body": "Please <a href=\"https://stackoverflow.com/posts/55031722/edit\">edit your question</a> to add the code -- it&#39;s just to difficult to properly parse when in comments"}, {"owner": {"reputation": 71, "user_id": 9924544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e96d9b3a4a1cd72089f8214407b22b52?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Liew", "link": "https://stackoverflow.com/users/9924544/michael-liew"}, "edited": false, "score": 0, "creation_date": 1551905648, "post_id": 55031722, "comment_id": 96816537, "body": "sorry i&#39;m still quite new to stackoverflow and realised that after putting in a comment with code"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551907813, "post_id": 55031722, "comment_id": 96817441, "body": "How do you know your function is returning the correct value? did you do a debug.print and check the immediate window?"}, {"owner": {"reputation": 1000, "user_id": 3050196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qFgSF.jpg?s=128&g=1", "display_name": "elektrykalAJ", "link": "https://stackoverflow.com/users/3050196/elektrykalaj"}, "edited": false, "score": 0, "creation_date": 1551910144, "post_id": 55031722, "comment_id": 96818441, "body": "Your code seemed to work for me. If you can post the specific error you are getting and the line of code that is breaking, then that would help."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1551908040, "creation_date": 1551908040, "answer_id": 55032509, "question_id": 55031722, "link": "https://stackoverflow.com/questions/55031722/how-to-update-chart-with-variable/55032509#55032509", "title": "how to update chart with variable?", "body": "<p>You should likely make sure that <code>GetLastRow()</code> returns a <code>Long</code> variable:</p>\n\n<pre><code>Sub doChart()\nDim lastRow As Long\nlastRow = GetLastRow(Sheets(\"Sheet1\")) ' Change to whatever you need\n' Next line requires the chart to be active.  You'd be better off actually directly\n' calling it, but that's for you to tweak. If there's only one chart, \n' then try Charts(1).SetSourceData ...\nActiveChart.SetSourceData Source:=Sheets(\"ChartSource\").Range(\"A1:C\" &amp; lastRow)\nEnd Sub\n\nFunction GetLastRow(sheetName As Worksheet) As Long\nGetLastRow = 1\nGetLastRow = sheetName.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\nEnd Function\n</code></pre>\n\n<p>Also, I removed the <code>On Error ...</code> in the function, because there shouldn't be any errors, and if there are it'd be best to handle.  (Worst case is that would return <code>1</code> as far as I can tell)</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1551967110, "post_id": 55045408, "comment_id": 96841538, "body": "Glad you solved it. Often when you ask a question, the solution will somehow pop out by &quot;itself&quot;...."}], "tags": [], "owner": {"reputation": 71, "user_id": 9924544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e96d9b3a4a1cd72089f8214407b22b52?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Liew", "link": "https://stackoverflow.com/users/9924544/michael-liew"}, "is_accepted": false, "score": 0, "last_activity_date": 1551966679, "creation_date": 1551966679, "answer_id": 55045408, "question_id": 55031722, "link": "https://stackoverflow.com/questions/55031722/how-to-update-chart-with-variable/55045408#55045408", "title": "how to update chart with variable?", "body": "<p>Thanks for the comments and advice</p>\n\n<p>Managed to figure it out in the end.\nIt's because I was deleting the cells that the graph was referring to</p>\n\n<p>ws.cells.delete</p>\n\n<p>i changed this to</p>\n\n<p>ws.cells.clear</p>\n\n<p>and there was no longer a problem.</p>\n"}], "owner": {"reputation": 71, "user_id": 9924544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e96d9b3a4a1cd72089f8214407b22b52?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Liew", "link": "https://stackoverflow.com/users/9924544/michael-liew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1551966679, "creation_date": 1551904390, "last_edit_date": 1551907363, "question_id": 55031722, "link": "https://stackoverflow.com/questions/55031722/how-to-update-chart-with-variable", "title": "how to update chart with variable?", "body": "<p>Hope someone can help I'm having trouble with something that should be really simple.</p>\n\n<p>I'm trying to update a chart based on changing source data (number of rows can change)</p>\n\n<p>this is my code:</p>\n\n<pre><code>lastRow = GetLastRow(ChartSourceSheet)\nActiveChart.SetSourceData Source:=Sheets(\"ChartSource\").Range(\"A1:C\" &amp; lastRow)\n</code></pre>\n\n<p>for some reason it doesn't work (getlastrow function is just a function that returns the last row number of a sheet, in this case it's 5 with my test data)</p>\n\n<p>but if i hard code the change it to:</p>\n\n<pre><code>lastRow = 5\nActiveChart.SetSourceData Source:=Sheets(\"ChartSource\").Range(\"A1:C\" &amp; lastRow)\n</code></pre>\n\n<p>then it works absolutely fine, and it's driving me nuts trying to figure out why.</p>\n\n<p>I've tried declaring lastRow as integer but it doesn't work.</p>\n\n<p>Anybody have any ideas what I can try?</p>\n\n<p>edit in response to replies:</p>\n\n<p>doesn't work means the chart just doesn't update and when I look at the data range manually it hasn't updated (in comparison to when i hardcoded the value and it updated fine) Also I tried setting lastRow to long as well and that didn't help.</p>\n\n<p>My function works fine, as it's returning the expected value (5) but for completion purposes here's the code to my function:</p>\n\n<pre><code>Function GetLastRow(sheetName As Worksheet)\nGetLastRow = 1\nOn Error Resume Next\nGetLastRow = sheetName.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\nOn Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "outlook", "character-encoding"], "comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1551905057, "post_id": 55031649, "comment_id": 96816299, "body": "Looks like the default language on your friend&#39;s laptop could be some form of Chinese (not knowing the difference between the various types of Chinese character sets), either in Outlook itself or as default language for the Desktop."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1551908330, "post_id": 55031649, "comment_id": 96817681, "body": "The output in your screenshot looks like <a href=\"https://en.wikipedia.org/wiki/Mojibake\" rel=\"nofollow noreferrer\">mojibake</a>, which you get e.g. when processing ASCII text as UTF-16 text (reading 2 bytes as 1 character instead of 1 byte as 1 character)."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1551913121, "post_id": 55031649, "comment_id": 96819545, "body": "Encoding mismatch all day long."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1551914813, "post_id": 55031649, "comment_id": 96820091, "body": "Try checking the <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/outlook.mailitem.internetcodepage\" rel=\"nofollow noreferrer\"><code>InternetCodepage</code> property</a> to identify character encoding that is being used for the message. Common ones you should end up coming across are <code>65001</code> <i>(UTF-8)</i> and <code>1252</code> <i>(Windows-1252)</i>."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1551915746, "post_id": 55031649, "comment_id": 96820317, "body": "Would also check the <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/outlook.mailitem.bodyformat\" rel=\"nofollow noreferrer\"><code>BodyFormat</code> property</a> for good measure, will be one of the <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/outlook.olbodyformat\" rel=\"nofollow noreferrer\"><code>OlBodyFormat</code> enumerations</a>. That you know whether you should be looking at <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/outlook.mailitem.body\" rel=\"nofollow noreferrer\"><code>Body</code></a>, <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/outlook.mailitem.htmlbody\" rel=\"nofollow noreferrer\"><code>HTMLBody</code></a> or <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/outlook.mailitem.rtfbody\" rel=\"nofollow noreferrer\"><code>RTFBody</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1552031537, "last_edit_date": 1552031537, "creation_date": 1551973059, "answer_id": 55047567, "question_id": 55031649, "link": "https://stackoverflow.com/questions/55031649/weird-characters-in-email-body/55047567#55047567", "title": "Weird characters in email body", "body": "<p>That sure sounds like you are running into an NDR (Non-Delivery Report - represented by the <code>ReportItem</code> object) - <code>ReportItem.Body</code> returns gibberish when accessed though the Outlook Object Model. This has been a problem for a few versions of Outlook now.</p>\n\n<p>You can either skip items like this by checking that you only get the <code>MailItem</code> object (Class property must be 43 (<code>olMail</code>)) or use <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> - its <a href=\"http://www.dimastr.com/redemption/RDOReportItem.htm\" rel=\"nofollow noreferrer\">RDOReportItem</a> object does not have this problem.</p>\n"}], "owner": {"reputation": 11, "user_id": 9990705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22e074060d9b22683dae61a652e55f3?s=128&d=identicon&r=PG&f=1", "display_name": "jefrey_76", "link": "https://stackoverflow.com/users/9990705/jefrey-76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552031537, "creation_date": 1551904070, "last_edit_date": 1551914867, "question_id": 55031649, "link": "https://stackoverflow.com/questions/55031649/weird-characters-in-email-body", "title": "Weird characters in email body", "body": "<p>I have a little problem with VBScript. There is how it should work. It is a simply code that should go through all emails in particular folder, get particular email body and try to find regular expression. It works correctly on my computer but somehow the same code is not working on other laptop (my friend laptop). Most (not all of them) of emails body look very weird like on attached screen below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jAjLn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jAjLn.jpg\" alt=\"VBS Results\"></a></p>\n\n<p>I would like to add that we had the same email messages to test. What is also curious, after use script, it converts first email into these weird characters.\nAnd this is how code looks:</p>\n\n<pre><code>Set objOutlook = CreateObject(\"Outlook.Application\")\nSet objNamespace = objOutlook.GetNamespace(\"MAPI\")\nSet objMailbox = objNamespace.Folders(Main_mailbox)\nSet objMainMailbox = objMailbox.Folders(Main_folder)\nSet objFolder = objMainMailbox.Folders(Sub_folder)\nSet re = New RegExp\nre.IgnoreCase = True\nre.Global = True\nre.Pattern = \"&lt;.+&gt;\"\n\nSet colItems = objFolder.Items\n\nNumberOfEmails = colItems.Count\nWScript.Echo NumberOfEmails &amp; \" emails found\"\nFor i = NumberOfEmails To 1 Step - 1\n    BodyMsg = colItems(i).Body\n    Lines = Split(BodyMsg, vbCrlf)\n    For j = 1 To UBound(Lines)\n        If InStr(1, Lines(j), \"Reply-To:\") Then\n            Set RegMatches = re.Execute(Lines(j))\n            For Each myMatch In RegMatches\n                OutputMatch = OutputMatch &amp; \" \" &amp; myMatch &amp; \";\"\n                OutputMatch = Replace(OutputMatch, \"&lt;\", \"\", 1, 1)\n                OutputMatch = Replace(OutputMatch, \"&gt;\", \"\", 1, 1)\n                EmailCount = EmailCount + 1\n            Next\n        End If\n    Next\nNext\n</code></pre>\n\n<p>I am wondering if it is about encoding or something like that and if that problem is caused by system settings?</p>\n\n<p>If you need some more information that I forgot mention about, please let me know.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1551908687, "post_id": 55031574, "comment_id": 96817828, "body": "Why do you want to scroll? does the site updates some data only when you scroll down to it? Edit: Different question but the answer applies: <a href=\"https://stackoverflow.com/questions/11790471/automate-page-scroll-using-vbscript\" title=\"automate page scroll using vbscript\">stackoverflow.com/questions/11790471/&hellip;</a> In short: <code>htmldoc.parentWindow.scrollBy 0, 100</code>"}, {"owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1551909901, "post_id": 55031574, "comment_id": 96818357, "body": "Yes, the site only update part of data. The data could be as much as few thousand line depend on your search. I tried parentWindow but it doesn&#39;t scroll page at all. The page is setup to have the search result displayed on lower right of the web page and has its own scroll bar."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1551910287, "post_id": 55031574, "comment_id": 96818491, "body": "It seems that it may be broken down in iframes, meaning that the lower right may be a different page. You may want to see in the code or properties. If it is a different page under an iframe, your vba code should open that iframe."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551946392, "post_id": 55031574, "comment_id": 96828973, "body": "Can you share the webpage url?"}, {"owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "edited": false, "score": 0, "creation_date": 1551970093, "post_id": 55031574, "comment_id": 96843434, "body": "To Ricardo, thanks for the reply. I will take a look at coding to see if iframe is the issue. But I have question since I was able to get partial data, is this really the iframe issue?"}, {"owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "edited": false, "score": 1, "creation_date": 1551970307, "post_id": 55031574, "comment_id": 96843591, "body": "To QHarr, unfortunately, this is a private website, I cannot share the site. Appreciate for your help anyway."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551971797, "post_id": 55031574, "comment_id": 96844535, "body": "Does the scrolling generate any web traffic you can examine in dev tools or fiddler?"}, {"owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "edited": false, "score": 0, "creation_date": 1551975879, "post_id": 55031574, "comment_id": 96847111, "body": "Thanks for the quick reply, yes I think so, when I scroll, I can see the loading icon and data won&#39;t immediate display but it did show how many lines the search found. For example, it might found 100 rows of data but only display 30 rows at a time. The number of lines display at a time depend on browser zoom level."}, {"owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "edited": false, "score": 0, "creation_date": 1551977754, "post_id": 55031574, "comment_id": 96848208, "body": "One thing I have question is onscroll=&quot;Grids[0].Scrolled()&quot;? That doesn&#39;t look like normal scroll seem in the webpage instead as function call upon. I did notice that source code did mention it is part of js script. I did not know vba well enough in this case do you have to do something different?"}, {"owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "edited": false, "score": 0, "creation_date": 1552485630, "post_id": 55031574, "comment_id": 97027737, "body": "Anyone has anymore ideas to try it? Any help is appreciated."}], "owner": {"reputation": 1, "user_id": 11161862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2472914f67a417ded86d90deb9f23cdb?s=128&d=identicon&r=PG&f=1", "display_name": "user11161862", "link": "https://stackoverflow.com/users/11161862/user11161862"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 846, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551945616, "creation_date": 1551903726, "last_edit_date": 1551945616, "question_id": 55031574, "link": "https://stackoverflow.com/questions/55031574/scraping-ie-with-vba-how-to-scroll-to-bottom-of-page", "title": "Scraping IE with VBA, how to scroll to bottom of page?", "body": "<p>I am pretty new to VBA. I'm trying to scroll to the bottom of a web page. Below is contents of web page.</p>\n\n<pre><code>&lt;DIV id=\"Table\"&gt;\n\n&lt;div style=\"width: 18px; overflow: auto; height: 912px;\" onscroll=\"Grids[0].Scrolled();\" onmousemove=\"Grids[0].ARow=null;Grids[0].ASec=-1;\"&gt;&lt;div style=\"width: 1px; overflow: hidden; height: 1954px;\"&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;'\n</code></pre>\n\n<p>This is VBA Code I have so far.</p>\n\n<pre><code>Dim selector As String\nselector = \"#Table div[style*='onmousemove']\"\n\nDim rightWindowDiv As HTMLDivElement\nSet rightWindowDiv = htmldoc.querySelector(selector)\nrightWindowDiv.ScrollTop = rightWindowDiv.ScrollHeight\n</code></pre>\n\n<p>Somehow it does not work. Can someone help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1551904119, "post_id": 55031528, "comment_id": 96815901, "body": "What section of your code doesn&#39;t work? Do you have any sample data you can provide to help test your algorithm?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1551904277, "post_id": 55031528, "comment_id": 96815972, "body": "Also... you should fully specify your <code>Range</code> references. Even though you&#39;re using <code>Cel</code> inside the <code>Range</code>, Excel assumes you&#39;re referring to the currently active sheet. Try <code>Set rng1 = Sht1.Range(Cel, ...</code> and then <code>Set rng2 = Sht2.Range(Cel, ...</code> and see if that makes any difference."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1551904338, "post_id": 55031528, "comment_id": 96815996, "body": "Why do you want to do that with code? What you describe can be done with formulas. Post a data sample and the expected result, so we can test our suggestions."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551905437, "post_id": 55031528, "comment_id": 96816440, "body": "Add a column in sheet1 that concatenates colums A &amp; B, then add a column in sheet2 that concatenates columns A &amp; F; use <code>INDEX+MATCH</code> for the lookup."}, {"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1551905581, "post_id": 55031528, "comment_id": 96816504, "body": "@teylyn it definitely doesn&#39;t have to be VBA. Someone told me it could be done using the Index command, but I haven&#39;t been able to figure it out. What is the easiest way to post sample data?"}, {"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551906156, "post_id": 55031528, "comment_id": 96816750, "body": "@MathieuGuindon someone else had recommended that as well...trying to figure it out right now"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1551906778, "post_id": 55031528, "comment_id": 96817017, "body": "Once you get the hang of it, you&#39;ll never want to use VLOOKUP ever again! It&#39;s <code>=INDEX(result_column, MATCH(lookup_value, where_its_at, 0))</code>"}, {"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551907706, "post_id": 55031528, "comment_id": 96817398, "body": "@MathieuGuindon awesome thanks a lot this worked well"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551907794, "post_id": 55031528, "comment_id": 96817433, "body": "Great! Now the relative position of columns is no longer relevant, and your lookups will never break when a column is inserted! Cheers!"}], "owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551905523, "creation_date": 1551903528, "last_edit_date": 1551905523, "question_id": 55031528, "link": "https://stackoverflow.com/questions/55031528/excel-vba-two-variable-vlookup", "title": "Excel VBA - Two Variable Vlookup?", "body": "<p>I'm relatively new to VBA (or any code for that matter) and don't use it much, but I'm struggling to figure out how to do this. </p>\n\n<p>I have two Excel sheets populated with data. I'm trying to take the Part Number and Next Higher Part Number in Columns A and B of Sheet 1 and look for the same Part Number and Next Higher Part Number in Columns A and F of Sheet 2. If a match is found, then I want it to pull over data from Sheet 2 to Sheet 1 (e.g. pull the data in Column B in Sheet 2 to Column M in Sheet 1).</p>\n\n<pre><code>Sub EEE_Reformat()\n\n  Dim wb1 As Workbook\n  Dim cell1 As Range, rng1 As Range, cell2 As Range, rng2 As Range\n  Dim Cel As Range\n  Dim Sht1 As Worksheet\n  Dim Sht2 As Worksheet\n\n  Set wb1 = ThisWorkbook\n\n  Set Sht1 = wb1.Sheets(\"Sheet1\")\n  Set Sht2 = wb1.Sheets(\"Sheet2\")\n\n  Set Cel = Sht1.Range(\"A2\")\n  Set rng1 = Range(Cel, Cel.Offset(Sht1.Cells.Rows.Count - Cel.Row, 0).End(xlUp))\n  Set Cel = Sht2.Range(\"A2\")\n  Set rng2 = Range(Cel, Cel.Offset(Sht2.Cells.Rows.Count - Cel.Row, 0).End(xlUp))\n\nFor i = 2 To 2500\n  If Sht1.Cells(i, 13) = \"\" Then  'if current cell in column 13 is empty then...\n    For Each cell2 In rng2        'for each cell in range 2 defined above (column A in Sheet2)...\n      For Each cell1 In rng1      'for each cell in range 1 defined above (column A in Sheet1)...\n        If cell2.Value = cell1.Value And cell2.Offset(i, 5) = cell1.Offset(i, 1).Value Then   'if the value of cell2 equals the value of cell1 AND the value of cell2 (offset by 5 columns) equals the value of cell1 (offset by 1 columns) then...\n          cell1.Offset(i, 12).Value = cell2.Offset(i, 1).Value    'from to Sheet1 column B to Sheet2 column M\n          cell1.Offset(i, 13).Value = cell2.Offset(i, 2).Value    'from to Sheet1 column C to Sheet2 column N\n          Exit For\n        End If\n      Next\n    Next\n  End If\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1551913660, "post_id": 55031965, "comment_id": 96819727, "body": "Thank You PeterT, I appreciate your information.  I swear someday this is going to make sense to me.  I understand your variables and believe I can keep them straight. But my troubles are going to lie with the range entries. ?,. With my example being (&quot;A2:G2000&quot;), Within your [ WITH textWS ] statement would I plug my lastCol setting as 7? Column A thru G is 7 columns. Am I thinking correctly?"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1551913671, "post_id": 55031965, "comment_id": 96819731, "body": "And with the [  Set textArea = .Range(&quot;A2&quot;) ] the textArea will count over 7 columns starting with row (2,A)? I believe the last ? is, with your lastRow &amp; lastCol statements, this will check for data going UP from the bottom of each columns? Is this correct thinking?  My lightbulb is DIM and I know enough to really mess something up.  lol   Thanks Again for helping me with this. I do appreciate it."}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1551966567, "post_id": 55031965, "comment_id": 96841211, "body": "Hello PeterT,  After working thru the workbook/sheet/ textdata referencing it seems that I have made my first completed successful transfer from textData to destArea.  You were right at it being tricky.  And placement of code is key. I have work thru all of my ranging issues to make the transfer work. But I&#39;m excited about trying some more of this.  I believe it should make the process more efficient.  ? for you....Since this bit of code is great for bulk data transferring, could it be used for multiple columns that are not consecutive?  I think I could see  work for this but very lengthy."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1551974357, "post_id": 55031965, "comment_id": 96846149, "body": "I&#39;m glad you got it to work. Yes, my code automatically figures out the size (rows and columns) of the data range you&#39;re working with. You can perform a very similar process for copying multiple, non-contiguous columns. You could, for example, get columns A-E in the <code>textArea</code> and copy to <code>textData</code> then set up your <code>destArea</code> and copy as above. Then repeat the same process for another set of columns (e.g. L-P, then R-S, W-Z). Each set of columns is a separate step."}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1551978931, "post_id": 55031965, "comment_id": 96848824, "body": "This is AWESOME!!!!!  I am all over this!!!!   Now it&#39;s got my mind thinking about using this for the deleting of the sheet data as well.  The block of data we are importing will also (or could be deleted). There is a macros for this now.  And works really fast. I think it&#39;s fast because it&#39;s just deleting within the workbook the 25 sheets that I have listed.  However,I originally used a recorded macro for this.  There are several SELECT statements and clearcontents of the selection.  I bet with what you have shown me, I could get rid of those extra SELECT statements as well.  Thank You Much!"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1551996984, "post_id": 55031965, "comment_id": 96856990, "body": "Ok PeterT,  I got way too happy way too fast.  I have maneuvered this code around so many ways my head is splitting.  As I mentioned earlier, I have a textWS that has multiple columns.  I just need column &quot;A&quot; starting at cell A2 and down to bottom. And in this case Column &quot;E&quot; starting at cell E2 and down to bottom. When I plug your code in, it is designed to pickup all columns to the right using xlLeft. and that&#39;s what it&#39;s doing. I&#39;ve taken out some and the best I can get is returning Cell A2 and Cell E2 individually.  Your code makes sense but I think I&#39;m over analyzing.  Code pasted above."}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552002536, "post_id": 55031965, "comment_id": 96858768, "body": "Hey PeterT, I have made a step or two forward and 2-3 steps back it seems.  I pasted a second set of WITH statements above. It reflect my attempt to copy one column &quot;A&quot; with plain variables (lastCol, lastRow, etc...) and this section of this WITH statement works. and transfer data correctly.  BUT, my second WITH statement breaks in the 3rd line [ lastRow2 = .Cells(Rows.Count, lastCol2).End(xlUp).Row ] with a runtime - 1004 error.  I do have Dim&#39;s for the extra variables.  Let me know when you have a moment.  I apprecaite it much.!!"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552012317, "post_id": 55031965, "comment_id": 96860898, "body": "Try my above untested edits. While I wasn&#39;t able to check it out myself, it should give you the general idea."}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552068392, "post_id": 55031965, "comment_id": 96884831, "body": "Hey PeterT,  I was late today getting to this project, my bad not getting back to you earlier.  I have place a bit of your code into the procedure and as soon as I F8 starting at 1st line Sub() it errors and breaks out.  Compile error: sub or function not defined and Hi-lights the [ CopyData ] statement only. I have pasted the code above. Also to mention, I have all Dim&#39;s listed as you have.  Also a bit confused by your second procedure within the code above? Is this two separate examples?  Just asking.  I&#39;ll get this, I&#39;m just trying to sound it out.  Thanks"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552068995, "post_id": 55031965, "comment_id": 96885098, "body": "So above, this code starts just after the textWB opens up.  So just to finish. As soon as I start to run code I get the error compile error on the word [ CopyData ] only. ??? also have a outside ? for you. When running a procedure (F8) and stepping thru, what would cause the procedure to just bounce out and start another procedure without error or breaking?  I was just testing different pieces to get this to work and had one column &quot;A&quot; transferring over fine using destArea = textData.  and then next the code jumps to another procedure, no calls, no other code, nothing? Any thoughts?  Thanks"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552072439, "post_id": 55031965, "comment_id": 96886697, "body": "My second example uses two Subs: <code>ImportData2</code> and <code>CopyData</code>. You need to put both of those in a single module for this to work. My example had no issues compiling and running as is. What you can do is to copy those two subs and then change the part opening the text file and see how it works then."}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552072512, "post_id": 55031965, "comment_id": 96886735, "body": "Outside question question revised:  I have a outside ? for you.  In testing this column data transfer and putting pieces of code together, Why would the procedure jump to running the [ Sheet ] procedures that exist? It&#39;s like a GOTO statement is listed but is not.  When it&#39;s completed with the sheet&#39;s procedure code, it jumps back into the procedure and finishes up the rest of the code.  No errors/breaks nothing. Just weird."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552072940, "post_id": 55031965, "comment_id": 96886913, "body": "I don&#39;t know what [ Sheet ] procedure you&#39;re referring to. If you have a <code>Worksheet_Change</code> method in the worksheet, that will certainly run. Look up Excel events and take a look at <a href=\"https://powerspreadsheets.com/excel-vba-events/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552075841, "post_id": 55031965, "comment_id": 96888233, "body": "Testing has completed... BINGO!!!  I just learned that you can call another procedure while in a procedure, How to copy columns from WB to WB without using copy/select/paste, and a few different range and variable usage.  I really like the (F8) step thru. Seeing it as it happens has helped a bunch.  And separating it into two procedures actually makes more sense to me.  A LOT better than some of the other code snippets I was trying to piece together.  Thanks a Bunch.  Work like a charm!!!!"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552076351, "post_id": 55031965, "comment_id": 96888439, "body": "Oh, regards to the Question.  By using (F8) and stepping thru this process, I can see that this is happening every time I run this column procedure. Start (F8), open text file, 1st CopyData call, run CopyData Sub(), Jump to worksheet module and run procedure, back to 2nd CopyData call, run CopyData Sub() again, Jump to worksheet module and run procedure again, and now back to last three lines of our code textWB.Close, AutoFilter stuff, screenupdating=true, END Sub.    ****I&#39;m sorry I&#39;m explaining it like this.  Just wanted you to kinda understand the flow......"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552077180, "post_id": 55031965, "comment_id": 96888780, "body": "The sheet that we are copying these columns onto is labeled (Sheet7) and I have two command buttons on the page. I also have a small procedure that assigns a value to a cell and if that value is 1 then buttons are visible, if value is 0 then not visible.  For some reason while trying to copy these columns, vba is jumping to the worksheet (Sheet7) Code and running. I don&#39;t know enough to speak savvy about it.  I hope that make some sense.  Thank you Peter so much for hanging with me thru this. Parts of this vba that seems easy, just enough to pull you in.  Then it confuses you !!!! Thanks Again"}, {"owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "edited": false, "score": 0, "creation_date": 1552084103, "post_id": 55031965, "comment_id": 96891414, "body": "Just impressive!!!!!  I can apply the top Sub procedure to each of my worksheets and reuse your 2nd sub procedure.  Absolutely Awesome!!!  This saves SO MUCH time....Thank you Peter for helping me through this.  I will try to keep learning so I can pay it forward to another.  I appreciate your help."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1552060114, "last_edit_date": 1552060114, "creation_date": 1551905654, "answer_id": 55031965, "question_id": 55031514, "link": "https://stackoverflow.com/questions/55031514/direct-value-transfer-instead-of-select-copy-paste-between-workbooks/55031965#55031965", "title": "Direct value transfer instead of select copy/paste between workbooks", "body": "<p>So here's a simple example for you to adapt to your needs. What you have to be careful of is to make clear your references to which workbook, worksheet, and range. In this example, the only thing that's copied is the data. Using copy/paste is better suited to copying both the data and the embedded formatting (which won't apply to your situation).</p>\n\n<pre><code>Option Explicit\n\nSub ImportData()\n    Dim destWB As Workbook\n    Set destWB = ThisWorkbook\n\n    Dim textWB As Workbook\n    Dim textWS As Worksheet\n    Workbooks.OpenText \"C:\\Temp\\testdata.txt\", Space:=True\n    Set textWB = ActiveWorkbook\n    If textWB Is Nothing Then\n        MsgBox \"Unable to open the text data\"\n        Exit Sub\n    Else\n        Set textWS = textWB.Sheets(1)\n    End If\n\n    '--- determine the data range and copy to a memory-based array\n    Dim lastRow As Long\n    Dim lastCol As Long\n    Dim textArea As Range\n    Dim textData As Variant\n    With textWS\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        Set textArea = .Range(\"A1\").Resize(lastRow, lastCol)\n        textData = textArea\n    End With\n\n    Dim destWS As Worksheet\n    Dim destArea As Range\n    Set destWS = destWB.Sheets(\"Sheet1\")\n    Set destArea = destWS.Range(\"A1\").Resize(lastRow, lastCol)\n    destArea = textData\n\n    textWB.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>EDIT:</strong> updated the answer to address the OP's questions from the\n  comments.</p>\n</blockquote>\n\n<pre><code>Sub ImportData2()\n    Dim destWB As Workbook\n    Set destWB = ThisWorkbook\n\n    Dim textWB As Workbook\n    Dim textWS As Worksheet\n    Workbooks.OpenText \"C:\\Temp\\testdata.txt\", Space:=True\n    Set textWB = ActiveWorkbook\n    If textWB Is Nothing Then\n        MsgBox \"Unable to open the text data\"\n        Exit Sub\n    Else\n        Set textWS = textWB.Sheets(1)\n    End If\n\n    Dim destWS As Worksheet\n    Set destWS = destWB.Sheets(\"Sheet1\")\n\n    '--- first range to copy A2:A&lt;lastRow&gt; to destWS A2\n    CopyData textWS, 1, 1, destWS, \"A2\"\n\n    '--- second range to copy E2:E&lt;lastRow&gt; to destWS E2\n    CopyData textWS, 5, 1, destWS, \"E2\"\n\n    '--- third range to copy G2:J&lt;lastRow&gt; to destWS G2\n    CopyData textWS, 7, 4, destWS, \"G2\"\n\n    textWB.Close SaveChanges:=False\nEnd Sub\n\nPrivate Sub CopyData(ByRef srcWS As Worksheet, _\n                     ByVal startColumn As Long, _\n                     ByVal numberOfColumns As Long, _\n                     ByRef destWS As Worksheet, _\n                     ByVal destCell As String)\n    Dim lastRow As Long\n    Dim textArea As Range\n    Dim textData As Variant\n    With srcWS\n        lastRow = .Cells(.Rows.Count, startColumn).End(xlUp).Row\n        Set textArea = .Cells(2, startColumn).Resize(lastRow, numberOfColumns)\n        textData = textArea\n    End With\n\n    Dim destArea As Range\n    Set destArea = destWS.Range(destCell).Resize(textArea.Rows.Count, _\n                                                 textArea.Columns.Count)\n    destArea = textData\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 11045591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c66631125dfc6a24b6ee3fd03578?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/11045591/boomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552060114, "creation_date": 1551903441, "last_edit_date": 1551905663, "question_id": 55031514, "link": "https://stackoverflow.com/questions/55031514/direct-value-transfer-instead-of-select-copy-paste-between-workbooks", "title": "Direct value transfer instead of select copy/paste between workbooks", "body": "<p>I'm able to select copy/paste between workbooks using recorded macros. It's working. BUT, as reading I'm learning there is a faster way that doesn't involve the copy/paste clipboard. Hope someone can help teach me to fish.</p>\n\n<p>Let me explain what's going on. </p>\n\n<ul>\n<li>Excel with main workbook open, goto FILE OPEN then open text file.  </li>\n<li>Walk thru the text delimited section. </li>\n<li>With new text workbook open select (\"A2:G2000\") hit COPY.  </li>\n<li>Go back to main excel file, find your worksheet, find your Range(\"B6:H6\") hit PASTE. </li>\n</ul>\n\n<p>That's it.  </p>\n\n<p>I rounded the rows at 2000 because it is a safe bet data will not travel pass this row.  However, I know there is a better way.  Currently, I'm getting a 438 error Object doesn't support this property or method.  Maybe you can help shed some light on this.  </p>\n\n<p>I'm going to attach a copy of my vba code with rem statements walking thru the process. Thank you in advance.  I'm just learning the stackoverflow setup and hope I can pay it forward.  Thank You,  Boomer</p>\n\n<pre><code>    `Sub import_data()\n    '\n    ' import_data Macro\n    Dim wb1 As Workbook\n\n    Application.ScreenUpdating = False\n\n    'Using FILE-OPEN text file and run thru text delimited setup\n\n  Workbooks.OpenText (Module33.FileDir + \"\\cf_data.txt\"), Origin:=437, _\n  StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n  ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False _\n  , Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), _\n  Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1)), \n  TrailingMinusNumbers:=True\n\n        'Applying the newly open excel workbook (text file)to a variable wb1\n  Set wb1 = ThisWorkbook\n\n         'Switching to the first sheet within this wb1 workbook\n  With wb1.Sheets(1)\n\n         'Selecting Columns A thru G and all rows in each columns that have \n          'values. text or numbers, no formulas.\n  lr = .Range(\"A:G\").Find(what:=\"*\", after:=.Range(\"A1\"), \n  searchorder:=xlByRows, _\n  searchdirection:=xlPrevious).Row\n  .Range(.Cells(2, \"A\"), .Cells(lr, \"G\")).Value          '&lt;====Run-time 438 '- Object doesn't support this property or method\n\n  End With\n\n  wb1.Close SaveChanges:=False\n\n        'Switches back to main workbook to sheet 2 then range B6 and paste \n        'all data\n\n  Workbooks(\"Auto_Data.xlsm\").Sheet2.Range(\"B6\").Resize(UBound(arr, \n        1), UBound(arr, 2)) = arr\n\n\n    'The code below does what I'm wanting however, it is very sluggish. This \n    'code, when in use, will sit just below text delimited section.\n\n'    Range(\"A2:G2000\").Select\n'    Selection.Copy\n'    Windows(\"Auto_Data.xlsm\").Activate\n'    Sheet2.Select\n'    Range(\"B6:H6\").Select\n'    ActiveSheet.Paste\n'    Selection.AutoFilter\n'    Application.CutCopyMode = False\n'    ActiveWindow.ActivateNext\n'    ActiveWindow.Close\n'    Range(\"B4\").Select\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1551907647, "post_id": 55031366, "comment_id": 96817366, "body": "Try removing the <code>.Value</code>"}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 1, "creation_date": 1551909240, "post_id": 55031366, "comment_id": 96818080, "body": "Try using <code>Thisworkbook.Path &amp; &quot;\\&quot; &amp; svName</code> instead of just <code>SvName</code>  after <code>.Show</code>"}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551945553, "creation_date": 1551902839, "last_edit_date": 1551945553, "question_id": 55031366, "link": "https://stackoverflow.com/questions/55031366/prompting-user-to-save-excel-file-name-based-on-cell-value-using-vba", "title": "Prompting user to save Excel file name based on cell value (using VBA)", "body": "<p>Trying to create a macro that will open the Save As window with a file name defaulted in the prompt based on a cell value.</p>\n\n<p>This code works in the initial file I used, however when I copy/paste it into different directories it doesn't show up.</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nDim SvName As String\n\nSvName = Sheets(1).Cells(6, 5).Value\n\nMsgBox (\"File should be saved as: \" &amp; SvName &amp; \".xlsm\")\nApplication.Dialogs(xlDialogSaveAs).Show SvName\n\nEnd Sub\n</code></pre>\n\n<p>The odd thing is even when the code doesn't work (it opens a blank Save As dialogue without the file name inputted), the MsgBox still displays the correct value for SvName.</p>\n\n<p>Why is it not working consistently?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 6, "creation_date": 1551903466, "post_id": 55031328, "comment_id": 96815616, "body": "You really want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using activate and select</a> in your VBA"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1551904545, "post_id": 55031328, "comment_id": 96816086, "body": "@cybernetic.nomad &quot;i&#39;m trying to avoid using Dim, Set and With to define a sheet&quot; - sounds like OP is already aware of the cure, just refusing treatment."}, {"owner": {"reputation": 1, "user_id": 11161764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31227d0c268d79acae0bb495a735ec49?s=128&d=identicon&r=PG&f=1", "display_name": "Nico D", "link": "https://stackoverflow.com/users/11161764/nico-d"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551907299, "post_id": 55031328, "comment_id": 96817239, "body": "@MathieuGuindon lol i know but could that really be why it&#39;s crashing 6 lines of code in? The entire macro is only 14 lines. That being said I started teaching myself vba this year so feel free to educate me."}, {"owner": {"reputation": 1, "user_id": 11161764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31227d0c268d79acae0bb495a735ec49?s=128&d=identicon&r=PG&f=1", "display_name": "Nico D", "link": "https://stackoverflow.com/users/11161764/nico-d"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551907999, "post_id": 55031328, "comment_id": 96817531, "body": "@cybernetic.nomad ok and in your opinion there&#39;s no way around that? You think that&#39;s certainly why the code is crashing?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551909212, "post_id": 55031328, "comment_id": 96818066, "body": "Plenty of reasons for it to fail. Does the source and/or destination sheet contain a <code>ListObject</code>, i.e. an actual <i>table</i>? If so, you don&#39;t need to work out the last row, and you might not be able to insert/shift cells either. That would be <i>one</i> reason for it to throw. Again, without knowing anything about your data, there&#39;s just too much to assume."}], "answers": [{"comments": [{"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 2, "creation_date": 1551908641, "post_id": 55032628, "comment_id": 96817804, "body": "Don&#39;t you think that this line <code>sourceSheet.Range(sourceStart, sourceStart.End(xlDown)).Copy</code> is why it&#39;s crashing? Depending on the values in the range, it can easily go to row 1048576."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1551908820, "post_id": 55032628, "comment_id": 96817893, "body": "@AlexdeJong could very well be - typically, finding the last row is much more reliable with e.g. <code>sourceSheet.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp)</code>; given how much information is given in the OP, it&#39;s hard to tell if it makes a difference - hence the suggestion to try to reproduce the error manually."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1551909761, "last_edit_date": 1551909761, "creation_date": 1551908530, "answer_id": 55032628, "question_id": 55031328, "link": "https://stackoverflow.com/questions/55031328/my-insert-copied-cells-vba-code-keeps-crashing/55032628#55032628", "title": "My &quot;Insert Copied Cells&quot; vba code keeps crashing?", "body": "<p>There are several reasons why <code>Range.Insert</code> might fail, depending on what's on that sheet... and it's not possible to tell why just by looking at that snippet.</p>\n\n<p>There is no reason whatsoever to want to avoid declaring and using variables though. Assuming the sheet that's active when the macro starts (assuming <code>Sub ...</code> isn't too far above the beginning of that snippet) is the <em>destination</em> sheet...</p>\n\n<pre><code>Dim destSheet As Worksheet\nSet destSheet = ActiveSheet\nDebug.Assert destSheet.Index &gt; 1 ' if code breaks here, assumption was wrong\n\nDim sourceSheet As Worksheet\nSet sourceSheet = destSheet.Previous\n\nDim sourceStart As Range\nSet sourceStart = sourceSheet.Range(\"A2:K2\")\n\nsourceSheet.Range(sourceStart, sourceStart.End(xlDown)).Copy\ndestSheet.Range(\"A2:K2\").Insert Shift:=xlDown\n</code></pre>\n\n<p>If the above code fails similarly, then I'd suggest attempting to do the exact same thing manually and see if Excel gives you a more detailed error message, as it often does when all its API tells VBA is \"1004, application-defined error\".</p>\n\n<p>Note that <code>Range.End(xlDown)</code> has a non-zero chance of not landing you where you think it does. Finding the last row is usually more reliable by going at it from the bottom of the sheet with <code>Range.End(xlUp)</code>:</p>\n\n<pre><code>sourceSheet.Range(sourceStart, sourceSheet.Range(\"A\" &amp; Rows.Count &amp; \":K\" &amp; Rows.Count).End(xlUp)).Copy\n</code></pre>\n\n<p>If the destination sheet contains a <code>ListObject</code>, make sure you're not inserting more columns than the table contains - if doing this manually, you get this message:</p>\n\n<p><img src=\"https://i.stack.imgur.com/H9zad.png\" alt=\"enter image description here\"></p>\n\n<p>If doing this programmatically, this is all you get:</p>\n\n<p><img src=\"https://i.stack.imgur.com/J14HQ.png\" alt=\"error 1004\"></p>\n"}], "owner": {"reputation": 1, "user_id": 11161764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31227d0c268d79acae0bb495a735ec49?s=128&d=identicon&r=PG&f=1", "display_name": "Nico D", "link": "https://stackoverflow.com/users/11161764/nico-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551909761, "creation_date": 1551902649, "last_edit_date": 1551903276, "question_id": 55031328, "link": "https://stackoverflow.com/questions/55031328/my-insert-copied-cells-vba-code-keeps-crashing", "title": "My &quot;Insert Copied Cells&quot; vba code keeps crashing?", "body": "<p>I'm trying to write a basic code where I'm copying a variable amount of cells from the previous sheet and INSERTING those copied cells in a new sheet, where it pushes the data I've already put in the new sheet down. </p>\n\n<p>This is a weekly task where I open a new sheet, paste some new information in it, then run the code to copy the previous weeks sheet and insert the copied cells into the new sheet. </p>\n\n<pre><code>`ActiveSheet.Previous.Select\nRange(\"A2:K2\").Select\nRange(Selection, Selection.End(xlDown)).Copy\nActiveSheet.Next.Select\nActiveSheet.Cells(2, 1).Select\nSelection.Insert Shift:=xlDown`\n</code></pre>\n\n<p>For some reason, the <code>Selection.Insert Shift:=xlDown</code> command crashes my excel. I've read a lot about how to solve this problem but most solutions revolve around running the code in the same sheet. But since it's a new sheet every week, I can't set it to a certain relevant worksheet. ie i'm trying to avoid using Dim, Set and With to define a sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1551902718, "post_id": 55031201, "comment_id": 96815248, "body": "Please provide the code you have so far along with any errors you are encountering."}, {"owner": {"reputation": 11, "user_id": 11161849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f422fa502b34424b1ca817d9240ebd84?s=128&d=identicon&r=PG&f=1", "display_name": "vchughes", "link": "https://stackoverflow.com/users/11161849/vchughes"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1551903062, "post_id": 55031201, "comment_id": 96815439, "body": "I need to know how to loop through the list of values, grab the price and put it in another worksheet with the corresponding product name. I have a snippet of code already that will then update every other sheet. I just don&#39;t know how to get prices from the master price list to the first sheet"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1551903753, "post_id": 55031201, "comment_id": 96815742, "body": "On this line <code>If ws.Cells(3, 1).Value = &quot;Division:&quot; Then</code> are you looking for an actual error like <code>#DIV</code>?"}, {"owner": {"reputation": 11, "user_id": 11161849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f422fa502b34424b1ca817d9240ebd84?s=128&d=identicon&r=PG&f=1", "display_name": "vchughes", "link": "https://stackoverflow.com/users/11161849/vchughes"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1551904453, "post_id": 55031201, "comment_id": 96816044, "body": "No that is just to verify the worksheet. All WS that would need to be updated have &quot;Division&quot; in cell A3."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11161849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f422fa502b34424b1ca817d9240ebd84?s=128&d=identicon&r=PG&f=1", "display_name": "vchughes", "link": "https://stackoverflow.com/users/11161849/vchughes"}, "edited": false, "score": 0, "creation_date": 1551904574, "post_id": 55031529, "comment_id": 96816100, "body": "I updated with MOD code. Prices(B) are adjacent to the product(A) and products are in alphabetical order on the master sheet. I was thinking Loop through master list, find product, price, update existing sheet. The mod code would then take care of the rest"}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "reply_to_user": {"reputation": 11, "user_id": 11161849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f422fa502b34424b1ca817d9240ebd84?s=128&d=identicon&r=PG&f=1", "display_name": "vchughes", "link": "https://stackoverflow.com/users/11161849/vchughes"}, "edited": false, "score": 0, "creation_date": 1551905285, "post_id": 55031529, "comment_id": 96816390, "body": "I saw. Edited my answer to include your added code."}], "tags": [], "owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "is_accepted": false, "score": 0, "last_activity_date": 1551907786, "last_edit_date": 1551907786, "creation_date": 1551903530, "answer_id": 55031529, "question_id": 55031201, "link": "https://stackoverflow.com/questions/55031201/updating-prices-from-a-master-list-through-the-workbook-vba/55031529#55031529", "title": "Updating Prices from a master list through the workbook VBA", "body": "<p>You could create a dictionary of the values and then pass the dictionary to the module. You would need to add a For Each loop to your master sheet to find the row with the product for each specific worksheet.</p>\n\n<pre><code>Sub CropValFind()\nDim ProdCol As Range, Cell As Range, PriceCol As Range\nSet ProdCol = 'Your product column range here\nSet PriceCol = 'Your Price Column range here\nFor Each Cell in ProdCol\n    Call ChangePrice(Cell.Value, CreateDictFromColumns(\"MasterSheetName\", ProdCol.Column, PriceCol.Column))\nNext\nEnd Sub\n</code></pre>\n\n<p>Assuming your product and price columns are adjacent to each other and the values are strings:</p>\n\n<p>Pulled from <a href=\"https://stackoverflow.com/a/33523909/10462532\">https://stackoverflow.com/a/33523909/10462532</a></p>\n\n<pre><code>Function CreateDictFromColumns(sheet As String, keyCol As String, valCol As String) As Dictionary\n    Set CreateDictFromColumns = New Dictionary\n    Dim rng As Range: Set rng = Sheets(sheet).Range(keyCol &amp; \":\" &amp; valCol)\n    Dim i As Long\n    Dim lastCol As Long '// for non-adjacent (\"A:ZZ\")\n    lastCol = rng.Columns.Count\n    For i = 1 To rng.Rows.Count\n        If (rng(i, 1).Value = \"\") Then Exit Function\n        CreateDictFromColumns.Add rng(i, 1).Value, rng(i, lastCol).Value\n    Next\nEnd Function\n</code></pre>\n\n<p>Then your ChangePrice Sub would look something like this.</p>\n\n<pre><code>Sub ChangePrice(row As String, price As Dictionary)\nDim cropVal As String: cropVal = row \nDim LastRow As Long\nFor Each ws In ActiveWorkbook.Worksheets\n\n'simple check for division in A3 (stronger check may be needed)\nIf ws.Cells(3, 1).Value = \"Division:\" Then\n\n    LastRow = ws.Range(\"A\" &amp; Rows.count).End(xlUp).row\n\n    ' starts in row 12, though data starts in 13\n    For i = 12 To LastRow\n\n        'check column 2 if crop is the same\n        If ws.Cells(i, 2).Value = cropVal Then\n\n            'if so, change its price in column 10\n            ws.Cells(i, 10).Value = price(row)\n\n        'this handles situations where the symbol is attached\n        ElseIf ws.Cells(i, 2).Value = cropVal &amp; \"\u00ae\" Then\n\n            ws.Cells(i, 10).Value = price(row)\n\n        End If\n\n\n    Next i\n\n\nEnd If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>A great resource to learn the in's and outs of dictionaries can be found <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 11161849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f422fa502b34424b1ca817d9240ebd84?s=128&d=identicon&r=PG&f=1", "display_name": "vchughes", "link": "https://stackoverflow.com/users/11161849/vchughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551945534, "creation_date": 1551902042, "last_edit_date": 1551945534, "question_id": 55031201, "link": "https://stackoverflow.com/questions/55031201/updating-prices-from-a-master-list-through-the-workbook-vba", "title": "Updating Prices from a master list through the workbook VBA", "body": "<p>I have a master price worksheet (Test Price) with product name (col A) and price (col B). I want to create a macro that when you click a button it will update the prices through the entire workbook. The previous person in my position already created a MOD that will update prices throughout the WB if it is changed in one WS. I am trying to link the master list to that code. So loop through the list and update one sheet which will use the existing mod to update all other sheets. Can anyone please help with this?</p>\n\n<p>This is the code that updates the sheets, I need to link the master price list to this:</p>\n\n<pre><code>Sub ChangePrice(row As String, price As String)\n\n    Dim cropVal As String: cropVal = Cells(row, 2).Value ' inefficient\n    Dim LastRow As Long\n    For Each ws In ActiveWorkbook.Worksheets\n\n        'simple check for division in A3 (stronger check may be needed)\n        If ws.Cells(3, 1).Value = \"Division:\" Then\n\n            LastRow = ws.Range(\"A\" &amp; Rows.count).End(xlUp).row\n\n            ' starts in row 12, though data starts in 13\n            For i = 12 To LastRow\n\n                'check column 2 if crop is the same\n                If ws.Cells(i, 2).Value = cropVal Then\n\n                    'if so, change its price in column 10\n                    ws.Cells(i, 10).Value = price\n\n                'this handles situations where the symbol is attached\n                ElseIf ws.Cells(i, 2).Value = cropVal &amp; \"\u00ae\" Then\n\n                    ws.Cells(i, 10).Value = price\n\n                End If\n\n\n            Next i\n\n\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1551902468, "post_id": 55031165, "comment_id": 96815117, "body": "You can loop through Target, or exit the sub if Target.Count&gt;1."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551903041, "post_id": 55031165, "comment_id": 96815432, "body": "FWIW <code>Range(Target.Address)</code> gets you the exact same <code>Range</code> object that <code>Target</code> alone does, assuming <code>Target</code> is on the activesheet (your code has a number of problems if that&#39;s not the case, due to all these unqualified <code>Range</code> member calls)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551903574, "post_id": 55031165, "comment_id": 96815663, "body": "<code>IsEmpty</code> is used to evaluate whether a <code>Variant</code> is <code>vbEmpty</code>, i.e. whether its subtype is <code>Variant&#47;Empty</code>. This will only ever be <code>True</code> for a single cell whose <code>.Value</code> contains literally <i>nothing</i> (no formula, no value, no empty string, <i>nothing at all</i>) -- in Excel terms, <i>that</i> is what a &quot;blank&quot; cell is."}, {"owner": {"reputation": 19, "user_id": 10222271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991735cc3670ccdeac01051c8d045e6?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/10222271/donovan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551906015, "post_id": 55031165, "comment_id": 96816689, "body": "@MathieuGuindon Thanks for the tip on <code>Target</code>, very good to know.  And your explanation on <code>IsEmpty</code> is good too."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10222271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991735cc3670ccdeac01051c8d045e6?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/10222271/donovan"}, "edited": false, "score": 0, "creation_date": 1551905882, "post_id": 55031465, "comment_id": 96816621, "body": "And good tip on the Marlett font.  For the Wingdings 2, it is an uppercase P that is needed."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 19, "user_id": 10222271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991735cc3670ccdeac01051c8d045e6?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/10222271/donovan"}, "edited": false, "score": 0, "creation_date": 1551906460, "post_id": 55031465, "comment_id": 96816878, "body": "@Donovan  Using reasonable variable names makes it easier to see the logic."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1551903223, "creation_date": 1551903223, "answer_id": 55031465, "question_id": 55031165, "link": "https://stackoverflow.com/questions/55031165/is-there-a-vba-function-like-isnumeric-but-for-text-istext-and-isempty-not-work/55031465#55031465", "title": "Is there a VBA function like IsNumeric but for Text? IsText and IsEmpty not working the same when a range is involved", "body": "<p>Consider:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, r As Range, rIntersect As Range\n    Dim wf As WorksheetFunction\n\n    Set rng = Range(\"C6:C60\")\n    Set rIntersect = Intersect(Target, rng)\n    Set wf = Application.WorksheetFunction\n\n    If rIntersect Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        For Each r In rIntersect\n            If wf.CountA(r) = 1 Then\n                r.Value = \"p\"\n                r.Font.Name = \"Wingdings 2\"\n            End If\n        Next r\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>We loop over the <code>Intersection</code> one cell at a time.  By the way, I use:</p>\n\n<pre><code>r.Value = \"a\"\nr.Font.Name = \"Marlett\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10222271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991735cc3670ccdeac01051c8d045e6?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/10222271/donovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 55031465, "answer_count": 1, "score": 1, "last_activity_date": 1551903223, "creation_date": 1551901911, "question_id": 55031165, "link": "https://stackoverflow.com/questions/55031165/is-there-a-vba-function-like-isnumeric-but-for-text-istext-and-isempty-not-work", "title": "Is there a VBA function like IsNumeric but for Text? IsText and IsEmpty not working the same when a range is involved", "body": "<p>Problem: need to be able to check a range or a single cell to see if blank.</p>\n\n<p>My code to replace any text with a check mark looks like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n' If the range (as defined in the next line) is changed to anything but a blank, replace it with a check mark.\n\nIf Not Intersect(Range(Target.Address), Range(\"C6:C60\")) Is Nothing Then\n    On Error GoTo ErrorOut\n    Application.EnableEvents = False\n    If Application.WorksheetFunction.IsText(Range(Target.Address)) Then\n        Range(Target.Address).Value = \"P\"\n        Range(Target.Address).Font.Name = \"Wingdings 2\"\n    End If\n    Application.EnableEvents = True\nEnd If\nExit Sub\n\nErrorOut:\nDebug.Print \"Error\"\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>It works.  But, if the user selects more than one cell and deletes them the error handling takes over.  Not a problem, because it works, but there has to be a better way.    </p>\n\n<p>I've been successful doing this when I wanted to check for numbers by using <code>If IsNumeric(Range(Target.Address)) Then</code>.  It works correctly if a bunch of cells are deleted at once.  But <code>IsText</code> or <code>IsEmpty</code> doesn't seem to behave exactly like <code>IsNumeric</code> and deleting a bunch of cells at once generates an error. </p>\n"}, {"tags": ["excel", "vba", "ms-word", "header"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1551903297, "post_id": 55031145, "comment_id": 96815543, "body": "Make sure the document is in the &quot;Print view&quot; (and not the &quot;Draft&quot; view, which we&#39;re seeing in the screen shot). Comment out the code in the <code>With</code> block and try this test: <code>.ActiveDocument.Bookmarks(&quot;Header&quot;).Range.Text = &quot;Test&quot;</code> Does this appear &quot;normally&quot;?"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551904169, "post_id": 55031145, "comment_id": 96815920, "body": "@Cindy the test works! but how do I make it have different lines (both left and right aligned) like the first picture?"}], "answers": [{"comments": [{"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1552051475, "post_id": 55032205, "comment_id": 96876201, "body": "I think you\u2019ve forgotten to include the tabs."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1552052322, "last_edit_date": 1552052322, "creation_date": 1551906669, "answer_id": 55032205, "question_id": 55031145, "link": "https://stackoverflow.com/questions/55031145/writing-in-a-word-document-header-using-excel-vba/55032205#55032205", "title": "Writing in a Word Document Header Using Excel VBA", "body": "<p>The behavior shown in the screen shot of the question is due to use the <code>Select</code> method. This separate Header pane, in the Draft view, comes from the days of Word 2.0, where WYSIWYG wasn't available for headers, footers, comments and similar things.</p>\n\n<p>Instead of using <code>Select</code>, working directly with <code>Range</code> objects will avoid the problem. The code in the question can be altered along these lines:</p>\n\n<pre><code>'Header\n  Dim rngHeader as Word.Range 'or Object if this is late-binding\n  With Wordapp\n   Set rngHeader = .ActiveDocument.Bookmarks(\"Header\").Range\n   rngHeader.Text =\"CFD Analysis of Antenna EPA \" &amp; vbTab &amp; _\n                    today &amp; vbCr &amp; antennamanu &amp; \" \" &amp; modnum\n  End With\n</code></pre>\n\n<p>In the original code, the document apparently has a TAB and a Paragraph character.  So <code>Selection.MoveRight</code> is moving to the tab stop, and then to the next paragraph. The above code writes those as it goes, so these characters should be removed from the report template being used. </p>\n"}], "owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552052322, "creation_date": 1551901837, "last_edit_date": 1551903167, "question_id": 55031145, "link": "https://stackoverflow.com/questions/55031145/writing-in-a-word-document-header-using-excel-vba", "title": "Writing in a Word Document Header Using Excel VBA", "body": "<p>I'm creating a button in an excel sheet that generates a report in Word. So far, so good except I'm trying to have a header in the document that looks like this:\n<a href=\"https://i.stack.imgur.com/pFLFN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pFLFN.png\" alt=\"enter image description here\"></a></p>\n\n<p>but it ends up just looking like this:\n<a href=\"https://i.stack.imgur.com/hKJsf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hKJsf.png\" alt=\"enter image description here\"></a></p>\n\n<p>where it just comes up as this weird extra window at the bottom of my document and it says page 3, when there is only two pages of the document (or there only should be two pages)\nmy code is:</p>\n\n<pre><code>'Header\n\n  With Wordapp\n   .activeDocument.Bookmarks(\"Header\").Select\n   .Selection.TypeText Text:=\"CFD Analysis of Antenna EPA \"\n   .Selection.MoveRight Count:=1\n   .Selection.TypeText Text:=today\n   .Selection.MoveRight Count:=1\n   .Selection.TypeText Text:=antennamanu &amp; \" \" &amp; modnum\n  End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1551909291, "post_id": 55031129, "comment_id": 96818108, "body": "What have you tried so far and where do you get stuck?"}, {"owner": {"reputation": 1, "user_id": 11161838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oTJpW4Y8Lk0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmYk1chRrOAVhL16avHt-Lnq2hGA/mo/photo.jpg?sz=128", "display_name": "arazano polini", "link": "https://stackoverflow.com/users/11161838/arazano-polini"}, "reply_to_user": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1551933188, "post_id": 55031129, "comment_id": 96824231, "body": "Hi Alex, See my edited post."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11161838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oTJpW4Y8Lk0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmYk1chRrOAVhL16avHt-Lnq2hGA/mo/photo.jpg?sz=128", "display_name": "arazano polini", "link": "https://stackoverflow.com/users/11161838/arazano-polini"}, "edited": false, "score": 0, "creation_date": 1551966231, "post_id": 55041935, "comment_id": 96841009, "body": "I have tested your code, i get bad file message with the filenames corresponding with the keywords in column A been used. Its only working when using full filename in column A."}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "reply_to_user": {"reputation": 1, "user_id": 11161838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oTJpW4Y8Lk0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmYk1chRrOAVhL16avHt-Lnq2hGA/mo/photo.jpg?sz=128", "display_name": "arazano polini", "link": "https://stackoverflow.com/users/11161838/arazano-polini"}, "edited": false, "score": 0, "creation_date": 1551998665, "post_id": 55041935, "comment_id": 96857524, "body": "That is because of the if-statement and the countif function. There you check if the filename is in column A, but it isn&#39;t of course because column A only contains keywords."}, {"owner": {"reputation": 1, "user_id": 11161838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oTJpW4Y8Lk0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmYk1chRrOAVhL16avHt-Lnq2hGA/mo/photo.jpg?sz=128", "display_name": "arazano polini", "link": "https://stackoverflow.com/users/11161838/arazano-polini"}, "edited": false, "score": 0, "creation_date": 1552062820, "post_id": 55041935, "comment_id": 96882157, "body": "Yes indeed. I have deleted the if statement. The code runs as it should be. Thanks!"}], "tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": false, "score": 0, "last_activity_date": 1551955603, "creation_date": 1551955603, "answer_id": 55041935, "question_id": 55031129, "link": "https://stackoverflow.com/questions/55031129/search-and-move-files-to-another-folder-with-vba/55041935#55041935", "title": "Search and move files to another folder with VBA", "body": "<p>You can use wildcards in the <code>Dir</code> function if your range only contains keywords of the file. Like this:</p>\n\n<p><code>FName = Dir(SourcePath &amp; \"*\" &amp; R.Value &amp; \"*\")</code></p>\n\n<p>It will then process all files where this keyword is used in.</p>\n"}], "owner": {"reputation": 1, "user_id": 11161838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oTJpW4Y8Lk0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmYk1chRrOAVhL16avHt-Lnq2hGA/mo/photo.jpg?sz=128", "display_name": "arazano polini", "link": "https://stackoverflow.com/users/11161838/arazano-polini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551955603, "creation_date": 1551901785, "last_edit_date": 1551945527, "question_id": 55031129, "link": "https://stackoverflow.com/questions/55031129/search-and-move-files-to-another-folder-with-vba", "title": "Search and move files to another folder with VBA", "body": "<p>Maybe someone can help me.</p>\n\n<p>I am looking for a vba code thats searches in a folder for kewords of the filename, and then moves these found files to anthor folder.</p>\n\n<p>The keywords are stored in column A in excel.</p>\n\n<p>I have used the following code and it works partly. The problem is that column A has to contain the exact filename in the following code. I want vba to search for keywords. The other thing is that the files have to be moved instead of been copied. And if a file has been moved that there is check in column B. </p>\n\n<pre><code>Sub Test()\n\nDim R As Range, r1 As Range\nDim SourcePath As String, DestPath As String, FName As String\n\nSourcePath = \"C:\\Downloads\\\"\nDestPath = \"C:\\Downloads\\New folder\\\"\nSet r1 = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n\nFor Each R In r1\nFName = Dir(SourcePath &amp; R)\n\n Do While FName &lt;&gt; \"\"\n\n   If Application.CountIf(r1, FName) Then\n      FileCopy SourcePath &amp; FName, DestPath &amp; FName\n\n     R.Offset(0, 1).Value = FName\n\n  Else\n\n     MsgBox \"Bad file: \" &amp; FName &amp; \" ==&gt;\" &amp; FName &amp; \"&lt;== \"\n\n  End If\n\n   FName = Dir()\n Loop\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1551912535, "post_id": 55031571, "comment_id": 96819292, "body": "Hi Ricardo, This is working better than the formula I had before.  However, I am running into the macro creating new tabs based on the column headers in my Sum to Line Item tab.  Could you point me in the right direction in the code as to where I incorrectly listed my target range for sheet creation?  Thank you"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1551914955, "post_id": 55031571, "comment_id": 96820133, "body": "Hi Connor. If the named range &quot;SplitOrderNum&quot; includes the headers and you don&#39;t want the headers to be created as worksheets, you need to modify it by clicking in the ribbon &quot;Formulas&quot; | &quot;Name Manager&quot; | and edit the range where it &quot;Refers to&quot;.  If this isn&#39;t what you intent to do, please edit your question and describe the steps you want the macro/code to follow."}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1551995976, "post_id": 55031571, "comment_id": 96856628, "body": "Hi Ricardo, thank you for the help.  I now have the above code. The VBA is now creating the separate sheets. However (in this example there is three sheets being created), after the first sheet is created and the VBA runs back through the code, it copies the first sheet that was created that already has the data needed for the second and third tab pulled out so there is no data in the final two tabs.  Do you know what could be causing this?"}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1552000154, "post_id": 55031571, "comment_id": 96858014, "body": "Sorry I posted my change in your code, however it deviated too far off of my original question.  The new code is posted here: <a href=\"https://stackoverflow.com/questions/55053905/vba-code-not-using-accurate-master-sheet-when-looping-back-second-third-time\" title=\"vba code not using accurate master sheet when looping back second third time\">stackoverflow.com/questions/55053905/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1551903694, "creation_date": 1551903694, "answer_id": 55031571, "question_id": 55031015, "link": "https://stackoverflow.com/questions/55031015/when-writing-vba-i-cannot-get-two-specific-errors-to-run-through/55031571#55031571", "title": "When writing VBA I cannot get two specific errors to run through", "body": "<p>Try this code, read the comments inside and look for the &lt;&lt;&lt;&lt; Customize this >>> lines:</p>\n\n<pre><code>Sub SplitandFilterSheet()\n\n    ' Declare objects\n    Dim sourceSheet As Worksheet\n    Dim targetSheet As Worksheet\n    Dim splitOrderNum As Range\n    Dim sourceCell As Range\n\n    ' Declare other variables\n    Dim sourceSheetName As String\n    Dim sourceRangeName As String\n    Dim targetSheetName As String\n    Dim targetRangeName As String\n\n    Dim lastSheetHidden As Boolean\n\n\n    ' &lt;&lt;&lt; Customize this &gt;&gt;&gt;\n    sourceSheetName = \"Sum To Line Item\"\n    sourceRangeName = \"SplitOrderNum\"\n    targetRangeName = \"OrderData\"\n\n    ' Initialize the source sheet\n    Set sourceSheet = ThisWorkbook.Sheets(sourceSheetName)\n\n    ' Initialize the range (Add full qualifier to the current workbook, sheet and range)\n    Set splitOrderNum = sourceSheet.Range(sourceRangeName)\n\n    ' Get if last sheet is visible in current workbook\n    lastSheetHidden = Not ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count).Visible\n    ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count).Visible = True\n\n    For Each sourceCell In splitOrderNum\n        ' Copy the source worksheet\n        sourceSheet.Copy After:=Worksheets(ThisWorkbook.Sheets.Count)\n        ' Rename the new worksheet\n        Sheets(ThisWorkbook.Sheets.Count).Name = sourceCell.Value\n        ' Reference to the added worksheet\n        Set targetSheet = ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n\n        With targetSheet.Range(targetRangeName)\n            .AutoFilter Field:=2, Criteria1:=\"&lt;&gt;\" &amp; sourceCell.Value, Operator:=xlFilterValues\n            .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n\n        ' Check this next line if this should point to the orderdata range too (?)\n        targetSheet.AutoFilter.ShowAllData\n\n    Next sourceCell\n\n    ' Return the last sheet visible state\n    If lastSheetHidden = False Then\n        ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count).Visible = Not lastSheetHidden\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 55031571, "answer_count": 1, "score": 0, "last_activity_date": 1551945513, "creation_date": 1551901308, "last_edit_date": 1551945513, "question_id": 55031015, "link": "https://stackoverflow.com/questions/55031015/when-writing-vba-i-cannot-get-two-specific-errors-to-run-through", "title": "When writing VBA I cannot get two specific errors to run through", "body": "<p>I am getting an Invalid use of code on my first line, and I am getting a Method 'Range' of object '_Worksheet' failed when inputting my object as the range.  Can anyone assist?</p>\n\n<pre><code>Sub SplitandFilterSheet()\n\n    Dim SplitOrderNum As Range\n\n    Sheets(\"Sum To Line Item\").Select\n\n    Set SplitOrderNum = Range(\"SplitOrderNum\")\n\n    For Each cell In SplitOrderNum\n        Sheets(\"Sum To Line Item\").Copy After:=Worksheets(Sheets.Count)\n        ActiveSheet.Name = cell.Value\n\n        With ActiveWorkbook.Sheets(cell.Value).Range(\"OrderData\")\n            .AutoFilter Field:=2, Criteria1:=\"&lt;&gt;\" &amp; cell.Value, Operator:=xlFilterValues\n            .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n\n        ActiveSheet.AutoFilter.ShowAllData\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1551901418, "post_id": 55031006, "comment_id": 96814517, "body": "enclose the saveas within an if statement to avoid that specific name?"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1551901557, "post_id": 55031061, "comment_id": 96814605, "body": "...i had just closed this page after making the comment for this, then reopened the tab to post this.  Thanks, Tim!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1551901602, "post_id": 55031061, "comment_id": 96814632, "body": "@Cyril -  Sorry if I stepped on your answer"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1551901717, "post_id": 55031061, "comment_id": 96814695, "body": "Didn&#39;t step over anything; you were all over it!  From the look of it, my comment wasn&#39;t as clear as my intent (which is what you put)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11148708"}, "edited": false, "score": 0, "creation_date": 1551901893, "post_id": 55031061, "comment_id": 96814777, "body": "I appreciate both of your guys&#39; help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1551901487, "creation_date": 1551901487, "answer_id": 55031061, "question_id": 55031006, "link": "https://stackoverflow.com/questions/55031006/how-to-handle-errors-and-cancel-in-excel-macro/55031061#55031061", "title": "How to handle errors and &quot;cancel&quot; in Excel Macro?", "body": "<pre><code>path = \"C:\\Report\\\"\nfileSaveName = Application.GetSaveAsFilename(InitialFileName:=path &amp; \"Report\", _\n                   fileFilter:=\"Excel Workbooks (*.xls; *.xlsx),*.xls;*.xslx\")\nIf fileSaveName &lt;&gt; False Then\n    Application.DisplayAlerts = True\n    ActiveWorkbook.SaveAs Filename:=fileSaveName, FileFormat:=xlOpenXMLWorkbook\nEnd If\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11148708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 55031061, "answer_count": 1, "score": 0, "last_activity_date": 1551901487, "creation_date": 1551901293, "question_id": 55031006, "link": "https://stackoverflow.com/questions/55031006/how-to-handle-errors-and-cancel-in-excel-macro", "title": "How to handle errors and &quot;cancel&quot; in Excel Macro?", "body": "<p>I have the following script that prompts the user to save the file as an .xlsx with an initial filename \"Report\". If the user saves the document, everything saves correctly. But if the user selects \"cancel\" excel saves the file as \"FALSE.xlsx\". How can I make it not save the file at all and just leave it open?</p>\n\n<pre><code>path = \"C:\\Report\\\"\nfileSaveName = Application.GetSaveAsFilename(InitialFileName:=path &amp; \"Report\", _\n fileFilter:=\"Excel Workbooks (*.xlsx; *.xlsx),*.xlsx;*.xslx\")\nApplication.DisplayAlerts = True\nActiveWorkbook.SaveAs Filename:=fileSaveName, FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1551912467, "post_id": 55032541, "comment_id": 96819256, "body": "Much thanks! This <i>almost</i> works. It takes care of the instance at the beginning of the document issue perfectly, but fails if the heading has nothing after it (no matter where the heading is in the document). For example, a heading with a list following below it -- in other words, another return right after the colon. This causes both the heading and the list text below it to be bolded. Any ideas?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1551944229, "post_id": 55032541, "comment_id": 96827927, "body": "The code I posted won&#39;t bold anything after the colon. If you&#39;re finding such content, that&#39;s because it was already formatted that way. That said, you might try changing the Find expression to &quot;^13[!^13]@:&quot;"}, {"owner": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1552157177, "post_id": 55032541, "comment_id": 96907404, "body": "The new expression does the trick! Thanks! I beg to differ, however, regarding your other statements. The first expression <i>does</i> bold all intervening text from one header to the next and nothing was already formatted.  Try it on a mock document, if you don&#39;t believe me. Type 3 uppercase headers with a colon. On header 1, follow the colon with 2 spaces and some sentence case text: &quot;HEADER1:  Blah blah blah.&quot; On HEADER2:, don&#39;t type any text after the colon, but instead hit return and type a numbered list below the header. Follow that with HEADER3: and more sentence case text after the colon."}, {"owner": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1552157192, "post_id": 55032541, "comment_id": 96907409, "body": "...continued...Run your macro exactly as you posted it above with the first Find expression, and you&#39;ll find that all the headers in the document are bold as hoped for, but that all intervening text between HEADER2 and HEADER3 (i.e., the numbered list) will be bold, too.  I assume this is due to either the return after the HEADER2 colon or the returns in the numbered list, or some combination of both.  No matter, though. Your second Find expression is perfection. Thanks again!"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1552192199, "post_id": 55032541, "comment_id": 96914341, "body": "The original Find expression - which is essentially your own - finds everything between a paragraph break and a colon. The problem with that approach is that using * means it&#39;ll start at the first paragraph break and continue from there until it finds a colon, no matter how many paragraphs later that might be. The replacement expression restricts the found range&#39;s scope to a single paragraph."}, {"owner": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1552502775, "post_id": 55032541, "comment_id": 97038774, "body": "Thank you. Your earlier comment was just rather adamant about how &quot;the code [you] posted won&#39;t bold anything after the colon&quot; and if it does it was &quot;because it was already formatted that way.&quot; Neither of those statements was the case. I was simply pointing that out."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1552512126, "post_id": 55032541, "comment_id": 97043113, "body": "That statement, too was correct, but its your understanding of what was going on that was lacking. That problem will only occur if the only thing after your colon is a paragraph break. With your Find expression, everything from the first paragraph break after a colon until the next colon is found will be bolded. Anything <i>between</i> the colon and the paragraph break immediately after it won&#39;t be bolded, though."}, {"owner": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "edited": false, "score": 0, "creation_date": 1552665676, "post_id": 55032541, "comment_id": 97110926, "body": "My understanding is just fine. And you in fact are echoing exactly what I said in my 2-part comment. I specifically stated it was a return immediately after the colon that was probably causing it. And it was <i>your</i> find expression being used, not mine. You also didn&#39;t clarify your &quot;nothing will be bolded after the colon&quot; comment -- until now. You just said &quot;nothing after the colon&quot; period and also &quot;already formatted.&quot; Both wrong. Let&#39;s just drop it. I&#39;ve moved on to an array anyway."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1551908190, "creation_date": 1551908190, "answer_id": 55032541, "question_id": 55030949, "link": "https://stackoverflow.com/questions/55030949/vba-macro-to-format-all-headings-in-document-as-bold/55032541#55032541", "title": "VBA Macro To Format All Headings in Document As Bold", "body": "<p>Try:</p>\n\n<pre><code>Sub BoldHeadings()\nApplication.ScreenUpdating = False\nWith ActiveDocument.Range\n  .InsertBefore vbCr\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Replacement.Font.Bold = True\n    .Text = \"^13*:\"\n    .Replacement.Text = \"^&amp;\"\n    .Format = True\n    .Forward = True\n    .MatchWildcards = True\n    .Wrap = wdFindContinue\n    .Execute Replace:=wdReplaceAll\n  End With\n  .Paragraphs.First.Range.Delete\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11161685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DumBgw-6AdQ/AAAAAAAAAAI/AAAAAAAABPM/SkCLrOg4Oew/photo.jpg?sz=128", "display_name": "bluemartian", "link": "https://stackoverflow.com/users/11161685/bluemartian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 55032541, "answer_count": 1, "score": 0, "last_activity_date": 1551908190, "creation_date": 1551901005, "last_edit_date": 1551904027, "question_id": 55030949, "link": "https://stackoverflow.com/questions/55030949/vba-macro-to-format-all-headings-in-document-as-bold", "title": "VBA Macro To Format All Headings in Document As Bold", "body": "<p>I'm trying to automate a search/replace of headings in a Word 2013 document (note, these are not Word style headings but simply text typed in uppercase with a colon). For example:</p>\n\n<p>CHIEF COMPLAINT:</p>\n\n<p>PHYSICAL EXAMINATION:</p>\n\n<p>The search and replace is only to format the headings to bold, which otherwise has to be done manually, otherwise the heading text remains the same. There is no way to know which headings will be in the document (or if any at all), which order or whether the first line of the document will include a heading or not.</p>\n\n<p>A manual search/replace for: ^13(*:)</p>\n\n<p>To this: ^p\\1</p>\n\n<p>Works, except if the first instance is at the beginning of the file (no return).</p>\n\n<p>The macro I've been using is this:</p>\n\n<pre><code>Sub BoldHeadings()\n'\n' BoldHeadings Macro\n'\nApplication.ScreenUpdating = False\nWith ActiveDocument.Range.Find\n  .ClearFormatting\n  .Replacement.ClearFormatting\n  .Format = False\n  .Forward = True\n  .MatchWildcards = True\n  .Wrap = wdFindContinue\n  .Text = \"^13(*:)\"\n  .Replacement.Text = \"^p\\1\"\n  .Replacement.Font.Bold = True\n  .Execute Replace:=wdReplaceAll\n  .Replacement.ClearFormatting\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>As stated, this works fine except if the first instance is at the beginning of the file. Is there another way I can achieve this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "excel", "vba", "string", "byref"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1551902310, "post_id": 55030840, "comment_id": 96815029, "body": "What error do you get and on which line? What is the value of <code>filecount</code> when it errors?"}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1551909678, "post_id": 55030840, "comment_id": 96818258, "body": "Can you post your <code>StringCutter</code> function as well?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551912492, "post_id": 55030840, "comment_id": 96819271, "body": "What <i>exactly</i> happens when you run your code?"}, {"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551946780, "post_id": 55030840, "comment_id": 96829137, "body": "@SJR: I get error 13: &quot;type mismatch&quot;. My macro jumps to the error routine when I try to execute &quot;arr = temp&quot;."}, {"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "reply_to_user": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1551946828, "post_id": 55030840, "comment_id": 96829152, "body": "@AlexdeJong: I edited my post and added the function. Hope that helps"}, {"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551947174, "post_id": 55030840, "comment_id": 96829311, "body": "@TimWilliams: My function iterates through a folder and all subfolders, increases a counter variable on every file in these folders. It also creates and fills an array with two values on every iteration: arr(i,1) = fill filename through the Filename variable, arr(i,2) = a small substring extracted from the filename through the function StringCutter. In the end I set the array that has been passed to the function equals my generated and filled array (this is where I get the error)."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1551951094, "post_id": 55040129, "comment_id": 96831632, "body": "You <a href=\"https://stackoverflow.com/a/22909268/11683\">absolutely can</a> copy arrays directly. They only restriction is that they can&#39;t be fixed size, which <code>arr</code> is."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1551951612, "post_id": 55040129, "comment_id": 96831996, "body": "Also, watch out for folders with filenames of less than 32 characters - you should consider trapping that eventuality in <code>StringCutter</code> so you don&#39;t attempt to shorten something beyond its length."}, {"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "edited": false, "score": 0, "creation_date": 1551996506, "post_id": 55040129, "comment_id": 96856829, "body": "Eventhough the function is build to iterate through folders as well, the function will only be called on one folder which has files in it that have all the same kind of name, so the -31 is calculated. But I know that it is not the best style to have so functionality as hardcoded as that."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1551950434, "creation_date": 1551950434, "answer_id": 55040129, "question_id": 55030840, "link": "https://stackoverflow.com/questions/55030840/error-13-when-passing-an-array-to-a-function-that-should-fill-it/55040129#55040129", "title": "Error 13 when passing an array to a function that should fill it", "body": "<p><strong><em>In VBA</em></strong>, I don 't think you can copy one array into another like that - <code>arr = temp</code> - you can with range arrays, but not pure arrays. You need to cycle through all the values and copy one at a time:</p>\n\n<pre><code>For y = LBound(temp, 2) To UBound(temp, 2)\n    For x = LBound(temp, 1) To UBound(temp, 1)\n        arr(x, y) = temp(x, y)\n    Next\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551951540, "post_id": 55040383, "comment_id": 96831935, "body": "I can&#39;t see how that would help with the error on <code>arr = temp</code>. You can&#39;t directly assign to a fixed-size array."}, {"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551951712, "post_id": 55040383, "comment_id": 96832062, "body": "Hi @GSerg, I helps because now I don&#39;t need temp and with that arr=temp. I can pass in the array arr as a parameter and fill it directly without using the temp array anymore. My problem was that I was trying to use a non String variable when filling my array. At least I think that was the problem. I am very new to VBA, so I am not really sure what I am doing, but at least now my sub fills the passed array without any error"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1552040526, "post_id": 55040383, "comment_id": 96870399, "body": "If you don&#39;t declare a variable it&#39;s always a variant. Use <code>Option Explicit</code>, which enforces predeclared variables."}, {"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "edited": false, "score": 0, "creation_date": 1552083204, "post_id": 55040383, "comment_id": 96891120, "body": "thanks for the tipp! that means I can use any variable in my code without declaring it and vba will just make it a variant?"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1552311460, "post_id": 55040383, "comment_id": 96948939, "body": "You can, but you should not do that, because typos happen and are a nightmare to debug without <code>Option Explicit</code>."}], "tags": [], "owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "is_accepted": true, "score": 0, "last_activity_date": 1551951215, "creation_date": 1551951215, "answer_id": 55040383, "question_id": 55030840, "link": "https://stackoverflow.com/questions/55030840/error-13-when-passing-an-array-to-a-function-that-should-fill-it/55040383#55040383", "title": "Error 13 when passing an array to a function that should fill it", "body": "<p>I think I figured it out! I was using the variable \"Filename\" which I guess is from the oFile element, because I didn't create it. Maybe that's why the types weren't compatible. Creating a <em>Dim fileName AS String</em> and using this variable here:</p>\n\n<pre><code>For Each oFile In oFolder.Files\n        fileName = fso.GetFileName(oFile)\n        temp(fileCount, 1) = fileName\n        temp(fileCount, 2) = StringCutter(fileName)\n        fileCount = fileCount + 1\n Next oFile\n</code></pre>\n\n<p>solved the problem. Thank you all for your help! :)</p>\n"}], "owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55040383, "answer_count": 2, "score": 0, "last_activity_date": 1551951215, "creation_date": 1551900591, "last_edit_date": 1551946567, "question_id": 55030840, "link": "https://stackoverflow.com/questions/55030840/error-13-when-passing-an-array-to-a-function-that-should-fill-it", "title": "Error 13 when passing an array to a function that should fill it", "body": "<p>First of all: I am fairly new to VBA, so please excuse me if the question is rather trivial, but this mistake has been keeping me busy all day - I have absolutely no clue.</p>\n\n<p>I am working on a small macro to look through a folder, count the files and fill a 2d array with the full file name and a specific section of the name. So I am creating an array in my main sub and call the function that takes the empty array as a parameter and fills it. </p>\n\n<p>My macro looks somewhat like this:</p>\n\n<pre><code>Private Sub whatever()\n    Dim arr(10, 2) As String\n    Dim count As Integer\n    CheckFolder(arr, \"somepath\", count)\nEnd Sub\n\nSub CheckFolder(ByRef arr() As String, strPath As String, count As Integer)\n\n    Dim fso, oFolder, oSubfolder, oFile, queue As Collection\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim fileCount As Integer\n    Dim temp(10, 2) As String\n    fileCount = 1\n\n    WriteToLog \"z\u00e4hle Files in Ordner \" &amp; strPath &amp; \"... \"\n\n    Dim path As String\n    path = ActiveWorkbook.path &amp; \"\\\" &amp; strPath\n    Set queue = New Collection\n    queue.Add fso.GetFolder(path) '- Pfad zum Ordner\n\n    Do While queue.count &gt; 0\n        Set oFolder = queue(1)\n        FolderName = fso.GetFileName(oFolder)\n        queue.Remove 1 'dequeue\n        For Each oSubfolder In oFolder.SubFolders\n          queue.Add oSubfolder 'enqueue\n        Next oSubfolder\n        For Each oFile In oFolder.Files\n            Filename = fso.GetFileName(oFile)\n            '- my guess is the next two line are the problem?\n            temp(fileCount, 1) = Filename\n            temp(fileCount, 2) = StringCutter(Filename)\n            fileCount = fileCount + 1\n        Next oFile\n    Loop\n\n    arr = temp\n    count = fileCount\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure, but I think that those two lines are the problem (as the rest of the logic worked perfectly fine before)</p>\n\n<pre><code>temp(fileCount, 1) = Filename\ntemp(fileCount, 2) = StringCutter(Filename)\n</code></pre>\n\n<p>The function \"StringCutter\" that is called here, returned a substring of the filename. I tested that function before and I works, so I don't think it is causing any problem. </p>\n\n<p>I would be much appreciated if someone could tell me where my mistake is. </p>\n\n<p><strong>EDIT:</strong> this is the StringCutter function, that takes a string and cuts out a certain portion of it and returns this portion. As mentioned before, this function works perfectly fine when I use it outside of filling an array.</p>\n\n<pre><code>Function StringCutter(str As String) As String\n\n    Dim ret As String\n    Dim retLen As Integer\n    Dim pos As Integer\n\n    retLen = Len(str)\n    ret = Right(str, (retLen - 31))\n    pos = InStr(ret, \"_\")\n\n    If (pos &gt; 0) Then\n        ret = Left(ret, (pos - 1))\n    Else\n        ret = Left(ret, 4)\n    End If\n\n    StringCutter = ret\n\nEnd Function\n</code></pre>\n\n<p>I hope that helps</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3308408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337dec559fad1917a48412c0433b1e05?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel M 42", "link": "https://stackoverflow.com/users/3308408/daniel-m-42"}, "edited": false, "score": 0, "creation_date": 1551911329, "post_id": 55031056, "comment_id": 96818821, "body": "I have added this but it still changes the formatting when It pastes to the new workbook. How do i keep the same cell size after?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 41, "user_id": 3308408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337dec559fad1917a48412c0433b1e05?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel M 42", "link": "https://stackoverflow.com/users/3308408/daniel-m-42"}, "edited": false, "score": 0, "creation_date": 1551911685, "post_id": 55031056, "comment_id": 96818953, "body": "You mean column width and row width? Or only column width?"}, {"owner": {"reputation": 41, "user_id": 3308408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337dec559fad1917a48412c0433b1e05?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel M 42", "link": "https://stackoverflow.com/users/3308408/daniel-m-42"}, "edited": false, "score": 0, "creation_date": 1551912363, "post_id": 55031056, "comment_id": 96819208, "body": "I need both column width and row height"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 41, "user_id": 3308408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337dec559fad1917a48412c0433b1e05?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel M 42", "link": "https://stackoverflow.com/users/3308408/daniel-m-42"}, "edited": false, "score": 0, "creation_date": 1551914589, "post_id": 55031056, "comment_id": 96820027, "body": "I have updated the code to handle rows and columns (heights and widths). Please check and if works, remember to mark this answer."}, {"owner": {"reputation": 41, "user_id": 3308408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337dec559fad1917a48412c0433b1e05?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel M 42", "link": "https://stackoverflow.com/users/3308408/daniel-m-42"}, "edited": false, "score": 0, "creation_date": 1551983763, "post_id": 55031056, "comment_id": 96851210, "body": "Awesome it worked! Thank you so much! You&#39;re the best"}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1551914537, "last_edit_date": 1551914537, "creation_date": 1551901454, "answer_id": 55031056, "question_id": 55030686, "link": "https://stackoverflow.com/questions/55030686/vba-copy-and-paste-values-only-of-a-specific-range-and-save-in-a-new-workbook/55031056#55031056", "title": "VBA: Copy and Paste values only of a specific range and save in a new workbook", "body": "<p>Try this code, read the comments inside and look for the &lt;&lt;&lt;&lt; Customize this >>> lines:</p>\n\n<pre><code>Sub SaveData()\n\n    ' Declare objects\n    Dim sourceWorkbook As Workbook\n    Dim targetWorkbook As Workbook\n    Dim sourceRange As Range\n    Dim targetRange As Range\n    Dim cellRange As Range\n\n    ' Declare other variables\n    Dim targetWorkbookName As String\n    Dim targetWorkbookTitle As String\n\n    Dim sourceSheetName As String\n    Dim sourceRangeAddress As String\n    Dim targetRangeAddress As String\n\n    Dim rowCounter As Long\n\n\n    ' &lt;&lt;&lt; Customize this &gt;&gt;&gt;\n    sourceSheetName = \"SaveSheet\" ' Name of the source sheet\n    sourceRangeAddress = \"A1:D14\" ' Address of the range you want to copy in the source workbook\n    targetRangeAddress = \"A2\" ' Cell address where you want to paste the copied range\n    targetWorkbookTitle = \"DigitalStorage\" ' Base file name\n\n    ' Reference source workbook\n    Set sourceWorkbook = ThisWorkbook\n\n    ' Create a new workbook\n    Set targetWorkbook = Application.Workbooks.Add\n\n    ' Set reference to source range\n    Set sourceRange = sourceWorkbook.Sheets(sourceSheetName).Range(sourceRangeAddress)\n\n    ' Copy the range to clipboard\n    sourceRange.Copy\n\n    ' This copies the range in the first available worksheet begining in the cell address specified\n    targetWorkbook.Sheets(1).Range(targetRangeAddress).PasteSpecial Paste:=xlPasteValues\n    targetWorkbook.Sheets(1).Range(targetRangeAddress).PasteSpecial Paste:=xlPasteFormats\n    targetWorkbook.Sheets(1).Range(targetRangeAddress).PasteSpecial Paste:=xlPasteColumnWidths\n\n    Set targetRange = targetWorkbook.Sheets(1).Range(targetRangeAddress).Resize(sourceRange.Rows.Count, sourceRange.Columns.Count)\n\n    ' Adjust row heights\n    For Each cellRange In sourceRange.Columns(1).Cells\n\n        rowCounter = rowCounter + 1\n\n        targetRange.Rows(rowCounter).RowHeight = cellRange.RowHeight\n\n    Next cellRange\n\n    ' Set the name of the new workbook\n    targetWorkbookName = Application.GetSaveAsFilename(InitialFileName:=targetWorkbookTitle &amp; \"_\" &amp; Format(Now, \"yyyy-MM-dd hh-mm-ss\"), _\n                                         fileFilter:=\"Excel Workbooks (*.xlsx),*.xlsx\")\n\n    If targetWorkbookName = vbNullString Then\n        MsgBox \"Saving operation canceled\"\n        Exit Sub\n    End If\n\n    ' Save the new workbook\n    targetWorkbook.SaveAs Filename:=targetWorkbookName ' Un comment this if you want it in OpenXML format: , FileFormat:=xlOpenXMLWorkbook\n\n    ' Close the new saved workbook (in this line couldn't figure out if you wanted to close the new or the old workbook\n    targetWorkbook.Close  ' savechanges:=False\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3308408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337dec559fad1917a48412c0433b1e05?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel M 42", "link": "https://stackoverflow.com/users/3308408/daniel-m-42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 55031056, "answer_count": 1, "score": 0, "last_activity_date": 1551914537, "creation_date": 1551900043, "question_id": 55030686, "link": "https://stackoverflow.com/questions/55030686/vba-copy-and-paste-values-only-of-a-specific-range-and-save-in-a-new-workbook", "title": "VBA: Copy and Paste values only of a specific range and save in a new workbook", "body": "<p>This seems to be a simple question so I am sorry if I should have been able to find it in the search but none of the answers have been able to help me. I am looking for a way to copy range A1:D14 and save it in a new workbook where only the format and values get saved to the new workbook.</p>\n\n<p>So basiaclly I have a range of data that has a lot of formulas and values that come from other sheets, but when my current code saves it, it has to do some weird delete method and it currently saves all of the data which means the values show up, but when I click on them it is the formula inside not the actual data.</p>\n\n<pre><code>Sub SaveData()\n\n\nDim SaveFile As String\n\nDim Title As String\n\n\nTitle = \"DigitalStorage\"\n\n\n\nSaveFile = Application.GetSaveAsFilename(InitialFileName:=Title &amp; \"_\" &amp; Format(Now, \"yyyy-MM-dd hh-mm-ss\"), _\n                                         fileFilter:=\"Excel Workbooks (*.xlsx),*.xlsx\")\n\n\nThisWorkbook.Worksheets(\"SaveSheet\").Copy\n\n\n\nWith ActiveWorkbook\n\n    With .Worksheets(\"SaveSheet\")\n\n        ThisWorkbook.Sheets(1).Range(\"A1:D14\").Copy\n\n        .Columns(\"E:ABC\").EntireColumn.Delete\n\n        .Rows(\"14:100\").EntireRow.Delete\n\n    End With\n\n    .SaveAs Filename:=SaveFile, FileFormat:=xlOpenXMLWorkbook\n\n    .Close savechanges:=False\n\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I have tried adding lines where I copy the sheet and PasteSpecial XlValues but that seems to overwrite my original workbook, and I just want the values and format in a plain xlsx file. And I also feel like my code is clunky and convoluted and that there is a much easier way to go about this that looks totally different from my method.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1551900469, "post_id": 55030642, "comment_id": 96813999, "body": "Does the table <code>newTable</code> created using the <code>SELECT INTO</code> statement have the same number of fields as the <code>myTable</code> table?"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1551900622, "post_id": 55030642, "comment_id": 96814085, "body": "Huh, great point.  The column counts do not match."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1551900798, "post_id": 55030642, "comment_id": 96814182, "body": "newTable = 42 columns, myTable = 45 columns.  There is data in the 3 missing columns."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1551901033, "post_id": 55030642, "comment_id": 96814311, "body": "OK, confirmed our processes do add the 3 extra columns downstream from the data import."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551901727, "post_id": 55030642, "comment_id": 96814699, "body": "So the CSV generates 42 columns? Open myTable in design view. Are the additional 3 columns located at end of the fields list? If not, move them there and then try the INSERT SELECT."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1551901893, "post_id": 55030642, "comment_id": 96814778, "body": "Yes, The extra columns are already at the end of the field list."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1551902090, "post_id": 55030642, "comment_id": 96814886, "body": "INSERT SELECT fails w/same message even into a 42 column destination."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1551902569, "post_id": 55030642, "comment_id": 96815171, "body": "Thinking I will just PUNT, import as a New Table and accommodate as needed.  was taking ~4mins using TransferText on this last large set.  Above approach takes 17sec.  Plenty of time to spare, ;)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11206014, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X9U3ul91ekQ/AAAAAAAAAAI/AAAAAAAAAaA/P8isyhdwKME/photo.jpg?sz=128", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/11206014/ken-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1575173569, "last_edit_date": 1575173569, "creation_date": 1575173328, "answer_id": 59122436, "question_id": 55030642, "link": "https://stackoverflow.com/questions/55030642/msaccess-append-from-csv-into-access-table/59122436#59122436", "title": "MSAccess: &quot;Append&quot; from CSV into Access Table", "body": "<p>You may want to try it this way without the '*'.        </p>\n\n<pre><code>Private Sub InsertRecordsFromCSV()\n\n    Dim cmd As New OleDbCommand\n    With cmd\n        .CommandText = \"INSERT INTO tblTest \" &amp; \"SELECT ID, ZIP_CODE, LATITUDE, LONGITUDE, CITY, STATE, COUNTY, TYPE \" &amp; \"FROM [Text;FMT=Delimited;HDR=Yes;DATABASE=\" &amp; dataPath &amp; \";].[zips.csv];\"\n        .CommandType = CommandType.Text\n        .Connection = conn\n    End With\n\n    Try\n        conn.Open()\n        cmd.ExecuteNonQuery()\n    Catch ex As OleDbException\n        MsgBox(ex.ToString)\n    Catch ex1 As Exception\n        MsgBox(ex1.ToString)\n    Finally\n        If conn.State = ConnectionState.Open Then conn.Close()\n    End Try\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594278629, "creation_date": 1551899900, "last_edit_date": 1594278629, "question_id": 55030642, "link": "https://stackoverflow.com/questions/55030642/msaccess-append-from-csv-into-access-table", "title": "MSAccess: &quot;Append&quot; from CSV into Access Table", "body": "<p>I can create a new TABLE without issue using the following approach:</p>\n\n<pre><code>Set db = CurrentDb\nstrFile = \"Item_9766.csv\"\nstrPath = \"c:\\users\\mark\\desktop\"\n\nstrSQL = \"SELECT * INTO newTable FROM [Text;HDR=NO;FMT=Delimited;Database=\" &amp; strPath &amp; \"].\" &amp; strFile &amp; \";\"\ndb.Execute (strSQL)\n</code></pre>\n\n<p>However, when trying a similar approach to APPEND to an existing Table, Access complains \"<em>The INSERT INTO statement contains the following unknown field name: 'F1'</em>\"</p>\n\n<pre><code>strSQL = \"Insert INTO myTable Select * FROM [Text;HDR=NO;FMT=Delimited;Database=\" &amp; strPath &amp; \"].\" &amp; strFile &amp; \";\"\n</code></pre>\n\n<p>Any suggestions to correct?  CSV file is comma delimited, with \" text qualifier, no headers.  TransferText approach was taking too long with large 550K x 50 column CSV file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551899284, "post_id": 55030224, "comment_id": 96813407, "body": "This long-winded <code>If..ElseIf...ElseIf...ElseIf...</code> block would be arguably cleaner as a <code>Select Case celValue</code> block. Also consider pulling <code>Sheets(&quot;Log&quot;)</code> and <code>Sheets(&quot;Cone&quot;)</code> into local <code>Worksheet</code> variables - no need to dereference the exact same objects over and over."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1551898489, "creation_date": 1551898489, "answer_id": 55030298, "question_id": 55030224, "link": "https://stackoverflow.com/questions/55030224/scale-programing-with-vba/55030298#55030298", "title": "Scale programing with VBA", "body": "<pre><code>belValue = Sheets(\"Cone\").Range(\"G18\").Offset(0, -i).Value\n</code></pre>\n\n<p>you cannot offset from G18 to the left by more than <strong>6</strong>, but your <code>i</code> loop goes to 8.  That's not going to work...</p>\n"}], "owner": {"reputation": 1, "user_id": 11105872, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-70irNVPn210/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdRwwKaWNYnAiPS-FbBJCS50LiXbg/mo/photo.jpg?sz=128", "display_name": "\u05d0\u05dc\u05de\u05d5\u05d2 \u05d1\u05dc\u05d9\u05d9\u05e8", "link": "https://stackoverflow.com/users/11105872/%d7%90%d7%9c%d7%9e%d7%95%d7%92-%d7%91%d7%9c%d7%99%d7%99%d7%a8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1551899221, "creation_date": 1551898217, "last_edit_date": 1551899221, "question_id": 55030224, "link": "https://stackoverflow.com/questions/55030224/scale-programing-with-vba", "title": "Scale programing with VBA", "body": "<p>I  make scale of depth until 4 meters so that \"cone\" sample were taken from each level. For single \"cone\" sample there is density and moisture tests.</p>\n\n<p>There is a \"cone\" spreadsheat in wich i get the two tests results and both of them are copy to \"Log\" spreadsheat by the depth conditions. </p>\n\n<p>I have problem with the error 1004.</p>\n\n<pre><code>Sub Cone()\n\n\n\nFor i = 1 To 8\n\n    celValue = Sheets(\"Cone\").Range(\"G18\").Offset(0, 1 - i).Value\n    belValue = Sheets(\"Cone\").Range(\"G18\").Offset(0, -i).Value\n    dens = Sheets(\"Cone\").Range(\"G41\").Offset(0, i - 1).Value\n    mois = Sheets(\"Cone\").Range(\"G48\").Offset(0, i - 1).Value\n\n   If celValue = belValue Then\n\n    If celValue &lt; 0.2 Then\n      Sheets(\"Log\").Range(\"S9\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R9\").Value = celValue\n      Sheets(\"Log\").Range(\"AI9\").Value = dens\n      Sheets(\"Log\").Range(\"AJ9\").Value = mois\n      Sheets(\"Log\").Range(\"AK9\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      Sheets(\"Log\").Range(\"AL9\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n      ElseIf celValue &lt; 0.4 And celValue &gt;= 0.2 Then\n      Sheets(\"Log\").Range(\"S10\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R10\").Value = celValue\n      Sheets(\"Log\").Range(\"AI10\").Value = dens\n      Sheets(\"Log\").Range(\"AJ10\").Value = mois\n      Sheets(\"Log\").Range(\"AK10\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      Sheets(\"Log\").Range(\"AL10\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, 0 - i).Value\n\n\n      ElseIf celValue &lt;= 0.5 And celValue &gt;= 0.4 Then\n      Sheets(\"Log\").Range(\"S11\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R11\").Value = celValue\n      Sheets(\"Log\").Range(\"AI11\").Value = dens\n      Sheets(\"Log\").Range(\"AJ11\").Value = mois\n      'Sheets(\"Log\").Range(\"AK11\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL11\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 0.5 And celValue &lt; 0.9 Then\n      Sheets(\"Log\").Range(\"S12\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R12\").Value = celValue\n      Sheets(\"Log\").Range(\"AI12\").Value = dens\n      Sheets(\"Log\").Range(\"AJ12\").Value = mois\n      'Sheets(\"Log\").Range(\"AK12\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL12\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &lt;= 1 And celValue &gt;= 0.9 Then\n      Sheets(\"Log\").Range(\"S13\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R13\").Value = celValue\n      Sheets(\"Log\").Range(\"AI13\").Value = dens\n      Sheets(\"Log\").Range(\"AJ13\").Value = mois\n      Sheets(\"Log\").Range(\"AK13\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      Sheets(\"Log\").Range(\"AL13\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 1 And celValue &lt; 1.2 Then\n\n      Sheets(\"Log\").Range(\"S14\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R14\").Value = celValue\n      Sheets(\"Log\").Range(\"AI14\").Value = dens\n      Sheets(\"Log\").Range(\"AJ14\").Value = mois\n      'Sheets(\"Log\").Range(\"AK14\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL14\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt;= 1.2 And celValue &lt;= 1.5 Then\n      Sheets(\"Log\").Range(\"S15\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R15\").Value = celValue\n      Sheets(\"Log\").Range(\"AI15\").Value = dens\n      Sheets(\"Log\").Range(\"AJ15\").Value = mois\n      'Sheets(\"Log\").Range(\"AK15\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL15\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n\n      ElseIf celValue &gt; 1.5 And celValue &lt; 1.8 Then\n      Sheets(\"Log\").Range(\"S16\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R16\").Value = celValue\n      Sheets(\"Log\").Range(\"AI16\").Value = dens\n      Sheets(\"Log\").Range(\"AJ16\").Value = mois\n      'Sheets(\"Log\").Range(\"AK16\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL16\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt;= 1.8 And celValue &lt; 1.9 Then\n      Sheets(\"Log\").Range(\"S17\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R17\").Value = celValue\n      Sheets(\"Log\").Range(\"AI17\").Value = dens\n      Sheets(\"Log\").Range(\"AJ17\").Value = mois\n      'Sheets(\"Log\").Range(\"AK17\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL17\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt;= 1.9 And celValue &lt;= 2 Then\n      Sheets(\"Log\").Range(\"S18\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R18\").Value = celValue\n      Sheets(\"Log\").Range(\"AI18\").Value = dens\n      Sheets(\"Log\").Range(\"AJ18\").Value = mois\n      'Sheets(\"Log\").Range(\"AK18\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL18\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 2 And celValue &lt; 2.2 Then\n      Sheets(\"Log\").Range(\"S19\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R19\").Value = celValue\n      Sheets(\"Log\").Range(\"AI19\").Value = dens\n      Sheets(\"Log\").Range(\"AJ19\").Value = mois\n      'Sheets(\"Log\").Range(\"AK19\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL19\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf Value &gt;= 2.2 And Value &lt; 2.4 Then\n      Sheets(\"Log\").Range(\"S20\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R20\").Value = celValue\n      Sheets(\"Log\").Range(\"AI20\").Value = dens\n      Sheets(\"Log\").Range(\"AJ20\").Value = mois\n      'Sheets(\"Log\").Range(\"AK20\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL20\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n\n      ElseIf celValue &gt;= 2.4 And celValue &lt;= 2.5 Then\n      Sheets(\"Log\").Range(\"S21\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R21\").Value = celValue\n      Sheets(\"Log\").Range(\"AI21\").Value = dens\n      Sheets(\"Log\").Range(\"AJ21\").Value = mois\n      'Sheets(\"Log\").Range(\"AK21\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL21\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 2.5 And celValue &lt; 2.8 Then\n      Sheets(\"Log\").Range(\"S22\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R22\").Value = celValue\n      Sheets(\"Log\").Range(\"AI22\").Value = dens\n      Sheets(\"Log\").Range(\"AJ22\").Value = mois\n      'Sheets(\"Log\").Range(\"AK22\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL22\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt;= 2.8 And celValue &lt;= 3 Then\n      Sheets(\"Log\").Range(\"S23\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R23\").Value = celValue\n      Sheets(\"Log\").Range(\"AI23\").Value = dens\n      Sheets(\"Log\").Range(\"AJ23\").Value = mois\n      'Sheets(\"Log\").Range(\"AK23\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL23\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 3 And celValue &lt; 3.2 Then\n      Sheets(\"Log\").Range(\"S24\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R24\").Value = celValue\n      Sheets(\"Log\").Range(\"AI24\").Value = dens\n      Sheets(\"Log\").Range(\"AJ24\").Value = mois\n      'Sheets(\"Log\").Range(\"AK24\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL24\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt;= 3.2 And celValue &lt;= 3.5 Then\n      Sheets(\"Log\").Range(\"S25\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R25\").Value = celValue\n      Sheets(\"Log\").Range(\"AI25\").Value = dens\n      Sheets(\"Log\").Range(\"AJ25\").Value = mois\n      'Sheets(\"Log\").Range(\"AK25\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL25\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 3.5 And celValue &lt; 3.7 Then\n      Sheets(\"Log\").Range(\"S26\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R26\").Value = celValue\n      Sheets(\"Log\").Range(\"AI26\").Value = dens\n      Sheets(\"Log\").Range(\"AJ26\").Value = mois\n      'Sheets(\"Log\").Range(\"AK26\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL26\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt;= 3.7 And celValue &lt;= 3.9 Then\n      Sheets(\"Log\").Range(\"S27\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R27\").Value = celValue\n      Sheets(\"Log\").Range(\"AI27\").Value = dens\n      Sheets(\"Log\").Range(\"AJ27\").Value = mois\n      'Sheets(\"Log\").Range(\"AK27\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL27\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue &gt; 3.9 And celValue &lt; 4 Then\n      Sheets(\"Log\").Range(\"S28\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R28\").Value = celValue\n      Sheets(\"Log\").Range(\"AI28\").Value = dens\n      Sheets(\"Log\").Range(\"AJ28\").Value = mois\n      'Sheets(\"Log\").Range(\"AK28\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL28\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Value\n\n\n      ElseIf celValue = 4 Then\n      Sheets(\"Log\").Range(\"S28\") = \"Sand Cone\"\n      Sheets(\"Log\").Range(\"R28\").Value = celValue\n      Sheets(\"Log\").Range(\"AI28\").Value = dens\n      Sheets(\"Log\").Range(\"AJ28\").Value = mois\n      'Sheets(\"Log\").Range(\"AK28\").Value = Sheets(\"Cone\").Range(\"G41\").Offset(0, -i).Value\n      'Sheets(\"Log\").Range(\"AL28\").Value = Sheets(\"Cone\").Range(\"G48\").Offset(0, -i).Valu\n     End If\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1551898212, "post_id": 55030175, "comment_id": 96812941, "body": "<code>Range(&quot;Y3:AB&quot; &amp; LastRow).FillDown</code>"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1551898457, "post_id": 55030175, "comment_id": 96813045, "body": "<code>CurrentRegion</code> will include any adjacent data, not just column X.  If you are only interested in Column X, then use <code>LastRow=Sht.Cells(Rows.Count, 24).End(xlup).Row</code>"}, {"owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "edited": false, "score": 0, "creation_date": 1551904441, "post_id": 55030175, "comment_id": 96816042, "body": "Thanks Darrel H!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "edited": false, "score": 0, "creation_date": 1551904406, "post_id": 55030237, "comment_id": 96816027, "body": "These both suggestions worked like a charm!! Thank you BigBen and Darrell!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 2, "last_activity_date": 1551915839, "last_edit_date": 1551915839, "creation_date": 1551898276, "answer_id": 55030237, "question_id": 55030175, "link": "https://stackoverflow.com/questions/55030175/error-while-calculating-last-row-of-adjucent-column/55030237#55030237", "title": "Error while calculating last row of adjucent column", "body": "<p>You shouldn't have <code>AB3</code>, just <code>AB</code>. The <code>Range</code> reference should include the first row and last row numbers. You're adding an additional 3 in front of the last row number, which results in the extra 3000 rows.</p>\n\n<pre><code>Range(\"Y3:AB\" &amp; LastRow).FillDown\n</code></pre>\n\n<p>Additionally, as pointed out by <a href=\"https://stackoverflow.com/users/4996248/john-coleman\">@JohnColeman</a>, using <code>CurrentRegion.Rows</code> is not a foolproof method to get the last row. It might have unanticipated results if your data does not start in row 1.</p>\n\n<p>Instead you can use <code>End(xlUp)</code> (also suggested by <a href=\"https://stackoverflow.com/users/6466694/darrell-h\">@Darrell H</a>):</p>\n\n<pre><code>With Sht\n    LastRow = .Cells(.Rows.Count, \"X\").End(xlup).Row\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "edited": false, "score": 0, "creation_date": 1551904484, "post_id": 55031286, "comment_id": 96816057, "body": "Thanks Raul, I used Darrell H and Big Ben&#39;s suggestions and those resolved my issues."}], "tags": [], "owner": {"reputation": 328, "user_id": 11053636, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-905Cm0oxwsg/AAAAAAAAAAI/AAAAAAAAAAc/s9eGPJxrdVU/photo.jpg?sz=128", "display_name": "Raul Guerrero", "link": "https://stackoverflow.com/users/11053636/raul-guerrero"}, "is_accepted": false, "score": 0, "last_activity_date": 1551902442, "creation_date": 1551902442, "answer_id": 55031286, "question_id": 55030175, "link": "https://stackoverflow.com/questions/55030175/error-while-calculating-last-row-of-adjucent-column/55031286#55031286", "title": "Error while calculating last row of adjucent column", "body": "<p>You can try:</p>\n\n<pre><code>Sub Test()\n    Sheets(\"CJI Data\").Select\n    Dim LastRow As Long\n    Dim Sht As Worksheet\n    Set Sht = ActiveWorkbook.Sheets(\"CJI Data\")\n    LastRow = Sht.Range(\"X1048576\").End(xlUp).Row\n    Range(\"Y3:AB3\" &amp; LastRow).FillDown\n    Range(\"A2:AB2\").Select\nEnd Sub\n</code></pre>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1551915839, "creation_date": 1551898022, "question_id": 55030175, "link": "https://stackoverflow.com/questions/55030175/error-while-calculating-last-row-of-adjucent-column", "title": "Error while calculating last row of adjucent column", "body": "<p>I am using below code in VBA to fill down formula in cell Y3:AB3 till the last row of column X but excel will fill down formula till the last row plus another 3000 rows. I have tested this formula with different file and data set but I get the same error. Please can you advise. </p>\n\n<p>Thanks,\nR</p>\n\n<pre><code>Sheets(\"CJI Data\").Select\nDim LastRow As Long\nDim Sht As Worksheet\nSet Sht = ActiveWorkbook.Sheets(\"CJI Data\")\nLastRow = Sht.Range(\"X3\").CurrentRegion.Rows.Count\nRange(\"Y3:AB3\" &amp; LastRow).FillDown\nRange(\"A2:AB2\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551898227, "post_id": 55030159, "comment_id": 96812946, "body": "Sounds like an <code>IF</code> statement with a <code>VLOOKUP</code> to see the spend level associated with a product colour would do the job. What have you tried so far?"}, {"owner": {"reputation": 19, "user_id": 11031121, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5g7KFelgp40/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfOJAqfuseM9elnbMfQMx3285Qpg/mo/photo.jpg?sz=128", "display_name": "user11031121", "link": "https://stackoverflow.com/users/11031121/user11031121"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551899380, "post_id": 55030159, "comment_id": 96813460, "body": "Haven&#39;t done anything yet, but was thinking of going that route. Just so I understand correctly - I would use the IF statement to determine the spend level (there are 4 spend levels in total), then once the spend level is determined refer to a vlookup on a table that lists out each of the allowable features?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551899974, "post_id": 55030159, "comment_id": 96813747, "body": "The exact opposite: use the <code>VLOOKUP</code> to determine the spend level based on the product colour, then the <code>IF</code> to compare with the actual spend level. See my answer"}], "answers": [{"tags": [], "owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "is_accepted": false, "score": 0, "last_activity_date": 1551899519, "creation_date": 1551899519, "answer_id": 55030538, "question_id": 55030159, "link": "https://stackoverflow.com/questions/55030159/three-layers-of-if-then-case-statements-in-excel/55030538#55030538", "title": "Three layers of If-Then case statements in Excel", "body": "<p>There are multiple ways you can approach this. You could define the allowed colours for each range of prices in some hidden helper worksheet, and then reference that. Grab the customer's spend, check match the column, then check if their selected option exists in that column. If it doesn't, flag the cell -- highlight it or whatever you want you do.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>+-------+-------+-------+\n| 19999 | 29999 | 39999 |\n+-------+-------+-------+\n| black | black | black |\n|       | blue  | blue  |\n|       |       | red   |\n+-------+-------+-------+\n</code></pre>\n\n<p>You could also approach this purely in VBA by using dictionaries to store these permitted options. Then just iterate over the dictionary keys, comparing the customers spend, to find the appropriate dictionary store. Once you've found your match, take the value, split it into an array, then compare if their chosen option, is a valid one for that spend range.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim options As Dictionary\nSet options = New Dictionary\noptions.Add \"19999\", \"black\"\noptions.Add \"29999\", \"black,blue\"\noptions.Add \"39999\", \"black,blue,red\"\n\nFor Each spend In options.Keys\n    'if customer spend is less than the max (defined here as the key)\n    'then grab the value, and split it into an array\n    allowedChoices = Split(options.Item(spend ), \",\")\n\n    ' if the customers selected choice is in the array of allowed choices\n    If IsInArray(&lt;the_users_choice&gt;, allowedChoices) Then\n        'flag whatever, however\n    End If\nNext spend \n</code></pre>\n\n<p>These are a couple of options you could use to approach this. Get creative -- goodluck.</p>\n"}, {"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1551899840, "creation_date": 1551899840, "answer_id": 55030626, "question_id": 55030159, "link": "https://stackoverflow.com/questions/55030159/three-layers-of-if-then-case-statements-in-excel/55030626#55030626", "title": "Three layers of If-Then case statements in Excel", "body": "<p>Assuming Column A has the spending amount, and B the color.</p>\n\n<p>This formula on any other column:</p>\n\n<pre><code>=IF(A2&gt;=30000,IF(OR(B2=\"Black\",B2=\"Blue\",B2=\"Red\"),\"OK\",\"FLAG\"),IF(A2&gt;=20000,IF(OR(B2=\"Black\",B2=\"Blue\"),\"OK\",\"FLAG\"),IF(A2&gt;=10000,IF(B2=\"Black\",\"OK\",\"FLAG\"),\"Less than 10000\")))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 11031121, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5g7KFelgp40/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfOJAqfuseM9elnbMfQMx3285Qpg/mo/photo.jpg?sz=128", "display_name": "user11031121", "link": "https://stackoverflow.com/users/11031121/user11031121"}, "edited": false, "score": 0, "creation_date": 1552067194, "post_id": 55030651, "comment_id": 96884286, "body": "Thanks! I went with a similar approach, but instead of the vlookup I did a combination of IF + SUMPRODUCT(--ISNUMBER(SEARCH(TABLE NAME)"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1551899929, "creation_date": 1551899929, "answer_id": 55030651, "question_id": 55030159, "link": "https://stackoverflow.com/questions/55030159/three-layers-of-if-then-case-statements-in-excel/55030651#55030651", "title": "Three layers of If-Then case statements in Excel", "body": "<p>I would create a lookup table to determine the spend levels:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8JakK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8JakK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then use the following formula to determine if a customer should be flagged:</p>\n\n<pre><code>=IF(VLOOKUP(B2,J$2:K$4,2)&gt;A2,\"flagged\",\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HWuF0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HWuF0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 19, "user_id": 11031121, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5g7KFelgp40/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfOJAqfuseM9elnbMfQMx3285Qpg/mo/photo.jpg?sz=128", "display_name": "user11031121", "link": "https://stackoverflow.com/users/11031121/user11031121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1551945467, "creation_date": 1551897953, "last_edit_date": 1551945467, "question_id": 55030159, "link": "https://stackoverflow.com/questions/55030159/three-layers-of-if-then-case-statements-in-excel", "title": "Three layers of If-Then case statements in Excel", "body": "<p>I am working on an excel document to understand product feature violations based on customer spend level (i.e. the more they spend, the more choice of features they are presented to choose from. Conversely, the less they spend, the less choices they have to choose from. </p>\n\n<p>There are about 7 variables that we use to measure products. For each of those variables, there are multiple options within each variable. For example, one feature could be color and the variables of that color feature could be black, white, red, yellow etc.</p>\n\n<p>Based on spend level by customers, they can or cannot be allowed to have certain options from those variables. For example:</p>\n\n<ul>\n<li>customer spending 10K can have a black product, but no other colors</li>\n<li>customer spending 20K can have a blue product or black product but not a red product</li>\n<li>customer spending 30K can have a black, blue or red product</li>\n</ul>\n\n<p>So if there is an entry where a customer spending 10K and has a blue product, I would like it to be \"flagged\" in some way, with the intention of knowing how many \"violations\" are happening for a range in time (i.e. December 2018). </p>\n\n<p>I would need a way to create an if-then statement that first searches for spend, then can reference what is / is not allowed in that spend, then determine if it is violating those rules. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1551899878, "post_id": 55029653, "comment_id": 96813698, "body": "&quot;none of these worked&quot; does not convey usable information. State what happens for each of the two tries."}, {"owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1551900745, "post_id": 55029653, "comment_id": 96814151, "body": "Right. Run-time error &#39;-2147221233 (8004010f)&#39;: The Attempted operation failed. An Object Could Not Be Found."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1551901331, "post_id": 55029653, "comment_id": 96814470, "body": "In the original code the object olFolder is an Outlook folder. <code>Set olFolder = olNS.GetDefaultFolder(9)</code>. You prematurely bring in Items in <code>Set olFolder = olNS.GetDefaultFolder(9).Parent.Folders(&quot;basic&quot;).Items</code>. Drop .Items"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1551903028, "post_id": 55029653, "comment_id": 96815422, "body": "Modify this to look at the calendars under olNS.GetDefaultFolder(9).Parent. <a href=\"https://stackoverflow.com/questions/33655041/vba-code-to-loop-through-every-folder-and-subfolder-in-outlook\" title=\"vba code to loop through every folder and subfolder in outlook\">stackoverflow.com/questions/33655041/&hellip;</a>"}, {"owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1551907544, "post_id": 55029653, "comment_id": 96817324, "body": "Okay, so this is what I ultimately found: olNS.GetDefaultFolder(9).Parent = email@gmail.com and Its Child is one of my calendars &quot;Calendar&quot; seen in the picture. The parent of &quot;basic&quot; calendar is Internet Calendars. How can I set olFolder to the directory &#39;\\\\Internet Calendars\\basic&#39; instead of &#39;\\\\email@gmail.com\\Calendar&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "is_accepted": true, "score": 0, "last_activity_date": 1552059634, "creation_date": 1552059634, "answer_id": 55066500, "question_id": 55029653, "link": "https://stackoverflow.com/questions/55029653/how-to-locate-a-subscribed-internet-calendars-folder-path/55066500#55066500", "title": "How to locate a subscribed internet calendar&#39;s folder path?", "body": "<p>I figured it out it was as simple as Setting olFolder to the parent folder and child folder,</p>\n\n<p>Set olFolder = olNS.Folders(\"Internet Calendars\").Folders(\"Calend\")</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11137979, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218576979200071/picture?type=large", "display_name": "Siebren Beens", "link": "https://stackoverflow.com/users/11137979/siebren-beens"}, "is_accepted": false, "score": -1, "last_activity_date": 1573168899, "creation_date": 1573168899, "answer_id": 58758272, "question_id": 55029653, "link": "https://stackoverflow.com/questions/55029653/how-to-locate-a-subscribed-internet-calendars-folder-path/58758272#58758272", "title": "How to locate a subscribed internet calendar&#39;s folder path?", "body": "<p>i found a small piece of code to determine all your folders and subfolders.</p>\n\n<pre><code>    Sub List_All_NameSpace_Folders()\n       Dim myNS As Outlook.Namespace\n       Dim myFolder As MAPIFolder\n       Dim mySubfolder As MAPIFolder\n       enter code hereDim nextrow As Long\n       Dim nextrows As Long\n\nSet myNS = Outlook.Application.GetNamespace(\"MAPI\")\nWith myNS\n    For Each myFolder In myNS.Folders\n        With Sheets(\"blad1\")\n            nextrows = .Cells(Rows.Count, 2).End(xlUp).Offset(1).Row\n            .Cells(nextrows, 1).Value = myFolder.Name\n                For Each mySubfolder In myFolder.Folders\n                    nextrow = .Cells(Rows.Count, 2).End(xlUp).Offset(1).Row\n                    .Cells(nextrow, 2).Value = mySubfolder.Name\n                Next mySubfolder\n        End With\n    Next myFolder\nEnd With\nEnd Sub\n</code></pre>\n\n<p>column A on the sheet contains all \"myFolder\"names</p>\n\n<p>column B on the sheet contains all \"mySubfolder\"names</p>\n\n<p>Set olFolder = olNS.Folders(\"myFolder\").Folders(\"mySubfolder\")</p>\n\n<pre><code>enter code here\nSub ListAppointments()\nDim olApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim olFolder As Outlook.MAPIFolder\nDim olFolder2 As Outlook.MAPIFolder\nDim olApt As Outlook.AppointmentItem\nDim nextrow As Long\nDim FromDate As Date\nDim ToDate As Date\n\n\nFromDate = CDate(\"10/01/2019\")\nToDate = CDate(\"12/31/2019\")\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\n On Error GoTo 0\n\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet olFolder = olNs.Folders(\"internetagenda's\").Folders(\"bis\")\n\n\nWith Sheets(\"blad1\")\nnextrow = .Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\n\n 'Change the name of the sheet here\n.Range(\"A1:D1\").Value = Array(\"NAAM\", \"DATUM\", \"DUUR\", \"BIJZONDERHEDEN\")\n   For Each olApt In olFolder.Items\n    If (olApt.Start &gt;= FromDate And olApt.Start &lt;= ToDate) Then\n        .Cells(nextrow, \"A\").Value = olApt.Subject\n        .Cells(nextrow, \"B\").Value = CDate(olApt.Start)\n        .Cells(nextrow, \"B\").NumberFormat = \"D MMMM YYYY\"\n        .Cells(nextrow, \"C\").Value = olApt.End - olApt.Start\n        .Cells(nextrow, \"C\").NumberFormat = \"HH:MM:SS\"\n        .Cells(nextrow, \"D\").Value = olApt.Location\n        .Cells(nextrow, \"E\").Value = olApt.Categories\n       nextrow = .Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n       Else\n       End If\n   Next olApt\n    .Columns.AutoFit\n End With\n\n Set olApt = Nothing\n Set olFolder = Nothing\n Set olNs = Nothing\n Set olApp = Nothing\n\n End Sub\n</code></pre>\n\n<p>i hope this will help people</p>\n"}], "owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 2, "accepted_answer_id": 55066500, "answer_count": 2, "score": 1, "last_activity_date": 1576430744, "creation_date": 1551895895, "last_edit_date": 1576430744, "question_id": 55029653, "link": "https://stackoverflow.com/questions/55029653/how-to-locate-a-subscribed-internet-calendars-folder-path", "title": "How to locate a subscribed internet calendar&#39;s folder path?", "body": "<p>I am trying to list the events of a subscribed internet calendar from gmail.</p>\n\n<p>The code only lists events created in the Outlook app in the Calender Folder.</p>\n\n<p>Here is the code I found on Stack Overflow:</p>\n\n<pre><code>Option Explicit\n\nSub ListAppointments()\nDim olApp As Object\nDim olNS As Object\nDim olFolder As Object\nDim olApt As Object\nDim NextRow As Long\nDim FromDate As Date\nDim ToDate As Date\n\nFromDate = CDate(\"08/25/2018\")\nToDate = CDate(\"12/31/2019\")\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\nOn Error GoTo 0\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFolder = olNS.GetDefaultFolder(9) 'olFolderCalendar 9\nNextRow = 2\n\nWith Sheets(\"Sheet1\") 'Change the name of the sheet here\n    .Range(\"A1:D1\").Value = Array(\"Project\", \"Date\", \"Time spent\", \"Location\")\n    For Each olApt In olFolder.Items\n        If (olApt.Start &gt;= FromDate And olApt.Start &lt;= ToDate) Then\n            .Cells(NextRow, \"A\").Value = olApt.Subject\n            .Cells(NextRow, \"B\").Value = CDate(olApt.Start)\n            .Cells(NextRow, \"C\").Value = olApt.End - olApt.Start\n            .Cells(NextRow, \"C\").NumberFormat = \"HH:MM:SS\"\n            .Cells(NextRow, \"D\").Value = olApt.Location\n            .Cells(NextRow, \"E\").Value = olApt.Categories\n            NextRow = NextRow + 1\n        Else\n        End If\n    Next olApt\n    .Columns.AutoFit\nEnd With\n\nSet olApt = Nothing\nSet olFolder = Nothing\nSet olNS = Nothing\nSet olApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>I am almost positive that the issue lies here:</p>\n\n<pre><code>Set olFolder = olNS.GetDefaultFolder(9) 'olFolderCalendar 9\n</code></pre>\n\n<p>The name of the folder I want to access is basic. I tried both of these:</p>\n\n<pre><code>Set olFolder = olNS.GetDefaultFolder(9).Folders(\"basic\").Items\nSet olFolder = olNS.GetDefaultFolder(9).Parent.Folders(\"basic\").Items\n</code></pre>\n\n<p>None worked.</p>\n\n<blockquote>\n  <p>Run-time error '-2147221233 (8004010f)':<br>\n  The Attempted operation failed. An Object Could Not Be Found.</p>\n</blockquote>\n\n<p>Here is the basic folder I want to grab the events from.<br>\n<a href=\"https://i.stack.imgur.com/pmRvh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pmRvh.png\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT:<br>\nI ultimately found: <code>olNS.GetDefaultFolder(9).Parent = email@gmail.com</code> and its child is one of my calendars \"Calendar\" seen in the picture. The parent of \"basic\" calendar is Internet Calendars. How can I set olFolder to the directory '\\Internet Calendars\\basic' instead of '\\email@gmail.com\\Calendar'?</p>\n"}, {"tags": ["excel", "vba", "ms-word", "paste"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1551895777, "post_id": 55029510, "comment_id": 96811837, "body": "try replacing <code>DataType:=PasteJPEGFilePicture</code> with <code>DataType:=PasteMetafilePicture</code>"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1551895944, "post_id": 55029510, "comment_id": 96811939, "body": "I did! it does the same exact thing"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1551896867, "post_id": 55029510, "comment_id": 96812351, "body": "Is there a way to set the width and height of the chart through VBA?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551902228, "post_id": 55029510, "comment_id": 96814974, "body": "Following up on Asgar&#39;s comment, below that answer: Do you get the same behavior if you copy/paste manually?"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551902400, "post_id": 55029510, "comment_id": 96815090, "body": "@CindyMeister nope! it pastes to fit perfect"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551903110, "post_id": 55029510, "comment_id": 96815461, "body": "Where did you get this: <code>Placement:=Tight</code>?  This is not a valid specification for the Placement argument of PasteSpecial. Is the object coming in in-line with the text or &quot;floating&quot;? And is it the same type when you paste manually (in-line or floating)?"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1551903786, "post_id": 55029510, "comment_id": 96815756, "body": "It&#39;s in-line when I paste manually, but even if I use Placement:=InLine nothing changes"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551903917, "post_id": 55029510, "comment_id": 96815817, "body": "It needs to be <code>Placement:=wdInLine</code> - you have to use values VBA understands. Read the information in the help..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551903982, "post_id": 55029510, "comment_id": 96815840, "body": "FWIW I get the impression the bookmark is in a table or something. But, yes, it&#39;s possible to resize an InlineShape. An InlineShape has Width and Height properties."}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551904510, "post_id": 55029510, "comment_id": 96816071, "body": "@cindy what would the code look like if I were to do that?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1551901829, "post_id": 55030203, "comment_id": 96814750, "body": "It&#39;s still sizing the same exact way"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1551902279, "post_id": 55030203, "comment_id": 96815009, "body": "just the first line of the second page"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1551906986, "post_id": 55030203, "comment_id": 96817100, "body": "word.range isn&#39;t a user defined type?"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1559748197, "post_id": 55030203, "comment_id": 99518543, "body": "Glad to be a lifesaver ... and then please mark my answer as answer as described <a href=\"https://stackoverflow.com/help/accepted-answer\">here</a>."}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1551909687, "last_edit_date": 1551909687, "creation_date": 1551898148, "answer_id": 55030203, "question_id": 55029510, "link": "https://stackoverflow.com/questions/55029510/copy-excel-chart-into-word-document-resizing/55030203#55030203", "title": "Copy Excel Chart into Word Document Resizing", "body": "<p>I don't know what you assigned to <code>PasteJPEGFilePicture</code>and <code>Tight</code>. If you paste as Bitmap inline, then it's sized according to the page width.</p>\n\n<p>If you will use a reference to <code>Microsoft Word x.x. Object Library</code> for early binding, you may use <code>Word.Range</code> and the ENUM values <code>wd...</code>.</p>\n\n<pre><code>Dim r As Object              ' Word.Range\nWith wordapp\n    Set r = .ActiveDocument.Bookmarks(\"Chart\").Range\n    r.Collapse 1             ' 1 = wdCollapseStart, 0 = wdCollapseEnd\n    r.PasteSpecial _\n        Link:=False, _\n        DataType:=4, _\n        Placement:=0, _\n        DisplayAsIcon:=False ' 1st 4 = wdPasteBitmap, 2nd 0 = wdInLine\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551909687, "creation_date": 1551895268, "last_edit_date": 1551906616, "question_id": 55029510, "link": "https://stackoverflow.com/questions/55029510/copy-excel-chart-into-word-document-resizing", "title": "Copy Excel Chart into Word Document Resizing", "body": "<p>I'm attempting to make an excel sheet that has a button \"Generate Report\" where as I click it, it opens up a document and writes a report based on the excel sheet. I have everything going good for me except pasting charts in to the word document. Every time I paste it into word using VBA the sizing is all off, like this: <a href=\"https://i.stack.imgur.com/brSUz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/brSUz.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want it to look like this:\n<a href=\"https://i.stack.imgur.com/iACsU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iACsU.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code is:</p>\n\n<pre><code>'Charts\nWorksheets(\"Input\").ChartObjects(\"Chart_Antenna\").Chart.ChartArea.Copy\n\nWith wordapp\n.activedocument.bookmarks(\"Chart\").Select\n.Selection.PasteSpecial Link:=False, _\nDataType:=PasteJPEGFilePicture, _\nPlacement:=Tight\nDisplayAsIcon = False\nEnd With\n</code></pre>\n"}, {"tags": ["arrays", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11097871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bfb0775a77394011ec55d0aa15d853?s=128&d=identicon&r=PG", "display_name": "Divingmickey", "link": "https://stackoverflow.com/users/11097871/divingmickey"}, "edited": false, "score": 0, "creation_date": 1551899941, "post_id": 55030085, "comment_id": 96813726, "body": "Thank you very much!! I will try it.  \ud83d\ude0a"}, {"owner": {"reputation": 11, "user_id": 11097871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bfb0775a77394011ec55d0aa15d853?s=128&d=identicon&r=PG", "display_name": "Divingmickey", "link": "https://stackoverflow.com/users/11097871/divingmickey"}, "edited": false, "score": 0, "creation_date": 1552344715, "post_id": 55030085, "comment_id": 96965799, "body": "I am still playing with it"}, {"owner": {"reputation": 11, "user_id": 11097871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bfb0775a77394011ec55d0aa15d853?s=128&d=identicon&r=PG", "display_name": "Divingmickey", "link": "https://stackoverflow.com/users/11097871/divingmickey"}, "edited": false, "score": 0, "creation_date": 1553103528, "post_id": 55030085, "comment_id": 97265275, "body": "Hello. So I had to go a different route due to my hands being tied at work. IT has disabled certain functions and I don\u2019t have permissions to enable them. I now have all my numbers as double, in one section 215 for statements to do the comparisons, and had to remove the arrays. Now I\u2019m having issues with my loops not working, passing the values, and need to pass my results to a report without using DAOs or the like."}, {"owner": {"reputation": 11, "user_id": 11097871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bfb0775a77394011ec55d0aa15d853?s=128&d=identicon&r=PG", "display_name": "Divingmickey", "link": "https://stackoverflow.com/users/11097871/divingmickey"}, "edited": false, "score": 0, "creation_date": 1553104384, "post_id": 55030085, "comment_id": 97265729, "body": "if I could upload a picture of my code this would be a lot easier. I will try to be as transparent as possible. One of my loops looks like this: do (next line) j = j +1 (next line) StartPoint = inputbox(\u201cwhere are you starting node a through z\u201d) (next line) endpoint = inputbox(\u201cwhere are you ending node a through z\u201d) (next line) loop until t = trips. Everything is double and \u201ctrips\u201d is entered by the user. The starting and ending points are passed to 215 separate for loops that use both values to test if they are true. If true, then it should assign a numerical value to the variable \u201ctime\u201d"}, {"owner": {"reputation": 11, "user_id": 11097871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bfb0775a77394011ec55d0aa15d853?s=128&d=identicon&r=PG", "display_name": "Divingmickey", "link": "https://stackoverflow.com/users/11097871/divingmickey"}, "edited": false, "score": 0, "creation_date": 1553104699, "post_id": 55030085, "comment_id": 97265899, "body": "\u201cTime\u201d is also a double and is used in a simple calculation such as (variable 1 + variable 2 + ...+) / (time + variable N). This calculated value and other user inputed values need to be passed to a printable report. Any ideas about how to fix this? Your assistances is always greatly appreciated. Thank you very much for everything"}], "tags": [], "owner": {"reputation": 1201, "user_id": 11155207, "user_type": "registered", "profile_image": "https://graph.facebook.com/1580155635371866/picture?type=large", "display_name": "Max Voisard", "link": "https://stackoverflow.com/users/11155207/max-voisard"}, "is_accepted": false, "score": 0, "last_activity_date": 1551899864, "last_edit_date": 1551899864, "creation_date": 1551897621, "answer_id": 55030085, "question_id": 55029494, "link": "https://stackoverflow.com/questions/55029494/two-dimensional-array-assistance/55030085#55030085", "title": "Two-dimensional array assistance", "body": "<p>I need more information from your question. You didn't state the data type of the values you are comparing, but since it is a \"calculation\" I assume that numbers are involved and I will use integers instead of floats or doubles for your 2D array in this example. Also, I don't know how to calculate the result, so I just made up a variable <code>CalculatedResult</code>.</p>\n\n<pre><code>Dim UserInput\nUserInput = InputBox(\"Please enter a number\", \"Enter Number\", Integer)\nDim CalculatedResult As Integer\n\nFor Each element In My2DArray\n  If UserInput = element Then\n    Area(element)\n  End If\nNext element\n\nFunction Area(number As Integer) As Void\n    ' Code used for calculation\n    Debug.Print CalculatedResult\nEnd Function\n</code></pre>\n\n<p>You may need to do <code>DoCmd.PrintOut</code> for the print statement instead of <code>Debug.Print</code> to display the results for Access; I'm not familiar with VBA's relation to Access. The <code>For Each</code> loop saves a lot of programming time compared to nested For loops.</p>\n"}], "owner": {"reputation": 11, "user_id": 11097871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bfb0775a77394011ec55d0aa15d853?s=128&d=identicon&r=PG", "display_name": "Divingmickey", "link": "https://stackoverflow.com/users/11097871/divingmickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594620565, "creation_date": 1551895210, "last_edit_date": 1594620565, "question_id": 55029494, "link": "https://stackoverflow.com/questions/55029494/two-dimensional-array-assistance", "title": "Two-dimensional array assistance", "body": "<p>I am new to creating arrays within Access and I have looked up a bunch of articles online that have provided some assistance.  I have created a two dimensional array and assigned values to each position with in the array. Now comes the fun part!! How do I ask for a two dimensional input, store the information, compare the user input with the array that I have already created, pass the matching value of the array to a calculation, and then display the results within Access? Any assistance would be greatly appreciated!! Thank you very much!!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 6683330, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206470463508389/picture?type=large", "display_name": "Jeremy Scott", "link": "https://stackoverflow.com/users/6683330/jeremy-scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1551894855, "creation_date": 1551894855, "answer_id": 55029396, "question_id": 55028995, "link": "https://stackoverflow.com/questions/55028995/auto-save-outlook-attachments-using-received-date-minus-1-calendar-day/55029396#55029396", "title": "Auto-Save Outlook attachments using received date (Minus 1 Calendar Day)", "body": "<p>I figured it out! Hope this solution can help someone else in the future. </p>\n\n<pre><code>Sub Save_DailyFluReport(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim dateFormat As String\nDim saveFolder As String\n\ndateFormat = Format(DateSerial(Year(itm.ReceivedTime), Month(itm.ReceivedTime), Day(itm.ReceivedTime) - 1), \"dd-mmmm-yyyy\")\nsaveFolder = \"Z:\\Infection Control\\IP Daily Surveillance Reports\"\n    For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; \" - Daily Flu Report.pdf\"\n        Set objAtt = Nothing\n\n     Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6683330, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206470463508389/picture?type=large", "display_name": "Jeremy Scott", "link": "https://stackoverflow.com/users/6683330/jeremy-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1592688819, "creation_date": 1551893429, "last_edit_date": 1592688819, "question_id": 55028995, "link": "https://stackoverflow.com/questions/55028995/auto-save-outlook-attachments-using-received-date-minus-1-calendar-day", "title": "Auto-Save Outlook attachments using received date (Minus 1 Calendar Day)", "body": "<p>Background: I receive several daily Infection Control Reports in pdf format from our electronic medical records system via Outlook email attachments. </p>\n\n<p>Request: Given the large number of reports, I am trying to find a way to autosave the attachments using an outlook rule. \nCurrently, the code I use works only to save the attachment with its respective received date. However, these medical reports largely reflect the previous day's data. Therefore, I was wondering, How would I format this code so that it will take the email attachment's received date less (minus) 1 day, and autosave it in a specified location?  </p>\n\n<p>Here is what I have so far: </p>\n\n<pre><code>Sub Save_DailyFluReport(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim dateFormat As String\nDim saveFolder As String\n\ndateFormat = Format(itm.ReceivedTime, \"dd-mmmm-yyyy\")\nsaveFolder = \"Z:\\Infection Control\\IP Daily Surveillance Reports\"\n    For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; \" - \" &amp; objAtt.DisplayName\n        Set objAtt = Nothing\n     Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 1, "creation_date": 1551894261, "post_id": 55029068, "comment_id": 96811103, "body": "The value property is the default member, BUT I did in fact try this, I just didn\u2019t mention it because it didn\u2019t seem pertinent. Thanks anyways"}, {"owner": {"reputation": 914, "user_id": 866596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b55348d23558fe0ff11a4d7bf9aa422b?s=128&d=identicon&r=PG", "display_name": "Keven M", "link": "https://stackoverflow.com/users/866596/keven-m"}, "reply_to_user": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1551894335, "post_id": 55029068, "comment_id": 96811145, "body": "Ok, as I said I wasn&#39;t sure, I work typically in C#/XAML, and I know there it&#39;s required to add it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551896582, "post_id": 55029068, "comment_id": 96812219, "body": "Default members needing to be explicitly invoked in .NET is such a blessing! Say, with VBA experience and a C#/XAML background, you wouldn&#39;t happen to be interested in contributing to <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a>? It&#39;s an open-source VBIDE add-in written in C# (currently 7.2) aiming to get the VBE into this century with features found in Visual Studio and other modern IDEs, ...and all UIs happen to be XAML and a lot of them could use some lovin&#39; =)"}, {"owner": {"reputation": 914, "user_id": 866596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b55348d23558fe0ff11a4d7bf9aa422b?s=128&d=identicon&r=PG", "display_name": "Keven M", "link": "https://stackoverflow.com/users/866596/keven-m"}, "edited": false, "score": 0, "creation_date": 1551899719, "post_id": 55029068, "comment_id": 96813616, "body": "UI design is my favorite aspect of coding, I&#39;ll take a look at it and see what I can help with."}], "tags": [], "owner": {"reputation": 914, "user_id": 866596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b55348d23558fe0ff11a4d7bf9aa422b?s=128&d=identicon&r=PG", "display_name": "Keven M", "link": "https://stackoverflow.com/users/866596/keven-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1551893703, "creation_date": 1551893703, "answer_id": 55029068, "question_id": 55028946, "link": "https://stackoverflow.com/questions/55028946/how-do-i-hide-a-control-in-a-report-based-on-a-field-value/55029068#55029068", "title": "How do i hide a control in a report based on a field value", "body": "<p>It's been a while since I've used Access and VBA, but I believe what you're missing is <code>.Value</code> after the checkbox name in the <code>if</code> clause.</p>\n\n<p>Try this : <code>If Me.chkRequireverify.Value = True</code></p>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1551894151, "post_id": 55029125, "comment_id": 96811054, "body": "I originally used the format you did, I was just making sure that I wasn&#39;t doing a dumb mistake. It looks like the format event only triggers in print preview which... sucks. I utilize the report as a data browse, and have it set up so the users can double click a record for a drill down."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1551894857, "post_id": 55029125, "comment_id": 96811420, "body": "@KySoto I&#39;ve updated my answer to provide more information."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1551900555, "post_id": 55029125, "comment_id": 96814045, "body": "Based on your information, I&#39;m stuck. I&#39;ll throw you best answer even though its not what I wanted to hear."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1551894843, "last_edit_date": 1551894843, "creation_date": 1551893866, "answer_id": 55029125, "question_id": 55028946, "link": "https://stackoverflow.com/questions/55028946/how-do-i-hide-a-control-in-a-report-based-on-a-field-value/55029125#55029125", "title": "How do i hide a control in a report based on a field value", "body": "<p>Your code looks to be correct and could be shortened to simply:</p>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n    Me.chkVerified.Visible = Me.chkRequireverify\nEnd Sub\n</code></pre>\n\n<p>However, I believe the event handler for the <code>OnFormat</code> event will only be evaluated when viewing the report in <strong>Print Preview</strong> view, rather than in <strong>Report</strong> view.</p>\n\n<p>Whilst the <code>OnPaint</code> event fires in <strong>Report</strong> view, you cannot modify certain properties after the report has been formatted, the <code>Visible</code> property being one such property, along with the <code>Height</code> &amp; <code>Width</code> properties (and so you also cannot shrink the checkboxes to zero size).</p>\n"}], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55029125, "answer_count": 2, "score": 1, "last_activity_date": 1551894843, "creation_date": 1551893300, "last_edit_date": 1551893996, "question_id": 55028946, "link": "https://stackoverflow.com/questions/55028946/how-do-i-hide-a-control-in-a-report-based-on-a-field-value", "title": "How do i hide a control in a report based on a field value", "body": "<p>I have a checkbox control that i need to hide if a Boolean value is false. I have tried using the Detail_Format event to no avail. i put the field value into another checkbox, then tried setting the visible property from the value in the checkbox, no dice. In the image below, the rightmost checkbox is showing the value of the field that determines if the checkbox to the left of it should be shown. I have the following code </p>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n  If Me.chkRequireverify = True Then\n  Me.chkVerified.Visible = True\n  Else\n  Me.chkVerified.Visible = False\n  End If\n  'Me.chkVerified.Visible = Me.chkRequireverify\nEnd Sub\n</code></pre>\n\n<p>when i tried using the Detail_Paint event, it errored out telling me that i cant change the visible property in this event.\n<a href=\"https://i.stack.imgur.com/4RhOV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4RhOV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word", "calculation"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1551894693, "post_id": 55028932, "comment_id": 96811332, "body": "<i>&quot;Below is what I have started but it does not achieve what I am trying to.&quot;</i> - please be more specific, what is the current behavior and what is the expected outcome?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1551902057, "post_id": 55028932, "comment_id": 96814866, "body": "In addition, we have no idea what <code>S1A to S1D AND S2A TO S2D on Label1.caption</code> and <code>T1A to T1D AND T2A to T2D with the output at Label2.caption</code> are. What you have and what you want are not at all clear to anyone reading this - we don&#39;t have the background knowledge of the project."}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551907451, "post_id": 55028932, "comment_id": 96817292, "body": "@Dwirony, it is adding up the count of both the checkboxes names from S1A to S1D and S2A to S2D alonf with the T1A to T1D AND T2A to T2D. I am looking to have label1.caption to give me the SUM of the count for S2A to S2D. and label2.caption to give me the SUM of T2A to T2D when checked off as true."}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551907906, "post_id": 55028932, "comment_id": 96817481, "body": "@cindy Meister, S1A, S1B, S1C and S1D are the names of the checkboxes that have the &quot;0&quot; value even if checked off as true (0 value even if checked off and the sum would be still 0) . S2A, S2B, S2C and S2D are the names of the checkboxes that have values &quot;2&quot; when checked off. The output of this first calculation should go to the label1.caption as sum of the values checked off as true."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551907924, "post_id": 55028932, "comment_id": 96817490, "body": "@M.R. When you click a box, what shows up on your label captions, 0?"}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "edited": false, "score": 0, "creation_date": 1551907965, "post_id": 55028932, "comment_id": 96817513, "body": "@ Cindy Meister. And I want to repeat the same thing for T1A to T1D (0 value even if checked off and the sum would be still 0). And T2A to T2D have values &quot;2&quot; and the sum of these values checked off as true should go to the output label2.caption."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551907996, "post_id": 55028932, "comment_id": 96817527, "body": "@M.R. What is <code>count_of_0 + 0</code>? <code>count_of_0</code> is never going to be anything other than 0...?"}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551908744, "post_id": 55028932, "comment_id": 96817848, "body": "@dwirony, label1.caption and label2.caption give the same total of the sum of the checkboxes. I want to separate the sum output the two set of checkboxes"}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551908876, "post_id": 55028932, "comment_id": 96817917, "body": "@dwirony, I jwas trying to be as details as possible and added that but you are right it will be always 0. What I am interested at is the non-zero."}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551991794, "post_id": 55028932, "comment_id": 96854989, "body": "@dwirony, any suggestion to make this work? never mind about the count_of_0. How can I get the sum of the S2A to S2D to label1 and the sum of T2A to T2D to output on label2? Please help. Thank you."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551992823, "post_id": 55028932, "comment_id": 96855434, "body": "@M.R. So you want label1 to display the 0s and label2 to display the 2s sum?"}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551993400, "post_id": 55028932, "comment_id": 96855661, "body": "@dwirony, I don&#39;t need to display the count of 0s. I need to display the count_of_2 from S2A to S2D on label1 and the count_of_2 from T2A to T2D on label2."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551993682, "post_id": 55028932, "comment_id": 96855763, "body": "@M.R. Okay I understand now. I&#39;ll post some code in a bit."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "edited": false, "score": 0, "creation_date": 1551999062, "post_id": 55053342, "comment_id": 96857653, "body": "the syntax makes sense but I will test it tonight."}, {"owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "edited": false, "score": 0, "creation_date": 1552016666, "post_id": 55053342, "comment_id": 96861842, "body": "you are the man!! the syntax works perfectly and returns the functions I intended to achieve. Thank you very much! I hope I can give you 5 Stars!!! Thank you again!!!!!!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1551995348, "creation_date": 1551995348, "answer_id": 55053342, "question_id": 55028932, "link": "https://stackoverflow.com/questions/55028932/vba-word-active-x-control/55053342#55053342", "title": "VBA word active x control", "body": "<p>Try this instead:</p>\n\n<pre><code>Dim count_of_0 As Integer\nDim scount_of_2 As Integer\nDim tcount_of_2 As Integer\nSub calculate_the_score()\ncount_of_0 = 0\nscount_of_2 = 0\ntcount_of_2 = 0\n\nIf S1A.Value = True Then count_of_0 = count_of_0 + 0\nIf S2A.Value = True Then scount_of_2 = scount_of_2 + 2\n\nIf S1B.Value = True Then count_of_0 = count_of_0 + 0\nIf S2B.Value = True Then scount_of_2 = scount_of_2 + 2\n\nIf S1C.Value = True Then count_of_0 = count_of_0 + 0\nIf S2C.Value = True Then scount_of_2 = scount_of_2 + 2\n\nIf S1D.Value = True Then count_of_0 = count_of_0 + 0\nIf S2D.Value = True Then scount_of_2 = scount_of_2 + 2\n\nIf T1A.Value = True Then count_of_0 = count_of_0 + 0\nIf T2A.Value = True Then tcount_of_2 = tcount_of_2 + 2\n\nIf T1B.Value = True Then count_of_0 = count_of_0 + 0\nIf T2B.Value = True Then tcount_of_2 = tcount_of_2 + 2\n\nIf T1C.Value = True Then count_of_0 = count_of_0 + 0\nIf T2C.Value = True Then tcount_of_2 = tcount_of_2 + 2\n\nIf T1D.Value = True Then count_of_0 = count_of_0 + 0\nIf T2D.Value = True Then tcount_of_2 = tcount_of_2 + 2\n\nLabel1.Caption = \"Total:\" &amp; scount_of_2 &amp; \"\"\nLabel2.Caption = \"Total :\" &amp; tcount_of_2 &amp; \"\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11156952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mOFI5u7QizU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf0DS0o5Dbbg3Lr2aXcAt4x5it0ZQ/mo/photo.jpg?sz=128", "display_name": "M. R.", "link": "https://stackoverflow.com/users/11156952/m-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1551995348, "creation_date": 1551893241, "last_edit_date": 1551901788, "question_id": 55028932, "link": "https://stackoverflow.com/questions/55028932/vba-word-active-x-control", "title": "VBA word active x control", "body": "<p>I am trying to make this VBA macro works to calculate two sets of data using active x controls in ms-word. For each box in the table</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZHrjN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZHrjN.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want the calculation to give the number of count each time \"2\" is checked off as true of the S1A to S1D AND S2A TO S2D on Label1.caption. </p>\n\n<p>And another set of calculations will give the number of count each time \"2\" is checked off as true of the T1A to T1D AND T2A to T2D with the output at Label2.caption.</p>\n\n<p>Below is what I have started but it does not achieve what I am trying to.</p>\n\n<pre><code>enter code here\nDim count_of_0 As Integer\nDim count_of_2 As Integer\nSub calculate_the_score()\ncount_of_0 = 0\ncount_of_2 = 0\n\nIf S1A.Value = True Then count_of_0 = count_of_0 + 0\nIf S2A.Value = True Then count_of_2 = count_of_2 + 2\n\nIf S1B.Value = True Then count_of_0 = count_of_0 + 0\nIf S2B.Value = True Then count_of_2 = count_of_2 + 2\n\nIf S1C.Value = True Then count_of_0 = count_of_0 + 0\nIf S2C.Value = True Then count_of_2 = count_of_2 + 2\n\nIf S1D.Value = True Then count_of_0 = count_of_0 + 0\nIf S2D.Value = True Then count_of_2 = count_of_2 + 2\n\nIf T1A.Value = True Then count_of_0 = count_of_0 + 0\nIf T2A.Value = True Then count_of_2 = count_of_2 + 2\n\nIf T1B.Value = True Then count_of_0 = count_of_0 + 0\nIf T2B.Value = True Then count_of_2 = count_of_2 + 2\n\nIf T1C.Value = True Then count_of_0 = count_of_0 + 0\nIf T2C.Value = True Then count_of_2 = count_of_2 + 2\n\nIf T1D.Value = True Then count_of_0 = count_of_0 + 0\nIf T2D.Value = True Then count_of_2 = count_of_2 + 2    \n\nDim the_sum As Double\n\nthe_sum = (count_of_0) + (count_of_2)\n\nLabel1.Caption = \"Total:\" &amp; the_sum &amp; \"\"\nLabel2.caption = \"Total :\" &amp; the_sum &amp; \"\"\nEnd Sub\n\n\nPrivate Sub S1A_Click()\n If S1A = True Then\n    S2A = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub S1B_Click()\n If S1B = True Then\n    S2B = False\nEnd If\n calculate_the_score\nEnd Sub\n\nPrivate Sub S1C_Click()\n If S1C = True Then\n    S2C = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub S1D_Click()\n If S1D = True Then\n    S2D = False\n End If\n  calculate_the_score\nEnd Sub\n\nPrivate Sub S2A_Click()\n If S2A = True Then\n    S1A = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub S2B_Click()\n If S2B = True Then\n    S1B = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub S2C_Click()\n If S2C = True Then\n    S1C = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub S2D_Click()\n If S2D = True Then\n    S1D = False\n End If\n calculate_the_score\n\n\n\nPrivate Sub T1A_Click()\n If T1A = True Then\n    T2A = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T1B_Click()\n If T1B = True Then\n    T2B = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T1C_Click()\n If T1C = True Then\n    T2C = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T1D_Click()\n If T1D = True Then\n    T2D = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T2A_Click()\n If T2A = True Then\n    T1A = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T2B_Click()\n If T2B = True Then\n    T1B = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T2C_Click()\n If T2C = True Then\n    T1C = False\n End If\n calculate_the_score\nEnd Sub\n\nPrivate Sub T2D_Click()\n If T2D = True Then\n    T1D = False\n End If\n calculate_the_score\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1551892932, "post_id": 55028801, "comment_id": 96810329, "body": "It should be <code>Column</code> not <code>Columns</code>."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551893036, "post_id": 55028801, "comment_id": 96810391, "body": "I made the change, but still no luck. It continues to not loop through the SUMIFS function."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1551893047, "post_id": 55028801, "comment_id": 96810399, "body": "You should always check that your search term is found before accessing its properties such as column. If it&#39;s not found your code will error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1551893159, "post_id": 55028801, "comment_id": 96810465, "body": "You&#39;ll have to check your code, step through and so on, as we don&#39;t have enough to go on. In SUMIFS your ranges must be the same size."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551893282, "post_id": 55028801, "comment_id": 96810528, "body": "I am not sure what you mean. But the code is not throwing an error. It runs through just fine, except the SUMIFS function simply does not appear do be doing anything. It just selects the column to the left of &quot;Total&quot; and then ends."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1551893337, "post_id": 55028801, "comment_id": 96810561, "body": "I&#39;m not sure you can use just a <code>String</code> reference in <code>After:=&quot;OI7&quot;</code>... Also, do you have <code>On Error Resume Next</code> in the code? If so, it&#39;s possible there&#39;s an error occurring that you&#39;re not seeing."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551893487, "post_id": 55028801, "comment_id": 96810662, "body": "@SJR, I updated the post with the entire code. @BigBen, I have <code>On Error Exit Sub</code>. That might be it. Let me check."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1551893492, "post_id": 55028801, "comment_id": 96810666, "body": "Now you&#39;ve posted the rest of your code I guess as @BigBen says it is hitting an error. Comment out the OE line to see what&#39;s going on."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1551893627, "post_id": 55028801, "comment_id": 96810735, "body": "Does that even compile?  <code>Cells(&quot;B7&quot;)</code> is not valid syntax.  <code>Range(&quot;B7&quot;)</code> would be correct.  Also - I&#39;d be very careful about inserting columns while in that <code>Find()</code> loop."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 0, "creation_date": 1551893724, "post_id": 55028801, "comment_id": 96810788, "body": "Good call. Now I am getting an error on ` With Sheets(&quot;FY19 Weekly Boston&quot;)` under <code>Dim preCol</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1551893834, "post_id": 55028801, "comment_id": 96810870, "body": "FYI &quot;getting an error&quot; is not a useful description of what goes wrong when you run your code.  Likely you&#39;re getting that error because you&#39;ve not specified which workbook to look in.  You should always fully-qualify all Range/Cells/Sheets references so there&#39;s no ambiguity and your code should never rely on a certain workbook/worksheet being active when it runs.   <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551894076, "post_id": 55028801, "comment_id": 96810998, "body": "@Tim Williams, you were absolutely right about not specifying the workbook. Thank you. However, the troubles continue. I am now recieving runtime error 13: type mismatch on <code>preCol = .Find(&quot;Total&quot;, After:=&quot;OI7&quot;, LookIn:=xlValues).Offset(0, -1).Column</code>."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 0, "creation_date": 1551894526, "post_id": 55028801, "comment_id": 96811252, "body": "Still receiving a type mismatch error. Does .Find not return an integer? How might I craft this so I receive an integer based on column location?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1551894644, "post_id": 55028801, "comment_id": 96811309, "body": "I would start with SJR&#39;s comment about about checking the result of Find() before you try to access (eg) <code>Column</code>.  Split that line up into two parts: one to find the cell and then another to get the column.  And to be on the safe side swap all your Integer types to Long."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551895283, "post_id": 55028801, "comment_id": 96811618, "body": "Also I just noticed the inner With on your Find  - I deleted my earlier correction."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1551896349, "post_id": 55028801, "comment_id": 96812112, "body": "What a learning curve this is turning out to be. I guess <code>sheetArray.Cells(i, preCol)</code> should be <code>sheetArray(s).Cells(i, preCol)</code> ?"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1551896630, "post_id": 55028801, "comment_id": 96812240, "body": "@SJR: Oh yah. There are so many errors with this code. I am brand new to VBA and coding in general. I am trying to learn on the job. I really appreciate your help!"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1551895588, "creation_date": 1551895588, "answer_id": 55029587, "question_id": 55028801, "link": "https://stackoverflow.com/questions/55028801/referencing-a-column-for-later-use-in-a-loop-in-vba/55029587#55029587", "title": "Referencing a column for later use in a loop in VBA", "body": "<p>Something like this:</p>\n\n<pre><code>Dim f As Range, preCol As Long\nWith ActiveSheet.Rows(7)\n        'Range() below is *relative* to the With range\n        Set f = .Find(\"Total\", After:=.Range(\"OI1\"), LookIn:=xlValues)\n        If Not f Is Nothing Then\n            preCol = f.Column - 1\n        Else\n            'handle missing column header\n        End If\nEnd With\nDebug.Print preCol\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55029587, "answer_count": 1, "score": -1, "last_activity_date": 1551895588, "creation_date": 1551892828, "last_edit_date": 1551894674, "question_id": 55028801, "link": "https://stackoverflow.com/questions/55028801/referencing-a-column-for-later-use-in-a-loop-in-vba", "title": "Referencing a column for later use in a loop in VBA", "body": "<p>I am attempting to create a VBA macro to import data from a RAW sheet into an array of sheets' tables using a SUMIFS function. This function needs to loop down the column for each site listed and set the cell's value according to the SUMIFS.</p>\n\n<p>However, am having an issue and I believe it has to do with how I am referencing the column. </p>\n\n<p>The column-finding portion <em>should</em> look for the column to the left of the column containing \"Total\" in Row 7 and then set preCol equal to that column number. </p>\n\n<p>I am receiving Error 13: Type mismatch on <code>preCol = .Find(\"Total\", After:=\"OI7\", LookIn:=xlValues).Offset(0, -1).Column</code> which makes sense, but I cannot think of a method to find a column and then turn that into an integer based on that column's location.</p>\n\n<p>Any advice or insight is greatly appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub ImportFile()\n\n    'Select import file\n    On Error GoTo err\n    Dim importFilePath As String\n    Dim fileExplorer As FileDialog\n    Set fileExplorer = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fileExplorer\n        .AllowMultiSelect = False\n        .Filters.Add \"Excel Files\", \"*.xls; *.xlsx; *.xlsm; *.xlsb\", 1\n        .Show\n        If .SelectedItems.Count &gt; 0 Then\n            importFilePath = .SelectedItems.Item(1)\n        Else\n            GoTo err\n            MsgBox \"Import cancelled.\"\n        End If\n    End With\n\n    'Beginning processes\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    'Defining and setting variables\n    'Loop variables\n    Dim i As Integer\n    Dim j As Integer\n    Dim s As Integer\n\n    'RAW workbook\n    Dim dataFile As Worksheet\n        Set dataFile = Workbooks.Open(importFilePath).Sheets(\"Cons Tx excluding credits\")\n\n    'Worksheet variables\n    Dim wsBOS As Worksheet\n        Set wsBOS = ThisWorkbook.Sheets(\"FY19 Weekly Boston\")\n    Dim wsMilford As Worksheet\n        Set wsMilford = ThisWorkbook.Sheets(\"FY19 Weekly Milford\")\n    Dim wsMansfield As Worksheet\n        Set wsMansfield = ThisWorkbook.Sheets(\"FY19 Weekly Mansfield\")\n    Dim wsSSH As Worksheet\n        Set wsSSH = ThisWorkbook.Sheets(\"FY19 Weekly SSH\")\n    Dim wsLP As Worksheet\n        Set wsLP = ThisWorkbook.Sheets(\"FY19 Weekly Libbey Park\")\n\n    Dim sheetArray As Variant\n        sheetArray = Array(wsBOS, wsMilford, wsMansfield, wsSSH, wsLP)\n\n\n    'SUMIF function variables\n    Dim sumIfRange As Range                             'Quantity\n        Set sumIfRange = dataFile.Range(\"M:M\")\n    Dim cSiteRange As Range                             'Disease site\n        Set cSiteRange = dataFile.Range(\"AM:AM\")\n    Dim criteriaSite As Range\n    Dim cDeptRange As Range                             'Department\n        Set cDeptRange = dataFile.Range(\"B:B\")\n    Dim criteriaDept As Range\n    Dim cTherapyRange As Range                          'Therapy used\n        Set cTherapyRange = dataFile.Range(\"E:E\")\n    Dim criteriaTherapy As Range\n    Dim c2TherapyRange As Range\n        Set c2TherapyRange = dataFile.Range(\"E:E\")\n    Dim criteria2Therapy As Range\n    Dim cGlandGURange As Range\n        Set cGlandGURange = dataFile.Range(\"AM:AM\")\n    Dim criteriaGlandGU As Range\n\n    'Insert before column containing \"Total\"\n    Dim f As Range\n    Dim firstAddress As String\n\n    For s = LBound(sheetArray) To UBound(sheetArray)\n        With sheetArray(s)\n            With .Rows(7).SpecialCells(XlCellType.xlCellTypeConstants, xlTextValues)\n                Set f = .Find(what:=\"Total\", LookIn:=xlValues, lookat:=xlWhole)\n                If Not f Is Nothing Then\n                    firstAddress = f.Offset(, 1).Address '&lt;-- offset by one column since f will be shifted one column to the right in subsequent statement\n                    Do\n                        f.EntireColumn.Insert\n                        Set f = .FindNext(f)\n                    Loop While f.Address &lt;&gt; firstAddress\n                End If\n            End With\n        End With\n    Next s\n\n    Dim preCol As Long\n        With Sheets(\"FY19 Weekly Boston\")\n            With .Rows(7).SpecialCells(XlCellType.xlCellTypeConstants, xlTextValues)\n                preCol = .Find(\"Total\", After:=\"OI7\", LookIn:=xlValues).Offset(0, -1).Column\n            End With\n        End With\n\n    For s = 1 To UBound(sheetArray)\n        With sheetArray(s)\n            For i = 8 To 21\n                Set criteriaDept = sheetArray(s).Cells(\"B7\")\n                Set criteriaSite = sheetArray(s).Cells(i, 2)\n                Set criteriaTherapy = sheetArray(s).Cells(\"C6\")\n                Set criteria2Therapy = sheetArray(s).Cells(\"C7\")\n                    sheetArray.Cells(i, preCol) = Application.WorksheetFunction.SumIfs(sumIfRange, cSiteRange, criteriaSite, cDeptRange, criteriaDept, cTherapyRange, criteriaTherapy) + Application.WorksheetFunction.SumIfs(sumIfRange, cSiteRange, criteriaSite, cDeptRange, criteriaDept, c2TherapyRange, criteria2Therapy)\n            Next i\n        End With\n    Next s\n\n        Set criteriaDept = Nothing\n        Set criteriaSite = Nothing\n        Set criteriaTherapy = Nothing\n        Set criteria2Therapy = Nothing\n\n\n\n\n\n\n\n    'Ending processes\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nerr:\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "xml", "vba", "msxml6"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551894868, "post_id": 55028753, "comment_id": 96811424, "body": "Likely a missing name space"}, {"owner": {"reputation": 3, "user_id": 10776655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7e356e60c5db626fb51a5067680202?s=128&d=identicon&r=PG&f=1", "display_name": "WPBird", "link": "https://stackoverflow.com/users/10776655/wpbird"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551896122, "post_id": 55028753, "comment_id": 96812021, "body": "@QHarr In the XML or the SelectionNamespaces property?  The feed element, as I understand it, should be using the default namespace (xmlns=&quot;<a href=\"http://www.w3.org/2005/Atom&quot;\" rel=\"nofollow noreferrer\">w3.org/2005/Atom&quot;</a>), which I have attempted to map to the &#39;a&#39; prefix in the code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10776655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7e356e60c5db626fb51a5067680202?s=128&d=identicon&r=PG&f=1", "display_name": "WPBird", "link": "https://stackoverflow.com/users/10776655/wpbird"}, "edited": false, "score": 0, "creation_date": 1551914117, "post_id": 55033601, "comment_id": 96819879, "body": "Perfect, thanks.  (With luck, this will be the only time I have to work in VBA...)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1551913475, "creation_date": 1551913475, "answer_id": 55033601, "question_id": 55028753, "link": "https://stackoverflow.com/questions/55028753/selectsinglenode-failure-in-vba/55033601#55033601", "title": "SelectSingleNode failure in VBA", "body": "<pre><code>Quotes = oXMLDoc.SelectSingleNode(\"//a:feed\")\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Set Quotes = oXMLDoc.SelectSingleNode(\"//a:feed\")\n</code></pre>\n\n<p>The error message is misleading since it looks like it's saying the xpath target was not found, but if that happens it doesn't raise an error, it just returns <code>Nothing</code></p>\n"}], "owner": {"reputation": 3, "user_id": 10776655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7e356e60c5db626fb51a5067680202?s=128&d=identicon&r=PG&f=1", "display_name": "WPBird", "link": "https://stackoverflow.com/users/10776655/wpbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 55033601, "answer_count": 1, "score": 0, "last_activity_date": 1551945411, "creation_date": 1551892678, "last_edit_date": 1551945411, "question_id": 55028753, "link": "https://stackoverflow.com/questions/55028753/selectsinglenode-failure-in-vba", "title": "SelectSingleNode failure in VBA", "body": "<p>I'm trying to parse a returned data service file in VBA for Excel, and while I've reviewed several helpful answers to similar questions, none of them seem to get SelectSingleNode to return anything for me.</p>\n\n<p>The XML file is rather large, but the wrapper nodes are thus:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;feed xml:base=\"https://___.bpmonline.com/0/ServiceModel/EntityDataService.svc/\" xmlns=\"http://www.w3.org/2005/Atom\" xmlns:d=\"http://schemas.microsoft.com/ado/2007/08/dataservices\" xmlns:m=\"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata\"&gt;\n    &lt;title type=\"text\"&gt;labQuoteCollection&lt;/title&gt;\n    ...\n&lt;/feed&gt;\n</code></pre>\n\n<p>My relevant VBA code is here (I know some of those properties are redundant, just trying to be certain):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim NS As String\nNS = \"xmlns:a=\"\"http://www.w3.org/2005/Atom\"\" xmlns:d=\"\"http://schemas.microsoft.com/ado/2007/08/dataservices\"\" xmlns:m=\"\"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata\"\"\"\nDim QuoteData As String\nDim oXMLReq As New WinHttp.WinHttpRequest\nDim oXMLDoc As New MSXML2.DOMDocument60\nWith oXMLHTTP\n    .Open \"GET\", DataURL, False\n    .setRequestHeader \"Cookie\", AuthCookie\n    .send\n\n    QuoteData = .responseXML.XML\n    oXMLDoc.LoadXML QuoteData\n    oXMLDoc.setProperty \"SelectionLanguage\", \"XPath\"\n    oXMLDoc.setProperty \"SelectionNamespaces\", NS\n    oXMLDoc.resolveExternals = True\n    Debug.Print (oXMLDoc.parseError.ErrorCode)\n    Debug.Print oXMLDoc.XML\n    Dim Quotes As IXMLDOMNode\n    Quotes = oXMLDoc.SelectSingleNode(\"//a:feed\")\n    If Quotes Is Nothing Then\n        Debug.Print \"fail\"\n    End If\nEnd With\n</code></pre>\n\n<p>I can see that the XML is loaded into oXMLDoc without error, and the Print statement outputs it in its entirety, but none of the XPath queries I've attempted have returned anything. The other questions I've seen on the topic suggest that the above query is correct; am I perhaps missing something else?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551892160, "post_id": 55028502, "comment_id": 96809815, "body": "Why can&#39;t the code that generates workbooks just cycle all sheets in the generated workbook and set the width as needed? Relying on, and hijacking application-wide settings for this doesn&#39;t strike me as a good idea."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1551892914, "post_id": 55028502, "comment_id": 96810317, "body": "Why would you need admin privileges to create a template sheet?"}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1551892996, "post_id": 55028502, "comment_id": 96810365, "body": "To paste the template sheet into the correct directory. However I agree with Mathieu, will just use the .AutoFit function on certain columns. Not a perfect solution, but it would be too tedious to try and code the exact column widths for each cells that wouldn&#39;t display correctly otherwise.."}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551892023, "creation_date": 1551891775, "last_edit_date": 1551892023, "question_id": 55028502, "link": "https://stackoverflow.com/questions/55028502/setting-default-column-width-for-the-workbooks-add-function-using-vba-in-excel", "title": "Setting default column width for the &quot;Workbooks.Add&quot; function using VBA in Excel", "body": "<p>In one of my codes, I'm automatically generating new workbooks. I need the column width to essentially be double whatever the default is (8.43 I assume).</p>\n\n<p>Microsoft's workaround is to create an Excel template file, however that would require Admin privileges which I do not want to use as this file will be shared with non-admin users.</p>\n\n<p>I'm looking for a code similar to this:</p>\n\n<pre><code>Application.SheetsInNewWorkbook = 4\n</code></pre>\n\n<p>Wherein it sets the default number of sheets in any new workbook I create to 4. Is there something equivalent for column widths? I cannot seem to find it.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1551896725, "post_id": 55028356, "comment_id": 96812284, "body": "If folder doesn&#39;t already exist, need code to create it before export. <a href=\"https://stackoverflow.com/questions/41447395/access-vba-lookup-folder-and-create-if-does-not-exist-dlookup\" title=\"access vba lookup folder and create if does not exist dlookup\">stackoverflow.com/questions/41447395/&hellip;</a>. Use whatever pathing you want. Can dynamically construct path with info from field, report name, user input, current date. Use conditional statements in code. Do some research and when you have specific code with issue, post question. TransferSpreadsheet will overwrite file."}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551978607, "post_id": 55028356, "comment_id": 96848642, "body": "Thank you for your feedback and guiding me to that link. I apologize for not taking the time to investigate further, but I kept getting stuck. However, I was actually able to do exactly what I want to do! It might not be the most efficient nor the best way, but it works for me. I will post specific questions later to see if I can make any improvements. Thank you again! I will post my answer for any curious people."}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "is_accepted": true, "score": 0, "last_activity_date": 1552751464, "creation_date": 1552751464, "answer_id": 55198634, "question_id": 55028356, "link": "https://stackoverflow.com/questions/55028356/ms-access-vba-and-macro-to-export/55198634#55198634", "title": "MS Access VBA and Macro to Export", "body": "<p>Here is the code I used. I hope it helps someone else!</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Function ExportExcel()\n\n  'Declare all variables\n\n  Dim file As Object\n\n  Dim filepath As String\n  Dim fp_report1 As String\n  Dim fp_report2 As String\n  Dim fp_report1_date As String\n  Dim fp_report2_date As String\n  Dim data1 As String\n  Dim data2 As String\n  Dim data3 As String\n  Dim fp_report1_data1 As String\n  Dim fp_report1_data2 As String\n  Dim fp_report2_data3 As String\n  Dim fp_reportdate As String\n  Dim reportdate_backup As String\n  Dim reportdate As String\n\n\n  Dim data1_run As String\n  Dim data2_run As String\n  Dim data3_run As String\n\n  Dim myVar As Date\n\n\n  'Get report date from the ReportDate linked table\n  myVar = DLookup(\"ReportDate\", \"tbl_reportdate\", \"ReportDate\")\n\n  ' Get current path\n  filepath = CurrentProject.Path\n\n  'Destination for files for dashboard\n  fp_report1 = Left(filepath, 87) &amp; \"\\report1\\\"\n  fp_report2 = Left(filepath, 87) &amp; \"\\report2\\\"\n\n  'Location for backup with the date as the folder name\n  fp_report1_date = Left(filepath, 87) &amp; \"\\report1\\\" &amp; Format(myVar, \"yyyy-mm-dd\")\n  fp_report2_date = Left(filepath, 87) &amp; \"\\report2\\\" &amp; Format(myVar, \"yyyy-mm-dd\")\n\n  'Location of raw reports to backup and date file\n  fp_report1_data1 = Left(filepath, 97) &amp; \"report1_data1.xls\"\n  fp_report1_data2 = Left(filepath, 97) &amp; \"report1_data2.xls\"\n  fp_report2_data3 = Left(filepath, 97) &amp; \"report2_data3.xls\"\n  fp_reportdate = Left(filepath, 97) &amp; \"ReportDate.xlsx\"\n\n  'If the folders for the backup doesn't exist, create it, otherwise, do nothing.\n  If Dir(fp_report1_date, vbDirectory) = \"\" _\n  Then MkDir (fp_report1_date) _\n  Else _\n\n  If Dir(fp_report2_date, vbDirectory) = \"\" _\n  Then MkDir (fp_report2_date) _\n  Else _\n\n  'Exact path with file name for backup of processed data in the appropriate date folder\n  data1 = fp_report1_date &amp; \"\\\" &amp; \"data1.xlsx\"\n  data2 = fp_report1_date &amp; \"\\\" &amp; \"data2.xlsx\"\n  data3 = fp_report2_date &amp; \"\\\" &amp; \"data3.xlsx\"\n  reportdate_backup = fp_report1_date &amp; \"\\\" &amp; \"ReportDate.xlsx\"\n\n  'Exact path with file name for dashboard to automatically pull\n  data1_run = fp_report1 &amp; \"data1.xlsx\"\n  data2_run = fp_report1 &amp; \"data2.xlsx\"\n  data3_run = fp_report2 &amp; \"data3.xlsx\"\n  reportdate = fp_report1 &amp; \"ReportDate.xlsx\"\n\n  'Export queries into the date backup folder\n  DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"data1\", data1\n  DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"data2\", data2\n  DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"data3\", data3\n\n  'Copy the files from the date backup folder into the path to be used by the dashboard. This includes the raw data in the reports and all the processed reports\n  FileCopy data1, data1_run\n  FileCopy data2, data2_run\n  FileCopy data3, data3_run\n  FileCopy fp_report1_data1, fp_report1_date &amp; \"\\\" &amp; \"report1_data1.xls\"\n  FileCopy fp_report1_data2, fp_report1_date &amp; \"\\\" &amp; \"report1_data2.xls\"\n  FileCopy fp_report2_data3, fp_report2_date &amp; \"\\\" &amp; \"report2_data3.xls\"\n  FileCopy fp_reportdate, reportdate_backup\n  FileCopy reportdate_backup, reportdate\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 55198634, "answer_count": 1, "score": -1, "last_activity_date": 1552751464, "creation_date": 1551891309, "question_id": 55028356, "link": "https://stackoverflow.com/questions/55028356/ms-access-vba-and-macro-to-export", "title": "MS Access VBA and Macro to Export", "body": "<p>I have a MS Acccess 2013 Database with many stored queries and linked tables to Excel spreadsheets. There are 3 in particular I need to export and I need to create backups as well. In my attempt to automate it, I am trying to use VBA.</p>\n\n<p>Query Names:</p>\n\n<pre><code>query1\nquery2\nquery3\n</code></pre>\n\n<p>The DB is located in <code>\\\\Reports\\Run\\Data</code>\nI would like BOTH the first and second query to export to both <code>\\\\Reports\\Type1\\</code> and  <code>\\\\Reports\\Type1\\[new sub-folder 1]</code>\nI would like the third query to export to both <code>\\\\Reports\\Type2\\</code>and  <code>\\\\Reports\\Type2\\[new sub-folder 2]</code></p>\n\n<p>One of the linked Excel spreadsheets <code>(Table Name = Sheet1)</code> has 1 single field and 1 single entry, which is the <code>ReportDate</code>. I would like both <code>[new sub-folder 1]</code> and <code>[new sub-folder 2]</code> to be that single date entry. For example, if 2019-03-06 was the entry, both sub-folders should be called \"2019-03-06\". These are my backup and stored copies. </p>\n\n<p>The export should overwrite the existing files in <code>\\\\Reports\\Type1</code> and <code>\\\\Reports\\Type2</code>. </p>\n\n<p>It would be nice to be able to prefix the names the files in the new sub-folders with the <code>ReportDate</code> as well if possible. </p>\n\n<p>So the final result would then be \n<code>\\\\Reports\\Type1\\2019-03-06\\20190306_query1.xlsx</code>, \n<code>\\\\Reports\\Type1\\2019-03-06\\20190306_query2.xlsx</code> and \n<code>\\\\Reports\\Type2\\2019-03-06\\20190306_query3.xlsx</code> as an example.</p>\n\n<p>I created a macro to export and converted it to VBA as a starting point. However, I am not sure how to do the dynamic naming and changing the path dynamically of the export.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1551891632, "post_id": 55028133, "comment_id": 96809460, "body": "It should be the other way around, the x becomes be z, because you are using X when calling the module, the module is listing them as Z on the first line Sub Input(...) what you should do is not to pass the values, set them up as global variables and just call SetInput without any variables passed and you can use the same name on both subscripts."}], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1551891781, "creation_date": 1551891781, "answer_id": 55028505, "question_id": 55028133, "link": "https://stackoverflow.com/questions/55028133/variable-names-dont-match-but-still-works/55028505#55028505", "title": "Variable names don&#39;t match but still works", "body": "<p>You may want to use public variables if you will use them across subscripts.</p>\n\n<pre><code>Public zDOB As Variant\nPublic zRetAte As Variant\nSub textSub()\n    Call Inputs\nEnd Sub\nSub Inputs()\n    zDOB = Range(\"B1\")\n    zRetAge = Range(\"B7\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "is_accepted": false, "score": 0, "last_activity_date": 1551893558, "last_edit_date": 1551893558, "creation_date": 1551892331, "answer_id": 55028660, "question_id": 55028133, "link": "https://stackoverflow.com/questions/55028133/variable-names-dont-match-but-still-works/55028660#55028660", "title": "Variable names don&#39;t match but still works", "body": "<p>When you call a Function/Sub in VBA, you can pass values to it, normally referred to as <em>arguments</em>. The names of arguments and their types are defined in the routine's signature like you have here:</p>\n\n<pre><code>Sub Inputs(zDOB As Date, zRetAge As Double, zRetDate As Date, ...)\n</code></pre>\n\n<p>To call a routine with certain arguments, you can pass them from the calling code as raw values:</p>\n\n<pre><code>Inputs 1, 2, 4 ... 'equiv to the obsolete Call Inputs(1, 2, 4 ...)\n</code></pre>\n\n<p>OR, the values you supply when you call a routine can be stored in <em>variables</em>. So I can have a variable being passed as an argument:</p>\n\n<pre><code>Dim x as Date 'here I 'declare' x, you don't generally have to do this but it's advised\nx = CDate(Range(\"A1\")) 'here I assign a Value (the date in A1) to a variable (x)\nInputs x, 3, 4, ... 'and call Inputs passing a variable (x) and some values(3,4) as argments\n</code></pre>\n\n<p>or equivalently for your code:</p>\n\n<pre><code>Dim xDOfB, xRetirementAge, xDateRetire ...\n'xDofB = blah 'we could initialise values here\n'xRetirementAge = foo\nInputs xDOfB, xRetirementAge, xDateRetire, ... 'call a function with these variables as arguments\n</code></pre>\n\n<p>So <code>xFoo</code> and <code>zFoo</code> are just variables held by different procedures, the calling code and the Inputs routine respectively</p>\n\n<hr>\n\n<p>Now what's weird is what the <code>Inputs</code> routine actually does. It takes a load of arguments, which normally would contain values you want to use in the routine. However they are all immediately overwritten. It's a bit like the following:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Dim x As Long\n    x = 5\n    Debug.Print x 'prints 5; the value initially stored in x\n    Foo x 'call Foo, passing the variable x which contains the value 5\n    Debug.Print x 'Actually prints 2! (see below)\nEnd Sub\n\nSub Foo(arg1 As Long)\n    arg1 = 2\n    Debug.Print arg1 'prints 2, the 5 we passed is gone\nEnd Sub\n</code></pre>\n\n<p>Why would you ever want to do that?</p>\n\n<p>I suspect 2 possible reasons:</p>\n\n<ol>\n<li><p>The routine declares a load of arguments, when the intention was actually just to declare a load of variables, in which case the code should in fact be:</p>\n\n<pre><code> Sub Inputs()\n    Dim zDOB As Date\n    Dim zRetAge As Double\n    Dim zRetDate As Date\n    ...\n\n    zDOB = Range(\"B1\")\n    zRetAge = Range(\"B7\")\n    zRetDate = Range(\"B8\")\n    ...\n\nEnd Sub\n</code></pre>\n\n<p>And can be called without any <code>xBlah</code> variables passed</p></li>\n<li><p>The routine is exploiting the default <code>ByRef</code> passing of arguments, and is in fact designed to overwrite all those variables in place (the reason why <code>x</code> is assigned 2 even though it is declared outside the function)</p>\n\n<p>In that case the signature should be made explicit:</p>\n\n<pre><code>Sub Inputs(ByRef zDOB As Date, ByRef zRetAge As Double, ByRef zRetDate As Date ...)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 11160989, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s44wsJzr-3s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxVvAMrdNDjdRKRhq1R51DA3_JCQ/mo/photo.jpg?sz=128", "display_name": "Stephen Roche", "link": "https://stackoverflow.com/users/11160989/stephen-roche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1551945401, "creation_date": 1551890566, "last_edit_date": 1551945401, "question_id": 55028133, "link": "https://stackoverflow.com/questions/55028133/variable-names-dont-match-but-still-works", "title": "Variable names don&#39;t match but still works", "body": "<p>I'm looking at a file that someone in my work created, it has the below:</p>\n\n<pre><code>Sub Inputs(zDOB As Date, zRetAge As Double, zRetDate As Date, zDOJ As Date, zEmployer As Double, zEmployee As Double, _\n           zSalary() As Double, zInflation As Double, zFund As Double, zAVCRate As Double, zEvalDate As Date, zAVCFund As Double, _\n           zCharge As Double, zFund2 As Double, zAVCFund2 As Double)\n\n    zDOB = Range(\"B1\")\n    zRetAge = Range(\"B7\")\n    zRetDate = Range(\"B8\")\n    zDOJ = Range(\"B11\")\n    zEmployer = Range(\"B15\")\n    zEmployee = Range(\"B16\")\n    zSalary(0) = Range(\"B14\")\n    zInflation = Range(\"B19\")\n    zFund = Range(\"B20\")\n    zFund2 = Range(\"B20\")\n    zAVCRate = Range(\"B24\")\n    zAVCFund = Range(\"B27\")\n    zAVCFund2 = Range(\"B27\")\n    zEvalDate = Range(\"B6\")\n    zCharge = Range(\"J7\")\n\nEnd Sub\n</code></pre>\n\n<p>Fair enough, this is setting up the inputs to be used later.</p>\n\n<p>My problem is when this sub is called again:</p>\n\n<pre><code>Call Module3.Inputs(xDOfB, xRetirementAge, xDateRetire, xDOJ, xEmployer, xEmployee, xSalary, _\n                         xInflation, xFund, xAVC, xEvalDate, xAVCFund, xCharge, xFund2, xAVCFund2)\n</code></pre>\n\n<p>The z is now x, does this make a difference? How does this work?</p>\n"}, {"tags": ["windows", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 9, "user_id": 3581906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c1df18bd5637d53ce4d18460890a9a?s=128&d=identicon&r=PG&f=1", "display_name": "NewbieAtVBA", "link": "https://stackoverflow.com/users/3581906/newbieatvba"}, "edited": false, "score": 0, "creation_date": 1551895157, "post_id": 55027758, "comment_id": 96811558, "body": "Iv tried using:  #If VBA7 Then     Private Declare PtrSafe Sub Sleep Lib &quot;kernel32&quot; (ByVal ms As LongPtr) #Else     Private Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal ms as Long) #End If"}], "answers": [{"tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 1, "last_activity_date": 1552131583, "last_edit_date": 1552131583, "creation_date": 1552131174, "answer_id": 55076920, "question_id": 55027758, "link": "https://stackoverflow.com/questions/55027758/error-while-integrating-camera-to-ms-access/55076920#55076920", "title": "Error while Integrating Camera to MS Access", "body": "<p>The conditional compilation (<code>#If VBA7</code>) is not necessary unless your DB needs to run on<code>Office 2007</code>or lower. If oldest version is<code>Office 2010</code>you just need </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal ms As Long)\n</code></pre>\n\n<p>because<code>VBA7</code>converts<code>LongPtr</code>to data-type<code>Long</code>on Office x86 and to<code>LongLong</code>on Office x64. </p>\n\n<p>Recognize the argument<code>ms</code>stays a<code>Long</code>as it is no Pointer/Handle. See <a href=\"https://codekabinett.com/rdumps.php?Lang=2&amp;targetDoc=windows-api-declaration-vba-64-bit\" rel=\"nofollow noreferrer\">How to convert Windows API declarations in VBA for 64-bit</a> for more information.</p>\n\n<p>If you need to support old Office-Versions before VBA7 use:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>#If VBA7 Then\n  Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal ms As Long)\n#Else\n  Private Declare Sub Sleep Lib \"kernel32\" (ByVal ms as Long)\n#End If\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 3581906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c1df18bd5637d53ce4d18460890a9a?s=128&d=identicon&r=PG&f=1", "display_name": "NewbieAtVBA", "link": "https://stackoverflow.com/users/3581906/newbieatvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552259713, "creation_date": 1551889343, "last_edit_date": 1552259713, "question_id": 55027758, "link": "https://stackoverflow.com/questions/55027758/error-while-integrating-camera-to-ms-access", "title": "Error while Integrating Camera to MS Access", "body": "<p>I got the code from :</p>\n\n<p><a href=\"https://www.developerfusion.com/thread/46191/how-to-capture-picture-using-webcam-in-vb60/\" rel=\"nofollow noreferrer\">https://www.developerfusion.com/thread/46191/how-to-capture-picture-using-webcam-in-vb60/</a></p>\n\n<p>However while using this code I got an compilation error></p>\n\n<p>The code in this project must be updated for use on 64-bit systems. Please review and update Declare Statements and then mark them with PtrSafe attribute.</p>\n\n<p>I used :</p>\n\n<pre><code>#If VBA7 Then\n    Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal ms As LongPtr)\n#Else\n    Private Declare Sub Sleep Lib \"kernel32\" (ByVal ms as Long)\n#End If\n</code></pre>\n\n<p>It doesnt work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1551889179, "post_id": 55027629, "comment_id": 96807967, "body": "Did you declared your variables as Double or Single? if you didn&#39;t declare them this could happen. Thought the user should input 0.05 and not .05"}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551889867, "post_id": 55027629, "comment_id": 96808397, "body": "@damian I had them declared as variants which should have allowed me to enter any data type, but I could see how it may have become confused especially if there was no preceding zero to the decimals."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1551897201, "post_id": 55027629, "comment_id": 96812494, "body": "I&#39;m assuming with <code>Variant</code>, when using <code>InputBox()</code>, it will assume then that it&#39;s a <code>String</code>, which is why the <code>+</code> simply concatenates the two. Also, some surprisingly good discussion came from this question, nice job!  Edit: Yep, <code>Dim tst as Variant &#47;&#47; tst = InputBox(&quot;What?&quot;) &#47;&#47; debug.print TypeName(tst)</code> returns <code>String</code> for an input of <code>Hi</code>, <code>3</code>, and <code>0.03</code>."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551889619, "post_id": 55027742, "comment_id": 96808224, "body": "Do you add the Option Explicit before the Dim section? Sorry very new to VBA. TIA."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551889943, "post_id": 55027742, "comment_id": 96808456, "body": "@A.Jones no worries, you add it literally at the very very top. Before you even put <code>Sub whatever()</code>. It&#39;s the first line in a module."}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551890274, "post_id": 55027742, "comment_id": 96808653, "body": "Thank you! I will be using <code>Option Explicit</code> from now on in any of my codes."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 2, "creation_date": 1551890540, "post_id": 55027742, "comment_id": 96808787, "body": "@A.Jones - It&#39;s a good habit to get in to.  FYI, you can have VBA automtically add it, see <a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">this page</a>.  It also helps prevent any typos, so if later in your code you accidentally type <code>thickmax</code>, it&#39;ll alert you that it&#39;s not declared, instead of running the code, then throwing an error when it gets to that line."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 2, "creation_date": 1551891001, "post_id": 55027742, "comment_id": 96809066, "body": "the problem with <i>not</i> specifying option explicit is that it&#39;s <i>not</i> going to throw an error on <i>that line</i>, rather somewhere else completely unrelated (if at all) - because an implicit <code>Variant</code> can hold ilterally anything, so code happily keeps running with invalid data, and the bug can pop up very far from its source, which makes the problem much harder to debug than it should be -- whereas with Option Explicit, instead of failing somewhere at runtime, it fails at compile-time, before a single statement gets to even begin to run. Failing early is always better! (CC @A.Jones)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551891165, "post_id": 55027742, "comment_id": 96809163, "body": "Not to mention, how frustrating it can be to spend 3 hours scratching your head, only to realize &quot;oh, it was a typo&quot; =)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551891351, "post_id": 55027742, "comment_id": 96809288, "body": "@MathieuGuindon - Haha, that&#39;s the exact scenario I found myself in when I then discovered <code>Option Explicit</code>.  Using <code>F8</code> to walk through a bunch of lines was getting annoying... It&#39;s a huge timesaver at the very least."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 1, "creation_date": 1551891590, "post_id": 55027742, "comment_id": 96809427, "body": "@A.Jones note that the VBE will only ever warn about a single compile-time error at a time, and that can be annoying too. <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> is a free and open-source VBIDE add-in I&#39;m contributing to (along with a bunch of folks hovering around the VBA tag on this site), that has a &quot;code inspection&quot; feature that can identify every single undeclared variable (that&#39;s just one of ~80 inspections), and declare them all at once (as explicit variants, which isn&#39;t ideal, but still better than not being declared). You might want to see if it helps!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551891724, "post_id": 55027742, "comment_id": 96809523, "body": "@A.Jones - Final comment from me - there&#39;s <a href=\"https://stackoverflow.com/questions/2454552/what-do-option-strict-and-option-explicit-do\">this thread, &quot;What do Option Strict and Option Explicit do?&quot;</a> too which has much more detail. (It&#39;s for .Net, but the Option Explicit info applies to VBA...not sure on the <code>Option Strict</code>)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551891824, "post_id": 55027742, "comment_id": 96809582, "body": "<code>Option Strict</code> is only in VB.NET; it prevents a number of narrowing implicit type conversions that VBA merrily allows (e.g. from <code>Double</code> to <code>Long</code>) -- I&#39;ll see myself out as well, cheers!"}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551962206, "post_id": 55027742, "comment_id": 96838593, "body": "@Mathieu Guindon Say I wanted to check if the user did not enter a value or hit the cancel button. What value does the input box return in those cases, zero? I know it depends on if the variable is declared as a double or string/variant, but wasn&#39;t sure exactly what it returned. TIA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 2, "creation_date": 1551963202, "post_id": 55027742, "comment_id": 96839136, "body": "@A.Jones If an empty value is legal input and you need to tell it from a cancellation, use <code>InputBox</code> from the VBA standard library (not Excel&#39;s), and the returned string will have a <code>StrPtr</code> value of 0 if cancelled. If you don&#39;t need to tell cancellation from empty input, then compare to the type&#39;s default initial value (&quot;&quot;/0)"}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551963703, "post_id": 55027742, "comment_id": 96839432, "body": "@Mathieu Guindon I tried using the default double value of 0, but it is giving me a run time 13 type mismatch error. Here is my current code:                                                           <code>thckmax = InputBox(&quot;What is the maximum nominal thickness?&quot;, &quot;Enter Max Nominal Thickness Measurement&quot;)         If thckmax = 0 Then             GoTo Line3         End If</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 4, "creation_date": 1551964718, "post_id": 55027742, "comment_id": 96840110, "body": "@A.Jones you&#39;re trying to coerce the return value into a double, but the function returns a string that may or may not implicitly convert to a double; the type mismatch is on assignment, not on comparison. Wrap the inputbox into its own double-returning function to abstract away the plumbing of receiving a string, validating whether it&#39;s numeric, attempting cdbl conversion, ...also... I&#39;ll pretend I didn&#39;t see that <code>GoTo</code> =)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1551889297, "creation_date": 1551889297, "answer_id": 55027742, "question_id": 55027629, "link": "https://stackoverflow.com/questions/55027629/inputbox-confusing-decimal-entries-with-strings/55027742#55027742", "title": "InputBox confusing Decimal entries with strings", "body": "<p>You need to declare the variables as either <code>Double</code> or <code>Single</code>, depending on the expected input:</p>\n\n<pre><code>Sub t()\nDim thckmax As Double, thckmin As Double, thcknom As Double\nthckmax = InputBox(\"What is the maximum nominal thickness?\", \"Enter Max Nominal Thickness Measurement\")\nthckmin = InputBox(\"What is the minimum nominal thickness?\", \"Enter Min Nominal Thickness Measurement\")\nthcknom = (thckmax + thckmin)\nDebug.Print thcknom\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"http://cis.poly.edu/~mleung/CS394/f06/VBA/essentialElements/dataTypes.html\" rel=\"nofollow noreferrer\">VBA's data types</a> for more info.</p>\n\n<p>Also, I suggest adding <code>Option Explicit</code> to the very top of your modules, which forces you to declare all variables.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1551889925, "post_id": 55027905, "comment_id": 96808443, "body": "Except OP is using <code>InputBox</code>, which resolves to the <code>VBA.Interaction.InputBox</code> function, which isn&#39;t <code>Excel.Application.InputBox</code>. If you want <code>Application.InputBox</code>, it must be explicitly qualified."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1551890751, "last_edit_date": 1551890751, "creation_date": 1551889774, "answer_id": 55027905, "question_id": 55027629, "link": "https://stackoverflow.com/questions/55027629/inputbox-confusing-decimal-entries-with-strings/55027905#55027905", "title": "InputBox confusing Decimal entries with strings", "body": "<p>InputBox allows you to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox\" rel=\"nofollow noreferrer\">define the input type</a>. Since you did not specify one, the default is used, which is TEXT.<br>\nSomething like </p>\n\n<pre><code>thckmax = Application.InputBox(Prompt:=\"What is the maximum nominal thickness?\", Type:=1)\n</code></pre>\n\n<p>guarantees you get a number, eventually preventing decimal symbol confusion.</p>\n"}], "owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 55027742, "answer_count": 2, "score": 2, "last_activity_date": 1551890751, "creation_date": 1551888970, "last_edit_date": 1551889821, "question_id": 55027629, "link": "https://stackoverflow.com/questions/55027629/inputbox-confusing-decimal-entries-with-strings", "title": "InputBox confusing Decimal entries with strings", "body": "<p>I am trying to use an InputBox function to be able to have a user input data. However, the data mainly consists of decimal values. When I am testing my program and I go to subtract two values, both entered from InputBox, it does not perform a mathematical operation. </p>\n\n<pre><code>thckmax = InputBox(\"What is the maximum nominal thickness?\", \"Enter Max Nominal Thickness Measurement\")\nthckmin = InputBox(\"What is the minimum nominal thickness?\", \"Enter Min Nominal Thickness Measurement\")\nthcknom = (thckmax + thckmin)\n</code></pre>\n\n<p>If I were to enter .05 and .04 respectively, it displays the preceding code as:</p>\n\n<pre><code>thcknom is .05.04\n</code></pre>\n\n<p>I am trying to perform the mathematical operation, addition, to the two variables; however, it is just \"adding\" the two strings side-by-side. How do I fix this issue?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1551893652, "post_id": 55027534, "comment_id": 96810751, "body": "I was not aware of SPLIT.  I like it as it is reusing what I had done earlier.  While awaiting for insight on potential union, I had thought of building an array of sheet names in the first loop, but I am liking the simplicity of this approach."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 2, "last_activity_date": 1551888645, "creation_date": 1551888645, "answer_id": 55027534, "question_id": 55027402, "link": "https://stackoverflow.com/questions/55027402/union-function-for-worksheets/55027534#55027534", "title": "Union function for worksheets", "body": "<p>You are going to need to loop again but this way the loop will occur only within the sheets you need to delete:</p>\n\n<pre><code>Sub Audit_Estimate_sheets()\n    Dim ws As Worksheet\n    Dim wb As Workbook\n    Dim ws_List As String\n    Dim Delete_Orphans As Integer\n    Dim Item_List_Sheet As Worksheet\n    Dim Item_List_First_Row As Long\n    Dim Item_List_Max_Row As Long\n\n    Set Item_List_Sheet = Sheets(2)\n\n    Item_List_First_Row = 14\n    Item_List_Max_Row = Item_List_First_Row + Application.WorksheetFunction.Max(Item_List_Sheet.Range(\"B:B\")) - 1\n\n    Set wb = ActiveWorkbook\n    For Each ws In wb.Worksheets\n        If IsError(Application.Match(ws.Name, Item_List_Sheet.Range(\"C\" &amp; Item_List_First_Row &amp; \":C\" &amp; Item_List_Max_Row), 0)) And Not exception(ws.CodeName) Then\n            'Colour Tab'\n            With ws.Tab\n                .ThemeColor = xlThemeColorAccent2\n                .TintAndShade = 0\n            End With\n            'Add name to list\n            If ws_List = \"\" Then\n                ws_List = ws.Name\n            Else\n                ws_List = ws_List &amp; \", \" &amp; ws.Name\n            End If\n        'SELECTION_SET = UNION(SELECTION_SET, ws)\n        End If\n    Next ws\n\n    'display list\n    Delete_Orphans = MsgBox(\"The following estimate sheets were not part of the item list and are currently orphaned:  \" &amp; vbLf &amp; vbLf &amp; ws_List &amp; vbLf &amp; vbLf &amp; \"Would you like to delete them?\", vbYesNo + vbQuestion, \"Delete Orphaned Estimates\")\n\n    Dim SplitSheets As Variant 'Declare an Array type variable\n    Dim i As Integer\n\n    If Delete_Orphans = vbYes Then\n        'loop through sheets again and delete\n        SplitSheets = Split(ws_List, \", \") 'here you will split all the names into one array\n        For i = LBound(SplitSheets) To UBound(SplitSheets) 'this way you will loop, but only on the sheets you need to.\n            wb.Sheets(SplitSheets(i)).Delete\n        Next i\n        'avoid looping again. build selection set in first loop\n        'then delete section.\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55027534, "answer_count": 1, "score": 0, "last_activity_date": 1551945395, "creation_date": 1551888284, "last_edit_date": 1592644375, "question_id": 55027402, "link": "https://stackoverflow.com/questions/55027402/union-function-for-worksheets", "title": "Union function for worksheets", "body": "<p>I have a sub that loops through my worksheets and flags them by colouring their tab red and adds their sheet name to a string. When the loop is done, a message box is displayed with a message listing the sheet name string and asking if all listed sheets should be deleted.</p>\n<p>My next step was going to be to repeat the code for the loop and this time instead of colouring and adding the name to a string, I was going to .delete the sheet.</p>\n<h3>Is there a way to build a selection set while going through the loop the first time so that if delete is option is selected I can do something similar to selection.delete?</h3>\n<pre><code>Sub Audit_Estimate_sheets()\n    Dim ws As Worksheet\n    Dim wb As Workbook\n    Dim ws_List As String\n    Dim Delete_Orphans As Integer\n    Dim Item_List_Sheet As Worksheet\n    Dim Item_List_First_Row As Long\n    Dim Item_List_Max_Row As Long\n    \n    Set Item_List_Sheet = Sheets(2)\n        \n    Item_List_First_Row = 14\n    Item_List_Max_Row = Item_List_First_Row + Application.WorksheetFunction.Max(Item_List_Sheet.Range(&quot;B:B&quot;)) - 1\n    \n    Set wb = ActiveWorkbook\n    For Each ws In wb.Worksheets\n        If IsError(Application.Match(ws.Name, Item_List_Sheet.Range(&quot;C&quot; &amp; Item_List_First_Row &amp; &quot;:C&quot; &amp; Item_List_Max_Row), 0)) And Not exception(ws.CodeName) Then\n            'Colour Tab'\n            With ws.Tab\n                .ThemeColor = xlThemeColorAccent2\n                .TintAndShade = 0\n            End With\n            'Add name to list\n            If ws_List = &quot;&quot; Then\n                ws_List = ws.Name\n            Else\n                ws_List = ws_List &amp; &quot;, &quot; &amp; ws.Name\n            End If\n        'SELECTION_SET = UNION(SELECTION_SET, ws)\n        End If\n    Next ws\n    \n    'display list\n    Delete_Orphans = MsgBox(&quot;The following estimate sheets were not part of the item list and are currently orphaned:  &quot; &amp; vbLf &amp; vbLf &amp; ws_List &amp; vbLf &amp; vbLf &amp; &quot;Would you like to delete them?&quot;, vbYesNo + vbQuestion, &quot;Delete Orphaned Estimates&quot;)\n        \n    If Delete_Orphans = vbYes Then\n        'loop through sheets again and delete\n\n        'avoid looping again. build selection set in first loop\n        'then delete section.\n    End If\n\nEnd Sub\n</code></pre>\n<p>I looked at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.union\" rel=\"nofollow noreferrer\">UNION FUNCTION</a> but if I understand correctly it is used for ranges not worksheets.</p>\n<h3>Is there a better way to achieve what I am describing?</h3>\n"}, {"tags": ["excel", "vba", "project", "user-defined-types", "office-2007"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551888457, "post_id": 55027391, "comment_id": 96807531, "body": "You could consider converting your Type to a class."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551888493, "post_id": 55027391, "comment_id": 96807552, "body": "<a href=\"https://stackoverflow.com/questions/25013024/only-public-user-defined-types-defined-in-public-object-modules-can-be-used-as-p\" title=\"only public user defined types defined in public object modules can be used as p\">stackoverflow.com/questions/25013024/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10213247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37e4b4b6f4881ff2b44266941898e6af?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Roberts", "link": "https://stackoverflow.com/users/10213247/steve-roberts"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551958410, "post_id": 55027391, "comment_id": 96836332, "body": "Thanks for the link, Tim , and apologies for not spotting this question before submitting my own. I was hazily aware that I could do something with classes but have been hesitant to dip my toe into the OO pool just yet. In for a penny; in for a pound, I suppose"}], "owner": {"reputation": 1, "user_id": 10213247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37e4b4b6f4881ff2b44266941898e6af?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Roberts", "link": "https://stackoverflow.com/users/10213247/steve-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551888226, "creation_date": 1551888226, "question_id": 55027391, "link": "https://stackoverflow.com/questions/55027391/not-possible-to-pass-udt-between-modules-on-different-projects", "title": "Not possible to pass UDT between modules on different projects", "body": "<p>I believe that what I'm about to ask is a restriction but I am hopeful that there is a satisfactory solution.</p>\n\n<p>I am working with multiple files / workbooks and am intending to keep code associated with the data as much as possible. Therefore I want to be able to link from one procedure to another across projects.</p>\n\n<p>I would like to be able to pass my arguments in a user-defined type when linking but have come up the following compiler error:</p>\n\n<p><strong>Only user-defined types defined in public object modules can be coerced to or from a variant or passed to late-bound functions</strong></p>\n\n<p>What I've found is that I only get this problem when I use <em>Application.Run</em> not when I issue a <em>Call</em> statement. However, I could not get <em>Call</em> to work across projects. Subsequent reading seems to confirm this. (I did read that <em>Application.Run</em> does not pass <em>ByRef</em> and it is also evident that UDT's can only pass <em>ByRef</em>). So it seems I'm lumbered. Here is some sample code to illustrate the point</p>\n\n<pre><code>Option Explicit\n\nPublic Type type1\n  s As String\nEnd Type\n\nPublic Sub main()\n\nDim t As type1\n\nApplication.Run \"Book2!Freda\", t\n\nEnd Sub\n</code></pre>\n\n<p>Application.Run \"Book2!Freda\", <strong>t</strong>\nis where the compiler error occurs</p>\n"}, {"tags": ["excel", "vba", "ms-word", "document", "ole"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551890839, "post_id": 55026936, "comment_id": 96808963, "body": "Double click on the table in Word. Then use the anchor points to expand (or contract it) as needed"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1551901566, "creation_date": 1551901566, "answer_id": 55031084, "question_id": 55026936, "link": "https://stackoverflow.com/questions/55026936/expandable-excel-table-to-word-document/55031084#55031084", "title": "Expandable Excel Table to Word Document", "body": "<p>As a user, it's possible to double-click on the Excel object to activate it, then drag the frame to expand/contract it in order to show a different number of rows and/or columns. </p>\n\n<p>There is no equivalent for this in the Word object model - it can't be done using code. <strong><em>Unless...</em></strong></p>\n\n<p>The table has been inserted with a link and a <code>Link</code> field manages the link. In this case, it's possible to change the cell range specified in the <code>Link</code> field and the embedded object will resize when the field is updated. </p>\n\n<p>For example, if the <code>Link</code> field code is for the range A1:B2</p>\n\n<pre><code>{ LINK Excel.Sheet.12 C:\\\\Test\\\\TestMergeData.xlsx Sheet1!R1C1:R2C2 \\a \\p }\n</code></pre>\n\n<p>changing it to A1:C3 (R1C1:R3:C3) will display three rows and columns instead of two. (You can view and edit field codes by pressing Alt+F9.)</p>\n\n<p>The VBA code would look like this:</p>\n\n<pre><code>Sub ChangeRangeLinkedExcel()\n    Dim fld As Word.Field\n    Dim ils As Word.InlineShape\n    Dim sFldCode As String\n    Dim posRangeStart As Long\n    Dim sLinkLeft As String, sRange As String, sLinkRight As String\n\n    For Each ils In ActiveDocument.InlineShapes\n        If ils.Type = 2 Then ' wdInlineShapeLinkedOLEObject\n            Set fld = ils.Range.Fields(1)\n            sFldCode = fld.code\n            posRangeStart = InStr(sFldCode, \"!R\")\n            sLinkLeft = Left(sFldCode, posRangeStart)\n            sRange = Mid(sFldCode, posRangeStart + 1, 9)\n            sLinkRight = Right(sFldCode, Len(sFldCode) - Len(sLinkLeft) - Len(sRange))\n            sRange = \"R1C1:R3C3\"\n            fld.code.Text = sLinkLeft &amp; sRange &amp; sLinkRight\n            fld.Update\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>If the Excel object is not a <code>Link</code> field then the only possibility I've ever found to change what it displays using code is to delete the object, then recreate it. When the new embedded object is insert it will automatically display the specified number of rows and columns.</p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1551908739, "creation_date": 1551908739, "answer_id": 55032666, "question_id": 55026936, "link": "https://stackoverflow.com/questions/55026936/expandable-excel-table-to-word-document/55032666#55032666", "title": "Expandable Excel Table to Word Document", "body": "<p>Simply name the range in Excel before copying &amp; pasting the link into Word. From then on, any changes to the scope or content of the named range in Excel will be reflected in Word.</p>\n\n<p>Alternatively, if you've already established the link, name the range in Excel, then edit the field code in Word. To do this, select the linked range and press Shift-F9. It should now appear as something like:</p>\n\n<pre><code>{ LINK Excel.Sheet.12 \"C:\\\\Test\\\\TestMergeData.xlsx\" \"Sheet1!R1C1:R2C2\" \\a \\p }\n</code></pre>\n\n<p>Change \"Sheet1!R1C1:R2C2\" (including the quotes) to your range name (without the quotes), then press F9 to refresh the link.</p>\n"}], "owner": {"reputation": 9, "user_id": 11158589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196a02c642b45772c995ac1e9377ca69?s=128&d=identicon&r=PG&f=1", "display_name": "HKK", "link": "https://stackoverflow.com/users/11158589/hkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551908739, "creation_date": 1551886933, "last_edit_date": 1551901597, "question_id": 55026936, "link": "https://stackoverflow.com/questions/55026936/expandable-excel-table-to-word-document", "title": "Expandable Excel Table to Word Document", "body": "<p>I need to link my Excel table in a Word document, but the option which is already in Word can only autorefresh a fix table size e.g. if I copy a 4x4 Table from Excel and paste it with link into Word it will stay 4x4. Only these cells can be refreshed, if I add a column or a row in Excel it doesn't appear in Word.</p>\n\n<p>I hope you got my problem :D </p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1551887624, "post_id": 55026833, "comment_id": 96806991, "body": "Yes, there are ways of doing this with VBA or other programming languages? But this isn&#39;t a code writing service. You&#39;ll need to write the code yourself (and ask for help with it here if you need it; people here are generous with help and knowledge).  There are also commercially available add-ins or other programs that can do this sort of thing for you."}, {"owner": {"reputation": 1, "user_id": 11160640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ySWs7ZoUUJY/AAAAAAAAAAI/AAAAAAAADjM/mG_9AYscgxA/photo.jpg?sz=128", "display_name": "rui Rui", "link": "https://stackoverflow.com/users/11160640/rui-rui"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1551919260, "post_id": 55026833, "comment_id": 96821148, "body": "Understand. Thanks."}], "owner": {"reputation": 1, "user_id": 11160640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ySWs7ZoUUJY/AAAAAAAAAAI/AAAAAAAADjM/mG_9AYscgxA/photo.jpg?sz=128", "display_name": "rui Rui", "link": "https://stackoverflow.com/users/11160640/rui-rui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551945315, "creation_date": 1551886605, "last_edit_date": 1551945315, "question_id": 55026833, "link": "https://stackoverflow.com/questions/55026833/convert-excel-datasome-cell-contains-pictures-to-powerpoint-slides", "title": "Convert excel data(some cell contains pictures) to PowerPoint slides", "body": "<p>I'd like to export a excel list data to power point slides, each line with 5 rows of data, one row is picture on it. Is there anyway to do it with VBA? Or if mailing merge able to do it? (By convert to word text lines them import to ppt). Can each row in the slide import to individual section (maybe textbox?). Thanks for your time. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551886844, "post_id": 55026830, "comment_id": 96806522, "body": "So Sheet1 should be replaced? You declare strFormulas but then use strFormulas1. Use Option Explicit!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11160609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4698095bcdbbe0500156dbc24b28cd?s=128&d=identicon&r=PG&f=1", "display_name": "crein147", "link": "https://stackoverflow.com/users/11160609/crein147"}, "edited": false, "score": 0, "creation_date": 1551888086, "post_id": 55026937, "comment_id": 96807294, "body": "How would I go about doing that? I&#39;m a noob with vba."}, {"owner": {"reputation": 1, "user_id": 11160609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4698095bcdbbe0500156dbc24b28cd?s=128&d=identicon&r=PG&f=1", "display_name": "crein147", "link": "https://stackoverflow.com/users/11160609/crein147"}, "edited": false, "score": 0, "creation_date": 1551889854, "post_id": 55026937, "comment_id": 96808391, "body": "Yes, it does, thank you very much. What would an Elseif look like if I wanted to add another formula that I want to apply to a certain worksheet? Like this?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 11160609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4698095bcdbbe0500156dbc24b28cd?s=128&d=identicon&r=PG&f=1", "display_name": "crein147", "link": "https://stackoverflow.com/users/11160609/crein147"}, "edited": false, "score": 0, "creation_date": 1551891677, "post_id": 55026937, "comment_id": 96809486, "body": "Not really sure what you&#39;re asking. If this a separate question, perhaps you accept this answer and ask a new question. If not, perhaps you can clarify?"}, {"owner": {"reputation": 1, "user_id": 11160609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4698095bcdbbe0500156dbc24b28cd?s=128&d=identicon&r=PG&f=1", "display_name": "crein147", "link": "https://stackoverflow.com/users/11160609/crein147"}, "edited": false, "score": 0, "creation_date": 1551902980, "post_id": 55026937, "comment_id": 96815397, "body": "Never mind I figured it out. And my wording was horrible, apologies."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1551887494, "last_edit_date": 1551887494, "creation_date": 1551886933, "answer_id": 55026937, "question_id": 55026830, "link": "https://stackoverflow.com/questions/55026830/loop-through-worksheets-and-insert-a-formula-based-on-the-worksheets-name/55026937#55026937", "title": "Loop through worksheets and insert a formula based on the worksheets name", "body": "<p>The main problem is that the code in your loop does not reference a sheet, so will only ever apply to the active sheet by default. And this never changes.</p>\n\n<p>If the sheet reference is in the wrong place, perhaps you can work out how to correct it.</p>\n\n<p>Also, if you are dealing with more than one open workbook, you should add workbook references as well as worksheet ones.</p>\n\n<pre><code>Sub test()\n    Dim wsSheet As Worksheet\n    Dim strFormulas As String\n    Dim Lastrow As Long\n\n    For Each wsSheet In Worksheets\n        If wsSheet.Name = \"Maintenance Formatting\" Or wsSheet.Name = \"Fuel Formatting\" Then\n            strFormulas = \"=VLOOKUP(C2,[BillingReportMacros.xlsm]'\" &amp; wsSheet.Name &amp; \"'!$G:$J,4,FALSE)\"\n            Lastrow = wsSheet.Range(\"F1\").CurrentRegion.Rows.Count + 1\n            wsSheet.Range(\"A2:A\" &amp; Lastrow).Formula = strFormulas\n        End If\n    Next wsSheet\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11160609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c4698095bcdbbe0500156dbc24b28cd?s=128&d=identicon&r=PG&f=1", "display_name": "crein147", "link": "https://stackoverflow.com/users/11160609/crein147"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551945289, "creation_date": 1551886595, "last_edit_date": 1551945289, "question_id": 55026830, "link": "https://stackoverflow.com/questions/55026830/loop-through-worksheets-and-insert-a-formula-based-on-the-worksheets-name", "title": "Loop through worksheets and insert a formula based on the worksheets name", "body": "<p>I am trying to loop through worksheets and insert a formula based on the worksheets name. The below code just loops through but only on the first worksheet. </p>\n\n<pre><code>Sub test()\n    Dim wsSheet As Worksheet\n    Dim strFormulas As Variant\n    Dim Lastrow As Long\n\n    For Each wsSheet In Worksheets\n         If wsSheet.Name = \"Maintenance Formatting\" Or _\n              wsSheet.Name = \"Fuel Formatting\" Then\n              strFormulas1 = \"=VLOOKUP(C2,[BillingReportMacros.xlsm]Sheet1!$G:$J,4,FALSE)\"\n              Lastrow = Range(\"F1\").CurrentRegion.Rows.Count + 1\n\n              Range(\"A2\").Formula = strFormulas1\n              Range(\"A2:A\" &amp; Lastrow).FillDown\n         End If\n    Next wsSheet\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551887077, "post_id": 55026798, "comment_id": 96806649, "body": "You need every highlighted cell on a different sheet? All on the same sheet? Per rows? Per columns?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551887247, "post_id": 55026798, "comment_id": 96806750, "body": "You&#39;re looping through <code>rngTemp</code> which is only a single cell."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551887424, "post_id": 55026798, "comment_id": 96806870, "body": "Read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 11160438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea120eb5f41738b214c319f37ae667?s=128&d=identicon&r=PG&f=1", "display_name": "battleboy", "link": "https://stackoverflow.com/users/11160438/battleboy"}, "edited": false, "score": 0, "creation_date": 1551890178, "post_id": 55026798, "comment_id": 96808599, "body": "No, I need all the highlighted cells  in ONE sheet  per Colums"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11160438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea120eb5f41738b214c319f37ae667?s=128&d=identicon&r=PG&f=1", "display_name": "battleboy", "link": "https://stackoverflow.com/users/11160438/battleboy"}, "edited": false, "score": 0, "creation_date": 1551889764, "post_id": 55027111, "comment_id": 96808334, "body": "first of all thanks for the reply... this code works but it generates number of sheets with to copied data... what i want is that all the copied data is in  ONE sheet ... i think i explained myself wrong at that point :D"}, {"owner": {"reputation": 3, "user_id": 11160438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea120eb5f41738b214c319f37ae667?s=128&d=identicon&r=PG&f=1", "display_name": "battleboy", "link": "https://stackoverflow.com/users/11160438/battleboy"}, "edited": false, "score": 0, "creation_date": 1551968589, "post_id": 55027111, "comment_id": 96842459, "body": "AWSOME. Thank you :D"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1558472433, "last_edit_date": 1558472433, "creation_date": 1551887448, "answer_id": 55027111, "question_id": 55026798, "link": "https://stackoverflow.com/questions/55026798/copy-paste-yellow-highlighted-cells-in-a-new-worksheet-vba/55027111#55027111", "title": "Copy/Paste Yellow Highlighted Cells in a new WorkSheet VBA", "body": "<pre><code> Sub test3()\n    Dim wbName As string\n    Dim rngTemp As Range\n    Dim r As Range\n    DIM TARGETSHEET AS WORKSHEET\n    DIM TARGET AS RANGE\n    '//open Workbook\n    wbName = Application.GetOpenFilename(, , \"Open Workbook\")\n    if  wbName = \"\" or wbname = \"CANCEL\" then exit sub\n    Workbooks.Open wbname\n\n\n    '// set Range ( Whole Sheet)\n    Set rngTemp = Activesheet.usedrange\n    SET TARGETSHEET = ACTIVEWORKBOOK.WORKSHEETS.ADD()\n    SET TARGET = TARGETSHEET.RANGE(\"A1\")  \n'// Search for Yellow highlighted Cells and (if you find one)\n    '// Copy Cell B1 + the 3rd Cell in the Column (of the highlighted Cell) + the value highlighted Cell\n    '// and paste in new Sheet\n\n        For Each r In rngTemp\n            If r.Interior.ColorIndex = 6 Then\n\n\n                TARGET = rngtemp.parent.range(\"B1\")\n                TARGET.OFFSET(0,1) = r\n                TARGET.OFFSTE(0,2) = rngtemp.parent.cells(3,r.column)\n       'I've assumed you want them across the first row\n                SET TARGET = TARGET.OFFSET(1,0)\n            End If\n        Next r\n       End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11160438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea120eb5f41738b214c319f37ae667?s=128&d=identicon&r=PG&f=1", "display_name": "battleboy", "link": "https://stackoverflow.com/users/11160438/battleboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 55027111, "answer_count": 1, "score": 0, "last_activity_date": 1558472440, "creation_date": 1551886495, "last_edit_date": 1558472440, "question_id": 55026798, "link": "https://stackoverflow.com/questions/55026798/copy-paste-yellow-highlighted-cells-in-a-new-worksheet-vba", "title": "Copy/Paste Yellow Highlighted Cells in a new WorkSheet VBA", "body": "<p>I'm trying to get this one done.</p>\n\n<p>This macro should open a workbook (workbook names always change and there's always just one sheet to process). This works.</p>\n\n<p>Set the range for the whole sheet; works fine.</p>\n\n<p>And search the entire sheet for cells highlighted in yellow, and copy these cells into a new sheet... and this is where I need help!</p>\n\n<p>I am really new to VBA and thats what I have so far:</p>\n\n<pre><code>Option Explicit\n\nSub test3()\n    Dim data As Variant\n    Dim rngTemp As Range\n    Dim cell As Range\n\n    '//open Workbook\n    data = Application.GetOpenFilename(, , \"Open Workbook\")\n    Workbooks.Open data\n\n\n    '// set Range ( Whole Sheet)\n    Set rngTemp = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n    If Not rngTemp Is Nothing Then\n        Range(Cells(1, 1), rngTemp).Select\n    End If\n\n    '// Search for Yellow highlighted Cells and (if you find one)\n    '// Copy Cell B1 + the 3rd Cell in the column (of the highlighted Cell) + the value highlighted Cell\n    '// and paste in new Sheet\n        For Each cell In rngTemp.Cells\n            If rngTemp.Interior.ColorIndex = 6 Then\n                cell.Select\n                Selection.Copy\n                Sheets.Add\n                Range(\"A1\").PasteSpecial\n                Application.CutCopyMode = False\n            End If\n        Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1551886614, "post_id": 55026791, "comment_id": 96806365, "body": "What error do you get?"}, {"owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551886691, "post_id": 55026791, "comment_id": 96806413, "body": "Run-time error &#39;1004&#39;: Application-defined or object-defined error. And it highlights the &quot;sheets(i).Protect &quot;Password&quot; row."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1551887029, "post_id": 55026791, "comment_id": 96806617, "body": "You&#39;re getting the error I believe because you have multiple worksheets selected.  AFAIK, there&#39;s no reason to select all of them, what&#39;s the purpose of selecting multiple sheets at once?  If you comment out that part, you&#39;ll see the <code>.Protect</code> line works."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1551887132, "post_id": 55026974, "comment_id": 96806683, "body": "This should work, but OP should consider why they&#39;re selecting multiple sheets in the first place.  AFAIK, there&#39;s no need to given the code posted."}, {"owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 0, "creation_date": 1551887238, "post_id": 55026974, "comment_id": 96806743, "body": "Because I was under the impression that spell check only runs on the active sheet, is that not the case?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1551887241, "post_id": 55026974, "comment_id": 96806748, "body": "I guess OP is selecting multiple sheets because they want the spellcheck to run on multiple sheets? No idea if that&#39;s necessary of course - but it makes sense given the way they&#39;re invoking the spell check."}, {"owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 0, "creation_date": 1551888257, "post_id": 55026974, "comment_id": 96807409, "body": "One sheet at a time is doable on my end, but not great for my end user time-wise."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 2, "creation_date": 1551890982, "post_id": 55026974, "comment_id": 96809058, "body": "@moosebiz - you realise that the spellchecker does it one sheet at a time too though right, whether you select all sheets or not? My point is that instead of unlocking all, running on all, locking all, the routine just deals with one sheet at a time and the loop is a lot tidier to read. The time taken to run will be the same."}, {"owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 0, "creation_date": 1551891747, "post_id": 55026974, "comment_id": 96809534, "body": "@CLR - I think your solution is best. I was originally thinking that the pause between sheets to lock and unlock would feel laggy to the end user but the delay is so slight that it&#39;s inconsequential. Thank you so much!"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 2, "last_activity_date": 1551887705, "last_edit_date": 1551887705, "creation_date": 1551887038, "answer_id": 55026974, "question_id": 55026791, "link": "https://stackoverflow.com/questions/55026791/excel-macro-unlock-spellcheck-lock/55026974#55026974", "title": "Excel Macro - Unlock, Spellcheck, Lock", "body": "<p>At the point of protecting the sheets, you still have all the sheets selected.</p>\n\n<p>Select just one before </p>\n\n<pre><code>Sheets(\"Sheet1\").Select\n\n'protect sheets\nFor I = 1 To Sheets.Count\n    Sheets(I).Protect \"Password\"\nNext I\n</code></pre>\n\n<hr>\n\n<p>However, perhaps doing them one sheet at a time is an idea..?</p>\n\n<pre><code>Sub SpellChecker()\n\n    For Each ws In Sheets\n        If ws.Visible Then\n            ws.Unprotect \"Password\"\n            ws.Select\n            Application.CommandBars.FindControl(ID:=2).Execute\n            ws.Protect \"Password\"\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 0, "creation_date": 1551891420, "post_id": 55028206, "comment_id": 96809328, "body": "This didn&#39;t seem to work. The completion message popped up immediately without addressing known spelling errors."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 0, "creation_date": 1551891551, "post_id": 55028206, "comment_id": 96809400, "body": "@moosebiz Are these errors in Constants (which it will find), or in Formula (which it won&#39;t)?  And, is the Password for each protected sheet <i>definitely</i> &quot;Password&quot;?  I have tested this, and it seems to work on my computer"}, {"owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "edited": false, "score": 0, "creation_date": 1551892004, "post_id": 55028206, "comment_id": 96809707, "body": "The errors are within actual cells, which have various formats (none of which are formulas). The password is definitely &quot;Password&quot; and is why I use macros to lock and unlock, so I don&#39;t misskey the password after typing it constantly."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1551891441, "last_edit_date": 1551891441, "creation_date": 1551890779, "answer_id": 55028206, "question_id": 55026791, "link": "https://stackoverflow.com/questions/55026791/excel-macro-unlock-spellcheck-lock/55028206#55028206", "title": "Excel Macro - Unlock, Spellcheck, Lock", "body": "<p>Here is a method that does <em>not</em> require that the Worksheets ever be unprotected - instead, it will change the Protection on Protected Sheets to allow VBA to edit cells (but <em>not</em> allow the User to edit them) - however, this requires <code>Range.CheckSpelling</code> instead of <code>Application.CommandBars.FindControl(ID:=2).Execute</code></p>\n\n<pre><code>Sub CheckAllSpelling()\n    Dim CheckSheet As Worksheet, CheckRange As Range, CheckCell As Range, SheetVisible AS XlSheetVisibility\n    'Loop through Worksheets in the Workbook\n    For Each CheckSheet In ThisWorkbook.Worksheets\n        'Allow VBA to edit a Protected Sheet, but not the User\n        If CheckSheet.ProtectContents Then CheckSheet.Protect Password:=\"Password\", UserInterfaceOnly:=True\n        'Filter for Cells with Text to check\n        On Error Resume Next\n        Set CheckRange = CheckSheet.UsedRange.SpecialCells(xlCellTypeConstants, xlTextValues)\n        On Error GoTo 0\n        'If there are Cells to Check\n        If Not CheckRange Is Nothing Then\n            SheetVisible = CheckSheet.Visible\n            'Loop through cells\n            For Each CheckCell In CheckRange.Cells\n                With CheckCell\n                    'If there is a typo, show the cell and Spellcheck it\n                    If Not Application.CheckSpelling(.Text) Then\n                        CheckSheet.Visible= xlSheetVisible\n                        CheckSheet.Activate\n                        .Select\n                        .Show\n                        DoEvents\n                        'This next line is to fix a bug when checking a single cell\n                        CheckSheet.Range(.MergeArea.Address &amp; \", \" &amp; .MergeArea.Address) _\n                        .CheckSpelling\n                    End If\n                End With\n            Next CheckCell\n            CheckSheet.Visible= SheetVisible\n        End If\n        'Tidy up the Loop\n        Set CheckRange = Nothing\n    Next CheckSheet\n    'Same message as normal Spellcheck\n    MsgBox \"Spell check complete.  You're good to go!\", vbExclamation\nEnd Sub\n</code></pre>\n\n<p>(Note the fix for a bug where checking a Single Cell will instead check the entire Sheet)</p>\n"}], "owner": {"reputation": 25, "user_id": 9124071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a684075fa2ea0deb38761d707c642600?s=128&d=identicon&r=PG&f=1", "display_name": "moosebiz", "link": "https://stackoverflow.com/users/9124071/moosebiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 55026974, "answer_count": 2, "score": 0, "last_activity_date": 1551944940, "creation_date": 1551886471, "last_edit_date": 1551944940, "question_id": 55026791, "link": "https://stackoverflow.com/questions/55026791/excel-macro-unlock-spellcheck-lock", "title": "Excel Macro - Unlock, Spellcheck, Lock", "body": "<p>I have a macro that needs to unlock all the sheets in a workbook, run the spell checker, and lock all the sheets (with the original column/cell formatting allowed). The locking errors out each time and I can't figure out why.</p>\n\n<p>I know this doesn't include the formatting aspect, but here's what I've got.</p>\n\n<pre><code>Sub SpellChecker()\n\n'unprotect all sheets\nFor i = 1 To Sheets.Count\n    Sheets(i).Unprotect \"Password\"\nNext i\n\n'select all sheets\nDim ws As Worksheet\nFor Each ws In Sheets\n    If ws.Visible Then ws.Select (False)\nNext\n\n'run spellchecker\nApplication.CommandBars.FindControl(ID:=2).Execute\n\n'protect sheets  \nFor i = 1 To Sheets.Count\n    Sheets(i).Protect \"Password\"\nNext i\n\n'selects one sheet/deselect all\nSheets(\"Sheet1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "string", "byref"], "comments": [{"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1551886754, "post_id": 55026636, "comment_id": 96806461, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26492872/how-to-pass-an-array-to-a-function-in-vba\">How to pass an array to a function in VBA?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "edited": false, "score": 0, "creation_date": 1551887252, "post_id": 55026754, "comment_id": 96806754, "body": "Hello Mr. Burns, thank you very much for your answer! Now I get error code 13 - type mismatch. AND I edited my post, maybe my mistake is somewhere else?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "edited": false, "score": 0, "creation_date": 1551888654, "post_id": 55026754, "comment_id": 96807645, "body": "@McMuellermilch You now have a new issue, I recommend a new question. SO is to help everyone, present or future. My answer is now invalid when looking at your question now. I recommend rolling back your question to what it was originally and if my answer resolved that issue, mark it as accepted and then ask a new question with your new issue"}], "tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1551886374, "creation_date": 1551886374, "answer_id": 55026754, "question_id": 55026636, "link": "https://stackoverflow.com/questions/55026636/byref-argumenttype-mismatch-when-passing-an-array-to-a-sub-or-function/55026754#55026754", "title": "ByRef Argumenttype mismatch when passing an array to a sub or function", "body": "<p>You are missing <code>()</code> in the function, an array needs <code>()</code> after the variable when passing it somewhere else so VBA knows it as an array</p>\n\n<pre><code>Private Sub whatever()\n  Dim arr(10, 2) As String\n  workArray arr\nEnd Sub\n\nSub workArray(ByRef arr() As String)\n  '- do stuff here\nEnd Sub\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>I look around a little bit <a href=\"http://www.cpearson.com/excel/passingandreturningarrays.htm\" rel=\"nofollow noreferrer\">cperson</a> has an excellent in depth guide on passing arrays to functions and back again. When in doubt, check cperson. He has a load of useful stuff regarding VBA</p>\n"}], "owner": {"reputation": 21, "user_id": 10938228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VdHBu.jpg?s=128&g=1", "display_name": "McMuellermilch", "link": "https://stackoverflow.com/users/10938228/mcmuellermilch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "accepted_answer_id": 55026754, "answer_count": 1, "score": 1, "last_activity_date": 1551945281, "creation_date": 1551886052, "last_edit_date": 1551945281, "question_id": 55026636, "link": "https://stackoverflow.com/questions/55026636/byref-argumenttype-mismatch-when-passing-an-array-to-a-sub-or-function", "title": "ByRef Argumenttype mismatch when passing an array to a sub or function", "body": "<p>I am working on a little project for work. All I am trying to do is create an array in Sub1 and call a function, pass the array to that function and have it fill the array. </p>\n\n<p>Very simplified, it looks something like this: </p>\n\n<pre><code>Private Sub whatever()\n  Dim arr(10, 2) As String\n  workArray arr\nEnd Sub\n\nSub workArray(ByRef arr As String)\n  '- do stuff here\nEnd Sub\n</code></pre>\n\n<p>I have googled so much and just can't figure out what I'm doing wrong. I have also tried:</p>\n\n<ul>\n<li>call workArray(arr)</li>\n<li>call workArray arr</li>\n<li>workArray(arr)</li>\n<li>workArray arr</li>\n</ul>\n\n<p>I've read that I can only pass an array ByRef, so I am sure that should be alright. The array arr is of type String, the array the function expects is declared as String - that should be alright too. I always get \"ByRef argument type mismatch\". Is the problem maybe with the type of String? Are String-arrays behaving differently?</p>\n\n<p>Anyone in here kind enough to release me of my pain?</p>\n"}, {"tags": ["vba", "file", "ms-access", "upload", "out-of-memory"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551885840, "post_id": 55026441, "comment_id": 96805878, "body": "You could try closing your streams each time, maybe use the actual libraries also, so no create objects, not 100%"}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551886164, "post_id": 55026441, "comment_id": 96806079, "body": "@Nathan_Sav:  I added a .Close before every &quot;end with&quot; but I could not see any changes."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1551886348, "post_id": 55026441, "comment_id": 96806184, "body": "I don&#39;t understand why you&#39;re reading the stream data into a byte array, then writing that byte array to a stream, then reading that stream back into a byte array and then sending it. Afaik this causes the entire file to be in memory at least 4 times, while it should be in memory at most twice. Ideally, however, you&#39;d use a chunking upload (so that only a few KB needs to be in memory at once), but that&#39;s a pretty advanced subject."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1551886523, "post_id": 55026441, "comment_id": 96806301, "body": "@Erik A: I dont think the file is in memory 4 times at once. I load it into the byteArray. Then I load it into the other stream and delete the fist stream. Then I load it into the webRequest. But of course Im open for any other way to do this. How I upload the file is the result of this question of mine on stack overflow: <a href=\"https://stackoverflow.com/questions/52389091/upload-pdf-via-multipart-html-post-does-change-file\" title=\"upload pdf via multipart html post does change file\">stackoverflow.com/questions/52389091/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551888253, "post_id": 55026441, "comment_id": 96807405, "body": "Is Rubberduck loaded? It&#39;s a useful add-in, but takes its toll in terms of memory available to the host process - is it 32-bit or 64-bit Access?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1551888567, "post_id": 55026441, "comment_id": 96807587, "body": "I&#39;d need to know exactly what the website expects. Combining form data with chunked binary data in a single request is not something I&#39;ve ever done, so I don&#39;t know if it&#39;s possible. If you&#39;re not using chunking, the entire file needs to be in memory, and that severely limits the possibility of uploading large files. Usually, APIs that expect large files have a way to send the form data in a header, the request URI, or something else entirely."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551890168, "post_id": 55026441, "comment_id": 96808588, "body": "@Mathieu Guindon: rubberduck is loaded but not not refreshed. But as explained in the question the problem also exists with the closed VBE."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1551890286, "post_id": 55026441, "comment_id": 96808661, "body": "@Erik A: I dont have any information about any other possibilities the APIs gives. But Ill ask the colleges which are resonsible for that system (its an openText-System)"}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551890583, "post_id": 55026441, "comment_id": 96808814, "body": "@Mathieu Guindon: And its 32-bit access..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551890792, "post_id": 55026441, "comment_id": 96808933, "body": "IIRC 32-bit host are limited to 2GB, regardless of available RAM. Not that 2GB shouldn&#39;t be more than enough though"}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1551891290, "post_id": 55026441, "comment_id": 96809241, "body": "I get the error with ~ 550mb. So there seems to be a lot room for data..."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1604563464, "post_id": 55026441, "comment_id": 114386047, "body": "Maybe this <a href=\"https://access.uservoice.com/forums/319956-access-desktop-application/suggestions/32586994-make-32-bit-access-large-address-aware-laa\" rel=\"nofollow noreferrer\">access.uservoice.com/forums/319956-access-desktop-applicatio&zwnj;&#8203;n/&hellip;</a> might be helping to solve the issue."}], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551887003, "creation_date": 1551885497, "last_edit_date": 1551887003, "question_id": 55026441, "link": "https://stackoverflow.com/questions/55026441/how-to-prevent-out-of-memory-error-while-uploading-files-with-access-vba", "title": "How to prevent &quot;out of memory&quot; error while uploading files with access-VBA?", "body": "<p>I loop through a folder and try to upload every file in the folder into an document management system with the following code:</p>\n\n<pre><code>Dim webRequest As MSXML2.XMLHTTP60: Set webRequest = New MSXML2.XMLHTTP60\n\nCall webRequest.Open(HTTPPost, adress, False)\n\nConst Boundary As String = \"AaB03x\"\nCall webRequest.setRequestHeader(HTTPHeaderValueContentType, \"multipart/form-data;boundary=\" &amp; Boundary)\nCall webRequest.setRequestHeader(HTTPHeaderValueCallingApplication, get_sys_db)\nCall webRequest.setRequestHeader(\"Connection\", \"Keep-Alive\")\nCall webRequest.setRequestHeader(\"cache-control\", \"no-cache\")\n\nDim byteData As Variant\nWith CreateObject(\"ADODB.Stream\")\n    .Type = StreamType.Binary\n    .Mode = StreamMode.ReadWrite\n    .Open\n    Call .LoadFromFile(fileName)\n    byteData = .Read  'Somethimes here I get the \"out of memory\" error\nEnd With\n\n'dim requestData as Variant\nWith CreateObject(\"ADODB.Stream\")\n    .Mode = StreamMode.ReadWrite\n    .Charset = WindowsCharset\n    .Open\n    .Type = StreamType.Text\n    Dim uploadFilename As String\n    uploadFilename = ZConverter.VariantToString(cut_file(fileName))\n    .WriteText CreateContentDisposionText(\"itemName\", uploadFilename, Boundary)  \n    .WriteText CreateContentDisposionText(\"parentNickname\", parentNickname, Boundary) \n    .WriteText vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"file\"\"; filename=\"\"\" &amp; fileName &amp; \"\"\"\" &amp; vbNewLine \n    .WriteText vbNewLine\n    .Position = StreamPositionStart\n    .Type = StreamType.Binary\n    .Position = .Size\n    .Write byteData\n    Set byteData = Nothing\n    .Position = StreamPositionStart\n    .Type = StreamType.Text\n    .Position = .Size\n    .WriteText vbNewLine &amp; vbNewLine &amp; \"--\" &amp; Boundary &amp; \"--\" &amp; vbNewLine\n    .Position = StreamPositionStart\n    .Type = StreamType.Binary\n    Call webRequest.Send(.Read) 'Here I get the \"out of memory\" error most of the time\nEnd With\n</code></pre>\n\n<p>So this works fine for small files.</p>\n\n<p>But when I try to upload a file with 420 mb I get the error: \"Not enough memory available for this task\" (original: \"F\u00fcr diesen Vorgang ist nicht gen\u00fcgend Speicher verf\u00fcgbar.\"). With the VBE (The development enviroment) open it fails even with 20 mb-files.</p>\n\n<p>Access needs ~ 55 mb ram with closed VBE and 140 mb with a open VBE. As the memory usage always falls back to this values I dont think there is a memory leak.</p>\n\n<p>So: Is there a way to extend the ram available to access as there is > 3GB free ram on the computer?\nAnd if not, is there a way to change the code so that there is not as much memory needed at once?</p>\n\n<p>Update:\nHow I upload the file is the result of this question of mine on stack overflow: <a href=\"https://stackoverflow.com/questions/52389091/upload-pdf-via-multipart-html-post-does-change-file\">Upload pdf via multipart-HTML-Post does change file</a></p>\n"}, {"tags": ["excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1551886074, "post_id": 55026346, "comment_id": 96806020, "body": "Try declaring rand as a long, then <code>rand=clng(Application.WorksheetFunction.RandBetween(9, 27) )</code>  Not sure what <code>Dim a, rand, AsInteger As Integer</code> is meant to do, you have a variable called AsInteger, which is the only one declared As Integer."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "edited": false, "score": 0, "creation_date": 1551887588, "post_id": 55026685, "comment_id": 96806972, "body": "The error occurs at row 4. If you just delete the 2nd section of code I added the type mismatch error will still occur. The first set of code is what is causing the TYPE mismatch error. the range(26,A) actually does change it&#39;s values for it&#39;s cells, the issue is It does not allow me to proceed further with my code once the values change in that range."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "edited": false, "score": 0, "creation_date": 1551887708, "post_id": 55026685, "comment_id": 96807051, "body": "You mean you are getting the error at <code>Cells(26, a) = Round(Cells(27, a)...</code> ?"}, {"owner": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "edited": false, "score": 0, "creation_date": 1551888446, "post_id": 55026685, "comment_id": 96807526, "body": "Yes, I am unsure why it would be changing the values for the range and then stopping the computation saying there is a type mismatch. I&#39;m still a novice with VBA but shouldn&#39;t the values not change if there is a TYPE mismatch for that section of the code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551888579, "post_id": 55026685, "comment_id": 96807592, "body": "Technically <code>Error</code> <i>is</i> a data type though =)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "edited": false, "score": 1, "creation_date": 1551888842, "post_id": 55026685, "comment_id": 96807766, "body": "@CanadianBeaver the answer to that is in the worksheet data: when code halts, hit Ctrl+G and type <code>?TypeNameCells(27,a).Value)</code> - and do that for all cells involved in the computation; one of them must be <code>Error</code>. You need to either fix your worksheet to avoid worksheet errors (e.g. <code>#VALUE!</code> or <code>#N&#47;A</code>), or fix your code to avoid attempting to do math against a data type that can&#39;t do math (<code>Error</code>, or a non-numeric <code>String</code>)."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "edited": false, "score": 0, "creation_date": 1551889632, "post_id": 55026685, "comment_id": 96808234, "body": "@CanadianBeaver: A good practice is to use <code>IfError()</code> with formulas to avoid any errors. This way your code will not crash."}, {"owner": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "edited": false, "score": 0, "creation_date": 1551889744, "post_id": 55026685, "comment_id": 96808318, "body": "Thanks, I&#39;ve found the error, there was a date data type for some of the cells in the range. I&#39;ve changed those data types and the code works fine now. Also I will utilize IFERROR more frequently."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1551886187, "creation_date": 1551886187, "answer_id": 55026685, "question_id": 55026346, "link": "https://stackoverflow.com/questions/55026346/trying-to-find-a-way-prevent-a-type-mismatch-error-from-occring-in-excel-vba/55026685#55026685", "title": "Trying to find a way Prevent a Type Mismatch error from Occring in Excel VBA", "body": "<p><code>Type mismatch</code> can occur not only because you have different value types. You can also get that error if there is a formula error in that cell. For example if you type <code>=0/0</code> in cell <code>A1</code> and then in immediate window if you execute <code>?Val([A1].value)</code>, you will get the <code>Type Mismatch</code> error.</p>\n\n<p>Here is one way to achieve what you want. Try and store the value in a temp variable and then use that for the comparision.</p>\n\n<pre><code>Dim tmpVal As Integer\n\nrand = Application.WorksheetFunction.RandBetween(9, 27)\n\nOn Error Resume Next\ntmpVal = Cells(27, rand)\nOn Error GoTo 0\n\nIf tmpVal = 0 Then\n\nElse\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10444116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e0c3686ac2acf3c53f6841d3448e6?s=128&d=identicon&r=PG&f=1", "display_name": "CanadianBeaver", "link": "https://stackoverflow.com/users/10444116/canadianbeaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551888540, "creation_date": 1551885141, "last_edit_date": 1551888540, "question_id": 55026346, "link": "https://stackoverflow.com/questions/55026346/trying-to-find-a-way-prevent-a-type-mismatch-error-from-occring-in-excel-vba", "title": "Trying to find a way Prevent a Type Mismatch error from Occring in Excel VBA", "body": "<pre><code>Sub Calculate_NNA_NMEXRegionUnits_Pacific()\nDim a, rand, AsInteger As Integer\nFor a = 8 To 42 \n Cells(26, a) = Round(Cells(27, a) * Cells(27, 7) * (Cells(22, 2) - Cells(22, 3) - Cells(20, 7)), 0)\nNext a\n</code></pre>\n\n<p>I'm making a program that performs a set of calculation on a range (26,a). The formula data type is variant/integer, while the data type on the range is variant/object/range. I am curious if I can ensure both sides of this equation are the same data type, I was looking at ways to change the formula, I've also worked with type conversion formulas. I have not been successful. I am asking for assistance to prevent a  Type mismatch from occurring on row 4 so my code can proceed.</p>\n\n<pre><code>rerand1:\n    rand = Application.WorksheetFunction.RandBetween(9, 27) 'Excludes base trim in random addition because of restrictions\n    If Cells(27, rand) = 0 Then\n        GoTo rerand1 'Wont change a 0 value, because it might be intentionally zero.\n    Else\n        If Cells(26, 7) &lt; Cells(22, 2) - (Cells(22, 3) + Cells(20, 7)) Then Cells(26, rand) = Cells(26, rand) + 1 'If there is less than the total, add.\n        If Cells(26, 7) &gt; Cells(22, 2) - (Cells(22, 3) + Cells(20, 7)) Then Cells(26, rand) = Cells(26, rand) - 1 'If there is more than the total, subtract.\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is the next step of my code if it is needed to solve the problem</p>\n"}, {"tags": ["vba", "bullet"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551885021, "post_id": 55026074, "comment_id": 96805351, "body": "You are assuming that the shape has a textframe property - it may not. Quick (and dirty) fix  would be to add On Error Goto Whoops  after With Osh and then Whoops: after the End If so it just skips them"}, {"owner": {"reputation": 1, "user_id": 11160391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288bf773655c8782e324440d401eecc2?s=128&d=identicon&r=PG&f=1", "display_name": "user11160391", "link": "https://stackoverflow.com/users/11160391/user11160391"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551947567, "post_id": 55026074, "comment_id": 96829499, "body": "Thanks for your prompt reply, how can I know what type of property the shape has?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551953685, "post_id": 55026074, "comment_id": 96833336, "body": "you&#39;d need to use TypeOf to return the type of the shape and then a select case to only run the code against the appropriate types"}, {"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "edited": false, "score": 0, "creation_date": 1589307371, "post_id": 55026074, "comment_id": 109240342, "body": "Hi - was this ever resolved? Having the same problem."}], "owner": {"reputation": 1, "user_id": 11160391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288bf773655c8782e324440d401eecc2?s=128&d=identicon&r=PG&f=1", "display_name": "user11160391", "link": "https://stackoverflow.com/users/11160391/user11160391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551884327, "creation_date": 1551884327, "question_id": 55026074, "link": "https://stackoverflow.com/questions/55026074/how-to-change-bullet-color-in-whole-presentation-ppt-vba", "title": "How to change bullet color in whole presentation ppt vba", "body": "<p>trying to change the color of different bullets across a presentation. Bullets have different shapes. Always the error code -2147024809 appears.</p>\n\n<p>Do you see what should be changed? Thank you very much for any help!</p>\n\n<hr>\n\n<p>Sub ReplacebulletColors()</p>\n\n<pre><code>Dim lFindColor As Long\nDim lReplaceColor As Long\nDim oSl As Slide\nDim oSh As Shape\nDim x As Long\n\nlFindColor = RGB(1, 98, 155)\nlReplaceColor = RGB(192, 0, 0)\n\nFor Each oSl In ActivePresentation.Slides\n    For Each oSh In oSl.Shapes\n        With oSh\n\n            If .TextFrame.TextRange.ParagraphFormat.Bullet.Font.Color.RGB = lFindColor Then\n                   .TextFrame.TextRange.ParagraphFormat.Bullet.Font.Color.RGB = lReplaceColor\n            End If\n\n        End With\n    Next\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551884739, "post_id": 55026040, "comment_id": 96805155, "body": "You can look at the <code>.to</code> property or <code>recipients</code> is an array, so you&#39;ll need to loop through that."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551903023, "post_id": 55026263, "comment_id": 96815417, "body": "Thank you for the answer and also Nathan. When i change the line to      If InStr(Item.Subject, thisItem.To) And DateDiff(&quot;m&quot;, Item.SentOn, Now) &lt; 1 Then  it is not working and it is not working when i change it to .recipients - I&#39;ve also tried to change the first part, but still doesn&#39;t work?"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551950497, "post_id": 55026263, "comment_id": 96831255, "body": "What do you mean by not working? Where does it fail and what&#39;s the error message? Do you get the &#39;Item.Subject&#39;, &#39;thisItem.To&#39; and &#39;Item.SentOn&#39; correctly?"}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551951981, "post_id": 55026263, "comment_id": 96832227, "body": "If i change thisItem.Subject to thisItem.To it is not checking correctly and warns me. If I change it to thisItem.Recipients it comes with the following error: Run-Time error &#39;5&#39; : Invalid procedure call or argument"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551958480, "post_id": 55026263, "comment_id": 96836377, "body": "You need to be more specific, what warning message are you getting with thisItem.To? As mentioned above thisItem.Recipients is not going to work as this is an array so you must loop through it"}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551962771, "post_id": 55026263, "comment_id": 96838896, "body": "When I use the thisItem.To the pop-up message doesn&#39;t show up even though I&#39;m sending to someone more than one time each month."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551964440, "post_id": 55026263, "comment_id": 96839926, "body": "Why don&#39;t you debug the code and check the values? You&#39;ll have an answer."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552043277, "post_id": 55026263, "comment_id": 96871829, "body": "When I try to debug the code it just highlights the line where i have made the change to recipients."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552061761, "post_id": 55026263, "comment_id": 96881606, "body": "Sorry I can&#39;t help you without seeing the line of code that fails and the error number/description, especially if you made a change. I&#39;m not a psychic ;)"}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552547355, "post_id": 55026263, "comment_id": 97052758, "body": "This is what I&#39;ve changed it to now: For Each Item In olfolder.Items     &#39; check subject content &amp; date difference  If InStr(Item.Subject, thisItem.Recipients) And DateDiff(&quot;m&quot;, Item.SentOn, Now) &lt; 1 Then         &#39; added this part         If MsgBox(&quot;already sent&quot;, vbYesNo + vbQuestion + vbMsgBoxSetForeground, &quot;Message Text Warning&quot;) = vbNo Then             &#39; cancel the email             Cancel = True                It comes with this: Run-Time error &#39;5&#39; : Invalid procedure call or argument"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1551885252, "last_edit_date": 1551885252, "creation_date": 1551884894, "answer_id": 55026263, "question_id": 55026040, "link": "https://stackoverflow.com/questions/55026040/item-to-recipients/55026263#55026263", "title": "Item to recipients", "body": "<p>Just replace <code>thisItem.Subject</code> to <code>thisItem.To</code></p>\n\n<p>edit: Nathan_Sav said it all :) <code>.Recipents</code> property returns an array so you can loop through it, might as well use <code>.To</code> which will return all recipients separated by semicolon</p>\n\n<p>edit2: note there are two other properties <code>.cc</code> and <code>.bcc</code> if you use them, whilst <code>.Recipients</code> array include all of them</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551952159, "post_id": 55032210, "comment_id": 96832339, "body": "This sounds really cool, but I&#39;m not quite sure how to tackle it in case of my problem. I&#39;m not the greatest at coding."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1551966276, "post_id": 55032210, "comment_id": 96841033, "body": "Which part are you having problems with?"}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552043458, "post_id": 55032210, "comment_id": 96871915, "body": "We have a specific folder with only a few massages it needs to loop through, so the only real problem I have is that I need to change it from subject to recipient, but when I use recipient it comes with an error and when i use .to it doesn&#39;t show the message even though I&#39;m sending to the same person multiple times."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552068213, "post_id": 55032210, "comment_id": 96884755, "body": "So what is your code that processes the recipients? And what is the error?"}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552547531, "post_id": 55032210, "comment_id": 97052829, "body": "This is what I&#39;ve changed it to now: For Each Item In olfolder.Items     &#39; check subject content &amp; date difference  If InStr(Item.Subject, thisItem.Recipients) And DateDiff(&quot;m&quot;, Item.SentOn, Now) &lt; 1 Then         &#39; added this part         If MsgBox(&quot;already sent&quot;, vbYesNo + vbQuestion + vbMsgBoxSetForeground, &quot;Message Text Warning&quot;) = vbNo Then             &#39; cancel the email             Cancel = True                It comes with this: Run-Time error &#39;5&#39; : Invalid procedure call or argument"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552570862, "post_id": 55032210, "comment_id": 97067090, "body": "Can you modify your original question with the updated code? It is impossible to read it in a comment."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1552959448, "post_id": 55032210, "comment_id": 97198981, "body": "Again, you are looping through all items in a folder. Don&#39;t do that - use Items.Find/FindNesxt or Items.Restrict. Secondly, Recipients is a collection, not a string. You must loop through that collection to check if the address matches."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1553077625, "post_id": 55032210, "comment_id": 97248421, "body": "Hello again. I&#39;ve tried to look up the Items.Find but I&#39;m still not sure how to use it correctly - do you have something you can refer to regarding this. When I want to loop through the recipients I still need to this.subject or?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1553090367, "post_id": 55032210, "comment_id": 97256340, "body": "First, you use the Items.Find / FindNext loop with a query like &quot;[Subject] = &#39; some value&#39; &quot;, then for each item returned by Find/FindNext, loop through the recipients."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1554272992, "post_id": 55032210, "comment_id": 97684893, "body": "Sorry I&#39;m not that familiar with that function - do you have somewhere I can read about it and how it is used?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1554273717, "post_id": 55032210, "comment_id": 97685192, "body": "Which function? See the example at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.findnext\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.items.findne&zwnj;&#8203;xt</a>"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1551906698, "creation_date": 1551906698, "answer_id": 55032210, "question_id": 55026040, "link": "https://stackoverflow.com/questions/55026040/item-to-recipients/55032210#55032210", "title": "Item to recipients", "body": "<p>Firstly, do not ever loop through all items in a folder - this is horribly inefficient. Use <code>Items.Find</code> with a restriction on the <code>Subject</code> and <code>SentOn</code> properties.</p>\n\n<p>For the recipients, you can use a restriction on the <code>To</code> property, but keep in mind that on the MAPI level it translates to a restriction on the <code>PR_DISPLAY_TO</code> property, which may or may not include the actual email address. OOM does not create subrestrictions on the <code>PR_MESSAGE_RECIPIENTS</code> property. If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> is an option, its version of <code>RDOItems.Find/Restrict</code> allows to specify <code>Recipients</code>, <code>To</code>, <code>CC</code>, <code>BCC</code> properties in a query and creates an appropriate restriction on the email address and name of the message recipients.</p>\n\n<p>In the worst case you can restrict on the <code>Subject</code> and <code>SentOn</code> properties using <code>Items.Find/FindNext</code> or <code>Items.Restrict</code>, and then explicitly loop through the Recipients collection of the returned matches.</p>\n"}], "owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552925068, "creation_date": 1551884237, "last_edit_date": 1552925068, "question_id": 55026040, "link": "https://stackoverflow.com/questions/55026040/item-to-recipients", "title": "Item to recipients", "body": "<p>I have a code which checks the subject in my e-mail and warns me if I already sent an email with this subject. I have experienced it would be smarter if it checks for the email address, but how do I fix that. I have tried substituting \"subject\" with \"recipients\" but without success. Is there a way to change this?</p>\n\n<pre><code>Public Sub Application_ItemSend(ByVal thisItem As Object, Cancel As Boolean)\n\nDim ns As Outlook.NameSpace\nDim olfolder As MAPIFolder\nDim Item As Object\n\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet firstFolder = olNs.Folders(\"test@dk.com\") ' name of my shared inbox\nSet olfolder = firstFolder.Folders(\"sent items\")\n\n' iterate thru emails\nFor Each Item In olfolder.Items\n    ' check subject content &amp; date difference\n If InStr(Item.Subject, thisItem.Recipients) And DateDiff(\"m\", Item.SentOn, Now) &lt; 1 Then\n        ' added this part\n        If MsgBox(\"already sent\", vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Message Text Warning\") = vbNo Then\n            ' cancel the email\n            Cancel = True\n        End If\n        Exit For\n    End If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1551894773, "post_id": 55025746, "comment_id": 96811378, "body": "How are you attaching the template.  Progrmatically from within VBA or by theFile.Option.Addin.Templates dialog"}, {"owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1552018446, "post_id": 55025746, "comment_id": 96862170, "body": "@Freeflow I have added the details in the question."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1552054676, "post_id": 55025746, "comment_id": 96877918, "body": "You need to investigate the application.run method. This will run a macro in the newly attached template without causing a compilation error due to the non availability of the template."}], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1552052121, "creation_date": 1552052121, "answer_id": 55064327, "question_id": 55025746, "link": "https://stackoverflow.com/questions/55025746/execute-macro-when-word-template-is-attached/55064327#55064327", "title": "Execute macro when Word template is attached", "body": "<p>Whilst there is an Open event and a New event there is\u2019nt an AttachTemplate event. So it simply isn\u2019t possible to have code automatically respond to the template being attached.</p>\n\n<p>Your options are:</p>\n\n<ul>\n<li>Attach the template then close and reopen the document.</li>\n<li>Attach the template then explicitly call the routine you want to run.</li>\n</ul>\n"}], "owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552052121, "creation_date": 1551883425, "last_edit_date": 1551931935, "question_id": 55025746, "link": "https://stackoverflow.com/questions/55025746/execute-macro-when-word-template-is-attached", "title": "Execute macro when Word template is attached", "body": "<p>I want to run some code when I attach a template to a Word document.</p>\n\n<p>I tried the <code>Document_Open</code> and <code>Document_New</code> methods to no avail.</p>\n\n<p>I also tried the <code>AutoNew</code> and <code>AutoOpen</code> method from <a href=\"https://wordmvp.com/FAQs/MacrosVBA/DocumentEvents.htm\" rel=\"nofollow noreferrer\">this article</a>.\nThe AutoOpen method is triggered when I attach my template to the document, close it, and then open the document again.</p>\n\n<p>How can I trigger a line of code to execute when I attach the template to a document?</p>\n\n<hr>\n\n<p><strong>EDIT :</strong>\nCurrently we are attaching the template through the <code>Templates</code> dialog.</p>\n\n<p>We are also adding a button in the ribbon, with the below code, to attach the template.</p>\n\n<pre><code>savedTmplt = \"C:\\Program Files\\*****\\template.dotm\"\n\nSet q = wd.ActiveDocument    \nwd.WordBasic.DisableAutoMacros False\n\nWith q\n    .AttachedTemplate = savedTmplt\n    .UpdateStyles\nEnd With\n\nwd.WordBasic.DisableAutoMacros\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerquery", "get-transform"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 11160298, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nm421RiRedA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHU1UN3gBCoq6U-N1kFr2g4O1-Jw/mo/photo.jpg?sz=128", "display_name": "Sergei Trunov", "link": "https://stackoverflow.com/users/11160298/sergei-trunov"}, "edited": false, "score": 0, "creation_date": 1551886225, "post_id": 55026382, "comment_id": 96806113, "body": "This looks promising, it will take me a while to understand what each statement does, I hope you understand that I will refrain to accept this answer at this moment for that reason? Otherwise thank you."}], "tags": [], "owner": {"reputation": 1379, "user_id": 10787050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16518865e85b864e0981815be5a675e5?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksei Zhigulin", "link": "https://stackoverflow.com/users/10787050/aleksei-zhigulin"}, "is_accepted": true, "score": 1, "last_activity_date": 1551885264, "creation_date": 1551885264, "answer_id": 55026382, "question_id": 55025611, "link": "https://stackoverflow.com/questions/55025611/excel-power-query-decouple-and-unpivot-columns/55026382#55026382", "title": "Excel Power Query decouple and unpivot columns", "body": "<p>You may apply following approach:</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Data\"]}[Content],\n    unpivot = Table.UnpivotOtherColumns(Source, {\"type\"}, \"Attribute\", \"Value\"),\n    split = Table.SplitColumn(unpivot, \"Attribute\", Splitter.SplitTextByDelimiter(\"-\", 1), {\"dimension\", \"metric\"}),\n    pivot = Table.Pivot(split, List.Distinct(split[metric]), \"metric\", \"Value\")\nin\n    pivot\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HA8Yi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HA8Yi.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 125, "user_id": 11160298, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nm421RiRedA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHU1UN3gBCoq6U-N1kFr2g4O1-Jw/mo/photo.jpg?sz=128", "display_name": "Sergei Trunov", "link": "https://stackoverflow.com/users/11160298/sergei-trunov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 55026382, "answer_count": 1, "score": 0, "last_activity_date": 1551885264, "creation_date": 1551882991, "question_id": 55025611, "link": "https://stackoverflow.com/questions/55025611/excel-power-query-decouple-and-unpivot-columns", "title": "Excel Power Query decouple and unpivot columns", "body": "<p>I have a data structure that is something comparable to this</p>\n\n<pre><code>| type | A-metric1 | A-metric2 | B-metric1 | B-metric2 |\n| aRow |     1     |     2     |     3     |     4     |\n</code></pre>\n\n<p>I'd like to turn A and B into a dimensions and turn it into rows so that it's something like this</p>\n\n<pre><code>| type | dimension | metric1 | metric2 |\n| aRow |     A     |    1    |    2    |\n| aRow |     B     |    3    |    4    |\n</code></pre>\n\n<p>I could probably do this manually by duplicating the type row for as many times as there are dimension labels, and then extract the metrics by order and do this in excel with a macro.</p>\n\n<p>However I am likely to be handling large files, and probably can't manipulate data of this size effecitvely in VBA. I was wondering if something like this is possible to do in Excels Power Query / Get &amp; Transform?</p>\n\n<p>Sorry if duplicate - Im not sure how to formulate this question to get relevant hits on searches.</p>\n"}, {"tags": ["vba", "ms-word", "alignment"], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 8165689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5bc2ef0db7d5812a814c6bb6f95cea13?s=128&d=identicon&r=PG&f=1", "display_name": "Will Croxford", "link": "https://stackoverflow.com/users/8165689/will-croxford"}, "edited": false, "score": 0, "creation_date": 1551884742, "post_id": 55025821, "comment_id": 96805161, "body": "Thanks kindly @Harassed , I see <code>paragraph.alignment</code> property in docs now. But this still makes date disappear, all the other text generated in this Word document shows fine. By kind chance, do you know if this means margin is doing something to make date disappear off right of document? Maybe I was just looking at old VBA code examples to begin on this route.. <a href=\"http://www.vbaexpress.com/forum/showthread.php?29989-Solved-justify-paragraph-via-VBA\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a>"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 361, "user_id": 8165689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5bc2ef0db7d5812a814c6bb6f95cea13?s=128&d=identicon&r=PG&f=1", "display_name": "Will Croxford", "link": "https://stackoverflow.com/users/8165689/will-croxford"}, "edited": false, "score": 1, "creation_date": 1551884864, "post_id": 55025821, "comment_id": 96805238, "body": "It aligns to the right hand margin of the paragraph - I&#39;d check what that is set to in that paragraph using the ruler, it may be off the display area in the view you are using."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 2, "last_activity_date": 1551883643, "creation_date": 1551883643, "answer_id": 55025821, "question_id": 55025559, "link": "https://stackoverflow.com/questions/55025559/vba-word-alignment-syntax/55025821#55025821", "title": "VBA Word alignment syntax", "body": "<pre><code> WordLetter.Paragraphs(1).Alignment = wdAlignParagraphRight\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 8165689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5bc2ef0db7d5812a814c6bb6f95cea13?s=128&d=identicon&r=PG&f=1", "display_name": "Will Croxford", "link": "https://stackoverflow.com/users/8165689/will-croxford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551891225, "creation_date": 1551882852, "last_edit_date": 1551891225, "question_id": 55025559, "link": "https://stackoverflow.com/questions/55025559/vba-word-alignment-syntax", "title": "VBA Word alignment syntax", "body": "<p><strong>EDIT 1:</strong>\nI'm trying to format paragraph with a string (today's date) with right align in VBA, using Excel VBA test function as below. This line below I thought was acceptable syntax but I got something wrong here or somewhere else in the function, as date still displays left-aligned when I open the saved document:</p>\n\n<pre><code>wordLetter.Paragraphs(1).Alignment = wdAlignParagraphRight\n</code></pre>\n\n<p>This function creates new Word document with Normal template, adds the date, saves it relative to current Excel workbook location.</p>\n\n<p>Otherwise, I understand <code>.Paragraphs(1)</code> exists already when a Word document is created with <code>.Add</code> or <code>.Open</code> method of <code>Documents</code> collection, I only just realised this.</p>\n\n<pre><code>Private Function Test()\n\n    Dim objWord As Object: Set objWord = CreateObject(\"Word.Application\")\n\n    objWord.Application.DisplayAlerts = False\n\n    objWord.Application.ScreenUpdating = False\n\n    Dim wordLetter As Object: Set wordLetter = objWord.Documents.Add\n\n    wordLetter.Range.Font.textColor.RGB = RGB(0, 0, 0)\n\n    Dim strDate As String: strDate = Format(Now(), \"dddd, mmm d, yyyy\")\n\n    wordLetter.Paragraphs(1).Alignment = wdAlignParagraphRight\n    wordLetter.Paragraphs(1).Range.text = strDate\n\n    objWord.Application.ScreenUpdating = True\n\n    savePath = ThisWorkbook.path &amp; \"\\testDoc.docx\"\n\n    With wordLetter\n        .SaveAs2 Filename:=savePath, FileFormat:=wdFormatDocumentDefault\n    End With\n\n    Application.DisplayAlerts = True\n\nEnd Function\n</code></pre>\n\n<p>Many thanks any suggestions.</p>\n"}, {"tags": ["excel", "vba", "email", "desktop"], "answers": [{"comments": [{"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551883908, "post_id": 55025542, "comment_id": 96804614, "body": "@Damian..............Thank you very much.  I&#39;m going to look at this today and start implementing it.  This should help a lot.  Thanks again for your help"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551883978, "post_id": 55025542, "comment_id": 96804661, "body": "A different approach could be checking if its not on the path you want it to be, i.e. <code>If ThisWorkbook.Path &lt;&gt; &quot;C:\\whereveryouneed&quot; Then</code> and so"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551885092, "post_id": 55025542, "comment_id": 96805391, "body": "++ Good suggestion :)"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551914122, "post_id": 55025542, "comment_id": 96819882, "body": "@Damian....Thanks for the help.  I used the 1st suggestion and it worked just like I expected it to.  The 2nd section wasn&#39;t as helpful for me because I wouldn&#39;t know all of the drive names.  There is a recommended drive but our users keep these macros in all sorts of locations.  I&#39;m trying to reduce the number of calls we get from users that are trying to run these from an email or from their desktop.  This was a big win.  I sent it out to a couple of people for their input and am waiting to hear back from them.  Thanks again for your help..."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551914234, "post_id": 55025542, "comment_id": 96819915, "body": "@SiddharthRout.....Thanks for your suggestion as well.  It&#39;s a little more advanced than I am at this point but I certainly understand what you are showing.  Thanks again for your help....."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551946114, "post_id": 55025542, "comment_id": 96828847, "body": "@Shaves <code>...because I wouldn&#39;t know all of the drive names....</code> Exactly. Nor would you know the MS Outlook (Not MS Office) version the user has and hence you should get those paths dynamically :)"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551946911, "post_id": 55025542, "comment_id": 96829180, "body": "@SiddharthRout wouldn&#39;t always that folder have the keyword &quot;Outlook&quot; on it? That should make my approach rather simple but effective. Yours is more advanced, but a bit of overkill right? shaves I&#39;ve edited my post on your concerning about the drive."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551947231, "post_id": 55025542, "comment_id": 96829338, "body": "<code>@SiddharthRout wouldn&#39;t always that folder have the keyword &quot;Outlook&quot; on it? That should make my approach rather simple but effective.</code> Yes but that will give you <code>False Positives</code>. So &quot;Simple but effective&quot;? Nope I don&#39;t think so... User can create a folder called <code>&quot;C:\\Temp\\Outlook&quot;</code> Overkill? Definitely not... BTW I am not asking anyone to do what I suggested.. I posted the &quot;right way&quot; to go about it. To use it or not to use it totally up to the user :)"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 4, "last_activity_date": 1551947375, "last_edit_date": 1551947375, "creation_date": 1551882821, "answer_id": 55025542, "question_id": 55025469, "link": "https://stackoverflow.com/questions/55025469/how-can-i-tell-if-a-macro-is-being-run-from-an-email-or-desktop-with-vba/55025542#55025542", "title": "How can I tell if a macro is being run from an email or desktop with VBA?", "body": "<p>If you open the workbook from the mail and debug <code>ThisWorkbook.Path</code> you will get something like:</p>\n\n<p><code>? thisworkbook.Path\nC:\\Users\\UserName\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook\\9PWSZZ9J</code></p>\n\n<p>The same thing will go to the desktop, so you can use the <code>Workbook_Open()</code> trigger to check the workbook path, if it is like <em>Outlook</em> or <em>Desktop</em> send a message warning to save it on the local drive.</p>\n\n<p>Edited due to Shaves comments:</p>\n\n<p>There is a final approach. Let's just say that their group policy let them save files on the local Dirve C: (supposing they all got that drive)</p>\n\n<p>Your approach could be, </p>\n\n<pre><code>Option Explicit\nPrivate Sub Workbook_Open()\n\n    Dim DesiredFilePath As String, CurrentFilePath As String, wb As Workbook\n\n    Set wb = ThisWorkbook\n\n    DesiredFilePath = \"C:\\\" &amp; wb.Name\n    CurrentFilePath = wb.Path &amp; \"\\\" &amp; wb.Name\n\n    If DesiredFilePath &lt;&gt; CurrentFilePath Then\n        wb.SaveAs DesiredFilePath\n        On Error Resume Next\n        Kill CurrentFilePath\n        On Error GoTo 0\n        MsgBox \"The file wasn't saved where it should be to work properly. It's been saved in: \" &amp; CurrentFilePath\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>this way you don't just warn the user, you save the file where you need it to be and delete it from where it was warning the user how to find it.</p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1551885080, "creation_date": 1551885080, "answer_id": 55026323, "question_id": 55025469, "link": "https://stackoverflow.com/questions/55025469/how-can-i-tell-if-a-macro-is-being-run-from-an-email-or-desktop-with-vba/55026323#55026323", "title": "How can I tell if a macro is being run from an email or desktop with VBA?", "body": "<p>Here is an expanded version of what Damian suggested. I will divide it in 2 parts. </p>\n\n<hr>\n\n<p><strong>PART ONE: FROM OUTLOOK</strong></p>\n\n<p>I am demostrating with one MS Office version. Feel free to add more to the <code>Select Case</code></p>\n\n<p>When you open attachments from the email message before saving to the hard drive, Outlook places copies in the <code>SecureTemp</code> folder. This folder is a <strong>hidden</strong> folder under <strong>Temporary Internet files</strong>.</p>\n\n<pre><code>Sub Sample()\n    Dim ol_Version As String\n    Dim ol_RegKey As String\n    Dim ol_SecureTempRegKey As String\n    Dim ol_SecureTempFolder As String\n\n    '~~&gt; This is the registry key which stores Outlook's version\n    ol_RegKey = \"HKEY_CLASSES_ROOT\\Outlook.Application\\CurVer\\\"\n\n    ol_Version = CreateObject(\"WScript.Shell\").RegRead(ol_RegKey)\n\n    '~~&gt; Check the outlook version\n    Select Case ol_Version\n        Case \"Outlook.Application.15\"\n\n            ol_SecureTempRegKey = \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Outlook\\Security\\OutlookSecureTempFolder\"\n        '\n        '~~&gt; Add more cases here\n        '\n    End Select\n\n    If ol_SecureTempRegKey &lt;&gt; \"\" Then\n        ol_SecureTempFolder = CreateObject(\"WScript.Shell\").RegRead(ol_SecureTempRegKey)\n\n        Debug.Print \"Outlook's temp folder is \" &amp; ol_SecureTempFolder\n    End If\nEnd Sub\n</code></pre>\n\n<p>Once you get the <code>SecureTemp</code> path, you can check if the file was opened from Outlook.</p>\n\n<hr>\n\n<p><strong>PART TWO: FROM DESKTOP</strong></p>\n\n<p>To get the user's desktop folder path you can use this. Once you get the <code>Desktop</code> path, you can check if the file was opened from there.</p>\n\n<pre><code>Sub Sample()\n    Dim desktopPath As String\n\n    desktopPath = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\n\n    Debug.Print \"User's desktop folder is \" &amp; desktopPath\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 55025542, "answer_count": 2, "score": 3, "last_activity_date": 1551947375, "creation_date": 1551882594, "question_id": 55025469, "link": "https://stackoverflow.com/questions/55025469/how-can-i-tell-if-a-macro-is-being-run-from-an-email-or-desktop-with-vba", "title": "How can I tell if a macro is being run from an email or desktop with VBA?", "body": "<p>I've developed macros for a number of years.  We users run these macros from a local drive.  However, due to turnover, new hires, etc., this info isn't always passed on to new users.  </p>\n\n<p>We have a central location where users download copies of these macros.  If they follow procedures, it saves the macro to a local drive.  However, sometimes users get macros from co-workers via email.  Then they open from the email or save them to their desktop.</p>\n\n<p>If they run our macros from either an email or a desktop, there can be issues; which often requires someone to contact us for support.  I'd like to try and cut down the number of support calls.  </p>\n\n<p>I'm wondering if there is a way to tell if the macro was opened from an email or from the user's desktop.  Ideally, I'm thinking of adding code to an \"On Open\" module and displaying a message that would tell the user to save the macro to a local drive before opening / running it.</p>\n\n<p>However, I'm not sure how to identify these 2 locations.  I've used the \"Path\" property before but these macros could be on any number of drives across hundreds of field offices.  I thought it would be better if I could identify an email or a desktop location and then display the message.</p>\n\n<p>Most of our users are on Office 2010 or 2016.  Thanks for the help..........</p>\n"}, {"tags": ["excel", "vba", "validation", "named-ranges"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1551883522, "post_id": 55025245, "comment_id": 96804350, "body": "Short Answer: It can&#39;t be done that way.  See <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2013_release-excel/data-validation-named-range-returning-array/bdb44056-700b-413e-9333-bf1942ac2f2c\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/&hellip;</a>"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1551898927, "post_id": 55025245, "comment_id": 96813250, "body": "You can&#39;t even use a name as a list of values for data validation. If you insert <code>={1,2,3}</code> into <code>Refers To</code> of your name, you can use it e. g. as a matrix formula in your worksheet, but not for data validation."}, {"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1551903320, "post_id": 55025245, "comment_id": 96815557, "body": "Please add a vote for this at user voice! <a href=\"https://excel.uservoice.com/forums/304921-excel-for-windows-desktop-application/suggestions/11008998-data-validation-should-be-allowed-to-come-from-udf\" rel=\"nofollow noreferrer\">excel.uservoice.com/forums/&hellip;</a>"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1551960976, "post_id": 55025245, "comment_id": 96837875, "body": "@ScottCraner It can&#39;t be done until workaround is found. Please check this <a href=\"https://stackoverflow.com/a/39351425/1903793\">stackoverflow.com/a/39351425/1903793</a> as an example of beating Excel limitation commonly regarded as impossible. Thank you for sound foundation that we deal with a challenge that finally turns me on:-)"}], "answers": [{"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551961154, "post_id": 55029986, "comment_id": 96837974, "body": "I cannot see any advantage in your answer. What do you want to advise? Dumping the array first to the cells and then use the dumped data as a dynamic named range?"}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551967118, "post_id": 55029986, "comment_id": 96841546, "body": "I edited my answer to hopefully apply more to the edits you made to your post."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551970236, "post_id": 55029986, "comment_id": 96843535, "body": "I seek the possibility to populate items of DV list from VBA array variable. My question is how to avoid the intermediate step of writing the array to cells (even in a hidden sheet). Please check if your concept require having the items to be in cells? If yes, then following this path does not bring us any closer to solution."}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551972791, "post_id": 55029986, "comment_id": 96845142, "body": "Unfortunately if you&#39;re trying to validate off of a named range, then there has to be a range in a worksheet somewhere to be validated against. Otherwise, you could try to use a <code>For Each</code> loop as part of a <code>Change Event</code> on the cell to be validated to loop through the array of data to validate against and run  your procedure from there."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551972996, "post_id": 55029986, "comment_id": 96845273, "body": "The DV list is not only for checking if user has input the correct data, but DV is for generating drop-down list to suggest user the correct data."}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551976126, "post_id": 55029986, "comment_id": 96847269, "body": "Hopefully this is what you are looking for."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551977154, "post_id": 55029986, "comment_id": 96847830, "body": "So you have reached my starting point:-) Please see <code>Formula1:=Join(ReturnArr, &quot;,&quot;)</code> where ReturnArr is the array variable. You build a long string first and then pass it to Formula1 argument. It will crash if the string is longer then 255 char."}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1551978028, "post_id": 55029986, "comment_id": 96848372, "body": "That&#39;s the only option I can see for you unfortunately. Hopefully someone else will have a better solution."}], "tags": [], "owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "is_accepted": false, "score": 0, "last_activity_date": 1551975909, "last_edit_date": 1551975909, "creation_date": 1551897208, "answer_id": 55029986, "question_id": 55025245, "link": "https://stackoverflow.com/questions/55025245/pass-array-variable-to-excel-named-range-for-data-validation-list/55029986#55029986", "title": "Pass array variable to Excel named range for data validation list", "body": "<p>You can populate data validation without a named range by using a comma delineated list (A, B, C). You could then put your Array function in place of the array in the below code and that will create your validation list on the cell you specify.</p>\n\n<pre><code>Public Sub DataValidation()\nDim ws As Worksheet\nDim range1 As Range, rng As Range\n'change Sheet1 to suit\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nSet rng = ws.Range(\"A1\")\n\nDim Arr(0 To 2)\nArr(0) = \"Spinosaur\"\nArr(1) = \"T-Rex\"\nArr(2) = \"Triceratops\"\n\nWith rng.Validation\n    .Delete 'delete previous validation\n    Dim arrVal As String\n    For Each arrItem In Arr()\n        arrVal = arrVal &amp; \", \" &amp; arrItem\n    Next\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=arrVal\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Found here and modified slightly: <a href=\"https://stackoverflow.com/questions/22956604/how-to-add-data-validation-to-a-cell-using-vba\">How to add data validation to a cell using VBA</a></p>\n\n<p>This does not use a named range in the traditional sense but uses a string variable from within the script in place of it.</p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1230, "favorite_count": 3, "answer_count": 1, "score": 2, "last_activity_date": 1566829794, "creation_date": 1551881909, "last_edit_date": 1566829794, "question_id": 55025245, "link": "https://stackoverflow.com/questions/55025245/pass-array-variable-to-excel-named-range-for-data-validation-list", "title": "Pass array variable to Excel named range for data validation list", "body": "<blockquote>\n  <p>This question has no satisfactory answer. I will be happy to vote for\n  any new responses that contain workarounds.</p>\n</blockquote>\n\n<p>How to pass array variable to Excel named range without prior dumping it to cells? I want such a dynamic named range to be used in data validation list. I do not want to set up validation list directly in VBA through the array variable: </p>\n\n<pre><code>Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=Join(ReturnArr, \",\")\n</code></pre>\n\n<p>because of limitation of the length of <code>Formula1</code> parameter to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.validation.add#parameters\" rel=\"nofollow noreferrer\">255 characters</a>. So the above code works fine as long as the <code>Len(Join(ReturnArr, \",\"))</code> does not exceed 255 characters. </p>\n\n<p>I have tried this:</p>\n\n<pre><code>Option Explicit\n\nFunction ReturnArr() As Variant\n    Dim Arr(0 To 2)\n    Arr(0) = \"Spinosaur\"\n    Arr(1) = \"T-Rex\"\n    Arr(2) = \"Triceratops\"\n\n    ReturnArr = Arr\nEnd Function\n</code></pre>\n\n<p>Then I add a named range pointing to the function returning array:<br>\n<a href=\"https://i.stack.imgur.com/p3PQx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p3PQx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Everything seems to be ok so far. I set up data validation list.\n<a href=\"https://i.stack.imgur.com/phhNm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/phhNm.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have also tried the following paths with no success:</p>\n\n<ul>\n<li>transposing the array: <code>ReturnArr = Application.Transpose(Arr)</code></li>\n<li><code>INDEX(ReturnArr(),,1)</code></li>\n<li>named range with <code>=OFFSET(ReturnArr(),0,0,ROWS(ReturnArr()),1)</code></li>\n<li>I event descended to such low level as to take use of one cell and I put the formula <code>=OFFSET(ReturnArr(),0,0,ROWS(ReturnArr()),1)</code> into <code>A1</code> cell and referenced to it with <code>INDIRECT(\"$A$1\")</code></li>\n<li>I experimented with undocumented secret <code>EVALUATE</code> function which works with named ranges as in this <a href=\"https://stackoverflow.com/a/39351425/1903793\">case</a>. I tried <code>EVALUATE</code> with all combinations of other functions returning array. </li>\n</ul>\n\n<p>Further references:<br>\n<a href=\"https://stackoverflow.com/questions/54984247/fast-way-to-output-array-into-range\">Fast way to output array into range</a> for those who would like to contribute to dumping approch</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 574, "user_id": 2387292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d3e7ab9be7cdc98be5a7e891860a423f?s=128&d=identicon&r=PG", "display_name": "k29", "link": "https://stackoverflow.com/users/2387292/k29"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1551881242, "post_id": 55024882, "comment_id": 96802926, "body": "@Larnu <code>ALL *</code> is valid T-SQL syntax, although usually redundant"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1551882845, "post_id": 55024882, "comment_id": 96803894, "body": "That between statement may not be doing quite what you think. If the datatype of your day column is a datetime it will not return any rows that on the +3 days because the timestamp would be greater than the beginning of the day. When it comes to date calculations (and many more things) between can really be problematic. <a href=\"https://sqlblog.org/2011/10/19/what-do-between-and-the-devil-have-in-common\" rel=\"nofollow noreferrer\">sqlblog.org/2011/10/19/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11055900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbe0fa55d93d373d0fd67e079268b14?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Jacques", "link": "https://stackoverflow.com/users/11055900/ryan-jacques"}, "edited": false, "score": 0, "creation_date": 1551888636, "post_id": 55025058, "comment_id": 96807635, "body": "Fantastic, is there a way to get a response if it does exist? i.e. Msgbox &quot;this is already in the database&quot;"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1551890798, "post_id": 55025058, "comment_id": 96808936, "body": "This is being answered in a follow up question from the OP <a href=\"https://stackoverflow.com/questions/55028025/return-if-a-success-vba-sql\">here</a>"}], "tags": [], "owner": {"reputation": 574, "user_id": 2387292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d3e7ab9be7cdc98be5a7e891860a423f?s=128&d=identicon&r=PG", "display_name": "k29", "link": "https://stackoverflow.com/users/2387292/k29"}, "is_accepted": false, "score": 0, "last_activity_date": 1551892171, "last_edit_date": 1551892171, "creation_date": 1551881363, "answer_id": 55025058, "question_id": 55024882, "link": "https://stackoverflow.com/questions/55024882/insert-into-sql-database-only-if-does-not-exist/55025058#55025058", "title": "Insert into SQL database only if does not exist", "body": "<p>Use <code>IF NOT EXISTS</code> and remove the <code>ORDER BY</code></p>\n\n<pre><code>IF NOT EXISTS(SELECT *\nFROM [MarketAnalysis].[dbo].[ReviewDatabase]\n  WHERE [VESSEL] = 'BOATY'\n  AND [LOAD DATE] BETWEEN DATEADD(day, -3,'20190227') AND DATEADD(day, +3,'20190227'))\nBEGIN\n--your insert statement\nEND\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11055900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbe0fa55d93d373d0fd67e079268b14?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Jacques", "link": "https://stackoverflow.com/users/11055900/ryan-jacques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551945178, "creation_date": 1551880786, "last_edit_date": 1551945178, "question_id": 55024882, "link": "https://stackoverflow.com/questions/55024882/insert-into-sql-database-only-if-does-not-exist", "title": "Insert into SQL database only if does not exist", "body": "<p>Using VBA to insert into microsoft sql database</p>\n\n<pre><code>SELECT ALL *\nFROM [MarketAnalysis].[dbo].[ReviewDatabase]\nWHERE [VESSEL] = 'BOATY'\n  AND [LOAD DATE] BETWEEN DATEADD(day, -3,'20190227') AND DATEADD(day, +3,'20190227')\nORDER BY [ID] DESC\n</code></pre>\n\n<p>for example, the above, if insert a vessel that matches the name and date +/- 3 days, let it not as it matches something already in the DB</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1551881100, "post_id": 55024877, "comment_id": 96802851, "body": "borderetype is an array of strings - thus i is a string not an object. But in any case your code within the loop refers to the with rng2 line and rng2 does not have a linestyle property."}], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1551882115, "post_id": 55025175, "comment_id": 96803445, "body": "This is a great answer. Thank you. I haven&#39;t worked with <code>LBound</code> and <code>UBound</code>. Using multi-arrays to pull everything I need at once didn&#39;t even cross my mind. Thank you so much"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1551881722, "creation_date": 1551881722, "answer_id": 55025175, "question_id": 55024877, "link": "https://stackoverflow.com/questions/55024877/making-an-array-which-completes-all-border-settings-in-one-sweep/55025175#55025175", "title": "Making an Array Which Completes All Border Settings In One Sweep", "body": "<p>Something like this is probably what you're looking for:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim aBorderSettings() As Long\n    Dim i As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Data\")\n\n    ReDim aBorderSettings(1 To 8, 1 To 2)\n        aBorderSettings(1, 1) = xlDiagonalDown:     aBorderSettings(1, 2) = xlNone\n        aBorderSettings(2, 1) = xlDiagonalUp:       aBorderSettings(2, 2) = xlNone\n        aBorderSettings(3, 1) = xlEdgeBottom:       aBorderSettings(3, 2) = xlContinuous\n        aBorderSettings(4, 1) = xlEdgeLeft:         aBorderSettings(4, 2) = xlContinuous\n        aBorderSettings(5, 1) = xlEdgeRight:        aBorderSettings(5, 2) = xlContinuous\n        aBorderSettings(6, 1) = xlEdgeTop:          aBorderSettings(6, 2) = xlContinuous\n        aBorderSettings(7, 1) = xlInsideHorizontal: aBorderSettings(7, 2) = xlContinuous\n        aBorderSettings(8, 1) = xlInsideVertical:   aBorderSettings(8, 2) = xlContinuous\n\n    With ws.Range(\"A1:O\" &amp; ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row)\n        .AutoFilter\n        .EntireColumn.AutoFit\n        For i = LBound(aBorderSettings, 1) To UBound(aBorderSettings, 1)\n            .Borders(aBorderSettings(i, 1)).LineStyle = aBorderSettings(i, 2)\n            If aBorderSettings(i, 2) &lt;&gt; xlNone Then\n                .Borders(aBorderSettings(i, 1)).ColorIndex = 0\n                .Borders(aBorderSettings(i, 1)).TintAndShade = 0\n                .Borders(aBorderSettings(i, 1)).Weight = xlThin\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55025175, "answer_count": 1, "score": 1, "last_activity_date": 1551881722, "creation_date": 1551880778, "question_id": 55024877, "link": "https://stackoverflow.com/questions/55024877/making-an-array-which-completes-all-border-settings-in-one-sweep", "title": "Making an Array Which Completes All Border Settings In One Sweep", "body": "<p>I'm trying to set up an array to pull the types of border in excel so I can create all my borders in a couple of lines, rather than the >40 normally</p>\n\n<p>I'm clearly missing something obvious, but at the moment I can't work it out\nCould someone please assist with this?</p>\n\n<p>Current error:\n <code>Object doesn't support this property or method (Error 438)</code></p>\n\n<p>This pulls to the <code>.LineStyle = xlContinuous</code> line</p>\n\n<p>Is <code>i</code> not the right way to go for this? Any help is appreciated</p>\n\n<pre><code>Dim wb As Workbook, ws As Worksheet, rng As Range, LastRow As Long, rng2 As Range, borderType, i\n\nborderType = Array(\"xlEdgeLeft\", \"xlEdgeTop\", \"xlEdgeBottom\", \"xlEdgeRight\", \"xlInsideVertical\", \"xlInsideHorizontal\")\nSet wb = ThisWorkbook\nSet ws = Worksheets(\"Data\")\nSet rng = ws.Cells(1, 1)\n\n    LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row                  'Finds the bottom populated row\n\nSet rng2 = ws.Range(rng, ws.Cells(LastRow, 15))\n\n    With rng2\n        .AutoFilter\n        .EntireColumn.AutoFit\n        .Borders(xlDiagonalDown).LineStyle = xlNone\n        .Borders(xlDiagonalUp).LineStyle = xlNone\n\n\n        For Each i In borderType\n            .LineStyle = xlContinuous\n            .ColorIndex = 0\n            .TintAndShade = 0\n            .Weight = xlThin\n        Next\n\n    End With\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1551879997, "post_id": 55024523, "comment_id": 96802154, "body": "Are the two line breaks between <code>For</code> and <code>rownum</code> part of the code you&#39;re running? If so, try removing them. Also, there&#39;s no need to compare the result of <code>IsEmpty(Range(&quot;E&quot; &amp; rownum))</code> to <code>True</code>."}, {"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1551880363, "post_id": 55024523, "comment_id": 96802371, "body": "try <code>(&quot;A&quot; &amp; rownum , &quot;H&quot; &amp; rownum)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1551881521, "creation_date": 1551881521, "answer_id": 55025113, "question_id": 55024523, "link": "https://stackoverflow.com/questions/55024523/in-vba-what-is-the-correct-syntax-for-looping-through-multiple-ranges-using/55025113#55025113", "title": "In vba what is the correct syntax for looping through multiple ranges using &amp;", "body": "<p>You have several syntax errors on your code. You could do the following:</p>\n\n<pre><code>Sub CheckForBlanksInName()\n        Dim myRange As Range\n        Set myRange = Sheets(\"Sheet1\").Range(\"A2:H103\") '&lt;~~ use sheet name instead\n        myRange.Interior.ColorIndex = xlNone            '&lt;~~ clear color\n    '------\n        Dim last_row As Long                            '&lt;~~ declare last_row\n        last_row = Range(\"A2\").End(xlDown).Row          '&lt;~~ fix last_row\n    '------\n        For rownum = 2 To last_row - 1\n            If IsEmpty(Sheets(\"Sheet1\").Range(\"E\" &amp; rownum)) = True Then '&lt;~~ use complete addresses\n                Sheets(\"Sheet1\").Range(\"A\" &amp; rownum &amp; \":H\" &amp; rownum).Interior.Color = RGB(166, 166, 166) '&lt;~~ use complete addresses\n            End If\n        Next rownum\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1014, "user_id": 1595285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/daee6d1b01135283d33c5d44e9e385aa?s=128&d=identicon&r=PG", "display_name": "blub", "link": "https://stackoverflow.com/users/1595285/blub"}, "is_accepted": false, "score": 0, "last_activity_date": 1551882713, "creation_date": 1551882713, "answer_id": 55025505, "question_id": 55024523, "link": "https://stackoverflow.com/questions/55024523/in-vba-what-is-the-correct-syntax-for-looping-through-multiple-ranges-using/55025505#55025505", "title": "In vba what is the correct syntax for looping through multiple ranges using &amp;", "body": "<p>or just loop through the rows</p>\n\n<pre><code>Sub CheckForBlanksInName2()\n\n   Dim rng As Range, roww As Range\n   Set rng = ThisWorkbook.Sheets(1).Range(\"A2:H103\")\n       rng.Interior.ColorIndex = xlNone\n\n   For Each roww In rng.Rows\n       If IsEmpty(roww.Cells(1, 5)) Then roww.Interior.ColorIndex = 50\n   Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1551885569, "creation_date": 1551885569, "answer_id": 55026463, "question_id": 55024523, "link": "https://stackoverflow.com/questions/55024523/in-vba-what-is-the-correct-syntax-for-looping-through-multiple-ranges-using/55026463#55026463", "title": "In vba what is the correct syntax for looping through multiple ranges using &amp;", "body": "<p>You can simply loop through specific <code>Cells</code> in the \"E\" <code>Column</code>  and depending on the result of their <code>isEmpty()</code> function result, you can highlight them as you like.</p>\n\n<pre><code>Dim cell As Range\nDim ws as Worksheet: Set ws = Sheets(\"Sheet1\") ' &lt;- change to whatever sheet you're using\nDim lr as Long: lr = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor Each cell In ws.Range(\"E1:E\" &amp; lr)\n    If IsEmpty(cell) Then\n        cell.EntireRow.Interior.ColorIndex = 27\n    End If\nNext cell\n</code></pre>\n\n<p>Produces the expected result</p>\n\n<p><a href=\"https://i.stack.imgur.com/eGQ7U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eGQ7U.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10260849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PpHhKbcBXfA/AAAAAAAAAAI/AAAAAAAABGg/P3LrdiLl1nU/photo.jpg?sz=128", "display_name": "Zachary Airola", "link": "https://stackoverflow.com/users/10260849/zachary-airola"}, "is_accepted": false, "score": 0, "last_activity_date": 1551892893, "creation_date": 1551892893, "answer_id": 55028825, "question_id": 55024523, "link": "https://stackoverflow.com/questions/55024523/in-vba-what-is-the-correct-syntax-for-looping-through-multiple-ranges-using/55028825#55028825", "title": "In vba what is the correct syntax for looping through multiple ranges using &amp;", "body": "<p>1.) Loop Syntax: For...To should be on the same line.</p>\n\n<p>2.) Range Syntax: Your attempt to use \"myRange((\"A &amp; rownum : H\" &amp; rownum))\" is \n    referring to a range within the \"myrange\" range object. This can be done but \n    you don't need it here and this is not the proper syntax. Refer To: \n    <a href=\"http://www.cpearson.com/excel/cells.htm\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/cells.htm</a></p>\n\n<p>Here's a few ways to refer to the range you want to highlight:</p>\n\n<p>sheet1.Range(\"A\" &amp; rownum &amp; \":H\" &amp; rownum)</p>\n\n<p>sheet1.Range(\"A\" &amp; rownum.row &amp; \":H\" &amp; rownum.row)</p>\n\n<p>sheet1.Range(\"A\" &amp; rownum, sheet1.range(\"A\" &amp; rownum).offset(0,7))</p>\n\n<p>sheet1.Range(sheet1.Cells(rownum, \"A\"), sheet1.Cells(rownum, \"H\"))</p>\n\n<p>sheet1.Range(sheet1.Range(\"A\" &amp; rownum), sheet1.Cells(rownum, \"H\"))</p>\n\n<p>VBA allows a lot of variation when referring to ranges but a few tips:<br>\n    1. Fully qualify your sheet reference [e.g. - sheet1.Range(sheet1...)] \n    2. Be careful with the tedious quotations\n    3. Use With...End With blocks</p>\n\n<p>3.) Your last_row variable will be unreliable when there are blank cells in your \n    data because it will return the last row before any blank cell. See below</p>\n\n<p>4.) You don't need a loop to accomplish this; I suggest using autofilter instead.</p>\n\n<p>Here's how I would do it:</p>\n\n<pre><code>   Sub CheckForBlanksInName()\n    Dim myRange As Range\n    Dim last_row As Double\n\n    With Sheet1\n\n      last_row = .Cells(.Rows.Count, \"A\").End(xlUp).Row 'Last row of the data set\n      MsgBox last_row '=&gt; returns\n      Set myRange = .Range(\"A2:H\" &amp; last_row)\n\n      'clear all color\n      myRange.Interior.ColorIndex = xlNone\n\n      .AutoFilterMode = False  'clear any filters\n      .Range(\"E1:E\" &amp; last_row) _ \n        .AutoFilter _\n            field:=1 _\n          , Criteria1:=\"=\" _\n          , Operator:=xlFilterValues  'filter column \"E\" on blank cells\n\n      'Highlight\n      myRange.SpecialCells(xlCellTypeVisible).Interior.Color = vbYellow\n\n      .AutoFilterMode = False  'clear filters\n\n    End With\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11115277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/436d8e03d4d55121f991e0825ae56011?s=128&d=identicon&r=PG&f=1", "display_name": "WMontgomery", "link": "https://stackoverflow.com/users/11115277/wmontgomery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1551892893, "creation_date": 1551879713, "question_id": 55024523, "link": "https://stackoverflow.com/questions/55024523/in-vba-what-is-the-correct-syntax-for-looping-through-multiple-ranges-using", "title": "In vba what is the correct syntax for looping through multiple ranges using &amp;", "body": "<p>I want to loop through code to do the following:  If there is an empty cell in column E, I want to highlight the entire row from A to H.  I've tried replacing the number with a variable using '&amp;' as in below, but failed.  What is the syntax to do this using VBA?</p>\n\n<pre><code> Sub CheckForBlanksInName()\n\n    Dim myRange As Range\n    Set myRange = Sheet1.Range(\"A2:H103\")\n    Dim rowrng As Range\n\n    'clear all color\n    myRange.Interior.ColorIndex = xlNone\n\n    'Last Row\n    last_row = Range(\"A2\").End(xlDown).Row 'Last row of the data set\n    MsgBox last_row '=&gt; returns\n    For \n\n   rownum = 2 To last_row - 1\n   If IsEmpty(Range(\"E\" &amp; rownum)) = True Then\n        'myRange((\"A &amp; rownum : H\" &amp; rownum)).Interior.Color = RGB(166, 166,\n      166) 'Gray DID NOT WORK\n\n     ' Set rowrng = Range(\"A &amp; rownum : H\" &amp; rownum)\n        rowrng.Interior.Color = RGB(166, 166, 166)  'DID NOT WORK\n\n     'Cell E is blank\n          MsgBox rownum &amp; \"Cell E\", rownum\n   End If\n   Next rownum\n   End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1551964387, "post_id": 55024324, "comment_id": 96839888, "body": "I am missing one piece of my puzzle and i didn&#39;t realize it until today.....i need to add that when it paste the formula into those 18 cells, it then copies that same set of 18 cells and will paste it has values so it holds those values in place."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1551882044, "post_id": 55024893, "comment_id": 96803403, "body": "thanks!  i kinda used both answers to piece together what works."}, {"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1551882052, "post_id": 55024893, "comment_id": 96803406, "body": "Sub Cash()  Dim rng_Copy As Range Dim rng_Paste As Range  Set rng_Copy = Sheet1.Range(&quot;$M$1&quot;) Set rng_Paste = Range(&quot;G&quot; &amp; ActiveSheet.Rows.Count).End(xlUp).Offset(1, 0)  rng_Copy.Copy rng_Paste.Resize(18, 1).PasteSpecial xlPasteFormulas End Sub"}], "tags": [], "owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "is_accepted": false, "score": 0, "last_activity_date": 1551880829, "creation_date": 1551880829, "answer_id": 55024893, "question_id": 55024324, "link": "https://stackoverflow.com/questions/55024324/copy-paste-formula-from-a-cell-into-18-rows-of-another-column-starting-on-next-e/55024893#55024893", "title": "Copy/Paste formula from a cell into 18 rows of another column starting on next empty row", "body": "<p>Firstly I'd create a named range that returns the blank cell after the last filled cell in column G. So something like this:</p>\n\n<pre><code>=INDEX(Sheet1!$G:$G,MAX(2,IFERROR(MATCH(\" *\",Sheet1!$G:$G,-1),0),IFERROR(MATCH(1E+306,Sheet1!$G:$G,1),0))+1)\n</code></pre>\n\n<p>Then I'd use that named range in VBA to copy the formula in M1 and apply it to the next 18 rows.</p>\n\n<pre><code>Sub s_CopyPaste()\n\nDim rng_Copy As Range\nDim rng_Paste As Range\n\nSet rng_Copy = Sheet1.Range(\"$M$1\")\nSet rng_Paste = Range(\"NAMED RANGE\")\n\nrng_Copy.Copy\nrng_Paste.Resize(18, 1).PasteSpecial xlPasteFormulas 'resize the blank cell to an 18x1 range\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "edited": false, "score": 0, "creation_date": 1551882119, "post_id": 55024915, "comment_id": 96803448, "body": "thank you.   the whole set didn&#39;t work but i used your range from &quot;set r =&quot; in the vba from the other answer in &quot;name range&quot; and it worked great!   thank again for the help."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1551880890, "creation_date": 1551880890, "answer_id": 55024915, "question_id": 55024324, "link": "https://stackoverflow.com/questions/55024324/copy-paste-formula-from-a-cell-into-18-rows-of-another-column-starting-on-next-e/55024915#55024915", "title": "Copy/Paste formula from a cell into 18 rows of another column starting on next empty row", "body": "<pre><code> Sub Fred()\n dim r as range\n set r = range(\"G\" &amp; activesheet.rows.count).end(xlup).offset(1,0)\n Range(\"M1\").copy  r\n r.copy range(r.address &amp; \":G\" &amp; r.row + 17)\n end sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "is_accepted": false, "score": 1, "last_activity_date": 1551882213, "creation_date": 1551882213, "answer_id": 55025347, "question_id": 55024324, "link": "https://stackoverflow.com/questions/55024324/copy-paste-formula-from-a-cell-into-18-rows-of-another-column-starting-on-next-e/55025347#55025347", "title": "Copy/Paste formula from a cell into 18 rows of another column starting on next empty row", "body": "<p>For anyone who needs help with this also, both Harassed Dad and jakrooster where great and i pieced together their answers to get it to work.   Finish VBA i am using. </p>\n\n<pre><code>Sub Cash()\n\nDim rng_Copy As Range\nDim rng_Paste As Range\n\nSet rng_Copy = Sheet1.Range(\"$M$1\")\nSet rng_Paste = Range(\"G\" &amp; ActiveSheet.Rows.Count).End(xlUp).Offset(1, 0)\n\nrng_Copy.Copy\nrng_Paste.Resize(18, 1).PasteSpecial xlPasteFormulas\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11156001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482eeb497b2ffda043e5fd91c5e55591?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Mears", "link": "https://stackoverflow.com/users/11156001/rachel-mears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55024915, "answer_count": 3, "score": -1, "last_activity_date": 1551882213, "creation_date": 1551879108, "last_edit_date": 1551879345, "question_id": 55024324, "link": "https://stackoverflow.com/questions/55024324/copy-paste-formula-from-a-cell-into-18-rows-of-another-column-starting-on-next-e", "title": "Copy/Paste formula from a cell into 18 rows of another column starting on next empty row", "body": "<p>My formula is in M1.<br>\nI need to run a VBA that will copy that cell and paste it in Column G only but down 18 rows each time I run it and each time I run it, it starts in the next empty row in column G.   </p>\n\n<p>If I use record macro for doing it one time, this is what it looks like. </p>\n\n<pre><code>Selection.Copy\nActiveWindow.SmallScroll Down:=33\nRange(\"G42:G59\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>I know this isn't the best way and I am not this advanced in Excel.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "screen-scraping"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1551880099, "post_id": 55024184, "comment_id": 96802207, "body": "If you take a look at the page source the class <code>snize-title</code> isn&#39;t present when it is loaded which is why you aren&#39;t getting any results"}, {"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 1, "creation_date": 1551880129, "post_id": 55024184, "comment_id": 96802224, "body": "You cant solve this issue by using <code>With CreateObject(&quot;MSXML2.XMLHTTP&quot;)</code>.  The site you are trying to access uses javascript and you have to build a solution that uses   ONLY <code>Dim IE As New InternetExplorer</code>. You should learn how to automate IE from VBA in the case of this particular page."}, {"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1551880260, "post_id": 55024184, "comment_id": 96802318, "body": "@Tom <a href=\"http://prntscr.com/mu2trw\" rel=\"nofollow noreferrer\">prntscr.com/mu2trw</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1551880328, "post_id": 55024184, "comment_id": 96802356, "body": "@Mig yes it is present after it is loaded, but the way you&#39;re scraping the page won&#39;t load the js so it is not present for your scraper"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1551880638, "post_id": 55024184, "comment_id": 96802555, "body": "Here you go - the data is actually loaded via a call to the url: <a href=\"https://www.searchanise.com/getresults?api_key=5G0b7c8K0r&amp;q=maquina+roupa&amp;sortBy=relevance&amp;sortOrder=desc&amp;startIndex=0&amp;maxResults=50&amp;items=true&amp;pages=true&amp;categories=true&amp;suggestions=true&amp;queryCorrection=true&amp;suggestionsMaxResults=3&amp;pageStartIndex=0&amp;pagesMaxResults=20&amp;categoryStartIndex=0&amp;categoriesMaxResults=20&amp;facets=true&amp;facetsShowUnavailableOptions=false&amp;ResultsTitleStrings=2&amp;ResultsDescriptionStrings=2&amp;output=jsonp&amp;callback=jQuery22405933330900677585_1551880363920&amp;_=1551880363921\" rel=\"nofollow noreferrer\">json link</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1551880652, "post_id": 55024184, "comment_id": 96802562, "body": "You may be able to get away with just scraping the json url instead"}, {"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "reply_to_user": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1551880758, "post_id": 55024184, "comment_id": 96802631, "body": "@Yane When I tried to replace that for IE it loads toons of IE pages (based on the numResults variable) and it takes tooooo long, yet stil shows blank values"}, {"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1551980394, "post_id": 55024184, "comment_id": 96849635, "body": "@Tom no way... that link has a lot of useless info."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551881053, "post_id": 55024690, "comment_id": 96802820, "body": "Oh... so I always need to use the same method depending on the page? If i start with IE I have to do the whole project with IE as well then? Thanks a lot btw !!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 1, "creation_date": 1551881086, "post_id": 55024690, "comment_id": 96802842, "body": "Seems like that may be the case unless an API is available"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1551880206, "creation_date": 1551880206, "answer_id": 55024690, "question_id": 55024184, "link": "https://stackoverflow.com/questions/55024184/vba-webscraping-returning-nothing-to-excel/55024690#55024690", "title": "VBA WebScraping returning nothing to excel", "body": "<p>The info is loaded dynamically. You need to use IE throughout. Also, change your css selector</p>\n\n<pre><code>Option Explicit\n\nPublic Sub WriterResults()\n    Dim IE As New InternetExplorer, i As Long, data As Object, span As Object, item As Object, r As Long, c As Long\n    With IE\n        .Visible = True\n        .Navigate2 \"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim numPages As Long, numResults As Long, arr() As String\n        arr = Split(.document.querySelector(\".snize-search-results-header\").innerText, Chr$(32))\n        numResults = arr(LBound(arr))\n        Dim resultsPerPage As Long\n        resultsPerPage = .document.querySelectorAll(\".snize-overhidden\").Length\n        numPages = Application.RoundUp(numResults / resultsPerPage, 0)\n        For i = 1 To numPages\n            If i &gt; 1 Then\n                .Navigate2 Replace$(\"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\", \"page=1\", \"page=\" &amp; i)\n                While .Busy Or .readyState &lt; 4: DoEvents: Wend\n            End If\n            Set data = .document.getElementsByClassName(\"snize-overhidden\")\n            For Each item In data\n                r = r + 1: c = 1\n                For Each span In item.getElementsByTagName(\"span\")\n                    With ThisWorkbook.Worksheets(\"Loi\u00e7a\")\n                        .Cells(r, c) = span.innerText\n                    End With\n                    c = c + 1\n                Next\n            Next\n        Next\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55024690, "answer_count": 1, "score": 0, "last_activity_date": 1560071733, "creation_date": 1551878657, "last_edit_date": 1560071733, "question_id": 55024184, "link": "https://stackoverflow.com/questions/55024184/vba-webscraping-returning-nothing-to-excel", "title": "VBA WebScraping returning nothing to excel", "body": "<p>I've been trying to scrap data from a WebSite, as my previous question indicates.<br>\nI was able to figure what my problem was thanks to the comunity, but now I'm facing another problem.<br>\nI don't get any error this time, but the program doesn't export any values to excel, my page still all blank.\n<br><strong>On the other website I was scraping from, the <code>HTML.Elements</code> were <code>divs</code> and now it's <code>spans</code>, it's because of that?</strong>\n<br>Here's my code:</p>\n\n<pre><code>Option Explicit\nPublic Sub Loi\u00e7a()\n    Dim data As Object, i As Long, html As HTMLDocument, r As Long, c As Long, item As Object, div As Object\n    Set html = New HTMLDocument                  '&lt;== VBE &gt; Tools &gt; References &gt; Microsoft HTML Object Library\n\n    Dim IE As New InternetExplorer\n    Dim numPages As Long\n    numPages = GetNumberOfPages\n\nWith CreateObject(\"MSXML2.XMLHTTP\")\n       ' numResults = arr(UBound(arr))\n       ' numPages = 1\n\n        For i = 1 To numPages\n             If i &gt; 1 Then\n                .Open \"GET\", Replace$(\"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\", \"page=1\", \"page=\" &amp; i), False\n                .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n                .send\n                 html.body.innerHTML = .responseText\n            End If\n            Set data = html.getElementsByClassName(\"snize-title\")\n            For Each item In data\n                r = r + 1: c = 1\n                For Each div In item.getElementsByTagName(\"span\")\n                    With ThisWorkbook.Worksheets(\"Loi\u00e7a\")\n                        .Cells(r, c) = div.innerText\n                    End With\n                    c = c + 1\n                Next\n            Next\n        Next\n    End With\n    '----------------------------------------------------------------------------------------------------------------------------------------------------------------------'\nEnd Sub\nPublic Function GetNumberOfPages() As Long\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = False\n        .Navigate2 \"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim numPages As Long, numResults As Long, arr() As String\n        arr = Split(.document.querySelector(\".snize-search-results-header\").innerText, Chr$(32))\n        numResults = arr(LBound(arr))\n        GetNumberOfPages = numResults\n        .Quit\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1551880261, "post_id": 55023918, "comment_id": 96802320, "body": "Perhaps, the guy who told you that you didn&#39;t &quot;need VBA to do this&quot; knew what you were intending to do. We don&#39;t. Note that there is no such thing as &quot;a reference to a function&quot;. Functions are called, not referenced. <code>Function f</code> has two parameters, x and y. It returns <code>x + y</code>. <code>Application.Goto Reference:=&quot;xplusy&quot;</code> requires that there should be a named range &quot;xplusy&quot; in your workbook. The code will select that range. It is unrelated to the <code>Sub xplusy()</code> which calls a sub by that same name in workbook &quot;5_3 Runge.Kutta.xlsm&quot; repeatedly, perhaps itself."}], "answers": [{"comments": [{"owner": {"reputation": 642, "user_id": 5031430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f54773bed5985e6b561303c382ebbab9?s=128&d=identicon&r=PG&f=1", "display_name": "Mary A. Marion", "link": "https://stackoverflow.com/users/5031430/mary-a-marion"}, "edited": false, "score": 0, "creation_date": 1551880661, "post_id": 55024088, "comment_id": 96802569, "body": "I just opened up the xlsm file. The macro is now not editable, will only run ie cannot be edited, and the name has been changed (filename is added to the beginning of macro name). My macros are being changed when I save? \u2013"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "reply_to_user": {"reputation": 642, "user_id": 5031430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f54773bed5985e6b561303c382ebbab9?s=128&d=identicon&r=PG&f=1", "display_name": "Mary A. Marion", "link": "https://stackoverflow.com/users/5031430/mary-a-marion"}, "edited": false, "score": 0, "creation_date": 1551880723, "post_id": 55024088, "comment_id": 96802611, "body": "That should be the case, yes."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 1, "last_activity_date": 1551878390, "creation_date": 1551878390, "answer_id": 55024088, "question_id": 55023918, "link": "https://stackoverflow.com/questions/55023918/how-to-change-a-macro-function/55024088#55024088", "title": "how to change a macro function", "body": "<p>You are calling the function <code>xplusy()</code>, which is calling the function <code>xplusy()</code>, which is calling the function <code>xplusy()</code>, which is calling the function <code>xplusy()</code>, ....<br>\nEach time you call a function, its reference is added to the so-called <code>stack</code>, so you are overloading that stack, explaining the error message.</p>\n\n<p>In the original file, you should check the name of the macro, and the macro you're calling (they definitely should be different).</p>\n"}, {"comments": [{"owner": {"reputation": 642, "user_id": 5031430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f54773bed5985e6b561303c382ebbab9?s=128&d=identicon&r=PG&f=1", "display_name": "Mary A. Marion", "link": "https://stackoverflow.com/users/5031430/mary-a-marion"}, "edited": false, "score": 0, "creation_date": 1551880462, "post_id": 55024197, "comment_id": 96802436, "body": "I just opened up the xlsm file. The macro is now not editable, will only run ie cannot be edited, and the name has been changed (filename is added to the beginning of macro name). My macros are being changed when I save?"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 2, "last_activity_date": 1551878679, "creation_date": 1551878679, "answer_id": 55024197, "question_id": 55023918, "link": "https://stackoverflow.com/questions/55023918/how-to-change-a-macro-function/55024197#55024197", "title": "how to change a macro function", "body": "<p>Let's pare your Sub down to the very basic level:</p>\n\n<pre><code>Sub VeryBasic()\n    Application.Run \"VeryBasic\"\n    Application.Run \"VeryBasic\"\n    Application.GoTo \"Location\"\nEnd Sub\n</code></pre>\n\n<p>Now, see how that code <em>calls itself</em>?  If we expand it 1 level, we get this:</p>\n\n<pre><code>Sub VeryBasic()\n    'Application.Run \"VeryBasic\"\n        Application.Run \"VeryBasic\"\n        Application.Run \"VeryBasic\"\n        Application.GoTo \"Location\"\n    'Application.Run \"VeryBasic\"\n        Application.Run \"VeryBasic\"\n        Application.Run \"VeryBasic\"\n        Application.GoTo \"Location\"\n    Application.GoTo \"Location\"\nEnd Sub\n</code></pre>\n\n<p>Expand it 2 levels:</p>\n\n<pre><code>Sub VeryBasic()\n    'Application.Run \"VeryBasic\"\n        'Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.GoTo \"Location\"\n        'Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.GoTo \"Location\"\n        Application.GoTo \"Location\"\n    'Application.Run \"VeryBasic\"\n        'Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.GoTo \"Location\"\n        'Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.Run \"VeryBasic\"\n            Application.GoTo \"Location\"\n        Application.GoTo \"Location\"\n    Application.GoTo \"Location\"\nEnd Sub\n</code></pre>\n\n<p><strong>Hopefully</strong> you can see that this code will keep getting bigger and bigger, without actually doing <em>anything</em> except adding another copy of itself to the \"Stack\" to run.  Eventually, your stack will run out of room (or your computer will run out of memory), and you get a <a href=\"https://en.wikipedia.org/wiki/Stack_overflow\" rel=\"nofollow noreferrer\">Stack overflow</a> error.</p>\n"}], "owner": {"reputation": 642, "user_id": 5031430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f54773bed5985e6b561303c382ebbab9?s=128&d=identicon&r=PG&f=1", "display_name": "Mary A. Marion", "link": "https://stackoverflow.com/users/5031430/mary-a-marion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55024088, "answer_count": 2, "score": 0, "last_activity_date": 1551879339, "creation_date": 1551877818, "last_edit_date": 1551879339, "question_id": 55023918, "link": "https://stackoverflow.com/questions/55023918/how-to-change-a-macro-function", "title": "how to change a macro function", "body": "<p>I have gotten an excel file that includes reference to a function f(x,y). The file did not include the macro. I wrote a macro with a different function and saved it with an .xlsm extension. when I run the new macro I get a run time error '28' out of stack space error.</p>\n\n<p>What does this mean and how do I correct? I was told I did not need visual basic to do this. Is this a special additional package? Thank you. </p>\n\n<pre><code>Sub xplusy()\n'\n' xplusy Macro\n' Function f(x,y) f=x+y End Function\n'\n\n'\n    Application.Run \"'5_3 Runge-Kutta.xlsm'!xplusy\"\n    Sheets(\"RK4\").Select\n    Range(\"C9\").Select\n    Application.Run \"'5_3 Runge-Kutta.xlsm'!xplusy\"\n    Range(\"E8\").Select\n    Application.CommandBars(\"Help\").Visible = False\n    Application.Goto Reference:=\"xplusy\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551879863, "post_id": 55023661, "comment_id": 96802083, "body": "Set <code>myTableRange</code> to <code>B2:B50</code>. Then change your <code>IF</code> statement to: <code>If Not Intersect(Target, myTableRange) Is Nothing Then</code>. If <code>Target</code> is in range, perform your steps. If <code>Target</code> is not in that range, reset <code>myTableRange</code> to <code>D2:D50</code> in an <code>Else</code>. Then check if your <code>Target</code> is in that range. If it is, perform your steps"}, {"owner": {"reputation": 1, "user_id": 11039190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c0deed2f99e8c85791701a1d488b39?s=128&d=identicon&r=PG&f=1", "display_name": "Almighty", "link": "https://stackoverflow.com/users/11039190/almighty"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551880387, "post_id": 55023661, "comment_id": 96802385, "body": "@ZAC - Thanks I&#39;ll try"}, {"owner": {"reputation": 1, "user_id": 11039190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c0deed2f99e8c85791701a1d488b39?s=128&d=identicon&r=PG&f=1", "display_name": "Almighty", "link": "https://stackoverflow.com/users/11039190/almighty"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551962267, "post_id": 55023661, "comment_id": 96838620, "body": "@ZAC Ok tried and succeeded, thank you"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551962722, "post_id": 55023661, "comment_id": 96838871, "body": "No problem, glad it helped"}], "answers": [{"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 1, "last_activity_date": 1557743357, "creation_date": 1557743357, "answer_id": 56110484, "question_id": 55023661, "link": "https://stackoverflow.com/questions/55023661/updating-columns-of-excel-2019-using-vba/56110484#56110484", "title": "Updating columns of Excel 2019 using VBA", "body": "<p>Set <code>myTableRange</code> to <code>B2:B50</code>. Then change your <code>IF</code> statement to: <code>If Not Intersect(Target, myTableRange) Is Nothing Then</code>. If <code>Target</code> is in range, perform your steps. If <code>Target</code> is not in that range, reset <code>myTableRange</code> to <code>D2:D50</code> in an <code>Else</code>. Then check if your <code>Target</code> is in that range. If it is, perform your steps</p>\n"}], "owner": {"reputation": 1, "user_id": 11039190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c0deed2f99e8c85791701a1d488b39?s=128&d=identicon&r=PG&f=1", "display_name": "Almighty", "link": "https://stackoverflow.com/users/11039190/almighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557743357, "creation_date": 1551876998, "last_edit_date": 1551877207, "question_id": 55023661, "link": "https://stackoverflow.com/questions/55023661/updating-columns-of-excel-2019-using-vba", "title": "Updating columns of Excel 2019 using VBA", "body": "<p>I found this VBA code which presently fills cols E and F with Date/Time and updates col F only with Date/Time when it detects a change in the range A2:D50. It works beautifully and thanks to the author. \nWhat I'd like to do is:</p>\n\n<ul>\n<li>to fill col E if there's a change in range B2:B50.</li>\n<li>and fill col F if there's a change in range D2:D50.</li>\n</ul>\n\n<p>I tried to modify the code and could fill col E, but am unable to update col F.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Timestamp Data\n    '   TeachExcel.com - Original Author\n\n    Dim myTableRange As Range\n    Dim myDateTimeRange As Range\n    Dim myUpdatedRange As Range\n\n    'Your data table range\n    Set myTableRange = Range(\"A2:D50\")\n\n    'Check if the changed cell is in the data tabe or not.\n    If Intersect(Target, myTableRange) Is Nothing Then Exit Sub\n\n    'Stop events from running\n    Application.EnableEvents = False\n\n    'Column for the date/time\n    Set myDateTimeRange = Range(\"E\" &amp; Target.Row)\n    'Column for last updated date/time\n    Set myUpdatedRange = Range(\"F\" &amp; Target.Row)\n\n    'Determine if the input date/time should change\n    If myDateTimeRange.Value = \"\" Then   \n        myDateTimeRange.Value = Now \n    End If\n\n    'Update the updated date/time value\n    myUpdatedRange.Value = Now\n\n    'Turn events back on\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551875813, "post_id": 55023253, "comment_id": 96799725, "body": "I can&#39;t help you with your main question but the also yes. You can split the code using &quot;&amp; _&quot; as line break, without the quotes."}, {"owner": {"reputation": 1, "user_id": 11159711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386f179fe1736884ed4b09e6c5a98ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Bosma", "link": "https://stackoverflow.com/users/11159711/sven-bosma"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551875980, "post_id": 55023253, "comment_id": 96799817, "body": "Thanks for your fast reply. This works for &quot;normal&quot; VBA code, but i cannot use &quot;&amp; _&quot; or &quot; _&quot; as a line brake in the SQL statement itself, as the code turns red and i get a simple &quot;syntax error&quot;"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551876079, "post_id": 55023253, "comment_id": 96799864, "body": "I believe it&#39;s because you are passing a string, so when you split the string you need to end the string and start it again every line break."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1551876326, "post_id": 55023253, "comment_id": 96800000, "body": "Did you try to run the SQL statement in your database? I think this is not valid SQL code for a Access database but I am not sure."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1551876521, "post_id": 55023253, "comment_id": 96800104, "body": "I agree IF/ELSE/BEGIN/END look more like T-SQL, there are no such constructs in Access SQL"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11159711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386f179fe1736884ed4b09e6c5a98ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Bosma", "link": "https://stackoverflow.com/users/11159711/sven-bosma"}, "edited": false, "score": 0, "creation_date": 1551883145, "post_id": 55024314, "comment_id": 96804102, "body": "Thank you for your answer, unfortunately this does not seem to work :/"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 1, "user_id": 11159711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386f179fe1736884ed4b09e6c5a98ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Bosma", "link": "https://stackoverflow.com/users/11159711/sven-bosma"}, "edited": false, "score": 0, "creation_date": 1551883390, "post_id": 55024314, "comment_id": 96804260, "body": "where does it error? I don&#39;t have the tables so I can&#39;t test any of it - I may have made a syntax error"}, {"owner": {"reputation": 1, "user_id": 11159711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386f179fe1736884ed4b09e6c5a98ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Bosma", "link": "https://stackoverflow.com/users/11159711/sven-bosma"}, "edited": false, "score": 0, "creation_date": 1551887124, "post_id": 55024314, "comment_id": 96806679, "body": "nevermind - it is working now. I have declared &quot;currentDate&quot; in the database as date, but with text it works now"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1551879066, "creation_date": 1551879066, "answer_id": 55024314, "question_id": 55023253, "link": "https://stackoverflow.com/questions/55023253/syntax-error-in-vba-sql-accdb-execution-expected-delete-insert-select-proc/55024314#55024314", "title": "Syntax Error in VBA SQL ACCDB execution expected &#39;DELETE&#39;,&#39;INSERT&#39;,&#39;SELECT,&#39;PROCEDURE&#39;, or &#39;UPDATE&#39;", "body": "<pre><code>Dim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nSet conn = New ADODB.Connection\n\nconn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=P:\\UHD-GEOBAN\\SPOC und Incident\\Screenshots\\Sven\\VBA\\statistik.accdb; Persist Security Info=False;\"\nconn.Open\nset rs = new ADODB.Recordset\nrs.open \"Select * from tbl_statistics where currentdate = #\" &amp; format(date(),\"dd mmm yyyy\") &amp; \"#\" ,conn\n'unless you're in the US not specifying the date format will bite you\nif rs.eof then \n     conn.execute \"INSERT INTO tbl_statistics(currentDate, spocmail) VALUES('#\" &amp; format(Date,\"dd mmm yyyy\")  &amp; \"#', '1') \n\nelse\n   conn.execute \"UPDATE tbl_statistics SET spocmail = spocmail + 1 WHERE currentDate = '#\" &amp; format(Date,\"dd mmm yyyy\" &amp; \"#\"\nend if\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11159711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386f179fe1736884ed4b09e6c5a98ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Bosma", "link": "https://stackoverflow.com/users/11159711/sven-bosma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551973205, "creation_date": 1551875703, "last_edit_date": 1551973205, "question_id": 55023253, "link": "https://stackoverflow.com/questions/55023253/syntax-error-in-vba-sql-accdb-execution-expected-delete-insert-select-proc", "title": "Syntax Error in VBA SQL ACCDB execution expected &#39;DELETE&#39;,&#39;INSERT&#39;,&#39;SELECT,&#39;PROCEDURE&#39;, or &#39;UPDATE&#39;", "body": "<p>I want to make a button to count actions in Outlook.</p>\n\n<p>I have the following code, but unfortunately it's not working:</p>\n\n<pre><code>Dim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nSet conn = New ADODB.Connection\n\nconn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=P:\\UHD-GEOBAN\\SPOC und Incident\\Screenshots\\Sven\\VBA\\statistik.accdb; Persist Security Info=False;\"\nconn.Open\n'DB: ID; currentDate; spocmail; onlinebankingmail\nconn.Execute (\"IF (NOT EXISTS(select * from tbl_statistics WHERE currentDate = '\" &amp; Date &amp; \"'))BEGIN INSERT INTO tbl_statistics(currentDate, spocmail) VALUES('\" &amp; Date &amp; \"', '1') END ELSE BEGIN UPDATE tbl_statistics SET spocmail = spocmail + 1 WHERE currentDate = '\" &amp; Date &amp; \"' END\")\n</code></pre>\n\n<p>I also would like to know, if it's possible to put the long SQL statements in multiple lines in the VBA code</p>\n\n<p>Thanks in forward</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1551882219, "post_id": 55023241, "comment_id": 96803511, "body": "Is it that you want to hide the extra Rows of data taking limit the column with less rows filled? So if Column G has 70 rows and Column N hast 75, hide from 71 to 75?"}, {"owner": {"reputation": 73, "user_id": 11159640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629f399d6fb632908027c67e715c10d3?s=128&d=identicon&r=PG&f=1", "display_name": "Qwerty", "link": "https://stackoverflow.com/users/11159640/qwerty"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551906463, "post_id": 55023241, "comment_id": 96816879, "body": "Hi Damian, to add a bit more context Column G and Column N are peoples names in two separate pivot tables. So depending on the day the range of data in each of these columns can differ (the pivot table has different filters). For example today there could be 50 rows of data in Column G and 40 in Column N. In this case the above formula would work and hide rows 51 to 71 with no data in. However, if Column G had 40 rows of data and Column N had 50 rows then it would still reference column G and hide rows 41 - 71, hiding data from column N."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 11159640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629f399d6fb632908027c67e715c10d3?s=128&d=identicon&r=PG&f=1", "display_name": "Qwerty", "link": "https://stackoverflow.com/users/11159640/qwerty"}, "edited": false, "score": 0, "creation_date": 1551907024, "post_id": 55024650, "comment_id": 96817113, "body": "I have tried this and have found the following; G24:G35 have data in &amp; N24:N30 have data in. With the above code it is hiding rows 31:71. The aim is for the code to look at rows G and rows N, identify where the greater range is and hide rows beyond that point up until row 71. So in this example identify the data range is larger in row G (G24:35) and then hide rows G36:71. Also for it to do the same in instances where the data range is greater in row N."}, {"owner": {"reputation": 73, "user_id": 11159640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629f399d6fb632908027c67e715c10d3?s=128&d=identicon&r=PG&f=1", "display_name": "Qwerty", "link": "https://stackoverflow.com/users/11159640/qwerty"}, "edited": false, "score": 0, "creation_date": 1551967374, "post_id": 55024650, "comment_id": 96841694, "body": "Thank you, Solved &amp; Working!"}, {"owner": {"reputation": 73, "user_id": 11159640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629f399d6fb632908027c67e715c10d3?s=128&d=identicon&r=PG&f=1", "display_name": "Qwerty", "link": "https://stackoverflow.com/users/11159640/qwerty"}, "edited": false, "score": 0, "creation_date": 1552039929, "post_id": 55024650, "comment_id": 96870081, "body": "Please see below question for further help if possible. Thanks."}], "tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": true, "score": 1, "last_activity_date": 1551955350, "last_edit_date": 1551955350, "creation_date": 1551880085, "answer_id": 55024650, "question_id": 55023241, "link": "https://stackoverflow.com/questions/55023241/hiding-rows-based-on-different-column-data-ranges/55024650#55024650", "title": "Hiding Rows Based On Different Column Data Ranges", "body": "<p>Try this one:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n    Dim xRg As Range, xCell As Range, bHide As Boolean\n    Application.ScreenUpdating = False\n        For Each xRg In Range(\"G24:G71, N24:N71\").Rows\n            bHide = True\n            For Each xCell In xRg.Cells\n                If IsEmpty(xRg.Value) = False Then\n                    bHide = False\n                End If\n            Next xCell\n            xRg.EntireRow.Hidden = bHide\n        Next xRg\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Explanation of the error: your code iterates through all cells, and makes a decision based on individual cells. That is incorrect because you want to know if both cells in a row are empty.</p>\n\n<p>Solution: So you should iterate rows in an outer loop, and cells inside the given row in an inner loop. Take note if there is any cell that is non-empty, and make the decision on hiding the row based on this.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Sorry, my code did not work because <code>Range(\"G24:G71, N24:N71\")</code> consists of 2 <code>.Areas,</code> and although <code>.Rows.Count</code> returns 48, <code>For Each</code> enumerates 96 \"rows\", each consisting of 1 cell (48 rows for each area).</p>\n\n<p>I modified the code to take into account Areas:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate()\n    Application.ScreenUpdating = False\n    With Range(\"G24:G71,N24:N71\")\n        Dim r As Long: For r = 1 To .Areas(1).Rows.Count\n            Dim bHide As Boolean: bHide = True\n            Dim xArea As Range: For Each xArea In .Areas\n                If IsEmpty(xArea.Cells(r, 1).Value) = False Then\n                    bHide = False\n                End If\n            Next xArea\n            .Rows(r).EntireRow.Hidden = bHide\n        Next r\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1551882528, "creation_date": 1551882528, "answer_id": 55025450, "question_id": 55023241, "link": "https://stackoverflow.com/questions/55023241/hiding-rows-based-on-different-column-data-ranges/55025450#55025450", "title": "Hiding Rows Based On Different Column Data Ranges", "body": "<p>This is another way to loop pivot table. The below code loop in two different columns (Items &amp; Quantity) and hidden rows:</p>\n\n<pre><code>Option Explicit\n\nSub Hide()\n\n    Dim pvtTable As PivotTable\n    Dim pvtItem As PivotItem\n    Dim pvtRow As Long\n\n    'Set table with name\n    Set pvtTable = ThisWorkbook.Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\")\n    'Loop Items in a specific field\n    For Each pvtItem In pvtTable.PivotFields(\"Item\").PivotItems\n        'Check conditions\n        pvtRow = pvtRow + 1\n\n        If pvtItem.Value = \"A\" Then\n            pvtTable.DataBodyRange.Rows(pvtRow).EntireRow.Hidden = True\n        ElseIf pvtItem.Value &lt;&gt; \"A\" And pvtTable.DataBodyRange.Rows(pvtRow).EntireRow.Hidden = True Then\n            pvtTable.DataBodyRange.Rows(pvtRow).EntireRow.Hidden = False\n        End If\n\n    Next pvtItem\n\n    'Loop Items in a specific field\n    For Each pvtItem In pvtTable.PivotFields(\"Quantity\").PivotItems\n        'Check conditions\n        pvtRow = pvtRow + 1\n\n        If pvtItem.Value = \"A\" Then\n            pvtTable.DataBodyRange.Rows(pvtRow).EntireRow.Hidden = True\n        ElseIf pvtItem.Value &lt;&gt; \"A\" And pvtTable.DataBodyRange.Rows(pvtRow).EntireRow.Hidden = True Then\n            pvtTable.DataBodyRange.Rows(pvtRow).EntireRow.Hidden = False\n        End If\n\n    Next pvtItem\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 11159640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629f399d6fb632908027c67e715c10d3?s=128&d=identicon&r=PG&f=1", "display_name": "Qwerty", "link": "https://stackoverflow.com/users/11159640/qwerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 55024650, "answer_count": 2, "score": 3, "last_activity_date": 1552032528, "creation_date": 1551875678, "last_edit_date": 1551954739, "question_id": 55023241, "link": "https://stackoverflow.com/questions/55023241/hiding-rows-based-on-different-column-data-ranges", "title": "Hiding Rows Based On Different Column Data Ranges", "body": "<p>I am fairly new to using VBA and am trying to create a code that will look at two different columns with varying data ranges and hide rows beyond the last data point (referencing both columns).</p>\n\n<p>At the moment I have this;</p>\n\n<pre><code>    Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n'Updateby Extendoffice 20160913\n    Dim xRg As Range\n    Application.ScreenUpdating = False\n        For Each xRg In Range(\"G24:G71, N24:N71\")\n            If xRg.Value = \"\" Then\n                xRg.EntireRow.Hidden = True\n\n            Else\n                xRg.EntireRow.Hidden = False\n            End If\n        Next xRg\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Column G and Column N are peoples names in two separate pivot tables. So depending on the day the range of data in each of these columns can differ (the pivot table has different filters). For example today there could be 50 rows of data in Column G and 40 in Column N. In this case the above formula would work and hide rows 51 to 71 with no data in. However, if Column G has 40 rows of data and Column N has 50 rows then it would reference column G and hide rows 41 - 71, hiding unwanted data from column N.</p>\n\n<p>Is there a way to get the code to look at Columns G &amp; N, identify which has a larger data range and hide rows beyond that point.</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["vba", "class", "if-statement", "range"], "comments": [{"owner": {"reputation": 469, "user_id": 10984529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/252d327a280e65cd24f88e1d46be31d7?s=128&d=identicon&r=PG&f=1", "display_name": "dasmy", "link": "https://stackoverflow.com/users/10984529/dasmy"}, "edited": false, "score": 1, "creation_date": 1551875680, "post_id": 55023145, "comment_id": 96799647, "body": "Is VBA really required? Maybe, using the builtin IF-function (see <a href=\"https://support.office.com/en-us/article/if-function-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>) is sufficient."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551875732, "post_id": 55023145, "comment_id": 96799675, "body": "So if on column A says &quot;Nee&quot; in column J must be  &quot;Er wordt in de cookie policy niet uitgelegd wat cookies zijn.&quot; and if on column B says &quot;Nee&quot; on column K must be &quot;  Waarom ze nuttig zijn is hier niet omschreven.&quot; ? Is that it?"}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1551876282, "creation_date": 1551876282, "answer_id": 55023444, "question_id": 55023145, "link": "https://stackoverflow.com/questions/55023145/vba-put-outcomes-if-statements-into-one-cell-as-a-listing/55023444#55023444", "title": "VBA put outcomes IF statements into one cell as a listing", "body": "<p>Your code can be simplified to this:</p>\n\n<pre><code>For i = startRow To lastRow\n    ' Check parameters and classify accordingly\n    If Sheet1.Range(\"A\" &amp; i).Value = \"Nee\" Then\n        Sheet1.Range(\"J\" &amp; i).Value = \" Er wordt in de cookie policy niet uitgelegd wat cookies zijn.\"\n    End If\n    ' If there's Nee in B column, then append next sentence with new line (Chr(10))\n    If Sheet1.Range(\"B\" &amp; i).Value = \"Nee\" Then\n        Sheet1.Range(\"J\" &amp; i).Value = Sheet1.Range(\"J\" &amp; i).Value &amp; Chr(10) &amp; \"  Waarom ze nuttig zijn is hier niet omschreven.\"\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "is_accepted": false, "score": 0, "last_activity_date": 1551877773, "creation_date": 1551877773, "answer_id": 55023906, "question_id": 55023145, "link": "https://stackoverflow.com/questions/55023145/vba-put-outcomes-if-statements-into-one-cell-as-a-listing/55023906#55023906", "title": "VBA put outcomes IF statements into one cell as a listing", "body": "<p>You can try putting this formula in column J, this way you avoid using macros</p>\n\n<pre><code>=IF(A2=\"Nee\",IF(B2=\"Nee\",\" Er wordt in de cookie policy niet uitgelegd wat cookies zijn.\" &amp;CHAR(10)&amp; \"  Waarom ze nuttig zijn is hier niet omschreven.\",\" Er wordt in de cookie policy niet uitgelegd wat cookies zijn.\"),\"\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11153438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc5316abd345e9c50514d325112e10a?s=128&d=identicon&r=PG&f=1", "display_name": "Batty", "link": "https://stackoverflow.com/users/11153438/batty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 55023444, "answer_count": 2, "score": 0, "last_activity_date": 1551877773, "creation_date": 1551875341, "last_edit_date": 1551877016, "question_id": 55023145, "link": "https://stackoverflow.com/questions/55023145/vba-put-outcomes-if-statements-into-one-cell-as-a-listing", "title": "VBA put outcomes IF statements into one cell as a listing", "body": "<p>My question is simple I guess, but I can't figure it out.\nTranslation: Ja=Yes / Nee=No</p>\n\n<p>So if cell A2 says \"Nee\" there should be a sentence in J2 if not then do nothing.\nThis is the same for al the other cells in each row.</p>\n\n<p>I got my code running that it does the if statements. BUT it just need to be merged into one cell.</p>\n\n<p>The Excel screenshot with an example of how it should be is as follows:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3a5be.png\" alt=\"Excel screenshot with example how it should be\"></p>\n\n<p>Code:</p>\n\n<pre><code>Sub SampleMacro()\n' Get the last row\nDim startRow As Long, lastRow As Long\nstartRow = 2\nlastRow = Sheet1.Cells(Sheet1.Rows.Count, 1).End(xlUp).Row\n\nDim i As Long, Wat As String\nDim j As Long, Waarom As String\n\nDim sClass As String\nDim tClass As String\n\n' Go through the parameter columns\nFor i = startRow To lastRow\n    Wat = Sheet1.Range(\"A\" &amp; i).Value\n\n    ' Check parameters and classify accordingly\n    If Wat = \"Nee\" Then\n        sClass = \" Er wordt in de cookie policy niet uitgelegd wat cookies zijn.\"\n    Else\n        sClass = \"\"\n    End If\n\nFor j = startRow To lastRow\n    Waarom = Sheet1.Range(\"B\" &amp; j).Value\n\n    If Waarom = \"Nee\" Then\n        tClass = \"  Waarom ze nuttig zijn is hier niet omschreven.\"\n    Else\n        tClass = \"\"\n    End If\n\n     ' Write out the class to columns\n    Sheet1.Range(\"J\" &amp; i).Value = sClass\n    Sheet1.Range(\"K\" &amp; j).Value = tClass\n\nNext\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551874215, "post_id": 55022726, "comment_id": 96798827, "body": "The first one, you don&#39;t need the last comma"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1551874218, "post_id": 55022726, "comment_id": 96798835, "body": "You&#39;re right. You can&#39;t do that like that. You instead just use <code>Cells(17, 2) = passing_variables(2, 4)</code>"}, {"owner": {"reputation": 82, "user_id": 4465153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91662a5cf1cf6907c34e8a484aaa2a64?s=128&d=identicon&r=PG", "display_name": "JeroenDV", "link": "https://stackoverflow.com/users/4465153/jeroendv"}, "edited": false, "score": 0, "creation_date": 1551879224, "post_id": 55022726, "comment_id": 96801690, "body": "Thanks, I am used to Python where this was the case I believe."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 4465153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91662a5cf1cf6907c34e8a484aaa2a64?s=128&d=identicon&r=PG", "display_name": "JeroenDV", "link": "https://stackoverflow.com/users/4465153/jeroendv"}, "edited": false, "score": 0, "creation_date": 1551879704, "post_id": 55022822, "comment_id": 96801972, "body": "At least not on purpose :D, I am used to Python where this is not the case."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1551874181, "creation_date": 1551874181, "answer_id": 55022822, "question_id": 55022726, "link": "https://stackoverflow.com/questions/55022726/how-to-omit-the-last-variable-in-an-arglist-using-vba/55022822#55022822", "title": "How to omit the last variable in an arglist using VBA", "body": "<p>Maybe just a typo</p>\n\n<pre><code>Sub main_procedure\n    Cells(17, 2) = passing_variables(2, 4)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": true, "score": 1, "last_activity_date": 1551874326, "creation_date": 1551874326, "answer_id": 55022872, "question_id": 55022726, "link": "https://stackoverflow.com/questions/55022726/how-to-omit-the-last-variable-in-an-arglist-using-vba/55022872#55022872", "title": "How to omit the last variable in an arglist using VBA", "body": "<p>You just omit it. For example:</p>\n\n<pre><code>Sub Test()\n    Debug.Print MyFunction(Var1:=2, Var2:=4)\n    Debug.Print MyFunction(Var1:=2, Var2:=4, Inverse:=True)\nEnd Sub\n\nFunction MyFunction(Var1 as Long, Var2 as Long, Optional Inverse as Boolean = False)\n    MyFunction = Var1 * Var2\n    If Inverse Then MyFunction = MyFunction * -1\nEnd Function\n</code></pre>\n\n<p>In the first call, \"Inverse\" is omitted.</p>\n"}], "owner": {"reputation": 82, "user_id": 4465153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91662a5cf1cf6907c34e8a484aaa2a64?s=128&d=identicon&r=PG", "display_name": "JeroenDV", "link": "https://stackoverflow.com/users/4465153/jeroendv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55022872, "answer_count": 2, "score": 0, "last_activity_date": 1551877530, "creation_date": 1551873874, "last_edit_date": 1551877530, "question_id": 55022726, "link": "https://stackoverflow.com/questions/55022726/how-to-omit-the-last-variable-in-an-arglist-using-vba", "title": "How to omit the last variable in an arglist using VBA", "body": "<p>When calling a function which has 3 arguments (a, b &amp; c respectively) where the last two are optional. Excel seems to force me to always supply the latest variable. When not supplying argument <strong>c</strong> , I recieve a <em>Compile Error /  Syntax Error.</em><br>\nBut I don't understand why?\nHow to omit the last variable from an argument list?</p>\n\n<p><strong>Function</strong></p>\n\n<pre><code>Function passing_variables(a, Optional b = 1, Optional c = 1)\n    passing_variables = a * b * c\nEnd Function\n</code></pre>\n\n<p><strong>Does not work</strong></p>\n\n<pre><code>Sub main_procedure\n    Cells(17, 2) = passing_variables(2, 4 , )\nEnd Sub\n</code></pre>\n\n<p><strong>Works</strong></p>\n\n<pre><code>Sub main_procedure\n    Cells(17, 2) = passing_variables(2, ,4)\nEnd Sub\n</code></pre>\n\n<p>Possible workaround is to provide named variables as stated by <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/understanding-named-arguments-and-optional-arguments\" rel=\"nofollow noreferrer\">Microsoft Language reference</a></p>\n"}, {"tags": ["excel", "vba", "row", "add"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872485, "post_id": 55022216, "comment_id": 96797780, "body": "If you have headers, your baserow would be +1?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1551873348, "post_id": 55022216, "comment_id": 96798297, "body": "Do you have any other tables below the one you are inserting rows into?"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551873846, "post_id": 55022216, "comment_id": 96798627, "body": "no, its one big table"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551873940, "post_id": 55022216, "comment_id": 96798675, "body": "I tried R = BaseRow + CInt(x) + 1 but no joy. Is that what you meant?"}], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551874927, "post_id": 55022769, "comment_id": 96799233, "body": "Would you please learn to tell where the error pops up? I assume at <i>Sheet1.ListObjects(1)</i>. Then either my assumption is wrong or the listobject is not on Sheet1. Do you know which sheet the data is on? And do you know the name, either the codename or the sheet name which you see in the tab on the bottom?"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551876944, "post_id": 55022769, "comment_id": 96800323, "body": "Thanks. I changed sheet1 to &quot;Rentals&quot; to match my sheet. The error now reads object required."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551877323, "post_id": 55022769, "comment_id": 96800539, "body": "How does your code look like now? Either you use the codename or you need to change the line to <code>Set myTbl = Sheets(&quot;Rentals&quot;).ListObjects(1)</code>."}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551877616, "post_id": 55022769, "comment_id": 96800714, "body": "Sub TestAdd() Dim myTbl As ListObject Dim x As String Dim i As Long      Set myTbl = Sheets(&quot;Rentals&quot;).ListObjects(1)     x = InputBox(&quot;How many rows would you like to add?&quot;, &quot;Insert Rows&quot;)      If x = &quot;&quot; Then Exit Sub     For i = 1 To CInt(x)         myTbl.ListRows.Add (1)     Next i End Sub"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551877702, "post_id": 55022769, "comment_id": 96800778, "body": "ok, this inserts new rows but there are a few format issues and not all the formulas are copied in. Any ideas?"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551878128, "post_id": 55022769, "comment_id": 96801011, "body": "Yeah, It is inserting rows. But it is not inserting the same format and formula from the rows below."}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551879669, "post_id": 55022769, "comment_id": 96801943, "body": "An error pops up saying subscript out of range. I don&#39;t understand the &quot;Tabelle4&quot;"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551879699, "post_id": 55022769, "comment_id": 96801971, "body": "I could send you the document if that makes it easier to understand?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551879707, "post_id": 55022769, "comment_id": 96801976, "body": "I just replaced it with your table name  :-)"}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551880763, "post_id": 55022769, "comment_id": 96802633, "body": "Ok this is exciting. it is very close. Some columns (appears random) I, O and Q copy the header colour cell into the new rows. A couple other columns don&#39;t centre the data like the others. Any ideas?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551881246, "post_id": 55022769, "comment_id": 96802929, "body": "The code works with my data and table. Anyway, I did a small modification to the code, maybe this fixes your issue."}, {"owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "edited": false, "score": 0, "creation_date": 1551881592, "post_id": 55022769, "comment_id": 96803129, "body": "YAAAAASSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS!!!!!!!!!!!!!!!!!!!!!!&zwnj;&#8203;!!!!!!!!!!!!!!!!!!!!&zwnj;&#8203;!!!!!!!!!!!!!!!!!!!!&zwnj;&#8203;!!!!!!!!!!!!!!!!!!!!&zwnj;&#8203;!!!!"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1551881192, "last_edit_date": 1551881192, "creation_date": 1551874007, "answer_id": 55022769, "question_id": 55022216, "link": "https://stackoverflow.com/questions/55022216/vba-to-insert-new-row-from-table-with-formula/55022769#55022769", "title": "VBA to insert new row from table with formula", "body": "<p>I think your table is a listobject. Then the following code might work</p>\n\n<pre><code>Sub TestAdd()\nDim myTbl As ListObject\nDim x As String\nDim i As Long\n\n    Set myTbl = Sheet1.ListObjects(1)\n    x = InputBox(\"How many rows would you like to add?\", \"Insert Rows\")\n\n    If x = \"\" Then Exit Sub\n    For i = 1 To CInt(x)\n        myTbl.ListRows.Add (1)\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong>: For keeping the format and formulas you could use the following code</p>\n\n<pre><code>Sub TestAdd()\n\nDim myTbl As ListObject\nDim x As String\nDim i As Long\nDim newRow As Range\nDim sngCell As Range\n\n    Set myTbl = Sheets(\"Rentals\").ListObjects(1)\n    x = InputBox(\"How many rows would you like to add?\", \"Insert Rows\")\n    If x = \"\" Then Exit Sub\n    For i = 1 To CInt(x)\n        Set newRow = myTbl.ListRows.Add(1).Range\n        With newRow\n            .Offset(1).Copy\n            ' .PasteSpecial xlPasteFormulasAndNumberFormats\n            .PasteSpecial xlPasteFormulas\n            .PasteSpecial xlPasteFormats\n            For Each sngCell In newRow\n                If Not (sngCell.HasFormula) Then\n                    sngCell.ClearContents\n                End If\n            Next\n        End With\n        Application.CutCopyMode = False\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11149204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e162eea973f75daffb5e306f44224dce?s=128&d=identicon&r=PG&f=1", "display_name": "SirSquiddly", "link": "https://stackoverflow.com/users/11149204/sirsquiddly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551881192, "creation_date": 1551872268, "last_edit_date": 1551875972, "question_id": 55022216, "link": "https://stackoverflow.com/questions/55022216/vba-to-insert-new-row-from-table-with-formula", "title": "VBA to insert new row from table with formula", "body": "<p>I have VBA code to add new rows to a table (data starts in row 5).</p>\n\n<p>I made a new sheet and it works pretty well when the table doesn't have headers. When I add headers, however, the following error pops up</p>\n\n<blockquote>\n  <p>run-time error '1004' this won't work because it would\n  move cells in a table on your worksheet.</p>\n</blockquote>\n\n<p>I click debug and it highlights <code>Rng.Insert Shift:=x1Down</code> </p>\n\n<p>What is the reason for the error and how can it be corrected?</p>\n\n<pre><code>Sub AddRows()\n\n    Const BaseRow As Long = 5   ' modify to suit\n\n    Dim x As String             ' InputBox returns text if 'Type' isn't specified\n    Dim Rng As Range\n    Dim R As Long\n\n    x = InputBox(\"How many rows would you like to add?\", \"Insert Rows\")\n    If x = \"\" Then Exit Sub\n    R = BaseRow + CInt(x) - 1\n\n    Rows(BaseRow).Copy          'Copy BaseRow\n    'specify range to insert new cells\n    Set Rng = Range(Cells(BaseRow, 1), Cells(R, 1))\n    Rng.Insert Shift:=xlDown\n\n    ' insert the new rows BEFORE BaseRow\n    ' to insert below BaseRow use Rng.Offset(BaseRow - R)\n    Set Rng = Rng.Offset(BaseRow - R - 1).Resize(Rng.Rows.Count, ActiveSheet.UsedRange.Columns.Count)\n    Rng.Select\n    On Error Resume Next\n    Rng.SpecialCells(xlCellTypeConstants).ClearContents\n    Application.CutCopyMode = False '\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1551872040, "post_id": 55022075, "comment_id": 96797531, "body": "You could try <code>match</code> on the range to get the row/column?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551873798, "post_id": 55022075, "comment_id": 96798600, "body": "What is the problem with <code>xlWhole</code>? I mean, what happens when you use it."}, {"owner": {"reputation": 5, "user_id": 10966767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc708e6601bf8db4551909fa3a96903f?s=128&d=identicon&r=PG&f=1", "display_name": "Nic", "link": "https://stackoverflow.com/users/10966767/nic"}, "edited": false, "score": 0, "creation_date": 1551878771, "post_id": 55022075, "comment_id": 96801408, "body": "I&#39;ve shown what happens when using xlWhole in image 2 in the description. Essentially for all integer span lengths, the values are just pasted in the first 3 columns."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551881674, "post_id": 55022075, "comment_id": 96803175, "body": "On the xwhole image you attached i can&#39;t find de 1.2, 1.6 on the column A, is it supposed to find the values you are putting in the yellow cells on the Column A?"}], "owner": {"reputation": 5, "user_id": 10966767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc708e6601bf8db4551909fa3a96903f?s=128&d=identicon&r=PG&f=1", "display_name": "Nic", "link": "https://stackoverflow.com/users/10966767/nic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551887433, "creation_date": 1551871878, "last_edit_date": 1551887433, "question_id": 55022075, "link": "https://stackoverflow.com/questions/55022075/find-function-is-only-finding-part-of-value-in-vba", "title": "Find function is only finding part of value in VBA", "body": "<p>I have written a macro in VBA which copies values from one worksheet to another using the find function.</p>\n\n<p>My workbook calculates certain variables depending on the span length of a bridge. The span length changes iteratively and I have named the variable \"SpanLength\". Each time the span length changes the macro copies the maximum values and pastes them to worksheet \"MAXIMUM\" (shown in the image attached). In MAXIMUM I have named all the top row of span lengths (1, 1.2, 1,4 etc.) \"FindSpanLength\". The macro then <em>finds</em> the appropriate span length here and paste  the maximum values next to it. This macro works except for with span lengths 2, 4, 6 and 8 where instead of finding these span lengths in MAXIMUM, it finds span lengths 1,2, 1.4, 1.6 and 1.8 and copies the results there.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ahCn1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ahCn1.jpg\" alt=\"x\"></a></p>\n\n<p>I have tried using Lookat:=xlWhole but this exacerbates the problem. Does anyone have any other solutions?</p>\n\n<p><a href=\"https://i.stack.imgur.com/U6yT0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U6yT0.jpg\" alt=\"xlWhole\"></a></p>\n\n<pre><code> Private Sub Max()\n\n    ' Chooses correct column: Find the span length column and name this outputcolumn\n    Dim spanlengthcell As Range, outputcolumn As Integer\n    Set spanlengthcell = Range(\"FindSpanLength\").Find(Range(\"SpanLength\").Value, LookIn:=xlValues, Lookat:=xlPart)\n    If Not spanlengthcell Is Nothing Then\n     outputcolumn = spanlengthcell.Column\n    End If\n\n' Chooses correct row: If the cell to the left of spanlengthcell is empty then this is the first row of output otherwise find next empty cell down\nIf MAXIMUM.Cells(4, outputcolumn + 1).Value = \"\" Then\n    outputrow = 4\nElseIf MAXIMUM.Cells(5, outputcolumn + 1).Value = \"\" Then\n    outputrow = 5\nElse\n    outputrow = MAXIMUM.Cells(4, outputcolumn + 1).End(xlDown).Row + 1\nEnd If\n\n' Copy starting point, max bending moment and max shear from calculate to output\nMAXIMUM.Cells(outputrow, outputcolumn + 1).Value = Sheets(\"Calculate\").Range(\"StartPoint\").Value\nMAXIMUM.Cells(outputrow, outputcolumn + 2).Value = Sheets(\"Calculate\").Range(\"[enter image description here][1]MaxBM\").Value\nMAXIMUM.Cells(outputrow, outputcolumn + 3).Value = Sheets(\"Calculate\").Range(\"MaxSF\").Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1551874074, "post_id": 55022012, "comment_id": 96798743, "body": "Please note that <i>&quot;it&#39;s not working&quot;</i> is no useful error description. Instead please tell which errors you get and in which line or what your code actually does vs. what you expect it to do."}, {"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551874120, "post_id": 55022012, "comment_id": 96798775, "body": "As I state the script runs in backgorund.It gives no error but it does not do what&#39;s expected."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1551874533, "post_id": 55022012, "comment_id": 96799021, "body": "What do you expect that is not happen?  I note that you are creating a copy of the first email in the default inbox and ignoring the rest.  You are supposed to process the email that is passed as a parameter."}, {"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1551875109, "post_id": 55022012, "comment_id": 96799330, "body": "What I want is that it looks at the incoming mail if &quot;Not internal&quot; text present, It should remove that text.    I don&#39;t want to create a copy just process the incoming mail edit and save it."}], "answers": [{"comments": [{"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1551947765, "post_id": 55026719, "comment_id": 96829600, "body": "it is not working.  Isn&#39;t htmlbody is the part where the mail is written normally ?"}, {"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1551956026, "post_id": 55026719, "comment_id": 96834870, "body": "I don&#39;t know why but i will try further.Still not working I don&#39;t know why.I am looking to the source code of the incoming mail as well.yesi It is within the htmlbody.  Is there any way ho delete long html code from the incoming mail ?"}, {"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1551960859, "post_id": 55026719, "comment_id": 96837799, "body": "exactly, same issue :) , I am deleting manually each time which cause a time and I want to automate this :)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1551979999, "post_id": 55026719, "comment_id": 96849423, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189609/discussion-between-tony-dallimore-and-ahmet\">continue this discussion in chat</a>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1551980114, "post_id": 55026719, "comment_id": 96849480, "body": "I have deleted my comments since they are all duplicated in the chat room.  I suggest you do the same."}, {"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1552395573, "post_id": 55026719, "comment_id": 96985522, "body": "Hello Tony,I found the error, outlook was preventing running macros because of security reasons when I fixed it.It works :)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1552397703, "post_id": 55026719, "comment_id": 96987015, "body": "@ahmet.  Pleased you got it working.  Sorry about the missing <code>End With</code>."}, {"owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "edited": false, "score": 0, "creation_date": 1552398795, "post_id": 55026719, "comment_id": 96987732, "body": "Hello Tony after i decreased the outlook macro security, i was able to see end with macro error ;) then i fixed that part."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 1, "last_activity_date": 1552396647, "last_edit_date": 1552396647, "creation_date": 1551886290, "answer_id": 55026719, "question_id": 55022012, "link": "https://stackoverflow.com/questions/55022012/delete-text-in-incoming-email/55026719#55026719", "title": "Delete text in incoming email", "body": "<p>Try:</p>\n\n<pre><code>Sub mails(MyMail As MailItem)\n  With MyMail\n    If Instr(1, .HTMLBody, \"Not Internal\") &gt; 0 Then\n      .HTMLBody = Replace(.HTMLBody, \"Not Internal\", \"\")\n      .Save\n    End If\n  End With\nEnd Sub\n</code></pre>\n\n<p>Your original code created <code>newMail</code> as a copy of the first item in the default inbox and amended that email. My version processes the email passed to it by the rule. Note that the email is only amended and saved if the body includes the string \"Not Internal\".  </p>\n"}, {"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1552258103, "creation_date": 1552258103, "answer_id": 55093181, "question_id": 55022012, "link": "https://stackoverflow.com/questions/55022012/delete-text-in-incoming-email/55093181#55093181", "title": "Delete text in incoming email", "body": "<p><strong>Converting part of an email to a VBA assignment statement: Part 1</strong></p>\n\n<p>First the warnings:</p>\n\n<p>Most of this code was written by me for me.  The comments are so I can understand the code when I need to amend it 12 or 24 months after I wrote it.  I have only added a few comments to help you.  Try to understand what my code does but ask questions if necessary.</p>\n\n<p>This system is work in progress.  It is fairly typical of my developments when I do not fully understand the scope of what I am attempting.  I create something simple using existing code and gradually improve it as my understanding of my requirement improves.  Repeatedly updating code eventually means it is too messy to be updated again.  I then redesign and rewrite ready for the next cycle of development.  I do not know of any errors in this code but there will be scenarios I have never tested.  Let me know of any problems.  If necessary, use the email address in my profile to send me full details of a problem.</p>\n\n<p>Having completed this answer, I can see that there is a lot for you to understand.  Although macros do all the difficult stuff, understanding what they are doing and why will not be easy.  Work through this answer slowly making sure you understand each step before moving onto the next.  Good luck. </p>\n\n<p>The first step is to discover what one of these emails look like to a VBA macro.  This is the routine I use:</p>\n\n<pre><code>Option Explicit\nPublic Sub InvestigateEmailsFile()\n\n  ' Outputs properties of selected emails to file \"InvestigateEmails.txt\"\n  ' on the desktop.\n\n  ' ???????  No record of when originally coded\n  ' 22Oct16  Create separate version with output to file rather than\n  '          Immediate Window.\n  ' 15Jan19  Previously, control characters were represented by {cr}, {lf}\n  '          and {tb}. There were replaced by \u2039cr\u203a, \u2039lf\u203a and \u2039tb\u203a on the\n  '          assumption that these special characters would never appear\n  '          in an email. \"\u2039\" is \\u2039 and \"\u203a\" is \\u203A\n  '  4Feb19  Previous version had tidied text itself because OutLongTextRtn\n  '          did not tidy text.  Amended OutLongTextRtn to use TidyTextForDspl\n\n  ' Technique for locating desktop from answer by Kyle:\n  ' http://stackoverflow.com/a/17551579/973283\n  ' Needs reference to \"Microsoft Scripting Runtime\"\n\n  Dim Exp As Explorer\n  Dim FileBody As String\n  Dim fso As FileSystemObject\n  Dim InxA As Long\n  Dim ItemCrnt As MailItem\n  Dim Path As String\n\n  Path = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  If Exp.Selection.Count = 0 Then\n    Call MsgBox(\"Please select one or more emails then try again\", vbOKOnly)\n    Exit Sub\n  Else\n    FileBody = \"\"\n    For Each ItemCrnt In Exp.Selection\n      If FileBody &lt;&gt; \"\" Then\n        FileBody = FileBody &amp; vbLf\n      End If\n      With ItemCrnt\n        FileBody = FileBody &amp; \"From (Sender): \" &amp; .Sender\n        FileBody = FileBody &amp; vbLf &amp; \"From (Sender name): \" &amp; .SenderName\n        FileBody = FileBody &amp; vbLf &amp; \"From (Sender email address): \" &amp; _\n                              .SenderEmailAddress\n        FileBody = FileBody &amp; vbLf &amp; \"Subject: \" &amp; CStr(.Subject)\n        FileBody = FileBody &amp; vbLf &amp; \"Received: \" &amp; Format(.ReceivedTime, \"dmmmyy hh:mm:ss\")\n        If .Attachments.Count = 0 Then\n          FileBody = FileBody &amp; vbLf &amp; \"No attachments\"\n        Else\n          FileBody = FileBody &amp; vbLf &amp; \"Attachments:\"\n          FileBody = FileBody &amp; vbLf &amp; \"No.|Type|Path|Filename|DisplayName|\"\n          For InxA = 1 To .Attachments.Count\n            With .Attachments(InxA)\n              FileBody = FileBody &amp; vbLf &amp; InxA &amp; \"|\"\n              Select Case .Type\n                Case olByValue\n                  FileBody = FileBody &amp; \"Val\"\n                Case olEmbeddeditem\n                  FileBody = FileBody &amp; \"Ebd\"\n                Case olByReference\n                  FileBody = FileBody &amp; \"Ref\"\n                Case olOLE\n                  FileBody = FileBody &amp; \"OLE\"\n                Case Else\n                  FileBody = FileBody &amp; \"Unk\"\n              End Select\n              ' Not all types have all properties.  This code handles\n              ' those missing properties of which I am aware.  However,\n              ' I have never found an attachment of type Reference or OLE.\n              ' Additional code may be required for them.\n              Select Case .Type\n                Case olEmbeddeditem\n                  FileBody = FileBody &amp; \"|\"\n                Case Else\n                  FileBody = FileBody &amp; \"|\" &amp; .Pathname\n              End Select\n              FileBody = FileBody &amp; \"|\" &amp; .Filename\n              FileBody = FileBody &amp; \"|\" &amp; .DisplayName &amp; \"|\"\n            End With\n          Next\n        End If  ' .Attachments.Count = 0\n        Call OutLongTextRtn(FileBody, \"Text: \", .Body)\n        Call OutLongTextRtn(FileBody, \"Html: \", .HtmlBody)\n        FileBody = FileBody &amp; vbLf &amp; \"--------------------------\"\n      End With\n    Next\n  End If\n\n  Call PutTextFileUtf8NoBom(Path &amp; \"\\InvestigateEmails.txt\", FileBody)\n\nEnd Sub\nPublic Sub OutLongTextRtn(ByRef TextOut As String, ByVal Head As String, _\n                          ByVal TextIn As String)\n\n  ' * Break TextIn into lines of not more than 100 characters\n  '   and append to TextOut.\n  ' * The output is arranged so:\n  '     xxxx|sssssssssssssss|\n  '         |sssssssssssssss|\n  '         |ssssssssss|\n  '   where \"xxxx\" is the value of Head and \"ssss...\" are characters from\n  '         TextIn.  The third line in the example could be shorter because:\n  '           * it contains the last few characters of TextIn\n  '           * there a linefeed in TextIn\n  '           * a &lt;xxx&gt; string recording whitespace would have been split\n  '             across two lines.\n\n  \u2018  ???????  Date originally coded not recorded.\n  ' 15Jan19  Added \"|\" at start and end of lines to make it clearer if\n  '          whitespace added by this routine or in original TextIn\n  '  3Feb19  Discovered I had two versions of OutLongText.  Renamed this version to\n  '          indicate it returned a formatted string.\n  '  4Feb19  Previous version relied on the caller tidying text for display. This\n  '          version expects TextIn to be untidied and uses TidyTextForDspl to tidy\n  '          the text and then creates TextOut from its output.\n\n  If TextIn = \"\" Then\n    ' Nothing to do\n    Exit Sub\n  End If\n\n  Const LenLineMax As Long = 100\n\n  'Dim LenLineCrnt As Long\n  Dim PosBrktEnd As Long     ' Last &gt; before PosEnd\n  Dim PosBrktStart As Long   ' Last &lt; before PosEnd\n  Dim PosNext As Long        ' Start of block to be output after current block\n  Dim PosStart As Long       ' First character of TextIn not yet output\n  'Dim TextInPart As String\n\n  TextIn = TidyTextForDspl(TextIn)\n  TextIn = Replace(TextIn, \"lf\u203a\", \"lf\u203a\" &amp; vbLf)\n\n  PosStart = 1\n  Do While True\n    PosNext = InStr(PosStart, TextIn, vbLf)\n    If PosNext = 0 Then\n      ' No LF in [Remaining] TextIn\n      'Debug.Assert False\n      PosNext = Len(TextIn) + 1\n    End If\n    If PosNext - PosStart &gt; LenLineMax Then\n      PosNext = PosStart + LenLineMax\n    End If\n    ' Check for &lt;xxx&gt; being split across lines\n    PosBrktStart = InStrRev(TextIn, \"\u2039\", PosNext - 1)\n    PosBrktEnd = InStrRev(TextIn, \"\u203a\", PosNext - 1)\n    If PosBrktStart &lt; PosStart And PosBrktEnd &lt; PosStart Then\n      ' No &lt;xxx&gt; within text to be displayed\n      ' No change to PosNext\n      'Debug.Assert False\n    ElseIf PosBrktStart &gt; 0 And PosBrktEnd &gt; 0 And PosBrktEnd &gt; PosBrktStart Then\n      ' Last or only &lt;xxx&gt; totally within text to be displayed\n      ' No change to PosNext\n      'Debug.Assert False\n    ElseIf PosBrktStart &gt; 0 And _\n           (PosBrktEnd = 0 Or (PosBrktEnd &gt; 0 And PosBrktEnd &lt; PosBrktStart)) Then\n      ' Last or only &lt;xxx&gt; will be split across rows\n      'Debug.Assert False\n      PosNext = PosBrktStart\n    Else\n      ' Are there other combinations?\n      Debug.Assert False\n    End If\n\n    'Debug.Assert Right$(Mid$(TextIn, PosStart, PosNext - PosStart), 1) &lt;&gt; \"\u2039\"\n\n    If TextOut &lt;&gt; \"\" Then\n      TextOut = TextOut &amp; vbLf\n    End If\n    If PosStart = 1 Then\n      TextOut = TextOut &amp; Head &amp; \"|\"\n    Else\n      TextOut = TextOut &amp; Space(Len(Head)) &amp; \"|\"\n    End If\n    TextOut = TextOut &amp; Mid$(TextIn, PosStart, PosNext - PosStart) &amp; \"|\"\n    PosStart = PosNext\n    If Mid$(TextIn, PosStart, 1) = vbLf Then\n      PosStart = PosStart + 1\n    End If\n    If PosStart &gt; Len(TextIn) Then\n      Exit Do\n    End If\n  Loop\n\nEnd Sub\nPublic Sub PutTextFileUtf8NoBom(ByVal PathFileName As String, ByVal FileBody As String)\n\n  ' Outputs FileBody as a text file named PathFileName using\n  ' UTF-8 encoding without leading BOM\n\n  ' Needs reference to \"Microsoft ActiveX Data Objects n.n Library\"\n  ' Addition to original code says version 2.5. Tested with version 6.1.\n\n  '  1Nov16  Copied from http://stackoverflow.com/a/4461250/973283\n  '          but replaced literals with parameters.\n  ' 15Aug17  Discovered routine was adding an LF to the end of the file.\n  '          Added code to discard that LF.\n  ' 11Oct17  Posted to StackOverflow\n  '  9Aug18  Comment from rellampec suggested removal of adWriteLine from\n  '          WriteTest statement would avoid adding LF.\n  ' 30Sep18  Amended routine to remove adWriteLine from WriteTest statement\n  '          and code to remove LF from file. Successfully tested new version.\n\n  ' References: http://stackoverflow.com/a/4461250/973283\n  '             https://www.w3schools.com/asp/ado_ref_stream.asp\n\n  Dim BinaryStream As Object\n  Dim UTFStream As Object\n\n  Set UTFStream = CreateObject(\"adodb.stream\")\n\n  UTFStream.Type = adTypeText\n  UTFStream.Mode = adModeReadWrite\n  UTFStream.Charset = \"UTF-8\"\n  UTFStream.Open\n  UTFStream.WriteText FileBody\n\n  UTFStream.Position = 3 'skip BOM\n\n  Set BinaryStream = CreateObject(\"adodb.stream\")\n  BinaryStream.Type = adTypeBinary\n  BinaryStream.Mode = adModeReadWrite\n  BinaryStream.Open\n\n  UTFStream.CopyTo BinaryStream\n\n  UTFStream.Flush\n  UTFStream.Close\n  Set UTFStream = Nothing\n\n  BinaryStream.SaveToFile PathFileName, adSaveCreateOverWrite\n  BinaryStream.Flush\n  BinaryStream.Close\n  Set BinaryStream = Nothing\n\nEnd Sub\nPublic Function TidyTextForDspl(ByVal Text As String) As String\n\n  ' Tidy Text for dsplay by replacing white space with visible strings:\n  '   Leave single space unchanged\n  '   Replace single LF by                 \u2039lf\u203a\n  '   Replace single CR by                 \u2039cr\u203a\n  '   Replace single TB by                 \u2039tb\u203a\n  '   Replace single non-break space by    \u2039nbs\u203a\n  '   Replace single CRLF by               \u2039crlf\u203a\n  '   Replace multiple spaces by           \u2039n s\u203a       where n is number of repeats\n  '   Replace multiple LFs by              \u2039n lf\u203a      of white space character\n  '   Replace multiple CRs by \u2039cr\u203a or      \u2039n cr\u203a\n  '   Replace multiple TBs by              \u2039n tb\u203a\n  '   Replace multiple non-break spaces by \u2039n nbs\u203a\n  '   Replace multiple CRLFs by            \u2039n crlf\u203a\n\n  ' 15Mar16  Coded\n  '  3Feb19  Replaced \"{\" (\\x7B) and \"}\" (\\x7D) by \"\u2039\" (\\u2039) and \"\u203a\" (\\u203A)\n  '          on the grounds that the angle quotation marks were not likely to\n  '          appear in text to be displayed.\n  '  5Feb19  Add code to treat CRLF as unit\n\n  Dim InsStr As String\n  Dim InxWsChar As Long\n  Dim NumWsChar As Long\n  Dim PosWsChar As Long\n  Dim RetnVal As String\n  Dim WsCharCrnt As Variant\n  Dim WsCharValue As Variant\n  Dim WsCharDspl As Variant\n\n  WsCharValue = VBA.Array(\" \", vbCr &amp; vbLf, vbLf, vbCr, vbTab, Chr(160))\n  WsCharDspl = VBA.Array(\"s\", \"crlf\", \"lf\", \"cr\", \"tb\", \"nbs\")\n\n  RetnVal = Text\n\n  ' Replace each whitespace individually\n  For InxWsChar = 0 To UBound(WsCharValue)\n    RetnVal = Replace(RetnVal, WsCharValue(InxWsChar), \"\u2039\" &amp; WsCharDspl(InxWsChar) &amp; \"\u203a\")\n  Next\n\n  ' Look for repeats. If found replace &lt;x&gt; by &lt;n x&gt;\n  For InxWsChar = 0 To UBound(WsCharValue)\n    PosWsChar = 1\n    Do While True\n      InsStr = \"\u2039\" &amp; WsCharDspl(InxWsChar) &amp; \"\u203a\"\n      PosWsChar = InStr(PosWsChar, RetnVal, InsStr &amp; InsStr)\n      If PosWsChar = 0 Then\n        ' No [more] repeats of this &lt;x&gt;\n        Exit Do\n      End If\n      ' Have &lt;x&gt;&lt;x&gt;.  Count number of extra &lt;x&gt;x\n      NumWsChar = 2\n      Do While Mid(RetnVal, PosWsChar + NumWsChar * Len(InsStr), Len(InsStr)) = InsStr\n        NumWsChar = NumWsChar + 1\n      Loop\n      RetnVal = Mid(RetnVal, 1, PosWsChar - 1) &amp; _\n                \"\u2039\" &amp; NumWsChar &amp; \" \" &amp; WsCharDspl(InxWsChar) &amp; \"\u203a\" &amp; _\n                Mid(RetnVal, PosWsChar + NumWsChar * Len(InsStr))\n      PosWsChar = PosWsChar + Len(InsStr) * (1 - NumWsChar) + 1 + Len(NumWsChar)\n\n    Loop\n  Next\n\n  ' Restore any single spaces\n  RetnVal = Replace(RetnVal, \"\u2039\" &amp; WsCharDspl(0) &amp; \"\u203a\", \" \")\n\n  TidyTextForDspl = RetnVal\n\nEnd Function\n</code></pre>\n\n<p>The above code needs references to \"Microsoft Scripting Runtime\" and \"Microsoft ActiveX Data Objects n.n Library\".</p>\n\n<p>For one of my emails, the above code creates a file on my desktop named \u201cInvestigateEmails.txt\u201d:</p>\n\n<pre><code>From (Sender): Zopa\nFrom (Sender name): Zopa\nFrom (Sender email address): zopa@mail.zopa.com\nSubject: Jane, your weekly Zopa update\nReceived: 1Mar19 16:30:49\nNo attachments\nText: |The latest news from Zopa\u2039crlf\u203a|\n      | &lt;http://click.mail.zopa.com/?qs=df1dd45fb22f0a80e44887f2afb89fa999010ffe37c4dffba1b431d565441dc586e|\n      |95525d2f44408471d2d3f3d36fcf89cca0b23e2b9ff84&gt; \u2039tb\u203a \u2039crlf\u203a|\n      |Can't see images?\u20392 s\u203aView in browser &lt;http://view.mail.zopa.com/?qs=4fd1698978f7849d57bb369504b2222|\n      |ec6a4dab29397ae38367d7cb6cda466891c948bfdca1b6e9a91fdf2f03d994985087240cc3ba05080cb96697ecdafef5faae|\n      |24843efc1e3649f6b94139653b26d&gt; \u2039crlf\u203a|\n\n      :       :       :       :\n\n      |change your Contact Preferences.\u2039crlf\u203a|\n      | &lt;http://click.mail.zopa.com/open.aspx?ffcb10-fefa1375756d04-fe53157770600d7a7113-fe3e15707564047b71|\n      |1773-ff62107470-fe671673766d017d7516-ff9a1574&gt; |\nHtml: |&lt;!doctype html&gt;&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xm|\n      |lns:o=\"urn:schemas-microsoft-com:office:office\"&gt;&lt;head&gt; &lt;title&gt;Zopa&lt;/title&gt; &lt;!--[if !mso]&gt;&lt;!-- --&gt; &lt;m|\n      |eta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt; &lt;!--&lt;![endif]--&gt;\u20392 s\u203a&lt;meta name=\"viewport\" conte|\n      |nt=\"width=device-width,initial-scale=1\"&gt; \u2039crlf\u203a|\n      |&lt;style type=\"text/css\"&gt; #outlook a { padding: 0; } .ReadMsgBody { width: 100%; } .ExternalClass { wi|\n      |dth: 100%; } .ExternalClass * { line-height: 100%; } body { margin: 0; padding: 0; -webkit-text-size|\n\n      :       :       :       :\n</code></pre>\n\n<p>As you can see, this file lists the most interesting properties including the text and Html bodies.  I add extra properties if I need to see them.  The text and Html bodies are exactly as held by Outlook except I have replaced control characters with strings such has \u201c\u2039crlf\u203a\u201d.  This allows me to understand exactly what a VBA program will see if it is processing an email body.</p>\n\n<p>Near the end of this email is a block of text the sender includes in all their emails.  This is sort of block I assume you wish to remove from your emails.</p>\n\n<p>Copy the above code to an Outlook module.  Select one of the emails you wish to process and run macro \u201cInvestigateEmailsFile()\u201d.  You should have a file on your desktop named \u201cExplorer.txt\u201d.  Open that file with your favourite text editor and you should see something like the content above.</p>\n"}, {"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1552261080, "creation_date": 1552261080, "answer_id": 55093521, "question_id": 55022012, "link": "https://stackoverflow.com/questions/55022012/delete-text-in-incoming-email/55093521#55093521", "title": "Delete text in incoming email", "body": "<p><strong>Converting part of an email to a VBA assignment statement: Part 2</strong></p>\n\n<p>At the end of Part 1, you should have a file on your desktop containing the Html body of one of the emails you wish to amend.</p>\n\n<p>The next step is to create an XLSM workbook with one worksheet named \u201cBody\u201d.  Expand columns \u201cA\u201d and \u201cB\u201d so \u201cC\u201d is just visible.  Make column \u201cA\u201d a little wider than \u201cB\u201d.  I find it helpful to format the worksheet as font Courier New\u201d and size 9.  Don\u2019t worry too much about the size of the columns, you can adjust them later.</p>\n\n<p>You now need to create a module within the workbook and copy this code to it:</p>\n\n<pre><code>Option Explicit\nSub ConvertBodyFromExplorerToVBA()\n\n  ' Column A of worksheet \"Body\" contains all or part of the\n  ' body of an email as output to file \"Explorer.txt\".\n  ' On exit, the data in column A has been converted to\n  ' VBA format in column B.\n\n  ' 17Jan19  Coded as part of FormatBodyAsVBA V01.xlsm\n  ' 10Mar19  Adjusted for the new format of \"Explorer.txt\"\n  '          Added code to handle output that requires more\n  '          continuation lines than allowed for VBA\n\n  Const MaxContLines As Long = 24     ' Maximum number of continuation lines per VBA statement\n  Const MaxLineLen As Long = 70       ' Normal maximum length of a line of the VBA string expression\n  Const MinPartLitLen As Long = 5     ' If a literal is split over two lines, neither part may be\n                                      ' less than MinPartStrLen characters.\n  Dim BodyIn As String                ' The string to be converted to a VBA string expression\n  Dim BodyPartsOut As New Collection  ' Each element is a part of the VBA string expression\n                                      ' Parts are \"xxx\" or vbCr or VbLf or so on\n  Dim CtrlCharType As String          ' s, cr, lf, crlf or nbs\n  Dim CtrlCharVba As String           ' VBA equivalent of s, cr, lf, crlf or nbs\n  Dim InxB As Long                    ' Inxex into BodyPartsOut\n  'Dim LenNextPart As Long\n  Dim LenOver As Long                 ' If a literal is to be split over two lines,\n                                      ' the length for the next line\n  Dim LenThisLine As Long             ' If a literal is to be split over two lines,\n                                      ' the length for the current line\n  Dim LineCrnt As String              ' Line imported from column A or\n                                      ' line being built ready to be added to column B\n  Dim LenMax As Long                  ' Maximum length of string that can be added to LineCrnt\n  Dim NumContLines                    ' Number of contuation lines for current string expression\n  Dim NumRpts As Long                 ' # from \u2039# xx\u203a\n  Dim NumVariables As Long            ' Number of variables required to hold output string expression\n  Dim PosInCrnt As Long               ' Everything before position PosInCrnt of BodyIn\n                                      ' has been output to BodyPartsOut\n  Dim PosInNext As Long               ' Start of next control character or end of BodyIn\n  Dim PosV As Long                    ' Position of vertical bar within LineCrnt\n  Dim RowInCrnt As Long               ' \\ Used to control building of\n  Dim RowInLast As Long               ' / BodyIn from input lines\n  Dim RowOutCrnt As Long              ' Row of column B for LineCrnt\n  Dim UnitCrnt As String              ' Holds a string literal while it is being split\n                                      ' over multiple lines.\n\n  With Worksheets(\"Body\")\n\n    .Columns(2).Clear\n\n    ' The source within the text file will be of the form:\n    ' Text: |xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx|\n    '       |xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx|\n    '       |xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx|\n    ' Html: |xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx|\n    '       |xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx|\n    '       |xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx|\n    '\n    ' Part of either a text body or an html body will have been copied to\n    ' column 1 of worksheet \"Body\".  Do not include any part of \"Text:\" or\n    ' \"Html:\" as this will confuse the code that removes the start and end\n    ' of each line.\n\n    ' This For loop removes the leading \"      |\" and trailing \"|\" from each\n    ' line and joins the text between the vertical lines into a single string.\n    BodyIn = \"\"\n    RowInLast = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    For RowInCrnt = 1 To RowInLast\n      LineCrnt = .Cells(RowInCrnt, \"A\").Value\n      If Right$(LineCrnt, 1) = \"|\" Then\n        ' Remove trailing \"|\"\n        LineCrnt = Mid$(LineCrnt, 1, Len(LineCrnt) - 1)\n      End If\n      Do While Left$(LineCrnt, 1) = \" \"\n        ' Remove leading space\n        LineCrnt = Mid$(LineCrnt, 2)\n      Loop\n      If Left$(LineCrnt, 1) = \"|\" Then\n        ' Remove leading \"|\"\n        LineCrnt = Mid$(LineCrnt, 2)\n      End If\n      BodyIn = BodyIn &amp; LineCrnt\n    Next\n\n  End With\n\n  ' Display BodyIn as a diagnostic aid.\n  Debug.Print \"[\" &amp; Replace(BodyIn, \"lf\u203a\", \"lf\u203a\" &amp; vbLf) &amp; \"]\"\n  'Debug.Assert False\n\n  ' * This Do loop converts BodyIn into the units of a VBA string expression\n  '   and stores them in collection BodyPartsOut.  These units are \"xxxx\",\n  '   vbCr, vbLf, vbCrLf, vbTab, Chr$(160) and String(#, \"x\").\n  ' * The input is ... xxxxxx\u2039# yy\u203axxxxxx\u2039yy\u203axxxxxx\u2039# yy\u203a ...\n  ' * This loop puts speech marks around each string of xs to create a string\n  '   literal and decodes each \u2039...\u203a and creates one or more of the other\n  '   units as appropriate.\n  PosInCrnt = 1\n  Do While PosInCrnt &lt;= Len(BodyIn)\n\n    'Find next control character if any\n    PosInNext = InStr(PosInCrnt, BodyIn, \"\u2039\")\n\n    If PosInNext = 0 Then\n      ' No [more] control characters in BodyIn.\n      'Debug.Assert False\n      PosInNext = Len(BodyIn) + 1\n    End If\n\n    If PosInCrnt = PosInNext Then\n      ' Next character of BodyIn is the start of control character\n      PosInCrnt = PosInCrnt + 1\n      If IsNumeric(Mid$(BodyIn, PosInCrnt, 1)) Then\n        ' Control string is of the form: \u2039# xx\u203a where\n        ' # is the number of repeats of control character xx\n        PosInNext = InStr(PosInCrnt, BodyIn, \" \")\n        NumRpts = Mid$(BodyIn, PosInCrnt, PosInNext - PosInCrnt)\n        PosInCrnt = PosInNext + 1\n      Else\n        ' Control string is of the form: \u2039xx\u203a where xx identifies a control character\n        NumRpts = 1\n        PosInCrnt = PosInNext + 1\n      End If\n      PosInNext = InStr(PosInCrnt, BodyIn, \"\u203a\")\n      CtrlCharType = Mid$(BodyIn, PosInCrnt, PosInNext - PosInCrnt)\n      PosInCrnt = PosInNext + 1\n      Select Case CtrlCharType\n        Case \"s\"\n          ' CtrlCharVba not used for space\n        Case \"crlf\"\n          CtrlCharVba = \"vbCrLf\"\n        Case \"tb\"\n          CtrlCharVba = \"vbTab\"\n        Case \"cr\"\n          CtrlCharVba = \"vbCr\"\n        Case \"lf\"\n          CtrlCharVba = \"vbLf\"\n        Case \"nbs\"\n          CtrlCharVba = \"Chr$(160)\"\n        Case Else\n          Debug.Assert False  ' Error. Unknown control character type\n      End Select\n      If NumRpts = 1 Then\n        ' Note: no single spaces\n        BodyPartsOut.Add CtrlCharVba\n      ElseIf CtrlCharType = \"s\" Then\n        ' Single, repeating space\n        BodyPartsOut.Add \"Space(\" &amp; NumRpts &amp; \")\"\n      ElseIf CtrlCharType &lt;&gt; \"crlf\" Then\n        ' Single, repeating control character\n        BodyPartsOut.Add \"String(\" &amp; NumRpts &amp; \", \" &amp; CtrlCharVba &amp; \")\"\n      Else\n        ' Double, repeating control character\n        Do While NumRpts &gt; 0\n          BodyPartsOut.Add CtrlCharVba\n          NumRpts = NumRpts - 1\n        Loop\n      End If\n    Else\n    ' Convert display characters PosInCrnt to PosInNext of BodyIn to a string literal\n      BodyPartsOut.Add \"\"\"\" &amp; Mid$(BodyIn, PosInCrnt, PosInNext - PosInCrnt) &amp; \"\"\"\"\n      PosInCrnt = PosInNext\n    End If\n  Loop\n\n  ' Display the elements of BodyPartsOut as a diagnostic aid.\n  Debug.Print\n  Debug.Print \"[\";\n  LineCrnt = \"\"\n  For InxB = 1 To BodyPartsOut.Count\n    If InxB &gt; 1 Then\n      LineCrnt = LineCrnt &amp; \" &amp; \"\n    End If\n    If Len(LineCrnt) + 3 + Len(BodyPartsOut(InxB)) &gt; MaxLineLen Then\n      Debug.Print LineCrnt &amp; \" _\"\n      LineCrnt = \"\"\n    End If\n    LineCrnt = LineCrnt &amp; BodyPartsOut(InxB)\n  Next\n  Debug.Print LineCrnt &amp; \"]\"\n  'Debug.Assert False\n  Debug.Print\n\n  RowOutCrnt = 1\n  NumVariables = 1\n  NumContLines = 0\n  LineCrnt = \"  Text1 = \"\n\n  With Worksheets(\"Body\")\n\n    ' This For loop converts the seperate units in BodyPartsOut into a string\n    ' expression by places \" &amp; \" between each unit and outputting the result\n    ' to column B of worksheet \"Body\".  It also cuts the entire string\n    ' expression into lines of about MaxLineLen characters and adds \" _\" at\n    ' the end of each line except the last.\n    For InxB = 1 To BodyPartsOut.Count\n      If InxB &gt; 1 Then\n        ' \" &amp; \" needed before every unit except the first\n        LineCrnt = LineCrnt &amp; \" &amp; \"\n      End If\n      ' The IIf below returns 2 (the length of \" _\") except for the last unit\n      ' for which it returns 0. This allows for a line continuation if necessary.\n      If Len(LineCrnt) + IIf(InxB = BodyPartsOut.Count, 0, 4) + _\n         Len(BodyPartsOut(InxB)) &lt;= MaxLineLen Then\n        ' Can fit the whole of the next body part onto the next line\n        'Debug.Assert False\n        LineCrnt = LineCrnt &amp; BodyPartsOut(InxB)\n        'Debug.Print \"LineCrnt [\" &amp; LineCrnt &amp; \"]\"\n      ElseIf Left$(BodyPartsOut(InxB), 1) &lt;&gt; \"\"\"\" Then\n        ' Unit is not a literal so cannot be split. Place on following line\n        'Debug.Assert False\n        If NumContLines = MaxContLines Then\n          'Debug.Assert False\n          LineCrnt = Mid$(LineCrnt, 1, Len(LineCrnt) - 2)  ' Remove concatenation\n          .Cells(RowOutCrnt, \"B\").Value = LineCrnt\n          ' Start new variable\n          NumVariables = NumVariables + 1\n          NumContLines = 0\n          LineCrnt = \"  Text\" &amp; NumVariables &amp; \" = \"\n        Else\n          'Debug.Assert False\n          .Cells(RowOutCrnt, \"B\").Value = LineCrnt &amp; \"_\"\n           NumContLines = NumContLines + 1\n          LineCrnt = Space(10)\n        End If\n        Debug.Print \"Row \" &amp; PadL(RowOutCrnt, 2) &amp; \" [\" &amp; .Cells(RowOutCrnt, \"B\").Value &amp; \"]\"\n        RowOutCrnt = RowOutCrnt + 1\n        LineCrnt = LineCrnt &amp; BodyPartsOut(InxB)\n        'Debug.Print \"LineCrnt [\" &amp; LineCrnt &amp; \"]\"\n      Else\n        'Debug.Assert False\n        ' Unit is a literal which can be split over two or more lines\n        ' A collection element cannot be amended so copy to variable\n        ' without speech marks.\n        UnitCrnt = Mid$(BodyPartsOut(InxB), 2, Len(BodyPartsOut(InxB)) - 2)\n        Do While UnitCrnt &lt;&gt; \"\"\n          'Debug.Assert False\n          LenThisLine = MaxLineLen - Len(LineCrnt) - 4  ' 4 for \" &amp; _\"\n          LenOver = Len(UnitCrnt) - LenThisLine\n          If LenOver &lt; 0 Then\n            LenOver = 0\n          End If\n          If LenOver = 0 Then\n            ' Can fit remainder of UnitCrnt on current line\n            'Debug.Assert False\n            ' Double any speech marks within literal\n            LineCrnt = LineCrnt &amp; \"\"\"\" &amp; Replace(UnitCrnt, \"\"\"\", \"\"\"\"\"\") &amp; \"\"\"\"\n            'Debug.Print \"LineCrnt [\" &amp; LineCrnt &amp; \"]\"\n            Exit Do\n          ElseIf LenThisLine &lt; MinPartLitLen Then\n            ' No room for part of literal on current line so settle for short line\n            Debug.Assert False\n            If NumContLines = MaxContLines Then\n              Debug.Assert False\n              LineCrnt = Mid$(LineCrnt, 1, Len(LineCrnt) - 2)  ' Remove concatenation\n              .Cells(RowOutCrnt, \"B\").Value = LineCrnt\n              ' Start new variable\n              NumVariables = NumVariables + 1\n              NumContLines = 0\n              LineCrnt = \"  Text\" &amp; NumVariables &amp; \" = \"\n            Else\n              Debug.Assert False\n              .Cells(RowOutCrnt, \"B\").Value = LineCrnt &amp; \"_\"\n               NumContLines = NumContLines + 1\n              LineCrnt = Space(10)\n            End If\n            Debug.Print \"Row \" &amp; PadL(RowOutCrnt, 2) &amp; \" [\" &amp; .Cells(RowOutCrnt, \"B\").Value &amp; \"]\"\n            RowOutCrnt = RowOutCrnt + 1\n            LineCrnt = LineCrnt &amp; BodyPartsOut(InxB)\n            ' Loop to fit all or part of UnitCrnt onto next line\n          ElseIf LenOver &lt; MinPartLitLen Then\n            ' Left over portion of literal too short to be split off.\n            ' Settle for overlength current line\n            Debug.Assert False\n            LineCrnt = LineCrnt &amp; \"\"\"\" &amp; Replace(UnitCrnt, \"\"\"\", \"\"\"\"\"\") &amp; \"\"\" &amp;\"\n            If NumContLines = MaxContLines Then\n              Debug.Assert False\n              LineCrnt = Mid$(LineCrnt, 1, Len(LineCrnt) - 2)  ' Remove concatenation\n              .Cells(RowOutCrnt, \"B\").Value = LineCrnt\n              ' Start new variable\n              NumVariables = NumVariables + 1\n              NumContLines = 0\n              LineCrnt = \"  Text\" &amp; NumVariables &amp; \" = \"\n            Else\n              Debug.Assert False\n              .Cells(RowOutCrnt, \"B\").Value = LineCrnt &amp; \"_\"\n               NumContLines = NumContLines + 1\n              LineCrnt = Space(10)\n            End If\n            Debug.Print \"Row \" &amp; PadL(RowOutCrnt, 2) &amp; \" [\" &amp; .Cells(RowOutCrnt, \"B\").Value &amp; \"]\"\n            RowOutCrnt = RowOutCrnt + 1\n          Else\n            ' UnitCrnt can be split.  Fit what can onto current line\n            'Debug.Assert False\n            LineCrnt = LineCrnt &amp; \"\"\"\" &amp; _\n                       Replace(Left$(UnitCrnt, LenThisLine), \"\"\"\", \"\"\"\"\"\") &amp; \"\"\" &amp; \"\n            If NumContLines = MaxContLines Then\n              'Debug.Assert False\n              LineCrnt = Mid$(LineCrnt, 1, Len(LineCrnt) - 2)  ' Remove concatenation\n              .Cells(RowOutCrnt, \"B\").Value = LineCrnt\n              ' Start new variable\n              NumVariables = NumVariables + 1\n              NumContLines = 0\n              LineCrnt = \"  Text\" &amp; NumVariables &amp; \" = \"\n            Else\n              'Debug.Assert False\n              .Cells(RowOutCrnt, \"B\").Value = LineCrnt &amp; \"_\"\n               NumContLines = NumContLines + 1\n              LineCrnt = Space(10)\n            End If\n            Debug.Print \"Row \" &amp; PadL(RowOutCrnt, 2) &amp; \" [\" &amp; .Cells(RowOutCrnt, \"B\").Value &amp; \"]\"\n            UnitCrnt = Mid$(UnitCrnt, LenThisLine + 1)\n            RowOutCrnt = RowOutCrnt + 1\n            ' Loop to fit all or part of UnitCrnt onto next line\n          End If  ' List of alternative splitting techniques for handling overlength unit\n        Loop  ' Until all of UnitCrnt has been output\n      End If  ' UnitCrnt fits onto current line or list of alternative choices\n    Next InxB\n    If LineCrnt &lt;&gt; \"\" Then\n      .Cells(RowOutCrnt, \"B\").Value = LineCrnt\n      Debug.Print \"Row \" &amp; RowOutCrnt &amp; \" [\" &amp; .Cells(RowOutCrnt, \"B\").Value &amp; \"]\"\n    End If\n  End With\n\nEnd Sub\nSub TestConvertOutput()\n\n  Dim Text1 As String\n  Dim Text2 As String\n  Dim TextToBeRemoved As String  \n\n\n\n  TextToBeRemoved = Text1 &amp; Text2\n\nDebug.Print TidyTextForDspl(TextToBeRemoved)\n\nEnd Sub\nPublic Function PadL(ByVal Str As String, ByVal PadLen As Long, _\n                     Optional ByVal PadChr As String = \" \") As String\n\n  ' Pad Str with leading PadChr to give a total length of PadLen\n  ' If the length of Str exceeds PadLen, Str will not be truncated\n\n  '   Sep15 Coded\n  ' 20Dec15 Added code so overlength strings are not truncated\n  ' 10Jun16 Added PadChr so could pad with characters other than space\n\n  If Len(Str) &gt;= PadLen Then\n    ' Do not truncate over length strings\n    PadL = Str\n  Else\n    PadL = Right$(String(PadLen, PadChr) &amp; Str, PadLen)\n  End If\n\nEnd Function\n</code></pre>\n\n<p>The Outlook code includes macro <code>TidyTextForDspl</code>.  You will need this macro in the Excel module as well.</p>\n\n<p>I doubt if the Outlook code will give you any problems because I have been using that code for some time.  My only concern is I have forgotten to include one of my library routines which are not in the same module as macro <code>InvestigateEmailsFile</code>.  This Excel code is experimental.  I have tested it on Html that I hope is more complicated than yours. That Html converted to a string expression that exceeded a VBA limit.  This weekend I have extended to code to avoid that limit.</p>\n\n<p>Now return to \u201cExplorer.txt\u201d.  Select and copy the entire block you want to remove. (I will explain this below.)  Switch to the workbook and paste into Cell A1 of worksheet \u201cBody\u201d.  With my example email, column \u201cA\u201d looks like:</p>\n\n<pre><code>&lt;div style=\"font-family:Verdana;font-size:12px;font-weight:400;line-height:16px;text-align:lef|\n      |t;color:#ABABAB;\"&gt;\u2039crlf\u203a|\n      |\u203916 s\u203aZopa Limited is authorised and regulated by the Financial Conduct Authority, and entered on th|\n      |e Financial Services Register (&lt;span style=\"color:#00B9A7;\"&gt;718925&lt;/span&gt;). Zopa Bank Limited is aut|\n      |horised by the Prudential Regulation Authority and regulated by the Financial Conduct Authority and |\n      |the Prudential Regulation Authority, and entered on the Financial Services Register (&lt;span style=\"co|\n      |lor:#00B9A7;\"&gt;800542&lt;/span&gt;). Zopa Limited (&lt;span style=\"color:#00B9A7;\"&gt;05197592&lt;/span&gt;) and Zopa B|\n      |ank Limited (&lt;span style=\"color:#00B9A7;\"&gt;10627575&lt;/span&gt;) are both incorporated in England &amp;amp; Wa|\n      |les and have their registered office at: 1st Floor, Cottons Centre, Tooley Street, London, SE1 2QG.&lt;|\n      |br&gt;\u2039crlf\u203a|\n      |\u203916 s\u203a&lt;br&gt;\u2039crlf\u203a|\n      |\u203916 s\u203a&amp;copy; Zopa Bank Limited 2019 All rights reserved. 'Zopa' is a trademark of Zopa Bank Limited.|\n      |&lt;br&gt;\u2039crlf\u203a|\n      |\u203916 s\u203a&lt;br&gt;\u2039crlf\u203a|\n      |\u203916 s\u203aZopa is a member of Cifas &amp;ndash; the UK&amp;rsquo;s leading anti-fraud association, and we are re|\n      |gistered with the Office of the Information Commissioner (&lt;span style=\"color:#00B9A7;\"&gt;ZA275984&lt;/spa|\n      |n&gt;, &lt;span style=\"color:#00B9A7;\"&gt;Z8797078&lt;/span&gt;).&lt;br&gt;\u2039crlf\u203a|\n      |\u203916 s\u203a&lt;br&gt;\u2039crlf\u203a|\n      |\u203916 s\u203aNo longer want to receive our emails? &lt;a\u20392 s\u203ahref=\"http://click.mail.zopa.com/?qs=df1dd45fb22f|\n      |0a804e99ede07e73c95c826908dfc9aef47f93c598c0c6537648c2c346408fab877afa32022afc1a846a3060560073066676|\n      |d72d0a4720039df6\" style=\"color: #ffffff; font-weight: 700; text-decoration: none;\"&gt;Unsubscribe&lt;/a&gt; o|\n      |r sign into your &lt;a\u20392 s\u203ahref=\"http://click.mail.zopa.com/?qs=df1dd45fb22f0a80c21dc52c7c6968eb3af863f|\n      |9656119ff373444e56f12bbc5c50c416ecbcd8e2c0192ac31983d91b06478e0f60261102d\" style=\"color: #ffffff; fo|\n      |nt-weight: 700; text-decoration: none;\"&gt;Zopa Account&lt;/a&gt; to change your Contact Preferences.&lt;/div&gt;\n</code></pre>\n\n<p>I found this block by searching for \u201cHtml:\u201d and then \u201cZopa Limited is authorised\u201d.  You need to search for the start of the text you want to remove.  Next is the difficult step.  You need to identify the entire block you want to remove.</p>\n\n<p>If you look at my example, the block starts <code>&lt;div style=\"font</code> and end <code>&lt;/div&gt;</code>.  You say the text you want to remove is coloured.  Note, the style attribute for the <code>&lt;div&gt;</code> start tag ends <code>color:#ABABAB</code>.  You will almost certainly have something similar at the start of the block you want to remove since this is what colours the text.  You need to remove the entire block; not just the text but the Html envelope around that text.  That envelope will probably be <code>&lt;div&gt;</code> to <code>&lt;/div&gt;</code> but there are plenty of other possible envelopes.  For a future version of my system, I plan to select the text and have a macro identify the start and end of the block containing that text.  But with the current version, you have to identify the block.</p>\n\n<p>As I have already said, you need to select the entire block and copy and paste it to column A of worksheet \u201cBody\u201d.  Note, I have only selected the block so in my example above, the first and last lines of column A are short.</p>\n\n<p>So \"Explorer.Txt\" contains properties, in a human readable format, of the email from you wish to delete a block of text.  You have copied that block including its Html envelope to column A of worksheet \"Body\".</p>\n\n<p>Run macro \u201cConvertBodyFromExplorerToVBA()\u201d</p>\n\n<p>I have left diagnostic code in this macro and <code>Debug.Assert False</code> statements so you can look at the diagnostic output to the Immediate Window.  When you have finished looking at the output, click [F5].  When the macro is finished, column B should look like:</p>\n\n<pre><code>  Text1 = \"&lt;div style=\"\"font-family:Verdana;font-size:12px;font-weig\" &amp; _\n          \"ht:400;line-height:16px;text-align:left;color:#ABABAB;\"\"&gt;\" &amp; _\n          vbCrLf &amp; Space(16) &amp; \"Zopa Limited is authorised and regu\" &amp; _\n          \"lated by the Financial Conduct Authority, and entered on\" &amp; _\n          \" the Financial Services Register (&lt;span style=\"\"color:#00\" &amp; _\n          \"B9A7;\"\"&gt;718925&lt;/span&gt;). Zopa Bank Limited is authorised b\" &amp; _\n          \"y the Prudential Regulation Authority and regulated by t\" &amp; _\n          \"he Financial Conduct Authority and the Prudential Regula\" &amp; _\n          \"tion Authority, and entered on the Financial Services Re\" &amp; _\n          \"gister (&lt;span style=\"\"color:#00B9A7;\"\"&gt;800542&lt;/span&gt;). Zop\" &amp; _\n          \"a Limited (&lt;span style=\"\"color:#00B9A7;\"\"&gt;05197592&lt;/span&gt;)\" &amp; _\n          \" and Zopa Bank Limited (&lt;span style=\"\"color:#00B9A7;\"\"&gt;106\" &amp; _\n          \"27575&lt;/span&gt;) are both incorporated in England &amp;amp; Wal\" &amp; _\n          \"es and have their registered office at: 1st Floor, Cotto\" &amp; _\n          \"ns Centre, Tooley Street, London, SE1 2QG.&lt;br&gt;\" &amp; _\n          vbCrLf &amp; Space(16) &amp; \"&lt;br&gt;\" &amp; vbCrLf &amp; Space(16) &amp; \"&amp;copy\" &amp; _\n          \"; Zopa Bank Limited 2019 All rights reserved. 'Zopa' is \" &amp; _\n          \"a trademark of Zopa Bank Limited.&lt;br&gt;\" &amp; vbCrLf &amp; _\n          Space(16) &amp; \"&lt;br&gt;\" &amp; vbCrLf &amp; Space(16) &amp; \"Zopa is a memb\" &amp; _\n          \"er of Cifas &amp;ndash; the UK&amp;rsquo;s leading anti-fraud as\" &amp; _\n          \"sociation, and we are registered with the Office of the \" &amp; _\n          \"Information Commissioner (&lt;span style=\"\"color:#00B9A7;\"\"&gt;Z\" &amp; _\n          \"A275984&lt;/span&gt;, &lt;span style=\"\"color:#00B9A7;\"\"&gt;Z8797078&lt;/s\" &amp; _\n          \"pan&gt;).&lt;br&gt;\" &amp; vbCrLf &amp; Space(16) &amp; \"&lt;br&gt;\" &amp; vbCrLf &amp; _\n          Space(16) &amp; \"No longer want to receive our emails? &lt;a\" \n  Text2 = Space(2) &amp; \"href=\"\"http://click.mail.zopa.com/?qs=df1dd45f\" &amp; _\n          \"b22f0a804e99ede07e73c95c826908dfc9aef47f93c598c0c6537648\" &amp; _\n          \"c2c346408fab877afa32022afc1a846a3060560073066676d72d0a47\" &amp; _\n          \"20039df6\"\" style=\"\"color: #ffffff; font-weight: 700; text-\" &amp; _\n          \"decoration: none;\"\"&gt;Unsubscribe&lt;/a&gt; or sign into your &lt;a\" &amp; _\n          Space(2) &amp; \"href=\"\"http://click.mail.zopa.com/?qs=df1dd45f\" &amp; _\n          \"b22f0a80c21dc52c7c6968eb3af863f9656119ff373444e56f12bbc5\" &amp; _\n          \"c50c416ecbcd8e2c0192ac31983d91b06478e0f60261102d\"\" style=\" &amp; _\n          \"\"\"color: #ffffff; font-weight: 700; text-decoration: none\" &amp; _\n          \";\"\"&gt;Zopa Account&lt;/a&gt; to change your Contact Preferences.&lt;\" &amp; _\n          \"/div&gt;\"\n</code></pre>\n\n<p>My text block is so long, the output exceeded the VBA limit of 24 continuation lines so there are two assignment statements in Column B.  You may only need one assignment statement or you may need more.</p>\n\n<p>The macro has converted the text in column A to VBA assignment statements in column B ready to be copied to your macro.</p>\n\n<p>To test the output, select all the text in column B.  Switch to the VBA Editor and find macro <code>TestConvertOutput</code>.  Paste the text from column B into the gap between <code>Dim TextToBeRemoved As String</code> and <code>TextToBeRemoved = Text1 &amp; Text2</code>.  There should be no syntax errors.  If you don\u2019t need Text2 or if you need Text3, amend the routine as necessary.  If you run macro <code>TestConvertOutput</code>, it should output the block to be deleted to the Immediate Window with any errors.</p>\n\n<p>The statements in macro <code>TestConvertOutput</code> are those you need for macro <code>mails</code>.  <code>TextToBeRemoved</code> is the value to replace \u201cNot Internal\u201d.  </p>\n"}], "owner": {"reputation": 226, "user_id": 1098363, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c3aec1119827ba8fb0cea50ce57fd62?s=128&d=identicon&r=PG", "display_name": "ahmet", "link": "https://stackoverflow.com/users/1098363/ahmet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 55026719, "answer_count": 3, "score": 0, "last_activity_date": 1609965987, "creation_date": 1551871691, "last_edit_date": 1609965987, "question_id": 55022012, "link": "https://stackoverflow.com/questions/55022012/delete-text-in-incoming-email", "title": "Delete text in incoming email", "body": "<p>I am trying to delete text in each incoming mail.</p>\n<p>My rule settings are correct but my script is false.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub mails(MyMail As MailItem)\n    Dim newMail As MailItem\n    Set newMail = Application.GetNamespace(&quot;MAPI&quot;).GetDefaultFolder(olFolderInbox).Items.GetFirst\n    newMail.HTMLBody = Replace(newMail.HTMLBody, &quot;Not Internal&quot;, &quot;&quot;)\n    newMail.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1551871654, "post_id": 55021937, "comment_id": 96797261, "body": "check the value of <code>StartCell1</code>, if you add a line <code>Debug.Print StartCell1</code> before the line of <code>Range(StartCell1).Select</code> what do you get in the immediate window ? Also what is the value of <code>BrandNumber</code>, is it larger then 2 ?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551871929, "post_id": 55021937, "comment_id": 96797438, "body": "You wont need the double quotes.  I think <code>B</code> and your number should be good in a string.  So your string will be <code>b3</code> not <code>&quot;b3&quot;</code>"}, {"owner": {"reputation": 53, "user_id": 10754715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MhtPyPX30iQ/AAAAAAAAAAI/AAAAAAAAInM/yWkXCVZS8LU/photo.jpg?sz=128", "display_name": "Thomas Gardner", "link": "https://stackoverflow.com/users/10754715/thomas-gardner"}, "edited": false, "score": 0, "creation_date": 1551872137, "post_id": 55021937, "comment_id": 96797582, "body": "Hi - Tried without the quotes didn&#39;t work, exactly the same issue and error! Thanks though  Shai Rado - Brand Number Starts at 1 (but multiplying 0 by 27 and adding 3 should be fine, right?) And apologies, being new-ish to VBA error handling. I&#39;ve tried the Debug.Print, I get the same error as it seems that it&#39;s simply jumping straight over the Debug.Print.   Also I&#39;m used to Python...where is the output console where I would see the Value?!  Thanks!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551872229, "post_id": 55021937, "comment_id": 96797631, "body": "You should avoid using select. You can try with Range objects <code>Dim CopyRange As Range</code> and then <code>Set CopyRange = Range(&quot;A1:A100&quot;)</code> for example, so you could just <code>CopyRange.Copy Destination:=Range(&quot;A101&quot;)</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551872400, "post_id": 55021937, "comment_id": 96797724, "body": "By the way, your <code>BrandNumber = 1</code> should go before the <code>StartCell1 =  </code>... Otherwise BrandNumber will be -1 and that will give you an error."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872605, "post_id": 55021937, "comment_id": 96797846, "body": "@ThomasGardner the output window is called Locals.  WHat is <code>vbDblQuote</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872741, "post_id": 55021937, "comment_id": 96797924, "body": "Your brandnumber not being set, will result in a -ve result, which translates to <code>&quot;&quot;B-24&quot;&quot;</code> using your code.  You need to get rid of the double quotes."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1551876021, "creation_date": 1551876021, "answer_id": 55023359, "question_id": 55021937, "link": "https://stackoverflow.com/questions/55021937/referencing-cell-as-variable-in-range-select/55023359#55023359", "title": "Referencing Cell as Variable in Range().Select", "body": "<pre><code>Dim StartCell  As Range\nDim BrandNumber As Integer\nBrandNumber = 1\nset StartCell = Range(\"B\" &amp; (3 + (27 * (BrandNumber - 1))))\n</code></pre>\n\n<p>Excel will convert the number returned by (3 + (...   into a string automatically. \nI've created an object variable to point to startcell so you can just copy it to a destination in one line - this would copy it to A2 for example</p>\n\n<pre><code>StartCell.Copy Range(\"a2\")   \n</code></pre>\n\n<p>Never use Select  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">How To Avoid using Select in VBA</a></p>\n"}], "owner": {"reputation": 53, "user_id": 10754715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MhtPyPX30iQ/AAAAAAAAAAI/AAAAAAAAInM/yWkXCVZS8LU/photo.jpg?sz=128", "display_name": "Thomas Gardner", "link": "https://stackoverflow.com/users/10754715/thomas-gardner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551877653, "creation_date": 1551871484, "last_edit_date": 1551877653, "question_id": 55021937, "link": "https://stackoverflow.com/questions/55021937/referencing-cell-as-variable-in-range-select", "title": "Referencing Cell as Variable in Range().Select", "body": "<p>I am copying and pasting data into blocks of cells which move down the spreadsheet in regular blocks for each brand - I am therefore trying to create a variable linked to Brand Number, but am receiving this error.</p>\n\n<p>Hopefully a simple one, hoping somebody can help!</p>\n\n<pre><code>Dim StartCell1 As String\nDim BrandNumber As Integer\nDim DblQuote As String\n\nStartCell1 = vbDblQuote + \"B\" + CStr((3 + (27 * (BrandNumber - 1)))) + vbDblQuote\n\nBrandNumber = 1\n\nRange(StartCell1).Select\n</code></pre>\n\n<blockquote>\n  <p>Run-time error '1004':<br>\n    Method 'Range' of object '_Global' failed</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "dropbox"], "comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1551877093, "post_id": 55021896, "comment_id": 96800408, "body": "Add at least a fragment of a code or anything you worked on otherwise no one will write a code from scratch just for you, people get paid to do that. That being said, you can use the &quot;MkDir&quot; function to create folders with VBA."}, {"owner": {"reputation": 11, "user_id": 11159374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908462394a3800d7119e66d868794b2e?s=128&d=identicon&r=PG&f=1", "display_name": "rajpabs", "link": "https://stackoverflow.com/users/11159374/rajpabs"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1551878877, "post_id": 55021896, "comment_id": 96801477, "body": "thanks @Rhyfelwr added it - sorry for this - this is my first post"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11159374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908462394a3800d7119e66d868794b2e?s=128&d=identicon&r=PG&f=1", "display_name": "rajpabs", "link": "https://stackoverflow.com/users/11159374/rajpabs"}, "is_accepted": true, "score": 0, "last_activity_date": 1552074371, "creation_date": 1552074371, "answer_id": 55070019, "question_id": 55021896, "link": "https://stackoverflow.com/questions/55021896/vba-macro-on-excel-to-create-a-new-folder-on-dropbox/55070019#55070019", "title": "VBA macro on excel to create a new folder on dropbox", "body": "<p>Thank you @rhyfewler !</p>\n\n<p>The function works as follows: MkDir \"c:\\TOTN\\Examples\"</p>\n"}], "owner": {"reputation": 11, "user_id": 11159374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908462394a3800d7119e66d868794b2e?s=128&d=identicon&r=PG&f=1", "display_name": "rajpabs", "link": "https://stackoverflow.com/users/11159374/rajpabs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 55070019, "answer_count": 1, "score": 0, "last_activity_date": 1552074371, "creation_date": 1551871368, "last_edit_date": 1551972012, "question_id": 55021896, "link": "https://stackoverflow.com/questions/55021896/vba-macro-on-excel-to-create-a-new-folder-on-dropbox", "title": "VBA macro on excel to create a new folder on dropbox", "body": "<p>I have a small module where I do some data entry into an excel database using a userform. </p>\n\n<p>I want to add an element to it that when I click submit, a folder on my shared dropbox drive is created with the name of the company I added to my userform.</p>\n\n<p>Note - the dropbox account is shared my 2 other users as well. The filepath would be:</p>\n\n<p>C:\\Users[user]\\nc Dropbox\\investment oportunities\\1. Companies</p>\n\n<p>Any help would be appreciated!</p>\n\n<p>Cheers! </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub Inisubmit_Click()\n\nIf Startup_Name.Value = \"\" Then\nMsgBox \"Enter Startup Name\", vbExclamation, \"Input Data\"\n    Exit Sub\nElse:\n\nDim LastRow As Long, ws As Worksheet\n\nSet ws = Sheets(\"Summary\")\n\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1 'Finds the last \nblank row\n\n'Date input\n\n ws.Range(\"A\" &amp; LastRow).Value = Format(Date, \"mm/dd/yyyy\")\n\n'Source Input\n\n If Events.Value = True Then\n    ws.Range(\"B\" &amp; LastRow).Value = Events.Caption\nElseIf Referral.Value = True Then\n    ws.Range(\"B\" &amp; LastRow).Value = Referral.Caption\nElseIf Direct.Value = True Then\n    ws.Range(\"B\" &amp; LastRow).Value = Direct.Caption\nElseIf Search.Value = True Then\n    ws.Range(\"B\" &amp; LastRow).Value = Search.Caption\nEnd If\n\n'Startup Info\nws.Range(\"AG\" &amp; LastRow).Value = sourcedetail.Value\nws.Range(\"AI\" &amp; LastRow).Value = Sector.Value\nws.Range(\"C\" &amp; LastRow).Value = Startup_Name.Value\nws.Range(\"H\" &amp; LastRow).Value = Startup_Location.Value\nws.Range(\"I\" &amp; LastRow).Value = Startup_Overview.Value\nws.Range(\"L\" &amp; LastRow).Value = funding_needed.Value\nws.Range(\"AD\" &amp; LastRow).Value = revenuebox.Value\n\n\n'Round Check\n\n If seed.Value = True Then\n    ws.Range(\"F\" &amp; LastRow).Value = seed.Caption\n ElseIf seriesa.Value = True Then\n    ws.Range(\"F\" &amp; LastRow).Value = seriesa.Caption\n ElseIf seriesb.Value = True Then\n    ws.Range(\"F\" &amp; LastRow).Value = seriesb.Caption\n ElseIf SeriesC.Value = True Then\n    ws.Range(\"F\" &amp; LastRow).Value = SeriesC.Caption\n End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>How does one add a new folder in dropbox using VBA?</strong></p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551871827, "post_id": 55021854, "comment_id": 96797366, "body": "What line is erroring?"}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551871994, "post_id": 55021854, "comment_id": 96797498, "body": "the line with: rs.Open query, con"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872094, "post_id": 55021854, "comment_id": 96797560, "body": "Have you checked <code>con.state</code> before hand.  Does the connection open ok basically?  <code>Debug.? con.state=adStateOpen</code>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1551872264, "post_id": 55021854, "comment_id": 96797654, "body": "Did you also check if the tablename resp. the syntax for the tablename is correct?"}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872752, "post_id": 55021854, "comment_id": 96797929, "body": "@Nathan_Sav with only connection i dont get any errors but i dont know if im actually connected. How to apply your code to mine correctly?"}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1551872798, "post_id": 55021854, "comment_id": 96797950, "body": "@Storax the table name from my query propably is wrong i have no clue how to import the query from pivot table and apply it in my code."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872817, "post_id": 55021854, "comment_id": 96797964, "body": "at the time of error, on the debug window, enter the code I put in comment"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551872872, "post_id": 55021854, "comment_id": 96798000, "body": "So the table name is wrong?  Check that your query is correct first.  Just try it with Excels data connections. :o)  Or in SQL Server."}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551875664, "post_id": 55021854, "comment_id": 96799631, "body": "@Nathan_Sav i added  If con.State = adStateOpen Then test = True con.Close End If MsgBox test  after connection and it says true so im connected?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551876182, "post_id": 55021854, "comment_id": 96799915, "body": "Dim rs As NEW ADODB.Recordset You can&#39;t open a recordet until it&#39;s been initialised"}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551878876, "post_id": 55021854, "comment_id": 96801476, "body": "@HarassedDad so i should move it to part after performing  the query in my code?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551879110, "post_id": 55021854, "comment_id": 96801625, "body": "No leave it where it is but add the NEW part"}, {"owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551880160, "post_id": 55021854, "comment_id": 96802242, "body": "@HarassedDad Well not sure how to edit my code now. Can you provide me with code and where is your suggestion?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1551880690, "post_id": 55021854, "comment_id": 96802585, "body": "on your third line of code add the word New between &quot;Dim rs as &quot; and &quot;ADODB.recordset&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1551881285, "post_id": 55021854, "comment_id": 96802946, "body": "@HarassedDad The initialising is done via the set statement later on <code>Set rs = New ADODB.Recordset</code>"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1551881471, "post_id": 55021854, "comment_id": 96803051, "body": "Nathan_Sav - Ahh! I actually missed that line even when I first saw your comment - word blindness I think, Thanks. Yes, the new isn&#39;t needed - no idea why I missed that - I must be going senile."}], "owner": {"reputation": 61, "user_id": 10995113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a160aa3b64c53869837967574e02bca?s=128&d=identicon&r=PG&f=1", "display_name": "Tomz", "link": "https://stackoverflow.com/users/10995113/tomz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1559136398, "creation_date": 1551871229, "last_edit_date": 1559136398, "question_id": 55021854, "link": "https://stackoverflow.com/questions/55021854/vba-sql-connection-and-query", "title": "VBA SQL Connection and Query", "body": "<p>I try to make connection with my database through VBA because using pivot table connection takes like 2 minutes (connecting and importing the data). In another job i had the vba code to connect to databse and do mdx query and it was much faster then by using excel pivot table. In this case i can't have mdx query because its not available (different database?).</p>\n\n<p>I have found the code to connect and do query. The problem is i dont get any information if im connected or not and the query part gives me error: (run time error '-2147217865 (80040e37) Automation Error).</p>\n\n<p>Here is the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SQL_Connection()\n\nDim con As ADODB.Connection\nDim rs As ADODB.Recordset\nDim query As String\nSet con = New ADODB.Connection\nSet rs = New ADODB.Recordset\nDim strCon As String\n\n'http://learnexcelmacro.com/wp/2011/11/sql-connection-string/\n\nstrCon = \"Provider=SQLOLEDB.1;Data Source=sql2\\bbqsrv;Initial Catalog=Reports;Integrated Security=SSPI\"\n\n'---  Open   the above connection string.\n\ncon.Open (strCon)\ncon.CommandTimeout = 120 'sec\n\n'---  Now connection is open and you can use queries to execute them.\n'---  It will be open till you close the connection\n\n'slq query\nquery = \"SELECT TOP 10 * FROM [Reports]\"\n\n'Performs the actual query\nrs.Open query, con\n\n'Dumps all the results from the query into cell A2 of the first sheet in the active workbook\nSheets(1).Range(\"A2\").CopyFromRecordset rs\n\nEnd Sub\n</code></pre>\n\n<p>First, can you guys help me how to check if im acutally connected and this part of code works? In excel if i check in DATA>Connections there is nothing.\nSecond, how to write simple query if i have only pivot table acces not database/sql? On this pivot i cant check the mdx query.</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "screen-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551871399, "post_id": 55021575, "comment_id": 96797113, "body": "On which line does the error occur?"}, {"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551871770, "post_id": 55021575, "comment_id": 96797329, "body": "@QHarr the error occurs on line 15 <code>numResults = arr(UBound(arr))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551872418, "post_id": 55022099, "comment_id": 96797741, "body": "By using IE you mean changing the <code>.setRequestHeader &quot;User-Agent&quot;, &quot;Mozilla&#47;5.0&quot;</code> to <code>.setRequestHeader &quot;User-Agent&quot;, &quot;internetexplorer.application&quot;</code> because I&#39;ve already tried that too :/"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551872516, "post_id": 55022099, "comment_id": 96797796, "body": "No I mean as per my edit above. You can always write the response from your original xmlhttp to a file and inspect. I don&#39;t think your value is there but I cannot test here. I am suggesting use a function like above to get the numPages using IE/Selenium then continue with xmlhttp as before assuming required data is returned in .responseText of those requests."}, {"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551873758, "post_id": 55022099, "comment_id": 96798564, "body": "I was able to get the numResults now thank you, now I just need to figure how to scrap the values into the sheet."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551874135, "post_id": 55022099, "comment_id": 96798778, "body": "you need to loop the elements with class name snize-product"}, {"owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551877486, "post_id": 55022099, "comment_id": 96800632, "body": "Yes I know that, it isn&#39;t giving me any error now and i check the value of <code>numResults</code> and it&#39;s totally correct! The only problem now it&#39;s that it isn&#39;t scraping any result to excel :/"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "edited": false, "score": 0, "creation_date": 1551877618, "post_id": 55022099, "comment_id": 96800717, "body": "post a new question but before that inspect the .responseText from xmlhttp and check the data you want is present for those classes. If not, you will need to change the function into a sub and re-write so whole thing done with ie. You can use same structure as your existing code but work with ie object instead."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1551874245, "last_edit_date": 1551874245, "creation_date": 1551871939, "answer_id": 55022099, "question_id": 55021575, "link": "https://stackoverflow.com/questions/55021575/vba-webscraping-script-returns-subscript-outof-range/55022099#55022099", "title": "VBA WebScraping Script Returns Subscript OutOf Range", "body": "<p>This</p>\n\n<pre><code>html.querySelector(\".snize-search-results-header\").innerText\n</code></pre>\n\n<p>is returning an empty string, therefore when you do split you end up with a -1 in your arr.</p>\n\n<p>It may be that this value requires javascript to run on page. Inspect the returned html. I think no value is returned for that. Use a method like selenium or IE which allows js to run on the page and update content with the value</p>\n\n<p>In this case you also need the lbound so you could use a function that returns the value which uses IE</p>\n\n<pre><code>numPages  =  GetNumberOfPages \n\nPublic Function GetNumberOfPages() As Long\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = False\n        .Navigate2 \"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim numPages As Long, numResults As Long, arr() As String\n        arr = Split(.document.querySelector(\".snize-search-results-header\").innerText, Chr$(32))\n        numResults = arr(LBound(arr))\n        GetNumberOfPages =  numResults\n        .Quit\n    End With\nEnd Function\n</code></pre>\n\n<p>For the next page you are looking at a different class name (I think)</p>\n\n<pre><code>Set data = html.getElementsByClassName(\"snize-product\")\n</code></pre>\n\n<p>Inspect the html to verify.</p>\n"}], "owner": {"reputation": 69, "user_id": 11159160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129bd5503aa006893a91ebcc00274a70?s=128&d=identicon&r=PG&f=1", "display_name": "Mig", "link": "https://stackoverflow.com/users/11159160/mig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 55022099, "answer_count": 1, "score": 4, "last_activity_date": 1551874245, "creation_date": 1551870279, "last_edit_date": 1551871178, "question_id": 55021575, "link": "https://stackoverflow.com/questions/55021575/vba-webscraping-script-returns-subscript-outof-range", "title": "VBA WebScraping Script Returns Subscript OutOf Range", "body": "<h3>Problem:</h3>\n\n<p>I've been trying to scrap data from a WebSite, but it's always giving me an error <strong>Subscript OutOf Range</strong> I don't know why, I use the exact same code for another WebSite and it works perfectly fine.</p>\n\n<p>Yes, I've changed the <code>divs</code> from the new Website I want to scrap from.</p>\n\n<p>Can anyone help me please? Thanks in advance.</p>\n\n<h3>Code:</h3>\n\n<pre><code>Option Explicit\nPublic Sub Loi\u00e7a()\n    Dim data As Object, i As Long, html As HTMLDocument, r As Long, c As Long, item As Object, div As Object\n    Set html = New HTMLDocument                  '&lt;== VBE &gt; Tools &gt; References &gt; Microsoft HTML Object Library\n\n    Const START_URL As String = \"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\"\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", START_URL, False\n        .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n        .send\n        html.body.innerHTML = .responseText\n        Dim numPages As Long, numResults As Long, arr() As String\n        arr = Split(html.querySelector(\".snize-search-results-header\").innerText, Chr$(32))\n        numResults = arr(UBound(arr))\n        numPages = 1\n\n\n        For i = 1 To numPages\n             If i &gt; 1 Then\n                .Open \"GET\", Replace$(\"https://mediamarkt.pt/pages/search-results-page?q=maquina+roupa&amp;page=1\", \"page=1\", \"page=\" &amp; i), False\n                .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n                .send\n                 html.body.innerHTML = .responseText\n            End If\n            Set data = html.getElementsByClassName(\"snize-four-columns\")\n            For Each item In data\n                r = r + 1: c = 1\n                For Each div In item.getElementsByTagName(\"div\")\n                    With ThisWorkbook.Worksheets(\"Loi\u00e7a\")\n                        .Cells(r, c) = div.innerText\n                    End With\n                    c = c + 1\n                Next\n            Next\n        Next\n    End With\n    '----------------------------------------------------------------------------------------------------------------------------------------------------------------------'\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551869777, "post_id": 55021303, "comment_id": 96796163, "body": "I recommend you using <code>Dir(Path)</code> to get the exact filename and some If to handle an error that would happen if it wasn&#39;t there. As for doing for the whole column you could use a loop to get the job done."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1551870093, "creation_date": 1551870093, "answer_id": 55021504, "question_id": 55021303, "link": "https://stackoverflow.com/questions/55021303/insert-images-from-directory-using-excel/55021504#55021504", "title": "Insert images from Directory using Excel", "body": "<p>Maybe you are after this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim myPict As Picture\nDim PictureLoc As String\n\n    On Error GoTo EH\n    Application.EnableEvents = False\n    If Target.Column = 1 Then\n\n        'Pictures.Delete\n\n        PictureLoc = \"\\\\ca-sbs-01\\t\\Shared\\ExcelImages\\\" &amp; Target.Value2 &amp; \".jpg\"\n\n\n        With Target.Offset(, 1)\n            Set myPict = ActiveSheet.Pictures.Insert(PictureLoc)\n            .RowHeight = myPict.Height\n            myPict.Top = .Top\n            myPict.Left = .Left\n            myPict.Placement = xlMoveAndSize\n        End With\n\n    End If\nEH:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9835217, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Fabio", "link": "https://stackoverflow.com/users/9835217/fabio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 55021504, "answer_count": 1, "score": 0, "last_activity_date": 1551870790, "creation_date": 1551869535, "last_edit_date": 1551870790, "question_id": 55021303, "link": "https://stackoverflow.com/questions/55021303/insert-images-from-directory-using-excel", "title": "Insert images from Directory using Excel", "body": "<p>I want to insert images from a folder based on what is written in a cell</p>\n\n<p>Example</p>\n\n<p>Cell A1 has the word \"ABC001\"</p>\n\n<p>I want cell B1 to insert the image from a directory - image name = \"ABC001.JPG\"</p>\n\n<p>I have found some VBA code that does this for me, but this only works on one cell.\ni would like it to work on the entire column</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim myPict As Picture\nDim PictureLoc As String\n\nIf Target.Address = Range(\"A2\").Address Then\n\nActiveSheet.Pictures.Delete\n\nPictureLoc = \"\\\\ca-sbs-01\\t\\Shared\\ExcelImages\\\" &amp; Range(\"A2\").Value &amp; \".jpg\"\n\nWith Range(\"B2\")\n    Set myPict = ActiveSheet.Pictures.Insert(PictureLoc)\n    RowHeight = myPict.Height\n\n    myPict.Top = .Top\n    myPict.Left = .Left\n    myPict.Placement = xlMoveAndSize\nEnd With\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "string", "data-manipulation", "coreldraw"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1551869597, "post_id": 55021269, "comment_id": 96796065, "body": "<code>CreateRGBColor(&quot; &amp; R &amp; &quot;, &quot; &amp; G &amp; &quot;, &quot; &amp; B &amp; &quot;, &quot; &amp; &quot;)</code> should be <code>CreateRGBColor(R,  G,  B)</code> variables on VBA are supposed to be like the number, so you would do as if they were numbers"}, {"owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551877573, "post_id": 55021269, "comment_id": 96800687, "body": "Doh!!! told you i was being stupid Thanks for the save"}], "owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551869436, "creation_date": 1551869436, "question_id": 55021269, "link": "https://stackoverflow.com/questions/55021269/coreldraw-vba-adding-strings-together-in-color-assignment", "title": "Coreldraw VBA adding strings together in color assignment", "body": "<p>Im sure im doing something stupid here but I cant get the following to work. I Have the following line of code</p>\n\n<pre><code>ActiveSelectionRange.ApplyCustomHatchFill ANG.value, LS.value, 0, 10, 0, LT.value, CreateRGBColor(255,255,255), Style:=OutlineStyles(TextBox5.value), DashDotLength:=(TextBox6.value), PenWidth:=(TextBox7.value), BackColor:=CreateRGBColor(255, 255, 255)\n</code></pre>\n\n<p>I am trying to replace the following part with variables</p>\n\n<pre><code>CreateRGBColor(255,255,255)\n</code></pre>\n\n<p>with the following</p>\n\n<pre><code> a = colbut.BackColor\n R = a Mod 256\n G = Int(a / 256) Mod 256\n B = Int(a / 256 / 256) Mod 256\n\nActiveSelectionRange.ApplyCustomHatchFill ANG.value, LS.value, 0, 10, 0, LT.value, CreateRGBColor(\" &amp; R &amp; \", \" &amp; G &amp; \", \" &amp; B &amp; \", \" &amp; \"), Style:=OutlineStyles(TextBox5.value), DashDotLength:=(TextBox6.value), PenWidth:=(TextBox7.value), BackColor:=CreateRGBColor(255, 255, 255)\n</code></pre>\n\n<p>It keeps throwing the error \"Wrong number of arguments or invalid property assignment\"</p>\n\n<p>I have tried all variations of adding the strings but to no avail</p>\n\n<p>Any help is greatly appreciated\nMark</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551870332, "post_id": 55020704, "comment_id": 96796487, "body": "When you say <code>it doesn&#39;t meet the output I need</code>, what is it that you get?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551870810, "post_id": 55020704, "comment_id": 96796781, "body": "I have edited the question and included the current output of the code. It only assigned persons until task seven. Which should be the same on the expected output above."}, {"owner": {"reputation": 61, "user_id": 6924140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d5f6915e65b21c262609e5157ff47?s=128&d=identicon&r=PG&f=1", "display_name": "AjCorneel", "link": "https://stackoverflow.com/users/6924140/ajcorneel"}, "edited": false, "score": 0, "creation_date": 1551872102, "post_id": 55020704, "comment_id": 96797563, "body": "The problem seems to be that for the second person the &#39;For each cl in rng&#39; loop starts at 1 again"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6924140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d5f6915e65b21c262609e5157ff47?s=128&d=identicon&r=PG&f=1", "display_name": "AjCorneel", "link": "https://stackoverflow.com/users/6924140/ajcorneel"}, "is_accepted": false, "score": 0, "last_activity_date": 1551885121, "creation_date": 1551885121, "answer_id": 55026334, "question_id": 55020704, "link": "https://stackoverflow.com/questions/55020704/assign-person-to-defined-percentage-of-rows/55026334#55026334", "title": "Assign person to defined percentage of rows", "body": "<p>If you swap to looping through the task assignments and checking whether enough tasks have been assigned yet, it might be easier to make it work. The below code does the job for me.</p>\n\n<pre><code>\nDim PersonFirstRow As Integer\nDim PersonLastRow As Long\nDim PersonRow As Long\n\n\nSet mainsheet = Sheets(\"Main\")\nSet todaysheet = Sheets(\"New\")\n\nDim LastRow As Long, LastColumn As Long\n\nDim StartCell As Range, rng As Range\n\nDim Percentage As Long, i As Long\nDim PersonPercent As Long\nDim TaskRow, AssignedTasks As Long\nSet StartCell = todaysheet.Range(\"B2\")\n\nPersonFirstRow = 10 'row of F12\n\nPersonLastRow = mainsheet.Cells(mainsheet.Rows.Count, \"E\").End(xlUp).Row\n\nLastRow = todaysheet.Cells(todaysheet.Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = todaysheet.Cells(StartCell.Row, todaysheet.Columns.Count).End(xlToLeft).Column\n\nSet rng = todaysheet.Range(StartCell, todaysheet.Cells(LastRow, 2))\n\n\nFor TaskRow = 2 To LastRow\n\n    For PersonRow = 10 To PersonLastRow\n        PersonPercent = mainsheet.Cells(PersonRow, \"F\").Value\n        Percentage = Round(rng.Rows.Count * PersonPercent / 100, 0)\n        AssignedTasks = Application.WorksheetFunction.CountIf(rng.Offset(0, -1), mainsheet.Cells(PersonRow, 5).Value)\n\n        If AssignedTasks + 1 &lt;= Percentage Then\n            If Trim(todaysheet.Cells(TaskRow, 1).Value) = \"\" Then\n                todaysheet.Cells(TaskRow, 1).Value = mainsheet.Cells(PersonRow, \"E\").Value\n            End If\n        End If\n\n    Next PersonRow\n\nNext TaskRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551885121, "creation_date": 1551867636, "last_edit_date": 1592644375, "question_id": 55020704, "link": "https://stackoverflow.com/questions/55020704/assign-person-to-defined-percentage-of-rows", "title": "Assign person to defined percentage of rows", "body": "<p>I'm currently creating a distribution tool in order to distribute person to tasks based on the defined percentage for each person. Below is the sample data for the assignee and with their respective distribution percentage which can be found in my &quot;Main Sheet&quot;. The assignee can grow as long as the total of the distribution will be 100%.</p>\n<pre><code> |---------------------|--------------------------------|\n |      Assignee       |     Distribution Percentage    |\n |---------------------|--------------------------------|\n |          Person1    |         25                     |\n |---------------------|--------------------------------|\n |          Person2    |         30                     |\n |---------------------|--------------------------------|\n |          Person2    |         45                     |\n |---------------------|--------------------------------|\n</code></pre>\n<p>In another sheet called &quot;New&quot; I have a list of tasks which needs to be assigned to the person according to its defined percentage. And Sometimes, there is already an assigned person, in this case, to skip assigning to that task.</p>\n<p>Below also shows the list of tasks and expected output (person assigned) based on the defined percentage for the distribution. The tasks can also grow:</p>\n<pre><code>|---------------------|--------------------------------|\n|      Assignee       |           Tasks                |\n|---------------------|--------------------------------|\n|          Person1    |         Task 1                 |\n|---------------------|--------------------------------|\n|          Person1    |         Task 2                 |\n|---------------------|--------------------------------|\n|          Person1    |         Task 3                 |\n|---------------------|--------------------------------|\n|          Person1    |         Task 4                 |\n|---------------------|--------------------------------|\n|          Person2    |         Task 5                 |\n|---------------------|--------------------------------|\n|          Person2    |         Task 6                 |\n|---------------------|--------------------------------|\n|          Person2    |         Task 7                 |\n|---------------------|--------------------------------|\n|          Person2    |         Task 8                 |\n|---------------------|--------------------------------|\n|          Person3    |         Task 9                 |\n|---------------------|--------------------------------|\n|          Person3    |         Task 10                |\n|---------------------|--------------------------------|\n|          Person3    |         Task 11                |\n|---------------------|--------------------------------|\n|          Person3    |         Task 12                |\n|---------------------|--------------------------------|\n|          Person3    |         Task 13                |\n|---------------------|--------------------------------|\n|          Person3    |         Task 14                |\n|---------------------|--------------------------------|\n|          Person3    |         Task 15                |\n|---------------------|--------------------------------|\n</code></pre>\n<p>In this case, below are the distribution:</p>\n<blockquote>\n<p>Person1 - 4 Tasks (25%)</p>\n<p>Person2 - 4 Tasks (30%)</p>\n<p>Person3 - 7 Tasks (45%)</p>\n</blockquote>\n<p>Below is working code that I have. However, it doesn't meet the output I need. And I'm getting stuck on how to proceed:</p>\n<pre><code>Sub AssignPercentage()\n\nDim PersonFirstRow As Integer\nDim PersonLastRow As Long\nDim PersonRow As Long\n\n\nSet mainSheet = Sheets(&quot;Main&quot;)\nSet TodaySheet = Sheets(&quot;New&quot;)\n\nDim LastRow As Long, LastColumn As Long\n\nDim StartCell As Range, rng As Range\nDim x As Long\nDim cl As Range\n\nDim Percentage As Long, i As Long\nDim PersonPercent As Long\nSet StartCell = TodaySheet.Range(&quot;B2&quot;)\n\nPersonFirstRow = 10 'row of F12\n\nPersonLastRow = mainSheet.Cells(mainSheet.Rows.Count, &quot;E&quot;).End(xlUp).Row\n\nLastRow = TodaySheet.Cells(TodaySheet.Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = TodaySheet.Cells(StartCell.Row, TodaySheet.Columns.Count).End(xlToLeft).Column\n\nSet rng = TodaySheet.Range(StartCell, TodaySheet.Cells(LastRow, 2))\n\n\nFor x = PersonFirstRow To PersonLastRow\n\nPersonPercent = mainSheet.Cells(x, &quot;F&quot;).Value\n\n\nPercentage = Round(rng.Rows.Count * PersonPercent / 100, 0)\n\n    For Each cl In rng\n\n        i = i + 1\n        If i &gt; Percentage Then\n        i = 0\n        Exit For\n\n        End If\n        \n        \n        If Trim(cl.Offset(0, -1).Value) = &quot;&quot; Then\n        \n            cl.Offset(0, -1).Value = mainSheet.Cells(x, &quot;E&quot;).Value\n        \n        End If\n        \n    Next cl\n    \nNext x\n\nEnd Sub\n</code></pre>\n<p>The output of the code above is below, which is not correct:</p>\n<pre><code>|---------------------|--------------------------------|\n|      Assignee       |           Tasks                |\n|---------------------|--------------------------------|\n|          Person1    |         Task 1                 |\n|---------------------|--------------------------------|\n|          Person1    |         Task 2                 |\n|---------------------|--------------------------------|\n|          Person1    |         Task 3                 |\n|---------------------|--------------------------------|\n|          Person1    |         Task 4                 |\n|---------------------|--------------------------------|\n|          Person3    |         Task 5                 |\n|---------------------|--------------------------------|\n|          Person3    |         Task 6                 |\n|---------------------|--------------------------------|\n|          Person3    |         Task 7                 |\n|---------------------|--------------------------------|\n|                     |         Task 8                 |\n|---------------------|--------------------------------|\n|                     |         Task 9                 |\n|---------------------|--------------------------------|\n|                     |         Task 10                |\n|---------------------|--------------------------------|\n|                     |         Task 11                |\n|---------------------|--------------------------------|\n|                     |         Task 12                |\n|---------------------|--------------------------------|\n|                     |         Task 13                |\n|---------------------|--------------------------------|\n|                     |         Task 14                |\n|---------------------|--------------------------------|\n|                     |         Task 15                |\n|---------------------|--------------------------------|\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "is_accepted": false, "score": 0, "last_activity_date": 1551898845, "creation_date": 1551898845, "answer_id": 55030391, "question_id": 55020644, "link": "https://stackoverflow.com/questions/55020644/protect-datasheet-with-regard-to-cell-fomat-border/55030391#55030391", "title": "Protect Datasheet with regard to cell fomat/border", "body": "<p>If I understand you correctly, then there is a way.</p>\n\n<p>Step 1) Select the cells you want the user to be able to fill data into and then format those cells such that they have an UNCHECKED \"Locked\" property.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AfoSh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AfoSh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 2) Right click the worksheet's tab and select \"Protect Sheet...\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/d7hnL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d7hnL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 3) Make sure \"Select unlocked cells\" is checked and \"Format cells\" is UNCHECKED. Here's how that might look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VQB0x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VQB0x.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now your worksheet should be locked, yet users can still enter data into the cells you \"unlocked\" in step 1. But they cannot change the fill or border situation of any cells in the worksheet, because they cannot format any cells in the worksheet.</p>\n"}], "owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551898845, "creation_date": 1551867460, "question_id": 55020644, "link": "https://stackoverflow.com/questions/55020644/protect-datasheet-with-regard-to-cell-fomat-border", "title": "Protect Datasheet with regard to cell fomat/border", "body": "<p>Hello Excle'rs and Vba'ers,</p>\n\n<p>I'd like to know if it's possible to set certain limitations protecting the excel datasheet with an password. My protected excel sheet has a certain \"unprotected\" range of cells, where the user can fill in data. </p>\n\n<p>Unfortunately I want to limitate the user to only fill in data, BUT NOT change the background color or border size of those cells. Is this possible? Maybe with some VBA code? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551867914, "post_id": 55020495, "comment_id": 96794982, "body": "It is unclear what you mean by <i>&quot;I want to make the exported selection in the sheets bigger in the PDF file&quot;</i> \u2022 The <code>ExportAsFixedFormat</code> function will always export to PDF as it is in your sheet. So if you make it bigger in your sheet, then it will probably export it bigger."}, {"owner": {"reputation": 5, "user_id": 11158666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FWUAOsK2bg0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfE-7GErPR8hvVdW5Dkp4ZYWq0HNA/mo/photo.jpg?sz=128", "display_name": "Sonofliberty11", "link": "https://stackoverflow.com/users/11158666/sonofliberty11"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551868356, "post_id": 55020495, "comment_id": 96795293, "body": "Thank you for your response, so far i can hardly make it bigger in my sheet without redoing the code, and i would prefer to keep things as they are in the sheets,"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551868778, "post_id": 55020495, "comment_id": 96795534, "body": "Could be a quick solution for your issue: Copy sheet, adjust size in the copy, export it, delete copy."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11158666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FWUAOsK2bg0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfE-7GErPR8hvVdW5Dkp4ZYWq0HNA/mo/photo.jpg?sz=128", "display_name": "Sonofliberty11", "link": "https://stackoverflow.com/users/11158666/sonofliberty11"}, "edited": false, "score": 0, "creation_date": 1551879909, "post_id": 55023452, "comment_id": 96802098, "body": "Thank you a lot that was helpfull"}], "tags": [], "owner": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "is_accepted": true, "score": 1, "last_activity_date": 1551876293, "creation_date": 1551876293, "answer_id": 55023452, "question_id": 55020495, "link": "https://stackoverflow.com/questions/55020495/export-sheets-to-pdf-through-vba-and-enlarge-them/55023452#55023452", "title": "Export sheets to PDF through VBA and enlarge them", "body": "<p>If you simply want to zoom in by a fix %, use the following command before the export line</p>\n\n<pre><code>wsA.PageSetup.Zoom = 150 \n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11158666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FWUAOsK2bg0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfE-7GErPR8hvVdW5Dkp4ZYWq0HNA/mo/photo.jpg?sz=128", "display_name": "Sonofliberty11", "link": "https://stackoverflow.com/users/11158666/sonofliberty11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "accepted_answer_id": 55023452, "answer_count": 1, "score": 0, "last_activity_date": 1551876293, "creation_date": 1551867060, "last_edit_date": 1551867680, "question_id": 55020495, "link": "https://stackoverflow.com/questions/55020495/export-sheets-to-pdf-through-vba-and-enlarge-them", "title": "Export sheets to PDF through VBA and enlarge them", "body": "<p>I already have a code that do the exporting to PDF, it exports the selected sheets but I want to make the exported selection in the sheets bigger in the PDF file, to help the printing phase later.</p>\n\n<p>Here's the code that do the exporting:</p>\n\n<pre><code>Sub PDFActiveSheet()\n    Dim wsA As Worksheet\n    Dim wbA As Workbook\n    Dim strTime As String\n    Dim strName As String\n    Dim strPath As String\n    Dim strFile As String\n    Dim strPathFile As String\n    Dim myFile As Variant\n    On Error GoTo errHandler\n\n    Set wbA = ActiveWorkbook\n    Set wsA = ActiveSheet\n    strTime = Format(Now(), \"yyyymmdd\\_hhmm\")\n\n    strPath = wbA.Path\n    If strPath = \"\" Then\n      strPath = Application.DefaultFilePath\n    End If\n    strPath = strPath &amp; \"\\\"\n\n    strName = Replace(wsA.Name, \" \", \"\")\n    strName = Replace(strName, \".\", \"_\")\n\n    strFile = strName &amp; \"_\" &amp; strTime &amp; \".pdf\"\n    strPathFile = strPath &amp; strFile\n\n    myFile = Application.GetSaveAsFilename _\n        (InitialFileName:=strPathFile, _\n            FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n            Title:=\"Select Folder and FileName to save\")\n\n    If myFile &lt;&gt; \"False\" Then\n        wsA.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=myFile, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False\n\n        MsgBox \"Les QrCodes ont \u00e9t\u00e9 exporter dans le fichier PDF\" _\n          &amp; vbCrLf _\n          &amp; myFile\n    End If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Erreur lors de l'exportation\"\n    Resume exitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551867265, "post_id": 55020423, "comment_id": 96794546, "body": "What have you tried so far?"}, {"owner": {"reputation": 31, "user_id": 7940005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55dba1a1af627e2a2719fecd8f3ada3c?s=128&d=identicon&r=PG&f=1", "display_name": "yobab77", "link": "https://stackoverflow.com/users/7940005/yobab77"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551867477, "post_id": 55020423, "comment_id": 96794685, "body": "tried using this =TRANSPOSE(A1:G6) but it wont show output/ tried using transpose(range) but it does not work"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551867597, "post_id": 55020423, "comment_id": 96794760, "body": "@yobab77 What you ask for cannot be done with a built-in function or formula. Instead you will need to write your own VBA code to perform each step. \u2022 Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 666314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eaf7e4fbd7eaea8fdafa1205449b73b?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/666314/samantha"}, "is_accepted": true, "score": 2, "last_activity_date": 1551879913, "creation_date": 1551879913, "answer_id": 55024592, "question_id": 55020423, "link": "https://stackoverflow.com/questions/55020423/customize-transposing-data/55024592#55024592", "title": "Customize Transposing data", "body": "<p>I've done something similar before using the built in formula OFFSET. Create the row and column headings as shown in red below. Then enter the three formulae as show below in the first day column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/E8GmG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E8GmG.jpg\" alt=\"screenshot\"></a></p>\n\n<p>drag those three formulae and the day numbering across as far as you need.</p>\n\n<p>As some comments have said, you'll get more and better answers if you provide details of what you've tried already and show that you've made an effort before asking the internet. For instance I might have taken the time to explain a little about how OFFSET works and how I figured out what values to give it. As it is... look it up :)</p>\n"}], "owner": {"reputation": 31, "user_id": 7940005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55dba1a1af627e2a2719fecd8f3ada3c?s=128&d=identicon&r=PG&f=1", "display_name": "yobab77", "link": "https://stackoverflow.com/users/7940005/yobab77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55024592, "answer_count": 1, "score": 0, "last_activity_date": 1551948683, "creation_date": 1551866849, "last_edit_date": 1551948683, "question_id": 55020423, "link": "https://stackoverflow.com/questions/55020423/customize-transposing-data", "title": "Customize Transposing data", "body": "<p>I would like to transpose data to another table so that this table 1 would be transposed. Please see table below.</p>\n\n<p>from this <strong>table 1</strong></p>\n\n<pre><code>                day 1           day 2           day 3           day 4   \n                value   %       value   %       value   %       value   %\ninformation 1   5694    59.72%  5694    59.72%  5694    59.72%  5678  59.55%\n</code></pre>\n\n<p>to this <strong>table 2</strong>         </p>\n\n<pre><code>information 1                               \n                day 1   day 2   day 3   day 4               \nvalue           5694    5694    5694    5678                \n%               59.72%  59.72%  59.72%  59.55%              \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551865540, "post_id": 55019899, "comment_id": 96793446, "body": "Just add this to your code <code>wb.Sheets(1).Cells.Value = wb.sheets(1).Cells.Value</code> before the <code>SaveAs</code>"}, {"owner": {"reputation": 793, "user_id": 8044579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yH2vnq9M1WM/AAAAAAAAAAI/AAAAAAAAAh0/WCUqKzwOvls/photo.jpg?sz=128", "display_name": "Vipluv", "link": "https://stackoverflow.com/users/8044579/vipluv"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551865887, "post_id": 55019899, "comment_id": 96793646, "body": "I get a runtime error saying &#39;Out of memory&#39;. Did i understand right -- its the same values on both sides of the = ?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1551866251, "post_id": 55019899, "comment_id": 96793895, "body": "Then do this <code>wb.sheets(1).UsedRange.Value = wb.Sheets(1).UsedRange.Value</code>"}, {"owner": {"reputation": 793, "user_id": 8044579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yH2vnq9M1WM/AAAAAAAAAAI/AAAAAAAAAh0/WCUqKzwOvls/photo.jpg?sz=128", "display_name": "Vipluv", "link": "https://stackoverflow.com/users/8044579/vipluv"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551866884, "post_id": 55019899, "comment_id": 96794287, "body": "That allows me save the file - as values - but what about the name of a date object to convert it to a string ?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1551867591, "post_id": 55019899, "comment_id": 96794753, "body": "That part would be <code>wb.SaveAs Format(Range(&quot;D3&quot;).Value, &quot;ddmmyyyy&quot;) &amp;  &quot; &quot; &amp; Range(&quot;D4&quot;).Value &amp; &quot;.xlsx&quot;</code>"}, {"owner": {"reputation": 793, "user_id": 8044579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yH2vnq9M1WM/AAAAAAAAAAI/AAAAAAAAAh0/WCUqKzwOvls/photo.jpg?sz=128", "display_name": "Vipluv", "link": "https://stackoverflow.com/users/8044579/vipluv"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551867843, "post_id": 55019899, "comment_id": 96794923, "body": "Thats great - all solved. I would give you &#39;Accepted&#39; - but its all in the comments :)"}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1551868035, "creation_date": 1551868035, "answer_id": 55020841, "question_id": 55019899, "link": "https://stackoverflow.com/questions/55019899/copy-a-worksheet-as-new-file-with-all-cells-as-numbers-instead-of-formulae/55020841#55020841", "title": "Copy a worksheet as new file with all cells as numbers instead of formulae", "body": "<p>Here:</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Add\nWith wb\n    ThisWorkbook.Sheets(\"Format\").Copy Before:=.Sheets(1)\n    .Sheets(1).UsedRange.Value = .Sheets(1).UsedRange.Value\n    .SaveAs Format(.Sheets(1).Range(\"D3\").Value, \"ddmmyyyy\") &amp; \" \" &amp; .Sheets(1).Range(\"D4\").Value &amp; \".xlsx\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 793, "user_id": 8044579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yH2vnq9M1WM/AAAAAAAAAAI/AAAAAAAAAh0/WCUqKzwOvls/photo.jpg?sz=128", "display_name": "Vipluv", "link": "https://stackoverflow.com/users/8044579/vipluv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 55020841, "answer_count": 1, "score": 0, "last_activity_date": 1551868035, "creation_date": 1551865375, "last_edit_date": 1551867331, "question_id": 55019899, "link": "https://stackoverflow.com/questions/55019899/copy-a-worksheet-as-new-file-with-all-cells-as-numbers-instead-of-formulae", "title": "Copy a worksheet as new file with all cells as numbers instead of formulae", "body": "<p>I have a worksheet 'Form' that is populated with many cells with formulae based on Data in Worksheet 'Data' in the same workbook 'Master. After running a macro I want to save 'Form' as a new file such that, the cells all have values rather than  formulae, i.e they shouldn't depend on any sheet in 'Master'. </p>\n\n<p>Secondly the name should be a string concatenated of contents in cell D3 and Cell D4 of the worksheet 'Form', but whereas cell D4 is a string, cell D3 is a date. I want to convert this date to <code>ddmmyyyy</code> format. The name of the file should be String Concatenate (D3,D4) -> \n<code>ddmmyyy XXXXXX.xlsx</code></p>\n\n<p>I have done this so far - but the cells in new file Format.xlsx are formulae rather than values and I dont know how to change the name to composed of the contents of two cells</p>\n\n<p>D3 contains a date - 7/3/2019 and D4 contains a String - \"XXXX\"</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Add\nThisWorkbook.Sheets(\"Format\").Copy Before:=wb.Sheets(1)\nwb.SaveAs Range(\"D3\").Value &amp; Range(\"D4\").Value &amp; \".xlsx\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11156693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c391507982be54bfc7f4897ed5df3e76?s=128&d=identicon&r=PG&f=1", "display_name": "JossephA", "link": "https://stackoverflow.com/users/11156693/jossepha"}, "edited": false, "score": 0, "creation_date": 1551972611, "post_id": 55020044, "comment_id": 96845033, "body": "Does not work, i tried exactly what you suggested i can send you the file and try it on you. Thank you"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1, "user_id": 11156693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c391507982be54bfc7f4897ed5df3e76?s=128&d=identicon&r=PG&f=1", "display_name": "JossephA", "link": "https://stackoverflow.com/users/11156693/jossepha"}, "edited": false, "score": 0, "creation_date": 1551976327, "post_id": 55020044, "comment_id": 96847382, "body": "forstackoverflowexamples@gmail.com"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1551865772, "creation_date": 1551865772, "answer_id": 55020044, "question_id": 55019735, "link": "https://stackoverflow.com/questions/55019735/execute-macro-commands-in-csv-files-or-create-a-macro-that-transforms-the-file-i/55020044#55020044", "title": "Execute macro commands in csv files or create a macro that transforms the file into csv", "body": "<p>The Csv will have the <code>0</code>. You can check that by opening it in notepad. If you double click on the CSV and open it in Excel then the <code>0s</code> will disappear.</p>\n\n<p>To preserve the <code>0s</code>, you will have to import the data directly in Excel. Follow the steps mentioned below.</p>\n\n<ol>\n<li>Click on Data Tab | From Text</li>\n<li>Select the Csv from the file slection dialog box</li>\n<li>In text Import Wizard (STEP 1), select 'Delimited' and hit next. </li>\n<li>In text Import Wizard (STEP 2), select 'Comma' and hit next.</li>\n<li>In text Import Wizard (STEP 3), select all columns and click on 'text' in the 'column data format'</li>\n<li>Click finish</li>\n<li>Select the cell where you want to import the data and click 'ok'</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 11156693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c391507982be54bfc7f4897ed5df3e76?s=128&d=identicon&r=PG&f=1", "display_name": "JossephA", "link": "https://stackoverflow.com/users/11156693/jossepha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551865772, "creation_date": 1551864839, "last_edit_date": 1551865129, "question_id": 55019735, "link": "https://stackoverflow.com/questions/55019735/execute-macro-commands-in-csv-files-or-create-a-macro-that-transforms-the-file-i", "title": "Execute macro commands in csv files or create a macro that transforms the file into csv", "body": "<p>I have a file with a table of info and information about the entry. In the table I have columns, one column in the table is the social security number, the ID number in my country is 9 digits. Often the ID number begins with a 0 - digit number. The Excel always omits the number 0, I wrote a macro code that adds 0. But I end up converting the file to CSV, after converting it again omits the number 0. I want to know how I execute my macro code in CSV (which disappeared 0 - I will be happy to set up the macro on csv files or at least execute a macro that converts the file into a .csv file and saves the 0 that disappear. Here is my command that works on xslm:</p>\n\n<pre><code>Sub Add_Zeros()\n    Selection.NumberFormat = \"@\"\n    For Each CL In Selection.Cells\n        If CL &lt;&gt; \"\" Then CL.Value = Application.Rept(\"0\", (9 - Len(CL))) &amp; CL\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551865093, "post_id": 55019718, "comment_id": 96793201, "body": "Do you have some code for us to advise on?"}, {"owner": {"reputation": 1998, "user_id": 5914654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b97f9c0f12c8ab7f33a1abeef2d68e2?s=128&d=identicon&r=PG&f=1", "display_name": "vincrichaud", "link": "https://stackoverflow.com/users/5914654/vincrichaud"}, "edited": false, "score": 1, "creation_date": 1551865116, "post_id": 55019718, "comment_id": 96793213, "body": "what have you tried so far ?"}, {"owner": {"reputation": 1, "user_id": 9170669, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6X8MTPOQ4I4/AAAAAAAAAAI/AAAAAAAAlhw/oQ-2z13eTk0/photo.jpg?sz=128", "display_name": "Jitendra Bari", "link": "https://stackoverflow.com/users/9170669/jitendra-bari"}, "reply_to_user": {"reputation": 1998, "user_id": 5914654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b97f9c0f12c8ab7f33a1abeef2d68e2?s=128&d=identicon&r=PG&f=1", "display_name": "vincrichaud", "link": "https://stackoverflow.com/users/5914654/vincrichaud"}, "edited": false, "score": 0, "creation_date": 1551873362, "post_id": 55019718, "comment_id": 96798305, "body": "@vincrichaud I have multiple PDF Pages like (500 to 1000 nos), I want to give print all of them. but singles should be print individual pages, Doubles should be print with both side print on one page only and triples should be print individually. so when i take print all pages not arrangement properly and for that i ask help to get rid of paper waste. extremely thankful if get solve this. Please see image how i take them."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9170669, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6X8MTPOQ4I4/AAAAAAAAAAI/AAAAAAAAlhw/oQ-2z13eTk0/photo.jpg?sz=128", "display_name": "Jitendra Bari", "link": "https://stackoverflow.com/users/9170669/jitendra-bari"}, "edited": false, "score": 0, "creation_date": 1551975521, "post_id": 55019878, "comment_id": 96846896, "body": "Thanxx @Nathan_Sav for clarification , As mention in question i want to write in excel Singles - (2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 ,17 , 18 , 19 , 20 ,26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40)  Doubles - (10 - 11 ,15 - 16 , 21 - 22 )  Triples - (12 - 14 ,23 - 25 )"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1551865315, "creation_date": 1551865315, "answer_id": 55019878, "question_id": 55019718, "link": "https://stackoverflow.com/questions/55019718/segregate-parts-a-string-based-on-condition/55019878#55019878", "title": "Segregate parts a string based on condition", "body": "<pre><code>Sub x()\n\nDim s As String\nDim a() As String\nDim a2() As String\nDim v As Variant\nDim colSingles As New Collection\nDim colDoubles As New Collection\nDim colTriples As New Collection\n\ns = \"2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 - 11 , 12 - 14 , 15 - 16 , 17 , 18 , 19 , 20 , 21 - 22 , 23 - 25 , 26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40\"\na = Split(s, \",\")\n\nFor Each v In a\n\n    If InStr(1, v, \"-\") = 0 Then\n        colSingles.Add v, CStr(v)\n    Else\n        a2 = Split(v, \"-\")\n        If a2(1) - a2(0) = 1 Then\n            colDoubles.Add v, CStr(v)\n        Else\n            colTriples.Add v, CStr(v)\n        End If\n    End If\n\nNext v\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9170669, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6X8MTPOQ4I4/AAAAAAAAAAI/AAAAAAAAlhw/oQ-2z13eTk0/photo.jpg?sz=128", "display_name": "Jitendra Bari", "link": "https://stackoverflow.com/users/9170669/jitendra-bari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 1, "accepted_answer_id": 55019878, "answer_count": 1, "score": -4, "last_activity_date": 1551865315, "creation_date": 1551864748, "last_edit_date": 1551864937, "question_id": 55019718, "link": "https://stackoverflow.com/questions/55019718/segregate-parts-a-string-based-on-condition", "title": "Segregate parts a string based on condition", "body": "<p>I want to segregate singles, doubles and triples from a string.</p>\n\n<p>e.g. (2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 - 11 , 12 - 14 , 15 - 16 , 17 , 18 , 19 , 20 , 21 - 22 , 23 - 25 , 26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40) </p>\n\n<p>Result should be</p>\n\n<p><strong>Singles</strong> - (2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 ,17 , 18 , 19 , 20 ,26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40)</p>\n\n<p><strong>Doubles</strong> - (10 - 11 ,15 - 16 , 21 - 22 )</p>\n\n<p><strong>Triples</strong> - (12 - 14 ,23 - 25 )</p>\n"}, {"tags": ["sql-server", "excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "edited": false, "score": 0, "creation_date": 1551864649, "post_id": 55019575, "comment_id": 96792927, "body": "AFAIR  &quot;Automation error&quot; - indicates problems on stage of creating COM-object. So your connection string itself maybe OK. Problem could be in registred/not-registred OLEDB-providers"}, {"owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 0, "creation_date": 1551873626, "post_id": 55019575, "comment_id": 96798482, "body": "To  connection with Windows authentication, add &quot;;Integrated Security=SSPI&quot;  to the connection string so the current Windows account is used. No need to specify a user/password. You mentioned servername has a comma - do you mean the a comma followed by a port number?"}, {"owner": {"reputation": 285, "user_id": 5561534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5aegyhU-0Po/AAAAAAAAAAI/AAAAAAAAAF0/iYNsoSN7V3k/photo.jpg?sz=128", "display_name": "FunnyO", "link": "https://stackoverflow.com/users/5561534/funnyo"}, "edited": false, "score": 0, "creation_date": 1551884526, "post_id": 55019575, "comment_id": 96805015, "body": "Ok I understand. I&#39;m going to look into the OLEDB-Providers, and I added the Integrated Security=SSPI. Still not working though  The Server Name is something like a whole number itself. Ist like this: &quot;asdf15789,456&quot; So yes, ist a Number and a certain port"}, {"owner": {"reputation": 285, "user_id": 5561534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5aegyhU-0Po/AAAAAAAAAAI/AAAAAAAAAF0/iYNsoSN7V3k/photo.jpg?sz=128", "display_name": "FunnyO", "link": "https://stackoverflow.com/users/5561534/funnyo"}, "edited": false, "score": 0, "creation_date": 1551884887, "post_id": 55019575, "comment_id": 96805260, "body": "It&#39;s definitely the connectionstring, I commented everything out, except of the con.Open ConnectionString, and the Error still persists"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5939926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2c2236ab60e69dc16fa8b88a7c087c?s=128&d=identicon&r=PG&f=1", "display_name": "Jens-Peter Giersch", "link": "https://stackoverflow.com/users/5939926/jens-peter-giersch"}, "is_accepted": false, "score": 0, "last_activity_date": 1563367304, "last_edit_date": 1563367304, "creation_date": 1563363256, "answer_id": 57074887, "question_id": 55019575, "link": "https://stackoverflow.com/questions/55019575/excel-visual-basic-adodb-sql-connection-string-not-working/57074887#57074887", "title": "Excel Visual Basic ADODB SQL connection string not working", "body": "<p>As you, FunnyO, already stated, it is the connection string.\nYou probably do not have the correct driver definition.</p>\n\n<p>Try something like that:\nstrCnn = \"Provider=SQLNCLI11;Server=\" &amp; pServer &amp; \";Database=\" &amp; pCatalog &amp; \";Integrated Security=SSPI;\"</p>\n\n<p>Sure, a very simple connection string. But it should work out as it is a very common one...</p>\n"}], "owner": {"reputation": 285, "user_id": 5561534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5aegyhU-0Po/AAAAAAAAAAI/AAAAAAAAAF0/iYNsoSN7V3k/photo.jpg?sz=128", "display_name": "FunnyO", "link": "https://stackoverflow.com/users/5561534/funnyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 774, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563367354, "creation_date": 1551864286, "last_edit_date": 1563367354, "question_id": 55019575, "link": "https://stackoverflow.com/questions/55019575/excel-visual-basic-adodb-sql-connection-string-not-working", "title": "Excel Visual Basic ADODB SQL connection string not working", "body": "<p>I'm trying to connect to an SQL Server through Automatisation in VBA, so each time Excel starts, the SQL Statement updates the table in Excel.</p>\n\n<p>Problem is, that my Connection string always throws an exception: </p>\n\n<blockquote>\n  <p>\"Run-time error \"-2147217843 (80040e4d)'; Automation error\"</p>\n</blockquote>\n\n<p>I have following data provided:</p>\n\n<ul>\n<li>Servername, though it has a comma in it's Name</li>\n<li>Database Name</li>\n</ul>\n\n<p>I also have a Windows user (accountname &amp; Password), that I run the Statements from, but I doubt, it is necessary to provide this information to the SQL Server.</p>\n\n<p>the Connection string Looks as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub OpenConnection2(pServer As String, pCatalog As String)\n    Dim mDataBase As New ADODB.Connection\n    Dim mRS As New ADODB.Recordset\n    Dim mCmd As New ADODB.Command\n\nCall mDataBase.Open(\"Provider=SQLOLEDB;Initial Catalog=\" &amp; pCatalog &amp; \";Data Source=\" &amp; pServer &amp; \";\")\n    mCmd.ActiveConnection = mDataBase\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016", "excel-charts"], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1551879174, "post_id": 55021505, "comment_id": 96801662, "body": "Thanks - I was looking for that submenu of the formatting menu, to see what my options were - apparently the reason I couldn&#39;t find it is because it wasn&#39;t there! Anyway, I don&#39;t think your proposed solution will work for me, but thanks a ton for the effort :-)"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1551879959, "post_id": 55021505, "comment_id": 96802128, "body": "I know. Since you&#39;re dealing with a combo chart, the trick may not be the right one. I posted it just because it was funny to do it (I&#39;m such a nerd...!)."}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 2, "last_activity_date": 1551870096, "creation_date": 1551870096, "answer_id": 55021505, "question_id": 55019356, "link": "https://stackoverflow.com/questions/55019356/positioning-labels-on-a-donut-chart/55021505#55021505", "title": "Positioning labels on a donut-chart", "body": "<p>I don't think it's possible to do exactly you want to do the way you want to do it! The option to place the labels outside the chart is not available on the doughnut chart options:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sfc7B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sfc7B.png\" alt=\"Missing options on doughnut chart\"></a> </p>\n\n<p>like they do on a pie chart:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gBVLT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gBVLT.png\" alt=\"Label position options on a pie chart\"></a></p>\n\n<p>However, you could perform a trick using a pie chart and a white circle to make it look like a doughnut by doing the following:</p>\n\n<pre><code>Sub AddCircle()\n    'Get chart size and position:\n        Dim CH01 As Chart: Set CH01 = ThisWorkbook.Sheets(\"Sheet1\").ChartObjects(\"Chart1\").Chart\n        Dim OB01 As ChartObject: Set OB01 = CH01.Parent\n        Dim x As Double: x = 0 'horizontal coordinate\n        Dim y As Double: y = 0 'vertical coordinate\n        Dim w As Double: w = 0 'width\n        Dim h As Double: h = 0 'height\n        x = OB01.Left\n        y = OB01.Top\n        w = OB01.Width\n        h = OB01.Height\n    'Adding the circle:\n        ThisWorkbook.Sheets(\"Sheet1\").Shapes.AddShape(msoShapeOval, x + w / 2 - 20, y + h / 2 - 20, 40, 40).Name = \"Circle01\"\n    'Formatting the circle:\n        With ThisWorkbook.Sheets(\"Sheet1\").Shapes(\"Circle01\")\n            .LINE.Visible = msoFalse\n            .Fill.ForeColor.RGB = RGB(255, 255, 255)\n        End With\nEnd Sub\n</code></pre>\n\n<p>And it works very nicely:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5KBRX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5KBRX.png\" alt=\"Pie chart with a hole\"></a></p>\n\n<p>Had some fun \"solving\" this one...</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 9676150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925ff34ea3d69d16cda87325249f84c5?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/9676150/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1566232332, "creation_date": 1566232332, "answer_id": 57560713, "question_id": 55019356, "link": "https://stackoverflow.com/questions/55019356/positioning-labels-on-a-donut-chart/57560713#57560713", "title": "Positioning labels on a donut-chart", "body": "<p>Working with sinus and cosinus we can also calculate the outside position of the label. Following a VB snippet, how this can be done:</p>\n\n<pre><code>Sub Macro1()\n    Dim cx\n    Dim cy\n    Dim x\n    Dim y\n    Dim radius\n    Dim angle\n    Dim new_radius\n    Dim new_x\n    Dim new_y\n\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveSheet.ChartObjects(\"Chart 1\").Select\n    cx = Selection.width / 2\n    cy = Selection.height / 2\n\n    For i = 1 To ActiveChart.FullSeriesCollection(1).Points.Count Step 1\n        ActiveChart.FullSeriesCollection(1).Points(i).DataLabel.Select\n        x = Selection.left + (Selection.width / 2)\n        y = Selection.top + (Selection.height / 2)\n        radius = Sqr(((x - cx) ^ 2) + ((y - cy) ^ 2))\n        angle = WorksheetFunction.Atan2(y - cy, x - cx)\n        new_radius = radius + 40\n        new_x = cx + (Sin(angle) * new_radius)\n        new_y = cy + (Cos(angle) * new_radius)\n        Selection.left = new_x - (Selection.width / 2)\n        Selection.top = new_y - (Selection.height / 2)\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1584973779, "creation_date": 1551863582, "last_edit_date": 1584973779, "question_id": 55019356, "link": "https://stackoverflow.com/questions/55019356/positioning-labels-on-a-donut-chart", "title": "Positioning labels on a donut-chart", "body": "<p>I have the following code which attempts to add a datalabel to a point in a combined donut/pie-chart:</p>\n\n<pre><code>    For Each co In .ChartObjects\n        With co.Chart.FullSeriesCollection(\"Gr\u00f8n pil\").Points(2)\n            .HasDataLabel = True\n            With .DataLabel\n                .Position = xlLabelPositionOutsideEnd\n                .Format.AutoShapeType = msoShapeRectangle\n                .Format.Line.Visible = msoTrue\n            End With\n        End With\n    Next co\n</code></pre>\n\n<p>However, the code aborts on the line <code>.Position = xlLabelPositionOutsideEnd</code> with the error message \"Run-time error 2147467259 (80004005)\". Method 'Position' of object 'DataLabel' failed\".</p>\n\n<p>Looking at the chart, the label has been added, but it is still positioned inside the chart.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wkArg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wkArg.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see I've already positioned a label outside the chart for a different series, which is represented as a pie chart. While the series I am trying to add the label to is represented as a donut-chart.</p>\n\n<p>Can't I have both the labels for the donut- and pie-chart on the outside? Isn't <code>xlLabelPositionOutsideEnd</code> a valid position for labels of a donut-chart? Or is the problem something else which eludes me?</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551864178, "post_id": 55019156, "comment_id": 96792612, "body": "Hi, welcome to SO. You have a good description of what you are trying to achieve but what you haven&#39;t provided is what you have tried so far? i.e. have you written any VBA? or made an attempt to achieve this with formulas? At SO we tend not to write the code for you but instead help you with yours. It might also be worth posting sample screen prints of your sheets and how you want <code>Sheet1</code> to look like"}, {"owner": {"reputation": 1, "user_id": 11158269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95594e6b6124562a7b8a48d76b7c3459?s=128&d=identicon&r=PG&f=1", "display_name": "sheppy3791", "link": "https://stackoverflow.com/users/11158269/sheppy3791"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1552427356, "post_id": 55019156, "comment_id": 97003894, "body": "Thanks for the follow up. Sorry for the late reply, just got back from long weekend. Wasn&#39;t expecting such a fast response. Ive updated the post with my current code. Thanks for the assistance."}, {"owner": {"reputation": 800, "user_id": 6310948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0VKq.jpg?s=128&g=1", "display_name": "Erjon", "link": "https://stackoverflow.com/users/6310948/erjon"}, "edited": false, "score": 0, "creation_date": 1552432109, "post_id": 55019156, "comment_id": 97005512, "body": "It&#39;s a little bit complex helping you without looking at your sheet, in this case I would ask if you can edit your answer by uploading an image of your reference tables. What i&#39;m trying to say is that if one of the dropdown list options matches one of your tables column name we can use loops and accomplish what you are looking for"}], "owner": {"reputation": 1, "user_id": 11158269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95594e6b6124562a7b8a48d76b7c3459?s=128&d=identicon&r=PG&f=1", "display_name": "sheppy3791", "link": "https://stackoverflow.com/users/11158269/sheppy3791"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552436212, "creation_date": 1551862903, "last_edit_date": 1552436212, "question_id": 55019156, "link": "https://stackoverflow.com/questions/55019156/how-to-get-cell-value-from-another-excel-sheet-based-on-multiple-list-conditions", "title": "How to get cell value from another excel sheet based on multiple list conditions", "body": "<p>I apologise if this comes across as a newbie query, but I have been stumped by this for some time.</p>\n\n<p>I am building an excel spreadsheet for my staff to be able to compare stock listings easily and automatically based on reference data held in a different sheet within the same workbook.</p>\n\n<p>The difficulty is that I want to pull this reference data based on the values chosen from a total of 6 conditional drop down lists I have created.</p>\n\n<p>Based on what is selected, the values on say Sheet 1 will display the relevant values from Sheet 2 automatically (i.e. if one of the list options is changed, the \"results\" will update with the associated data automatically).</p>\n\n<p>I have tried using lookup functions, arrays and nested if functions, but I have been unable to get it to work properly - probably due to my own lack of depth of knowledge for this type of coding. As such I am looking for advice about the best way to code this function requirement.</p>\n\n<p>The format of what I am trying to do is this:</p>\n\n<p>Sheet 1 - The 'GUI'\nThis sheet has the dropdown lists and the \"displayed results\" section</p>\n\n<pre><code>dd1 - State (6 options)\ndd2 - Product Type (4 options)\ndd3 - Product Brand (3 options)\ndd4 - Product variation 1 (eg model) (say, 2 options)\ndd5 - Product variation 2 (eg colour) (5 options)\ndd6 - Product variation 3 (eg size) (3 options)\n</code></pre>\n\n<p>Sheet 2 - Reference data</p>\n\n<pre><code>Table 1 - ACT products and variations\nTable 2 - VIC products and variations \nTable 3 - NSW products and variations etc and so on...\n</code></pre>\n\n<p>Based on choices above in Sheet1, I want the product &amp; price to be listed in cells below. Currently I have conditional functions listing the avail options based on the choice made for the prev list working fine.</p>\n\n<p>I need it so that:</p>\n\n<pre><code>IF dd1 = \"ACT\" AND dd2 = \"Mobile\" AND dd3 = \"Apple\" AND dd4 = \"iPhone\" AND dd5 = \"white\" AND dd6 = \"128Gb\"\n</code></pre>\n\n<p>Then</p>\n\n<p>The results cell, say Sheet1!C10, will reflect the price of the item based on a table of data lists in Sheet2 (say for eg the listed value is in Sheet 2, Cell A5)</p>\n\n<p>But if say the list choices change, eg dd3 was changed to \"Samsung\", then the lists will auto update because of the conditional formatting already; but I then want the results to be updated accordingly (eg the price listed based on the new choices will then reflect Sheet2!B3).</p>\n\n<p>Because of the many options and variations, there are many tables in Sheet 2 for reference, so the 'IF' statement to cover all these options would be massive and convoluted.</p>\n\n<p>Is there a relatively concise way of writing vb code for this function to suit?</p>\n\n<p>My current code under the worksheet_change sub</p>\n\n<pre><code>    If Range(\"D10\").Value = \"ACT\" And (Range(\"D11\").Value = \"Mobile\" And (Range(\"D13\").Value = \"Samsung\" And (Range(\"D14\").Value = \"S7\") And (Range(\"D15\").Value = \"Black\") And (Range(\"D16\").Value = \"128\"))))) Then\n\n    Sheets(\"Sheet2\").Range(\"F20\").Value = Sheets(\"Sheet4\").Range(\"C5\").Value2\n\n    Sheets(\"Sheet2\").Range(\"F29\").Value = Sheets(\"Sheet4\").Range(\"C6\").Value2\n\nElseIf Range(\"D10\").Value = \"ACT\" And (Range(\"D11\").Value = \"Mobile\" And (Range(\"D13\").Value = \"Samsung\" And (Range(\"D14\").Value = \"S7\") And (Range(\"D15\").Value = \"Black\") And (Range(\"D16\").Value = \"256\"))))) Then\n\n    Sheets(\"Sheet2\").Range(\"F21\").Value = Sheets(\"Sheet4\").Range(\"C8\").Value2\n\n    Sheets(\"Sheet2\").Range(\"F22\").Value = Sheets(\"Sheet4\").Range(\"C9\").Value2\n\n    Sheets(\"Sheet2\").Range(\"F29\").Value = Sheets(\"Sheet4\").Range(\"C10\").Value2\n</code></pre>\n\n<p>'and so on. With all the variations, there's prob going to be approx 20+ elseif statements.</p>\n\n<pre><code>End If\n</code></pre>\n\n<p>Ive only pasted 2x sections for the purpose of this request. I can copy it down or adjust the code accordingly for each option.</p>\n\n<p>Ive not used nor written arrays before (successfully i.e.) so I have no clue/understanding if that is a better way, but i have written vba for basic functions and macros before; but im open to learn.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1551861002, "post_id": 55018419, "comment_id": 96790835, "body": "As a start, try the first 20 solutions of google for <a href=\"https://www.google.com/search?rlz=1C1GCEU_deAT822AT823&amp;ei=O4R_XPizFbrRmwXXspKgAg&amp;q=excel+vba+search+range+for+specific+text&amp;oq=excel+vba+search+range+for+specific+text&amp;gs_l=psy-ab.3...22396.23074..23225...0.0..0.92.342.4......0....1..gws-wiz.......35i39j0i8i30j33i10.ArYYBTXGGGM\" rel=\"nofollow noreferrer\">finding text</a> and <a href=\"https://www.google.com/search?q=excel+vba+change+cell+color+on+condition&amp;rlz=1C1GCEU_deAT822AT823&amp;oq=excel+vba+change+cell+color+on+condition&amp;aqs=chrome..69i57.12199j0j7&amp;sourceid=chrome&amp;ie=UTF-89\" rel=\"nofollow noreferrer\">changing cell color</a>."}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1551861287, "post_id": 55018419, "comment_id": 96791000, "body": "By &quot;specific text in cells with comments&quot;, do you mean the comment text or the cell text?"}, {"owner": {"reputation": 1, "user_id": 11100502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7db4362e0e854bdc2ec3978e6fc6e9?s=128&d=identicon&r=PG&f=1", "display_name": "Alpha_BPS", "link": "https://stackoverflow.com/users/11100502/alpha-bps"}, "edited": false, "score": 0, "creation_date": 1551862790, "post_id": 55018419, "comment_id": 96791834, "body": "Thanks, I mean the comment text. The cell is used simply to indicate something by its color."}], "answers": [{"tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": false, "score": 0, "last_activity_date": 1551865532, "last_edit_date": 1551865532, "creation_date": 1551863228, "answer_id": 55019255, "question_id": 55018419, "link": "https://stackoverflow.com/questions/55018419/search-range-for-specific-comments/55019255#55019255", "title": "Search range for specific comments", "body": "<p>The following user-defined function will return the comment text. Put it in a module.</p>\n\n<pre><code>Public Function GetComment(Optional rng As Range)\n  If rng Is Nothing Then\n    Set rng = Application.Caller\n  End If\n  If rng.Comment Is Nothing Then\n    GetComment = \"\"\n  Else\n    GetComment = rng.Comment.Text\n  End If\nEnd Function\n</code></pre>\n\n<p>Then create a conditional format rule with formula <code>=FIND(\"your search text\",GetComment())&gt;0</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11100502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7db4362e0e854bdc2ec3978e6fc6e9?s=128&d=identicon&r=PG&f=1", "display_name": "Alpha_BPS", "link": "https://stackoverflow.com/users/11100502/alpha-bps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551865532, "creation_date": 1551860230, "last_edit_date": 1551863249, "question_id": 55018419, "link": "https://stackoverflow.com/questions/55018419/search-range-for-specific-comments", "title": "Search range for specific comments", "body": "<p>I'm trying to search a range for specific text in a all cells with comments. Then change the background color of the cells containing the comment with specified text.</p>\n\n<p>Any help? I'm stuck :(</p>\n"}, {"tags": ["vba", "ms-access", "dao"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1551860207, "creation_date": 1551860207, "answer_id": 55018410, "question_id": 55018268, "link": "https://stackoverflow.com/questions/55018268/how-to-find-field-width-of-a-table-in-access-vba/55018410#55018410", "title": "How to find field width of a table in Access VBA", "body": "<p>The <code>Size</code> property contains the field size:</p>\n\n<pre><code>debug.print dars.Fields(\"FieldName\").Properties!Size\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 55018410, "answer_count": 1, "score": 0, "last_activity_date": 1594620553, "creation_date": 1551859527, "last_edit_date": 1594620553, "question_id": 55018268, "link": "https://stackoverflow.com/questions/55018268/how-to-find-field-width-of-a-table-in-access-vba", "title": "How to find field width of a table in Access VBA", "body": "<p>In Access <code>DAO.TablDef</code> has a function <code>CreateField(Name,Type,Size)</code> I am looking for the size of an existing table field. I have a table column of type <code>db_text</code> and has a size of 6. \n<a href=\"https://i.stack.imgur.com/282Xo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/282Xo.png\" alt=\"enter image description here\"></a>\n<code>DAO recordset</code> has a <code>fields</code> class. I can find field type with it but not field size yet. I tried DefinedSize, NumericScale and ActualSize. Anyone knows how to find field size? Thanks</p>\n\n<pre><code>Dim dars As Dao.Recordset\n\nSet dars = CurrentDb.OpenRecordset(\"TableName\")\n\ndebug.print dars.Fields(\"FieldName\").Type\n\ndebug.print dars.Fields(\"FieldName\").DefinedSize\ndebug.print dars.Fields(\"FieldName\").NumericScale\ndebug.print dars.Fields(\"FieldName\").ActualSize\n\ndars.Close\nSet dars = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "filter"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551859494, "post_id": 55018215, "comment_id": 96790054, "body": "Could you please show us the code you already have?"}, {"owner": {"reputation": 11, "user_id": 11061872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fe9d6a3bf32b06b661389562bc5ded?s=128&d=identicon&r=PG&f=1", "display_name": "Saransh", "link": "https://stackoverflow.com/users/11061872/saransh"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551859746, "post_id": 55018215, "comment_id": 96790179, "body": "Hey Damian! Just updated the test code"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11061872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fe9d6a3bf32b06b661389562bc5ded?s=128&d=identicon&r=PG&f=1", "display_name": "Saransh", "link": "https://stackoverflow.com/users/11061872/saransh"}, "edited": false, "score": 0, "creation_date": 1551861792, "post_id": 55018640, "comment_id": 96791295, "body": "Got it! Thanks :D   Just tested on my project and it works"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11156232"}, "is_accepted": false, "score": 0, "last_activity_date": 1551861076, "creation_date": 1551861076, "answer_id": 55018640, "question_id": 55018215, "link": "https://stackoverflow.com/questions/55018215/date-filter-month-year/55018640#55018640", "title": "Date Filter - Month &amp; Year", "body": "<p>Set up a date range using Criteria1 and Criteria2.</p>\n\n<pre><code>dim dt as long\n\ndt = datevalue(\"1 \" &amp; mnth &amp; \", \" &amp; yr)\n\nwith activesheet\n  with .range(.cells(1, \"A\"), .cells(.rows.count, \"A\").end(xlup))\n    .autofilter field:=1, criteria1:=\"&gt;=\"&amp;dt, operator:=xland, _\n                criteria2:=\"&lt;\" &amp; dateserial(year(dt), month(dt)+1, 1)\n  end with\nend with\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 0, "last_activity_date": 1551862060, "creation_date": 1551862060, "answer_id": 55018892, "question_id": 55018215, "link": "https://stackoverflow.com/questions/55018215/date-filter-month-year/55018892#55018892", "title": "Date Filter - Month &amp; Year", "body": "<p>If you record the setting of an autofilter of the date value you get:</p>\n\n<pre><code>Sub DateFiter_Recorded()\n'\n' DateFiter_Recorded Macro\n'\n    Columns(\"C:C\").ColumnWidth = 16.29\n    ActiveSheet.Range(\"A1:A3200\").AutoFilter Field:=1, Operator:= _\n        xlFilterValues, criteria2:=Array(1, \"2/4/2019\")\n    ActiveWindow.SmallScroll Down:=153\n    Range(\"C194\").Select\nEnd Sub\n</code></pre>\n\n<p>Based on this is easy to code and test a routine to set a filter:</p>\n\n<pre><code>Option Explicit\n\nSub SetDateValueRange()\n    ActiveWorkbook.Names.Add Name:=\"DateValRange\",  RefersTo:=\"=Sheet1!A1:A3200\"\nEnd Sub\n\nSub DateFiter_JAN_2019()\n    ActiveSheet.Range(\"DateValRange\").AutoFilter Field:=1, Operator:= _\n        xlFilterValues, criteria2:=Array(1, \"1/31/2019\")\nEnd Sub\n\nSub DateFiter_FEB_2019()\n    Dim criteria2value\n    criteria2value = Array(1, \"2/15/2019\")\n    ActiveSheet.Range(\"DateValRange\").AutoFilter Field:=1, Operator:= _\n        xlFilterValues, criteria2:=criteria2value\nEnd Sub\n\nSub DateFiter_AUG_2019()\n    Dim criteria2value\n    criteria2value = Array(1, \"8/1/2018\")\n    ActiveSheet.Range(\"DateValRange\").AutoFilter Field:=1, Operator:= _\n        xlFilterValues, criteria2:=criteria2value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11061872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fe9d6a3bf32b06b661389562bc5ded?s=128&d=identicon&r=PG&f=1", "display_name": "Saransh", "link": "https://stackoverflow.com/users/11061872/saransh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1551863270, "creation_date": 1551859283, "last_edit_date": 1551863270, "question_id": 55018215, "link": "https://stackoverflow.com/questions/55018215/date-filter-month-year", "title": "Date Filter - Month &amp; Year", "body": "<p>I want to filter a date column basis \n1. Year \n2. Month </p>\n\n<p>The Year &amp; Month are dynamic fields and I've saved their values in the macro as \nYEAR - yr\nMonth - mnth </p>\n\n<p>Is there a way for the macro to simply filter using these conditions without inserting additional columns ? </p>\n\n<p><a href=\"https://i.stack.imgur.com/Obx4p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Obx4p.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub testcode()\n\nRange(\"a1:a200\").Select\n\nyr = 2019\nmnth = Feb\n\nActiveSheet.Range(\"$A$1:$A$3200\").AutoFilter Field:=1, Criteria1:=yr\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551947325, "post_id": 55027745, "comment_id": 96829388, "body": "Thank you this seems to work great. I have not done this type of VBA yet so thanks. But the only thing is, i only want it to copy from the second column and 4th row. (B4). There is stuff in Column A and lines 1,2 and 3."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551948160, "post_id": 55027745, "comment_id": 96829820, "body": "@Lalaland Is your data in a defined table or a simple range. not in table. Further can you upload a sample file with factitious data so that I may  test and modify my code to suit your requirements  fully."}, {"owner": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551949750, "post_id": 55027745, "comment_id": 96830802, "body": "Hi there, i have uploaded the file i use to copy from, so everything in yellow needs to be copied and pasted to other sheet."}, {"owner": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551950938, "post_id": 55027745, "comment_id": 96831550, "body": "So basically after doing the filter for Magnesium, then the copy will take place but i dont want to copy the actual colum &quot;magnisum&quot;. I have highlighted the columns in yellow which should help."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551961466, "post_id": 55027745, "comment_id": 96838165, "body": "@Lalaland I wanted to make minimum changes to the program routine as it is of universal application and want not to disturb looping portion. I have made minor changes at two places to accomplish your purpose.I have uploaded a word document highlighting changed portion with yellow shade. I hope it should do your  job. In case you are satisfied by my efforts for you please accept my answer. Copy from one workbook to another including tables&lt;<a href=\"https://www.dropbox.com/s/7vqh2anayy5hgyg/55018080-Copy%20from%20one%20workbook%20to%20another.docx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/7vqh2anayy5hgyg/&hellip;</a>&gt;"}, {"owner": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551961959, "post_id": 55027745, "comment_id": 96838449, "body": "That is working perfect, thank you so much for all your effort it is really appreciated."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "edited": false, "score": 0, "creation_date": 1551964117, "post_id": 55027745, "comment_id": 96839710, "body": "@Lalaland  please remove your File upload  link from Question as it contains your specific information."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 2, "last_activity_date": 1551949890, "last_edit_date": 1551949890, "creation_date": 1551889304, "answer_id": 55027745, "question_id": 55018080, "link": "https://stackoverflow.com/questions/55018080/copy-from-one-workbook-to-another-including-tables/55027745#55027745", "title": "Copy from one workbook to another including tables", "body": "<p>Please note following points regarding your code</p>\n\n<ul>\n<li>a) <code>x.Sheets.ListObjects</code> does not identify variables and their\nassociation correctly and would give compiler error whereas\n<code>x.ActiveSheet.ListObjects</code> is correct. </li>\n<li><p>b)  Repetition of Filter line    twice is not understandable.</p></li>\n<li><p>c)   You have to use visibleCells    property for copying filtered\ncells in your method.</p></li>\n<li><p>d)   You have to    either Activate the sheet to be worked upon or\nuse With ... End with    structure. Later one is a preferable\napproach.</p></li>\n<li>e)    To clear filter    use <code>ShowAlldata</code> property.</li>\n</ul>\n\n<p>I recorded a macro to demonstrate its potential.</p>\n\n<pre><code>  Sub Macro()\n'\n' Macro6 Macro\n'\n\n'\n    Cells.Select\n    Application.Goto Reference:=\"FIdetails\"\n    Selection.AutoFilter\n    Selection.AutoFilter\n    ActiveSheet.ListObjects(\"FIdetails\").Range.AutoFilter Field:=1, Criteria1:= _\n        \"magnesium\"\n    Selection.SpecialCells(xlCellTypeVisible).Select\n    Selection.Copy\n    Windows(\"Outstanding.xlsm\").Activate\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n    Windows(\"Extracts.xlsm\").Activate\n    Cells.Select\n    Application.CutCopyMode = False\n    ActiveSheet.ShowAllData\nEnd Sub\n</code></pre>\n\n<p>Subsequently if you run the program it generates error particularly on line <code>Application.Goto Reference:=\"FIdetails\"</code> and also is not reliable in performance. Further it uses 'Select' which preferably be avoided keeping in view following highly acclaimed SO Posts.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/321299/what-is-the-reason-not-to-use-select\">What is the reason not to use select *?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/3639861/why-is-select-considered-harmful\">Why is SELECT * considered harmful?</a></p>\n\n<p>Finally I chose array based approach, which I think may give better &amp; consistent results.</p>\n\n<p>Try This:</p>\n\n<pre><code>    Sub Details()\n    Dim Results As Variant, tmp As Variant\n    Dim i As Long, j As Long\n    Dim CriteriaCol As Long, ResultCount As Long\n    Dim Criteria As String\n\n    Criteria = \"Magnesium\"\n    CriteriaCol = 1\n\n    With Sheet1.ListObjects(\"FIdetails\")\n        tmp = .DataBodyRange\n    End With\n\n    ReDim Results(LBound(tmp, 2) To UBound(tmp, 2), LBound(tmp, 1) To UBound(tmp, 1))\n    For i = LBound(tmp, 1) To UBound(tmp, 1)\n        If UCase(tmp(i, CriteriaCol)) = UCase(Criteria) Then\n            ResultCount = ResultCount + 1\n            j = LBound(tmp, 2) - 1\n            Do\n                j = j + 1\n                Results(j, ResultCount) = tmp(i, j)\n            Loop Until j = UBound(tmp, 2)\n        End If\n    Next i\n    ReDim Preserve Results(LBound(Results, 1) To UBound(Results, 1), LBound(Results, 1) To ResultCount)\n    With Workbooks(\"Outstanding.xlsm\").Sheets(\"Details\")\n        .Cells(2, 1).Resize(UBound(Results, 2), UBound(Results, 1)) = Application.Transpose(Results)\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>\nScreenshots of sample data and results added for OP's guidance based on his comments dated 07-03-2019. \n<a href=\"https://i.stack.imgur.com/DWZXA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DWZXA.jpg\" alt=\"filter1\"></a>\n<a href=\"https://i.stack.imgur.com/BqR9T.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BqR9T.jpg\" alt=\"filter2\"></a></p>\n"}], "owner": {"reputation": 151, "user_id": 9794792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576250bd6d4f9961aeb9e1326c8565f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lalaland", "link": "https://stackoverflow.com/users/9794792/lalaland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55027745, "answer_count": 1, "score": 0, "last_activity_date": 1552048981, "creation_date": 1551858724, "last_edit_date": 1552048981, "question_id": 55018080, "link": "https://stackoverflow.com/questions/55018080/copy-from-one-workbook-to-another-including-tables", "title": "Copy from one workbook to another including tables", "body": "<p>So I am trying to copy data from one workbook to another. The sheet where the data is at is in Table form but when i try the below code it does not work. Before the copy happens, it first does a filter and then copies the data.</p>\n\n<pre><code>Sub Details()\nDim x As Workbook\nDim y As Workbook\n\n'## Open both workbooks first:\nSet x = Workbooks(\"C:\\Users\\user\\Desktop\\mi\\Extracts.xlsm\")\nSet y = Workbooks(\"C:\\Users\\user\\Desktop\\mi\\Outstanding.xlsm\")\n\n\n    x.Sheets.ListObjects(\"FIdetails\").Range.AutoFilter Field:=1\n\n    x.Sheets.ListObjects(\"FIdetails\").Range.AutoFilter Field:=1, Criteria1:= _\n        \"Magnesium\"\n\n        lastCol = ActiveSheet.Range(\"b4\").End(xlToRight).Column\n    Lastrow = ActiveSheet.Cells(4, 1).End(xlDown).Row\n    ActiveSheet.Range(\"b4\", ActiveSheet.Cells(Lastrow, lastCol)).Copy\n\n'paste to y worksheet:\ny.Sheets(\"Details\").Range(\"A2\").Paste\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be great thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551855833, "post_id": 55017183, "comment_id": 96788346, "body": "Hi allen, you could use Scripting Dictionary for this. You store each group of variables on a different dictionary and then using the Dictionary.Exists(PivotItemName) you could do the trick."}, {"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551856066, "post_id": 55017183, "comment_id": 96788428, "body": "Hey Damian. Thanks for the response. I&#39;ll try to search more about using the Scripting Dictionary. Thanks for the tip."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551856204, "post_id": 55017183, "comment_id": 96788489, "body": "You need the library <code>Scripting Runtime</code> And then <code>Dim Whatever As Scripting.Dictionary</code>, finally you set it like <code>Set Whatever = New Scripting.Dictionary</code> so you finally loop through all the items on the range which match your criteria to store them on the dictionary. Later you will only need to test  <code>If Whatever.Exists(FieldName) Then</code>and whatever code you need."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551857349, "post_id": 55017498, "comment_id": 96788996, "body": "Hi @Qharr Thank you for taking the time to answer. The code works well and I can definitely use this in the future. However, is ti possible to tweak the code so it would also work on approximate matches and not simply on exact matches. For example a value of an oPI is 1234500000 but the value in range A1 is 12345 only. The code above will hide the pivot item since it is not equal to 12345 but that is not what i intended. I still need to display pivot item 1234500000."}, {"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551860529, "post_id": 55017498, "comment_id": 96790571, "body": "Hi @QHarr vba now prompts me &quot;Unable to set the visible property of the PivotItem Class. This did not happen with your previous code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551860933, "post_id": 55017498, "comment_id": 96790805, "body": "Can you provide the failing value?"}, {"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551861021, "post_id": 55017498, "comment_id": 96790844, "body": "I am thinking the problem is in the variable &quot;i&quot;. It was undeclared and that&#39;s the only thing i can say about it haha. I don&#39;t know how to fix it."}, {"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551861129, "post_id": 55017498, "comment_id": 96790906, "body": "When I go to the vba debug screen, it highlights this line oPI.Visible = False in yellow."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551862829, "post_id": 55017498, "comment_id": 96791855, "body": "still failing then?"}, {"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551863086, "post_id": 55017498, "comment_id": 96791982, "body": "I don&#39;t know what did i do. i think i deleted some comments. I tried the code. it worked when i added one line and modified another.     oPI.Visible = False before the For i= line and change the &gt;0 then oPI.visible = True. However, it only shows the exact matches. My head is now messed up lol."}, {"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551863321, "post_id": 55017498, "comment_id": 96792114, "body": "Thank you very much for spending your time with me. I think I now get it. I used the logic from your code and came up with this and it works! Hahaha Thank you very much!  For Each oPI In ws.PivotTables(1).PivotFields(&quot;Reference Number&quot;).PivotItems     oPI.Visible = False     For Each rng In ws.Range(&quot;A1:A100&quot;)         If InStr(oPI.Value, rng.Value) &gt; 0 Then         oPI.Visible = True     Exit For     End If     Next Next"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551863425, "post_id": 55017498, "comment_id": 96792170, "body": "I\u2019m guessing something is truncated when reading into array or leading 0s lost."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1551861136, "last_edit_date": 1551861136, "creation_date": 1551856235, "answer_id": 55017498, "question_id": 55017183, "link": "https://stackoverflow.com/questions/55017183/using-list-of-values-in-the-select-case-statement/55017498#55017498", "title": "Using list of values in the Select Case Statement", "body": "<p>You could read the range of values to check against into an array you loop comparing against current pivotitem. I used Instr rather than Like with wildcards (%) to see if substring present.</p>\n\n<pre><code>Dim arr(), ws As Worksheet, i As Long\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\narr = Application.Transpose(ws.Range(\"A1:A100\").Value)\n'other code\nFor Each oPI In ws.PivotTables(1).PivotFields(\"Reference Number\").PivotItems\n    For i = LBound(arr) To UBound(arr)\n        If InStr(arr(i), oPI.Value) &gt; 0 Then\n            oPI.Visible = False\n            Exit For\n        End If\n    Next\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "edited": false, "score": 0, "creation_date": 1551860653, "post_id": 55017785, "comment_id": 96790651, "body": "Hi Tim! Thanks for taking a minute. Some of my field values are numeric, some are alphanumeric, and some are text. I tried your code and converted the values to text by adding (&#39;) before the numeric values but it seems none of the pivot items have been hidden."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1551857570, "creation_date": 1551857570, "answer_id": 55017785, "question_id": 55017183, "link": "https://stackoverflow.com/questions/55017183/using-list-of-values-in-the-select-case-statement/55017785#55017785", "title": "Using list of values in the Select Case Statement", "body": "<p>Using an array formula and <code>Match</code> to find \"like\" matches:</p>\n\n<pre><code>Dim ws, oPI, r\n\nSet ws = ActiveSheet\n\nFor Each oPI In ws.PivotTables(1).PivotFields(\"Reference Number\").PivotItems\n    r = ws.Evaluate(\"=MAX(IFERROR(MATCH(A1:A100 &amp; \"\"*\"\",\"\"\" &amp; oPI.Value &amp; \"\"\",0),0))\")\n    oPI.Visible = (r = 0)\nNext\n</code></pre>\n\n<p>May not work if your field values are numeric and not text.</p>\n"}], "owner": {"reputation": 25, "user_id": 11027481, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fLxzi4zIKKU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPEJ2HJo4oP6imN7S5rGXgRpHK_Jw/mo/photo.jpg?sz=128", "display_name": "AJ123", "link": "https://stackoverflow.com/users/11027481/aj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55017498, "answer_count": 2, "score": 0, "last_activity_date": 1551863289, "creation_date": 1551854910, "last_edit_date": 1551863289, "question_id": 55017183, "link": "https://stackoverflow.com/questions/55017183/using-list-of-values-in-the-select-case-statement", "title": "Using list of values in the Select Case Statement", "body": "<p>Hi I am currently trying to hide unnecessary PivotItems in my pivot table by using select case statement.</p>\n\n<p>My Select Case Statement would look like this:</p>\n\n<p>ws = ActiveWorksheet</p>\n\n<pre><code>For Each oPI In ws.PivotTables(1).PivotFields(\"Reference Number\").PivotItems\n\nSelect Case oPI.Value\nCase \"Value1\",\"Value2\",\"Value3\"\n'Do Nothing\nCase Else\noPI.Visible = False\nEnd Select\n\nNext\n</code></pre>\n\n<p>However, I want to modify the statement to do two things.</p>\n\n<ol>\n<li><p>Use \"Like\" inside the Case \"Value1\",\"Value2\",\"Value3\" because Value1,2,and 3 are not exact matches for the values in the PivotItems. Value 1 for example would be 12345 while in the PivotItems it would be 12345a or 12345b, or 12345c.</p></li>\n<li><p>Instead of inputting in VBA the actual values of Value1, 2, and 3, I want the Case Statement to refer to a range of Cell inside my active worksheet (Range(\"A1:A100\") for example.</p></li>\n</ol>\n\n<p>I tried many combinations already but my code does not seem to work. I don't know how to do this also with IF Statements.</p>\n\n<p>Your help will be deeply appreciated. Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551852095, "post_id": 55016507, "comment_id": 96786884, "body": "Path relevant to what? show where the script would be and where the excel file would be?"}, {"owner": {"reputation": 21, "user_id": 4773017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62391a5b25fdeae6ef5cf9e8c2aeac84?s=128&d=identicon&r=PG&f=1", "display_name": "ADGAN", "link": "https://stackoverflow.com/users/4773017/adgan"}, "reply_to_user": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551852889, "post_id": 55016507, "comment_id": 96787163, "body": "Both files (.xlsm and batch) on the same path. C:\\Users\\ashg"}, {"owner": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551852981, "post_id": 55016507, "comment_id": 96787195, "body": "So then remove the path?"}, {"owner": {"reputation": 21, "user_id": 4773017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62391a5b25fdeae6ef5cf9e8c2aeac84?s=128&d=identicon&r=PG&f=1", "display_name": "ADGAN", "link": "https://stackoverflow.com/users/4773017/adgan"}, "reply_to_user": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551853438, "post_id": 55016507, "comment_id": 96787372, "body": "It didn&#39;t work for me. I tried: Set xlBook = objExcel.Workbooks.Open(&quot;CSVtoxlsx.xlsm&quot;, 0, False)"}, {"owner": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551853505, "post_id": 55016507, "comment_id": 96787393, "body": "did you receive an error?"}, {"owner": {"reputation": 21, "user_id": 4773017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62391a5b25fdeae6ef5cf9e8c2aeac84?s=128&d=identicon&r=PG&f=1", "display_name": "ADGAN", "link": "https://stackoverflow.com/users/4773017/adgan"}, "reply_to_user": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551853600, "post_id": 55016507, "comment_id": 96787437, "body": "Yeah it says, sorry, we couldn&#39;t find CSVtoxlsx.xlsm"}, {"owner": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551853721, "post_id": 55016507, "comment_id": 96787493, "body": "Then the file is not in the same directory or you are running it as admin? How do you run the vba script?"}, {"owner": {"reputation": 21, "user_id": 4773017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62391a5b25fdeae6ef5cf9e8c2aeac84?s=128&d=identicon&r=PG&f=1", "display_name": "ADGAN", "link": "https://stackoverflow.com/users/4773017/adgan"}, "reply_to_user": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551854288, "post_id": 55016507, "comment_id": 96787701, "body": "Files are in the same directory. I&#39;m sure I&#39;m running as an admin. I have a .vbs file saved in the directory. So by double-clicking it. It works fine when I mention the full path. I tried running cmd as admin and running the script from CLI. The problem is still there"}, {"owner": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551854741, "post_id": 55016507, "comment_id": 96787876, "body": "ok, but that is a problem because cmd admin starts in <code>c:\\windows\\system32</code> and double clicking it would probably also start it from the vba executable path."}, {"owner": {"reputation": 17619, "user_id": 7818749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4a72453e116debb802d55e88c2572e?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/7818749/gerhard"}, "edited": false, "score": 0, "creation_date": 1551855084, "post_id": 55016507, "comment_id": 96788013, "body": "you can determine the directory the script runs as working directory. <code>Set wshell = CreateObject(&quot;WScript.Shell&quot;) Debug.Print wshell.CurrentDirectory</code>"}], "owner": {"reputation": 21, "user_id": 4773017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62391a5b25fdeae6ef5cf9e8c2aeac84?s=128&d=identicon&r=PG&f=1", "display_name": "ADGAN", "link": "https://stackoverflow.com/users/4773017/adgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551863302, "creation_date": 1551851890, "last_edit_date": 1551863302, "question_id": 55016507, "link": "https://stackoverflow.com/questions/55016507/how-to-open-excel-object-from-a-relative-path", "title": "How to open Excel object from a relative path?", "body": "<p>I want to open an Excel workbook from a Windows batch file. I have used the following line of code which does the job but I want it to use a relative path. </p>\n\n<pre><code>Set xlBook = objExcel.Workbooks.Open(\"C:\\Users\\ashg\\CSVtoxlsx.xlsm\", 0, False)\n</code></pre>\n\n<p>How do I construct the relative path and the Excel file name together to open the Excel file?</p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551852298, "post_id": 55016061, "comment_id": 96786958, "body": "Is there a webpage we can test this with?"}, {"owner": {"reputation": 21, "user_id": 7284581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2053b19996325dd246155bfd37e81eef?s=128&d=identicon&r=PG&f=1", "display_name": "questioner", "link": "https://stackoverflow.com/users/7284581/questioner"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551854033, "post_id": 55016061, "comment_id": 96787608, "body": "Unfortunately, it is only accessible for employees."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551855866, "post_id": 55016061, "comment_id": 96788362, "body": "can you pastebin.com the page html?"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1551925119, "post_id": 55016061, "comment_id": 96822442, "body": "From your above description, I understand that there are 3 dropdowns and 1 button. when nothing is selected button is available for click. when anything get selected it process something and button get disable until the process get finished. It is not clear that what you want to automate here. Try to develop a sample web page and try to post it here which can able to produce the issue. Also try to mention your overall requirement in detail. It can help us to understand the issue in better way. Thanks for your understanding."}], "owner": {"reputation": 21, "user_id": 7284581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2053b19996325dd246155bfd37e81eef?s=128&d=identicon&r=PG&f=1", "display_name": "questioner", "link": "https://stackoverflow.com/users/7284581/questioner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551849734, "creation_date": 1551849734, "question_id": 55016061, "link": "https://stackoverflow.com/questions/55016061/vba-excel-disable-enable-dropdown-in-ie", "title": "VBA excel Disable/Enable Dropdown in IE", "body": "<p>I want to automate a website that each time the dropdown menu is already clickable, I can select the next button. It has 3 dropdown menus. When nothing is selected in the dropdown menus, it is clickable, however when a value is selected, the button will be disabled for a moment (time varies cause each time a value is selected there is a processing occurred in the back end side).</p>\n\n<p>The source code of the button is like this:</p>\n\n<blockquote>\n  <p><strong>When the page is idle or nothing is selected.</strong></p>\n</blockquote>\n\n<pre><code>&lt;input name = \"m_ct103$txtvalue\" class=\"null\" id=\"m_ct103_txtValue\" style = \"\" type=\"text\"/&gt;\n</code></pre>\n\n<blockquote>\n  <p><strong>When a value is selected from the dropdown menu, the disabled property is visible.</strong></p>\n</blockquote>\n\n<pre><code>&lt;input name = \"m_ct104$txtvalue\" class=\"null\" disabled=\"disabled\" id=\"m_ct104_txtValue\" style = \"\" type=\"text\"/&gt;\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1551848306, "creation_date": 1551848306, "answer_id": 55015857, "question_id": 55015809, "link": "https://stackoverflow.com/questions/55015809/how-can-i-count-the-number-of-items-in-a-parameter-that-is-a-range/55015857#55015857", "title": "How can I count the number of items in a parameter that is a range?", "body": "<p>You can use: </p>\n\n<pre><code>ParameterName.Cells(ParameterName.Cells.Count)\n</code></pre>\n\n<p>...assuming a single-area range</p>\n"}], "owner": {"reputation": 3, "user_id": 5116428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fa98e083e118003c4b1a546593068d?s=128&d=identicon&r=PG&f=1", "display_name": "John Haas", "link": "https://stackoverflow.com/users/5116428/john-haas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551848306, "creation_date": 1551848005, "question_id": 55015809, "link": "https://stackoverflow.com/questions/55015809/how-can-i-count-the-number-of-items-in-a-parameter-that-is-a-range", "title": "How can I count the number of items in a parameter that is a range?", "body": "<p>I'm trying to write a custom function that need to do math with the first and last items in a range. I know the first is just <code>ParameterName(1)</code> but I know I need to count them for the last item. How would I do this?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "time-and-attendance"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1551846663, "post_id": 55015456, "comment_id": 96785225, "body": "Your code is incomplete, does not how you&#39;ve declared your variable (or if they are not explicitly declared in which case they should be by having an <code>Option Explicit</code> at the top, nor how you initialize the database. For all I can see, <code>db</code> is undeclared. Furthermore, I don&#39;t know whether <code>rs1</code> is implicitly declared as <code>ADODB.Recordset</code>, which would be a mismatch since <code>Database.OpenRecordset()</code> can only return a <code>DAO.Recordset</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1551849196, "post_id": 55015456, "comment_id": 96785928, "body": "Part of problem is lack of spaces at ends of FROM and WHERE lines building the SQL statement. Text is &#39;running together&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1551849498, "creation_date": 1551849498, "answer_id": 55016023, "question_id": 55015456, "link": "https://stackoverflow.com/questions/55015456/access-excelvba-type-mismatch/55016023#55016023", "title": "Access - Excel(VBA) - Type Mismatch", "body": "<pre><code>SQL1 = \"SELECT Name \" &amp; _\nSQL1 = SQL1 &amp; \"FROM February\" &amp; _\nSQL1 = SQL1 &amp; \"WHERE Gender = 'F'\" &amp; _\nSQL1 = SQL1 &amp; \"ORDER BY Name\"\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>SQL1 = \" SELECT Name \" &amp; _\n       \" FROM February\" &amp; _\n       \" WHERE Gender = 'F'\" &amp; _\n       \" ORDER BY Name\"\n</code></pre>\n\n<p>...or don't use the line continuation and use <code>SQL1 = SQL1 &amp;</code>, but you can only use <em>one</em> of those options.</p>\n"}], "owner": {"reputation": 7, "user_id": 11157441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FPjmgr9mmy0/AAAAAAAAAAI/AAAAAAAAAEU/J0ckjkTzNTs/photo.jpg?sz=128", "display_name": "Chedrick Rowy", "link": "https://stackoverflow.com/users/11157441/chedrick-rowy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551849498, "creation_date": 1551845604, "question_id": 55015456, "link": "https://stackoverflow.com/questions/55015456/access-excelvba-type-mismatch", "title": "Access - Excel(VBA) - Type Mismatch", "body": "<p>We're trying to load data from Access Database using VBA to Excel. But our code doesn't work fine.</p>\n\n<pre><code>SQL1 = \"SELECT Name \" &amp; _\nSQL1 = SQL1 &amp; \"FROM February\" &amp; _\nSQL1 = SQL1 &amp; \"WHERE Gender = 'F'\" &amp; _\nSQL1 = SQL1 &amp; \"ORDER BY Name\"\nSet rs1 = db.OpenRecordset(SQL1, dbOpenSnapshot)\n\n If rs1.RecordCount = 0 Then\n    MsgBox \"No data retrieved from database\", vbInformation + vbOKOnly, \"No Data\"\n     GoTo SubExit\n Else\n     rs1.MoveLast\n     recCount = rs1.RecordCount\n     rs1.MoveFirst\nEnd If\n  xlSheet.Range(\"B28\").CopyFromRecordset rs1\n</code></pre>\n\n<p>We're getting an error of \"Type Mismatched\" in the line:</p>\n\n<pre><code>Set rs1 = db.OpenRecordset(SQL1, dbOpenSnapshot)\n</code></pre>\n\n<p>Can anyone help us and explain us why we're getting that error?</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551848408, "post_id": 55015439, "comment_id": 96785704, "body": "Always best to show what you already tried, so folks can get a quicker start on helping you find a solution.  See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551848443, "post_id": 55015439, "comment_id": 96785712, "body": "what about formulas which have them? <code>C:\\Sample.xlsx</code> will end up as <code>C:\\\\Sample.xlsx</code>  and <code>=2^3</code> will become <code>=2\\^3</code> and so on..."}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551862332, "post_id": 55015439, "comment_id": 96791578, "body": "<a href=\"https://www.google.com/search?q=regular+expression+find+and+replace\" rel=\"nofollow noreferrer\">google.com/search?q=regular+expression+find+and+replace</a>"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551862408, "post_id": 55015439, "comment_id": 96791625, "body": "do a search and replace on the relevant ranges ( <a href=\"https://www.google.com/search?q=vba+excel+replace\" rel=\"nofollow noreferrer\">google.com/search?q=vba+excel+replace</a> )"}], "owner": {"reputation": 3, "user_id": 9360618, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160064933090088/picture?type=large", "display_name": "Hugh Wagner", "link": "https://stackoverflow.com/users/9360618/hugh-wagner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551882241, "creation_date": 1551845465, "last_edit_date": 1551882241, "question_id": 55015439, "link": "https://stackoverflow.com/questions/55015439/how-do-could-i-use-vba-regexp-or-other-function-in-excel-to-escape-special-cha", "title": "How do could I use VBA RegExp (or other function) in Excel to escape special characters?", "body": "<p>I need to be able to look through several ranges and add a \"\\\" before any of these characters #$%&amp;_{}~\\^ that are not already preceeded by a \"\\\".  Can anybody help?  I've been fooling around with this for a couple of hours and I know it should be simple to somebody who is more familiar with regular expressions.  If there is another simple way, that's fine too.  </p>\n\n<p>Below is my lame attempt at making this work.  I think that I need to include back references, but that is confounding me.</p>\n\n<pre><code>Function EC(code As Range)\n\n\n    Dim strPattern As String: strPattern = \"[^\\\\]+[#$%^&amp;_{}\\~]\"\n    Dim strReplace As String: strReplace = \"[\\]+[#$%^&amp;_{}\\~]\"\n    Dim myreplace As Long\n    Dim strInput As String\n    Dim Myrange As Range\n\n    Set RegEx = CreateObject(\"VBScript.RegExp\")\n\n    For Each cell In code\n        If strPattern &lt;&gt; \"\" Then\n            strInput = cell.Value\n\n            With RegEx\n                .Global = True\n                .MultiLine = True\n                .IgnoreCase = False\n                .Pattern = strPattern\n            End With\n            If RegEx.Test(strInput) Then\n                 EC = (RegEx.Replace(strInput, strReplace))\n            Else: EC = code.Value\n            End If\n        End If\n    Next\n    Set RegEx = Nothing\nEnd Function\n</code></pre>\n"}]