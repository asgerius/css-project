[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473291659, "post_id": 39380505, "comment_id": 66088854, "body": "You need to remove the <code>Selection</code> - the calculate event can fire when a worksheet isn&#39;t active."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6806755, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422349557793147/picture?type=large", "display_name": "Ken Tng", "link": "https://stackoverflow.com/users/6806755/ken-tng"}, "edited": false, "score": 0, "creation_date": 1473295028, "post_id": 39380626, "comment_id": 66089581, "body": "Thanks a million Thomas! You&#39;re a lifesaver!"}, {"owner": {"reputation": 11, "user_id": 6806755, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422349557793147/picture?type=large", "display_name": "Ken Tng", "link": "https://stackoverflow.com/users/6806755/ken-tng"}, "edited": false, "score": 0, "creation_date": 1473295776, "post_id": 39380626, "comment_id": 66089700, "body": "Sorry to bother you again, but now I have another issue. The raw data sheet (Sheet 2), has a user form embedded. Before the macro, the data is transferred to Sheet 2, however, with the macro working now, the data is transferred to Sheet 1. May I have your opinion on this issue? Thanks again!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 11, "user_id": 6806755, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422349557793147/picture?type=large", "display_name": "Ken Tng", "link": "https://stackoverflow.com/users/6806755/ken-tng"}, "edited": false, "score": 1, "creation_date": 1473297977, "post_id": 39380626, "comment_id": 66090153, "body": "There is really a need to use select or activate.  You should post your code and ask how to make it work without selecting Sheet1."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1473292540, "creation_date": 1473292540, "answer_id": 39380626, "question_id": 39380505, "link": "https://stackoverflow.com/questions/39380505/unable-to-call-macro/39380626#39380626", "title": "Unable to call macro", "body": "<p>You need to reference the <code>ListObjects</code> collection.  </p>\n\n<p>If there is only one table on the worksheet you can just reference the table by it's index</p>\n\n<pre><code>With Sheets(\"Sheet 1\")\n    .Select\n    .ListObjects(1).ListRows.Add AlwaysInsert:=True\nEnd With\nRange(\"BA10\").Select\n</code></pre>\n\n<p>If there are multiple you should reference the table by it's name </p>\n\n<pre><code>With Sheets(\"Sheet 1\")\n    .Select\n    .ListObjects(\"Table1\").ListRows.Add AlwaysInsert:=True\nEnd With\nRange(\"BA10\").Select\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6806755, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422349557793147/picture?type=large", "display_name": "Ken Tng", "link": "https://stackoverflow.com/users/6806755/ken-tng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473292540, "creation_date": 1473291464, "question_id": 39380505, "link": "https://stackoverflow.com/questions/39380505/unable-to-call-macro", "title": "Unable to call macro", "body": "<p>I am using Excel 2010 and I have been unable to call a macro. I have three worksheets, one where my chart (Sheet 1) is displayed and therein lies a table for a dynamic chart, a worksheet for raw data input (Sheet 2) and lastly a worksheet whereby data is formatted from the raw data through formulas (Sheet 3).</p>\n\n<p>The macro to insert the new row in the table is as follows:</p>\n\n<pre><code>Sub SBTrend()\n'\n' SBTrend Macro\n'\n\n'\n    Sheets(\"Sheet 1\").Select\n    Selection.ListObject.ListRows.Add AlwaysInsert:=True\n    Range(\"BA10\").Select\nEnd Sub\n</code></pre>\n\n<p>The code that I have to call the macro in Sheet 3 is as follows:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nStatic OldVal As Variant\nIf Range(\"A9\").Value &lt;&gt; OldVal Then\n    OldVal = Range(\"A9\").Value\n    Call SBTrend\nEnd If\nEnd Sub\n</code></pre>\n\n<p>However, I am always faced with the error \"Run-time error '91': Object variable or With block variable not set.\" And when I debug, this line gets highlighted:</p>\n\n<pre><code>Selection.ListObject.ListRows.Add AlwaysInsert:=True\n</code></pre>\n\n<p>I would really appreciate any and all the help I can get. Thank you everyone.</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1473291887, "post_id": 39380377, "comment_id": 66088918, "body": "Thank you very much @Tim Williams I had no idea how to account for the range."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1473290432, "creation_date": 1473290432, "answer_id": 39380377, "question_id": 39380341, "link": "https://stackoverflow.com/questions/39380341/macros-run-fine-when-ran-individually-but-not-when-called-one-after-another-by-b/39380377#39380377", "title": "Macros run fine when ran individually but not when called one after another by button", "body": "<p>You need to make sure you're qualifying all of your <code>Range</code> calls with a worksheet object:</p>\n\n<pre><code>Sub Fill_It_Down1()\n\n    With Sheets(\"Sheet1\")\n        .Range(\"D2:ZZ2\").AutoFill destination:= _\n               .Range(\"D2:ZZ\" &amp; .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row)\n    End with\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1473291819, "post_id": 39380385, "comment_id": 66088894, "body": "Thank you @Comintern That did it!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1473290481, "creation_date": 1473290481, "answer_id": 39380385, "question_id": 39380341, "link": "https://stackoverflow.com/questions/39380341/macros-run-fine-when-ran-individually-but-not-when-called-one-after-another-by-b/39380385#39380385", "title": "Macros run fine when ran individually but not when called one after another by button", "body": "<p><code>Range</code> is a property of a worksheet, so if your code is in a Sheet module, you need to explicitly reference the target worksheet:</p>\n\n<pre><code>Sub Fill_It_Down1()\nDim source As Worksheet\nSet source = Sheets(\"Sheet1\")\nWith source\n    .Range(\"D2:ZZ2\").AutoFill Destination:=.Range(\"D2:ZZ\" &amp; .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row)\nEnd With\nEnd Sub\n\nSub Fill_It_Down2()\nDim source As Worksheet\nSet source = Sheets(\"Sheet2\")\nsource.Range(\"C2:ZZ2\").AutoFill Destination:=source.Range(\"C2:ZZ2\" &amp; 100)\nEnd Sub\n\nSub Fill_It_Down3()\nDim source As Worksheet\nSet source = Sheets(\"Sheet3\")\nsource.Range(\"A2:ZZ2\").AutoFill Destination:=source.Range(\"A2:ZZ2\" &amp; 100)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 39380385, "answer_count": 2, "score": 1, "last_activity_date": 1473290481, "creation_date": 1473290131, "question_id": 39380341, "link": "https://stackoverflow.com/questions/39380341/macros-run-fine-when-ran-individually-but-not-when-called-one-after-another-by-b", "title": "Macros run fine when ran individually but not when called one after another by button", "body": "<p>I have a series of Macros that I want to run to Autofill sheets when I press a button. </p>\n\n<p>The first Macro called will AutoFill columns to the range of a specific column in that sheet, it runs perfectly fine. The rest of the sheets should be filled to the 100th row with whatever is on their row 2. </p>\n\n<p>This runs well when run one by one but when I press the button to run them all together ALL of the macros are applied to Sheet1 only. Instead of to the sheets I had specified.</p>\n\n<p>Also, It would be much better if all these were DownFilled rather than autofilled since the numbers get changed when I Autofill them and I need them to be repeats not increments.</p>\n\n<pre><code>Private Sub CommandButton1_Click()    \nFill_It_Down1\nFill_It_Down2\nFill_It_Down3\nEnd Sub\n</code></pre>\n\n<p>These are the macros I have written.</p>\n\n<pre><code>Sub Fill_It_Down1()\nDim source As Worksheet\nSet source = Sheets(\"Sheet1\")\nRange(\"D2:ZZ2\").AutoFill destination:=Range(\"D2:ZZ\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\nEnd Sub\n\nSub Fill_It_Down2()\nDim source As Worksheet\nSet source = Sheets(\"Sheet2\")\nRange(\"C2:ZZ2\").AutoFill destination:=Range(\"C2:ZZ2\" &amp; 100)\nEnd Sub\n\nSub Fill_It_Down3()\nDim source As Worksheet\nSet source = Sheets(\"Sheet3\")\nRange(\"A2:ZZ2\").AutoFill destination:=Range(\"A2:ZZ2\" &amp; 100)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473288814, "post_id": 39380078, "comment_id": 66088156, "body": "Try searching the VBA code for <code>.AllowDesignChanges</code> and <code>.ShortcutMenu</code>."}, {"owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473289301, "post_id": 39380078, "comment_id": 66088297, "body": "Thank you for that tip.  I searched using &quot;Current Project&quot;  but unfortunately it didn&#39;t return a match for either property."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473289628, "post_id": 39380078, "comment_id": 66088381, "body": "Hmmm... I&#39;m pretty sure there&#39;s a way to disable the shortcut menus globally, but unfortunately it&#39;s not something I ever use so I&#39;m not sure how to do it through the UI. Maybe search <code>.Visible = False</code> to see if you get hits on <code>CommandBars</code>?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1473289744, "post_id": 39380078, "comment_id": 66088415, "body": "Startup code is either called from a start form, or from an Autoexec macro. Make your way from there."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1473289991, "post_id": 39380078, "comment_id": 66088482, "body": "Perhaps this might help: <a href=\"http://stackoverflow.com/questions/15957315/disabling-design-view-in-ms-access\" title=\"disabling design view in ms access\">stackoverflow.com/questions/15957315/&hellip;</a>"}, {"owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "edited": false, "score": 0, "creation_date": 1473291343, "post_id": 39380078, "comment_id": 66088774, "body": "Thank you all so much! Andre and Comintern were both correct.  In the AutoExec proc there was a statement that disabled all CommandBars."}, {"owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473291354, "post_id": 39380078, "comment_id": 66088777, "body": "@Andre, thank you!"}, {"owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473291369, "post_id": 39380078, "comment_id": 66088779, "body": "@Comintern, thank you!"}, {"owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "edited": false, "score": 0, "creation_date": 1473291415, "post_id": 39380078, "comment_id": 66088796, "body": "Sorry for my ignorance but is there a way to indicate which comments solved this and also to indicate that this post is solved?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473291453, "post_id": 39380078, "comment_id": 66088803, "body": "@48_million - Not really.  I&#39;d just post a self-answer."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "is_accepted": false, "score": 1, "last_activity_date": 1473292251, "creation_date": 1473292251, "answer_id": 39380592, "question_id": 39380078, "link": "https://stackoverflow.com/questions/39380078/ms-access-right-click-on-object-is-disabled/39380592#39380592", "title": "MS Access - RIght-Click on object is disabled", "body": "<p>@Andre and @Comintern both provided correct answers.  The culprit was in the Auto Exec function and it had a loop that went through each CommandBar and set Enabled = False.</p>\n"}], "owner": {"reputation": 61, "user_id": 6806710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e36bd354da0d9b852b5fbf1be6970?s=128&d=identicon&r=PG&f=1", "display_name": "48_million", "link": "https://stackoverflow.com/users/6806710/48-million"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2456, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1473292251, "creation_date": 1473288205, "last_edit_date": 1473289481, "question_id": 39380078, "link": "https://stackoverflow.com/questions/39380078/ms-access-right-click-on-object-is-disabled", "title": "MS Access - RIght-Click on object is disabled", "body": "<p>I have recently taken a job that involves using an Access database to find information.  The database in question was built by a developer who left before it was completed.  He also didn't leave any documentation behind. </p>\n\n<p>The database uses queries, forms, and VBA.  Some of the queries are no longer valid since the source data has a different format than what it was when the database was developed.  I know SQL and some basic VBA so I'm trying to modify the SQL; however, I cannot view the SQL behind the queries. I can't open it in Design View or SQL View.  I can't even right-click on any object.  Not only that but when I open an object, I can't right click on the top tab to close it.  There's a red x that populates on the top-right that I have to use.  I've tried holding shift when opening the DB, but it still happens.  I also went to: menu option Tools -> Startup -> to see if 'Allow Default ShortCut Menus' was unchecked; however, it wasn't.  I've checked other forums but haven't been able to find a solution.  I think it may be in the VBA somewhere but there are tons of modules and each module has a boat-load of sub procedures in it.  I have no idea what else it could be.  Any and all insight would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473279921, "post_id": 39378307, "comment_id": 66084835, "body": "Where is <code>Me.OrderPrompts</code>? Is it asssigned to an object reference?"}, {"owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "edited": false, "score": 0, "creation_date": 1473280226, "post_id": 39378307, "comment_id": 66084966, "body": "Do you have any code of your Class object  and what&#39;s the function CallByName?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "edited": false, "score": 0, "creation_date": 1473282021, "post_id": 39378307, "comment_id": 66085760, "body": "@Thapipo <code>CallByName</code> is defined in the <code>VBA.Interaction</code> module, it&#39;s built-in."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473283144, "post_id": 39378307, "comment_id": 66086265, "body": "You&#39;ll have to <a href=\"https://stackoverflow.com/posts/39378307/edit\">edit</a> your post and show us the <code>Property Let</code> members being assigned here, and clarify which is throwing a <i>type mismatch</i> and which is throwing a <i>null not supported</i>. Otherwise it&#39;s nothing but guesswork."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473288364, "post_id": 39378307, "comment_id": 66088033, "body": "<code>Property Let</code>&#39;s are for primitive types.  You need to use <code>Property Set</code> for objects."}, {"owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "edited": false, "score": 0, "creation_date": 1473342321, "post_id": 39378307, "comment_id": 66111320, "body": "The solution to the original problem was that during the iteration of controls i was also picking up the label controls which do not have a .Value property and were throwing and error.  Also controls that were empty were also throwing an error because of how the properties were declared in the class as strings.  I switched all the declarations to variants and works no problem.  However now, i will be adopting the solution below to clean up the code"}], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "edited": false, "score": 0, "creation_date": 1473342103, "post_id": 39382920, "comment_id": 66111168, "body": "i really dig this.  You took my concept and improved it. I never thought about using the dictionary for the prompts.  This way i can get rid of my class entirely and just use my property.  Awesome! Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "edited": false, "score": 0, "creation_date": 1473347735, "post_id": 39382920, "comment_id": 66115315, "body": "I&#39;m glad that you liked it.  Thanks for accepting my answer."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1473310991, "creation_date": 1473310991, "answer_id": 39382920, "question_id": 39378307, "link": "https://stackoverflow.com/questions/39378307/saving-control-values-to-class-object-property/39382920#39382920", "title": "Saving Control Values to Class Object Property", "body": "<p>The short answer is to use <code>Prompt.Object.Value</code> for all the controls.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WWjgo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WWjgo.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Public Sub PrintControls()\n    Dim Prompt As Control\n    Dim PageIndex As Long\n\n    For PageIndex = 0 To Me.TabControl.Pages.Count - 1\n        For Each Prompt In TabControl.Pages(PageIndex).Controls\n            Debug.Print \"Name:\", Prompt.Name, \"Value:\", Prompt.Object.Value\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I really liked your concept so I wrote my own class to Save and Load control values.  My class saves references to the controls and their values for easy retrieval.   <a href=\"https://www.dropbox.com/s/4cwmehapl88ujgb/SaveControls.xlsm?dl=0\" rel=\"nofollow noreferrer\">Download Workbook</a></p>\n\n<p>When the Save button is clicked a reference to each control on the MultiPage is saved into a Scripting Dictionary.  The Dictionary is then added to an ArrayList and the Dictionary's index in the ArrayList is added to a ListBox.  When the ListBox is clicked the current settings are saved and the previous settings, corresponding to the Listbox's Value, are loaded.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MQJBl.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MQJBl.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>Class: SettingsDictionaryClass</h2>\n\n<pre><code>Option Explicit\nPrivate ControlSetting As Object\nPrivate mTabControl As MSForms.MultiPage\n\nSub Init(TabControl As MSForms.MultiPage)\n    Set mTabControl = TabControl\n    Set ControlSetting = CreateObject(\"System.Collections.ArrayList\")\n\nEnd Sub\n\nFunction Save() As Long\n    Dim subDict As Object: Set subDict = CreateObject(\"Scripting.Dictionary\")\n    Dim ctrl As MSForms.Control\n    Dim PageIndex As Long\n    With mTabControl\n        For PageIndex = 0 To .Pages.Count - 1\n            For Each ctrl In .Pages(PageIndex).Controls\n                subDict.Add ctrl, ctrl.Object.Value\n            Next\n        Next\n    End With\n    Save = ControlSetting.Count\n    ControlSetting.Add subDict\n\nEnd Function\n\nSub LoadValues(ListIndex As Long, Optional SaveCurrent As Boolean)\n    Dim ctrl\n    Dim Settings As Object\n\n    If SaveSetting Then Save\n\n    Set Settings = ControlSetting.Item(ListIndex)\n    For Each ctrl In Settings\n        ctrl.Value = Settings(ctrl)\n    Next\n\nEnd Sub\n</code></pre>\n\n<h2>Userform: Userform1</h2>\n\n<pre><code>Option Explicit\nPrivate SettingsDictionary As SettingsDictionaryClass\n\nPrivate Sub btnSave_Click()\n    lboSettings.AddItem SettingsDictionary.Save\nEnd Sub\n\nPrivate Sub lboSettings_Click()\n    SettingsDictionary.LoadValues lboSettings.Value, True\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Set SettingsDictionary = New SettingsDictionaryClass\n    SettingsDictionary.Init TabControl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "accepted_answer_id": 39382920, "answer_count": 1, "score": 1, "last_activity_date": 1473310991, "creation_date": 1473279348, "last_edit_date": 1473286635, "question_id": 39378307, "link": "https://stackoverflow.com/questions/39378307/saving-control-values-to-class-object-property", "title": "Saving Control Values to Class Object Property", "body": "<p>I have this userform that I has a bunch of controls on it, and the control name corresponds to a property name that i have defined inside <code>OrderPrompts</code>. </p>\n\n<p>When the user clicks on the save button, I am trying to save all those control values back to the original object <code>OrderPrompts</code>. </p>\n\n<p>Here's the order prompts classs\nOption Explicit</p>\n\n<pre><code>Private pSKU As String\nPrivate pWidth As String\nPrivate pHeight As String\nPrivate pDepth As String\nPrivate pLeftSwing As String\nPrivate pRightSwing As String\nPrivate pLeftFinishedEnd As String\nPrivate pRightFinishedEnd As String\nPrivate pToeKickHeight As String\nPrivate pAdjShelfQty As String\nPrivate pLeftStileWidth As String\nPrivate pRightStileWidth As String\nPrivate pTopRailWidth As String\nPrivate pBottomRailWidth As String\nPrivate pExtendLeftFFDown As String\nPrivate pExtendLeftFFUp As String\nPrivate pExtendRightFFDown As String\nPrivate pExtendRightFFUp As String\nPrivate pExtendTopRail As String\nPrivate pExtendBottomRail As String\nPrivate pBayHeightCalc As String\nPrivate pBay1Height As String\nPrivate pBay2Height As String\nPrivate pBay3Height As String\nPrivate pBay4Height As String\nPrivate pBay5Height As String\nPrivate pBayWidthCalc As String\nPrivate pBay1Width As String\nPrivate pBay2Width As String\nPrivate pBay3Width As String\nPrivate pBay4Width As String\nPrivate pBay5Width As String\nPrivate pDrawerFrontCalc As String\nPrivate pTopDrawerFront As String\nPrivate pSecondDrawerFront As String\nPrivate pThirdDrawerFront As String\nPrivate pBottomDrawerFront As String\n\nPublic Property Get SKU() As String\nSKU = pSKU\nEnd Property\n\nPublic Property Let SKU(Value As String)\npSKU = Value\nEnd Property\n\nPublic Property Get Width() As String\nWidth = pWidth\nEnd Property\n\nPublic Property Let Width(Value As String)\npWidth = Value\nEnd Property\n\nPublic Property Get Height() As String\nHeight = pHeight\nEnd Property\n\nPublic Property Let Height(Value As String)\npHeight = Value\nEnd Property\n\nPublic Property Get Depth() As String\nDepth = pDepth\nEnd Property\n\nPublic Property Let Depth(Value As String)\npDepth = Value\nEnd Property\n\nPublic Property Get LeftSwing() As String\nLeftSwing = pLeftSwing\nEnd Property\n\nPublic Property Let LeftSwing(Value As String)\npLeftSwing = Value\nEnd Property\n\nPublic Property Get RightSwing() As String\nRightSwing = pRightSwing\nEnd Property\n\nPublic Property Let RightSwing(Value As String)\npRightSwing = Value\nEnd Property\n\nPublic Property Get LeftFinishedEnd() As String\nLeftFinishedEnd = pLeftFinishedEnd\nEnd Property\n\nPublic Property Let LeftFinishedEnd(Value As String)\npLeftFinishedEnd = Value\nEnd Property\n\nPublic Property Get RightFinishedEnd() As String\nRightFinishedEnd = pRightFinishedEnd\nEnd Property\n\nPublic Property Let RightFinishedEnd(Value As String)\npRightFinishedEnd = Value\nEnd Property\n\nPublic Property Get ToeKickHeight() As String\nToeKickHeight = pToeKickHeight\nEnd Property\n\nPublic Property Let ToeKickHeight(Value As String)\npToeKickHeight = Value\nEnd Property\n\nPublic Property Get AdjShelfQty() As String\nAdjShelfQty = pAdjShelfQty\nEnd Property\n\nPublic Property Let AdjShelfQty(Value As String)\npAdjShelfQty = Value\nEnd Property\n\nPublic Property Get LeftStileWidth() As String\nLeftStileWidth = pLeftStileWidth\nEnd Property\n\nPublic Property Let LeftStileWidth(Value As String)\npLeftStileWidth = Value\nEnd Property\n\nPublic Property Get RightStileWidth() As String\nRightStileWidth = pRightStileWidth\nEnd Property\n\nPublic Property Let RightStileWidth(Value As String)\npRightStileWidth = Value\nEnd Property\n\nPublic Property Get TopRailWidth() As String\nTopRailWidth = pTopRailWidth\nEnd Property\n\nPublic Property Let TopRailWidth(Value As String)\npTopRailWidth = Value\nEnd Property\n\nPublic Property Get BottomRailWidth() As String\nBottomRailWidth = pBottomRailWidth\nEnd Property\n\nPublic Property Let BottomRailWidth(Value As String)\npBottomRailWidth = Value\nEnd Property\n\nPublic Property Get ExtendLeftFFDown() As String\nExtendLeftFFDown = pExtendLeftFFDown\nEnd Property\n\nPublic Property Let ExtendLeftFFDown(Value As String)\npExtendLeftFFDown = Value\nEnd Property\n\nPublic Property Get ExtendLeftFFUp() As String\nExtendLeftFFUp = pExtendLeftFFUp\nEnd Property\n\nPublic Property Let ExtendLeftFFUp(Value As String)\npExtendLeftFFUp = Value\nEnd Property\n\nPublic Property Get ExtendRightFFDown() As String\nExtendRightFFDown = pExtendRightFFDown\nEnd Property\n\nPublic Property Let ExtendRightFFDown(Value As String)\npExtendRightFFDown = Value\nEnd Property\n\nPublic Property Get ExtendRightFFUp() As String\nExtendRightFFUp = pExtendRightFFUp\nEnd Property\n\nPublic Property Let ExtendRightFFUp(Value As String)\npExtendRightFFUp = Value\nEnd Property\n\nPublic Property Get ExtendTopRail() As String\nExtendTopRail = pExtendTopRail\nEnd Property\n\nPublic Property Let ExtendTopRail(Value As String)\npExtendTopRail = Value\nEnd Property\n\nPublic Property Get ExtendBottomRail() As String\nExtendBottomRail = pExtendBottomRail\nEnd Property\n\nPublic Property Let ExtendBottomRail(Value As String)\npExtendBottomRail = Value\nEnd Property\n\nPublic Property Get BayHeightCalc() As String\nBayHeightCalc = pBayHeightCalc\nEnd Property\n\nPublic Property Let BayHeightCalc(Value As String)\npBayHeightCalc = Value\nEnd Property\n\nPublic Property Get Bay1Height() As String\nBay1Height = pBay1Height\nEnd Property\n\nPublic Property Let Bay1Height(Value As String)\npBay1Height = Value\nEnd Property\n\nPublic Property Get Bay2Height() As String\nBay2Height = pBay2Height\nEnd Property\n\nPublic Property Let Bay2Height(Value As String)\npBay2Height = Value\nEnd Property\n\nPublic Property Get Bay3Height() As String\nBay3Height = pBay3Height\nEnd Property\n\nPublic Property Let Bay3Height(Value As String)\npBay3Height = Value\nEnd Property\n\nPublic Property Get Bay4Height() As String\nBay4Height = pBay4Height\nEnd Property\n\nPublic Property Let Bay4Height(Value As String)\npBay4Height = Value\nEnd Property\n\nPublic Property Get Bay5Height() As String\nBay5Height = pBay5Height\nEnd Property\n\nPublic Property Let Bay5Height(Value As String)\npBay5Height = Value\nEnd Property\n\nPublic Property Get BayWidthCalc() As String\nBayWidthCalc = pBayWidthCalc\nEnd Property\n\nPublic Property Let BayWidthCalc(Value As String)\npBayWidthCalc = Value\nEnd Property\n\nPublic Property Get Bay1Width() As String\nBay1Width = pBay1Width\nEnd Property\n\nPublic Property Let Bay1Width(Value As String)\npBay1Width = Value\nEnd Property\n\nPublic Property Get Bay2Width() As String\nBay2Width = pBay2Width\nEnd Property\n\nPublic Property Let Bay2Width(Value As String)\npBay2Width = Value\nEnd Property\n\nPublic Property Get Bay3Width() As String\nBay3Width = pBay3Width\nEnd Property\n\nPublic Property Let Bay3Width(Value As String)\npBay3Width = Value\nEnd Property\n\nPublic Property Get Bay4Width() As String\nBay4Width = pBay4Width\nEnd Property\n\nPublic Property Let Bay4Width(Value As String)\npBay4Width = Value\nEnd Property\n\nPublic Property Get Bay5Width() As String\nBay5Width = pBay5Width\nEnd Property\n\nPublic Property Let Bay5Width(Value As String)\npBay5Width = Value\nEnd Property\n\nPublic Property Get DrawerFrontCalc() As String\nDrawerFrontCalc = pDrawerFrontCalc\nEnd Property\n\nPublic Property Let DrawerFrontCalc(Value As String)\npDrawerFrontCalc = Value\nEnd Property\n\nPublic Property Get TopDrawerFront() As String\nTopDrawerFront = pTopDrawerFront\nEnd Property\n\nPublic Property Let TopDrawerFront(Value As String)\npTopDrawerFront = Value\nEnd Property\n\nPublic Property Get SecondDrawerFront() As String\nSecondDrawerFront = pSecondDrawerFront\nEnd Property\n\nPublic Property Let SecondDrawerFront(Value As String)\npSecondDrawerFront = Value\nEnd Property\n\nPublic Property Get ThirdDrawerFront() As String\nThirdDrawerFront = pThirdDrawerFront\nEnd Property\n\nPublic Property Let ThirdDrawerFront(Value As String)\npThirdDrawerFront = Value\nEnd Property\n\nPublic Property Get BottomDrawerFront() As String\nBottomDrawerFront = pBottomDrawerFront\nEnd Property\n\nPublic Property Let BottomDrawerFront(Value As String)\npBottomDrawerFront = Value\nEnd Property\n</code></pre>\n\n<p>Here's how OrderPrompts is defined inside the form control</p>\n\n<pre><code>Public Property Get OrderPrompts() As clsOrderPromptRow\nSet OrderPrompts = pOrderPrompts\nEnd Property\n\nPublic Property Let OrderPrompts(Value As clsOrderPromptRow)\nSet pOrderPrompts = Value\nEnd Property\n</code></pre>\n\n<p>Here's the code I have for the button click</p>\n\n<pre><code>Private Sub btnSave_Click()\nDim Prompt As Control\nDim PageIndex As Long\n\nFor PageIndex = 0 To Me.TabControl.Pages.Count - 1\n    For Each Prompt In TabControl.Pages(PageIndex).Controls\n        'MsgBox (TypeName(Prompt))\n        'CallByName(Me.ProductPromptMapping, PromptControl.ControlName, VbGet)\n        Select Case TypeName(Prompt)\n            Case \"TextBox\"\n                CallByName Me.OrderPrompts, Prompt.Name, VbLet, Prompt.Text\n            Case \"OptionButton\"\n                CallByName Me.OrderPrompts, Prompt.Name, VbLet, Prompt.ControlFormat.Value\n            Case \"CheckBox\"\n                CallByName Me.OrderPrompts, Prompt.Name, VbLet, CStr(Prompt.Value)\n            Case \"ComboBox\"\n                CallByName Me.OrderPrompts, Prompt.Name, VbLet, Prompt.Value\n        End Select\n    Next\nNext\nMsgBox (OrderPrompts.Width)\nMe.Hide\nEnd Sub\n</code></pre>\n\n<p>The problem i am having is with saving the Checkbox, Combobox, and OptionButton values back to the object. The textbox value works just fine. So I am not sure what to fix. I keep getting either a type mismatch error or null not supported.</p>\n\n<p>Any help is appreciated.  Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-indirect"], "comments": [{"owner": {"reputation": 2864, "user_id": 1128558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b83be06b95cf0999ccbb4715dafa1019?s=128&d=identicon&r=PG", "display_name": "elijah", "link": "https://stackoverflow.com/users/1128558/elijah"}, "edited": false, "score": 0, "creation_date": 1473279291, "post_id": 39378103, "comment_id": 66084548, "body": "check out <a href=\"http://stackoverflow.com/questions/28461672/how-to-referencing-value-in-closed-excel-workbook-by-formula-incl-variable-shee\" title=\"how to referencing value in closed excel workbook by formula incl variable shee\">stackoverflow.com/questions/28461672/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1473279573, "post_id": 39378103, "comment_id": 66084663, "body": "<i>so far this formula works but only for open workbooks</i> - if you open the closed workbooks, does it work for them then?"}, {"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473280661, "post_id": 39378103, "comment_id": 66085131, "body": "yes it does work only when open but as soon as you close it and the workbook refreshes the values disappear"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473280779, "post_id": 39378408, "comment_id": 66085178, "body": "as soon as you close the source workbooks and the destination workbook refreshes the values disappear. I would write a VBA but my skills are on lvl 1/10"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1473281036, "post_id": 39378408, "comment_id": 66085290, "body": "@Kevin I suggest you add that there is a function called INDIRECT.EXT in morefunc.xll or a UDF macro called PULL that will do what OP asks."}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "edited": false, "score": 0, "creation_date": 1473281076, "post_id": 39378408, "comment_id": 66085313, "body": "Correct, once it leaves memory Indirect() will calculate again since it is volatile. I&#39;m thinking of a simple UDF function you can use rather than a larger loop."}, {"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473282234, "post_id": 39378408, "comment_id": 66085845, "body": "Thank you guys, I have tried installing INDIRECT.EXT but havent had any luck with that either, I have Excel 2016"}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "reply_to_user": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473284220, "post_id": 39378408, "comment_id": 66086651, "body": "@Allan, added a function and instructions on how you can add it and use it."}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1473284263, "post_id": 39378408, "comment_id": 66086666, "body": "@Andreas thanks for advice, wouldn&#39;t want to leave Allan out to dry on this :)"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473309677, "post_id": 39378408, "comment_id": 66092697, "body": "Plus one from me. @Allan you should accept the answer with the button left of Kevins answer"}, {"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473374238, "post_id": 39378408, "comment_id": 66128441, "body": "@Kevin Thank you! I will try this and let you know how it goes!! :-)"}, {"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473444024, "post_id": 39378408, "comment_id": 66159373, "body": "so technically speaking after proceeding with the steps and code you provided, each cell that needs to be populated should have something like this?  =Getfield(&quot;&#39;\\\\server5\\Operations\\testing&#91;&quot;&amp;A6&amp;&quot;]Summary&#39;&zwnj;&#8203;!$E9&quot;) where in active workbook contains the file name, and Summary E9 is the cell to extract from provided file name on A6."}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "edited": false, "score": 0, "creation_date": 1473451126, "post_id": 39378408, "comment_id": 66162818, "body": "It would be <code>=GetField(&quot;\\\\server5\\Operations\\testing\\&quot;&amp;A6,&quot;Summary&quot;,&quot;E9&quot;)</code>&zwnj;&#8203;, where A6 is ThisFile.xlsx"}, {"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473955959, "post_id": 39378408, "comment_id": 66347324, "body": "Hello @Kevin, Just FIY it seems like this piece of code opens all reffered workbooks copy and paste but it does not close them. they still open in the back ground. Tried adding &quot;SaveChanges:=False&quot; to the end of wb.Close but that didn&#39;t work either... any clues?"}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "reply_to_user": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 0, "creation_date": 1473963580, "post_id": 39378408, "comment_id": 66351401, "body": "@AllanPtacnik Try the edited code. They <i>should</i> be closing but recalculations could be causing this."}, {"owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "edited": false, "score": 1, "creation_date": 1474042284, "post_id": 39378408, "comment_id": 66385992, "body": "@Kevin For some reason, This did not work either way, workbooks don&#39;t get closed and cells get 0.000"}], "tags": [], "owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "is_accepted": true, "score": 2, "last_activity_date": 1473963390, "last_edit_date": 1495542762, "creation_date": 1473279837, "answer_id": 39378408, "question_id": 39378103, "link": "https://stackoverflow.com/questions/39378103/excel-cell-reference-from-closed-workbook-using-file-name-in-cell/39378408#39378408", "title": "Excel cell reference from closed workbook using file name in cell", "body": "<p>According to Microsoft, the Indirect() function must have the workbook opened. You could cycle through the directory with VBA to get the cell values using this route.</p>\n\n<p>Got a UDF and below is how you'd add it:</p>\n\n<ul>\n<li><p>Open Visual Basic editor in excel (Development tab of the Ribbon - you may need to go into Excel options to unhide it). </p></li>\n<li><p>Right click VBA Project([Your workbookname]), highlight insert and then click module. </p></li>\n<li><p>Paste the below in module1 and save the workbook as a .xlsm.</p></li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>Function GetField(Path As String, WorksheetName As String, CellRange As String) As Variant\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rng As Range\n\n    Set wb = GetObject(Path)\n    Set ws = wb.Worksheets(WorksheetName)\n    Set rng = ws.Range(CellRange)\n\n    Application.DisplayAlerts = False\n    wb.Saved = True            \n    wb.Close SaveChanges:=False\n    Application.DisplayAlerts = True\nEnd Function\n</code></pre>\n\n<p>You can then use =GetField() in this workbook only.</p>\n\n<p>Parameters:\n=getfield(\"\\server5\\Operations\\MainBoard testing central location DO NOT REMOVE or RENAME\\\"&amp;A6,\"Summary\",\"E9\")</p>\n\n<p>Only tested with one file, but you should be able to use cell references, filenames, etc in rows/columns for more than one.</p>\n\n<p>-Confirmed this works on multiple Rows/Columns</p>\n\n<p>Edit: Changed how workbooks are closed from some code provided by <a href=\"https://stackoverflow.com/questions/11220537/vba-workbooks-close-without-being-prompted-to-if-the-user-wants-to-save\">Alistair Weir</a> in another issue.</p>\n"}], "owner": {"reputation": 49, "user_id": 6801394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m0ESM.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/6801394/allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6834, "favorite_count": 1, "accepted_answer_id": 39378408, "answer_count": 1, "score": 0, "last_activity_date": 1473963390, "creation_date": 1473278405, "last_edit_date": 1473279855, "question_id": 39378103, "link": "https://stackoverflow.com/questions/39378103/excel-cell-reference-from-closed-workbook-using-file-name-in-cell", "title": "Excel cell reference from closed workbook using file name in cell", "body": "<p>I have a central location that contains 96 xls files; each of these 96 files represent an individual test located here:</p>\n\n<p>\"\\server5\\Operations\\MainBoard testing central location DO NOT REMOVE or RENAME\"</p>\n\n<p>I created an Excel workbook to input all the information of each individual test on to a single sheet. Then, I used a VBA to pull the names of the files and add a link to the file on a second sheet on the same workbook. I linked those files to sheet 1.</p>\n\n<p>Next, I added all the information on the top row corresponding to the test performed broken down in to a single line per workbook (Test).</p>\n\n<p>Now I need to populate sheet 1 on the new workbook (Advanced Main board test log.xlsx)</p>\n\n<p>So far this formula works, but only for open workbooks:</p>\n\n<pre><code>=INDIRECT(\"'\\\\server5\\Operations\\MainBoard testing central location DO NOT REMOVE or RENAME\\[\"&amp;A7&amp;\"]Summary'!$E9\")\n</code></pre>\n\n<p>Where A7 represents the column of filenames which ranges from A6 to A103</p>\n\n<p>Summary E9 is the cell I would like to enter in cell C7</p>\n\n<p><a href=\"http://i.stack.imgur.com/DRNzJ.jpg\" rel=\"nofollow\">Excel capture of C7</a></p>\n\n<p>Please note the populated values, this is because I have those 2 work books open, All #REF! cells contain the same formula as the populated cells.</p>\n\n<p>please let me know if you need any additional information to accomplish this tedious task</p>\n\n<p>I also tried doing Microsoft recommended method:</p>\n\n<pre><code>='[20160613 1002257 35000010-01B.xls]Summary'!$E9\n</code></pre>\n\n<p>replaced file name with cell containing file name:</p>\n\n<pre><code>='[\"&amp;A7&amp;\"]Summary'!$E9\n</code></pre>\n\n<p>and I get #REF! in the cell and formula bar automatically changes to:</p>\n\n<pre><code>='(\\\\server5\\Operations\\MainBoard testing central location DO NOT REMOVE or RENAME\\[\"&amp;A7&amp;\"]Summary'!$E9\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1473278187, "post_id": 39378022, "comment_id": 66084037, "body": "Please read <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and edit your question."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1473280798, "post_id": 39378022, "comment_id": 66085185, "body": "One suggestion is to separate your code into different functions/subs based on what is needed. For example, the code for the user to use a <code>FileDialog</code> to select previous and current dBase files could be collapsed into a single functional call (probably returning the opened workbook itself). Then your range comparison code can be isolated in a <code>Function</code> or <code>Sub</code> as well. You can capture your <code>Range</code> into an array in a single statement (see <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/3830/work-with-arrays-not-with-ranges#t=201609072038348917869\">this</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6377866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022479605ffaad493e826297db85b5e8?s=128&d=identicon&r=PG&f=1", "display_name": "BKruk", "link": "https://stackoverflow.com/users/6377866/bkruk"}, "edited": false, "score": 0, "creation_date": 1473442426, "post_id": 39380059, "comment_id": 66158559, "body": "I have corrected the indexing errors by finding the larger row count and reDim the array before filling it."}, {"owner": {"reputation": 11, "user_id": 6377866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022479605ffaad493e826297db85b5e8?s=128&d=identicon&r=PG&f=1", "display_name": "BKruk", "link": "https://stackoverflow.com/users/6377866/bkruk"}, "edited": false, "score": 0, "creation_date": 1473443031, "post_id": 39380059, "comment_id": 66158874, "body": "As for the last correction (Over-running the array bound) My solution is to instead of filling a 2D Array with both records I will fill an array with row index numbers and then use that to copy. The execution is very slow, I think I am making this much harder than it should be. The objective was to compare two exported dBase files (from ESRI AcrMap) and put any records that differ next to each other so I can easily see what has changed."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1473288045, "last_edit_date": 1495540109, "creation_date": 1473288045, "answer_id": 39380059, "question_id": 39378022, "link": "https://stackoverflow.com/questions/39378022/issues-with-comparing-two-workbooks/39380059#39380059", "title": "Issues with comparing two workbooks", "body": "<p>This code has several indexing errors.  The first one is here:</p>\n\n<pre><code>OldRC = PreviousWB.Sheets(\"Export_Output\").UsedRange.Rows.Count\nOldCC = PreviousWB.Sheets(\"Export_Output\").UsedRange.Columns.Count\n'...\nReDim PreviousRecord(OldRC, OldCC)\n'...\n\nNewRC = CurrentWB.Sheets(\"Export_Output\").UsedRange.Rows.Count\nNewCC = CurrentWB.Sheets(\"Export_Output\").UsedRange.Columns.Count\n'...\nReDim CurrentRecord(NewRC, NewCC)\n\nFor i = 1 To NewRC\n    For j = 1 To NewCC\n        PreviousRecord(i, j) = ActiveCell.Value\n</code></pre>\n\n<p>You're setting the size of PreviousRecord based on <code>OldRC</code> and <code>OldCC</code>, but your loop counters are based on <code>NewRC</code> and <code>NewCC</code>.</p>\n\n<p>The second one is here.  Only the <em>last bound</em> of an array can be changed with the <code>Preserve</code> keyword.  See <a href=\"https://stackoverflow.com/a/38778728/4088852\">this answer</a> for an explanation of why.</p>\n\n<pre><code>If NewRC &gt; OldRC Then\n    ReDim Preserve PreviousRecord(NewRC, NewCC)\n    MaxRC = NewRC\nElse\n    ReDim Preserve CurrentRecord(OldRC, OldCC)\n    MaxRC = OldRC\nEnd If\n</code></pre>\n\n<p>If your code makes it far enough, you pretty much ensure the same error as above here:</p>\n\n<pre><code>For i = 1 To MaxRC\n    For j = 1 To MaxCC\n        If Not PreviousRecord(i, j) = CurrentRecord(i, j) Then\n            RecordChange = RecordChange + 1\n            ReDim Preserve ChangedRecord(RecordChange, MaxCC)\n</code></pre>\n\n<p>In this section, you don't do anything to prevent <code>l</code> from over-running the array bound - it is based entirely on how many mismatches you have:</p>\n\n<pre><code>For k = 1 To MaxCC\n    ChangedRecord(l, k) = PreviousRecord(i, k)\n    ChangedRecord(l + 1, k) = CurrentRecord(i, k)\n    l = l + 2\nNext k\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6377866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022479605ffaad493e826297db85b5e8?s=128&d=identicon&r=PG&f=1", "display_name": "BKruk", "link": "https://stackoverflow.com/users/6377866/bkruk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473288045, "creation_date": 1473277964, "last_edit_date": 1531164843, "question_id": 39378022, "link": "https://stackoverflow.com/questions/39378022/issues-with-comparing-two-workbooks", "title": "Issues with comparing two workbooks", "body": "<p>I am trying to compare a worksheet from two different workbooks and cant seem to get this right. I have read many times that using arrays are inefficient but every time a try the suggested solutions I get nowhere. </p>\n\n<p>The following problems are happening \nRuntime error 9 subscript out of range </p>\n\n<p>when I debug it is related to filling the array, but it should not be out of range i from 1 to (in this case_ 1487) but error on 1486 so I am still within the range. </p>\n\n<p>I want to skip this error so I can see if there are any other problems so at the top I have on error goto 0 </p>\n\n<p>Bypassing the error the program continues but will not print the different records. If anyone can take a look at this I would be much appreciated. </p>\n\n<p>I can send you the files that I am working with at your request\nAlso the compare code is below </p>\n\n<pre><code>Option Base 1\n\nSub GatherInfo()\n\nDim CurrentRecord() As Variant\nDim PreviousRecord() As Variant\nDim ChangedRecord() As Variant\n\nDim WasCancled As Integer\nDim RecordChange As Integer\n\nDim CurrentFile As String\nDim PreviousFile As String\nDim CurrentWB As Excel.Workbook\nDim PreviousWB As Excel.Workbook\n\nDim OldRC As Integer\nDim NewRC As Integer\nDim OldCC As Integer\nDim NewCC As Integer\nDim MaxRC As Integer\nDim MaxCC As Integer\n\n\n\n'Allow user to select the older version of the dBase\n\nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = False  'Allow only one fiel selection\n\n'Application.FileDialog(msoFileDialogOpen).InitialFileName = \"C:\\Users\\bkrukowski\\Desktop\\Paving DataBase\" 'Point to the file folder\n\nApplication.FileDialog(msoFileDialogOpen).Title = \"SELECT THE OLDER VERSION FOR COMPARISON:\" ' Create a title in open dialog box to specify what file to open\n\nWasCancled = Application.FileDialog(msoFileDialogOpen).Show ' Show the selection\n\nIf WasCancled &lt;&gt; 0 Then\n\nPreviousFile = Application.FileDialog(msoFileDialogOpen).SelectedItems(1) ' PreviousFile now has the address of the file\n\nElse\n\nExit Sub\n\nEnd If\n\n\n'Allow user to select current version of dBase\n\nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = False 'Allow only one fiel selection\n\n'Application.FileDialog(msoFileDialogOpen).InitialFileName = \"C:\\Users\\bkrukowski\\Desktop\\Paving DataBase\" 'Point to the file folder\n\nApplication.FileDialog(msoFileDialogOpen).Title = \"SELECT THE NEWER VERSION FOR COMPARISON:\" ' Create a title in open dialog box to specify what file to open\n\nWasCancled = Application.FileDialog(msoFileDialogOpen).Show ' Show the selection\n\nIf WasCancled &lt;&gt; 0 Then\n\nCurrentFile = Application.FileDialog(msoFileDialogOpen).SelectedItems(1) ' CerrentFile now has the address of the file\n\nElse\n\nExit Sub\n\nEnd If\n\nApplication.ScreenUpdating = False\n\n\n'Open the previous version\n\nSet PreviousWB = Workbooks.Open(PreviousFile)\n\n'Determine the Size of Array needed\n\nOldRC = PreviousWB.Sheets(\"Export_Output\").UsedRange.Rows.Count\nOldCC = PreviousWB.Sheets(\"Export_Output\").UsedRange.Columns.Count\n\nPreviousWB.Worksheets(\"Export_Output\").Range(\"A1\").Activate\n\n\nReDim PreviousRecord(OldRC, OldCC)\n\n' Fill the array\nFor i = 1 To OldRC\n\n    For j = 1 To OldCC\n\n        PreviousRecord(i, j) = ActiveCell.Value\n\n        ActiveCell.Offset(0, 1).Activate\n\n        If j = OldCC Then\n\n         ActiveCell.Offset(1, -j).Activate\n\n\n         End If\n\n\n        Next j\n\nNext i\n\n\n'Open the current version\nSet CurrentWB = Workbooks.Open(CurrentFile)\n\n\n'Determine the Size of Array needed\n\nNewRC = CurrentWB.Sheets(\"Export_Output\").UsedRange.Rows.Count\nNewCC = CurrentWB.Sheets(\"Export_Output\").UsedRange.Columns.Count\n\nCurrentWB.Worksheets(\"Export_Output\").Range(\"A1\").Activate\n\n\nReDim CurrentRecord(NewRC, NewCC)\n\n'Fill the Array\n\nFor i = 1 To NewRC\n\n    For j = 1 To NewCC\n\n        PreviousRecord(i, j) = ActiveCell.Value\n\n        ActiveCell.Offset(0, 1).Activate\n\n        If j = NewCC Then\n\n         ActiveCell.Offset(1, -j).Activate\n\n\n         End If\n\n\n        Next j\n\nNext i\n\n'Ensure array dimentions are same\n\nIf Not OldRC = NewRC Then\n\n    If NewRC &gt; OldRC Then\n\n        ReDim Preserve PreviousRecord(NewRC, NewCC)\n\n        MaxRC = NewRC\n\n    Else\n\n        ReDim Preserve CurrentRecord(OldRC, OldCC)\n\n        MaxRC = OldRC\n\n    End If\n\n    Else\n\n        MaxRC = NewRC\nEnd If\n\n\n    MaxCC = NewCC\n\nRecordChange = 0\nl = 1\n'Begin comparing Data - If any item on a Row is diffrent from the previous copy the entrie row into new array\n\nFor i = 1 To MaxRC\n    For j = 1 To MaxCC\n\n        If Not PreviousRecord(i, j) = CurrentRecord(i, j) Then\n\n            RecordChange = RecordChange + 1\n\n            ReDim Preserve ChangedRecord(RecordChange, MaxCC)\n\n            For k = 1 To MaxCC\n\n                ChangedRecord(l, k) = PreviousRecord(i, k)\n                ChangedRecord(l + 1, k) = CurrentRecord(i, k)\n                l = l + 2\n\n                Next k\n            End If\n\n            Next j\n            Next i\n\n\nWorkbooks(\"CompareThis\").Sheets(\"Sheet1\").Activate\nRange(\"A1\").Activate\n\nFor i = 1 To RecordChange\n\n    For j = 1 To MaxCC\n\n        ActiveCell.Value = ChangedRecord(i, j)\n        ActiveCell.Offset(1, j).Activate\n    Next j\n    Next i\n\n\nApplication.ScreenUpdating = True\n\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for any help you can offer.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473274248, "post_id": 39377119, "comment_id": 66082188, "body": "<code>Dim n As Long</code> and <code>Dim I as Long</code>, 300,000 well exceeds the limit of integer data type. Also, please consider showing what you&#39;re doing inside the loop."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473274327, "post_id": 39377119, "comment_id": 66082220, "body": "If a loop is necessary (and it may not be) you could use <code>Do While</code> loop instead of <code>For</code> loop, with criteria to exit when the cell value is empty."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473274652, "post_id": 39377119, "comment_id": 66082381, "body": "Ideally, instead of using hard-coded <code>Workseets(&quot;Sheet6&quot;).Range(&quot;D:D&quot;)</code> you&#39;ll define a proper Range variable that represents only the rows/data you want to process."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5731874, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/416cabe7ab1d7175caa263954b3cad8d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahsan Khan", "link": "https://stackoverflow.com/users/5731874/ahsan-khan"}, "edited": false, "score": 0, "creation_date": 1473280753, "post_id": 39377425, "comment_id": 66085164, "body": "Range.Replace only returns a Boolean function. It is giving TRUE for every cell in the column"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1473285815, "last_edit_date": 1473285815, "creation_date": 1473275271, "answer_id": 39377425, "question_id": 39377119, "link": "https://stackoverflow.com/questions/39377119/vba-replacing-space-bars-with-blank-spaces/39377425#39377425", "title": "VBA: Replacing space bars with blank spaces?", "body": "<p>Your attempt uses the <code>String.Replace</code> function and causes a mismatch error, because you're passing a variant/range to a function which expects a string. </p>\n\n<pre><code>'Replacing all spaces in a column by blanks\nWorkseets(\"Sheet6\").Range(\"D:D\") = Replace(Worksheets(\"Sheet6\").Range(\"D:D\"),\" \",\"\")\n</code></pre>\n\n<p>A solution is to use the <code>Range.Replace</code> method, instead. No assignment is necessary, the method operates on the range object which calls it. This copies the values directly and replaces the empty string</p>\n\n<pre><code>'Replacing all spaces in a column by blanks\n With Worksheets(\"Sheet6\").Range(\"D:D\")\n    .Value = .Value2\n    .Replace \" \", \"\", xlWhole\n End With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473279533, "post_id": 39378311, "comment_id": 66084652, "body": "If the range has spaces or other non-printing characters, or contains formula which output same, the UsedRange will not be reliable. (There are other reasons why UsedRange is not always reliable, too!)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473279895, "post_id": 39378311, "comment_id": 66084822, "body": "From the OP there: <i>it assigns the formula to entire column but only few of them have actual values</i>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473284781, "post_id": 39378311, "comment_id": 66086854, "body": "Rather than get in a pissing match about this, it would&#39;ve been much more appropriate for you to simply <i>edit</i> my answer for what is an obvious oversight."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1473279386, "creation_date": 1473279386, "answer_id": 39378311, "question_id": 39377119, "link": "https://stackoverflow.com/questions/39377119/vba-replacing-space-bars-with-blank-spaces/39378311#39378311", "title": "VBA: Replacing space bars with blank spaces?", "body": "<p>You should use the <code>Intersect</code> method to trim the range down to the actual used cells.</p>\n\n<pre><code>With Worksheets(\"Sheet6\")\n\n    Intersect(.Range(\"D:D\"), .UsedRange).Replace \" \", \"\"\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5731874, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/416cabe7ab1d7175caa263954b3cad8d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahsan Khan", "link": "https://stackoverflow.com/users/5731874/ahsan-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "accepted_answer_id": 39377425, "answer_count": 2, "score": -1, "last_activity_date": 1473285815, "creation_date": 1473273993, "last_edit_date": 1531164843, "question_id": 39377119, "link": "https://stackoverflow.com/questions/39377119/vba-replacing-space-bars-with-blank-spaces", "title": "VBA: Replacing space bars with blank spaces?", "body": "<p>I am running a code that pulls data from PI using conditional formula. When the values are pulled, it assigns the formula to entire column but only few of them have actual values: </p>\n\n<p><a href=\"https://i.stack.imgur.com/Qphbh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qphbh.png\" alt=\"enter image description here\"></a></p>\n\n<p>The column has about 300,000 rows but I want to run the loop only when I have actual values (4 times instead of 300,000 in this case).</p>\n\n<p>Are there any suggestions to do it avoiding the loop 300,000 times? </p>\n\n<p>I have tried using the replace function by replacing all the spaces with blank and then count the number of non-blank cells using <code>COUNTA</code> :</p>\n\n<pre><code>'Replacing all spaces in a column by blanks\nWorkseets(\"Sheet6\").Range(\"D:D\") = Replace(Worksheets(\"Sheet6\").Range(\"D:D\"),\" \",\"\")\n'counting non-blank cells\nn = WorksheetFunction.CountA(Worksheets(\"Sheet6\").Range(\"D:D\"))\n'running code only 4 times\nfor I = 1 to n.....\n</code></pre>\n\n<p>But I am getting type mismatch error for the replace function. I have not written anything inside for <code>FOR Loop</code> yet. Currently just trying to use the <code>REPLACE</code> function correctly</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "edited": false, "score": 0, "creation_date": 1473273801, "post_id": 39376995, "comment_id": 66081991, "body": "read this : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834664.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff834664.aspx</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473273948, "post_id": 39376995, "comment_id": 66082062, "body": "Also, I suggest reading through <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code></a>  It&#39;s doing it in the same cell, because your <code>ActiveCell</code> never changes."}, {"owner": {"reputation": 1, "user_id": 6806085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8a557e03456f52a4ab229107655ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Jim O", "link": "https://stackoverflow.com/users/6806085/jim-o"}, "edited": false, "score": 0, "creation_date": 1473274559, "post_id": 39376995, "comment_id": 66082337, "body": "Sorry, that might be a bit above my level, I am not much of a programmer.  Does that mean that my request can be done because everything always has to be defined relative to the upper left corner of the document?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6806085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8a557e03456f52a4ab229107655ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Jim O", "link": "https://stackoverflow.com/users/6806085/jim-o"}, "edited": false, "score": 0, "creation_date": 1473276054, "post_id": 39377399, "comment_id": 66083055, "body": "Scott - Thanks this is almost exactly what I need.  Is there something in there that is controlling the length of the arrow?  It seems okay if I am in the upper left 100 or so cells of the grid, but when I go down to say S,200, the line becomes very long."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 6806085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8a557e03456f52a4ab229107655ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Jim O", "link": "https://stackoverflow.com/users/6806085/jim-o"}, "edited": false, "score": 1, "creation_date": 1473276211, "post_id": 39377399, "comment_id": 66083141, "body": "@JimO - play with the <code>t + 89.25, l + 89.25, l, t</code> arguments. It&#39;s basically begin and end point of arrow, so you need to do the math to figure out exactly how to make it the length you want."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473278578, "post_id": 39377399, "comment_id": 66084216, "body": "I think you meant to use <code>ActiveSheet.Shapes.AddConnector(msoConnectorStraight, l - 89.25, t - 89.25, l, t).Select</code>.  Your current line has t and l switched in the start positions, and you have the arrow pointing away from the cell.  (But I don&#39;t know what the OP wants to happen when the cell is near the top or left of the document - <code>t - 89.25</code> or <code>l - 89.25</code> may become negative.)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1473275137, "creation_date": 1473275137, "answer_id": 39377399, "question_id": 39376995, "link": "https://stackoverflow.com/questions/39376995/excel-vba-insert-arrow-macro/39377399#39377399", "title": "Excel vba insert arrow macro", "body": "<p>This request can be done by using the <code>Top</code> and <code>Left</code> property of the <code>ActiveCell</code> and using those numbers to place the arrow, since the <code>Top</code> and <code>Left</code> property are measured against the upper left corner of the document and assuming the arrow will always be a static length. </p>\n\n<p>See the refactored code below:</p>\n\n<pre><code>Sub Red_Arrow_Insert()\n\n'Red_Arrow_Insert Macro\n'Insert Red Arrow\n'Keyboard Shortcut: Ctrl Shift + A\n\nDim l As Long, t As Long\n\nl = ActiveCell.Left\nt = ActiveCell.Top\n\nActiveSheet.Shapes.AddConnector(msoConnectorStraight, t + 89.25, l + 89.25, l, t).Select\n\nWith Selection\n    With .ShapeRange.Line\n        .EndArrowheadStyle = msoArrowheadOpen\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 0, 0)\n        .Transparency = 0\n        .Weight = 1.5\n    End With\nEnd With\n\nActiveCell.Select 'assumes you want to activate the last active cell.\n\nEnd Sub\n</code></pre>\n\n<p><em>n.b. -- I used 89.25 as the length since it was the difference in points in your original code. Change as needed.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 6806085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8a557e03456f52a4ab229107655ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Jim O", "link": "https://stackoverflow.com/users/6806085/jim-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7095, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473275137, "creation_date": 1473273512, "last_edit_date": 1473273888, "question_id": 39376995, "link": "https://stackoverflow.com/questions/39376995/excel-vba-insert-arrow-macro", "title": "Excel vba insert arrow macro", "body": "<p>I created a macro in excel to insert a red arrow via keyboard command.  I figured out thru research how to make it stop selecting the cell that was selected when I wrote the macro, but I can't figure out how to make it insert the arrow next to my current selection every time.  It currently inserts the arrow in the same spot as my original line from when I recorded the macro.  Is there a way around this?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Red_Arrow_Insert()\n\n Red_Arrow_Insert Macro\n Insert Red Arrow\n\n Keyboard Shortcut: Ctrl+Shift+A\n\n    ActiveCell.Select\n    ActiveSheet.Shapes.AddConnector(msoConnectorStraight, 264, 50.25, 353.25, 139.5 _\n        ).Select\n        Selection.ShapeRange.Line.EndArrowheadStyle = msoArrowheadOpen\n    With Selection.ShapeRange.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 0, 0)\n        .Transparency = 0\n    End With\n    With Selection.ShapeRange.Line\n        .Visible = msoTrue\n        .Weight = 1.5\n    End With\n    ActiveCell.Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1473273579, "post_id": 39376896, "comment_id": 66081890, "body": "You&#39;re not saving the workbook as a macro-enabled format...  You probably want <code>xlOpenXMLWorkbookMacroEnabled</code>  (52)  &quot;Open XML Workbook Macro Enabled&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473273659, "post_id": 39376896, "comment_id": 66081928, "body": "@Comintern if VBProject permission is not already granted, this will raise an error."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1473273752, "post_id": 39376896, "comment_id": 66081967, "body": "@DavidZemens - I&#39;ve had the option checked so long I forgot what happened when it wasn&#39;t set. I think @ TimWilliams hit the nail on the head."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473273824, "post_id": 39376896, "comment_id": 66082000, "body": "This works as expected up until the <code>.Close</code> method If you comment out that line and leave the <code>wbNew</code> open, you can confirm this. Tim&#39;s comment is spot on."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1473273903, "post_id": 39376896, "comment_id": 66082046, "body": "Your use of <code>Application.DisplayAlerts = False</code> is suppressing the dialog that warns you your XLSX file format does not permit macros."}, {"owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473274198, "post_id": 39376896, "comment_id": 66082159, "body": "@TimWilliams was correct. Unfortunately I still couldn&#39;t get rid of the warning with this code and I now get an additional prompt to allow for macro-enabled content."}, {"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "edited": false, "score": 0, "creation_date": 1473299125, "post_id": 39376896, "comment_id": 66090431, "body": "@rib.usa...Dumb question but do you have the extensibility reference checked?"}], "answers": [{"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": true, "score": 2, "last_activity_date": 1473275094, "creation_date": 1473275094, "answer_id": 39377388, "question_id": 39376896, "link": "https://stackoverflow.com/questions/39376896/vba-vbproject-vbcomponents-itemthisworkbook-codemodule-addfromstring-isnt/39377388#39377388", "title": "VBA .VBProject.VBComponents.Item(&quot;ThisWorkbook&quot;).CodeModule.AddFromString isn&#39;t working", "body": "<p>This works for me, no prompts or missing codes:</p>\n\n<pre><code>Sub test()\n\n    Dim wbnew As Workbook\n\n    Set wbnew = Workbooks.Add\n\n\n    Application.DisplayAlerts = False\n    wbnew.SaveAs Filename:=\"C:\\temp\\abc.xlsm\", FileFormat:=XlFileFormat.xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\n    wbnew.VBProject.VBComponents.Item(\"ThisWorkbook\").CodeModule.AddFromString ( _\n        \"Private Sub Workbook_Open()\" &amp; vbCrLf _\n        &amp; \"    Application.AskToUpdateLinks = False\" &amp; vbCrLf _\n        &amp; \"    Application.DisplayAlerts = False\" &amp; vbCrLf _\n        &amp; \"End Sub\")\n\n    wbnew.Close True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>For macro prompt settting Fil--> Options--> Trust Center --> Macro Setting to this will get rid of the prompt:\n<a href=\"https://i.stack.imgur.com/qhk5V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qhk5V.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6568, "favorite_count": 0, "accepted_answer_id": 39377388, "answer_count": 1, "score": 2, "last_activity_date": 1473332590, "creation_date": 1473273112, "question_id": 39376896, "link": "https://stackoverflow.com/questions/39376896/vba-vbproject-vbcomponents-itemthisworkbook-codemodule-addfromstring-isnt", "title": "VBA .VBProject.VBComponents.Item(&quot;ThisWorkbook&quot;).CodeModule.AddFromString isn&#39;t working", "body": "<p>I am creating a bunch of workbooks dynamically that are linked and I need to suppress the linked warning, so I am trying to add a <code>Workbook_Open()</code> sub with the proper code.</p>\n\n<p>Only problem is that the code isn't actually being added to the workbook.</p>\n\n<pre><code>' do not display alerts while processing so many files\nApplication.DisplayAlerts = False\nwbNew.SaveAs FileName:=path, FileFormat:=51, CreateBackup:=False\n\n' add a little Workbook_Open method to the new workbook's ThisWorkbook dynamically\n' this line doesn't actually do anything - why?\nwbNew.VBProject.VBComponents.Item(\"ThisWorkbook\").CodeModule.AddFromString ( _\n    \"Private Sub Workbook_Open()\" &amp; vbCrLf _\n    &amp; \"    Application.AskToUpdateLinks = False\" &amp; vbCrLf _\n    &amp; \"    Application.DisplayAlerts = False\" &amp; vbCrLf _\n    &amp; \"End Sub\")\nwbNew.Save  \nwbNew.Close\n</code></pre>\n\n<p>The file is created and all is well, except that no code is actually added to the workbook I just made, it's a normal workbook and its ThisWorkbook is blank. (I also checked that I wasn't suppressing any warnings about the dynamic code writing, just the normal saveas prompts).</p>\n\n<p>How can I make this work?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473272982, "post_id": 39376835, "comment_id": 66081637, "body": "&quot;...it is not working.&quot; - How so? Is it giving you an error? If so, what error and what line? Is it working, but giving unexpected results? etc..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473273028, "post_id": 39376835, "comment_id": 66081656, "body": "This can be done with a formula if you are interested."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473273120, "post_id": 39376835, "comment_id": 66081704, "body": "Remove the <code>On Error...</code> line and see where the error is."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473273173, "post_id": 39376835, "comment_id": 66081726, "body": "@ScottCraner I&#39;m interested if that matters? I think I could do this, but you seem to be WAY better at array formulas than I am."}, {"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473273345, "post_id": 39376835, "comment_id": 66081789, "body": "@scott craner i am interested."}, {"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473273403, "post_id": 39376835, "comment_id": 66081817, "body": "@ brucewayne only name column is being copied and pasted"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473273495, "post_id": 39376835, "comment_id": 66081862, "body": "@Kyle no array formula just some math with an INDEX formula."}, {"owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "edited": false, "score": 0, "creation_date": 1473277612, "post_id": 39376835, "comment_id": 66083781, "body": "record a macro, to record yourself doing the iteration."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473274411, "post_id": 39376985, "comment_id": 66082264, "body": "thanks it is working. But i have a small problem. If there are multiple rows of data then how to write formula. In the above example i have given only one row of data"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473274454, "post_id": 39376985, "comment_id": 66082283, "body": "Very nice! Thanks for sharing."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473274587, "post_id": 39376985, "comment_id": 66082350, "body": "@commander420 Is there a set number of groups per row?  Or are they arbitrary?"}, {"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473274974, "post_id": 39376985, "comment_id": 66082542, "body": "@Scott Craner Number of rows are constant, there will be only three rows of data"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473275012, "post_id": 39376985, "comment_id": 66082554, "body": "So three rows and an unlimited number of columns? @commander420"}, {"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473275084, "post_id": 39376985, "comment_id": 66082591, "body": "@Scott Craner yes"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473276357, "post_id": 39376985, "comment_id": 66083217, "body": "@commander420 remember that if this works and is the method you use to mark as correct by clicking the check mark by the answer.  If someone give you vba that works and you use that then choose that one."}, {"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473276362, "post_id": 39376985, "comment_id": 66083221, "body": "@Scott Craner is it possible to copy jason,tim,xander data after david,scott and dawn"}, {"owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473278867, "post_id": 39376985, "comment_id": 66084353, "body": "@Scott Craner Thank you so much, your solution is working. If there are 5 rows instead of three what should i change in the formula"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "edited": false, "score": 0, "creation_date": 1473279354, "post_id": 39376985, "comment_id": 66084583, "body": "@commander420 You have changed the question many times.  This is not usually acceptable on this site.  Try to figure it out.  If you cannot then come back and ask another question."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1473278294, "last_edit_date": 1473278294, "creation_date": 1473273473, "answer_id": 39376985, "question_id": 39376835, "link": "https://stackoverflow.com/questions/39376835/pasting-multiple-columns-data-under-one-column/39376985#39376985", "title": "Pasting multiple columns data under one column", "body": "<p>For a formula I put the original data in rows 1 and 2.  Then in Row 4 I put only the three headers.</p>\n\n<p>Then in A5 I put this formula:</p>\n\n<pre><code>=INDEX($2:$2,((ROW(1:1) - 1) * 3) + 1 + (COLUMN(A:A)-1))\n</code></pre>\n\n<p>Then drag/filled over two columns and down two rows.</p>\n\n<p>This formula uses the entire second row as its reference for the data so no matter how many columns it will be included and only needs to be drag/filled down a sufficient number of rows.</p>\n\n<p>If the data pattern is different than every three columns then change the <code>3</code> to the number of columns in the pattern.</p>\n\n<p><a href=\"https://i.stack.imgur.com/stlZU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/stlZU.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>As per your comments:</p>\n\n<pre><code>=IFERROR(INDEX($2:$4,INT((ROW(1:1)-1)/(MATCH(\"ZZZ\",$1:$1)/3))+1,(MOD((ROW(1:1)-1),MATCH(\"ZZZ\",$1:$1)/3) *3)+1 + (COLUMN(A:A)-1)),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NHjF3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NHjF3.png\" alt=\"![enter image description here\"></a></p>\n\n<hr>\n\n<p>To go rows first then columns flip the two row references:</p>\n\n<pre><code>=INDEX($2:$4,MOD(ROW(1:1)-1,3)+1,INT((ROW(1:1)-1)/3)*3+1+COLUMN(A:A)-1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/e6YfF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e6YfF.png\" alt=\"![enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1473280663, "creation_date": 1473280663, "answer_id": 39378600, "question_id": 39376835, "link": "https://stackoverflow.com/questions/39376835/pasting-multiple-columns-data-under-one-column/39378600#39378600", "title": "Pasting multiple columns data under one column", "body": "<p>A VBA solution (just in case you choose not to go with Scott's excellent formula) would be:</p>\n\n<pre><code>Sub CombineColumns1()\n    Dim xRng As Range\n    Dim i As Long, j As Integer\n    Dim xNextRow As Long\n    Dim xTxt As String\n    On Error Resume Next\n    With ActiveSheet\n        xTxt = .RangeSelection.Address\n        Set xRng = Application.InputBox(\"please select the data range\", \"Kutools for Excel\", xTxt, , , , , 8)\n        If xRng Is Nothing Then Exit Sub\n        j = xRng.Columns(1).Column\n        For i = 4 To xRng.Columns.Count Step 3\n            'Need to recalculate the last row, as some of the final columns may not have data in all rows\n            xNextRow = .Cells(.Rows.Count, j).End(xlUp).Row + 1\n\n            .Range(xRng.Cells(1, i), xRng.Cells(xRng.Rows.Count, i + 2)).Copy .Cells(xNextRow, j)\n            .Range(xRng.Cells(1, i), xRng.Cells(xRng.Rows.Count, i + 2)).Clear\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note:  The code is assuming that the user is <strong>not</strong> including the headings when selecting the data range.</p>\n"}], "owner": {"reputation": 15, "user_id": 6806045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6995f2754cf63f2722e713bf369811dc?s=128&d=identicon&r=PG&f=1", "display_name": "commander420", "link": "https://stackoverflow.com/users/6806045/commander420"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 39376985, "answer_count": 2, "score": 0, "last_activity_date": 1576404188, "creation_date": 1473272781, "last_edit_date": 1576404188, "question_id": 39376835, "link": "https://stackoverflow.com/questions/39376835/pasting-multiple-columns-data-under-one-column", "title": "Pasting multiple columns data under one column", "body": "<p>Data is in the below format,</p>\n\n<p><a href=\"https://i.stack.imgur.com/POqac.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/POqac.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need data in the below format,</p>\n\n<p><a href=\"https://i.stack.imgur.com/sLpiT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sLpiT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I used the below macro but it is not working,</p>\n\n<pre><code>Sub CombineColumns1()\n    'updateby Extendoffice 20151030\n    Dim xRng As Range\n    Dim i, j As Integer\n    Dim xLastRow As Integer\n    Dim xTxt As String\n    On Error Resume Next\n    xTxt = Application.ActiveWindow.RangeSelection.Address\n    Set xRng = Application.InputBox(\"please select the data range\", \"Kutools for Excel\", xTxt, , , , , 8)\n    If xRng Is Nothing Then Exit Sub\n    xLastRow = xRng.Columns(1).Rows.Count + 1\n    For i = 4 To xRng.Columns.Count\n        For j = 1 To 3\n            Range(xRng.Cells(j, i), xRng.Cells(xRng.Columns(i).Rows.Count, i)).Cut\n            ActiveSheet.Paste Destination:=xRng.Cells(xLastRow, 1)\n            xLastRow = xLastRow + xRng.Columns(i).Rows.Count\n        Next\n        j = 1\n        i = i + 2\n    Next\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473272936, "post_id": 39376689, "comment_id": 66081613, "body": "Isn&#39;t the runtime error <i>subscript out of range</i> in the first snippet?"}, {"owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473273799, "post_id": 39376689, "comment_id": 66081990, "body": "It&#39;s not a duplicate because the <code>Application.</code> part isn&#39;t a part of any SO question I could find, trust me, I spent a while looking at the one you linked and it wasn&#39;t obvious at all."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1473273917, "post_id": 39376689, "comment_id": 66082049, "body": "Would you happen to have some variable or function named <code>Workbooks</code> in scope? The name clashing would explain it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1473273993, "post_id": 39376689, "comment_id": 66082081, "body": "@rlb.usa - From within Excel, <code>Application.Workbooks</code> <i>is</i> <code>Workbooks</code>.  You&#39;re just using the implicit global copy of the collection."}], "answers": [{"comments": [{"owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "edited": false, "score": 0, "creation_date": 1473273722, "post_id": 39376842, "comment_id": 66081957, "body": "<code>Application.Workbooks.Open(path)</code> omfg, I spent hours googling and couldn&#39;t find that."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1473272822, "creation_date": 1473272822, "answer_id": 39376842, "question_id": 39376689, "link": "https://stackoverflow.com/questions/39376689/vba-workbooks-open-type-mismatch/39376842#39376842", "title": "VBA Workbooks.Open type mismatch", "body": "<blockquote>\n<pre><code>Set wbNew = Workbooks(path).Open\n</code></pre>\n</blockquote>\n\n<p>The <code>path</code> should be an argument to the <code>Open</code> method; you're passing it as an <em>index</em> to the <code>Application.Workbooks</code> collection - that's the collection of <em>workbooks already opened</em>, so <code>path</code> presumably wouldn't correspond to any already-opened workbook, hence the error.</p>\n\n<p>So the correct and fully qualified call would be:</p>\n\n<pre><code>Dim wbNew As Excel.Workbook\nSet wbNew = Application.Workbooks.Open(path)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 1, "creation_date": 1473274199, "post_id": 39376940, "comment_id": 66082162, "body": "Why don&#39;t <i>you</i> try it and verify that it works? After all, answers are only supposed to be written if you 100% know that it&#39;s correct. I think you&#39;ll be surprised by the result..."}, {"owner": {"reputation": 14, "user_id": 3945114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2e563661e34561049a5b9e350712cd4?s=128&d=identicon&r=PG&f=1", "display_name": "irvin", "link": "https://stackoverflow.com/users/3945114/irvin"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1473278086, "post_id": 39376940, "comment_id": 66083993, "body": "Sorry, i didnt paste everything. Ill double check next time."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1473278169, "post_id": 39376940, "comment_id": 66084031, "body": "No problem. StackOverflow gets easier the more you do it. Soon you&#39;ll be full time ;)"}, {"owner": {"reputation": 14, "user_id": 3945114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2e563661e34561049a5b9e350712cd4?s=128&d=identicon&r=PG&f=1", "display_name": "irvin", "link": "https://stackoverflow.com/users/3945114/irvin"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1473278603, "post_id": 39376940, "comment_id": 66084225, "body": "It worked it just needs to change the path... I hope :S is my first post. It worked for me."}], "tags": [], "owner": {"reputation": 14, "user_id": 3945114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2e563661e34561049a5b9e350712cd4?s=128&d=identicon&r=PG&f=1", "display_name": "irvin", "link": "https://stackoverflow.com/users/3945114/irvin"}, "is_accepted": false, "score": -3, "last_activity_date": 1473278552, "last_edit_date": 1473278552, "creation_date": 1473273305, "answer_id": 39376940, "question_id": 39376689, "link": "https://stackoverflow.com/questions/39376689/vba-workbooks-open-type-mismatch/39376940#39376940", "title": "VBA Workbooks.Open type mismatch", "body": "<p>TRY THIS</p>\n\n<p>Path = \"C:\\Users\\USER\\Desktop\\test.xlsx\"  </p>\n\n<p>Dim myShell As Object</p>\n\n<p>Set myShell = CreateObject(\"WScript.Shell\")</p>\n\n<p>myShell.Run Path</p>\n"}], "owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3025, "favorite_count": 0, "closed_date": 1473275597, "accepted_answer_id": 39376842, "answer_count": 2, "score": 0, "last_activity_date": 1473278552, "creation_date": 1473272152, "last_edit_date": 1473273980, "question_id": 39376689, "link": "https://stackoverflow.com/questions/39376689/vba-workbooks-open-type-mismatch", "closed_reason": "Duplicate", "title": "VBA Workbooks.Open type mismatch", "body": "<p>I'm having a really hard time opening a workbook in VBA.</p>\n\n<p>This line of code gives me a type mismatch. <code>path</code> is a <code>String</code> and I am 100% sure it is valid and I am able to do the <code>.SaveAs</code> with <code>path</code> without issues.</p>\n\n<pre><code>' Compile Error: Invalid qualifier on Workbooks\nSet wbNew = Workbooks(path).Open\n</code></pre>\n\n<p>I have tried other permutations like this one, but I get <code>Compile Error: Invalid qualifier</code> on the <code>Workbooks</code> object itself. Am I missing a reference?</p>\n\n<pre><code>' Compile Error: Invalid qualifier on Workbooks\nWorkbooks.Open path\n</code></pre>\n\n<p>How do I open a workbook in VBA?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "duplicates", "autonumber"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473307551, "post_id": 39376611, "comment_id": 66092203, "body": "Not clear from your example how <code>SEQ</code> is supposed to be numbered. WHy wouldn&#39;t the last three entries be incremented as 3, 2, 2? Your criteria was ID_NUMB on same Date, correct.? Even if you throw in Office as part of the criteria - the final ID_NUMB 1 should still have SEQ=3, shouldn&#39;t it?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473308102, "post_id": 39376611, "comment_id": 66092323, "body": "The query to temp table + VBA for SEQ is a very simple approach - do you have example of the query you used to create the Temp Table? Or the VBA? Are you against that method - or if it works you&#39;ll take it?"}, {"owner": {"reputation": 47, "user_id": 4962629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c0d9fe2106e2d769f8b33cb3db92?s=128&d=identicon&r=PG&f=1", "display_name": "dramerus", "link": "https://stackoverflow.com/users/4962629/dramerus"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473311529, "post_id": 39376611, "comment_id": 66093208, "body": "In response to the first comment @dbmitch, it&#39;s actually a combination of a few factors. You are correct the first one should have been 3, I&#39;ll change that. The other two either appeared at a different office or at a different time (or both). That ultimately might be too granular maybe.."}, {"owner": {"reputation": 47, "user_id": 4962629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c0d9fe2106e2d769f8b33cb3db92?s=128&d=identicon&r=PG&f=1", "display_name": "dramerus", "link": "https://stackoverflow.com/users/4962629/dramerus"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473312026, "post_id": 39376611, "comment_id": 66093377, "body": "@dbmitch to the second question/comment, I can update the question in the morning with the temp table query, although I don&#39;t think it was to different than the syntax above. I didn&#39;t get too far with the VBA, but I can post that as well. I&#39;m certainly not opposed to going with a temp table and/or VBA. As you said, if it works, I&#39;ll take it."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473313714, "post_id": 39376611, "comment_id": 66093980, "body": "Ok. The sql will map the table and fields to your temp table example. Right now it looks like everything comes from T1 but not quite sure which field maps to TP ... maybe APP_TIME_PER ? And DATE is APP_DTE?"}, {"owner": {"reputation": 47, "user_id": 4962629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c0d9fe2106e2d769f8b33cb3db92?s=128&d=identicon&r=PG&f=1", "display_name": "dramerus", "link": "https://stackoverflow.com/users/4962629/dramerus"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473690739, "post_id": 39376611, "comment_id": 66226897, "body": "@dbmitch - In this case, everything does come from T1. While there are more complicated pulls that do link other tables (some linking upwards of 8), performance has started to be an issue with these queries since they are on a production server that is quite old. APP_TIME_PER is TP and DATE is APP_DATE, yes."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4962629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c0d9fe2106e2d769f8b33cb3db92?s=128&d=identicon&r=PG&f=1", "display_name": "dramerus", "link": "https://stackoverflow.com/users/4962629/dramerus"}, "edited": false, "score": 0, "creation_date": 1473691162, "post_id": 39384946, "comment_id": 66227190, "body": "I love the sound of this approach; however it might be a little beyond my skill set. I explored opening a recordset using DAO when I was looking to pass authentication credentials as part of automating a few pulls. I wasn&#39;t terribly successful, but I have kept trying to learn as I have gone on. Do you think based on the SQL above that would be possible? or would writing the data to a temp table make more sense?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 47, "user_id": 4962629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c0d9fe2106e2d769f8b33cb3db92?s=128&d=identicon&r=PG&f=1", "display_name": "dramerus", "link": "https://stackoverflow.com/users/4962629/dramerus"}, "edited": false, "score": 0, "creation_date": 1473696082, "post_id": 39384946, "comment_id": 66230142, "body": "I added some example code for illustration. You should get the idea."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1473696035, "last_edit_date": 1473696035, "creation_date": 1473319642, "answer_id": 39384946, "question_id": 39376611, "link": "https://stackoverflow.com/questions/39376611/access-sql-logic-for-incrementing-key-field-based-on-composite-key/39384946#39384946", "title": "Access SQL/Logic for Incrementing Key/Field based on composite key", "body": "<p>For this kind of tasks, the most straight-forward method is usually to open a <em>recordset</em> using <em>DAO</em> with the records ordered as to the sequence you need.</p>\n\n<p>Then loop through the recordset, for each record keeping track of the conditions that will force a new sequence number or just add one to the previous sequence number. Now, build the sequence number, update the record, and move on until no more records.</p>\n\n<p><strong>Edit</strong>: Example looping records:</p>\n\n<pre><code>Dim rst As DAO.Recordset\n\n'Me.RecordsetClone\nSet rst = Me.RecordsetClone\nrst.Sort = \"Dato, ID asc\"\nSet rst = rst.OpenRecordset()\nrst.MoveFirst\nWhile rst.EOF = False\n    Debug.Print rst!Dato.Value, rst!Id.Value\n'    If SomeCondition = True Then\n        rst.Edit\n            rst!Dec1.Value = rst!Id.Value\n        rst.Update\n'   End If\n    rst.MoveNext\nWend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1473699691, "creation_date": 1473699691, "answer_id": 39455289, "question_id": 39376611, "link": "https://stackoverflow.com/questions/39376611/access-sql-logic-for-incrementing-key-field-based-on-composite-key/39455289#39455289", "title": "Access SQL/Logic for Incrementing Key/Field based on composite key", "body": "<p>I think this SQL might be close to what you want (based on the limited example) It does an INNER JOIN on the table T1 - and does a simple sort before it builds the SEQ on the fly</p>\n\n<pre><code>SELECT \n    a.ID_NUMB,\n    a.ADJ_APPEAR_NUM,\n    a.OFFICE,\n    a.APP_TIME_PER AS TP,\n    Format(a.[APP_DTE],\"Short Date\") AS APP_DATE,\n    (SELECT Count(ID_NUMB) \n        FROM T1 b \n        WHERE (b.ADJ_APPEAR_NUM &lt;= a.ADJ_APPEAR_NUM\n        AND b.ID_NUMB = a.ID_NUMB \n        AND b.OFFICE = a.OFFICE\n        AND b.APP_TIME_PER = a.APP_TIME_PER\n        AND b.APP_DTE = a.APP_DTE)) AS SEQ\nFROM T1 AS a\nORDER BY a.ID_NUMB, a.OFFICE, a.ADJ_APPEAR_NUM;   \n</code></pre>\n\n<p><strong>Query Results</strong> (using your data for T1)</p>\n\n<p><a href=\"https://i.stack.imgur.com/NGbGE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NGbGE.jpg\" alt=\"Sample Query Results\"></a></p>\n"}], "owner": {"reputation": 47, "user_id": 4962629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c0d9fe2106e2d769f8b33cb3db92?s=128&d=identicon&r=PG&f=1", "display_name": "dramerus", "link": "https://stackoverflow.com/users/4962629/dramerus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 39455289, "answer_count": 2, "score": 2, "last_activity_date": 1594460732, "creation_date": 1473271760, "last_edit_date": 1594460732, "question_id": 39376611, "link": "https://stackoverflow.com/questions/39376611/access-sql-logic-for-incrementing-key-field-based-on-composite-key", "title": "Access SQL/Logic for Incrementing Key/Field based on composite key", "body": "<p>Suppose you have a table in a database that tracks ticket appearances across 9 office locations for between 4 and 5 times periods every day. In each of these time periods, people might appear for one ticket (I guess we can use a transaction model), or they can appear for many (I've seen some with 15, heard of others with up to 50). </p>\n\n<p>A query was created using Access 2013 to capture the data from this table. This is done for archiving (the current date table records are purged after 24 hours), and general analysis.</p>\n\n<p>The current query logic is as follows:</p>\n\n<pre><code>SELECT Format([T1]![APP_DTE],\"Short Date\") AS APPEAR_DTE, \nT1.OFFICE, OFFCDES.OFFICE_NAME, OFFCDES.LOC_CDE, OFFCDES.LOC_NAME, \nT1.APP_TIME_PER, T1.ROOM_NUM, T1.INCL_CDE, T1.ID_NUMB, \nT1.ADJ_APPEAR_NUM, T2.APPEAR_CDE, \nIIf([T1]![APPEAR_LOGIN_TIME] Is Null,\"\",[T1]![APPEAR_LOGIN_TIME]) AS LOGIN_TIME1, \nIIf([T1]![OFFICE_LOGIN] Is Null,\"\",[T1]![OFFICE_LOGIN]) AS OFFICE_LOGIN, \nIIf([T1]![DECISION_TIME] Is Null,\"\",[T1]![DECISION_TIME]) AS DECISION_TIME, \n[T1]![ID_NUMB] &amp; \"-\" &amp; CStr([T2]![OFFICE_REP_ID]) &amp; \"-\" &amp; CStr([T1]![APP_DTE]) AS CASEKEY, \nWeekday([APP_DTE]) AS NUM_DAY, \n[T1]![OFFICE] &amp; \"-\" &amp; Weekday([T1]![APP_DTE]) &amp; \"-\" &amp; [T1]![APP_TIME_PER] AS OFFICE_TP_KEY, \"\" AS RecordKey\nFROM (T1 INNER JOIN OFFCDES ON T1.OFFICE = OFFCDES.OFFICE) \nINNER JOIN T2 ON T1.APPEAR_NUM = T2.APPEAR_NUM\nWHERE (((Format([T1]![APP_DTE],\"Short Date\"))=Format(Date(),\"Short Date\")));\n</code></pre>\n\n<p>I realize that the above code will need to be cleaned up for readability, and that it's probably not as efficient as it could be. That part I can't take credit for, I inherited all of this from a coworker and have just started to wrap my head around it. </p>\n\n<p>The query result includes a ton of information, some (most) of which is irrelevant to what I'm trying to accomplish. It's important to capture all of this information since the information, once gone, is gone. With that stated:</p>\n\n<p><strong>What I'm trying to do:</strong></p>\n\n<p>I'm trying to incorporate a key/sequentially numbered column that would tell me how many times a particular ID_NUMB has occurred at a particular Office/Time Period on the date pulled. I'm also not looking for a total, rather something along the lines of the SEQ column here:</p>\n\n<pre><code>ID_NUMB  |  APPEAR_NUM  |  OFFICE  |  TP  |    DATE    |  SEQ\n1        |  1XZ2        |  01      |  01  |  9/7/2016  |  1\n1        |  1XZ3        |  01      |  01  |  9/7/2016  |  2\n2        |  3MN1        |  03      |  01  |  9/7/2016  |  1\n3        |  J915        |  02      |  01  |  9/7/2016  |  1\n1        |  1TY1        |  01      |  01  |  9/7/2016  |  1\n3        |  P91D        |  05      |  01  |  9/7/2016  |  1\n2        |  U11E        |  11      |  05  |  9/7/2016  |  1\n</code></pre>\n\n<p>While I have looked around and found many fine numbering solutions, most aren't quite what I'm looking to accomplish due to how fine grained the count seems to be. </p>\n\n<p>I've thought about writing the data to a temp table, but using some of the information that I've found didn't lead to any kind of solution. Similarly, \nI tried writing a separate query that could retrieve this information and add the sequential number in, kind of an adaption of <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2013_release-access/access-2013-how-do-i-generate-a-record-number/22fa42e1-dd89-4683-b1d0-72b112281c1c?page=3\" rel=\"nofollow\" title=\"One Solution\">the solution</a> found on the MS Answers site. I put that aside as it seemed like the wrong approach. </p>\n\n<p>I even toyed with writing the query to a temp table and then having a piece of VBA handle the sequential numbering, but that approach too, didn't get too far. </p>\n\n<p>What would the right approach to generate a sequential number in a column as I outlined be? I'm at a loss. </p>\n"}, {"tags": ["vba", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473271409, "post_id": 39376444, "comment_id": 66080930, "body": "you beat me to it! I had an explanation with mine also saying that excel isn&#39;t capable of stand-alone multi-threading which is why his nested for statements felt counter-intuitive to him. Our codes are 1:1 identical though."}, {"owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "edited": false, "score": 0, "creation_date": 1473273384, "post_id": 39376444, "comment_id": 66081809, "body": "Thanks Scott - I was really overcomplicating it!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1473271007, "creation_date": 1473271007, "answer_id": 39376444, "question_id": 39376338, "link": "https://stackoverflow.com/questions/39376338/vba-nested-for-loop/39376444#39376444", "title": "VBA: Nested For/Loop", "body": "<p>You do not need the inner loop as your arrays are synced just use the same reference number from the first loop.  It will equate <code>Sunday</code> with <code>Sun</code> and so forth:</p>\n\n<pre><code>Dim wsShortDays As Variant, wsFullDays As Variant\nDim FD As Long\n\nwsShortDays = Array(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\")\nwsFullDays = Array(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\")\n\nFor FD = LBound(wsFullDays) To UBound(wsFullDays)\n   wbk2.Worksheets(wsShortDays(FD)).Range(\"A:H\").Copy\n   wbk1.Worksheets(wsFullDays(FD)).Range(\"C:J\").PasteSpecial xlPasteAllUsingSourceTheme\nNext FD\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 39376444, "answer_count": 1, "score": 0, "last_activity_date": 1473271840, "creation_date": 1473270652, "last_edit_date": 1473271840, "question_id": 39376338, "link": "https://stackoverflow.com/questions/39376338/vba-nested-for-loop", "title": "VBA: Nested For/Loop", "body": "<p>I am creating a macro that will copy all data from one workbook/multiple sheets into another workbook/multiple sheets.  The first spreadsheet has 7 worksheets named as Sun-Sat.  The second worksheet has 10 worksheets 3 worksheets are irrelevant and the other 7 worksheets are named Sunday-Saturday.</p>\n\n<p>I tested each for loop separately and they work as needed.  When trying to combine them the inner for statement repeats and cycles through all dates before backing out.  I have tried incorporating a exit for to jump out of the inner for but when going back to the inner for it does not increment +1 to go to the next date.  Is there a simple way to add +1 from the outer for statement?</p>\n\n<pre><code>enter code here\nDim wsShortDays, wsFullDays As Variant\nDim wsShortDaysCrnt, wsFullDaysCrnt As Long\nDim SD, FD As Long\n\nwsShortDays = Array(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\")\nwsFullDays = Array(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\")\n\nFor FD = LBound(wsFullDays) To UBound(wsFullDays)\n    With wbk1.Worksheets(wsFullDays(FD))\n\n        For SD = LBound(wsShortDays) To UBound(wsShortDays)\n            With wbk2.Worksheets(wsShortDays(SD))\n                wbk2.Worksheets(wsShortDays(SD)).Activate\n                Range(\"A:H\").Copy\n            End With\n            Exit For\n        Next SD\n\n\n        wbk1.Worksheets(wsFullDays(FD)).Activate\n        Range(\"C:J\").PasteSpecial xlPasteAllUsingSourceTheme\n        SD = 1\n    End With\nNext FD\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 6, "creation_date": 1473271124, "post_id": 39376262, "comment_id": 66080790, "body": "Make sure the text box is not bound to the table field. That is the only way your text box could be affecting the table data if that is all the code you have on it."}, {"owner": {"reputation": 61, "user_id": 6695757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2bb990c9d6245b9e9e35ee251a3d56cb?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/6695757/anthony"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1473276055, "post_id": 39376262, "comment_id": 66083056, "body": "The way my database is setup the &quot;Client name field&quot; in the main table is the only way I can differentiate reports."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 3, "creation_date": 1473276958, "post_id": 39376262, "comment_id": 66083490, "body": "That has nothing to do with making the text box bound to the field. You can leave the text box unbound and your code will still work just fine. In fact you should not even have a table bound to your forma at all. By making it bound your users are literally editing the name of your first table record."}, {"owner": {"reputation": 61, "user_id": 6695757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2bb990c9d6245b9e9e35ee251a3d56cb?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/6695757/anthony"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1473277245, "post_id": 39376262, "comment_id": 66083631, "body": "Ok this makes a lot of sense because that is exactly the issue I am experiencing. How exactly do I &quot;unbound&quot; the table from my formula?"}, {"owner": {"reputation": 115, "user_id": 5953480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5GyKLX0YIp4/AAAAAAAAAAI/AAAAAAAAWS8/FNd0amluVDw/photo.jpg?sz=128", "display_name": "Erick 3E", "link": "https://stackoverflow.com/users/5953480/erick-3e"}, "edited": false, "score": 4, "creation_date": 1473278312, "post_id": 39376262, "comment_id": 66084086, "body": "@Anthony on design view, go to the properties of the field and under control source just leave it blank. that is now and unbound field"}], "answers": [{"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 1, "last_activity_date": 1540836269, "last_edit_date": 1592644375, "creation_date": 1540836269, "answer_id": 53051363, "question_id": 39376262, "link": "https://stackoverflow.com/questions/39376262/access-user-form-unintentionally-altering-data-table-records/53051363#53051363", "title": "Access User Form unintentionally altering data table records", "body": "<p>If the Control Source of a form control (textbox, combo box) is linked to a table then it will modify that table. In your case, you want to receive user input based on selections from a table and not to modify the table itself. You want to use the &quot;Row Source&quot; property to limit the selection to table items and clear the Control Source. This pulls potential options from the table without changing existing table entries.</p>\n<p><strong>Like this:</strong></p>\n<p><a href=\"https://i.stack.imgur.com/kCPN0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCPN0.png\" alt=\"Clear Control source\" /></a></p>\n<p>Notice that the source of options for the combobox is a query that defines what items should appear in the dropdown but no Control Source is specified.</p>\n"}], "owner": {"reputation": 61, "user_id": 6695757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2bb990c9d6245b9e9e35ee251a3d56cb?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/6695757/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1540836269, "creation_date": 1473270324, "question_id": 39376262, "link": "https://stackoverflow.com/questions/39376262/access-user-form-unintentionally-altering-data-table-records", "title": "Access User Form unintentionally altering data table records", "body": "<p>I have been using MS Access to aid in generating pdf reports based on a table. I have created a form that contains a text box for entering a client's name (this value is in the main table) and a button that when clicked runs the code:</p>\n\n<pre><code>Private Sub cmdPrintRecord_Click()\n\n    Dim strReportName As String\n    Dim strCriteria As String\n\n    strReportName = \"Current SP Report\"\n    strCriteria = \"[Owner]='\" &amp; Me![Owner] &amp; \"'\"\n    DoCmd.OpenReport strReportName, acViewPreview, , strCriteria\n\nEnd Sub\n</code></pre>\n\n<p>The idea here is to generate an individual PDF report based on the clients name. </p>\n\n<p>The above procedure has been able to do that successfully however, I have encountered that as I run it, the data in my table is affected, specifically the client name field. </p>\n\n<p>For example: I'll run a report for client \"Anthony\" and it shows 10 products which is correct, but then if I go back and run that same report again it will show 11 products. It is as if the procedure here is altering the data table. </p>\n\n<p>How can I troubleshoot this issue and or are there any alternatives recommended? </p>\n\n<p>Thanks. </p>\n\n<p>Attached is the MS link where I obtained the source code: \n<a href=\"https://support.microsoft.com/en-us/kb/209560\" rel=\"noreferrer\">https://support.microsoft.com/en-us/kb/209560</a></p>\n"}, {"tags": ["excel", "slicers", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473275252, "post_id": 39376238, "comment_id": 66082669, "body": "I am having a difficult time understanding what you want. Do you have some sample data, current layout and a mock-up of the desired output / layout? Also, your tags currently indicate that you are looking for a VBA solution. So, could you please include the VBA code you have written thus far?"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473278733, "post_id": 39376238, "comment_id": 66084292, "body": "I want whatever slicer #1&#39;s value is to automatically change slicer #2&#39;s value to the same."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473280238, "post_id": 39376238, "comment_id": 66084970, "body": "Oh, in this case your post seems to be simply a duplicate of the following post: <a href=\"http://stackoverflow.com/questions/12056831/capture-excel-pivot-table-refresh-event\" title=\"capture excel pivot table refresh event\">stackoverflow.com/questions/12056831/&hellip;</a> Please verify. If that&#39;s the case then you might as well remove your post. I sure hope the referenced post and answer solve your problem."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473335505, "post_id": 39376238, "comment_id": 66106349, "body": "I&#39;m fairly certain that is in no way close."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473336059, "post_id": 39376238, "comment_id": 66106690, "body": "If doing away with the original slicer inquiry and focusing purely on the pivottable which seems the direction <code>pivottableupdate</code> and .<code>DateRefresh</code> was taking me, the question would remain how do I express           <code>PivotTable2.PivotFields (&quot;Department&quot;).value = PivotTable1.PivotFields(&quot;Department&quot;).value</code> ?"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473337202, "post_id": 39376238, "comment_id": 66107507, "body": "and I mean of course without using       <code>pivotitems (&quot;item1&quot;).visible = true      pivotitems (&quot;item2&quot;).visible = false</code>"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "is_accepted": true, "score": 0, "last_activity_date": 1474388170, "creation_date": 1474388170, "answer_id": 39599114, "question_id": 39376238, "link": "https://stackoverflow.com/questions/39376238/macro-to-change-multiple-slicer-values/39599114#39599114", "title": "macro to change multiple slicer values", "body": "<p>I finally came across something useful on <a href=\"http://www.contextures.com/excelslicersupdatevba.html\" rel=\"nofollow\">contextures</a></p>\n\n<p>It works exactly how I want it to, I simply linked the slicer connected to 4 other pivot tables with a separate cache than my \"main\" slicer/table and hid the linked slicer. When I select and option from the main slicer, it updates the hidden slicer thus filtering all the other pivot tables. </p>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2144, "favorite_count": 1, "accepted_answer_id": 39599114, "answer_count": 1, "score": 0, "last_activity_date": 1474388170, "creation_date": 1473270202, "last_edit_date": 1531164843, "question_id": 39376238, "link": "https://stackoverflow.com/questions/39376238/macro-to-change-multiple-slicer-values", "title": "macro to change multiple slicer values", "body": "<p>I am at a loss after some searching.\n I have two pivot tables driven from two different data source/caches. source 1 is a table with departments' total charged amounts, source 2 has the same departments with the total denied dollar amounts. I am pulling the data from both of these into pivot tables so that I can manipulate the department (among other things) to calculate percentages.</p>\n\n<p>My original thought was to set a \"Department\" slicer for each table, and have a macro assigned to one of the slicers to change the second one so that both pivot tables filter the department. I was also thinking of possibly using one slicer, and assigning it a macro to simply filter the department on the second pivot.</p>\n\n<p>both of these tables will be hidden  with the exception of one of the slicers and will have the calculated data from each table pulled to the top of the sheet for easy viewing.</p>\n\n<p>both sheets/data sources are derived from separate reports with completely different data &amp; headers. </p>\n\n<p>thanks in advance for any help.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1473269275, "post_id": 39375673, "comment_id": 66079917, "body": "<i>it seems that something loads into memory</i> - yup. 7000 combobox items. ...and if you have 7000 items in your combobox, you seriously need to consider other options. A search box, perhaps."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473281647, "post_id": 39375673, "comment_id": 66085588, "body": "You can&#39;t &quot;scroll fast&quot; until the data is cached.  You need to either unbind the control and cache your lookup, or rethink the design so you don&#39;t need to cache 7000 records."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "edited": false, "score": 0, "creation_date": 1473280798, "post_id": 39376123, "comment_id": 66085184, "body": "With typing I can select without problem, But because the users are using Excel list box now and they select through this list box very fast without typing, I wanted to have the quality of Excel list box."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "edited": false, "score": 0, "creation_date": 1473281274, "post_id": 39376123, "comment_id": 66085419, "body": "Your question was about a combobox in Access...... regardless; a user-friendly UI doesn&#39;t give 7000 choices to pick from."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1473269768, "last_edit_date": 1495542797, "creation_date": 1473269768, "answer_id": 39376123, "question_id": 39375673, "link": "https://stackoverflow.com/questions/39375673/how-can-i-scroll-and-reach-to-end-of-combo-box-fast-in-access/39376123#39376123", "title": "How can I scroll and reach to end of Combo box fast in Access", "body": "<p>A <code>ComboBox</code> isn't <em>meant</em> to hold that many items. Cut it down to 10-20 items maximum, and make the contents of the dropdown depend on what the user types in the <code>TextBox</code> part of the \"combo\" - select only the top X few records that match the \"search\" value.</p>\n\n<p><a href=\"https://stackoverflow.com/q/33892474/1188513\">Search as you type with MS Access Combobox</a> seems like a good place to start (minus the line numbers and redundant comments I guess).</p>\n"}], "owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 39376123, "answer_count": 1, "score": 1, "last_activity_date": 1593957978, "creation_date": 1473267969, "last_edit_date": 1593957978, "question_id": 39375673, "link": "https://stackoverflow.com/questions/39375673/how-can-i-scroll-and-reach-to-end-of-combo-box-fast-in-access", "title": "How can I scroll and reach to end of Combo box fast in Access", "body": "<p>How can I scroll and reach to end of Combo box fast like the second time? At the first time after opening form scrolling 7000 records takes 13 secs to reach end of file.Records don't move during moving scroll bar handle and move when handle stops.After reaching end of file, now records move during moving handle and I can go from start to end without delay. It seems that something loads into memory.</p>\n"}, {"tags": ["vba", "excel", "conditional"], "comments": [{"owner": {"reputation": 3, "user_id": 6805503, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207639643932814/picture?type=large", "display_name": "Kheuwnyuk", "link": "https://stackoverflow.com/users/6805503/kheuwnyuk"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1473272419, "post_id": 39374658, "comment_id": 66081386, "body": "I use this code, but maybe it&#39;s a little different with my question because the real data is more complicated than what I illustrated. My data table starts at 4th row (header on 3rd). This code only formats 1 row (above the row that has zero column O value) and what I need is all rows with same column C value are formatted. Please keep in mind that I&#39;m a newbie in vba :(  With Range(&quot;A4:r8000&quot;).FormatConditions.Add( _         Type:=xlExpression, _         Formula1:=&quot;=AND($C4=$C5,$O5=0,$F4&lt;&gt;0)&quot;)              .Interior.Color = 13551615         .Font.Color = -16383844          End With"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 1, "creation_date": 1473272574, "post_id": 39374658, "comment_id": 66081445, "body": "Can you format the code and put it in the original question body to make it easier to read (and easier to help you)? <a href=\"http://stackoverflow.com/editing-help\">Stack Overflow</a> has a guide to help format."}, {"owner": {"reputation": 3, "user_id": 6805503, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207639643932814/picture?type=large", "display_name": "Kheuwnyuk", "link": "https://stackoverflow.com/users/6805503/kheuwnyuk"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1473273395, "post_id": 39374658, "comment_id": 66081814, "body": "Okay done, please check it out"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1473266299, "creation_date": 1473266299, "answer_id": 39375269, "question_id": 39374658, "link": "https://stackoverflow.com/questions/39374658/conditional-formatting-range-based-on-2-conditions-other-cells-format-value/39375269#39375269", "title": "Conditional formatting range based on 2 conditions (other cell&#39;s format/ value)", "body": "<p>Try this as the formula for the CFR,</p>\n\n<pre><code>=and(countif(c:c, c1)&gt;1, o1=0, len(o1))\n'alternate for part that I am not sure I understand\n=and(countif(c$1:c1, c1)&gt;1, o1=0, len(o1))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6805503, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207639643932814/picture?type=large", "display_name": "Kheuwnyuk", "link": "https://stackoverflow.com/users/6805503/kheuwnyuk"}, "edited": false, "score": 0, "creation_date": 1473271472, "post_id": 39375270, "comment_id": 66080958, "body": "I&#39;ve tried it but your code doesn&#39;t work for me because I may have 3 or more rows with same column C values but only the bottom has zero value in the column O. For example if I have 4 rows with same C column value (C1=C2=C3=C4) and the bottom has 0 values in column O (O4=0), I want all the 4 rows turn to green."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": false, "score": -1, "last_activity_date": 1473266696, "last_edit_date": 1473266696, "creation_date": 1473266308, "answer_id": 39375270, "question_id": 39374658, "link": "https://stackoverflow.com/questions/39374658/conditional-formatting-range-based-on-2-conditions-other-cells-format-value/39375270#39375270", "title": "Conditional formatting range based on 2 conditions (other cell&#39;s format/ value)", "body": "<p>If cells with same values are always grouped (one below the other), following code might do what you want.</p>\n\n<pre><code>Sub Test()\nDim lLastRow As Long\nDim i As Integer\n\nlLastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, 3).End(xlUp).Row\n\nFor i = 1 To lLastRow\n    If ((Worksheets(\"Sheet1\").Cells(i + 1, 3).Value = Worksheets(\"Sheet1\").Cells(i, 3).Value) And (Worksheets(\"Sheet1\").Cells(i, 15).Value = \"0\")) Then\n        Worksheets(\"Sheet1\").Cells(i, 3).Interior.Color = vbGreen\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6805503, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207639643932814/picture?type=large", "display_name": "Kheuwnyuk", "link": "https://stackoverflow.com/users/6805503/kheuwnyuk"}, "edited": false, "score": 0, "creation_date": 1473303869, "post_id": 39377504, "comment_id": 66091472, "body": "It works Sir, but one little thing, can you change it so not only cells in column C are highlighted but also the adjacent cells in the data table. My table ranges from column A to R"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 3, "user_id": 6805503, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207639643932814/picture?type=large", "display_name": "Kheuwnyuk", "link": "https://stackoverflow.com/users/6805503/kheuwnyuk"}, "edited": false, "score": 0, "creation_date": 1473350605, "post_id": 39377504, "comment_id": 66117224, "body": "If whoever downvoted could mention why, that would be fantastic. I believe I answered the question to the best of my ability. To answer Kheuwnyuk, you should be able to change <code>c.Interior.color</code> to <code>Range(Cells(c.row, 1), Cells(c.row, 18)).Interior.color</code> and similar for <code>c.font.color</code>. I am not able to test it now, but it should work."}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": -1, "last_activity_date": 1473276923, "last_edit_date": 1473276923, "creation_date": 1473275647, "answer_id": 39377504, "question_id": 39374658, "link": "https://stackoverflow.com/questions/39374658/conditional-formatting-range-based-on-2-conditions-other-cells-format-value/39377504#39377504", "title": "Conditional formatting range based on 2 conditions (other cell&#39;s format/ value)", "body": "<p>This will go through and highlight duplicate cells if any of the duplicate cells' rows have '0' in column O. I am still working on a way that will make this auto update whenever a change happens in Column O, but can't quite figure that out. Will update when I do.</p>\n\n<pre><code>Sub ConditionalFormatSE()\n\nApplication.ScreenUpdating = False\n\nDim lastRow As Long\nDim myCell As Range\nDim colCVals As Range\n\nlastRow = Cells(Rows.Count, 3).End(xlUp).Row\n\nSet colCVals = Range(\"C1\", \"C\" &amp; lastRow)\n\ncolCVals.clearformats\n\nFor Each myCell In colCVals\n    If Cells(myCell.Row, 15).Value = \"0\" Then\n        If WorksheetFunction.CountIf(colCVals, myCell.Value) &gt; 1 Then\n            Set c = colCVals.Find(myCell.Value)\n            If Not c Is Nothing Then\n                firstAddress = c.Address\n                Do\n                    c.Interior.color = RGB(198, 239, 206)\n                    c.Font.color = RGB(0, 97, 0)\n                    Set c = colCVals.FindNext(c)\n                Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n            End If\n        End If\n    End If\nNext myCell\n\nSet colCVals = Nothing\nSet myCell = Nothing\nSet c = Nothing\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>As for making it run automatically, put this in: VBAProject([workbookname].xlsm)->Microsoft Excel Objects->Sheet1([sheetname]) and it should run whenever a value in column 'O' is changed</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells As Range\n\nSet KeyCells = Columns(15)\n\nIf Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n       Call ConditionalFormatSE\nEnd If\n\nSet KeyCells = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6805503, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207639643932814/picture?type=large", "display_name": "Kheuwnyuk", "link": "https://stackoverflow.com/users/6805503/kheuwnyuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 39377504, "answer_count": 3, "score": -4, "last_activity_date": 1473276923, "creation_date": 1473264195, "last_edit_date": 1473273342, "question_id": 39374658, "link": "https://stackoverflow.com/questions/39374658/conditional-formatting-range-based-on-2-conditions-other-cells-format-value", "title": "Conditional formatting range based on 2 conditions (other cell&#39;s format/ value)", "body": "<p>I'm new to VBA and English isn't my native language so here goes.</p>\n\n<p>I want to conditional format rows/ range (giving them green-colored background) if cell C in that row have duplicate value in column C and also if there's a cell in column O that equals 0, but if the cell in column C has no similar value, don't apply the conditional format to that cell (eventhough cells in column O has the value of 0).</p>\n\n<p>Note: Cells that have same values in column C will always be above and below each other, for example it's possible that C1=C2=C3 but not C1&lt;>C2, C1=C3</p>\n\n<p>I know I'm not explaining it clearly, so please just let me know if you want more information.</p>\n\n<p>Update (more information): I may have 3 or more rows with same C column value above and below each other, and the zero value in column O will always be the bottom row.</p>\n\n<p>Example:\nIf C1=C2=C3=C4=C5 and O5=0 , Rows 1 2 3 4 5 become green colored.\nI prefer using conditional format even if it needs vba code so I dont have to run it everytime there's new 0 in column O.</p>\n\n<p>I've used this code but it doesn't work (obviously), but maybe it's a little different with my question because the real data is more complicated than what I illustrated. My data table starts at 4th row (header on 3rd). This code only formats 1 row (above the row that has zero column O value) and what I need is all rows with same column C value are formatted. Please keep in mind that I'm a newbie in vba :(</p>\n\n<pre><code>With Range(\"A4:r8000\").FormatConditions.Add( _ \nType:=xlExpression, _\n Formula1:=\"=AND($C4=$C5,$O5=0,$F4&lt;&gt;0)\")\n .Interior.Color = 13551615\n .Font.Color = -16383844\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer", "macros"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1473274939, "post_id": 39374457, "comment_id": 66082521, "body": "While debug, enter <code>? TypeName(IE.document)</code> in Immediate window to check the actual type. What Excel version are you using - 32 or 64 bit?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473277198, "post_id": 39374457, "comment_id": 66083612, "body": "What references do you have enabled?"}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "is_accepted": false, "score": 0, "last_activity_date": 1473280834, "creation_date": 1473280834, "answer_id": 39378646, "question_id": 39374457, "link": "https://stackoverflow.com/questions/39374457/updated-to-ie-explorer-11-marco-update-is-not-working/39378646#39378646", "title": "updated to IE explorer 11. Marco update is not working", "body": "<p>Make sure that the reference : Microsoft HTML Object Library is checked. </p>\n\n<p>You can go in Tools/References in the VBA editor. </p>\n"}], "owner": {"reputation": 23, "user_id": 5666090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a262422534d6f253ca3bfcb7cadc15de?s=128&d=identicon&r=PG&f=1", "display_name": "S.Nair", "link": "https://stackoverflow.com/users/5666090/s-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473280834, "creation_date": 1473263666, "last_edit_date": 1473264208, "question_id": 39374457, "link": "https://stackoverflow.com/questions/39374457/updated-to-ie-explorer-11-marco-update-is-not-working", "title": "updated to IE explorer 11. Marco update is not working", "body": "<p>I just updated to IE11.  Just made an update to my report (macro) and it's giving me a run time error... run-time error'13': type mismatch.  When I debug, below is where it's taking me to - specifically Set pDocument = IE.document... Can you help please.  Thank you so much</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n\n     IE.navigate \"https://famis.web.fedex.com/fwr/menus/menu-15-a.cfm?chgDiv=1&amp;Division=09\"\n\n\nWith IE\n    .Top = 1\n    .Left = 1\n    .Height = 400\n    .Width = 600\nEnd With\n\nIE.Visible = True\n\n    Do While IE.Busy\n    Loop\n\n\n    Dim pDocument As IHTMLDocument2\n    Dim pElements As IHTMLElementCollection\n    Dim pElement As IHTMLElement\n    Set pDocument = IE.document\n    Set pElements = pDocument.all\n\nWorksheets(\"Setup\").Range(\"A10\").Value = IE.LocationName\n\n\n\nIf IE.LocationName = \"SSO Login\" Then\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "ms-word"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 2, "creation_date": 1473266359, "post_id": 39374452, "comment_id": 66078420, "body": "How many rows does Table(1) have? If Table(1) has 24 rows, then you might get such an error."}], "answers": [{"tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 0, "last_activity_date": 1473269005, "creation_date": 1473269005, "answer_id": 39375922, "question_id": 39374452, "link": "https://stackoverflow.com/questions/39374452/looping-through-excel-cells-and-writing-them-to-word/39375922#39375922", "title": "Looping through Excel Cells and writing them to Word", "body": "<p>Looks like the table might not have enough rows.  If so, a brute-force way is to add rows as you need them:</p>\n\n<pre><code>...\nFor Col = 1 To 3\n    For Row = 3 To 32\n        ' vvv new lines vvv\n        Do While wrd.ActiveDocument.Tables(1).Rows.Count &lt; j\n            wrd.ActiveDocument.Tables(1).Rows.Add\n        Loop\n        ' ^^^ new lines ^^^\n        ...\n</code></pre>\n\n<p>I also recommend renaming <code>j</code>, <code>k</code>, <code>Row</code>, and <code>Col</code> to more descriptive names.  You have Excel row/column indices and Word-table row/column indices, and it's easy to get them confused unless the names are clear.</p>\n\n<p>(Note: Yes, the above code is slow, clunky, unoptimized, yadda yadda.  Hopefully it will help the OP. :) )</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "is_accepted": false, "score": 1, "last_activity_date": 1477940669, "creation_date": 1477940669, "answer_id": 40348851, "question_id": 39374452, "link": "https://stackoverflow.com/questions/39374452/looping-through-excel-cells-and-writing-them-to-word/40348851#40348851", "title": "Looping through Excel Cells and writing them to Word", "body": "<p>I think it's a lot easier to use DocVariables in Word and push your data from Excel cells into the DocVariables.  The end game is about the same, but I think the code is a lot easier to setup and maintain.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n'On Error Resume Next\n\nobjWord.ActiveDocument.variables(\"FirstName\").Value = Range(\"FirstName\").Value\nobjWord.ActiveDocument.variables(\"LastName\").Value = Range(\"LastName\").Value\nobjWord.ActiveDocument.variables(\"AnotherVariable\").Value = Range(\"AnotherVariable\").Value\n\nobjWord.ActiveDocument.Fields.Update\n\n'On Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Set a reference ot the MS Word Object Library.</p>\n"}], "owner": {"reputation": 35, "user_id": 6504476, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/67b5ad1b0d52896dae28e248d19205e4?s=128&d=identicon&r=PG&f=1", "display_name": "Katie J", "link": "https://stackoverflow.com/users/6504476/katie-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 39375922, "answer_count": 2, "score": 1, "last_activity_date": 1477940669, "creation_date": 1473263654, "last_edit_date": 1473268877, "question_id": 39374452, "link": "https://stackoverflow.com/questions/39374452/looping-through-excel-cells-and-writing-them-to-word", "title": "Looping through Excel Cells and writing them to Word", "body": "<p>I am using a Macro in Excel to loop through cells and write the data into a Template in Word.  Everything worked completely fine until I wanted to add more cells to grab data from. Everything still works fine except once the variable I have name \"j\" gets to the value of 25, I get an error saying \"Run-time error '5941': The requested member of the collection does not exist.\"</p>\n\n<p>I've played around with using different rows and columns and every combination works. It is only when the \"<code>j</code>\" reaches 25 does the error occur. It is failing when it reaches the <code>wrd.ActiveDocument.Tables(1).Rows(j)</code>... line.</p>\n\n<pre><code>Sub Label_ExcelToWord_Single()\n    'Variable that stores file path for\n    'word template\n    Dim strpath As String\n    strpath = Cells(28, 8)\n\n    'opens Microsoft Word to edit template\n    Call OpenWord\n\n    Set wrd = GetObject(, \"Word.Application\")\n    wrd.Visible = True\n    wrd.Activate\n\n    wrd.ActiveDocument.Close savechanges:=False\n    wrd.Documents.Open strpath\n\n    'Variables used for loop data manipulation\n    Dim k As Integer\n    Dim j As Integer\n    k = 1\n    j = 1\n\n    'Primary loop responsible for exporting Excel\n    'data to word template\n    For Col = 1 To 3\n        For Row = 3 To 32\n            wrd.ActiveDocument.Tables(1).Rows(j).Cells(((Row - 3) Mod 7) + k).Range.Text = Cells(Row, Col) &amp; vbCrLf &amp; Cells(Row, Col)\n            If k = 7 Then\n                k = 0\n                j = j + 2\n            End If\n            If Col = 3 Then\n                If Row = 32 Then\n                    'When we reach the last cell containing data exit routine\n                    Exit Sub\n                End If\n            End If\n            k = k + 1\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1473263717, "post_id": 39374246, "comment_id": 66076916, "body": "search SO for how to send email with Outlook from Excel: there will come out tons of answers"}, {"owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473263988, "post_id": 39374246, "comment_id": 66077097, "body": "I have but they dont really say how to integrate it into my already existing code"}], "answers": [{"comments": [{"owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "edited": false, "score": 0, "creation_date": 1473669319, "post_id": 39375248, "comment_id": 66214409, "body": "Thank you so much. This is a lot clearer than others i found"}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": true, "score": 1, "last_activity_date": 1473266202, "creation_date": 1473266202, "answer_id": 39375248, "question_id": 39374246, "link": "https://stackoverflow.com/questions/39374246/submit-button-and-email-excel/39375248#39375248", "title": "submit button and email - excel", "body": "<p>Add below to your code</p>\n\n<pre><code>dim olApp as object, olMail as object\n\nset olApp = createobject(\"outlook.application\")\nset olMail = olApp.createitem(0) \n\nWith olMail\n    .To = \"Test123@outlook.com\"\n    .Cc = \"\"\n    .Bcc = \"\"\n    .Subject = \"machine checklist submitted\"\n    .body = \"machine checklist submitted\"\n    .Send\nEnd With\nset olApp = nothing\nset olMail = nothing\n</code></pre>\n"}], "owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 39375248, "answer_count": 1, "score": -1, "last_activity_date": 1473266202, "creation_date": 1473263041, "question_id": 39374246, "link": "https://stackoverflow.com/questions/39374246/submit-button-and-email-excel", "title": "submit button and email - excel", "body": "<p>I have a button and macro currently set up that allows a sheet to save to a folder and close that sheet. Is there a way I can add to the macro so it will email out a message from Outlook saying something along the lines of \"machine checklist submitted\" to Test123@outlook.com for example. Below is the code i already have that works a treat.</p>\n\n<pre><code>Sub Saveworkbook()\nApplication.DisplayAlerts = False\nDim Sheet1 As Worksheet\nDim dName$, vName$, sName$\n    dName = Range(\"B8\")\n    vName = ActiveWorkbook.FullName\n    sName = ActiveWorkbook.ActiveSheet.Name\n    For Each Sheet1 In ActiveWorkbook.Sheets\n    If Not Sheet1.Name = sName Then\n    Sheet1.Delete\n    End If\n    Next Sheet1\n\n    ActiveWorkbook.SaveAs \"\\\\filestore\\IT$\\Forms and Templates\\Completed Checklists\\\" &amp; dName &amp; \"_\" &amp; Environ(\"username\") &amp; \"_\" &amp; Format(Now, \"ddmmyy\")\n    ActiveWorkbook.Close\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance\nSam</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2058, "user_id": 6530111, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1325612580789223/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/6530111/david"}, "edited": false, "score": 0, "creation_date": 1473262357, "post_id": 39373863, "comment_id": 66076031, "body": "When stepping through it, have you checked all of the values for each item in the line? Eg; Does <code>i</code> hold the correct row number? Is the <code>.Value</code> value correct? The same for <code>ParID</code>?"}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "reply_to_user": {"reputation": 2058, "user_id": 6530111, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1325612580789223/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/6530111/david"}, "edited": false, "score": 0, "creation_date": 1473264642, "post_id": 39373863, "comment_id": 66077494, "body": "It won&#39;t step though and continues to hang up on the error line, however <code>i</code> does hold the correct row number and <code>.Value&#39; does contain the correct value and </code>ParID` indeed contains the correct numeric ID that was assigned."}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1473265576, "post_id": 39375043, "comment_id": 66078018, "body": "Yeah well, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192660.aspx\" rel=\"nofollow noreferrer\">ComboBox.Column</a> doesn&#39;t return an object, but a Variant. So <code>.Value</code> is indeed wrong."}], "tags": [], "owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "is_accepted": false, "score": 0, "last_activity_date": 1473265438, "creation_date": 1473265438, "answer_id": 39375043, "question_id": 39373863, "link": "https://stackoverflow.com/questions/39373863/object-required-with-access-combobox-in-with-statement/39375043#39375043", "title": "Object required with Access Combobox in With statement", "body": "<p>Well I'll be damned! I found out the problem.</p>\n\n<p>I don't know if it was a syntax issue or logic issue but I removed the <code>.value</code> from:</p>\n\n<pre><code>If .Column(1, i).Value = ParID Then\n</code></pre>\n\n<p>So here's the new, fully working code:</p>\n\n<pre><code>Private Sub Command223_Click()\nDim ParID As Long\nDim Combo As ComboBox\nSet Combo = Forms![Deal Tracker Query2]!Combo217\nParID = Me.ParentID.Value\n\nWith Combo\n   For i = 0 To Combo.ListCount - 1\n      If .Column(1, i) = ParID Then\n         .Value = .ItemData(i)\n         Exit For\n      End If\n   Next\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473265438, "creation_date": 1473261885, "question_id": 39373863, "link": "https://stackoverflow.com/questions/39373863/object-required-with-access-combobox-in-with-statement", "title": "Object required with Access Combobox in With statement", "body": "<p>this is a separate issue with a previous one that I had submitted and got some help with.</p>\n\n<p>I'm trying to work with some code that checks a numeric ID field on a form (Record set originates from a query of complex joins) and compares it to a combobox of values, that is unbound to the form but originates from a query and fills in the combo box, based on the numeric ID on the form.\nThe query for the combo box has two columns bound \"Name\" and \"ID\" with the ID field hidden.</p>\n\n<p>I keep getting \"Object Required\" error when attempting to run the code and I've tried everything to debug it. The strange thing is: While debugging, each line of the code returns/contains the values it should, so Access is seeing the combobox as a valid object, but it continues to return the error.</p>\n\n<p>First shot at the code:</p>\n\n<pre><code>Dim ParID\nDim i as Integer\nParID = Me.ParentID.Value\n\nWith Combo217\n   For i = 0 To .ListCount - 1\n      If .Column(1, i).Value = ParID Then\n         .Value = .ItemData(i)\n         Exit For\n      End If\n   Next\nEnd With\n</code></pre>\n\n<p>This didn't work</p>\n\n<p>So I tried putting the combobox into a variable and declaring it specifically as a combobox:</p>\n\n<pre><code>Private Sub Command223_Click()\nDim ParID\nDim Combo As ComboBox\nSet Combo = Combo217\nParID = Me.ParentID.Value\n\nWith Combo\n   For i = 0 To Combo.ListCount - 1\n      If .Column(1, i).Value = ParID Then\n         .Value = .ItemData(i)\n         Exit For\n      End If\n   Next\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>Again same error</p>\n\n<p>Finally I tried to explicitly declare the combobox on the form that it's originating from:</p>\n\n<pre><code>Private Sub Command223_Click()\nDim ParID\nDim Combo As ComboBox\nSet Combo = Forms!DT2!Combo217\nParID = Me.ParentID.Value\n\nWith Combo\n   For i = 0 To Combo.ListCount - 1\n      If .Column(1, i).Value = ParID Then\n         .Value = .ItemData(i)\n         Exit For\n      End If\n   Next\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>Any and all watch windows and debug prints keep telling me that the loop sees values in the combo box and is even assigning the correct selection in this line:</p>\n\n<pre><code>.Value = .ItemData(i)\n</code></pre>\n\n<p>But continues to error out</p>\n\n<p>Oh and the line it's complaining about is:</p>\n\n<pre><code>If .Column(1, i).Value = ParID Then\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1473354013, "post_id": 39373718, "comment_id": 66119006, "body": "What are you doing with <code>Selection.RowHeight = 15</code>? Seems like the end result is to select some cells but what happens with that?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6515143, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ee770213fddf17030590fd2ef5fedf29?s=128&d=identicon&r=PG&f=1", "display_name": "pinkrose", "link": "https://stackoverflow.com/users/6515143/pinkrose"}, "edited": false, "score": 0, "creation_date": 1473284765, "post_id": 39375125, "comment_id": 66086848, "body": "Thanks- how do I translate this below into .row Rows(&quot;2:2&quot;).Select         Range(Selection, Selection.End(xlDown)).Select         Selection.RowHeight = 15"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 19, "user_id": 6515143, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ee770213fddf17030590fd2ef5fedf29?s=128&d=identicon&r=PG&f=1", "display_name": "pinkrose", "link": "https://stackoverflow.com/users/6515143/pinkrose"}, "edited": false, "score": 0, "creation_date": 1473289355, "post_id": 39375125, "comment_id": 66088311, "body": "@pinkrose: Please don&#39;t post code in comments. Edit your question and add it there - but it seems like a new question, so perhaps post a new one."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1473265727, "creation_date": 1473265727, "answer_id": 39375125, "question_id": 39373718, "link": "https://stackoverflow.com/questions/39373718/excel-not-closing-in-vba-access-module/39375125#39375125", "title": "Excel not Closing in vba access module", "body": "<p>You have <code>With wb.Sheets(1)</code>, but don't actually use it.</p>\n\n<p>Also, it is advisable to not use the Selection object.</p>\n\n<p>Try this (note the <code>.</code> before <code>Columns</code>)</p>\n\n<pre><code>With wb.Sheets(1)\n    .Columns(\"E:E\").NumberFormat = \"m/d/yyyy\"        \n    .Columns(\"C:C\").HorizontalAlignment = xlCenter\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1473908676, "creation_date": 1473908676, "answer_id": 39502519, "question_id": 39373718, "link": "https://stackoverflow.com/questions/39373718/excel-not-closing-in-vba-access-module/39502519#39502519", "title": "Excel not Closing in vba access module", "body": "<p>YOU HAVE TO CLOSE EVERY SINGLE OBJECT THAT YOU OPEN.  Andre underscored the issue.  Look very closely at your code.  </p>\n"}], "owner": {"reputation": 19, "user_id": 6515143, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ee770213fddf17030590fd2ef5fedf29?s=128&d=identicon&r=PG&f=1", "display_name": "pinkrose", "link": "https://stackoverflow.com/users/6515143/pinkrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594023077, "creation_date": 1473261457, "last_edit_date": 1594023077, "question_id": 39373718, "link": "https://stackoverflow.com/questions/39373718/excel-not-closing-in-vba-access-module", "title": "Excel not Closing in vba access module", "body": "<p>What's wrong on the function below. Excel.exe*32 not closing in task manager. </p>\n\n<pre><code>Function formatExcel()\n    Dim FileName As String\n    FileName = \"C:\\This file\\queryCentering.xlsx\"\n    Set xl = New Excel.Application\n    Set wb = xl.Workbooks.Open(FileName)\n    With wb.Sheets(1)\n        Columns(\"E:E\").Select\n        Selection.NumberFormat = \"m/d/yyyy\"        \n\n        Columns(\"C:C\").HorizontalAlignment = xlCenter\n        Rows(\"2:2\").Select \n        Range(Selection, Selection.End(xlDown)).Select  \n        Selection.RowHeight = 15 \n\n    End With\n    wb.Save\n    wb.Close True\n    Set wb = Nothing\n    xl.Quit\n    Set xl = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "object", "insert", "vba"], "comments": [{"owner": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1473287532, "post_id": 39373711, "comment_id": 66087791, "body": "You&#39;re trying to put an entire Excel workbook into a single cell?"}, {"owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "reply_to_user": {"reputation": 318, "user_id": 3250452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3ce4422a640b06398cde22466f0f9ac?s=128&d=identicon&r=PG&f=1", "display_name": "C-Love511", "link": "https://stackoverflow.com/users/3250452/c-love511"}, "edited": false, "score": 0, "creation_date": 1473422824, "post_id": 39373711, "comment_id": 66146597, "body": "No, I realized I needed to insert an Object - the Excel workbook - probably using OLE with which I was unfamiliar, but I found some script and adapted it to my purpose."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1473422988, "creation_date": 1473422988, "answer_id": 39411277, "question_id": 39373711, "link": "https://stackoverflow.com/questions/39373711/how-to-insert-an-excel-workbook-into-another-excel-workbook-range/39411277#39411277", "title": "How to Insert an Excel workbook into another Excel workbook range", "body": "<p>I realized I was inserting an object, so that I probably had to use OLE, with which I was unfamiliar.  I found and adapted an answer into my macro yesterday, but forgot to come back and post it, so thanks for the \"reminder\" to post it for the benefit of others:</p>\n\n<pre><code>'Inserts the Backup Template file into the JDT file\n\nFor Each cell In JDT.Sheets(\"Document Template\").Range(\"E44\")\nIf IsEmpty(cell) Then\n    Dim ol As OLEObject\n    Set ol = ActiveSheet.OLEObjects.Add(Filename:=Path &amp; Fname,   \n    Link:=False,     DisplayAsIcon:=True, Height:=2)\n   With ol\n    .Top = cell.Offset(0, 1).Top\n    .Left = cell.Offset(0, 1).Left\n   End With\n  End If\nNext\n</code></pre>\n\n<p>I realize a For-Next Loop to target 1 cell is inefficient, but it gave me cell oriented statements that were useful, so having already spent too much time on this, I moved on to the next challenge. </p>\n"}], "owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473422988, "creation_date": 1473261448, "last_edit_date": 1531164843, "question_id": 39373711, "link": "https://stackoverflow.com/questions/39373711/how-to-insert-an-excel-workbook-into-another-excel-workbook-range", "title": "How to Insert an Excel workbook into another Excel workbook range", "body": "<p>I need to insert one Excel workbook into another Excel workbook, always at the same range address of the 2nd workbook.  I have seen the \"Selection.InsertFile\" method,but how can I make that specific range the selection?  </p>\n\n<p>I tried:</p>\n\n<pre><code>JDT.Sheets(\"Document Template\").Range(\"E44\").Select\nSelection.InsertFile Filename:=Path &amp; Fname\n</code></pre>\n\n<p>but got:\"Object doesn't support this property or method\" </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1473262385, "creation_date": 1473262385, "answer_id": 39374039, "question_id": 39373710, "link": "https://stackoverflow.com/questions/39373710/related-to-article-get-a-subrange-that-has-all-the-cells-of-a-range-except-of-a/39374039#39374039", "title": "related to article Get a subrange that has all the cells of a range except of a range of", "body": "<p>Hide the cells that you do not want to include if you are attempting a reverse-Union. Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a> to get the visible cells.</p>\n\n<pre><code>dim a as long, arr as variant, r as range, rng as range\narr = array(2, 3)\nfor a = lbound(arr) to ubound(arr)\n    range(\"B5:H20\").rows(arr(a)).entirerow.hidden = true\nnext a\nset rng = range(\"B5:H20\").specialcells(xlcelltypevisible)\nrange(\"B5:H20\").entirerow.hidden = false\n\ndebug.print rng.address(0,0)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6805200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e1e6bd6be7b002bd0a7858a349dae9?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeEng", "link": "https://stackoverflow.com/users/6805200/georgeeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473262385, "creation_date": 1473261448, "last_edit_date": 1531161705, "question_id": 39373710, "link": "https://stackoverflow.com/questions/39373710/related-to-article-get-a-subrange-that-has-all-the-cells-of-a-range-except-of-a", "title": "related to article Get a subrange that has all the cells of a range except of a range of", "body": "<p>Hi all I want to create a subrange  that excludes certain rows from that range lets say the 2nd and the 3rd row.  I have seen some answers on that site of how I can realize that, like </p>\n\n<pre><code>set rng = Range(\"B5:H20\")\n\nset subrng=rng.offset(1).resize(rng.rows.count-1)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Set subrng = Intersect(rng.Offset(1), rng)\n</code></pre>\n\n<p>but because I am a beginner I do not know what script goes above and underneath those commands  so that can be compatible with VBA and make it related with my worksheet.So I would like to have your help on that.</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1473260895, "creation_date": 1473260895, "answer_id": 39373498, "question_id": 39373316, "link": "https://stackoverflow.com/questions/39373316/how-to-merge-3-columns-to-1-new-column-with-vba/39373498#39373498", "title": "How to merge 3 columns to 1 new column with VBA", "body": "<p>I would use a pair of <a href=\"https://msdn.microsoft.com/en-us/library/aa241892.aspx\" rel=\"nofollow\">Replace functions</a> on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553.aspx\" rel=\"nofollow\">Range.Value2 property</a>.</p>\n\n<pre><code>Option Explicit\n\nSub wqwewuy()\n    Dim rw As Long, lr As Long\n\n    With ActiveSheet\n        lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        For rw = 1 To lr\n            .Cells(rw, \"D\") = Replace(Replace(.Cells(rw, \"A\").Value2, _\n                                        Chr(34), .Cells(rw, \"B\").Value2 &amp; Chr(34)), _\n                                        Chr(63), .Cells(rw, \"C\").Value2 &amp; Chr(63))\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "is_accepted": false, "score": 2, "last_activity_date": 1473261952, "creation_date": 1473261952, "answer_id": 39373897, "question_id": 39373316, "link": "https://stackoverflow.com/questions/39373316/how-to-merge-3-columns-to-1-new-column-with-vba/39373897#39373897", "title": "How to merge 3 columns to 1 new column with VBA", "body": "<p>The previous answer is a good solution and you could also do it this way.</p>\n\n<pre><code>Sub MergeColumns()\n\n    Dim LR As Long\n    Dim cell As Range, RNG As Range\n\n    LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set RNG = Range(\"A1:A\" &amp; LR)\n\n    For Each cell In RNG\n        cell.Offset(0, 3) = Left(cell.Value, 2) &amp; \" \" _\n                    &amp; cell.Offset(0, 1) &amp; \" \" _\n                    &amp; Mid(cell.Value, 4, 13) &amp; \" \" _\n                    &amp; cell.Offset(0, 2) &amp; Right(cell.Value, 1)\n    Next cell\n\n    Range(\"C:C\").Columns.AutoFit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 39373498, "answer_count": 2, "score": 1, "last_activity_date": 1473261952, "creation_date": 1473260387, "last_edit_date": 1592644375, "question_id": 39373316, "link": "https://stackoverflow.com/questions/39373316/how-to-merge-3-columns-to-1-new-column-with-vba", "title": "How to merge 3 columns to 1 new column with VBA", "body": "<p>I'm trying to merge 3 column they all have a text (string) in them</p>\n<p>lets say Column A is like this:</p>\n<ol>\n<li><p>Hi &quot; are you from ?</p>\n</li>\n<li><p>Hi &quot; are you from ?</p>\n</li>\n<li><p>Hi &quot; are you from ?</p>\n<p>Column B:</p>\n</li>\n<li><p>Peter</p>\n</li>\n<li><p>mom</p>\n</li>\n<li><p>dad</p>\n</li>\n</ol>\n<p>Column C:</p>\n<ol>\n<li>DK</li>\n<li>JP</li>\n<li>GB</li>\n</ol>\n<p>I want my out put in column D to be:</p>\n<ol>\n<li>Hi Peter&quot; are you from DK?</li>\n<li>Hi mom&quot; your are from JP?</li>\n<li>Hi dad&quot; your are from GB?</li>\n</ol>\n<p>My own code for this so fare is:</p>\n<pre><code>Sub MergeColumns()\n\n    Dim LR As Long\n    Dim cell As Range, RNG As Range\n\n    LR = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n    Set RNG = Range(&quot;A1:A&quot; &amp; LR)\n\n    For Each cell In RNG\n           cell.Offset(0, 4) = Left(cell.Value, 2) &amp; Range(B1:B) &amp;   Mid(cell.Value, 4, 13) &amp; Range(C1:C) &amp; Right(cell.Value, 1)\n    Next cell\n\n    Range(&quot;C:C&quot;).Columns.AutoFit\n\nEnd Sub\n</code></pre>\n<p>I kind of think the bug is at my Range(B1:B) and Range(C1:C) but i have no idea how to insert the column i tried with &quot;Concatenate&quot; but this just messed it up.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1473261156, "post_id": 39373286, "comment_id": 66075252, "body": "A <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834621.aspx\" rel=\"nofollow noreferrer\">Union</a> of cells will homogenize itself into a left-to-right / top-to-bottom arrangement. You need multiple operations if you wish to restructure the target."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473310007, "post_id": 39373286, "comment_id": 66092800, "body": "@Sage Mohan you can try my code (below), it&#39;s not ideal, but it will get the job done for you case"}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473344320, "post_id": 39373286, "comment_id": 66112824, "body": "@ShaiRado the code works. I tested it out today. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1473272686, "creation_date": 1473272686, "answer_id": 39376814, "question_id": 39373286, "link": "https://stackoverflow.com/questions/39373286/excel-specific-column-extraction/39376814#39376814", "title": "Excel specific column extraction", "body": "<p>It's quick (and dirty), but the following code will get you what you want:</p>\n\n<pre><code>Public Sub extractCol()\n\nDim newbook                 As Workbook\nDim ShtSource               As Worksheet\nDim ShtDest                 As Worksheet\n\n' modify Sheet 1 to your Source sheet name\nSet ShtSource = ThisWorkbook.Sheets(\"Sheet6\")\n\nSet newbook = Workbooks.Add\n\n' modify Sheet 1 to your Destination sheet name\nSet ShtDest = newbook.Sheets(\"Sheet1\")\n\nShtSource.Columns(\"A:A\").Copy Destination:=ShtDest.Columns(1)\nShtSource.Columns(\"BI:BI\").Copy Destination:=ShtDest.Columns(2)\nShtSource.Columns(\"C:C\").Copy Destination:=ShtDest.Columns(3)\nShtSource.Columns(\"L:L\").Copy Destination:=ShtDest.Columns(4)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39376814, "answer_count": 1, "score": 1, "last_activity_date": 1473272686, "creation_date": 1473260294, "last_edit_date": 1531161705, "question_id": 39373286, "link": "https://stackoverflow.com/questions/39373286/excel-specific-column-extraction", "title": "Excel specific column extraction", "body": "<p>I've been trying to extract certain columns from an Excel sheet from a multitude of unwanted columns. I've been running the following script:</p>\n\n<pre><code>Public Sub extractCol()\n  Set range1 = Range(\"A:A, BI:BI, C:C, L:L\")\n  range1.Copy\n  Set newbook = Workbooks.Add\n  ActiveCell.PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>This formula extracts the data however, the output comes out as:</p>\n\n<pre><code>Column A   Column C   Column L   Column BI\n</code></pre>\n\n<p>When the output I need is:</p>\n\n<pre><code>Column A   Column BI   Column C   Column L\n</code></pre>\n\n<p>How can I change the code to get the desired output?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1473261253, "creation_date": 1473261253, "answer_id": 39373632, "question_id": 39373271, "link": "https://stackoverflow.com/questions/39373271/trying-as-assign-a-sql-string-to-the-record-source-property-of-access-report/39373632#39373632", "title": "Trying as assign a SQL string to the record source property of Access report", "body": "<p><code>Me.RecordSource strsql</code> should be <code>Me.RecordSource = strsql</code></p>\n\n<p>But do you know there is a <code>WhereCondition</code> option when you open a report ?<br>\nYou can also use <code>OpenArgs</code> to pass a parameter to the report/form when you open it.</p>\n\n<pre><code>docmd.OpenReport reportname:=\"SomeReport\", _  \n                 whereCondition:=\"Category = 33\", _\n                 openArgs:=\"Furniture\"  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10788025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1ZBFbdj_R54/AAAAAAAAAAI/AAAAAAAAAEw/5VSLd31aufA/photo.jpg?sz=128", "display_name": "James Kelley", "link": "https://stackoverflow.com/users/10788025/james-kelley"}, "is_accepted": false, "score": 0, "last_activity_date": 1595878794, "creation_date": 1595878794, "answer_id": 63122380, "question_id": 39373271, "link": "https://stackoverflow.com/questions/39373271/trying-as-assign-a-sql-string-to-the-record-source-property-of-access-report/63122380#63122380", "title": "Trying as assign a SQL string to the record source property of Access report", "body": "<p>Open the report hidden, set the recordsource then close the report and save:</p>\n<pre><code>DoCmd.OpenReport &quot;SomeReport&quot;, acViewDesign, , , acHidden\nReports!SomeReport.RecordSource = strSQL\nDoCmd.Close acReport, &quot;SomeReport&quot;, acSaveYes\n</code></pre>\n"}], "owner": {"reputation": 1674, "user_id": 945157, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3bLUo.jpg?s=128&g=1", "display_name": "jamesTheProgrammer", "link": "https://stackoverflow.com/users/945157/jamestheprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1595878794, "creation_date": 1473260243, "last_edit_date": 1594641422, "question_id": 39373271, "link": "https://stackoverflow.com/questions/39373271/trying-as-assign-a-sql-string-to-the-record-source-property-of-access-report", "title": "Trying as assign a SQL string to the record source property of Access report", "body": "<p>I have a form pictured below.  Three sort buttons, 1 preview report button.</p>\n\n<p><a href=\"https://i.stack.imgur.com/c86T3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c86T3.png\" alt=\"sort and preview buttons\"></a></p>\n\n<p>When the sort buttons are clicked, a publicly declared variable called strsql is updated.</p>\n\n<p>I have this code at top of Form</p>\n\n<pre><code>Option Compare Database\nPublic strsql As String\nOption Explicit\n</code></pre>\n\n<p>strsql is updated and used to populate the list area. </p>\n\n<p>One of the buttons click events</p>\n\n<pre><code>Private Sub cmdReturnDate_Click()\n   strsql = strSQL1 &amp; strSQL2 &amp; Me!cboDistricts.Value &amp; weekEndSort\n   Me!teachersList.RowSource = strsql\n   Me!teachersList.Requery\n End Sub\n</code></pre>\n\n<p>I am trying to use strsql as the recordsource for the report being called on the Preview Report button.</p>\n\n<p>I have this line of code in the event open function for the report and can see the correct sql in the variable strsql</p>\n\n<pre><code>Private Sub btnPreviewReport_Click() \n  MsgBox (strsql)\n\n  Rem assign the sql string to the reports data property.\n  DoCmd.OpenReport \"reportname\", acViewPreview\n\n End Sub\n</code></pre>\n\n<p>I either need to pass the sql to the report or reference the variable in the reports recordSource property.</p>\n\n<p>attempt to reference in report open event</p>\n\n<pre><code> Private Sub Report_Open(Cancel As Integer)\n\n   Me.RecordSource strsql\n\n End Sub\n</code></pre>\n\n<p>The report is currently not showing data, not recognizing the variable - no output.</p>\n\n<p><strong>Question is:  How can I access/assign strsql to the reports recordsource property?</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473260079, "post_id": 39373161, "comment_id": 66074459, "body": "Can you try this&gt;For Each axs In objCht&lt; instead?"}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473260229, "post_id": 39373161, "comment_id": 66074581, "body": "No dice. Still gets hung up when I remove <code>.Chart</code>"}], "answers": [{"comments": [{"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1473260721, "post_id": 39373403, "comment_id": 66074942, "body": "The caveat as that I&#39;m trying to avoid using <code>.Axes(xlValue)</code> and <code>.Axes(xlCategory)</code>. And instead have a catch-all with the <code>For Each axs</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1473260924, "post_id": 39373403, "comment_id": 66075081, "body": "I am not sure that you may loop through the axs with a for-each. Are the axs a collection?"}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 1, "creation_date": 1473261832, "post_id": 39373403, "comment_id": 66075687, "body": "The logic works as here: <code>Sub remove_gridlines()      Dim cht As Chart     Dim axs As Axis          &#39; change chart name here     Set cht = Sheets(&quot;Anesthesia&quot;).ChartObjects(&quot;Chart 2&quot;).Chart          For Each axs In cht.Axes         axs.HasMajorGridlines = False         axs.HasMinorGridlines = False     Next       End Sub</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1473262124, "post_id": 39373403, "comment_id": 66075872, "body": "see edit, I have not tested it, but it seems to work."}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 1, "creation_date": 1473262202, "post_id": 39373403, "comment_id": 66075925, "body": "That&#39;s throws a type mismatch."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1473328967, "last_edit_date": 1473328967, "creation_date": 1473260594, "answer_id": 39373403, "question_id": 39373161, "link": "https://stackoverflow.com/questions/39373161/removing-gridlines-in-all-charts-on-all-worksheets/39373403#39373403", "title": "Removing Gridlines in All Charts on All Worksheets", "body": "<p>You know, it is funny what was the real reason, but now the code works:</p>\n\n<pre><code>Sub RemoveGridlines2()\n\n    Dim axs             As Axis\n    Dim ws              As Worksheet\n    Dim objCht          As ChartObject\n    Dim k               As Chart\n\n    For Each ws In Worksheets\n        For Each objCht In ws.ChartObjects\n            Set k = Sheets(ws.Name).ChartObjects(objCht.Name).Chart\n            For Each axs In k.Axes\n                axs.HasMajorGridlines = False\n                axs.HasMinorGridlines = False\n            Next\n            Set k = Nothing\n        Next objCht\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Actually, if you change \"AXES\" to \"AXIS\" in your code in the \"DIM\" you may also get a working code :) \nEnjoy it! :D</p>\n\n<p>EDIT: \nAnd that is how your code should look like:</p>\n\n<pre><code>Sub RemoveGridlines()\n\n    Dim axs                 As Axis\n    Dim ws                  As Worksheet\n    Dim objCht              As ChartObject\n\n    For Each ws In Worksheets\n        ws.Activate\n        For Each objCht In ws.ChartObjects\n            For Each axs In objCht.Chart.Axes\n                axs.HasMajorGridlines = False\n                axs.HasMinorGridlines = False\n            Next axs\n        Next objCht\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2792, "favorite_count": 0, "accepted_answer_id": 39373403, "answer_count": 1, "score": 1, "last_activity_date": 1473328967, "creation_date": 1473259961, "last_edit_date": 1473260312, "question_id": 39373161, "link": "https://stackoverflow.com/questions/39373161/removing-gridlines-in-all-charts-on-all-worksheets", "title": "Removing Gridlines in All Charts on All Worksheets", "body": "<p>I'm working with the following code:</p>\n\n<pre><code>Sub RemoveGridlines()\n\nDim axs As Axes\nDim ws As Worksheet\nDim objCht As ChartObject\n\nFor Each ws In Worksheets\n        ws.Activate\n        For Each objCht In ws.ChartObjects\n            With objCht.Chart\n                For Each axs In objCht.Chart\n                    .Axes.HasMajorGridlines = False\n                    .Axes.HasMinorGridlines = False\n                Next axs\n            End With\n        Next objCht\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>And get hung up on <code>For Each axs In objCht.Chart</code> as an object mismatch. I tried adding <code>.axes</code> to the line but it won't proceed regardless. \nHow can I get this to loop through each axis, chart, and worksheet? Even when I remove<code>.Chart</code> and remove <code>.Axes</code> from the subsequent lines I get <code>Method or data member not found</code>.</p>\n"}, {"tags": ["sql", "vba", "sql-insert"], "comments": [{"owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "edited": false, "score": 0, "creation_date": 1473259424, "post_id": 39372538, "comment_id": 66073918, "body": "It seems you are just overwriting the Max field in the VB version. Do you want to store concatenated values in Max? Can you give an example of what the field values should look like?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1473263306, "post_id": 39372538, "comment_id": 66076659, "body": "Well between select case and if statements you should be able delegate what value needs o be part of the insert statement."}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "reply_to_user": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "edited": false, "score": 0, "creation_date": 1473305456, "post_id": 39372538, "comment_id": 66091788, "body": "Could you provide the table structure for <code>tableY</code>? By your SQL, you have 2 columns named <code>max</code>.  Or as @Coolshaikh said, you want to store the concatenated value?"}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "is_accepted": true, "score": 0, "last_activity_date": 1473926331, "creation_date": 1473926331, "answer_id": 39505868, "question_id": 39372538, "link": "https://stackoverflow.com/questions/39372538/vb-script-into-sql-vb-making-2-inserts-into-one-column/39505868#39505868", "title": "VB script into SQL (VB making 2 inserts into one column)", "body": "<p>It turns out the the VB script was overwriting the data. The second insert was the only one being actually inserted.</p>\n"}], "owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 39505868, "answer_count": 1, "score": 0, "last_activity_date": 1473926331, "creation_date": 1473258236, "last_edit_date": 1473308865, "question_id": 39372538, "link": "https://stackoverflow.com/questions/39372538/vb-script-into-sql-vb-making-2-inserts-into-one-column", "title": "VB script into SQL (VB making 2 inserts into one column)", "body": "<p>I'm new to coding so pls take it easy on me.<br>\nI'm rewriting a Visual Basic to SQL.</p>\n\n<p>The VB code inserts transformed data from a file into <code>tableY</code>.<br>\nI want my SQL code to load the data into <code>tableX</code>, transform it and load it into <code>tableY</code>.<br>\nI created <code>tableX</code> and inserted the untransformed data from the file. Now I want to transform it and insert it into <code>tableY</code> when I notice a problem.</p>\n\n<p>Here is the VB code</p>\n\n<pre><code>IF some-if-statement THEN\n    DTSDestination(\"max\") = Mid(DTSSource(\"Col001\"),985,5)\n    another MID\n    another MID\n    another MID\n    DTSDestination(\"max\") = Mid(DTSSource(\"Col001\"),983,5)\n</code></pre>\n\n<p>Here is my SQL version:</p>\n\n<pre><code>INSERT INTO tableY (max, aaa, bbb, ccc, max)\nselect\n    substring(Col001,985,5),\n    another substring,\n    another substring,\n    another substring,\n    substring(Col001,983,5)\nfrom tableX \nwhere some-where-statement\n</code></pre>\n\n<p>The problem is that I'm trying to insert 2 values <code>[substring(Col001,985,5)</code> and <code>substring(Col001,983,5)]</code> into 1 column.<br>\nObviously SQL gives me an error:  </p>\n\n<blockquote>\n  <p>The column name 'max' is specified more than once in the SET clause or column list of an INSERT. A column cannot be assigned more than one value in the same clause. Modify the clause to make sure that a column is updated only once. If this statement updates or inserts columns into a view, column aliasing can conceal the duplication in your code.`</p>\n</blockquote>\n\n<p>I am certain that the VB version works, even though it shouldn't - because it does the same thing.<br>\nAny ideas on how I can fix this? Inserting just one value won't work for me since I don't know which one is the correct one.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1473257299, "post_id": 39371945, "comment_id": 66072197, "body": "Maybe it&#39;s just me, but it&#39;s very unclear what you ask."}, {"owner": {"reputation": 3, "user_id": 6608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5d6da37290d2fac3b8b833817936e?s=128&d=identicon&r=PG&f=1", "display_name": "Ela", "link": "https://stackoverflow.com/users/6608461/ela"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1473258316, "post_id": 39371945, "comment_id": 66073009, "body": "I want to 1) Define the Range in wich I will perform my search, 2) For each cell in range check is value is AV, 3) if value is AV, then define Range to copy."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5d6da37290d2fac3b8b833817936e?s=128&d=identicon&r=PG&f=1", "display_name": "Ela", "link": "https://stackoverflow.com/users/6608461/ela"}, "edited": false, "score": 0, "creation_date": 1473324616, "post_id": 39374369, "comment_id": 66099682, "body": "thanks for your answer, it works well, but I have another problem and I could not solve it, at the moment the data copied from Job but paste it in Einf&#252;gen from C11:H9616 but I need to Copy data for Av  in &quot;Einfugen&quot; C11:H1611 then An in  &quot;I11:N1611&quot; , Af in  (&quot;O11:T1611&quot;), Zi in (&quot;U11:Z1611&quot;), Ar in  (&quot;AA11:AF1611&quot;), LCL in  (&quot;AG11:AL1611&quot;)"}, {"owner": {"reputation": 3, "user_id": 6608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5d6da37290d2fac3b8b833817936e?s=128&d=identicon&r=PG&f=1", "display_name": "Ela", "link": "https://stackoverflow.com/users/6608461/ela"}, "edited": false, "score": 0, "creation_date": 1473333081, "post_id": 39374369, "comment_id": 66104934, "body": "I really appriciate it if you can help me in this part as well"}, {"owner": {"reputation": 3, "user_id": 6608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5d6da37290d2fac3b8b833817936e?s=128&d=identicon&r=PG&f=1", "display_name": "Ela", "link": "https://stackoverflow.com/users/6608461/ela"}, "edited": false, "score": 0, "creation_date": 1473412300, "post_id": 39374369, "comment_id": 66140605, "body": "tnx I found my answer"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1473263418, "creation_date": 1473263418, "answer_id": 39374369, "question_id": 39371945, "link": "https://stackoverflow.com/questions/39371945/excel-vba-specific-copy-paste-string-to-another-sheet-with-all-its-range-to-sp/39374369#39374369", "title": "excel vba - specific copy/paste string to another sheet with all its range to specific range in another worksheet", "body": "<p>try this (commented) code:</p>\n\n<pre><code>Option Explicit\n\nSub DoMyJob()\n    Dim f As Range\n    Dim lastRow As Long\n    Dim keyword As Variant\n\n    Const KEYWORDS As String = \"Av,An,Af,Zi,Ar,LCL\" '&lt;--| list your 'keyword' strings\n    Const DATASETROWS As Long = 1600 '&lt;--| define data set range fixed amount of rows\n    Const DATASETCOLUMNS As Long = 6 '&lt;--| define data set range maximum amount of columns\n    Const COLUMNSOFFSETFROMKEYWORD As Long = 2 '&lt;--| define data set range rows offset from keyword cell\n    Const ROWSOFFSETFROMKEYWORD As Long = 2 '&lt;--| define data set columns rows offset from keyword cell\n\n    With Worksheets(\"Job\") '&lt;--| reference your data worksheet\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)) '&lt;--! reference its column \"A\" cells form row 1 down to last non empty one\n            For Each keyword In Split(KEYWORDS, \",\") 'loop through 'keywords' list\n                Set f = .Find(What:=keyword, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False) '&lt;--| search referenced cells for current 'keyword'\n                If Not f Is Nothing Then '&lt;--| if 'keyword' found then...\n                    Sheets(\"Einf\u00fcgen\").Range(\"C11\").Offset(lastRow).Resize(DATASETROWS, DATASETCOLUMNS).Value = _\n                    f.Offset(ROWSOFFSETFROMKEYWORD, COLUMNSOFFSETFROMKEYWORD).Resize(DATASETROWS, DATASETCOLUMNS).Value '&lt;--| copy data set fixed range values\n                    lastRow = lastRow + DATASETROWS '&lt;--|update destination sheet pasting row\n                End If\n            Next keyword\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5d6da37290d2fac3b8b833817936e?s=128&d=identicon&r=PG&f=1", "display_name": "Ela", "link": "https://stackoverflow.com/users/6608461/ela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1365, "favorite_count": 0, "accepted_answer_id": 39374369, "answer_count": 1, "score": 0, "last_activity_date": 1473263418, "creation_date": 1473256700, "last_edit_date": 1473257156, "question_id": 39371945, "link": "https://stackoverflow.com/questions/39371945/excel-vba-specific-copy-paste-string-to-another-sheet-with-all-its-range-to-sp", "title": "excel vba - specific copy/paste string to another sheet with all its range to specific range in another worksheet", "body": "<p>I am completely a newbie in the Excel VBA!<br>\nI have a task to copy ranges from worksheet  \u201dJob\u201d  to worksheet  \u201dEinf\u00fcgen\u201d when certain string is found.<br>\nWhat I have been previously done is manually selecting and then copy-paste it from \u201dJob\u201d  to \u201dEinf\u00fcgen\u201d. I want to use VBA to select and copy the 6 ranges out of available 19 ranges in \u201cJob\u201d (each range has fixed amount of rows which is 1600, columns can be 4 or 6), I am going to search for each table heading in Column A in the  \u201dJob\u201d sheet using the Find method, and then use the result of Find, plus an offset, as the starting position of a dynamic range. </p>\n\n<p>So for example, the string \"Av\" is found in A8033, but the range which I need starts in C8035. And also the positions of these strings are not fixed in specific rows they can be sorted differently for different inputs.<br>\nTherefore, In this case I want to first find \u201cAv\u201d position in \u201cJob\u201d which is A8033 in this example it has got 4 rows and then select range C8035 till F9635{F(8035+1600)} and copy-paste it in fixed range in \u201cEinf\u00fcgen\u201d which is C11:F1611 .<br>\nAnd then repeat for all further 6 heading strings. The headings will all appear in Column A, all the tables will have the same offset from the search string result (2,2), and the same number of columns (4 or 6), and the same number of rows (1600). \nI tried lots of way to solve it but unfortunately I could not find the code.\nI really appreciate if you could help me to solve it.\nMy 6 strings are: \u201cAv\u201d,\u201dAn\u201d,\u201dAf\u201d,\u201dZi\u201d,\u201dAr\u201d,\u201dLCL\u201d\nmy table in Job is like:</p>\n\n<pre><code>        A    B            C           D           E           F\n8033    Av                                  \n8034   Idx  [Hz]         DA 1        DA 2        DA 3        DA 4\n8035    0   1,00E+06    -9,58E-01   -9,65E-01   -9,74E-01   -9,62E-01\n8036    1   2,87E+06    -1,49E+00   -1,51E+00   -1,52E+00   -1,50E+00\n8034    2   4,75E+06    -1,84E+00   -1,88E+00   -1,88E+00   -1,86E+00\n8035    3   6,62E+06    -2,14E+00   -2,19E+00   -2,17E+00   -2,15E+00\n8036    4   8,50E+06    -2,39E+00   -2,45E+00   -2,43E+00   -2,41E+00\n8037    5   1,04E+07    -2,63E+00   -2,70E+00   -2,66E+00   -2,65E+00\n8038    6   1,22E+07    -2,86E+00   -2,92E+00   -2,89E+00   -2,88E+00\n8039    7   1,41E+07    -3,07E+00   -3,14E+00   -3,10E+00   -3,09E+00\n.\n.\n9635   1600 3,00E+09    -6,07E+01   -5,51E+01   -8,11E+01   -4,92E+01\n</code></pre>\n\n<p>you can see my code here:</p>\n\n<pre><code>Sub DoMyJob()\n\n    Dim IDump As Worksheet\n    Dim f As Range\n    Dim g As Range\n    Dim CapPremRng As Range\n    Worksheets(\"Job\").Activate\n    Set IDump = Sheets(\"Job\")\n\n    Set f = IDump.Range(\"A1:A30488\").Find(What:=\"Av\", LookIn:=xlValues, LookAt:=xlPart)\n    Set g = f.Offset(2, 2).Activate\n\n    Set CapPremRng = g.Range(\"A1:I\" &amp; Lastrow)\n\n    CapPremRng.Copy\n    Sheets(\"Einf\u00fcgen\").Range(\"C11\" &amp; Lastrow).PasteSpecial xlValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 185, "user_id": 6575062, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2244552e2069509d2678f9d9f6c77714?s=128&d=identicon&r=PG&f=1", "display_name": "Sjoerd89", "link": "https://stackoverflow.com/users/6575062/sjoerd89"}, "edited": false, "score": 0, "creation_date": 1473258348, "post_id": 39371958, "comment_id": 66073040, "body": "@Sjoerd89, you may mark the answer as accepted, by clicking the green checkbox on its left."}, {"owner": {"reputation": 185, "user_id": 6575062, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2244552e2069509d2678f9d9f6c77714?s=128&d=identicon&r=PG&f=1", "display_name": "Sjoerd89", "link": "https://stackoverflow.com/users/6575062/sjoerd89"}, "edited": false, "score": 0, "creation_date": 1473259326, "post_id": 39371958, "comment_id": 66073835, "body": "Sorry for being new but i can&#39;t see that green checkbox ;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 185, "user_id": 6575062, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2244552e2069509d2678f9d9f6c77714?s=128&d=identicon&r=PG&f=1", "display_name": "Sjoerd89", "link": "https://stackoverflow.com/users/6575062/sjoerd89"}, "edited": false, "score": 0, "creation_date": 1473259455, "post_id": 39371958, "comment_id": 66073943, "body": "@Sjoerd89 in the left margin, right underneath the upvote/downvote buttons next to the answer"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473259512, "post_id": 39371958, "comment_id": 66073985, "body": "Or check here -&gt; <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1473256725, "creation_date": 1473256725, "answer_id": 39371958, "question_id": 39371901, "link": "https://stackoverflow.com/questions/39371901/set-font-size-of-text/39371958#39371958", "title": "Set font size of text", "body": "<p>probably you may want to try with this:</p>\n\n<pre><code>&lt;BODY style=font-size:11pt;font-family:Calibri&gt;TEXT&lt;/BODY&gt;\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 6575062, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2244552e2069509d2678f9d9f6c77714?s=128&d=identicon&r=PG&f=1", "display_name": "Sjoerd89", "link": "https://stackoverflow.com/users/6575062/sjoerd89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 39371958, "answer_count": 1, "score": 1, "last_activity_date": 1593003678, "creation_date": 1473256553, "last_edit_date": 1593003678, "question_id": 39371901, "link": "https://stackoverflow.com/questions/39371901/set-font-size-of-text", "title": "Set font size of text", "body": "<p>I send text to Outlook email that shows up in font size 10.</p>\n\n<p>I have it set at 11 as the rest of my email. The signature is set to 11 as well.</p>\n\n<p>I am using this.</p>\n\n<pre><code>EBody_tekst = \"&lt;font face= Calibri size= 11px color=#000000&gt;\" &amp; _\n</code></pre>\n\n<p>But still the text will show up at fontsize 10.</p>\n"}, {"tags": ["c#", "vba", "excel", "com"], "comments": [{"owner": {"reputation": 3446, "user_id": 5520131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b1a21a95beb29e669c9174d20f025e1?s=128&d=identicon&r=PG&f=1", "display_name": "Innat3", "link": "https://stackoverflow.com/users/5520131/innat3"}, "edited": false, "score": 0, "creation_date": 1473256708, "post_id": 39371692, "comment_id": 66071772, "body": "What object type is &quot;ThisWorkbook&quot;? A WorkBook or a module? EDIT: also can&#39;t you access it by index? would the index number vary?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3446, "user_id": 5520131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b1a21a95beb29e669c9174d20f025e1?s=128&d=identicon&r=PG&f=1", "display_name": "Innat3", "link": "https://stackoverflow.com/users/5520131/innat3"}, "edited": false, "score": 0, "creation_date": 1473256860, "post_id": 39371692, "comment_id": 66071895, "body": "@Innat3 It&#39;s a global <code>Workbook</code> instance representing the host document containing the code of the current VBA project."}, {"owner": {"reputation": 3446, "user_id": 5520131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b1a21a95beb29e669c9174d20f025e1?s=128&d=identicon&r=PG&f=1", "display_name": "Innat3", "link": "https://stackoverflow.com/users/5520131/innat3"}, "edited": false, "score": 0, "creation_date": 1473257121, "post_id": 39371692, "comment_id": 66072082, "body": "that doesnt make any sense, the host document is already the variable &quot;excelFile&quot;, with that piece of code I believe, you are trying to search a module with the name &quot;ThisWorkbook&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3446, "user_id": 5520131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b1a21a95beb29e669c9174d20f025e1?s=128&d=identicon&r=PG&f=1", "display_name": "Innat3", "link": "https://stackoverflow.com/users/5520131/innat3"}, "edited": false, "score": 1, "creation_date": 1473257184, "post_id": 39371692, "comment_id": 66072123, "body": "@Innat3 every single Excel VBA project has a <code>ThisWorkbook</code> document module representing the host document, regardless of how much sense it makes."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1489074631, "post_id": 39371692, "comment_id": 72521310, "body": "The second part of the question is a Possible duplicate of <a href=\"http://stackoverflow.com/q/33485632/11683\">How to identify ThisWorkbook module using VBA</a>. The first part is correctly <a href=\"http://stackoverflow.com/a/39372165/11683\">answered below</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3446, "user_id": 5520131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b1a21a95beb29e669c9174d20f025e1?s=128&d=identicon&r=PG&f=1", "display_name": "Innat3", "link": "https://stackoverflow.com/users/5520131/innat3"}, "is_accepted": false, "score": -1, "last_activity_date": 1473257032, "creation_date": 1473257032, "answer_id": 39372061, "question_id": 39371692, "link": "https://stackoverflow.com/questions/39371692/c-excel-vba-make-module-names-not-depended-on-the-language/39372061#39372061", "title": "C# Excel VBA make module names not depended on the language", "body": "<p>Since you just added that module in your code, it should be on the last index position, thus it should be accesible by doing:</p>\n\n<pre><code>VBComponent ModuleIJustAdded = excelFile.VBProject.VBComponents.Item(excelFile.VBProject.VBComponents.Count - 1);\n</code></pre>\n\n<p>Since you are unsure about the module's name, I suggest you try to play around the index.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1473258066, "last_edit_date": 1473258066, "creation_date": 1473257294, "answer_id": 39372165, "question_id": 39371692, "link": "https://stackoverflow.com/questions/39371692/c-excel-vba-make-module-names-not-depended-on-the-language/39372165#39372165", "title": "C# Excel VBA make module names not depended on the language", "body": "<blockquote>\n<pre><code>excelFile.VBProject.VBComponents.Add(vbext_ComponentType.vbext_ct_StdModule);\n</code></pre>\n</blockquote>\n\n<p><code>VBComponents.Add</code> is a <strong>function</strong>, returning the object that was just added - but you're discarding that reference.</p>\n\n<p>All you need to do is to hold on to that reference:</p>\n\n<pre><code>var component = excelFile.VBProject.VBComponents.Add(vbext_ComponentType.vbext_ct_StdModule);\n</code></pre>\n\n<p>And then you can rename it at will (must be unique in the parent project though):</p>\n\n<pre><code>component.Name = \"RenameMe\";\n</code></pre>\n\n<p>...Or if you just need to know its name, it's right there for you to read:</p>\n\n<pre><code>Debug.WriteLine(component.Name);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473258888, "post_id": 39372549, "comment_id": 66073502, "body": "Oh, somehow I hadn&#39;t realized OP was also asking for a way to retrieve <code>ThisWorkbook</code>. Nice answer! =)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1473258947, "post_id": 39372549, "comment_id": 66073537, "body": "Is the property count 134 in all known versions of Excel?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1473259230, "post_id": 39372549, "comment_id": 66073752, "body": "@Mat&#39;sMug - Now that you mention it, I would actually doubt it.  It should be fixed per version though.  134 is the value in 2013 (worksheets have 66 BTW).  It would probably be best to grab all the <code>VBComponent</code> of type <code>vbext_ct_Document</code>, group by <code>Properties.Count</code>, and take the result with the highest property count.  For a new workbook, that should be a safe assumption."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473260612, "post_id": 39372549, "comment_id": 66074859, "body": "@WilliamCaman - Mat&#39;s Mug made a good point above - see the edit."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489074809, "post_id": 39372549, "comment_id": 72521451, "body": "The search is not reliable and is not needed. Given a <code>Workbook excelFile</code>, the <code>ThisWorkbook</code>&#39;s <code>VBComponent</code> is <code>excelFile.VBProject.VBComponents[excelFile.CodeName]</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1489075914, "post_id": 39372549, "comment_id": 72522283, "body": "@GSerg - In this specific case, sure. But the presence of a <code>CodeName</code> property on the <i>Excel</i> object doesn&#39;t make the search unreliable.  AFAIK examining the properties is the only way to determine whether the underlying document module is a Workbook or a Worksheet when given an arbitrary <code>VBComponent</code>.  If you have a better method, the RD devs would love to know it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489076256, "post_id": 39372549, "comment_id": 72522564, "body": "@Comintern I don&#39;t quite understand. Both <code>Workbook</code> and <code>Worksheet</code> have a <code>CodeName</code> and the lookup works for them just as well. On contrary, the Excel object (which is <code>Excel.Application</code> I assume?) does not have a <code>CodeName</code>, but it is not associated with a code module either."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489076458, "post_id": 39372549, "comment_id": 72522714, "body": "@GSerg see <a href=\"http://stackoverflow.com/q/37078992/1188513\">how do I know that &quot;ThisWorkbook&quot; is a &quot;Workbook&quot;?</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489076490, "post_id": 39372549, "comment_id": 72522738, "body": "@GSerg - How do you get the <code>Excel.Workbook</code> object from an arbitrary <code>VBComponent</code>?  Using the <code>CodeName</code> property only works if you have access to the Excel object.  That&#39;s why I say that using the <code>CodeName</code> works fine <i>in this case</i> - but it has the underlying assumption that you hold the reference to the Workbook or Worksheet."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489076663, "post_id": 39372549, "comment_id": 72522858, "body": "I will look into the reverse lookup, but I still don&#39;t understand why it&#39;s an issue to have to have a reference to Excel file. In the code in your answer, you have <code>excelFile</code> which is a <code>Workbook</code>, and you use it everywhere."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489077032, "post_id": 39372549, "comment_id": 72523141, "body": "@GSerg - It&#39;s <i>not</i> an issue if you have access to the <code>excelFile</code>.  That fact that the solution above gets the <code>VBComponents</code> collection from the Workbook is only coincidental to the OP&#39;s code.  The test as to whether the <code>VBComponent</code> is a Workbook is intentionally meant to be a more general solution."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489077137, "post_id": 39372549, "comment_id": 72523224, "body": "@GSerg we (Rubberduck devs) are in a slightly different situation - here the OP is using Excel interop; in the situation we&#39;re trying to address, we&#39;re <i>not</i> using Excel interop, because we can&#39;t assume what the host application is - and even if we <i>know</i> the host is Excel we&#39;re looking for a reliable, host-agnostic way of figuring out the runtime type of a document object module."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1489078292, "post_id": 39372549, "comment_id": 72524054, "body": "@Mat&#39;sMug Okay, I think understand better. Then again, maybe I do not - because if you can&#39;t make assumptions on existence and structure of the host application, the how can you look up anything? Your absolute best is getting to the <code>VBProject</code> that contains the module (which is <code>component.Collection.Parent</code>), anything beyond that <i>requires</i> knowing that there must be a &quot;Workbook&quot; that must have the VBProject as its property. And still, this means this answer is much more confusing and less reliable <i>for the OP</i> than <code>VBComponents[excelFile.CodeName]</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489079215, "post_id": 39372549, "comment_id": 72524693, "body": "@GSerg - I agreed that <i>for the OP</i>, using the Excel object directly was easier about an hour ago.  You keep coming back to the &quot;less reliable&quot; assertion though.  <code>VBComponent.Properties.Count</code> per module type can be considered a constant for any given version of Excel - it&#39;s defined in the TypeLibrary and isn&#39;t effected by user code. Is there an example where sorting by property count <i>wouldn&#39;t</i> be reliable?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489080014, "post_id": 39372549, "comment_id": 72525246, "body": "@Comintern I don&#39;t have an example, but I can&#39;t take the <code>For a new workbook, the ThisWorkbook module will be the one with the highest property count</code> for granted either. It just doesn&#39;t sound like it is based on something other than experiment. It may be true today, it might change with a next version. It sounds even less convincing when I try to apply it to a host-agnostic situation."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489080675, "post_id": 39372549, "comment_id": 72525672, "body": "@GSerg - By that logic you can&#39;t take for granted that the next version of Excel won&#39;t remove the <code>CodeName</code> property.  The property count <i>can&#39;t</i> contain anything outside of the TypeLib, because that&#39;s not really the way that COM works. Anything that isn&#39;t a declared property of the document class would have to be on an extended interface. One of the rules for a dispatch interface is &quot;The member and parameter DISPIDs must remain constant for the lifetime of the object.&quot; - it <b><i>has to</i></b> be bound to the defined interface in the TypeLib."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489081160, "post_id": 39372549, "comment_id": 72525941, "body": "@Comintern It&#39;s nothing like removing properties from an interface. <code>Properties</code> is a collection that can be filled with any number of elements. Apparently you are saying that the <code>Properties</code> collection is always filled in a way that mirrors the typelib-declared properties of the parent, and their count always matches. I did not know that, but if that is the case, still in the next Excel version a Worksheet may contain more properties than a Workbook - because a bunch of properties can be added to the sheet with none removed from the workbook."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489081333, "post_id": 39372549, "comment_id": 72526051, "body": "@GSerg - Right, and the next version of Excel could remove <code>CodeName</code>.  I think the likelihood of <i>either</i> of those things happening is approaching zero. ;-)"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1489089094, "post_id": 39372549, "comment_id": 72530571, "body": "If you only have the component reference, then <code>TypeOf vbcomp.Properties(&quot;Parent&quot;).Object Is Application</code> will tell you if it is a Workbook, but how do you distinguish between a Chart sheet and a Worksheet? The Property count, in my testing, is more reliable <i>and</i> faster."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1473260560, "last_edit_date": 1473260560, "creation_date": 1473258261, "answer_id": 39372549, "question_id": 39371692, "link": "https://stackoverflow.com/questions/39371692/c-excel-vba-make-module-names-not-depended-on-the-language/39372549#39372549", "title": "C# Excel VBA make module names not depended on the language", "body": "<p>The first one is easy - <code>VBComponents.Add</code> returns a <code>VBComponent</code>.  You can just inspect the <code>.Name</code> property:</p>\n\n<pre><code>var module = excelFile.VBProject.VBComponents.Add(vbext_ComponentType.vbext_ct_StdModule);\nDebug.WriteLine(module.Name);\n</code></pre>\n\n<p>The second one is a bit trickier.  You'll need to loop through all of the VBComponents and test for the 2 things that are unique to the Workbook object.  It will have a <code>.Type</code> of <code>vbext_ct_Document</code> and 134 properties in its <code>.Properties</code> collection by default:</p>\n\n<pre><code>VBComponent thisWorkbook;\nforeach (var module in excelFile.VBProject.VBComponents)\n{\n    var test = module as VBComponent;\n    if (test.Type == vbext_ComponentType.vbext_ct_Document &amp;&amp;\n        test.Properties.Count == 134)\n    {\n        thisWorkbook = test;\n        Debug.WriteLine(thisWorkbook.Name);\n        break;\n    }\n}\n</code></pre>\n\n<p><strong>EDIT:</strong>\nThe Linq solution looks like this, but it's possible that you could leave dangling Interop references this way.  If you want to try it, it can't hurt - but it would be the first place I'd look if Excel doesn't shut down properly:</p>\n\n<pre><code>var thisWorkbook =\n    (excelFile.VBProject.VBComponents).Cast&lt;VBComponent&gt;()\n        .First(x =&gt; x.Type == vbext_ComponentType.vbext_ct_Document &amp;&amp;\n                    x.Properties.Count == 134);\n</code></pre>\n\n<p><strong>EDIT2:</strong> As pointed out by @Mat'sMug in the comments, the property count is specific to the version - the value above is probably specific to Excel 2013. For a new workbook, the ThisWorkbook module will be the one with the highest property count. This should work on any version:</p>\n\n<pre><code>VBComponent thisWorkbook = null;\nforeach (var component in excelFile.VBProject.VBComponents.Cast&lt;VBComponent&gt;())\n{\n    if (thisWorkbook == null || component.Properties.Count &gt; thisWorkbook.Properties.Count)\n    {\n        thisWorkbook = component;\n    }\n}\nDebug.WriteLine(thisWorkbook.Name);\n</code></pre>\n\n<p>Linq:</p>\n\n<pre><code>var thisWorkbook =\n    excelFile.VBProject.VBComponents.Cast&lt;VBComponent&gt;()\n        .Aggregate((p, x) =&gt; (p.Properties.Count &gt; x.Properties.Count ? p : x));\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6805003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8963741750176ecb74b3b8b82bce7bbe?s=128&d=identicon&r=PG&f=1", "display_name": "William Caman", "link": "https://stackoverflow.com/users/6805003/william-caman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 39372549, "answer_count": 3, "score": 3, "last_activity_date": 1473260560, "creation_date": 1473256059, "question_id": 39371692, "link": "https://stackoverflow.com/questions/39371692/c-excel-vba-make-module-names-not-depended-on-the-language", "title": "C# Excel VBA make module names not depended on the language", "body": "<pre><code>excelFile.VBProject.VBComponents.Add(vbext_ComponentType.vbext_ct_StdModule);\n</code></pre>\n\n<p>This code in English version of Office creates module named: \"Module1\". But if office language is different \"Module1\" will be in another language. I need to know how this module is called in my code.</p>\n\n<pre><code>var standardModule = excelFile.VBProject.VBComponents.Item(\"ThisWorkbook\");    \n</code></pre>\n\n<p>The same problem is here in English version of Office \"ThisWorkbook\" exits, but in another language it will be called differently.</p>\n\n<p>It's possible to make this code language independent?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473257251, "post_id": 39371577, "comment_id": 66072162, "body": "If you just want to know if a cell&#39;s text is bold use <code>Cell().Font.Bold</code>."}, {"owner": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "edited": false, "score": 0, "creation_date": 1473257375, "post_id": 39371577, "comment_id": 66072257, "body": "Sorry I meant for the text to be bold for clarification on what I need help with not to see if the text is bold within the data itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473257403, "post_id": 39371577, "comment_id": 66072283, "body": "After you get it working you should post your code on <a href=\"http://codereview.stackexchange.com/\">Code Review</a>.  The experts there will analyze it and give you pointer on how to refine it."}, {"owner": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "edited": false, "score": 0, "creation_date": 1473257506, "post_id": 39371577, "comment_id": 66072360, "body": "Ok Thank you Thomas.  I will do that, the only problem with this code is to get it to work properly.  I have everything else in the code working except for the ID Code portion."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "edited": false, "score": 0, "creation_date": 1473258246, "post_id": 39372382, "comment_id": 66072938, "body": "Hi Kevin thank you for your comment.  Would I put that in place of  &quot; cell = something&quot;         like shown below:                          Sheets(&quot;CostOS&quot;).Range(&quot;D2:D&quot; &amp; x).Select     Set cell = InStr(1, [Range Value], &quot;-&quot;)     For Each cell In cell           If cell.Value = &quot; &quot; Then              cell.Offset(0, 3).Value = Range(&quot;D2:D&quot; &amp; x)           End If"}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "reply_to_user": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "edited": false, "score": 0, "creation_date": 1473261253, "post_id": 39372382, "comment_id": 66075320, "body": "Added to my answer how I&#39;d handle it. It&#39;d be better to normalize the data first and then go through more logic. I&#39;m assuming there will be changes from Code Review. Also, you could just use this in your code and use Call to run it first."}, {"owner": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "edited": false, "score": 0, "creation_date": 1473262364, "post_id": 39372382, "comment_id": 66076037, "body": "Hi Kevin   Is there a way to paste those values in a separate sheet and then call them through the unifier code?"}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "reply_to_user": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "edited": false, "score": 0, "creation_date": 1473266757, "post_id": 39372382, "comment_id": 66078623, "body": "Are you meaning get Column A for Description and Column B for Codes in say, Sheet2, and also skipping rows with the code? Yes. I&#39;d start with changing &quot;For Each rng In rngValues&quot; to &quot;For i=1 to rngValues.Rows.Count&quot;. You can then use i for the row number in sheet2. Doing it this way, codes will need to be counted so you can offset the row in sheet2."}], "tags": [], "owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473261900, "last_edit_date": 1473261900, "creation_date": 1473257850, "answer_id": 39372382, "question_id": 39371577, "link": "https://stackoverflow.com/questions/39371577/how-to-split-certain-rows-from-the-column-dynamiclly-in-vba/39372382#39372382", "title": "how to split certain rows from the column dynamiclly in VBA", "body": "<p>It looks like all ID Codes use hyphens. If none of the descriptions have them, you could use a test in InStr(). This function will return 0 if the hyphen does not exist (which would then be your description).</p>\n\n<pre><code>InStr(1, [Range Value], \"-\")\n</code></pre>\n\n<p>If this doesn't work, all the descriptions also seem to end with a period. A 2nd test could be:</p>\n\n<pre><code>If Right([Range Value], 1) = \".\" Then ...\n</code></pre>\n\n<p>EDIT: Adding how I'd use the test.</p>\n\n<p>I would use the test in somewhat like this:</p>\n\n<pre><code>Sub SplitCodesFromDescriptions()\n    Dim strCode As String\n    Dim rngValues, rng As Range\n\n    Set rngValues = Range(\"A1:A2500\")\n\n    For Each rng In rngValues\n\n        If rng.Value = \"\" Then Exit Sub\n\n        If InStr(1, rng.Value, \"-\") &gt; 0 Then\n            strCode = rng.Value\n        Else\n            rng.Offset(0, 1).Value = strCode\n        End If\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>*Note- I personally like defining the range. There can be issues where Excel thinks there is data in row 1 million.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1473258125, "creation_date": 1473258125, "answer_id": 39372487, "question_id": 39371577, "link": "https://stackoverflow.com/questions/39371577/how-to-split-certain-rows-from-the-column-dynamiclly-in-vba/39372487#39372487", "title": "how to split certain rows from the column dynamiclly in VBA", "body": "<h2>You can use the Like operator to test for a pattern</h2>\n\n<p><a href=\"https://i.stack.imgur.com/wu5cL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wu5cL.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TestLikePattern()\n    Dim x As Long\n\n    For x = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        If Cells(x, 1) Like \"*[A-Z][-]#*[.]#*\" Then Cells(x, 2) = True\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6654856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3ce16e6f3b445d99084779a373f9bc?s=128&d=identicon&r=PG&f=1", "display_name": "carp47", "link": "https://stackoverflow.com/users/6654856/carp47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 39372487, "answer_count": 2, "score": 1, "last_activity_date": 1473261900, "creation_date": 1473255816, "last_edit_date": 1531164843, "question_id": 39371577, "link": "https://stackoverflow.com/questions/39371577/how-to-split-certain-rows-from-the-column-dynamiclly-in-vba", "title": "how to split certain rows from the column dynamiclly in VBA", "body": "<p>I have a column with data that has a description and a ID code (bold Char) with it:</p>\n\n<p><strong>BBA-34.009876</strong> </p>\n\n<p>The harmful impact of the typical American diet. </p>\n\n<p>The number of Americans that recycle on a regular basis. </p>\n\n<p>The amount of time students use on social media.  </p>\n\n<p>The average college debt of undergraduate and graduate students. </p>\n\n<p>How many public schools have cut arts programs.  </p>\n\n<p>How often do high school athletes succeed in college programs. </p>\n\n<p>How healthy is the average public school lunch.  </p>\n\n<p>The number of low socioeconomic students that fail state standardized testing.</p>\n\n<p><strong>CCV-09.89765</strong> </p>\n\n<p>A beautiful summer morning in the woods.  </p>\n\n<p>A character from a movie, cartoon, or book.  </p>\n\n<p>The most frightening place on the planet.  </p>\n\n<p>A personality you would like to resemble.  </p>\n\n<p>The best place for a winter vacation.  </p>\n\n<p>A holiday celebration in a certain country.  </p>\n\n<p>The most interesting piece of art in the nearest museum.  </p>\n\n<p>Describe your favorite season.</p>\n\n<p><strong>FFG-890.786543</strong>  </p>\n\n<p>Your first day of school. </p>\n\n<p>Your favorite cuisine.  </p>\n\n<p>The experience of parachute jumping.  </p>\n\n<p>The memory of people you met when you were a child.  </p>\n\n<p>Your ideal study partner.  </p>\n\n<p>Environmental degradation caused by human activity.</p>\n\n<p><strong>R-34.896543</strong>  </p>\n\n<p>The worst d255 34 your life.  </p>\n\n<p>The best place to do homework.  </p>\n\n<p>The experience of learning a foreign language.  </p>\n\n<p>Choosing a college and a future career.  </p>\n\n<p>Your favorite camping spot. </p>\n\n<p>The data set above is an example and there could be 50-2000 description in between the ID codes.  My question is how do you just split the ID codes from the descriptions, which are in separate rows but in the same column, and paste just the ID codes in a separate column but within the same row?  This also has to be dynamic and not a static input. Also the ID codes do not have the same pattern every time.</p>\n\n<p>here is the VBA code that I have been working with and yes this is a Unifier style code within VBA.</p>\n\n<pre><code>Sub Unifier()\n    Dim cell As Range\n    Dim x As Integer\n    Dim x2 As Integer\n    Dim s As String\n    Dim e As String\n    Dim e2 As String\n    Dim e3 As String\n    Dim e4 As String\n    Dim e5 As String\n    Dim e6 As String\n    Dim e7 As String\n    Dim form As String\n\n\n\n\n\n    s = Sheets(\"CostOS\").Range(\"L2\").Value 'Pulls 0\n    x = Sheets(\"CostOS\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row 'Task Code Count\n    x2 = Sheets(\"CostOS\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row 'Item Code\n    x3 = Sheets(\"CostOS\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row 'Item Description Count\n    x4 = Sheets(\"CostOS\").Range(\"G\" &amp; Rows.Count).End(xlUp).Row 'UM Count\n    x5 = Sheets(\"CostOS\").Range(\"F\" &amp; Rows.Count).End(xlUp).Row 'Unit Rate Count\n    x6 = Sheets(\"CostOS\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row 'Quantity Count\n    x7 = Sheets(\"CostOS\").Range(\"H\" &amp; Rows.Count).End(xlUp).Row 'CBS Count\n    e = Sheets(\"CostOS\").Range(\"L2\").Value 'Approved by\n    e2 = Sheets(\"CostOS\").Range(\"L3\").Value 'Estimate Type\n    e3 = Sheets(\"CostOS\").Range(\"L4\").Value 'Estimate Number\n    e4 = Sheets(\"CostOS\").Range(\"L5\").Value 'Estimator\n    e5 = Sheets(\"CostOS\").Range(\"L6\").Value 'Approval Date\n    e6 = Sheets(\"CostOS\").Range(\"L7\").Value 'Project Number\n    e7 = Sheets(\"CostOS\").Range(\"L8\").Value 'Effective Date\n    e8 = Sheets(\"CostOS\").Range(\"V4\").Value 'Task Code Prefix\n\n    **'ID Code\n    Sheets(\"CostOS\").Range(\"D2:D\" &amp; x).Select\n    Set cell = Sheets(\"CostOS\").Range(\"A2:A\" &amp; x)\n    For Each cell In cell\n          If cell.Value = \" \" Then\n             cell.Offset(0, 3).Value = Range(\"D2:D\" &amp; x)\n          End If      \n    Next**\n    'Task Code, Prefix &amp; H or D logic\n    Sheets(\"CostOS\").Range(\"A2:A\" &amp; x).Copy\n    Sheets(\"EST template\").Range(\"C3\").PasteSpecial xlPasteValues\n    'H or D\n    For Each cell In Sheets(\"EST template\").Range(\"C3:C\" &amp; x)\n        If cell.Value = \"\" Then\n            cell.Offset(0, -2).Value = \"H\"\n        Else\n            cell.Offset(0, -2).Value = \"D\"\n        End If\n    Next\n    Sheets(\"CostOS\").Range(\"M3\").Select 'Filldown Task Prefix\n    Selection.AutoFill Destination:=Range(\"M3:M\" &amp; x7), Type:=xlFillDefault\n    For Each cell In Sheets(\"EST template\").Range(\"M3:Q\" &amp; x7)\n    Next\n    Sheets(\"CostOS\").Range(\"N2\").Select 'Filldown Milepost Prefix\n    Selection.AutoFill Destination:=Range(\"N2:N\" &amp; x7), Type:=xlFillDefault\n    For Each cell In Sheets(\"EST template\").Range(\"N2:Q\" &amp; x7)\n    Next\n    Sheets(\"CostOS\").Range(\"O2\").Select 'Filldown Milepost Number\n    Selection.AutoFill Destination:=Range(\"O2:O\" &amp; x7), Type:=xlFillDefault\n    For Each cell In Sheets(\"EST template\").Range(\"O2:O\" &amp; x7)\n    Next\n    'CBS &amp; Approval Date\n    Sheets(\"CostOS\").Range(\"Q3\").Select 'Removes end of CBS code\n    Selection.AutoFill Destination:=Range(\"Q3:Q\" &amp; x7), Type:=xlFillDefault\n    Sheets(\"CostOS\").Range(\"T3\").Select 'Fills down the vlookup\n    Selection.AutoFill Destination:=Range(\"T3:T\" &amp; x7), Type:=xlFillDefault\n    Sheets(\"CostOS\").Range(\"T2:T\" &amp; x).Copy\n    Sheets(\"EST template\").Range(\"N3\").PasteSpecial xlPasteValues\n    For Each cell In Sheets(\"EST template\").Range(\"N3:N\" &amp; x)\n        If cell.Text = \"\" Then\n            cell.Value = e5\n        End If    \n    Next\n    'Item Code\n    Sheets(\"CostOS\").Range(\"C2:C\" &amp; x).Copy\n    Sheets(\"EST template\").Range(\"G3\").PasteSpecial xlPasteValues\n    For Each cell In Sheets(\"EST template\").Range(\"G3:G\" &amp; x2)\n\n    Next\n     'Estimate number\n    Set cell = Sheets(\"EST template\").Range(\"A3:A\" &amp; x)\n    For Each cell In cell\n        If cell.Value &lt;&gt; \"D\" Then\n             cell.Offset(0, 6).Value = e3\n        End If\n    Next\n    'Effective Date\n    Set cell = Sheets(\"EST template\").Range(\"A3:A\" &amp; x)\n    For Each cell In cell\n        If cell.Value &lt;&gt; \"D\" Then\n            cell.Offset(0, 8).Value = e7\n        End If\n    Next\n    'Task Code Prefix\n    Set cell = Sheets(\"EST template\").Range(\"A3:A\" &amp; x)\n    For Each cell In cell\n        If cell.Value &lt;&gt; \"D\" Then\n            cell.Offset(0, 9).Value = e8\n        End If\n    Next\n    'Quantity &amp; Estimator\n    Sheets(\"CostOS\").Range(\"E2:E\" &amp; x).Copy\n    Sheets(\"EST template\").Range(\"K3\").PasteSpecial xlPasteValues\n    For Each cell In Sheets(\"EST template\").Range(\"K3:K\" &amp; x6)\n        If cell.Value = \"\" Then\n            cell.Value = e4\n        End If\n    Next\n    'Unit of Measure &amp; Approved by\n    Sheets(\"CostOS\").Range(\"G2:G\" &amp; x4).Copy\n    Sheets(\"EST template\").Range(\"M3\").PasteSpecial xlPasteValues\n    For Each cell In Sheets(\"EST template\").Range(\"M3:M\" &amp; x4)\n        If cell.Value = \"\" Then\n            cell.Value = e\n        End If\n    Next\n    'Unit Cost &amp; Estimate Type\n    Sheets(\"CostOS\").Range(\"F2:F\" &amp; x5).Copy\n    Sheets(\"EST template\").Range(\"L3\").PasteSpecial xlPasteValues\n    For Each cell In Sheets(\"EST template\").Range(\"L3:L\" &amp; x5)\n        If cell.Value = \"\" Then\n            cell.Value = e2\n        End If\n    Next\n    'Project Code\n    For Each cell In Sheets(\"EST template\").Range(\"C3:C\" &amp; x)\n        If cell.Value = \"\" Then\n            cell.Offset(0, -1).Value = e6\n        Else\n            cell.Offset(0, -1).Value = \"Estimate Details\"\n        End If\n    Next\n    'Source\n    For Each cell In Sheets(\"EST template\").Range(\"C3:C\" &amp; x)\n        If cell.Value = \"\" Then\n            cell.Offset(0, 2).Value = \"RailDOCS\"\n        Else\n            cell.Offset(0, 2).Value = \"\"\n        End If\n    Next\n    'Item Description\n    Sheets(\"CostOS\").Range(\"D3:D\" &amp; x3).Copy\n    Sheets(\"EST template\").Range(\"I4\").PasteSpecial xlPasteValues\n    For Each cell In Sheets(\"EST template\").Range(\"I4:I\" &amp; x3)\n\n    Next\n    'Short Description &amp; Task Prefix\n    Sheets(\"Est template\").Select\n    Sheets(\"Est template\").Range(\"J4\").Select\n    With ActiveCell\n        .Formula = \"=LEFT(I4,50)\"\n    End With\n    Selection.AutoFill Destination:=Range(\"J4:J\" &amp; x3), Type:=xlFillDefault\n    For Each cell In Sheets(\"EST template\").Range(\"J4:J\" &amp; x3)\n    Next\n    CutCopyMode = False\n    End Sub\n</code></pre>\n\n<p>The bold portion is what I am haveing trouble with and everything else is working.</p>\n"}, {"tags": ["excel", "vba", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473258056, "post_id": 39371796, "comment_id": 66072771, "body": "I&#39;d use <code>ActiveSheet</code> to make it more <i>general</i>, should OP change worksheet name. And <code>Date</code> instead of <code>Now</code> to be more adherent to its example"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473258265, "post_id": 39371796, "comment_id": 66072956, "body": "@user3598756 The OP actually want date-time <code>&quot;the date (and time)&quot;</code>.  ActiveSheet make a lot of since. I&#39;ll update my answer now.  Thanks!!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473258426, "post_id": 39371796, "comment_id": 66073104, "body": "&quot;date-time&quot;: you&#39;re right. I only looked at the screenshot"}, {"owner": {"reputation": 253, "user_id": 4515407, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Roycj.jpg?s=128&g=1", "display_name": "Noobs DeSroobs", "link": "https://stackoverflow.com/users/4515407/noobs-desroobs"}, "edited": false, "score": 0, "creation_date": 1473266554, "post_id": 39371796, "comment_id": 66078514, "body": "Thank you for the reply. I didnt know you could use <code>Application.Caller</code> for this. However, there is a slight problem. <a href=\"http://puu.sh/r37FJ/e8b4816da8.png\" rel=\"nofollow noreferrer\">puu.sh/r37FJ/e8b4816da8.png</a> I have macros enabled, but the macro does not run. I tried putting it in the sheet and in the workbook objects to no avail."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473276918, "post_id": 39371796, "comment_id": 66083471, "body": "Is <code>myCombo_Change</code> in a public module?  I was kind of curious why you are adding combo boxes everytime the workbook is opened?"}, {"owner": {"reputation": 253, "user_id": 4515407, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Roycj.jpg?s=128&g=1", "display_name": "Noobs DeSroobs", "link": "https://stackoverflow.com/users/4515407/noobs-desroobs"}, "edited": false, "score": 0, "creation_date": 1473329992, "post_id": 39371796, "comment_id": 66103026, "body": "@ThomasInzina The excel file I have have a LOT of drop down menus all over the place and I was told, with no experience with VBA or excels systems, to make it so that for each ListBox that was already in the document every time someone changed their selection it would update the value next to it. What I wrote down was just my initial attempt. If you have something better, please do tell. I really dont want to change n ListBoxes using code just to keep track of them, but I see no other option."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473330893, "post_id": 39371796, "comment_id": 66103626, "body": "The problem is that every time you open the workbook you are stacking new dropdowns on top of each other.  I updated my answer with macros that will help you fix the workbook.  You need to move <code>Workbook_Open</code> to a normal module and call it just once after you remove the listboxes on Sheet1."}, {"owner": {"reputation": 253, "user_id": 4515407, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Roycj.jpg?s=128&g=1", "display_name": "Noobs DeSroobs", "link": "https://stackoverflow.com/users/4515407/noobs-desroobs"}, "edited": false, "score": 0, "creation_date": 1473331246, "post_id": 39371796, "comment_id": 66103823, "body": "You can loop through all items without having their names I see! Thanks. This is a major help. Sometimes I wish people would stop assuming you can program in any language and framework just because we are programmers. ^^ Thank you so much for all your help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473331613, "post_id": 39371796, "comment_id": 66104065, "body": "Sometimes I wish that I would stop assuming that I can program in any language or on any framework!...lol"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1473330621, "last_edit_date": 1473330621, "creation_date": 1473256307, "answer_id": 39371796, "question_id": 39370860, "link": "https://stackoverflow.com/questions/39370860/creating-a-list-of-comboboxes-using-vba-that-update-the-values-of-cells-specifie/39371796#39371796", "title": "Creating a list of ComboBoxes using VBA that update the values of cells specified in the code", "body": "<p>Use <code>Application.Caller</code> to get the name of the control that called the myCombo_Change event.</p>\n\n<pre><code>Sub myCombo_Change()\n\n    Dim curCombo As Shape\n    Set curCombo = ActiveSheet.Shapes(Application.Caller)\n    curCombo.TopLeftCell.Offset(0, -1) = Now\n\nEnd Sub\n</code></pre>\n\n<h2>Assign the myCombo_Change to all existing DropDown:</h2>\n\n<pre><code>Sub AssignMacroToAllListBoxes()\n    Dim sh As Shape\n    Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        For Each sh In ws.Shapes\n            If TypeName(sh.OLEFormat.Object) = \"DropDown\" Then\n                sh.OLEFormat.Object.OnAction = \"myCombo_Change\"\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<h2>Delete all DropDowns on Sheet1</h2>\n\n<pre><code>Sub DeleteAllDropDownsOnSheet()\n    For Each sh In Sheet1.Shapes\n        If TypeName(sh.OLEFormat.Object) = \"DropDown\" Then\n            sh.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 4515407, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Roycj.jpg?s=128&g=1", "display_name": "Noobs DeSroobs", "link": "https://stackoverflow.com/users/4515407/noobs-desroobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 39371796, "answer_count": 1, "score": 1, "last_activity_date": 1473330621, "creation_date": 1473253890, "last_edit_date": 1473254511, "question_id": 39370860, "link": "https://stackoverflow.com/questions/39370860/creating-a-list-of-comboboxes-using-vba-that-update-the-values-of-cells-specifie", "title": "Creating a list of ComboBoxes using VBA that update the values of cells specified in the code", "body": "<p>What I am trying to do is to create a program that adds combo boxes with some options. These options should then, depending on the option selected, change some values in some cells that I specify in code.</p>\n\n<p>This is how I make the combo lists:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nWith Worksheets(\"Sheet1\").Columns(\"E\")\n .ColumnWidth = 25\nEnd With\n\nFor i = 1 To 6\n    Set curCombo = Sheet1.Shapes.AddFormControl(xlDropDown, Left:=Cells(i, 5).Left, Top:=Cells(i, 5).Top, Width:=100, Height:=15)\n    With curCombo\n        .ControlFormat.DropDownLines = 3\n        .ControlFormat.AddItem \"Completed\", 1\n        .ControlFormat.AddItem \"In Progress\", 2\n        .ControlFormat.AddItem \"To be done\", 3\n        .Name = \"myCombo\" &amp; CStr(i)\n        .OnAction = \"myCombo_Change\"\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I want each of the dropdown values trigger the event <code>myCombo_Change</code> and then simply change the cell \"D\" For example, combo box 3 is located at E3 and I want the \"To be done\" to clear the cell D3 and the completed to simply store the date (and time) to the cell D3. This should be done for all combo boxes in the E Column. </p>\n\n<pre><code>Private Sub myCombo_Change(index As Integer)\n\nMe.Range(\"D\" &amp; CStr(index)) = Me.myCombo.Value\n\nEnd Sub\n</code></pre>\n\n<p>This is the code I started thinking about, but I have no idea how to call the event with an integer as the index parameter NOR how to access the cell using said index. </p>\n\n<p>The effect I want is something along the lines of this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dgEyA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dgEyA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["postgresql", "ms-access", "vba", "odbc"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473367030, "post_id": 39370607, "comment_id": 66125596, "body": "Why don&#39;t you edit your question and update your code to what it is now? I imagine it&#39;s nothing like what you&#39;r showing above"}, {"owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473422603, "post_id": 39370607, "comment_id": 66146476, "body": "Thanks! Now it&#39;s working fine. Finally to populate the id_muni field I made another query on change like this"}, {"owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473422712, "post_id": 39370607, "comment_id": 66146543, "body": "<code>If oRs.recordCount&gt;0 Then    Me.txtTextbox=oRs!gid Else    Me.txtTextbox=&quot;N&#47;A&quot; End If  Set oRs=Nothing Set oDb=Nothing     End Sub</code> from @Fiounnala"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "edited": false, "score": 0, "creation_date": 1473282788, "post_id": 39379070, "comment_id": 66086124, "body": "And sorry for not formatting blocks of codes,  I&#39;m on my cellphone! I&#39;ll edit later when ill be home"}, {"owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "edited": false, "score": 0, "creation_date": 1473321219, "post_id": 39379070, "comment_id": 66097811, "body": "Thanks for the answer, but it&#39;s not working. The oDb.Openrecordset(sql) tries to open a Database in my local machine, it says &quot;Error, cannot find database C:\\Users\\Documents\\memoria.mdb&quot;. I don&#39;t understand why, because dbconnect is calling the ODBC driver DSN. Any suggestion? Thanks in advance"}, {"owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "edited": false, "score": 0, "creation_date": 1473322398, "post_id": 39379070, "comment_id": 66098458, "body": "I tried using the dbSnapshot in recordset Type and dbSQLPassThrough in the Options, and now I don&#39;t have this error now, but the filter is not working. I&#39;m completely lost :-("}, {"owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "edited": false, "score": 0, "creation_date": 1473417189, "post_id": 39379070, "comment_id": 66143433, "body": "Hi @Thapipo I have achieved a solution thanks to your code. I need now to clear the combobox, do you have any hint? I tried combobox.Clear(); combobox.SelectedIndex = -1, and other, but it&#39;s not working. Thanks!"}], "tags": [], "owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "is_accepted": true, "score": 0, "last_activity_date": 1473284960, "last_edit_date": 1473284960, "creation_date": 1473282711, "answer_id": 39379070, "question_id": 39370607, "link": "https://stackoverflow.com/questions/39370607/populate-combobox-access-2007-using-vba-with-postgresql-table/39379070#39379070", "title": "Populate combobox access 2007 using vba with postgresql table", "body": "<p>You can you DAO library. </p>\n\n<p>You could you DAO. Database and DAO. Recordset like:</p>\n\n<pre><code>Dim oDb as DAO.Database\nDim oRs as DAO.Recordset\n</code></pre>\n\n<p>Your second block of codes could do the work. </p>\n\n<pre><code>Set oDb = OpenDatabase(\"\", False, False, dbconnect)\nDim sql As String\nsql = \"select m.nombre  from memoria.muni \nm,memoria.prov p where st_within(m.the_geom,p.the_geom) and p.gid =\" &amp; PROV \";\"\n\nSet oRs = oDb.Openrecordset(sql) \n\nIf oRs.Recordcount &gt; 1 Theb\nWith oRs\n.Movelast\n.Movefirst\n\nDo while not.EOF\n                    PROV.Additem . Fields(\"nameOfFieldsYouNeed\"). Value\n                    .Movenext\nLoop\nEnd With\n\nEnd if\n</code></pre>\n\n<p>And it's would be a good idea to clear the combox box before adding new items in it. </p>\n"}], "owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 39379070, "answer_count": 1, "score": 0, "last_activity_date": 1594651348, "creation_date": 1473253144, "last_edit_date": 1594651348, "question_id": 39370607, "link": "https://stackoverflow.com/questions/39370607/populate-combobox-access-2007-using-vba-with-postgresql-table", "title": "Populate combobox access 2007 using vba with postgresql table", "body": "<p>I'm trying to populate a combobox with records from a table filtered by a parent combobox.\nThe table I want to filter is called muni and parent table is called prov. They are related by a common field (muni has a field called gid_prov that contains prov gid for each record)\nFirst combobox stores the prov gid and shows the prov name.\nBoth tables are in a database from postgresql connected to access by an DSN file using ODBC.\nI have tried many options, and none is correct.\nFirst I tried a simple option. This code is useless now</p>\n\n<pre><code>Private Sub PROV_Change()\n   MUNI.RowSourceType = \"Table/Query\"\n   MUNI.RowSource = \"select *  from memoria.muni  where gid_provs =\" &amp; PROV\n   MUNI.Requery\n   MUNI.SetFocus\n   MUNI.Text = \"\"\n\n   End Sub\n</code></pre>\n\n<p>PROV is the name of the parent combobox that stores the prov gid. And MUNI the combobox I want to populate.\nOther option I tried was creating a query with an sql statement, this is the code right now, i tried with the OpenRecordsetOutput, but is not working. I can access the database and get the fields, but I can't populate the combobox MUNI</p>\n\n<pre><code>     Private Sub PROV_Change()\n    Dim oDb As DAO.Database\n    Dim oRs As DAO.Recordset\n    dbconnect = \"ODBC;DRIVER=PostgreSQL ANSI;UID=***;PWD=***;PORT=5432;SERVER=127...;DATABASE=memoria_historica;DSN=C:\\Users\\***\"\n    Set oDb = OpenDatabase(\"\", False, False, dbconnect)\nDim sql As String\nsql = \"select gid,nombre  from memoria.municipios m where m.gid_provs =\" &amp; PROV &amp; \"order by m.nombre;\"\nSet oRs = oDb.OpenRecordset(sql, dbOpenSnapshot, dbSQLPassThrough)\nMe.muni2.RowSource = \"\"\nIf oRs.RecordCount &gt; 0 Then\nWith oRs\n.MoveFirst\n.MoveNext\n\nDo While Not .EOF\n                    muni2.AddItem .Fields(\"nombre\").Value\n\n                    .MoveNext\nLoop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Worked fine tih the support of @Thaippo. Thanks</p>\n"}, {"tags": ["excel", "vba", "select", "runtime-error"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1473252635, "post_id": 39370343, "comment_id": 66068748, "body": "just a hint - Excel has something called instances (if you are using Excel 2007 onwards). I suppose that in your case you have opened two incstances of excel. To fix it, close all excel files and then open the file with the code and the one with XXX just by clicking the mouse button."}, {"owner": {"reputation": 176, "user_id": 6566211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce40841f1a55640d22261334c077d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6566211/jason"}, "edited": false, "score": 2, "creation_date": 1473253198, "post_id": 39370343, "comment_id": 66069233, "body": "This error is likely happening because, while you are activating the workbook, you also need to activate your worksheet before you can use the .select method on that sheet.  So: <code>worksheets(&quot;XXX&quot;).activate</code>   I know you said this already, but remember there are almost always better ways than to use a select statement."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473253426, "post_id": 39370343, "comment_id": 66069404, "body": "You can&#39;t select something on anything other than the active sheet.  Best practice would be to refactor the code so that it doesn&#39;t <b><i>use</i></b> the <code>Active*</code> or global objects.  Get references to your objects and use those instead."}, {"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1473255136, "post_id": 39370343, "comment_id": 66070610, "body": "Guys, just to understand you right - you are saying that .Select method can only be used to objects being previously activated? So, in my case the problem is after adding new sheet &quot;XXX_F&quot; (which by delault activates it) I tried to select Range on &quot;XXX&quot; sheet (by explicitly referring to it)? So, if I omit explicit reference my code will just select Range(&quot;A1:C1&quot;) on &quot;XXX_F&quot; sheet? And if I left explicit reference, but instead of .Select method will use .Copy - code will be working as it supposed to?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473255325, "post_id": 39370343, "comment_id": 66070734, "body": "In a word, yes.  <code>.Copy</code> doesn&#39;t require a range to be selected."}, {"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1473259105, "post_id": 39370343, "comment_id": 66073663, "body": "Thanks a lot for all of you who helped me."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1473259068, "post_id": 39371768, "comment_id": 66073638, "body": "Thanks a lot for help!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1473260913, "last_edit_date": 1495535627, "creation_date": 1473256230, "answer_id": 39371768, "question_id": 39370343, "link": "https://stackoverflow.com/questions/39370343/vba-select-method-failed/39371768#39371768", "title": "VBA - Select method failed", "body": "<p>The comments on the question have sufficiently described the nature of the <code>1004</code> error, and you seem to have a good enough understanding of that.</p>\n\n<p>See this great discussion for more detail:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n\n<p>Here is your code refactored to avoid <code>Select</code> method. </p>\n\n<pre><code>Dim wb as Workbook\nDim ws as Worksheet\nDim newWS as Worksheet\nDim rngCopy as Range\n\nSet wb = Workbooks(\"XXX.xls\")\nSet ws = wb.Worksheets(\"XXX\")\n\nWith ws\n    ' Setting column width\n    .Cells.ColumnWidth = 10\n\n    ' Filtering XXX funds\n    .Rows(1).AutoFilter Field:=3, Criteria1:=\"=*XXX*\"\n\n    Set rngCopy = .Range(.Range(\"A1:C1\"), .Range(\"A1:C1\").End(xlDown))\nEnd With\n\n' Add new sheet and rename it\nWith wb\n    Set newWS = .Sheets.Add(After:=.Worksheets(.Worksheets.Count))\nEnd With\nnewWS.Name = \"XXX_F\"\n\n' Paste data in to the new worksheet\nrngCopy Destination:=newWS.Cells(1,1)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 0, "accepted_answer_id": 39371768, "answer_count": 1, "score": 1, "last_activity_date": 1473260913, "creation_date": 1473252374, "last_edit_date": 1473254669, "question_id": 39370343, "link": "https://stackoverflow.com/questions/39370343/vba-select-method-failed", "title": "VBA - Select method failed", "body": "<p>I am a pretty new to VBA, so sorry if problem is obvious for more experienced users. I tried to read couple of answers to similar question, and fix the problem but still facing the same problem.</p>\n\n<p>My code is: </p>\n\n<pre><code>Workbooks(\"XXX.xls\").Activate\n\n' Setting column width\nWorkbooks(\"XXX.xls\").Worksheets(\"XXX\").Cells.Select\nSelection.ColumnWidth = 10\n\n' Filtering XXX funds\nWorkbooks(\"XXX.xls\").Worksheets(\"XXX\").Rows(\"1:1\").Select\nSelection.AutoFilter Field:=3, Criteria1:=\"=*XXX*\"\n\n' Add new sheet and rename it\nSheets.Add After:=Worksheets(Worksheets.Count)\nActiveSheet.Name = \"XXX_F\"\n\n'Copying needed information\nWorkbooks(\"XXX.xls\").Worksheets(\"XXX\").Range(\"A1:C1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n</code></pre>\n\n<p>The error I am getting is <em>\"Run Time Error '1004': Select method of Range Class failed\"</em> on the third line from the bottom. I tried to fix it by adding this line (i.e. activating workbook I want to work with first):</p>\n\n<pre><code>Workbooks(\"XXX.xls\").Activate\n</code></pre>\n\n<p>Also I used explicit references in my code, like:</p>\n\n<pre><code>Workbooks(\"XXX.xls\").Worksheets(\"XXX\").Range(\"A1:C1\").Select\n</code></pre>\n\n<p>I understand that it is better not to use .Select method in my code at all. But it is not the first time I am getting this error, and I just want to understand VBA's logic. As I understand Excel just do not understand to which sheet I am referring, but I do not understand why - as I have activated the workbook I need (I have a couple of workbooks opened) and using explicit references. If you could please explain in detail why this error occurs (i.e in which point in time Excel confuses), I will be very grateful!</p>\n\n<p>Thanks to everyone for help in advance!</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473252641, "post_id": 39370277, "comment_id": 66068752, "body": "Perhaps you can just do a <code>Replace</code>. Find the <code>.</code> and replace with <code>&#47;</code>."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1473252776, "post_id": 39370277, "comment_id": 66068882, "body": "If you format the cells as &#39;Custom&#39; and set the custom format as &#39;dd.mm.yyyy&#39;, Excel will then recognize the values in the cells as date"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473254406, "post_id": 39370277, "comment_id": 66070109, "body": "@Zac no way. Not working"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1473256272, "post_id": 39370277, "comment_id": 66071426, "body": "Are the days and month s always on 2 char (01..11), or variable  (1..11)?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473257664, "post_id": 39370277, "comment_id": 66072479, "body": "Sorry, that is my bad. I tried date in the cell with &#39;/&#39; and it worked but if its with &#39;.&#39; it doesn&#39;t work. Please scrap my comment"}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1473314785, "post_id": 39370277, "comment_id": 66094378, "body": "@iDevelop they are always on 2 chars."}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1473314830, "post_id": 39370277, "comment_id": 66094394, "body": "user @BrakNicku provided the most convinient solution, I encourage users to have a look a it!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473253728, "post_id": 39370582, "comment_id": 66069622, "body": "The OP had an empty string check in his code but good work +1."}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1473253029, "creation_date": 1473253029, "answer_id": 39370582, "question_id": 39370277, "link": "https://stackoverflow.com/questions/39370277/optimizing-a-date-conversion-loop/39370582#39370582", "title": "Optimizing a date conversion loop", "body": "<p>\"I have tried adding the entire range with the dates into an Array and looking through that\"...</p>\n\n<p>Yes, that is the way to go. Reading and writing to cells on the sheet one at a time is what is taking a lot of time.</p>\n\n<pre><code>Dim vData as Variant\nDim vDates() as Date\nReDim vDates(1 to n, 1 to 1) as Date\nDim i as Long\n\nvData = ThisWorkbook.Sheets(\"Spread\").Range(\"E7\").Resize(n,1).Value\n\nFor i = 1 to n\n    vDates(i,1) = DateSerial(Split(vData(i,1),\".\")(2),vData(i,1),\".\")(1),vData(i,1),\".\")(0))\nNext\n\nThisWorkbook.Sheets(\"Spread\").Range(\"E7\").Resize(n,1).Value = vDates\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1473258023, "post_id": 39371934, "comment_id": 66072740, "body": "simplest and fastest"}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1473314736, "post_id": 39371934, "comment_id": 66094357, "body": "Super simple solution, works quick and does the job - thank you, I will use it many time over in the future!"}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1473256673, "creation_date": 1473256673, "answer_id": 39371934, "question_id": 39370277, "link": "https://stackoverflow.com/questions/39370277/optimizing-a-date-conversion-loop/39371934#39371934", "title": "Optimizing a date conversion loop", "body": "<p>You can use Text To Columns functionality with DMY column format. </p>\n\n<pre><code>ThisWorkbook.Sheets(\"Spread\").Range(\"E7:E\" &amp; 7 + n).TextToColumns _\n                                DataType:=xlDelimited, FieldInfo:=Array(1, xlDMYFormat)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 39371934, "answer_count": 2, "score": 0, "last_activity_date": 1473258290, "creation_date": 1473252166, "question_id": 39370277, "link": "https://stackoverflow.com/questions/39370277/optimizing-a-date-conversion-loop", "title": "Optimizing a date conversion loop", "body": "<p>I have a set of data (n), about 1500 items long filled with dates in DD.MM.YYYY format that excel does not regognize.  My goal is to change them to something that excel can work with, this is how I do it.</p>\n\n<pre><code>Function date_to_excel()\nCall public_dims\n\nDim date_i As String\ndate_array = ThisWorkbook.Sheets(\"Spread\").Range(Cells(7, 5), Cells(7 + n, 5))\n\nFor i = 0 To n\ndate_i = ThisWorkbook.Sheets(\"Spread\").Cells(7 + i, 5)\n    If date_i &lt;&gt; \"\" Then\n    date_array = Split(date_i, \".\")\n    date_i = date_array(1) &amp; \"/\" &amp; date_array(0) &amp; \"/\" &amp; date_array(2)\n    ThisWorkbook.Sheets(\"Spread\").Cells(7 + i, 5) = date_i\n    End If\nNext\n\nEnd Function\n</code></pre>\n\n<p>The function works allright, but it just takes a really long time.  <strong>What I am askingfrom the community is for ideas on how to optimize this loop.</strong>  I have tried adding the entire range with the dates into an Array and looking through that, but it doesn't seem compatible with my method of changing the date format (the date_i = line near the end).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473250153, "post_id": 39369439, "comment_id": 66066970, "body": "to find your last row, I&#39;d reccommend something like <code>lastrow = Worksheets(&quot;Sheet1&quot;).Cells(Worksheets(&quot;Sheet1&quot;).Rows.Count, &quot;H&quot;).End(xlUp).Row</code>. Also, your IF statements should be like <code>If</code> this <code>Then</code> that <code>ElseIf</code> this <code>Then</code> that <code>Else</code> that <code>End If</code>"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1473250560, "post_id": 39369439, "comment_id": 66067264, "body": "To hide the Form after pressing the button, you have to add <code>Me.Hide</code> at the end of your code"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473250653, "post_id": 39369439, "comment_id": 66067332, "body": "After I indent your code maybe it&#39;s more clearer why . if the first <code>If</code> is false, then you don&#39;t enter all other <code>If</code>s..."}, {"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473250680, "post_id": 39369439, "comment_id": 66067344, "body": "@Tyeler Thanks! I changed the code based on your suggestions and now it seems like it accepts all options as an answer! But it also override my <code>H1</code> with the option and dont autofill. Also the Input-mask does not disappear after I click the Ok-Button"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1473251648, "post_id": 39369894, "comment_id": 66068038, "body": "Thank you very much! That really helps alot! Actually didn&#39;t know about the &quot;ElseIf&quot;-Option.. I copied your code into mine and I&#39;ve still got the problem, that the code overwrites my H1 and dont autill automatically. Edit: I changed <code>ws.Cells(ws.Rows.Count, &quot;H&quot;).End(xlUp).Row</code> into <code>ws.Cells(ws.Rows.Count, &quot;H&quot;).End(xl**Down**).Row</code>. Now he don&#39;t overwrite my H1 but the lastrow he choses is in cell 104mil."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1473252027, "post_id": 39369894, "comment_id": 66068323, "body": "I copy-pasta&#39;d the code and ran it.. it works perfectly. Are you sure there aren&#39;t any differences in your&#39;s and this one?"}, {"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1473252411, "post_id": 39369894, "comment_id": 66068596, "body": "I&#39;m very sure! But this still helps me alot to achieve my work. Thank you very much!"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 1, "creation_date": 1473252457, "post_id": 39369894, "comment_id": 66068631, "body": "I wish I knew why it wasn&#39;t working the same for you as it is for me.. If you get stuck let me know and I&#39;ll help."}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 0, "last_activity_date": 1473251456, "last_edit_date": 1473251456, "creation_date": 1473251017, "answer_id": 39369894, "question_id": 39369439, "link": "https://stackoverflow.com/questions/39369439/fill-a-column-with-userform/39369894#39369894", "title": "Fill a column with UserForm", "body": "<p>Give this a shot.. The biggest difference here is how the <code>If statement</code> is written. Your original code had <code>If statements</code> nested in each other, which is fine, but will not work for what you're trying to achieve. The statement I have written is <strong>1</strong> <code>If statement</code>. Another way you can do this is by <code>Select Case</code> statements. I'm keeping the code as similar to your original for ease of learning.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n' OK Button\nDim emptyRow As Range, ws As Worksheet\nDim lastrow As Long\n\nSet ws = ThisWorkbook.Sheets(1)\nlastrow = ws.Cells(ws.Rows.Count, \"H\").End(xlUp).Row 'A more flexible way to find last row\nSet emptyRow = ws.Range(\"H2:H\" &amp; lastrow)\n\nIf OptionButton2.value = True Then\n     emptyRow.value = \"2\"\nElseIf OptionButton3.value = True Then\n     emptyRow.value = \"3\"\nElseIf OptionButton4.value = True Then\n     emptyRow.value = \"4\"\nElseIf OptionButton5.value = True Then\n     emptyRow.value = \"5\"\nElse: MsgBox \"No option was chosen.\", vbOKOnly, \"No Option Chosen\" 'Catches no button selected\nEnd If\n\nMe.Hide 'This hides the userform. Another method is Unload Me which drops the cache as well\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 39369894, "answer_count": 1, "score": 0, "last_activity_date": 1473251456, "creation_date": 1473249748, "last_edit_date": 1473250589, "question_id": 39369439, "link": "https://stackoverflow.com/questions/39369439/fill-a-column-with-userform", "title": "Fill a column with UserForm", "body": "<p>I want to fill a column with UserForm. The user has 4 Options how the column can be filled. My Problem right know is, that only the first option works (2).\nAlso the input-mask wont disappear after I click the OK-Button. The chosen option should be copied into column H and filled automatically. Where are my mistakes?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n' OK Button\nDim emptyRow As Range\nDim lastrow As Long\nlastrow = Cells.SpecialCells(xlCellTypeLastCell).row\n\nWorksheets(\"Sheet1\").Activate\nSet emptyRow = Worksheets(\"Sheet1\").Range(\"H2:H\" &amp; lastrow)\n\nIf OptionButton2.value = True Then\n    emptyRow.value = \"2\"\n\n    If OptionButton3.value = True Then\n        emptyRow.value = \"3\"\n\n        If OptionButton4.value = True Then\n            emptyRow.value = \"4\"\n\n            If OptionButton5.value = True Then\n                emptyRow.value = \"5\"\n            End If\n        End If\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1473249265, "post_id": 39369132, "comment_id": 66066329, "body": "what do you mean by closed? Do you mean the Workbook the sheet is in is closed? Or do you mean that another sheet has the focus?"}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1473250014, "post_id": 39369132, "comment_id": 66066855, "body": "There are two worbooks. One is open. The other is not. I would like the open one to open the second in the background, change the data types of some columns. Save the changes and then close the hidden workbook."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1473251980, "post_id": 39369677, "comment_id": 66068298, "body": "Thank you very much for your help. To save to changes what do you change to True?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1473252252, "post_id": 39369677, "comment_id": 66068473, "body": "<code>xlWB.Close True</code> instead of <code>xlWB.Close</code>"}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1473252867, "post_id": 39369677, "comment_id": 66068958, "body": "When you do that it brings up the save as window though. I have tried using xlApp.DisplayAlerts = False. Do you know how to just save over the current file without being prompted?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1473253117, "post_id": 39369677, "comment_id": 66069169, "body": "setting <code>xlApp.DisplayAlerts = False</code> before the <code>xlWB.Close</code> should work fine. If it doesn&#39;t do the trick, you can try to set <code>.DisplayAlerts = False</code> for Application, too (<code>Application.DisplayAlerts = False</code>)"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1473250407, "creation_date": 1473250407, "answer_id": 39369677, "question_id": 39369132, "link": "https://stackoverflow.com/questions/39369132/modifying-a-closed-excel-sheet-with-vba/39369677#39369677", "title": "Modifying a closed excel sheet with VBA", "body": "<p>A bit of research should have given you the result, but I will provide it anyway...</p>\n\n<pre><code>'Since you want the Workbook to be invisible, we have to open it in a new Excel Application\nDim xlApp As New Excel.Application\nDim xlWB As Excel.Workbook\nDim xlWS As Excel.Worksheet\n\nxlApp.Visible = False\n\n'Open Workbook from specified path\nSet xlWB = xlApp.Workbooks.Open(\"YOUR FILEPATH HERE\")\n\n'Select Worksheet from opened Workbook\nSet xlWS = xlWB.Worksheets(\"YOUR WORKSHEET NAME HERE\")\n\n'Do something\n'example\nxlWS.Name = \"Asdf\"\n\n'Cleanup\nSet xlWS = Nothing\nxlWB.Close 'True to save changes, False to discard changes\nSet xlWB = Nothing\nxlApp.Quit\nSet xlApp = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473250522, "creation_date": 1473250522, "answer_id": 39369715, "question_id": 39369132, "link": "https://stackoverflow.com/questions/39369132/modifying-a-closed-excel-sheet-with-vba/39369715#39369715", "title": "Modifying a closed excel sheet with VBA", "body": "<p>This should get you started...</p>\n\n<pre><code>Sub Test()\n\n  Dim wbk As Workbook\n\n  'Open the workbook that is closed\n  Set wbk = Workbooks.Open(\"C:\\OtherWorkbook.xlsx\")\n\n  'Change the format of the first column\n  wbk.Worksheets(1).Range(\"A:A\").NumberFormat = \"0.00\"\n\n  'Close the workbook and save changes\n  wbk.Close True\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 1, "accepted_answer_id": 39369677, "answer_count": 2, "score": 0, "last_activity_date": 1473258467, "creation_date": 1473248980, "last_edit_date": 1531164843, "question_id": 39369132, "link": "https://stackoverflow.com/questions/39369132/modifying-a-closed-excel-sheet-with-vba", "title": "Modifying a closed excel sheet with VBA", "body": "<p>I am trying to open one spredsheet from another so that it isn't in view. I would then like to change the column format of one of the columns to date using the TextToColumns feature. The changes should then be saved and the file closed automatically.</p>\n\n<p>When I run the following it says No data was selected to parse. Any thoughts?</p>\n\n<pre><code>Sub Test()\n\nDim xlApp As New Excel.Application\nDim xlWB As Excel.Workbook\nDim xlWS As Excel.Worksheet\n\nxlApp.Visible = False\n\nSet xlWB = xlApp.Workbooks.Open(\"directory of file\")\n\nSet xlWS = xlWB.Worksheets(\"Sheet 1\")\nxlWS.Unprotect\n\n\n    xlWS.Columns(\"F:F\").Select\n    Selection.TextToColumns Destination:=Range(\"F1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(1, 4), TrailingMinusNumbers:=True\n\n\nSet xlWS = Nothing\nxlApp.DisplayAlerts = False\nxlWB.Close True\nSet xlWB = Nothing\nxlApp.Quit\nSet xlApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "stored-procedures", "ms-access-2010", "ado"], "comments": [{"owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 3, "creation_date": 1473252167, "post_id": 39368635, "comment_id": 66068414, "body": "If you add line <code>cmd_temp.NamedParameters = True</code> to command object initializer, will that help?"}, {"owner": {"reputation": 121, "user_id": 5322443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51cafe9715fa0326571d64cf035b0766?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5322443/john"}, "reply_to_user": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 0, "creation_date": 1473252773, "post_id": 39368635, "comment_id": 66068876, "body": "You did it. THANK YOU :D"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 0, "creation_date": 1473253642, "post_id": 39368635, "comment_id": 66069549, "body": "ADO params as far as I know do follow order. The names you give are simply local collection names and do not have to correspond to stored proc named params unless as @Arvo suggests you explicitly align the to sets of names. Also, do note both stored proc <a href=\"https://technet.microsoft.com/en-us/library/ms189330(v=sql.105).aspx\" rel=\"nofollow noreferrer\">params are optional</a> (since you set default values). So you can append one, both, or no params and procedure should still run."}, {"owner": {"reputation": 219328, "user_id": 15498, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Wi4EN.png?s=128&g=1", "display_name": "Damien_The_Unbeliever", "link": "https://stackoverflow.com/users/15498/damien-the-unbeliever"}, "edited": false, "score": 0, "creation_date": 1473319635, "post_id": 39368635, "comment_id": 66096882, "body": "Side note: <a href=\"https://msdn.microsoft.com/en-GB/library/ms187926.aspx\" rel=\"nofollow noreferrer\"><code>CREATE PROCEDURE</code></a>: &quot;Avoid the use of the <b>sp_</b> prefix when naming procedures. This prefix is used by SQL Server to designate system procedures&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5322443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51cafe9715fa0326571d64cf035b0766?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5322443/john"}, "edited": false, "score": 0, "creation_date": 1473251621, "post_id": 39369541, "comment_id": 66068015, "body": "It doesn&#39;t find the stored procedure. I am confused -.-"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473250019, "creation_date": 1473250019, "answer_id": 39369541, "question_id": 39368635, "link": "https://stackoverflow.com/questions/39368635/calling-stored-procedure-in-access-vba-only-with-the-correct-order-of-parameters/39369541#39369541", "title": "Calling Stored Procedure in Access VBA only with the correct order of parameters, why?", "body": "<p>You can use the ADOX Catalog object to inspect the named parameters.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms676682(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms676682(v=vs.85).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "is_accepted": true, "score": 2, "last_activity_date": 1473316046, "creation_date": 1473316046, "answer_id": 39383917, "question_id": 39368635, "link": "https://stackoverflow.com/questions/39368635/calling-stored-procedure-in-access-vba-only-with-the-correct-order-of-parameters/39383917#39383917", "title": "Calling Stored Procedure in Access VBA only with the correct order of parameters, why?", "body": "<p>You need to add line</p>\n\n<pre><code>cmd_temp.NamedParameters = True \n</code></pre>\n\n<p>to command object initializer.</p>\n"}], "owner": {"reputation": 121, "user_id": 5322443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51cafe9715fa0326571d64cf035b0766?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5322443/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 39383917, "answer_count": 2, "score": 3, "last_activity_date": 1473316046, "creation_date": 1473247548, "last_edit_date": 1473252363, "question_id": 39368635, "link": "https://stackoverflow.com/questions/39368635/calling-stored-procedure-in-access-vba-only-with-the-correct-order-of-parameters", "title": "Calling Stored Procedure in Access VBA only with the correct order of parameters, why?", "body": "<p>i have a little Problem with executing a stored procedure from Access. I am using the \"Microsoft ActiveX Data Objects 2.8 Library\" together with MS SQL Server 2008.</p>\n\n<p>For now I am calling the stored procedures like this:</p>\n\n<pre><code>Set cmd = init_adodbcommand(\"sp_002_test_tabellenparameter\")\n\ncmd.Parameters(\"@str_test\") = \"Test\"    \ncmd.Parameters(\"@str_test2\") = \"Test\"\n\ncmd.Execute\n</code></pre>\n\n<p>I am ok with that, but there are issues if I am using a nvarchar(max) variable in the stored procedure so I am using this code, which works fine too:</p>\n\n<pre><code>    Set cmd = init_adodbcommand(\"sp_002_test_tabellenparameter\")\n\ncmd.Parameters.Append cmd.CreateParameter(\"@str_test\", adLongVarWChar, adParamInput, -1, \"Test\")\ncmd.Parameters.Append cmd.CreateParameter(\"@str_test2\", adLongVarWChar, adParamInput, -1, \"Test\")\n\ncmd.Execute\n</code></pre>\n\n<p>It works too, BUT only if the parameters are in the correct order, like they are added in the stored procedure on the Server. \nThis behaviour doesn't happen for the first option I mentioned at the beginning! With this option I can address the parameter directly.</p>\n\n<p>The Code of the sp on the server starts like that:</p>\n\n<pre><code>    ALTER PROCEDURE [dbo].[sp_002_test_tabellenparameter]\n   -- Add the parameters for the stored procedure here\n   @str_test nvarchar(max) = NULL,\n   @str_test2 nvarchar(max) = NULL\n</code></pre>\n\n<p>I have a lot of stored procedures with more than 30 parameters and some of These parameters aren't needed sometimes and I don't won't to \"give a shit\" about the correct order... :D</p>\n\n<p>It looks like that it doesn't matter which name for the parameter I am using in Access.</p>\n\n<p>Where is my fault?</p>\n\n<p>Thank you! :)</p>\n\n<p>attachment code to initialize:</p>\n\n<pre><code>Dim cmd_temp As ADODB.Command\nDim adoconn_connection_tmp As ADODB.Connection\n\nSet adoconn_connection_tmp = New ADODB.Connection\n\n    Set adoconn_connection_tmp = ADOConnObj\n\n    Set cmd_temp = New ADODB.Command\n\n    cmd_temp.CommandType = adCmdStoredProc\n    cmd_temp.CommandText = str_prozedurname\n    cmd_temp.ActiveConnection = adoconn_connection_tmp\n\n    Set init_adodbcommand = cmd_temp\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1473248271, "post_id": 39368372, "comment_id": 66065623, "body": "Are you sure about your output? what&#39;s the rule for it? or did you mean for the output to be <code>1-3,4,5-8,9-11</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1473251612, "post_id": 39368372, "comment_id": 66068010, "body": "yes i am sure, it&#39;s not 1-3 because there is no 2.. it should only join adjacent numbers"}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1473254448, "post_id": 39368372, "comment_id": 66070140, "body": "Oh I got your point. Check my answer below."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": false, "score": 0, "last_activity_date": 1473253774, "creation_date": 1473253774, "answer_id": 39370821, "question_id": 39368372, "link": "https://stackoverflow.com/questions/39368372/simplest-way-to-convert-a-number-list-to-a-readable-string-in-vba/39370821#39370821", "title": "Simplest way to convert a number list to a readable string in VBA", "body": "<p>Well i took the long route:</p>\n\n<pre><code>Public Sub SortCollection(ByRef c As Collection)\nDim tmp\nFor i = 1 To c.Count - 1\n    For j = i + 1 To c.Count\n        If c(i) &gt; c(j) Then\n           vTemp = c(j)\n           c.Remove j\n           c.Add tmp, tmp, i\n        End If\n    Next j\nNext i\nEnd Sub\n\n\nPublic Function NumberListGrouped(cells As Range) As String\n\n    If cells.Count = 0 Then\n        AnimalIdListGrouped = \"-\"\n    ElseIf cells.Count = 1 Then\n        AnimalIdListGrouped = cells(1, 1)\n    End If\n\n    Dim c As New Collection\n\n    On Error Resume Next\n    For Each cell In cells\n        c.Add CInt(cell.Value), CStr(cell.Value)\n    Next cell\n    SortCollection c\n    On Error GoTo 0\n\n    Dim i As Long: i = 1\n    Dim numStr As String: numStr = c(1)\n    Dim isGap As Boolean: isGap = False\n\n    Do Until i &gt;= c.Count\n        DoEvents\n        Do Until i &gt;= c.Count Or c(i) + 1 &lt;&gt; c(i + 1)\n            i = i + 1\n            isGap = True\n            DoEvents\n        Loop\n        If isGap Then\n            numStr = numStr &amp; \"-\" &amp; c(i)\n        End If\n        If i &lt;&gt; c.Count Then\n            numStr = numStr &amp; \", \" &amp; c(i + 1)\n            isGap = False\n            i = i + 1\n        End If\n    Loop\n\n    NumberListGrouped = numStr\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1473263277, "post_id": 39371059, "comment_id": 66076645, "body": "That was a bit shorter than mine, but i had to make some changes to it as i was passing in a collection just for uniqueness and that fell over when i tried to test the last number against one higher."}], "tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 0, "last_activity_date": 1473254427, "last_edit_date": 1495540305, "creation_date": 1473254427, "answer_id": 39371059, "question_id": 39368372, "link": "https://stackoverflow.com/questions/39368372/simplest-way-to-convert-a-number-list-to-a-readable-string-in-vba/39371059#39371059", "title": "Simplest way to convert a number list to a readable string in VBA", "body": "<p>If you want a simple method, you might use something like the following:</p>\n\n<pre><code>Function GroupedNumbers(nums() As Long) As String\n    SortMe (nums) 'No built-in sort method in VBA,\n                  'so you need to implement one yourself (see links below).\n    Dim numStr As String\n    numStr = nums(0)\n    For i = 1 To UBound(nums)\n        If nums(i) = nums(i - 1) + 1 Then\n            numStr = numStr &amp; IIf(nums(i) + 1 = nums(i + 1), \"\", \"-\" &amp; nums(i))\n        Else\n            numStr = numStr &amp; \", \" &amp; nums(i)\n        End If\n    Next i\n    GroupedNumbers = numStr\nEnd Function\n</code></pre>\n\n<p>For array sorting you might refer to <a href=\"https://stackoverflow.com/q/152319/4934172\">this question</a>. </p>\n\n<p>And if you want something more simple, check <a href=\"https://stackoverflow.com/a/34077228/4934172\">this answer</a> which use the .NET version of <code>ArrayList</code> for sorting. Hence you would need to adapt the above function to work with <code>ArrayList</code> instead of <code>Array</code>.</p>\n\n<p>Hope that helps :)</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473255339, "creation_date": 1473255339, "answer_id": 39371399, "question_id": 39368372, "link": "https://stackoverflow.com/questions/39368372/simplest-way-to-convert-a-number-list-to-a-readable-string-in-vba/39371399#39371399", "title": "Simplest way to convert a number list to a readable string in VBA", "body": "<p>Should you ever use VBA in Excel, you could have it do the work for you as follows</p>\n\n<pre><code>Function GroupedNumbers(nums() As Long) As String\n    Dim strng As String\n    Dim i As Long\n\n    For i = LBound(nums) To UBound(nums) - 1\n        strng = strng &amp; CStr(nums(i)) &amp; \",A\"\n    Next i\n    strng = \"A\" &amp; strng &amp; CStr(nums(i))\n    GroupedNumbers = Replace(Replace(Replace(Intersect(Columns(1), Range(strng)).Address(False, False), \",A\", \", \"), \"A\", \"\"), \":\", \"-\")\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 39371059, "answer_count": 3, "score": 0, "last_activity_date": 1473255339, "creation_date": 1473246793, "question_id": 39368372, "link": "https://stackoverflow.com/questions/39368372/simplest-way-to-convert-a-number-list-to-a-readable-string-in-vba", "title": "Simplest way to convert a number list to a readable string in VBA", "body": "<p>Given an array of numbers:</p>\n\n<p>[1,3,4,5,8,9,11]</p>\n\n<p>What's the simplest way in VBA to convert that list to a readable string, e.g:</p>\n\n<p>1, 3-5, 8-9, 11</p>\n\n<p>I could just rewrite my VB.net function to VBA but it's already quite long winded and it will end up even longer in VBA.</p>\n\n<pre><code>Public Shared Function GroupedNumbers(nums As List(Of Long))\n\n    If nums Is Nothing OrElse nums.Count = 0 Then Return \"-\"\n\n    If nums.Count = 1 Then Return nums(0)\n\n    Dim lNums = nums.Distinct().OrderBy(Function(m) m).ToList\n\n    Dim curPos As Long = 1\n    Dim lastNum As Long = lNums(0)\n    Dim i As Long = 0\n    Dim numStr As String = lNums(0)\n    Dim isGap As Boolean = False\n\n    Do Until i &gt;= lNums.Count - 1\n        Do Until i &gt;= lNums.Count - 1 OrElse lNums(i) + 1 &lt;&gt; lNums(i + 1)\n            i += 1\n            isGap = True\n        Loop\n        If isGap Then\n            numStr += \"-\" &amp; lNums(i)\n        End If\n        If i &lt;&gt; lNums.Count - 1 Then\n            numStr += \", \" &amp; lNums(i + 1)\n            isGap = False\n            i += 1\n        End If\n    Loop\n\n    Return numStr\n\nEnd Function\n</code></pre>\n\n<p>Just wondering if anyone has a better way of doing this before i go about rewriting it for VBA?</p>\n"}, {"tags": ["excel", "macros", "vba"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1473248306, "post_id": 39368737, "comment_id": 66065648, "body": "Wonderful, it works. But I appreciate if the user input is pop-up, not predefined in column C. Thanks"}, {"owner": {"reputation": 130, "user_id": 6654659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swshc.jpg?s=128&g=1", "display_name": "Krlos", "link": "https://stackoverflow.com/users/6654659/krlos"}, "reply_to_user": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1473248642, "post_id": 39368737, "comment_id": 66065884, "body": "added the userInput from an InputBox"}], "tags": [], "owner": {"reputation": 130, "user_id": 6654659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swshc.jpg?s=128&g=1", "display_name": "Krlos", "link": "https://stackoverflow.com/users/6654659/krlos"}, "is_accepted": true, "score": 1, "last_activity_date": 1473259411, "last_edit_date": 1473259411, "creation_date": 1473247816, "answer_id": 39368737, "question_id": 39368256, "link": "https://stackoverflow.com/questions/39368256/replacing-strings-in-a-column-sequentially/39368737#39368737", "title": "Replacing strings in a column sequentially", "body": "<pre><code>Sub naming()\nRowsToProcess = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nj = 1\n\nuserInput = InputBox(\"Give me text\")\n\nFor i = 1 To RowsToProcess\n   If Not Cells(i, 1).Value = \"\" Then\n\n    Cells(i, 2).Value = userInput &amp; \"_Image-\" &amp; j &amp; \".jpg\"\n    j = j + 1\n   End If\nNext\nEnd Sub\n</code></pre>\n\n<p>This macro creates column B as desired</p>\n"}], "owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 39368737, "answer_count": 1, "score": 0, "last_activity_date": 1473801248, "creation_date": 1473246454, "last_edit_date": 1531164843, "question_id": 39368256, "link": "https://stackoverflow.com/questions/39368256/replacing-strings-in-a-column-sequentially", "title": "Replacing strings in a column sequentially", "body": "<p>I am naive to macros. I have data in column A with 500 rows of data. Note some rows are blank in between. The data are image files names like (X0011@00.jpg). I need to rename them sequentially with user input. The user input must be only 400500. The new name must be like (400500_Image-1.jpg). The _Image-1, _Image-2 and so on must be generated automatically in sequence omitting blank rows.</p>\n\n<p>See below how my data is displayed in column A and how I want it in column B.</p>\n\n<p>I appreciate if anyone can provide macro for this.</p>\n\n<pre><code>  Col A              Col B\n\nX0011@00.jpg    400500_Image-1.jpg\nX0021@00.jpg    400500_Image-2.jpg\nX0041@00.jpg    400500_Image-3.jpg\n\nX0071@00.jpg    400500_Image-4.jpg\nX0051@00.jpg    400500_Image-5.jpg\n\n\nX0031@00.jpg    400500_Image-6.jpg\nX0061@00.jpg    400500_Image-7.jpg\nX0091@00.jpg    400500_Image-8.jpg\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473249951, "post_id": 39368130, "comment_id": 66066803, "body": "@siddarthRout just to grab your attention any chance you could help me out with a problem I posted, thanks"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473250404, "post_id": 39368130, "comment_id": 66067153, "body": "try the code in my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473247473, "post_id": 39368394, "comment_id": 66065098, "body": "ActiveChart.SetSourceData Source:=Sheets(ws_OutputSheet).Range(dataRng.Address(True, True, True, True)), PlotBy:=xlColumns     at this line of code, Run time error 1004: Application defined or object defined error is showing up.. @user3598756"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473246854, "creation_date": 1473246854, "answer_id": 39368394, "question_id": 39368130, "link": "https://stackoverflow.com/questions/39368130/dynamic-data-range-for-vba-chart/39368394#39368394", "title": "dynamic data range for vba chart", "body": "<p>try this</p>\n\n<pre><code>Option Explicit\n\nSub to_Draw_chart()\n    Dim ws_InputSheet As String, ws_OutputSheet As String\n\n    ws_InputSheet = \"Sheet3\"\n\n    Dim dataRng As Range\n    With Worksheets(ws_InputSheet)\n        Set dataRng = .Range(\"A1\").CurrentRegion\n    End With\n\n    Charts.Add\n    ActiveChart.ChartType = xlColumnStacked\n'    ActiveChart.SetSourceData Source:=Sheets(ws_OutputSheet).Range(ws_InputSheet &amp; \"!$A$1:$P$4\"), PlotBy:=xlColumns\n    ActiveChart.SetSourceData Source:=Sheets(ws_OutputSheet).Range(dataRng.Address(True, True, True, True)), PlotBy:=xlColumns\n    With ActiveChart\n        .HasTitle = True\n        .ChartTitle.Characters.Text = \"Time_Plotter\"\n        .Axes(xlValue).MaximumScale = 1000\n        .Axes(xlValue).MajorUnit = 250\n        .Axes(xlCategory).CategoryType = xlCategoryScale\n        .Axes(xlCategory).CategoryType = xlAutomatic\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473249584, "post_id": 39369243, "comment_id": 66066540, "body": "i tried this code, but it is just generating the blank chart without any data being plotted.. my question is where in this code it has been mentioned that it should select data from Sheet3?? and also active selection means the cells in the excel sheet which are selected , Is it what it means??"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473250083, "post_id": 39369243, "comment_id": 66066908, "body": "yes. Exactly. therefore if your are in a different sheet when you running this, then you need to switch to sheet3 for this code to work. that is to include <code>Sheets(&quot;Sheet3&quot;).Activate</code> before <code>Set SelRange = Selection</code>"}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1473250109, "last_edit_date": 1473250109, "creation_date": 1473249255, "answer_id": 39369243, "question_id": 39368130, "link": "https://stackoverflow.com/questions/39368130/dynamic-data-range-for-vba-chart/39369243#39369243", "title": "dynamic data range for vba chart", "body": "<p>Try the below code. This will create the chart from the active selection</p>\n\n<pre><code>Sub to_Draw_chart()\n    Dim ws_InputSheet As String\n    Dim SelRange As Range\n    Sheets(\"Sheet3\").Activate\n    Set SelRange = Selection\n    ws_InputSheet = \"Sheet3\"\n    Charts.Add\n    ActiveChart.ChartType = xlColumnStacked\n    ActiveChart.SetSourceData Source:=SelRange, PlotBy:=xlColumns\n    With ActiveChart\n        .HasTitle = True\n        .ChartTitle.Characters.Text = \"Time_Plotter\"\n        .Axes(xlValue).MaximumScale = 1000\n        .Axes(xlValue).MajorUnit = 250\n        .Axes(xlCategory).CategoryType = xlCategoryScale\n        .Axes(xlCategory).CategoryType = xlAutomatic\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473251292, "post_id": 39369668, "comment_id": 66067773, "body": "i tried the code given by you. but then it is showing compiler error. With object must be user defined type, Object / Variant. The code is breaking at With ws_InputSheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473251504, "post_id": 39369668, "comment_id": 66067927, "body": "@user28 did you change the definition to <code>Dim ws_InputSheet As Worksheet</code> ? and later did you set it to <code>Set ws_InputSheet = ThisWorkbook.Sheets(&quot;Sheet3&quot;)</code> ?"}, {"owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "edited": false, "score": 0, "creation_date": 1473252774, "post_id": 39369668, "comment_id": 66068878, "body": "thank you very much. it worked. yes i didn&#39;t change Dim ws_InputSheet As Worksheet . but now everythng is working fine."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1473250379, "creation_date": 1473250379, "answer_id": 39369668, "question_id": 39368130, "link": "https://stackoverflow.com/questions/39368130/dynamic-data-range-for-vba-chart/39369668#39369668", "title": "dynamic data range for vba chart", "body": "<p>I used your <strong>ws_InputSheet</strong> but <code>As WorkSheet</code>, I think you'll find the code below simplier to follow: </p>\n\n<pre><code>Option Explicit\n\nSub to_Draw_chart()\n\n    Dim ws_InputSheet As Worksheet, ws_OutputSheet As Worksheet\n    Dim dataRng As Range\n\n    Set ws_InputSheet = ThisWorkbook.Sheets(\"Sheet3\")\n\n    With ws_InputSheet\n        Set dataRng = .Range(\"A1\").CurrentRegion\n    End With\n\n    Charts.Add\n    ActiveChart.ChartType = xlColumnStacked\n\n    ActiveChart.SetSourceData Source:=dataRng, PlotBy:=xlColumns\n    With ActiveChart\n        .HasTitle = True\n        .ChartTitle.Characters.Text = \"Time_Plotter\"\n        .Axes(xlValue).MaximumScale = 1000\n        .Axes(xlValue).MajorUnit = 250\n        .Axes(xlCategory).CategoryType = xlCategoryScale\n        .Axes(xlCategory).CategoryType = xlAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "accepted_answer_id": 39369668, "answer_count": 3, "score": 0, "last_activity_date": 1473250379, "creation_date": 1473246102, "last_edit_date": 1473247252, "question_id": 39368130, "link": "https://stackoverflow.com/questions/39368130/dynamic-data-range-for-vba-chart", "title": "dynamic data range for vba chart", "body": "<p>The below mentioned code is working properly. But then my query is:---\ncurrently I am having Input datasheet value from A1 to P4 but it can change: for example datavalue can be from A1 to S7. (the data always starts with A in excel sheet) \nBut in the code given below, I have given the range manually. what changes i need to do in range part so that it will automatically find out the column range?</p>\n\n<pre><code>            Sub to_Draw_chart()\n               Dim ws_InputSheet As String \n               ws_InputSheet = \"Sheet3\"\n               Charts.Add\n               ActiveChart.ChartType = xlColumnStacked\n               ActiveChart.SetSourceData Source:=Sheets(ws_InputSheet).Range(ws_InputSheet &amp; \"!$A$1:$P$4\"), PlotBy:=xlColumns\n               With ActiveChart\n                   .HasTitle = True\n                   .ChartTitle.Characters.Text = \"Time_Plotter\"\n                   .Axes(xlValue).MaximumScale = 1000\n                   .Axes(xlValue).MajorUnit = 250\n                   .Axes(xlCategory).CategoryType = xlCategoryScale\n                   .Axes(xlCategory).CategoryType = xlAutomatic\n               End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6804196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7677208cb86a4a0e7915d6d54c02ca81?s=128&d=identicon&r=PG&f=1", "display_name": "mhurstsmith", "link": "https://stackoverflow.com/users/6804196/mhurstsmith"}, "edited": false, "score": 0, "creation_date": 1473246947, "post_id": 39368182, "comment_id": 66064754, "body": "Thanks @Andreas I will bear this in mind. As this workbook will need to be moved around across multiple users I think I will stick with the global variables. Thanks nonetheless!"}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 1, "last_activity_date": 1473246245, "creation_date": 1473246245, "answer_id": 39368182, "question_id": 39368004, "link": "https://stackoverflow.com/questions/39368004/excel-vba-userform-global-counter/39368182#39368182", "title": "Excel VBA Userform Global Counter", "body": "<p>You can always use the registry. It can be used to many other things too in the future.  </p>\n\n<pre><code>SaveSetting \"Your macro\", \"Values\", \"CurrentRow\", currentRow\n</code></pre>\n\n<p>Now the currentRow is saved in your registry.  </p>\n\n<p>Now in your <code>PlanningUserForm</code>:</p>\n\n<pre><code>currentRow = GetSetting(\"Your macro\", \"Values\", \"CurrentRow\")\n</code></pre>\n\n<p>and you got the saved value from your registry. </p>\n\n<p>I have bad experiences with global variables, that is why I suggest registry.</p>\n"}, {"tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1473246407, "creation_date": 1473246407, "answer_id": 39368233, "question_id": 39368004, "link": "https://stackoverflow.com/questions/39368004/excel-vba-userform-global-counter/39368233#39368233", "title": "Excel VBA Userform Global Counter", "body": "<p>If you have declared <code>currentRow</code> as public, then in <code>PlanningUserForm</code> you can access the <code>currentRow</code> value as <code>UserForm1.currentRow</code> where <code>UserForm1</code> is the userform where you have declared currentRow as Public</p>\n"}], "owner": {"reputation": 5, "user_id": 6804196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7677208cb86a4a0e7915d6d54c02ca81?s=128&d=identicon&r=PG&f=1", "display_name": "mhurstsmith", "link": "https://stackoverflow.com/users/6804196/mhurstsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 39368233, "answer_count": 2, "score": 0, "last_activity_date": 1473246407, "creation_date": 1473245759, "question_id": 39368004, "link": "https://stackoverflow.com/questions/39368004/excel-vba-userform-global-counter", "title": "Excel VBA Userform Global Counter", "body": "<p>I have created a VBA UserForm whose purpose is to allow the user to update records held in that Workbook. On Initialization, the UserForm populates with certain cell values in various text boxes, the user is then asked to add certain information in other text boxes, and on clicking the 'Next' button, the new information is added to the data table and the next entry populates the UserForm.</p>\n\n<p>I am currently achieving this by keeping a count of the current row (currentRow) and once the 'Next' button is clicked, currentRow = currentRow + 1. This works fine.</p>\n\n<p>My problem now is that I need to show a different UserForm if the value of a specific cell is different, for example:</p>\n\n<pre><code>If Range(Cells(currentRow, 3).Address).Value = \"Planning\" Then\n    PlanningUserForm.Show\nElse\n... rest of code ...\n</code></pre>\n\n<p>This works, but I am struggling to maintain the counter once this new PlanningUserForm is initialized. I need it to know the current value of currentRow so that it can display the correct cell values in its text boxes. </p>\n\n<p>I have declared the variable currentRow as Public, but it doesn't seem to carry over the value into the new userform. Is this possible? Or am I asking too much of Excel? </p>\n\n<p>Many thanks</p>\n\n<p>Matt</p>\n"}, {"tags": ["excel", "vba", "outlook", "office-2013"], "comments": [{"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 0, "creation_date": 1473246365, "post_id": 39367874, "comment_id": 66064386, "body": "Which version of Outlook/Office are you targeting? <a href=\"http://stackoverflow.com/a/12353494/205233\">Difference between Outlook.Folder and Outlok.MAPIFolder</a> seems to indicate that <code>Outlook.Namespace</code>and <code>Outlook.MAPIFolder</code> are deprecated."}, {"owner": {"reputation": 13, "user_id": 6796888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Zmh8x.jpg?s=128&g=1", "display_name": "alejandraux", "link": "https://stackoverflow.com/users/6796888/alejandraux"}, "reply_to_user": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 0, "creation_date": 1473246765, "post_id": 39367874, "comment_id": 66064638, "body": "I am trying to export to Office 2013. This code works to one of my subfolders in outlook but not in the other folders"}, {"owner": {"reputation": 13, "user_id": 6796888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Zmh8x.jpg?s=128&g=1", "display_name": "alejandraux", "link": "https://stackoverflow.com/users/6796888/alejandraux"}, "reply_to_user": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 0, "creation_date": 1473246925, "post_id": 39367874, "comment_id": 66064740, "body": "The Namespace and MAPIFolder is just for selecting the  folders I want to export . I don&#39;t think it&#39;s the problem"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6796888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Zmh8x.jpg?s=128&g=1", "display_name": "alejandraux", "link": "https://stackoverflow.com/users/6796888/alejandraux"}, "edited": false, "score": 0, "creation_date": 1473261972, "post_id": 39370830, "comment_id": 66075774, "body": "I&#39;ll try this one and give you an update if it works. Thank you for this ."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1473253816, "creation_date": 1473253816, "answer_id": 39370830, "question_id": 39367874, "link": "https://stackoverflow.com/questions/39367874/vba-macro-export-email-address-to-excel/39370830#39370830", "title": "VBA MACRO - Export Email Address To Excel", "body": "<p>You assume every itm is a mailitem.</p>\n\n<p>You could skip an item if it is not a mailitem:</p>\n\n<pre><code>For Each itm In fld.items\n\n    intColumnCounter = 1\n\n    If itm.Class = olMail Then\n\n        Set msg = itm\n\n        intRowCounter = intRowCounter + 1\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        rng.Value = msg.To\n\n        intColumnCounter = intColumnCounter + 1\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        rng.Value = msg.senderemailaddress\n\n    Else\n\n        Debug.Print \" Item is not a mailitem.\"\n\n    End If\n\nNext itm\n</code></pre>\n\n<p>You could instead bypass errors if the item does not have the properties you want.</p>\n\n<pre><code>For Each itm In fld.items\n\n    intColumnCounter = 1\n\n    intRowCounter = intRowCounter + 1\n    Set rng = wks.Cells(intRowCounter, intColumnCounter)\n    On Error Resume Next\n    rng.Value = itm.To\n    On Error GoTo 0\n\n    intColumnCounter = intColumnCounter + 1\n    Set rng = wks.Cells(intRowCounter, intColumnCounter)\n    On Error Resume Next\n    rng.Value = itm.senderemailaddress\n    On Error GoTo 0\n\nNext itm\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6796888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Zmh8x.jpg?s=128&g=1", "display_name": "alejandraux", "link": "https://stackoverflow.com/users/6796888/alejandraux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1593154989, "creation_date": 1473245387, "last_edit_date": 1593154989, "question_id": 39367874, "link": "https://stackoverflow.com/questions/39367874/vba-macro-export-email-address-to-excel", "title": "VBA MACRO - Export Email Address To Excel", "body": "<p>I have a VBA code here that export email addresses of a chosen subfolder to an Excel file. My problem is that, it only works to only one of my folders.</p>\n\n<p>When I try using this macro to other folders, I'm getting a \"Run Time Error 13 TYPE MISMATCH\" error. I really don't have an idea why I am getting this error. I hope someone could help me detect where the problem came from.</p>\n\n<p><strong>Here's my code:</strong></p>\n\n<pre><code>Sub ExportToExcel()\n\n\nDim appExcel As Excel.Application\nDim wkb As Excel.Workbook\nDim wks As Excel.Worksheet\nDim rng As Excel.Range\nDim strSheet As String\nDim strPath As String\nDim intRowCounter As Integer\nDim intColumnCounter As Integer\nDim msg As Outlook.MailItem\nDim nms As Outlook.NameSpace\nDim fld As Outlook.MAPIFolder\nDim itm As Object\nstrSheet = \"OutlookItems.xlsx\"\nstrPath = \"C:\\Users\\Gabriel.Alejandro\\Desktop\\\"\nstrSheet = strPath &amp; strSheet\n\n\nDebug.Print strSheet\n  'Select export folder\nSet nms = Application.GetNamespace(\"MAPI\")\nSet fld = nms.PickFolder\n  'Handle potential errors with Select Folder dialog box.\n\n\n  'Open and activate Excel workbook.\nSet appExcel = CreateObject(\"Excel.Application\")\nappExcel.Workbooks.Open (strSheet)\n\n\nSet wkb = appExcel.ActiveWorkbook\nSet wks = wkb.Sheets(1)\nwks.Activate\n\n\nappExcel.Application.Visible = True\n\n  'Copy field items in mail folder.\nFor Each itm In fld.Items\nintColumnCounter = 1\n\nSet msg = itm  'The part where I am getting the ERROR \n\nintRowCounter = intRowCounter + 1\nSet rng = wks.Cells(intRowCounter, intColumnCounter)\nrng.Value = msg.To\nintColumnCounter = intColumnCounter + 1\nSet rng = wks.Cells(intRowCounter, intColumnCounter)\nrng.Value = msg.SenderEmailAddress\n\n\nNext itm\n\nSet appExcel = Nothing\nSet wkb = Nothing\nSet wks = Nothing\nSet rng = Nothing\nSet msg = Nothing\nSet nms = Nothing\nSet fld = Nothing\nSet itm = Nothing\n\nExit Sub\n\nSet appExcel = Nothing\nSet wkb = Nothing\nSet wks = Nothing\nSet rng = Nothing\nSet msg = Nothing\nSet nms = Nothing\nSet fld = Nothing\nSet itm = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "hyperlink", "powerpoint", "powerpoint-2010"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1473262014, "creation_date": 1473262014, "answer_id": 39373923, "question_id": 39367867, "link": "https://stackoverflow.com/questions/39367867/click-a-link-to-another-slide-in-powerpoint-without-going-full-screen/39373923#39373923", "title": "Click a link to another slide in powerpoint without going full screen", "body": "<p>Links only work in Slide Show view.</p>\n\n<p>If you go to Slide Show | Set Up Slide Show, you can choose \"Browsed by an individual (window)\" </p>\n\n<p>Then the slide show window will be moveable/resizable and won't necessarily fill the screen.</p>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1473342233, "creation_date": 1473342233, "answer_id": 39392606, "question_id": 39367867, "link": "https://stackoverflow.com/questions/39367867/click-a-link-to-another-slide-in-powerpoint-without-going-full-screen/39392606#39392606", "title": "Click a link to another slide in powerpoint without going full screen", "body": "<p>If the problem is that your presenter(s) aren't putting the deck into slide show mode before they start presenting (meaning your links don't work in normal/edit mode), you could try one of these solutions:</p>\n\n<ol>\n<li><p>Add a solid filled rectangle that fully covers your first slide and set any <strong>Entrance</strong> animation on it with the <strong>Trigger</strong> / <strong>On Click of</strong> set to this shape. Then write the text in the shape \"Please press F5 to start this presentation\". The shape will never be seen in slide show mode but is a polite reminder for your presenters when they open the .pptx file.</p></li>\n<li><p>Save the deck in the .ppsx file format, forcing it to automatically start in slide show mode.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 6825240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5665e08c4eed9a29a4db2a1f3e1d36df?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/6825240/john-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1473749219, "creation_date": 1473749219, "answer_id": 39463775, "question_id": 39367867, "link": "https://stackoverflow.com/questions/39367867/click-a-link-to-another-slide-in-powerpoint-without-going-full-screen/39463775#39463775", "title": "Click a link to another slide in powerpoint without going full screen", "body": "<p>As Steve says Links only work in show mode. To get them to work in edit the only way is to RIGHT CLICK on them and choose Open Hyperlink from the menu.</p>\n"}], "owner": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3005, "favorite_count": 0, "accepted_answer_id": 39373923, "answer_count": 3, "score": 0, "last_activity_date": 1593806150, "creation_date": 1473245361, "last_edit_date": 1593806150, "question_id": 39367867, "link": "https://stackoverflow.com/questions/39367867/click-a-link-to-another-slide-in-powerpoint-without-going-full-screen", "title": "Click a link to another slide in powerpoint without going full screen", "body": "<p>I'm creating a powerpoint which has a contents page, I would like that contents page to have clickable links to other slides in the presentation. The problem is currently those links only work when I go full screen, is there a way which I can click the link without going full screen?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "macros", "permutation", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 6804219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4d3f8923c12dbf107a2de2d3ae6a00?s=128&d=identicon&r=PG&f=1", "display_name": "elene", "link": "https://stackoverflow.com/users/6804219/elene"}, "edited": false, "score": 2, "creation_date": 1473246033, "post_id": 39367480, "comment_id": 66064164, "body": "Ok I Did it with macros  <code>Sub qwerty()     For i = 0 To 9         For j = 0 To 9             For k = 0 To 9                 For a = 0 To 9                     For b = 0 To 9                         LL = LL + 1                         Cells(LL, 1) = i                         Cells(LL, 2) = j                         Cells(LL, 3) = k                         Cells(LL, 4) = a                         Cells(LL, 5) = b                     Next b                 Next a             Next k         Next j     Next i End Sub</code> If anyone has better answer feel free"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1473251758, "post_id": 39367480, "comment_id": 66068108, "body": "Hm, if the term is &quot;combinations 5 out of 10&quot;, then in my opinion 9,9,9,8,0 and 0,8,9,9,9 and 8,0,9,9,9 and 9,8,0,9,9 and ... are exactly the same combination: 3 times 9, one 8 and one 0. Considered this, there are only 2002 combinations with repetition possible."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1473250223, "creation_date": 1473250223, "answer_id": 39369609, "question_id": 39367480, "link": "https://stackoverflow.com/questions/39367480/all-possible-combinations-of-10-numbers-with-repetition-in-excel/39369609#39369609", "title": "All possible combinations of 10 numbers with repetition in excel", "body": "<p>A slight modification of elene's code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/J57ic.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J57ic.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub AllCombinations()\n    Dim nums(): nums = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)\n    Dim arValues(99999, 4)\n    Dim n1 As Integer, n2 As Integer, n3 As Integer, n4 As Integer, n5 As Integer, x As Long\n\n    For n1 = 0 To UBound(nums)\n        For n2 = 0 To UBound(nums)\n            For n3 = 0 To UBound(nums)\n                For n4 = 0 To UBound(nums)\n                    For n5 = 0 To UBound(nums)\n                        arValues(x, 0) = nums(n1)\n                        arValues(x, 1) = nums(n2)\n                        arValues(x, 2) = nums(n3)\n                        arValues(x, 3) = nums(n4)\n                        arValues(x, 4) = nums(n5)\n                        x = x + 1\n                    Next\n                Next\n            Next\n        Next\n    Next\n\n    Range(\"A1\").Resize(100000, 5).Value2 = arValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1473260621, "creation_date": 1473260621, "answer_id": 39373413, "question_id": 39367480, "link": "https://stackoverflow.com/questions/39367480/all-possible-combinations-of-10-numbers-with-repetition-in-excel/39373413#39373413", "title": "All possible combinations of 10 numbers with repetition in excel", "body": "<p>This might run a bit faster:</p>\n\n<pre><code>Sub combinations()\nDim wb As Workbook, i As Integer, strFileName As String\n\n'Create Temp Workbook for data source\nSet wb = Workbooks.Add\nWith wb.ActiveSheet\n    .Range(\"A1\").Value = \"Integer\"\n    For i = 0 To 9\n        .Range(\"A\" &amp; i + 2).Value = i\n    Next i\nEnd With\nstrFileName = \"C:\\Temp\\Temp.xlsx\"\nwb.SaveAs strFileName\nwb.Close False\n\n'Create List using Temp Workbook as source(s)\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array(Array(\"ODBC;DBQ=\" &amp; strFileName &amp; \";DefaultDir=C:\\temp;Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};DriverId=1046;FIL=exce\"), Array(\"l 12.0;MaxBufferSize=2048;MaxScanRows=8;PageTimeout=5;ReadOnly=1;SafeTransactions=0;Threads=3;UID=admin;UserCommitSync=Yes;\")), Destination:=Range(\"$A$1\")).QueryTable\n    .CommandText = Array( _\n    \"SELECT `Sheet1$`.Integer, `Sheet1$_1`.Integer, `Sheet1$_2`.Integer, `Sheet1$_3`.Integer, `Sheet1$_4`.Integer\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM `\" &amp; strFileName &amp; \"`.`Sheet1$` `Sheet1$`, `\" &amp; strFileName &amp; \"`.`Sheet1$` `Sheet1$_1`, `\", strFileName &amp; \"`.`Sheet1$` `Sheet1$_2`, `\" &amp; strFileName &amp; \"`.`Sheet1$` `Sheet1$_3`, `\" &amp; strFileName &amp; \"`.`Sheet1$` `Sheet1$_4`\")\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = False\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"Table_Query_from_Temp\"\n    .Refresh BackgroundQuery:=False\nEnd With\n\n'Convert back to range\nActiveSheet.ListObjects(\"Table_Query_from_Temp\").Unlist\n\n'Delete top row\nRows(\"1:1\").Delete\n\n'Delete Temp file\nKill strFileName\nEnd Sub\n</code></pre>\n\n<p>Well faster than the original. Probably not a lot in it for the array approach. It's a different technique at least...</p>\n"}], "owner": {"reputation": 13, "user_id": 6804219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4d3f8923c12dbf107a2de2d3ae6a00?s=128&d=identicon&r=PG&f=1", "display_name": "elene", "link": "https://stackoverflow.com/users/6804219/elene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1647, "favorite_count": 0, "accepted_answer_id": 39369609, "answer_count": 2, "score": 1, "last_activity_date": 1473260621, "creation_date": 1473244296, "last_edit_date": 1531161705, "question_id": 39367480, "link": "https://stackoverflow.com/questions/39367480/all-possible-combinations-of-10-numbers-with-repetition-in-excel", "title": "All possible combinations of 10 numbers with repetition in excel", "body": "<p>How can i generate all possible combinations of numbers {0, 1, 2, 3, 4, 5, 6, 7, 8, 9 } with length 5 in Excel. I know there are 10^5 possible combinations with repetition.\nThank you    </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473243528, "post_id": 39366995, "comment_id": 66062506, "body": "is C7 always the cell with number of rows you want to hide ? Does the range of hidden rows starts from row 13 (&quot;B13&quot;) ?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473244102, "post_id": 39366995, "comment_id": 66062876, "body": "You&#39;ll want to check the value in C7 <code>isnumeric</code> and then <code>resize</code> range B13 to the value in C7 and change the <code>entirerow</code>s <code>hidden</code> property to False."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473750422, "post_id": 39366995, "comment_id": 66248602, "body": "@ongcaps have you tested the code in mu asnwer below ?"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1473244751, "post_id": 39367525, "comment_id": 66063322, "body": "I&#39;d use <code>Range(&quot;B13&quot;).Resize(Target.Value).EntireRow.Hidden = False</code>.  Personal preference though."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473250098, "post_id": 39367525, "comment_id": 66066921, "body": "@DarrenBartrup-Cook feel free to update my answer if it&#39;s improving the answer"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473251533, "post_id": 39367525, "comment_id": 66067950, "body": "I wouldn&#39;t say it&#39;s improving - just another way of getting the same result."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473245111, "last_edit_date": 1473245111, "creation_date": 1473244410, "answer_id": 39367525, "question_id": 39366995, "link": "https://stackoverflow.com/questions/39366995/unhide-rows-based-on-a-numeric-value-in-a-cell/39367525#39367525", "title": "Unhide rows based on a numeric value in a cell", "body": "<p>The code below on <code>Worksheet_Change()</code> event, will run only if the user changes the value in Cell \"<strong>C7</strong>\", you can modify it easily in the code (it is commeneted at which line).</p>\n\n<p>The code wil unhide the number of rows specified starting from row 13 (according to Range <strong>B13:B513</strong>)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim WatchRange                  As Range\nDim IntersectRange              As Range\nDim Numof_UnhideRows            As Long\nDim UnhideRowStart              As Long\n\n\n' if you want to unhide the rows in Range(B13:B513) only when someone canges the vlues in C7\nSet WatchRange = Range(\"C7\")\n\n' starting unhiding number of rows starting for row 13\nUnhideRowStart = 13\n\nSet IntersectRange = Intersect(Target, WatchRange)\n\nIf Not IntersectRange Is Nothing Then\n    If IsNumeric(Target.Value) Then\n        Numof_UnhideRows = Target.Value\n        Rows(UnhideRowStart &amp; \":\" &amp; UnhideRowStart + Numof_UnhideRows - 1).EntireRow.Hidden = False\n\n        MsgBox \"Unhide a total of \" &amp; Numof_UnhideRows &amp; \" rows\"\n    Else\n        MsgBox \"Cell C7 doesn't contain a Numeric Value\", vbCritical\n    End If\nElse\n   'Do Nothing Spectacular\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6804143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f5e6ae98e4427aaca027e1abc2160ba?s=128&d=identicon&r=PG&f=1", "display_name": "ongcaps", "link": "https://stackoverflow.com/users/6804143/ongcaps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473245111, "creation_date": 1473242965, "last_edit_date": 1531161705, "question_id": 39366995, "link": "https://stackoverflow.com/questions/39366995/unhide-rows-based-on-a-numeric-value-in-a-cell", "title": "Unhide rows based on a numeric value in a cell", "body": "<p>I am trying to create <code>Worksheet_Change()</code> event to unhide rows based on the numeric value of one cell.</p>\n\n<p>I have a table <strong>B13:B513</strong>. I want to unhide a number of rows equal to the value in <strong>C7</strong>. For example, if C7 = 10, then B13:B22 will unhide and the rest will still be hidden.</p>\n\n<p>I have seen several ways of doing something similar but using \"case\" for each option. In my case I have 500 options. I am sure there is a more efficient way of doing this.</p>\n\n<p>I am using Excel 2010.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Daniel</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473242525, "post_id": 39366608, "comment_id": 66061901, "body": "Sorry, can&#39;t see the image - &quot;This site can\u2019t be reached&quot;.  Your <code>.Cells.</code> and <code>.Range</code> are referencing the Excel application rather than a worksheet so they&#39;ll cause an error.  Not sure about the PasteSpecial - I&#39;m used to seeing it in this format: <code>Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473243773, "post_id": 39366608, "comment_id": 66062663, "body": "I think it&#39;s the format bit, also a range where to put it maybe, I&#39;ve tried with <code>ActiveSheet.Range(&quot;a1&quot;).PasteSpecial xlPasteValues</code> and fine, are why not use CopyFromRecordset instead?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 1797935, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4197a761e1dbbc2c8e3710ca57b02314?s=128&d=identicon&r=PG", "display_name": "user1797935", "link": "https://stackoverflow.com/users/1797935/user1797935"}, "edited": false, "score": 0, "creation_date": 1473247547, "post_id": 39368048, "comment_id": 66065145, "body": "Thanks that worked perfectly, is there also a way i can exclude certain fields  and open a fixed excel sheet?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 57, "user_id": 1797935, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4197a761e1dbbc2c8e3710ca57b02314?s=128&d=identicon&r=PG", "display_name": "user1797935", "link": "https://stackoverflow.com/users/1797935/user1797935"}, "edited": false, "score": 0, "creation_date": 1473247703, "post_id": 39368048, "comment_id": 66065247, "body": "You could do this the other way around, by writing a macro in Excel that uses ADO to query your database, then use the <code>.CopyFromRecordset()</code> method but it&#39;s more advanced that this and impossible for me to give an example without being next to you at your computer! I&#39;d suggest researching this though if you&#39;re working with DBs a lot - it will make your life a million times easier."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1506014804, "last_edit_date": 1506014804, "creation_date": 1473245867, "answer_id": 39368048, "question_id": 39366608, "link": "https://stackoverflow.com/questions/39366608/access-vba-method-pastespecial-of-worksheet-class-failed/39368048#39368048", "title": "Access VBA: Method pastespecial of worksheet class failed", "body": "<p>Couple of things wrong:</p>\n\n<ul>\n<li><p>You appear to have used early binding to dimension the <code>xlApp</code> variable, but then use late binding to initialize that variable.</p></li>\n<li><p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow noreferrer\"><code>.PasteSpecial()</code></a> method should be used on a range object, not a sheet object.</p></li>\n<li><p>You appear to be using the wrong arguments on the <code>.PasteSpecial</code> method.</p></li>\n<li><p>The paste method should be a numeric value, part of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837425.aspx\" rel=\"nofollow noreferrer\"><code>xlPasteType</code></a> enumeration</p></li>\n</ul>\n\n<hr>\n\n<p>Try this code instead:</p>\n\n<pre><code>DoCmd.RunCommand acCmdSelectAllRecords\nDoCmd.RunCommand acCmdCopy\n\nDim xlApp As Excel.Application\nSet xlApp = New Excel.Application\n\nxlApp.Workbooks.Add\nxlApp.Visible = True\n\nWith xlApp.ActiveWorkbook.ActiveSheet\n    .Cells.PasteSpecial XlPasteType.xlPasteValues\n    .Cells.EntireColumn.AutoFit\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1797935, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4197a761e1dbbc2c8e3710ca57b02314?s=128&d=identicon&r=PG", "display_name": "user1797935", "link": "https://stackoverflow.com/users/1797935/user1797935"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1296, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593956020, "creation_date": 1473241791, "last_edit_date": 1593956020, "question_id": 39366608, "link": "https://stackoverflow.com/questions/39366608/access-vba-method-pastespecial-of-worksheet-class-failed", "title": "Access VBA: Method pastespecial of worksheet class failed", "body": "<p>I have a <strong>VBA</strong> code that is supposed to export the filtered query data to Excel. When I activate the code trough an OnClick button, I get the error: \n<code>Method pastespecial of worksheet class failed</code>.</p>\n\n<p>I am running <strong>Access 2013</strong> on a <strong>Windows Server 2012 r2</strong> machine.</p>\n\n<p><strong>The VBA code:</strong></p>\n\n<pre><code>Private Sub cbExport_Click()\n\n    On Error GoTo Command13_Click_Err\n\n    DoCmd.RunCommand acCmdSelectAllRecords\n    DoCmd.RunCommand acCmdCopy\n\n    Dim xlapp As Excel.Application\n    Set xlapp = CreateObject(\"Excel.Application\")\n\n    With xlapp\n        .Workbooks.Add\n        .ActiveSheet.PasteSpecial Format:=\"Text\", _\n                                  Link:=False, _\n                                  DisplayAsIcon:= False\n\n        .Cells.Select\n        .Cells.EntireColumn.AutoFit\n        .Visible = True\n        .Range(\"A1\").Select\n\n    End With\n\n    Command13_Click_Exit:\n    Exit Sub\n\n    Command13_Click_Err:\n    MsgBox Error$\n    Resume Command13_Click_Exit\n\nEnd Sub\n</code></pre>\n\n<p><strong>Picture of the UI:</strong>\n<img src=\"https://s22.postimg.org/z7oc9ly0x/Schermafbeelding_2016_09_07_om_11_45_30.png\" alt=\"\"></p>\n\n<p>Somebody got an idea?</p>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1473240240, "post_id": 39365956, "comment_id": 66060477, "body": "<code>chkname</code> is just a string, you need to get the actual control it refers to - why have you defined chkname as an Integer..?"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "reply_to_user": {"reputation": 1202, "user_id": 2039855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tK06O.jpg?s=128&g=1", "display_name": "VladNeacsu", "link": "https://stackoverflow.com/users/2039855/vladneacsu"}, "edited": false, "score": 1, "creation_date": 1473240259, "post_id": 39365956, "comment_id": 66060493, "body": "@VladNeacsu code review is for working code, which this certainly isn&#39;t"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1473240373, "post_id": 39365956, "comment_id": 66060561, "body": "Also, the first sheet you process is Sheet2, as you increment i at the start of the loop and it&#39;s initial value is 1"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6694566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753a8c1a1ca814d6af317164c228a147?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Wieland", "link": "https://stackoverflow.com/users/6694566/jan-wieland"}, "edited": false, "score": 0, "creation_date": 1473251579, "post_id": 39366211, "comment_id": 66067991, "body": "The checkboxes are running on a userform. This code looks like what I&#39;m looking for. Except the sheetname will be raised with each marked checkbox automatically. This in the range &quot;Item_1&quot; &quot;Item_2&quot; etc like the checkboxes."}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 13, "user_id": 6694566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753a8c1a1ca814d6af317164c228a147?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Wieland", "link": "https://stackoverflow.com/users/6694566/jan-wieland"}, "edited": false, "score": 0, "creation_date": 1473251808, "post_id": 39366211, "comment_id": 66068138, "body": "If the checkboxes are on a userform, you should be able to replace the <code>Sheets(sheetname)</code> with your Formname. It was just in case you are using the same worksheet over and over again"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1473240661, "creation_date": 1473240661, "answer_id": 39366211, "question_id": 39365956, "link": "https://stackoverflow.com/questions/39365956/simplify-code-with-loop/39366211#39366211", "title": "Simplify code with loop", "body": "<p>If the checkboxes on the Sheet are ActiveX Controls, you can use this to access the checkboxes:</p>\n\n<pre><code>Sheets(\"sheet1\").OLEObjects(\"chkTest\").Object\n</code></pre>\n\n<p>if you want to change the value of a checkbox, use it like this:</p>\n\n<pre><code>    Sheets(\"sheet1\").OLEObjects(\"chkTest\").Object.Value = True\n</code></pre>\n\n<p>now replace <code>\"sheet1\"</code> with your actual sheet name and change the <code>\"chkTest\"</code> to your string <code>chkname</code></p>\n\n<p>So your complete code should be like this:</p>\n\n<pre><code>Dim i As Integer\nDim sheetname As String\nDim chkname As String\n\nsheetname = \"YOUR SHEETNAME HERE\"\n\nFor i = 1 To ThisWorkbook.Worksheets.Count Step 1\n\n    chkname = \"SheetCheckBox\" &amp; i\n\n    If Sheets(sheetname).OLEObjects(chkname).Object.Visible = False Then Exit Sub\n\n    If Sheets(sheetname).OLEObjects(chkname).Object.Value = True Then\n\n        Sheets(\"Item_\" &amp; i).Select\n        Call Finalize\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6694566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753a8c1a1ca814d6af317164c228a147?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Wieland", "link": "https://stackoverflow.com/users/6694566/jan-wieland"}, "edited": false, "score": 0, "creation_date": 1473251245, "post_id": 39368091, "comment_id": 66067741, "body": "Thanks I will try if I can use this code. Basically I don&#39;t need to get a box printed but I need the routine to run all possible options until the max sheet number which can be 40. (With more I have to add them but that&#39;s no problem). The code runs on a userform by the way."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1473245984, "creation_date": 1473245984, "answer_id": 39368091, "question_id": 39365956, "link": "https://stackoverflow.com/questions/39365956/simplify-code-with-loop/39368091#39368091", "title": "Simplify code with loop", "body": "<p>This should do it.  If <code>finalize</code> isn't called on a worksheet then the reason why is printed to the Immediate Window.</p>\n\n<p><a href=\"https://i.stack.imgur.com/K3UCi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K3UCi.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub ProcessWorkSheets()\n\n    Dim check As MSForms.CHECKBOX\n    Dim i As Integer\n    For i = 1 To Worksheets.Count\n\n        On Error Resume Next\n        Set check = Worksheets(i).OLEObjects(\"SheetCheckBox\" &amp; i).Object\n        On Error GoTo 0\n        If check Is Nothing Then\n            Debug.Print Worksheets(i).Name; \" - Checkbox not found\"\n        Else\n            If check.Visible And check.Value Then\n                Worksheets(i).Select\n                Call Finalize\n            Else\n                Debug.Print Worksheets(i).Name; \" - Checkbox\", \"Visible\", check.Visible, \"Value:\", check.Value\n            End If\n        End If\n\n        Set check = Nothing\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6694566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753a8c1a1ca814d6af317164c228a147?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Wieland", "link": "https://stackoverflow.com/users/6694566/jan-wieland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 39366211, "answer_count": 2, "score": -1, "last_activity_date": 1473245984, "creation_date": 1473240024, "last_edit_date": 1473240133, "question_id": 39365956, "link": "https://stackoverflow.com/questions/39365956/simplify-code-with-loop", "title": "Simplify code with loop", "body": "<p>Hi I'm pretty new at the vba so please don't shoot my code :-).\nI have a set of repaeting code's. I woukld like to simplify this code by using the code name with an increasing number. I can't get it to run. Can someone help me a bit on the road to get this going.\nBelow what I'm trying.\nThe second block is a part of the code now (it's 40 blocks of the same code only increasing the number)</p>\n\n<pre><code>Sub sheet41()\nDim i As Integer\nDim chkname As Integer\nchkname = \"SheetCheckBox\" &amp; i\ni = 1\nDo\n  i = i + 1\n  If chkname.Visible = False Then Exit Sub\n  If chkname.value = True Then\n    Sheets(\"Item_\" &amp; i).Select\n    Call Finalize\n  End If\nLoop Until i = ThisWorkbook.Worksheets.Count\nEnd Sub\n</code></pre>\n\n<p>This is the old code:</p>\n\n<pre><code>Sub Sheet1()\nIf SheetCheckBox1.Visible = False Then Exit Sub\nIf SheetCheckBox1.value = True Then\n  Sheets(\"Item_1\").Select\n  Call Finalize\nEnd If\nEnd Sub\n\nSub Sheet2()\nIf SheetCheckBox2.Visible = False Then Exit Sub\nIf SheetCheckBox2.value = True Then\n  Sheets(\"Item_2\").Select\n  Call Finalize\nEnd If\nEnd Sub\n\nSub Sheet3()\nIf SheetCheckBox3.Visible = False Then Exit Sub\nIf SheetCheckBox3.value = True Then\n  Sheets(\"Item_3\").Select\n  Call Finalize\nEnd If\nEnd Sub\n</code></pre>\n\n<p>As you can see this should be possible to clean I asume.</p>\n"}, {"tags": ["vba", "excel", "optimization", "macros"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473251919, "post_id": 39365841, "comment_id": 66068243, "body": "From the look of this, you may be better off using a SQL statement to update your sheet. It should be fast and be able to handle what you are after, and in my opinion is a cleaner approach. If for nothing else, it&#39;s a good technique to know more about. Here&#39;s an article from MSDN on the topic. <a href=\"https://technet.microsoft.com/en-us/library/ee692882.aspx\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/ee692882.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 3747824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af45cd0dc3eac8e267754d1a23e703e3?s=128&d=identicon&r=PG&f=1", "display_name": "m  e", "link": "https://stackoverflow.com/users/3747824/m-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1473252576, "creation_date": 1473252576, "answer_id": 39370410, "question_id": 39365841, "link": "https://stackoverflow.com/questions/39365841/how-to-optimize-a-macros-which-is-running-on-large-number-of-records/39370410#39370410", "title": "How to optimize a macros which is running on large number of records?", "body": "<p>The main drag in this code is the constant reading and writing out/in the worksheet. If you work with the data in variables, the code will be very fast. In fact, code like yours should finish in seconds (or less) when working this way.</p>\n\n<p>I have drafted an example inspired in one of the subs in your code, it may not work \"out of the box\" as I don't understand your data structure perfectly, but the most important point is: get all the data from the workbook just once and put it back there just once (that was done in the lines with 3 *). The logical operations should be done in memory (with the data stored in variables).</p>\n\n<pre><code>Sub Replace()\n    Dim i, re, s, row_num, col_num, data_initial(), data_final()\n    Dim WS_1 As Worksheet\n\n    'defines the worksheet object\n    Set WS_1 = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    'get where do the data range begins and ends\n    row_num = WS_1.Cells(1, 1).End(xlDown).Row\n    col_num = WS_1.Cells(1, 1).End(xlToRight).Row\n\n    '***dump the data from the worksheet to memory all in once\n    data_initial = WS_1.Cells(1, 1).Resize(Row - 1, col).Value\n\n    'create a blank matrix where the output will be placed\n    ReDim data_final(LBound(data_initial, 1) To UBound(data_initial, 1), LBound(data_initial, 2) To UBound(data_initial, 2))\n\n    'you do your work whith the data, this part may not be coherent since I dont understand your data very well\n    i = 1\n    While i &lt;= UBound(data_initial, 1)\n        If data_initial(i, 22) = \"\" Then\n            data_final(i, 24) = \"\"\n        Else\n            s = 1\n            Do Until data_initial(i, 2) = data_initial(i, 22)\n                s = s + 1\n            Loop\n\n            data_final(i, 24) = data_initial(i, 23)\n\n            i = i + 1\n    Wend\n\n    '***dump the data into the worksheet (again, just once)\n    WS_1.Cells(1, 1).Resize(LBound(data_initial, 1) To UBound(data_initial, 1), LBound(data_initial, 2) To UBound(data_initial, 2)).Value = data_final\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5065506, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153015760475590/picture?type=large", "display_name": "Aman Garg", "link": "https://stackoverflow.com/users/5065506/aman-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473252576, "creation_date": 1473239699, "last_edit_date": 1473242770, "question_id": 39365841, "link": "https://stackoverflow.com/questions/39365841/how-to-optimize-a-macros-which-is-running-on-large-number-of-records", "title": "How to optimize a macros which is running on large number of records?", "body": "<p>I have come up with a macros for populating the Super Manager against employees. I am unable to perform this macros against large sets of data and Excel Hangs. I assume this code isn't quite optimized.</p>\n\n<p>A few Requirements and Pre Requisites:</p>\n\n<ol>\n<li>Manager ID Column will be the first column ie column A and the Employee ID column is the second column ie column B in the sheet.</li>\n<li>Super managers will not be populated in Sheet 1 ie no record of super managers should exist in the Sheet 1 except for their ids mapped against Manager ID of other employees</li>\n<li>Super managers will be populated in Sheet 2 with the same order as in the attached sheet  ie. Super Manager Id | Super Manager Name| Whatever extra data fields needed.</li>\n<li>Once the pre requisites are taken care of please click on \"Macros\" button and run the macros called: Main_Function_SuperManager.</li>\n<li>The super manager details will be listed in column S and T respectively of Sheet 1.</li>\n</ol>\n\n<p>Here is my Macros:</p>\n\n<pre><code>Option Explicit\nSub Main_Function_SuperManager()\nDim i, re\nRoot_Parent\nReplace\nReplace_Name\ni = 1\n    While Cells(i, 22) &lt;&gt; \"\"\n\n         Cells(i, 22) = \"\"\n         Cells(i, 23) = \"\"\n         i = i + 1\n\n    Wend\nEnd Sub\nSub Root_Parent()\n    Dim i, re, k\n    i = 2\n    While Cells(i, 1) &lt;&gt; \"\"\n        Set re = Range(\"B:B\").Find(Cells(i, 1))\n        If re Is Nothing Then\n            Set re = Range(\"V:V\").Find(Cells(i, 1))\n            If re Is Nothing Then\n                k = k + 1\n                Cells(k, 22) = Cells(i, 1)\n                Cells(k, 23) = \"Super Manager\"\n                findchild Cells(k, 22).Value, k\n            End If\n        End If\n        i = i + 1\n    Wend\nEnd Sub\nSub findchild(parent, ByRef k)\n Dim i, s, re\n i = 1\n    While Cells(i, 2) &lt;&gt; \"\"\n    s = i\n        Do\n            Set re = Range(\"B:B\").Find(Cells(s, 1))\n            If re Is Nothing Then\n                If Cells(s, 1) = parent Then\n                k = k + 1\n                Cells(k, 22) = Cells(i, 2)\n                Cells(k, 23) = Cells(s, 1)\n                End If\n                Exit Do\n            Else\n                s = re.Row\n            End If\n        Loop\n        i = i + 1\n    Wend\nEnd Sub\n\nSub Replace()\n    Dim i, re, s\n    i = 2\n    While Cells(i, 22) &lt;&gt; \"\"\n        Set re = Range(\"B:B\").Find(Cells(i, 22))\n        If re Is Nothing Then\n        Cells(10, 24) = \"\"\n        Else\n         s = re.Row\n         Cells(s, 19) = Cells(i, 23)\n        End If\n        i = i + 1\n\n    Wend\nEnd Sub\n\nSub Replace_Name()\n    Dim i, re, s\n    i = 2\n    While Cells(i, 19) &lt;&gt; \"\"\n        Set re = Worksheets(\"Sheet2\").Range(\"A:A\").Find(Cells(i, 19))\n        If re Is Nothing Then\n        Cells(10, 24) = \"\"\n        Else\n         s = re.Row\n         Cells(i, 20) = Worksheets(\"Sheet2\").Cells(s, 2)\n        End If\n        i = i + 1\n\n    Wend\nEnd Sub\n</code></pre>\n\n<p>This code helps me parse down a large list of data and list the highest level root nodes to the child and grand child nodes.</p>\n\n<p>My data structure looks as follows:</p>\n\n<pre><code>MANAGER ID|EMP ID|NAME|GRADE|MANAGER|&lt;some other fields&gt;|SUPER MANAGER ID|SUPER MANAGER NAME\n</code></pre>\n\n<p>Really looking forward to tips to optimize this code such that i can perform the function on large data sets.</p>\n\n<p>In essence I wish to populate the child nodes with their respective highest level roots nodes such that all child nodes have a root level data/parent mapped to them.</p>\n"}, {"tags": ["vba", "if-statement"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473239449, "post_id": 39365584, "comment_id": 66059991, "body": "What do you mean by &quot;not working&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 2, "last_activity_date": 1473240549, "last_edit_date": 1473240549, "creation_date": 1473240026, "answer_id": 39365957, "question_id": 39365584, "link": "https://stackoverflow.com/questions/39365584/complicated-if-with-and-or-operators/39365957#39365957", "title": "Complicated if with and, or operators", "body": "<p>Problem is that And has higher precedence than or. So (strongly abbreviated for visualisation):</p>\n\n<pre><code>If e2 = ns And e3=c And gc=c Or e3=c And gc=r Or e3=r And gc=c\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>If (e2 = ns And e3=c And gc=c) Or (e3=c And gc=r) Or (e3=r And gc=c)\n</code></pre>\n\n<blockquote>\n  <ol>\n  <li>information should always be \"not shared\"</li>\n  </ol>\n</blockquote>\n\n<p>So you need to enforce this for every case, so you have to break above with additional parentheses:</p>\n\n<pre><code>If e2 = ns And ((e3=c And gc=c) Or (e3=c And gc=r) Or (e3=r And gc=c))\n</code></pre>\n\n<p>Like your version, omitting surplus parentheses again:</p>\n\n<pre><code>If e2 = ns And (e3=c And gc=c Or e3=c And gc=r Or e3=r And gc=c)\n</code></pre>\n\n<p>As you got trapped at the precedence point, possibly a good idea to always place parentheses like in third code example. Then you won't miss anything again...</p>\n\n<p>You achieve the same, too, by splitting the If:</p>\n\n<pre><code>If e2 = ns Then\n   If e3=c And gc=c Or e3=c And gc=r Or e3=r And gc=c Then\n</code></pre>\n\n<p>There is an opportunity to optimise and reduce the number of necessary comparisons:</p>\n\n<pre><code>If e2 = ns And (e3=c And (gc=c Or gc=r) Or e3=r And gc=c)\n</code></pre>\n\n<p>(used the unsplitted if...)</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473246487, "creation_date": 1473246487, "answer_id": 39368264, "question_id": 39365584, "link": "https://stackoverflow.com/questions/39365584/complicated-if-with-and-or-operators/39368264#39368264", "title": "Complicated if with and, or operators", "body": "<p>as per your description your test would be passed if:</p>\n\n<ul>\n<li><p>ele.Cells(m, 2) = \"Not Shared\"</p>\n\n<p>AND</p></li>\n<li><p>ele.Cells(m, 3)    OR   gc.Cells(m, 3) = \"Correct\"</p></li>\n</ul>\n\n<p>so you can simply code:</p>\n\n<pre><code>If ele.Cells(m, 2) = \"Not Shared\" And (ele.Cells(m, 3) = \"Correct\" Or gc.Cells(m, 3) = \"Correct\") Then\n</code></pre>\n\n<p>furthermore, being them all strings you could use the following alternative approach:</p>\n\n<pre><code>Dim corrStrng As String\n\nl = 2\nFor m = 2 To ElecRow\n    corrStrng = \"|\" &amp; ele.Cells(m, 3) &amp; \"|\" &amp; gc.Cells(m, 3) &amp; \"|\" '&lt;--| concatenate two strings into one\n    If ele.Cells(m, 2) = \"Not Shared\" And InStr(corrStrng, \"|Correct|\") &gt; 0 Then '&lt;--| use Instr() to check if substring \"|Correct|\" is inside the concatenated word \n</code></pre>\n\n<p>where you use <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264811(v=office.15).aspx\" rel=\"nofollow\"><code>Instr()</code> function</a> to check if substring \"|Correct|\" is inside the concatenated word, i.e. if either one of the two <em>parent</em> cells content was \"Correct\" precisely</p>\n"}], "owner": {"reputation": 3, "user_id": 6603236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d4BbdEIVLQw/AAAAAAAAAAI/AAAAAAAABHA/wW0Et00lEB0/photo.jpg?sz=128", "display_name": "Iaroslav", "link": "https://stackoverflow.com/users/6603236/iaroslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 39365957, "answer_count": 2, "score": 0, "last_activity_date": 1473246487, "creation_date": 1473238987, "question_id": 39365584, "link": "https://stackoverflow.com/questions/39365584/complicated-if-with-and-or-operators", "title": "Complicated if with and, or operators", "body": "<p>*I want to create if statement, which would copy a value from one sheet to another if conditions are met. Logical test should be as following: \n 1. information should always be \"not shared\" \n 2. information should be \"correct\" and \"correct\" OR \"correct\" and \"wrong\" OR \"wrong\" and \"correct\"\nBelow you may see the code with which I came so far:</p>\n\n<pre><code>    l = 2\nFor m = 2 To ElecRow\n    If ele.Cells(m, 2) = \"Not Shared\" And _\n           ele.Cells(m, 3) = \"Correct\" And gc.Cells(m, 3) = \"Correct\" _\n        Or ele.Cells(m, 3) = \"Correct\" And gc.Cells(m, 3) = \"Reading is wrong\" _\n        Or ele.Cells(m, 3) = \"Reading is wrong\" And gc.Cells(m, 3) = \"Correct\" Then\n    For i = k + 4 To f + 4\n    Selegas.Cells(l, 2).Value = ele.Cells(m, i).Value\n    Selegas.Cells(l, 4).Interior.Color = RGB(179, 182, 184)\n    l = l + 1\n    Next i\n    End If\nNext m\n</code></pre>\n\n<p>However, the code is not working. Do you have any suggestions?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473253792, "post_id": 39365442, "comment_id": 66069663, "body": "instead of changing the links, you can change the source book from Data &gt; Edit Links &gt; Change Source <a href=\"https://support.office.com/en-us/article/Open-or-change-source-workbooks-of-external-references-links-ae3e687c-97ae-4d9b-b684-8756a5301253\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6803728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oqXr6aNyP-8/AAAAAAAAAAI/AAAAAAAAABg/DFmw5yM6ZRY/photo.jpg?sz=128", "display_name": "Mohamad Khair", "link": "https://stackoverflow.com/users/6803728/mohamad-khair"}, "edited": false, "score": 0, "creation_date": 1473388453, "post_id": 39367561, "comment_id": 66131624, "body": "at first i did try supplying the workbooks path. But then this code will only works on that month only. (i.e. September workbook to October workbook) I need it to be able to work for every month. That y i used dialog, to pick the current month workbook.  and for the loop n array code.. Thanks a lot!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 6803728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oqXr6aNyP-8/AAAAAAAAAAI/AAAAAAAAABg/DFmw5yM6ZRY/photo.jpg?sz=128", "display_name": "Mohamad Khair", "link": "https://stackoverflow.com/users/6803728/mohamad-khair"}, "edited": false, "score": 0, "creation_date": 1473400591, "post_id": 39367561, "comment_id": 66134737, "body": "@MohamadKhair I updated my answer to include a file dialog.  Personally,  I would add a button that would generate the next months workbook from the current workbook.  In this way, every workbook would be saved in a predictable folder with a predictable name.  It&#39;ll make further modifications much easier."}, {"owner": {"reputation": 3, "user_id": 6803728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oqXr6aNyP-8/AAAAAAAAAAI/AAAAAAAAABg/DFmw5yM6ZRY/photo.jpg?sz=128", "display_name": "Mohamad Khair", "link": "https://stackoverflow.com/users/6803728/mohamad-khair"}, "edited": false, "score": 0, "creation_date": 1473412868, "post_id": 39367561, "comment_id": 66140947, "body": "That it.. Thanks a lot! Its work!  Yes i do plan to do it as you suggest, from the current workbook to create new workbook. But i always stuck on how to use the file i selected as a path for the loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 6803728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oqXr6aNyP-8/AAAAAAAAAAI/AAAAAAAAABg/DFmw5yM6ZRY/photo.jpg?sz=128", "display_name": "Mohamad Khair", "link": "https://stackoverflow.com/users/6803728/mohamad-khair"}, "edited": false, "score": 0, "creation_date": 1473413053, "post_id": 39367561, "comment_id": 66141053, "body": "Awesome!  Glad that I could help :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1473400417, "last_edit_date": 1473400417, "creation_date": 1473244534, "answer_id": 39367561, "question_id": 39365442, "link": "https://stackoverflow.com/questions/39365442/using-macros-in-excel-to-hyperlink-lots-of-data-and-work-across-workbook/39367561#39367561", "title": "Using Macros in Excel to hyperlink lots of data and work across workbook", "body": "<p>You can avoid the file dialog altogether by supplying the workbooks path.</p>\n\n<p>I refactored your code so that the cells links are added as array formulas.  This simplifies the code and makes it harder for someone to inadvertently change a formula. </p>\n\n<pre><code>Sub LinkLastMonth()\n    Dim x As Long\n    Dim Path As String, FileName As String\n    Dim fDialog As FileDialog, result As Integer\n    Set fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n    'Optional: FileDialog properties\n    fDialog.AllowMultiSelect = False\n    fDialog.Title = \"Select a file\"\n    fDialog.InitialFileName = Environ(\"USERPROFILE\") &amp; \"\\Dropbox\\On the go ordering\"\n    'Optional: Add filters\n    fDialog.Filters.Clear\n    fDialog.Filters.Add \"Excel files\", \"*.xls, *.xlsx, *.xlsm\"\n    fDialog.Filters.Add \"All files\", \"*.*\"\n\n    'Show the dialog. -1 means success!\n    If fDialog.Show = -1 Then\n        x = InStrRev(fDialog.SelectedItems(1), \"\\\")\n        Path = Left(fDialog.SelectedItems(1), x)\n        FileName = Right(fDialog.SelectedItems(1), Len(fDialog.SelectedItems(1)) - x)\n\n        If Right(Path, 1) &lt;&gt; \"\\\" Then Path = Path &amp; \"\\\"\n\n        For x = 3 To 30 Step 3\n\n            Rows(x).Columns(\"N:T\").FormulaArray = \"='\" &amp; Path &amp; \"[\" &amp; FileName &amp; \"]Data Input'!\" &amp; Rows(x).Columns(\"C:I\").Address\n\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6803728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oqXr6aNyP-8/AAAAAAAAAAI/AAAAAAAAABg/DFmw5yM6ZRY/photo.jpg?sz=128", "display_name": "Mohamad Khair", "link": "https://stackoverflow.com/users/6803728/mohamad-khair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 39367561, "answer_count": 1, "score": 0, "last_activity_date": 1473400417, "creation_date": 1473238582, "question_id": 39365442, "link": "https://stackoverflow.com/questions/39365442/using-macros-in-excel-to-hyperlink-lots-of-data-and-work-across-workbook", "title": "Using Macros in Excel to hyperlink lots of data and work across workbook", "body": "<p><a href=\"http://i.stack.imgur.com/AWZjP.png\" rel=\"nofollow\">Example Table</a></p>\n\n<p>Each month i have to create new workbook and copy across all the data to the new workbook manually. All the data are hyperlink to the previous month data. I try to create a button for this task.</p>\n\n<p>This is what i got so far..</p>\n\n<pre><code>Sub Macro1()\n\n'open a new file template\nWorkbooks.Open Filename:= _\n    \"C:\\Users\\ACER\\Google Drive\\A.C status\\A.C STATUS MASTER FILE.xlsm\"\nActiveWindow.WindowState = xlNormal\nWith ActiveWindow\n    .Top = 14.5\n    .Left = 625.75\nEnd With\n\nRange(\"N3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C3\"\nRange(\"O3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C4\"\nRange(\"P3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C5\"\nRange(\"Q3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C6\"\nRange(\"R3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C7\"\nRange(\"S3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C8\"\nRange(\"T3\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R3C9\"\nRange(\"N6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C3\"\nRange(\"O6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C4\"\nRange(\"P6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C5\"\nRange(\"Q6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C6\"\nRange(\"R6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C7\"\nRange(\"S6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C8\"\nRange(\"T6\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R6C9\"\nRange(\"N9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C3\"\nRange(\"O9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C4\"\nRange(\"P9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C5\"\nRange(\"Q9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C6\"\nRange(\"R9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C7\"\nRange(\"S9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C8\"\nRange(\"T9\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R9C9\"\nRange(\"N12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C3\"\nRange(\"O12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C4\"\nRange(\"P12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C5\"\nRange(\"Q12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C6\"\nRange(\"R12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C7\"\nRange(\"S12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C8\"\nRange(\"T12\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R12C9\"\nRange(\"N15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C3\"\nRange(\"O15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C4\"\nRange(\"P15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C5\"\nRange(\"Q15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C6\"\nRange(\"R15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C7\"\nRange(\"S15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C8\"\nRange(\"T15\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R15C9\"\nRange(\"N18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C3\"\nRange(\"O18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C4\"\nRange(\"P18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C5\"\nRange(\"Q18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C6\"\nRange(\"R18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C7\"\nRange(\"S18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C8\"\nRange(\"T18\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R18C9\"\nRange(\"N21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C3\"\nRange(\"O21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C4\"\nRange(\"P21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C5\"\nRange(\"Q21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C6\"\nRange(\"R21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C7\"\nRange(\"S21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C8\"\nRange(\"T21\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R21C9\"\nRange(\"N24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C3\"\nRange(\"O24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C4\"\nRange(\"P24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C5\"\nRange(\"Q24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C6\"\nRange(\"R24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C7\"\nRange(\"S24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C8\"\nRange(\"T24\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R24C9\"\nRange(\"N27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C3\"\nRange(\"O27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C4\"\nRange(\"P27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C5\"\nRange(\"Q27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C6\"\nRange(\"R27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C7\"\nRange(\"S27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C8\"\nRange(\"T27\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R27C9\"\nRange(\"N30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C3\"\nRange(\"O30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C4\"\nRange(\"P30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C5\"\nRange(\"Q30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C6\"\nRange(\"R30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C7\"\nRange(\"S30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C8\"\nRange(\"T30\").Select\nActiveCell.FormulaR1C1 = \"='[wksData]Data Input'!R30C9\"\n\nActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Users\\ACER\\Google Drive\\A.C status\\A.C STATUS.xlsm\", FileFormat:= _\n    xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\nEnd Sub\n</code></pre>\n\n<p>Originally \"wksData\" are the name file that i need to copy from.. i change it to \"wksData\" so that this code will work on difference workbook. Excel will ask user to choose a file to be \"wksData\". </p>\n\n<p><a href=\"http://i.stack.imgur.com/L3AiA.png\" rel=\"nofollow\">enter image description here</a></p>\n\n<p>But, the problem is, each time the code reach \"wksData\" excel will ask me again and again.. how to make it only ask once?</p>\n"}, {"tags": ["string", "vba", "copy"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473239271, "post_id": 39365406, "comment_id": 66059892, "body": "It should be <code>Set FindIDcol = ...</code>. That should give you an error message though. That said, wouldn&#39;t <code>FindIFcol</code>and <code>IDcol</code> be the same (unless there are duplicate IDs)?"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473239687, "post_id": 39365406, "comment_id": 66060132, "body": "IDcolumn has always shown the value of the cell, so the ID. Which meant I was working with. i.e. &quot;A300743&quot; for the first ID. That&#39;s why I started using the IDcolLetter and IDrowNumber with splitting the Address. I will try the Set. Thank you already!"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473240238, "post_id": 39365406, "comment_id": 66060472, "body": "Your tip, together with two changes in the Splitting made it work! :) If you write your comment as a seperate answer, I will be able to upvote you."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473240290, "post_id": 39365406, "comment_id": 66060514, "body": "My point was that you take the ID (actually the cell that contains the ID) from the first row, then you search for the ID in the first row, what&#39;s the point of that?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473240568, "post_id": 39365406, "comment_id": 66060693, "body": "You don&#39;t need the column letters. You can set ranges using the first and last cell, so <code>.Range(.Cells(1, 1),  .Cells(1, lastcol))</code>. Also use <code>Option Explicit</code> to prevent typos."}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473243912, "post_id": 39365406, "comment_id": 66062758, "body": "Because I did not know any other way to get the cell address, so that I can split it later. The first time I take the ID cell, it is just to define a range."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473244325, "post_id": 39365406, "comment_id": 66063042, "body": "But <code>IDcolumn</code> is a (single cell) range and then <code>FindIDcol</code> will be the exact same cell so why not just use <code>IDcolumn</code>?"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473245059, "post_id": 39365406, "comment_id": 66063518, "body": "Aaah, now I get what you mean. Indeed, I deleted These two doublings and am now directly referring to IDcolumn and IDrow and it still works. Thank you for your effort! :)"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1473245308, "creation_date": 1473245308, "answer_id": 39367847, "question_id": 39365406, "link": "https://stackoverflow.com/questions/39365406/vba-copy-split-elements-of-vertically-saved-strings-to-another-sheet-in-horizont/39367847#39367847", "title": "VBA Copy split elements of vertically saved strings to another sheet in horizontal manner", "body": "<p>standing your shown data <em>structure</em> and if I correctly interpreted your goal, you can simplify your code as follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim wsOutput As Worksheet\n    Dim colCell As Range, rowCell As Range\n    Dim outputRow As Long\n\n    Set wsOutput = Worksheets(\"Output\") '&lt;--| change \"Output\" to your actual output sheet name\n    outputRow = 2 '&lt;--| initialize output row to 2 (row 1 is for headers)\n\n    With Worksheets(\"Input\") '&lt;--| reference input sheet (change \"Input\" to your actual input sheet name)\n        For Each colCell In .Range(\"A1\", .Cells(1, .Columns.Count).End(xlToLeft)).SpecialCells(XlCellType.xlCellTypeConstants) '&lt;--| iterate over its row 1 non blank cells\n            For Each rowCell In .Range(colCell.Offset(1), colCell.End(xlDown)) '&lt;--| iterate over current column rows from row 2 down to last contiguous non empty one\n                wsOutput.Cells(outputRow, 1) = colCell.Value '&lt;--| write ID in column 1 of current output row\n                wsOutput.Cells(outputRow, 2).Resize(, 3) = Split(rowCell.Value, \"\\\") '&lt;--| write other info from column 2 rightwards of current output row\n                outputRow = outputRow + 1 '&lt;--| update output row\n            Next rowCell\n        Next colCell\n    End With\nEnd Sub\n</code></pre>\n\n<p>should you deal with input sheet non contiguous data below any ID (blank cells) or ID with no data below, there would be needed a few changes </p>\n"}], "owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 39367847, "answer_count": 1, "score": 0, "last_activity_date": 1473245308, "creation_date": 1473238475, "question_id": 39365406, "link": "https://stackoverflow.com/questions/39365406/vba-copy-split-elements-of-vertically-saved-strings-to-another-sheet-in-horizont", "title": "VBA Copy split elements of vertically saved strings to another sheet in horizontal manner", "body": "<p>I am looking to save the vertically saved Information for each ID (row 1) from this Worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/y6q0S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y6q0S.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>To another Worksheet, which Looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yRVil.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRVil.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For each column, with the ID in row 1, there are skills saved as strings. Each part (there are 3) is supposed to be saved on the second Worksheet in column B,C and D, respectively. </p>\n\n<p>With the code I will post below, there is no Error. It simply doesn't do anything. When using a stop in the code, the problem seems to be that the items ID's I am trying to find (FindIDcol, FindIDrow) are simply \"Nothing\". </p>\n\n<p>I am very new to VBA and might have a way too complicated Approach or ineffective code. However, I hope one of you can help me out here.</p>\n\n<p>Thank you in advance for your help!</p>\n\n<p>Here my code:</p>\n\n<pre><code>Dim wsInput As Worksheet\nSet wsInput = ActiveWorkbook.Worksheets(\"Supplier Skills\")\nDim wsOutput As Worksheet\nSet wsOutput = ActiveWorkbook.Worksheets(\"Search Skills\")\n\nDim IDcolumn As Range\nDim IDrow As Range\nDim lastcol As Integer\nDim lastRow As Integer\nDim NextRow As Integer\nDim FindIDcol As Range\nDim FindIDrow As Range\n\nWith wsInput\n    lastcol = .Cells(1, Columns.Count).End(xlToLeft).Column\n    LastColLetter = Split(Cells(1, lastcol).Address(True, False), \"$\")(0)\n\n    'For every column on Input-Sheet with Data\n    For Each IDcolumn In wsInput.Range(\"A1:\" &amp; LastColLetter &amp; \"1\")\n\n        'Firstly, find each ID column\n        FindIDcol = wsInput.Range(\"A1:\" &amp; LastColLetter &amp; \"1\").Find(What:=IDcolumn, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n        If Not FindIDcol Is Nothing Then\n\n            'Secondly, get the respective column Letter\n            IDcolLetter = Split(FindIDcol.Address, \"$\")(0)\n\n                'Thirdly, find all skills saved in rows beneath this column\n                lastRow = .Range(IDcolLetter &amp; .Rows.Count).End(xlUp).row\n                For Each IDrow In wsInput.Range(IDcolLetter &amp; \"1:\" &amp; IDcolLetter &amp; lastRow)\n\n                    'Fourthly, get the respective row-number for each skill\n                    FindIDrow = wsInput.Range(IDcolLetter &amp; \"2:\" &amp; IDcolLetter &amp; lastRow).Find(What:=IDrow, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n                    IDrowNumber = Split(FindIDrow.Address, \"$\")(1)\n\n                    'Fifthly, split the strings in 3 parts\n                    Dim myElements() As String\n                    myElements = Split(wsInput.Range(IDcolLetter &amp; IDrowNumber).value, \"\\\")\n\n                    'Sixthly, for every skill of that supplier, copy the ID in A, CG in B, Category in C and Product in D\n                    NextRow = wsOutput.Range(\"A\" &amp; Rows.Count).End(xlUp).row + 1\n\n                    wsInput.Range(IDcolLetter &amp; \"1\").Copy Destination:=wsOutput.Range(\"A\" &amp; NextRow) 'ID\n                    wsOutput.Range(\"B\" &amp; NextRow) = myElements(0)                                 'Commodity Group\n                    wsOutput.Range(\"C\" &amp; NextRow) = myElements(1)                                 'Category\n                    wsOutput.Range(\"D\" &amp; NextRow) = myElements(2)                                 'Product\n\n                Next IDrow\n\n        End If\n\n    Next IDcolumn\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "edited": false, "score": 0, "creation_date": 1473319719, "post_id": 39365958, "comment_id": 66096928, "body": "Should this work by itself cause I&#180;ve tried it in my workbook and  in a new one but nothing happens, what am I doing wrong?"}, {"owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "edited": false, "score": 0, "creation_date": 1473321357, "post_id": 39365958, "comment_id": 66097882, "body": "When i run this I end up with a new sheet, &quot;Test Data&quot; written in C3:D6;F3G6;I3.J6 and a selection of A1:Z20"}, {"owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "edited": false, "score": 0, "creation_date": 1473323281, "post_id": 39365958, "comment_id": 66098945, "body": "Wow! thank you for your patience, after looking at the code for a while I&#180;m close to understanding it and after a couple tests and edits maybe I&#180;ll do, but the end result of this is exactly what I was after. Thank you!"}, {"owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "edited": false, "score": 0, "creation_date": 1473325689, "post_id": 39365958, "comment_id": 66100344, "body": "I&#180;ve done some test runs with it now and ran into a problem, if one of the areas with content is longer than the others It will not be included unless it&#180;s the last one. If I for example have content in C3:D10;F3:F7;I3:J7 I&#180;ll end up with B2:K8 what I would want it to be is B2:K11 any suggestions ? :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1473327462, "last_edit_date": 1473327462, "creation_date": 1473240027, "answer_id": 39365958, "question_id": 39365291, "link": "https://stackoverflow.com/questions/39365291/extend-range-from-active-cells-in-four-directions-vba-excel/39365958#39365958", "title": "Extend range from active cells in four directions vba excel", "body": "<p>Anything is possible</p>\n\n<p><a href=\"https://i.stack.imgur.com/tvrT5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tvrT5.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TestResizeAndMergeAreas()\n    Dim r As Range\n\n    Worksheets.Add\n\n    Range(\"C3:D6,F3:G6,I3:J6\").Value = \"Test Data\"\n\n    Range(\"A1:Z20\").Select\n\n    On Error Resume Next\n    Set r = Selection.SpecialCells(xlCellTypeConstants, 23)\n    On Error GoTo 0\n\n    If Not r Is Nothing Then\n        Debug.Print \"Before:\", r.Address\n\n        ResizeAndMergeAreas r, -1, 1, -1, 1\n\n        Debug.Print \"After:\", r.Address\n    End If\n\n    r.Select\nEnd Sub\n\nSub ResizeAndMergeAreas(ByRef Target As Range, x1 As Long, x2 As Long, y1 As Long, y2 As Long)\n    Dim rArea As Range\n\n    For Each rArea In Target\n        Set Target = Range(Target, rArea)\n    Next\n\n    Set Target = Target.Offset(x1, y1).Resize(Target.Rows.Count + x2 + (x1 * -1), Target.Columns.Count + y2 + (y1 * -1))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473327462, "creation_date": 1473238188, "last_edit_date": 1531164843, "question_id": 39365291, "link": "https://stackoverflow.com/questions/39365291/extend-range-from-active-cells-in-four-directions-vba-excel", "title": "Extend range from active cells in four directions vba excel", "body": "<p>I\u00b4ve managed to select a range with content by using this: </p>\n\n<p><code>Selection.SpecialCells(xlCellTypeConstants, 23).Select</code></p>\n\n<p>Now i want to extend that range in four directions, probably with a Offset function. For example I want the range selection C3:D6 to become B2:E7.</p>\n\n<p>And if possible C3:D6;F3:G6;I3:J6 to become B2:K7 somehow</p>\n"}, {"tags": ["vba", "ms-word", "fieldcodes"], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1474187944, "creation_date": 1474187944, "answer_id": 39555695, "question_id": 39364982, "link": "https://stackoverflow.com/questions/39364982/is-it-possible-to-use-vba-functions-in-word-field-codes/39555695#39555695", "title": "Is it possible to use VBA functions in Word field codes?", "body": "<p>Word doesn't allow you to use VBA functions in a field.</p>\n\n<p>One common approach is to use a field with a <code>DocVariable</code>, and have some VBA that is triggered by a button press or a document event, that sets the value of the variable to the result of a function, and then refreshes the field value.</p>\n\n<p>First, add a <code>DOCVARIABLE</code> field to your document:</p>\n\n<blockquote>\n  <p>My function returns \u2018<code>DOCVARIABLE  MyFuncResult \\* MERGEFORMAT</code>\u2019!</p>\n</blockquote>\n\n<p>Then add this VBA:</p>\n\n<pre><code>Option Explicit\n\nPrivate Function Foo() As String\n  Foo = \"BAR\"\nEnd Function\n\nPublic Sub setvar()\n\n  Const MYVAR As String = \"MyFuncResult\"\n\n  Dim var As Variable\n\n  On Error Resume Next\n  Set var = ThisDocument.Variables(MYVAR)\n  On Error GoTo 0\n\n  If var Is Nothing Then\n    Set var = ThisDocument.Variables.Add(MYVAR)\n  End If\n\n  var.Value = Foo\n\n  ThisDocument.Fields.Update\n\nEnd Sub\n</code></pre>\n\n<p>And you should see the document content as:</p>\n\n<blockquote>\n  <p>My function returns \u2018BAR\u2019!</p>\n</blockquote>\n"}], "owner": {"reputation": 5452, "user_id": 64082, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/073bae7634991aac9fa7ec92059c7fc7?s=128&d=identicon&r=PG", "display_name": "Svein Bringsli", "link": "https://stackoverflow.com/users/64082/svein-bringsli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1818, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1474187944, "creation_date": 1473237241, "last_edit_date": 1473238805, "question_id": 39364982, "link": "https://stackoverflow.com/questions/39364982/is-it-possible-to-use-vba-functions-in-word-field-codes", "title": "Is it possible to use VBA functions in Word field codes?", "body": "<p>I have a Word document with some functions. I want to access these functions in formula fields, but this was harder than anticipated.  </p>\n\n<p>Let's say I have a function defined as </p>\n\n<pre><code>Public Function Area(R As Double) As Double\n  Area = 3.14 * R * R\nEnd Function\n</code></pre>\n\n<p>and that I want to use this in a field, like this</p>\n\n<pre><code>{ = Area(RadiusBookmark) }\n</code></pre>\n\n<p>This seems pretty straight forward, but I get a syntax error. If I omit the parameter, like this</p>\n\n<pre><code>{ = Area }\n</code></pre>\n\n<p>I get an \"undefined bookmark\" error, which leads me to believe that only bookmarks are available to the formula code fields.</p>\n"}, {"tags": ["vba", "excel", "date", "macros"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1473237608, "post_id": 39364736, "comment_id": 66058872, "body": "It&#39;s recommended to not use <code>Select</code> as it slows down subroutines. Instead of using <code>Columns(&quot;C:C&quot;).Select</code> and <code>Selection.NumberFormat = &quot;dd&#47;mm&#47;yyyy&quot;</code> you can just use: <code>Columns(&quot;C:C&quot;).NumberFormat = &quot;dd&#47;mm&#47;yyyy&quot;</code> similarly you can just use <code>Columns(&quot;C:C&quot;).Insert Shift:=xlToRight</code> in the first line of your code."}], "answers": [{"tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 2, "last_activity_date": 1473236875, "creation_date": 1473236875, "answer_id": 39364855, "question_id": 39364736, "link": "https://stackoverflow.com/questions/39364736/how-to-edit-the-date-column-in-excel-using-macros-to-get-it-to-the-common-format/39364855#39364855", "title": "How to edit the date column in excel using macros to get it to the common format &quot;dd/mm/yyyy&quot;", "body": "<p>I believe the problem is here:  </p>\n\n<pre><code>d = Cells(i, 2).Value ' here you set d as the variable\na = CDate(d)  ' at this point a is the current variable\nCells(i, 3) = FormatDateTime(d, 2) ' and here you use d again. \n</code></pre>\n\n<p>I think you need to replace the <code>d</code> with <code>a</code> in the FormatDateTime.  </p>\n\n<p>The CDate() converts a value to a date.<br>\nThe FormateDateTime() needs a date-value to function. <code>d</code> is not a date-value.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1473238131, "creation_date": 1473238131, "answer_id": 39365274, "question_id": 39364736, "link": "https://stackoverflow.com/questions/39364736/how-to-edit-the-date-column-in-excel-using-macros-to-get-it-to-the-common-format/39365274#39365274", "title": "How to edit the date column in excel using macros to get it to the common format &quot;dd/mm/yyyy&quot;", "body": "<p>The problem is that the standard format is <code>\"mm/dd/yyyy\"</code> not  <code>\"dd/mm/yyyy\"</code>.  When you try and convert <code>\"dd/mm/yyyy\"</code> to a standard datevalue you have to swap the days and months.   </p>\n\n<p>This function will only handle date values.</p>\n\n<pre><code>Function FixDDMMYYYY(DateString As String) As Date\n    Dim arDateParts() As String\n\n    If InStr(DateString, \".\") Then\n        arDateParts = Split(DateString, \".\")\n    ElseIf InStr(DateString, \"-\") Then\n        arDateParts = Split(DateString, \"-\")\n    End If\n\n    On Error Resume Next\n        FixDDMMYYYY = DateSerial(arDateParts(2), arDateParts(1), arDateParts(0))\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6803443, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeYV7.jpg?s=128&g=1", "display_name": "Sangeetha", "link": "https://stackoverflow.com/users/6803443/sangeetha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473238131, "creation_date": 1473236486, "last_edit_date": 1473236720, "question_id": 39364736, "link": "https://stackoverflow.com/questions/39364736/how-to-edit-the-date-column-in-excel-using-macros-to-get-it-to-the-common-format", "title": "How to edit the date column in excel using macros to get it to the common format &quot;dd/mm/yyyy&quot;", "body": "<p>The question is related to date &amp; time. I was trying to create a macro in excel for editing the date column to change all the dates previously entered to  the common format \"dd/mm/yyyy\". But when the date is separated using \".\" or \"-\" it is not being identified as a date. Tried replacing the separators to \"/\",and then the date was considered from right to left.\nThe macro I tried is as given below:</p>\n\n<pre><code>Sub Date_Edit() \n\nColumns(\"C:C\").Select\nSelection.Insert Shift:=xlToRight\nSheets(1).Range(\"B1:B1000\").Replace \".\", \"/\"\n\nFor i = 2 To 1000                                        \n    d = Cells(i, 2).Value\n    a = CDate(d)\n    Cells(i, 3) = FormatDateTime(d, 2)\nNext i\n\nColumns(\"C:C\").Select\nSelection.NumberFormat = \"dd/mm/yyyy\"  \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1473235031, "post_id": 39363527, "comment_id": 66057287, "body": "Comboboxes allow you to select a record. there is a wizard."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473239246, "post_id": 39363527, "comment_id": 66059883, "body": "@Lucas: as you can see from the discussions below, your question is kinda unclear. What exactly do you want to fill? Unbound controls? Bound controls -- in table Products or another table (but then you would duplicate data... bad.) ?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473233443, "post_id": 39363741, "comment_id": 66056409, "body": "The OP&#39;s did not include VB.Net in his tags."}, {"owner": {"reputation": 247, "user_id": 4515587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1561339194/picture?type=large", "display_name": "Lucas Frugier", "link": "https://stackoverflow.com/users/4515587/lucas-frugier"}, "edited": false, "score": 0, "creation_date": 1473234022, "post_id": 39363741, "comment_id": 66056725, "body": "yep, that&#39;s vba"}, {"owner": {"reputation": 1168, "user_id": 6796061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HXcoD.jpg?s=128&g=1", "display_name": "George Kerwood", "link": "https://stackoverflow.com/users/6796061/george-kerwood"}, "edited": false, "score": 0, "creation_date": 1473234971, "post_id": 39363741, "comment_id": 66057263, "body": "Apologies.  Is it not simply a case of linking a cell then?  <a href=\"http://www.excel-easy.com/vba/examples/combo-box.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/combo-box.html</a>  Create yourself a proxy cell to hold the value then reference your selection from the table?"}, {"owner": {"reputation": 247, "user_id": 4515587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1561339194/picture?type=large", "display_name": "Lucas Frugier", "link": "https://stackoverflow.com/users/4515587/lucas-frugier"}, "edited": false, "score": 0, "creation_date": 1473235838, "post_id": 39363741, "comment_id": 66057761, "body": "nop, i need to  Auto fill fields based on selection in Combo Box from the same table"}, {"owner": {"reputation": 1168, "user_id": 6796061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HXcoD.jpg?s=128&g=1", "display_name": "George Kerwood", "link": "https://stackoverflow.com/users/6796061/george-kerwood"}, "edited": false, "score": 0, "creation_date": 1473236848, "post_id": 39363741, "comment_id": 66058400, "body": "So that I understand;  You have a ComboBox whose input range is configured from one area of a table, and you want it&#39;s selection to auto update other values in the same table?"}], "tags": [], "owner": {"reputation": 1168, "user_id": 6796061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HXcoD.jpg?s=128&g=1", "display_name": "George Kerwood", "link": "https://stackoverflow.com/users/6796061/george-kerwood"}, "is_accepted": false, "score": -1, "last_activity_date": 1473233279, "creation_date": 1473233279, "answer_id": 39363741, "question_id": 39363527, "link": "https://stackoverflow.com/questions/39363527/automatically-fill-fields-using-a-drop-down-list/39363741#39363741", "title": "automatically fill fields using a drop-down list", "body": "<p>Easiest way will be just to create yourself a myComboBox_SelectionChanged() event. Then within your method assign the values where you want them.</p>\n\n<pre><code>Private Sub myComboBox_SelectionChanged(sender As Object, e As SelectionChangedEventArgs) Handles myComboBox.SelectionChanged\n\n     // Exact the selection here and put it in your table.\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1473236836, "post_id": 39364760, "comment_id": 66058387, "body": "I am not sure why you would want to do this when the controls can have a control source set and be filled in automatically on selecting a record via the dropdown."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1473237000, "post_id": 39364760, "comment_id": 66058494, "body": "I assumed he wants to fill data into a new record (not table Products), not select an existing record. @Fionnuala"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1473238809, "post_id": 39364760, "comment_id": 66059601, "body": "&quot;Datas in the fields are also from the table products&quot; suggest to me that it is a simple look-up. I think we have insufficient information :)"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1473236576, "creation_date": 1473236576, "answer_id": 39364760, "question_id": 39363527, "link": "https://stackoverflow.com/questions/39363527/automatically-fill-fields-using-a-drop-down-list/39364760#39364760", "title": "automatically fill fields using a drop-down list", "body": "<p>If your combobox row source is</p>\n\n<pre><code>SELECT ProdID, ProdName, ProdColor FROM Products\n</code></pre>\n\n<p>and column widths 0;3;0 (i.e. only ProdName is visible), you can use the AfterUpdate event to copy data from the combobox columns to other controls.</p>\n\n<pre><code>Private Sub cboProduct_AfterUpdate()\n\n    Me!txtID = Me!cboProduct.Column(0)\n    Me!txtColor = Me!cboProduct.Column(2)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 4515587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1561339194/picture?type=large", "display_name": "Lucas Frugier", "link": "https://stackoverflow.com/users/4515587/lucas-frugier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593957982, "creation_date": 1473232636, "last_edit_date": 1593957982, "question_id": 39363527, "link": "https://stackoverflow.com/questions/39363527/automatically-fill-fields-using-a-drop-down-list", "title": "automatically fill fields using a drop-down list", "body": "<p>I have a combo box which is linked with a table (products) and i need to fill fields automatically when the user select a value.\nDatas in the fields are also from the table products.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1473492752, "post_id": 39363144, "comment_id": 66171696, "body": "This question is an instance of my stupidity but of course I thank for upvotes :-) I had used the statement which is the condition of if statement in the question without tilde in an complex logical statement and I had not understand that the false result had come from another component of that logical statement; so \u0131 had thought that the correct writing is wrong by mistake."}], "answers": [{"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": true, "score": 6, "last_activity_date": 1473231882, "creation_date": 1473231882, "answer_id": 39363272, "question_id": 39363144, "link": "https://stackoverflow.com/questions/39363144/how-can-an-asterisk-be-found-in-a-string-using-instr-function/39363272#39363272", "title": "How can an asterisk be found in a string using InStr function?", "body": "<p>get rid of <code>~</code> for <code>*</code> you dont need anything special.</p>\n\n<pre><code>Sub testss()\n\n    Dim str As String\n\n    str = \"test*name\"\n\n    '/ Returns 0\n    MsgBox InStr(1, str, \"~*\", vbTextCompare)\n\n    '/ Returns 5\n    MsgBox InStr(1, str, \"*\", vbTextCompare)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 3, "last_activity_date": 1511022845, "last_edit_date": 1511022845, "creation_date": 1473234071, "answer_id": 39363984, "question_id": 39363144, "link": "https://stackoverflow.com/questions/39363144/how-can-an-asterisk-be-found-in-a-string-using-instr-function/39363984#39363984", "title": "How can an asterisk be found in a string using InStr function?", "body": "<p><code>~*</code> is used to find <code>*</code> in <code>Range.Find</code> and <code>Range.Replace</code> (same in Excel's Find and Replace dialogs).  </p>\n\n<p>You can also use <code>InStrRev</code> to search in reverse order starting from the end of the string.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/like-operator\" rel=\"nofollow noreferrer\"><code>Like</code> operator</a> can also be used with <code>[*]</code> to check if a string ends with <code>*</code> :</p>\n\n<pre><code>If WS.Cells(intRow, 6) Like \"*[*]\" Then\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5416, "favorite_count": 0, "accepted_answer_id": 39363272, "answer_count": 2, "score": 2, "last_activity_date": 1511022845, "creation_date": 1473231461, "last_edit_date": 1531164843, "question_id": 39363144, "link": "https://stackoverflow.com/questions/39363144/how-can-an-asterisk-be-found-in-a-string-using-instr-function", "title": "How can an asterisk be found in a string using InStr function?", "body": "<p>Microsoft documentation specifies to use <code>\"~*\"</code> to search for <code>\"*\"</code> in a string. <code>\"~*\"</code> and <code>\"[*]\"</code> don't work.</p>\n\n<p>String expression being searched:\n\"Bal\u0131k ya\u011f\u0131, bal\u0131k unu, ya\u015f meyve, kuru meyve, sucuk past\u0131rma, nebati ya\u011f, s\u00fct ve s\u00fct mamulleri imalat\u0131nda kullan\u0131lan iktisadi k\u0131ymetler ve \u00f6zel ara\u00e7 gere\u00e7ler *\"</p>\n\n<pre><code>If InStr(1, WS.Cells(intRow, 6).Value, \"~*\", vbTextCompare) &gt; 0 then\n    'Additional code here\nEnd If\n</code></pre>\n\n<p>This code can not find asterisk character.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1473231817, "post_id": 39363006, "comment_id": 66055470, "body": "Put <code>DoEvents</code> into the waiting loop?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473235921, "post_id": 39364269, "comment_id": 66057805, "body": "Thank you very much for your help dee! I&#39;d seen the product not found, and that&#39;s why I was trying to search to see if results_0 was there, as that frame doesn&#39;t appear (I believe) in that circumstance.  I look forward to trying your code now! Thanks again :)"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473236720, "post_id": 39364269, "comment_id": 66058316, "body": "One final question if anyone stumbles on this and can help: I&#39;m actually looking just to check the title of the first returned product on the page. I&#39;m currently searching through all text in the frame/class/I&#39;m not sure what to call it. Is it possible to limit the search to just the title?"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473253131, "post_id": 39364269, "comment_id": 66069181, "body": "It did, enormously. Thanks again. :) I raise the next bit as a curiosity rather than a plea for help as you&#39;ve already done so much, but currently this code generates an ie task in the task manager that grows and grows and grows and eventually causes and error when it gets too big. I&#39;m going to look into it myself, but if you know (top of head!) why....!"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473255534, "post_id": 39364269, "comment_id": 66070880, "body": "On my PC the code doesn&#39;t cause any problems, iexplorer.exe process is terminated immediatelly after the IE.Quit is called in VBA code. If you debug the code can you see if the problem is in VBA code itself? Btw. is the row <code>rowe = rowe + 1</code> still there?"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473259567, "post_id": 39364269, "comment_id": 66074029, "body": "You&#39;re right in that the process quits correctly! I&#39;m running the macro on 1000+ titles though. After about 200 or so the task manager looks like this (<a href=\"http://imgur.com/a/oQxUg\" rel=\"nofollow noreferrer\">imgur.com/a/oQxUg</a>) and the code throws an error. If I then quit the task and restart the macro it all works well again."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473261047, "post_id": 39364269, "comment_id": 66075169, "body": "Which error exactly is thrown? Could you locate the row of VBA code which caused the error?"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473414373, "post_id": 39364269, "comment_id": 66141816, "body": "Hi Dee. I ran it again and waited for the error - both it and the line of code highlighted on debug are here: <a href=\"http://imgur.com/a/JlGzE\" rel=\"nofollow noreferrer\">imgur.com/a/JlGzE</a>. This was again when the ie task had hit about 1.5GB of memory. Your thoughts appreciated!"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473414604, "post_id": 39364269, "comment_id": 66141950, "body": "Have you tried some from <a href=\"https://support.microsoft.com/en-us/kb/320369\" rel=\"nofollow noreferrer\">this advices</a>?"}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 3, "last_activity_date": 1473250242, "last_edit_date": 1473250242, "creation_date": 1473235002, "answer_id": 39364269, "question_id": 39363006, "link": "https://stackoverflow.com/questions/39363006/what-is-intermittently-breaking-my-short-block-of-vba/39364269#39364269", "title": "What is intermittently breaking my short block of VBA?", "body": "<p>One problem is the fact that for some barcodes no results are found.\nIf you would test your code with <code>IE.Visible = true</code> then you will see text like this:</p>\n\n<blockquote>\n  <p>Your search \"5060223767949\" did not match any products.</p>\n</blockquote>\n\n<p>Another problem is the condition <code>IsObject(document.getElementById(\"result_0\")) = False</code>. This doesn't work well, because <code>IsObject(Nothing)</code> returns <code>true</code>. Better would be to use <code>If &lt;variable-name&gt; Is Nothing Then ...</code>.</p>\n\n<p>The complete code. HTH</p>\n\n<pre><code>' Add reference to Microsoft Internet Controls (SHDocVw)\n' Add reference to Microsoft HTML Object Library\n\nSub LetsAutomateIE()\n    Dim IE As SHDocVw.InternetExplorer\n    Dim barcode As String\n    Dim rowe As Integer\n    Dim document As HTMLDocument\n    Dim Element As HTMLDivElement\n    Dim result01 As HTMLListElement\n    Dim noResults As HTMLHeaderElement\n    Dim text As String\n    Dim pos As Integer\n    Dim url As String\n\n    rowe = 2\n    url = \"https://www.amazon.co.uk/s/ref=nb_sb_noss_1?url=search-alias%3Daps&amp;field-keywords=\"\n    Set IE = New SHDocVw.InternetExplorer\n\n    While Not IsEmpty(Cells(rowe, 2))\n        barcode = Cells(rowe, \"B\").Value\n        pos = 0\n        text = \"\"\n\n        IE.Navigate url &amp; barcode\n\n        While IE.Busy Or IE.readyState &lt;&gt; READYSTATE_COMPLETE\n            DoEvents\n        Wend\n\n        Set document = IE.document\n        Set result01 = document.getElementById(\"result_0\")\n\n        If result01 Is Nothing Then\n            Set noResults = document.getElementById(\"noResultsTitle\")\n            If Not noResults Is Nothing Then MsgBox noResults.outerText\n            GoTo Here\n        End If\n\n        text = document.getElementById(\"result_0\").innerText\n        If InStr(text, \"STEELBOOK\") Or InStr(text, \"Steelbook\") Or InStr(text, \"Steel book\") &lt;&gt; 0 Then pos = 1\n\n        If pos &lt;&gt; 0 Then Cells(rowe, 4) = \"Y\" Else Cells(rowe, 4) = \"N\"\n\nHere:\n        rowe = rowe + 1\n    Wend\n\n    IE.Quit\n    Set IE = Nothing\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I'm actually looking just to check the title of the first returned\n  product on the page...</p>\n</blockquote>\n\n<p>The title is displayed with <code>h2</code> element within <code>li</code> with id <code>result_0</code>. So it is possible to limit the search just to this <code>li</code> element and search for first <code>h2</code> element.</p>\n\n<pre><code>' text = document.getElementById(\"result_0\").innerText\n\nDim h2Elements As IHTMLElementCollection\nDim h2 As HTMLHeadElement\n\nSet h2Elements = result01.getElementsByTagName(\"h2\")\n\nIf h2Elements.Length &gt; 0 Then\n    Set h2 = h2Elements.Item(0)\n    text = h2.innerText\n    Debug.Print text\nElse\n    MsgBox \"Text not found\"    \nEnd If\n</code></pre>\n\n<blockquote>\n  <p>Output:</p>\n</blockquote>\n\n<pre><code>RED 2 Blu-ray Steelbook UK Exclusive\nThe Hunger Games With Mockingjay Pendant\nThe Hunger Games\nThe Hunger Games\nAvengers Assemble BD Steelbook\nAvengers Assemble Bonus Disc BD Retail\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1473253141, "post_id": 39364914, "comment_id": 66069191, "body": "Thanks very much Thomas :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1473237045, "creation_date": 1473237045, "answer_id": 39364914, "question_id": 39363006, "link": "https://stackoverflow.com/questions/39363006/what-is-intermittently-breaking-my-short-block-of-vba/39364914#39364914", "title": "What is intermittently breaking my short block of VBA?", "body": "<p>I had an issue with <code>document.getElementById(\"result_0\")</code> throwing an error.  My workaround was to test if the element was in the Document.Body.InnerHTML.  </p>\n\n<p>If you set <code>DebugMode</code> to True then the webpage with bad results is left open for further inspection.  </p>\n\n<p>The barcode will be marked NA if not found.</p>\n\n<pre><code>Option Explicit\n\nSub LetsAutomateIE()\n    Const DebugMode As Boolean = True\n    Dim barcode As String, text As String\n    Dim rowe As Integer\n    Dim doc As HTMLDocument, liResults As HTMLLIElement\n    Dim ie As Object\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    rowe = 2\n\n    While Not IsEmpty(Cells(rowe, 2))\n        barcode = Cells(rowe, \"B\").Value\n\n        With ie\n            .Visible = False\n            .navigate2 \"https://www.amazon.co.uk/s/ref=nb_sb_noss_1?url=search-alias%3Daps&amp;field-keywords=\" &amp; barcode\n            Do Until ie.readyState = 4\n            Loop\n        End With\n\n        Set doc = ie.document\n        If InStr(doc.body.innerHTML, \"li id=\"\"result_0\"\"\") Then\n\n            Set liResults = doc.getElementById(\"result_0\")\n            text = liResults.innerText\n            Cells(rowe, 4) = IIf(InStr(text, \"STEELBOOK\") Or InStr(text, \"Steelbook\") Or InStr(text, \"Steel book\"), \"Y\", \"N\")\n\n        Else\n            Cells(rowe, 4) = \"NA\"\n            If DebugMode Then\n                ie.Visible = True\n                Set ie = CreateObject(\"InternetExplorer.Application\")\n            End If\n        End If\n        rowe = rowe + 1\n    Wend\n\n    ie.Quit\n\n    Set ie = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 39364269, "answer_count": 2, "score": 3, "last_activity_date": 1473250242, "creation_date": 1473231047, "last_edit_date": 1473231436, "question_id": 39363006, "link": "https://stackoverflow.com/questions/39363006/what-is-intermittently-breaking-my-short-block-of-vba", "title": "What is intermittently breaking my short block of VBA?", "body": "<p>As per <a href=\"https://stackoverflow.com/questions/39352270/check-with-vba-if-an-element-exists-on-the-page\" title=\"this post\">this post</a> I have fixed the object checker. Sometimes the code will run fine for 10 entries, getting them all correct, sometimes it'll run for five. Sometimes it'll get the entries wrong. </p>\n\n<p>It always tends to fail on the getting innertext of the element. When it gets the Y/N result wrong, I don't know at all what's causing that.</p>\n\n<p>Please help! It's driving me mad. I've error checked at every stage over and again. </p>\n\n<pre><code>Sub LetsAutomateIE()\n\nDim barcode As String\nDim rowe As Integer\nDim document As HTMLDocument\nDim Element As HTMLDivElement\nDim text As String\nDim pos As Integer\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nrowe = 2\n\nWhile Not IsEmpty(Cells(rowe, 2))\n    barcode = Cells(rowe, \"B\").Value\n    pos = 0\n    text = \"\"\n    Set document = Nothing\n\n    With ie\n        .Visible = False\n        .navigate2 \"https://www.amazon.co.uk/s/ref=nb_sb_noss_1?url=search-alias%3Daps&amp;field-keywords=\" &amp; barcode\n        Do Until ie.readyState = 4\n        Loop\n    End With\n\n    Set document = ie.document\n\n    If IsObject(document.getElementById(\"result_0\")) = False Then GoTo Here\n\n    text = document.getElementById(\"result_0\").innerText\n    If InStr(text, \"STEELBOOK\") Or InStr(text, \"Steelbook\") Or InStr(text, \"Steel book\") &lt;&gt; 0 Then pos = 1\n\n    If pos &lt;&gt; 0 Then Cells(rowe, 4) = \"Y\" Else Cells(rowe, 4) = \"N\"\n\n    Here:\n\n    rowe = rowe + 1\nWend\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Here is a selection of sample barcodes I was working with. I've never managed to get through these successfully.</p>\n\n<pre><code>5030305517076\n5030305517816\n5060223767925\n5060223767949\n5060223767956\n5060223767970\n5060223767994\n8717418358563\n8717418365851\n</code></pre>\n\n<p>Thank you so much,</p>\n\n<p>Sam</p>\n"}, {"tags": ["excel", "vba", "count", "cell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1473230828, "post_id": 39362649, "comment_id": 66054872, "body": "Hi, thanks that is really helpful (and a useful bit of code), but for some reason when I use the later of the above I get the longest row on the sheet, not the specified row? Any ideas?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1473231019, "post_id": 39362649, "comment_id": 66054985, "body": "Maybe it&#39;s not working how i thought it would, haven&#39;t tried it out"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1473231343, "post_id": 39362649, "comment_id": 66055190, "body": "still nice though mate"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1473229913, "creation_date": 1473229913, "answer_id": 39362649, "question_id": 39362610, "link": "https://stackoverflow.com/questions/39362610/finding-end-of-disjoint-row-vba/39362649#39362649", "title": "finding end of disjoint row VBA", "body": "<p>Try <code>Sheets(\"sheet 1\").UsedRange.Specialcells(xlCellTypeLastCell).Column</code></p>\n\n<p>This usually returns the right column</p>\n\n<p>If you want to check for a certain row, use it like this:</p>\n\n<pre><code>Sheets(\"sheet 1\").Rows(4).Entirerow.Specialcells(xlCellTypeLastCell).Column\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1473231525, "post_id": 39362926, "comment_id": 66055308, "body": "@MrNemo Cheers!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1473230819, "creation_date": 1473230819, "answer_id": 39362926, "question_id": 39362610, "link": "https://stackoverflow.com/questions/39362610/finding-end-of-disjoint-row-vba/39362926#39362926", "title": "finding end of disjoint row VBA", "body": "<p>This can be done using WorksheetFunctions Count and CountA.</p>\n\n<p>If you want the number of non-empty cells in row 4 use the <code>CountA</code></p>\n\n<p><code>WorksheetFunction.CountA(Rows(4))</code></p>\n\n<p>If you want the number of cells that contain only numbers in row 4 use the <code>Count</code></p>\n\n<p><code>WorksheetFunction.Count(Rows(4))</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473230819, "creation_date": 1473229762, "question_id": 39362610, "link": "https://stackoverflow.com/questions/39362610/finding-end-of-disjoint-row-vba", "title": "finding end of disjoint row VBA", "body": "<p>It is possible this question has already been asked and I didn't spot it in my research.</p>\n\n<p>I have a row of numbers, which starts at \"DC:4\" on a spread sheet. This row can increase or decrease in length (possibly going up to \"GG:4\"). For a given run of my macro I wish to find the number of none empty cells in row 4, so it could be 2 or 262.\nI could do something like:</p>\n\n<pre><code>     Sheets(\"sheet 1\").Cells(4, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>But, this fails due to the 106 blanks cells before this row of numbers starts. Please any help would be greatly appreciated.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1473225589, "creation_date": 1473225589, "answer_id": 39361702, "question_id": 39361682, "link": "https://stackoverflow.com/questions/39361682/change-hyperlink-address-in-all-sheets-using-mac-2011/39361702#39361702", "title": "Change hyperlink address in all sheets (using Mac 2011)", "body": "<p>use a for each loop to loop over all sheets in ThisWorkbook.Worksheets:</p>\n\n<pre><code>Dim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n    'do something\nNext ws\n</code></pre>\n\n<p>so in your case:</p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\n\n    For Each hl In ws.Hyperlinks\n\n        hl.Address = Replace(hl.Address, sOld, sNew)\n    Next hl\nNext ws\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 5560856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a66f8ebba486396e31a9c2d2cade93?s=128&d=identicon&r=PG&f=1", "display_name": "A.D usa", "link": "https://stackoverflow.com/users/5560856/a-d-usa"}, "edited": false, "score": 0, "creation_date": 1473226460, "post_id": 39361714, "comment_id": 66052858, "body": "Sorry, it dosent make the changes. I am using Excel for Mac 2011 by the way,"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 47, "user_id": 5560856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a66f8ebba486396e31a9c2d2cade93?s=128&d=identicon&r=PG&f=1", "display_name": "A.D usa", "link": "https://stackoverflow.com/users/5560856/a-d-usa"}, "edited": false, "score": 0, "creation_date": 1473226800, "post_id": 39361714, "comment_id": 66052977, "body": "ok, I am not familiar with code changes needed from PC to Mac, it works on Office 2010 for PC."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1473225667, "creation_date": 1473225667, "answer_id": 39361714, "question_id": 39361682, "link": "https://stackoverflow.com/questions/39361682/change-hyperlink-address-in-all-sheets-using-mac-2011/39361714#39361714", "title": "Change hyperlink address in all sheets (using Mac 2011)", "body": "<p>The only thing you need to add is to loop the Workbook for all Sheets, see in modifed code below:</p>\n\n<pre><code>Sub FixHyperlinks()\n\nDim wb As Workbook\nDim wks As Worksheet\nDim hl As Hyperlink\nDim sOld As String\nDim sNew As String\n\nSet wb = ThisWorkbook\n\n' loop ThisWorkbook all Sheets\nFor Each wks In wb.Worksheets\n    sOld = \"%5C\"\n    sNew = \"/\"\n    For Each hl In wks.Hyperlinks\n        hl.Address = Replace(hl.Address, sOld, sNew)\n    Next hl\nNext wks\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5560856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a66f8ebba486396e31a9c2d2cade93?s=128&d=identicon&r=PG&f=1", "display_name": "A.D usa", "link": "https://stackoverflow.com/users/5560856/a-d-usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473226827, "creation_date": 1473225441, "last_edit_date": 1473226827, "question_id": 39361682, "link": "https://stackoverflow.com/questions/39361682/change-hyperlink-address-in-all-sheets-using-mac-2011", "title": "Change hyperlink address in all sheets (using Mac 2011)", "body": "<p>I have a working Excel VBA code that replace hyperlink text in every sheet.\nCheck the code below</p>\n\n<pre><code>' Only change Hyperlinks in the active sheet\nSub FixHyperlinks()\n\n    Dim wks As Worksheet\n    Dim hl As Hyperlink\n    Dim sOld As String\n    Dim sNew As String\n\n    Set wks = ActiveSheet\n    sOld = \"%5C\"\n    sNew = \"/\"\n    For Each hl In wks.Hyperlinks\n        hl.Address = Replace(hl.Address, sOld, sNew)\n    Next hl\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that the workbook have around 30 sheets!!</p>\n\n<p>How can I make this macro run in all the sheets in the active workbook ?</p>\n"}, {"tags": ["excel", "loops", "vba"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "edited": false, "score": 0, "creation_date": 1473314616, "post_id": 39362045, "comment_id": 66094311, "body": "Thanks MJH, based on your formula I edited it slightly and added correct field names to get the answer below"}], "tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": true, "score": 1, "last_activity_date": 1473227375, "creation_date": 1473227375, "answer_id": 39362045, "question_id": 39361510, "link": "https://stackoverflow.com/questions/39361510/vba-loop-in-excel-2016-for-columns/39362045#39362045", "title": "VBA Loop in Excel 2016 for columns", "body": "<p>My numbers may be off a bit, but I believe may want something like this:</p>\n\n<pre><code>For i = 1 To 30\n    j = i - 12\n    k = i - 5\n    l = i - 3\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(R[\" &amp; i &amp; \"]C[\" &amp; k &amp; \"]=\"\"Diagnostic - HCP\"\",IF(RC[\" &amp; j &amp; \"]=R[\" &amp; i &amp; \"]C[\" &amp; j &amp; \"],R[\" &amp; i &amp; \"]C[\" &amp; l &amp; \"],\"\"\"\"),\"\"\"\")\"\n    Selection.Offset(0, 1).Select\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1473314875, "creation_date": 1473314875, "answer_id": 39383607, "question_id": 39361510, "link": "https://stackoverflow.com/questions/39361510/vba-loop-in-excel-2016-for-columns/39383607#39383607", "title": "VBA Loop in Excel 2016 for columns", "body": "<p>Thanks MJH, based on your formula this was the working code:</p>\n\n<pre><code>MemberNo = -10\nDiagnosis = -3\nServiceClass = -1\nFor i = 1 To 30\n\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(R[\" &amp; i &amp; \"]C[\" &amp; Diagnosis &amp; \"]=\"\"Diagnostic - HCP\"\",IF(R[0]C[\" &amp; MemberNo &amp; \"]=R[\" &amp; i &amp; \"]C[\" &amp; MemberNo &amp; \"],R[\" &amp; i &amp; \"]C[\" &amp; ServiceClass &amp; \"],\"\"\"\"),\"\"\"\")\"\n    Selection.Offset(0, 1).Select\n    MemberNo = MemberNo - 1\n    Diagnosis = Diagnosis - 1\n    ServiceClass = ServiceClass - 1\n\nNext i &lt;/code&gt;\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 39362045, "answer_count": 2, "score": 0, "last_activity_date": 1473314875, "creation_date": 1473224390, "last_edit_date": 1531164843, "question_id": 39361510, "link": "https://stackoverflow.com/questions/39361510/vba-loop-in-excel-2016-for-columns", "title": "VBA Loop in Excel 2016 for columns", "body": "<p>I used the macro recorder to record some steps which works fine, however I wanted to make a loop rather than repeat each step as I want to replicate it further down the line.</p>\n\n<p>The idea is I have a list of people who have who have multiple codes, they could have 1 to 30 separate codes, which gives an extra line for each of them.</p>\n\n<p>The VBA basically adds 30 columns, then says in the first new column 1 is the person 1 row down the same as this line? if so add their code, else leave blank. \nIn column 2, is the person in 2 rows down the same as this line, if so add their code, else leave blank, and etc for the rest of the columns</p>\n\n<p><a href=\"https://i.stack.imgur.com/piXi5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/piXi5.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    'Loop through the columns\n\n\nFor i = 1 To 30\nj = -10\nk = -3\nl = -1\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(RC[k]=\"\"Diagnostic - HCP\"\",IF(RC[j]=RC[i],RC[l],\"\"\"\"),\"\"\"\")\"\n    Selection.Offset(0, 1).Select\n'The line above causes an error\nNext i\n\n'These lines all work:\nActiveCell.FormulaR1C1 = _\n'    \"=IF(R[1]C[-4]=\"\"Diagnostic - HCP\"\",IF(RC[-11]=R[1]C[-11],R[1]C[-2],\"\"\"\"),\"\"\"\")\"\n'Range(\"Q2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[2]C[-5]=\"\"Diagnostic - HCP\"\",IF(RC[-12]=R[2]C[-12],R[2]C[-3],\"\"\"\"),\"\"\"\")\"\n'Range(\"R2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[3]C[-6]=\"\"Diagnostic - HCP\"\",IF(RC[-13]=R[3]C[-13],R[3]C[-4],\"\"\"\"),\"\"\"\")\"\n'Range(\"S2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[4]C[-7]=\"\"Diagnostic - HCP\"\",IF(RC[-14]=R[4]C[-14],R[4]C[-5],\"\"\"\"),\"\"\"\")\"\n'Range(\"T2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[5]C[-8]=\"\"Diagnostic - HCP\"\",IF(RC[-15]=R[5]C[-15],R[5]C[-6],\"\"\"\"),\"\"\"\")\"\n'Range(\"U2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[6]C[-9]=\"\"Diagnostic - HCP\"\",IF(RC[-16]=R[6]C[-16],R[6]C[-7],\"\"\"\"),\"\"\"\")\"\n'Range(\"V2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[7]C[-10]=\"\"Diagnostic - HCP\"\",IF(RC[-17]=R[7]C[-17],R[7]C[-8],\"\"\"\"),\"\"\"\")\"\n'Range(\"W2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[8]C[-11]=\"\"Diagnostic - HCP\"\",IF(RC[-18]=R[8]C[-18],R[8]C[-9],\"\"\"\"),\"\"\"\")\"\n'Range(\"X2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[9]C[-12]=\"\"Diagnostic - HCP\"\",IF(RC[-19]=R[9]C[-19],R[9]C[-10],\"\"\"\"),\"\"\"\")\"\n'Range(\"Y2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[10]C[-13]=\"\"Diagnostic - HCP\"\",IF(RC[-20]=R[10]C[-20],R[10]C[-11],\"\"\"\"),\"\"\"\")\"\n'Range(\"Z2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[11]C[-14]=\"\"Diagnostic - HCP\"\",IF(RC[-21]=R[11]C[-21],R[11]C[-12],\"\"\"\"),\"\"\"\")\"\n'Range(\"AA2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[12]C[-15]=\"\"Diagnostic - HCP\"\",IF(RC[-22]=R[12]C[-22],R[12]C[-13],\"\"\"\"),\"\"\"\")\"\n'Range(\"AB2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[13]C[-16]=\"\"Diagnostic - HCP\"\",IF(RC[-23]=R[13]C[-23],R[13]C[-14],\"\"\"\"),\"\"\"\")\"\n'Range(\"AC2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[14]C[-17]=\"\"Diagnostic - HCP\"\",IF(RC[-24]=R[14]C[-24],R[14]C[-15],\"\"\"\"),\"\"\"\")\"\n'Range(\"AD2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[15]C[-18]=\"\"Diagnostic - HCP\"\",IF(RC[-25]=R[15]C[-25],R[15]C[-16],\"\"\"\"),\"\"\"\")\"\n'Range(\"AE2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[16]C[-19]=\"\"Diagnostic - HCP\"\",IF(RC[-26]=R[16]C[-26],R[16]C[-17],\"\"\"\"),\"\"\"\")\"\n'Range(\"AF2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[17]C[-20]=\"\"Diagnostic - HCP\"\",IF(RC[-27]=R[17]C[-27],R[17]C[-18],\"\"\"\"),\"\"\"\")\"\n'Range(\"AG2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[18]C[-21]=\"\"Diagnostic - HCP\"\",IF(RC[-28]=R[18]C[-28],R[18]C[-19],\"\"\"\"),\"\"\"\")\"\n'Range(\"AH2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[19]C[-22]=\"\"Diagnostic - HCP\"\",IF(RC[-29]=R[19]C[-29],R[19]C[-20],\"\"\"\"),\"\"\"\")\"\n'Range(\"AI2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[20]C[-23]=\"\"Diagnostic - HCP\"\",IF(RC[-30]=R[20]C[-30],R[20]C[-21],\"\"\"\"),\"\"\"\")\"\n'Range(\"AJ2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[21]C[-24]=\"\"Diagnostic - HCP\"\",IF(RC[-31]=R[21]C[-31],R[21]C[-22],\"\"\"\"),\"\"\"\")\"\n'Range(\"AK2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[22]C[-25]=\"\"Diagnostic - HCP\"\",IF(RC[-32]=R[22]C[-32],R[22]C[-23],\"\"\"\"),\"\"\"\")\"\n'Range(\"AL2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[23]C[-26]=\"\"Diagnostic - HCP\"\",IF(RC[-33]=R[23]C[-33],R[23]C[-24],\"\"\"\"),\"\"\"\")\"\n'Range(\"AM2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[24]C[-27]=\"\"Diagnostic - HCP\"\",IF(RC[-34]=R[24]C[-34],R[24]C[-25],\"\"\"\"),\"\"\"\")\"\n'Range(\"AN2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[25]C[-28]=\"\"Diagnostic - HCP\"\",IF(RC[-35]=R[25]C[-35],R[25]C[-26],\"\"\"\"),\"\"\"\")\"\n'Range(\"AO2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[26]C[-29]=\"\"Diagnostic - HCP\"\",IF(RC[-36]=R[26]C[-36],R[26]C[-27],\"\"\"\"),\"\"\"\")\"\n'Range(\"AP2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[27]C[-30]=\"\"Diagnostic - HCP\"\",IF(RC[-37]=R[27]C[-37],R[27]C[-28],\"\"\"\"),\"\"\"\")\"\n'Range(\"AQ2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[28]C[-31]=\"\"Diagnostic - HCP\"\",IF(RC[-38]=R[28]C[-38],R[28]C[-29],\"\"\"\"),\"\"\"\")\"\n'Range(\"AR2\").Select\n'ActiveCell.FormulaR1C1 = _\n'    \"=IF(R[29]C[-32]=\"\"Diagnostic - HCP\"\",IF(RC[-39]=R[29]C[-39],R[29]C[-30],\"\"\"\"),\"\"\"\")\"\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1473220690, "post_id": 39360939, "comment_id": 66051260, "body": "<code>RunSQL</code> is for updates, inserts, and deletes.  You want to open a recordset or use some other mechanism to select data."}, {"owner": {"reputation": 162, "user_id": 4645596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vE82cUBpJEk/AAAAAAAAAAI/AAAAAAAAAyk/ZfyIxXYFvXM/photo.jpg?sz=128", "display_name": "Vincent Labrecque", "link": "https://stackoverflow.com/users/4645596/vincent-labrecque"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1473222366, "post_id": 39360939, "comment_id": 66051641, "body": "By using the other guy&#39;s code and removing the RunSQL statement, I got it to work now, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 4645596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vE82cUBpJEk/AAAAAAAAAAI/AAAAAAAAAyk/ZfyIxXYFvXM/photo.jpg?sz=128", "display_name": "Vincent Labrecque", "link": "https://stackoverflow.com/users/4645596/vincent-labrecque"}, "edited": false, "score": 0, "creation_date": 1473221977, "post_id": 39361088, "comment_id": 66051544, "body": "I get a new error msg: &quot;Ms Access DB engine cannot find the input table or query. Make sure it exists and that its name is spelled correctly&quot;"}, {"owner": {"reputation": 162, "user_id": 4645596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vE82cUBpJEk/AAAAAAAAAAI/AAAAAAAAAyk/ZfyIxXYFvXM/photo.jpg?sz=128", "display_name": "Vincent Labrecque", "link": "https://stackoverflow.com/users/4645596/vincent-labrecque"}, "edited": false, "score": 0, "creation_date": 1473222324, "post_id": 39361088, "comment_id": 66051631, "body": "I had to remove the RunSQL line and do some modifications, but it&#39;s working now. Thanks a lot! The solution was so hard to find on Google... I tried many resources &quot;MS access SQL in VBA&quot; and stuff like that. Thanks!"}, {"owner": {"reputation": 162, "user_id": 4645596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vE82cUBpJEk/AAAAAAAAAAI/AAAAAAAAAyk/ZfyIxXYFvXM/photo.jpg?sz=128", "display_name": "Vincent Labrecque", "link": "https://stackoverflow.com/users/4645596/vincent-labrecque"}, "edited": false, "score": 0, "creation_date": 1473343887, "post_id": 39361088, "comment_id": 66112461, "body": "Is it wrong to not put .Value at the end of &quot;Text191.Value = rs.Fields(&quot;Addresse&quot;).Value&quot;?? It works without right now"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": true, "score": 1, "last_activity_date": 1473221620, "creation_date": 1473221620, "answer_id": 39361088, "question_id": 39360939, "link": "https://stackoverflow.com/questions/39360939/working-sql-query-generates-a-runsql-statement-requires-an-argument-consisting/39361088#39361088", "title": "Working SQL query generates &quot;A RunSQL statement requires an argument consisting of an SQL statement&quot; in VBA", "body": "<p>Try something like</p>\n\n<pre><code>Dim db As Database\nDim rs As DAO.Recordset\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(strSQL1)\nText191.Value = rs.Fields(\"Addresse\").Value\n\nSet rs = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 4645596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vE82cUBpJEk/AAAAAAAAAAI/AAAAAAAAAyk/ZfyIxXYFvXM/photo.jpg?sz=128", "display_name": "Vincent Labrecque", "link": "https://stackoverflow.com/users/4645596/vincent-labrecque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 39361088, "answer_count": 1, "score": 1, "last_activity_date": 1609610293, "creation_date": 1473220297, "last_edit_date": 1609610293, "question_id": 39360939, "link": "https://stackoverflow.com/questions/39360939/working-sql-query-generates-a-runsql-statement-requires-an-argument-consisting", "title": "Working SQL query generates &quot;A RunSQL statement requires an argument consisting of an SQL statement&quot; in VBA", "body": "<p>I'm trying to make a form in Access with a &quot;search as you type&quot; function to find a customer.<br />\nI'll double click the correct match in a listbox to update the customer info textboxes.</p>\n<p>I succeeded the &quot;search as you type&quot; part, but not the listbox double click update form part.</p>\n<p>I get the following RunSQL error:</p>\n<blockquote>\n<p>&quot;A RunSQL statement requires an argument consisting of an SQL statement&quot;</p>\n</blockquote>\n<p>The SQL statement works in a query.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub lstClient_DblClick(Cancel As Integer)\n    Dim selectedItem, strSQL, strSQL1 As String\n    Dim i As Integer\n        \n    i = lstClient.ListIndex\n    selectedItem = lstClient.ItemData(i)\n    txtCustName.Value = selectedItem\n        \n    strSQL = &quot;SELECT tblClient.[Addresse] FROM tblClient WHERE tblClient.[Nom] ='&quot; &amp; selectedItem &amp; &quot;';&quot;\n\n    strSQL1 = &quot;SELECT tblClient.[Addresse] FROM tblClient WHERE tblClient.[Nom] ='Bernache Funeral home';&quot;\n            \n    DoCmd.RunSQL (strSQL1)\n    Text191.Value = strSQL1\nEnd Sub\n</code></pre>\n<p>The second statement (strSQL1) is the one I tried in the query to make sure it worked, and it did.</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1473218565, "post_id": 39360625, "comment_id": 66050840, "body": "Looks like you want a filter. See <a href=\"https://support.office.com/en-us/article/Filter-data-in-a-range-or-table-01832226-31b5-4568-8806-38c37dcc180e\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1473235827, "post_id": 39360625, "comment_id": 66057755, "body": "Probably best to walk down the column, check to see if the value meets criteria by looping through a list. If it doesn&#39;t meet the criteria, delete the row."}, {"owner": {"reputation": 127, "user_id": 3651553, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2e3cf6c2124e7b4cc0e2b12d2bf40ecd?s=128&d=identicon&r=PG&f=1", "display_name": "joseph_k", "link": "https://stackoverflow.com/users/3651553/joseph-k"}, "edited": false, "score": 0, "creation_date": 1473296944, "post_id": 39360625, "comment_id": 66089933, "body": "I am using Filter -&gt; Advanced criteria, by creating a list of keywords. It works perfectly. But the code given by Tim Edwards in the answer is doing exactly the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 3651553, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2e3cf6c2124e7b4cc0e2b12d2bf40ecd?s=128&d=identicon&r=PG&f=1", "display_name": "joseph_k", "link": "https://stackoverflow.com/users/3651553/joseph-k"}, "edited": false, "score": 0, "creation_date": 1473296841, "post_id": 39367579, "comment_id": 66089909, "body": "Worked like a charm. Thanks a lot."}], "tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": true, "score": 1, "last_activity_date": 1473244561, "creation_date": 1473244561, "answer_id": 39367579, "question_id": 39360625, "link": "https://stackoverflow.com/questions/39360625/how-to-copy-rows-from-a-range-if-the-cell-value-starts-with-particular-string/39367579#39367579", "title": "How to copy rows from a range if the cell value starts with particular string?", "body": "<p>You could use Advanced Filter, something like this:</p>\n\n<pre><code>Sub FilterThings()\n'Add header row and call it something\nRows(\"1:1\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"A1\").FormulaR1C1 = \"Bananas\"\n\n'Create named range to use in filter\nActiveWorkbook.Names.Add Name:=\"Source\", RefersToR1C1:=Replace(Range(\"A1\").CurrentRegion.Address(True, True, xlR1C1, True), \"[\" &amp; ActiveWorkbook.Name &amp; \"]\", \"=\")\n\n'Add in criteria\nRange(\"P1\").FormulaR1C1 = \"Bananas\"\nRange(\"P2\").FormulaR1C1 = \"=\"\"File*\"\"\"\nRange(\"P3\").FormulaR1C1 = \"=\"\"Geometry*\"\"\"\nRange(\"P4\").FormulaR1C1 = \"=\"\"Feature Count*\"\"\"\nRange(\"P5\").FormulaR1C1 = \"=\"\"Layer SRS*\"\"\"\nRange(\"P6\").FormulaR1C1 = \"=\"\"GEOGCS*\"\"\"\nRange(\"P7\").FormulaR1C1 = \"=\"\"PROJGCS*\"\"\"\n\n'Create named range to use in filter\nActiveWorkbook.Names.Add Name:=\"Criteria\", RefersToR1C1:=Replace(Range(\"P1\").CurrentRegion.Address(True, True, xlR1C1, True), \"[\" &amp; ActiveWorkbook.Name &amp; \"]\", \"=\")\n\n'Filter to Location\nRange(\"Source\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range(\"Criteria\"), CopyToRange:=Range(\"G1\")\n\n'Delete Criteria column\nColumns(\"P:P\").Delete Shift:=xlToLeft\n\n'Delete Header Bananas row\nRows(\"1:1\").Delete Shift:=xlUp\n\n'Delete named ranges\nActiveWorkbook.Names(\"Criteria\").Delete\nActiveWorkbook.Names(\"Extract\").Delete\nActiveWorkbook.Names(\"Source\").Delete\nEnd Sub\n</code></pre>\n\n<p>You could substitute Bananas for something else or leave that part out if you already have a header. Here I assumed your data was just in column A starting at row 1 and have arbitrarily put it in Column G, this and where you put the Criteria could be changed with no adverse effect. </p>\n"}], "owner": {"reputation": 127, "user_id": 3651553, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2e3cf6c2124e7b4cc0e2b12d2bf40ecd?s=128&d=identicon&r=PG&f=1", "display_name": "joseph_k", "link": "https://stackoverflow.com/users/3651553/joseph-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 39367579, "answer_count": 1, "score": -3, "last_activity_date": 1473244561, "creation_date": 1473217561, "last_edit_date": 1531161705, "question_id": 39360625, "link": "https://stackoverflow.com/questions/39360625/how-to-copy-rows-from-a-range-if-the-cell-value-starts-with-particular-string", "title": "How to copy rows from a range if the cell value starts with particular string?", "body": "<p>I have a list with with 1000's of geographical parameters - which will vary according to the file type - in a single column. I would like to copy the rows which starts with strings \"<strong><em>File, Geometry, Feature Count, Layer SRS, GEOGCS, PROJGCS</em></strong>, etc... \" (Image) to the next column. Few parameters, for eg - PROJGCS might be present for one file but not for another one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ERZEA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ERZEA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473217714, "post_id": 39360611, "comment_id": 66050667, "body": "See <a href=\"http://stackoverflow.com/documentation/vba/877/declaring-variables/16978/when-to-use-a-static-variable#t=201609070306389229598\">When to use a Static variable</a>."}, {"owner": {"reputation": 4077, "user_id": 1988304, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9tgQl.jpg?s=128&g=1", "display_name": "JimHawkins", "link": "https://stackoverflow.com/users/1988304/jimhawkins"}, "edited": false, "score": 0, "creation_date": 1473218277, "post_id": 39360611, "comment_id": 66050778, "body": "<i>&quot;I need a code...&quot;</i> is not the way this site works. Show your own efforts and ask about a specific problem. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1473220600, "post_id": 39360611, "comment_id": 66051242, "body": "Sorry for the wrong word i used.Should I put my userform code to show my effort?? I just dont know how to start a serial number part.Newbie here.Not familiar with coding"}, {"owner": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "edited": false, "score": 0, "creation_date": 1473222605, "post_id": 39360611, "comment_id": 66051707, "body": "So you want some sort of counter that increments ever time data is entered by the user?"}, {"owner": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1473223024, "post_id": 39360611, "comment_id": 66051822, "body": "Jim Hewitt,is that possible?? You suggest counter in userform code or in worksheet code?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1473392736, "post_id": 39376327, "comment_id": 66132513, "body": "Ive been working with the code that will appear automaticly after user click submit form button.but i fail to upload my code here ."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1473429618, "post_id": 39376327, "comment_id": 66150905, "body": "If you put my code in a module (lets call it module1), then in your button_click() sub at the end insert <code>Call Module1.SerialCode</code>. Or you can put this code in your UserForm code, and just <code>Call SerialCode</code>. Either way achieves the same thing."}, {"owner": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1475197948, "post_id": 39376327, "comment_id": 66858550, "body": "I&#39;ve got error :type mismatch in &#39;Else:lastSerial=CInt(Replace(ws.Range(&quot;A&quot; &amp; lastRow). Value, &quot;RD&quot;,&quot;&quot;))&#39; when second data entered"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1475203372, "post_id": 39376327, "comment_id": 66859696, "body": "Because you have something other than &quot;RD 000000&quot; in your serial"}, {"owner": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1475203667, "post_id": 39376327, "comment_id": 66859756, "body": "It should be. Second entered data should  be RD000002."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1475205539, "post_id": 39376327, "comment_id": 66860190, "body": "no, second entered data should be RD 000002, with the space, just like how you have it structured in your question."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "edited": false, "score": 0, "creation_date": 1475205586, "post_id": 39376327, "comment_id": 66860205, "body": "If your serial code has a different format just alter my code to fit your needs. I do think this has answered the question, could you mark it as answered?"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 0, "last_activity_date": 1473303282, "last_edit_date": 1473303282, "creation_date": 1473270597, "answer_id": 39376327, "question_id": 39360611, "link": "https://stackoverflow.com/questions/39360611/vba-code-to-auto-serial-number-in-column-a-after-my-userform-entered-data-in-col/39376327#39376327", "title": "VBA code to auto serial number in column A after my userform entered data in column B", "body": "<p>The code behind this is very simple and designed for you to start on a blank sheet with <code>Row 1</code> being your header row. It's dynamic so essentially plug and play. Just call on the sub with whatever code you have for entering in the other data.</p>\n\n<pre><code>Sub SerialCode()\n    Dim ws As Worksheet\n    Dim lastSerial, digits, i As Integer\n    Dim nextRow, lastRow As Long\n    Dim newSerial As String\n\n    Set ws = ThisWorkbook.Sheets(1)\n    nextRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row + 1 'Finds the last row in A\n    lastRow = nextRow - 1\n    newSerial = \"\" 'set value of our string blank\n\n    If (nextRow - 1) &lt; 2 Then 'If statement to catch if there's only a header\n        lastSerial = 0\n    Else: lastSerial = CInt(Replace(ws.Range(\"A\" &amp; lastRow).Value, \"RD \", \"\"))\n    End If\n\n    lastSerial = lastSerial + 1\n    digits = 6 - Len(lastSerial) 'how many 0's are there\n\n    For i = 1 To digits\n        newSerial = newSerial &amp; \"0\" 'start building the string with 0's\n    Next i\n\n    newSerial = \"RD \" &amp; newSerial &amp; lastSerial 'concatenate the serial code\n    ws.Range(\"A\" &amp; nextRow).Value = newSerial\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong> whatever you have for finding your last row to input the other data, make sure your last row and this sub's last row are the same.</p>\n"}], "owner": {"reputation": 9, "user_id": 6472254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBcV9XXBe0M/AAAAAAAAAAI/AAAAAAAAABY/AOOSdcVsd9o/photo.jpg?sz=128", "display_name": "RayZa", "link": "https://stackoverflow.com/users/6472254/rayza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13046, "favorite_count": 0, "accepted_answer_id": 39376327, "answer_count": 1, "score": -3, "last_activity_date": 1563364597, "creation_date": 1473217433, "last_edit_date": 1531164843, "question_id": 39360611, "link": "https://stackoverflow.com/questions/39360611/vba-code-to-auto-serial-number-in-column-a-after-my-userform-entered-data-in-col", "title": "VBA code to auto serial number in column A after my userform entered data in column B", "body": "<p>I have a userform in which user can insert data and data will insert in column B to M. I need a code, either in worksheet or in userform to auto fill serial number starting with \"RD 00001\" which will fill in column A everytime data has enter. Please someone give me an idea.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473216446, "post_id": 39360315, "comment_id": 66050422, "body": "In VBA?  You can use <code>Like</code> Or <code>Instr</code> To test for &quot;purchase&quot;."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1473216811, "post_id": 39360315, "comment_id": 66050486, "body": "A possible formula might be <code>=IF(IFERROR(FIND(&quot;Purchase&quot;,H1),0)&gt;0,-1,1)*B1</code>.  (Oops, just noticed the <code>excel-vba</code> tag, so I guess you aren&#39;t after a formula.)"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6450247, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f9f43cd1f620e4f33f9938f41c0d50da?s=128&d=identicon&r=PG&f=1", "display_name": "TomC", "link": "https://stackoverflow.com/users/6450247/tomc"}, "edited": false, "score": 0, "creation_date": 1473294996, "post_id": 39360726, "comment_id": 66089571, "body": "I ended up using the formula.  I am not very familiar with vba and I am not fully understanding what is happening in the For statement.  Need to go through that more slowly and pick it apart.  Thanks for the help!"}], "tags": [], "owner": {"reputation": 11, "user_id": 6793930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639fb2b22018a38ee06e85ff781ff605?s=128&d=identicon&r=PG&f=1", "display_name": "Don Flash", "link": "https://stackoverflow.com/users/6793930/don-flash"}, "is_accepted": false, "score": 0, "last_activity_date": 1473221436, "last_edit_date": 1473221436, "creation_date": 1473218498, "answer_id": 39360726, "question_id": 39360315, "link": "https://stackoverflow.com/questions/39360315/excel-vba-calculate-one-cell-based-on-string-from-another/39360726#39360726", "title": "Excel VBA calculate one cell based on string from another", "body": "<p>You can do it in formula or VBA.</p>\n\n<p>In formula, say B1 had content X before, you change to formula\n=(X) * IF(ISNUMBER(SEARCH(\"Purchase\", H1)), -1, 1)</p>\n\n<p>In VBA, try this</p>\n\n<pre><code>Sub NegateB_IfPurchaseH()\nDim celB As Range\nDim celH As Range\nDim celPtr As Range\n\n' you can change 1:10 to any other range\nSet celB = Range(\"B1:B10\")\nSet celH = celB.Cells(1, 7)\n\nFor Each celPtr In celB\n    If InStr(1, celPtr.Cells(1, 7).Value, \"purchase\", vbTextCompare) &gt; 0 Then\n        celPtr.Formula = \"=-\" &amp; Mid(celPtr.Formula, 2)\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6450247, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f9f43cd1f620e4f33f9938f41c0d50da?s=128&d=identicon&r=PG&f=1", "display_name": "TomC", "link": "https://stackoverflow.com/users/6450247/tomc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473221436, "creation_date": 1473214767, "last_edit_date": 1531164843, "question_id": 39360315, "link": "https://stackoverflow.com/questions/39360315/excel-vba-calculate-one-cell-based-on-string-from-another", "title": "Excel VBA calculate one cell based on string from another", "body": "<p>I want to perform a simple calculation on another cell based off a key word in the string from a different cell.  For example Column H might have a description along the lines of \"Purchase of 50,000 shares.\"  I want to multiple Column B by -1 if the word Purchase appears.  Is it possible to build a condition off of a key word in a string?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473214269, "post_id": 39360167, "comment_id": 66050008, "body": "Is this a <code>excel-vba</code> question, or a <code>excel-formulas</code> question?  Would the formula <code>=ADDRESS(ROW($J$3),COLUMN($J$3),1,1,&quot;Sheet2&quot;)&amp;&quot;:&quot;&amp;ADDRESS(RO&zwnj;&#8203;W($J$3)+COUNTA(Sheet&zwnj;&#8203;2!$J:$J)-2,COLUMN($J&zwnj;&#8203;$3)+1,1,1)</code> work?   (I&#39;m sure there must be a better way than that though.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473218555, "post_id": 39360167, "comment_id": 66050837, "body": "Just noticed (after posting a VBA solution) that I was getting one more row and column than the OFFSET function would have, therefore the formula would really be <code>=ADDRESS(ROW($J$3),COLUMN($J$3),1,1,&quot;Sheet2&quot;)&amp;&quot;:&quot;&amp;ADDRESS(RO&zwnj;&#8203;\u200c\u200bW($J$3)+COUNTA(She&zwnj;&#8203;et\u200c\u200b2!$J:$J)-3,COLUM&zwnj;&#8203;N($J\u200c\u200b$3),1,1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6736492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cUt6wzkAizk/AAAAAAAAAAI/AAAAAAAAGIo/QU8_SaDQkTI/photo.jpg?sz=128", "display_name": "LukeB", "link": "https://stackoverflow.com/users/6736492/lukeb"}, "edited": false, "score": 0, "creation_date": 1473289769, "post_id": 39360670, "comment_id": 66088423, "body": "perfect, thanks Yow! I am using the 1st solution as I have at OFFSET from a dynamic named range. (I voted up but I am new to StackOverflow, so it will not show in the publicly displaced post... )"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 6736492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cUt6wzkAizk/AAAAAAAAAAI/AAAAAAAAGIo/QU8_SaDQkTI/photo.jpg?sz=128", "display_name": "LukeB", "link": "https://stackoverflow.com/users/6736492/lukeb"}, "edited": false, "score": 0, "creation_date": 1473297366, "post_id": 39360670, "comment_id": 66090023, "body": "@LukeB - See Thomas Inzina&#39;s answer - it is probably much, much better than my 1st solution."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1473218432, "last_edit_date": 1473218432, "creation_date": 1473217929, "answer_id": 39360670, "question_id": 39360167, "link": "https://stackoverflow.com/questions/39360167/excel-get-range-for-named-dynamic-range-offset/39360670#39360670", "title": "Excel get range for named dynamic range (OFFSET)", "body": "<p>A VBA solution to the question you asked might be:</p>\n\n<pre><code>Dim x as String\nWith Worksheets(\"Sheet2\")\n    x = \"'\" &amp; .Name &amp; \"'!\" &amp; .Range(\"J3\", .Range(\"J3\").Offset(Application.WorksheetFunction.CountA(.Columns(\"J\")) - 2, 0)).Address\nEnd With\n'The value of variable x is now the address you asked for\n</code></pre>\n\n<p>but maybe what you are really trying to do is:</p>\n\n<pre><code>Dim rng As Range\nWith Worksheets(\"Sheet2\")\n    Set rng = .Range(\"J3:J\" &amp; .Range(\"J\" &amp; .Rows.Count).End(xlUp).Row)\nEnd With\n'rng will now be a Range object referring to everything in\n' column J, starting at row 3 and ending at the last\n' non-blank cell in column J\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473297170, "post_id": 39365629, "comment_id": 66089982, "body": "Well, would you look at that!!  I didn&#39;t realise that you could do such a calculation in that spot - I definitely learn something new every day.  (Now if I could just work out how to trick SO into letting me do a +2 I would be really happy!)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473297763, "post_id": 39365629, "comment_id": 66090100, "body": "LOL...I think that SO should have a special platinum badge <code>&quot;Gray-Hatter&quot;</code> that you can only get by hacking the site!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473298776, "post_id": 39365629, "comment_id": 66090332, "body": "The closest I would be able to get to a <code>&quot;Gray-Hatter&quot;</code> badge would be if they issued me with a <code>&quot;Grey-Hair&quot;</code> badge."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1473239113, "creation_date": 1473239113, "answer_id": 39365629, "question_id": 39360167, "link": "https://stackoverflow.com/questions/39360167/excel-get-range-for-named-dynamic-range-offset/39365629#39365629", "title": "Excel get range for named dynamic range (OFFSET)", "body": "<p>You don't have to do anything special.  The formula will return a valid range.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w3FFU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w3FFU.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6736492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cUt6wzkAizk/AAAAAAAAAAI/AAAAAAAAGIo/QU8_SaDQkTI/photo.jpg?sz=128", "display_name": "LukeB", "link": "https://stackoverflow.com/users/6736492/lukeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "closed_date": 1594203622, "answer_count": 2, "score": 0, "last_activity_date": 1594203618, "creation_date": 1473213402, "last_edit_date": 1594203618, "question_id": 39360167, "link": "https://stackoverflow.com/questions/39360167/excel-get-range-for-named-dynamic-range-offset", "closed_reason": "Needs more focus", "title": "Excel get range for named dynamic range (OFFSET)", "body": "<p>hi I have a data Validation for a dropdown cell on Sheet1, the List is a named dynamic range whose equation is: \n =OFFSET(Sheet2!$J$3,0,0,COUNTA(Sheet2!$J:$J)-2,1)</p>\n\n<p>Works fine.</p>\n\n<p>But now I want to get the Excel cell reference for this; in my example the range is sheet2!$j$3:$j$30. I need that string to put into a Range reference</p>\n\n<p>I've done this by parsing but slows down my spreadsheet</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473209511, "post_id": 39359695, "comment_id": 66049215, "body": "Can you post examples of the expected input and output? I can&#39;t tell from the code what you expect to see. Currently you only write the value of the last result of the inner loop."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473209826, "post_id": 39359695, "comment_id": 66049262, "body": "presumably you need <code>StartNumber</code> in the right-hand-side of the assignment, maybe where the 1 is? <i>= Cells.Item(<b>1</b>, &quot;B&quot;) * i * (1 - alpha)</i>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473210032, "post_id": 39359695, "comment_id": 66049289, "body": "It&#39;s suspicious that there is a loop from 0 to 38 inside a loop from 1 to 39.  Is that intentional, or should <code>i</code> simply be <code>StartNumber - 1</code>?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473235476, "post_id": 39359695, "comment_id": 66057560, "body": "If you swap your &#39;StartNumber&#39; loop with your &#39;i&#39; loop, you should get the desired result. But like Comintern, I&#39;m not sure what you are trying to achieve"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5978172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10105298382930019/picture?type=large", "display_name": "Moiz Kapadia", "link": "https://stackoverflow.com/users/5978172/moiz-kapadia"}, "edited": false, "score": 0, "creation_date": 1473951833, "post_id": 39364045, "comment_id": 66344694, "body": "Thank you, the first suggestion you made is what I was looking for. If I wanted to fix the row and add numbers across columns, should I make the column letters a variable?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 73, "user_id": 5978172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10105298382930019/picture?type=large", "display_name": "Moiz Kapadia", "link": "https://stackoverflow.com/users/5978172/moiz-kapadia"}, "edited": false, "score": 0, "creation_date": 1473952543, "post_id": 39364045, "comment_id": 66345169, "body": "not sure what you mean, but you can use numeric indexs for columns. too like <code>Cells(1, i).value = Cells.item(2, i) * (i - 1) * (1 - alpha)</code> where rows 1 and 2 are <i>fixed</i>  and you iterate through columns with <code>i</code>. But in this case take care not to overwrite what&#39;s actually in &quot;B2&quot;"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1473234254, "creation_date": 1473234254, "answer_id": 39364045, "question_id": 39359695, "link": "https://stackoverflow.com/questions/39359695/parallel-for-loops-in-vba/39364045#39364045", "title": "Parallel for loops in VBA", "body": "<p>your question/aim isn't very clear so here are some possible blind shots:</p>\n\n<ol>\n<li><p>place from cell \"A1\" down to a predefined rows number (<code>EndNumber</code>) the result of multiplying cell \"B1\" value by a number from 0 to <code>(currentRowIndex- 1) * (1 - alpha)</code>, where <code>currentRowIndex</code> is the row index of the current cell in column \"A\" being written and <code>alpha</code> varies from 0 to 10 (...) </p>\n\n<p>then you'd go:</p>\n\n<pre><code>Option Explicit\n\nSub find_alpha1()\n    Dim StartNumber As Long\n    Dim EndNumber As Long\n    Dim i As Long\n    Dim alpha As Long\n\n    StartNumber = 1\n    EndNumber = 39\n    For alpha = 0 To 10\n        For i = StartNumber To EndNumber\n            Cells(i, \"A\").value = Cells.item(1, \"B\") * (i - 1) * (1 - alpha)\n        Next i\n    Next alpha\nEnd Sub\n</code></pre>\n\n<p>the same code could be rewritten as follows:</p>\n\n<pre><code>Option Explicit\n\nSub find_alpha2()\n    Dim EndNumber As Long\n    Dim alpha As Long\n\n    EndNumber = 39\n    For alpha = 0 To 10\n        With Range(\"A1\").Resize(EndNumber)\n            .FormulaR1C1 = \"=R1C2*(ROW()-1)*(1-\" &amp; alpha &amp; \")\"\n            .Value=.Value '&lt;--| get rid of the formula and leave values only\n        End With\n    Next alpha\nEnd Sub\n</code></pre>\n\n<p>but there would be the issue that those column \"A\" cells would be rewritten at every <code>For alpha = 0 To 10</code> loop ... (see below)</p></li>\n<li><p>place in columns starting from \"A\" rightwards from row 1 to a predefined rows number (<code>EndNumber</code>) the results of multiplying cell \"B1\" value by a number from 0 to <code>(currentRowIndex- 1) * (1 - alpha)</code>, where <code>currentRowIndex</code> is the row index of the current cell in current column being written and with columns shifting rightwards at every <code>alpha</code> loop from 0 to 10</p>\n\n<p>for such a task you actually need to write cells from row 2 downwards in order not to overwrite cell \"B1\"</p>\n\n<p>then you'd go:</p>\n\n<pre><code>Option Explicit\n\nSub find_alpha3()\n    Dim EndNumber As Long\n    Dim alpha As Long\n\n    EndNumber = 39\n    For alpha = 0 To 10\n        With Range(\"A2\").Offset(, alpha).Resize(EndNumber)\n           .FormulaR1C1 = \"=R1C2*(ROW()-2)*(1-\" &amp; alpha &amp; \")\"\n           .value = .value '&lt;--| get rid of the formula and leave values only\n        End With\n    Next alpha\nEnd Sub\n</code></pre></li>\n<li><p>If not 1 or 2 then what?</p></li>\n</ol>\n"}], "owner": {"reputation": 73, "user_id": 5978172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10105298382930019/picture?type=large", "display_name": "Moiz Kapadia", "link": "https://stackoverflow.com/users/5978172/moiz-kapadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 0, "accepted_answer_id": 39364045, "answer_count": 1, "score": 1, "last_activity_date": 1473234254, "creation_date": 1473208739, "last_edit_date": 1473209080, "question_id": 39359695, "link": "https://stackoverflow.com/questions/39359695/parallel-for-loops-in-vba", "title": "Parallel for loops in VBA", "body": "<p>this is my first time using VBA. My goal is to create a column of values that are the result of evaluating a function. Here is a simplified version of how I'm structuring my code. </p>\n\n<pre><code>Sub find_alpha()\n    Dim StartNumber As Integer\n    Dim EndNumber As Integer\n    Dim i As Integer\n    Dim alpha As Integer\n    EndNumber = 39\n    For alpha = 0 To 10\n        For StartNumber = 1 To EndNumber\n            For i = 0 To 38\n                Cells(StartNumber, \"A\").Value = Cells.Item(1, \"B\") * i * (1 - alpha)\n            Next i\n        Next StartNumber\n    Next alpha\nEnd Sub\n</code></pre>\n\n<p>This doesn't work because it loops from 0 to 38 in only one cell, while I need it to actually move through and add the value to each cell. So the value at i=0, should go to A1, i=2 should go to A2, i=3 should go to A3, etc. </p>\n\n<p>Is there a way to move through the loop in parallel to accomplish this?</p>\n\n<p>Thank you!! </p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1473205491, "post_id": 39359307, "comment_id": 66048330, "body": "Yesss! this is it! Thank you @Tim Williams"}, {"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1473206163, "post_id": 39359307, "comment_id": 66048501, "body": "I see what you mean about excluding Sheet 1 from the search. I actually just needed it to go through 2 different sheets so I just copied this macro twice and set the sheet to be sheet 2 in one macro and sheet 3 in another <code>Set Sheet = Sheets(&quot;Sheet 2&quot;)</code> i needed it to contain the word &quot;date&quot; just like you coded it."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473258348, "post_id": 39359307, "comment_id": 66073041, "body": "@TimWilliams, just to say that <code>Sheet.UsedRange.Rows(1).Cells</code> isn&#39;t bound to return the <i>real</i> row 1 of Sheet1 ..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473259760, "post_id": 39359307, "comment_id": 66074192, "body": "@user3598756 - I know that, but since the OP expects their headers in Row 1 then in this case it should."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473260151, "post_id": 39359307, "comment_id": 66074515, "body": "@TimWilliams, I guessed that. I wanted to point it out just for other people reading this post and with possible different (more general) needs as to this specific issue"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473266787, "post_id": 39359307, "comment_id": 66078642, "body": "@user3598756 - agreed it&#39;s something which is often assumed and doesn&#39;t always hold true..."}, {"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1474057289, "post_id": 39359307, "comment_id": 66393045, "body": "@TimWilliams  is there a way to not only copy the string in &quot;L3&quot;  which is actually a text sating &quot;YYYY-MM-DD&quot; to let the user know this is what I want you to enter here but also enfroce a yyyy/mm/dd format? I tried adding this inside the IF statement but they dont seem to work <code>.NumberFormat = &quot;yyyy&#47;mm&#47;dd&quot;</code> I also tried <code>&#39;ActiveSheet.Name = Format$(Date, &quot;yyyy&#47;mm&#47;dd&quot;)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1474057950, "post_id": 39359307, "comment_id": 66393339, "body": "See my edit - not following what you want to do with the sheet name but you cannot use <code>&#47;</code> there..."}, {"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1474059025, "post_id": 39359307, "comment_id": 66393783, "body": "@TimWilliams That did it! thank you once again, you are my hero!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1474057881, "last_edit_date": 1474057881, "creation_date": 1473205302, "answer_id": 39359307, "question_id": 39359205, "link": "https://stackoverflow.com/questions/39359205/how-do-i-find-a-string-keyword-and-paste-something-to-the-row-below-it-when-the/39359307#39359307", "title": "How do I find a string keyword and paste something to the row below it when the string is matched?", "body": "<p>This would be more straightforward without using Find()</p>\n\n<p>It's not clear whether you're looking for cells which <em>contain</em> date, or just cells with the value \"date\".</p>\n\n<p>Or whether you want to exclude Sheet1 from the search</p>\n\n<pre><code>Sub FindAndPaste()\n\n    Dim Sheet, wb As workbook\n    Dim c As Range, arrSheets\n\n    Set wb = ThisWorkbook\n\n    arrSheets = Array(wb.sheets(\"Sheet2\"), wb.sheets(\"Sheet3\"))\n\n    For Each Sheet In arrSheets\n        For Each c in Sheet.UsedRange.Rows(1).Cells\n            If c.value like \"*date*\" Then\n                wb.Sheets(\"Sheet1\").Range(\"L3\").Copy c.Offset(1,0)\n                c.Offset(1,0).NumberFormat = \"yyyy/mm/dd\" '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;EDIT \n            End If\n        Next c\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1473206079, "creation_date": 1473206079, "answer_id": 39359405, "question_id": 39359205, "link": "https://stackoverflow.com/questions/39359205/how-do-i-find-a-string-keyword-and-paste-something-to-the-row-below-it-when-the/39359405#39359405", "title": "How do I find a string keyword and paste something to the row below it when the string is matched?", "body": "<p>Try this</p>\n\n<pre><code>Sub FindAndPaste()\n\nDim sht As Worksheet\nDim Loc As Range, founds As Range\nDim firstAddress As String\n\nFor Each sht In ThisWorkbook.Worksheets\n    Set founds = sht.Cells(2,1)\n    With Intersect(sht.Rows(1), sht.UsedRange)\n        Set Loc = .Find(What:=\"date\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n        If Not Loc Is Nothing Then\n            firstAddress = Loc.Address\n            Do\n                Set founds = Union(founds, Loc)\n                Set Loc = .FindNext(Loc)\n            Loop While Not Loc.Address &lt;&gt;firstAddress\n            Intersect(.Cells,founds).Offset(1).Value =Sheets(\"Sheet1\").Range(\"L3\").Value\n        End If\n    End With\nNext sht\n\nEnd Sub\n</code></pre>\n\n<p>While if you need to find a header containg \"date\" than just substitute <code>LookAt:=xlWhole</code> with <code>LookAt:=xlPart</code></p>\n"}], "owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 39359307, "answer_count": 2, "score": 0, "last_activity_date": 1474057881, "creation_date": 1473204577, "question_id": 39359205, "link": "https://stackoverflow.com/questions/39359205/how-do-i-find-a-string-keyword-and-paste-something-to-the-row-below-it-when-the", "title": "How do I find a string keyword and paste something to the row below it when the string is matched?", "body": "<p>I am very new to VBA. I am trying to write a macro that will search for the word \"date\" in all the header names (all variables names in Row 1) and will copy a cell (from another sheet) into the row under the headers where the matches are found (Row 2).</p>\n\n<p>The pasting part does not work currently and I am having it search the whole workbook as I did not know how to set it to search only the header row.</p>\n\n<pre><code>Sub FindAndPaste()\n\nDim Sheet As Worksheet\nDim Loc As Range\n\nFor Each Sheet In ThisWorkbook.Worksheets\n    With Sheet.UsedRange\n    Set Loc = .Cells.Find(What:=\"date\")\n    If Not Loc Is Nothing Then\n        Do Until Loc Is Nothing\n            Sheets(\"Sheet1\").Range(\"L3\").Copy\n            Loc.Value.Offset(1, 0).PasteSpecial xlPasteAll\n            Set Loc = .FindNext(Loc)\n        Loop\n    End If\nEnd With\nSet Loc = Nothing\nNext\nEnd Sub\n</code></pre>\n\n<p>I also tried changing the part inside the Do Until loop by changing it to the code below but that did not seem to work either. </p>\n\n<pre><code>Do Until Loc Is Nothing\n    copiedval = Sheets(\"Sheet1\").Range(\"L3\").Copy\n    Loc.Value.Offset(1, 0).Value = copiedval\n    Set Loc = .FindNext(Loc)\nLoop\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473236813, "post_id": 39358825, "comment_id": 66058370, "body": "<a href=\"http://allenbrowne.com/casu-14.html\" rel=\"nofollow noreferrer\">Calculated fields belong in queries, not tables.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3917, "user_id": 1275255, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/40ffdb2f9ea3c58d2d8b5d53d23308cd?s=128&d=identicon&r=PG", "display_name": "Ivan Cachicatari", "link": "https://stackoverflow.com/users/1275255/ivan-cachicatari"}, "is_accepted": false, "score": 1, "last_activity_date": 1473207620, "creation_date": 1473207620, "answer_id": 39359595, "question_id": 39358825, "link": "https://stackoverflow.com/questions/39358825/access-vba-docmd-run-sql-creating-tables-with-field-types-containing-expressi/39359595#39359595", "title": "Access VBA - DoCmd. Run SQL Creating Tables with field types containing expressions", "body": "<p>MS Access doesn't support keys as functions but the multiple fields in unique key are allowed:</p>\n\n<p>VBA code:</p>\n\n<pre><code>DoCmd.RunSQL \"CREATE TABLE MyTable([ID] INT PRIMARY KEY, \" &amp; _\n              \"[PNO] DOUBLE, [DD] DATE, [OP] TEXT(255), \" &amp; _\n              \"CONSTRAINT unique_index_name UNIQUE ([PNO],[DD],[OP]) )\"\n</code></pre>\n\n<p>SQL code:</p>\n\n<pre><code>CREATE TABLE MyTable(\n   [ID] INT PRIMARY KEY, \n   [PNO] DOUBLE,\n   [DD] DATE, \n   [OP] TEXT(255), \n   CONSTRAINT unique_index_name UNIQUE ([PNO],[DD],[OP]) \n );\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6802308, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206290677820764/picture?type=large", "display_name": "Sameer Mirza Beg", "link": "https://stackoverflow.com/users/6802308/sameer-mirza-beg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3474, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473207620, "creation_date": 1473201651, "question_id": 39358825, "link": "https://stackoverflow.com/questions/39358825/access-vba-docmd-run-sql-creating-tables-with-field-types-containing-expressi", "title": "Access VBA - DoCmd. Run SQL Creating Tables with field types containing expressions", "body": "<p>I am trying to create a SQL query that will create a table.</p>\n\n<p>However, one of the fields will contain an expression. This is what my expression looks like.</p>\n\n<p><strong>Docmd. Run SQL \"CREATE MyTable ([ID] PRIMARY KEY, [PNO] DOUBLE, [DD] DATE, [OP] TEXT(255), [UNIQUEKEY] FUNCTION([PNO]&amp;[DD]&amp;[OP]))\"</strong></p>\n\n<p>However, I am getting a syntax error which I am assuming that VBA does not recognize the FUNCTION as a data type. The UNIQUEKEY is supposed to be a concatenation of three fields as you all can probably tell. Any idea what I should do?</p>\n\n<p>What is the correct field type for an expression in access VBA?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["r", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1473203435, "post_id": 39358630, "comment_id": 66047814, "body": "<code>Attributes</code> is a 2-D array of values from the range you specified.  You cannot write that as a string on the command line like that.  You could consider writing the range to a text file and then passing the file path to your R script"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1473206336, "post_id": 39358630, "comment_id": 66048548, "body": "Indeed as @TimWilliams mentions, your range is not scalar values used to pass args at command line. In fact it is a fairly long table-like range of 3 columns, 66 rows. Consider saving as txt/csv to be read in R with <code>read.table()</code> into df or <code>readLines()</code> into list."}, {"owner": {"reputation": 15, "user_id": 5415477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc4443dce740248976970119eab63a7e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Sweet", "link": "https://stackoverflow.com/users/5415477/j-sweet"}, "edited": false, "score": 0, "creation_date": 1473265503, "post_id": 39358630, "comment_id": 66077982, "body": "Very helpful comments. I was able to find code to write to a csv file for later use in R. Thank you for the guidance!"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 5415477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc4443dce740248976970119eab63a7e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Sweet", "link": "https://stackoverflow.com/users/5415477/j-sweet"}, "is_accepted": true, "score": 0, "last_activity_date": 1473265743, "creation_date": 1473265743, "answer_id": 39375129, "question_id": 39358630, "link": "https://stackoverflow.com/questions/39358630/using-vba-to-send-data-to-r/39375129#39375129", "title": "using VBA to send data to R", "body": "<p>This code did the trick to write to a csv file: <a href=\"http://www.excel-easy.com/vba/examples/write-data-to-text-file.html\" rel=\"nofollow\">http://www.excel-easy.com/vba/examples/write-data-to-text-file.html</a></p>\n\n<pre><code>Private Sub CommandButton21_Click()\nDim myFile As String, rng As Range, cellValue As Variant, i As Integer, j As Integer\n\nmyFile = \"...\\test.csv\"\nSet rng = Selection\n\nOpen myFile For Output As #1\n\nFor i = 1 To rng.Rows.Count\n  For j = 1 To rng.Columns.Count\n        cellValue = rng.Cells(i, j).Value\n\n        If j = rng.Columns.Count Then\n            Write #1, cellValue\n        Else\n            Write #1, cellValue,\n        End If\n    Next j\nNext i\n\nClose #1\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5415477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc4443dce740248976970119eab63a7e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Sweet", "link": "https://stackoverflow.com/users/5415477/j-sweet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 39375129, "answer_count": 1, "score": 0, "last_activity_date": 1473265743, "creation_date": 1473200058, "question_id": 39358630, "link": "https://stackoverflow.com/questions/39358630/using-vba-to-send-data-to-r", "title": "using VBA to send data to R", "body": "<p>First of all, I am new to excel Visual Basic. I am attempting to write code that takes 3 columns of user-defined data to use in R (for graphing purposes). User will hit button in excel that creates graph output from R. I have been able to, at the very least, interact with R following this example: <a href=\"http://shashiasrblog.blogspot.com/2013/10/vba-front-end-for-r.html\" rel=\"nofollow\">http://shashiasrblog.blogspot.com/2013/10/vba-front-end-for-r.html</a></p>\n\n<p>I am having trouble extending this to include multiple cell inputs and form a data frame in R. Here is my attempt:</p>\n\n<pre><code>Sub RunRscript()\nDim shell As Object\nSet shell = VBA.CreateObject(\"WScript.Shell\")\nDim waitTillComplete As Boolean: waitTillComplete = True\nDim style As Integer: style = 1\nDim errorCode As Integer\nDim Attributes() As Variant\nAttributes = Sheet55.Range(\"A2:C68\")\n\nDim path As String\npath = \"RScript S:\\...\\test.R \" &amp; Attributes\nerrorCode = shell.Run(path, style, waitTillComplete)\n\nEnd Sub\n</code></pre>\n\n<p>I am getting an error: \"Compile error: Type mismatch\". I'm assuming I'm defining Attributes() incorrectly. Any help or direction to literature/tutorials is greatly appreciated! In all honesty, I'm not understanding the path and errorCode lines.</p>\n\n<p>Thanks all,\nJ</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 14076573, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d79f2d6b630bd25fd299311dcef6406c?s=128&d=identicon&r=PG", "display_name": "Admin OD46", "link": "https://stackoverflow.com/users/14076573/admin-od46"}, "is_accepted": false, "score": 0, "last_activity_date": 1596995449, "creation_date": 1596995449, "answer_id": 63329566, "question_id": 39358547, "link": "https://stackoverflow.com/questions/39358547/outlook-vba-jump-to-actual-folder-from-favorite/63329566#63329566", "title": "outlook vba jump to actual folder from favorite", "body": "<p>I've been using this for #1 forever. Answering this question, I've solved it in part for #2.</p>\n<p>The 2 macros find the folder of the currently selected email or finds a folder by name.\nI've only updated the 1st macro for now.</p>\n<p>Private m_Folder As Outlook.MAPIFolder\nPrivate m_Find As String\nPrivate m_Wildcard As Boolean</p>\n<p>'Jumps to the folder based on currently selected email - works great from a search or search folder\n'Offers to Jump to the folder (if it was also in the favorites view)</p>\n<pre><code>Public Sub GetItemsFolderPath()\n  \n  Dim obj As Object\n  Dim F As Outlook.MAPIFolder\n  Dim Msg$\n  Set obj = Application.ActiveWindow\n  \n  If TypeOf obj Is Outlook.Inspector Then\n    Set obj = obj.CurrentItem\n  Else\n    Set obj = obj.Selection(1)\n  End If\n  Set F = obj.Parent\n  Debug.Print F.FolderPath\n  Debug.Print Application.ActiveExplorer.NavigationPane.CurrentModule.NavigationModuleType\n  Debug.Print Application.ActiveExplorer.NavigationPane.CurrentModule\n  Msg = &quot;The path is: &quot; &amp; F.FolderPath &amp; vbCrLf\n  'ModuleValue : Folder = 6 / Mail = 1\n  Msg = Msg &amp; &quot;Switch to the folder?&quot;\n  If MsgBox(Msg, vbYesNo) = vbYes Then\n    Set Application.ActiveExplorer.CurrentFolder = F\n  End If\n  \n  ' If the found folder is a favorite... offer option to jump out of Mail ( favorites view )\n    ' Should be able to figure it out prompting user (me) but this works for now\n  If Application.ActiveExplorer.NavigationPane.CurrentModule.NavigationModuleType = 0 Then\n    Msg = &quot;If your folder is in your favorites list, you can Jump from Favorites. Do so now ? &quot;\n    If MsgBox(Msg, vbYesNo) = vbYes Then\n      'The below does this &quot;Set Application.ActiveExplorer.NavigationPane.CurrentModule.NavigationModuleType = 6&quot;\n      'Toggle Back\n      Set Application.ActiveExplorer.NavigationPane.CurrentModule = Application.ActiveExplorer.NavigationPane.Modules(6)\n      'Toggle Back\n      Set Application.ActiveExplorer.NavigationPane.CurrentModule = Application.ActiveExplorer.NavigationPane.Modules(1)\n    End If\n  End If\nEnd Sub\n\n'Find a folder by name - case sensitive\n\nPublic Sub FindFolder()\n  Dim Name$\n  Dim Folders As Outlook.Folders\n\n  Set m_Folder = Nothing\n  m_Find = &quot;&quot;\n  m_Wildcard = False\n\n  Name = InputBox(&quot;Find Name:&quot;, &quot;Search Folder&quot;)\n  If Len(Trim$(Name)) = 0 Then Exit Sub\n  m_Find = Name\n\n  m_Find = LCase$(m_Find)\n  m_Find = Replace(m_Find, &quot;%&quot;, &quot;*&quot;)\n  m_Wildcard = (InStr(m_Find, &quot;*&quot;))\n\n  Set Folders = Application.Session.Folders\n  LoopFolders Folders\n\n  If Not m_Folder Is Nothing Then\n    If MsgBox(&quot;Activate Folder: &quot; &amp; vbCrLf &amp; m_Folder.FolderPath, vbQuestion Or vbYesNo) = vbYes Then\n      Set Application.ActiveExplorer.CurrentFolder = m_Folder\n    End If\n  Else\n    MsgBox &quot;Not Found&quot;, vbInformation\n  End If\nEnd Sub\n\n'used by the search to loop through\n\nPrivate Sub LoopFolders(Folders As Outlook.Folders)\n  Dim F As Outlook.MAPIFolder\n  Dim Found As Boolean\n\n  For Each F In Folders\n    If m_Wildcard Then\n      Found = (LCase$(F.Name) Like m_Find)\n    Else\n      Found = (LCase$(F.Name) = m_Find)\n    End If\n\n    If Found Then\n      Set m_Folder = F\n      Exit For\n    Else\n      LoopFolders F.Folders\n      If Not m_Folder Is Nothing Then Exit For\n    End If\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4744372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34f8bc2ee2cda3dd228f900bd452e3cc?s=128&d=identicon&r=PG", "display_name": "Victor Onrust", "link": "https://stackoverflow.com/users/4744372/victor-onrust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1596995449, "creation_date": 1473199574, "last_edit_date": 1473201834, "question_id": 39358547, "link": "https://stackoverflow.com/questions/39358547/outlook-vba-jump-to-actual-folder-from-favorite", "title": "outlook vba jump to actual folder from favorite", "body": "<p>Is there a way to (in VBA)</p>\n\n<p>(1) jump from a folder in the outlook favorites pane to the actual folder in the tree pane and </p>\n\n<p>(2) is there a way to establish if the \"selected\" folder is in the tree or in the favorites pane? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473199969, "post_id": 39358509, "comment_id": 66047041, "body": "You&#39;d use a nested loop to compare the two collections.  Have you tried that?"}, {"owner": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473202280, "post_id": 39358509, "comment_id": 66047543, "body": "I tried during a nested For Each loop (outside loop for List 1, inside loop for List 2), and an innermost if loop to see if one variant from List 1 matches one variant from List 2. The problem is that it only does a variant by variant comparison, when in reality I need it to compare all 3 variants from List2 with a variant from List1"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "edited": false, "score": 0, "creation_date": 1473202381, "post_id": 39358755, "comment_id": 66047565, "body": "I&#39;ll give it a go, but other people will be the end users. I&#39;m not sure if they have the aptitude/security clearance to understand or install references."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "edited": false, "score": 0, "creation_date": 1473202478, "post_id": 39358755, "comment_id": 66047583, "body": "@Plaxerous - The reference is stored in the Excel file, and the .dll should be on any reasonably modern (i.e. post around 2000) Windows machine."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1473201187, "creation_date": 1473201187, "answer_id": 39358755, "question_id": 39358509, "link": "https://stackoverflow.com/questions/39358509/i-have-two-collections-how-do-i-create-a-new-collection-that-extracts-the-diffe/39358755#39358755", "title": "I have two Collections. How do I create a new Collection that extracts the difference between the existing two Collections?", "body": "<p>This is better suited for a Scripting.Dictionary than a <code>Collection</code>, because a <code>Collection</code> doesn't have an <code>.Exists</code> function:</p>\n\n<pre><code>Dim list1 As New Scripting.Dictionary\nDim list2 As New Scripting.Dictionary\n\nWith list1\n    .Add \"Soap\", vbNull\n    .Add \"Toothbrush\", vbNull\n    .Add \"Toothpaste\", vbNull\n    .Add \"Showercap\", vbNull\n    .Add \"Shampoo\", vbNull\nEnd With\n\nWith list2\n    .Add \"Toothbrush\", vbNull\n    .Add \"Toothpaste\", vbNull\n    .Add \"Shampoo\", vbNull\nEnd With\n\nDim differences As New Scripting.Dictionary\nDim key As Variant\nFor Each key In list1.Keys\n    If Not list2.Exists(key) Then differences.Add key, vbNull\nNext\n\nFor Each key In list2.Keys\n    If Not list1.Exists(key) Then differences.Add key, vbNull\nNext\n\nFor Each key In differences\n    Debug.Print key\nNext\n</code></pre>\n\n<p>Note - this requires a reference to \"Microsoft Scripting Runtime\".  You can add one with Tools->References... from the menu, then find it and check the box next to it.</p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "edited": false, "score": 0, "creation_date": 1473258830, "post_id": 39359041, "comment_id": 66073452, "body": "Thanks! This worked great. Only error is that you forget to Dim elm As Variant in your function."}, {"owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "reply_to_user": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "edited": false, "score": 0, "creation_date": 1473347144, "post_id": 39359041, "comment_id": 66114906, "body": "Glad it worked, I didn&#39;t have to dim elm in my version for some reason. Please accept as answer if you are using it :)"}], "tags": [], "owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "is_accepted": true, "score": 0, "last_activity_date": 1473203233, "creation_date": 1473203233, "answer_id": 39359041, "question_id": 39358509, "link": "https://stackoverflow.com/questions/39358509/i-have-two-collections-how-do-i-create-a-new-collection-that-extracts-the-diffe/39359041#39359041", "title": "I have two Collections. How do I create a new Collection that extracts the difference between the existing two Collections?", "body": "<p>I would:</p>\n\n<p>1) create a function to see if the item exists\n2) then check each collection by looping through it\n3) add to a 3rd collection if it isn't found</p>\n\n<p>example</p>\n\n<pre><code>Sub test()\n\nDim List1 As New Collection\nDim List2 As New Collection\nDim List3 As New Collection\n\nWith List1\n    .Add \"Soap\"\n    .Add \"Toothbrush\"\n    .Add \"Toothpaste\"\n    .Add \"Showercap\"\n    .Add \"Shampoo\"\nEnd With\n\nWith List2\n    .Add \"Toothbrush\"\n    .Add \"Toothpaste\"\n    .Add \"Shampoo\"\nEnd With\n\nFor Each Item In List1\n    If Not Exists(List2, Item) Then\n        List3.Add (Item)\n    End If\nNext\n\nFor Each Item In List2\n    If Not Exists(List1, Item) Then\n        List3.Add (Item)\n    End If\nNext\n\nEnd Sub\n\n\nPublic Function Exists(col As Collection, key As Variant) As Boolean\n    Exists = False\n\n    For Each elm In col\n        If key = elm Then\n            Exists = True\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473206840, "post_id": 39359277, "comment_id": 66048679, "body": "You&#39;re missing a <code>&quot;</code> after <code>||</code>.  ;-)"}, {"owner": {"reputation": 6793, "user_id": 58845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d71b3a2fa0cdb2eb54921626292ef7b8?s=128&d=identicon&r=PG", "display_name": "jtolle", "link": "https://stackoverflow.com/users/58845/jtolle"}, "edited": false, "score": 0, "creation_date": 1473207639, "post_id": 39359277, "comment_id": 66048856, "body": "What happens if there is another list element with the value &quot;Tooth&quot;?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473207808, "post_id": 39359277, "comment_id": 66048893, "body": "I&#39;d also add a test for <code>If elem &lt;&gt; vbNullString</code> when you build the return <code>Collection</code> - it will end up with empty elements without it."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473230131, "post_id": 39359277, "comment_id": 66054474, "body": "@Comintern: fixed typo, thank you. While empty strings are dealt with by means of the elimination of &quot;||&quot; string"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 6793, "user_id": 58845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d71b3a2fa0cdb2eb54921626292ef7b8?s=128&d=identicon&r=PG", "display_name": "jtolle", "link": "https://stackoverflow.com/users/58845/jtolle"}, "edited": false, "score": 0, "creation_date": 1473230164, "post_id": 39359277, "comment_id": 66054488, "body": "@jtolle, edited to handle possible substrings. thanks for the catch"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473230049, "last_edit_date": 1473230049, "creation_date": 1473205148, "answer_id": 39359277, "question_id": 39358509, "link": "https://stackoverflow.com/questions/39358509/i-have-two-collections-how-do-i-create-a-new-collection-that-extracts-the-diffe/39359277#39359277", "title": "I have two Collections. How do I create a new Collection that extracts the difference between the existing two Collections?", "body": "<p>Assuming (as per you example) that collection elements are <code>String</code>s, I propose you the following \"out of the box\" approach:</p>\n\n<p><strong>edited</strong> to account for possible substrings and fix a typo</p>\n\n<pre><code>Option Explicit\n\nSub Main()\n    Dim List1 As New Collection\n    Dim List2 As New Collection\n    Dim List3 As Collection\n\n    With List1\n        .Add \"Soap\"\n        .Add \"Toothbrush\"\n        .Add \"Toothpaste\"\n        .Add \"Showercap\"\n        .Add \"Shampoo\"\n    End With\n\n    With List2\n        .Add \"Toothbrush\"\n        .Add \"Toothpaste\"\n        .Add \"Shampoo\"\n    End With\n\n    Set List3 = GetDifferenceList(List1, List2)\n\nEnd Sub\n\n\nFunction GetDifferenceList(List1 As Collection, List2 As Collection) As Collection\n    Dim list1Strng As String\n    Dim c As New Collection\n    Dim elem As Variant\n\n    list1Strng = GetListString(List1)\n    For Each elem In List2\n        list1Strng = Replace(list1Strng, \"|\" &amp; CStr(elem) &amp; \"|\", \"|\")\n    Next elem\n    list1Strng = Replace(list1Strng, \"||\", \"|\")\n    list1Strng = Mid(list1Strng, 2, Len(list1Strng) - 2)\n\n    For Each elem In Split(list1Strng, \"|\")\n      c.Add elem\n    Next elem\n\n    Set GetDifferenceList = c\nEnd Function\n\n\nFunction GetListString(List As Collection) As String\n    Dim elem As Variant\n\n    For Each elem In List\n        GetListString = GetListString &amp; CStr(elem) &amp; \"|\"\n    Next elem\n    GetListString = \"|\" &amp; GetListString\n    GetListString = Replace(GetListString, \"||\", \"|\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 0, "accepted_answer_id": 39359041, "answer_count": 3, "score": 1, "last_activity_date": 1473230049, "creation_date": 1473199387, "last_edit_date": 1531164843, "question_id": 39358509, "link": "https://stackoverflow.com/questions/39358509/i-have-two-collections-how-do-i-create-a-new-collection-that-extracts-the-diffe", "title": "I have two Collections. How do I create a new Collection that extracts the difference between the existing two Collections?", "body": "<p>Sorry for the wordy title! I have a master collection, let's call it List1, and a secondary collection, let's call it List2. I would like to create List3, which consists of the differences between List1 and List2. I defined my variables as Collections because List2 is dynamic and changes in length (code not shown).</p>\n\n<pre><code>Dim List1 As New Collection\nDim List2 As New Collection\n\nWith List1\n    .Add \"Soap\"\n    .Add \"Toothbrush\"\n    .Add \"Toothpaste\"\n    .Add \"Showercap\"\n    .Add \"Shampoo\"\nEnd With\n\nWith List2\n    .Add \"Toothbrush\"\n    .Add \"Toothapste\"\n    .Add \"Shampoo\"\nEnd With\n</code></pre>\n\n<p>Ideally List3 should be a New Collection that consists only of \"Soap\" and \"Showercap\".</p>\n\n<p>Any help would be appreciated! Thanks.</p>\n"}, {"tags": ["vba", "ssh", "putty", "plink", "console.writeline"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473198969, "post_id": 39358428, "comment_id": 66046749, "body": "Which language is this? You have 3 different ones tagged. vb.net &lt;&gt; vba &lt;&gt; vbscript."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1473200904, "post_id": 39358428, "comment_id": 66047205, "body": "The password prompt obviously doesn&#39;t read from <code>StdIn</code>. For further help please provide more information about the remote system and the actual command you&#39;re running."}, {"owner": {"reputation": 11, "user_id": 6795991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5416e585baaf7de3744ed4e09d7f8214?s=128&d=identicon&r=PG&f=1", "display_name": "Lookin", "link": "https://stackoverflow.com/users/6795991/lookin"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1473202864, "post_id": 39358428, "comment_id": 66047681, "body": "Comintern - it is vba   @AnsgarWiechers Remote system is a modified version of Linux box, and the actual command is &quot;set user password&quot; after executing this command Enter Current Password: prompt comes up and after entering the password Enter New Password prompt is displayed and the Re-enter New Password prompt is displayed"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473212329, "post_id": 39358428, "comment_id": 66049692, "body": "I&#39;d if it&#39;s a remote Linux machine, I&#39;d suggest using Telnet instead.  <a href=\"http://stackoverflow.com/q/5337527/4088852\">This link</a> should get you started."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473228681, "post_id": 39358428, "comment_id": 66053774, "body": "@Comintern Using unsecured telnet protocol to change a password? How can you possibly recommend such non-sense?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 1, "creation_date": 1473251636, "post_id": 39358428, "comment_id": 66068028, "body": "@MartinPrikryl - Fair enough, but only marginally more nonsensical than changing <i>any</i> password via VBA (or any scripting language for that matter). Regardless of the method, the real answer is <i>&quot;Make sure the server admin is happy with, what you are trying to do.&quot;</i>"}, {"owner": {"reputation": 11, "user_id": 6795991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5416e585baaf7de3744ed4e09d7f8214?s=128&d=identicon&r=PG&f=1", "display_name": "Lookin", "link": "https://stackoverflow.com/users/6795991/lookin"}, "edited": false, "score": 0, "creation_date": 1473254645, "post_id": 39358428, "comment_id": 66070284, "body": "If we can have scripts to change password through bash, then I don;t see the point in discussing why vba."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6795991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5416e585baaf7de3744ed4e09d7f8214?s=128&d=identicon&r=PG&f=1", "display_name": "Lookin", "link": "https://stackoverflow.com/users/6795991/lookin"}, "edited": false, "score": 0, "creation_date": 1473253972, "post_id": 39362368, "comment_id": 66069783, "body": "Thank you Martin! finally someone here tried to provide  constructive answer on this query, otherwise I  got vague responses.  Unfortunately switch <code>-t</code> didn&#39;t work. Also regarding the admin being happy with what I am doing, I am the admin for this lab and I am trying it on a test lab :)"}], "tags": [], "owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "is_accepted": false, "score": 2, "last_activity_date": 1488096710, "last_edit_date": 1488096710, "creation_date": 1473228775, "answer_id": 39362368, "question_id": 39358428, "link": "https://stackoverflow.com/questions/39358428/password-is-not-read-while-executing-password-change-command-using-writeline-in/39362368#39362368", "title": "Password is not read while executing password change command using writeline in shell", "body": "<p>The command <code>set user password</code> (or whatever it is) is possibly built to read the password from terminal only, not from a standard input. This is a common security feature to avoid exactly this kind of automatic password change.</p>\n\n<p>Try forcing an interactive/terminal mode using the Plink command-line <a href=\"https://the.earth.li/~sgtatham/putty/latest/htmldoc/Chapter3.html#using-cmdline-pty\" rel=\"nofollow noreferrer\">switch <code>-t</code></a>.</p>\n\n<p>This will make the Plink input be redirected to a virtual terminal and can make your command happy.</p>\n\n<hr>\n\n<p><em>Make sure the server admin is happy with, what you are trying to do.</em></p>\n"}], "owner": {"reputation": 11, "user_id": 6795991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5416e585baaf7de3744ed4e09d7f8214?s=128&d=identicon&r=PG&f=1", "display_name": "Lookin", "link": "https://stackoverflow.com/users/6795991/lookin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1525432571, "creation_date": 1473198881, "last_edit_date": 1525432571, "question_id": 39358428, "link": "https://stackoverflow.com/questions/39358428/password-is-not-read-while-executing-password-change-command-using-writeline-in", "title": "Password is not read while executing password change command using writeline in shell", "body": "<p>I have a code by which I open <code>plink</code> for SSH connection using shell command where I can run any command by <code>StdIn.Writeline</code> method except password change command. If I run a change password command I am unable to input the password by <code>StdIn.Writeline</code> method. The command is like <code>set usr pwd</code>. This command gets executed perfectly and after it executes it asks for \"Enter Current Password\". Here the <code>WriteLine</code> method fails to input the password.</p>\n\n<p>Below is the example of the code and ouput:</p>\n\n<pre><code>Run = filename &amp; \" \" &amp; strCompAddress &amp; \" -P \" &amp; strServerPOrt &amp; \" -l \" &amp; strServerUser &amp; \" -pw \" &amp; strServerPassword\nSet osh = CreateObject(\"Wscript.Shell\")\nSet oEx = osh.exec(Run)\n\noEx.StdIn.WriteLine \"command 1\" 'This command runs fine'\noEx.StdIn.WriteLine \"command 2\" 'This command runs fine'\noEx.StdIn.WriteLine \"command 3\" 'This command runs fine'\noEx.StdIn.WriteLine \"set usr wd\" 'This command runs fine'\noEx.StdIn.WriteLine \"current_pwd\" 'This doesn't input the password and it stucks here  \noEx.StdIn.WriteLine \"new_pwd\"\noEx.StdIn.WriteLine \"new_pwd\"\noEx.StdIn.WriteLine \"exit\"\n</code></pre>\n\n<p>Output is like with lots of escape sequence commands.</p>\n\n<pre>command 1 \ncommand 2\ncommand 3\nset usr pwd\ncurrent_pwd\nnew_pwd\nnew_pwd\nexit\n\nCommand 1\nresult\nok\n\ncommand 2\nresult \nok\n\ncommand 3\nresult\nok\nset usr pwd\nEnter Current Password:</pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1473197511, "post_id": 39358066, "comment_id": 66046183, "body": "Changing an extension from <code>.csv</code> to <code>.xlsx</code> is going to cause you (or, at least, future users) problems.  They will see the <code>.xlsx</code> extension and think that it is an Excel workbook, when it is actually a text file!  (Unless it is already an Excel workbook, which someone has renamed to be <code>.csv</code> in order to confuse <b>you</b>.  In that case, renaming it back would be a good idea.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473197706, "post_id": 39358066, "comment_id": 66046258, "body": "P.S.  Just tested and, sure enough, Excel won&#39;t open it once the extension is changed to <code>.xlsx</code> - it says the file is corrupt (because it thinks it needs to unZIP it, but fails because the first two bytes aren&#39;t &quot;PK&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6802006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3b19d796b0857ad0f31d6705fd0439?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Taormina", "link": "https://stackoverflow.com/users/6802006/nick-taormina"}, "edited": false, "score": 0, "creation_date": 1473351363, "post_id": 39362044, "comment_id": 66117644, "body": "Thank you! This was able to work when I changed the extension from &quot;.xlsx&quot; to &quot;.xls.&quot; If the path changes to E:\\Backup\\ABCDE-01234\\Cases\\ABCDE-01234.A0002\\Exports_filefo&zwnj;&#8203;lderopening\\, would I need to go into the code to change the path every time a change like this is made?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 1, "user_id": 6802006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3b19d796b0857ad0f31d6705fd0439?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Taormina", "link": "https://stackoverflow.com/users/6802006/nick-taormina"}, "edited": false, "score": 0, "creation_date": 1473398458, "post_id": 39362044, "comment_id": 66134036, "body": "Right now, yes. But you can change the code to get the path from a cell on the sheet for example: <code>originalpath = Range(&quot;A1&quot;).Value</code>"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1473227375, "creation_date": 1473227375, "answer_id": 39362044, "question_id": 39358066, "link": "https://stackoverflow.com/questions/39358066/excel-vba-rename-and-save-to-alternate-directory-without-user-intervention/39362044#39362044", "title": "Excel-VBA rename and save to alternate directory without user intervention", "body": "<p>This should work, just make sure that i got your paths and filename patterns right:</p>\n\n<pre><code>Dim file As Variant\nDim wb As Workbook\nDim originalpath As String, newpath As String\n\noriginalpath = \"E:\\Backup\\VSNMM-01691\\Cases\\VSNMM-01691.A0001\\Exports_fileFolderOpening\\\"\nnewpath = \"E:\\Backup\\VSNMM-01691\\Reports\\\"\n\nfile = Dir(originalpath)\n\n'loop through files in original folder\nWhile (file &lt;&gt; \"\")\n\n    'match filename with pattern (# means one number, so 4 single numbers) change this if i did it wrong\n    If file Like \"A####_lp_profile.csv\" Then\n\n        'open the csv file\n        Set wb = Workbooks.Open(originalpath &amp; file)\n\n        'save in new path as xlsx (without the Fileformat, the file will be unreadable\n        wb.SaveAs newpath &amp; Left(file, 5) &amp; \".RecentlyOpenedFiles.LNK.xlsx\", ThisWorkbook.FileFormat\n\n        'close workbook in original path, discard changes\n        wb.Close False\n\n        'clear variable\n        Set wb = Nothing\n    End If\n\n    'next file\n    file = Dir\nWend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6802006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3b19d796b0857ad0f31d6705fd0439?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Taormina", "link": "https://stackoverflow.com/users/6802006/nick-taormina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473227375, "creation_date": 1473197020, "question_id": 39358066, "link": "https://stackoverflow.com/questions/39358066/excel-vba-rename-and-save-to-alternate-directory-without-user-intervention", "title": "Excel-VBA rename and save to alternate directory without user intervention", "body": "<p>I have a series of excel spreadsheets that need to change their filename and save to an alternate path.I have run into a wall trying to attempt this on my own.</p>\n\n<hr>\n\n<p><strong>The original filename:</strong> <em>A0001_lp_profile.csv</em> (the A000# will not always be A0001)</p>\n\n<p><strong>The new filename:</strong> <em>A0001.RecentlyOpenedFiles.LNK.xlsx</em></p>\n\n<p>The first five characters will not change during the rename.</p>\n\n<hr>\n\n<p><strong>The original path:</strong> <em>E:\\Backup\\VSNMM-01691\\Cases\\VSNMM-01691.A0001\\Exports_fileFolderOpening</em></p>\n\n<p><strong>The new path:</strong> <em>E:\\Backup\\VSNMM-01691\\Reports</em></p>\n\n<p>VSNMM-01691 will not always be in the path and changes quite often to something in a similar format. The \"E:\\Backup\\\" will always be the beginning of the path. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1473197402, "creation_date": 1473197402, "answer_id": 39358144, "question_id": 39357883, "link": "https://stackoverflow.com/questions/39357883/subscript-out-of-range-error-9-vba/39358144#39358144", "title": "Subscript out of range error 9 vba", "body": "<p>See: <a href=\"https://stackoverflow.com/questions/38745818/windows-activate-works-on-every-computer-except-one/38748754#38748754\">Windows().Activate works on every computer except one</a></p>\n\n<p>This should fix the issue.</p>\n\n<pre><code>tempstr = \"TSReports\" &amp; Month(gendate) &amp; \"_\" &amp; Day(gendate) &amp; \"_\" &amp; _\n            Year(gendate) &amp; Hour(gendate) &amp; \"h\" &amp; Minute(gendate) &amp; \"m\" &amp; _\n            Second(gendate) &amp; \"s\" &amp; \".xlsx\"\n\nfp = gv.Range(\"b2\").Text &amp; \"\\\" &amp; tempstr \n\nWorkbooks.Add\nApplication.DisplayAlerts = False\nApplication.AlertBeforeOverwriting = False\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs Filename:=fp\nSet dwb = Workbooks(tempstr) \n</code></pre>\n\n<p>However this would be more robust:</p>\n\n<pre><code>Set dwb = Workbooks.Add\nApplication.DisplayAlerts = False\nApplication.AlertBeforeOverwriting = False\nApplication.DisplayAlerts = False\ndwb.SaveAs Filename:=fp\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3740764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hOkbJ.jpg?s=128&g=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/3740764/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473197402, "creation_date": 1473196160, "last_edit_date": 1531164843, "question_id": 39357883, "link": "https://stackoverflow.com/questions/39357883/subscript-out-of-range-error-9-vba", "title": "Subscript out of range error 9 vba", "body": "<p>I am getting a subscript out of range error when another user runs my add in but have no problems when running the same code myself.  This happens when setting a workbook value.  The filename is being generated by getting the current date and stored as gendate.  From this, the filename is created and saved based on the filepath that the user has made.  In this example, the value of gv.Range(\"b2\").text is C:\\Users\\username\\Desktop\\ReportGeneration.  fp is therefore C:\\Users\\dmulhausen\\Desktop\\ReportGeneration\\TSReports9_6_201615h5m32s.xlsx\nThis is not generating an error for me, but it is generating an error for another user of the script.</p>\n\n<pre><code>Dim ai As Workbook  'add in data ---Initialized in Report Setup\nDim dwb As Workbook 'destination workbook ---Initialized in Report Setup\nDim ss As Worksheet 'source sheet\nDim ds As Worksheet 'destination sheet or writing sheet\nDim rv As Worksheet 'reporting variables sheet ---Initialized in Report Setup\nDim pv As Worksheet 'ts variables sheet ---Initialized in Report Setup\nDim gv As Worksheet 'global ai variables ---Initialized in Report Setup\nDim tempstr As String\nDim fp As String 'file path ---Initialized in Report Setup\nDim gendate As Date\nDim reportscreated As Integer\nDim initialized As Boolean\nDim sheetnames(1 To 12) As String\n\nSub reportsetup()\n    Set ai = Workbooks(\"TSReports add in.xlam\")\n    Set rv = ai.Worksheets(\"ReportVars\")\n    Set pv = ai.Worksheets(\"TS1_2Vars\")\n    Set gv = ai.Worksheets(\"globalVars\")\n    If (IsEmpty(gv.Range(\"b2\").Value)) Then\n        MsgBox (\"Please select a designated folder for reports\")\n        With Application.FileDialog(msoFileDialogFolderPicker)\n            .AllowMultiSelect = False\n            .Show\n            If .SelectedItems.Count &gt; 0 Then\n                gv.Range(\"b2\").Value = .SelectedItems(1)\n            End If\n            ai.Save\n        End With\n\n    End If\n    initialized = True\n    gendate = Now()\n    tempstr = \"TSReports\" &amp; Month(gendate) &amp; \"_\" &amp; Day(gendate) &amp; \"_\" &amp; Year(gendate) &amp; Hour(gendate) &amp; \"h\" &amp; Minute(gendate) &amp; \"m\" &amp; Second(gendate) &amp; \"s\"\n    fp = gv.Range(\"b2\").Text &amp; \"\\\" &amp; tempstr &amp; \".xlsx\"\n    Workbooks.Add\n    Application.DisplayAlerts = False\n    Application.AlertBeforeOverwriting = False\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs Filename:=fp\n    Set dwb = Workbooks(tempstr) '*******Error occurs here*******\n</code></pre>\n"}, {"tags": ["matlab", "excel", "batch-processing", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2614, "user_id": 3254869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/O17Z7.jpg?s=128&g=1", "display_name": "zhqiat", "link": "https://stackoverflow.com/users/3254869/zhqiat"}, "is_accepted": false, "score": 1, "last_activity_date": 1473196775, "creation_date": 1473196775, "answer_id": 39358011, "question_id": 39357821, "link": "https://stackoverflow.com/questions/39357821/file-conversion-multiple-dat-files-to-one-xlsx-workbook-with-different-sheets/39358011#39358011", "title": "File Conversion Multiple .DAT files to one xlsx workbook with different sheets", "body": "<p>Each time you use xlswrite, what you are doing is opening an excel instance, trying to write everything to a file, closing the file, and then reopening the file to do this again. Your OS is erroring (presuming you are using windows) out because the file is locked in windows. </p>\n\n<p>What you should do is use the underlying <a href=\"http://www.mathworks.com/help/matlab/ref/actxserver.html\" rel=\"nofollow\">ActiveXServer</a> in excel, write all of your tabs into a spreadsheet once, and then save this. </p>\n\n<p>Your code should broadly read something like this. </p>\n\n<p>Create an excel object and setup a fresh new workbook.</p>\n\n<pre><code>e = actxserver('Excel.Application');\ne.Visible = 1;\nw=Add(e.Workbooks)\n</code></pre>\n\n<p>You should subsequently loop over your data range and write your data in. \nThis code will add a sheet for each item in a loop, change the sheetname, and then create a the following text in each cell. </p>\n\n<pre><code>datasheet=Add(e.Sheets)\ndatasheet.Name=sheetname(n)\ndatasheet.Range('A1:B1').Value='test data or your range'\n</code></pre>\n\n<p>Once you've completed the loop, save the file, and cleanup your excel object.</p>\n\n<pre><code>w.SaveAs('myfile.xls')\nw.Saved = 1;\nw.Close;\nw.delete\n</code></pre>\n\n<p>You should follow the pattern of this <a href=\"http://www.mathworks.com/help/matlab/matlab_external/using-a-matlab-application-as-an-automation-client.html\" rel=\"nofollow\">example</a> on the Matlab help page as well. </p>\n"}], "owner": {"reputation": 23, "user_id": 6321571, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/01abc12baf58a6e9547a5b9a0f3a619d?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6321571/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473196910, "creation_date": 1473195880, "last_edit_date": 1531161705, "question_id": 39357821, "link": "https://stackoverflow.com/questions/39357821/file-conversion-multiple-dat-files-to-one-xlsx-workbook-with-different-sheets", "title": "File Conversion Multiple .DAT files to one xlsx workbook with different sheets", "body": "<p>I have a directory containing with 50 DAT files one base xlsx file in each. I need to make one workbook with those 50 DAT files as an independent worksheet in each folder within directory. The worksheet shall use the columns 3,4,5 from DAT files which is tab separated. The worksheet shall have 6 columns. The first three will be taken from the base xlsx file in the directory. Column 4-6 shall have values from Column 3-5 from .DAT files. I wrote a code in MATLAB to do the needful. Everytime I run it, program crashes. The error I received is </p>\n\n<p>Error using xlswrite (line 219)\nInvoke Error, Dispatch Exception:\nSource: Microsoft Excel\nDescription: Document not saved.\nHelp File: xlmain11.chm\nHelp Context ID: 0.</p>\n\n<p>The code is as follows: In the code, files_larswg is base xlsx file. Is there a procesto rectify the error and make the process a batch process in case I have 10 similar directories. </p>\n\n<pre><code>date=xlsread('files_larswg.xlsx',1,'A2:C18251');\n\n header_tree={ 'da' , 'mo', 'year', 'tminC', 'tmaxC','prcpmm'};\n\nfor k=1:50\n\nk\n\nfileID =fopen(sprintf('FortWayneWG%d.dat',k+516));\n\ndata = textscan(fileID,'%*d %*d %f %f %f');\n\nfclose(fileID);\n\ndata=cell2mat(data);\n\nsheet_no=sprintf('sheet%d',k);\n\nxlswrite('FWYLARSWG_50set.xlsx', data, sheet_no,'D2:F18251');\nxlswrite('FWYLARSWG_50set.xlsx', header_tree, sheet_no,'A1:F1');\nxlswrite('FWYLARSWG_50set.xlsx', date, sheet_no,'A2:C18251');\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473196756, "post_id": 39357766, "comment_id": 66045896, "body": "I think I missed the question somewhere along the line of reading this. Is there a reason you can&#39;t just use the <code>.Top</code> and <code>.Left</code> of the controls themselves? I&#39;m not exactly sure what benefit there is to duplicating them."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1473231686, "post_id": 39357766, "comment_id": 66055408, "body": "Have a look at <a href=\"http://www.cpearson.com/excel/CollectionClass.aspx\" rel=\"nofollow noreferrer\">Custom Collection Classes in VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473196564, "creation_date": 1473196564, "answer_id": 39357969, "question_id": 39357766, "link": "https://stackoverflow.com/questions/39357766/creating-collection-with-class-objects/39357969#39357969", "title": "Creating Collection with Class Objects", "body": "<p>Personally I prefer using arrays over collections.  Perhaps something like this might work for you:</p>\n\n<pre><code>Const lTop As Long = 0      'Use named variable to always work with Top attribute\nConst lLeft As Long = 1     'Use named variable to always work with Left attribute\n\nDim lTabIndex As Long\nDim aTabColumns() As Variant\nReDim aTabColumns(0 To 4, 0 To 1)\n    'The first dimension (0 to 4) is for your tab numbers\n    'The second dimension (0 to 1) shows if you're working with the Top or Left attribute for that tab's column\n    'Example use:   aTabColumns(1, lTop) = aTabColumns(1, lTop) + 40\n\n'Example showing how to loop through the array and set initial values\nFor lTabIndex = LBound(aTabColumns, 1) To UBound(aTabColumns, 1)\n    aTabColumns(lTabIndex, lTop) = StartFromTop\n    aTabColumns(lTabIndex, lLeft) = StartFromLeft\nNext lTabIndex\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "is_accepted": false, "score": 0, "last_activity_date": 1473210507, "creation_date": 1473210507, "answer_id": 39359874, "question_id": 39357766, "link": "https://stackoverflow.com/questions/39357766/creating-collection-with-class-objects/39359874#39359874", "title": "Creating Collection with Class Objects", "body": "<p>Finally got it to work properly using a dictionary</p>\n\n<pre><code>Dim TabAttributes As Dictionary\nDim ColumnAttributes As Dictionary\nDim Column1Info As clsColumn\nDim Column2Info As clsColumn\nDim Column3Info As clsColumn\nDim TabColumnIndex As Integer\n\nSet Column1Info = New clsColumn\nSet Column2Info = New clsColumn\nSet Column3Info = New clsColumn\nSet TabAttributes = New Dictionary\nSet ColumnAttributes = New Dictionary\n\n'set column offsets\nColumn1Info.Left = StartFromLeft\nColumn1Info.Top = StartFromTop\nColumn2Info.Left = StartFromLeft + Column1Width + ColumnGap\nColumn2Info.Top = StartFromTop\nColumn3Info.Left = StartFromLeft + Column1Width + ColumnGap * 2 + Column2Width\nColumn3Info.Top = StartFromTop\n\n'add column offsets to class object\nColumnAttributes.Add 1, Column1Info\nColumnAttributes.Add 2, Column2Info\nColumnAttributes.Add 3, Column3Info\n\n'add class object to each tab index\nFor TabColumnIndex = 0 To 4\n    TabAttributes.Add TabColumnIndex, ColumnAttributes\nNext\n</code></pre>\n\n<p>So now I can get my data like this...</p>\n\n<pre><code>TabAttributes(MyControl.Tabindex)(MyControl.ColumnIndex).Top = 125\n</code></pre>\n\n<p>thanks for the help guys</p>\n"}], "owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1473210507, "creation_date": 1473195626, "question_id": 39357766, "link": "https://stackoverflow.com/questions/39357766/creating-collection-with-class-objects", "title": "Creating Collection with Class Objects", "body": "<p>Im trying to consolodate my code a bit by making the code a little more polymorphic.  I have a userform in which I have 5 tabs.  Each tab has 3 columns in which to place controls dynamically at run time.</p>\n\n<p>I am looking to consolidate all of my Top and Left Positions for each control as i start building this form.</p>\n\n<p>Right now I have variables like this. </p>\n\n<pre><code>Tab0StartFromTop\nTab1StartFromTop\nTab2StartFromTop\nTab3StartFromTop\nTab4StartFromTop\n\nTab0Col1Left\nTab0Col2Left\nTab0Col3Left\n''you get the picture\n</code></pre>\n\n<p>What I'd like to do is something like this</p>\n\n<pre><code>Dim TabAttributes(0 To 4) As Collection\nDim ColumnAttributes As clsColumn ''clsColumn is a class object with properties for both .Top and .Left\nDim ColumnAttributeCollection As Collection\n\n''Load Up my initial data. Distance from top will be incremented as I add controls\nSet ColumnAttributes = New clsColumn\nColumnAttributes.Top = StartFromTop\nColumnAttributes.Left = StartFromLeft\n\n''load all 3 objects into the (0) zero index for tab0\nColumnAttributeCollection(1).Add ColumnAttributes\nColumnAttributeCollection(2).Add ColumnAttributes\nColumnAttributeCollection(3).Add ColumnAttributes\n\n''Now stick it inside my TabAttributes\nTabAttributes(0).add ColumnAttributeCollection\n</code></pre>\n\n<p>so now I could access it like this, or in some way.</p>\n\n<pre><code>For each blah..\n    TabAttributes(MyControl.Tabindex).Column(MyControl.ColumnIndex).Top\n    TabAttributes(MyControl.Tabindex).Column(MyControl.ColumnIndex).Left\nNext\n</code></pre>\n\n<p>also as I loop through each control I will need to adjust the top integer as more controls are added to that specific column on that specific tab.</p>\n\n<pre><code>TabAttributes(MyControl.Tabindex).Column(MyControl.ColumnIndex).Top = _\n     TabAttributes(MyControl.Tabindex).Column(MyControl.ColumnIndex).Top + 40\n</code></pre>\n\n<p>I hope that makes sense.  Thanks in advance for the suggestions. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4777541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/093930d1a4d1f600bf0f9c738ca866bf?s=128&d=identicon&r=PG&f=1", "display_name": "rtemen", "link": "https://stackoverflow.com/users/4777541/rtemen"}, "edited": false, "score": 0, "creation_date": 1473256345, "post_id": 39361922, "comment_id": 66071491, "body": "Yes, my QuoteNumber is on this sheet and is scoped to Workbook. When you emailed the file to your friend, did he get the message that you have to enable editing?  It is when you click the enable editing button that the error occurs."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473226741, "creation_date": 1473226741, "answer_id": 39361922, "question_id": 39357690, "link": "https://stackoverflow.com/questions/39357690/rangemy-name-fails-after-enabling-editing/39361922#39361922", "title": "Range(&quot;My_Name&quot;) fails after enabling editing", "body": "<p>Just to make sure, you defined the Named Range \"<strong>QuoteNumber</strong>\" as a Workbook Scope, right ? Also, \"<strong>QuoteNumber</strong>\" Range is in this WorkBook.</p>\n\n<p>I defined \"<strong>QuoteNumber</strong>\" as a WorkBook scope, and it's Range is in \"<strong>Repot</strong>\" Sheet, I used Range(A1:C10).\nWhen I emailed this Workbook (with the code below attached), and my collegue (on his PC) clicked on one of the cells inside Range(A1:C10) in \"<strong>Report</strong>\" Sheet (cell B3), he got my test <code>MsgBox</code> of \"Row number is 3\".</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)\n\nDim WhichNumbers As String\nDim WhichData As String\nDim WhichStatuses As String\nDim ToAddress As String\nDim CCAddress As String\nDim sFound As String\nDim wsTemp As Workbook\nDim sThisQuoteNumber As String\nDim pdfShell As Object\n\nIf sh.Name = \"Report\" Then\n    ' If we intersect with one of the Quote Numbers, then present him with a view of the PDF of the quote.\n    If Not Intersect(Target, Range(\"QuoteNumber\")) Is Nothing And (Selection.Count = 1) Then\n        iRow = Target.Row\n        MsgBox \"Row number is \" &amp; iRow\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4777541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/093930d1a4d1f600bf0f9c738ca866bf?s=128&d=identicon&r=PG&f=1", "display_name": "rtemen", "link": "https://stackoverflow.com/users/4777541/rtemen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473226741, "creation_date": 1473195308, "last_edit_date": 1531164843, "question_id": 39357690, "link": "https://stackoverflow.com/questions/39357690/rangemy-name-fails-after-enabling-editing", "title": "Range(&quot;My_Name&quot;) fails after enabling editing", "body": "<p>I have a spreadsheet that is Macro Enabled.\nIn the 'ThisWorkbook' area I have a routine to check where users can click.\nHere is an excerpt of the code:</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)\n\nDim WhichNumbers As String\nDim WhichData As String\nDim WhichStatuses As String\nDim ToAddress As String\nDim CCAddress As String\nDim sFound As String\nDim wsTemp As Workbook\nDim sThisQuoteNumber As String\nDim pdfShell As Object\n\nIf sh.Name = \"Report\" Then\n' If we intersect with one of the Quote Numbers, then present him with a view of the PDF of the quote.\nIf Not Intersect(Target, Range(\"QuoteNumber\")) Is Nothing And (Selection.Count = 1) Then\n    iRow = Target.Row\n .....\n</code></pre>\n\n<p>Here is what is happening:\nThis code all works fine.\nI email the file to another user, when he opens it in email, OR if he saves it on his drive and opens it the file looks fine, but has the message at the top saying that you have to enable editing.\nWhen you hit the 'enable' button, the program halts with an error indicating that the Range(\"QuoteNumber\") method fails.\nThe message box allows you to \"end\" or \"Debug\".\nIf you hit 'End', then the message box clears, and the program works OK from this point on.</p>\n\n<p>Any idea what is happening?  How do I stop this from happening so it doesn't 'blow-up' if my users' faces?</p>\n\n<p>Rich</p>\n"}, {"tags": ["python", "vba", "excel", "wsh"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473191415, "post_id": 39356710, "comment_id": 66043487, "body": "I doubt it has ever worked with that path: there are spaces in your paths. How does wsh.Run know how to parse the arguments? At home you certainly had python in <code>C:\\python27</code>."}, {"owner": {"reputation": 41, "user_id": 6801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4685dd318ceb1ded60686ab52ee8408?s=128&d=identicon&r=PG&f=1", "display_name": "Billi B", "link": "https://stackoverflow.com/users/6801795/billi-b"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473192692, "post_id": 39356710, "comment_id": 66044082, "body": "Exactly, that&#39;s what I meant with &quot;there weren&#39;t any blanks in the path&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4685dd318ceb1ded60686ab52ee8408?s=128&d=identicon&r=PG&f=1", "display_name": "Billi B", "link": "https://stackoverflow.com/users/6801795/billi-b"}, "edited": false, "score": 0, "creation_date": 1473192826, "post_id": 39356767, "comment_id": 66044148, "body": "Yes, the path itself is correct. The problem is the spaces in the path. Sadly your solution didn&#39;t work for me."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 41, "user_id": 6801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4685dd318ceb1ded60686ab52ee8408?s=128&d=identicon&r=PG&f=1", "display_name": "Billi B", "link": "https://stackoverflow.com/users/6801795/billi-b"}, "edited": false, "score": 0, "creation_date": 1473281422, "post_id": 39356767, "comment_id": 66085482, "body": "hmm it should.  Here&#39;s another way to do it, <code>&quot;C:\\&quot; &amp; chr(34) &amp; &quot;Program Files (x86)&quot; &amp; chr(34) &amp; &quot;\\Python27\\python.exe C:\\Users\\Markus\\BrowseDirectory.py&quot;</code>  does this work?"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 41, "user_id": 6801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4685dd318ceb1ded60686ab52ee8408?s=128&d=identicon&r=PG&f=1", "display_name": "Billi B", "link": "https://stackoverflow.com/users/6801795/billi-b"}, "edited": false, "score": 0, "creation_date": 1473281541, "post_id": 39356767, "comment_id": 66085549, "body": "Also, <code>wsh.Run myApp, windowStyle, waitOnReturn</code> would be sufficient with my change"}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1473191433, "creation_date": 1473191433, "answer_id": 39356767, "question_id": 39356710, "link": "https://stackoverflow.com/questions/39356710/call-python-script-from-vba-with-wsh/39356767#39356767", "title": "Call python script from vba with wsh", "body": "<p>Did you verify that path takes you directly to the interpreter?</p>\n\n<p>Try this,</p>\n\n<pre><code>Dim myApp As String: myApp = \"C:\\\"\"Program Files (x86)\"\"\\Python27\\python.exe C:\\Users\\Markus\\BrowseDirectory.py\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 6801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4685dd318ceb1ded60686ab52ee8408?s=128&d=identicon&r=PG&f=1", "display_name": "Billi B", "link": "https://stackoverflow.com/users/6801795/billi-b"}, "edited": false, "score": 0, "creation_date": 1473232160, "post_id": 39357131, "comment_id": 66055659, "body": "Thank you for the answer. Sadly neither version works for me. Using the first approach I get error429 ActiveX component can&#39;t create object. The second approach results in error method run of object iwshshell3 failed."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 2, "last_activity_date": 1473193280, "last_edit_date": 1473193280, "creation_date": 1473192910, "answer_id": 39357131, "question_id": 39356710, "link": "https://stackoverflow.com/questions/39356710/call-python-script-from-vba-with-wsh/39357131#39357131", "title": "Call python script from vba with wsh", "body": "<p>The interpreter cannot possibly distinguish directories containing spaces from real arguments unless you protect the directories with quotes.</p>\n\n<p>A workaround, which is actually a better solution, relies on the fact that Python associates <code>.py</code> extension with the installed python interpreter.</p>\n\n<p>Just do this (like you would launch a <code>.bat</code> file):</p>\n\n<pre><code>Dim myApp As String: myApp = \"C:\\Users\\Markus\\BrowseDirectory.py\"\n</code></pre>\n\n<p>and your code will work no matter where python is installed (and the problem with spaces vanishes)</p>\n\n<p>This little test in excel worked for me and ran <code>pycrust.py</code> which happens to be in my system <code>PATH</code>:</p>\n\n<pre><code>Sub foo()\n  Dim wsh As Object\n  Set wsh = VBA.CreateObject(\"WScript.Shell\")\n\n    Dim myApp As String: myApp = \"pycrust.py\"\n    Dim waitOnReturn As Boolean: waitOnReturn = True\n    Dim windowStyle As Integer: windowStyle = 1\n\n    wsh.Run myApp, windowStyle, waitOnReturn\n\nEnd Sub\n</code></pre>\n\n<p>(I had to simplify your <code>wsh.Run</code> line because it was not working, I suspect that the 256 quotes you added didn't do any good)</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 8189434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2e97424e34325a321b14ec383d7ac00?s=128&d=identicon&r=PG&f=1", "display_name": "zlpython", "link": "https://stackoverflow.com/users/8189434/zlpython"}, "is_accepted": false, "score": 0, "last_activity_date": 1500635128, "creation_date": 1500635128, "answer_id": 45236073, "question_id": 39356710, "link": "https://stackoverflow.com/questions/39356710/call-python-script-from-vba-with-wsh/45236073#45236073", "title": "Call python script from vba with wsh", "body": "<p>My script works at my sheet and Python (but I put the sheet and py script in the same folder):</p>\n\n<pre><code>Path = ActiveWorkbook.Path\nPth = \"\"\"\" &amp; Path &amp; \"\\pythonscript_name.py\" &amp; \"\"\"\"\nPh = \"\"\"\" &amp; \"C:\\Python27\\python.exe \" &amp; Pth &amp; \"\"\"\"\n\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\nErrorCode = wsh.Run(Ph, windowStyle, waitOnReturn)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11283536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQ7UE.jpg?s=128&g=1", "display_name": "Nicolas Goulet", "link": "https://stackoverflow.com/users/11283536/nicolas-goulet"}, "is_accepted": false, "score": 0, "last_activity_date": 1554001484, "creation_date": 1554001484, "answer_id": 55437526, "question_id": 39356710, "link": "https://stackoverflow.com/questions/39356710/call-python-script-from-vba-with-wsh/55437526#55437526", "title": "Call python script from vba with wsh", "body": "<p>I do not know if this could have solved your problem, but I encountered the same problem when trying to launch a python script \"frozen\" with CX-Freeze (from VBA with wsh). Everything worked fine until I changed the folder name of my EXE file to a name with spaces. I did not understand the problem until I read your post and your mention of blank spaces.</p>\n\n<p>I found a function on the internet (maybe here on SO, I don't remember) that gives me the name of the folder in DOS. If like me, you have to pass some parameters that are folder names, then reuse the function to give you the names in DOS.</p>\n\n<p>Here is the function found on internet:</p>\n\n<pre><code>Public Function GetShortFileName(ByVal FullPath As String) As String\n\n'PURPOSE: Returns DOS File Name (8.3 Format) Give\n'FullPath for long file name\n\n'PARAMETERS: FullPath: Full Path of Original File\n\n'RETURNS: 8.3 FileName, or \"\" if FullPath doesn't\n'         exist or file fails for other reasons\n\n'EXAMPLE:\n'  GetShortFileName(\"C:\\Nouveau dossier\\Nouveau dossier\\Nouveau \ndossier\\Nouveau dossier\\Nouveau dossier\\\")\n\n\nDim lAns As Long\nDim sAns As String\nDim iLen As Integer\n\nOn Error Resume Next\n\n'this function doesn't work if the file doesn't exist\nIf Dir(FullPath) = \"\" Then Exit Function\n\nsAns = Space(255)\nlAns = GetShortPathName(FullPath, sAns, 255)\nGetShortFileName = Left(sAns, lAns)\n\nEnd Function\n</code></pre>\n\n<p>Here is how you could make your sub :</p>\n\n<pre><code>Dim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\nDim program_folder_path\nDim file_path\n\nprogram_folder_path = \"C:\\Program Files (x86)\\Python27\\\"\nprogram_folder_path = CStr(GetShortFileName(program_folder_path))\n\nfile_path = \"C:\\Users\\Markus\\BrowseDirectory.py\"\nfile_path = CStr(GetShortFileName(file_path))\n\nwsh.Run program_folder_path &amp; \"python.exe\" &amp; file_path, windowStyle,_\nwaitOnReturn\n</code></pre>\n\n<p>I hope this could help, sorry for my bad english by the way... </p>\n"}], "owner": {"reputation": 41, "user_id": 6801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4685dd318ceb1ded60686ab52ee8408?s=128&d=identicon&r=PG&f=1", "display_name": "Billi B", "link": "https://stackoverflow.com/users/6801795/billi-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1893, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1554001484, "creation_date": 1473191189, "last_edit_date": 1531164843, "question_id": 39356710, "link": "https://stackoverflow.com/questions/39356710/call-python-script-from-vba-with-wsh", "title": "Call python script from vba with wsh", "body": "<p>I need to call a python script from vba which works fine by using the shell.</p>\n\n<pre><code>Sub CallPythonScript()\n\n        Call Shell(\"C:\\Program Files (x86)\\Python27\\python.exe C:\\Users\\Markus\\BrowseDirectory.py\")\n\nEnd Sub\n</code></pre>\n\n<p>But when I try using wsh (because of the wait funcionality) it just won't work anymore. </p>\n\n<pre><code>Sub CallPythonScript()\n\n    Dim wsh As Object\n        Set wsh = VBA.CreateObject(\"WScript.Shell\")\n\n    Dim myApp As String: myApp = \"C:\\Program Files (x86)\\Python27\\python.exe C:\\Users\\Markus\\BrowseDirectory.py\"\n    Dim waitOnReturn As Boolean: waitOnReturn = True\n    Dim windowStyle As Integer: windowStyle = 1\n\n    wsh.Run \"\"\"\"\" &amp; myApp &amp; \"\"\"\"\", windowStyle, waitOnReturn\n\nEnd Sub\n</code></pre>\n\n<p>However, I used the same code at home and everything worked out just fine, with the difference that there weren't any blanks in the path. So naturally there must be something wrong with the blanks. Help is greatly appreciated. </p>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473190231, "post_id": 39356237, "comment_id": 66042957, "body": "Would help to show your batch vbscript also"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473192167, "post_id": 39356237, "comment_id": 66043827, "body": "Can you update your question with this code properly formatted? My first question would be, when did you open Excel?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473226076, "post_id": 39356237, "comment_id": 66052728, "body": "If you comment out the <code>On Error Resume Next</code> (start with the vbscript) what happens?"}], "owner": {"reputation": 21, "user_id": 6801745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab46cf6c539dfc4193a1c42edd87a51?s=128&d=identicon&r=PG&f=1", "display_name": "MJH", "link": "https://stackoverflow.com/users/6801745/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473192590, "creation_date": 1473189074, "last_edit_date": 1473192590, "question_id": 39356237, "link": "https://stackoverflow.com/questions/39356237/excel-adodb-batch-issue", "title": "Excel ADODB batch issue", "body": "<p>I have written the following VBA/ADODB code in excel which works ok when run directly but when run via a batch VBS script the SQL statement isn't executed. Any ideas what is the cause? (Windows 7 / Excel 2012)</p>\n\n<p>If you have any other comments on the code please let me know.\nThanks.</p>\n\n<pre><code>Sub RunSQL()\n\nDim conn As Object, rst As Object, rst2 As Object\nDim strConnection As String, strSQL As String, strSQL2 As String\nDim i As Integer\n\n'start error handler\nOn Error GoTo ErrorHandler:\n\nSet conn = CreateObject(\"ADODB.Connection\")\nSet rst = CreateObject(\"ADODB.Recordset\")\n\n'connection string EXTERNAL source\nstrConnection = \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n&amp; \"DBQ=C:\\Users\\Mike\\Documents\\SourceBook1.xlsx;\"\n\n'SQL statement\nstrSQL = \"SELECT col2 FROM [Sheet1$];\"\n\n'open connection\nconn.Open strConnection\n\n'run SQL\nrst.Open strSQL, conn\n\n'write column headings\nFor i = 1 To rst.Fields.Count\n    Worksheets(\"Sheet1\").Cells(1, i) = rst.Fields(i - 1).Name\nNext i\n\n'write data rows\nWorksheets(\"Sheet1\").Range(\"A2\").CopyFromRecordset rst\n\n'close workbook and save\nActiveWorkbook.Close True\n\n'clean up\nrst.Close: conn.Close\nSet rst = Nothing: Set conn = Nothing\n\nExit Sub\n\nErrorHandler:\nErrorStr = \"Error: \" &amp; Str(Err.Number) &amp; \", Source: \" &amp; Err.Source &amp; \", Description: \" &amp; Err.Description\n\n'continue if error in clean up\nOn Error Resume Next\n\n'clean up\nrst.Close: conn.Close\nSet rst = Nothing: Set conn = Nothing\n\n'handle error\nMsgBox (ErrorStr)\n\nEnd Sub\n</code></pre>\n\n<p>Here's the batch job ...</p>\n\n<pre><code>Option Explicit\n\nOn Error Resume Next\nExcelMacroExample\n\nSub ExcelMacroExample() \nDim xlApp \nDim xlBook \n\nSet xlApp = CreateObject(\"Excel.Application\") \nSet xlBook = xlApp.Workbooks.Open (\"C:\\Users\\Mike\\Documents\\TargetBook1.xlsm\", 0, True) \n\nxlApp.Run \"RunSQL\"\nxlApp.ActiveWorkbook.Close\nxlApp.Quit \n\nSet xlBook = Nothing \nSet xlApp = Nothing \nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1473189025, "post_id": 39356186, "comment_id": 66042387, "body": "The MSForms <code>TextBox</code> actually <i>doesn&#39;t</i> have an <code>Enter</code> event.  You can verify that the events you listed are the only ones available in your Object Browser."}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473189411, "post_id": 39356186, "comment_id": 66042548, "body": "Those are the only ones available in the Object Browser for the class module, but when I create a textbox on a userform, <code>Enter</code> does show up in the Object Browser, and code added there runs as expected."}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473189704, "post_id": 39356186, "comment_id": 66042694, "body": "<a href=\"http://imgur.com/Qxp9y2a\" rel=\"nofollow noreferrer\">Screenshot of <code>Textbox_Enter</code> event</a>. That&#39;s what you&#39;re talking about, correct? Or am I missing something?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473190075, "post_id": 39356186, "comment_id": 66042878, "body": "OK that&#39;s truly bizarre, never noted that before.  I wonder if it has something to do with how the typelib is defined - unfortunately fm20.dll is crashing my typelib browser..."}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473190709, "post_id": 39356186, "comment_id": 66043149, "body": "So all I&#39;m looking to do is fire an event when a user clicks one of these textboxes, and after reading into the descriptions of the events it looks <code>MouseDown</code> may be able to do what I want. It&#39;s not quite what I&#39;d like (it&#39;s interfering with <code>DblClick</code> events), but I think I might be able to make it work."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473190998, "post_id": 39356186, "comment_id": 66043277, "body": "OK, so I busted open the typelib and verified that it really doesn&#39;t have an <code>Enter</code> event, hidden or otherwise.  The events are extended on the <code>MdcTextEvents</code> dispinterface, and there aren&#39;t any <code>Enter</code> or <code>Exit</code> events.  I wonder if VBA is doing some sort of forwarding based on the message pump (i.e. simulating an &quot;event&quot; when it gets a <code>WM_SETFOCUS</code> message or something like that)."}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473191116, "post_id": 39356186, "comment_id": 66043335, "body": "Alright, well that at least answers why I can&#39;t do it. Still a bit frustrating, but I&#39;ll manage. If you want to submit that as an answer I&#39;ll accept it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473191246, "post_id": 39356186, "comment_id": 66043390, "body": "There&#39;s still a way to do it - it just depends on how much work you&#39;d want to do.  You can do the same thing VBA apparently does and subclass the <code>TextBox</code>.  Then <i>you</i> can listen for <code>WM_GETFOCUS</code> messages."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1521566357, "post_id": 39356186, "comment_id": 85782277, "body": "My understanding is that <code>_Enter</code> and <code>_Exit</code> events are Userform related. Hence, they are not <i>purely</i> textbox events, and do not show up in custom classes as such."}], "owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1596, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1473188844, "creation_date": 1473188844, "question_id": 39356186, "link": "https://stackoverflow.com/questions/39356186/create-enter-event-handler-for-textbox-in-class-module", "title": "Create &quot;_Enter&quot; event handler for textbox in class module", "body": "<p>I have a Class Module, <code>TCLabel</code>, to add event handlers for a dynamically populated userform. When the userform is initialized, these labels (and other controls) are dynamically added based on the custom document properties of <code>ActiveDocument</code>. Everything is working correctly, except I have found that I am unable to create <code>Textbox_Enter</code> event handlers using the class module. Here is the code from the module:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents m_oTextBox As TextBox\n\nPublic Property Set TextBox(ByVal oTextBox As TextBox)\n    Set m_oTextBox = oTextBox\nEnd Property\n\nPrivate Sub m_oTextBox_Change()\n    MsgBox \"Success: Change\"    '&lt;--Works\nEnd Sub\n\nPrivate Sub m_oTextBox_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    MsgBox \"Success: DblClick\"    '&lt;--Works\nEnd Sub\n\nPrivate Sub m_oTextBox_Enter()\n    MsgBox \"Success: Enter\"    '&lt;--Doesn't work\nEnd Sub\n</code></pre>\n\n<p>In the drop-down menus for the class module, there are options only for <code>BeforeDragOver</code>, <code>BeforeDropOrPaste</code>, <code>Change</code>, <code>DblClick</code>, <code>DropButtonClick</code>, <code>Error</code>, <code>KeyDown</code>, <code>KeyPress</code>, <code>KeyUp</code>, <code>MouseDown</code>, <code>MouseMove</code>, and <code>MouseUp</code>, but no option for <code>Enter</code>. Manually creating the event, as seen in the code above, does nothing. <code>Enter</code> is a valid event handler for a textbox, why can it not be created with a class module? Is there a workaround for this? </p>\n"}, {"tags": ["vba", "excel", "vb6", "excel-2013"], "comments": [{"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473188167, "post_id": 39355966, "comment_id": 66041989, "body": "Interestingly, Access doesn&#39;t give me any issues. I opened the application and ran a few reports in access - 2013 and everything went just fine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1473189450, "post_id": 39355966, "comment_id": 66042561, "body": "Just to clarify, the code is VB6 code in a VB6 app, referencing the Excel object model? If that&#39;s the case then I think the [vba] and [excel-vba] tags are confusing things."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473189746, "post_id": 39355966, "comment_id": 66042725, "body": "Also, it doesn&#39;t seem right that <code>xlApp</code>, <code>xlBook</code> and <code>xlSheetA</code> are module-scoped and assigned in a function&#39;s scope. A <code>Function</code> shouldn&#39;t have side-effects, and yours is changing global state (well, module state anyway). leaving <code>xlSheetA</code>, <code>xlBook</code> and <code>xlApp</code> with dangling object references after the function exits. Also - just a coding style minor point, but using <code>Private</code> instead of <code>Dim</code> for declaring module-level variables would make it clearer that you&#39;re referring to private fields."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473189870, "post_id": 39355966, "comment_id": 66042781, "body": "@Mat&#39;sMug - VB6 and VBA is exactly the same code - especially when i&#39;m writing data to extract in VB6 - i run macros and paste it into VB6. I&#39;m declaring xlApp, xlBook, xlSheetA at a modular level, at the end of the function before I exit it - i set it to NOTHING in each case. It works perfectly fine in 2007 - but i get the error in 2013"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473190019, "post_id": 39355966, "comment_id": 66042847, "body": "The difference between VB6 and VBA is that in VBA you would have a host application and a global <code>Application</code> object variable waiting to be used - your answer would simply be &quot;use the global <code>Application</code> object instead of making a new instance&quot;. VB6 only <i>looks</i> like VBA. If your code is VB6, tag with VB6; if it&#39;s VBA, tag with VBA. As for your variables, if they only live while the function is running, then they should be scoped to that function. Are you calling <code>.Quit</code> or just setting it to <code>Nothing</code>?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473190092, "post_id": 39355966, "comment_id": 66042888, "body": "@Mat&#39;sMug - i save it, set it to nothing then close it. My bad - i just assumed since it&#39;s excel related VBA experts might give me a hint or two."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1473190379, "post_id": 39355966, "comment_id": 66043015, "body": "How do you close it after you set it to <code>Nothing</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1473190502, "post_id": 39355966, "comment_id": 66043069, "body": "Try setting <code>xlApp.Visible = True</code> right after <code>Set xlApp = New Excel.Application</code> and see if Excel is getting hung up on some pop-up/dialog."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473190606, "post_id": 39355966, "comment_id": 66043105, "body": "@Comintern - i don&#39;t - i save it, then close it , then set to nothing"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473190792, "post_id": 39355966, "comment_id": 66043191, "body": "@TimWilliams - same thing - i think it doesn&#39;t like the SET xlAPP = New Excel.Application because it hangs up every time whatever the code after it"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1473190938, "post_id": 39355966, "comment_id": 66043247, "body": "@Bobski Does Excel do anything when you start it manually? Do you have any autoloading addins?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1473191038, "post_id": 39355966, "comment_id": 66043295, "body": "@GSerg - when i Open it - it shows me Recent Documents, and lets me choose blank document, academic calendar, etc"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473191104, "post_id": 39355966, "comment_id": 66043328, "body": "If you put a breakpoint on the <code>Set xlBook = XlApp.Workbooks.Add</code> and wait 5-10sec before continuing, does it still error ?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473191252, "post_id": 39355966, "comment_id": 66043391, "body": "@TimWilliams - I get the same error &quot;Component Request Pending&quot; This action cannot be completed because the other app is busy......"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 1, "creation_date": 1473191437, "post_id": 39355966, "comment_id": 66043498, "body": "Maybe I need to tell it to open the spreadsheet right away - because when I initially open it it goes to RECENT documents - so it cannot add a workbook, just a thought?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1473192779, "post_id": 39355966, "comment_id": 66044122, "body": "I had a similar problem with that start screen, but it was a MailMerge problem the other day where Word&#39;s DDE would fail to interact with a new installation of Excel 2013 because of the Start Screen in Excel 2013. I had to uncheck the <i>Show the start screen when the application starts</i> option for Excel. (which you should do anyway)."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473192962, "post_id": 39355966, "comment_id": 66044209, "body": "I&#39;ve also seen problems with GetObject/CreateObject not returning <i>any</i> version of Excel if I use <code>&quot;Excel.Application&quot;</code>, if more than one version of Excel is installed, and one of the versions is Excel 2013 or later."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473193210, "post_id": 39355966, "comment_id": 66044318, "body": "@ThunderFrame - I unched Start screen - same issue. In regards to 2nd comment - I only have one version of excel on my box. Is there a way for me to specify how to createobject in 2013 only"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473196744, "post_id": 39355966, "comment_id": 66045889, "body": "Yes, you can append the version as a suffix. Eg. <code>&quot;Excel.Application.15&quot;</code>"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1473200065, "post_id": 39355966, "comment_id": 66047081, "body": "You don&#39;t have to, VB6 will create the excel application as specified in your project reference.  Unless you want to use createobject(&quot;&quot;) in which case I prefer to use version free &quot;Excel.Application&quot;"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473254580, "post_id": 39355966, "comment_id": 66070244, "body": "ahhhhhh nothing seems to work - don&#39;t know what my other options are."}], "answers": [{"comments": [{"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473267124, "post_id": 39375207, "comment_id": 66078814, "body": "this unfortunately doesn&#39;t help it. I see what you are doing. The issue here is that once it hits the line set xlapp = new excel.application with office 2013 - it doesn&#39;t give it a value, in 2007 when i run it and it hits that line - xlAPP become &quot;MICROSOFT EXCEL&quot; when I hover over it with the mouse, it 2013 it doesn&#39;t say anything."}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 1, "last_activity_date": 1473266051, "creation_date": 1473266051, "answer_id": 39375207, "question_id": 39355966, "link": "https://stackoverflow.com/questions/39355966/vb6-extracts-in-excel-2013/39375207#39375207", "title": "VB6 extracts in Excel 2013", "body": "<p>Long back I had similar issue. Not sure if this relates to your scenario.\nMy code was updating an opened excel which had a cell in edit mode. After trying many possibilities, I turned off screen updating and visibility until code finished. Something like \nxlApp.ScreenUpdating = False\nxlApp.Visible = False</p>\n"}, {"comments": [{"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "edited": false, "score": 1, "creation_date": 1473268146, "post_id": 39375689, "comment_id": 66079345, "body": "Also make sure you have the newest Microsoft Excel Object Library referenced, think you mentioned you only have 1."}, {"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "edited": false, "score": 1, "creation_date": 1473268514, "post_id": 39375689, "comment_id": 66079538, "body": "Just for a bit of clarification, the switch error is related to calling another sub (not function) whilst the current sub is still trying to execute some processes or commands."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473268821, "post_id": 39375689, "comment_id": 66079680, "body": "well the first part of the code is from my actual application, the screenshots are from me doing a brand new project - displaying exactly what&#39;s going on - its easier for me to do it this way since my code inthe application is in different places"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473269018, "post_id": 39375689, "comment_id": 66079784, "body": "ur saying this works on your machine? What SP do you have? 6?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473269196, "post_id": 39375689, "comment_id": 66079868, "body": "can you please tlel me which references you have checked in your IDE"}, {"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 1, "creation_date": 1473269222, "post_id": 39375689, "comment_id": 66079878, "body": "I&#39;m using SP6, referenced Microsoft Excel 16 Object Library. The exact code above opens Excel, &quot;TEST&quot; is in col/row 1 and it wants to close asking me to save the workbook. Are you getting any other erros or still the same?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473269313, "post_id": 39375689, "comment_id": 66079940, "body": "i have Microsoft Excel 15 Object Library - but i&#39;m getting the error"}, {"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 1, "creation_date": 1473269707, "post_id": 39375689, "comment_id": 66080126, "body": "See screenshot above, works fine... Even with object 15 it should work fine. Try to run it exactly the same as my code and see if it works."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473269879, "post_id": 39375689, "comment_id": 66080199, "body": "It doesn&#39;t work :( -- but i&#39;ll accept this as answer as it obviously works on your machine. I&#39;ll have to reinstall vb6 studio and then go from there. It looks like there was an issue with installing it, and that&#39;s where the root cause is. Thank you!"}, {"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 1, "creation_date": 1473269944, "post_id": 39375689, "comment_id": 66080225, "body": "Are you running VB6 as administrator? On Windows 7 on it will crash if not used as admin."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473271045, "post_id": 39375689, "comment_id": 66080762, "body": "Im running Windows 10 - and yes, VB6 is run as administrator"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473271083, "post_id": 39375689, "comment_id": 66080780, "body": "Wait you  have windows 7? I hope that&#39;s not where the issue  is"}, {"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 1, "creation_date": 1473271699, "post_id": 39375689, "comment_id": 66081056, "body": "Nope, running Win 10 :). It is a long process re-installing VB6 again, not sure why this won&#39;t work on your side. Just tested on Win 8.1 and Win 7 on my side, worked through all of them."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473271754, "post_id": 39375689, "comment_id": 66081082, "body": "You da best. Thanks a bunch - I know but will need to reinstall again with all the SP&#39;s. Thanks again!"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473439328, "post_id": 39375689, "comment_id": 66157037, "body": "I tried reinstalling VB6 again and i keep getting the same issue. How did you do your installation - did you install VB6 first and then office 2013 or the other way around? Did you have to do anything unusual to get them both to work. We&#39;ve reinstalled VB6 and office 2013 to no avail."}, {"owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473505832, "post_id": 39375689, "comment_id": 66174852, "body": "Nope, my excel and vb6 is installed normally, normal updates in place etc. Show me a screenshot of your references in vb6 please."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1473619103, "post_id": 39375689, "comment_id": 66201201, "body": "So it looks like theres some sort of issue with office 2013 because we installed office 2007 on windows 10 and everythimg ran fine. Looking firther into it we realized that 13 has some issues."}], "tags": [], "owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "is_accepted": true, "score": 2, "last_activity_date": 1473269595, "last_edit_date": 1473269595, "creation_date": 1473268036, "answer_id": 39375689, "question_id": 39355966, "link": "https://stackoverflow.com/questions/39355966/vb6-extracts-in-excel-2013/39375689#39375689", "title": "VB6 extracts in Excel 2013", "body": "<p>Your function1 is in a private sub, should be called as a function. Your code shown and the screenshots also differ. I have created a quick sample and it works perfect in Excel 2013. Changed the sub to function...</p>\n\n<pre><code>Option Explicit\n\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheetA As Excel.Worksheet\n\nPrivate Function function1()\n\nSet xlApp = New Excel.Application\nSet xlBook = xlApp.Workbooks.Add\nSet xlSheetA = xlBook.Worksheets.Add\n\nSet xlSheetA = xlBook.Sheets.Item(1) ''the sheet you want to use\n\nxlApp.Visible = True\n\nxlApp.ActiveSheet.Cells(1, 1).Value = \"TEST\"\n\nxlApp.Workbooks.Close\n\nMsgBox \"Excel Done\"\nEnd Function\n\nPrivate Sub Command3_Click()\n\nCall function1\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p>Edit: See screenshot below, working fine...</p>\n\n<p><a href=\"https://i.stack.imgur.com/SHsTa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SHsTa.png\" alt=\"Open Excel\"></a></p>\n"}], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 39375689, "answer_count": 2, "score": 3, "last_activity_date": 1473271412, "creation_date": 1473187960, "last_edit_date": 1473271412, "question_id": 39355966, "link": "https://stackoverflow.com/questions/39355966/vb6-extracts-in-excel-2013", "title": "VB6 extracts in Excel 2013", "body": "<p>I have a few applications writting in legacy VB6 that have extract code built into to create EXCEL extracts. We are moving from Excel 2007 to Excel 2013 and I've run into some issues. I'm running Windows 10. In 2007, this is my declarations and <code>Set</code> statements that used to work just fine...</p>\n\n<pre><code>Option Explicit\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheetA As Excel.Worksheet\n</code></pre>\n\n<p>These I have at the top of the module.</p>\n\n<p>In my Function that writes the data to extract I do this...</p>\n\n<pre><code>Set xlApp = New Excel.Application\nSet xlBook = XlApp.Workbooks.Add\nSet xlSheetA = xlBook.Worksheets.Add\n</code></pre>\n\n<p>When it gets to XLBook - it hangs up and everything stops working. I get an error:</p>\n\n<blockquote>\n  <p><em>This action cannot be completed because the other program is busy. Choose   \"SwitchTo' to activate the busy program and correct the problem.</em></p>\n</blockquote>\n\n<p>Now, before I run my extract I make sure Excel is not running in the background, to check I go to <em>Task Manager</em> -> <em>processes</em> and delete it if it's there. What am I doing wrong? how should I change my code?</p>\n\n<p>EDIT SCREENSHOTS: The screensnhots do not display the code that i have in my application. this was a new project just to show all the code I'm using.\n<a href=\"https://i.stack.imgur.com/EEz40.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EEz40.png\" alt=\"code\"></a>\n<a href=\"https://i.stack.imgur.com/RgEeL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RgEeL.png\" alt=\"error\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473190749, "post_id": 39356553, "comment_id": 66043169, "body": "I currently have Column 0 Bound to &quot;Company Name&quot; and Column 1 (This is hidden) Bound to the ID of the Parent table. If I use your method then the Combo box displays the numeric ID instead of the company name. So I guess I want to display Column 0&#39;s value, by using Column 1 to select it"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473190971, "post_id": 39356553, "comment_id": 66043268, "body": "Ahhh okay .. I changed my loop check - does that work better?"}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473191445, "post_id": 39356553, "comment_id": 66043502, "body": "Getting somewhere. It&#39;s giving an &quot;Object required&quot; error, but it looks like the itemdata is seeing the correct value in the column. Trouble shooting now"}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473192917, "post_id": 39356553, "comment_id": 66044190, "body": "<code>If .Column(1).Value = ParID Then</code> The ParID variable and Itemdata(i) are both returning the respective values"}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473195247, "post_id": 39356553, "comment_id": 66045248, "body": "Nope, same error. It&#39;s strange because the loop clearly see&#39;s the object and the itemdata is pulling the correct value from that column (Not to mention the loop is able to count all the items in the list). It&#39;s the end of the day so Imma have to troubleshoot a bit more tomorrow with a fresh mind. Thanks for the input! Looks like it&#39;s on the right path."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473196229, "post_id": 39356553, "comment_id": 66045662, "body": "Hmm - just tested on my system and it works.- add some debug.print statements"}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1473265518, "post_id": 39356553, "comment_id": 66077993, "body": "Okay found out the issue! I removed <code>.value</code> from <code>If .Column(1, i).Value = ParID Then</code> and that worked."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 3, "last_activity_date": 1473193727, "last_edit_date": 1473193727, "creation_date": 1473190484, "answer_id": 39356553, "question_id": 39355475, "link": "https://stackoverflow.com/questions/39355475/setting-the-value-of-an-access-combobox-with-vba-comparison/39356553#39356553", "title": "Setting the value of an Access combobox with VBA comparison", "body": "<p>Because it's tied to specific column you can loop thru to set the value based on the matching ID  </p>\n\n<blockquote>\n  <p>EDIT - Add Row index to Column Value</p>\n</blockquote>\n\n<pre><code>Dim i as Integer\n\nWith Combo217\n   For i = 0 To .ListCount - 1\n      If .Column(1, i).Value = ParID Then\n         .Value = .ItemData(i)\n         Exit For\n      End If\n   Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8389, "favorite_count": 0, "accepted_answer_id": 39356553, "answer_count": 1, "score": 1, "last_activity_date": 1473801411, "creation_date": 1473186028, "last_edit_date": 1473801411, "question_id": 39355475, "link": "https://stackoverflow.com/questions/39355475/setting-the-value-of-an-access-combobox-with-vba-comparison", "title": "Setting the value of an Access combobox with VBA comparison", "body": "<p>I'm trying to figure out where I went wrong with this.</p>\n\n<p>I have two tables <code>Request</code> and <code>Parent</code>. <code>Request</code> can only have one related <code>Parent</code> record, but <code>Parent</code> can have many related <code>Request</code> records. So I have the <code>Request</code> table containing the foreign key to <code>Parent</code>.</p>\n\n<p>I have an unbound combobox that pulls it's data from the <code>Parent</code> table using a query (contains company name and ID bound to column 0 and 1, with column 1 being hidden so the user doesn't see the numeric ID). It's unbound because the form's recordset has a lot of complex joins, making anything on that form unable to be updated. So I created an \"On Change\" event on the combo box to fill in the foreign key using a querydef SQL update query:</p>\n\n<pre><code>Private Sub Combo217_Change()\nDim ComboID As String\nDim ReqID As Long\nDim dbs As DAO.Database\nDim qdfUpdateParentExisting As DAO.QueryDef\n\nReqID = Me.RequestID.Value\nComboID = Me.Combo217.Column(1)\n\nSet dbs = CurrentDb\nSet qdfUpdateParentExisting = dbs.QueryDefs(\"UpdateReqExistingParent\")\nqdfUpdateParentExisting.Parameters(\"VBParent\").Value = ComboID\nqdfUpdateParentExisting.Parameters(\"VBReqID\").Value = ReqID\nqdfUpdateParentExisting.Execute\nqdfUpdateParentExisting.Close\nDoCmd.Save acForm, \"DT2\"\nMe.Requery\n\nEnd Sub\n</code></pre>\n\n<p>This works just fine, but once you exit the form and re-enter it, the value in the combo box is blank and I would like this to contain the same value that was selected.</p>\n\n<p>I've been trying to do an \"On load event\" with the following code but it's not working</p>\n\n<pre><code>Dim ParID\nParID = Me.ParentID.Value\nMe.Combo217.Column(1).Value = ParID\n</code></pre>\n\n<p>Any input on getting this to work would be fantastic!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473186579, "post_id": 39355447, "comment_id": 66041113, "body": "I think you want that last line to be <code>Sheets(&quot;Sheet12&quot;).Range(formatedCellBegin,FormatedCellEnd).C&zwnj;&#8203;opy ...</code> , since <code>formatedCellBegin.Address</code> should resolve to like <code>J12</code>. If you step through the macro, using <code>F8</code>, when it sets those two ranges, in the Immediate Window (press CTRL+G to see) type <code>?formatedCellBegin.address</code> to make sure it&#39;s setting correctly."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473225422, "post_id": 39355447, "comment_id": 66052520, "body": "@Kevin Smith see the code and explanation in my answer below"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5733214, "user_type": "registered", "profile_image": "https://graph.facebook.com/960945373943084/picture?type=large", "display_name": "Kevin Smith", "link": "https://stackoverflow.com/users/5733214/kevin-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1473197505, "creation_date": 1473197505, "answer_id": 39358158, "question_id": 39355447, "link": "https://stackoverflow.com/questions/39355447/excel-vba-copy-data-from-one-worksheet-to-another-off-of-user-input-on-another-s/39358158#39358158", "title": "Excel VBA copy data from one worksheet to another off of user input on another sheet", "body": "<p>I got it.  Since 'formatedCellBegin' and the others declared as Strings didn't need to have 'Set' in front.  </p>\n\n<pre><code>Sub Transfer()\n\n   Dim shSource As Worksheet\n   Dim cellValue As Range\n\n   Dim formatedCellBegin As String\n   Dim formatedCellEnd As String\n   Dim fullRange As String\n\n\n   Set shSource = ThisWorkbook.Sheets(\"Sheet10\") 'Get info from user input    sheet\n   Set cellValue = shSource.Cells(4, \"H\") 'User input received in regards to what row to start transfer\n\n\n   formatedCellBegin = (\"J\" &amp; CStr(cellValue)) 'Add J to the that row to get the cell to start at\n   formatedCellEnd = (\"K\" &amp; CStr(cellValue)) 'End at cell K - (whatever they pick)\n\n   fullRange = formatedCellBegin &amp; \":\" &amp; formatedCellEnd\n</code></pre>\n\n<p>'Sheet 12 is the sheet with all the invoice info\n'Sheet 11 is the sheet to put all the info\n       ThisWorkbook.Sheets(\"Sheet12\").Range(fullRange).Copy    Destination:=ThisWorkbook.Sheets(\"Sheet11\").Range(\"B20\")\n      End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473225360, "creation_date": 1473225360, "answer_id": 39361665, "question_id": 39355447, "link": "https://stackoverflow.com/questions/39355447/excel-vba-copy-data-from-one-worksheet-to-another-off-of-user-input-on-another-s/39361665#39361665", "title": "Excel VBA copy data from one worksheet to another off of user input on another sheet", "body": "<p>In your case, you don't need to define <strong>formatedCellBegin</strong> and <strong>formatedCellEnd</strong> <code>As Range</code>, but in your case and how you use them you define them <code>As String</code>.</p>\n\n<p>Also, <strong>cellValue</strong> is a value you get from a cell, representing a row, so you need to define it <code>As Long</code> (or <code>Integer</code>).</p>\n\n<p>Try the modified code below:</p>\n\n<pre><code>Sub Transfer()\n\nDim shSource As Worksheet\nDim cellValue As Long    \nDim formatedCellBegin As String\nDim formatedCellEnd As String\n\nSet shSource = ThisWorkbook.Sheets(\"Sheet1\") ' Get info from user input sheet\ncellValue = shSource.Cells(4, \"H\") ' User input taken from \"H4\" on sheet1 received in regards  to what row to start transfer\n\nformatedCellBegin = \"J\" &amp; cellValue ' Add J to the that row to get the cell to start at\nformatedCellEnd = \"K\" &amp; cellValue ' End at cell K - (whatever they pick)\n\n'Sheet 12 is the sheet with all the invoice info\n'Sheet 11 is the sheet to put all the info    \nSheets(\"Sheet12\").Range(formatedCellBegin &amp; \",\" &amp; formatedCellEnd).Copy Sheets(\"Sheet11\").Range(\"B20\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5733214, "user_type": "registered", "profile_image": "https://graph.facebook.com/960945373943084/picture?type=large", "display_name": "Kevin Smith", "link": "https://stackoverflow.com/users/5733214/kevin-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "accepted_answer_id": 39358158, "answer_count": 2, "score": 0, "last_activity_date": 1473225360, "creation_date": 1473185924, "question_id": 39355447, "link": "https://stackoverflow.com/questions/39355447/excel-vba-copy-data-from-one-worksheet-to-another-off-of-user-input-on-another-s", "title": "Excel VBA copy data from one worksheet to another off of user input on another sheet", "body": "<p>I hope I did a thorough search for answers to this however, after trying piece things together I couldn't see the solution.  I'm trying to copy data from one worksheet to another based on user input of the the row to start on.  For example, If they enter \"9\" then I will add a letter signifying the column to that and start copying over data up to another cell.  Here is the code:</p>\n\n<pre><code>Sub Transfer()\n\n    Dim shSource As Worksheet\n    Dim cellValue As Range\n\n    Dim formatedCellBegin As Range\n    Dim formatedCellEnd As Range\n\n\n    Set shSource = ThisWorkbook.Sheets(\"Sheet1\") 'Get info from user input     sheet\n    Set cellValue = shSource.Cells(4, \"H\") 'User input taken from \"H4\" on sheet1 received in regards  to what row to start transfer\n\n\n   Set formatedCellBegin = \"J\" &amp; cellValue 'Add J to the that row to get the cell to start at\n   Set formatedCellEnd = \"K\" &amp; cellValue 'End at cell K - (whatever they pick)\n\n\n'Sheet 12 is the sheet with all the invoice info\n'Sheet 11 is the sheet to put all the info\n\nSheets(\"Sheet12\").Range(\"formatedCellBegin:formatedCellEnd\").Copy    Destination:=Sheets(\"Sheet11\").Range(\"B20\")\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1473467638, "post_id": 39367013, "comment_id": 66167599, "body": "Thank you so much, Zac. The ElseIf. I&#39;m looking through a website on how to do loops, so this is very timely. Thank you, again!"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1473554318, "post_id": 39367013, "comment_id": 66186844, "body": "No problems, glad to help"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": true, "score": 0, "last_activity_date": 1473801275, "last_edit_date": 1473801275, "creation_date": 1473243024, "answer_id": 39367013, "question_id": 39355369, "link": "https://stackoverflow.com/questions/39355369/how-to-consolidate-loops-for-code-to-t-f-data-btw-wkshts-based-on-2-conditions/39367013#39367013", "title": "How to consolidate loops for code to t/f data btw. wkshts based on 2 conditions", "body": "<p>Try this: </p>\n\n<pre><code>Sub Main()\n\nDim wbCP As Worksheet: Set wbCP = ActiveWorkbook.Worksheets(\"CPDesign\")\nDim wbD As Worksheet: Set wbD = ActiveWorkbook.Worksheets(\"Design\")\nDim intLastrowCP As Integer: intLastrowCP = wbCP.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDim intLastrowD As Integer: intLastrowD = wbD.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDim intCountCP As Integer\nDim intCountD As Integer\nDim strCurrentCPNode As String\n\n' Loop through CPDesign sheet\nFor intCountCP = 2 To intLastrowCP\n\n    ' Get current Node in CPdesign\n    strCurrentCPNode = wbCP.Cells(intCountCP, \"B\").Value\n\n    ' Loop through Design sheet\n    For intCountD = 2 To intLastrowD\n\n        ' Does the node match NodeA in Design sheet\n        If wbD.Cells(intCountD, \"B\").Value = strCurrentCPNode Then\n\n            ' It does so set the SourcerTxA column value\n            wbD.Cells(intCountD, \"D\").Value = wbCP.Cells(intCountCP, \"C\").Value\n\n        ' Does the node match NodeB in Design sheet\n        ElseIf wbD.Cells(intCountD, \"C\").Value = strCurrentCPNode Then\n\n            ' It does so set SourceTxB and SourceRxB values\n            wbD.Cells(intCountD, \"E\").Value = wbCP.Cells(intCountCP, \"C\").Value\n            wbD.Cells(intCountD, \"F\").Value = wbCP.Cells(intCountCP, \"D\").Value\n\n        End If\n\n    Next\n\nNext\n\n' Clear objects\nSet wbCP = Nothing\nSet wbD = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong>: code doesn't activate the sheet or the cell at the end but you already know how to do that :)</p>\n"}], "owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 39367013, "answer_count": 1, "score": 0, "last_activity_date": 1473801275, "creation_date": 1473185649, "question_id": 39355369, "link": "https://stackoverflow.com/questions/39355369/how-to-consolidate-loops-for-code-to-t-f-data-btw-wkshts-based-on-2-conditions", "title": "How to consolidate loops for code to t/f data btw. wkshts based on 2 conditions", "body": "<p>I found the code below and modified it from here: <a href=\"https://www.youtube.com/watch?v=AzhQ5KiNybk\" rel=\"nofollow\">https://www.youtube.com/watch?v=AzhQ5KiNybk</a> \u2013 \u201cTransfer Specific Worksheet Range Data from one worksheet to another based on condition\u201d</p>\n\n<p>CODE OVERVIEW: I used the VBA Excel code below in Excel 2013 to copy data from columns F to Y in a wksht called CPDesign and paste it to columns H to AA in a wksht called Design (in the same wkbk) by using a lookup value. It looks up the values, I\u2019ve defined as NodeA and NodeB, in column B of the CPDesign wksht and looks up its match in column C of Design wksht and then copies and pastes the corresponding data as described above.</p>\n\n<p>EXAMPLE WKSHTS: <strong>CPDesign</strong> (the wksht I am copying the data from) has the Node names (what I call NodeA and NodeB) listed in a single column called Node. Ex:</p>\n\n<pre><code>Hub            Node       SourceTx           SourceRx\nAllentown     V12345         14a                 3a     \nAllentown     V78945         14b                 3b\nAllentown     V33333         15a                 2a \nAllentown     V44444         15a                 2b\n</code></pre>\n\n<p><strong>Design</strong> (the wksht I need to paste data to) has the NodeA and NodeB values listed in two different columns next to each other. A shortened version of the wksht below. Ex:</p>\n\n<pre><code>Hub       NodeA     NodeB    SourceTxA      SourceTxB      SourceRxB         \nAllentown   V12345  V78945  (paste here)    (paste here)   (paste here)\nAllentown   V33333  V44444  (paste here)    (paste here)   (paste here)\n</code></pre>\n\n<p>QUESTION: I took the code for NodeA and copied and pasted it below the loop for Node A and made it the loop for Node B. The code below works but I want to know how to consolidate the code for Node B with Node A loop so that it looks better? (I would like it to stay like the code I have and not turn it into something I don\u2019t understand b/c I understand this code from the video, please:))</p>\n\n<p>Thank you.</p>\n\n<p>CODE:</p>\n\n<pre><code>Sub transfer()\nDim i As Long, j As Long, lastrowCP As Long, lastrowD As Long\nDim NodeA As String\nDim NodeB As String\n\nlastrowCP = Sheets(\"CPDesign\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To lastrowCP\n\n'CPDesign is spreadsheet I am copying data from\n\u2018NodeA and NodeB are all in column B of CPDesign spreadsheet\nNodeA = Sheets(\"CPDesign\").Cells(i, \"B\").Value\nNodeB = Sheets(\"CPDesign\").Cells(i, \"B\").Value\n\n'Design is spreadsheet I am copying data to\nSheets(\"Design\").Activate\nlastrowD = Sheets(\"Design\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'NodeA~~~\n\nFor j = 2 To lastrowD\n'Design is Design what I'm pasting into\n\u2018if value in NodeA column of CPDesign spreadsheet = value in column B of         \nDesign spreadsheet, then _\n\u2018continue with code\nIf Sheets(\"Design\").Cells(j, \"B\").Value = NodeA Then\n\nSheets(\"CPDesign\").Activate\nSheets(\"CPDesign\").Range(Cells(i, \"F\"), Cells(i, \"Y\")).Copy\nSheets(\"Design\").Activate\nSheets(\"Design\").Range(Cells(j, \"H\"), Cells(j, \"AA\")).Select\nActiveSheet.Paste\nEnd If\n\nNext j\nApplication.CutCopyMode = False\nNext i\n\n'NodeB~~~\n'just repeated code above for NodeA except minus the Dim's. Can I consolidate this with Node A loop above so that it looks better?\nlastrowCP = Sheets(\"CPDesign\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To lastrowCP\nNodeA = Sheets(\"CPDesign\").Cells(i, \"B\").Value\nNodeB = Sheets(\"CPDesign\").Cells(i, \"B\").Value\n\nSheets(\"Design\").Activate\nlastrowD = Sheets(\"Design\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor j = 2 To lastrowD\n\u2018if value in NodeB column of CPDesign spreadsheet = value in column C of Design spreadsheet, then _\n\u2018continue with code\nIf Sheets(\"Design\").Cells(j, \"C\").Value = NodeB Then\n\nSheets(\"CPDesign\").Activate\nSheets(\"CPDesign\").Range(Cells(i, \"F\"), Cells(i, \"Y\")).Copy\nSheets(\"Design\").Activate\nSheets(\"Design\").Range(Cells(j, \"H\"), Cells(j, \"AA\")).Select\nActiveSheet.Paste\nEnd If\n\nNext j\nApplication.CutCopyMode = False\nNext i\n\n'END NodeA and NodeB Loops~~~\n\n'when data transferred can go to sheet 1\nSheets(\"Design\").Activate\n'and end routine by selecting cell A1\nSheets(\"Design\").Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 2, "creation_date": 1473185932, "post_id": 39355335, "comment_id": 66040786, "body": "<code>Concat(i)</code> is an array, not a collection, so you&#39;ll want to use <code>UBound</code> instead of <code>.Count</code> to iterate over it (note that the array returned by <code>Split()</code> will be 0-indexed so your loop should start at <code>i=0</code>). Also, <code>Dim Concat, bucket As New Collection</code> should cause you even more errors, because it makes <code>Concat</code> an empty Variant while <code>bucket</code> becomes the Collection you allocated. You need to individually <code>Dim</code> each variable like <code>Dim Concat As New Collection, bucket As New Collection</code>"}, {"owner": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1473186527, "post_id": 39355335, "comment_id": 66041080, "body": "I tried UBound and I am still getting the same error message"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 5, "creation_date": 1473186546, "post_id": 39355335, "comment_id": 66041088, "body": "Use a <a href=\"http://stackoverflow.com/documentation/vba/3667/scripting-dictionary-object\">Dictionary</a> instead of a Collection. That way you can test to see if it&#39;s a duplicate <i>before adding it</i>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473187248, "post_id": 39355335, "comment_id": 66041463, "body": "BTW <code>Dim foo, bar As Whatever</code> only declares a type to the last variable in the list (e.g. <code>bar As Whatever</code>), leaving everything else an implicit <code>Variant</code> (e.g. <code>Dim foo</code>) - so <code>bucket</code> is a <code>Collection</code> and <code>Concat</code> is a <code>Variant</code>. And VBA comments are made using a single quote. And your use of extraneous parentheses will eventually make you run into weird runtime error 424 &quot;Object required&quot;  ...oh, wait."}, {"owner": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473187786, "post_id": 39355335, "comment_id": 66041782, "body": "@Mat&#39;sMug # instead of &#39; is for the purpose of clarity. the runtime error is in regards to the line w/o the parenthesis"}, {"owner": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473188086, "post_id": 39355335, "comment_id": 66041947, "body": "@Comintern can you elaborate further, please?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473188273, "post_id": 39355335, "comment_id": 66042039, "body": "See the answer below.  I was going to post one similar to it.  BTW, &quot;for the purpose of clarity&quot; it wouldn&#39;t hurt to get in the habit of explicitly calling default members (i.e. <code>Concat.Items(a)</code> instead of <code>Concat(a)</code>).  That would give you an instant hint that something was wrong with your declaration because the IntelliSense wouldn&#39;t have popped up after the <code>.</code>."}, {"owner": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473190023, "post_id": 39355335, "comment_id": 66042851, "body": "@Comintern thanks for the pointers, I will keep that in mind moving forward. Good day :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "edited": false, "score": 0, "creation_date": 1473188249, "post_id": 39355748, "comment_id": 66042023, "body": "I tried executing your code, and I get &quot;User-defined type not defined&quot; for Dim dctData As New Dictionary"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "edited": false, "score": 2, "creation_date": 1473188389, "post_id": 39355748, "comment_id": 66042093, "body": "@user23960 - Add a reference to &quot;Microsoft Scripting Runtime&quot; in the Tools-&gt;References... window."}, {"owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "edited": false, "score": 0, "creation_date": 1473188505, "post_id": 39355748, "comment_id": 66042149, "body": "Ah! Thanks Comintern. I should have mentioned that."}], "tags": [], "owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "is_accepted": false, "score": 3, "last_activity_date": 1473187094, "creation_date": 1473187094, "answer_id": 39355748, "question_id": 39355335, "link": "https://stackoverflow.com/questions/39355335/vba-removing-duplicates-from-a-collection/39355748#39355748", "title": "VBA: Removing duplicates from a Collection", "body": "<p>Using a dictionary will make it a lot simpler and easier. See below.</p>\n\n<pre><code>Sub UniqueValues()\n    Const Delimiter = \",\"\n    Dim num As Range\n    Dim a As Variant\n    Dim i As Integer, j As Integer\n    Dim dctData As New Dictionary\n\n    'Loop through all the values in the cells (including splitting into arrays)\n    For Each num In Selection\n        a = Split(num, Delimiter)\n        For j = 0 To UBound(a, 1)\n            If Not dctData.Exists(Trim(a(j))) Then\n                dctData.Add Trim(a(j)), \"\"\n            End If\n        Next j\n    Next num\n\n    '#to output to excel\n    For Each a In dctData\n        Debug.Print a\n    Next a\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6801445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f9591471c3c357ddd001acb9a637fe0?s=128&d=identicon&r=PG&f=1", "display_name": "user23960", "link": "https://stackoverflow.com/users/6801445/user23960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6116, "favorite_count": 1, "closed_date": 1473188216, "answer_count": 1, "score": 0, "last_activity_date": 1473187094, "creation_date": 1473185519, "last_edit_date": 1473186446, "question_id": 39355335, "link": "https://stackoverflow.com/questions/39355335/vba-removing-duplicates-from-a-collection", "closed_reason": "Duplicate", "title": "VBA: Removing duplicates from a Collection", "body": "<p><a href=\"http://i.stack.imgur.com/3Xw8W.jpg\" rel=\"nofollow\">What I am trying to accomplish</a></p>\n\n<p>I'd like to take a series of values from a selection of cells, then fill a new cell which contains only unique values from the selection I made. here is my code so far:</p>\n\n<pre><code>Const Delimiter = \", \"\nDim num As Range\nDim a As Variant\nDim Concat, bucket As New Collection\n\n#to create a collection that contains all the values from my selection \nFor Each num In Selection\n  a = Split(num, Delimiter)\n  Concat.Add (a)\nNext num\n\n#to convert multidimensional collection to a single dimensional\nFor i = 1 To Concat.Count\n  For j = 1 To Concat(i).Count\n    bucket.add(Concat(i)(j))\n  Next i\nNext j\n\n#to remove duplicate values\n[code]\n\n#to output to excel\n[code]\n</code></pre>\n\n<p>As you can see, the code is incomplete. I am having issues with the following lines of code</p>\n\n<pre><code>For j = 1 To Concat(i).Count\n</code></pre>\n\n<p>I get a \"Run-time error '424': Object required\" error.</p>\n"}, {"tags": ["excel", "vba", "worksheet", "consolidation"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473185301, "post_id": 39355008, "comment_id": 66040478, "body": "At a quick glance, notice how you prefaced <code>Range</code> with the worksheet? You <i>must</i> do the same with <code>Rows.Count</code>, <code>Columns.Count</code>, <code>Cells()</code>, etc. Otherwise, VBA can get confused really quickly.  Try just doing that to see if it fixes your issue. (at the very least, it&#39;ll help tighten your code up!)"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "is_accepted": false, "score": 0, "last_activity_date": 1473194076, "creation_date": 1473194076, "answer_id": 39357416, "question_id": 39355008, "link": "https://stackoverflow.com/questions/39355008/combine-sheets-from-different-workbooks-with-the-same-names-into-a-master-workbo/39357416#39357416", "title": "Combine Sheets from different workbooks with the same names into a master workbook", "body": "<p>You seem to be copying and pasting into the same source worksheet. Check the code below. That might work. I put in comments in the code.</p>\n\n<pre><code>Sub AddAllWS()\n    Dim wbDst As Workbook\n    Dim wsDst As Worksheet\n    Dim wbSrc As Workbook\n    Dim wsSrc As Worksheet\n    Dim MyPath As String\n    Dim strFilename As String\n    Dim lLastRow As Long\n\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    Set wbDst = ThisWorkbook\n\n    MyPath = \"C:\\Documents and Settings\\path\\to\\\"\n    strFilename = Dir(MyPath &amp; \"*.xls*\", vbNormal)\n\n    Do While strFilename &lt;&gt; \"\"\n\n            Set wbSrc = Workbooks.Open(MyPath &amp; strFilename)\n\n            'loop through each worksheet in the source file\n            For Each wsSrc In wbSrc.Worksheets\n                'Find the corresponding worksheet in the destination with the same name as the source\n                On Error Resume Next\n                Set wsDst = wbDst.Worksheets(wsSrc.Name)\n                On Error GoTo 0\n                If wsDst.Name = wsSrc.Name Then\n                    lLastRow = wsDst.UsedRange.Rows(wsDst.UsedRange.Rows.Count).Row + 1\n                    wsSrc.UsedRange.Copy\n                    wsDst.Range(\"A\" &amp; lLastRow).PasteSpecial xlPasteValues\n                End If\n            Next wsSrc\n\n            wbSrc.Close False\n            strFilename = Dir()\n    Loop\n\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4852575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2caa2599b0a65ac1297d0ed0022c205?s=128&d=identicon&r=PG&f=1", "display_name": "ThePangloss", "link": "https://stackoverflow.com/users/4852575/thepangloss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1976, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473194076, "creation_date": 1473184062, "question_id": 39355008, "link": "https://stackoverflow.com/questions/39355008/combine-sheets-from-different-workbooks-with-the-same-names-into-a-master-workbo", "title": "Combine Sheets from different workbooks with the same names into a master workbook", "body": "<p>so I have about 21 sheets that are all named the exact same across about 16 files. All the formats and such are the exact same, so for example I need to combine all the sheets with \"Age\" in all 16 files into a master file that will have the \"Age\" sheet with the aggregated data of all 16 \"Age\" sheets. Similarly for the other 20 sheet types.</p>\n\n<p>I'm not sure how exactly to do this. I have a macro that currently adds all sheets in a file together into one master workbook, and I'm looking to modify this so it combines similar sheets instead of just adding them all into one workbook.\nAny ideas would be appreciated!</p>\n\n<pre><code>Sub AddAllWS()\nDim wbDst As Workbook\nDim wbSrc As Workbook\nDim wsSrc As Worksheet\nDim MyPath As String\nDim strFilename As String\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nMyPath = \"C:\\Documents and Settings\\path\\to\"\nSet wbDst = ThisWorkbook\nstrFilename = Dir(MyPath &amp; \"\\*.xls\", vbNormal)\n\nIf Len(strFilename) = 0 Then Exit Sub\n\nDo Until strFilename = \"\"\n\n        Set wbSrc = Workbooks.Open(Filename:=MyPath &amp; \"\\\" &amp; strFilename)\n\n        Set wsSrc = wbSrc.Worksheets(1)\n\n        wsSrc.UsedRange.Copy\n\n        wsSrc.Paste (wbSrc.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1))\n\n\n        wbSrc.Close False\n\n    strFilename = Dir()\n\nLoop\nwbDst.Worksheets(1).Delete\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vb6"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473183617, "post_id": 39354871, "comment_id": 66039671, "body": "Why the winforms tag? That&#39;s for the .NET platform (not VBA)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "is_accepted": false, "score": 0, "last_activity_date": 1473236675, "creation_date": 1473236675, "answer_id": 39364794, "question_id": 39354871, "link": "https://stackoverflow.com/questions/39354871/how-to-make-powerpoint-ppapp-appearing-immediately-behind-excel-window/39364794#39364794", "title": "How to make PowerPoint (PPApp) appearing immediately behind Excel window?", "body": "<pre><code>Public Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPublic Declare Function SetWindowPos Lib \"user32\" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long\nPublic Const SWP_DRAWFRAME = &amp;H20\nPublic Const SWP_FRAMECHANGED = &amp;H20        '  The frame changed: send WM_NCCALCSIZE\nPublic Const SWP_HIDEWINDOW = &amp;H80\nPublic Const SWP_NOACTIVATE = &amp;H10\nPublic Const SWP_NOCOPYBITS = &amp;H100\nPublic Const SWP_NOMOVE = &amp;H2\nPublic Const SWP_NOOWNERZORDER = &amp;H200      '  Don't do owner Z ordering\nPublic Const SWP_NOREDRAW = &amp;H8\nPublic Const SWP_NOREPOSITION = &amp;H200\nPublic Const SWP_NOSIZE = &amp;H1\nPublic Const SWP_NOZORDER = &amp;H4\nPublic Const SWP_SHOWWINDOW = &amp;H40\n\nPublic Declare Function SetWindowText Lib \"user32\" Alias \"SetWindowTextA\" (ByVal hwnd As Long, ByVal lpString As String) As Long\n</code></pre>\n\n<p><strong>Set Position</strong></p>\n\n<pre><code>Sub Main()\n\n    On Error Resume Next\n    HWND_TOPMOST = -1\n\n    CmdLine = Command()\n\n    A = Split(CmdLine, Chr(32), 2, 1)\n    B = Split(A(0), \"x\", 2, 1)\n\n    hwindows = FindWindow(vbNullString, A(1))\n    Ret = SetWindowPos(hwindows, HWND_NOTOPMOST, B(0), B(1), 0, 0, SWP_NOREPOSITION + SWP_NOSIZE)\n    If Ret = 0 Then MsgBox \"Set Pos Error is \" &amp; Err.LastDllError\n\nEnd Sub\n</code></pre>\n\n<p><strong>Set Size</strong></p>\n\n<pre><code>Sub Main()\n\n    On Error Resume Next\n    HWND_TOPMOST = -1\n\n    CmdLine = Command()\n\n    A = Split(CmdLine, Chr(32), 2, 1)\n    B = Split(A(0), \"x\", 2, 1)\n\n    hwindows = FindWindow(vbNullString, A(1))\n    Ret = SetWindowPos(hwindows, HWND_NOTOPMOST, 0, 0, B(0), B(1), SWP_NOREPOSITION + SWP_NOMOVE)\n    If Ret = 0 Then MsgBox \"Set Pos Error is \" &amp; Err.LastDllError\n\nEnd Sub\n</code></pre>\n\n<p>To set active window use this API call from the program that is already the active window</p>\n\n<p>SetForegroundWindow\nThe SetForegroundWindow function puts the thread that created the specified window into the foreground and activates the window. Keyboard input is directed to the window, and various visual cues are changed for the user. The system assigns a slightly higher priority to the thread that created the foreground window than it does to other threads. </p>\n\n<pre><code>BOOL SetForegroundWindow(\n  HWND hWnd   // handle to window\n);\nParameters\nhWnd \n[in] Handle to the window that should be activated and brought to the foreground. \n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473236675, "creation_date": 1473183496, "last_edit_date": 1531164843, "question_id": 39354871, "link": "https://stackoverflow.com/questions/39354871/how-to-make-powerpoint-ppapp-appearing-immediately-behind-excel-window", "title": "How to make PowerPoint (PPApp) appearing immediately behind Excel window?", "body": "<p>I am using a progress form that runs on top of an Excel worksheet.</p>\n\n<p>The progress indicates that Excel objects are exported to PowerPoint.</p>\n\n<p>During the export I want the Excel window to resize such that PowerPoint will also be visible at the left.</p>\n\n<p>I am using the following code for resizing Excel. The problem is how to make PowerPoint (PPApp) appearing immediately behind Excel?</p>\n\n<pre><code>With xlApp\n.WindowState = xlNormal\n.Left = 200\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "automation", "catia"], "comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1473866010, "post_id": 39354663, "comment_id": 66305464, "body": "Try with <code>Dim oMyDoc &#39;as Document</code> and <code>Dim oCurrentProd &#39;as Product</code>"}], "answers": [{"tags": [], "owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "is_accepted": false, "score": 0, "last_activity_date": 1475868236, "creation_date": 1475868236, "answer_id": 39924473, "question_id": 39354663, "link": "https://stackoverflow.com/questions/39354663/excel-vba-to-modify-catia-v5-model-properties/39924473#39924473", "title": "Excel vba to modify Catia v5 model properties", "body": "<p>When running a code from CATIA in VBA, some objects gets an error when they are properly typed. Try declaring those objects without a type or as a variant.</p>\n\n<pre><code>Dim CATIA as 'object\nSet CATIA = Getobject(,\"CATIA.Application\")\nDim oMyDoc as 'Document\nDim oCurrentProd as 'Product   \nSet oMyDoc = CATIA.ActiveDocument\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim CATIA as variant\nSet CATIA = Getobject(,\"CATIA.Application\")\nDim oMyDoc as variant\nDim oCurrentProd as variant   \nSet oMyDoc = CATIA.ActiveDocument\n</code></pre>\n\n<p>I recommend you to first declare them properly typed so you can see the object's methods and properties and afterwards change it to variant</p>\n"}], "owner": {"reputation": 25, "user_id": 6682556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b35af17663e89f5879744a16bf6a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingnovice20", "link": "https://stackoverflow.com/users/6682556/programmingnovice20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1028, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1475868236, "creation_date": 1473182714, "last_edit_date": 1531164843, "question_id": 39354663, "link": "https://stackoverflow.com/questions/39354663/excel-vba-to-modify-catia-v5-model-properties", "title": "Excel vba to modify Catia v5 model properties", "body": "<p>I am a novice when it comes to CATIA, but I have a fair amount of experience with VBA in excel. I am trying to develop an excel macro that goes through the all the parts in a catia assembly, renames them by splicing the text where i want, and then reorder them (alpha-numeric ascending order). I believe I can write the algorithm for the actual splicing, renaming, reordering bit. What I am struggling with is actually operating Catia using excel. There is not a lot of information on the internet. I have ticked all the boxes in the references section that start with CATIA. I have written this so far:</p>\n\n<pre><code>Dim CATIA as object\nSet CATIA = Getobject(,\"CATIA.Application\")\nDim oMyDoc as Document\nDim oCurrentProd as Product   'I assume the individual parts within CATIA are_\n                               referenced as products?\nSet oMyDoc = CATIA.ActiveDocument\n</code></pre>\n\n<p>If I try and run just the above code, I get an error saying 'Class doesn't support Automation'. Which means my basics are wrong. Would appreciate help on this and any other information that would enable me to complete my task. Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473182616, "post_id": 39354550, "comment_id": 66039094, "body": "Is your range dynamic or static?"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 1, "creation_date": 1473182987, "post_id": 39354550, "comment_id": 66039308, "body": "try <code>For Each row In myrange.Rows</code>. Then you would need to modify your logic within your loop to only check that row&#39;s info rather than using absolute references"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1473183138, "post_id": 39354550, "comment_id": 66039395, "body": "Also, your <code>If</code> statements in your <code>for each</code> loop don&#39;t actually change when the loop changes. I <i>think</i> you want to do <code>If Cells(row,3).Value &lt;&gt; &quot;&quot; and Cells(row,6).Value = &quot;Control&quot;...</code>, following @Taelsin&#39;s suggestion."}, {"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473186066, "post_id": 39354550, "comment_id": 66040858, "body": "thank you for your help that makes sense...I get a type mismatch error though  If Cells(lRow, &quot;A&quot;) &lt;&gt; &quot;&quot; And Cells(lRow, &quot;F&quot;) = &quot;Control&quot; Then  can you point me in the right area to fix it?  thanks again"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473185985, "post_id": 39354756, "comment_id": 66040810, "body": "this works thank you.  quick question, what would be the best way to expand the are to review in column f?  that is, say the risk in c has 4 line items mitigating.  (procedure, monitor, test, control)  as is, it would call it without a control because it&#39;s out of order but I&#39;d like to be able to have it scan the fields until the next risk occurs in column c"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 2, "last_activity_date": 1473183060, "creation_date": 1473183060, "answer_id": 39354756, "question_id": 39354550, "link": "https://stackoverflow.com/questions/39354550/move-to-next-row-repeat-process-vba/39354756#39354756", "title": "move to next row repeat process vba", "body": "<p>I propose this correction</p>\n\n<pre><code> For Each cell In range(\"F7:F27\")\n     if cell.offset(,-3)&lt;&gt;\"\" then ' check if cell in column C is not empty \n        if cell = \"Control\" then control=control+1 else WoControl=WoControl+1   \n     end if\n Next cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473183165, "creation_date": 1473183165, "answer_id": 39354781, "question_id": 39354550, "link": "https://stackoverflow.com/questions/39354550/move-to-next-row-repeat-process-vba/39354781#39354781", "title": "move to next row repeat process vba", "body": "<p>Try the code below, I think in your case it's better to use a <code>For</code> loop on rows, scanning the values in <strong>Column A</strong> and <strong>Column F</strong> (instead of the entire range).</p>\n\n<pre><code>Sub CountWithWithoutControls()\n\n' counts number of risks with controls and without controls,\n' currently running through each cell and comparing back to original control,\n' need to write to get it to walk down the series\n\nDim cell As Range\n'Dim myrange As Range\nDim control As Long\nDim WoControl As Long\nDim lRow As Long\nDim LastRow As Long\n\n'Set myrange = Range(\"A7:F27\")\n\n' find last row in Column A - risks\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nFor lRow = 7 To LastRow\n    If Cells(lRow, \"A\") &lt;&gt; \"\" And Cells(lRow, \"F\") = \"Control\" Then control = control + 1\n    If Cells(lRow, \"A\") &lt;&gt; \"\" And Cells(lRow, \"F\") &lt;&gt; \"Control\" Then WoControl = WoControl + 1\nNext lRow\n\nMsgBox control &amp; \"  = number of risks with controls; \" &amp; WoControl &amp; \" = number of risks without controls\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473202069, "post_id": 39357314, "comment_id": 66047482, "body": "thank you this helps...the risk column is C sorry for the mistake.  i edited that but the loop appears to end when i have a cell in column c and in column f are blank.  to that point, it called out correctly the risk with and without a control.  can you point me in the right direction to take the loop down the page?  sorry for the dumb question and thank you for your help"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473209252, "post_id": 39357314, "comment_id": 66049172, "body": "@Pauliec - I have updated the answer to allow for blank rows inside the data.  (Previously it stopped as soon as there were blanks in both the control <b>and</b> risk column, now it will go until the last row where either of the columns is non-blank.)"}, {"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473251816, "post_id": 39357314, "comment_id": 66068146, "body": "thank you again.  I get a run time error on this line  If UCase(Trim(.Cells(r, ControlColumn).Value)) = &quot;CONTROL&quot; Then           thoughts on fixing?  I see there was a do and exit do on the first iteration and wondering if it needs inserted again but not sure.  thank you again"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473264950, "post_id": 39357314, "comment_id": 66077689, "body": "(a) It looks like that line will crash in some cases, e.g. if one of the cells contains a &quot;#DIV/0!&quot;.  I&#39;ve edited the answer to put a <code>CStr</code> function in there too - that should fix it.  (b) It doesn&#39;t need an <code>Exit Do</code> anymore - the original code kept going forever until it found blank cells at which point it did the <code>Exit Do</code>, but the edit to handle blank rows within the data changed the code to first work out the specific rows to look at (the <code>StartAtRow</code> and <code>lastRow</code> variables) and then just loop across those rows."}, {"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473267323, "post_id": 39357314, "comment_id": 66078938, "body": "That works!!!!  thank you very much for your help.  I was having the hardest time trying to figure out how to get it to roll through the areas specific to that risk.  it&#39;s been to date a largely manual process but the rows keep getting longer so this will be a huge help!  thank you again!!"}, {"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473453361, "post_id": 39357314, "comment_id": 66163780, "body": "I&#39;m attempting to build on this...the sheet populates a report for risks-with without controls, then the ones with controls-how many have tests monitors how many do not, etc.   Is it possible to next if then statements inside of a for next loop?  that is, if control and monitor and test, then it&#39;s a control with a test and monitor. I put code similar to yours but I&#39;m getting a for next error .  Do you tutor?  Thank you"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473459674, "post_id": 39357314, "comment_id": 66165965, "body": "@Pauliec - it&#39;s better to create a new question, as there won&#39;t be enough room in a comment to help you, and editing the answer based on extra requirements posted in comments is usually &quot;frowned on&quot; (with good reason) in SO.  In the new question, post the code that you are now using, and explain what results you are after.  (I <b>think</b> you are after:  of the &quot;blocks&quot; that have a control record, how many have a &quot;test&quot; record, how many have a &quot;monitor&quot; record, how many have both.  But you may have other records, and therefore other combinations, so make sure you explain those in the question.)"}, {"owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "edited": false, "score": 0, "creation_date": 1473462473, "post_id": 39357314, "comment_id": 66166606, "body": "great thank you for the etiquette tip.  will do post here shortly.  you&#39;re correct, it&#39;s a matter of identifying the different combinations.  thanks again"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1473264573, "last_edit_date": 1473264573, "creation_date": 1473193622, "answer_id": 39357314, "question_id": 39354550, "link": "https://stackoverflow.com/questions/39354550/move-to-next-row-repeat-process-vba/39357314#39357314", "title": "move to next row repeat process vba", "body": "<p>The below code should check each \"block\" of risks to see whether \"Control\" (case-insensitive) appears within the block.</p>\n\n<p>I wasn't sure whether the Risks were in column A or column C (both seem to get mentioned in the question and other answers) so I have used constants to define the columns and start row - change them as appropriate.</p>\n\n<p>(Updated to allow for blank rows within data)</p>\n\n<pre><code>Sub CountWithWithoutControls()\n    Const RiskColumn As String = \"C\"\n    Const ControlColumn As String = \"F\"\n    Const StartAtRow As Long = 7\n\n    Dim r As Long\n    Dim ControlFound As Boolean\n    Dim control As Long\n    Dim WoControl As Long\n\n    Dim lastRow As Long\n\n    With ActiveSheet\n        lastRow = .Range(RiskColumn &amp; .Rows.Count).End(xlUp).Row\n        r = .Range(ControlColumn &amp; .Rows.Count).End(xlUp).Row\n        If lastRow &lt; r Then\n            lastRow = r\n        End If\n\n        ControlFound = False\n        For r = StartAtRow To lastRow\n            If UCase(Trim(CStr(.Cells(r, ControlColumn).Value))) = \"CONTROL\" Then\n                ControlFound = True\n            End If\n            If Not IsEmpty(.Cells(r + 1, RiskColumn)) Then\n                'Store info for previous block each time we encounter a new \"risk\"\n                If ControlFound Then\n                    control = control + 1\n                Else\n                    WoControl = WoControl + 1\n                End If\n                ControlFound = False\n            End If\n        Next\n        'Store info for final \"block\"\n        If ControlFound Then\n            control = control + 1\n        Else\n            WoControl = WoControl + 1\n        End If\n    End With\n\n    MsgBox control &amp; \"  = number of risks with controls, \" &amp; WoControl &amp; \"  = number of risks without controls\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6801125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e27c98750db182b3cfd9f176cb698074?s=128&d=identicon&r=PG&f=1", "display_name": "Pauliec", "link": "https://stackoverflow.com/users/6801125/pauliec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11024, "favorite_count": 0, "accepted_answer_id": 39357314, "answer_count": 3, "score": 1, "last_activity_date": 1473264573, "creation_date": 1473182327, "last_edit_date": 1473182591, "question_id": 39354550, "link": "https://stackoverflow.com/questions/39354550/move-to-next-row-repeat-process-vba", "title": "move to next row repeat process vba", "body": "<p>I have a worksheet with column A listing a series of risks.</p>\n\n<p>Column F lists items that can mitigate these risks.\nI want to write a script to identify if the risks in a have a control or do not have a control\nfor example</p>\n\n<pre><code>A                  F\nRisk7              control\n                   monitor\n                   test\nRisk8              (blank)\n</code></pre>\n\n<p>so output would be 1 risk with a control and one risk without</p>\n\n<p>my script so far is</p>\n\n<pre><code>Sub CountWithWithoutControls()\n\n' counts number of risks with controls and without controls, \n' currently running through each cell and comparing back to original control, \n' need to write to get it to walk down the series\n\n Dim cell As Range\n Dim myrange As Range\n Dim control As Long\n Dim WoControl As Long\n\n Set myrange = Range(\"a7:f27\")\n\n For Each cell In myrange     \n     If Range(\"c7\") &lt;&gt; \"\" And Range(\"f7\") = \"Control\" Then control = control + 1\n     If Range(\"c7\") &lt;&gt; \"\" And Range(\"f7\") &lt;&gt; \"Control\" Then WoControl = WoControl + 1     \n Next cell\n\n MsgBox control &amp; \"  = number of risks with controls\" &amp; WoControl &amp; (\"  = number of risks without controls\")\n\n End Sub\n</code></pre>\n\n<p>I'm new to VBA and while I don't think this should be that hard I'm not making any progress.  any hints in the right direction would be most appreciated!\nthank you all\nPaul</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1473179491, "post_id": 39353800, "comment_id": 66037426, "body": "Not sure what line the error occurs on but try this: <code>file = Dir(ThisWorkbook.Path &amp; &quot;\\Departments\\*.xlsx&quot;)</code> The <code>*</code> character will return all files with the name <code>.xlsx</code> in the folder, for example. Actually, I think the answer is that you need to open the workbook first, before you can copy any range values to it. So insert a <code>Workbooks.Open</code> method before the copy method. (Leaving first part in case it helps)."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1473179653, "post_id": 39353800, "comment_id": 66037506, "body": "This error will pop up on any of your <code>Sheets()</code> or <code>Workbooks()</code> accesses if the item you&#39;re trying to use is not in the collection. Check the value of <code>ThisWorkbook.Path &amp; &quot;\\Departments\\&quot; &amp; file</code> to make sure it&#39;s the name of an already-open workbook. Check that workbook has a sheet named &quot;XXX&quot; and check that your ActiveWorkbook has a sheet named <code>WS.Name</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1473182162, "post_id": 39354446, "comment_id": 66038867, "body": "I&#39;d suggest adding a description of why this will help the OP."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473182189, "post_id": 39354446, "comment_id": 66038886, "body": "Just a personal tweak - since OP just wants the values, you can skip the <code>.Copy</code> altogether, and just set the two ranges equal: <code>wsOutput.Range(&quot;A1&quot;).Value =  wbSource.Sheets(&quot;XXX&quot;).Cells.Value</code>.  (That should work. If not, you just have to size the two ranges equal to eachother)."}, {"owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "edited": false, "score": 0, "creation_date": 1473185833, "post_id": 39354446, "comment_id": 66040731, "body": "I didn&#39;t set the ranges because depending on how much data is on the source sheet it could cause an &quot;Out of memory&quot; error."}], "tags": [], "owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "is_accepted": true, "score": 1, "last_activity_date": 1473185629, "last_edit_date": 1473185629, "creation_date": 1473181912, "answer_id": 39354446, "question_id": 39353800, "link": "https://stackoverflow.com/questions/39353800/copy-paste-between-workbooks-subscript-out-of-range/39354446#39354446", "title": "Copy/Paste between workbooks (Subscript out of range)", "body": "<p>This should resolve the problem. You were not opening the workbook prior to doing the copy/paste. </p>\n\n<pre><code>Sub InsertDepartments()\n    Dim wbOutput As Workbook\n    Dim wsOutput As Worksheet\n    Dim wbSource As Workbook\n    Dim file As Variant\n\n    file = Dir(ThisWorkbook.Path &amp; \"\\Departments\\*.xls*\")\n    Set wbOutput = ActiveWorkbook\n\n    While (file &lt;&gt; \"\")\n\n        Set wsOutput = wbOutput.Sheets.Add(After:=wbOutput.Sheets(\"Start\"))\n        wsOutput.Name = Left(file, InStr(file, \".\") - 1)\n        Set wbSource = Workbooks.Open(ThisWorkbook.Path &amp; \"\\Departments\\\" &amp; file)\n        wbSource.Sheets(\"XXX\").Cells.Copy\n        wsOutput.Range(\"A1\").PasteSpecial xlPasteValues\n        Application.CutCopyMode = False\n        wbSource.Close False\n        file = Dir\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 1110385, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de3eeff277bb346e4c703f0e43b2040b?s=128&d=identicon&r=PG", "display_name": "hskrijelj", "link": "https://stackoverflow.com/users/1110385/hskrijelj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "accepted_answer_id": 39354446, "answer_count": 1, "score": 0, "last_activity_date": 1473185629, "creation_date": 1473179391, "last_edit_date": 1473182303, "question_id": 39353800, "link": "https://stackoverflow.com/questions/39353800/copy-paste-between-workbooks-subscript-out-of-range", "title": "Copy/Paste between workbooks (Subscript out of range)", "body": "<p>I'm having troubles figuring out the problem with my code. I am running through a folder, creating a sheet based on the filename, copying a single cell (A1) and passing it in the new sheet. However, I keep get the following error:</p>\n\n<blockquote>\n  <p>Subscript out of range (Run-time error '9')</p>\n</blockquote>\n\n<p>I have the following code:</p>\n\n<pre><code>Sub InsertDepartments()\n    Dim MyObj As Object, MySource As Object, file As Variant\n    file = Dir(ThisWorkbook.Path &amp; \"\\Departments\\\")\n    While (file &lt;&gt; \"\")\n        Set WS = Sheets.Add(After:=Sheets(\"Start\"))\n        WS.Name = Left(file, InStr(file, \".\") - 1)\n\n        Workbooks(ThisWorkbook.Path &amp; \"\\Departments\\\" &amp; file).Sheets(\"XXX\").Range(\"A1\").Copy\n        Sheets(WS.Name).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n        file = Dir\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone see what is wrong in the code? Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473179836, "post_id": 39353753, "comment_id": 66037591, "body": "And what is the error exactly?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 7, "creation_date": 1473179841, "post_id": 39353753, "comment_id": 66037594, "body": "Instead of this very long question read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> and edit your question down to the minimal amount of information needed to solve the problem."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1473181558, "post_id": 39353753, "comment_id": 66038529, "body": "well, I&#39;m confused, but I think that this line is bad:"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473181619, "post_id": 39353753, "comment_id": 66038563, "body": "Write the necessary range to an array, loop through to figure out how many items you need, size another array to hold them all, then output what you need to the new array, then overwrite the sheet with the new array. Then you don&#39;t actually have to delete rows. Actually deleting that many rows will take forever."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1473182021, "post_id": 39353753, "comment_id": 66038794, "body": "well, that didn&#39;t work out very well. Aside from your problem, &quot;lastRow = wb.Sheets(&quot;host_scan_data&quot;).Range(&quot;K&quot; &amp; wb.Sheets(&quot;host_scan_data&quot;).Rows.Count).End(xlUp).row&quot; seems so complex to me.  Why not just &quot;lastRow = wb.Sheets(&quot;host_scan_data&quot;).cells(rows.count, &quot;K&quot;).End(xlUp).row&quot;"}, {"owner": {"reputation": 1, "user_id": 6801195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f8e352bf5a035e5e8b5378a862c2a1?s=128&d=identicon&r=PG&f=1", "display_name": "IRMHPE", "link": "https://stackoverflow.com/users/6801195/irmhpe"}, "edited": false, "score": 0, "creation_date": 1473183070, "post_id": 39353753, "comment_id": 66039360, "body": "Kyle - how would i go about creating an array to loop through my items?  i apologize but i&#39;m not very fluent with VBA.  In my source workbook within the host_scan_data sheet i have a total of 24 columns (A:X) that contain content.  I would only like to create a filter on column &quot;K&quot; that will check to see if the value contains a &quot;0&quot; and if so i&#39;d like delete/omit that from being imported into my Workbook.  Note: i do not intend on copying all columns (A:X) from workbook 1 into workbook 2, just B,K,H,M,L,O,G,X."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473196461, "post_id": 39353753, "comment_id": 66045777, "body": "@IRMHPE It&#39;s quite a lot of code (at least for me to want to knock out the code for you). Look into arrays. The idea is to scan column &quot;K&quot;, if the value in column &quot;K&quot; does not contain 0, then count that item. Once you have a count all the items, size the array based on the count and loop back through, but this time, add the desired data points to your new array as you loop instead of just counting."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6803760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5228cd2441f33ac2f7e2b4ed5ca471?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Webber", "link": "https://stackoverflow.com/users/6803760/graham-webber"}, "is_accepted": false, "score": 0, "last_activity_date": 1473237320, "creation_date": 1473237320, "answer_id": 39365018, "question_id": 39353753, "link": "https://stackoverflow.com/questions/39353753/vba-to-delete-entire-row-based-on-cell-value/39365018#39365018", "title": "VBA to delete entire row based on cell value", "body": "<p>So here is what may be happening.</p>\n\n<p>If the row you are deleting has data used, in a formula somewhere else, that formula is going to recalculate on every iteration of the row delete.</p>\n\n<p>I had this problem with a data set which has many Vlookup functions pulling data.</p>\n\n<p>here is what I did and it take a few seconds rather than 30min</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Sub removeLines()\r\nDim i As Long\r\nDim celltxt As String\r\nDim EOF As Boolean\r\nDim rangesize As Long\r\nEOF = False\r\ni = 1\r\n'My data has \"End of File\" at the end so I check for that \r\n' Though it would be better to used usedRange\r\nWhile Not (EOF)\r\n    celltxt = ActiveSheet.Cells(i, 1).Text \r\n    If InStr(1, celltxt, \"end\", VbCompareMethod.vbTextCompare) &gt; 0 Then\r\n       EOF = True 'if we reach the \"end Of file\" then exit\r\n\r\n' so I clear a cell that has no influence on any functions thus \r\n' it executes quickly\r\n    ElseIf InStr(1, celltxt, \"J\") &lt;&gt; 1 Then\r\n        Cells(i, 1).Clear\r\n    End If\r\n    i = i + 1\r\nWend\r\n' once all the rows to be deleted are marked with the cleared cell\r\n' I use the specialCells to select and delete all the rows at once\r\n' so that the dependent formula are only recalculated once \r\n    Columns(\"A:A\").Select\r\n    Selection.SpecialCells(xlCellTypeBlanks).Select\r\n    Selection.EntireRow.Delete\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>hope this helps and that it is read able</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6801195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f8e352bf5a035e5e8b5378a862c2a1?s=128&d=identicon&r=PG&f=1", "display_name": "IRMHPE", "link": "https://stackoverflow.com/users/6801195/irmhpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473347688, "creation_date": 1473347688, "answer_id": 39394625, "question_id": 39353753, "link": "https://stackoverflow.com/questions/39353753/vba-to-delete-entire-row-based-on-cell-value/39394625#39394625", "title": "VBA to delete entire row based on cell value", "body": "<p>I tried a little different approach by using AutoFilter and i'm seeing a high success rate on my larger lists however there still is one issue.  With the code below i was able to parse through 67k+ rows and filter/delete any row contains a \"0\" in my column K (this takes approx 276 seconds to complete), after the code filters and deletes the rows with zeros it clears any existing filters then is  to copy the remaining data into my Workbook #2 (this is approx 7k rows) however it is consistently only copying 17 rows of data into my workbook #2, it just seems to stops and i have no idea why.  Also, while 4.5 mins to complete the consolidation could be acceptable does anyone have any ideas on how to speed this up?</p>\n\n<pre><code>Sub Import()\n Dim strAnswer\n Dim itAnswer As String\n Dim OpenFileName As String\n Dim wb As Workbook\n Dim db As Workbook\n Dim Avals As Variant, X As Variant\n Dim i As Long\n Dim FileLastRow As Long\n Dim t As Single\n Dim SevRng As Range\n t = Timer\n\n 'Optimize Code\n  Call OptimizeCode_Begin\n\n 'Select and Open workbook\n OpenFileName = Application.GetOpenFilename(\"*.xlsx,\")\n If OpenFileName = \"False\" Then Exit Sub\n Set wb = Workbooks.Open(OpenFileName, UpdateLinks:=0)\n Set db = ThisWorkbook\n\n 'Provide Sheet Input\n    strAnswer = InputBox(\"Please enter name of worksheet where Nessus data will be imported:\", \"Import Name\")\n\n    If strAnswer = \"\" Then\n\n        MsgBox \"You must enter a valid name. Exiting now...\"\n        wb.Close\n        Exit Sub\n    Else\n\n        Response = MsgBox(strAnswer, vbYesNo + vbCritical + vbDefaultButton2, \"Is this Correct?\")\n        If Response = vbNo Then\n            MsgBox \"Got it, you made a mistake. Exiting now...\"\n            wb.Close\n            Exit Sub\n        Else: MsgBox \"Importing Now!\"\n        End If\n    End If\n\n    FileLastRow = wb.Sheets(\"host_scan_data\").Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n    Set SevRng = wb.Sheets(\"host_scan_data\").Range(\"K2:K\" &amp; FileLastRow)\n\n    Application.DisplayAlerts = False\n    With SevRng\n        .AutoFilter Field:=11, Criteria1:=\"0\"\n        .Offset(1, 0).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Rows.Delete\n        .Cells.AutoFilter\n    End With\n\n    Application.DisplayAlerts = True\n\n    MsgBox \"Consolidated in \" &amp; Timer - t &amp; \" seconds.\"\n\n            countNum = (Application.CountA(Range(\"B:B\"))) - 1\n            MsgBox (countNum &amp; \" Rows being imported now!\")\n            countNum = countNum + 2\n            db.Sheets(strAnswer).Range(\"A3:A\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"B3:B\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"B3:B\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"K3:K\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"C3:C\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"H3:H\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"D3:D\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"M3:M\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"E3:E\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"L3:L\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"F3:F\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"O3:O\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"G3:G\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"G3:G\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"K3:K\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"X3:X\" &amp; countNum).value\n            MsgBox (\"Done\")\n            'Close nessus file\n            wb.Close SaveChanges:=False\n\n Sheets(strAnswer).Select\n\n 'Optimize Code\n  Call OptimizeCode_End\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6803760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5228cd2441f33ac2f7e2b4ed5ca471?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Webber", "link": "https://stackoverflow.com/users/6803760/graham-webber"}, "is_accepted": false, "score": 0, "last_activity_date": 1473420721, "creation_date": 1473420721, "answer_id": 39410621, "question_id": 39353753, "link": "https://stackoverflow.com/questions/39353753/vba-to-delete-entire-row-based-on-cell-value/39410621#39410621", "title": "VBA to delete entire row based on cell value", "body": "<p>Does your \n\"MsgBox (countNum &amp; \" Rows being imported now!\")\"\nreturn the correct number of rows?\nCountA will stop counting at the first empty cell.</p>\n\n<p>Try instread:\ncountNum = ActiveSheet.UsedRange.Rows.Count</p>\n"}], "owner": {"reputation": 1, "user_id": 6801195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f8e352bf5a035e5e8b5378a862c2a1?s=128&d=identicon&r=PG&f=1", "display_name": "IRMHPE", "link": "https://stackoverflow.com/users/6801195/irmhpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1264, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473420721, "creation_date": 1473179286, "last_edit_date": 1473183212, "question_id": 39353753, "link": "https://stackoverflow.com/questions/39353753/vba-to-delete-entire-row-based-on-cell-value", "title": "VBA to delete entire row based on cell value", "body": "<p>I'm experiencing some issues getting the provided VBA code working and would appreciate any assistance. </p>\n\n<p>I have two Workbooks (1) is a monthly report I receive that has multiple worksheets, Worksheet \"<strong>host_scan_data</strong>\" contains the source of the information I will need to work with. The other Workbook (2) is where I will store all consolidated date month over month.</p>\n\n<p>How I'm trying to accomplish this task:\n1. launch workbook #2\n2. click a button that has the following VBA code assigned to (see below)\n3. browse and select my monthly report (workbook #1)\n4. specify the worksheet tab in workbook #2 where i'd like to store this consolidate information\n5. prompt user to validate worksheet tab where data will be stored</p>\n\n<p>Based on the responses above the macro will then analyze <strong>Column K</strong> within the \"<strong>host_scan_data</strong>\" Sheet of the Workbook (1), and I would like for it to remove all rows where <strong>Column k</strong> contains a \"0\" (note the only values i'm concerned about are 4,3,2,1). Once that action is complete i'd like for the macro to copy the consolidated list of entry's over to the location specified in step #4 above. </p>\n\n<p>I've tried this with a few variations of code and other solutions appear to work fine when the \"<strong>host_scan_data</strong>\" Sheet contains &lt;4,000 rows however once I exceed that number (give or take) excel becomes unresponsive. Ideally this solution will need to handle approx 150,000+ rows.</p>\n\n<p>Here is the code i'm currently using, when i execute it errors out at \".Sort .Columns(cl + 1), Header:=xlYes\":</p>\n\n<p>The Code I Have so far:</p>\n\n<pre><code>Sub Import()\n Dim strAnswer\n Dim itAnswer As String\n Dim OpenFileName As String\n Dim wb As Workbook\n Dim db As Workbook\n Dim Avals As Variant, X As Variant\n Dim i As Long, LR As Long\n\n 'Optimize Code\n  Call OptimizeCode_Begin\n\n 'Select and Open workbook\n OpenFileName = Application.GetOpenFilename(\"*.xlsx,\")\n If OpenFileName = \"False\" Then Exit Sub\n Set wb = Workbooks.Open(OpenFileName, UpdateLinks:=0)\n Set db = ThisWorkbook\n\n 'Provide Sheet Input\n    strAnswer = InputBox(\"Please enter name of worksheet where Nessus data will be imported:\", \"Import Name\")\n\n    If strAnswer = \"\" Then\n\n        MsgBox \"You must enter a valid name. Exiting now...\"\n        wb.Close\n        Exit Sub\n    Else\n\n        Response = MsgBox(strAnswer, vbYesNo + vbCritical + vbDefaultButton2, \"Is this Correct?\")\n        If Response = vbNo Then\n            MsgBox \"Got it, you made a mistake. Exiting now...\"\n            wb.Close\n            Exit Sub\n        Else: MsgBox \"Importing Now!\"\n        End If\n    End If\n\n    wb.Sheets(\"host_scan_data\").Activate\n            Dim rs, cl, Q()\n            Dim arr1, j, C, s As Long\n\n            Dim t As String: t = \"4\"\n            Dim u As String: u = \"3\"\n            Dim v As String: v = \"2\"\n            Dim w As String: w = \"1\"\n\n            If Cells(1) = \"\" Then Cells(1) = Chr(2)\n            'Application.Calculation = xlManual\n            rs = wb.Sheets(\"host_scan_data\").Cells.Find(\"*\", , , , , xlByRows, xlPrevious).Row\n            cl = wb.Sheets(\"host_scan_data\").Cells.Find(\"*\", , , , , xlByColumns, xlPrevious).Column\n            ReDim Q(1 To rs, 1 To 1)\n            arr1 = wb.Sheets(\"host_scan_data\").Cells(1, \"k\").Resize(rs)\n            For j = 1 To rs\n                C = arr1(j, 1)\n                If (C &lt;&gt; t) * (C &lt;&gt; u) * (C &lt;&gt; v) * (C &lt;&gt; w) Then Q(j, 1) = 1: s = s + 1\n            Next j\n            If s &gt; 0 Then\n                With Cells(1).Resize(rs, cl + 1)\n                    .Columns(cl + 1) = Q\n                    .Sort .Columns(cl + 1), Header:=xlYes\n                    .Cells(cl + 1).Resize(s).EntireRow.Delete\n                End With\n            End If\n\n            countNum = (Application.CountA(Range(\"B:B\"))) - 1\n            MsgBox (countNum &amp; \" Rows being imported now!\")\n            countNum = countNum + 2\n            db.Sheets(strAnswer).Range(\"A3:A\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"B3:B\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"B3:B\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"K3:K\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"C3:C\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"H3:H\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"D3:D\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"M3:M\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"E3:E\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"L3:L\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"F3:F\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"O3:O\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"G3:G\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"G3:G\" &amp; countNum).value\n            db.Sheets(strAnswer).Range(\"K3:K\" &amp; countNum).value = wb.Sheets(\"host_scan_data\").Range(\"X3:X\" &amp; countNum).value\n            MsgBox (\"Done\")\n            'Close nessus file\n            wb.Close SaveChanges:=False\n        'Else\n            'MsgBox \"You must enter 1 or 2 only. Exiting now...\"\n            'wb.Close\n            'Exit Sub\n   'End If\n\n\n\n Sheets(strAnswer).Select\n\n 'Optimize Code\n  Call OptimizeCode_End\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 4, "creation_date": 1473178460, "post_id": 39353402, "comment_id": 66036881, "body": "Record a macro doing what you want see the code understand and modify it."}], "answers": [{"tags": [], "owner": {"reputation": 300, "user_id": 6679564, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/063096bdb8908a2084454a639a838531?s=128&d=identicon&r=PG&f=1", "display_name": "Tchotchke", "link": "https://stackoverflow.com/users/6679564/tchotchke"}, "is_accepted": false, "score": 0, "last_activity_date": 1473179448, "creation_date": 1473179448, "answer_id": 39353816, "question_id": 39353402, "link": "https://stackoverflow.com/questions/39353402/how-to-insert-n-number-of-rows-on-a-sperate-sheet-based-on-n-being-a-number/39353816#39353816", "title": "How to insert &#39;n&#39; number of rows on a sperate sheet based on &#39;n&#39; being a number in a cell", "body": "<p>You may have to modify this a little for your needs...</p>\n\n<pre><code>workbook.sheet(\"yoursheet\").rows(startRow &amp; \":\" &amp; startRow+numberOfRowsYouWant).Insert Shift:=xlDown\n</code></pre>\n\n<p>If you want to insert 5 lines at row 60, for example:</p>\n\n<pre><code>workbook.sheet(\"yoursheet\").rows(\"60:\" &amp; 60+5).Insert Shift:=xlDown\n</code></pre>\n\n<p>Let me know if this doesn't work.</p>\n"}], "owner": {"reputation": 1, "user_id": 6801052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fdfdc03bcaf0bf8af8a52c37652f45?s=128&d=identicon&r=PG&f=1", "display_name": "Rkrause1", "link": "https://stackoverflow.com/users/6801052/rkrause1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1473179448, "creation_date": 1473178029, "last_edit_date": 1473179216, "question_id": 39353402, "link": "https://stackoverflow.com/questions/39353402/how-to-insert-n-number-of-rows-on-a-sperate-sheet-based-on-n-being-a-number", "title": "How to insert &#39;n&#39; number of rows on a sperate sheet based on &#39;n&#39; being a number in a cell", "body": "<p>I have to make my teams workload each month. It changes, based on number of working days how many auditors there will be available, and how may audits are needed for each company. If i can have the sheet auto balance the load based on how many total audits are needed for each company, then determine how many working days a person might have in the month that would be amazing. </p>\n\n<p>But for now - I would really like to be able to have it create a separate sheet for each auditor with their name in column A and the name of the account in column B based on how many audits they have been assigned. </p>\n\n<p><a href=\"https://i.stack.imgur.com/U9eUa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9eUa.jpg\" alt=\"example worksheet\"></a></p>\n"}, {"tags": ["regex", "string", "vba", "excel"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1473178301, "post_id": 39353317, "comment_id": 66036805, "body": "Are you trying to do this <b>one Regex expression</b>? It sounds like you have it figured out for doing it with three expressions. All RegEx returns is whether one a match occurs and how many and what they are"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1473179355, "post_id": 39353317, "comment_id": 66037359, "body": "Is there any compelling reason to use regex? Especially since your string has a well established separator, a quick token-extraction function would work just as quickly."}, {"owner": {"reputation": 1, "user_id": 6801018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ab7313e68881135fd3ab3eeec243a8?s=128&d=identicon&r=PG&f=1", "display_name": "tip_tip", "link": "https://stackoverflow.com/users/6801018/tip-tip"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473318017, "post_id": 39353317, "comment_id": 66095951, "body": "@dbmitch No, there are going to be multiple Regex expressions as the string contains several combinations. Peter, there is no specific reason for it - I think i should look into your suggestion. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1473179966, "creation_date": 1473179966, "answer_id": 39353950, "question_id": 39353317, "link": "https://stackoverflow.com/questions/39353317/vba-regex-identifiying-multiple-patterns-excel/39353950#39353950", "title": "VBA RegEx identifiying multiple patterns - Excel", "body": "<p>Like @dbmitch mentions in the comments, you can't do this with a single Regex - you'll need to use 3 of them. I'd personally put the cities and countries into <code>Consts</code> and build the patterns as need.  You can then pass them (along with the <code>strReplace</code>) as <em>parameters</em> to <code>simpleCellRegex</code> function:</p>\n\n<pre><code>Const CITIES As String = \"(munich|berlin|new-york|porto|copenhagen|moscow)\"\nConst COUNTRIES As String = \"(germany|france|usa|russia|etc)\"\n\nFunction simpleCellRegex(Myrange As Range, strReplace As String, strPattern As String) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n    If strPattern &lt;&gt; \"\" Then\n        strInput = Myrange.Value\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n\n        If regEx.test(strInput) Then\n            simpleCellRegex = regEx.Replace(strInput, strReplace)\n        Else\n            simpleCellRegex = \"NO MATCH FOUND\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>Called like this:</p>\n\n<pre><code>foo = simpleCellRegex(someRange, \"CITY TO CITY\", CITIES &amp; \"/\" &amp; CITIES)\nfoo = simpleCellRegex(someRange, \"CITY TO COUNTRY\", CITIES &amp; \"/\" &amp; COUNTRIES)\nfoo = simpleCellRegex(someRange, \"COUNTRY TO COUNTRY\", COUNTRIES &amp; \"/\" &amp; COUNTRIES)\n</code></pre>\n\n<p>Note: If you're doing this in a loop, it would be wildly more efficient to only build each <code>RegExp</code> <strong><em>once</em></strong>, and then pass <em>that</em> as a parameter instead of the pattern.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473181246, "creation_date": 1473181246, "answer_id": 39354282, "question_id": 39353317, "link": "https://stackoverflow.com/questions/39353317/vba-regex-identifiying-multiple-patterns-excel/39354282#39354282", "title": "VBA RegEx identifiying multiple patterns - Excel", "body": "<p>A little (maybe) \"out of the box\" solution:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Const CITIES As String = \"MUNICH|BERLIN|NEWYORK|PORTO|COPENHAGEN|MOSCOW\"\n    Const COUNTRIES As String = \"USA|GERMANY\"\n\n    With Worksheets(\"FLIGHTS\")\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp))\n            With .Offset(, 1)\n                .value = .Offset(, -1).value\n                .Replace What:=\"*flights/\", replacement:=\"\", LookAt:=xlPart, MatchCase:=False\n                .Replace What:=\"/\", replacement:=\" to \", LookAt:=xlPart, MatchCase:=False\n                ReplaceElement .Cells, CITIES, \"city\"\n                ReplaceElement .Cells, COUNTRIES, \"country\"\n            End With\n        End With\n    End With\nEnd Sub\n\nSub ReplaceElement(rng As Range, whats As String, replacement As String)\n    Dim elem As Variant\n\n    With rng\n        For Each elem In Split(whats, \"|\")\n            .Replace What:=elem, replacement:=replacement, LookAt:=xlPart, MatchCase:=False\n        Next elem\n    End With\nEnd Sub\n</code></pre>\n\n<p>note</p>\n\n<ul>\n<li>replace() methods can be <em>taught</em> to ignore cases but beware to have consistency between names: \"newyork\" will never match \"new-york\"</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1473189305, "last_edit_date": 1473189305, "creation_date": 1473188123, "answer_id": 39356002, "question_id": 39353317, "link": "https://stackoverflow.com/questions/39353317/vba-regex-identifiying-multiple-patterns-excel/39356002#39356002", "title": "VBA RegEx identifiying multiple patterns - Excel", "body": "<p>I would do this a bit differently.\nI would make the regex pattern the start or end point, and match it against a comma delimited string of cities or countries.</p>\n\n<p>Given what you have presented, the start and end points will always be the last two <code>/</code> separated units.</p>\n\n<p>So something like:</p>\n\n<pre><code>Option Explicit\nSub CategorizeFlights()\n    Dim rData As Range, vData As Variant\n    Dim arrCity() As Variant\n    Dim arrCountry() As Variant\n    Dim I As Long, J As Long\n    Dim sCategoryStart As String, sCategoryEnd As String\n    Dim V As Variant\n    Dim RE As RegExp\n\narrCity = Array(\"munich\", \"newyork\")\narrCountry = Array(\"usa\", \"germany\")\n\nSet RE = New RegExp\nWith RE\n    .Global = False\n    .ignorecase = True\nEnd With\n\nSet rData = Range(\"A2\", Cells(Rows.Count, \"A\").End(xlUp)).Resize(columnsize:=2)\nvData = rData\n\nFor I = 1 To UBound(vData, 1)\n    V = Split(vData(I, 1), \"/\")\n\n        RE.Pattern = \"\\b\" &amp; V(UBound(V) - 1) &amp; \"\\b\"\n        If RE.test(Join(arrCity, \",\")) = True Then\n                sCategoryStart = \"City to \"\n        ElseIf RE.test(Join(arrCountry, \",\")) = True Then\n                sCategoryStart = \"Country to \"\n        Else\n                sCategoryStart = \"Unknown to \"\n        End If\n\n        RE.Pattern = \"\\b\" &amp; V(UBound(V)) &amp; \"\\b\"\n        If RE.test(Join(arrCity, \",\")) = True Then\n                sCategoryEnd = \"City\"\n        ElseIf RE.test(Join(arrCountry, \",\")) = True Then\n                sCategoryEnd = \"Country\"\n        Else\n                sCategoryEnd = \"Unknown\"\n        End If\n\n    vData(I, 2) = sCategoryStart &amp; sCategoryEnd\nNext I\n\nWith rData\n    .Value = vData\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>As is sometimes the case, a similar algorithm can be used without regular expressions, but I assume this is an exercise in its use.</p>\n"}], "owner": {"reputation": 1, "user_id": 6801018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ab7313e68881135fd3ab3eeec243a8?s=128&d=identicon&r=PG&f=1", "display_name": "tip_tip", "link": "https://stackoverflow.com/users/6801018/tip-tip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4313, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473189305, "creation_date": 1473177740, "last_edit_date": 1495542765, "question_id": 39353317, "link": "https://stackoverflow.com/questions/39353317/vba-regex-identifiying-multiple-patterns-excel", "title": "VBA RegEx identifiying multiple patterns - Excel", "body": "<p>I\u00b4m rather new to VBA RegEx, but thanks to this <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">stackoverflow thread</a>, </p>\n\n<p>I am getting to it. I have a problem and hope that somebody can help. In row 1 in Excel I have multiple Strings with different city/country attribution. Example:</p>\n\n<pre><code>A1: \"/flights/munich/newyork\"\nA2: \"flights/munich/usa\"\nA3:  \"flights/usa/germany\"\n...\n</code></pre>\n\n<p>What I wanna have now, is a VBA that goes though those strings with RegEx and prompts a categorisation value if the RegEx is met. Example:</p>\n\n<pre><code>A1: \"/flights/munich/new-york\" categorises as \"city to city\"\nA2: \"flights/munich/usa\" categorises as \"city to country\"\nA3:  \"flights/usa/germany\" categorises as \"country to country\"\n</code></pre>\n\n<p>Right now, I have a code that will return the \"city to city\" category to me, but I can\u00b4t figure out who to get a code that handles the multiple patterns and returns the corresponding output string.</p>\n\n<p>In short, a logic like this is needed:</p>\n\n<p>If A1 contains RegEx <code>\".*/munich/new-york\"</code> then return output string <code>\"city to city\"</code>, if A1 contains RegEx <code>\".*/munich/usa\"</code> then return output string <code>\"city to country\"</code> and so on.</p>\n\n<p>Guess this has something to to with how to handle multiple if statements with multiple patterns in VBA, but I can\u00b4t figure it out. </p>\n\n<p>This is how my code looks right now - hope you can help!</p>\n\n<pre><code>Function simpleCellRegex(Myrange As Range) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n    strPattern = \"(munich|berlin|new-york|porto|copenhagen|moscow)/(munich|berlin|new-york|porto|copenhagen|moscow)\"\n\n    If strPattern &lt;&gt; \"\" Then\n        strInput = Myrange.Value\n        strReplace = \"CITY TO CITY\"\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n\n        If regEx.Test(strInput) Then\n            simpleCellRegex = regEx.Replace(strInput, strReplace)\n        Else\n            simpleCellRegex = \"NO MATCH FOUND\"\n        End If\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["python", "vba", "xpath", "import", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6778694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e70ebc61edfabd036a535c5b23666cf?s=128&d=identicon&r=PG&f=1", "display_name": "KarlJensen", "link": "https://stackoverflow.com/users/6778694/karljensen"}, "edited": false, "score": 0, "creation_date": 1473179779, "post_id": 39353663, "comment_id": 66037560, "body": "Great! Thank you so much @PadraicCunningham ! I really didn&#39;t have a clue. :) Now just one last question. How do I store the two xlsx files, which is now stored in v?"}, {"owner": {"reputation": 159764, "user_id": 2141635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/f6yNV.jpg?s=128&g=1", "display_name": "Padraic Cunningham", "link": "https://stackoverflow.com/users/2141635/padraic-cunningham"}, "reply_to_user": {"reputation": 59, "user_id": 6778694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e70ebc61edfabd036a535c5b23666cf?s=128&d=identicon&r=PG&f=1", "display_name": "KarlJensen", "link": "https://stackoverflow.com/users/6778694/karljensen"}, "edited": false, "score": 0, "creation_date": 1473181202, "post_id": 39353663, "comment_id": 66038350, "body": "@JSkjold, do you mean download?"}, {"owner": {"reputation": 59, "user_id": 6778694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e70ebc61edfabd036a535c5b23666cf?s=128&d=identicon&r=PG&f=1", "display_name": "KarlJensen", "link": "https://stackoverflow.com/users/6778694/karljensen"}, "edited": false, "score": 0, "creation_date": 1473182895, "post_id": 39353663, "comment_id": 66039256, "body": "Yes, @PadraicCunningham. But never mind, I figured it out. But thanks again! Cheers"}, {"owner": {"reputation": 159764, "user_id": 2141635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/f6yNV.jpg?s=128&g=1", "display_name": "Padraic Cunningham", "link": "https://stackoverflow.com/users/2141635/padraic-cunningham"}, "reply_to_user": {"reputation": 59, "user_id": 6778694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e70ebc61edfabd036a535c5b23666cf?s=128&d=identicon&r=PG&f=1", "display_name": "KarlJensen", "link": "https://stackoverflow.com/users/6778694/karljensen"}, "edited": false, "score": 0, "creation_date": 1473182997, "post_id": 39353663, "comment_id": 66039315, "body": "No prob, the second snippet does it anyway."}], "tags": [], "owner": {"reputation": 159764, "user_id": 2141635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/f6yNV.jpg?s=128&g=1", "display_name": "Padraic Cunningham", "link": "https://stackoverflow.com/users/2141635/padraic-cunningham"}, "is_accepted": true, "score": 0, "last_activity_date": 1473181553, "last_edit_date": 1473181553, "creation_date": 1473178972, "answer_id": 39353663, "question_id": 39353191, "link": "https://stackoverflow.com/questions/39353191/trouble-downloading-xlsx-file-from-website-scraping/39353663#39353663", "title": "Trouble downloading xlsx file from website - Scraping", "body": "<p>Just use <em>contains</em> to find the <em>hrefs</em> and slice the first two:</p>\n\n<pre><code> tree.xpath('//p/a[contains(@href, \"/site-files/library/EirGrid/Outage-Weeks\")]/@href')[:2]\n</code></pre>\n\n<p>Or doing it all with the xpath using <code>[position() &lt; 3]</code>:</p>\n\n<pre><code>tree.xpath'(//p/a[contains(@href, \"site-files/library/EirGrid/Outage-Weeks\")])[position() &lt; 3]/@href')\n</code></pre>\n\n<p>The files are ordered from latest to oldest so getting the first two gives you the two newest.</p>\n\n<p>To download the files you just need to join each href to the base url and write the content to a file:</p>\n\n<pre><code>from lxml import html\nimport requests\nimport os\nfrom urlparse import urljoin # from urllib.parse import urljoin\n\n\npage = requests.get('http://www.eirgridgroup.com/customer-and-industry/general-customer-information/outage-information/')\ntree = html.fromstring(page.content)\n\nv = tree.xpath('(//p/a[contains(@href, \"/site-files/library/EirGrid/Outage-Weeks\")])[position() &lt; 3]/@href')\nfor href in v:\n    # os.path.basename(href) -&gt; Outage-Weeks_35(2016)-50(2016).xlsx \n    with open(os.path.basename(href), \"wb\") as f:\n        f.write(requests.get(urljoin(\"http://www.eirgridgroup.com\", link)).content)\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6778694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e70ebc61edfabd036a535c5b23666cf?s=128&d=identicon&r=PG&f=1", "display_name": "KarlJensen", "link": "https://stackoverflow.com/users/6778694/karljensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 1, "accepted_answer_id": 39353663, "answer_count": 1, "score": 1, "last_activity_date": 1473181553, "creation_date": 1473177305, "question_id": 39353191, "link": "https://stackoverflow.com/questions/39353191/trouble-downloading-xlsx-file-from-website-scraping", "title": "Trouble downloading xlsx file from website - Scraping", "body": "<p>I'm trying to write some code which download the two latest publications of the Outage Weeks found at the  bottom of <a href=\"http://www.eirgridgroup.com/customer-and-industry/general-customer-information/outage-information/\" rel=\"nofollow\">http://www.eirgridgroup.com/customer-and-industry/general-customer-information/outage-information/</a></p>\n\n<p>It's xlsx-files, which I'm going to load into Excel afterwards.\nIt doesn't matter which programming language the code is written in. </p>\n\n<p>My first idea was to use the direct url's, like <a href=\"http://www.eirgridgroup.com/site-files/library/EirGrid/Outage-Weeks_36(2016)-51(2016)_31%20August.xlsx\" rel=\"nofollow\">http://www.eirgridgroup.com/site-files/library/EirGrid/Outage-Weeks_36(2016)-51(2016)_31%20August.xlsx</a>\n, and then make some code which guesses the url of the two latest publications.\nBut I have noticed some inconsistencies in the url names, so that solution wouldn't work. </p>\n\n<p>Instead it might be solution to scrape the website and use the XPath to download the files. I found out that the two latest publications always have the following XPaths:</p>\n\n<pre><code>/html/body/div[3]/div[3]/div/div/p[5]/a\n/html/body/div[3]/div[3]/div/div/p[6]/a\n</code></pre>\n\n<p>This is where I need help. I'm new to both XPath and Web Scraping. I have tried stuff like this in Python</p>\n\n<pre><code>from lxml import html\nimport requests\n\npage = requests.get('http://www.eirgridgroup.com/customer-and-industry/general-customer-information/outage-information/')\ntree = html.fromstring(page.content)\n\nv = tree.xpath('/html/body/div[3]/div[3]/div/div/p[5]/a')\n</code></pre>\n\n<p>But v seems to be empty.</p>\n\n<p>Any ideas would be greatly appreciated! </p>\n"}, {"tags": ["vba", "excel", "runtime-error", "msgbox"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473177130, "post_id": 39353101, "comment_id": 66036116, "body": "why do you have the &quot;*&quot; at the end ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473177319, "post_id": 39353101, "comment_id": 66036233, "body": "modify <code>*MsgBox (&quot;Proxy Candidate Found at &quot; And rngX.Address)</code> to <code>MsgBox &quot;Proxy Candidate Found at &quot; &amp; rngX.Address</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473177808, "post_id": 39353101, "comment_id": 66036527, "body": "Did you omit some code?  @litelite has the correct answer re. the Error 13, but your <code>Do</code> loop doesn&#39;t have any way to <i>exit</i>. Also <code>If Rng Is found Then</code> should be <code>If Not Rng Is Nothing Then</code>."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473178182, "post_id": 39353101, "comment_id": 66036733, "body": "@Comintern There is a <code>goto</code> in the if which he uses to break out of the infinite loop"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473178350, "post_id": 39353101, "comment_id": 66036824, "body": "@Comintern true, i read that quickly. His code will never end..."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473180512, "post_id": 39353207, "comment_id": 66037926, "body": "The parentheses are superfluous. And they can bite you in the rear end, too - see <a href=\"http://stackoverflow.com/documentation/vba/1179/procedure-calls/3818/this-is-confusing-why-not-just-always-use-parentheses#t=201609061647521040081\">this is confusing, why not just always use parentheses?</a>."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1473236535, "post_id": 39353207, "comment_id": 66058201, "body": "Office VBA documentation for <code>&amp;</code> is <a href=\"https://msdn.microsoft.com/en-en/library/office/gg264104.aspx\" rel=\"nofollow noreferrer\">here</a> and for <code>And</code> it&#39;s <a href=\"https://msdn.microsoft.com/en-en/library/office/gg251591.aspx\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 4, "last_activity_date": 1473177721, "last_edit_date": 1473177721, "creation_date": 1473177346, "answer_id": 39353207, "question_id": 39353101, "link": "https://stackoverflow.com/questions/39353101/vba-runtime-error-13-using-msgbox/39353207#39353207", "title": "VBA runtime error 13 using Msgbox", "body": "<p>You are trying to use the binary operator <code>And</code> on two strings. You probably meant to use <code>&amp;</code> instead to concatenate strings.</p>\n\n<p>Documentation :</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/sdbcfyzh(v=vs.90).aspx\" rel=\"nofollow\"><code>And</code></a> </li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/wfx50zyk(v=vs.90).aspx\" rel=\"nofollow\"><code>&amp;</code></a></li>\n</ul>\n\n<p>(The docs are for VB.Net, but they work the same in both languages)</p>\n\n<p>So to fix it, replace </p>\n\n<pre><code>MsgBox (\"Proxy Candidate Found at \" And rngX.Address)\n</code></pre>\n\n<p>By </p>\n\n<pre><code>MsgBox (\"Proxy Candidate Found at \" &amp; rngX.Address)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473232062, "post_id": 39354609, "comment_id": 66055606, "body": "Thanks guys, I now no longer get the error message. however I have tested this after inserting a text string manually that I am searching for.  although it doesn&#39;t actually find  the text string. can any of you help?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473234431, "post_id": 39354609, "comment_id": 66056947, "body": "more info needed: update your question with examples of minimal set of data reproducing the issue. moreover specify if cells to be searched for hold <i>constant</i> values or <i>formulas</i> results"}, {"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473258552, "post_id": 39354609, "comment_id": 66073215, "body": "I have updated the question now if anyone has any ideas it would be appreciated! thank you for your help so far!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473258773, "post_id": 39354609, "comment_id": 66073407, "body": "I saw in you edited question that cells to be searched in host a concatenation formula. therefore see edited answer where I just substituted <code>xlValues</code> with <code>xlFormulas</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473260237, "post_id": 39354609, "comment_id": 66074586, "body": "@Lbrin, did you get through it?"}, {"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473261008, "post_id": 39354609, "comment_id": 66075146, "body": "Thank you, I don&#39;t know why it isn&#39;t working, I have updated it as you have suggested but still nothing :/"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473261579, "post_id": 39354609, "comment_id": 66075514, "body": "what does <i>still nothing</i> mean? update your question with examples of minimal set of data reproducing the issue."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473258678, "last_edit_date": 1473258678, "creation_date": 1473182559, "answer_id": 39354609, "question_id": 39353101, "link": "https://stackoverflow.com/questions/39353101/vba-runtime-error-13-using-msgbox/39354609#39354609", "title": "VBA runtime error 13 using Msgbox", "body": "<p><strong>edited</strong> to account for searching in cell whose content derives from a formula</p>\n\n<p>to both summarize all what has been already pointed out in comments and litelite answer and add some 0.02 cents, here a working code</p>\n\n<pre><code>Option Explicit\n\nSub search()\n    Dim ws As Worksheet, found As Range\n    Dim TextToFind(1 To 20) As String\n    Dim iText As Long\n\n    TextToFind(1) = \"xxxx\"\n    TextToFind(2) = \"xxxx\"\n    TextToFind(3) = \"xxxxx\"\n\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If .name &lt;&gt; \"Blacklisted Candidates\" Then 'Do not search blacklist candidates!\n                iText = 1\n                Do While iText &lt;= UBound(TextToFind)\n                    If TextToFind(iText) &lt;&gt; \"\" Then 'Do not search blank strings!\n                        Set found = .UsedRange.Find(what:=TextToFind(iText), LookIn:=xlFormulas, LookAt:=xlPart, MatchCase:=False)\n\n                        If Not found Is Nothing Then\n                            MsgBox \"Proxy Candidate Found at \" &amp; found.Address\n                        Else\n                            MsgBox \"No Proxy Candidates Found \", vbOKOnly, \"Success!\"\n                        End If\n                        iText = iText + 1\n                    End If\n                Loop\n            End If\n       End With\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473410307, "creation_date": 1473176992, "last_edit_date": 1531164843, "question_id": 39353101, "link": "https://stackoverflow.com/questions/39353101/vba-runtime-error-13-using-msgbox", "title": "VBA runtime error 13 using Msgbox", "body": "<p>I'm very new to VBA and only have a basic level of knowledge.</p>\n\n<p>I have been trying to create a macro to cross-reference data on one sheet against multiple other sheets within the same work book.  If a record is found I would like a msgbox to appear to alert the user of the location of the data.</p>\n\n<p>After many hours searching the internet and piecing together bits of code this is what I have</p>\n\n<pre><code>Sub search()\nDim ws As Worksheet, found As Range\nDim TextToFind(1 To 20) As String\nDim iText As Long\n\nTextToFind(1) = \"Jade Smith\"\nTextToFind(2) = \"Bob Collins\"\nTextToFind(3) = \"Jemima Smythe\"\n\nFor Each ws In ThisWorkbook.Worksheets\n    With ws\n        If .Name &lt;&gt; \"Blacklisted Candidates\" Then 'Do not search blacklist candidates!\n            iText = 1\n            Do While iText &lt;= UBound(TextToFind)\n                If TextToFind(iText) &lt;&gt; \"\" Then 'Do not search blank strings!\n                    Set found = .UsedRange.Find(what:=TextToFind(iText), LookIn:=xlformulas, LookAt:=xlPart, MatchCase:=False)\n\n                    If Not found Is Nothing Then\n                        MsgBox \"Proxy Candidate Found at \" &amp; found.Address\n                    Else\n                        MsgBox \"No Proxy Candidates Found \", vbOKOnly, \"Success!\"\n                    End If\n                    iText = iText + 1\n                End If\n            Loop\n        End If\n   End With\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>This code however doesn't find the values from other sheets.</p>\n\n<p>when testing this I just get the msgbox when no data has been found even though there is test data there.</p>\n\n<p>I have a workbook of approx 9 sheets (ever growing) and I want to search the first 9 columns of each work book for the specified data which as you can see I have manually input into the macro but when running the macro I get no results returned even though there is data to find.</p>\n"}, {"tags": ["sql-server", "vba", "localhost"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473175904, "post_id": 39352727, "comment_id": 66035363, "body": "&quot;Data Source= <b>YOUR_COMPUTER_NAME</b> \\SQLEXPRESS;Initial Catalog=Tempt;Integrated Security=True;&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473176817, "post_id": 39352727, "comment_id": 66035894, "body": "Hi. It really does not work. Same mistake. I have taken the YOUR_COMPUTER_NAME from here &gt;Systemsteuerung\\Alle Systemsteuerungselemente\\System&lt;"}, {"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 1, "creation_date": 1473177193, "post_id": 39352727, "comment_id": 66036151, "body": "create a txt file. Rename its extension to .UDL Now doubleclick on it and you will get a screen where you can build and test your connectionstring. If you have a tested connectionstring than save it and then open the text file with notepad to see the completed connectionstring"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473177193, "post_id": 39352727, "comment_id": 66036152, "body": "What does the &quot;SERVER\\INSTANCE&quot; look like when you connect to the database engine in SSMS?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473235332, "post_id": 39352727, "comment_id": 66057484, "body": "@Comintern see the update of the post."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1473235342, "post_id": 39352727, "comment_id": 66057495, "body": "@GuidoG - see the update of the post."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1473235958, "post_id": 39352727, "comment_id": 66057827, "body": "You are using an ADO.NET connection string. OLEDB connection strings <i>have</i> to specify the driver they want to use"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1473236057, "post_id": 39352727, "comment_id": 66057894, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6913409/how-do-i-connect-to-sql-server-using-oledb-using-windows-authentication-connecti\">How do I connect to SQL Server using OLEDB using Windows Authentication connection string</a>"}, {"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1473236097, "post_id": 39352727, "comment_id": 66057917, "body": "Can you show us the first tab of this screen ? What are you using there ? OLE DB for SQL Server or Sql Server Native Client ? For local db it should be the latter"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473236860, "post_id": 39352727, "comment_id": 66058410, "body": "Now I am using the Sql Server Native Client. With a server name &quot;MSSQLLocalDB&quot; I cannot find any db to select. And what should I write in the Server SPN?"}, {"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1473237669, "post_id": 39352727, "comment_id": 66058908, "body": "In localDB you cannot select a database from the server, you have to use second option at the bottom of the screen and select your mdf file"}], "answers": [{"comments": [{"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1473236036, "post_id": 39353739, "comment_id": 66057874, "body": "I think you posted an ODBC connection string. OLEDB connection strings require a <code>Provider</code> parameter instead of <code>DRIVER</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1473236486, "post_id": 39353739, "comment_id": 66058160, "body": "True that, @Panagiotis KAnavos. I am until here:<a href=\"https://sysmod.wordpress.com/2014/07/11/adodb-connection-string-for-localdb-and-sql-server-native-client/\" rel=\"nofollow noreferrer\">sysmod.wordpress.com/2014/07/11/&hellip;</a>  And I am looking for Provider. Any idea?"}, {"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1473236620, "post_id": 39353739, "comment_id": 66058256, "body": "For localDB the provider should be a &quot;SQL Server Native Client&quot;. If you dont have this you can download it from microsoft but it takes some searching"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473236751, "post_id": 39353739, "comment_id": 66058339, "body": "I am trying this: &gt;Provider=SQL Server Native Client;Server=(localdb)\\MSSQLLocalDB;Initial Catalog=Tempt;Trusted_Connection=Yes;&lt; but it does not work."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473236776, "post_id": 39353739, "comment_id": 66058350, "body": "@Vityata did you try googling for `OLEDB SQL Server Connection String&quot; ? Or check the documentation? There are a lot of resources, eg <a href=\"https://connectionstrings.com/microsoft-ole-db-provider-for-sql-server-sqloledb/\" rel=\"nofollow noreferrer\">this one</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1473237027, "post_id": 39353739, "comment_id": 66058511, "body": "well, I did not find a way to refer a local db in the link."}], "tags": [], "owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473179530, "last_edit_date": 1473179530, "creation_date": 1473179219, "answer_id": 39353739, "question_id": 39352727, "link": "https://stackoverflow.com/questions/39352727/vba-sql-server-2014-how-to-access-localhost-windows-authentication/39353739#39353739", "title": "VBA - SQL Server 2014 - How to access localhost - Windows Authentication", "body": "<p>Try stating the driver like the below in the VBA connection string. You will find server\\instance right below the connect bar (in object explorer) in SSMS.</p>\n\n<pre><code>\"SERVER=[server]\\[instance];DRIVER={SQL Server};Initial Catalog=[database];Trusted_Connection=Yes\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1530797076, "post_id": 39369312, "comment_id": 89366510, "body": "The mixed feeling 2 years later, when you google the same problem and find your own answer..."}, {"owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 1, "creation_date": 1530859284, "post_id": 39369312, "comment_id": 89389766, "body": "You&#39;r lucky; me usually finds only my own questions, without any solutions :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 0, "creation_date": 1530875716, "post_id": 39369312, "comment_id": 89399014, "body": "@Arvo - yup. And the answer has actually helped me! :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1530797140, "last_edit_date": 1530797140, "creation_date": 1473249428, "answer_id": 39369312, "question_id": 39352727, "link": "https://stackoverflow.com/questions/39352727/vba-sql-server-2014-how-to-access-localhost-windows-authentication/39369312#39369312", "title": "VBA - SQL Server 2014 - How to access localhost - Windows Authentication", "body": "<p>Actually this is what has worked for me:</p>\n\n<pre><code>connectionString = \"Provider=SQLNCLI11;Server=(localdb)\\MSSQLLocalDB;Initial Catalog=Tempt;Trusted_Connection=yes;timeout=30;\"\n</code></pre>\n\n<p>My db is named \"Tempt\".\nI have taken the code from here:\n<a href=\"https://sysmod.wordpress.com/2014/07/11/adodb-connection-string-for-localdb-and-sql-server-native-client/\" rel=\"nofollow noreferrer\">https://sysmod.wordpress.com/2014/07/11/adodb-connection-string-for-localdb-and-sql-server-native-client/</a></p>\n\n<p>Thanks everyone for the help! :)</p>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1332, "favorite_count": 1, "accepted_answer_id": 39369312, "answer_count": 2, "score": 0, "last_activity_date": 1530875763, "creation_date": 1473175638, "last_edit_date": 1530875763, "question_id": 39352727, "link": "https://stackoverflow.com/questions/39352727/vba-sql-server-2014-how-to-access-localhost-windows-authentication", "title": "VBA - SQL Server 2014 - How to access localhost - Windows Authentication", "body": "<p><strong>VBA - SQL Server 2014 - How to access localhost?</strong></p>\n\n<p>Pretty much, I need to access localhost of SQL Server and I have tried almost anything I found here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5283727/what-is-the-sql-connection-string-i-need-to-use-to-access-localhost-sqlexpress-w\">What is the sql connection string I need to use to access localhost\\SQLEXPRESS with Windows Authentication or SQL Authentication?</a></p>\n\n<p>I have tried this:</p>\n\n<pre><code>    str_connection_string = \"Data Source=localhost\\SQLEXPRESS;Initial Catalog=Tempt;Integrated Security=True;\"\n    str_connection_string = \"Data Source = .\\\\\\\\SQLEXPRESS;Initial Catalog=Tempt;Integrated Security=True;\"\n</code></pre>\n\n<p>And both return error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hVvbP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hVvbP.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is a German Run-Time error, saying something about OLE DB. (My German is also not in my top 4 languages).</p>\n\n<p>I want WindowsAuthetication. The automatic one, without username or password.</p>\n\n<p>So what are the ideas?\nI use MSSQL Management Studio 2014.\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p>\n\n<p>A day has passed. this is what I tried in the morning:\n@GuidoG\nI liked the idea, but I did not succeed to make it in a way. What should be the servername on the top (point 1), in order to find my DB (point 3)?</p>\n\n<h2><a href=\"https://i.stack.imgur.com/8r3gX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8r3gX.png\" alt=\"enter image description here\"></a></h2>\n\n<p>@Comintern\nThe local server, to which I am connecting through the MS DB Studio looks like this:</p>\n\n<h2>(localdb)\\MSSQLLocalDB</h2>\n\n<p>Edit: I am trying to connect to localhost.</p>\n"}, {"tags": ["forms", "vba", "import", "export"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1473178357, "post_id": 39352694, "comment_id": 66036828, "body": "Note, <i>Microsoft Visual FoxPro Report</i> isn&#39;t the description for a .frx file when you don&#39;t have MS FoxPro installed (geez <i>who</i> has that installed anyway?!) - if you have Visual Studio 6 installed it might read something like <i>Visual Basic Binary Form File</i> or similar. And if you don&#39;t have VS6 installed, there might not be a file type description at all."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473191799, "post_id": 39352694, "comment_id": 66043669, "body": "@ThunderFrame - For the DOS and UNIX versions?  :shudders:"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1473175505, "creation_date": 1473175505, "answer_id": 39352694, "question_id": 39352350, "link": "https://stackoverflow.com/questions/39352350/move-designed-vba-userform-by-moving-code-between-ide-environments/39352694#39352694", "title": "Move designed VBA Userform by moving code between IDE environments", "body": "<p>Right-click on the UserForm and export it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YgMKq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YgMKq.png\" alt=\"Export form\"></a></p>\n\n<p>For UserForms, this actually results in <em>2</em> files - one for the code (.frm), and one for the designer (.frx).</p>\n\n<p><a href=\"https://i.stack.imgur.com/QChnE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QChnE.png\" alt=\"File explorer\"></a></p>\n\n<p><sub>Ignore the Visual FoxPro Report association, I need to fix that...</sub></p>\n\n<p>When you re-import the file into the other IDE, it will check to see if there is a matching .frx file for the .frm file and import them both.</p>\n"}], "owner": {"reputation": 655, "user_id": 1723231, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7967c8dcef276c025295cd28dcc4b78b?s=128&d=identicon&r=PG", "display_name": "TheCodeNovice", "link": "https://stackoverflow.com/users/1723231/thecodenovice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492345915, "creation_date": 1473174468, "last_edit_date": 1492345915, "question_id": 39352350, "link": "https://stackoverflow.com/questions/39352350/move-designed-vba-userform-by-moving-code-between-ide-environments", "title": "Move designed VBA Userform by moving code between IDE environments", "body": "<p>I am coding a project in VBA that will involve userforms. My issue is my current  IDE MS Excel, is not compatible (at least I think) with the destination IDE which is proprietary using lvb files. I will have to code as much as possible in MS VB Editor and cut and paste it into a blank file. That is fine for procedures and functions, but I do not think it would work for the forms. Where does the code sit that has the actual form guts, not the event stuff? If I could find that maybe I could past the form into the new IDE or something. </p>\n"}]