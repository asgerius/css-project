[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 0, "last_activity_date": 1421885880, "last_edit_date": 1421885880, "creation_date": 1421885482, "answer_id": 28079256, "question_id": 28079074, "link": "https://stackoverflow.com/questions/28079074/get-specific-values-from-an-range-and-store-it-in-another/28079256#28079256", "title": "Get specific values from an range and store it in another", "body": "<p>this an example how you can achieve this</p>\n\n<pre><code>    Sub MethodFindAllSamples()\n    Dim oCell As Range, i&amp;, z&amp;, strSearch$\n    strSearch = InputBox(\"Type the model you are looking for, please: \")\n    i = Cells(Rows.Count, \"G\").End(xlUp).Row\n    z = 0\n    If strSearch &lt;&gt; \"\" Then\n        For Each oCell In Range(\"G1:G\" &amp; i)\n            If Replace(Trim(UCase(oCell.Value)), \" \", \"\") Like \"*\" &amp; Replace(Trim(UCase(strSearch)), \" \", \"\") &amp; \"*\" Then\n                z = z + 1\n            End If\n        Next\n        If z &gt; 0 Then\n            MsgBox \"Range [D] contain: \" &amp; z &amp; \" iteration of the selected model : \" &amp; strSearch\n        Else\n            MsgBox \"Range [D] does not contain: \" &amp; strSearch\n        End If\n    Else\n        MsgBox \"Search model not specified!\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4480460, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/1Aouh.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4480460/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 28079256, "answer_count": 1, "score": 1, "last_activity_date": 1503665388, "creation_date": 1421884413, "last_edit_date": 1503665388, "question_id": 28079074, "link": "https://stackoverflow.com/questions/28079074/get-specific-values-from-an-range-and-store-it-in-another", "title": "Get specific values from an range and store it in another", "body": "<p>I'm trying to type a search term and look into a entire specific range and every time this term has a match the information will be stored in another column.</p>\n\n<p>When I use \"Do\", \"With\" or \"While\" it just stores one result.</p>\n\n<pre><code>Sub MethodFindAllSamples()\n    Dim rng1 As Range\n    Dim strSearch As String\n    index = 11\n    strSearch = InputBox(\"Type the model you are looking for, please: \")\n    Set rng1 = Range(\"G:G\").Find(strSearch, , xlValues, xlPart, xlByRows, False)\n    If Not rng1 Is Nothing Then\n        Application.Goto rng1\n        Model = ActiveCell(1.1)\n        Content = ActiveCell(1, 4)\n        FIssues = Range(\"ER\" &amp; ActiveCell.Row + 1).Value\n        TIssues = Range(\"ER\" &amp; ActiveCell.Row + 1).Value\n        MsgBox \"Model selected: \" &amp; Model &amp; vbNewLine &amp; \"CS: \" &amp; Content &amp; vbNewLine &amp; \" Issues found: \" &amp; FIssues\n        Errors = Left(FIssues, 1)\n        Errors2 = Mid(TIssues, 22, 1)\n        Cells(index, 1).Value = Mid(Model, 4, 6)\n        Cells(index, 3).Value = Errors\n        Cells(index, 4).Value = Errors2\n        Cells(index, 2).Value = strSearch + Left(Content, 8)\n    Else\n        MsgBox strSearch &amp; \" This device can't be found, please try again\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "filter", "report", "subform"], "comments": [{"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1421880433, "post_id": 28078121, "comment_id": 44535388, "body": "What have you tried so far? Can you post some VBA?  What problems are you having, precisely?"}, {"owner": {"reputation": 23, "user_id": 4352143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adec46831e6ef791194567cdf0ace826?s=128&d=identicon&r=PG&f=1", "display_name": "Nico_2014", "link": "https://stackoverflow.com/users/4352143/nico-2014"}, "reply_to_user": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1421880787, "post_id": 28078121, "comment_id": 44535539, "body": "I edited my question. Thank you for your help"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4352143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adec46831e6ef791194567cdf0ace826?s=128&d=identicon&r=PG&f=1", "display_name": "Nico_2014", "link": "https://stackoverflow.com/users/4352143/nico-2014"}, "edited": false, "score": 0, "creation_date": 1421881465, "post_id": 28078416, "comment_id": 44535852, "body": "My command button is on the main form, that&#39;s right.  so the name of my subform is: frmDocumentDatasheet  &quot;If Not IsNull(Me.Form!frmDocumentDatasheet.Filter) Then&quot;  But now i get a error that it cant find the field frmDocumentDatasheet..."}, {"owner": {"reputation": 23, "user_id": 4352143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adec46831e6ef791194567cdf0ace826?s=128&d=identicon&r=PG&f=1", "display_name": "Nico_2014", "link": "https://stackoverflow.com/users/4352143/nico-2014"}, "edited": false, "score": 0, "creation_date": 1421883184, "post_id": 28078416, "comment_id": 44536455, "body": "If Not IsNull(Forms.frmDocumentList.frmDocumentDatasheet.Form) Then ?? this produces the next error: Application-defined or object-defined error"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "reply_to_user": {"reputation": 23, "user_id": 4352143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adec46831e6ef791194567cdf0ace826?s=128&d=identicon&r=PG&f=1", "display_name": "Nico_2014", "link": "https://stackoverflow.com/users/4352143/nico-2014"}, "edited": false, "score": 0, "creation_date": 1421886417, "post_id": 28078416, "comment_id": 44537453, "body": "Don&#39;t use the name you gave the form when you made it, the name you see in the Navigation Panel .  When you made it a subform, it became a control in the main form.  That control has a name, found as a property -- that is what you must use.  The link I provided should make this clear."}, {"owner": {"reputation": 23, "user_id": 4352143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adec46831e6ef791194567cdf0ace826?s=128&d=identicon&r=PG&f=1", "display_name": "Nico_2014", "link": "https://stackoverflow.com/users/4352143/nico-2014"}, "edited": false, "score": 0, "creation_date": 1421894307, "post_id": 28078416, "comment_id": 44539490, "body": "I understand what you are saying but somehow it still doesnt work.. I&#39;m very thankful that you invest the time in me. I updated the vba box in my question. Can you have another look at it? Does the filter- field/property create itself?"}], "tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": true, "score": 1, "last_activity_date": 1421895561, "last_edit_date": 1421895561, "creation_date": 1421881034, "answer_id": 28078416, "question_id": 28078121, "link": "https://stackoverflow.com/questions/28078121/ms-access-quick-filter-on-a-subform-then-pass-the-filter-to-a-report/28078416#28078416", "title": "MS Access -- quick filter on a subform, then pass the filter to a report", "body": "<p>If your command button is on the main form, then you want a different filter:  you want the filter that is on the sub-form.  Something like:</p>\n\n<pre><code>Option Explicit  ' &lt;- be sure this is at top of module\n                 ' ...and run Debug&gt;Compile so it can perform its check\n\n'' And on your button click event:\nPrivate Sub Command17_Click()\n    Dim strFilter as String\n    strFilter = Me.Form![Document Datasheet].[Filter]\n    Debug.Print strFilter\n    If strFilter &lt;&gt; \"\" Then\n        DoCmd.OpenReport \"RptDocumentList\", A_PREVIEW, , strFilter\n    Else\n        MsgBox \"Apply a filter to the form first\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Just reference the <em>name</em> of the subform -- that is, its control name as seen on the main form.  More <a href=\"http://www.allenbrowne.com/casu-04.html\" rel=\"nofollow\">here</a>.</p>\n\n<p>Using a variable like <code>strFilter</code> will hopefully give you a bit more control so you can see what is (or is not) happening.  </p>\n\n<p>The <code>Debug.Print</code> command causes your filter string appear in the Immediate window.  If you are unfamiliar with this, I suggest you do a bit of research as it will undoubtedly help you.  For one thing, you can post the output -- maybe your string is somehow the problem.  </p>\n\n<p>You will notice my code tests for an empty string (<code>\"\"</code>).  Possibly your filter is an empty string and the <code>IsNull()</code> test is not helping you to detect that.</p>\n"}], "owner": {"reputation": 23, "user_id": 4352143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adec46831e6ef791194567cdf0ace826?s=128&d=identicon&r=PG&f=1", "display_name": "Nico_2014", "link": "https://stackoverflow.com/users/4352143/nico-2014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1813, "favorite_count": 0, "accepted_answer_id": 28078416, "answer_count": 1, "score": 2, "last_activity_date": 1421895561, "creation_date": 1421879747, "last_edit_date": 1421894322, "question_id": 28078121, "link": "https://stackoverflow.com/questions/28078121/ms-access-quick-filter-on-a-subform-then-pass-the-filter-to-a-report", "title": "MS Access -- quick filter on a subform, then pass the filter to a report", "body": "<p>I have a form (frmDocumentList) with a subform(frmDocumentDatasheet) and a print button which opens a report(rptDocumentList).</p>\n\n<p>All i want to do is use the \"quick filter function\" (sort&amp;filter-ribbon) on the subform. And then pass the filtered data to the report. </p>\n\n<p>At the moment the report takes all of the data. </p>\n\n<p>I think this is a simple problem but it is not possible for me atm to solve it. I have experience with vba. \nHopefully someone can help me. \n-sorry for my bad english-</p>\n\n<p>Here is the vba i tried: </p>\n\n<pre><code> Private Sub Command17_Click()\n\nIf Not IsNull(Me.Form![Document Datasheet].[Filter]) Then\n    DoCmd.OpenReport \"RptDocumentList\", A_PREVIEW, , Me.Form![Document Datasheet].Filter\nElse\n    MsgBox \"Apply a filter to the form first\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>My problem is that the quick filter i used on the subform doesn't apply on the report.</p>\n"}, {"tags": ["vba", "excel", "compiler-errors", "syntax-error"], "comments": [{"owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "edited": false, "score": 0, "creation_date": 1421883652, "post_id": 28077784, "comment_id": 44536631, "body": "Is there anything preventing you from using a Form Control instead of an ActiveX one? They have proven much more stable and compatible across systems for me. As a guess to the specific issue you&#39;re experiencing, there is an issue with ActiveX controls when moving between 32-bit and 64-bit versions of Office: <a href=\"https://msdn.microsoft.com/en-us/library/office/ee691831(v=office.14).aspx#odc_office2010_Compatibility32bit64bit_ActiveXControlCOMAddinCompatibility\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 4480232, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e3L5JPvRNUY/AAAAAAAAAAI/AAAAAAAAAAA/KlZiG1fxNFw/photo.jpg?sz=128", "display_name": "Zach Henry", "link": "https://stackoverflow.com/users/4480232/zach-henry"}, "edited": false, "score": 0, "creation_date": 1421937986, "post_id": 28077784, "comment_id": 44559529, "body": "Thank you for the response. Both versions are 32 bit versions of excel. I was reluctant to use form controls just for aesthetics of the Active X controls. I had always heard they had compatibility issues, but had never seen it first hand. I will take your advice and use a form control. I wish I knew what the problem was though, since we both use 32 bit versions."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4718211, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a75d992b4b74b9503e40c241ca0c1e90?s=128&d=identicon&r=PG", "display_name": "Kyle Lai", "link": "https://stackoverflow.com/users/4718211/kyle-lai"}, "is_accepted": false, "score": 0, "last_activity_date": 1427401168, "creation_date": 1427401168, "answer_id": 29288047, "question_id": 28077784, "link": "https://stackoverflow.com/questions/28077784/command-button-is-changing-names-when-different-version-of-excel-opens-it/29288047#29288047", "title": "Command Button is changing names when different version of Excel opens it", "body": "<p>Apply fm20.dll fix from Microsoft for Microsoft Office 2010. If you have Office 2013, then apply both fm20.dll fix for both 2010 and 2013.</p>\n\n<p><a href=\"http://blogs.technet.com/b/the_microsoft_excel_support_team_blog/archive/2014/12/11/forms-controls-stop-working-after-december-2014-updates-.aspx\" rel=\"nofollow\">http://blogs.technet.com/b/the_microsoft_excel_support_team_blog/archive/2014/12/11/forms-controls-stop-working-after-december-2014-updates-.aspx</a></p>\n"}], "owner": {"reputation": 3, "user_id": 4480232, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e3L5JPvRNUY/AAAAAAAAAAI/AAAAAAAAAAA/KlZiG1fxNFw/photo.jpg?sz=128", "display_name": "Zach Henry", "link": "https://stackoverflow.com/users/4480232/zach-henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2583, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427401168, "creation_date": 1421878236, "last_edit_date": 1421881672, "question_id": 28077784, "link": "https://stackoverflow.com/questions/28077784/command-button-is-changing-names-when-different-version-of-excel-opens-it", "title": "Command Button is changing names when different version of Excel opens it", "body": "<p>I have a spreadsheet that was created in Excel 2010 Pro Plus.  I was just recently upgraded at my business to the Pro Plus version. It is very simple and it works when I open and use it. However, when I send it to my colleagues, they open it, click to enable macros, and immediately it tells them my VBA does not work. It says that the object cannot be found.</p>\n\n<p>Thinking it was a problem with my code, I did a test. I created a spreadsheet with one Active X command button. I assigned it the code:</p>\n\n<pre><code>Sheet1.Range(\"A2\").value = sheet1.Range(\"A2\").value + 1\n</code></pre>\n\n<p>Just the simplest command I could think of. I opened it on my version of excel and it worked. Yet still, when my colleagues opened it it gave them the compile error, object does not exist. When looking into the error I found 2 things:</p>\n\n<ol>\n<li><p>When I create a command button in a spreadsheet in my new excel version, it starts with \"CommandButton21\" This seems odd because if I remember correctly, excel should always start with \"CommandButton1\" and go in sequential order. Why is it putting a \"2\" between the CommandButton and the \"1\"</p></li>\n<li><p>The reason my colleagues are getting the compile error object not found is because when they open the spreadsheet, it changes the name of the active x command button from \"CommandButton21\" to \"CommandButton22\". </p></li>\n</ol>\n\n<p>I ran another test to confirm this. I opened a new spreadsheet on a COLLEAGUES computer and wrote the same code with the same command button (except when I created the command button, it was in fact \"CommandButton1\" not \"CommandButton21\" like my version is doing). After creating the spreadsheet, i sent it to my version of excel. It worked. So, I created the exact same spreadsheet on my version, same code, and I even renamed the button \"CommandButton1\". I sent it to my Colleague and it still didnt work.</p>\n\n<p>Please someone, tell me this is an installation error or something. Before the Pro Plus version, everything worked fine. Any help would be greatly appreciated. Im no expert at VBA, just a novice, but i have done plenty of macros to know this is not normal.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1421878163, "post_id": 28077445, "comment_id": 44534472, "body": "Disable macros, delete combobox, save and close workbook. Then reopen workbook, add combobx and check what happens. Let me know."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1421902785, "post_id": 28077445, "comment_id": 44541623, "body": "Perhaps you are a victim of <a href=\"http://stackoverflow.com/q/27411399/445425\">this Microsoft update</a>"}], "owner": {"reputation": 11, "user_id": 4480102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6c24d20b6492bdd88dadfcb77748a7?s=128&d=identicon&r=PG&f=1", "display_name": "zfighter00", "link": "https://stackoverflow.com/users/4480102/zfighter00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1421876810, "creation_date": 1421876810, "question_id": 28077445, "link": "https://stackoverflow.com/questions/28077445/excel-2007-method-oleobjects-of-object-failed", "title": "excel 2007 method oleobjects of object failed", "body": "<p>I have an invoice set up with validation list on a separate worksheet listing all our parts we sell.  I put combo boxes on the invoice and linked them to the validation list and included code so that when box is double clicked, it will start auto completing the box using the validation list when typed.  I also included code so that when this invoice is closed at end of the day, and then reopened the next day, or when shortcut key is pressed, it will clear the contents and change the invoice number.  </p>\n\n<p>Sometimes I need to save a, invoice to add on or change later. So I copy that worksheet and rename it with customer name.  This has worked fine for over a year.  But last week, when I click on any cell on the copied worksheets, it has a runtime error 1004 Method \"OLEObjects\" of object\"_Worksheet\" failed.  Then the combo boxes don't work.  But it only does it on the copied worksheets.  The original worksheet works fine.  Any suggestions?  Here is the code used:</p>\n\n<pre><code>    '==========================\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, _\n      Cancel As Boolean) \nDim str As String\nDim cboTemp As OLEObject\nDim ws As Worksheet\nDim wsList As Worksheet\nSet ws = ActiveSheet\nSet wsList = Sheets(\"ValidationLists\")\nCancel = True\nSet cboTemp = ws.OLEObjects(\"Parts\")\nOn Error Resume Nex\nWith cboTemp\n'clear and hide the combo box\n.ListFillRange = \"\"\n.LinkedCell = \"\"\n.Visible = False\nEnd With\nOn Error GoTo errHandler\nIf Target.Validation.Type = 3 Then\n'if the cell contains a data validation list\nApplication.EnableEvents = False\n'get the data validation formula\nstr = Target.Validation.Formula1\nstr = Right(str, Len(str) - 1)\nWith cboTemp\n  'show the combobox with the list\n  .Visible = True\n  .Left = Target.Left\n  .Top = Target.Top\n  .Width = Target.Width + 5\n  .Height = Target.Height + 5\n  .ListFillRange = str\n  .LinkedCell = Target.Address\nEnd With\ncboTemp.Activate\nEnd If\nerrHandler:\nApplication.EnableEvents = True\nExit Sub\nEnd Sub\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nEnd Sub\n'=========================================\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim str As String\nDim cboTemp As OLEObject\nDim ws As Worksheet\nSet ws = ActiveSheet\nApplication.EnableEvents = False\nApplication.ScreenUpdating = True\nIf Application.CutCopyMode Then\n'allow copying and pasting on the worksheet\nGoTo errHandler\nEnd If\nSet cboTemp = ws.OLEObjects(\"Parts\")\nOn Error Resume Next\nWith cboTemp\n.Top = 10\n.Left = 10\n.Width = 0\n.ListFillRange = \"\"\n.LinkedCell = \"\"\n.Visible = False\n.Value = \"\"\nEnd With\nerrHandler:\nApplication.EnableEvents = True\nExit Sub\nEnd Sub\n'====================================\n'Optional code to move to next cell if Tab or Enter are pressed\n'from code by Ted Lanham\nPrivate Sub Parts_KeyDown(ByVal _\n    KeyCode As MSForms.ReturnInteger, _\n    ByVal Shift As Integer)\nSelect Case KeyCode\n    Case 9 'Tab\n        ActiveCell.Offset(0, 1).Activate\n    Case 13 'Enter\n        ActiveCell.Offset(1, 0).Activate\n    Case Else\n        'do nothing\nEnd Select\nEnd Sub\n</code></pre>\n\n<p>Set cboTemp = ws.OLEObjects(\"Parts\") is where the problem is. It appears twice and gets flagged on both of them.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1421876823, "post_id": 28077407, "comment_id": 44533781, "body": "FWIW, It works fine for me in a 2013 .xlsx file. Perhaps try putting the function into a clean spreadsheet to see if it can work for you at all."}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1421876909, "post_id": 28077407, "comment_id": 44533833, "body": "Okay I made a new file and it worked, so it must be something weird with my document. I&#39;ll copy my data into there and try again."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421876966, "post_id": 28077407, "comment_id": 44533870, "body": "You probably had made an error but left the function in the cell, since it&#39;s not volatile, it would not &quot;update&quot; by fixing the function, maybe?  For your paramters (tooltip), you could look at the suggestions here: <a href=\"http://stackoverflow.com/questions/4262421/how-to-put-a-tooltip-on-a-user-defined-function\" title=\"how to put a tooltip on a user defined function\">stackoverflow.com/questions/4262421/&hellip;</a>"}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1421876986, "post_id": 28077407, "comment_id": 44533883, "body": "I think when i saved the file as a <code>.xlsm</code> it didn&#39;t automatically enable macros on the file. I reopened the file and it prompted me to enable macros"}], "answers": [{"comments": [{"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1421877091, "post_id": 28077504, "comment_id": 44533932, "body": "I had originally created the file as a <code>.xlsx</code>, and saved as <code>.xlsm</code> to enable macros on it. Now that I&#39;ve re-opened the file it asked me to enable macros. Thanks!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1421877152, "post_id": 28077504, "comment_id": 44533978, "body": "I have made the same mistake about a million times myself !"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1421877016, "creation_date": 1421877016, "answer_id": 28077504, "question_id": 28077407, "link": "https://stackoverflow.com/questions/28077407/excel-not-finding-vba-function/28077504#28077504", "title": "Excel not finding VBA Function", "body": "<p>Your <em>UDF</em> is in the correct place and is coded correctly and will be \"recognized\" <strong>if macros are enabled</strong> for the workbook in question!<br><br> <em>Check your security settings.</em></p>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 4552470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd1812cc6d0582553d50b37e6fedc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "omJohn8372", "link": "https://stackoverflow.com/users/4552470/omjohn8372"}, "is_accepted": false, "score": 0, "last_activity_date": 1595073363, "creation_date": 1595073363, "answer_id": 62968256, "question_id": 28077407, "link": "https://stackoverflow.com/questions/28077407/excel-not-finding-vba-function/62968256#62968256", "title": "Excel not finding VBA Function", "body": "<p>I have a macro-enabled file, I have Macro Security set to Enable All, I checked Trust access to the VBA project object model, I have my workbook in a Trusted Location, and I still cannot type in my function name or find it in the Insert Function dialog box. What other security settings are there?</p>\n<p>This is on a recent unmodified install of 2016 x64 on Windows 10 Pro.</p>\n<p>I have, in ThisWorkbook (Code):</p>\n<pre><code>Public Function TestJohn(derp As String) As String\n    TestJohn = &quot;test john &quot; &amp; derp\nEnd Function\n</code></pre>\n<p>And I have in Sheet2 (Code):</p>\n<pre><code>Public Function TestJohn2(derp As String) As String\n    TestJohn2 = &quot;test john2 &quot; &amp; derp\nEnd Function\n</code></pre>\n<p>Neither of which appear as usable functions for Sheet2.</p>\n"}], "owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2188, "favorite_count": 0, "accepted_answer_id": 28077504, "answer_count": 2, "score": 1, "last_activity_date": 1595073363, "creation_date": 1421876588, "last_edit_date": 1531161705, "question_id": 28077407, "link": "https://stackoverflow.com/questions/28077407/excel-not-finding-vba-function", "title": "Excel not finding VBA Function", "body": "<p>I'm trying to create a VBA function to call in a cell in Excel, but the cell comes up as <code>#NAME?</code> when I enter <code>=MyFunction(\"a\")</code></p>\n\n<p>In my VBA Module <code>Module1</code>:</p>\n\n<pre><code>Public Function MyFunction(anything As String)\n    MyFunction = anything\nEnd Function\n</code></pre>\n\n<p>in the cell:</p>\n\n<pre><code>=MyFunction(\"a\")\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>#NAME?\n</code></pre>\n\n<p>What am I doing wrong here? When I start typing <code>=MyFunction</code> in the cell, Excel lists it as an option, but doesn't show the parameters and then produces this result.</p>\n\n<p>This is in a 2007 <code>.xlsm</code> file.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1421876322, "post_id": 28077202, "comment_id": 44533520, "body": "You are constructing an insert string but you are not executing it. You need to issue something like IRGConn.Execute strSQL to make it happen. See <a href=\"http://stackoverflow.com/questions/16161865/using-excel-vba-to-export-data-to-ms-access-table\" title=\"using excel vba to export data to ms access table\">stackoverflow.com/questions/16161865/&hellip;</a>:"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1421878717, "post_id": 28077202, "comment_id": 44534693, "body": "<i>Cstr&#39;FannieMaeLoanNumber&#39;),&#39;&quot; &amp; Manager</i> - missing opening bracket after <b>Cstr</b> function."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 2561662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d13970d723239a5b9625abba6c0a9e2?s=128&d=identicon&r=PG", "display_name": "user2561662", "link": "https://stackoverflow.com/users/2561662/user2561662"}, "edited": false, "score": 0, "creation_date": 1556842999, "post_id": 28083434, "comment_id": 98574939, "body": "i need to copy and paste data from one sheet to another based on the value on the column. For eg: In my source sheet in column"}], "tags": [], "owner": {"reputation": 9, "user_id": 2561662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d13970d723239a5b9625abba6c0a9e2?s=128&d=identicon&r=PG", "display_name": "user2561662", "link": "https://stackoverflow.com/users/2561662/user2561662"}, "is_accepted": false, "score": 0, "last_activity_date": 1421912105, "creation_date": 1421912105, "answer_id": 28083434, "question_id": 28077202, "link": "https://stackoverflow.com/questions/28077202/inserting-excel-sheet-in-existing-table-in-access/28083434#28083434", "title": "Inserting excel sheet in Existing table in Access", "body": "<p>Thank you very much for your reply, i went the code that you have posted by what i really dont undertand is i don't see any file xl file path, i have to insert data in into the table every month, and the xlfile is saved in specific folder,given static Name, what i do is first i rewrite the field name on excel via vba to match with my table field name in access,where i activate the xlfile , after that i am trying to import. Since i am working on the access it self i dont think i have to give a string for database connection.I am really confused here It would be very great full if you could explain it more for me.\n Thank you \nManoj</p>\n"}], "owner": {"reputation": 9, "user_id": 2561662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d13970d723239a5b9625abba6c0a9e2?s=128&d=identicon&r=PG", "display_name": "user2561662", "link": "https://stackoverflow.com/users/2561662/user2561662"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1421912105, "creation_date": 1421875819, "last_edit_date": 1421876349, "question_id": 28077202, "link": "https://stackoverflow.com/questions/28077202/inserting-excel-sheet-in-existing-table-in-access", "title": "Inserting excel sheet in Existing table in Access", "body": "<p>I am pretty New to VBA, In here i my tring to insert some data from the excel sheet looping through each and, in Access existing, the code runs fine but doesn't insert any data in the table, i aslo try appending that data using recordset, but did work because of the data type issue.  Please guide me through it, Thank you very much in Advance. \n This is My  Code:</p>\n\n<pre><code>Const AccessConnectionString  As String = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source =C:\\Documents and Settings\\e4umts\\Desktop\\New Database\\IRG Analytics--New.accdb;Persist Security Info=False\"\nSub Import()\n Dim dbsIRG As ADODB.Connection\n Dim ConnectionString As String\n Dim IRGConn As ADODB.Connection\n Dim Mypath As String\n Dim IRGCmd As New ADODB.Command\n Dim r As Range\n Dim column As Integer\n Dim row As Integer\n\n Mypath = \"C:\\Documents and Settings\\e4umts\\Desktop\\New Folder\\Liquidation Exceptions Report.xls\"\n Set IRGConn = New ADODB.Connection\n IRGConn.ConnectionString = AccessConnectionString\n IRGConn.Open\n Set IRGCmd = New ADODB.Command\n IRGCmd.ActiveConnection = IRGConn                     \n For Each r In ActiveSheet.Range(\"A2\", Range(\"A2\").End(xlDown))          \n      If ActiveSheet.Range(\"A2\", Range(\"A2\").End(xlDown)) Is Nothing Then\n      IRGCmd.CommandText = _\n      GetSQL( _\n            r.Offset(0, 0).Value, _\n            r.Offset(0, 1).Value, _\n            r.Offset(0, 2).Value, _\n            r.Offset(0, 3).Value, _\n            r.Offset(0, 4).Value, _\n            r.Offset(0, 5).Value, _\n            r.Offset(0, 6).Value, _\n            r.Offset(0, 7).Value, _\n            r.Offset(0, 8).Value, _\n            r.Offset(0, 9).Value, _\n            r.Offset(0, 10).Value, _\n            r.Offset(0, 11).Value, _\n            r.Offset(0, 12).Value, _\n            r.Offset(0, 13).Value, _\n            r.Offset(0, 14).Value, _\n            r.Offset(0, 15).Value, _\n            r.Offset(0, 16).Value, _\n            r.Offset(0, 17).Value, _\n            r.Offset(0, 18).Value, _\n            r.Offset(0, 19).Value, _\n            r.Offset(0, 20).Value, _\n            r.Offset(0, 21).Value, _\n            r.Offset(0, 22).Value)\n\n        ActiveSheet.Range(\"A2\", Range(\"A2\").End(xlDown)).Value = \"\"\n        IRGCmd.Execute\n    Else\n\n        End If\n\n\n\n    Next r\n\n    IRGConn.Close\n    Set IRGConn = Nothing\n End Sub\n\n\n\nFunction GetSQL(LoanNumber As Integer, Manager As String, Analyst As String, _\n   ServicerName As String, ServicerNumber As Integer, ServicerLoanNumber As Integer, _\n    PoolNumber As Integer, RemmittanceType As String, SaleType As String, ActionCode As Integer, _\n     ActivityDate As Date, ActionDate As Date, LPI As Date, InterestRate As Double, PandI As Double, _\n       UPB As Double, ReportedPrincipal As Double, ReportedInterest As Double, AppliedPrincipal As Double, _\n         AppliedInterest As Double, InvestorPassThruRate As Double, PFPIntAdv As Double, Months As Date) As String\n\n\n   Dim strSql As String\n\n    strSql = _\n             \" INSERT INTO Table1\" &amp; _\n             \" (LoanNumber, Manager, Analyst, ServicerName, ServicerNumber, ServicerLoanNumber,\" &amp; _\n             \" PoolNumber, RemittanceType, SaleType, ActionCode, ActivityDate, ActionDate, LPI, InterestRate,\" &amp; _\n             \" PandI, UPB, ReportedPrincipal, ReportedInterest, AppliedPrincipal, AppliedInterest, InvestorPassThruRate, PFPIntAdv, Months )\" &amp; _\n             \" VALUES (\" &amp; _\n             \" Cstr'FannieMaeLoanNumber'),'\" &amp; Manager &amp; \"','\" &amp; Analyst &amp; \"','\" &amp; ServicerName &amp; \"',\" &amp; _\n             \" Cstr('ServicerNumber'),Cstr('ServicerLoanNumber'), Cstr('PoolNumber'), '\" &amp; RemmittanceType &amp; \"'\" &amp; _\n             \" '\" &amp; SaleType &amp; \"', Cstr('ActionCode'), #\" &amp; ActivityDate &amp; \"#, #\" &amp; ActionDate &amp; \"#,#\" &amp; LPI &amp; \"#,Cstr('InterestRate'),\" &amp; _\n             \" Cstr('PandI'),Cstr('UPB'),Cstr('ReportedPrincipal'),Cstr('ReportedInterest'),Cstr('AppliedPrincipal'),Cstr('AppliedInterest'),Cstr('InvestorPassThruRate'),\" &amp; _\n             \" Cstr('PFPIntAdv'),#\" &amp; Months &amp; \"#)\"\n\n\n    GetSQL = strSql\n\n\n  End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421908718, "post_id": 28076665, "comment_id": 44543337, "body": "Probably too much code in this question"}, {"owner": {"reputation": 117, "user_id": 4075015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e41c8dece72211fffda6a3c2d460c80b?s=128&d=identicon&r=PG&f=1", "display_name": "adit123", "link": "https://stackoverflow.com/users/4075015/adit123"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421934728, "post_id": 28076665, "comment_id": 44557372, "body": "@TimWilliams I cut the code down a little. Some functions i kept because they are part of setting the limits. Sorry about that ."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4075015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e41c8dece72211fffda6a3c2d460c80b?s=128&d=identicon&r=PG&f=1", "display_name": "adit123", "link": "https://stackoverflow.com/users/4075015/adit123"}, "edited": false, "score": 0, "creation_date": 1422030074, "post_id": 28097774, "comment_id": 44602346, "body": "Thank you for your response @TimWilliams! I tried this code and indeed, it does plot! However, when I added my code for formatting the lines and such. I received an error at this line for some reason:    .Values = &quot;=&#39;&quot; &amp; ActiveSheet.Name &amp; &quot;&#39;!&quot; &amp; Application.WorksheetFunction.Substitute(myChtObj.Name, &quot; &quot;, &quot;&quot;) &amp; &quot;_AVG&quot; . The error was object not defined. I wasn&#39;t sure why the Average line is not created?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 117, "user_id": 4075015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e41c8dece72211fffda6a3c2d460c80b?s=128&d=identicon&r=PG&f=1", "display_name": "adit123", "link": "https://stackoverflow.com/users/4075015/adit123"}, "edited": false, "score": 0, "creation_date": 1422033554, "post_id": 28097774, "comment_id": 44604592, "body": "Update your question to add your current code, and indicate where you get the error."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1421991273, "last_edit_date": 1421991273, "creation_date": 1421957356, "answer_id": 28097774, "question_id": 28076665, "link": "https://stackoverflow.com/questions/28076665/statistical-quality-control-macro-changing-parameters-to-a-determined-std-dev/28097774#28097774", "title": "Statistical Quality Control Macro Changing parameters to a determined std.dev", "body": "<p>Compiled but not tested:</p>\n\n<pre><code>Sub Make_Control_Chart()\n        Dim data_values As Range\n        Dim chart_labels As Range\n        Dim range_selected_before As Range\n        Dim got_label_range As Boolean\n        Dim got_value_range As Boolean\n        Dim bActivate As Boolean\n        Dim myChtObj As ChartObject\n        Dim plot_series, MyNewSrs As Series\n        Dim series_label As String\n        Dim number_of_control_limits As Integer\n        Dim standard_deviation As Integer\n        Dim data_str As String\n        Dim avg_str As String\n\n\n        Dim stddev As Variant\n        Dim wb As Workbook, sCht As String, i As Long\n\n        Set wb = ActiveWorkbook\n\n        'On Error GoTo if_error_occured: 'GOTO THE END OF THE PROGRAM\n\n        stddev = Range(\"F3\").Value\n\n        'GET RANGE FOR DATA VALUES\n        bActivate = False   ' True to re-activate the input range\n        Set data_values = GetRange(\"Please select the range containing the DATA POINTS\" &amp; _\n                                   Chr(13) &amp; \"(press select a single column)\")\n        If IsNotOk(data_values) Then\n            MsgBox \"Incorrect Input Data !\"\n            Exit Sub 'not End!\n        ElseIf Not (check_if_numeric(data_values)) Then\n            MsgBox \"Incorrect Input Data !\"\n            Exit Sub 'not End!\n        End If\n\n        'GET RANGE FOR CHART X-AXIS LABELS\n        got_label_range = True   ' True to re-activate the input range\n        Set chart_labels = GetRange(\"Please select the range containing the LABELS\" &amp; _\n                                   Chr(13) &amp; \"(press ESC if no labels available)\")\n        If IsNotOk(chart_labels) Then\n            got_label_range = False\n        End If\n\n\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n\n        'LETS CREATE THE CHART NOW\n        Set myChtObj = ActiveSheet.ChartObjects.Add(Left:=300, Width:=450, _\n                                                    Top:=25, Height:=300)\n        myChtObj.Chart.ChartType = xlLineMarkers\n\n\n        'REMOVE ALL UNWANTED SERIES FROM CHART, IF ANY\n        For Each MyNewSrs In myChtObj.Chart.SeriesCollection\n            MyNewSrs.Delete\n        Next MyNewSrs\n        Set MyNewSrs = Nothing\n\n\n         'IF WE HAVE THE LABEL RANGE\n        'ADD NEW SERIES\n        Set MyNewSrs = myChtObj.Chart.SeriesCollection.NewSeries\n        With MyNewSrs\n            .Name = \"PLOT\"\n            .Values = data_values\n            If got_label_range Then\n                .XValues = chart_labels.Value\n            End If\n        End With\n\n\n        'FORMAT THE PLOT SERIES\n        Set plot_series = MyNewSrs\n        With MyNewSrs\n            .Border.ColorIndex = 1\n            .MarkerBackgroundColorIndex = 2\n            .MarkerForegroundColorIndex = xlAutomatic\n            .MarkerStyle = xlCircle\n            .Smooth = False\n            .MarkerSize = 5\n            .Shadow = False\n        End With\n        Set MyNewSrs = Nothing\n\n        'CREATE NAMED RANGE FOR THE DATA VALUES, AVERAGE, LOWER AND UPPER CONTROL LIMITS\n        sCht = sCht\n        data_str = sCht &amp; \"_data_values\"\n        avg_str = \"roundup(average(\" &amp; sCht &amp; \"_data_values\" &amp; \"),2)\"\n\n\n        wb.Names.Add Name:=sCht &amp; \"_data_values\", RefersToR1C1:=data_values\n        wb.Names.Add Name:=sCht &amp; \"_AVG\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"\"\n\n        For i = 1 To 3\n\n            wb.Names.Add Name:=sCht &amp; \"_LCL\" &amp; i, _\n                RefersToR1C1:=\"=\" &amp; avg_str &amp; \"- roundup(\" &amp; i &amp; \"*\" &amp; stddev &amp; \",3)\"\n            wb.Names.Add Name:=sCht &amp; \"_UCL\" &amp; i, _\n                RefersToR1C1:=\"=\" &amp; avg_str &amp; \"+ roundup(\" &amp; i &amp; \"*\" &amp; stddev &amp; \",3)\"\n        Next i\n\nEnd Sub\n\nPublic Function GetRange(box_message As String) As Range\n    On Error Resume Next\n    Set GetRange = Application.InputBox(box_message, \"Select Range\", Selection.Address, , , , , 8)\nEnd Function\n\nPublic Function IsNotOk(ByVal rng As Range) As Boolean 'TO CHECK IF A GIVEN RANGE IS BLANK\n    IsNotOk = True\n    On Error GoTo if_error_occured:\n    If rng.Rows.Count &gt; 0 And rng.Columns.Count = 1 Then IsNotOk = False\nif_error_occured:\n    If Err.Number Then IsNotOk = True\nEnd Function\n\nPublic Function check_if_numeric(rng As Range) As Boolean\n    Dim cel As Range, rv As Boolean\n    rv = True\n    For Each cel In rng.Cells\n        If Not (Application.WorksheetFunction.IsNumber(cel.Value)) Then\n            rv = False\n            Exit For\n        End If\n    Next cel\n    check_if_numeric = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4075015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e41c8dece72211fffda6a3c2d460c80b?s=128&d=identicon&r=PG&f=1", "display_name": "adit123", "link": "https://stackoverflow.com/users/4075015/adit123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422030166, "creation_date": 1421873848, "last_edit_date": 1422030166, "question_id": 28076665, "link": "https://stackoverflow.com/questions/28076665/statistical-quality-control-macro-changing-parameters-to-a-determined-std-dev", "title": "Statistical Quality Control Macro Changing parameters to a determined std.dev", "body": "<p>I found a macro online that creates a Statistical Quality Control chart online. So I have a .Csv file that looks like an excel sheet. I use the macro, so I have to select the data points. Then I have to select the labels, and then it gets plotted. </p>\n\n<p>So instead of calculating the standard deviation from the selected data as my macro does, I want it to calculate the Upper limits and Lower limits from a set Standard deviation. Which is in the cell \"F3\". I have tried creating a variant where \"stddev=Range(\"F3\").value\" But when I included it in my macro, the data was scattered and my labels on the right were not showing up as they were before. I will specify , where in the code that I think the problem is lying. </p>\n\n<p>Here is the full code for creating the Quality control chart:</p>\n\n<pre><code>    Option Explicit\n\n    Public Function GetRange(box_message As String) As Range\n        Set GetRange = Nothing\n        On Error Resume Next\n        Set GetRange = Application.InputBox(box_message, \"Select Range\", Selection.Address, , , , , 8)\n    End Function\n\n    Public Function IsNotOk(ByVal rng As Range) As Boolean 'TO CHECK IF A GIVEN RANGE IS BLANK\n        IsNotOk = True\n        On Error GoTo if_error_occured:\n        If rng.Rows.Count &gt; 0 And rng.Columns.Count = 1 Then IsNotOk = False\n    if_error_occured:\n        If Err.Number Then IsNotOk = True\n    End Function\n\n    Public Function check_if_numeric(rng As Range) As Boolean\n    Dim cel As Range\n    check_if_numeric = True\n    For Each cel In rng.Cells\n        If Not (Application.WorksheetFunction.IsNumber(cel.Value)) Then check_if_numeric = False\n    Next cel\n    End Function\n\n    Sub Make_Control_Chart()\n        Dim data_values As Range\n        Dim chart_labels As Range\n        Dim range_selected_before As Range\n        Dim got_label_range As Boolean\n        Dim got_value_range As Boolean\n        Dim bActivate As Boolean\n        Dim myChtObj As ChartObject\n        Dim plot_series, MyNewSrs As Series\n        Dim series_label As String\n        Dim number_of_control_limits As Integer\n        Dim standard_deviation As Integer\n        Dim data_str As String\n        Dim avg_str As String\n\n        Dim stddev As Variant\n\n        On Error GoTo if_error_occured: 'GOTO THE END OF THE PROGRAM\n\n\n        stddev = Range(\"F3\").Value\n\n        'GET RANGE FOR DATA VALUES\n        bActivate = False   ' True to re-activate the input range\n        Set data_values = GetRange(\"Please select the range containing the DATA POINTS\" &amp; Chr(13) &amp; \"(press select a single column)\")\n        If IsNotOk(data_values) Then\n            MsgBox \"Incorrect Input Data !\"\n            End\n        ElseIf Not (check_if_numeric(data_values)) Then\n            MsgBox \"Incorrect Input Data !\"\n            End\n        End If\n\n        'GET RANGE FOR CHART X-AXIS LABELS\n        got_label_range = True   ' True to re-activate the input range\n        Set chart_labels = GetRange(\"Please select the range containing the LABELS\" &amp; Chr(13) &amp; \"(press ESC if no labels available)\")\n        If IsNotOk(chart_labels) Then\n            got_label_range = False\n        End If\n\n\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n\n\n\n        'LETS CREATE THE CHART NOW\n        Set myChtObj = ActiveSheet.ChartObjects.Add(Left:=300, Width:=450, Top:=25, Height:=300)\n        myChtObj.Chart.ChartType = xlLineMarkers\n\n\n        'REMOVE ALL UNWANTED SERIES FROM CHART, IF ANY\n        For Each MyNewSrs In myChtObj.Chart.SeriesCollection ' myChtObj.Chart.SeriesCollection\n            MyNewSrs.Delete\n        Next MyNewSrs\n        Set MyNewSrs = Nothing\n\n\n        If got_label_range Then 'IF WE HAVE THE LABEL RANGE\n        'ADD NEW SERIES\n            Set MyNewSrs = myChtObj.Chart.SeriesCollection.NewSeries\n            With MyNewSrs\n                .Name = \"PLOT\"\n                .Values = data_values\n                .XValues = chart_labels.Value\n            End With\n        Else\n            Set MyNewSrs = myChtObj.Chart.SeriesCollection.NewSeries\n            With MyNewSrs\n                .Name = \"PLOT\"\n                .Values = data_values\n            End With\n        End If\n\n        'FORMAT THE PLOT SERIES\n        Set plot_series = MyNewSrs\n        With MyNewSrs\n            .Border.ColorIndex = 1\n            .MarkerBackgroundColorIndex = 2\n            .MarkerForegroundColorIndex = xlAutomatic\n            .MarkerStyle = xlCircle\n            .Smooth = False\n            .MarkerSize = 5\n            .Shadow = False\n        End With\n        Set MyNewSrs = Nothing\n\n\n\n\n\n        'CREATE NAMED RANGE FOR THE DATA VALUES, AVERAGE, LOWER AND UPPER CONTROL LIMITS\n\n        data_str = Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_data_values\"\n        avg_str = \"roundup(average(\" &amp; Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_data_values\" &amp; \"),2)\"\n\n'HERE THE LIMITS ARE SET AND THE ORIGINAL CODE IS SET IN THERE WHERE IT WORKS ON A SET OF DATA POINTS, HOWEVER WHEN I TRY TO CHANGE IT TO JUST \"1*stddev,3\" the data gets all scattered. I'M WONDERING WHY THE DATA IS BEING SCATTERED?\n\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_data_values\", RefersToR1C1:=data_values\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_AVG\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"\"\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_LCL1\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"- roundup(1*stdev(\" &amp; data_str &amp; \"),3)\"\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_LCL2\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"- roundup(2*stdev(\" &amp; data_str &amp; \"),3)\"\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_LCL3\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"- roundup(3*stdev(\" &amp; data_str &amp; \"),3)\"\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_UCL1\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"+ roundup(1*stdev(\" &amp; data_str &amp; \"),3)\"\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_UCL2\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"+ roundup(2*stdev(\" &amp; data_str &amp; \"),3)\"\n        ActiveWorkbook.Names.Add Name:=Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_UCL3\", RefersToR1C1:=\"=\" &amp; avg_str &amp; \"+ roundup(3*stdev(\" &amp; data_str &amp; \"),3)\"\n</code></pre>\n\n<p>The code for formatting and creating the lines on the chart:</p>\n\n<pre><code>        'ADD THE LINE FOR AVERAGE\n    Set MyNewSrs = myChtObj.Chart.SeriesCollection.NewSeries\n\n    With MyNewSrs\n        .Name = \"AVG = \"\n        .Values = \"='\" &amp; ActiveSheet.Name &amp; \"'!\" &amp; Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_AVG\"\n        .ChartType = xlXYScatter\n        '.ErrorBar Direction:=xlX, Include:=xlNone, Type:=xlFixedValue, Amount:=10000\n        '.ErrorBar Direction:=xlX, Include:=xlUp, Type:=xlFixedValue, Amount:=20\n        .ErrorBar Direction:=xlX, Include:=xlPlusValues, Type:=xlFixedValue, Amount:=data_values.Rows.Count\n        .MarkerBackgroundColorIndex = xlAutomatic\n        .MarkerForegroundColorIndex = xlAutomatic\n        .MarkerStyle = xlNone\n        .Smooth = False\n        .MarkerSize = 5\n        .Shadow = False\n        With .Border\n            .Weight = xlHairline\n            .LineStyle = xlNone\n        End With\n        'With .ErrorBars.Border\n        '    .LineStyle = xlContinuous\n        '    .ColorIndex = 3\n        '    .Weight = xlThin\n        'End With\n    End With\n\n\n\n    Set MyNewSrs = Nothing\n\n    'ADD UPPER AND LOWER CONTROL LIMITS\n     For number_of_control_limits = 1 To 3\n        For standard_deviation = -1 To 1 Step 2\n\n            Select Case standard_deviation:\n                Case -1: series_label = \"LCL\"\n                Case 1: series_label = \"UCL\"\n            End Select\n\n            Set MyNewSrs = myChtObj.Chart.SeriesCollection.NewSeries\n            With MyNewSrs\n                .Name = series_label &amp; number_of_control_limits &amp; \" =\"\n                .Values = \"='\" &amp; ActiveSheet.Name &amp; \"'!\" &amp; Application.WorksheetFunction.Substitute(myChtObj.Name, \" \", \"\") &amp; \"_\" &amp; series_label &amp; number_of_control_limits\n                .ChartType = xlXYScatter\n                .ErrorBar Direction:=xlX, Include:=xlPlusValues, Type:=xlFixedValue, Amount:=data_values.Rows.Count\n            End With\n\n            MyNewSrs.ErrorBar Direction:=xlX, Include:=xlPlusValues, Type:=xlFixedValue, Amount:=data_values.Rows.Count\n\n            Select Case number_of_control_limits:\n                Case 1:\n                            With MyNewSrs.ErrorBars.Border\n                                .LineStyle = xlGray25\n                                .ColorIndex = 15\n                                .Weight = xlHairline\n                            End With\n                Case 2:\n                            With MyNewSrs.ErrorBars.Border\n                                .LineStyle = xlGray25\n                                .ColorIndex = 57\n                                .Weight = xlHairline\n                            End With\n                Case 3:\n                            With MyNewSrs.ErrorBars.Border\n                                .LineStyle = xlGray75\n                                .ColorIndex = 3\n                                .Weight = xlHairline\n                            End With\n            End Select\n\n            MyNewSrs.ErrorBars.EndStyle = xlNoCap\n\n            With MyNewSrs\n                With .Border\n                    .Weight = xlHairline\n                    .LineStyle = xlNone\n                End With\n                .MarkerBackgroundColorIndex = xlAutomatic\n                .MarkerForegroundColorIndex = xlAutomatic\n                .MarkerStyle = xlNone\n                .Smooth = False\n                .MarkerSize = 5\n                .Shadow = False\n            End With\n            Set MyNewSrs = Nothing\n        Next standard_deviation\n    Next number_of_control_limits\n\n   myChtObj.Chart.ApplyDataLabels AutoText:=True, LegendKey:=False, _\n        HasLeaderLines:=False, ShowSeriesName:=True, ShowCategoryName:=False, _\n        ShowValue:=True, ShowPercentage:=False, ShowBubbleSize:=False, Separator:=\" \"\n\n    'OFFSET THE LABELS\n    For Each MyNewSrs In myChtObj.Chart.SeriesCollection\n        With MyNewSrs.Points(1).DataLabel\n            .Left = 400\n        End With\n    Next MyNewSrs\n\n\n    'LETS FORMAT THE CHART\n    With myChtObj\n        With .Chart.Axes(xlCategory)\n            .MajorTickMark = xlNone\n            .MinorTickMark = xlNone\n            .TickLabelPosition = xlNextToAxis\n        End With\n        With .Chart.Axes(xlValue)\n            .MajorTickMark = xlOutside\n            .MinorTickMark = xlNone\n            .TickLabelPosition = xlNextToAxis\n        End With\n        With .Chart.ChartArea.Border\n            .Weight = 1\n            .LineStyle = 0\n        End With\n        With .Chart.PlotArea.Border\n            .ColorIndex = 1\n            .Weight = xlThin\n            .LineStyle = xlContinuous\n        End With\n        With .Chart.PlotArea.Interior\n            .ColorIndex = 2\n            .PatternColorIndex = 1\n            .Pattern = xlSolid\n        End With\n        With .Chart.ChartArea.Font\n            .Name = \"Arial\"\n            .Size = 8\n            .Strikethrough = False\n            .Superscript = False\n            .Subscript = False\n            .OutlineFont = False\n            .Shadow = False\n            .Underline = xlUnderlineStyleNone\n            .ColorIndex = xlAutomatic\n            .Background = xlAutomatic\n        End With\n        With .Chart\n            .HasTitle = False\n            .Axes(xlCategory, xlPrimary).HasTitle = False\n            .Axes(xlValue, xlPrimary).HasTitle = True\n            .HasTitle = True\n            .ChartTitle.Characters.Text = \"Control Chart\"\n            .ChartTitle.Left = 134\n            .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Observations\"\n        End With\n        With .Chart.Axes(xlCategory).TickLabels\n            .Alignment = xlCenter\n            .Offset = 100\n            .ReadingOrder = xlContext\n            .Orientation = xlHorizontal\n        End With\n    End With\n\n\n\n    myChtObj.Chart.Legend.Delete\n    myChtObj.Chart.PlotArea.Width = 310\n    myChtObj.Chart.Axes(xlValue).MajorGridlines.Delete\n    myChtObj.Chart.Axes(xlValue).CrossesAt = myChtObj.Chart.Axes(xlValue).MinimumScale\n    myChtObj.Chart.ChartArea.Interior.ColorIndex = xlAutomatic\n    myChtObj.Chart.ChartArea.AutoScaleFont = True\n\n\n    'DELETE THE LABELS FOR THE ACTUAL DATA SERIES\n    plot_series.DataLabels.Delete\n    Set plot_series = Nothing\n\nif_error_occured:\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    If Err.Number Then z_delete_all_named_range\n\nEnd Sub\n\n\nSub z_delete_all_named_range()\nDim nam As Name\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    For Each nam In ActiveWorkbook.Names\n    nam.Delete\n    Next nam\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "edited": false, "score": 0, "creation_date": 1421943446, "post_id": 28076343, "comment_id": 44563368, "body": "So I&#39;ve tried another macro that isn&#39;t moving data between two workbooks, and I don&#39;t see the screen updating then. However, in this macro, <code>DoEvents</code> isn&#39;t causing the status bar to update... so I&#39;m pretty lost now"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 1, "creation_date": 1421964629, "post_id": 28076343, "comment_id": 44574890, "body": "instead of statusbar, you could use a userform, wich wont be bothered by application.screenupdating (or application.enableevents), and no need of doeevents"}, {"owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1422045676, "post_id": 28076343, "comment_id": 44610798, "body": "That looks like what I&#39;ll have to do."}, {"owner": {"reputation": 1478, "user_id": 2866644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae52996b1232c611a06e92d7b9e505d?s=128&d=identicon&r=PG&f=1", "display_name": "robotik", "link": "https://stackoverflow.com/users/2866644/robotik"}, "edited": false, "score": 0, "creation_date": 1448362810, "post_id": 28076343, "comment_id": 55546766, "body": "DoEvents can cause errors in loops, especially in recursion. I guess whether it is problematic depends on the code you are using it in. I have just faced this problem recently, and would be happy to see a solution so I can keep using the StatusBar for messages."}, {"owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "reply_to_user": {"reputation": 1478, "user_id": 2866644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae52996b1232c611a06e92d7b9e505d?s=128&d=identicon&r=PG&f=1", "display_name": "robotik", "link": "https://stackoverflow.com/users/2866644/robotik"}, "edited": false, "score": 0, "creation_date": 1450104820, "post_id": 28076343, "comment_id": 56281234, "body": "@robotik I ultimately just created a tiny user form that is just a text field and a button. I post status information to the text field and the button serves to close the form when the macro finishes. As I&#39;ve used 2013 more, it seems like StatusBar will serve for smaller macros that don&#39;t need to update much and don&#39;t handle much data, but just isn&#39;t up to the job for bigger programs anymore."}, {"owner": {"reputation": 1478, "user_id": 2866644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae52996b1232c611a06e92d7b9e505d?s=128&d=identicon&r=PG&f=1", "display_name": "robotik", "link": "https://stackoverflow.com/users/2866644/robotik"}, "edited": false, "score": 0, "creation_date": 1450201629, "post_id": 28076343, "comment_id": 56333479, "body": "it is a pity, as i use statusbar for progress feedback in a macro that browses through directories. it is not as intrusive as a text field, it seems more professional, and it&#39;s long enough to show file paths. it worked perfectly in the previous version, but now I guess we have to settle for this workaround."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7133438, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8aef876416969c819f0334058fa1f619?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/7133438/ian"}, "is_accepted": false, "score": 2, "last_activity_date": 1478632730, "creation_date": 1478632730, "answer_id": 40494796, "question_id": 28076343, "link": "https://stackoverflow.com/questions/28076343/statusbar-and-screenupdate-in-excel-2013/40494796#40494796", "title": "StatusBar and ScreenUpdate in Excel 2013", "body": "<p>I ran into a similar problem today so I thought I would share what I found while debugging the issue:</p>\n\n<p>For me I noticed that the status bar was reverting to a previous status bar method while my macro was running. I found that the old message was the last status bar message printed before I disable screen updating. However, new status bar messages were printing temporarily so screen updating wasn't preventing new messages from displaying. I traced the issue to a spot in the macro where I run an executable using:</p>\n\n<pre><code>Set wsh = VBA.CreateObject(\"WScript.Shell\")\nerrorCode = wsh.Run(exeCMD, windowStyle, waitOnReturn)\n</code></pre>\n\n<p>It appears that calling the executable disrupted the status bar display and excel reverted to displaying whatever status bar message was showing before screen updating was disabled. To solve this I reactivated screen updating before running the executable and then disabled screen updating once the executable was run:</p>\n\n<pre><code>Set wsh = VBA.CreateObject(\"WScript.Shell\")\nApplication.ScreenUpdating = True\nerrorCode = wsh.Run(exeCMD, windowStyle, waitOnReturn)\nApplication.ScreenUpdating = False\n</code></pre>\n\n<p>Hope this helps someone out there.</p>\n"}], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5764, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478632730, "creation_date": 1421872555, "last_edit_date": 1531164843, "question_id": 28076343, "link": "https://stackoverflow.com/questions/28076343/statusbar-and-screenupdate-in-excel-2013", "title": "StatusBar and ScreenUpdate in Excel 2013", "body": "<p>I've just gotten into Excel 2013 and am noticing some differences in how macros work (because Microsoft can't leave a good thing alone).</p>\n\n<p>I've always used <code>Application.ScreenUdpdating = False</code> at the start of long macros to speed run time. Generally in those instances I've also used <code>Application.StatusBar = \"random text based on macro\"</code> to give myself (or other users) some sense of what's going on and/or how much work is left for the macro to complete.</p>\n\n<p>In 2013, I've learned (from <a href=\"https://stackoverflow.com/questions/20278177/application-statusbar-not-working-as-expected-in-excel-2013\">Application.Statusbar not working as expected in Excel 2013</a>) that <code>DoEvents</code> is now required. However, when I added in <code>DoEvents</code> after my StatusBar updates, it seems to turn screen updating back on, unless a window outside Excel (ex. an open File Explorer window) is given the focus.</p>\n\n<p>Another issue I've noticed is that with DoEvents in the code I can't seem to break the macro manually (i.e. holding ESC doesn't stop the code).</p>\n\n<p>So a few questions:\nA) Is DoEvents really required?\nB) Is there a way to prevent ScreenUpdates from getting turned back \"on\" by DoEvents?\nC) How do you manually break code running with DoEvents in it?</p>\n\n<p>I can provide the current macro I'm working on if it will help, but since I'm more interested in the general concepts I didn't want to provide specifics for any readers to get bogged down in.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "powerpoint", "shapes"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1421896969, "creation_date": 1421896969, "answer_id": 28080762, "question_id": 28075837, "link": "https://stackoverflow.com/questions/28075837/shape-names-ppt-vba/28080762#28080762", "title": "Shape names PPT VBA", "body": "<p>Tag the shape before cutting, then call a function to return the shape tagged with that value from the target slide after pasting:</p>\n\n<pre><code>With ActivePresentation.Slides(1).Shapes(3)\n  .Tags.Add \"SomeName\", \"SomeValue\" \n  ' whatever name and value you like\n  .Cut\nEnd With\n\n' Then paste it onto another slide\n' and to get a reference to it:\n\nDim oSh as shape\nSet oSh = ShapeTaggedWith(oSl, \"SomeName\", \"SomeValue\")\nIf Not oSh is Nothing Then\n\nEnd If\n' etc\n\nFunction ShapeTaggedWith(oSl as Slide, sTagName as String sValue as String) as Shape\n   Dim oSh as Shape\n   For each oSh in oSl.Shapes\n      If oSh.Tags(sTagName) = sValue Then\n          Set ShapeTaggedWith = oSh\n          Exit Function\n      End If\n   Next\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 28080762, "answer_count": 1, "score": 1, "last_activity_date": 1421896969, "creation_date": 1421870482, "last_edit_date": 1421871959, "question_id": 28075837, "link": "https://stackoverflow.com/questions/28075837/shape-names-ppt-vba", "title": "Shape names PPT VBA", "body": "<p>I am trying to reference shapes by index in PPT VBA.  It is working but it is a hit and miss because I am cutting and pasting them to different slides so the indexes keep changing.  Is there another way to reference shapes so I don't have to deal with the indexes? Here is an example of my code:</p>\n\n<pre><code>ActivePresentation.Slides(1).Shapes(3).Cut\nActivePresentation.Slides(2).Shapes.Paste\nActivePresentation.Slides(1).Shapes(4).Cut\nActivePresentation.Slides(2).Shapes.Paste\n\n With ActivePresentation.Slides(1).Shapes(3)\n.Height = 325\n.Width = 325\n.Left = 190\n.Top = 90\n\nEnd With\n\nWith ActivePresentation.Slides(1).Shapes(4)\n.Height = 600\n.Width = 600\n.Left = 65\n.Top = 360\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421869248, "post_id": 28074975, "comment_id": 44529999, "body": "Did you see my note in my answer about using Find in hidden cells?  Your current code won&#39;t work for hidden cells as is."}, {"owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421871932, "post_id": 28074975, "comment_id": 44531404, "body": "Thank you all for your answers. Seemed an easy-one. I mis understood whose member hidden property is. I marked as answer  Chrismas007&#39;s, as he featured an other problem of my code."}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1421868204, "creation_date": 1421868204, "answer_id": 28075167, "question_id": 28074975, "link": "https://stackoverflow.com/questions/28074975/how-do-i-determine-if-an-excel-range-is-hidden/28075167#28075167", "title": "How do I determine if an Excel range is hidden?", "body": "<p>Do you need to determine if the entire column is hidden? Individual cells can not be hidden. (Unless, of course, you're referring to the HiddenFormula property). If so, the following code should work:</p>\n\n<pre><code>y = x.entirecolumn.Hidden 'does not get the property\n</code></pre>\n\n<p>Let me know if this works</p>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 3, "last_activity_date": 1421868784, "creation_date": 1421868784, "answer_id": 28075343, "question_id": 28074975, "link": "https://stackoverflow.com/questions/28074975/how-do-i-determine-if-an-excel-range-is-hidden/28075343#28075343", "title": "How do I determine if an Excel range is hidden?", "body": "<p>According to a quick Google search, <code>Range.Find</code> will not find the data if the cell is hidden if you use <code>LookIn:=xlValues</code>.  I tested this with \"Test\" in Cell <code>A6</code> and hid the row.  This code returned <code>Nothing</code>:</p>\n\n<pre><code>Sub TestIt()\n    Dim x As Range\n    Set x = Range(\"A1:A7\").Find(\"Test\", , xlValues, xlWhole)\n    If x Is Nothing Then\n        MsgBox \"Nothing\"\n    Else\n        If x.EntireRow.Hidden = True Then\n            MsgBox x.Address &amp; \" is Hidden\"\n        Else\n            MsgBox x.Address &amp; \" is Visible\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Instead you need to use <code>LookIn:=xlFormulas</code>:</strong></p>\n\n<pre><code>Sub TestIt()\n    Dim x As Range\n    Set x = Range(\"A1:A7\").Find(\"Test\", , xlFormulas, xlWhole)\n    If x Is Nothing Then\n        MsgBox \"Nothing\"\n    Else\n        If x.EntireRow.Hidden = True Then\n            MsgBox x.Address &amp; \" is Hidden\"\n        Else\n            MsgBox x.Address &amp; \" is Visible\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Then you can use either:</p>\n\n<pre><code>y = x.EntireRow.Hidden\n</code></pre>\n\n<p>or</p>\n\n<pre><code>y = x.EntireColumn.Hidden\n</code></pre>\n\n<p>to get your Boolean (True if the cell is hidden and False if the cell is visible)</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 5, "last_activity_date": 1421869187, "creation_date": 1421869187, "answer_id": 28075474, "question_id": 28074975, "link": "https://stackoverflow.com/questions/28074975/how-do-i-determine-if-an-excel-range-is-hidden/28075474#28075474", "title": "How do I determine if an Excel range is hidden?", "body": "<p>You can say a <strong>cell</strong> is hidden if it is located on a hidden row or hidden column.<br>Then a <strong>range</strong> is hidden if all cells in that range are hidden:</p>\n\n<pre><code>Public Function IsHidden(rIn As Range) As Boolean\n    Dim r As Range\n    IsHidden = True\n    For Each r In rIn\n        If Not r.EntireRow.Hidden Then\n            If Not r.EntireColumn.Hidden Then\n                IsHidden = False\n                Exit Function\n            End If\n        End If\n    Next r\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11434, "favorite_count": 0, "accepted_answer_id": 28075343, "answer_count": 3, "score": 3, "last_activity_date": 1421869187, "creation_date": 1421867538, "last_edit_date": 1421867834, "question_id": 28074975, "link": "https://stackoverflow.com/questions/28074975/how-do-i-determine-if-an-excel-range-is-hidden", "title": "How do I determine if an Excel range is hidden?", "body": "<p>In my code I include a boolean variable in which I want to assign the value of a range's hidden property. i.e. if the range is hidden, the variable should have the value true, and vice versa.</p>\n\n<p>While running the code I get a '1004' Run-time error - Unable to get the Hidden property of the Range class. By this I assume that Hidden property in this case is write-only (correct me if I'm wrong).</p>\n\n<p>Is there a way to determine (in my code, not by watching) whether a range/cell is hidden or not?</p>\n\n<p>I have a class named \"minas\" and with this sub I am trying to create a collection of minas based on some criteria. </p>\n\n<pre><code>Public mines As Collection\nSub existing_months()\n    Set mines = New Collection\n    Dim min As minas\n    Dim str As String\n    Dim x As Range\n    Dim y As Boolean\n    For i = 1 To 12\n        Set min = New minas\n        Set x = Range(\"A1:A500\").Find(i, LookIn:=xlValues, LookAt:=xlWhole)\n        If x Is Nothing Then GoTo next_iteration:\n        y = x.Hidden 'does not get the property\n        Call min.initialize(x, y)\n        str = min.minas &amp; \"/\" &amp; min.etos\n        mines.Add min, str\n        Debug.Print min.ref_range.Address &amp; \" \" &amp; min.end_cell\nnext_iteration:\n    Next\n    Set min = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button", "activex"], "comments": [{"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421876699, "post_id": 28074908, "comment_id": 44533715, "body": "You might want to read <a href=\"http://stackoverflow.com/questions/27823225/opening-workbook-error-code-32809-on-one-computer-but-not-the-other-computer/27987410#27987410\">this post</a>"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421942436, "post_id": 28074908, "comment_id": 44562690, "body": "I am using 2010, would it be the same solution?"}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421943984, "post_id": 28074908, "comment_id": 44563723, "body": "Yes, it would be. I worked with 2010 when I first encountered this problem. Microsoft does not want to support ActiveX controls imbedded in worksheets (it is a security risk, alright). Therefore, it is a good idea to move away from using imbedded ActiveX controls regardless the version."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421946960, "post_id": 28074908, "comment_id": 44565513, "body": "@GeneSkuratovsky     I now have put my code if you can tell me what the problem is please let me know"}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421947131, "post_id": 28074908, "comment_id": 44565629, "body": "Either approach outlined in the the referred post is complex and well outside of the scope of this forum, IMO. Basically, it&#39;s a redesign of your app. There are many helpful websites for either approach. Alas, there are no quick fixes that stay... Good luck."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1423071638, "post_id": 28074908, "comment_id": 45003298, "body": "I found how to fix it and post the answer"}], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 972, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499958955, "creation_date": 1421867314, "last_edit_date": 1499958955, "question_id": 28074908, "link": "https://stackoverflow.com/questions/28074908/excel-renaming-activex-controls-on-other-computers", "title": "Excel renaming Activex Controls on other computers", "body": "<p>I have a worksheet with Activex Controls(Combobox, Command Button, Option Button, CheckBox).\nOn my computer I have renamed all the controls (Ex. CButtonPMR, OButton_Comp, etc)\nBut when I open the file on other computer all the controls are renamed to default the default names (CheckBox1,Checkbox2, CommandButton1, etc)\nFor that reason the code doesn't works on other computers.\nI am getting errors every time because the code can't compile.\nIs there a way to fix this?</p>\n\n<p>I basically have 2 forms into one and there is 2 option button to chose wich one you want.\nWhen the user select a Button the other form is Hidden</p>\n\n<hr>\n\n<pre><code> Private Sub OpButtonComp_Click()\n Dim ws As Worksheet\n Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim protect As Boolean\nprotect = False\nIf ActiveSheet.ProtectContents Then\n        protect = True\n        ActiveSheet.Unprotect Password:=\"password\"\nEnd If\nApplication.ScreenUpdating = False\n\n\nActiveSheet.Rows(\"13:61\").Hidden = True\nActiveSheet.Rows(\"62:86\").Hidden = False\nActiveSheet.Rows(\"6\").Hidden = True\nDim rng As Range\nSet rng = ActiveSheet.Range(\"A62:P62\")\n   With ActiveSheet.OLEObjects(\"CButtonPMB\")\n       .Top = rng.Top\n        .Left = rng.Left\n        .Width = rng.Width\n        .Height = rng.RowHeight\n    End With\nActiveSheet.OLEObjects(\"CButtonPMB\").Visible = True\n\n\n   Set rng = ActiveSheet.Range(\"A72:P72\")\n    With ActiveSheet.OLEObjects(\"CButtonMQSB\")\n        .Top = rng.Top\n        .Left = rng.Left\n        .Width = rng.Width\n        .Height = rng.RowHeight\n    End With\nActiveSheet.OLEObjects(\"CButtonMQSB\").Visible = True\n\n   Set rng = ActiveSheet.Range(\"A79:P79\")\n    With ActiveSheet.OLEObjects(\"CButtonMQS2B\")\n        .Top = rng.Top\n        .Left = rng.Left\n        .Width = rng.Width\n        .Height = rng.RowHeight\n    End With\nActiveSheet.OLEObjects(\"CButtonMQS2B\").Visible = True\n\n   Set rng = ActiveSheet.Range(\"A85:P85\")\n    With ActiveSheet.OLEObjects(\"CButtonPM2B\")\n        .Top = rng.Top\n        .Left = rng.Left\n        .Width = rng.Width\n        .Height = rng.RowHeight\n    End With\nActiveSheet.OLEObjects(\"CButtonPM2B\").Visible = True\n\n\nApplication.ScreenUpdating = True\nIf Not (ActiveSheet.ProtectContents) And protect = True Then\n            ActiveSheet.protect Password:=\"password\"\n            End If\n\nEnd Sub\n\n\n\n\n\nPrivate Sub OpButtonCon_Click()\nDim protect As Boolean\nprotect = False\nIf ActiveSheet.ProtectContents Then\n        protect = True\n        ActiveSheet.Unprotect Password:=\"password\"\nEnd If\nApplication.ScreenUpdating = False\n\n\nActiveSheet.Rows(\"13:61\").Hidden = False\nActiveSheet.Rows(\"62:86\").Hidden = True\nActiveSheet.Rows(\"6\").Hidden = False\nActiveSheet.CButtonPMB.Visible = False\nActiveSheet.CButtonMQSB.Visible = False\nActiveSheet.CButtonMQS2B.Visible = False\nActiveSheet.CButtonPM2B.Visible = False\n\nApplication.ScreenUpdating = True\nIf Not (ActiveSheet.ProtectContents) And protect = True Then\n            ActiveSheet.protect Password:=\"password\"\n            End If\n\nEnd Sub\n</code></pre>\n\n<p>This is to pop up a DatePicker Form when those cells are selected.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n\n      '   Only look at that range\n\n    If Intersect(Target, Range(\"N12:P12\")) Is Nothing _\n    And Intersect(Target, Range(\"N15:P15\")) Is Nothing _\n    And Intersect(Target, Range(\"N29:P29\")) Is Nothing _\n    And Intersect(Target, Range(\"N37:P37\")) Is Nothing _\n    And Intersect(Target, Range(\"N44:P44\")) Is Nothing _\n    And Intersect(Target, Range(\"N50:P50\")) Is Nothing _\n    And Intersect(Target, Range(\"N51:P51\")) Is Nothing _\n    And Intersect(Target, Range(\"N59:P59\")) Is Nothing _\n    And Intersect(Target, Range(\"N70:P70\")) Is Nothing _\n    And Intersect(Target, Range(\"N78:P78\")) Is Nothing _\n    And Intersect(Target, Range(\"N83:P83\")) Is Nothing Then\n        Exit Sub\n    Else\n    'Show Datepicker\n        CalendarFrm.Show\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thank you </p>\n\n<p>Since my answer was deleted I'll post the solution here.\nIf anyone is wondering, I managed to fix it by following this <a href=\"http://www.excelclout.com/microsoft-update-breaks-excel-activex-controls-fix/\" rel=\"nofollow noreferrer\">http://www.excelclout.com/microsoft-update-breaks-excel-activex-controls-fix/</a></p>\n\n<p>Copy and paste the following VBA code into any module in the spreadsheet.</p>\n\n<pre><code>Public Sub RenameMSFormsFiles() \n    Const tempFileName As String = \"MSForms - Copy.exd\"  \n    Const msFormsFileName As String = \"MSForms.exd\"  \n    On Error Resume Next \n\n    'Try to rename the C:\\Users\\[user.name]\\AppData\\Local\\Temp\\Excel8.0\\MSForms.exd file  \n    RenameFile Environ(\"TEMP\") &amp; \"\\Excel8.0\\\" &amp; msFormsFileName, Environ(\"TEMP\") &amp; \"\\Excel8.0\\\" &amp; tempFileName \n    'Try to rename the C:\\Users\\[user.name]\\AppData\\Local\\Temp\\VBE\\MSForms.exd file  \n    RenameFile Environ(\"TEMP\") &amp; \"\\VBE\\\" &amp; msFormsFileName, Environ(\"TEMP\") &amp; \"\\VBE\\\" &amp; tempFileName \nEnd Sub  \n\nPrivate Sub RenameFile(fromFilePath As String, toFilePath As String) \n    If CheckFileExist(fromFilePath) Then \n        DeleteFile toFilePath  \n        Name fromFilePath As toFilePath  \n    End If  \nEnd Sub  \n\nPrivate Function CheckFileExist(path As String) As Boolean \n    CheckFileExist = (Dir(path) &lt;&gt; \"\")  \nEnd Function  \n\nPrivate Sub DeleteFile(path As String) \n    If CheckFileExist(path) Then \n        SetAttr path, vbNormal  \n        Kill path  \n    End If  \nEnd Sub \n</code></pre>\n\n<p>Call the RenameMSFormsFiles subroutine at the very beginning of the workbook_Open event.</p>\n\n<pre><code>Private Sub Workbook_Open() \n    RenameMSFormsFiles  \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "edited": false, "score": 0, "creation_date": 1421877130, "post_id": 28074768, "comment_id": 44533962, "body": "Have the sheets changed names across workbooks? In the workbook where you&#39;re having a problem, is there a sheet named &quot;Sheet1&quot;"}, {"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "reply_to_user": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "edited": false, "score": 0, "creation_date": 1421966128, "post_id": 28074768, "comment_id": 44575501, "body": "Alex thanks for the responce, I just found I had made the error of writing a sub and calling it Replace I changed it to strReplace and all is fine now"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1421879751, "creation_date": 1421866814, "last_edit_date": 1531164843, "question_id": 28074768, "link": "https://stackoverflow.com/questions/28074768/macro-works-in-all-workbook-but-one", "title": "Macro works in all workbook but one", "body": "<p>I have a replace macro that had been working! and it just stoped working!, I get </p>\n\n<pre><code>Compile error:\n\nWrong number of arguments or invalid property assignment\n</code></pre>\n\n<p>I made a workbook of the sheet I was running the Macro on and saved it as a xlsm file, then I placed my code in a module and tryed it in the new workbook and it worked!</p>\n\n<p>But it does NOT work in the original workbook.</p>\n\n<p>What does this say about my original workbook? I am concerned, I can not make any sense of what I might be doing wrong.</p>\n\n<p>Thanks for any insight</p>\n\n<pre><code>Sub iReplace()\nDim ws As Worksheet\nDim rngCell As Range, rng As Range\nDim LastRow As Long\n\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\nWith ws\n    LastRow = ws.Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\nSet rng = ws.Range(\"A2:A\" &amp; LastRow)\n\n If Not rng Is Nothing Then\n   For Each rngCell In rng\n      rngCell.Value = Replace(rngCell, \" \", \"  \", xlWhole)\n   Next\n  End If\n  End With\nEnd Sub\n</code></pre>\n\n<p>Also this works in the original workbook and on the same sheet as the one that does not work and they are very similar</p>\n\n<pre><code>Sub Replace2()\nDim ws As Worksheet\nDim rngCell As Range, rng As Range\nDim LR As Long\n\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\n  With ws\n      LR = ws.Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n      Set rng = ws.Range(\"A2:B\" &amp; LR)\n\n      If Not rng Is Nothing Then\n        For Each rngCell In rng\n           rngCell.Replace \" \", \"  \", xlPart\n        Next rngCell\n      End If\n End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "syntax", "vlookup"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 1, "creation_date": 1421866784, "post_id": 28074219, "comment_id": 44528689, "body": "Can you provide some additional clarification? Are you trying to populate  the five cells all at once?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1421867010, "post_id": 28074219, "comment_id": 44528807, "body": "And how would a VLOOKUP with &quot;multiple col_index_num&#39;s&quot; even work as a regular Excel formula? <code>WorksheetFunction</code> works just like the worksheet function; if it can&#39;t be done with a VLOOKUP, it can&#39;t be done with a VLOOKUP <i>in VBA</i>."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421867799, "post_id": 28074219, "comment_id": 44529236, "body": "added clarification, sorry"}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 4440388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8097f6c1f9fb532a67c4e7d44f54f43e?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Becker", "link": "https://stackoverflow.com/users/4440388/jim-becker"}, "is_accepted": false, "score": 0, "last_activity_date": 1422154916, "creation_date": 1422154916, "answer_id": 28132775, "question_id": 28074219, "link": "https://stackoverflow.com/questions/28074219/vba-equivalent-to-vlookup-with-multiple-col-index-nums/28132775#28132775", "title": "VBA equivalent to VLOOKUP with multiple &quot;col_index_num&quot;s", "body": "<p>Two possible ways to do this.</p>\n\n<p>1) If you were to record a macro it would give you the FormulaArray method of the Range object:</p>\n\n<pre><code>Range(\"I4:M4\").FormulaArray = \"=VLOOKUP(G2,range,{3,4,5,6,7},0)\"\n</code></pre>\n\n<p>2) Alternately you can use Application.Evaluate</p>\n\n<pre><code>Range(\"I6:M6\") = Application.Evaluate(\"VLOOKUP(G2,range,{3,4,5,6,7},0)\")\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422154916, "creation_date": 1421864811, "last_edit_date": 1421867649, "question_id": 28074219, "link": "https://stackoverflow.com/questions/28074219/vba-equivalent-to-vlookup-with-multiple-col-index-nums", "title": "VBA equivalent to VLOOKUP with multiple &quot;col_index_num&quot;s", "body": "<p>what is the syntax for writing vlookup in vba where you want to return multiple columns?  My code:</p>\n\n<pre><code>For i = 2 To lastrow\n   wsTEMP.Range(Cells(i, 16), Cells(i, 20)) = _\n       Application.WorksheetFunction.VLookup( _\n           Workbooks(\"template.xlsm\").Worksheets(\"Qry\").Cells(i, 1), _\n           Workbooks(\"template.xlsm\").Worksheets(\"Qry\").Range(\"A:G\"), _\n           XXXhow do I write this??XXX, _\n           0)\nNext i\n</code></pre>\n\n<p><strong>EDIT: Further Clarification</strong></p>\n\n<p>If you were doing this with a normal vlookup it would look like:</p>\n\n<p>Select a range, let's say A1:E1, then</p>\n\n<pre><code>=VLOOKUP(G2,range,{3,4,5,6,7},0)\n</code></pre>\n\n<p>So that {3,4,5,6,7} would return the results of multiple columns when you hit Ctrl+Shift+Enter (they'd go in the A1, B1, etc. that I selected before doing the vlookup.  How do I do that in VBA?  Please let me know if I need to provide further clarification, sorry.</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421865910, "post_id": 28073903, "comment_id": 44528246, "body": "That&#39;s part of the problem, I&#39;m not used to work with worksheets, I have no clue which output would be best."}, {"owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421867210, "post_id": 28073903, "comment_id": 44528904, "body": "Cool, I share code, gain downvote, WTFH?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421869084, "post_id": 28073903, "comment_id": 44529930, "body": "I downvoted because it was unclear the output you were looking for.  Since you have now shared, I removed the DV."}, {"owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421869456, "post_id": 28073903, "comment_id": 44530130, "body": "I went for walk, got some ideas...MerryBond"}, {"owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421872886, "post_id": 28073903, "comment_id": 44531839, "body": "@Chrismas007 , how does one write a single value to a cell in excel? I&#39;ve read Cells(row,column).Value = ValueToWrite on the internet, but this doesn&#39;t work!"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421872977, "post_id": 28073903, "comment_id": 44531889, "body": "what doesn&#39;t work about that?  If the <code>ValueToWrite</code> is a valid string or number containing value then it should work."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "edited": false, "score": 0, "creation_date": 1421873074, "post_id": 28073903, "comment_id": 44531930, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/69344/discussion-between-chrismas007-and-elric\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421873175, "post_id": 28073903, "comment_id": 44531977, "body": "I&#39;ve tryied it to do the function after, but got runtime error 1004. Sub test()   Cells(0, 0).Value = &quot;test&quot;  End Sub"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421873221, "post_id": 28073903, "comment_id": 44531995, "body": "Cells(0, 0) doesn&#39;t exist.  A1 is Cells(1,1)"}, {"owner": {"reputation": 6793, "user_id": 58845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d71b3a2fa0cdb2eb54921626292ef7b8?s=128&d=identicon&r=PG", "display_name": "jtolle", "link": "https://stackoverflow.com/users/58845/jtolle"}, "edited": false, "score": 1, "creation_date": 1421884972, "post_id": 28073903, "comment_id": 44537027, "body": "You&#39;re closer than you think. Instead of printing out text line-by-line, build up an array row-by-row. Then output that to the worksheet by assigning the array to a range. See <a href=\"http://stackoverflow.com/questions/3992717/how-can-i-redim-preserve-a-2d-array-in-excel-2007-vba-so-that-i-can-add-rows/3993119#3993119\" title=\"how can i redim preserve a 2d array in excel 2007 vba so that i can add rows\">stackoverflow.com/questions/3992717/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/8911497/reference-region-in-multidimensional-array/8964033#8964033\" title=\"reference region in multidimensional array\">stackoverflow.com/questions/8911497/&hellip;</a> for more. You can probably reuse most of your working code. Then answer your own question with the result!"}], "answers": [{"comments": [{"owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "edited": false, "score": 0, "creation_date": 1507110891, "post_id": 28086608, "comment_id": 80077394, "body": "I know this is old, but do you also have a code snipped for reading in the dict? Seems a little difficult because you don&#39;t know offhand how many levels there are"}, {"owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "reply_to_user": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "edited": false, "score": 0, "creation_date": 1507230772, "post_id": 28086608, "comment_id": 80139282, "body": "@dv3 I don&#39;t understand what you mean with reading in the dict. I do have a code to print as text in the Excel console - yes, Excel has a console."}], "tags": [], "owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "is_accepted": true, "score": 2, "last_activity_date": 1524736838, "last_edit_date": 1524736838, "creation_date": 1421922926, "answer_id": 28086608, "question_id": 28073903, "link": "https://stackoverflow.com/questions/28073903/easy-generic-print-dictionary-to-excel-worksheet-using-vba/28086608#28086608", "title": "Easy generic print Dictionary to Excel Worksheet using VBA", "body": "<p>Solved. Code is below:      </p>\n\n<pre><code>'usage: PrintToWS(yourdata)\n' Optional parameters are to be used internally by the function, \n'leave optional parameters blank.\n\nFunction PrintToWS(ByVal data As Variant, _\n    Optional rowi As Integer = 1, _\n    Optional coli As Integer = 1, _\n    Optional wasdict As Integer = 0) As Integer\n\n    Dim key\n    Dim j As Integer\n\n    If (TypeName(data) = \"Dictionary\") Then\n        For Each key In data.Keys:\n            Cells(rowi + wasdict, coli).Value = key\n            rowi = PrintToWS(data.Item(key), rowi + wasdict, coli + 1, 1)\n            wasdict = 0\n        Next\n    ElseIf (TypeName(data) = \"Variant()\") Then\n        For j = LBound(data) To UBound(data)\n            rowi = PrintToWS(data(j), rowi, coli + 1)\n        Next j\n    Else\n        Cells(rowi, coli).Value = data\n        rowi = rowi + 1\n    End If\n\n    PrintToWS = rowi\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1435, "user_id": 965638, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3dbb79927c171952b1757479d53b1fe4?s=128&d=identicon&r=PG", "display_name": "eri0o", "link": "https://stackoverflow.com/users/965638/eri0o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4599, "favorite_count": 1, "accepted_answer_id": 28086608, "answer_count": 1, "score": 2, "last_activity_date": 1528418881, "creation_date": 1421863535, "last_edit_date": 1528418881, "question_id": 28073903, "link": "https://stackoverflow.com/questions/28073903/easy-generic-print-dictionary-to-excel-worksheet-using-vba", "title": "Easy generic print Dictionary to Excel Worksheet using VBA", "body": "<p>I'm working with really intricate data. Because of this I wrote this really nice function to print data to the debug area - the imediate window you can reach with Ctrl + G on the VBA, inside Excel. I need a similar function to print this generic data (that has numbers, strings, dictionarys and arrays) to a worksheet.</p>\n\n<pre><code>'call using: Call PrintDict(data)\n' Where data can be a number, a string, a dictionary or an Array, \n' with any of these inside.\n\nSub PrintDict(ByVal dicttoprint As Variant, Optional indent As Integer = 0, Optional wasdict As Boolean = False)\n    Dim i As Long\n    Dim j As Long\n    Dim indentStr As String\n    indentStr = \"\"\n    i = 0\n\n    Do While i &lt; indent\n        indentStr = indentStr + \" \"\n        i = i + 1\n    Loop\n\n    Dim key\n\n    If (TypeName(dicttoprint) = \"Dictionary\") Then\n        If (wasdict = True) Then\n            Debug.Print vbNewLine;\n        End If\n        For Each key In dicttoprint.Keys:\n            Debug.Print indentStr &amp; key &amp; \" \";\n            Call PrintDict(dicttoprint.Item(key), indent + 2, True)\n        Next\n    ElseIf (TypeName(dicttoprint) = \"Variant()\") Then\n        If (wasdict = True) Then\n            Debug.Print vbNewLine;\n        End If\n        For j = LBound(dicttoprint) To UBound(dicttoprint)\n            Call PrintDict(dicttoprint(j), indent + 2)\n        Next j\n    Else\n        Debug.Print indentStr &amp; dicttoprint &amp; \" \"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Edit1:\nOk, been thinking about, I have an idea, but can't solve some corner cases...</p>\n\n<p>Example expected output below:</p>\n\n<pre><code>key1:____|__________|__________|__________|_________|\n_________|key1.1:___|_numvalue_|__________|_________|\n_________|__________|_numvalue_|__________|_________|\n_________|__________|_arr1Indx1|_numvalue_|_________|\n_________|__________|_arr1Indx2|_numvalue_|_________|\n_________|__________|_arr1Indx3|_numvalue_|_________|\n_________|key1.2:___|_numvalue_|__________|_________|\n_________|__________|_numvalue_|__________|_________|\nkey2:____|_numvalue_|__________|__________|_________|\nkey3:____|__________|__________|__________|_________|\n_________|_arr2Indx1|keyA.1:___|_numvalue_|_________|\n_________|__________|keyA.2:___|_strvalue_|_________|\n_________|_arr2Indx2|_numvalue_|__________|_________|\n</code></pre>\n\n<p>Ok, I think now this output solves some corner cases. Any ideas on how to implement it?</p>\n\n<p>I'm thinking on having the function be able to pass X,Y parameters, that are optional and to return last Y. When working with text, the cursor naturally goes down, I don't know how to do this through recursion in a worksheet.</p>\n\n<p>Edit 2:</p>\n\n<p>Ok, this is pseudo code idea - is almost VBA, but I don't know how to make this work... </p>\n\n<pre><code>Function PrintToWS(ByVal data As Variant, _\n    Optional rowi As Integer = 0, _\n    Optional coli As Integer = 0) As Integer\n\n    If (TypeName(data) = \"Dictionary\") Then\n        For Each key In data.Keys:\n            Cells(rowi, coli).Value = key\n            coli = coli + PrintToWS(data.Item(key), rowi+1, coli)\n        Next\n    ElseIf (TypeName(data) = \"Variant()\") Then\n        For j = LBound(data) To UBound(data)\n            coli = coli + PrintToWS(data(j), rowi+1, coli)\n        Next j           \n    Else\n        Cells(rowi, coli).Value = data\n        coli = coli + 1\n    End If\n\n    PrintToWS = coli\nEnd Function\n</code></pre>\n\n<p>Edit2:</p>\n\n<p><a href=\"https://gist.github.com/ericoporto/e18bc0ae8432afcd673d634e70c940ae\" rel=\"nofollow noreferrer\">Added it in a gist here</a> </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1421865760, "post_id": 28073580, "comment_id": 44528169, "body": "Can you clarify what you&#39;re trying to do? I think that would make it easier for us to work out a solution."}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1421866551, "post_id": 28073580, "comment_id": 44528575, "body": "Sure For each cell that ends with &quot;/&quot; I want t append to it value from cell to the right, and delete cell to the right( as an clear content of the cell to the right, and shift all cells afterwards to the left)."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1421866705, "post_id": 28073580, "comment_id": 44528641, "body": "Also, to confirm, are you looking across an entire row? For example, check Cell A1 first, then Cell B1, then Cell C1? In this case, what should happen when the cell to the right has already been deleted?"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1421873595, "post_id": 28073580, "comment_id": 44532184, "body": "Yes this is correct. and if the cell already has been deleted skip it meaning  if C1 was deleted( and D1, E1 .......   shifted the the left), then continue from C1( which now should have contents previously belonging to D1 due to the shift)"}], "answers": [{"tags": [], "owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "is_accepted": false, "score": 0, "last_activity_date": 1421880342, "last_edit_date": 1421880342, "creation_date": 1421876214, "answer_id": 28077310, "question_id": 28073580, "link": "https://stackoverflow.com/questions/28073580/vba-collection-issue/28077310#28077310", "title": "VBA Collection issue", "body": "<p>Try this. For this example, assumptions made about data being on Sheet1 and the start row (stRow) and start col (testCol) of the data.  Amend these to suit your conditions.</p>\n\n<pre><code>Option Explicit\nSub combine()\nDim ws As Worksheet\nDim stRow As Long, endRow As Long, testCol As Long, endCol As Long\nDim rnum As Long, cnum As Long\nDim cl As Range\n\nSet ws = Sheets(\"Sheet1\")\nstRow = 1\ntestCol = 1\n\n    With ws\n        endRow = .Cells(Rows.Count, testCol).End(xlUp).Row\n\n            For rnum = stRow To endRow\n                endCol = .Cells(rnum, Columns.Count).End(xlToLeft).Column\n                    For cnum = testCol To endCol - 1\n                        Set cl = .Cells(rnum, cnum)\n                            If Right(cl, 1) = \"/\" And Right(cl.Offset(0, 1), 1) &lt;&gt; \"/\" Then\n                                If IsNumeric(Left(cl.Value, Len(cl.Value) - 1)) Then\n                                    cl.Value = cl.Value &amp; cl.Offset(0, 1).Value\n                                    cl.Offset(0, 1).Delete (xlShiftToLeft)\n                                End If\n                            End If\n                    Next cnum\n            Next rnum\n    End With\nEnd Sub\n</code></pre>\n\n<p>Although not specified by you, this code does not combine an adjacent cell which also has a trailing \"/\". This on the basis that we shouldn't 'remove' a 'test' value. If this condition not required it is easily changed.</p>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421880342, "creation_date": 1421862290, "last_edit_date": 1531161705, "question_id": 28073580, "link": "https://stackoverflow.com/questions/28073580/vba-collection-issue", "title": "VBA Collection issue", "body": "<p>I an trying towrite a simple VBA code where some cell values are combined.\nProblem with code bellow is that <code>Cell</code> Object in the loop keeps selecting whole row, not just one cell in <code>Row</code> Collection</p>\n\n<pre><code>Dim Cell As Range\nDim Row As Range\n\nSet Row = Rows(ActiveCell.Row)\nSet Cell = ActiveCell\n\nFor Each Cell In Row\n    With Cell\n        If IsNumeric(InStr(1, Right(.Value, 1), \"/\")) Then\n            .Value = .Value &amp; .Offset(0, 1).Value\n             .Offset(0, 1).Delete (xlShiftToLeft)\n        End If\n    End With\nNext Cell\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13, "user_id": 4479275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C8cMtMC_QHY/AAAAAAAAAAI/AAAAAAAAACU/VvK_9kbXDxk/photo.jpg?sz=128", "display_name": "TheDramaticBurger", "link": "https://stackoverflow.com/users/4479275/thedramaticburger"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421862865, "post_id": 28073331, "comment_id": 44526709, "body": "I tried deleting the extra +1&#39;s but still having the same issue where it keeps adding the row but not the data in the row"}, {"owner": {"reputation": 13, "user_id": 4479275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C8cMtMC_QHY/AAAAAAAAAAI/AAAAAAAAACU/VvK_9kbXDxk/photo.jpg?sz=128", "display_name": "TheDramaticBurger", "link": "https://stackoverflow.com/users/4479275/thedramaticburger"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421863451, "post_id": 28073331, "comment_id": 44527009, "body": "My table does start in row 1. I added <code>MsgBox lastRow</code> Its giving me the correct row number when the code is executed but still no data."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421863721, "post_id": 28073331, "comment_id": 44527156, "body": "Haha just noticed the typo.  Your variable is strData but you use strname in the InputBox code line..."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421863767, "post_id": 28073331, "comment_id": 44527187, "body": "Gotta use that <code>Option Explicit</code> bro!"}, {"owner": {"reputation": 13, "user_id": 4479275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C8cMtMC_QHY/AAAAAAAAAAI/AAAAAAAAACU/VvK_9kbXDxk/photo.jpg?sz=128", "display_name": "TheDramaticBurger", "link": "https://stackoverflow.com/users/4479275/thedramaticburger"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421863770, "post_id": 28073331, "comment_id": 44527189, "body": "haha, I just realized that myself! .... I do apologize, been a long day"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 0, "last_activity_date": 1421863940, "creation_date": 1421863940, "answer_id": 28074009, "question_id": 28073331, "link": "https://stackoverflow.com/questions/28073331/adding-another-row-with-data/28074009#28074009", "title": "Adding another row with data", "body": "<p>Looks like a typographical error: (Which is why you should always use <a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow\"><code>Option Explicit</code></a>)</p>\n\n<pre><code>Option Explicit\nSub CommandButton1_Click()\n    Dim lastRow As Long\n    Dim iHeader As Integer\n    Dim strData As String\n    strData = InputBox(prompt:=\"Enter data\") 'Fixed variable here\n    Set myTable = ActiveSheet.ListObjects(\"Table1\")\n    With myTable\n        .ListRows.Add\n        lastRow = .ListRows.Count\n    End With\n    ActiveSheet.Cells(lastRow, \"M\").Value = strData    \nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4479275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C8cMtMC_QHY/AAAAAAAAAAI/AAAAAAAAACU/VvK_9kbXDxk/photo.jpg?sz=128", "display_name": "TheDramaticBurger", "link": "https://stackoverflow.com/users/4479275/thedramaticburger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 28074009, "answer_count": 1, "score": 1, "last_activity_date": 1421863998, "creation_date": 1421861368, "last_edit_date": 1421863998, "question_id": 28073331, "link": "https://stackoverflow.com/questions/28073331/adding-another-row-with-data", "title": "Adding another row with data", "body": "<p>I've looked hight and low for a correct method, but I'm having so much trouble. </p>\n\n<p>I'm trying to add another row with data on the end of my table, but all it keeps doing is adding another row but doesn't add the actual data. </p>\n\n<pre><code>Sub CommandButton1_Click()\nDim lastRow As Long\nDim iHeader As Integer\nDim strData As String\nstrname = InputBox(prompt:=\"Enter data\")\n    Set myTable = ActiveSheet.ListObjects(\"Table1\")\n    ActiveSheet.ListObjects(\"Table1\").ListRows.Add\n         With ActiveSheet.ListObjects(\"Table1\")\n            lastRow = ActiveSheet.ListObjects(\"Table1\").ListRows.Count\n        End With\n    ActiveSheet.Cells(lastRow, \"M\").Value = strData    \nEnd Sub \n</code></pre>\n\n<p>It will only add a row to the table but it will not add the strData value no matter what I try. The Column its using for testing purposes is \"M\"</p>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1421927770, "creation_date": 1421927770, "answer_id": 28088189, "question_id": 28073203, "link": "https://stackoverflow.com/questions/28073203/replace-symbol-in-certain-pattern/28088189#28088189", "title": "Replace Symbol in Certain Pattern", "body": "<p>Try</p>\n\n<pre><code>Dim FindPeriodIndex As Integer\nDo While FindPeriodIndex = InStr(Description, Chr(46)) &lt;&gt; 0\n\n    If IsNumeric(Mid(Description, FindPeriodIndex - 1, FindPeriodIndex)) = False Or   IsNumeric(Mid(Description, FindPeriodIndex, FindPeriodIndex + 1)) = False Then\n        Description = SuperReplace(Description, Chr(46), \" \")\n    End If\n Loop\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594645570, "creation_date": 1421860989, "last_edit_date": 1594645570, "question_id": 28073203, "link": "https://stackoverflow.com/questions/28073203/replace-symbol-in-certain-pattern", "title": "Replace Symbol in Certain Pattern", "body": "<p>I wrote a code like this in order to find pattern. In descriptions sometime \".\" will appear between numbers and text, for example, \" 0.5 text book and pen.whatever.\" or \"I love fried chicken and burger .65 mm.\"<br>\nI wanna replace \".\"between text but not numbers. </p>\n\n<pre><code>Dim FindPeriodIndex As Integer\nDo While FindPeriodIndex = InStr(Description, Chr(46)) &lt;&gt; 0\n\n    If IsNumeric(Mid(Description, FindPeriodIndex - 1, 1)) = False Or   IsNumeric(Mid(Description, FindPeriodIndex + 1, 1)) = False Then\n        Description = SuperReplace(Description, Chr(46), \" \")\n    End If\n Loop\n</code></pre>\n\n<p>Superreplace is a function that I created, it's similiar to replace function but can replace an array. this doesn't matter in my question. The code that I create doesn't really work,could anyone give a better idea on why it's not working? Appreciate! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 1, "creation_date": 1421860916, "post_id": 28073121, "comment_id": 44525664, "body": "During figuring out what is wrong, did you try to use <b>F8</b> key to trace execution of the macro? Then you can hover mouse cursor over variables (among other things) to see their values."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421861412, "post_id": 28073121, "comment_id": 44525960, "body": "First you say that the macro runs without error, but then you say that the debugger breaks on line <code>Comment.Name = ...</code>.  It can&#39;t happen both ways. Either you get an error, or you do not. Please clarify.  Also, please indicate what type of data (with examples, if possible) is in the range of cells to be examined (&quot;B2:B20&quot;)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421861497, "post_id": 28073121, "comment_id": 44526013, "body": "I note that nothing in this code actually assigns a value out to the range in column C, so that is probably the explanation. <b>ALWAYS</b> declare all of your variables (<code>StartDate</code> is not declared, and it is the fact that you probably forgot to use this variable then to update the cell in column C)."}], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421862431, "post_id": 28073371, "comment_id": 44526497, "body": "I&#39;d say just before <code>Next i</code> use <code>Range(&quot;C&quot; &amp; i).Value = StartDate</code>"}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": false, "score": 2, "last_activity_date": 1421861534, "creation_date": 1421861534, "answer_id": 28073371, "question_id": 28073121, "link": "https://stackoverflow.com/questions/28073121/using-case-is-with-named-column/28073371#28073371", "title": "Using Case Is with Named Column", "body": "<p>You're not writing anything to column C. You're putting a value in the variable StartDate but not doing anything with it. You're also not doing anything with the Comment range. The following will write to Column C</p>\n\n<pre><code>Range(\"C\" &amp; i).Value = \"Success\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4424940, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XMko9x8otco/AAAAAAAAAAI/AAAAAAAAAEU/MER-TRy8aic/photo.jpg?sz=128", "display_name": "Laurie Wax", "link": "https://stackoverflow.com/users/4424940/laurie-wax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421862386, "creation_date": 1421860752, "last_edit_date": 1421862386, "question_id": 28073121, "link": "https://stackoverflow.com/questions/28073121/using-case-is-with-named-column", "title": "Using Case Is with Named Column", "body": "<p>I cant get this (simple) VBA formula to work (in Excel 2010). I want the formula to evaluate cell B2. If B2 is blank, I want C2 to be blank. If B2 > 0, I want C2 to populate with the word \"success\". Then I want the program to evaluate B3, B4, B5, etc (through B20) using the same logic as above. In other words, for each Bx, I want one of two cases. Case 1) a blank value in Bx generates a blank in the corresponding Cx or Case 2) a value greater than 0 in Bx generates the word \"success\" in the corresponding Cx. When I run the macro, I don't get an error message, but nothing happens in column C. The debugger tells me the problem is in the Comment.Name = \"Comment\" line but I cant figure out what's wrong. thanks!  </p>\n\n<pre><code>Sub AutoComplete()\n    Dim Comment As Range\n    Set Comment = Range(\"C2:C20\")\n    Comment.Name = \"Comment\"\n    For i = 2 To 20\n        Select Case Range(\"B\" &amp; i).Value\n            Case Is &gt; 0\n                StartDate = \"Success\"\n            Case Is = \" \"\n                StartDate = \" \"\n        End Select\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1421861409, "post_id": 28073084, "comment_id": 44525957, "body": "Right click on the table and click Table-&gt;Totals Row to show a row at the bottom of the table for totals. It will only sum the visible rows of that column."}, {"owner": {"reputation": 1, "user_id": 4479321, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003632820810/picture?type=large", "display_name": "Yin", "link": "https://stackoverflow.com/users/4479321/yin"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1421861936, "post_id": 28073084, "comment_id": 44526237, "body": "Wow! I didn&#39;t even think of that."}], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1421861705, "creation_date": 1421861705, "answer_id": 28073428, "question_id": 28073084, "link": "https://stackoverflow.com/questions/28073084/macro-sum-only-filtered-cells-in-table-and-copy-to-clipboard/28073428#28073428", "title": "Macro sum only filtered cells in table and copy to clipboard", "body": "<p>No need to really use a macro, you can use the <code>SUMIFS</code> function <a href=\"https://support.office.com/en-in/article/SUMIFS-function-9dd6179e-cced-41dd-ac38-08fdf5b929e5\" rel=\"nofollow\">https://support.office.com/en-in/article/SUMIFS-function-9dd6179e-cced-41dd-ac38-08fdf5b929e5</a>  Basically you will use the criteria for filtering as the criteria for summing the values. I am not sure what your filtering criteria is, but let's you are filtering value that are great than 0 in column A rows 1 to 100.</p>\n\n<pre><code>SUMIFS(A1:A100, A1:A100, \"&gt;0\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1421862264, "creation_date": 1421862264, "answer_id": 28073576, "question_id": 28073084, "link": "https://stackoverflow.com/questions/28073084/macro-sum-only-filtered-cells-in-table-and-copy-to-clipboard/28073576#28073576", "title": "Macro sum only filtered cells in table and copy to clipboard", "body": "<p>Right click on the table and click Table->Totals Row to show a row at the bottom of the table for totals. It will only sum the visible rows of that column.</p>\n"}], "owner": {"reputation": 1, "user_id": 4479321, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003632820810/picture?type=large", "display_name": "Yin", "link": "https://stackoverflow.com/users/4479321/yin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 518, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1421862264, "creation_date": 1421860638, "last_edit_date": 1421860685, "question_id": 28073084, "link": "https://stackoverflow.com/questions/28073084/macro-sum-only-filtered-cells-in-table-and-copy-to-clipboard", "title": "Macro sum only filtered cells in table and copy to clipboard", "body": "<p>I'm trying to do some data entry and was wondering if I could copy the sum of FILTERED data onto clipboard with a macro? </p>\n\n<p>I have a macro that copies sum of selected cells, but when in a table format and filtering it seems to sum everything in that range too. Please let me know.</p>\n\n<p>There are 1665 Rows total in my data table starting at 22. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1421862361, "post_id": 28072996, "comment_id": 44526462, "body": "There might be a way to alter the title in Access but it will be much easier if the modification is done in Excel (with code) prior to the import?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421862797, "post_id": 28072996, "comment_id": 44526674, "body": "@Flyhigh you can do this pretty simply in Excel VBA or even a simple concatenate formula as well.  Why do you have the requirement of doing this in Access VBA?"}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1421866837, "post_id": 28072996, "comment_id": 44528710, "body": "I assume you need this in Access because you are going to do something else with this data once you get it in Access. If not, just do your manipulations in Excel. Following that, does the table structure already exist in Access or are you bringing this in as a new table?"}, {"owner": {"reputation": 63, "user_id": 2321589, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5cf60cb6233af85c24fa70952389608?s=128&d=identicon&r=PG", "display_name": "Flyhigh", "link": "https://stackoverflow.com/users/2321589/flyhigh"}, "edited": false, "score": 0, "creation_date": 1421873081, "post_id": 28072996, "comment_id": 44531931, "body": "it was more for convenience factor. i just didnt want to open up 2 programs to just upload data on the database. I want to do it all in Access. Also this is for educational purpose as well. haha"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4220727, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NMmWd.jpg?s=128&g=1", "display_name": "CarloC", "link": "https://stackoverflow.com/users/4220727/carloc"}, "edited": false, "score": 0, "creation_date": 1490893752, "post_id": 28074678, "comment_id": 73327553, "body": "Don&#39;t know why I got a -1 on my answer. The question was; can the Excel manipulation be done in Access. The answer is yes by setting the noted reference. Am I missing something here?"}], "tags": [], "owner": {"reputation": 135, "user_id": 4220727, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NMmWd.jpg?s=128&g=1", "display_name": "CarloC", "link": "https://stackoverflow.com/users/4220727/carloc"}, "is_accepted": false, "score": -1, "last_activity_date": 1421866493, "creation_date": 1421866493, "answer_id": 28074678, "question_id": 28072996, "link": "https://stackoverflow.com/questions/28072996/combine-2-row-in-microsoft-access-table/28074678#28074678", "title": "Combine 2 row in Microsoft Access table", "body": "<p>Create a reference to Excel in Access.</p>\n\n<p>In your Access VBA IDE Goto Tools>References and find/add Microsoft Excel ##.# Object Library reference.</p>\n\n<p>You can then declare any variables (with intelliscense!) to Excel objects etc. and do all the required set up through Excel but inside an Access session.</p>\n"}], "owner": {"reputation": 63, "user_id": 2321589, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5cf60cb6233af85c24fa70952389608?s=128&d=identicon&r=PG", "display_name": "Flyhigh", "link": "https://stackoverflow.com/users/2321589/flyhigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421866493, "creation_date": 1421860373, "last_edit_date": 1421862813, "question_id": 28072996, "link": "https://stackoverflow.com/questions/28072996/combine-2-row-in-microsoft-access-table", "title": "Combine 2 row in Microsoft Access table", "body": "<p>I just have a question about importing a table to Access from Excel spreadsheet.</p>\n\n<p>I am basically importing a table from Excel to Access\n<img src=\"https://i.stack.imgur.com/UkWJG.png\" alt=\"enter image description here\"></p>\n\n<p>And I want the final table to look like this in Access -</p>\n\n<p><img src=\"https://i.stack.imgur.com/FhW4A.png\" alt=\"enter image description here\"></p>\n\n<p>Is this possible in access? or does this need to be modified in Excel before import? If so can I write all of the modification code in Access VBA?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "optimization"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421863182, "post_id": 28072805, "comment_id": 44526870, "body": "Possible candidate for migration to Code Review SE?"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421867497, "post_id": 28072984, "comment_id": 44529069, "body": "This code doesn&#39;t call the right cells, probably because you didn&#39;t respect the .Cells(ROWIndex, COLUMNIndex) notation. It also does not allow for multiple iterations through a linked command button which the original did quite well. Gonna have to stay with the original for now and move on to  other stuff. Thanks for answering anyways."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1421860319, "creation_date": 1421860319, "answer_id": 28072984, "question_id": 28072805, "link": "https://stackoverflow.com/questions/28072805/optimizing-code-for-the-formatting-of-a-row-in-excel-vba/28072984#28072984", "title": "Optimizing code for the formatting of a row in Excel VBA", "body": "<p>This will be a bit quicker:</p>\n\n<pre><code>Sub dural()\n    Dim EndRow As Long\n    EndRow = ThisWorkbook.Worksheets(\"Flags\").Cells(Rows.Count, 1).End(xlUp).Row\n    Range(\"A1:A\" &amp; EndRow).EntireRow.RowHeight = 45\n    With Range(Cells(1, 1), Cells(EndRow, 15))\n        .Borders.LineStyle = xlContinuous\n        .Borders.Weight = xlMedium\n    End With\nEnd Sub\n</code></pre>\n\n<p><em>As you see, no loops are required!</em></p>\n"}], "owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421863245, "creation_date": 1421859753, "last_edit_date": 1421863245, "question_id": 28072805, "link": "https://stackoverflow.com/questions/28072805/optimizing-code-for-the-formatting-of-a-row-in-excel-vba", "title": "Optimizing code for the formatting of a row in Excel VBA", "body": "<p>Good day!</p>\n\n<p>Now this is more of a syntax question for VBA, specifically when calling on multiple columns in a row. My code is used to give a format to a new row at each iteration. These iterations get progressively slower. I have already looked around a bit to find ways to speed it up, one which I have found and implemented being the Application.ScreenUpdating = False function which stops Excel from using considerable overhead. However, there is another area which I believe could be optimized. The following code is rather repetitive and calls cells individually which is both ugly and slow. Now, my problem is that I do not know how to use the Range function which would reduce the amount of code when I have the variable i in my loop...? Being a novice, I guess that I just am not aware of the proper way to use Range as I keep getting errors.</p>\n\n<p>The code in question:</p>\n\n<pre><code>Dim i As Long\nDim EndRow As Long\n\nEndRow = ThisWorkbook.Worksheets(\"Flags\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 19 To EndRow + 1 Step 1\n\n        ThisWorkbook.Worksheets(\"Flags\").Rows(i).RowHeight = 45\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 1).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 1).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 2).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 2).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 3).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 3).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 4).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 4).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 5).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 5).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 6).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 6).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 7).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 7).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 8).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 8).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 9).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 9).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 10).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 10).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 11).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 11).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 12).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 12).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 13).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 13).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 14).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 14).Borders.Weight = xlMedium\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 15).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Worksheets(\"Flags\").Cells(i, 15).Borders.Weight = xlMedium\n\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4475809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2278968f29dc728e510226f16a02449f?s=128&d=identicon&r=PG&f=1", "display_name": "shred21", "link": "https://stackoverflow.com/users/4475809/shred21"}, "edited": false, "score": 0, "creation_date": 1421940986, "post_id": 28081361, "comment_id": 44561633, "body": "Thanks for the reply. Actually, both Exit Subs are in the original code. I&#39;ll try deleting to see if that does the trick. I did find a workaround after posting yesterday, and it works pretty well: I put code in that runs when the workbook is open to write the word &quot;REPORT&quot; in cell B1. This occurs every time the book is opened and runs once. Since its at the top of the page and outside my table, it doesn&#39;t interfere with the data. It is effectively the first change to the array (Range(B:B)). After that, the &quot;first&quot; change (really the second!) is picked up and the counters are properly set."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 1, "user_id": 4475809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2278968f29dc728e510226f16a02449f?s=128&d=identicon&r=PG&f=1", "display_name": "shred21", "link": "https://stackoverflow.com/users/4475809/shred21"}, "edited": false, "score": 0, "creation_date": 1423082262, "post_id": 28081361, "comment_id": 45009055, "body": "@shred21 If you answered your own question, please add it as an answer and accept it. That way, future users will easily know which method worked for you."}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1421901325, "creation_date": 1421901325, "answer_id": 28081361, "question_id": 28072388, "link": "https://stackoverflow.com/questions/28072388/loop-does-not-initialize-until-after-first-selection-is-made/28081361#28081361", "title": "Loop does not initialize until after first selection is made", "body": "<p>You have a couple <code>Exit Sub</code>'s near the beginning that could be causing the issue. I suspect it's the first one and that <code>init = 0</code> the first time it is run.</p>\n"}, {"comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1423680918, "post_id": 28355285, "comment_id": 45250220, "body": "Make sure to accept your answer so that it shows up first on the list of answers."}], "tags": [], "owner": {"reputation": 1, "user_id": 4475809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2278968f29dc728e510226f16a02449f?s=128&d=identicon&r=PG&f=1", "display_name": "shred21", "link": "https://stackoverflow.com/users/4475809/shred21"}, "is_accepted": false, "score": 0, "last_activity_date": 1423175263, "creation_date": 1423175263, "answer_id": 28355285, "question_id": 28072388, "link": "https://stackoverflow.com/questions/28072388/loop-does-not-initialize-until-after-first-selection-is-made/28355285#28355285", "title": "Loop does not initialize until after first selection is made", "body": "<p>I figured out the answer a day after posting, and it works pretty well: </p>\n\n<p>I put code in that runs when the workbook is open to write a string into a cell within the range that is checked (I put the word \"REPORT\" in cell B1), which is, in effect, the first change to the sheet. </p>\n\n<p>This occurs every time the book is opened and runs only once. Since it is at the top of the page and outside my table, it doesn't interfere with the data, but it solves the \"first time into the loop\" conundrum. It is effectively the first change to the array (Range(B:B)). After that, the \"first\" change (really the second!) is picked up and the counters are properly set.</p>\n\n<p>Go freaking figure ....... </p>\n\n<p>Hope this helps someone out there. </p>\n"}], "owner": {"reputation": 1, "user_id": 4475809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2278968f29dc728e510226f16a02449f?s=128&d=identicon&r=PG&f=1", "display_name": "shred21", "link": "https://stackoverflow.com/users/4475809/shred21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423175263, "creation_date": 1421858486, "last_edit_date": 1531161705, "question_id": 28072388, "link": "https://stackoverflow.com/questions/28072388/loop-does-not-initialize-until-after-first-selection-is-made", "title": "Loop does not initialize until after first selection is made", "body": "<p>Using this <a href=\"https://stackoverflow.com/questions/19088467/vba-check-changes-in-a-particular-cell-range\">very helpful example</a> as a starting point (thank you Gary's Student!), I am having trouble initializing the code so it recognizes the very first change. There's a big pile of hair on the table next to me as I've been trying to solve this for 2 days now..... </p>\n\n<p>Basically, I have a range (<code>B1:B200</code>) in a table. Through data validation (drop down list), users have a choice of two values for the cells in this range. When they choose a value, I want to pick up that the cell has changed (let's say <code>B12</code>) and, based on the new value (either choice 1 or choice 2), the first cell in that row (cell <code>A12</code>) has it's value set to one of two different counters. </p>\n\n<p>When the workbook is first opened and a user makes a selection in that range, it doesn't \"see\" that first change, but each subsequent change is recorded and the value in cell <code>A</code> is set properly and the appropriate counter is then incremented. </p>\n\n<p><strong>One other constraint:</strong> \nIf a user chooses a value and cell A is set, they cannot subsequently change the B value from 1 to 2 (otherwise the counters would just keep incrementing). </p>\n\n<p>Does this make sense? </p>\n\n<p>Here's the code I'm working with. Thanks all, very much, for any assistance you can provide: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Interesting As Range\n    Dim I As Long, J As Long, K As Long, INTL As Long, DOMESTIC As Long\n\n    ' These are the values for the two counters, stored in another sheet in\n    ' the book:\n    INTL = Worksheets(\"MASTER\").Range(\"A8\")\n    DOMESTIC = Worksheets(\"MASTER\").Range(\"A5\")\n\n    K = 1\n    Set Interesting = Range(\"B1:B200\")\n    If init = 0 Then\n        MemoryOfThingsPast = Interesting\n        init = 1\n        Exit Sub\n    End If\n\n    If Intersect(Target, Interesting) Is Nothing Then Exit Sub\n\n    K = 1\n    ' MsgBox \"2. init: \" &amp; init &amp; \"  v1: \" &amp; v1 &amp; \"  v2: \" &amp; v2\n\n    For I = LBound(MemoryOfThingsPast, 1) To UBound(MemoryOfThingsPast, 1)\n        For J = LBound(MemoryOfThingsPast, 2) To UBound(MemoryOfThingsPast, 2)\n            ' MsgBox \"3. init: \" &amp; init &amp; \"  v1: \" &amp; v1 &amp; \"  v2: \" &amp; v2\n\n            v1 = Interesting(K)\n            v2 = MemoryOfThingsPast(I, J)\n\n            If v1 &lt;&gt; v2 Then\n                If Not IsEmpty(Cells(K, 1)) Then\n                    If v1 = \"INTERNATIONAL\" And Left(Cells(K, 1), 1) = \"D\" Then\n                        MsgBox \"DOMESTIC counter is already set\"\n                    ElseIf v1 = \"DOMESTIC\" And Left(Cells(K, 1), 1) = \"I\" Then\n                        MsgBox \"INTERNATIONAL counter is already set\"\n                    End If\n                Else\n                    If v1 = \"INTERNATIONAL\" And IsEmpty(Cells(K, 1)) Then\n                        Worksheets(\"MASTER\").Range(\"A8\") = INTL + 1\n                        Cells(K, 1) = \"I-\" &amp; INTL\n                        MsgBox \"INTL Counter has been set.\"\n                    ElseIf v1 = \"DOMESTIC\" And IsEmpty(Cells(K, 1)) Then\n                        Worksheets(\"MASTER\").Range(\"A5\") = DOMESTIC + 1\n                        Cells(K, 1) = \"D-\" &amp; DOMESTIC\n                        MsgBox \"DOMESTIC Counter has been set.\"\n                    End If\n                End If\n            End If\n            K = K + 1\n        Next J\n    Next I\n\n    MemoryOfThingsPast = Interesting\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "transpose", "unpivot"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1421858711, "post_id": 28072309, "comment_id": 44524275, "body": "You can use the <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=39379\" rel=\"nofollow noreferrer\">Power Query</a> Excel add-in from Microsoft to perform an <a href=\"https://support.office.com/en-ie/article/Unpivot-columns-0f7bad4b-9ea1-49c1-9d95-f588221c7098\" rel=\"nofollow noreferrer\">Unpivot</a>"}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1421858878, "post_id": 28072309, "comment_id": 44524401, "body": "It can also be done with worksheet formulas alone, though depending on the size of your dataset, this may not be the most effective solution."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1421858934, "last_edit_date": 1495535188, "creation_date": 1421858934, "answer_id": 28072529, "question_id": 28072309, "link": "https://stackoverflow.com/questions/28072309/conditionally-transpose/28072529#28072529", "title": "Conditionally Transpose", "body": "<p>You could apply the process detailed <a href=\"https://stackoverflow.com/a/20543651/1505120\">here</a> but finish off with addressing those data rows that are shorter than others (fewer cells populated) by filtering <code>Value</code> to select <code>(Blanks)</code> and deleting those rows. </p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": true, "score": 0, "last_activity_date": 1421863695, "creation_date": 1421863695, "answer_id": 28073946, "question_id": 28072309, "link": "https://stackoverflow.com/questions/28072309/conditionally-transpose/28073946#28073946", "title": "Conditionally Transpose", "body": "<p>Here is an image of Sheet1:</p>\n\n<p><img src=\"https://i.stack.imgur.com/HUaiq.jpg\" alt=\"\"></p>\n\n<p>Here is the code in Sheet1's module:</p>\n\n<pre><code>Public Sub ProcessData()\n    Dim rData As Range\n    Dim OutRow As Long\n    Dim DataRow As Long\n    Dim DataCol As Long\n    Dim SKU As Long\n\n    With Worksheets(\"Sheet1\")\n        Set rData = .Range(\"D1:J10\") ' deliberately larger than the data, as a deminstration\n        OutRow = 1\n        For DataRow = 2 To rData.Rows.Count\n            SKU = rData(DataRow, 1)\n            If SKU = 0 Then\n                Exit For\n            End If\n            For DataCol = 2 To rData.Columns.Count\n                If Not IsEmpty(rData(DataRow, DataCol)) Then\n                    OutRow = OutRow + 1\n                    .Cells(OutRow, 1) = SKU\n                    .Cells(OutRow, 2) = rData(DataRow, DataCol)\n                Else\n                    Exit For\n                End If\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>This should give you a good starting point.</p>\n"}], "owner": {"reputation": 411, "user_id": 1625155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ded2d420d68a8859b2081d8c4c25b638?s=128&d=identicon&r=PG", "display_name": "user1625155", "link": "https://stackoverflow.com/users/1625155/user1625155"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1501, "favorite_count": 0, "accepted_answer_id": 28073946, "answer_count": 2, "score": 0, "last_activity_date": 1422400568, "creation_date": 1421858278, "last_edit_date": 1422400568, "question_id": 28072309, "link": "https://stackoverflow.com/questions/28072309/conditionally-transpose", "title": "Conditionally Transpose", "body": "<p>I have a table that looks like this:</p>\n\n<pre><code>SKU    ID1    ID2    ID3    ID4     and so on...\n111    1ab    2bc    3bc                                \n222    1bb    3bb    4bb    abb\n333    2bb    3bb    4bc    abc\n444    1b2    2bb\n</code></pre>\n\n<p>I am trying to format all of the data as below, hopefully with some kind of macro:</p>\n\n<pre><code>SKU    ID\n111    1ab                      \n111    2bc\n111    3bc  \n222    1bb\n222    3bb\n222    4bb\n222    abb\n333    2bb\n333    3bb\n333    4bc\n333    abc\n444    1b2\n444    2bb\n</code></pre>\n\n<p>I have tried transposing all of it at once, but it does not come out right. I think a more coded macro type solution is needed, but I am not sure.</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2007"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1421858875, "post_id": 28071931, "comment_id": 44524398, "body": "Check this out -&gt; <a href=\"http://stackoverflow.com/q/24132665/2140173\">stackoverflow.com/q/24132665/2140173</a>"}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421862258, "post_id": 28071931, "comment_id": 44526402, "body": "Thanks, but that thread just shows how to extract RGB from Range.Interior.Color. That&#39;s interesting information but not to the point. The point is that I&#39;m getting different numbers depending on Excel version. After converting to RGB, I&#39;ve still got different numbers depending on Excel version."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1422010263, "post_id": 28071931, "comment_id": 44590554, "body": "I do not know if the OP is told if an answer is updated.  To be sure you know, please see my updated answer."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 1, "creation_date": 1421857732, "post_id": 28072140, "comment_id": 44523630, "body": "your <i>answer</i> is somehow an alternative solution but it <b>doesn&#39;t</b> answer the original question asked which was <i>Range.Interior.Color returns different numbers for the same color in some cases, depending on whether it is running in Excel 2007, or Excel 2010 or 2013</i>. <b>Is that expected??</b>"}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421857942, "post_id": 28072140, "comment_id": 44523759, "body": "@vba4all     did I misread this: &quot;Any suggestions? For now, I&#39;m using conditional compliling...&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1421858040, "post_id": 28072140, "comment_id": 44523818, "body": "to me the question being asked here is rather straight forward, the numbers change in different XL versions, is that expected? why does it happen then?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1421858258, "post_id": 28072140, "comment_id": 44523961, "body": "Even though someone experienced in XL sees potential in your answer as it stands it is very poor IMHO. You should explain the difference in comparison to the OP&#39;s current approach and why your alternative is better. The part about constants seems a bit irrelevant to the actual problem."}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 1, "creation_date": 1421858334, "post_id": 28072140, "comment_id": 44524010, "body": "@vba4all You are free to edit the answer, I do not mind a bit. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1421858433, "post_id": 28072140, "comment_id": 44524080, "body": "I am trying to give you tips on how to give a good answer. If I wanted to answer myself, I would. Since I have been here quite a bit longer then you and answered a lot more questions than you at the moment I am happy to help new users - both askers and answerers improve the quality of their online contributions."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 1, "creation_date": 1421858446, "post_id": 28072140, "comment_id": 44524087, "body": "Thanks guys, I&#39;m actually intersted in both questons:  is the behavior expected, and any suggestions on a better workaround than conditional compile. Gene, thanks for the suggestion; I&#39;d looked at RGB. But conditional compile as I&#39;m doing now seems a bit easier than having three constants per color."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421858565, "post_id": 28072140, "comment_id": 44524160, "body": "@GregLovern conditional compiling may not be necessary if you understand what the .Interior.Color returns and how it&#39;s calculated. It would help if someone shared why the number is different and if there is an easier way to calculate it."}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421858719, "post_id": 28072140, "comment_id": 44524280, "body": "@vba4all Thank you for your help."}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421858922, "post_id": 28072140, "comment_id": 44524440, "body": "@Greg Lovern 4 colors * 3 color components = 12 lines of code. You have 13 lines of code :)"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1421859186, "post_id": 28072140, "comment_id": 44524638, "body": "@GeneSkuratovsky adding a reference link (and maybe a quote) to the document saying &quot;Yes, this indeed is expected it changed between versions.&quot; would gain an upvote from me. <i>hint hint wink wink</i>"}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1421859442, "post_id": 28072140, "comment_id": 44524790, "body": "@RubberDuck But some of the Range.Interior.Color numbers are the same between all of these versions. It isn&#39;t normal for all properties to return different values between versions; if they did, we&#39;d have to conditional-compile virtually all our code."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421859939, "post_id": 28072140, "comment_id": 44525102, "body": "@GeneSkuratovsky Not true about your solution requiring only 12 lines of code; it would require much more. There are many places in the code where I branch based on that color; currently I just check the constant and branch accordingly. With RGB instead of conditional compile, I&#39;d either have to add variables for each color and assign them according to Excel version, or test for all three R/G/B each time and branch according to all three, a fairly complex test which should probably go in a new function. If you believe it can be done with only your 12 lines, I&#39;d like to see it."}], "tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": false, "score": -1, "last_activity_date": 1421864936, "last_edit_date": 1421864936, "creation_date": 1421857710, "answer_id": 28072140, "question_id": 28071931, "link": "https://stackoverflow.com/questions/28071931/range-interior-color-different-between-excel-2007-and-later/28072140#28072140", "title": "Range.Interior.Color Different Between Excel 2007 and Later", "body": "<p>You can use the RGB() function instead of those numbers, as for example in </p>\n\n<pre><code>   Activecell.Interior.Color = RGB(200,150,230)\n</code></pre>\n\n<p>If you would like the constants, then </p>\n\n<pre><code>    Const RED = 200\n    Const GRN = 150\n    Const BLU = 230\n    ......\n    Activecell.Interior.Color = RGB(RED, GRN, BLU)\n</code></pre>\n\n<p>As for \"Is it expected?\", here is this: <code>Color = 10921638</code> is <code>RGB(165, 165, 165)</code> while <code>Color = 10855845</code> is <code>RGB(166, 166, 166)</code>. I have no access to Excel 2007 at the moment, but if your color values are indeed system's \"dark grey\" in both cases then Microsoft has a changed the value for \"dark grey\" between the Excel versions. I suspect you do not care or able to see the difference between the two anyway... You might consider using the same color in all versions, I think.</p>\n"}, {"comments": [{"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421861901, "post_id": 28073231, "comment_id": 44526217, "body": "The colors in the cells are set when the user picks a color from Excel&#39;s user interface for picking a &quot;Fill Color&quot; for a cell."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421863351, "post_id": 28073231, "comment_id": 44526958, "body": "@GregLovern  The colour number for a cell can be set using VBA to anything the programmer wants or can be set by selecting a colour from the palette. The palette is under user control and can be changed.  I do not believe Microsoft has changed its standard colours since I have received workbooks created in different versions of Excel without encountering different colours.  If you do not want to blame your programmers, you need to ask which of your users is changing the palette."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421864024, "post_id": 28073231, "comment_id": 44527320, "body": "It sounds like you&#39;re saying that for any given color in the cell, Range.Interior.Color returns different numbers depending on the palette. In that case, RGB would also return different sets of numbers depending on palette, since any given Range.Interior.Color number always converts to the same set of RGB numbers. I&#39;m surprised to hear that you get different numbers (whether Range.Interior.Color or RGB) depending on palette. Can you show an example of how Range.Interior.Color or RGB numbers can change just by changing the palette, without changing the cell&#39;s Fill Color?"}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421864793, "post_id": 28073231, "comment_id": 44527693, "body": "Also, as far as I can tell the palette is a property of the workbook, not of the Excel Application. So when this workbook is opened by each version of Excel, it always has the same palette. The users are not changing the palette; I&#39;m seeing this change in Range.Interior.Color just by opening the workbook in one verson of Excel, then closing the workbook without making any changes, and then opening it in another version of Excel. No changes to the workbook at all; just opening in different versions of Excel, and seeing different Range.Interior.Color numbers for the same, unchanged cell."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421865937, "post_id": 28073231, "comment_id": 44528260, "body": "It sounds like you&#39;re saying that for any given color in the cell, Range.Interior.Color returns different numbers depending on the palette. No.  Once the colour of a cell is set, changing the palette does not change the cell."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1421866121, "post_id": 28073231, "comment_id": 44528360, "body": "No changes to the workbook at all; just opening in different versions of Excel, and seeing different Range.Interior.Color numbers for the same, unchanged cell.  When I have had problems with colours in the past, the user has admitted playing with the palette.  I have no explanation for the behaviour you describe."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1422032842, "post_id": 28073231, "comment_id": 44604150, "body": "@GregLovern Just reread my last but one comment where I quote you and then reply.  My reply is wrong; don&#39;t know what I was thinking.  For 2003, changing the palette immediately changes all cells that reference it.  I have not experimented with later versions."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 2, "last_activity_date": 1422010148, "last_edit_date": 1422010148, "creation_date": 1421861063, "answer_id": 28073231, "question_id": 28071931, "link": "https://stackoverflow.com/questions/28071931/range-interior-color-different-between-excel-2007-and-later/28073231#28073231", "title": "Range.Interior.Color Different Between Excel 2007 and Later", "body": "<p>If you search for \u201cExcel colour codes\u201d you will find sites that list Excel\u2019s 56 \u201cofficial\u201d colours.  You will not find any of numbers you list in the official list.</p>\n\n<p>The Red, Green and Blue values for the numbers you list are:</p>\n\n<pre><code>             Red   Green   Blue \n10855845     165     165    165\n10921638     166     166    166\n 9868950     150     150    150  Grey 40%\n\n14922893     141     180    227\n14857357     141     180    226\n16764057     153     204    255  Pale blue\n\n14211288     216     216    216\n14277081     217     217    217\n12632256     192     192    192  Grey 25%   \n</code></pre>\n\n<p>In each sub-table, the first two lines show your colour numbers.  Although the combined numbers like very different, you will notice the separate values are almost identical so the two alternative colours would look the same on the screen.  The third line shows the nearest official Excel colour and its name.</p>\n\n<p>The question for you to investigate is: where have these non-standard colour numbers come from?  Are these colours being set by a program or has the palette been very subtly changed by a user?  I find it difficult to believe Microsoft released Excel 2007, 2010 and 2013 to you in this state.</p>\n\n<p><strong>New section</strong></p>\n\n<p>I have been playing with Excel colours and I am convinced your problem is related to the palette and the use of non-standard colours.</p>\n\n<p>I do not have your range of versions so experimented with 2003 and 2007.</p>\n\n<p>With 2003 there is a palette of 56 colours and a colour index with a value of 1 to 56.  I believe that Excel stores the colour index against a cell because:</p>\n\n<ul>\n<li>If with VBA you set a cell to an off-palette colour, Excel immediately changes it to an on-palette colour.</li>\n<li>If you change a colour on the palette, every use of that colour within the workbook immediately changes.</li>\n</ul>\n\n<p>That is, with 2003 you can have any 56 colours but only 56 different colours.</p>\n\n<p>Under 2003, I created a new workbook.  On the palette, I switched Red and Blue and I replaced Indigo, RGB(51, 51, 163), by RGB(167, 167, 167).  This is not a standard Excel colour but, if it was, it would be named something like Grey 30.  I coloured a few cells using these colours.</p>\n\n<p>I opened this workbook with 2007 and saved it as an xlsm file.  The colours on the worksheet appeared unchanged.  I selected a new cell and defined a custom colour of RGB(167, 167, 167).  Visually the new cell was identical (to my eyes) to those coloured with the RGB(167, 167, 167) imported from 2003.  I then examined these cells via the palette and VBA:</p>\n\n<pre><code>Colour I    Appearance   Number according      Number according\nhad set     on screen    to palette            to VBA\n255,0,0       Red        0,0,255 Blue          255,0,0\n0,0,255       Blue       255,0,0 Red           0,0,255\n167,167,167   Grey 30    51,51,153 Indigo      167,167,167      Imported from 2003\n167,167,167   Grey 30    167,167,167 Grey 30   167,167,167      Created with 2007\n</code></pre>\n\n<p>The implication from the last line is that 2007 can handle custom colours correctly if defined within 2007 but gets hopelessly confused with imported custom colours.</p>\n\n<p>My understanding is that 2007 to 2010 to 2013 involved incremental improvements but 2003 to 2007 was a total rewrite.  I would guess a bug in 2007 was fixed in 2010.   </p>\n\n<p>I believe the problem is the use of non-standard colours.  2007 may have a larger standard palette but RGB(167, 167, 167) is not on it.  I do not have 2010 or 2013 but suspect I would get different results if I tried this experiment with either of them.</p>\n\n<p>I believe you must re-colour all cells that use these custom colours with standard colours.  You report two custom shades of grey and a custom variation of pale blue.  Surely 2007, 2010 and 2013 offer enough standard shades and colours?</p>\n"}, {"tags": [], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "is_accepted": true, "score": 0, "last_activity_date": 1422030637, "creation_date": 1422030637, "answer_id": 28114381, "question_id": 28071931, "link": "https://stackoverflow.com/questions/28071931/range-interior-color-different-between-excel-2007-and-later/28114381#28114381", "title": "Range.Interior.Color Different Between Excel 2007 and Later", "body": "<p>Update:</p>\n\n<p>I haven't been able to reproduce this problem in a new workbook, so it may be workbook corruption. Normally Range.Interior.Color is reliable across versions, for all colors represented.</p>\n\n<p>FWIW, this workbook was sent to me by another person, and that person is on Excel for Macintosh while I am on Windows, so creating the workbook on one platform and then using it on another may have been a factor in the corruption, if any (even though that should work fine).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6400594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6ede7c49a734cd4f2815977f1aafd2a?s=128&d=identicon&r=PG&f=1", "display_name": "user6400594", "link": "https://stackoverflow.com/users/6400594/user6400594"}, "is_accepted": false, "score": 0, "last_activity_date": 1464614478, "creation_date": 1464614478, "answer_id": 37526764, "question_id": 28071931, "link": "https://stackoverflow.com/questions/28071931/range-interior-color-different-between-excel-2007-and-later/37526764#37526764", "title": "Range.Interior.Color Different Between Excel 2007 and Later", "body": "<p>I have been doing some work with a project and come across something that may help with this whole question.  I have been working on Excel 2010 (and don't have access to any more versions at the moment), but found out that there is more than one way to refer to 3 x 8-bit colours.  While we are all familiar with RGB (Red-Green-Blue) references I came across someone using BGR (Blue-Green-Red) and got very confused in a similar manner to the original post.  I remember doing work a long time ago on XL2003 and found that the colours were \"correct\", so I suspect that MS have changed the references without telling everybody (their documentation states RGB).</p>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2956, "favorite_count": 1, "accepted_answer_id": 28114381, "answer_count": 4, "score": 4, "last_activity_date": 1464614478, "creation_date": 1421857136, "last_edit_date": 1421863374, "question_id": 28071931, "link": "https://stackoverflow.com/questions/28071931/range-interior-color-different-between-excel-2007-and-later", "title": "Range.Interior.Color Different Between Excel 2007 and Later", "body": "<p>I'm seeing that Range.Interior.Color returns different numbers for the same color in some cases, depending on whether it is running in Excel 2007, or Excel 2010 or 2013.</p>\n\n<p>Is that expected?? I'm surprised.</p>\n\n<p>Range.Interior.Color is the background color (\"Fill Color\") of the cell. In the Immediate pane, you can read it like this:</p>\n\n<p>?ActiveCell.Interior.Color</p>\n\n<p>And set it like this:</p>\n\n<p>ActiveCell.Interior.Color = 10921638</p>\n\n<p>Examples:</p>\n\n<p>Example 1:</p>\n\n<p>(these are the same color though their Range.Interior.Color are different.)</p>\n\n<ul>\n<li>Excel 2007:       10855845</li>\n<li>Excel 2010/2013:  10921638</li>\n</ul>\n\n<p>Example 2:</p>\n\n<ul>\n<li>Excel 2007:       14922893</li>\n<li>Excel 2010/2013:  14857357</li>\n</ul>\n\n<p>Example 3:</p>\n\n<ul>\n<li>Excel 2007:       14211288</li>\n<li>Excel 2010/2013:  14277081</li>\n</ul>\n\n<p>Any suggestions? For now, I'm using conditional compliling to set constants for one number or the other depending on VBA constant VBA7, which returns True for Excel 2010 or later and False for Excel 2007 and earlier:</p>\n\n<pre><code>#If VBA7 Then\n    'Excel 2010 or later:\n    Const NO_SHADING_COLOR As Long = 16777215\n    Const MAIN_HEADER_COLOR As Long = 10921638 'dark gray [in xl2007 s/b 10855845]\n    Const SUB_HEADER_COLOR As Long = 14857357 'light blue [in xl2007 s/b 14922893]\n    Const SUBSUB_HEADER_COLOR As Long = 14277081 'medium gray [in xl2007 s/b 14211288]\n#Else\n    'Excel 2007 or earlier:\n    Const NO_SHADING_COLOR As Long = 16777215\n    Const MAIN_HEADER_COLOR As Long = 10855845 'dark gray\n    Const SUB_HEADER_COLOR As Long = 14922893 'light blue\n    Const SUBSUB_HEADER_COLOR As Long = 14211288 'medium gray\n#End If\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Yes, I understand that RGB can be used intead of Range.Interior.Color, and that RGB numbers can be extracted from Range.Interior.Color. But we can do that all day long and still get different sets of RGB numbers depending on Excel version, which effectively takes us back to the original problem.</p>\n\n<p>For any given Range.Interior.Color number, yes it is equivalent to a certain set of RGB numbers. But the point is that depending on Excel version, in some cases you get different Range.Interior.Color numbers for the very same cell without changing the cell's color. If you extract that number to RGB numbers, then you just have different sets of RGB numbers depending on Excel version, which is no better than having the different Range.Interior.Color numbers depending on version.</p>\n\n<p>These cell colors are being set by the user, using Excel's user interface for setting the cell's \"Fill Color\". The VBA code in this proejct does not set the colors. The VBA code only GETS the colors, and branches according to the color found in the cell being processed.</p>\n\n<p>Aside from obvious exceptions like Application.Version, it isn't normal for object properties to randomly change like this from version to version. Consistency of object properties between versions is an important part of what allows VBA code to work across different versions. If it were not so, we'd have to conditional-compile virtually all our Excel VBA code.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1421856421, "post_id": 28071507, "comment_id": 44522745, "body": "Do you want the <i>Display</i> to be converted or the <i>underlying value</i> ?"}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 3317244, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RAdtp.jpg?s=128&g=1", "display_name": "Damien Morvan", "link": "https://stackoverflow.com/users/3317244/damien-morvan"}, "edited": false, "score": 0, "creation_date": 1421856840, "post_id": 28071729, "comment_id": 44523026, "body": "Thank you for replying. I know I could format the cells individually but the report contains more than 3000 rows.... I&#39;m looking for a way to format it automatically."}, {"owner": {"reputation": 323, "user_id": 3317244, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RAdtp.jpg?s=128&g=1", "display_name": "Damien Morvan", "link": "https://stackoverflow.com/users/3317244/damien-morvan"}, "edited": false, "score": 0, "creation_date": 1421857060, "post_id": 28071729, "comment_id": 44523171, "body": "Got it but is there a way to keep the values as text in the PT?"}, {"owner": {"reputation": 323, "user_id": 3317244, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RAdtp.jpg?s=128&g=1", "display_name": "Damien Morvan", "link": "https://stackoverflow.com/users/3317244/damien-morvan"}, "edited": false, "score": 0, "creation_date": 1421857325, "post_id": 28071729, "comment_id": 44523360, "body": "Ok so at the end there is no way to do what I am asking for?"}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "reply_to_user": {"reputation": 323, "user_id": 3317244, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RAdtp.jpg?s=128&g=1", "display_name": "Damien Morvan", "link": "https://stackoverflow.com/users/3317244/damien-morvan"}, "edited": false, "score": 1, "creation_date": 1421857552, "post_id": 28071729, "comment_id": 44523519, "body": "@DamienMorvan if it helps to have a second opinion, you cannot do what you are asking. pnuts has a good work around, but it is exactly that."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1421856416, "creation_date": 1421856416, "answer_id": 28071729, "question_id": 28071507, "link": "https://stackoverflow.com/questions/28071507/excel-convert-numbers-to-text-in-a-pivot-table-more-than-4-values/28071729#28071729", "title": "Excel - Convert numbers to text in a pivot table (more than 4 values)", "body": "<p>You might format the cells individually, say:  </p>\n\n<pre><code>[=4]\"D\"  \n</code></pre>\n\n<p>but I would suggest select the PT, Copy, Paste Special, Values somewhere else and then in the copy lookup the numbers from the PT in a lookup table.</p>\n"}], "owner": {"reputation": 323, "user_id": 3317244, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RAdtp.jpg?s=128&g=1", "display_name": "Damien Morvan", "link": "https://stackoverflow.com/users/3317244/damien-morvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421856416, "creation_date": 1421855815, "question_id": 28071507, "link": "https://stackoverflow.com/questions/28071507/excel-convert-numbers-to-text-in-a-pivot-table-more-than-4-values", "title": "Excel - Convert numbers to text in a pivot table (more than 4 values)", "body": "<p>I have built an Excel sheet that displays Employee's Grade Number. I also have created a pivot table based on the same data. </p>\n\n<p>I would like the Grade Number to be displayed as Text in the pivot table :</p>\n\n<pre><code>-If value = 1 then \"A\" is displayed in the table\n-If value = 2 then \"B\" is displayed in the table\n-If value = 3 then \"C\" is displayed in the table\n-If value = 4 then \"D\" is displayed in the table\n-Else \"N/A\" is displayed\n</code></pre>\n\n<p>I tried using the conditional formatting but it only works for 2 values.</p>\n\n<p>Could you help me by providing a VBA script or another idea?</p>\n\n<p>You can find an example of the file here: <a href=\"http://s000.tinyupload.com/index.php?file_id=06988753639886895632\" rel=\"nofollow\">http://s000.tinyupload.com/index.php?file_id=06988753639886895632</a></p>\n\n<p>Thanks,\nDamien</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "edited": false, "score": 0, "creation_date": 1421856805, "post_id": 28071557, "comment_id": 44523007, "body": "Thanks Gary. Great help!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 4, "last_activity_date": 1421855931, "creation_date": 1421855931, "answer_id": 28071557, "question_id": 28071459, "link": "https://stackoverflow.com/questions/28071459/compare-2-cells-in-excel-by-using-vba/28071557#28071557", "title": "compare 2 cells in excel by using vba", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub CompareCells()\n    If [a1] = [b1] Then\n        [c1] = \"yes\"\n    Else\n        [c1] = \"no\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><em>Assign this code to the button.</em></p>\n"}, {"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421856257, "post_id": 28071641, "comment_id": 44522621, "body": "That isn&#39;t proper VBA syntax."}, {"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "edited": false, "score": 3, "creation_date": 1421856471, "post_id": 28071641, "comment_id": 44522774, "body": "Fairly certain this isn&#39;t valid code in <i>any</i> language. Looks like you&#39;ve mixed together VBA and C#. And even if the syntax was correct, this does not do what the question asks."}, {"owner": {"reputation": 29, "user_id": 4479057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7532c1f6a747cdef784e069c2babd91?s=128&d=identicon&r=PG&f=1", "display_name": "Eswin", "link": "https://stackoverflow.com/users/4479057/eswin"}, "edited": false, "score": 0, "creation_date": 1421863634, "post_id": 28071641, "comment_id": 44527108, "body": "If (Range(&quot;A1&quot;).Value = Range(&quot;B1&quot;).Value) Then         MsgBox (&quot;Equals&quot;)     Else         MsgBox (&quot;Not Equals&quot;)     End If"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421864110, "post_id": 28071641, "comment_id": 44527362, "body": "Syntax works, but still doesn&#39;t answer the original Q."}, {"owner": {"reputation": 29, "user_id": 4479057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7532c1f6a747cdef784e069c2babd91?s=128&d=identicon&r=PG&f=1", "display_name": "Eswin", "link": "https://stackoverflow.com/users/4479057/eswin"}, "edited": false, "score": 0, "creation_date": 1421864367, "post_id": 28071641, "comment_id": 44527486, "body": "If (Range(&quot;A1&quot;).Value = Range(&quot;B1&quot;).Value) Then      Range(&quot;C1&quot;).Value = &quot;Yes&quot;  Else      Range(&quot;C1&quot;).Value = &quot;No&quot;  End If"}], "tags": [], "owner": {"reputation": 29, "user_id": 4479057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7532c1f6a747cdef784e069c2babd91?s=128&d=identicon&r=PG&f=1", "display_name": "Eswin", "link": "https://stackoverflow.com/users/4479057/eswin"}, "is_accepted": false, "score": 2, "last_activity_date": 1421867356, "last_edit_date": 1421867356, "creation_date": 1421856182, "answer_id": 28071641, "question_id": 28071459, "link": "https://stackoverflow.com/questions/28071459/compare-2-cells-in-excel-by-using-vba/28071641#28071641", "title": "compare 2 cells in excel by using vba", "body": "<pre><code>If (Range(\"A1\").Value = Range(\"B1\").Value) Then\n    Range(\"C1\").Value = \"Yes\"\nElse\n    Range(\"C1\").Value = \"No\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1421856534, "creation_date": 1421856534, "answer_id": 28071764, "question_id": 28071459, "link": "https://stackoverflow.com/questions/28071459/compare-2-cells-in-excel-by-using-vba/28071764#28071764", "title": "compare 2 cells in excel by using vba", "body": "<p>Here is an on change Sub (code MUST go in the sheet module).  It will only activate if you change a cell in column B.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target is Nothing Then Exit Sub\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If Target.Column &lt;&gt; 2 Then Exit Sub\n    If Cells(Target.Row, 1).Value = Cells(Target.Row, 2).Value Then\n        Cells(Target.Row, 3).Value = \"Yes\"\n    Else\n        Cells(Target.Row, 3).Value = \"No\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>For the record, this doesn't use a button, but it accomplishes your goal of calculating if the two cells are equal any time you manually enter data into cells in Col B.</p>\n"}, {"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421864173, "post_id": 28072507, "comment_id": 44527395, "body": "This isn&#39;t standard practice in VBA.  If you are trying to make your code portable, I&#39;d suggest either Gary&#39;s answer on assigning to a button or my answer on using onchange event."}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": true, "score": 0, "last_activity_date": 1421858865, "creation_date": 1421858865, "answer_id": 28072507, "question_id": 28071459, "link": "https://stackoverflow.com/questions/28071459/compare-2-cells-in-excel-by-using-vba/28072507#28072507", "title": "compare 2 cells in excel by using vba", "body": "<p>You can use the IIF function in VBA. It is similar to the Excel IF</p>\n\n<pre><code>[c1] = IIf([a1] = [b1], \"Yes\", \"No\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10684872, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2ed838b00b161777f176d847b44653ad?s=128&d=identicon&r=PG", "display_name": "Madhushree", "link": "https://stackoverflow.com/users/10684872/madhushree"}, "is_accepted": false, "score": 0, "last_activity_date": 1542793560, "last_edit_date": 1542793560, "creation_date": 1542792558, "answer_id": 53408910, "question_id": 28071459, "link": "https://stackoverflow.com/questions/28071459/compare-2-cells-in-excel-by-using-vba/53408910#53408910", "title": "compare 2 cells in excel by using vba", "body": "<pre><code>Sub CompareandHighlight()\n    Dim n As Integer\n    Dim sh As Worksheets\n    Dim r As Range\n\n    n = Worksheets(\"Indices\").Range(\"E:E\").Cells.SpecialCells(xlCellTypeConstants).Count\n    Application.ScreenUpdating = False \n\n    Dim match As Boolean\n    Dim valE As Double\n    Dim valI As Double\n    Dim i As Long, j As Long\n\n    For i = 2 To n\n        valE = Worksheets(\"Indices\").Range(\"E\" &amp; i).Value\n        valI = Worksheets(\"Indices\").Range(\"I\" &amp; i).Value\n\n        If valE = valI Then\n\n        Else:                           \n            Worksheets(\"Indices\").Range(\"E\" &amp; i).Font.Color = RGB(255, 0, 0)\n        End If\n    Next i\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92897, "favorite_count": 0, "accepted_answer_id": 28072507, "answer_count": 5, "score": 8, "last_activity_date": 1542805611, "creation_date": 1421855718, "question_id": 28071459, "link": "https://stackoverflow.com/questions/28071459/compare-2-cells-in-excel-by-using-vba", "title": "compare 2 cells in excel by using vba", "body": "<p>I would like to compare 2 cells' value and see whether they are match or not.\nI know how to do it on excel but I dont' know how to put it vba code.</p>\n\n<p><strong>Input &amp; output:</strong></p>\n\n<ol>\n<li>The value of cell A1 is already in the excel.</li>\n<li>Manually enter a value in Cell B1.</li>\n<li>click on a button_click sub to see whether the value on 2 cells are the same or not.</li>\n<li>Show \"Yes\" or \"No\" on cell C1 </li>\n</ol>\n\n<p><strong>Excel formula:</strong></p>\n\n<pre><code>=IF(A1=B1,\"yes\",\"no\")\n</code></pre>\n"}, {"tags": ["ms-access", "format", "vba", "report"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1421858676, "post_id": 28071451, "comment_id": 44524245, "body": "On the line:  &quot;If pubstrFirstDetaildata &lt;&gt; pubstrLastDetaildata Then&quot;   where are you setting the value of pubstrLastDetaildata prior to that?"}, {"owner": {"reputation": 31, "user_id": 4478981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148da1470a60daa620ba874394c50cc9?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan Hayes", "link": "https://stackoverflow.com/users/4478981/morgan-hayes"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1421859652, "post_id": 28071451, "comment_id": 44524930, "body": "That is my mistake i have not set the value of pubstrLastDetaildata for the the first run through. and i do not get an error. i would not think that would cause the main issue do you?"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1421863214, "post_id": 28071451, "comment_id": 44526890, "body": "I don&#39;t see anything that acts as a loop.  You&#39;ve stepped through the code and have seen it process more than once?"}], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1421865270, "creation_date": 1421865270, "answer_id": 28074341, "question_id": 28071451, "link": "https://stackoverflow.com/questions/28071451/format-event-of-detail-band-executes-more-than-once-per-row/28074341#28074341", "title": "Format event of Detail band executes more than once per row", "body": "<blockquote>\n  <p>Why is it looking at the data more than once?</p>\n</blockquote>\n\n<p>As suggested by the <code>FormatCount</code> parameter in the argument list, the <code>Format</code> event of the <code>Detail</code> band can fire more than once for a given row in the Record Source depending on what happens as the report is being rendered. For example, if the report has one or more Groups defined and one of those groups has \"Keep Together\" enabled then one possibility might be that</p>\n\n<ul>\n<li>the <code>Format</code> event fires the first time for a given row,</li>\n<li>as the report continues to render, subsequent rows can cause the group to spill over onto the next page, so</li>\n<li>the report starts a new page and \"backs up\" to the beginning of the group to <code>Format</code> those rows again.</li>\n</ul>\n\n<p>If you want to ensure that the code in the <code>Format</code> event is only executed once per row then you can put it inside an <code>If FormatCount = 1 Then</code> block.</p>\n"}], "owner": {"reputation": 31, "user_id": 4478981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148da1470a60daa620ba874394c50cc9?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan Hayes", "link": "https://stackoverflow.com/users/4478981/morgan-hayes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1421865405, "creation_date": 1421855689, "last_edit_date": 1421865405, "question_id": 28071451, "link": "https://stackoverflow.com/questions/28071451/format-event-of-detail-band-executes-more-than-once-per-row", "title": "Format event of Detail band executes more than once per row", "body": "<p>This my code to alternately color rows when the data changes.\nAs i was researching an anomaly where a line did not change where it should i found that Access is looking at the each line more than once. </p>\n\n<p>Why is it looking at the data more than once?</p>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n\nDim test As String\n\nIf IsNull(Text158.Value) Then\n    pubstrFirstDetaildata = \"\"\nElse\n    pubstrFirstDetaildata = Text158.Value\nEnd If\n\nIf pubstrFirstDetaildata &lt;&gt; pubstrLastDetaildata Then\n    backcolorCount = backcolorCount + 1\n    If backcolorCount Mod 2 = 1 Then\n        Me.Detail.BackColor = Val(\"&amp;H\" &amp; \"EDEDED\")\n        Me.Box160.BackColor = Val(\"&amp;H\" &amp; \"EDEDED\")\n    Else\n        Me.Detail.BackColor = vbWhite\n        Me.Box160.BackColor = vbWhite\n    End If\n\nEnd If\n\nIf IsNull(Text158.Value) Then\n    pubstrLastDetaildata = \"\"\nElse\n    pubstrLastDetaildata = Text158.Value\nEnd If\nText177 = backcolorCount\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4357, "user_id": 4152992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hjdth.jpg?s=128&g=1", "display_name": "Florian Schmidinger", "link": "https://stackoverflow.com/users/4152992/florian-schmidinger"}, "edited": false, "score": 0, "creation_date": 1421853958, "post_id": 28070653, "comment_id": 44520837, "body": "What do you mean by Automation?"}, {"owner": {"reputation": 659, "user_id": 2502511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c47afe6ea5176ebe6e6618776971351?s=128&d=identicon&r=PG", "display_name": "ignotus", "link": "https://stackoverflow.com/users/2502511/ignotus"}, "edited": false, "score": 0, "creation_date": 1421854204, "post_id": 28070653, "comment_id": 44521054, "body": "What does your vba code do?"}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421854688, "post_id": 28070653, "comment_id": 44521449, "body": "My VBA code allows the user to input certain dates and runs SQL Queries tailored to the info they input."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1421856080, "post_id": 28070653, "comment_id": 44522486, "body": "Like a search query? Those aren&#39;t automatic. There is some code in your VBA that captures a user event (like a button click) and executes a query. The same applies but the query now pulls from sql server instead of access."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421858599, "post_id": 28071617, "comment_id": 44524190, "body": "I have added a snippet of my code in the edit. Basically it deletes all records in a previously created table and then inserts new ones based on the information provided by the user.  Would this be possible in .Net?"}, {"owner": {"reputation": 4357, "user_id": 4152992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hjdth.jpg?s=128&g=1", "display_name": "Florian Schmidinger", "link": "https://stackoverflow.com/users/4152992/florian-schmidinger"}, "reply_to_user": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421861199, "post_id": 28071617, "comment_id": 44525836, "body": "you can implement these statement with a little effort (SQL dialect is off by a little, pretty sure you can find references on the differences on the web) into stored procedures and hook those in using Entity Framework. (Recommended on mass update/insert/delete operations)"}, {"owner": {"reputation": 4357, "user_id": 4152992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hjdth.jpg?s=128&g=1", "display_name": "Florian Schmidinger", "link": "https://stackoverflow.com/users/4152992/florian-schmidinger"}, "reply_to_user": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421861482, "post_id": 28071617, "comment_id": 44526004, "body": "If you use the reports of access much id recommend using a access frontend though. Learning curve on Forms (either Winforms or WPF) should not pose much of a problem"}], "tags": [], "owner": {"reputation": 4357, "user_id": 4152992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hjdth.jpg?s=128&g=1", "display_name": "Florian Schmidinger", "link": "https://stackoverflow.com/users/4152992/florian-schmidinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1421856539, "last_edit_date": 1421856539, "creation_date": 1421856099, "answer_id": 28071617, "question_id": 28070653, "link": "https://stackoverflow.com/questions/28070653/automate-sql-queries/28071617#28071617", "title": "Automate SQL Queries", "body": "<p>Whereas Access is a DBMS with an integrated Frontend (Forms,Reports), SQL-Server is a pure DBMS. You can define table valued functions like you can in Access however you have to do everything in SQL. SQL-Server is way more powerfull than Access overall. Multiuser access to begin with. However you have to make a Frontend for the users, for example .net c# WPF with Entity Framework.</p>\n\n<p>With you allready an expert in Visual Basic, VB.net would also be an option.</p>\n\n<p>Or use Access as Frontend and use ADO or DAO to get the data from the sql-server database. You could also connect Access via ODBC. However I don't recommend that on a large scale application.</p>\n"}, {"tags": [], "owner": {"reputation": 633, "user_id": 3702761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a54650e837f566e40b74e893d4ef47a4?s=128&d=identicon&r=PG&f=1", "display_name": "DB101", "link": "https://stackoverflow.com/users/3702761/db101"}, "is_accepted": false, "score": 0, "last_activity_date": 1421856318, "creation_date": 1421856318, "answer_id": 28071679, "question_id": 28070653, "link": "https://stackoverflow.com/questions/28070653/automate-sql-queries/28071679#28071679", "title": "Automate SQL Queries", "body": "<p>If your tables have already been migrated to SQL Server you need to do the following:\nDelete all the tables in your Access Database (take a backup first!).</p>\n\n<p>Link your SQL Server tables back into Access. They should have the same name and structure as the original tables prior to migration.</p>\n\n<p>If they do not have the same name and structure, then you will have to create views and link these.</p>\n\n<p>Your existing code should then hopefully work as all the objects that it expects to exist, now do.</p>\n"}], "owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "closed_date": 1421858577, "accepted_answer_id": 28071617, "answer_count": 2, "score": -3, "last_activity_date": 1594645578, "creation_date": 1421853579, "last_edit_date": 1594645578, "question_id": 28070653, "link": "https://stackoverflow.com/questions/28070653/automate-sql-queries", "closed_reason": "Needs more focus", "title": "Automate SQL Queries", "body": "<p>I have an access database that I want to transfer over to a SQL server database.  But I have a program in VBA that I still want to utilize in the SQL database.  Is there a way to automate SQL queries like VBA does in access? Any help would be greatly appreciated.</p>\n\n<p>Edit:</p>\n\n<p>Here is a snippet of my VBA code.  </p>\n\n<pre><code>deleteVerifTable = \"DELETE * FROM VerifiedFormularies\"\n\nverifiedForm = \"INSERT INTO VerifiedFormularies ([CLIENT ID], [CLIENT NAME], [MARKET SEGMENT], [FORMULARY ID], [FORMULARY NAME], [FORMULARY VERSION], [APPROVAL STATE], [ARCHIVED]) \" &amp; _\n\"SELECT DD.[CLIENT ID], DD.[CLIENT NAME], DD.[MARKET SEGMENT], DD.[FORMULARY ID], DD.[FORMULARY NAME], DD.[FORMULARY VERSION], DD.[APPROVAL STATE], [ARCHIVED] \" &amp; _\n\"FROM \" &amp; tableName &amp; \" as DD \" &amp; _\n\"Where DD.[APPROVAL STATE] IN (\"\"APPROVED AND PUBLISHED\"\", \"\"APPROVED\"\", \"\"APPROVED WITH CHANGES\"\", \"\"APPROVED WITH POSTED CHANGES\"\") \" &amp; _\n\"AND DD.[Client ID] NOT IN (SELECT Exclusions.[Client ID] FROM Exclusions)\" &amp; _\n\"AND DD.[ARCHIVED] NOT IN(\"\"YES\"\")\" &amp; _\n\"AND DD.[CLIENT ID] NOT IN(SELECT Exclusions.[Client ID] FROM Exclusions)\" &amp; _\n\"AND YEAR(DD.[APPROVED DATE]) &gt;= \" &amp; year &amp; \" AND MONTH(DD.[APPROVED DATE]) &gt; 1 AND DAY(DD.[APPROVED DATE]) &gt; 1\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1421851696, "post_id": 28070031, "comment_id": 44519380, "body": "these type of question has been asked before. Please search the site or/and google"}, {"owner": {"reputation": 267, "user_id": 1552146, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/v7ca3.png?s=128&g=1", "display_name": "smt", "link": "https://stackoverflow.com/users/1552146/smt"}, "edited": false, "score": 1, "creation_date": 1421851791, "post_id": 28070031, "comment_id": 44519443, "body": "Already searched it but cannot find an answer exactly valid for me, and I am not a vba expert."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1421852175, "post_id": 28070031, "comment_id": 44519722, "body": "Make sure <code>c</code> actually finds something, it might be that <code>licensePlate</code> is not found where you look it for. Set a watcher into <code>c</code> and run the code in debug to see what it is after the statement <code>Set c = ...</code>."}, {"owner": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 0, "creation_date": 1421852375, "post_id": 28070031, "comment_id": 44519842, "body": "Open &quot;Locals Window&quot;, so you can see if your variables are not empty (<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264148(v=office.15).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>)."}, {"owner": {"reputation": 267, "user_id": 1552146, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/v7ca3.png?s=128&g=1", "display_name": "smt", "link": "https://stackoverflow.com/users/1552146/smt"}, "edited": false, "score": 0, "creation_date": 1421852394, "post_id": 28070031, "comment_id": 44519853, "body": "I did it already before the creation of this thread and exactly the column named &quot;licensePlate&quot; is not found, but it exists in the file. The macro does not select the column. It&#39;s strange...the headername is correct =/"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421852772, "post_id": 28070031, "comment_id": 44520099, "body": "Did you read my answer?  I don&#39;t think your <code>.Find</code> is referring to the correct Range.  You need to DEFINE the area you want to search in."}, {"owner": {"reputation": 267, "user_id": 1552146, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/v7ca3.png?s=128&g=1", "display_name": "smt", "link": "https://stackoverflow.com/users/1552146/smt"}, "edited": false, "score": 0, "creation_date": 1421853608, "post_id": 28070031, "comment_id": 44520614, "body": "How exactly should I define the area?"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1421853926, "last_edit_date": 1495540257, "creation_date": 1421852278, "answer_id": 28070242, "question_id": 28070031, "link": "https://stackoverflow.com/questions/28070031/run-time-error-1004-method-range-of-object-global-failed/28070242#28070242", "title": "Run-time error 1004 - Method &#39;Range&#39; of object&#39;_Global&#39; failed", "body": "<p>You <code>.Find</code> doesn't seem to be referring to a Range because you are not using a <code>With Range</code>.  Therefore, <code>c</code> is being set to <code>Nothing</code> and when you try to <code>Offset</code> a <code>Nothing Range</code> you will get the error.</p>\n\n<p>You need to use an error check like</p>\n\n<pre><code>If c is Nothing Then\n    Msgbox \"licensePlate Not Found\"\nElse\n    'Run Code\nEnd If\n</code></pre>\n\n<p>If you want to search a whole sheet you could use something like:</p>\n\n<pre><code>Set c = Workbooks(\"options.xlsx\").Sheets(\"name of sheet\").Cells.Find(\"licensePlate\", LookIn:=xlValues)\nIf c is Nothing Then\n    Msgbox \"licensePlate Not Found\"\nElse\n    'Run Code\nEnd If\n</code></pre>\n\n<p>Also, I would highly recommend you avoid <code>Activate</code>.  Instead, you should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">always define the object that you are using a method on</a>.</p>\n\n<p>Edit:  You aren't defining your Sheet for the <code>Range</code> either:</p>\n\n<p>Something like this should work:</p>\n\n<pre><code>Dim ws1 as Worksheet, Dim c As Range\nSet ws1 = Workbooks(\"options.xlsx\").Sheets(\"name of sheet\")\nSet c = ws1.Cells.Find(\"licensePlate\", LookIn:=xlValues)\nIf c is Nothing Then\n    Msgbox \"licensePlate Not Found\"\nElse\n    ws1.Range(c.Offset(1, 0), c.End(xlDown)).Copy\n    ThisWorkbook.Sheets(\"example\").Range(\"BS6\").PasteSpecial Paste:=xlPasteValues\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 267, "user_id": 1552146, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/v7ca3.png?s=128&g=1", "display_name": "smt", "link": "https://stackoverflow.com/users/1552146/smt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5177, "favorite_count": 0, "accepted_answer_id": 28070242, "answer_count": 1, "score": 0, "last_activity_date": 1555645468, "creation_date": 1421851667, "last_edit_date": 1555645468, "question_id": 28070031, "link": "https://stackoverflow.com/questions/28070031/run-time-error-1004-method-range-of-object-global-failed", "title": "Run-time error 1004 - Method &#39;Range&#39; of object&#39;_Global&#39; failed", "body": "<p>I'd like to get the data of A and B columns inside <code>.xlsx</code> file, and paste them in the active <code>Workbook</code>, in both <code>BS</code> and <code>BT</code> columns, starting at row 6.</p>\n\n<p>This is the code I've been using in other parts of the macro:</p>\n\n<pre><code>Workbooks.Open ThisWorkbook.Path &amp; \"\\..\\macro\\options.xlsx\"\n\nWorkbooks(\"options.xlsx\").Activate\nSet c = .Find(\"licensePlate\", LookIn:=xlValues)\nRange(c.Offset(1, 0), Range(c.Address).End(xlDown)).Copy\nThisWorkbook.Activate\nSheets(\"example\").Activate\nRange(\"BS6\").PasteSpecial Paste:=xlPasteValues\n\nWorkbooks(\"options.xlsx\").Activate\nSet c = .Find(\"description\", LookIn:=xlValues)\nRange(c.Offset(1, 0), Range(c.Address).End(xlDown)).Copy\nThisWorkbook.Activate\nSheets(\"example\").Activate\nRange(\"BT6\").PasteSpecial Paste:=xlPasteValues\n\nWorkbooks(\"options.xlsx\").Close\n\nThisWorkbook.Activate\n</code></pre>\n\n<p>It worked in all of the macro content except on this portion of code. It fails at line 5, which is:</p>\n\n<p><code>(Range(c.Offset(1, 0), Range(c.Address).End(xlDown)).Copy)</code></p>\n"}, {"tags": ["r", "excel", "vba", "webbrowser-control", "shiny"], "comments": [{"owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "edited": false, "score": 0, "creation_date": 1423084414, "post_id": 28069993, "comment_id": 45010209, "body": "-2 vs 2 favorite, ergo help me to improve my question"}], "answers": [{"comments": [{"owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "edited": false, "score": 0, "creation_date": 1422278933, "post_id": 28145274, "comment_id": 44673216, "body": "I accept only MS compatible solutions, due to the fact this solution should serve for end users, Shiny Server is now not available on Windows platform"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "edited": false, "score": 6, "creation_date": 1422309382, "post_id": 28145274, "comment_id": 44690309, "body": "Then you should have said so in your question @Qbik."}, {"owner": {"reputation": 15629, "user_id": 1133019, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/464c24cdefccd3ef5033c12e1522b9bc?s=128&d=identicon&r=PG", "display_name": "Jeff Allen", "link": "https://stackoverflow.com/users/1133019/jeff-allen"}, "edited": false, "score": 1, "creation_date": 1422326320, "post_id": 28145274, "comment_id": 44695804, "body": "You can consider VirtualBox to run Shiny Server on Windows. Alternatively, you could create your own proxy using the SockJS package we use in Shiny Server."}], "tags": [], "owner": {"reputation": 15629, "user_id": 1133019, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/464c24cdefccd3ef5033c12e1522b9bc?s=128&d=identicon&r=PG", "display_name": "Jeff Allen", "link": "https://stackoverflow.com/users/1133019/jeff-allen"}, "is_accepted": false, "score": -1, "last_activity_date": 1422251055, "creation_date": 1422251055, "answer_id": 28145274, "question_id": 28069993, "link": "https://stackoverflow.com/questions/28069993/embedding-local-shiny-web-application-into-excel-file/28145274#28145274", "title": "Embedding local shiny web application into Excel file", "body": "<p>Could you consider using <a href=\"http://www.rstudio.com/products/shiny/shiny-server/\" rel=\"nofollow\">Shiny Server</a> to host the Shiny applications? Shiny Server provides compatibility with products that don't support WebSockets (like IE 8). I'm not sure if that's the issue with \"Microsoft Web Control\" or not, though.</p>\n"}], "owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 737, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1422568545, "creation_date": 1421851544, "last_edit_date": 1422568545, "question_id": 28069993, "link": "https://stackoverflow.com/questions/28069993/embedding-local-shiny-web-application-into-excel-file", "title": "Embedding local shiny web application into Excel file", "body": "<p>I've tried to embed <code>shiny</code> page into Excel using Excel <code>Microsoft Web Control</code>, buttons, text etc. was displayed correctly, but no plot have been displayed, that not suprised me because of Web Socket issue with IE7/8 on which <code>Microsoft Web Control</code> is based. I wonder if there is any other way to directly embed <code>shiny</code> web application into Excel file. I found no Firefox based Web Controls, there is Geckofx project, but compiling it into ActiveX control is out of my scope of skills. Embedding <code>shiny</code> into Excel would be very useful for me because I would not need any new technology to deliver results for my internal firm clien except Excel and R. </p>\n\n<p>If I put shiny web application into Excel file, all I would need is some additional VBA based wrapper for uploading data into it from spreadsheet directly, that gives me complete solution for building R based extensions for Excel which looks very good, and are easy to handle (more front-end oriented) in comparison to DDE or RExcel based solutions. R would run simply as local process on user machine.</p>\n\n<p><strong>Edition</strong>\nSolution should work under Windows operating system, its version is irrelevant.</p>\n"}, {"tags": ["excel", "vba", "sql-server-2008", "stored-procedures", "ado"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1421849656, "creation_date": 1421849656, "answer_id": 28069340, "question_id": 28069011, "link": "https://stackoverflow.com/questions/28069011/paramater-not-supplied-error-when-executing-stored-procedure/28069340#28069340", "title": "Paramater Not Supplied Error when Executing Stored Procedure", "body": "<p>You need to add:</p>\n\n<pre><code>oCM.NamedParameters = True\n</code></pre>\n\n<p>before assigning the parameters, otherwise they're actually being passed by position.</p>\n"}], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "accepted_answer_id": 28069340, "answer_count": 1, "score": 1, "last_activity_date": 1594153335, "creation_date": 1421848692, "last_edit_date": 1594153335, "question_id": 28069011, "link": "https://stackoverflow.com/questions/28069011/paramater-not-supplied-error-when-executing-stored-procedure", "title": "Paramater Not Supplied Error when Executing Stored Procedure", "body": "<p>I'm trying to execute a stored procedure (SQL Server 2008) using ADO through Excel 2007 VBA. When executing the stored procedure, I'm receiving the following error: <code>Procedure or function 'crl_GetData' expects parameter '@StartDate', which was not supplied.</code></p>\n\n<p>I am supplying the parameters using the <code>ADODB.Command</code> method like so:</p>\n\n<pre><code>Public Function fGetMI(strStart As String, strEnd As String) As ADODB.Recordset\n\nDim oDB As ADODB.Connection: Set oDB = New ADODB.Connection\nDim oCM As ADODB.Command: Set oCM = New ADODB.Command\nDim oRS As ADODB.Recordset\n\noDB.Open gcConn\n\nWith oCM\n    .ActiveConnection = oDB\n    .CommandType = adCmdStoredProc\n    .CommandText = \"crl_GetData\"\n    .Parameters.Append .CreateParameter(\"@StartDate\", adDate, adParamInput, , strStart)\n    .Parameters.Append .CreateParameter(\"@EndDate\", adDate, adParamInput, , strEnd)\n    Set oRS = .Execute 'Error thrown here'\nEnd With\n\nIf Not oRS.BOF And Not oRS.EOF Then\n    Set fGetMI = oRS\nEnd If\n\noRS.Close\nSet oRS = Nothing\noDB.Close\nSet oDB = Nothing\n\nEnd Function\n</code></pre>\n\n<p>The error is received on the line <code>Set oRS = .Execute</code>.</p>\n\n<p>The stored procedure requires the <code>@StartDate</code> parameter along with the <code>@EndDate</code> parameter and the stored procedure is defined like so:</p>\n\n<pre><code>CREATE PROCEDURE [dbo].[crl_GetData]\n    @TL varchar(128) = null,\n    @Unit varchar(16) = null,\n    @Site varchar(16) = null,\n    @OutcomeId int = null,\n    @Auth varchar(128) = null,\n    @StartDate datetime,\n    @EndDate datetime\nAS\n    BEGIN\n        SELECT\n            [Claim Handler],\n            [Team Leader],\n            [Unit],\n            [Site],\n            [Claim Reference],\n            [Outcome],\n            [Authoriser],\n            [Date]\n\n        FROM\n            crl_all_data\n\n        WHERE\n            [Date] BETWEEN @StartDate AND @EndDate\n            AND (@TL IS NULL OR ([TL_ID] = @TL))\n            AND (@Unit IS NULL OR ([Unit] = @Unit))\n            AND (@Site IS NULL OR ([Site] = @Site))\n            AND (@OutcomeId IS NULL OR ([OUTCOME_ID] = @OutcomeId))\n            AND (@Auth IS NULL OR ([AUTH_ID] = @Auth))\n\n        ORDER BY\n            [Date] ASC\n\n        OPTION(RECOMPILE);\n    END\n\nGO\n</code></pre>\n\n<p>Can anyone help as to why this error is being thrown as I've used this method for executing a stored procedure many times before?</p>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 1, "last_activity_date": 1421848603, "creation_date": 1421848603, "answer_id": 28068987, "question_id": 28068791, "link": "https://stackoverflow.com/questions/28068791/using-excel-vba-saveas-function-to-save-as-pdf-with-user-interaction/28068987#28068987", "title": "Using Excel VBA saveas function to save as PDF with user interaction", "body": "<p>You cannot accomplish this with the <code>Application.Dialogs</code> method, however, you can use the <code>Application.GetSaveAsFilename</code> method with a file filter:</p>\n\n<pre><code>Function SaveAsPDF() As String\n    SaveAsPDF = Application.GetSaveAsFilename(, \"PDF Files (*.PDF), *.PDF\")\n    If (SaveAsPDF = \"False\") Then SaveAsPDF = \"\" 'user cancelled.\nEnd Function\n</code></pre>\n\n<p>This method doesn't actually save anything, so you would have to do something like this:</p>\n\n<pre><code>Dim saveFilePath As String\nsaveFilePath = SaveAsPDF()\n\n'if user didn't cancel...\nIf (Len(saveFilePath) &gt; 0) Then\n    'use whatever third-party technology you are planning to use to save to PDF.\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": true, "score": 2, "last_activity_date": 1421848726, "creation_date": 1421848726, "answer_id": 28069020, "question_id": 28068791, "link": "https://stackoverflow.com/questions/28068791/using-excel-vba-saveas-function-to-save-as-pdf-with-user-interaction/28069020#28069020", "title": "Using Excel VBA saveas function to save as PDF with user interaction", "body": "<p>Try this:</p>\n\n<pre><code>Sub pdf()\nApplication.Dialogs(xlDialogSaveAs).Show \"*.*\", 57\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 1768386, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cd2b5863dc28be9ed682869d1d431d5?s=128&d=identicon&r=PG", "display_name": "Morten Laustsen", "link": "https://stackoverflow.com/users/1768386/morten-laustsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 28069020, "answer_count": 2, "score": 0, "last_activity_date": 1421848726, "creation_date": 1421847989, "question_id": 28068791, "link": "https://stackoverflow.com/questions/28068791/using-excel-vba-saveas-function-to-save-as-pdf-with-user-interaction", "title": "Using Excel VBA saveas function to save as PDF with user interaction", "body": "<p>Firstly - sorry if the title is somewhat confusing. I was not really sure how to title this problem.</p>\n\n<p>I have this really simple vba macro which opens the saveas dialog and prefills filename based on a cell value:    </p>\n\n<pre><code>Sub SaveAsFunction()\n\nIf Sheet1.Range(\"B17\").Value = vbNullString Then\n    MsgBox \"Cell B17 must not be empty\"\n    End\nEnd If\n\nDim fileName As String\nfileName = Sheet1.Range(\"B17\").Value\n\nApplication.Dialogs(xlDialogSaveAs).Show fileName\n\nEnd Sub\n</code></pre>\n\n<p>I've been asked if it's possible to change the \"save as type:\" field to PDF as the dialog opens but NOT save automatically. The enduser needs to navigate to the correct folder first. I've looked around but haven't found any threads explaining this specific issue.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 3382899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/A7fAg.jpg?s=128&g=1", "display_name": "Zakaria Jaiathe", "link": "https://stackoverflow.com/users/3382899/zakaria-jaiathe"}, "edited": false, "score": 0, "creation_date": 1421853521, "post_id": 28069505, "comment_id": 44520553, "body": "I was expecting a method that handle everything automatically because this is a very used functionality. I was trying your solution, it worked so far. I have just to delete some empty placeholder before the Selection. Thanks bro/sis!"}], "tags": [], "owner": {"reputation": 659, "user_id": 2502511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c47afe6ea5176ebe6e6618776971351?s=128&d=identicon&r=PG", "display_name": "ignotus", "link": "https://stackoverflow.com/users/2502511/ignotus"}, "is_accepted": false, "score": 1, "last_activity_date": 1421850225, "creation_date": 1421850225, "answer_id": 28069505, "question_id": 28068555, "link": "https://stackoverflow.com/questions/28068555/get-automatically-the-appropriate-customlayout-in-ppt/28069505#28069505", "title": "Get automatically the appropriate CustomLayout in PPT", "body": "<p>I assume you can use this snippet to start with and add more conditions based on your needs:</p>\n\n<pre><code>Sub SelectSlideLayout(ByVal slideNumber As Integer)\n    Dim hasTitle  As Boolean\n    Dim hasPicture As Boolean\n    Dim hasSubtitle As Boolean\n    Dim sh As Shape\n\n    hasTitle = False\n    hasPicture = False\n    hasSubtitle = False\n\n    With ActivePresentation.Slides(slideNumber)\n\n        For Each sh In .Shapes\n            If sh.PlaceholderFormat.Type = ppPlaceholderCenterTitle Then\n                hasTitle = True\n            ElseIf sh.PlaceholderFormat.Type = ppPlaceholderTitle Then\n                hasTitle = True\n            ElseIf sh.PlaceholderFormat.Type = ppPlaceholderSubtitle Then\n                hasSubtitle = True\n            ElseIf sh.PlaceholderFormat.Type = ppPlaceholderPicture Then\n                hasPicture = True\n            ElseIf sh.PlaceholderFormat.Type = ppPlaceholderBitmap Then\n                hasPicture = True\n            ElseIf sh.PlaceholderFormat.Type = ppPlaceholderObject Then\n                hasPicture = True\n            Else\n                '' TODO: Specify more cases\n            End If\n        Next sh\n\n    End With\n\n    If hasTitle And hasSubtitle Then\n        ActivePresentation.Slides(slideNumber).CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(1)\n    ElseIf hasTitle And hasPicture Then\n        ActivePresentation.Slides(slideNumber).CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(2)\n    Else\n        '' TODO: Specify more cases\n\n        'Default layout\n        ActivePresentation.Slides(slideNumber).CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(1)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 3382899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/A7fAg.jpg?s=128&g=1", "display_name": "Zakaria Jaiathe", "link": "https://stackoverflow.com/users/3382899/zakaria-jaiathe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421850225, "creation_date": 1421847192, "question_id": 28068555, "link": "https://stackoverflow.com/questions/28068555/get-automatically-the-appropriate-customlayout-in-ppt", "title": "Get automatically the appropriate CustomLayout in PPT", "body": "<p>I am still beginner in VBA. I have an existing ppt presentation.\nI would like to load a Template and to match automatically the slide with the appropriate layaout depending on what it contains (image and/or text and/or title).</p>\n\n<p>I am doing it manually right now.</p>\n\n<pre><code>Sub test21()\nCall LoadDesign\n\nActivePresentation.Slides(1).CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(3)\nActivePresentation.Slides(2).CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(7)\nActivePresentation.Slides(3).CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(3)\n\nEnd Sub\n\nSub LoadDesign()\n    ActivePresentation.Designs.Load TemplateName:=\"C:\\myTemplateFile.pot\", Index:=1\nEnd Sub\n</code></pre>\n\n<p>I am using VS2008 and mso2010.\nThanks in advance for your help.</p>\n"}, {"tags": ["vba", "excel", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1422315649, "creation_date": 1422315649, "answer_id": 28160836, "question_id": 28068425, "link": "https://stackoverflow.com/questions/28068425/vba-add-task-to-ms-project-from-excel/28160836#28160836", "title": "VBA - Add task to MS project from Excel", "body": "<p>When you set a task's Start property through code you are actually setting a Constraint Date and Constraint Type in order to drive the calculated Start field. And the date that is supplied has a time component, either explicitly (e.g. 1/26/2015 3:25 PM) or implicitly (e.g. 1/26/2015 12:00 AM).</p>\n\n<p>On the other hand, if you type in a Start date in the user interface and you don't supply a time component, the Default Start Time is added to the date to create the Constraint Date.</p>\n\n<p>What you actually see in a task's Start field depends on these factors that Microsoft Project uses to calculate the date: constraints, predecessor/successor tasks, and calendars (project, task, and resource).</p>\n\n<p>From what you are reporting it appears that your project calendar is set to 7d24h or a similar calendar with working time starting at midnight. So when you set the Start date through code, a constraint date is added with a midnight start time and since the project calendar has that as a working time, the task starts at midnight.</p>\n\n<p>If you want to emulate the user interface method of setting a Start date, use the SetField method:</p>\n\n<pre><code>newproj.Tasks(i - 6).SetField pjTaskStart, strStartDate\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4477645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fffe0ce9c227b63b6140f97ce973b8?s=128&d=identicon&r=PG&f=1", "display_name": "Tomerasu", "link": "https://stackoverflow.com/users/4477645/tomerasu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4095, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1489628706, "creation_date": 1421846793, "question_id": 28068425, "link": "https://stackoverflow.com/questions/28068425/vba-add-task-to-ms-project-from-excel", "title": "VBA - Add task to MS project from Excel", "body": "<p>I am currently opening a project in MS-Project from Excel sheet using VBA. I am also adding tasks, dates, duration and some more data.</p>\n\n<p>My problem is that when I am adding a new task the default start time of the task is not as defined in the project (7:00 am) but 00:00.\nHere is the code i am using:</p>\n\n<pre><code>'Collect data\nstrValue = Worksheets(\"Display\").Range(\"B\" &amp; i)\nstrStartDate = Worksheets(\"Display\").Range(\"G\" &amp; i)\nstrEndDate = Worksheets(\"Display\").Range(\"G\" &amp; i)\nStrresource = Worksheets(\"Display\").Range(\"C\" &amp; i)\nDurTim = CDec(Worksheets(\"Display\").Range(\"E\" &amp; i))\nActDurTim = CDec(Worksheets(\"Display\").Range(\"F\" &amp; i))\n\n'Define project defaults\nnewproj.DefaultStartTime = \"7:00\"\nnewproj.DefaultFinishTime = \"16:00\"\nnewproj.HoursPerDay = \"7\"\n\n'Enter data to task\nnewproj.Tasks.Add (strValue)\n'Check for milestone\nIf Worksheets(\"Display\").Range(\"H\" &amp; i) = \"Y\" Then\n    newproj.Tasks(i - 6).Milestone = False\nEnd If\nnewproj.Tasks(i - 6).Start = strStartDate\nnewproj.Tasks(i - 6).Duration = DurTim &amp; \" hours\"\nnewproj.Tasks(i - 6).ActualDuration = ActDurTim &amp; \"hours\"\nIf i &lt;&gt; 7 Then\n    newproj.Tasks(i - 6).Predecessors = newproj.Tasks(i - 6 - 1)\nEnd If\nIf Not ExistsInCollection(newproj.Resources, Strresource) Then _\nnewproj.Resources.Add.Name = Strresource\nnewproj.Tasks(i - 6).ResourceNames = Strresource\n</code></pre>\n\n<p>I have tried to look in the Ms-Project objects of the tasks and the project itself for a solution but no luck.\nAny help would be grateful.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "edited": false, "score": 0, "creation_date": 1421849878, "post_id": 28069365, "comment_id": 44518209, "body": "it&#39;s actually a game called Minesweeper that I&#39;m working on. I have code to generate numbers and all other stuff. But struggle with this thing."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "edited": false, "score": 0, "creation_date": 1421850170, "post_id": 28069365, "comment_id": 44518380, "body": "Did the code I posted help you at all? If not, how are you defining which range is in table 16x16?"}, {"owner": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "edited": false, "score": 0, "creation_date": 1421850385, "post_id": 28069365, "comment_id": 44518487, "body": "it&#39;s not exactly what I need I think. My &quot;table16x16&quot; is just 16x16 table selected and named that way. I need code to search for integers around and if none found in range of table just mark these cells with a color + integers found (after searching all 8 ways)"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "edited": false, "score": 0, "creation_date": 1421850835, "post_id": 28069365, "comment_id": 44518779, "body": "I think I understand better. The problem is that you&#39;ve got a recursive subroutine with no break designation. You will have to check each <i>IF</i> statement to see if it&#39;s in your range. I will show one example: <code>IF NOT Intersect(myCell.Offset(-1, -1), &quot;table16x16&quot;) is nothing then ClearTheCells(myCell.Offset(-1,-1)</code>"}, {"owner": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "edited": false, "score": 0, "creation_date": 1421860662, "post_id": 28069365, "comment_id": 44525512, "body": "does not work anyway - it&#39;s actually clears in range, but clears full cells as well till left top and at the end I get error message"}, {"owner": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "edited": false, "score": 0, "creation_date": 1421861644, "post_id": 28069365, "comment_id": 44526081, "body": "aniway, I found more efficient way to do it without any codes. I placed any integers or symbols all around the table and make them invisible (Format Cells-&gt;Custom-&gt;;;;). Now it works perfectly fine."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1421849737, "creation_date": 1421849737, "answer_id": 28069365, "question_id": 28068267, "link": "https://stackoverflow.com/questions/28068267/end-if-not-in-range/28069365#28069365", "title": "End IF not in range", "body": "<p>I'm not sure I understand your game, but I think the Intersect method can help resolve the problem. I'm just showing an example of how it works below. Try to modify it to meet your requirements.</p>\n\n<p>In the example below, I set <code>myCell = 11</code>. Next, I checked if <code>myCell</code> is within a range that I defined as cells A1:C10. If not, it gives an error message. Else, it gives a success message</p>\n\n<pre><code>Dim myCell As Range\n\nSet myCell = Range(\"A11\")\n\nIf Intersect(myCell, Range(\"A1:C10\")) Is Nothing Then\n    MsgBox (\"YOU CLICKED OUTSIDE THE TABLE\")\nElse\n    MsgBox (\"ALL GOOD\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4357201, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000155831184/picture?type=large", "display_name": "Dinozauras", "link": "https://stackoverflow.com/users/4357201/dinozauras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421849737, "creation_date": 1421846351, "last_edit_date": 1421846912, "question_id": 28068267, "link": "https://stackoverflow.com/questions/28068267/end-if-not-in-range", "title": "End IF not in range", "body": "<p>I'm creating a game with MS Excel and I need this actions to stop if it's out of my range, which is my table of game called \"table16x16\". Program is if you run the game and click on hidden blank cell then program looks in all 8 ways to find non blank cell (till finds) and then shows them all (I hope it's clear). Aniway, when I click one that has no filled cells around it's goes out of table to search for any and fills cells out of table with colors till the end of sheet (goes up and left till the end). I would like it to end in my \"table16x16\" and stop looking outside. May anyone help me and show me how can I do this?</p>\n\n<p>My code:</p>\n\n<pre><code>Sub ClearTheCells(myCell As Range)\n    myCell.Font.Color = RGB(153, 204, 255)\n    myCell.Interior.Color = RGB(153, 204, 255)\n    myCell.Value = \".\"\n\n    If myCell.Offset(-1, -1) = \"\" Then\n        ClearTheCells myCell.Offset(-1, -1)\n    End If\n\n    If myCell.Offset(0, -1) = \"\" Then\n        ClearTheCells myCell.Offset(0, -1)\n    End If\n\n    If myCell.Offset(1, -1) = \"\" Then\n        ClearTheCells myCell.Offset(1, -1)\n    End If\n\n    If myCell.Offset(-1, -0) = \"\" Then\n        ClearTheCells myCell.Offset(-1, 0)\n    End If\n\n    If myCell.Offset(1, 0) = \"\" Then\n        ClearTheCells myCell.Offset(1, 0)\n    End If\n\n    If myCell.Offset(-1, 1) = \"\" Then\n        ClearTheCells myCell.Offset(-1, 1)\n    End If\n\n    If myCell.Offset(1, 1) = \"\" Then\n        ClearTheCells myCell.Offset(1, 1)\n    End If\n\n    If myCell.Offset(0, 1) = \"\" Then\n        ClearTheCells myCell.Offset(0, 1)\n    End If\n\n    If IsNumeric(myCell.Offset(-1, -1)) Then\n        myCell.Offset(-1, -1).Font.Color = vbBlack\n        myCell.Offset(-1, -1).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(0, -1)) Then\n        myCell.Offset(0, -1).Font.Color = vbBlack\n        myCell.Offset(0, -1).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(1, -1)) Then\n        myCell.Offset(1, -1).Font.Color = vbBlack\n        myCell.Offset(1, -1).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(-1, 0)) Then\n        myCell.Offset(-1, 0).Font.Color = vbBlack\n        myCell.Offset(-1, 0).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(-1, 1)) Then\n        myCell.Offset(-1, 1).Font.Color = vbBlack\n        myCell.Offset(-1, 1).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(1, 1)) Then\n        myCell.Offset(1, 1).Font.Color = vbBlack\n        myCell.Offset(1, 1).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(0, 1)) Then\n        myCell.Offset(0, 1).Font.Color = vbBlack\n        myCell.Offset(0, 1).Interior.Color = RGB(153, 204, 255)\n    End If\n\n    If IsNumeric(myCell.Offset(1, 0)) Then\n        myCell.Offset(1, 0).Font.Color = vbBlack\n        myCell.Offset(1, 0).Interior.Color = RGB(153, 204, 255)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "edited": false, "score": 0, "creation_date": 1421853012, "post_id": 28068198, "comment_id": 44520239, "body": "you could disable the warning messages that the user receives :D"}, {"owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "reply_to_user": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "edited": false, "score": 0, "creation_date": 1421854200, "post_id": 28068198, "comment_id": 44521048, "body": "Well yes, you&#39;re right that would achieve my objective but I was hoping for something a little less brute force!"}, {"owner": {"reputation": 158, "user_id": 1695216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e829d4a30e29518d7546cfcaa7471b7f?s=128&d=identicon&r=PG", "display_name": "Michael Harvey", "link": "https://stackoverflow.com/users/1695216/michael-harvey"}, "edited": false, "score": 1, "creation_date": 1421855626, "post_id": 28068198, "comment_id": 44522143, "body": "You could check for key combination, mouse click, tool bar inputs.  Once you&#39;ve validated that the inputs are the paste function, set some sort of flag then set the focus to the form.  Once the form has focus, check the flag.  If the flag is set, then do what you need to do.  Then unset the flag.  This isn&#39;t so &quot;brute force&quot;, but it is time consuming.  <a href=\"http://www.jkp-ads.com/articles/catchpaste.asp\" rel=\"nofollow noreferrer\">Here&#39;s</a> a link that might be helpful."}, {"owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "edited": false, "score": 0, "creation_date": 1422011156, "post_id": 28068198, "comment_id": 44591028, "body": "That&#39;s not a bad suggestion, hell of a hack though :D It&#39;s a shame there isn&#39;t a AfterPasteConfirm event the same way there&#39;s a AfterDelConfirm. I&#39;m currently working in 2007, but given the choice between turning warnings off, trying to capture paste events manually, or upgrading to 2010 to use &quot;triggers&quot; then I&#39;m going to opt for the latter"}], "answers": [{"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 2, "last_activity_date": 1421884696, "creation_date": 1421884696, "answer_id": 28079133, "question_id": 28068198, "link": "https://stackoverflow.com/questions/28068198/ms-access-after-paste-confirmation-event/28079133#28079133", "title": "MS Access - after Paste confirmation event", "body": "<p>If you use a Data Macros you can achieve this. I set up a table, <code>TestDataTable</code>, that looks like this which will be audited</p>\n\n<p><img src=\"https://i.stack.imgur.com/UNdqf.png\" alt=\"enter image description here\"></p>\n\n<p>and an audit table like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/2eygn.png\" alt=\"enter image description here\"></p>\n\n<p>I added 3 data macros to my <code>TestDataTable</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/OJWfA.png\" alt=\"enter image description here\"></p>\n\n<p>The After Insert looks like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/DM6Zr.png\" alt=\"enter image description here\"></p>\n\n<p>After Update looks like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/Xscmp.png\" alt=\"enter image description here\"></p>\n\n<p>and After Delete looks like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/eHnx8.png\" alt=\"enter image description here\"></p>\n\n<p>Which generates records which looks like this\n<img src=\"https://i.stack.imgur.com/GHyym.png\" alt=\"enter image description here\"></p>\n\n<p>And if you paste data in but click NO on the paste confirmation Access takes care of everything for you. Those records are not added to your main table and no audit records are inserted.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZIyyi.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 1, "accepted_answer_id": 28079133, "answer_count": 1, "score": 3, "last_activity_date": 1421884696, "creation_date": 1421846117, "question_id": 28068198, "link": "https://stackoverflow.com/questions/28068198/ms-access-after-paste-confirmation-event", "title": "MS Access - after Paste confirmation event", "body": "<p>Is it possible to capture an event AFTER the paste confirmation message has been displayed when a user pastes records directly into a datasheet subreport? I need this to be able to log when new records are created in an audit table.</p>\n\n<p>By capturing the Before/After Update and Insert events, I can easily create a collection of records that have been added, ready to insert details into the audit log, however after all these events have fired the user is then prompted to confirm with a \"You are about to paste x record(s)\" message. </p>\n\n<p>So the problem is the user may click \"No\" here, and I can't find any way of capturing this, meaning the insertions could all be captured in the audit log, but as the user cancelled the request the records wouldn't actually exist.</p>\n\n<p>The only way I can think of handling this is to create a temp table to display the existing records, and adding a \"Save\" button to write the temp table back, but running a comparison beforehand to update the audit log. However, this isn't ideal, especially as there is more than one of these tables.</p>\n"}, {"tags": ["vba", "footer", "ms-word", "word-2010"], "answers": [{"comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1421848020, "post_id": 28068788, "comment_id": 44516982, "body": "Also, you might want to add a space between <code>footerText</code>and the date?"}, {"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1421848496, "post_id": 28068788, "comment_id": 44517292, "body": "Good spot, I&#39;d accidently removed <code>Selection.TypeText text:=vbCrLf</code> before outputting the date.  As for your answer it&#39;s working on date but not the <code>footerText</code>, which is now a line above. Thanks."}, {"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 1, "creation_date": 1421849304, "post_id": 28068788, "comment_id": 44517831, "body": "Ah ha, changing <code>wdLine</code> to <code>wdStory</code> does the trick.  Thanks for the help."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1421850512, "post_id": 28068788, "comment_id": 44518560, "body": "OK, great! (I just assumed they were on the same line)"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1421850808, "post_id": 28068788, "comment_id": 44518761, "body": "Right, I&#39;ve updated the answer to include your comment about selecting both lines."}, {"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1421850905, "post_id": 28068788, "comment_id": 44518830, "body": "Well from the code I origianlly posted you would have been correct, it&#39;s just becuase I&#39;d removed that one line by mistake. Thanks again."}], "tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": true, "score": 1, "last_activity_date": 1421850748, "last_edit_date": 1421850748, "creation_date": 1421847979, "answer_id": 28068788, "question_id": 28067599, "link": "https://stackoverflow.com/questions/28067599/change-the-colour-of-text-in-the-footer-of-a-word-document/28068788#28068788", "title": "Change the colour of text in the footer of a Word document", "body": "<p>You need to select the text where you want to change the color first. Try adding the line below, right before the line where you set the color of the text.</p>\n\n<p>It's the equivalent of pressing <kbd>SHIFT</kbd>+<kbd>Home</kbd>:</p>\n\n<pre><code>Selection.HomeKey Unit:=wdLine, Extend:=wdExtend\n\nSelection.Range.Font.ColorIndex = wdGray50                      ' Set the colour of the footer text\n</code></pre>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>If you want to select all of the text in the footer, from where the text is entered to the beginning of the footer (the equivalent of pressing <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>Home</kbd>), use <code>Selection.HomeKey Unit:=wdStory, Extend:=wdExtend</code> instead.</p>\n"}], "owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "accepted_answer_id": 28068788, "answer_count": 1, "score": 0, "last_activity_date": 1421850748, "creation_date": 1421844309, "last_edit_date": 1421848548, "question_id": 28067599, "link": "https://stackoverflow.com/questions/28067599/change-the-colour-of-text-in-the-footer-of-a-word-document", "title": "Change the colour of text in the footer of a Word document", "body": "<p>I'm using VBA to insert some text in to the footer of a document, and I wish to then change the colour of the text.</p>\n\n<p>I've tried using <code>Selection.Range.Font.ColorIndex</code> but this doesn't seem to work. I've also tried manually settings the colour and recording a macro, but VBA doesn't pick up on the colour change.</p>\n\n<p>Does anybody know how I can achieve this? Thanks.</p>\n\n<pre><code>'**\n ' Insert the required text into the footer of the document\n '\n ' @param required String footerText    The text to insert into the document footer\n ' @param Boolean insertDate            Whether or no to insert the date into the document footer\n '*\nSub DoFooterText(ByVal footerText As String, _\n                 Optional ByVal insertDate As Boolean = True)\n\n    Selection.GoTo What:=wdGoToPage, Count:=2                       ' Go to page 2 of the document (no footer on page 1)\n    Selection.MoveRight Unit:=wdCharacter, Count:=1                 ' Move the cursor to the right of the document\n    ActiveWindow.ActivePane.View.SeekView = wdSeekPrimaryFooter     ' Switch the view to the header\n    Selection.TypeText text:=footerText                             ' Insert the footer text\n    If insertDate = True Then                                       ' Insert the date into the footer\n        Selection.TypeText text:=vbCrLf\n        Selection.InsertDateTime _\n            DateTimeFormat:=\"dd/MM/yyyy\", _\n            InsertAsField:=False, _\n            InsertAsFullWidth:=False, _\n            DateLanguage:=wdEnglishUK, _\n            CalendarType:=wdCalendarWestern\n    End If\n    Selection.Range.Font.ColorIndex = wdGray50                      ' Set the colour of the footer text\n    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument      ' Switch the view back to the main document\n    Selection.HomeKey Unit:=wdStory                                 ' Move the cursor back to the top of the document\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 659, "user_id": 2502511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c47afe6ea5176ebe6e6618776971351?s=128&d=identicon&r=PG", "display_name": "ignotus", "link": "https://stackoverflow.com/users/2502511/ignotus"}, "is_accepted": false, "score": 1, "last_activity_date": 1421853888, "creation_date": 1421853888, "answer_id": 28070776, "question_id": 28067584, "link": "https://stackoverflow.com/questions/28067584/find-loop-word-2013/28070776#28070776", "title": ".Find Loop Word 2013", "body": "<p>This should do it</p>\n\n<pre><code>Sub test3()\n    Const STARTTOKEN = \"startoftitle \"\n    Const ENDTOKEN = \" endoftitle\"\n\n    For i = 1 To ThisDocument.Paragraphs.Count\n        If ThisDocument.Paragraphs(i).Range.Style = \"Title\" _\n            And Left(ThisDocument.Paragraphs(i).Range.Text, Len(STARTTOKEN)) &lt;&gt; STARTTOKEN Then\n\n            ThisDocument.Paragraphs(i).Range.Text = STARTTOKEN &amp; ThisDocument.Paragraphs(i).Range.Text &amp; ENDTOKEN\n\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 4478269, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ecd18d0b1d0f95d55f698eb4954e582f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Herald", "link": "https://stackoverflow.com/users/4478269/steve-herald"}, "is_accepted": true, "score": 1, "last_activity_date": 1521454305, "last_edit_date": 1521454305, "creation_date": 1421878619, "answer_id": 28077880, "question_id": 28067584, "link": "https://stackoverflow.com/questions/28067584/find-loop-word-2013/28077880#28077880", "title": ".Find Loop Word 2013", "body": "<p>I managed to solve it before checking what you've written. Thank you for your help!</p>\n\n<p>Here is the code for anyone with the same problem:</p>\n\n<pre><code>Sub test3()\n'\n' test3 Macro\n'\n'\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \" startoftitle \"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchCase = True\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Do While Selection.Find.Execute = True\n        Selection.EndKey Unit:=wdLine\n        Selection.TypeText Text:=\" endoftitle\"\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4478269, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ecd18d0b1d0f95d55f698eb4954e582f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Herald", "link": "https://stackoverflow.com/users/4478269/steve-herald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 28077880, "answer_count": 2, "score": 0, "last_activity_date": 1593883261, "creation_date": 1421844283, "last_edit_date": 1593883261, "question_id": 28067584, "link": "https://stackoverflow.com/questions/28067584/find-loop-word-2013", "title": ".Find Loop Word 2013", "body": "<p>I have a document that has plain text and I want to do some preformatting before I move it to Access. Currently, I'm in Word trying to separate the formatting into titles and text. The document has hundreds of titles and after each title small explanation text (it's an error book with explanations for one machine).</p>\n\n<p>I am trying to put a unique string at the end of a lane that starts with \"start-of-title\" unique string.</p>\n\n<p>I want to make a macro that finds that string, then goes to the end of the lane and writes \" end-of-title\" and do that till there are results found.</p>\n\n<p>What I've done so far, and works once, is the following:</p>\n\n<pre><code>Sub test3()\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"startoftitle \"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = False\n        .MatchCase = True\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\n    Selection.EndKey Unit:=wdLine\n    Selection.TypeText Text:=\" endoftitle\"\nEnd Sub\n</code></pre>\n\n<p>I've tried doing loops, but sadly I wasn't able to do the right syntax. The problem is that I can't make it loop till there are no results found...</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421841957, "post_id": 28066538, "comment_id": 44513363, "body": "I assume you don&#39;t have a sheet in the code workbook whose <b>code name</b> (rather than tab name) is <code>Lookup</code>."}, {"owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421842032, "post_id": 28066538, "comment_id": 44513403, "body": "Tab name is Lookup, what do you mean by code name?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1421842374, "post_id": 28066538, "comment_id": 44513604, "body": "Just on a side note it might be worthwhile replacing the <code>ActiveSheet</code> and explicitly stating which sheet with <code>ThisWorkbook.Sheets(&quot;Data&quot;)</code> instead of using it based on selection - This could cause errors during the workflow. Also can you state which Line this is throwing the error - Step through the code line by line using F8. It might not like how you&#39;re stating the range or your If condition."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421842594, "post_id": 28066538, "comment_id": 44513731, "body": "If the tab name is Lookup, you need to use <code>Sheets(&quot;Lookup&quot;).Range(&quot;I17:K22&quot;)</code> and not <code>Lookup.Range(&quot;I17:K22&quot;)</code>. The code name is a property you can set in the VBE for a sheet so that you can refer to it using the same name no matter what the tab shows."}, {"owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "edited": false, "score": 0, "creation_date": 1421844275, "post_id": 28066538, "comment_id": 44514685, "body": "newVal = Application.WorksheetFunction.VLookup(colC, Lookup.Range(&quot;I17:K22&quot;), 2, False) Is throwing the error"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421845044, "post_id": 28066538, "comment_id": 44515130, "body": "You need to replace the part I mentioned."}, {"owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "edited": false, "score": 0, "creation_date": 1421849114, "post_id": 28066538, "comment_id": 44517702, "body": "I edited the code as advised, the error has gone."}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421850009, "post_id": 28066538, "comment_id": 44518287, "body": "Good catch, @Rory. You should put that down as the answer."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1421850277, "creation_date": 1421850277, "answer_id": 28069531, "question_id": 28066538, "link": "https://stackoverflow.com/questions/28066538/424-object-required-error/28069531#28069531", "title": "424 object required error", "body": "<p>Since Lookup is the tab name and not the code name, you need to use:</p>\n\n<pre><code>newVal = Application.WorksheetFunction.VLookup(colC, Worksheets(\"Lookup\").Range(\"I17:K22\"), 2, False)\n</code></pre>\n"}], "owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 28069531, "answer_count": 1, "score": -1, "last_activity_date": 1421850277, "creation_date": 1421840970, "last_edit_date": 1531161705, "question_id": 28066538, "link": "https://stackoverflow.com/questions/28066538/424-object-required-error", "title": "424 object required error", "body": "<p>I have written this so far, what I am aiming to do is to find the value ORDER31 in column D. If this condition is met I would like the find the corresponding value in the same row but from column C, in this case I have used OFFSET() and placed this value into a variable called colC. I then wish to do a lookup with this value and pull in a new value which I want to assign to newVal. I then wish to assign this newVal to the original cell where ORDER31 was found.</p>\n\n<p>I get a 424 object required error, and I am not sure where I am going wrong?</p>\n\n<pre><code> Sub illHack()\n\n     Sheets(\"Data\").Select\n     Dim colC As String\n     Dim newVal As String\n\n     For Each r In Intersect(ActiveSheet.UsedRange, Range(\"D:D\"))\n         If r.Text = \"ORDER31\" Then\n             colC = r.Offset(0, -1)\n             newVal = Application.WorksheetFunction.VLookup(colC, Lookup.Range(\"I17:K22\"), 2, False)\n             r.Offset(0, 0) = newVal\n         End If\n     Next r\n\n     Sheets(\"Control-Sheet\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1421844209, "post_id": 28066353, "comment_id": 44514651, "body": "I would break this project into a few smaller steps: (1) Transform the &quot;Cities&quot; sheet into a single column of city names, meaning all semicolon-delimited cells have been parsed out and each cell contains exactly one city name. (2) Loop through the &quot;Cities&quot; column of city names, searching for a match on the &quot;Task&quot; sheet. (3) Apply formatting based on whether or not a match is found"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1421845676, "post_id": 28066353, "comment_id": 44515509, "body": "@DanWagner Oh... Buddy Thanks for the reply... I have presented only small portion of the code. My both the sheets have 30+ columns each. among those one is &#39;Cities&#39; and my this question is related to the other question I have asked on stackoverflow.com. Can you see into that also. <a href=\"http://stackoverflow.com/questions/28045505/how-to-validate-hierarchy-of-three-columns-in-excel-vba\">link</a> I have already written the code as u have suggested. But I need a code which shall work in the case where &#39;Cities&#39; sheet has less records than &#39;Task&#39;(If am applying the logic explained above) Or viceversa"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1421845807, "post_id": 28066353, "comment_id": 44515591, "body": "@DanWagner As I have some 40 other types of validations in excelsheet; again breaking the logic into smaller steps going lower performance :("}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1421848558, "post_id": 28066353, "comment_id": 44517339, "body": "It looks like you need to redefine the `LastRow&#39; variable to be used with the Cities sheet. It uses the previously declared LastRow value from the tasks sheet. [Personal Preference]: I sometimes use different variables when I&#39;m identifying the last row for two different sheets. This reduces my confusion. EDIT: Looks like you will need to use two different variables since both sheet&#39;s last rows are being referenced concurrently."}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1421849366, "creation_date": 1421849366, "answer_id": 28069247, "question_id": 28066353, "link": "https://stackoverflow.com/questions/28066353/comparing-records-from-two-columns-with-unequal-lengths/28069247#28069247", "title": "Comparing records from two columns with unequal lengths", "body": "<p>It's not very efficient to loop through a list of values searching for a match. The longer each of the lists becomes, the longer it will take to run the macro. Instead, use the built-in <em>FIND</em> method to search for values. </p>\n\n<p>I've updated the code to show the FIND method in action. Check it out and let me know if this makes sense/works.</p>\n\n<p>(SIDE NOTE): I left a comment above detailing why your initial code wasn't working correctly. You needed a second variable to reference the last row of the cities sheet.</p>\n\n<pre><code>Dim CityString As String\nDim CityArray() As String\n\n'Get the last row\n'Dim lastRow As Integer\nLastRow = Sheets(\"Task\").UsedRange.Rows.Count\nnLastRowSheet2 = Sheets(\"Cities\").UsedRange.Rows.Count\n\nDim c As Range\nDim d As Range\nDim e As Variant\n\n'Turn screen updating off to speed up macro code.\n'User won't be able to see what the macro is doing, but it will run faster.\nApplication.ScreenUpdating = False\n\nFor Each c In Worksheets(\"Task\").Range(\"A2:A\" &amp; LastRow)\n    CityString = c\n    CityArray() = Split(CityString, \";\")\n    For Each e In CityArray()\n        e = Trim(e)\n\n        Dim rngFnder As Range\n        On Error Resume Next\n\n            Set rngFnder = Sheets(\"Cities\").Range(\"A2:A\" &amp; nLastRowSheet2).Find(e)\n\n            If rngFnder Is Nothing Then\n                c.Interior.Color = vbRed\n            End If\n\n        On Error GoTo 0\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1232, "favorite_count": 0, "accepted_answer_id": 28069247, "answer_count": 1, "score": 0, "last_activity_date": 1425841280, "creation_date": 1421840416, "last_edit_date": 1531164843, "question_id": 28066353, "link": "https://stackoverflow.com/questions/28066353/comparing-records-from-two-columns-with-unequal-lengths", "title": "Comparing records from two columns with unequal lengths", "body": "<p>I am doing validation of two columns(with unequal lengths) present on two different sheets of excel.</p>\n\n<p>The first sheet name is 'Task'. Column 'A' of the 'Task' sheet has about 200 City Names. </p>\n\n<p>The second sheet is 'Cities'. Column 'A' of the 'Cities' sheet has about 8000+ City Names. </p>\n\n<p>Now I need to do validation such that the name of City in Column A of 'Task' sheet should be </p>\n\n<ol>\n<li><p>Either one among the City Names specified in column 'A' of sheet 'Cities' </p></li>\n<li><p>Or It can have multiple entries separated with semicolon; after separating all cities based on semicolon each city names shall match with that one in column D of 'Cities' sheet.</p></li>\n<li><p>If not among both the above cases then it should be '<strong>All</strong>'</p></li>\n</ol>\n\n<p>The cells in 'Task' Sheet from which City names do not match are to be turned in Red background</p>\n\n<p>My Code is as follows: (am just giving required part of code)</p>\n\n<pre><code>Dim CityString As String\nDim CityArray() As String\n\n'Get the last row\n'Dim lastRow As Integer\nLastRow = ActiveSheet.UsedRange.Rows.Count\n\n\nDim c As Range\nDim d As Range\nDim e As Variant\n\n'Turn screen updating off to speed up macro code.\n'User won't be able to see what the macro is doing, but it will run faster.\nApplication.ScreenUpdating = False\n\nFor Each c In Worksheets(\"Task\").Range(\"A2:A\" &amp; LastRow).Cells\nCityString = c\nCityArray() = Split(CityString, \";\")\nFor Each e In CityArray()\ne = Trim(e)\n    For Each d In Worksheets(\"Cities\").Range(\"A2:A\" &amp; LastRow).Cells\n        c.Interior.Color = vbRed\n\n        If (UCase(e) = UCase(d) Or c = \"All\") Then\n        c.Interior.Color = vbWhite\n        Exit For\n        End If\n    Next\n    If c.Interior.Color = vbRed Then\n    Exit For\n    End If\nNext\nNext\n</code></pre>\n\n<p>Now, the above code is valid only when both the sheets (Sheet1 - 'Task' and Sheet2 - 'Cities' have equal number of records. If Sheet2 - 'Cities' has more records than the 'Task' Sheet, the above code do not work.</p>\n\n<p>For Example: New York is at 'A55' Cell of 'Task' sheet.\nIt's also there in 'Cities' Sheet at 'A41'. My code validates the cell correctly.</p>\n\n<p>For Example: 'A53' of 'Task' sheet I have 'Tokyo' and 'Task' Sheet has only 200 records, where as 'Tokyo' is present at 'A988' of 'Cities' sheet, which has some 8000+ records, then my code does not validate this cell correctly.</p>\n\n<p>Can anyone give me an alternative code for the same?\nI need code to compare records from two columns with unequal lengths.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1421840576, "post_id": 28066255, "comment_id": 44512547, "body": "Have you tried simply <code>#,##0.00</code>, assuming your regional settings use a space as the thousands separator?"}, {"owner": {"reputation": 10898, "user_id": 40691, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d181288c6d64fa3ab1ffe464e98afd34?s=128&d=identicon&r=PG", "display_name": "wqw", "link": "https://stackoverflow.com/users/40691/wqw"}, "edited": false, "score": 0, "creation_date": 1423946629, "post_id": 28066255, "comment_id": 45356981, "body": "There is no point in putting multiple <code>#</code> in a sequence i.e. <code>#,##0.00</code> =&gt; <code>#,#0.00</code> and <code>##0.00</code> =&gt; <code>#0.00</code> should be the same format."}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 2115756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e9592a9a3403d95d72bb0e8d5f0ed38?s=128&d=identicon&r=PG", "display_name": "vladiz", "link": "https://stackoverflow.com/users/2115756/vladiz"}, "edited": false, "score": 0, "creation_date": 1438623448, "post_id": 28066428, "comment_id": 51514859, "body": "How can I make it not to  display zeros after the point if the number is whole number. For example 1000 instead of 1000.00 , but if there is numbers after the decimal point they should be displayed like 1000.22"}, {"owner": {"reputation": 6762, "user_id": 3014322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16a501f84f3604998ff3cca90e34f8f?s=128&d=identicon&r=PG&f=1", "display_name": "simon at rcl", "link": "https://stackoverflow.com/users/3014322/simon-at-rcl"}, "reply_to_user": {"reputation": 174, "user_id": 2115756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e9592a9a3403d95d72bb0e8d5f0ed38?s=128&d=identicon&r=PG", "display_name": "vladiz", "link": "https://stackoverflow.com/users/2115756/vladiz"}, "edited": false, "score": 0, "creation_date": 1438623633, "post_id": 28066428, "comment_id": 51514968, "body": "You either have decimals or you don&#39;t. Buy you could conditionally change the NumberFormat if the value is an integer/long."}], "tags": [], "owner": {"reputation": 6762, "user_id": 3014322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16a501f84f3604998ff3cca90e34f8f?s=128&d=identicon&r=PG&f=1", "display_name": "simon at rcl", "link": "https://stackoverflow.com/users/3014322/simon-at-rcl"}, "is_accepted": true, "score": 2, "last_activity_date": 1421840645, "creation_date": 1421840645, "answer_id": 28066428, "question_id": 28066255, "link": "https://stackoverflow.com/questions/28066255/set-standard-number-format-with-thousand-separator-2-decimals-and-minus-sign-fo/28066428#28066428", "title": "Set standard number format with thousand separator, 2 decimals and minus sign for negative numbers using VBA?", "body": "<pre><code>rng.NumberFormat = \"# ##0.00:-# ##0.00\"\n</code></pre>\n\n<p>You put the format for positive numbers before : and the format for negative after. You don't need to put hundreds of # signs in the format, just enough to show what the 1000's separator is.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19710, "favorite_count": 1, "accepted_answer_id": 28066428, "answer_count": 1, "score": 2, "last_activity_date": 1421841449, "creation_date": 1421840140, "last_edit_date": 1531164843, "question_id": 28066255, "link": "https://stackoverflow.com/questions/28066255/set-standard-number-format-with-thousand-separator-2-decimals-and-minus-sign-fo", "title": "Set standard number format with thousand separator, 2 decimals and minus sign for negative numbers using VBA?", "body": "<p>I've seen the question asked before on stackoverflow, how to get normal number format with thousand separator and 2 decimals. The answer was to set:</p>\n\n<pre><code>    rng.NumberFormat = \"##0.00\"\n</code></pre>\n\n<p>But this is incomplete, because, at least on my computer, I don't get any space separator between millions and thousands. So I have changed that to:</p>\n\n<pre><code>    rng.NumberFormat = \"### ### ##0.00\"\n</code></pre>\n\n<p>But this is again incomplete, because for some reason negative numbers were formatted to look like they have a space between the minus sign and the number. See below:</p>\n\n<pre><code>- 12.4\n</code></pre>\n\n<p>So, there are some things left to do to arrive at Excels \"built-in\" \"format as number\" formats. Additionally the formatting that I apply though VBA is described as Custom by Excel.</p>\n\n<p>Is there any way to set the format to be the standard built in format as number with thousand separators, 2 decimals and minus signs for negative numbers?</p>\n\n<p>I'm looking for something like:</p>\n\n<pre><code>    rng.NumberFormat = \"Number, 2, minus\"\n</code></pre>\n"}, {"tags": ["excel", "storage", "pivot-table", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1422004128, "last_edit_date": 1422004128, "creation_date": 1421850941, "answer_id": 28069777, "question_id": 28066099, "link": "https://stackoverflow.com/questions/28066099/why-is-my-excel-10-megabytes-large/28069777#28069777", "title": "Why is my Excel 10 Megabytes large?", "body": "<p>When you insert a pivot table on your workbook, <strong>Excel caches the data from the PivotTable.dataSource</strong>. <em>(That is why you need to Refresh your pivot table to incorporate changes in the source data into the pivot table.)</em> </p>\n\n<p>The data cache is less than half as big the as worksheet Range it does cache, but significant. <em>(In my case it added another 2.6MB to the existing 6.5MB and apparently once above 10MB, Excel starts swapping data to disk.)</em></p>\n\n<p>If your source data is on a separate sheet, you can <strong>remove the source sheet, keep your data only in the cache</strong> and save space instead of spoiling it with your pivot tables. <em>(Take care you did_not_uncheck <code>Save data with the file</code>, though)</em> </p>\n\n<p>If you need to edit the data source later on, you can \"drill through\" to the data from the cache by double clicking the grand total on your pivot table.</p>\n\n<p>Read <a href=\"http://nhsexcel.com/massive-excel-spreadsheets-how-to-reduce-the-size-of-pivot-table-workbooks/\" rel=\"nofollow\">Massive Excel Spreadsheets \u2013 How to Reduce the Size of Pivot Table Workbooks</a> for more details.</p>\n\n<p>As a VBA programmer, I must hide all this for my customer, so I wrote</p>\n\n<p><em>code to extract the data and delete the pivot tables</em></p>\n\n<pre><code>Public Sub unpackPivots()\n    On Error GoTo goneWrong\n\n    Dim PSheet As Worksheet, PTable As PivotTable, PBody As Range\n    For Each PSheet In ThisWorkbook.Sheets\n        If PSheet.Name Like \"*Pivot\" Then\n            Set PTable = PSheet.PivotTables(1)\n            PTable.ClearAllFilters\n            Set PBody = PTable.DataBodyRange\n            Set PBody = PBody.Cells(PBody.Rows.Count, PBody.Columns.Count)\n            PSheet.Activate\n            PBody.Select\n            PBody.ShowDetail = True\n            Application.ActiveSheet.Name = Replace(PSheet.Name, \"Pivot\", \"_Data\")\n            Application.DisplayAlerts = False\n            PSheet.Delete\n        End If\n    Next\n    Application.DisplayAlerts = True\n\n    Exit Sub\n</code></pre>\n\n<p>goneWrong:\n        Application.DisplayAlerts = True\n        Debug.Print Err.Number, Err.Description\n        Debug.Assert False\n        Err.Clear\n        Resume\n    End Sub</p>\n\n<p><em>code to create the pivot tables from the data tables and delete the tables</em></p>\n\n<pre><code>Public Sub recreatePivots()\n    On Error GoTo goneWrong\n\n    Dim DSheet As Worksheet, DTable As ListObject\n    Dim PSheet As Worksheet, PCach As PivotCache\n    Dim PTable As PivotTable, PBody As Range\n\n    For Each DSheet In ThisWorkbook.Sheets\n        If DSheet.Name Like \"*_Data\" Then\n            Set PCache = ActiveWorkbook.PivotCaches.Create( _\n                SourceType:=xlDatabase, _\n                sourceData:=DSheet.ListObjects(1).Name, _\n                Version:=xlPivotTableVersion14 _\n            )\n            ThisWorkbook.Sheets.Add Before:=DSheet\n            Set PSheet = Application.ActiveSheet\n            PSheet.Name = Replace(DSheet.Name, \"_Data\", \"_Pivot\")\n\n            Set PTable = PCache.CreatePivotTable( _\n                TableDestination:=PSheet.Name + \"!R3C1\", _\n                DefaultVersion:=xlPivotTableVersion14 _\n            )\n</code></pre>\n\n<p>Here comes your business dependent stuff</p>\n\n<pre><code>            Select Case DSheet.Name\n                Case \"Stock_Data\"\n                    PTable.PivotFields(\"Month\").Orientation = xlPageField\n                    PTable.PivotFields(\"Manufacturer\").Orientation = xlRowField\n                    PTable.PivotFields(\"Warehouse\").Orientation = xlColumnField\n                    PTable.AddDataField PTable.PivotFields(\"Key\"), _\n                        \"Nr of products\", xlSum\n                Case Else\n                    ' Some other configuration of a pivote table\n            End Select\n            DSheet.Delete\n        End If\n    Next\n\n    Exit Sub\ngoneWrong:\n    Application.DisplayAlerts = True\n    Debug.Print Err.Number, Err.Description\n    Debug.Assert False\n    Err.Clear\n    Resume\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1421996758, "answer_count": 1, "score": -1, "last_activity_date": 1422004128, "creation_date": 1421839639, "last_edit_date": 1531161705, "question_id": 28066099, "link": "https://stackoverflow.com/questions/28066099/why-is-my-excel-10-megabytes-large", "closed_reason": "Not suitable for this site", "title": "Why is my Excel 10 Megabytes large?", "body": "<p>My Excel 2010 workbook contains </p>\n\n<p>4 datasheets with a table (i.e. a ListObject)</p>\n\n<ul>\n<li>deliveries, used range $A$1:$T$7647</li>\n<li>stock, used range $A$1:$V$22962</li>\n<li>sales, used range $A$1:$U$2348</li>\n<li>summary, used range $A$1:$AA$9509 (a summary of the life cycle per item, created in VBA) </li>\n</ul>\n\n<p>7 hidden sheets with pivot tables, with on the largest one a used range of $A$1:$CS$37, that refer to the above tables</p>\n\n<p>1 presentation sheet with a used range of $A$1:$X$108, containing 7 tables (ListObjects) with either formulas referring to the pivot tables, or values copied from them in VBA.</p>\n\n<p><strong>Why is my file so huge and what can I do about it?</strong></p>\n\n<p><em>Edits in response to comments from other users:</em></p>\n\n<p>To make sure there are not too much cells I ever touched in the past but do not use any more, I retrieved the above ranges with </p>\n\n<pre><code>For Each sht In ThisWorkbook.Sheets\n    Print sht.Name, sht.UsedRange.Address\nNext\n</code></pre>\n\n<p>So it will not help to copy the data and the code to a new clean workbook.</p>\n\n<p>There are no formulas that refer to a whole column, style <code>=match(\"anything\", A:A)</code> , nor other formulas that refer anything outside the used range.</p>\n\n<p>As I am a VBA developer, any solution should be transparent for the user. This person is not supposed to know about the internals of Excel.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "edited": false, "score": 0, "creation_date": 1421838539, "post_id": 28065567, "comment_id": 44511368, "body": "what do you mean by <code>semi-volatile</code> please? neither <code>sum</code>, <code>index</code> nor <code>rows</code> seem to be volatile as per <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">decisionmodels.com/calcsecretsi.htm</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "edited": false, "score": 0, "creation_date": 1421838671, "post_id": 28065567, "comment_id": 44511451, "body": "@Aprillion I&#39;ve added a clarification. It&#39;s actually mentioned in the link you posted under the &#39;Volatile only at Workbook Open&#39; section."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1421838620, "last_edit_date": 1421838620, "creation_date": 1421838063, "answer_id": 28065567, "question_id": 28065252, "link": "https://stackoverflow.com/questions/28065252/repeat-a-specific-excel-formula-pattern-down-column/28065567#28065567", "title": "repeat a specific excel formula pattern down column", "body": "<p>Here's one way. In P2 enter:</p>\n\n<p><code>=SUM(OFFSET(INDEX(C:C,(ROWS($A$1:$A1)-1)*6+2),0,0,6))</code></p>\n\n<p>and then copy that across and down as required. This is volatile due to the use of OFFSET which shouldn't be a problem with a small data set like this, but if your real data is bigger and you have more formulas, you may prefer:</p>\n\n<p><code>=SUM(INDEX(C:C,(ROWS($A$1:$A1)-1)*6+2):INDEX(C:C,(ROWS($A$1:$A1)-1)*6+7))</code></p>\n\n<p>which is only semi-volatile. (i.e. it will recalculate whenever the workbook is opened, even if its inputs haven't changed)</p>\n"}], "owner": {"reputation": 29, "user_id": 4477300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1540523858/picture?type=large", "display_name": "Patrick Handcock", "link": "https://stackoverflow.com/users/4477300/patrick-handcock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6771, "favorite_count": 0, "accepted_answer_id": 28065567, "answer_count": 1, "score": 0, "last_activity_date": 1526428134, "creation_date": 1421837256, "last_edit_date": 1531161705, "question_id": 28065252, "link": "https://stackoverflow.com/questions/28065252/repeat-a-specific-excel-formula-pattern-down-column", "title": "repeat a specific excel formula pattern down column", "body": "<p>I'm not an excel whiz but really stuck on this one and hoping a guru out there will be able to help me out as it's really important for some research I am doing - please!! I think it will be quite a simple fix (see attached example excel sheet for context below). If you are even able to modify the formula in question and re-attach that would be awesome too!!</p>\n\n<p>There are 2 datasets in sheet 1 side-by-side. The data on left (rows A to K) displays data in 10 sec time epochs, the data on right (rows N to X) in 1 min time epochs. I would like to be able to drag the formula in P2 all the way down the column P based on data in column C (as per colour coding in red and blue).</p>\n\n<p>You'll note that the P2 formula is taking a SUM of C2-C7 and P3 is taking sum of C8-C13. I would like to be able to continue this pattern down the column, perhaps with a better drag-down formula (or more efficiently \u2013 as there is loads of data!) if possible. Essentially I want each single data row on the right to move onto the next block of 6 rows from data on the left. </p>\n\n<p>I hope I explained that well enough. Really hoping someone can help! Really important to me!</p>\n\n<p>Patrick</p>\n\n<p>See attached excel example - thanks so much!! I will be ever grateful!</p>\n\n<p><a href=\"https://www.dropbox.com/s/72r7ty9v15vzyyv/drag%20formula%20quick%20way%20-%20help.xlsx?dl=0\" rel=\"nofollow\">https://www.dropbox.com/s/72r7ty9v15vzyyv/drag%20formula%20quick%20way%20-%20help.xlsx?dl=0</a> </p>\n"}, {"tags": ["vba", "excel", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4477645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fffe0ce9c227b63b6140f97ce973b8?s=128&d=identicon&r=PG&f=1", "display_name": "Tomerasu", "link": "https://stackoverflow.com/users/4477645/tomerasu"}, "edited": false, "score": 0, "creation_date": 1421841205, "post_id": 28064524, "comment_id": 44512936, "body": "When looking across the web I understood that the code i have written was supposed to handle the error. After testing, your suggestion works good."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1421835148, "creation_date": 1421835148, "answer_id": 28064524, "question_id": 28064485, "link": "https://stackoverflow.com/questions/28064485/excel-vba-error-when-creating-ms-project/28064524#28064524", "title": "Excel VBA error when creating MS Project", "body": "<p>You don't have any code that handles that error (at least not that you posted). One way is:</p>\n\n<pre><code>Dim pjapp As Object\nOn Error Resume Next\nSet pjapp = CreateObject(\"MSProject.Application\")\nOn Error Goto 0\n\nIf pjapp Is Nothing Then\n    MsgBox \"Project is not installed\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4477645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fffe0ce9c227b63b6140f97ce973b8?s=128&d=identicon&r=PG&f=1", "display_name": "Tomerasu", "link": "https://stackoverflow.com/users/4477645/tomerasu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 28064524, "answer_count": 1, "score": 0, "last_activity_date": 1427200203, "creation_date": 1421835040, "last_edit_date": 1427200203, "question_id": 28064485, "link": "https://stackoverflow.com/questions/28064485/excel-vba-error-when-creating-ms-project", "title": "Excel VBA error when creating MS Project", "body": "<p>when I create an an \"MS Project\" object in excel i try to use this code to check if the object was created:</p>\n\n<pre><code>Dim pjapp As Object\n\nSet pjapp = CreateObject(\"MSProject.Application\")\n\nIf pjapp Is Nothing Then\n    MsgBox \"Project is not installed\"\nEnd If\n</code></pre>\n\n<p>I keep getting:</p>\n\n<p>\"Run-time error '429':\nActivX component can't create object\"</p>\n\n<p>although i have a code that suppose to handle this kind of problem.</p>\n\n<p>I searched for a solution but didn't find any.\nThanks for the help.</p>\n"}, {"tags": ["excel", "vba", "activexobject"], "comments": [{"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421834430, "post_id": 28063725, "comment_id": 44508841, "body": "Would it be <code>...Slider21.Fill.BackColor</code>?"}, {"owner": {"reputation": 947, "user_id": 3398398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f794a17e52fc07b84d1fbd7cffd4319?s=128&d=identicon&r=PG&f=1", "display_name": "cybujan", "link": "https://stackoverflow.com/users/3398398/cybujan"}, "reply_to_user": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421836528, "post_id": 28063725, "comment_id": 44510166, "body": "It doesn&#39;t seem to be working either..."}], "answers": [{"tags": [], "owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "is_accepted": true, "score": 0, "last_activity_date": 1421841544, "creation_date": 1421841544, "answer_id": 28066723, "question_id": 28063725, "link": "https://stackoverflow.com/questions/28063725/is-it-possible-to-change-background-colour-and-other-visual-attributes-of-slider/28066723#28066723", "title": "Is it possible to change background colour and other visual attributes of Slider Control in Excel (via VBA or otherwise)?", "body": "<p>Sorry cybujan, doesn't look as though the slider control has any colour properties within VBA, although it does have a <code>Background</code> property in the vb.net version, see <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.slider_properties(v=vs.110).aspx\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.control.background(v=vs.110).aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><img src=\"https://i.stack.imgur.com/MiYNx.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 947, "user_id": 3398398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f794a17e52fc07b84d1fbd7cffd4319?s=128&d=identicon&r=PG&f=1", "display_name": "cybujan", "link": "https://stackoverflow.com/users/3398398/cybujan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 28066723, "answer_count": 1, "score": 1, "last_activity_date": 1421841544, "creation_date": 1421832767, "last_edit_date": 1421836489, "question_id": 28063725, "link": "https://stackoverflow.com/questions/28063725/is-it-possible-to-change-background-colour-and-other-visual-attributes-of-slider", "title": "Is it possible to change background colour and other visual attributes of Slider Control in Excel (via VBA or otherwise)?", "body": "<p>I have been trying to change sliders' background color using VBA:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Dashboard\").Slider21.BackColor = \"xxxxx\"\n</code></pre>\n\n<p>but have an error saying <code>Object doesn't support this property or method</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1864610"}, "edited": false, "score": 0, "creation_date": 1421832002, "post_id": 28063442, "comment_id": 44507431, "body": "<a href=\"https://stackoverflow.com\">Stack Overflow</a> is not a free coding service. What is the problem you&#39;re having doing this?"}, {"owner": {"reputation": 4964, "user_id": 2622016, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/224fcc10727bc8adf8a64f548abd9b6b?s=128&d=identicon&r=PG", "display_name": "user2622016", "link": "https://stackoverflow.com/users/2622016/user2622016"}, "edited": false, "score": 0, "creation_date": 1421832258, "post_id": 28063442, "comment_id": 44507576, "body": "Hi Patrik, please take a while and look at <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1421842882, "post_id": 28063539, "comment_id": 44513880, "body": "Just to add use <code>Dim wk as worksheet</code> at the beginning of this. and @Patrik get explicitly state your ranges instead of using <code>.select</code> It will speed up your code so much more. This can generally be done for example by replacing the select and selection and making it one line so <code>Columns(&quot;A:D&quot;).Select &#47; Selection.Copy</code> becomes <code>Columns(&quot;A:D&quot;).copy</code>"}], "tags": [], "owner": {"reputation": 700, "user_id": 1208630, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/QBADm.jpg?s=128&g=1", "display_name": "bunny1985", "link": "https://stackoverflow.com/users/1208630/bunny1985"}, "is_accepted": true, "score": 1, "last_activity_date": 1421832204, "creation_date": 1421832204, "answer_id": 28063539, "question_id": 28063442, "link": "https://stackoverflow.com/questions/28063442/i-have-recorded-a-macro-now-i-want-it-to-loop-throw-all-worksheets-and-not-writ/28063539#28063539", "title": "I have recorded a macro, now i want it to loop throw all worksheets and not write the code 30 times, can someone help me", "body": "<p>just simple loop: You can do it for example like this:</p>\n\n<pre><code>Sub RUN()\nFor Each wk In ThisWorkbook.Worksheets\nwk.Activate\n    Test\nNext wk\nEnd Sub\n</code></pre>\n\n<p>add :</p>\n\n<pre><code>Set wk = ActiveSheet\n</code></pre>\n\n<p>in the begining on Test Macro</p>\n\n<p>and use wk instead of Sheets(\"Sheet1\")\nfor example \ninstead of </p>\n\n<pre><code>Sheets(\"test\").Select Columns(\"A:D\").Select\n</code></pre>\n\n<p>this </p>\n\n<pre><code>wk.Select Columns(\"A:D\").Select\n</code></pre>\n\n<p>Please fix formating in this question.</p>\n"}], "owner": {"reputation": 41, "user_id": 2181994, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4f50fdee80574380d43eb7994f6bbe8c?s=128&d=identicon&r=PG", "display_name": "Patrik Frid", "link": "https://stackoverflow.com/users/2181994/patrik-frid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 28063539, "answer_count": 1, "score": -1, "last_activity_date": 1421857336, "creation_date": 1421831892, "last_edit_date": 1421857336, "question_id": 28063442, "link": "https://stackoverflow.com/questions/28063442/i-have-recorded-a-macro-now-i-want-it-to-loop-throw-all-worksheets-and-not-writ", "title": "I have recorded a macro, now i want it to loop throw all worksheets and not write the code 30 times, can someone help me", "body": "<pre><code>Sub Test()\n'\n' Test Macro\n'\n\n'\n    Sheets(\"test\").Select\n    Columns(\"A:D\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    ActiveSheet.Paste\n    Sheets(\"test\").Select\n    Columns(\"E:E\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"G1\").Select\n    ActiveSheet.Paste\n    Sheets(\"test\").Select\n    Columns(\"J:K\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"H1\").Select\n    ActiveSheet.Paste\n    Sheets(\"test\").Select\n    Columns(\"O:O\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"J1\").Select\n    ActiveSheet.Paste\n    Rows(\"1:4\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\n    Rows(\"1:1\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"Product_Id\"\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"Category\"\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"Brand\"\n    Range(\"D1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"Model\"\n    Range(\"E1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"EAN\"\n    Range(\"F1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"UPC\"\n    Range(\"G1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"SKU\"\n    Range(\"H1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"Supplier_Shop_Price\"\n    Range(\"I1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"In_Voice\"\n    Range(\"J1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    ActiveCell.FormulaR1C1 = \"In_Stock\"\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421831974, "post_id": 28063329, "comment_id": 44507419, "body": "I don&#39;t think your array looks like you think it does. Unless you have an <code>Option Base 1</code> statement, your array dimensions are 0 to 5, not 1 to 5."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421832193, "post_id": 28063329, "comment_id": 44507535, "body": "even in the case, it should be 1 not 3. Not sure why it is 3."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1421832326, "post_id": 28063329, "comment_id": 44507616, "body": "How do you figure that? Your array is actually <code>(0,-2500,-1250,0,1250,2500)</code> since you didn&#39;t populate the first element and you are looking for an <i>exact match</i>."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1421833348, "post_id": 28063329, "comment_id": 44508210, "body": "Aside from <code>Option Base 1</code>, you can be explicitly in the dimension of your array: <code>Dim vol(1 to NoOfVol) As Integer</code>"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421838915, "post_id": 28063329, "comment_id": 44511581, "body": "And you can check bounds with <code>Ubond</code> and <code>Lbound</code>."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421839947, "post_id": 28063329, "comment_id": 44512155, "body": "@Rory please add your comment as answer. Will mark it right."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1421840416, "creation_date": 1421840416, "answer_id": 28066354, "question_id": 28063329, "link": "https://stackoverflow.com/questions/28063329/getting-the-index-of-item-in-an-array-vba/28066354#28066354", "title": "Getting the index of item in an array VBA", "body": "<p>Your array is actually effectively declared as:</p>\n\n<pre><code>Dim vol(0 to NoOfVol) As Integer\n</code></pre>\n\n<p>unless you have an <code>Option Base 1</code> statement. Since your loop goes from 1 to 5, you never populate the first element of the array and it retains its default value of 0. Therefore your array is actually:</p>\n\n<pre><code>(0,-2500,-1250,0,1250,2500)\n</code></pre>\n\n<p>and since you are looking for an <em>exact</em> match, -1250 is found at the third position.</p>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1787, "favorite_count": 0, "accepted_answer_id": 28066354, "answer_count": 1, "score": 1, "last_activity_date": 1421840416, "creation_date": 1421831505, "last_edit_date": 1421832745, "question_id": 28063329, "link": "https://stackoverflow.com/questions/28063329/getting-the-index-of-item-in-an-array-vba", "title": "Getting the index of item in an array VBA", "body": "<p>I am trying to get the index of the item in an array VBA, but I have issue getting it.</p>\n\n<pre><code>Const NoOfVol As Integer = 5\nDim vol(NoOfVol) As Integer\nFor Index = 1 To NoOfVol\n   vol(Index) = Cells(15 + Index, 8).Value\nNext\n</code></pre>\n\n<p>The array looks like this: (-2500,-1250,0,1250,2500). I am calling the function this way.</p>\n\n<pre><code>Function Find(ByVal Value As Variant, arr As Variant) As Integer\n    Find = Application.Match(Value, arr, False)\nEnd Function\nposOfVol = Find(-1250, vol)\n</code></pre>\n\n<p>But the posOfVol = 3, when it should be 2. Not sure where my error is. Need some guidance on this.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6123, "user_id": 2670182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MzRYh.jpg?s=128&g=1", "display_name": "Cool Blue", "link": "https://stackoverflow.com/users/2670182/cool-blue"}, "edited": false, "score": 1, "creation_date": 1421895196, "post_id": 28065359, "comment_id": 44539688, "body": "&quot;You are not looking for a collection, but for a dictionary.&quot; Why do you say that?  The second part of your answer is the solution but I&#39;m curious about the first part. Why not use a Collection."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1421918951, "last_edit_date": 1421918951, "creation_date": 1421837518, "answer_id": 28065359, "question_id": 28062826, "link": "https://stackoverflow.com/questions/28062826/assign-an-array-to-a-collection/28065359#28065359", "title": "Assign an array to a collection", "body": "<p>You are not looking for a collection, but for a dictionary. </p>\n\n<ol>\n<li><p>Add <code>Microsoft Scripting Runtime</code> to your references (Tools/References);</p></li>\n<li><p>Slightly revise your code using a dictionary instead of a collection:</p>\n\n<pre><code>Sub test()\n   Dim C As New Scripting.Dictionary '&lt;-- not collection\n   Dim A() As String\n\n   ReDim A(0, 1)\n   A(0, 0) = \"row 0, col 0\"\n   A(0, 1) = \"row 0, col 1\"\n\n   C.Add \"first\", A '&lt;-- key first, item then\n\n   Debug.Print C(\"first\")(0, 0) &amp; \", \" &amp; C(\"first\")(0,1) &lt;-- you need to access the elements properly (bi-dimensional)\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>As for the error (\"subscript out of range\"), it depends on a bad use of the array. You define it as <code>A(0 to 0, 0 to 1)</code> so you cannot use it as if it was uni-dimensional. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4087080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 28065359, "answer_count": 1, "score": -1, "last_activity_date": 1594645574, "creation_date": 1421829662, "last_edit_date": 1594645574, "question_id": 28062826, "link": "https://stackoverflow.com/questions/28062826/assign-an-array-to-a-collection", "title": "Assign an array to a collection", "body": "<p>From the code it's very easy to see what I want, but nothing works so far:</p>\n\n<pre><code>Sub test()\n    Dim C As New Collection\n    Dim A() As String\n\n    ReDim A(0, 1)\n    A(0, 0) = \"row 0, col 0\"\n    A(0, 1) = \"row 0, col 1\"\n\n    C.Add A(0), \"first\" ' subscript out of range error\n\n    Debug.Print C.Item(\"first\")(0) &amp; \", \" &amp; C.Item(\"first\")(1)\nEnd Sub\n</code></pre>\n\n<p>So, I just want to have an array as a member of a collection.</p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["vba", "dictionary"], "answers": [{"tags": [], "owner": {"reputation": 1011, "user_id": 3770161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f161c5406dcf4b139b8ffdcace6ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Fumu 7", "link": "https://stackoverflow.com/users/3770161/fumu-7"}, "is_accepted": true, "score": 4, "last_activity_date": 1421831040, "creation_date": 1421831040, "answer_id": 28063196, "question_id": 28062329, "link": "https://stackoverflow.com/questions/28062329/how-to-check-whether-a-item-not-the-key-exists-in-the-dictionary-vba/28063196#28063196", "title": "How to check whether a item (not the key) exists in the dictionary VBA", "body": "<p>You may misunderstand about 'Dictionary' of VBA.</p>\n\n<p>You can not get 'key' by 'value', but can get 'value' by 'key'.</p>\n\n<p>In your code, Curr has indices(integer) as 'key's and currency as 'value's.  This is why you can't determine that \"USD\" is included in the dictionary 'Curr'.</p>\n\n<p>If you want to check \"USD\" exist in cells in E column or not, you should use currency as 'key's.</p>\n\n<p>Following code may be what you want and you can get right answer by using 'IsInArray(\"USD\", Curr)' .</p>\n\n<pre><code>Set Curr = CreateObject(\"Scripting.Dictionary\")\nFor Index = 1 To NoOfCurr\n    Curr.Add Cells(15 + Index, 5).Value, Index 'currency is used as keys.\nNext\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    IsInArray = arr.Exists(stringToBeFound)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5886, "favorite_count": 1, "accepted_answer_id": 28063196, "answer_count": 1, "score": 1, "last_activity_date": 1421831040, "creation_date": 1421827673, "last_edit_date": 1421828002, "question_id": 28062329, "link": "https://stackoverflow.com/questions/28062329/how-to-check-whether-a-item-not-the-key-exists-in-the-dictionary-vba", "title": "How to check whether a item (not the key) exists in the dictionary VBA", "body": "<p>I would like to check whether a specific value exists in a dictionary. I have created a dictionary as such:</p>\n\n<pre><code>Set Curr = CreateObject(\"Scripting.Dictionary\")\nFor Index = 1 To NoOfCurr\n   Curr.Add Index, Cells(15 + Index, 5).Value\nNext\n</code></pre>\n\n<p>I need to check whether a string exists in the dictionary. I have written a code as such:</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  IsInArray = arr.Exists(stringToBeFound)\nEnd Function\n</code></pre>\n\n<p>And it gets called as such: \n<code>IsInArray(\"USD\", Curr)</code> and it returns a false.</p>\n\n<p>I am using Exists function, but it is returning me a False. How do I change IsInArray to see whether the USD is in the Currency dictionary?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4476999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e3AvB0_ZJ-4/AAAAAAAAAAI/AAAAAAAAABA/d7wCsNTC54A/photo.jpg?sz=128", "display_name": "Gangadevi rampelli", "link": "https://stackoverflow.com/users/4476999/gangadevi-rampelli"}, "edited": false, "score": 0, "creation_date": 1421826951, "post_id": 28061339, "comment_id": 44505096, "body": "Private Sub CommandButton21_Click() Dim rng As String On Error GoTo ErrorHandler ErrorHandler: Set rng = ExcelApplication.Columns(&quot;A:A&quot;).EntireColumn For i = 1 To A For j = 1 To A Select Case IsEmpty(rng)       Case True         Sheets(&quot;Sheet2&quot;).Cells(2, 3) = &quot;Row &quot; &amp; i &amp; &quot; Column &quot; &amp; k End Select    End Sub &#39;I have changed the code but its giving object is required"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4476999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e3AvB0_ZJ-4/AAAAAAAAAAI/AAAAAAAAABA/d7wCsNTC54A/photo.jpg?sz=128", "display_name": "Gangadevi rampelli", "link": "https://stackoverflow.com/users/4476999/gangadevi-rampelli"}, "edited": false, "score": 0, "creation_date": 1421824915, "post_id": 28061493, "comment_id": 44504283, "body": "Private Sub CommandButton21_Click() On Error GoTo ErrorHandler   &#39; Enable error-handling routine.     Dim LastCol As Long   Dim LastRow As Long   Dim rng As Range, iLength As Integer   LastCol = ActiveSheet.UsedRange.Columns.Count   LastRow = ActiveSheet.UsedRange.Rows.Count ErrorHandler: Set rng = ActiveSheet.Range(&quot;A1:A&quot; &amp; h) Select Case IsEmpty(rng)       Case True         iLength = Len(rng)         If iLength &gt; 10 Then             MsgBox rng.Address &amp; &quot;has exceeded the limit. the lenth shold be less than 10&quot;         End If End Select   End Sub I&#39;ve editd code but its gvg appn defined error"}, {"owner": {"reputation": 1, "user_id": 4476999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e3AvB0_ZJ-4/AAAAAAAAAAI/AAAAAAAAABA/d7wCsNTC54A/photo.jpg?sz=128", "display_name": "Gangadevi rampelli", "link": "https://stackoverflow.com/users/4476999/gangadevi-rampelli"}, "edited": false, "score": 0, "creation_date": 1421834008, "post_id": 28061493, "comment_id": 44508587, "body": "for the first line itself"}, {"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "reply_to_user": {"reputation": 1, "user_id": 4476999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e3AvB0_ZJ-4/AAAAAAAAAAI/AAAAAAAAABA/d7wCsNTC54A/photo.jpg?sz=128", "display_name": "Gangadevi rampelli", "link": "https://stackoverflow.com/users/4476999/gangadevi-rampelli"}, "edited": false, "score": 0, "creation_date": 1421835831, "post_id": 28061493, "comment_id": 44509734, "body": "Please specify the line."}], "tags": [], "owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1421824353, "creation_date": 1421824353, "answer_id": 28061493, "question_id": 28061339, "link": "https://stackoverflow.com/questions/28061339/promt-message-for-error-fields/28061493#28061493", "title": "Promt message for error fields", "body": "<p>Check this line of your code, I think this might be causing error:</p>\n\n<pre><code>Set rng = ActiveSheet.Range(\"A1:A&amp;h\")\n</code></pre>\n\n<p>Instead use this:</p>\n\n<pre><code>Set rng = ActiveSheet.Range(\"A1:A\" &amp; h)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4476999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e3AvB0_ZJ-4/AAAAAAAAAAI/AAAAAAAAABA/d7wCsNTC54A/photo.jpg?sz=128", "display_name": "Gangadevi rampelli", "link": "https://stackoverflow.com/users/4476999/gangadevi-rampelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421826393, "creation_date": 1421823607, "last_edit_date": 1421823914, "question_id": 28061339, "link": "https://stackoverflow.com/questions/28061339/promt-message-for-error-fields", "title": "Promt message for error fields", "body": "<p>I wrote this code and its giving error.<br>\nI want to prompt error msg for the cells which are having errors.</p>\n\n<pre><code>Public Sub OnErrorDemo()\n    On Error GoTo ErrorHandler\n    Dim LastCol As Long\n    Dim LastRow As Long\n    Dim rng As Range, iLength As Integer\n    LastCol = ActiveSheet.UsedRange.Columns.Count\n    LastRow = ActiveSheet.UsedRange.Rows.Count\n\nErrorHandler:\n    For h = 1 To Range(\"A60\").End(xlUp).Row\n        Set rng = ActiveSheet.Range(\"A1:A&amp;h\")\n        Select Case IsEmpty(rng)\n        Case True\n            MsgBox rng.Address &amp; \" is empty\"\n        Case Else\n            Select Case IsNumeric(rng)\n            Case True\n                MsgBox rng.Address &amp; \" has a numeric value\"\n                Select Case rng.HasFormula\n                Case True\n                    MsgBox rng.Address &amp; \" also has a formula\"\n                End Select\n            Case Else\n                iLength = Len(rng)\n                MsgBox rng.Address &amp; \" has a Text length of \" &amp; iLength\n            End Select\n        End Select\n    Next h\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "outlook", "qtp"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1421819359, "post_id": 28060246, "comment_id": 44502162, "body": "How did you setup the trigger? Most likely you can refer to any item in Outlook using <code>.EntryID</code>. If you use application level event trigger to execute the macro, have a read on <a href=\"http://www.slipstick.com/developer/processing-incoming-e-mails-with-macros/\" rel=\"nofollow noreferrer\">slipstick.com/developer/processing-incoming-e-mails-with-mac&zwnj;&#8203;ros</a>"}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421828601, "post_id": 28060246, "comment_id": 44505734, "body": "The mail is the trigger. Automation engineer sends an email in order to start the test suite execution. The mail will have a particular subject e.g. \u2018RunQTPMasterDriverScript\u2019 and an attachment which contains path of the test scripts and run indicator. A rule in Outlook is created to monitor the inbox and call the macro when a mail with subject as \u2018RunQTPMasterDriverScript\u2019 is arrived. The macro should download the attachment, move the mail from one folder to another ."}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421828966, "post_id": 28060246, "comment_id": 44505895, "body": "I want the macro to download the attachment and move the mail from one folder to another. How can this be achieved? Any kind of help is highly appreciated."}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421829144, "post_id": 28060246, "comment_id": 44505976, "body": "My intention was if we can directly reference the mail which triggered the macro, we don&#39;t have to go through the entire email collection of the inbox to search the mail with the particular subject &#39;RunQTPMasterDriverScript&#39;. I hope you are getting my point."}, {"owner": {"reputation": 4198, "user_id": 355294, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa7eb1d4b0091c5ca00178f0ce8f9e?s=128&d=identicon&r=PG", "display_name": "TheBlastOne", "link": "https://stackoverflow.com/users/355294/theblastone"}, "edited": false, "score": 0, "creation_date": 1421837110, "post_id": 28060246, "comment_id": 44510542, "body": "What have you done so far in code regarding the receiving side? The event on the receiving side is the &quot;trigger&quot; that PatricK asked for."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421878152, "post_id": 28060246, "comment_id": 44534466, "body": "@JdevKamath What you have setup sounds like a Rule in Outlook to run a macro when certain conditions are met. Bare in mind that this only works if your Outlook session is running and there isn&#39;t any issue with it. I have macros that work in similar way. And yes, once you have the mail item, you can save all attachments, move it to a sub folder in your mailbox (to indicate it has been processed), etc. I will respond some code when I have free time today. I don&#39;t have QTP, how do you execute it?"}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421903908, "post_id": 28060246, "comment_id": 44541914, "body": "@PatricK I am running a VBScript to configure and launch the QTP. I have given the code in description that I am currently using but I have no idea whether it is working fine or not! Whenever I try to run the code, VBA is telling me to create a new macro. I guess this is happening due to the parameter that is passed. Do you have any idea what&#39;s going wrong here?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421850661, "post_id": 28067839, "comment_id": 44518660, "body": "mail as Outlook.MailItem - In this statement does the &#39;mail&#39; refer to the mail item which triggered the macro?"}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421904766, "post_id": 28067839, "comment_id": 44542162, "body": "Thanks a lot for your reply! I have given the code in description that I am currently using but I have no idea whether it is working fine or not! Whenever I try to run the code, VBA is telling me to create a new macro. I guess this is happening due to the parameter that is passed. Do you have any idea what&#39;s going wrong here?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1421845116, "creation_date": 1421845116, "answer_id": 28067839, "question_id": 28060246, "link": "https://stackoverflow.com/questions/28060246/how-to-reference-the-mail-which-triggered-the-outlook-macro/28067839#28067839", "title": "How to reference the mail which triggered the outlook macro?", "body": "<p>You just need to define a VBA macro sub which accepts a MailItem as a parameter. The source object will be passed to the sub and you don't need to search it in the Inbox folder. For example:</p>\n\n<pre><code>Public Sub Text(mail as Outlook.MailItem)\n    ' do something with the mail object\nEnd Sub\n</code></pre>\n\n<p>You can access attachments using the <em>Attachments</em> property of the MailItem class. The <em>Move</em> method allows to move the item to another folder. </p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421904724, "post_id": 28081710, "comment_id": 44542153, "body": "Thanks a lot for your reply!   Why do we need cscript? Can&#39;t we a VBS file using WShell object through the macro? And whenever I try to run the code, VBA is telling me to create a new macro. I guess this is happening due to the parameter that is passed. Do you have any idea what&#39;s going wrong here?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421905529, "post_id": 28081710, "comment_id": 44542402, "body": "Since I don&#39;t know whats in the vbs file, if it ever uses wscript.echo, cscript will display it and let the code running. wscript however, will pause until OK is pressed. You cannot have 2 Subs of the same name. Add &quot;_Rule&quot; to the new one."}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421907580, "post_id": 28081710, "comment_id": 44542964, "body": "Okay. Is there something that I can do to associate the macro with the rule (and activate the rule) when the outlook restarts or will it be associated automatically?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421908512, "post_id": 28081710, "comment_id": 44543278, "body": "Once you have setup the Outlook Rule, it is activated until Outlook decides that the macro has an error."}, {"owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421916238, "post_id": 28081710, "comment_id": 44546551, "body": "Just one more question, any idea how do I point to the &#39;Inbox&#39; under personal folder? Mailbox - Jai dev  -Deleted items -Draft -Inbox -Junk Email -Outbox -Sent Item Personal Folders -Deleted items -Draft -Inbox -Junk Email -Outbox -Sent Item Mailbox - Bill Jobs -Deleted items -Draft -Inbox -Junk Email -Outbox -Sent Item"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "edited": false, "score": 0, "creation_date": 1421970757, "post_id": 28081710, "comment_id": 44577090, "body": "Check the example out. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863652(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1421903848, "creation_date": 1421903848, "answer_id": 28081710, "question_id": 28060246, "link": "https://stackoverflow.com/questions/28060246/how-to-reference-the-mail-which-triggered-the-outlook-macro/28081710#28081710", "title": "How to reference the mail which triggered the outlook macro?", "body": "<p>Two steps to skip checking the whole Inbox until a match. Keep yours just in case you need to run it manually for the first matching item.</p>\n\n<p>1) Add code below (altered to use cscript.exe):</p>\n\n<pre><code>Sub TestSuiteInitialilzer_Rules(ByRef oMail As MailItem)\n    Const FileName = \"C:\\Email Attachments\\\"\n    For Each Atmt In oMail.Attachments\n        'Download the attachment\n        Atmt.SaveAsFile FileName &amp; Atmt.Filename\n    Next Atmt\n    ' Move the Mail to objDestFolder\n    oMail.Move objDestFolder\n    'launchQTP = \"C:\\Unlock.vbs\"\n    launchQTP = \"cscript.exe //nologo C:\\Unlock.vbs\"\n    Set objShell = CreateObject(\"WScript.Shell\")\n    'QTP will be launched with the neccassary configurations through the vb script\n    objShell.Run launchQTP\n    Set objShell = Nothing\nEnd Sub\n</code></pre>\n\n<p>2) Add Outlook Rule (Apply rule on messages I receive) on top of your existing one. Better to turn off your existing one.</p>\n\n<p><img src=\"https://i.stack.imgur.com/sP2cW.png\" alt=\"OutlookRule\"></p>\n"}], "owner": {"reputation": 53, "user_id": 4466798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rcA5iCF6eDg/AAAAAAAAAAI/AAAAAAAAAGQ/Uu4zJC8Gm5U/photo.jpg?sz=128", "display_name": "Jdev Kamath", "link": "https://stackoverflow.com/users/4466798/jdev-kamath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 2, "accepted_answer_id": 28081710, "answer_count": 2, "score": 0, "last_activity_date": 1421904259, "creation_date": 1421818244, "last_edit_date": 1421904259, "question_id": 28060246, "link": "https://stackoverflow.com/questions/28060246/how-to-reference-the-mail-which-triggered-the-outlook-macro", "title": "How to reference the mail which triggered the outlook macro?", "body": "<p>I am designing a QTP framework which in which the automation engineer sends an email in order to start the test suite execution (The email can be scheduled using MS Outlook)</p>\n\n<p>As soon as the trigger mail is received, the <strong>attachment should be downloaded</strong> and QTP should be launched (automatically) using appropriate settings by the Outlook Macro</p>\n\n<p>But in the above scenario <strong>I want to download the attachment of the mail and move the mail to a different folder which triggered the macro.</strong></p>\n\n<p>Is there any way to reference the mail which triggered the macro?</p>\n\n<p>Currently this is what I am doing.     </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub TestSuiteInitialilzer(mail As Outlook.MailItem)\r\n    Set ns = Application.GetNamespace(\"MAPI\")\r\n    Set Inbox = ns.GetDefaultFolder(olFolderInbox)\r\n    Set objDestFolder = Inbox.Folders(\"RAN\")\r\n    FileName = \"C:\\Email Attachments\\\" &amp; mail.Attachments.Item.FileName\r\n    'Download the attachment\r\n    Atmt.SaveAsFile FileName\r\n    'Move the mail to another folder\r\n    mail.Move objDestFolder\r\n    launchQTP = \"C:\\Unlock.vbs\"\r\n    Set objShell = CreateObject(\"WScript.Shell\")\r\n    \u2018Launch QTP\r\n    objShell.Run launchQTP  \r\n    objShell = Nothing\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "dictionary"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421819532, "post_id": 28059610, "comment_id": 44502219, "body": "Have a read on <a href=\"https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx</a> (Dictionary Object)"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421823189, "post_id": 28059610, "comment_id": 44503523, "body": "Dictionary? Then you must read this : <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">Dictionary VBA</a>. If you still have questions (which I doubt after reading this), then post your code. Above question is already answered in the link posted."}], "answers": [{"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421823531, "post_id": 28059712, "comment_id": 44503684, "body": "I agree to this one. I always use <i>Early Bind</i> during development. Then revert to late binding if only necessary after the code is tried and tested +1."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1421817688, "last_edit_date": 1421817688, "creation_date": 1421815168, "answer_id": 28059712, "question_id": 28059610, "link": "https://stackoverflow.com/questions/28059610/how-to-retrieve-the-value-in-a-dictionary-based-on-key-in-vba/28059712#28059712", "title": "How to retrieve the value in a Dictionary based on key in VBA", "body": "<p>You're getting exactly what you asked for: when you added the items, you specified <code>Cells(15 + Index, 4)</code> for a <em>Key</em>, and <code>Index</code> for an <em>Item</em>. <code>Index</code> being an <code>Integer</code>, you're getting an <code>Integer</code>.</p>\n\n<p>If possible, add a reference to <code>Microsoft Scripting Runtime</code> instead of late-binding with <code>CreateObject</code>: you'll get IntelliSense, which makes it much easier to work with an unfamiliar API:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1q2Cc.png\" alt=\"Add(Key,Item) tooltip\"></p>\n\n<p>Your code would look like this:</p>\n\n<pre><code>Set Desk = New Dictionary\nFor Index = 1 To NoOfDesks\n   Desk.Add Index, Cells(15 + Index, 4).Value\nNext\n</code></pre>\n\n<p>One thing to note, is that dictionary keys must be unique - you're [un]lucky to not have duplicates in column 4, otherwise it would be quite apparent that you have inverted the dictionary's key and value.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1421817533, "post_id": 28059878, "comment_id": 44501570, "body": "This will blow up if <code>Cells(15 + Index, 4)</code> has any duplicate values. OP wants the <b>values</b>, not the keys."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1421818355, "post_id": 28059878, "comment_id": 44501819, "body": "@retailcoder I know that if values will be not uniq then error will apear, but question was how to retrieve the value based on a key. So I suppose that my example will show it, how values and key can be retrieved. Thks for downvote"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1421818678, "post_id": 28059878, "comment_id": 44501936, "body": "I downvoted because this answer addresses the symptom, not the cause; that makes it misleading and leaves OP with code that only <i>seems</i> to work as intended. I will happily revert my vote if it is edited to better explain the implications. Cheers!"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": -1, "last_activity_date": 1421816139, "creation_date": 1421816139, "answer_id": 28059878, "question_id": 28059610, "link": "https://stackoverflow.com/questions/28059610/how-to-retrieve-the-value-in-a-dictionary-based-on-key-in-vba/28059878#28059878", "title": "How to retrieve the value in a Dictionary based on key in VBA", "body": "<p>try this:</p>\n\n<pre><code>Sub test()\n    Dim Desk As Object, NoOfDesks&amp;, Index&amp;, Key As Variant\n    Set Desk = CreateObject(\"Scripting.Dictionary\")\n\n    NoOfDesks = 100\n\n    For Index = 1 To NoOfDesks\n       Desk.Add Cells(15 + Index, 4).Value, Index\n    Next\n    For Each Key In Desk\n        Debug.Print Key, Desk(Key)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15552, "favorite_count": 0, "accepted_answer_id": 28059712, "answer_count": 2, "score": 1, "last_activity_date": 1421817688, "creation_date": 1421814380, "question_id": 28059610, "link": "https://stackoverflow.com/questions/28059610/how-to-retrieve-the-value-in-a-dictionary-based-on-key-in-vba", "title": "How to retrieve the value in a Dictionary based on key in VBA", "body": "<p>I have a dictionary as such:</p>\n\n<pre><code>Set Desk = CreateObject(\"Scripting.Dictionary\")\nFor Index = 1 To NoOfDesks\n   Desk.Add Cells(15 + Index, 4).Value, Index\nNext\n</code></pre>\n\n<p>I am interested in getting the value based on the index. I tried doing this:</p>\n\n<pre><code>MsgBox Desk.Items()(1)\n</code></pre>\n\n<p>But I am not able to get the Value. It is returning a integer. It should be a string. Need some guidance on this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1421832830, "post_id": 28059442, "comment_id": 44507918, "body": "Read <a href=\"https://social.technet.microsoft.com/Forums/en-US/b8f0af82-0bb8-4799-aa62-1dbcbc5b7742/excel-2010-macros-does-not-work-after-updates-9dec2014?forum=excel\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/en-US/&hellip;</a> especially the last post from Hans Vogelaar. This means: All users which computers have installed the update in December 2014, that changed the behavior of ActiveX controls, have to delete the *.exd files from their user profiles. You have already done so, but the user on the other computer has not."}, {"owner": {"reputation": 281, "user_id": 3818716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/896ab148a720107cdfcf61b8e242fb67?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/3818716/filippo"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1421859302, "post_id": 28059442, "comment_id": 44524722, "body": "I let him do it as well, but it was still not working."}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 4466402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7139b7ab17ebd71a9387eb4a6fd1c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Kellner", "link": "https://stackoverflow.com/users/4466402/lucas-kellner"}, "is_accepted": false, "score": 0, "last_activity_date": 1421824687, "creation_date": 1421824687, "answer_id": 28061565, "question_id": 28059442, "link": "https://stackoverflow.com/questions/28059442/macro-not-responding-on-different-computer/28061565#28061565", "title": "Macro not responding on different computer", "body": "<p>This may be too simple a suggestion, but have you checked the security settings in Excel?  The other computers may be set to a higher security setting that disables all macros without notifying the user.</p>\n\n<p><a href=\"https://support.office.com/en-US/Article/Enable-or-disable-macros-in-Office-documents-7b4fdd2e-174f-47e2-9611-9efe4f860b12?ui=en-US\" rel=\"nofollow\">https://support.office.com/en-US/Article/Enable-or-disable-macros-in-Office-documents-7b4fdd2e-174f-47e2-9611-9efe4f860b12?ui=en-US</a></p>\n"}, {"comments": [{"owner": {"reputation": 281, "user_id": 3818716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/896ab148a720107cdfcf61b8e242fb67?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/3818716/filippo"}, "edited": false, "score": 0, "creation_date": 1421951799, "post_id": 28077334, "comment_id": 44568229, "body": "Yes I think this is the only solution. Unfortunately my file is very large and will take 6-8 hours to do so"}, {"owner": {"reputation": 122, "user_id": 4345224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b289c4110f79570caafe8d97a5400886?s=128&d=identicon&r=PG&f=1", "display_name": "djevulen", "link": "https://stackoverflow.com/users/4345224/djevulen"}, "reply_to_user": {"reputation": 281, "user_id": 3818716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/896ab148a720107cdfcf61b8e242fb67?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/3818716/filippo"}, "edited": false, "score": 0, "creation_date": 1422106374, "post_id": 28077334, "comment_id": 44625147, "body": "If it comes to copy contents of your workbook, you could try running a simple macro - stored in the newly created Excel file - to import data from the corrupted file to that new file. I&#39;ve never tried that myself (did not need that), but it could save you some time."}], "tags": [], "owner": {"reputation": 122, "user_id": 4345224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b289c4110f79570caafe8d97a5400886?s=128&d=identicon&r=PG&f=1", "display_name": "djevulen", "link": "https://stackoverflow.com/users/4345224/djevulen"}, "is_accepted": true, "score": 1, "last_activity_date": 1421876309, "creation_date": 1421876309, "answer_id": 28077334, "question_id": 28059442, "link": "https://stackoverflow.com/questions/28059442/macro-not-responding-on-different-computer/28077334#28077334", "title": "Macro not responding on different computer", "body": "<p>I had issues like that myself both with macros and with Excel workbook doing some really funny stuff (like formulas not calculating properly, or functions not working as expected etc) and I did not find any other solution then copying the content of the file and pasting into a newly created file.\nIn each case this resolved my problem.\nIt suggests that my files somehow got corrupted and the only solution was to save the contents and delete the files.\nExporting the .frm and .frx files from VBEditor (Modules and Forms) worked fine for me.\nHave you tried this yourself?</p>\n"}], "owner": {"reputation": 281, "user_id": 3818716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/896ab148a720107cdfcf61b8e242fb67?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/3818716/filippo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20363, "favorite_count": 1, "accepted_answer_id": 28077334, "answer_count": 2, "score": 1, "last_activity_date": 1471510643, "creation_date": 1421813100, "last_edit_date": 1421857366, "question_id": 28059442, "link": "https://stackoverflow.com/questions/28059442/macro-not-responding-on-different-computer", "title": "Macro not responding on different computer", "body": "<p>I have a macro which works fine on my computer when I click its button but it does not work on different computers.\nAll the macros on that excel file are not working when clicking on the button.</p>\n\n<p>However, I have a macro working before saving. That means that when I try to save, another macro works properly. (that macro pop up an input message, but is not relevant now). So it seems that macros are not working only when you call them by a click...</p>\n\n<p>The version of Excel is the same one and I enabled the macro when asked.</p>\n\n<p>It is not a problem of the code because even if I create a new simple macro on that file from the different PC (such as:</p>\n\n<pre><code>msgbox(\"hello\")\n</code></pre>\n\n<p>) it is still not responding.</p>\n\n<p>I had a problem with that excel file in the past and I had to manually delete all the *.exd extensions in my computer. However once I deleted those extensions, the file worked well.</p>\n\n<p>I believe that the excel file is considered corrupted by other computers and they do not enable the macro. This is just my impression but I cannot get why the macro is working when saving and not working when clicking. </p>\n\n<p>Do you have any idea to solve the problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 2, "creation_date": 1421811487, "post_id": 28058807, "comment_id": 44499841, "body": "Upload the photo in a free image hosting site (eg. <a href=\"http://i.imgur.com\" rel=\"nofollow noreferrer\">i.imgur.com</a>) and post the link in your question. We&#39;ll take it from there. Btw, there are existing post here that you might want to check: <a href=\"http://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba\">Finding the lastrow</a>"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1421953933, "post_id": 28058807, "comment_id": 44569479, "body": "its not x1down but xldown !!!  (you wrote ONE and its L"}, {"owner": {"reputation": 1, "user_id": 4476390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af46d1a44b6378d8183dd34d2b7916e?s=128&d=identicon&r=PG&f=1", "display_name": "Dunn2", "link": "https://stackoverflow.com/users/4476390/dunn2"}, "edited": false, "score": 0, "creation_date": 1421989829, "post_id": 28058807, "comment_id": 44581814, "body": "The XL down worked. Thanks"}, {"owner": {"reputation": 1, "user_id": 4476390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af46d1a44b6378d8183dd34d2b7916e?s=128&d=identicon&r=PG&f=1", "display_name": "Dunn2", "link": "https://stackoverflow.com/users/4476390/dunn2"}, "edited": false, "score": 0, "creation_date": 1421989874, "post_id": 28058807, "comment_id": 44581831, "body": "I was watching a YouTube video and the code was hard to read. I questioned that when I typed it but guess I never thought to change it"}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1421847698, "last_edit_date": 1421847698, "creation_date": 1421812938, "answer_id": 28059415, "question_id": 28058807, "link": "https://stackoverflow.com/questions/28058807/finding-last-row-using-an-if-statement/28059415#28059415", "title": "Finding last row using an if statement", "body": "<p>The code could use some refinement, which is understandable considering you're admittedly a new user. </p>\n\n<p>First, you don't have to Select worksheets/cells to get your desired results. In fact, doing so serves as a de facto penalty as it taxes the system. Also, in this specific case, it may be redundant to store values into variables since you aren't doing much processing with them.</p>\n\n<p>If I understood your code correctly, you are copying Sheet1 cells E7:E16 and pasting them into Sheet2, starting in Column B with the next available row. If correct, try this code and let's tweak it as necessary.</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n    Dim ws1 as Worksheet\n    Dim ws2 as Worksheet\n    Dim nLastRowSheet2 as Long\n\n    Set ws1 = Worksheets(\"Sheet1\")\n    Set ws2 = Worksheets(\"Sheet2\")\n\n    nLastRowSheet2 = ws2.cells(rows.count,1).end(xlup).row\n\n    ws1.Range(\"E7:E16\").Copy ws2.Range(\"B\" &amp; nLastRowSheet2 + 1)\n    ws1.Range(\"E7:E16\").ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4476390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af46d1a44b6378d8183dd34d2b7916e?s=128&d=identicon&r=PG&f=1", "display_name": "Dunn2", "link": "https://stackoverflow.com/users/4476390/dunn2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421847698, "creation_date": 1421808633, "last_edit_date": 1421811878, "question_id": 28058807, "link": "https://stackoverflow.com/questions/28058807/finding-last-row-using-an-if-statement", "title": "Finding last row using an if statement", "body": "<p>I'm very new to VBA having only taught myself a little using youtube videos and trial and error.  Please be very descriptive and do not assume anything when answering.</p>\n\n<p>I have a code written that is suppose to take data submitted using a command button on sheet1 and store the information on the next blank row of sheet2.  The code I have works great the first time, but it will not fill in below it the next time I use it.  I get an error 1004 code at the if statement.  Please help.</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n    Dim Location As String, EmployeeName As String, itemnumber As Long, color As String, size As String, embloc As String, secopt As String, secplace As String, embstyle As String, lettering As String\n\n    Worksheets(\"sheet1\").Select\n    Location = Range(\"e7\")\n    EmployeeName = Range(\"e8\")\n    itemnumber = Range(\"e9\")\n    color = Range(\"e10\")\n    size = Range(\"e11\")\n    embloc = Range(\"e12\")\n    secopt = Range(\"e13\")\n    secplace = Range(\"e14\")\n    embstyle = Range(\"e15\")\n    lettering = Range(\"e16\")\n    Worksheets(\"sheet2\").Select\n    Worksheets(\"sheet2\").Range(\"b3\").Select\n    If Worksheets(\"sheet2\").Range(\"B3\").Offset(1, 0) &lt;&gt; \"\" Then\n        Worksheets(\"sheet2\").Range(\"B3\").End(x1down).Select\n    End If\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.Value = Location\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = EmployeeName\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = itemnumber\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = color\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = size\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = embloc\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = secopt\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = secplace\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = embstyle\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = lettering\n    Worksheets(\"sheet1\").Select\n    Worksheets(\"sheet1\").Range(\"e7:e16\").ClearContents\n    Worksheets(\"sheet1\").Range(\"e7\").Select\nEnd Sub\n</code></pre>\n\n<p>It won't let me post photos on here yet, but i have a table on sheet 2 that has headings from B3 to K3.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421822353, "post_id": 28058482, "comment_id": 44503173, "body": "Why not open the file directly in excel instead of using IE? E.g. <code>Workbooks.Open(&quot;http:&#47;&#47;server.company.com&#47;path&#47;Test.xlsx&quot;)</code>"}, {"owner": {"reputation": 7, "user_id": 4476318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_YZlDjkB7fw/AAAAAAAAAAI/AAAAAAAAAAA/4258WOQ5FQY/photo.jpg?sz=128", "display_name": "DPA", "link": "https://stackoverflow.com/users/4476318/dpa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421886422, "post_id": 28058482, "comment_id": 44537457, "body": "Thanks Tim. Tried to open the file directly using below code which came with Run Time Error;        Dim strFilePath As String      strFilePath = &quot;URL/TEST.XLSX&quot;      ThisWorkbook.FollowHyperlink (strFilePath)  So I thought I&#39;ll try using IE, which might work better. As I said earlier, am new to this world &amp; trying to learn as much as possible from the experts."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421890206, "post_id": 28058482, "comment_id": 44538537, "body": "Excel should have no problem directly opening a file from a URL"}], "answers": [{"tags": [], "owner": {"reputation": 50, "user_id": 2457792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d5d214f5e5d54dbde9efb22e5bdffad?s=128&d=identicon&r=PG", "display_name": "creddit", "link": "https://stackoverflow.com/users/2457792/creddit"}, "is_accepted": false, "score": 0, "last_activity_date": 1465933560, "creation_date": 1465933560, "answer_id": 37820814, "question_id": 28058482, "link": "https://stackoverflow.com/questions/28058482/how-to-open-an-excel-document-from-share-point-by-internet-explorer-using-vba/37820814#37820814", "title": "How to Open an Excel Document from Share Point by Internet Explorer using VBA", "body": "<pre><code>Sub SP()\nApplication.Workbooks.Open \"http://123/Testing/Test.xlsx\"\nEnd Sub\n</code></pre>\n\n<p>Or if you want to automatically check it out too </p>\n\n<pre><code>Sub SP()\n\nfil = \"http://123/Testing/Test.xlsx\" \nIf Application.Workbooks.CanCheckOut(fil) Then \nApplication.Workbooks.CheckOut fil \nSet wb = Application.Workbooks.Open(fil) \nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4476318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_YZlDjkB7fw/AAAAAAAAAAI/AAAAAAAAAAA/4258WOQ5FQY/photo.jpg?sz=128", "display_name": "DPA", "link": "https://stackoverflow.com/users/4476318/dpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465933560, "creation_date": 1421806290, "last_edit_date": 1531164843, "question_id": 28058482, "link": "https://stackoverflow.com/questions/28058482/how-to-open-an-excel-document-from-share-point-by-internet-explorer-using-vba", "title": "How to Open an Excel Document from Share Point by Internet Explorer using VBA", "body": "<p>Am new to VBA &amp; trying to learn as I go. Am currently stuck with an Issue here which I need some help.</p>\n\n<p>Am trying to open an Excel workbook(<code>Test.xlsx</code>) from the share point using Internet Explorer. Once the File is opened, I would like to close IE.  Then copy few Sheets from the Workbook, copy/Move it to a new Workbook &amp; close the original Workbook. \nI searched a lot in Google &amp; came with below codes which works OK if I run it separately, but If I combine with my original program (which I manged to generate by recording Macros) it gives an Error message 'Run-time error'9': Subscript out of range'which when I debug will highlight my Error Handler Code <code>(Workbooks(\"Test.xlsx\").Close SaveChanges:=False)</code>.</p>\n\n<p>I really cant understand the mistake here.\nCan someone please help me with the correct codes here.</p>\n\n<p>Basically my requirement is to open an Excel Workbook from Share point(<code>\"URL/TEST.xlsx\"</code>) using Internet Explorer(in a new window),close IE window &amp; then to copy/move few sheets from the original Workbook(Test.xlsx) to new Workbook, close the original workbook(Test.xlsx) &amp; make amendments in the new workbook(Book##).</p>\n\n<p>Can someone please help me with the codes here. </p>\n\n<p>Below are the codes I managed to get from Google/Internet.</p>\n\n<pre><code>Sub OpenIE()\n\n  Dim objIE As Object\n\n  Set objIE = CreateObject(\"InternetExplorer.Application\")\n\n  objIE.Navigate \"URL/TEST.xlsx\"\n\n  objIE.Visible = True**\n\nOn Error GoTo My_Error_Handler\n\n    Windows(\"Test.xlsx\").Visible = True\n\nOn Error GoTo My_Error_Handler\n\n    Sheets(Array(\"Stats\", \"Mtx\")).Select\n\n    Sheets(\"Mtx\").Activate\n\n    Sheets(Array(\"Stats\", \"Mtx\")).Copy\n\n    Sheets(\"Mtx\").Select\n    '\n'\n'\n'\n' so on \n'\n'\nMy_Error_Handler:\n\n    Workbooks(\"Test.xlsx\").Close SaveChanges:=False\n\n    ActiveWorkbook.Close SaveChanges:=False\n\n    MsgBox \"Error: (\" &amp; Err.Number &amp; \") \" &amp; Err.Description, vbCritical\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1421803975, "creation_date": 1421803975, "answer_id": 28058174, "question_id": 28058075, "link": "https://stackoverflow.com/questions/28058075/how-to-find-the-smallest-of-an-array-within-vba-not-in-an-excel-range/28058174#28058174", "title": "How to find the smallest of an array within VBA, not in an excel range", "body": "<p>Assuming your array is a one-dimensional array, you can still use the worksheetfunction class, like:</p>\n\n<pre><code>Dim myArray\nmyArray = Array(5, 3, 103, 99, -14, 12)\n\nDebug.Print Application.WorksheetFunction.Small(myArray, 1)\n</code></pre>\n\n<p>If your array is multi-dimensional, then you will need to use brute force iteration.</p>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1421805381, "creation_date": 1421805381, "answer_id": 28058353, "question_id": 28058075, "link": "https://stackoverflow.com/questions/28058075/how-to-find-the-smallest-of-an-array-within-vba-not-in-an-excel-range/28058353#28058353", "title": "How to find the smallest of an array within VBA, not in an excel range", "body": "<p>This is an example how you can achieve it : </p>\n\n<pre><code>Sub test()\n    Dim a(10), i&amp;\n    For i = 0 To 10\n       a(i) = i\n    Next\n    MsgBox \"Min: \" &amp; WorksheetFunction.Min(a) &amp; Chr(10) &amp; _\n            \"Avg: \" &amp; WorksheetFunction.Average(a) &amp; Chr(10) &amp; _\n            \"Max: \" &amp; WorksheetFunction.Max(a)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4462013, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6Zh9p.jpg?s=128&g=1", "display_name": "Miksoko", "link": "https://stackoverflow.com/users/4462013/miksoko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 28058174, "answer_count": 2, "score": 1, "last_activity_date": 1421829656, "creation_date": 1421803191, "last_edit_date": 1531161705, "question_id": 28058075, "link": "https://stackoverflow.com/questions/28058075/how-to-find-the-smallest-of-an-array-within-vba-not-in-an-excel-range", "title": "How to find the smallest of an array within VBA, not in an excel range", "body": "<p>Basic idea here is roll 4 d6, drop the lowest.    </p>\n\n<pre><code>For lngPosition = LBound(strAttributes) To UBound(strAttributes)\n\n        i = 0\n        For shortPosition = LBound(intRoll) To UBound(intRoll)\n           intRoll(shortPosition) = Int((6 - 1 + 1) * Rnd + 1)\n           i = intRoll(shortPosition) + i\n        Next shortPosition\n\n        i = {i - smallest intRoll()}\n\n        strAttributes(lngPosition) = i\n\n    Next lngPosition\n</code></pre>\n\n<p>I've found a lot of info on how to find the lowest value in a range in excel, by adding <code>.Small</code> after defining the range, but I don't think that works here. It may be that I'm off by miles on how to accomplish this, but I'm so fresh that I really don't know.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1421795331, "post_id": 28056758, "comment_id": 44495433, "body": "&quot;Compress&quot;... based on what condition?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1421795449, "post_id": 28056758, "comment_id": 44495478, "body": "If you would like to normalize it, i&#39;d suggest to redesign it. Have you any chance to do that?"}, {"owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "edited": false, "score": 0, "creation_date": 1421806270, "post_id": 28056758, "comment_id": 44498526, "body": "The link below should give you your answer:    <a href=\"http://stackoverflow.com/questions/5517233/ms-access-query-concatenating-rows-through-a-query\" title=\"ms access query concatenating rows through a query\">stackoverflow.com/questions/5517233/&hellip;</a>"}, {"owner": {"reputation": 39, "user_id": 1956557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c434adff8e5034ce232a550b6d622de?s=128&d=identicon&r=PG", "display_name": "user1956557", "link": "https://stackoverflow.com/users/1956557/user1956557"}, "edited": false, "score": 0, "creation_date": 1421806905, "post_id": 28056758, "comment_id": 44498696, "body": "The database is normalized. The actual table contains a field for the Category, a field that designates a division, and a third field for the value.  When it&#39;s flipped, each division becomes a column.  Each row in the query caries a value for a division.  The client wants the data &quot;compressed&quot; - the first item for division 1, the first item for division 2, and the first item for division 3 appear on the first fow for that category.  You can see this pattern in the example of the results I need."}, {"owner": {"reputation": 39, "user_id": 1956557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c434adff8e5034ce232a550b6d622de?s=128&d=identicon&r=PG", "display_name": "user1956557", "link": "https://stackoverflow.com/users/1956557/user1956557"}, "edited": false, "score": 0, "creation_date": 1421807390, "post_id": 28056758, "comment_id": 44498803, "body": "The example provided is the equivelant of the Group_Concat function in MySQL.  It&#39;s close, but not quite what I need.  Group_Concat creates a delimited list and only one row for the grouping field.  What I need is a row for each item in the column that has the most items in the category, in the sample it&#39;s FieldA"}, {"owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "edited": false, "score": 0, "creation_date": 1421807702, "post_id": 28056758, "comment_id": 44498894, "body": "You could use it for each column, create a table for each of your 3 columns, then do a simple join query with the new tables, no?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 1956557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c434adff8e5034ce232a550b6d622de?s=128&d=identicon&r=PG", "display_name": "user1956557", "link": "https://stackoverflow.com/users/1956557/user1956557"}, "edited": false, "score": 0, "creation_date": 1421856752, "post_id": 28069298, "comment_id": 44522974, "body": "This is the equivelant of the MySQL Group_Concat function, which is close to what I need, but not quite it, since it concatenates all the rows in a group into a single row with delimited data."}], "tags": [], "owner": {"reputation": 1, "user_id": 4478630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b74c60bebd0e79fc872550f1bc0b225?s=128&d=identicon&r=PG", "display_name": "NataliaGarber", "link": "https://stackoverflow.com/users/4478630/nataliagarber"}, "is_accepted": false, "score": 0, "last_activity_date": 1421849523, "last_edit_date": 1495542494, "creation_date": 1421849523, "answer_id": 28069298, "question_id": 28056758, "link": "https://stackoverflow.com/questions/28056758/ms-access-group-query/28069298#28069298", "title": "MS ACCESS Group Query", "body": "<p>I had the same problem. Take a look at: <a href=\"https://stackoverflow.com/questions/5174362/microsoft-access-condense-multiple-lines-in-a-table/5174843#5174843\">Microsoft Access condense multiple lines in a table</a></p>\n\n<p>or get the cloud version here <a href=\"https://www.apponfly.com/en/application/microsoft-access-2013\" rel=\"nofollow noreferrer\">https://www.apponfly.com/en/application/microsoft-access-2013</a></p>\n\n<p>Works pretty good</p>\n"}, {"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 39, "user_id": 1956557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c434adff8e5034ce232a550b6d622de?s=128&d=identicon&r=PG", "display_name": "user1956557", "link": "https://stackoverflow.com/users/1956557/user1956557"}, "edited": false, "score": 0, "creation_date": 1421877098, "post_id": 28069475, "comment_id": 44533937, "body": "You&#39;re very welcome ;) If my answer was helpfull, please accept it."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 3, "last_activity_date": 1421850111, "creation_date": 1421850111, "answer_id": 28069475, "question_id": 28056758, "link": "https://stackoverflow.com/questions/28056758/ms-access-group-query/28069475#28069475", "title": "MS ACCESS Group Query", "body": "<p>As i mentioned in my comment to the question, normalized table should look like:</p>\n\n<pre><code>|_Category_|_F_Name_|_F_Val__|\n|----------|--------|--------|\n|   CAT1   | FieldA |    A   |\n|----------|--------|--------|\n|   CAT1   | FieldB |    B   |\n|----------|--------|--------|\n|   CAT1   | FieldC |    C   |\n|----------|--------|--------|\n|   CAT1   | FieldB |    D   |\n|----------|--------|--------|\n|   CAT1   | FieldC |    E   |\n|----------|--------|--------|\n|   CAT1   | FieldA |    F   |\n|----------|--------|--------|\n</code></pre>\n\n<p>How to achieve that?</p>\n\n<pre><code>SELECT A.Category, \"FieldA\" AS FieldName, A.FieldA AS FieldValue\nFROM TableA AS A\nWHERE NOT A.FieldA IS NULL\nUNION ALL\nSELECT A.Category, \"FieldB\", A.FieldB\nFROM TableA AS A\nWHERE NOT A.FieldB IS NULL\nUNION ALL\nSELECT A.Category, \"FieldC\", A.FieldC\nFROM TableA AS A\nWHERE NOT A.FieldC IS NULL;\n</code></pre>\n\n<p>To export the data into new table, use query:</p>\n\n<pre><code>SELECT B.* INTO TableB\nFROM (\n   --above query\n)  AS B;\n</code></pre>\n\n<p>Do not forget to add autonumber field (as primary key) to <em>TableB</em> to be able to identify each record.</p>\n\n<p>As per my understanding, you want to pivot data. It's not so simple, becasue we need to simulate</p>\n\n<pre><code>ROW_NUMBER() OVER(PARTITION BY FieldName, ORDER BY ID)\n</code></pre>\n\n<p>which is not supported in MS Access. How to workaround it?  </p>\n\n<pre><code>SELECT B.ID, B.Category, B.FieldName, B.FieldValue,\n       (SELECT COUNT(A.FieldName)\n        FROM TableB AS A\n        WHERE A.FieldName=B.FieldName AND A.ID &gt;=B.ID\n        GROUP BY A.FieldName ) AS TRank\nFROM TableB AS B;\n</code></pre>\n\n<p>It should produce below record set:</p>\n\n<pre><code>ID  Category    FieldName   FieldValue  TRank\n1   CAT1        FieldA      A           3\n2   CAT1        FieldA      D           2\n3   CAT1        FieldA      F           1\n4   CAT1        FieldB      B           1\n5   CAT1        FieldC      C           2\n6   CAT1        FieldC      E           1\n</code></pre>\n\n<p>But... you can't use above query as a source of pivot data, because of \"<em>The Microsoft Access database engine does not recognize  as a valid field name or expression. (Error 3070)</em>\" error message. So, finally, you should export these data into another table (let's say <em>TableC</em>).</p>\n\n<pre><code>SELECT C.* INSERT INTO TableC\nFROM TableB AS C\n</code></pre>\n\n<p>Now, you can pivot data:</p>\n\n<pre><code>TRANSFORM First(A.FieldValue) AS FirstOfFieldValue\nSELECT A.Category, A.TRank\nFROM TableC AS A\nGROUP BY A.Category, A.TRank\nPIVOT A.FieldName;\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Category    TRank   FieldA  FieldB  FieldC\nCAT1        1       F       B       E\nCAT1        2       D       C\nCAT1        3       A       \n</code></pre>\n\n<p>Cheers,<br/>\nMaciej</p>\n"}], "owner": {"reputation": 39, "user_id": 1956557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c434adff8e5034ce232a550b6d622de?s=128&d=identicon&r=PG", "display_name": "user1956557", "link": "https://stackoverflow.com/users/1956557/user1956557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 28069475, "answer_count": 2, "score": 0, "last_activity_date": 1421850111, "creation_date": 1421794786, "question_id": 28056758, "link": "https://stackoverflow.com/questions/28056758/ms-access-group-query", "title": "MS ACCESS Group Query", "body": "<p>This one really has me scratching my head.  It's sort of like a GROUP_CONCAT, but different.  I'm pretty sure there is no way to do this with SQL only.  I have a query that does a flip-table on a normalized table.  The result looks like this:</p>\n\n<pre><code>|_Category_|_FieldA_|_FieldB_|_FieldC_|\n|----------|--------|--------|--------|\n|   CAT1   |    A   |        |        | \n|----------|--------|--------|--------|\n|   CAT1   |        |    B   |        | \n|----------|--------|--------|--------|\n|   CAT1   |        |        |    C   | \n|----------|--------|--------|--------|\n|   CAT1   |   D    |        |        | \n|----------|--------|--------|--------|\n|   CAT1   |        |        |    E   |   \n|----------|--------|--------|--------|\n|   CAT1   |    F   |        |        | \n|----------|--------|--------|--------|\n</code></pre>\n\n<p>My challenge is to compress it into as few rows as possible, but only have one value per cell.</p>\n\n<pre><code>|_Category_|_FieldA_|_FieldB_|_FieldC_|\n|----------|--------|--------|--------|\n|   CAT1   |    A   |    B   |    C   | \n|----------|--------|--------|--------|\n|   CAT1   |    D   |        |    E   | \n|----------|--------|--------|--------|\n|   CAT1   |    F   |        |        | \n|----------|--------|--------|--------|\n</code></pre>\n\n<p>Any Ideas?  </p>\n\n<p>Thanks in advance.</p>\n\n<p>Mark</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421794279, "post_id": 28056458, "comment_id": 44494959, "body": "If you want to end the whole code execution, I don&#39;t think you can preserve GlobalVariable in the stack, you will need a database (or even a simple print into the spreadsheet, but not the stack if you want to end it). If you don&#39;t really want to end it, then you might need to slightly re-designing your code. Could you add some context of why you would like to end the run but keep the stack please?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1421799691, "post_id": 28056458, "comment_id": 44496912, "body": "Probably create a boolean variable say <code>Global.bProceed</code> to control the flow of <code>Procedure()</code> and <code>Module1.SubProcedure()</code>."}, {"owner": {"reputation": 6123, "user_id": 2670182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MzRYh.jpg?s=128&g=1", "display_name": "Cool Blue", "link": "https://stackoverflow.com/users/2670182/cool-blue"}, "edited": false, "score": 0, "creation_date": 1421812037, "post_id": 28056458, "comment_id": 44499996, "body": "The normal way to do this is to use an <code>Exit Sub</code> statement..."}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1421794326, "post_id": 28056589, "comment_id": 44494981, "body": "The &quot;return&quot; statement will give you an error in VBA."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421794636, "post_id": 28056589, "comment_id": 44495127, "body": "No problem, I guess you develop C# / VB.NET, I always fall into the same trap ;) However, I think the user wants to stop the code execution, not returning to the caller Sub. Even if I would honestly re-design the code not too much differently than what you did."}], "tags": [], "owner": {"reputation": 3652, "user_id": 3980820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0dbb38e57f2ecb35697d109ac1f5d60?s=128&d=identicon&r=PG&f=1", "display_name": "Abdessabour Mtk", "link": "https://stackoverflow.com/users/3980820/abdessabour-mtk"}, "is_accepted": false, "score": 3, "last_activity_date": 1567769030, "last_edit_date": 1567769030, "creation_date": 1421794141, "answer_id": 28056589, "question_id": 28056458, "link": "https://stackoverflow.com/questions/28056458/alternative-to-end-statement-in-vba/28056589#28056589", "title": "alternative to End statement in VBA", "body": "<p>You can use a Function instead of using a subprocedure and then return a boolean like this :</p>\n\n<pre><code>Function SubProcedure() as Boolean\n\n    If x then \n        SubProcedure = false\n    ElseIf y then\n        SubProcedure = true\n    End If\n\nEnd Function\n</code></pre>\n\n<p>and add these line to the procedure code :  </p>\n\n<pre><code>if module1.subprocedure then\n   End\nend if\n</code></pre>\n"}], "owner": {"reputation": 4318, "user_id": 793468, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2a53d6ad132f0d080fd699f581869c50?s=128&d=identicon&r=PG", "display_name": "user793468", "link": "https://stackoverflow.com/users/793468/user793468"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1625, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567769030, "creation_date": 1421793644, "last_edit_date": 1531164843, "question_id": 28056458, "link": "https://stackoverflow.com/questions/28056458/alternative-to-end-statement-in-vba", "title": "alternative to End statement in VBA", "body": "<p>I have a Procedure which calls a module. Something like this:</p>\n\n<p>Procedure:</p>\n\n<pre><code>Sub Procedure()\n\n    Module1.SubProcedure()\n\n    If Global.Variable = \"A\" Then\n        ...\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Module1:</p>\n\n<pre><code>Sub SubProcedure()\n\n    If x then \n        Exit Sub\n    ElseIf y then\n        End\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Using 'End' resets the Global.Variable. Is there any alternative to 'End' Which would stop the execution of Procedure() and preserve the value of Global.Variable?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "is_accepted": true, "score": 4, "last_activity_date": 1421793964, "last_edit_date": 1421793964, "creation_date": 1421793549, "answer_id": 28056442, "question_id": 28056266, "link": "https://stackoverflow.com/questions/28056266/excel-checking-if-any-day-of-specified-month-falls-between-a-range-of-dates/28056442#28056442", "title": "Excel - Checking if any day of specified month falls between a range of dates", "body": "<p>There would only <strong>not</strong> be an overlap if the first day of that month is later than B, or if last day is before A, so this formula should work</p>\n\n<p><code>=IF(OR(A2&gt;DATE(2014,6,30),B2&lt;DATE(2014,6,1)),\"no\",\"yes\")</code></p>\n\n<p>To shorten you can put the start and end dates of the reference period in two cells, e.g. <code>E1</code> and <code>F1</code> and then use this version:</p>\n\n<p><code>=IF(OR(A2&gt;F$1,B2&lt;E$1),\"no\",\"yes\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1421801144, "post_id": 28056461, "comment_id": 44497317, "body": "Quote the OP: &quot;In column C I want to check if any day of specified month (i.e. June 2014) &quot; but he doesn&#39;t specify which month."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": -1, "last_activity_date": 1421793660, "creation_date": 1421793660, "answer_id": 28056461, "question_id": 28056266, "link": "https://stackoverflow.com/questions/28056266/excel-checking-if-any-day-of-specified-month-falls-between-a-range-of-dates/28056461#28056461", "title": "Excel - Checking if any day of specified month falls between a range of dates", "body": "<p>Assuming Excel knows that the first to columns are dates; lets say you put your \"specified month\" in column D, this is how you can compare it:</p>\n\n<pre><code>=IF(AND(D1&gt;A1,D1&lt;B1),\"yes\",\"no\")\n</code></pre>\n\n<p>It would have to compare another date, like if you wanted to test July you would reference a cell with 7-1-2014</p>\n\n<p>In order to be more specific you would probably want to use VBA and <a href=\"http://www.classanytime.com/mis333k/sjdatetime.html\" rel=\"nofollow\">date references</a> to check.</p>\n"}], "owner": {"reputation": 89, "user_id": 2825175, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea35b0af5094fec40a5593158be5352b?s=128&d=identicon&r=PG&f=1", "display_name": "Zygmunt", "link": "https://stackoverflow.com/users/2825175/zygmunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2250, "favorite_count": 0, "accepted_answer_id": 28056442, "answer_count": 2, "score": 2, "last_activity_date": 1421793964, "creation_date": 1421792722, "question_id": 28056266, "link": "https://stackoverflow.com/questions/28056266/excel-checking-if-any-day-of-specified-month-falls-between-a-range-of-dates", "title": "Excel - Checking if any day of specified month falls between a range of dates", "body": "<p>I have a worksheet with dates in columns A and B:</p>\n\n<pre><code>   col A   |    col B   |\n\n2014-06-30 | 2014-10-31 | \n2014-01-21 | 2014-05-31 |\n2012-03-07 | 2014-11-03 |\n2013-02-05 | 2014-05-01 |\n</code></pre>\n\n<p>In column C I want to check if any day of specified month (i.e. June 2014) falls between dates form columns A and B:</p>\n\n<pre><code>   col A   |    col B   |   col C  |\n\n2014-06-30 | 2014-10-31 |    yes   |\n2014-01-21 | 2014-05-31 |    no    |\n2012-03-07 | 2014-11-03 |    yes   |\n2013-02-05 | 2014-05-01 |    no    |\n</code></pre>\n\n<p>Any ideas? (VBA or Excel formula)</p>\n\n<p>Thank you in advance for your help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4475808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fa4847260ca5c530424de2d3c9e9be?s=128&d=identicon&r=PG&f=1", "display_name": "avUNT", "link": "https://stackoverflow.com/users/4475808/avunt"}, "edited": false, "score": 0, "creation_date": 1421803368, "post_id": 28055761, "comment_id": 44497884, "body": "Thanks for the comment, Tim. I ran what you gave and it&#39;s a good start, but not quite what I&#39;m looking for. I&#39;m certain that it has more with in inability to communicate what I want. This may help"}, {"owner": {"reputation": 3, "user_id": 4475808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fa4847260ca5c530424de2d3c9e9be?s=128&d=identicon&r=PG&f=1", "display_name": "avUNT", "link": "https://stackoverflow.com/users/4475808/avunt"}, "edited": false, "score": 0, "creation_date": 1421804381, "post_id": 28055761, "comment_id": 44498171, "body": "Well, I can&#39;t post what I want because my reputation isn&#39;t high enough to post pictures. I&#39;ll work on increasing that."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 4475808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fa4847260ca5c530424de2d3c9e9be?s=128&d=identicon&r=PG&f=1", "display_name": "avUNT", "link": "https://stackoverflow.com/users/4475808/avunt"}, "edited": false, "score": 0, "creation_date": 1421808087, "post_id": 28055761, "comment_id": 44499011, "body": "Try editing your question to describe where each copied line needs to go - that&#39;s really what&#39;s missing here."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1421822907, "last_edit_date": 1421822907, "creation_date": 1421790548, "answer_id": 28055761, "question_id": 28055567, "link": "https://stackoverflow.com/questions/28055567/vba-copy-and-paste-dynamic-range-with-dynamic-start-point/28055761#28055761", "title": "VBA - Copy and Paste Dynamic Range with Dynamic Start Point", "body": "<pre><code>Sheets(\"Raw Data\").Select\nRange(\"B3:B7\").Select\nSelection.Copy\nSheets(\"Sheet1\").Select\nRange(\"D2\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True \n</code></pre>\n\n<p>reduces to </p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"D2\").Resize(5, 1).Value = _\n Application.Transpose(Sheets(\"Raw Data\").Range(\"B3\").Resize(1, 5).Value)\n</code></pre>\n\n<p>Taking that as a starting point, you can declare some variables (or better, use Constants) for the \"5\", etc, but you'd need to add some more details to your question, including what dtermines where the next \"paste\" point is.  you mention multiple sheets but it's not clear how those are involved in the operation.</p>\n\n<p>Eg:</p>\n\n<pre><code>Sub Tester()\n\n    Const DATA_PTS As Long = 5\n\n    Dim rngCopy As Range, rngPaste As Range\n\n    'start point for source data\n    Set rngCopy = Sheets(\"Raw Data\").Range(\"B3\").Resize(DATA_PTS, 1).Value\n\n    Do While Application.CountA(rngCopy) &gt; 0\n\n        'Set rngPaste = ? 'what determines where data is copied to?\n\n        rngPaste.Resize(1, DATA_PTS).Value = _\n           Application.Transpose(rngCopy.Value)\n\n        'next source range\n        Set rngCopy = rngCopy.Offset(DATA_PTS, 0)\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4475808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fa4847260ca5c530424de2d3c9e9be?s=128&d=identicon&r=PG&f=1", "display_name": "avUNT", "link": "https://stackoverflow.com/users/4475808/avunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 28055761, "answer_count": 1, "score": 0, "last_activity_date": 1421822907, "creation_date": 1421789726, "last_edit_date": 1421804301, "question_id": 28055567, "link": "https://stackoverflow.com/questions/28055567/vba-copy-and-paste-dynamic-range-with-dynamic-start-point", "title": "VBA - Copy and Paste Dynamic Range with Dynamic Start Point", "body": "<p>I am very new to the VBA community and usage so my illiteracy is a bit embarrassing. I work in a lab that routinely deals with very large data output files. In order to statistically analyze these data files we often have to rearrange the output data into a more statistically friendly format. Therein lies my problem. </p>\n\n<p>I have created and VBA that does this for a very specific dataset, copying and paste transposing 5 data points at a time. I would like help in creating something that allows me to have a more generic approach to this where I might be able to enter the number of study time points (typically between 3 and 10) and the number of study participants (between 10 and 100) and still get the copy/paste transpose done on the correct sheet. </p>\n\n<p>What I have in my specific VBA is below. I basically have this done manually all the way to a range of B208:212 and all the way through Sheet 13.</p>\n\n<pre><code>Sheets(\"Raw Data\").Select\nRange(\"B3:B7\").Select\nSelection.Copy\nSheets(\"Sheet1\").Select\nRange(\"D2\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True \n</code></pre>\n\n<p>What this does is copies five data points for one study participant, goes to my desired sheet, and paste transposes in the row corresponding with my study participant. I need to do this for up 100 study participants, each beginning on its own row starting with D2. </p>\n\n<p>Sorry this is confusing. I am working on posting more clarification below. </p>\n"}, {"tags": ["xml", "vba", "post", "xmlhttprequest", "cxml"], "answers": [{"tags": [], "owner": {"reputation": 12673, "user_id": 95195, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/735a05084346db68dff750870654da3d?s=128&d=identicon&r=PG", "display_name": "Justin Dearing", "link": "https://stackoverflow.com/users/95195/justin-dearing"}, "is_accepted": false, "score": 1, "last_activity_date": 1437667518, "creation_date": 1437667518, "answer_id": 31592618, "question_id": 28055191, "link": "https://stackoverflow.com/questions/28055191/send-post-xml-file-using-vb/31592618#31592618", "title": "Send/POST xml file using VB", "body": "<p>I would suggest using <a href=\"https://github.com/VBA-tools/VBA-Web\" rel=\"nofollow\">This library</a> for making rest calls. Currently XML parsing requires a bit of a workaround, but its less code than all the boilerplate you wrote., </p>\n"}], "owner": {"reputation": 31, "user_id": 4475622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40551337023266d688531633ab08eb94?s=128&d=identicon&r=PG&f=1", "display_name": "Hammertime", "link": "https://stackoverflow.com/users/4475622/hammertime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3337, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1437667518, "creation_date": 1421788203, "question_id": 28055191, "link": "https://stackoverflow.com/questions/28055191/send-post-xml-file-using-vb", "title": "Send/POST xml file using VB", "body": "<p>I am trying to post a well-formed cxml file to a remote server url.  My code makes the connection but fails on the actual SEND command.  I am not necessarily a newbie to VBA but I am a newbie to POSTING xml and posting help request to this forum.  Hope I did it right.</p>\n\n<p>I get status = 200 and a response of \"Missing XML\" when I post.  It appears that the XML data is not actually getting uploaded to remote server</p>\n\n<pre><code>remoteurl = \"http://myremoteurl.com/incoming\"\nFileNameXML = XML file read into a string variable\nFileNameSource = fullpath &amp; filename of XML file=\"C:\\xmls\\test00001.xml\"\n\n' I am calling the following function &amp; storing response\nxmlresp = HTTPPostTXT(remoteurl, FileNameXML, FileNameSource)\n\nFunction HTTPostTxt(ByVal sUrl As String, xmlText As String, ByVal xmlname As String)\n  Set XMLHTTP = CreateObject(\"Microsoft.XMLHTTP\")\n  XMLHTTP.Open \"POST\", sUrl, False\n  Set xmldom = CreateObject(\"Microsoft.XMLDOM\")\n  xmldom.LoadXML xmlText\n  xmldom.Validate\n  ' xmldom.xml does not error out but XML file does not get sent/uploaded \n  XMLHTTP.send xmldom.xml\n  MsgBox XMLHTTP.Status &amp; \" \" &amp; XMLHTTP.responseText   ' Return Status # &amp; reponseText\n\n  ' I am storing response and status for troubleshooting\n  If XMLHTTP.Status &lt;&gt; 200 Then\n    Sheets(Shtname).Cells(iRow, 6).Value = XMLHTTP.responseText\n    HTTPPostTxt = \"Failure\"\n  Else\n    Sheets(Shtname).Cells(iRow, 6).Value = XMLHTTP.responseText\n    HTTPPostTxt = \"Accepted\"\n  End If\nEnd Function\n</code></pre>\n\n<p>(1) I am looking for help on what I am doing wrong with sending the XML string data.  This is assuming that this is why I can't SEND data.  Here is how I read the XML file into String variable</p>\n\n<pre><code>Function XMLFileString(ByVal XMLFileName As String) As String\n  Dim text, textline As String\n  Open XMLFileName For Input As #1\n  Do Until EOF(1)\n    Line Input #1, textline\n    text = text &amp; textline\n  Loop\n  Close #1\n  XMLFileString = text\n  End Function\n</code></pre>\n\n<p>(2) Changing the SEND command to send the actual file (using fullpath &amp; filename) is an option.  Not sure what to change.  I think I need to change the LOADXML command to a LOAD and use the filename.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1421790122, "post_id": 28055048, "comment_id": 44493083, "body": "Is there a specific field in the recordset you want to total?"}], "owner": {"reputation": 644, "user_id": 2114590, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a436624136df74997ff3a3cd5b89451?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/2114590/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 494, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1421791085, "creation_date": 1421787656, "last_edit_date": 1421791085, "question_id": 28055048, "link": "https://stackoverflow.com/questions/28055048/sum-recordsets-access-2013-vba", "title": "Sum Recordsets Access 2013 VBA", "body": "<p>I have, lets say, 4 recordsets which I am creating like:</p>\n\n<pre><code>SET rs = (SELECT mySQL stuff)\n</code></pre>\n\n<p>This recordset is changing its content with a loop because I'm changing the WHERE condition on each iteration.</p>\n\n<p>My question is, how can I sum all recordset to be able to get a result? I mean something like (pseudo code):</p>\n\n<pre><code>DO\n  SET RS = (mySQL  stuff)\n  rsTotal = rsTotal + RS\nLOOP\n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1421788071, "post_id": 28055026, "comment_id": 44492091, "body": "So to simplify; you need to check if Column E in Sheet1 is a &quot;Y&quot;, if it is then fill in the data from that row to the corresponding columns in Sheet2? Will the columns in both sheets always stay the same, or will they be changing?"}, {"owner": {"reputation": 956, "user_id": 3486773, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4b1aec69e11bd6483ba49e73fa49c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3486773", "link": "https://stackoverflow.com/users/3486773/user3486773"}, "reply_to_user": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1421808009, "post_id": 28055026, "comment_id": 44498985, "body": "They have the potential to change.  And I corrected one of the columns in sheet2."}], "answers": [{"comments": [{"owner": {"reputation": 956, "user_id": 3486773, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4b1aec69e11bd6483ba49e73fa49c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3486773", "link": "https://stackoverflow.com/users/3486773/user3486773"}, "edited": false, "score": 0, "creation_date": 1421810182, "post_id": 28055402, "comment_id": 44499528, "body": "I&#39;m torn. Technically the top answer is the answer to the question I posted. But you knocked it out of the park with this^^^. This is the answer to my project &amp; only requires minor tweaking. Going to study this good &amp; long to understand how it does what I&#39;ve been trying for days to do.The only thing this doesn&#39;t do is search the &quot;Y/N&quot; column to see if = Y before copying and then looping to the bottom of the sheet.  Once I understand this more I&#39;ll add those tweaks.  What&#39;s amazing is how scalable this is.  You didn&#39;t even need to know any of the header names in order to make this work.  Bravo!"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 956, "user_id": 3486773, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4b1aec69e11bd6483ba49e73fa49c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3486773", "link": "https://stackoverflow.com/users/3486773/user3486773"}, "edited": false, "score": 0, "creation_date": 1421811986, "post_id": 28055402, "comment_id": 44499982, "body": "Thanks! I figured I&#39;d try to help you solve the underlying problem. With regards to the Y/N column: If I understood your request correctly, a button click will fire this macro. Once clicked, the button will check to see if the Y/N column is indeed a Y? If that&#39;s correct, then the easiest solution is to encase the entire code block within an IF / ELSE statement. For example, IF cells(Activecell.row, 5) = &quot;Y&quot; Then &#39;ENTER CODE ELSE END IF"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1421789044, "creation_date": 1421789044, "answer_id": 28055402, "question_id": 28055026, "link": "https://stackoverflow.com/questions/28055026/storing-headers-in-string-array-vba/28055402#28055402", "title": "Storing headers in string array VBA", "body": "<p>Here's a piece of code that I've thrown together that I think meets your needs. I think the variable names are self explanatory, but if not, please follow up. </p>\n\n<p>The code searches each cell in the header row of the origin sheet to see if it exists in the destination sheet. If so, it copies over the corresponding information.</p>\n\n<pre><code>Dim wsOrigin As Worksheet\nDim wsDest As Worksheet\nDim nCopyRow As Long\nDim nPasteRow As Long\nDim rngFnd As Range\nDim rngDestSearch As Range\nDim cel As Range\n\nConst ORIGIN_ROW_HEADERS = 1\nConst DEST_ROW_HEADERS = 1\n\n\nSet wsOrigin = Sheets(\"Sheet1\")\nSet wsDest = Sheets(\"Sheet2\")\n\nnCopyRow = ActiveCell.Row\nnPasteRow = wsDest.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\nSet rngDestSearch = Intersect(wsDest.UsedRange, wsDest.Rows(DEST_ROW_HEADERS))\n\nFor Each cel In Intersect(wsOrigin.UsedRange, wsOrigin.Rows(ORIGIN_ROW_HEADERS))\n    On Error Resume Next\n        Set rngFnd = rngDestSearch.Find(cel.Value)\n\n        If rngFnd Is Nothing Then\n            'Do Nothing as Header Does not Exist\n        Else\n            wsDest.Cells(nPasteRow, rngFnd.Column).Value = wsOrigin.Cells(nCopyRow, cel.Column).Value\n        End If\n    On Error GoTo 0\n\n    Set rngFnd = Nothing\nNext cel\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 2, "creation_date": 1421791446, "post_id": 28055624, "comment_id": 44493698, "body": "You can skip a few steps with something like: <code>HeaderList = Array(&quot;header1&quot;, &quot;header2&quot;)</code>"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1421795138, "post_id": 28055624, "comment_id": 44495356, "body": "@DougGlancy - Yes. I have personally found this more practical when you have many elements in the array. It is a matter of taste."}, {"owner": {"reputation": 956, "user_id": 3486773, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4b1aec69e11bd6483ba49e73fa49c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3486773", "link": "https://stackoverflow.com/users/3486773/user3486773"}, "edited": false, "score": 0, "creation_date": 1421809380, "post_id": 28055624, "comment_id": 44499344, "body": "This answered the actual question and cleared up what they were referring to"}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": true, "score": 2, "last_activity_date": 1421789972, "creation_date": 1421789972, "answer_id": 28055624, "question_id": 28055026, "link": "https://stackoverflow.com/questions/28055026/storing-headers-in-string-array-vba/28055624#28055624", "title": "Storing headers in string array VBA", "body": "<p><strong>How do I store my headers in a string array?</strong></p>\n\n<p>A very practical way:</p>\n\n<pre><code>Dim hdlist As String\nDim sep As String\nhdlist = \"ID|CUR|Region|Amount|Y/N\"      ' Change this line\nsep = \"|\"\nDim hdnames() As String\nhdnames = Split(hdlist, sep, -1, vbBinaryCompare)\n</code></pre>\n\n<p>Then you can use a <code>For</code> loop to traverse the array.</p>\n"}], "owner": {"reputation": 956, "user_id": 3486773, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4b1aec69e11bd6483ba49e73fa49c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3486773", "link": "https://stackoverflow.com/users/3486773/user3486773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3922, "favorite_count": 1, "accepted_answer_id": 28055624, "answer_count": 2, "score": 2, "last_activity_date": 1421808057, "creation_date": 1421787536, "last_edit_date": 1421808057, "question_id": 28055026, "link": "https://stackoverflow.com/questions/28055026/storing-headers-in-string-array-vba", "title": "Storing headers in string array VBA", "body": "<p>New to VBA and am trying to essentially lookup column headers in on sheet to another and if match copy data over...</p>\n\n<p>I was told that I can store my headers in a string array then loop through and compare the headers to my array to see if they match.</p>\n\n<pre><code>ie: For each c In\nSheet1.Range(\"A1:BA1\").offset(rownumber -1)\n</code></pre>\n\n<p>But I'm not sure what that means?  How do I store my headers in a string array?  Sorry if this is a super basic question.  I have googled it and not found anything explaining how to do this or what it means.</p>\n\n<p>My Project:\nresearch data on sheet1.  If there is an issue I want to click a button that will copy only the matching column data to a new row in a Specified sheet.  From there the data will be reviewed and then another button to export the data to an MS SQL table. </p>\n\n<p>ie:</p>\n\n<pre><code>Sheet1\nA       B        C      D    E\nID     CUR    Region Amount Y/N\n1      USD      NA    $54    Y\n\nSheet2\n   A       B     C     D     E\nRegion    CUR   Amount   Type  Misc\n</code></pre>\n\n<p>So if Column E = Y then copy all the relevant data in that row to a new sheet:</p>\n\n<pre><code>Sheet2 (output)\n   A       B     C      D     E\nRegion    CUR   Amount Type  Misc\n  NA      USD   $54    Null  Null\n</code></pre>\n\n<p>Sheet2 has columns not in Sheet1 and vice versa... Also the order of the columns are not the same in each sheet.  The real sheets are huge with many columns and the row count will change everytime I refresh my data. I need this to loop until Col A in Sheet1 is null.</p>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 644, "user_id": 2114590, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a436624136df74997ff3a3cd5b89451?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/2114590/mark"}, "edited": false, "score": 0, "creation_date": 1421787865, "post_id": 28054960, "comment_id": 44491985, "body": "how is BANK_accno  declared?"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 2, "creation_date": 1421793288, "post_id": 28054960, "comment_id": 44494545, "body": "Need more information.  &quot;Has not worked&quot; isn&#39;t enough to go on.  However, you might try &quot;@@@@-@@-@@-@@-@@&quot; to start with, since that replaces every numeric indicator with an alphanumeric indicator."}], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 3172599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDYD6.jpg?s=128&g=1", "display_name": "stb", "link": "https://stackoverflow.com/users/3172599/stb"}, "is_accepted": false, "score": 0, "last_activity_date": 1423077166, "creation_date": 1423077166, "answer_id": 28329493, "question_id": 28054960, "link": "https://stackoverflow.com/questions/28054960/vb6-change-numeric-field-to-alphanumeric/28329493#28329493", "title": "VB6 Change Numeric Field To Alphanumeric", "body": "<p>As BobRodes commented, you can use <code>@</code> to mask characters not limited to numbers. There are other options (ignore spaces, force left-to-right filling, upper/lower case).</p>\n\n<p>Have a look at <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251755%28v=office.15%29.aspx\" rel=\"nofollow\">Format function documentation at MSDN</a> for details. This link is for VBA but Format strings should be compatible.</p>\n\n<p>Please note that you still need to validate Input, <code>Format</code> function is not strict about input.</p>\n"}], "owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423077166, "creation_date": 1421787286, "question_id": 28054960, "link": "https://stackoverflow.com/questions/28054960/vb6-change-numeric-field-to-alphanumeric", "title": "VB6 Change Numeric Field To Alphanumeric", "body": "<p>There is a numeric field in a legacy application that I am trying to change to alphanumeric with a field length of about 15. The field is for data entry of account information. In the code, its referenced at numerous places:</p>\n\n<pre><code>.BANK_accno = Format(Me.txtBANK, \"####-##-##-##-##\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code>!BANK_accno = Format(Me.txtBANK, \"####-##-##-##-##\")\n</code></pre>\n\n<p>The Format is: ####-##-##-##-## and the Mask is ####-##-##-##-##. What I am wondering is what Format (and code) changes should I make to get the field to become alphanumeric? I tried using @@@@@@@@@@, however that has not worked.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 119, "user_id": 4475666, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100004637049977/picture?type=large", "display_name": "Tyler Veinot", "link": "https://stackoverflow.com/users/4475666/tyler-veinot"}, "edited": false, "score": 0, "creation_date": 1421790572, "post_id": 28054713, "comment_id": 44493280, "body": "I have gotten Closer with this using Application.FileDialog(msoFileDialogFolderPicker).ButtonName = &quot;Select Path&quot; I found on a VB Tutorial but I cannot seem to pass the variable to the ChangeDirectory everything saves in C:\\."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4475666, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100004637049977/picture?type=large", "display_name": "Tyler Veinot", "link": "https://stackoverflow.com/users/4475666/tyler-veinot"}, "edited": false, "score": 0, "creation_date": 1421841240, "post_id": 28056252, "comment_id": 44512954, "body": "Thank you! It took me a bit to insert it into my code block but once I did it worked fine."}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 119, "user_id": 4475666, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100004637049977/picture?type=large", "display_name": "Tyler Veinot", "link": "https://stackoverflow.com/users/4475666/tyler-veinot"}, "edited": false, "score": 0, "creation_date": 1421847700, "post_id": 28056252, "comment_id": 44516776, "body": "Thank you for the feedback.. If the answer helped, please do not forget to mark it so the question will no longer appear open (unanswered)."}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": false, "score": 1, "last_activity_date": 1421792665, "creation_date": 1421792665, "answer_id": 28056252, "question_id": 28054713, "link": "https://stackoverflow.com/questions/28054713/folder-picker-for-ms-word/28056252#28056252", "title": "Folder Picker for MS Word", "body": "<p>First <a href=\"https://www.google.sk/search?q=select+directory+vba\" rel=\"nofollow\">Google match</a> gave me <a href=\"http://www.mrexcel.com/forum/excel-questions/294728-browse-folder-visual-basic-applications.html\" rel=\"nofollow\">this</a>:</p>\n\n<pre><code>Function GetFolder(strPath As String) As String\n    Dim fldr As FileDialog\n    Dim sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = strPath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nEnd Function\n</code></pre>\n\n<p>Tested: works fine. In the above code you can also see how they set initial path.</p>\n"}], "owner": {"reputation": 119, "user_id": 4475666, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100004637049977/picture?type=large", "display_name": "Tyler Veinot", "link": "https://stackoverflow.com/users/4475666/tyler-veinot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4028, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594070101, "creation_date": 1421786318, "last_edit_date": 1594070101, "question_id": 28054713, "link": "https://stackoverflow.com/questions/28054713/folder-picker-for-ms-word", "title": "Folder Picker for MS Word", "body": "<p>I am working on a Mail Merge Export Function. I would like to add a \"Select Folder\" Dialog box.</p>\n\n<p>I found this in my googling which is similar (<a href=\"https://stackoverflow.com/questions/18358964/browse-button-in-input-box-to-find-file-excel2007-vba\">browse button in input box to find file Excel2007 Vba</a> ) but I want to choose a folder, not a file. The file name and type is auto generated through the export.</p>\n\n<pre><code>Sub Export_Docs()\n    'Used to set criteria for moving through the document by section.\n    Application.Browser.Target = wdBrowseSection\n\n    'A mailmerge document ends with a section break next page.\n    'Subtracting one from the section count stop error message.\n    For i = 1 To ((ActiveDocument.Sections.Count) - 1)\n\n      'Select and copy the section text to the clipboard\n      ActiveDocument.Bookmarks(\"\\Section\").Range.Copy\n\n      'Create a new document to paste text from clipboard.\n      Documents.Add\n      'To save your document with the original formatting'\n      Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\n      'Removes the break that is copied at the end of the section, if any.\n      Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend\n      Selection.Delete Unit:=wdCharacter, Count:=1\n      'Sets Save Location and Document Name Parameters'\n\n      ChangeFileOpenDirectory \"C:\\Users\\tveinot\\Documents\\Asset Management\\Buildings\\\"\n      MyString = ActiveDocument.Tables(1).Cell(6, 3).Range.Text\n      Filename = Left(MyString, 13)\n      DocNum = DocNum + 1\n      ActiveDocument.SaveAs Filename:=Filename &amp; \".doc\"\n      ActiveDocument.Close\n      'Move the selection to the next section in the document\n      Application.Browser.Next\n    Next i\n    ActiveDocument.Close savechanges:=wdDoNotSaveChanges\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "macos", "ms-word", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1421787317, "creation_date": 1421787317, "answer_id": 28054970, "question_id": 28054261, "link": "https://stackoverflow.com/questions/28054261/retrieving-html-source-code-using-mac-vba-word-2011/28054970#28054970", "title": "Retrieving HTML Source Code using - MAC VBA Word 2011", "body": "<p>It's worthy to say that this <a href=\"http://answers.microsoft.com/en-us/mac/forum/macoffice2011-macexcel/need-xmlhttp-request-like-feature-in-excel-for-mac/f2b5aca7-fcbb-4c60-b606-27e1c4a0fcd9\" rel=\"nofollow\">information</a> goes back to the 2012, so maybe something has changed meanwhile.</p>\n\n<p>As for what the MVP of the question above says, <code>ActiveX</code> is a Windows-only technology that has not been ported to Mac (yet?), so the <code>XMLHTTP</code> request initialization will fail with a run-time error <code>ActiveX component cannot create object</code>.<br>\nYou might be interested in using a <a href=\"http://support2.microsoft.com/default.aspx?scid=kb;en-us;274787\" rel=\"nofollow\">Web Query</a>, which is instead usable by a Mac according to the Microsoft Official source. </p>\n"}], "owner": {"reputation": 127, "user_id": 4425378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9IEFS.png?s=128&g=1", "display_name": "Clyde", "link": "https://stackoverflow.com/users/4425378/clyde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 28054970, "answer_count": 1, "score": 0, "last_activity_date": 1592988832, "creation_date": 1421784506, "last_edit_date": 1592988832, "question_id": 28054261, "link": "https://stackoverflow.com/questions/28054261/retrieving-html-source-code-using-mac-vba-word-2011", "title": "Retrieving HTML Source Code using - MAC VBA Word 2011", "body": "<p>Below Is my Code to read source code from websites on windows operating system.</p>\n\n<pre><code>Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\nURL = \"http://webste.com\"   'Replace http://webste.com with your own website.\nobjHTTP.Open \"GET\", URL, False\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nobjHTTP.send (\"\")\nHTML = objHTTP.responseText\n</code></pre>\n\n<p>I would like to find something similar for Mac VBA Word 2011. I've been trying for days to find something that will work for Mac to no avail. Please if you have a link to another post or some code that works let me know. Preferably code that works without downloading anything, so it works on any Mac.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 12341, "user_id": 3678068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QWjMd.png?s=128&g=1", "display_name": "Fabricator", "link": "https://stackoverflow.com/users/3678068/fabricator"}, "edited": false, "score": 0, "creation_date": 1421784356, "post_id": 28054120, "comment_id": 44490286, "body": "It would be nice to have some examples. I think <code>indirect</code> might help in this situation."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 12341, "user_id": 3678068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QWjMd.png?s=128&g=1", "display_name": "Fabricator", "link": "https://stackoverflow.com/users/3678068/fabricator"}, "edited": false, "score": 0, "creation_date": 1421785472, "post_id": 28054120, "comment_id": 44490823, "body": "I will try to add an example with dummy data as soon as possible"}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421786379, "post_id": 28054589, "comment_id": 44491288, "body": "I didn&#39;t know you could vlookup with a string as your reference, that&#39;s cool.  But in need my col_index_num to be a string, not a number.  Or, the number of the column that is a certain string, if that makes sense."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 1, "creation_date": 1421787130, "post_id": 28054589, "comment_id": 44491644, "body": "Perhaps we are misunderstanding each other. Using my mock formula, Excel will pick the col_index_num that corresponds to the string &quot;DAY2&quot;. So, if DAY2 is the third column, as it is in my example, the col_index_num will be three. If it moves, the col_index_num will likewise update. Is this not what you needed?"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421788322, "post_id": 28054589, "comment_id": 44492198, "body": "are you sure it will update?  If I make a macro to do a specific vlookup and write in a # for col_index_num, and then next month the column location is not 3 but 16, how will the macro know to change col_index_num to 16?  I edited my question with an example to hopefully clarify.  Thanks!"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421789262, "post_id": 28054589, "comment_id": 44492648, "body": "Per my code, your don&#39;t enter a specific number for col_index_num. Instead, you use the MATCH function to return the col_index_num for you. Instead of a number, you enter the formula: MATCH(&quot;DEAL&quot;,A1:D1,0) where the col_index_num would normally go. If deal is the first column, col_index_num would automatically return 1. If it is in column 2 next month, col_index_num would find the text DEAL and return the corresponding column. Does that clear things up?"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421791179, "post_id": 28054589, "comment_id": 44493555, "body": "Oh, I apologize.  Let me try this and get back to you ASAP!"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421792295, "post_id": 28054589, "comment_id": 44494097, "body": "Oh man, I think that works!!  Much simpler than I thought it would be.  I&#39;m going to keep testing this but if all goes well, this will be marked as correct and upvoted.  Thanks so much!!"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1421792393, "post_id": 28054589, "comment_id": 44494149, "body": "No problem! Let us know if you have additional problems."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1421857790, "post_id": 28054589, "comment_id": 44523658, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/69326/discussion-between-msim-and-user3561813\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 3, "last_activity_date": 1421785823, "creation_date": 1421785823, "answer_id": 28054589, "question_id": 28054120, "link": "https://stackoverflow.com/questions/28054120/excel-lookup-data-based-on-column-name-not-cell-name/28054589#28054589", "title": "Excel Lookup Data Based on Column Name not Cell Name", "body": "<p>If you combine <code>VLOOKUP</code> with <code>MATCH</code> you can search based on column name, not index. Remember that the <code>MATCH</code> function returns the numeric index of the match. Let's assume that your data looks like the below:</p>\n\n<pre><code>NAME    DAY1    DAY2    DAY3\nBob     123     345     567\nTim     456     789     998\n</code></pre>\n\n<p>A functioning Vlookup to return the DAY2 column for Tim would look like:</p>\n\n<pre><code>=VLOOKUP(\"Tim\", A2:D3,MATCH(\"DAY2\",A1:D1,0),FALSE)\n</code></pre>\n\n<p>A couple of notes. Where I've hard coded in words, you can use cell references. </p>\n"}, {"tags": [], "owner": {"reputation": 12341, "user_id": 3678068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QWjMd.png?s=128&g=1", "display_name": "Fabricator", "link": "https://stackoverflow.com/users/3678068/fabricator"}, "is_accepted": false, "score": 0, "last_activity_date": 1421790892, "creation_date": 1421790892, "answer_id": 28055848, "question_id": 28054120, "link": "https://stackoverflow.com/questions/28054120/excel-lookup-data-based-on-column-name-not-cell-name/28055848#28055848", "title": "Excel Lookup Data Based on Column Name not Cell Name", "body": "<p>Here is one idea:</p>\n\n<ul>\n<li>get the index of the column <code>ID#</code> in Sheet2 <code>MATCH(\"ID#\",Sheet2!$1:$1,0)</code></li>\n<li>convert to a character: <code>CHAR(MATCH(\"ID#\",Sheet2!$1:$1,0)+64)</code></li>\n<li>get the column range: \n  <code>INDIRECT(\n     CONCATENATE(\"Sheet2!\",\n                 CHAR(MATCH(\"ID#\",Sheet2!$1:$1,0)+64),\":\",\n                 CHAR(MATCH(\"ID#\",Sheet2!$1:$1,0)+64)))</code></li>\n<li>similarly for column <code>AltID#</code>:<br>\n<code>INDIRECT(\n     CONCATENATE(\"Sheet2!\",\n                 CHAR(MATCH(\"AltID#\",Sheet2!$1:$1,0)+64),\":\",\n                 CHAR(MATCH(\"AltID#\",Sheet2!$1:$1,0)+64)))</code></li>\n</ul>\n\n<p>with range of <code>ID#</code> and <code>AltID#</code>, we can do the match+index:</p>\n\n<pre><code>=INDEX(\n   INDIRECT(\n     CONCATENATE(\"Sheet2!\",\n                 CHAR(MATCH(\"AltID#\",Sheet2!$1:$1,0)+64),\":\",\n                 CHAR(MATCH(\"AltID#\",Sheet2!$1:$1,0)+64))),\n   MATCH(A2,INDIRECT(\n              CONCATENATE(\"Sheet2!\",\n                          CHAR(MATCH(\"ID#\",Sheet2!$1:$1,0)+64),\":\",\n                          CHAR(MATCH(\"ID#\",Sheet2!$1:$1,0)+64))),0))\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2635, "favorite_count": 0, "accepted_answer_id": 28054589, "answer_count": 2, "score": 1, "last_activity_date": 1421790892, "creation_date": 1421783941, "last_edit_date": 1421788190, "question_id": 28054120, "link": "https://stackoverflow.com/questions/28054120/excel-lookup-data-based-on-column-name-not-cell-name", "title": "Excel Lookup Data Based on Column Name not Cell Name", "body": "<p>I am trying to accomplish a strange task in excel and don't know how to go about it.  I'm using Excel 2007 at work and I know very basic vba.</p>\n\n<p>I want to automate a process where a person takes three spreadsheets and dumps certain data from them into one master sheet.  The three spreadsheets vary every month in their column order, so unfortunately I can't just program vlookups to run and get the data.</p>\n\n<p>I could be wrong, but it seems like Vlookup Match, Index Match Match, etc. wouldn't work either because they are still referencing cells.  <strong>I basically need something that will find a column based on the text in the column, rather than its location, because the location will change, but the text will always be the same.</strong></p>\n\n<p>I have two ideas but I have no idea if they work and don't really know where to start on implementing them:</p>\n\n<ol>\n<li>Convert the three spreadsheets to tables and reference the headings with table syntax (I haven't been able to get this to work)</li>\n<li>Complex VBA that IDs everything</li>\n</ol>\n\n<p>Can anyone help point me in the right direction to accomplish this task?  Thanks so much for your help.</p>\n\n<p>EDIT EXAMPLE</p>\n\n<p>My main template that I'm trying to dump things into is just going to have the ID#s and empty columns:</p>\n\n<pre><code>ID#          AltID#          Deal\n1\n2\n3\n4\n5\n</code></pre>\n\n<p>And then another spread sheet might have look like this</p>\n\n<pre><code>ID#          AltID#          Deal\n1            10101           AAAA\n2            20202           BBBB\n3            30303           CCCC\n4            40404           DDDD\n5            50505           EEEE\n</code></pre>\n\n<p>I could of course vlookup, but the problem is next month, those columns in the second spreadsheet won't be in the same place, in the same order.  They could be all the way on colum DD or whatever.  So I need a formula that looks them up regardless of the columns location.  Just matching them by the heading text.  I hope that clarifies...</p>\n"}, {"tags": ["arrays", "excel", "vba", "range"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421819542, "post_id": 28054092, "comment_id": 44502222, "body": "What&#39;s stopping you from reaching your goal here?  Exactly which part are you having a problem with?"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "edited": false, "score": 0, "creation_date": 1421792114, "post_id": 28054941, "comment_id": 44494012, "body": "Well, I really need this in a VBA script.  Also I can&#39;t assume length of columns, this script will have to work without knowing the column lengths.  Thank you for this reply though, it is a great jumping off point."}, {"owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "edited": false, "score": 0, "creation_date": 1421846717, "post_id": 28054941, "comment_id": 44516165, "body": "thank you, I can certainly use this.  If I come up with some VBA I&#39;ll post it back here."}], "tags": [], "owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "is_accepted": false, "score": 0, "last_activity_date": 1421792211, "last_edit_date": 1421792211, "creation_date": 1421787238, "answer_id": 28054941, "question_id": 28054092, "link": "https://stackoverflow.com/questions/28054092/vba-excel-2010-specific-script-how-to-dealing-with-range-comparisons/28054941#28054941", "title": "VBA (Excel) 2010: specific script how-to, dealing with range comparisons", "body": "<p>A simple formula should do the job : assuming the data are found in A:C</p>\n\n<pre><code>=IF(ISBLANK(A2),\"\",IF(ISBLANK(C2),B2, SUMIFS(B:B,A:A,A2,C:C,1)))\n</code></pre>\n\n<p>The outer <code>IF</code> display nothing when <code>column A</code> is empty.<br>\nThe inner <code>IF</code> display<code>column B</code> when <code>column C</code> is empty.<br>\nThe <code>SUMIFS</code> will add up<code>column B</code> where <code>column A</code> is the same(as current row) and when <code>column C</code> is 1.</p>\n"}], "owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421792211, "creation_date": 1421783849, "question_id": 28054092, "link": "https://stackoverflow.com/questions/28054092/vba-excel-2010-specific-script-how-to-dealing-with-range-comparisons", "title": "VBA (Excel) 2010: specific script how-to, dealing with range comparisons", "body": "<p>I have 3 columns that follow these rules:</p>\n\n<ul>\n<li>Any cell in Col A may be empty, otherwise it contains a string.</li>\n<li>If a row in Col A is empty, that row in Col's B and C will be empty.</li>\n<li>If a row in Col A is populated, That row in Col B will be populated with an integer, and that row in Col C may be empty or have a \"1\".</li>\n</ul>\n\n<p>I need a script that, for each cell in Col A,</p>\n\n<ol>\n<li>Checks the string in that cell and looks for all identical strings in Col A.</li>\n<li>For each row containing said matching string, checks Col C for a \"1\"</li>\n<li>For each row where <strong>both</strong> of the above are true, sum the values in Col B and replace each of them with that sum.</li>\n</ol>\n\n<p>So for example, this:</p>\n\n<pre><code>A B C\nx 1  \nx 2  \nz 2 1\ny 1 1\ny 2 1\n\ny 1 \nz 2 1\nz 1 1\n</code></pre>\n\n<p>Should become this:</p>\n\n<pre><code>A B C\nx 1\nx 2\nz 5 1\ny 3 1\ny 3 1\n\ny 1\nz 5 1\nz 5 1\n</code></pre>\n\n<p>So 3 different strings are found in Col A, (x y and z). Duplicates of x are found but the values in col B are not summed because there was no \"1\" in Col C. Dupes of y are found, but only those with a \"1\" to the right are summed. All dupes of z found have a \"1\", so all are summed.</p>\n\n<p>What's the best way to do this? Please let me know if I need to clarify something about this question (I know it's convoluted, but I spent a lot of time trying to make it as clear as possible haha).</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421781274, "post_id": 28053343, "comment_id": 44488571, "body": "How is <i>minimo</i> declared?  If it&#39;s Integer, it can&#39;t accept a value larger than 32,767.  What is the value of <code>rs.Fields(0)</code> when you hit that error?"}], "answers": [{"comments": [{"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 4, "creation_date": 1421787999, "post_id": 28053553, "comment_id": 44492055, "body": "@MarcheseIlChihuahua \u2013 My practice is to insert <code>Option Explicit</code> as the first line of every program module (file). This forces me to declare every variable using <code>Dim</code> statement and this way I can avoid many errors similar to this one."}, {"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1421823556, "post_id": 28053553, "comment_id": 44503699, "body": "Miroxlav, just as an FYI i had declared that variable as Integer prior to taking your advice. After a bit of research it seemed to me that this problem resulted from the fact that the underlying field which was being extracted was an automatic numerical field which was exceeding a large number. I am still a bit confused as to why this is a problem ."}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 1, "creation_date": 1421826721, "post_id": 28053553, "comment_id": 44504997, "body": "@MarcheseIlChihuahua - honestly, I&#39;m not sure how automatic data types work in some scenarios. The best approach is as follows: (1) check data type of your database field (of field <code>autoenumerazione</code> in this case) (2) determine maximum and minimum value for this data type (use <b>MS Access Help</b>) (3) find corresponding data type in VBA (Integer? Long? use <b>VBA Help</b>) (4) declare variable of given data type. If you determined data type correctly, it will be large enough to accept all values coming from the database."}, {"owner": {"reputation": 79, "user_id": 10513813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ugWYBaJe6oU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUjBFbZomC0gX-qq-RX0fGC84mOAA/mo/photo.jpg?sz=128", "display_name": "Jesse Zarzycki", "link": "https://stackoverflow.com/users/10513813/jesse-zarzycki"}, "edited": false, "score": 0, "creation_date": 1570024664, "post_id": 28053553, "comment_id": 102784170, "body": "this is an old post but good god I was tearing my head out for a solution and this fixed it. thank you so much!"}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": true, "score": 3, "last_activity_date": 1421781839, "creation_date": 1421781839, "answer_id": 28053553, "question_id": 28053343, "link": "https://stackoverflow.com/questions/28053343/runtime-error-6-overflow/28053553#28053553", "title": "runtime error 6 overflow", "body": "<p>Try inserting the following line at the start of the program:</p>\n\n<pre><code>Dim minimo as Long\n</code></pre>\n"}], "owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8274, "favorite_count": 0, "accepted_answer_id": 28053553, "answer_count": 1, "score": 2, "last_activity_date": 1594654646, "creation_date": 1421781066, "last_edit_date": 1594654646, "question_id": 28053343, "link": "https://stackoverflow.com/questions/28053343/runtime-error-6-overflow", "title": "runtime error 6 overflow", "body": "<p>I am getting a Runtime error 6 'overflow' message on the following code upon arriving at the line starting with 'minimo'.  It was working fine until recently. After providing some cosmetic-type updates to its underlying form this message has arrived and I can't understand why.</p>\n\n<pre><code>'Dim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nrs.Open \"select min(autonumerazione) from tblDashboard01\", CurrentProject.Connection\n\nDo While Not rs.EOF\nminimo = rs.Fields(0)\nrs.MoveNext\nLoop\nminimo = minimo - 1\nst_Sql = \"update tbldashboard01 set MasterLevel = autonumerazione - \" &amp; minimo &amp; \"\"\nApplication.DoCmd.RunSQL (st_Sql)\n</code></pre>\n"}, {"tags": ["excel", "button", "next", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1421784474, "post_id": 28053816, "comment_id": 44490342, "body": "I had been trying yo use the cnt variables to add counters to the buttons, but I will try your method and see if it cooperates with me haha. I&#39;ll let you know if I have any issues or if it works first try."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1421785170, "post_id": 28053816, "comment_id": 44490668, "body": "Cool. Keep us posted. Sounds to me like counters attached to the button are unnecessary."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1421785234, "post_id": 28053816, "comment_id": 44490697, "body": "Your solution worked very well. Defenitely took out the overcomplications I made. Thank you so much!"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1421785300, "post_id": 28053816, "comment_id": 44490729, "body": "Very happy to hear that. Keep us posted if you have any other issues."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422559999, "post_id": 28053816, "comment_id": 44809054, "body": "I&#39;ve run into another issue. I want to use the Prev/Next buttons again with filtered results so that they only go between the rows that have a specific value in it. This value will be selected in a combobox elsewhere."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422560484, "post_id": 28053816, "comment_id": 44809296, "body": "By filtered, do you mean you&#39;ve used the built-in Excel AutoFilter feature? Or, instead, do you want to jump over rows that do not have the value in the combobox, but the sheet is not being filtered?"}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422560784, "post_id": 28053816, "comment_id": 44809449, "body": "Yes, I just want to jump over rows that do no have the value in the combobox. I am not using the autofilter."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422563717, "post_id": 28053816, "comment_id": 44811218, "body": "I&#39;ve edited the code above, making changes to the code for the previous and next buttons. Now, the code enters a loop that traverses rows until it finds a match to the value in the combobox. Needless to say, adjust the object names to match those in your workbook. Let me know if this works."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422565774, "post_id": 28053816, "comment_id": 44812354, "body": "So far it&#39;s just pulling the column headers and then erroring out. I&#39;m not sure what would cause that. I don&#39;t have a lot of time left today, so I might not get back to it until a week or two. Thanks for all the help so far."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422566640, "post_id": 28053816, "comment_id": 44812852, "body": "I added it to the end of the first post."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422567034, "post_id": 28053816, "comment_id": 44813052, "body": "I&#39;m a bit confused. In the code above, you have <code>nCurrentRow2</code>, but I don&#39;t see that variable being declared. I also see a reference to a <code>TraverseData2</code> subroutine that is also not being references. Is this correct?"}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422567216, "post_id": 28053816, "comment_id": 44813155, "body": "Sorry, I had been testing something and forgot to take those out."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422568193, "post_id": 28053816, "comment_id": 44813703, "body": "Are the loop conditions met? In the current code, it loops until the value in Column A of <code>nCurrentRow</code> matches the value in the <code>ComboBox12</code>. Is this condition ever met? I created mock spreadsheet/userform to test out the code, and it seems to work fine otherwise."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1422981169, "post_id": 28053816, "comment_id": 44959159, "body": "Ok I see my issue. I was trying to look through more than just column a. Earlier in my code I have a variable that identifies column selected and I just used that instead of column a. Now it works great. Thank you so much for all your help."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1422563651, "last_edit_date": 1422563651, "creation_date": 1421782902, "answer_id": 28053816, "question_id": 28053117, "link": "https://stackoverflow.com/questions/28053117/using-next-and-previous-buttons-in-vba-to-load-userform-given-data-in-excel/28053816#28053816", "title": "Using Next and Previous Buttons in VBA to Load Userform Given Data in Excel", "body": "<p>I'm having a difficult time determining what <code>cnt1 and</code>cnt2 refer to.</p>\n\n<p>In my opinion, you only need one publicly declared variable used to reference the row of data that is loaded into the table. That variable should be set once the userform is loaded based on desired behavior. For example, the userform loads with data from the last row.</p>\n\n<p>Check the below code as a basis and let me know if it helps at all:</p>\n\n<pre><code>    Public nCurrentRow As Long\n\nPrivate Sub cmdNext_Click()\n    Do\n        nCurrentRow = nCurrentRow + 1\n        TraverseData (nCurrentRow)\n    Loop Until Sheet1.Cells(nCurrentRow, 1).Value = \"\" Or Sheet1.Cells(nCurrentRow, 1).Value = Me.ComboBox1.Value\nEnd Sub\n\nPrivate Sub cmdPrev_Click()\n    Do\n        nCurrentRow = nCurrentRow - 1\n        TraverseData (nCurrentRow)\n    Loop Until nCurrentRow = 1 Or Sheet1.Cells(nCurrentRow, 1).Value = Me.ComboBox1.Value\nEnd Sub    \n    Private Sub UserForm_Initialize()\n        nCurrentRow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n        TraverseData (nCurrentRow)\n    End Sub\n\n    Private Sub TraverseData(nRow As Long)\n        Me.TextBox1.Value = Sheet1.Cells(nRow, 1)\n        Me.TextBox2.Value = Sheet1.Cells(nRow, 2)\n        Me.TextBox3.Value = Sheet1.Cells(nRow, 3)\n    End Sub\n</code></pre>\n\n<p>Needless to say, it must be amended to handle each of your individual userform controls. Additionally, reuse your error checking to confirm that it doesn't traverse into negative rows (you've already done this in your version of the code).</p>\n\n<p>Notice I encapsulated the `TraverseData into its own SubRoutine so you don't have to rewrite it for each button. It really cleans up the data.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1421785292, "post_id": 28053874, "comment_id": 44490723, "body": "Thank you for answering as well, your code helped me with a different area I was struggling with."}], "tags": [], "owner": {"reputation": 564, "user_id": 4175088, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KlNYj.jpg?s=128&g=1", "display_name": "blindguy", "link": "https://stackoverflow.com/users/4175088/blindguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1421783098, "creation_date": 1421783098, "answer_id": 28053874, "question_id": 28053117, "link": "https://stackoverflow.com/questions/28053117/using-next-and-previous-buttons-in-vba-to-load-userform-given-data-in-excel/28053874#28053874", "title": "Using Next and Previous Buttons in VBA to Load Userform Given Data in Excel", "body": "<pre><code>Public ViewRow as long\n\n'Prev Button\nPrivate Sub CommandButton5_Click()\n\nif ViewRow &gt; 1 then 'assumes row 1 is the first row\n    ViewRow = ViewRow - 1\n    CommandButton5.Enabled = True\n    if ViewRow = 1 then\n        MsgBox \"This is the first entry.\", , \"Alert!\"\n        CommandButton4.Enabled = False\n    end if\nend if\n\n\nSheet4.Activate\n\nComboBox1.Value = Cells(ViewRow, 1)\n...\nTextBox5.Value = Cells(ViewRow, 15)\n\n\nMe.Label15.Caption = ViewRow &amp; \"  \" &amp; \"of\" &amp; \"  \" &amp; WorksheetFunction.CountA(Range(\"A:A\"))\n\nEnd Sub\n\n\n'Next button\nPrivate Sub CommandButton5_Click()\nif ViewRow &lt; WorksheetFunction.CountA(Range(\"A:A\")) then\n    ViewRow = ViewRow + 1\n    CommandButton4.Enabled = True\n    if ViewRow = 1 then\n        MsgBox \"This is the last entry.\", , \"Alert!\"\n        CommandButton5.Enabled = False\n    end if\nend if\n\nSheet4.Activate\n\nComboBox1.Value = Cells(NextRow1, 1)\n...\nTextBox5.Value = Cells(NextRow1, 15)\n\n\nMe.Label15.Caption = ViewRow &amp; \"  \" &amp; \"of\" &amp; \"  \" &amp; WorksheetFunction.CountA(Range(\"A:A\"))\nEnd Sub\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Public ViewRow as long\n\n'Prev Button\nPrivate Sub CommandButton5_Click()\n\nif ViewRow &gt; 1 then 'assumes row 1 is the first row\n    ViewRow = ViewRow - 1\n    CommandButton5.Enabled = True\n    if ViewRow = 1 then\n        MsgBox \"This is the first entry.\", , \"Alert!\"\n        CommandButton4.Enabled = False\n    end if\nend if\n\ncall populate_row(ViewRow)\n\nEnd Sub\n\n\n   'Next button\n   Private Sub CommandButton5_Click()\n   if ViewRow &lt; WorksheetFunction.CountA(Range(\"A:A\")) then\n        ViewRow = ViewRow + 1\n        CommandButton4.Enabled = True\n        if ViewRow = 1 then\n            MsgBox \"This is the last entry.\", , \"Alert!\"\n            CommandButton5.Enabled = False\n        end if\n    end if\n\ncall populate_row(ViewRow)\nEnd Sub\n\nSub populate_row(thisrow as long)\nSheet4.Activate\n\nComboBox1.Value = Cells(NextRow1, 1)\n...\nTextBox5.Value = Cells(NextRow1, 15)\n\n\n    Me.Label15.Caption = ViewRow &amp; \"  \" &amp; \"of\" &amp; \"  \" &amp;      WorksheetFunction.CountA(Range(\"A:A\"))\nEnd Sub\n</code></pre>\n\n<p>The second option lets you make changes to how the data is added to the form without changing both functions.</p>\n"}], "owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11421, "favorite_count": 0, "accepted_answer_id": 28053816, "answer_count": 2, "score": 0, "last_activity_date": 1426243988, "creation_date": 1421780281, "last_edit_date": 1531161705, "question_id": 28053117, "link": "https://stackoverflow.com/questions/28053117/using-next-and-previous-buttons-in-vba-to-load-userform-given-data-in-excel", "title": "Using Next and Previous Buttons in VBA to Load Userform Given Data in Excel", "body": "<p>I am working on a userform in excel-VBA. I am trying to use a next and previous button to cycle through previous entries in a table. The previous button should select the previous row and load it into the userform. The next button should select the next row and load it into the userform as well.The data table has no set length. Below is my attempt at this. I know I have a disconnect between the two buttons function and am not sure how to connect them.  Any help would be greatly appreiciated. I will respond as quickly as I can.</p>\n\n<pre><code>Public PrevRow1 As Long\nPublic cnt1 As Long\nPublic cnt2 As Long\n\n'Prev Button\nPrivate Sub CommandButton4_Click()\ncnt1 = cnt1 + 1\n\n\nSheet4.Activate\nPrevRow1 = WorksheetFunction.CountA(Range(\"A:A\")) + 1 - cnt1 + cnt2\nComboBox1.Value = Cells(PrevRow1, 1)\nComboBox10.Value = Cells(PrevRow1, 2)\nComboBox2.Value = Cells(PrevRow1, 3)\nComboBox3.Value = Cells(PrevRow1, 4)\nComboBox4.Value = Cells(PrevRow1, 5)\nTextBox6.Value = Cells(PrevRow1, 6)\nTextBox2.Value = Cells(PrevRow1, 7)\nTextBox3.Value = Cells(PrevRow1, 8)\nTextBox4.Value = Cells(PrevRow1, 10)\nComboBox6.Value = Cells(PrevRow1, 11)\nComboBox7.Value = Cells(PrevRow1, 12)\nComboBox8.Value = Cells(PrevRow1, 13)\nComboBox9.Value = Cells(PrevRow1, 14)\nTextBox5.Value = Cells(PrevRow1, 15)\n\nIf PrevRow1 = 1 Then\nMsgBox \"This is the last entry.\", , \"Alert!\"\n\nCommandButton4.Enabled = False\nEnd If\n\n\n\n\nMe.Label15.Caption = PrevRow1 - 1 &amp; \"  \" &amp; \"of\" &amp; \"  \" &amp;   WorksheetFunction.CountA(Range(\"A:A\")) - 1\n\nEnd Sub\n\n\n'Next button\nPrivate Sub CommandButton5_Click()\nDim i As Long\n\ncnt2 = cnt2 + 1\n\n\nDim NextRow1 As Long\nSheet4.Activate\nNextRow1 = PrevRow1 - (cnt1 - cnt2) + 3\n\n\nComboBox1.Value = Cells(NextRow1, 1)\nComboBox10.Value = Cells(NextRow1, 2)\nComboBox2.Value = Cells(NextRow1, 3)\nComboBox3.Value = Cells(NextRow1, 4)\nComboBox4.Value = Cells(NextRow1, 5)\nTextBox6.Value = Cells(NextRow1, 6)\nTextBox2.Value = Cells(NextRow1, 7)\nTextBox3.Value = Cells(NextRow1, 8)\nTextBox4.Value = Cells(NextRow1, 10)\nComboBox6.Value = Cells(NextRow1, 11)\nComboBox7.Value = Cells(NextRow1, 12)\nComboBox8.Value = Cells(NextRow1, 13)\nComboBox9.Value = Cells(NextRow1, 14)\nTextBox5.Value = Cells(NextRow1, 15)\n\n\n\nMe.Label15.Caption = NextRow1 - 1 &amp; \"  \" &amp; \"of\" &amp; \"  \" &amp; WorksheetFunction.CountA(Range(\"A:A\")) - 1\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>New Code</p>\n\n<pre><code>Public nCurrentRow As Long\n\nSub UserForm_Initialize()\nnCurrentRow = Sheets(4).Cells(Rows.Count, 1).End(xlUp).Row\nTraverseData (nCurrentRow)\nend sub\n\n'Prev button\nPrivate Sub CommandButton14_Click()\nDo\n    nCurrentRow = nCurrentRow - 1\n    TraverseData (nCurrentRow)\nLoop Until nCurrentRow = 1 Or Sheets(4).Cells(nCurrentRow, 1).Value = Me.ComboBox12.Value\nEnd Sub\n\n'Next Button\nPrivate Sub CommandButton15_Click()\n\nDo\n    nCurrentRow = nCurrentRow + 1\n    TraverseData (nCurrentRow)\nLoop Until Sheets(4).Cells(nCurrentRow, 1).Value = \"\" Or Sheets(4).Cells(nCurrentRow, 1).Value = Me.ComboBox12.Value\nEnd Sub\n\nPrivate Sub TraverseData(nRow As Long)\nMe.ComboBox1.Value = Sheets(4).Cells(nRow, 1)\nMe.ComboBox10.Value = Sheets(4).Cells(nRow, 2)\nMe.ComboBox2.Value = Sheets(4).Cells(nRow, 3)\nMe.ComboBox3.Value = Sheets(4).Cells(nRow, 4)\nMe.ComboBox4.Value = Sheets(4).Cells(nRow, 5)\nMe.TextBox6.Text = Sheets(4).Cells(nRow, 6)\nMe.TextBox2.Text = Sheets(4).Cells(nRow, 7)\nMe.TextBox3.Value = Sheets(4).Cells(nRow, 8)\nMe.TextBox4.Value = Sheets(4).Cells(nRow, 10)\nMe.ComboBox6.Value = Sheets(4).Cells(nRow, 11)\nMe.ComboBox7.Value = Sheets(4).Cells(nRow, 12)\nMe.ComboBox8.Value = Sheets(4).Cells(nRow, 13)\nMe.ComboBox9.Value = Sheets(4).Cells(nRow, 14)\nMe.TextBox5.Value = Sheets(4).Cells(nRow, 15)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 1, "creation_date": 1421780391, "post_id": 28053012, "comment_id": 44488105, "body": "Please add more specifics by providing the code snippet you are working on and clearly identifying the problematic part. Best regards,"}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1421782770, "post_id": 28053012, "comment_id": 44489404, "body": "Private pFields As New Collection and Private pFields As New SampleFields seems ambiguous. Btw, why do you need a Collection class if it&#39;s already a built-in object in Excel VBA?"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "reply_to_user": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1421783411, "post_id": 28053012, "comment_id": 44489756, "body": "I may need some custom properties/methods of the collection besides the 4 the built-in collection has."}], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 3, "last_activity_date": 1496821076, "last_edit_date": 1496821076, "creation_date": 1496672847, "answer_id": 44371239, "question_id": 28053012, "link": "https://stackoverflow.com/questions/28053012/excel-vba-creating-a-collection-class-within-a-parent-class/44371239#44371239", "title": "Excel VBA - creating a collection class within a parent class", "body": "<p>Very old post, but let me at least answer this:\nIn the sample class, have a Collection. You can forget about the SampleFields class, it's not needed.</p>\n\n<p>Then you only need to have one SampleField class that you pass to this SampleClass method \"AddField\" that you use to increase the size of the collection.</p>\n\n<p>Sample class should look like this:</p>\n\n<pre><code>Private p_SampleFields as Collection\nPrivate p_SampleField as SampleField\n\n'Initialize this class with it's collection:\nPrivate Sub Class_Initialize()\n    Set p_SampleFields = New Collection\nEnd Sub\n\n'Allow for adding SampleFields:\nPublic Sub AddField(field as SampleField)\n    Set p_SampleField = field\n    p_sampleFields.add field\nEnd Sub\n\n'Expose the collection:\nPublic Property Get SampleFields() as Collection\n    Set SampleFields = p_SampleFields\nEnd Property\n</code></pre>\n\n<p>In a regular module you can then use the following:</p>\n\n<pre><code>Sub Test()\n    Dim sField as SampleField\n    Dim sClass as SampleClass\n\n    Set sField = New SampleField\n    Set sClass = New SampleClass\n\n    sField.Name = \"SomeName\"\n    sClass.AddField sField 'This adds it to the collection\n\n    'Access as per requirement:\n    msgbox sClass.SampleFields(1).Name 'Pop-up saying \"SomeName\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "is_accepted": false, "score": -1, "last_activity_date": 1558660500, "last_edit_date": 1558660500, "creation_date": 1557961648, "answer_id": 56158744, "question_id": 28053012, "link": "https://stackoverflow.com/questions/28053012/excel-vba-creating-a-collection-class-within-a-parent-class/56158744#56158744", "title": "Excel VBA - creating a collection class within a parent class", "body": "<p>With a little change in Rik's answer, we can use a public collection, eliminating the need of AddField and Get methods:</p>\n\n<p><strong>Class SampleClass:</strong></p>\n\n<pre><code>Public SampleFields As Collection\n\nPrivate Sub Class_Initialize()\n    Set SampleFields = New Collection\nEnd Sub\n</code></pre>\n\n<p>Then to use it in your module:</p>\n\n<pre><code>Sub Test()\n    Dim sField as AnyOtherClass\n    Dim sClass as SampleClass\n\n    Set sField = New AnyOtherClass\n    Set sClass = New SampleClass\n\n    sField.Name = \"SomeName\"\n    sClass.SampleFields.add sField 'This adds it to the collection\n\n    'Access as per requirement:\n    msgbox sClass.SampleFields(1).Name 'Pop-up saying \"SomeName\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1558660500, "creation_date": 1421779916, "last_edit_date": 1531164843, "question_id": 28053012, "link": "https://stackoverflow.com/questions/28053012/excel-vba-creating-a-collection-class-within-a-parent-class", "title": "Excel VBA - creating a collection class within a parent class", "body": "<p>I've been trying to create a class that is a collection of objects (of another class) and that is within a parent class. I've looked at several questions here but couldn't get it working. So if anyone can post a short code with my parameters, I'd be very grateful.</p>\n\n<p>My parent class is Sample. It should contain a collection SampleFields which should contain objects from the class SampleField. The SampleField objects have only a Name property and it is taken from cells A1 to D1. It should be possible to add and remove items from the SampleFields collection and modify the Name property of the SampleField objects. The SampleFields collection gets its objects upon the initialization of the Sample class.</p>\n\n<p>I need to access it like this - Sample.SampleFields(1).Name</p>\n\n<p>I think it's useless to post my attempt but here it is:</p>\n\n<pre><code>Sub test()\n\nDim a As New Sample, i As Variant\n\na.GetFields\n\nFor Each i In a.SampleFields\n    Debug.Print i.Name\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Sample class:</p>\n\n<pre><code>Private pFields As New SampleFields\n\nPublic Property Get SampleFields() As SampleFields\n    Set SampleFields= pFields\nEnd Property\n\nPublic Property Set SampleFields(ByVal value As SampleFields)\n    Set pFields = value\nEnd Property\n\nPrivate Sub Initialize_Class()\n    Set pFields = New SampleFields\nEnd Sub\n\n\nPublic Sub GetFields()\n\nDim rngHeaders As Range, rngCell As Range\nSet rngHeaders = Range(\"A1\").CurrentRegion.Rows(1)\n\nFor Each rngCell In rngHeaders.Cells\n    Dim newField As SampleField\n    newField.Name = rngCell.Value2\n    Me.Fields.AddNewField (newField)   'crashes here with Method or data member not found\nNext\n\nEnd Sub\n</code></pre>\n\n<p>SampleFields class:</p>\n\n<pre><code>Private pFields As New Collection\n\nPublic Sub AddNewField(FieldName As SampleField)\n    Me.AddNewField (FieldName)\nEnd Sub\n</code></pre>\n\n<p>SampleField class:</p>\n\n<pre><code>Private pName As String\n\nPublic Property Let Name(value As String)\n    pName = value\nEnd Property\n\nPublic Property Get Name() As String\n    Name = pName\nEnd Property\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421783026, "post_id": 28053000, "comment_id": 44489555, "body": "What does <code>MsgBox QuerySheet.QueryTables.Count</code> show you?"}, {"owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421783327, "post_id": 28053000, "comment_id": 44489719, "body": "Giving me back a 0. I have tried using QueryTables(&quot;Table Name&quot;), but no success with that either."}, {"owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421783525, "post_id": 28053000, "comment_id": 44489828, "body": "I may be calling a Query Table incorrectly? I connected Access and Excel and in the Command Text have a table named &quot;QUERY_1&quot;. I want to be able to change that name to &quot;QUERY_2&quot;. Is that not done through using the QueryTable function?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421783839, "post_id": 28053000, "comment_id": 44490003, "body": "&quot;subscipt out of range&quot; from <code>QuerySheet.QueryTables(1)</code> made me suspect <code>QuerySheet.QueryTables.Count</code> is zero.  But I&#39;ve never actually used QueryTables, so can&#39;t suggest how to fix it."}, {"owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421787128, "post_id": 28053000, "comment_id": 44491643, "body": "I think I have found a solution by using Querysheet.ListObject.Item(1).QueryTable. I am unsure why it needs to be called a List Object item first, but I also do not have much expereince with this. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "edited": false, "score": 0, "creation_date": 1421781030, "post_id": 28053310, "comment_id": 44488440, "body": "I should specify, I do have 3 other Sheets in this Workbook. I have edited the post to say &quot;Sheet1&quot; for simplicity however."}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": true, "score": 0, "last_activity_date": 1421781976, "last_edit_date": 1421781976, "creation_date": 1421780947, "answer_id": 28053310, "question_id": 28053000, "link": "https://stackoverflow.com/questions/28053000/working-with-query-table-in-excel-vba/28053310#28053310", "title": "Working with Query Table in Excel/VBA", "body": "<p><em>In a newly created MS Excel Workbook by default you have only 3 Worksheets, so pertinent to your case, either change the <code>ThisWorkbook.Sheets(\"Sheet4\")</code> to <code>ThisWorkbook.Sheets(\"Sheet3\")</code> , or add another Worksheet to make sure that <code>Sheet4</code> actually exists - issue resolved</em></p>\n\n<p>I would also recommend to modify your code by adding proper error handling as shown below:</p>\n\n<pre><code>Sub ChooseQueryTable()\n    Dim QueryARVIS As QueryTable\n    Dim QuerySheet As Worksheet\nOn Error GoTo err:\n    Set QuerySheet = ThisWorkbook.Sheets(\"Sheet1\")\n\n    If (QuerySheet.QueryTables.Count &gt; 0) Then\n        Set QueryARVIS = QuerySheet.QueryTables(1)\n        With QueryARVIS\n            .CommandType = xlCmdTable\n            .CommandText = \"10K_WELLCOUNT_PERMIAN_ID\"\n            .Refresh\n        End With\n    End If\n    Exit Sub\nerr:\n    MsgBox (err.Description)\nEnd Sub\n</code></pre>\n\n<p>Please make sure that <code>QuerySheet.QueryTables(1)</code> actually exists (most likely it doesn't). Hope this will help. Best regards</p>\n"}], "owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2216, "favorite_count": 0, "accepted_answer_id": 28053310, "answer_count": 1, "score": 1, "last_activity_date": 1453842219, "creation_date": 1421779867, "last_edit_date": 1453842219, "question_id": 28053000, "link": "https://stackoverflow.com/questions/28053000/working-with-query-table-in-excel-vba", "title": "Working with Query Table in Excel/VBA", "body": "<p>I am getting a \"Subscript out of Range\" Error 9 with my code. I have a Microsoft Access database connected to Excel and a table already made with the Query for Table \"QUERY_1\". I want to update the table with \"QUERY_2\" through using VBA. The error occurs on this line:</p>\n\n<pre><code>Set QueryARV = QuerySheet.QueryTables(1)\n</code></pre>\n\n<p>Here is the full procedure:</p>\n\n<pre><code>Sub ChooseQueryTable()\n\nDim QueryARV As QueryTable\nDim QuerySheet As Worksheet\n\nSet QuerySheet = ThisWorkbook.Sheets(\"Sheet1\")\nSet QueryARV = QuerySheet.QueryTables(1)\n\nWith QueryARV\n.CommandType = xlCmdTable\n.CommandText = \"QUERY_1\"\n.Refresh\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "webbrowser-control", "barcode"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2690652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3b8352d67f121e01d80b2ce7df298b?s=128&d=identicon&r=PG&f=1", "display_name": "user2690652", "link": "https://stackoverflow.com/users/2690652/user2690652"}, "edited": false, "score": 0, "creation_date": 1421780662, "post_id": 28053083, "comment_id": 44488237, "body": "Thanks for the quick response but I need to isolate the specific image, which I can identify by getElementByID, not take a screenshot. The other issue is that the window is not launched in full screen - the picture I want probably wouldn&#39;t even be included in the screenshot."}], "tags": [], "owner": {"reputation": 2020, "user_id": 4327668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ATSJq.png?s=128&g=1", "display_name": "Roman Canlas", "link": "https://stackoverflow.com/users/4327668/roman-canlas"}, "is_accepted": false, "score": 0, "last_activity_date": 1421780172, "creation_date": 1421780172, "answer_id": 28053083, "question_id": 28052796, "link": "https://stackoverflow.com/questions/28052796/copy-specific-image-from-webpage-and-paste-into-excel-using-vba/28053083#28053083", "title": "Copy specific image from webpage and paste into Excel using VBA", "body": "<p>You can follow the steps detailed over here:</p>\n\n<p><a href=\"http://social.technet.microsoft.com/wiki/contents/articles/23860.print-screen-to-an-image-using-access-vba.aspx\" rel=\"nofollow\">http://social.technet.microsoft.com/wiki/contents/articles/23860.print-screen-to-an-image-using-access-vba.aspx</a></p>\n\n<p>Although the example is used in Access, it's still VBA code so it still should work in Excel</p>\n"}], "owner": {"reputation": 63, "user_id": 2690652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3b8352d67f121e01d80b2ce7df298b?s=128&d=identicon&r=PG&f=1", "display_name": "user2690652", "link": "https://stackoverflow.com/users/2690652/user2690652"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2092, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594060536, "creation_date": 1421779189, "last_edit_date": 1594060536, "question_id": 28052796, "link": "https://stackoverflow.com/questions/28052796/copy-specific-image-from-webpage-and-paste-into-excel-using-vba", "title": "Copy specific image from webpage and paste into Excel using VBA", "body": "<p>I'm trying to take a character string from a cell, copy it into a free QR code generator (ex| <a href=\"http://goqr.me/\" rel=\"nofollow\">http://goqr.me/</a> ), and bring the resulting image back into my spreadsheet. (I like this generator because you don't need to click \"submit\" - it updates the image as the text is entered. Assuming/hoping that feature makes this easier) </p>\n\n<p>I'm trying to avoid the installation of new barcode fonts and the purchasing of barcode specific packages.</p>\n\n<p>Using the below code, I can get the browser to open and enter the desired text. I need a way to get the image back into my spreadsheet now. The code I'm using currently just returns \"[object]\" (as text) in cell C1. </p>\n\n<p>How can I use VBA to get this image onto my clipboard?</p>\n\n<pre><code>    Public ieApp As Object\n\nSub Barcode()\n\n  Dim ieDoc As Object\n  Dim InputBox As Object\n  Dim qrBoxImage as Object\n\n  barcodeTerm = Range(\"B1\").Value\n\n    If TypeName(ieApp) = \"Object\" Or TypeName(ieApp) = \"Nothing\" Then\n        Set ieApp = CreateObject(\"InternetExplorer.Application\")\n        ieApp.Navigate (\"http://goqr.me/\")\n\n    End If\n\n      While ieApp.ReadyState &lt;&gt; 4\n        DoEvents\n      Wend\n\n      ieApp.Visible = True\n\n      Set ieDoc = ieApp.Document\n\n        Set InputBox = ieDoc.getElementsByName(\"text\")\n        Set qrBoxImage = ieDoc.getElementByID(\"qrcode-preview-image\")\n\n\n        InputBox.Item(0).Value = barcodeTerm\n        Range(\"C1\").Value = qrBoxImage\n\n      Set ieDoc = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1421780256, "post_id": 28052870, "comment_id": 44488018, "body": "Can I get the range of the red and green area into one variable? I would like to set something like r = r.green + r.red"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1421780491, "post_id": 28052870, "comment_id": 44488151, "body": "@user1283776 That gets more complicated, but I added a link and code from the site related to REMOVING a portion of the range.  So you&#39;d want to remove the <code>Intersect</code> from the <code>Union</code>."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 1, "last_activity_date": 1421787843, "last_edit_date": 1495540619, "creation_date": 1421779460, "answer_id": 28052870, "question_id": 28052685, "link": "https://stackoverflow.com/questions/28052685/how-do-i-get-the-part-of-a-range-that-is-not-a-union/28052870#28052870", "title": "How do I get the part of a range that is not a union?", "body": "<p><code>Union()</code> method (<a href=\"http://msdn.microsoft.com/en-us/library/office/ff834621%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">MSDN Reference</a>) combines the ENTIRE ranges so there would never be parts of <code>r1</code> and <code>r2</code> that would not be in the <code>Union(r1, r2)</code>.</p>\n\n<p>If however, you are looking for overlap (and cells that do not overlap) you could look into <code>Intersect()</code> method (<a href=\"https://stackoverflow.com/questions/28052685/how-do-i-get-the-part-of-a-range-that-is-not-a-union\">MSDN Reference</a>)\n    Sub TestIt()</p>\n\n<pre><code>Dim r1 As Range, r2 As Range, r3 As Range\n    Set r1 = Range(\"A1:D4\")\n    Set r2 = Range(\"C3:F6\")\n    Set r3 = Intersect(r1, r2)\n    r1.Cells.Interior.Color = RGB(255, 0, 0)\n    r2.Cells.Interior.Color = RGB(0, 255, 0)\n    r3.Cells.Interior.Color = RGB(0, 0, 255)\n    If r3 Is Nothing Then\n        MsgBox \"Ranges do not overlap\"\n    Else\n        MsgBox \"r1 and r2 overlap at \" &amp; r3.Address\n    End If\nEnd Sub\n</code></pre>\n\n<p>A picture representation of <code>Intersect()</code> method:</p>\n\n<p><img src=\"https://i.stack.imgur.com/gbQRu.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/dEMPD.png\" alt=\"enter image description here\"></p>\n\n<p>There is some interesting functions related to finding the non-intersect portion.  I'd suggest @TimWilliam's answer <a href=\"https://stackoverflow.com/a/28054992/4241535\">FOUND HERE</a></p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 2102578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b15cc62dc43980b2a6ee7f1a6ee36ce9?s=128&d=identicon&r=PG", "display_name": "Jefry Sastre", "link": "https://stackoverflow.com/users/2102578/jefry-sastre"}, "is_accepted": false, "score": 0, "last_activity_date": 1421780211, "last_edit_date": 1421780211, "creation_date": 1421780074, "answer_id": 28053049, "question_id": 28052685, "link": "https://stackoverflow.com/questions/28052685/how-do-i-get-the-part-of-a-range-that-is-not-a-union/28053049#28053049", "title": "How do I get the part of a range that is not a union?", "body": "<p>If x belongs to r1 => x belongs to the union of r1 and somethings else.\nThere is nothing belonging to r1 that doesn't belong to the union.\nAnd it the same for r2.</p>\n"}, {"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421787760, "post_id": 28054992, "comment_id": 44491937, "body": "That was the code I was going for that I found off-site.  Much cleaner."}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1421843795, "post_id": 28054992, "comment_id": 44514411, "body": "Cool, very clever and a great utility function for me. I didn&#39;t know the answer would be this complex :-) Very easy to understand and clean code though. Thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1421787378, "creation_date": 1421787378, "answer_id": 28054992, "question_id": 28052685, "link": "https://stackoverflow.com/questions/28052685/how-do-i-get-the-part-of-a-range-that-is-not-a-union/28054992#28054992", "title": "How do I get the part of a range that is not a union?", "body": "<pre><code>Sub CombinedMinusIntersect()\n\n    Dim rng1 As Range, rng2 As Range, c As Range\n    Dim rngInt As Range, rngUnion As Range\n    Dim rngFinal As Range\n\n    Set rng1 = Range(\"A1:B5,C6:D10\")\n    Set rng2 = Range(\"D9:G16\")\n\n    Set rngUnion = Application.Union(rng1, rng2)\n    Set rngInt = Application.Intersect(rng1, rng2)\n\n    If Not rngInt Is Nothing Then\n        For Each c In rngUnion\n            If Application.Intersect(c, rngInt) Is Nothing Then\n                If rngFinal Is Nothing Then\n                    Set rngFinal = c\n                Else\n                    Set rngFinal = Application.Union(rngFinal, c)\n                End If\n            End If\n        Next c\n    Else\n        Set rngFinal = rngUnion\n    End If\n\n    rngFinal.Interior.Color = vbYellow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 28054992, "answer_count": 3, "score": 1, "last_activity_date": 1421787843, "creation_date": 1421778796, "last_edit_date": 1531164843, "question_id": 28052685, "link": "https://stackoverflow.com/questions/28052685/how-do-i-get-the-part-of-a-range-that-is-not-a-union", "title": "How do I get the part of a range that is not a union?", "body": "<p>I know that I can get the union of two ranges by writing:</p>\n\n<pre><code>Dim r1 as range\nDim r2 as range\nUnion(r1, r2)\n</code></pre>\n\n<p>But is there any I can get the range that is either in r1 or r2 but NOT in the union?</p>\n"}, {"tags": ["sql-server", "excel", "vba", "vb6"], "comments": [{"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1421779338, "post_id": 28052650, "comment_id": 44487518, "body": "<code>LoadFromFile()</code> takes a string as an argument, why are you assuming it is required to be hardcoded?  See <a href=\"http://stackoverflow.com/questions/1085436/how-to-use-open-file-dialog-in-vb-6\" title=\"how to use open file dialog in vb 6\">stackoverflow.com/questions/1085436/&hellip;</a> for how to get a file name from the user."}, {"owner": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "reply_to_user": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1421783700, "post_id": 28052650, "comment_id": 44489922, "body": "Ok, the customer now wants to do this saving the excel files to CSV which will be helpful since my knowledge of VB6 is so cursory. This form code linked should still be basically the same except for the file type so it is still very helpful. I now just need to figure out verifying that new user Ids imported don&#39;t mach existing and all users imported are marked as paid in the database. I appreciate your help"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "edited": false, "score": 0, "creation_date": 1421784044, "post_id": 28053372, "comment_id": 44490123, "body": "Do I need to use ADO and Jet to upload the records from VB6 to SQL? I guess I get confused about why a database engine is needed to import data into an existing database, Is it making the code work like a form? I really get confused by some things in VB6. Thank you for the help"}, {"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "reply_to_user": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "edited": false, "score": 0, "creation_date": 1421784240, "post_id": 28053372, "comment_id": 44490231, "body": "VB6 by itself doesn&#39;t know how to talk to a database.  You must use some data-library.  I think the progression was DAO, the RDO, then ADO.  But you gotta piggy back on some mdac technology.  Here is an article.  <a href=\"http://msdn.microsoft.com/en-us/library/aa231216%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa231216%28v=vs.60%29.aspx</a>"}, {"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "reply_to_user": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "edited": false, "score": 0, "creation_date": 1421784322, "post_id": 28053372, "comment_id": 44490269, "body": "Find the KB I mention for other ideas."}, {"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "reply_to_user": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "edited": false, "score": 1, "creation_date": 1421784407, "post_id": 28053372, "comment_id": 44490308, "body": "PS VB6 is an ancient technology.  Move away from it as soon as possible."}, {"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "reply_to_user": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "edited": false, "score": 0, "creation_date": 1421785798, "post_id": 28053372, "comment_id": 44490986, "body": "If this answer (or any answer) is helpful, you should upvote it.  If the answer satisfies or leads you to having your issue resolved, you should mark the answer as &quot;The Answer&quot;."}], "tags": [], "owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1421781140, "creation_date": 1421781140, "answer_id": 28053372, "question_id": 28052650, "link": "https://stackoverflow.com/questions/28052650/import-excel-data-into-sql-using-vb6/28053372#28053372", "title": "Import Excel Data into SQL using VB6", "body": "<p>With a 32 bit Machine (O/S):</p>\n\n<pre><code>Dim cn As ADODB.Connection\nDim strSQL As String\nDim lngRecsAff As Long\nSet cn = New ADODB.Connection\ncn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n    \"Data Source=C:\\test\\myfile.xls;\" &amp; _\n    \"Extended Properties=Excel 8.0\"\n\n'Import by using Jet Provider.\nstrSQL = \"SELECT * INTO [odbc;Driver={SQL Server};\" &amp; _\n    \"Server=&lt;server&gt;;Database=&lt;database&gt;;\" &amp; _\n    \"UID=&lt;user&gt;;PWD=&lt;password&gt;].MyTable \" &amp; _\n    \"FROM [MySheet$]\"\nDebug.Print strSQL\ncn.Execute strSQL, lngRecsAff, adExecuteNoRecords\nDebug.Print \"Records affected: \" &amp; lngRecsAff\n\ncn.Close\nSet cn = Nothing\n</code></pre>\n\n<p>Microsoft KB : 321686 has more ideas.</p>\n"}], "owner": {"reputation": 135, "user_id": 4420763, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/25203d98128c17cb035aa85d056e24b8?s=128&d=identicon&r=PG&f=1", "display_name": "Davidp04", "link": "https://stackoverflow.com/users/4420763/davidp04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421781140, "creation_date": 1421778673, "question_id": 28052650, "link": "https://stackoverflow.com/questions/28052650/import-excel-data-into-sql-using-vb6", "title": "Import Excel Data into SQL using VB6", "body": "<p>I'm completely new to Visual Basic and I now need to take a program that is entirely constructed in VB6 and add the ability to import a large set of records in bulk from an excel file into the current SQL Database. all of the examples I have found online are confusing and require hard-coding of the file name (ex. Using document As New Spreadsheet() document.LoadFromFile(\"SimpleReport.xls\")) yet this needs to be called by a user anytime they get a new set of records so I need the excel file name to be specified at time of import. </p>\n\n<p>How do I import from excel to SQL using VB6? Can I make a variable for the excel filename or does the string value of the filename have to be hard coded? If I can make a variable can/should I add set and get to it in order to specify the filename? Thanks</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "edited": false, "score": 0, "creation_date": 1421949021, "post_id": 28056553, "comment_id": 44566692, "body": "Miroxlav, thanks for your input, sorry for the delayed response (been working out the code).  It was just what I needed to point me in the right direction (I&#39;ll post my updated code below).  On the topic of SQL injection attacks, I&#39;m not sure how I would change my SQL statement to be more secure... changing it is a little beyond me right now... Do you have any suggestions or resources I could use?  I&#39;ve looked at a few web pages... but none seem to address this particular usage of the wild card (that I can comprehend)."}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": true, "score": 0, "last_activity_date": 1421793988, "creation_date": 1421793988, "answer_id": 28056553, "question_id": 28052528, "link": "https://stackoverflow.com/questions/28052528/ms-access-consolidating-two-text-boxes-used-for-searching-into-one/28056553#28056553", "title": "MS Access Consolidating two text boxes (used for searching) into one", "body": "<ol>\n<li><p>Create consolidated text box</p></li>\n<li><p>Detect if value in consolidated text box is employee ID</p>\n\n<p>2.1. if <strong>yes</strong> then launch <code>Cardswipe_AfterUpdate()</code> referring to consolidated text box value</p>\n\n<p>2.2. if <strong>no</strong> then launch <code>EmployeeSearch_Change()</code> referring to consolidated text box value</p></li>\n</ol>\n\n<p>Note: expressions like <code>\"*\" &amp; Me.EmployeeSearch &amp; \"*\"</code> are open doors for <a href=\"http://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow\">SQL injection attacks</a>. Try closing that door.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "is_accepted": false, "score": 0, "last_activity_date": 1421950642, "last_edit_date": 1421950642, "creation_date": 1421949595, "answer_id": 28095633, "question_id": 28052528, "link": "https://stackoverflow.com/questions/28052528/ms-access-consolidating-two-text-boxes-used-for-searching-into-one/28095633#28095633", "title": "MS Access Consolidating two text boxes (used for searching) into one", "body": "<p>My updated working code:</p>\n\n<pre><code>Private Sub EmployeeSearch_AfterUpdate()\n\n    Dim Textcheck As String\n\n    Textcheck = Nz(Left(Me.EmployeeSearch.Text, 1), \"\")\n\n    Select Case Textcheck\n\n    Case 6\n\n        If Len(Me.EmployeeSearch.Text) &gt;= 17 Then\n\n            Me.EmployeeList.Value = Mid(Me.EmployeeSearch.Text, 7, 10)\n\n            Me.EmployeeSearch.Value = \"\"\n\n            Me.EmployeeSearch.ForeColor = vbBlack\n        End If\n\n    End Select\n\nEnd Sub\n\n\n\nPrivate Sub EmployeeSearch_Change()\n'CODE THAT HANDLES WHAT HAPPENS WHEN THE USER TYPES IN THE SEARCH BOX\n    Dim strFullList As String\n    Dim strFilteredList As String\n\n    If (Me.EmployeeSearch Is Me.ActiveControl) Then\n\n        If Nz(Left(Me.EmployeeSearch.Text, 1), \"\") = 6 Then\n            Me.EmployeeSearch.ForeColor = RGB(255, 255, 153)\n\n            If Len(Me.EmployeeSearch.Text) &gt;= 18 Then\n\n                SendKeys \"{TAB}\", False\n\n            End If\n\n        Else\n\n\n\n          If blnSpace = False Then\n              Me.Refresh  'refresh to make sure the text box changes are actually available to use\n\n                'specify the default/full rowsource for the control\n      strFullList = \"SELECT EM_Employees_T.Emp_ID AS [Emp ID], EM_Employees_T.Emp_First AS [First], EM_Employees_T.Emp_Last AS [Last], EM_Employees_T.Email, EM_Employees_T.Full_Time AS [Full Time], EM_Employees_T.Visa_Exp, EM_Employees_T.Visa_ID, EM_Employees_T.Added, EM_Employees_T.Added_by, EM_Employees_T.Modified, EM_Employees_T.Modified_by \" &amp; vbCrLf &amp; _\n\"FROM EM_Employees_T \" &amp; vbCrLf &amp; _\n\"WHERE (((EM_Employees_T.Emp_ID)&lt;&gt;0 And (EM_Employees_T.Emp_ID)&lt;&gt;2 And (EM_Employees_T.Emp_ID)&lt;&gt;20)) \" &amp; vbCrLf &amp; _\n\"ORDER BY EM_Employees_T.Emp_First, EM_Employees_T.Emp_Last;\"\n\n        'specify the way you want the rowsource to be filtered based on the user's entry\n      strFilteredList = \"SELECT EM_Employees_T.Emp_ID AS [Emp ID], EM_Employees_T.Emp_First AS [First], EM_Employees_T.Emp_Last AS [Last], EM_Employees_T.Email, EM_Employees_T.Full_Time AS [Full Time], EM_Employees_T.Visa_Exp, EM_Employees_T.Visa_ID, EM_Employees_T.Added, EM_Employees_T.Added_by, EM_Employees_T.Modified, EM_Employees_T.Modified_by \" &amp; vbCrLf &amp; _\n\"FROM EM_Employees_T \" &amp; vbCrLf &amp; _\n\"WHERE (((EM_Employees_T.Emp_ID)&lt;&gt;0 And (EM_Employees_T.Emp_ID)&lt;&gt;2 And (EM_Employees_T.Emp_ID)&lt;&gt;20) AND ((EM_Employees_T.Emp_First) Like \"\"*\" &amp; Me.EmployeeSearch &amp; \"*\"\")) OR (((EM_Employees_T.Emp_ID)&lt;&gt;0 And (EM_Employees_T.Emp_ID)&lt;&gt;2 And (EM_Employees_T.Emp_ID)&lt;&gt;20) AND ((EM_Employees_T.Emp_Last) Like \"\"*\" &amp; Me.EmployeeSearch &amp; \"*\"\")) \" &amp; vbCrLf &amp; _\n\"ORDER BY EM_Employees_T.Emp_First, EM_Employees_T.Emp_Last;\"\n\n                'run the search\n              fLiveSearch Me.EmployeeSearch, Me.EmployeeList, strFullList, strFilteredList    ', Me.txtCount\n          End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 28056553, "answer_count": 2, "score": 0, "last_activity_date": 1594645562, "creation_date": 1421778215, "last_edit_date": 1594645562, "question_id": 28052528, "link": "https://stackoverflow.com/questions/28052528/ms-access-consolidating-two-text-boxes-used-for-searching-into-one", "title": "MS Access Consolidating two text boxes (used for searching) into one", "body": "<p>I have a form that has two text boxes (CardSwipe and EmployeeSearch) and a list box (EmployeeList) .  </p>\n\n<p>The EmployeeList displays employee first and last names as well as their ID number.</p>\n\n<p>EmployeeSearch is a search as you type field and allows for searching EmployeeList by any of the fields.  It calls a function \"fLiveSearch\" in order to achieve this and relies on refreshing the form per change in the field.</p>\n\n<p>CardSwipe allows you to swipe an ID card with the employee ID encoded in it and navigate directly to the record in EmployeeList.</p>\n\n<p>The card that's swiped has the employee ID embedded within a long strand of numbers.  When the card is swiped it's read as if the user has just typed all of the information in really fast. All of these strands on the cards start with the number 6.... There are no ID numbers (or names for that matter) that start with this number.</p>\n\n<p>I would like to consolidate EmployeeSearch and CardSwipe into one text box... But am unsure how to do it.</p>\n\n<p>Below is the code associated with the functions above:</p>\n\n<p><strong>EmployeeSearch:</strong></p>\n\n<pre><code>Private Sub EmployeeSearch_Change()\n'CODE THAT HANDLES WHAT HAPPENS WHEN THE USER TYPES IN THE SEARCH BOX\n\nDim strFullList As String\nDim strFilteredList As String\n\n\nIf blnSpace = False Then\n    Me.Refresh  'refresh to make sure the text box changes are actually available to use\n\n    'specify the default/full rowsource for the control\n    strFullList = \"SELECT EM_Employees_T.Emp_ID AS [Emp ID], EM_Employees_T.Emp_First AS [First], EM_Employees_T.Emp_Last AS [Last], EM_Employees_T.Email, EM_Employees_T.Full_Time AS [Full Time], EM_Employees_T.Visa_Exp, EM_Employees_T.Visa_ID, EM_Employees_T.Added, EM_Employees_T.Added_by, EM_Employees_T.Modified, EM_Employees_T.Modified_by \" &amp; vbCrLf &amp; _\n                  \"FROM EM_Employees_T \" &amp; vbCrLf &amp; _\n                  \"WHERE (((EM_Employees_T.Emp_ID)&lt;&gt;0 And (EM_Employees_T.Emp_ID)&lt;&gt;2 And (EM_Employees_T.Emp_ID)&lt;&gt;20)) \" &amp; vbCrLf &amp; _\n                  \"ORDER BY EM_Employees_T.Emp_First, EM_Employees_T.Emp_Last;\"\n\n    'specify the way you want the rowsource to be filtered based on the user's entry\n    strFilteredList = \"SELECT EM_Employees_T.Emp_ID AS [Emp ID], EM_Employees_T.Emp_First AS [First], EM_Employees_T.Emp_Last AS [Last], EM_Employees_T.Email, EM_Employees_T.Full_Time AS [Full Time], EM_Employees_T.Visa_Exp, EM_Employees_T.Visa_ID, EM_Employees_T.Added, EM_Employees_T.Added_by, EM_Employees_T.Modified, EM_Employees_T.Modified_by \" &amp; vbCrLf &amp; _\n                      \"FROM EM_Employees_T \" &amp; vbCrLf &amp; _\n                      \"WHERE (((EM_Employees_T.Emp_ID)&lt;&gt;0 And (EM_Employees_T.Emp_ID)&lt;&gt;2 And (EM_Employees_T.Emp_ID)&lt;&gt;20) AND ((EM_Employees_T.Emp_First) Like \"\"*\" &amp; Me.EmployeeSearch &amp; \"*\"\")) OR (((EM_Employees_T.Emp_ID)&lt;&gt;0 And (EM_Employees_T.Emp_ID)&lt;&gt;2 And (EM_Employees_T.Emp_ID)&lt;&gt;20) AND ((EM_Employees_T.Emp_Last) Like \"\"*\" &amp; Me.EmployeeSearch &amp; \"*\"\")) \" &amp; vbCrLf &amp; _\n                      \"ORDER BY EM_Employees_T.Emp_First, EM_Employees_T.Emp_Last;\"\n\n    'run the search\n    fLiveSearch Me.EmployeeSearch, Me.EmployeeList, strFullList, strFilteredList    ', Me.txtCount\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>CardSwipe:</strong></p>\n\n<pre><code>Private Sub CardSwipe_AfterUpdate()\n\nMe.EmployeeList.Value = Mid(Me.CardSwipe, 7, 10)\nMe.CardSwipe = \"\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>fLiveSearch:</strong></p>\n\n<pre><code>Function fLiveSearch(ctlSearchBox As TextBox, ctlFilter As Control, _\n                     strFullSQL As String, strFilteredSQL As String, Optional ctlCountLabel As Control)\n'==================================================================================\n'  THIS FUNCTION ALLOWS YOU TO FILTER A COMBO BOX OR LIST BOX AS THE USER TYPES\n'  ALL YOU NEED TO DO IS PASS IN THE CONTROL REFERENCE TO THE SEARCH BOX ON YOUR\n'  FORM, THE LISTBOX/COMBO BOX YOU WANT TO FILTER, AND WHAT THE FULL AND FILTERED\n'  SQL (ROWSOURCE) SHOULD BE.\n'\n'  ctlSearchBox       THE TEXTBOX THE USER TYPES IN TO SEARCH\n'\n'  ctlFilter          THE LISTBOX OR COMBOBOX ON THE FORM YOU WANT TO FILTER\n'\n'  strFullSQL         THE FULL ROWSOURCE YOU WANT TO DISPLAY AS A DEFAULT IF NO\n'                     RESULTS ARE RETURNED\n'\n'  strFilteredSQL     THE FILTERED ROWSOURCE FOR THE LISTBOX/COMBOBOX; FOR EXAMPLE\n'                     YOU WOULD WANT TO USE '...like \"\"*\" &amp; me.txtsearch.value &amp; \"*\"\"\"\n'                     TO FILTER THE RESULTS BASED ON THE USER'S SEARCH INPUT\n'\n' ctlCountLabel       (OPTIONAL) THE LABEL ON YOUR FORM WHERE YOU WANT TO DISPLAY THE\n'                     COUNT OF ROWS DISPLAYED IN THE LISTBOX/COMBOBOX AS THEY SEARCH\n'=====================================================================================\n\n'ADVANCED PARAMETERS - Change these constants to change the behaviour of the search\n    Const iSensitivity = 1    'Set to the number of characters the user must enter before the search starts\n    Const blnEmptyOnNoMatch = True    'Set to true if you want nothing to appear if nothing matches their search\n\n\n10  On Error GoTo err_handle\n\n    'restore the cursor to where they left off\n20  ctlSearchBox.SetFocus\n30  ctlSearchBox.SelStart = Len(ctlSearchBox.Value) + 1\n\n40  If ctlSearchBox.Value &lt;&gt; \"\" Then\n        'Only fire if they've input more than two characters (otherwise it's wasteful)\n50      If Len(ctlSearchBox.Value) &gt; iSensitivity Then\n60          ctlFilter.RowSource = strFilteredSQL\n70          If ctlFilter.ListCount &gt; 0 Then\n80              ctlSearchBox.SetFocus\n90              ctlSearchBox.SelStart = Len(ctlSearchBox.Value) + 1\n100         Else\n110             If blnEmptyOnNoMatch = True Then\n120                 ctlFilter.RowSource = \"\"\n130             Else\n140                 ctlFilter.RowSource = strFullSQL\n150             End If\n160         End If\n170     Else\n180         ctlFilter.RowSource = strFullSQL\n190     End If\n\n200 Else\n210     ctlFilter.RowSource = strFullSQL\n220 End If\n\n    'if there is a count label, then update it\n230 If IsMissing(ctlCountLabel) = False Then\n240     ctlCountLabel.Caption = \"Displaying \" &amp; Format(ctlFilter.ListCount - 1, \"#,##0\") &amp; \" records\"\n250 End If\n\n260 Exit Function\nerr_handle:\n270 Select Case Err.Number\n    Case 91    'no ctlCountLabel\n        'exit\n280 Case 94    'null string\n        'exit\n290 Case Else\n300     MsgBox \"An unexpected error has occurred: \" &amp; vbCrLf &amp; Err.Description &amp; _\n               vbCrLf &amp; \"Error \" &amp; Err.Number &amp; vbCrLf &amp; \"Line: \" &amp; Erl\n310 End Select\n\n\nEnd Function\n</code></pre>\n\n<p>Thanks in advance for your input and help.</p>\n\n<p>[edit: fixed formatting]</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421778542, "post_id": 28052360, "comment_id": 44487107, "body": "On what line is the Type mismatch?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 5, "last_activity_date": 1421777998, "creation_date": 1421777998, "answer_id": 28052465, "question_id": 28052360, "link": "https://stackoverflow.com/questions/28052360/error-with-vba-type-mismatch-error-13/28052465#28052465", "title": "Error with VBA Type mismatch (Error 13)", "body": "<pre><code>If (f &gt;= f1) &amp; (f &lt;= F2) Then\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>If (f &gt;= f1) And (f &lt;= F2) Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421782997, "post_id": 28052742, "comment_id": 44489538, "body": "That is not the problem - some implicit conversion will take place.  E.g. <code>? 20141229 &lt; &quot;20141228&quot;</code> is <code>False</code>, and <code>? 20141227 &lt; &quot;20141228&quot;</code> is <code>True</code>"}], "tags": [], "owner": {"reputation": 11, "user_id": 4473976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac177a30f6837fa9cccd01c53822ccd?s=128&d=identicon&r=PG&f=1", "display_name": "rushifell", "link": "https://stackoverflow.com/users/4473976/rushifell"}, "is_accepted": false, "score": -1, "last_activity_date": 1421779015, "creation_date": 1421779015, "answer_id": 28052742, "question_id": 28052360, "link": "https://stackoverflow.com/questions/28052360/error-with-vba-type-mismatch-error-13/28052742#28052742", "title": "Error with VBA Type mismatch (Error 13)", "body": "<p>The declaration of variable f is variant. But if you call the format function, the result is converted in a string. An then you want compare f1 of type long with a string. This is the problem. Compare f with f1 BEFOR you call the format function.</p>\n"}], "owner": {"reputation": 1, "user_id": 4475200, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rIhLvTG1254/AAAAAAAAAAI/AAAAAAAAAEg/shJWfYXhHdY/photo.jpg?sz=128", "display_name": "Aureliano Garza Rodriguez", "link": "https://stackoverflow.com/users/4475200/aureliano-garza-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1421794675, "answer_count": 2, "score": -2, "last_activity_date": 1421779015, "creation_date": 1421777646, "last_edit_date": 1421778574, "question_id": 28052360, "link": "https://stackoverflow.com/questions/28052360/error-with-vba-type-mismatch-error-13", "closed_reason": "Needs details or clarity", "title": "Error with VBA Type mismatch (Error 13)", "body": "<p>my code: </p>\n\n<pre><code>Sub sem()\nDim f As Variant\nDim f1 As Long\nDim F2 As Long\n\nf = Format(DTPFechaFalla, \"yyyymmdd\")\nf1 = 20141227\nF2 = 20150124\n\n\n    If (f &gt;= f1) &amp; (f &lt;= F2) Then\n       Week = 1\n       month = 1\n    Else\n       MsgBox \"Fale\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4474370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee38fb69dfbaf7f3f6f1fc550978408?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Boon", "link": "https://stackoverflow.com/users/4474370/thomas-boon"}, "edited": false, "score": 0, "creation_date": 1421825252, "post_id": 28052448, "comment_id": 44504412, "body": "Thank you for your answer.I followed your suggestion. I get an error &quot;There are not enough parameters. The expected number is : 1. Error 3061"}, {"owner": {"reputation": 1, "user_id": 4474370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee38fb69dfbaf7f3f6f1fc550978408?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Boon", "link": "https://stackoverflow.com/users/4474370/thomas-boon"}, "edited": false, "score": 0, "creation_date": 1421837978, "post_id": 28052448, "comment_id": 44511051, "body": "The problem is solved. First i chanced the declaration as follows;                Dim projectnamen As DAO.Database"}, {"owner": {"reputation": 1, "user_id": 4474370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee38fb69dfbaf7f3f6f1fc550978408?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Boon", "link": "https://stackoverflow.com/users/4474370/thomas-boon"}, "edited": false, "score": 0, "creation_date": 1421838946, "post_id": 28052448, "comment_id": 44511604, "body": "The problem is solved. First I changed the declaration Dim projectnamen as Dao.database into Dim projektnamen as DAO.database. Second the name of the field in the db contained spaces. I deleted the spaces. Now the code works fine with your suggestions"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 2, "last_activity_date": 1421777951, "creation_date": 1421777951, "answer_id": 28052448, "question_id": 28052255, "link": "https://stackoverflow.com/questions/28052255/how-to-fill-a-recordset-in-vba-in-a-module-behind-a-db/28052448#28052448", "title": "how to fill a recordset in vba in a module behind a db", "body": "<p>I think you want to run that query against the db which you opened in the new Access session, <em>accapp</em>.</p>\n\n<p>The <code>CurrentDb</code> method is a member of <code>Application</code>.  So qualify <code>CurrentDb</code> with the object variable name of that other application session.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Set rs = CurrentDb.OpenRecordset(strSQL, dbOpenTable)\nSet rs = accapp.CurrentDb.OpenRecordset(strSQL, dbOpenSnapshot)\n</code></pre>\n\n<p>Note <code>OpenRecordset</code> won't let you use <em>dbOpenTable</em> with a query.  So I arbitrarily chose <em>dbOpenSnapshot</em> instead.  If that's not what you want, substitute a different constant from the <em>RecordsetTypeEnum Enumeration</em> (see Access help topic for details).</p>\n"}], "owner": {"reputation": 1, "user_id": 4474370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee38fb69dfbaf7f3f6f1fc550978408?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Boon", "link": "https://stackoverflow.com/users/4474370/thomas-boon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421778118, "creation_date": 1421777309, "last_edit_date": 1421778118, "question_id": 28052255, "link": "https://stackoverflow.com/questions/28052255/how-to-fill-a-recordset-in-vba-in-a-module-behind-a-db", "title": "how to fill a recordset in vba in a module behind a db", "body": "<p>I have tried many ways to get the job done.  I am inexperienced with the<br>\nAccess VBA.\nI think the problem is how to set the current database.  The code is in a module  from another db as the current db. I have paste the code here in a module behind the\ncurrentdb that also gives the same error. I have looked after very much questions. \nIt must be simple. But I don't see the answer. </p>\n\n<pre><code>Private Sub project()\n\nDim projectnamen As DAO.Database\nDim strSQL As String\nDim rs As DAO.Recordset\nDim strdbName As String\nDim strMyPath As String\nDim strdb As String\nDim accapp As Object    \n\nPath = \"c:\\GedeeldeMappen\\programma en bestanden stiko\"\nstrdbName=\"projektnamen.accdb\"\nstrMyPath = Path\nstrdb = strMyPath &amp; \"\\\" &amp; strdbName\n\n'make the db \"projectnamen\"current. Perhaps this is possible with set??\n\nSet accapp = CreateObject(\"Access.Application\")  \naccapp.OpenCurrentDatabase (strdb)\n\n'fieldname is naam_van_het_project  \n'tablename is projectnaam    \n\nstrSQL = \"SELECT All naam_van_het_project FROM projectnaam;\"\n\n'here i get an error \"can't find the object Select All naam_van_het_project\n'FROM projectnaam\"  error 3011\n\nSet rs = CurrentDb.OpenRecordset(strSQL, dbOpenTable)\nrs.MoveFirst\nDo While Not rs.EOF\n    MsgBox (rs)    \n    rs.MoveNext\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 2, "creation_date": 1421778167, "post_id": 28052100, "comment_id": 44486922, "body": "What error message is it giving you?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1421782749, "post_id": 28052100, "comment_id": 44489396, "body": "It&#39;s difficult to help you unless you tell us what the problem is... Is there an error? If so, what is the error message? And what is the value of <i>each</i> variable in the statement which raises the error?"}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "is_accepted": false, "score": 0, "last_activity_date": 1421801053, "creation_date": 1421801053, "answer_id": 28057766, "question_id": 28052100, "link": "https://stackoverflow.com/questions/28052100/sum-up-duplicate-values-in-excel-using-vba/28057766#28057766", "title": "Sum up duplicate values in Excel using VBA", "body": "<p>You might want to have</p>\n\n<pre><code>Sheets(\"summary\").Activate\n</code></pre>\n\n<p>before you start on your calls to SumDuplicates</p>\n\n<pre><code>'switch to summary sheet\nSheets(\"summary\").Activate\nCall SumDuplicates(12, 2)\n</code></pre>\n\n<p>etc. </p>\n"}], "owner": {"reputation": 1, "user_id": 4454703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0572c6a3455628f1301e1d3640cdc0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Virtualboy2015", "link": "https://stackoverflow.com/users/4454703/virtualboy2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421803447, "creation_date": 1421776809, "last_edit_date": 1421803447, "question_id": 28052100, "link": "https://stackoverflow.com/questions/28052100/sum-up-duplicate-values-in-excel-using-vba", "title": "Sum up duplicate values in Excel using VBA", "body": "<p>I'd appreciate your help in modifying the code below:</p>\n\n<pre><code>Public Sub CommandButton2_Click()\n\nCall Sheet1.CommandButton1_Click\nSheet8.Activate\n\n'101-WP-101\nSheets(\"Data Normalize\").Range(\"T19:T30\").Copy Destination:=Sheets(\"summary\").Range(\"B12\")\nSheets(\"Data Normalize\").Range(\"E19:E30\").Copy Destination:=Sheets(\"summary\").Range(\"C12\")\n'101-WP-102\nSheets(\"Data Normalize\").Range(\"U19:U30\").Copy Destination:=Sheets(\"summary\").Range(\"E12\")\nSheets(\"Data Normalize\").Range(\"F19:F30\").Copy Destination:=Sheets(\"summary\").Range(\"F12\")\n'101-WP-103\nSheets(\"Data Normalize\").Range(\"V19:V30\").Copy Destination:=Sheets(\"summary\").Range(\"H12\")\nSheets(\"Data Normalize\").Range(\"G19:G30\").Copy Destination:=Sheets(\"summary\").Range(\"I12\")\n'101-WP-104\nSheets(\"Data Normalize\").Range(\"W19:W30\").Copy Destination:=Sheets(\"summary\").Range(\"B27\")\nSheets(\"Data Normalize\").Range(\"H19:H30\").Copy Destination:=Sheets(\"summary\").Range(\"C27\")\n'101-WP-105\nSheets(\"Data Normalize\").Range(\"X19:X30\").Copy Destination:=Sheets(\"summary\").Range(\"E27\")\nSheets(\"Data Normalize\").Range(\"I19:I30\").Copy Destination:=Sheets(\"summary\").Range(\"F27\")\n'102-WP-101\nSheets(\"Data Normalize\").Range(\"Y19:Y30\").Copy Destination:=Sheets(\"summary\").Range(\"B43\")\nSheets(\"Data Normalize\").Range(\"J19:J30\").Copy Destination:=Sheets(\"summary\").Range(\"C43\")\n'102-WP-102\nSheets(\"Data Normalize\").Range(\"Z19:Z30\").Copy Destination:=Sheets(\"summary\").Range(\"E43\")\nSheets(\"Data Normalize\").Range(\"K19:K30\").Copy Destination:=Sheets(\"summary\").Range(\"F43\")\n'102-WP-103\nSheets(\"Data Normalize\").Range(\"AA19:AA30\").Copy Destination:=Sheets(\"summary\").Range(\"H43\")\nSheets(\"Data Normalize\").Range(\"L19:L30\").Copy Destination:=Sheets(\"summary\").Range(\"I43\")\n'102-WP-104\nSheets(\"Data Normalize\").Range(\"AB19:AB30\").Copy Destination:=Sheets(\"summary\").Range(\"B58\")\nSheets(\"Data Normalize\").Range(\"M19:M30\").Copy Destination:=Sheets(\"summary\").Range(\"C58\")\n'102-WP-105\nSheets(\"Data Normalize\").Range(\"AC19:AC30\").Copy Destination:=Sheets(\"summary\").Range(\"E58\")\nSheets(\"Data Normalize\").Range(\"N19:N30\").Copy Destination:=Sheets(\"summary\").Range(\"F58\")\n'102-WP-106\nSheets(\"Data Normalize\").Range(\"AD19:AD30\").Copy Destination:=Sheets(\"summary\").Range(\"H58\")\nSheets(\"Data Normalize\").Range(\"O19:O30\").Copy Destination:=Sheets(\"summary\").Range(\"I58\")\n'102-WP-107\nSheets(\"Data Normalize\").Range(\"AE19:AE30\").Copy Destination:=Sheets(\"summary\").Range(\"B73\")\nSheets(\"Data Normalize\").Range(\"P19:P30\").Copy Destination:=Sheets(\"summary\").Range(\"C73\")\n'102-WP-108\nSheets(\"Data Normalize\").Range(\"AF19:AF30\").Copy Destination:=Sheets(\"summary\").Range(\"E73\")\nSheets(\"Data Normalize\").Range(\"Q19:Q30\").Copy Destination:=Sheets(\"summary\").Range(\"F73\")\n'102-WP-109\nSheets(\"Data Normalize\").Range(\"AG19:AG30\").Copy Destination:=Sheets(\"summary\").Range(\"H73\")\nSheets(\"Data Normalize\").Range(\"R19:R30\").Copy Destination:=Sheets(\"summary\").Range(\"I73\")\n'102-WP-110\nSheets(\"Data Normalize\").Range(\"AH19:AH30\").Copy Destination:=Sheets(\"summary\").Range(\"B88\")\nSheets(\"Data Normalize\").Range(\"S19:S30\").Copy Destination:=Sheets(\"summary\").Range(\"C88\")\n\nCall SumDuplicates(12, 2)\nCall SumDuplicates(12, 5)\nCall SumDuplicates(12, 8)\nCall SumDuplicates(27, 2)\nCall SumDuplicates(27, 5)\nCall SumDuplicates(43, 2)\nCall SumDuplicates(43, 5)\nCall SumDuplicates(43, 8)\nCall SumDuplicates(58, 2)\nCall SumDuplicates(58, 5)\nCall SumDuplicates(58, 8)\nCall SumDuplicates(73, 2)\nCall SumDuplicates(73, 5)\nCall SumDuplicates(73, 8)\nCall SumDuplicates(88, 2)\n\nEnd Sub\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>Private Function SumDuplicates(startRow As Integer, startCol As Integer)\nDim lngRow As Long\n\nWith ActiveSheet\n\n    lngRow = .Cells(startRow, startCol).End(xlDown).Row\n\n    .Cells(startRow, startCol).CurrentRegion.sort key1:=.Cells(startRow, startCol), Header:=xlYes 'change this to xlYes if your table has header cells\n    .Cells(1, 1).Value = lngRow\n\n   Do\n\n       If .Cells(lngRow - 1, startCol) = .Cells(lngRow, startCol) Then\n          .Cells(lngRow - 1, startCol + 1) = .Cells(lngRow - 1, startCol + 1) + .Cells(lngRow, startCol + 1)\n          .Cells(lngRow, startCol).Clear\n          .Cells(lngRow, startCol + 1).Clear\n\n      End If\n\n      lngRow = lngRow - 1\n\n   Loop Until lngRow &lt; (startRow + 1)\n\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>When I run the code, it is stopping on the text highlighted/underline in red (the first line below).</p>\n\n<pre><code>.Cells(startRow, startCol).CurrentRegion.sort key1:=.Cells(startRow, startCol), Header:=xlYes 'change this to xlYes if your table has header cells\n.Cells(1, 1).Value = lngRow\n</code></pre>\n\n<p>What is missing..on my code\nI have multiple tables in my worksheet.</p>\n"}, {"tags": ["vba", "outlook", "subdirectory", "inbox"], "answers": [{"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 0, "creation_date": 1421781241, "post_id": 28052547, "comment_id": 44488555, "body": "Well, I also updated the post. See the changes above."}, {"owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 0, "creation_date": 1421788160, "post_id": 28052547, "comment_id": 44492126, "body": "Thank you for the suggestions!  My macros are enabled, and I will experiment with the NewMailEx application.  For the time being however, I&#39;m still not getting any response from the current macro - I don&#39;t even get a notification when the test email comes through (i.e. no errors).  Any ideas?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 0, "creation_date": 1421842270, "post_id": 28052547, "comment_id": 44513550, "body": "Did you check out the Trust center settings in Outlook? Is your macro allowed to run?"}, {"owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 0, "creation_date": 1421849867, "post_id": 28052547, "comment_id": 44518199, "body": "I changed the Macro Settings within the Trust Center to &quot;Enable all macros&quot;.  I believe this is the only relevant setting to running macros, correct?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1421781217, "last_edit_date": 1592644375, "creation_date": 1421778267, "answer_id": 28052547, "question_id": 28052041, "link": "https://stackoverflow.com/questions/28052041/moving-outlook-message-with-specific-subject-to-subfolders/28052547#28052547", "title": "Moving Outlook message with specific subject to Subfolders", "body": "<p>It looks like you didn't define and initialize the Items object properly. For example:</p>\n<pre><code> Public WithEvents myOlItems As Outlook.Items\n\n Public Sub Initialize_handler()  \n     Set myOlItems = Application.GetNamespace(&quot;MAPI&quot;).GetDefaultFolder(olFolderContacts).Items  \n End Sub \n\n Private Sub myOlItems_ItemAdd(ByVal Item As Object)  \n    ' do something here\n End Sub\n</code></pre>\n<p>Be aware, the ItemAdd event is not fired when more than 16 items is added at the same time. This is a known issue in the OOM.</p>\n<p>Try to use the NewMailEx event of the Application class instead. And I'd suggest reading the following series of articles:</p>\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/10/03/outlook-newmail-event/\" rel=\"nofollow noreferrer\">Outlook NewMail event unleashed: the challenge (NewMail, NewMailEx, ItemAdd)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/10/24/outlook-newmail-solution-options/\" rel=\"nofollow noreferrer\">Outlook NewMail event: solution options</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/01/outlook-newmail-extended-mapi/\" rel=\"nofollow noreferrer\">Outlook NewMail event and Extended MAPI: C# example</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/10/outlook-newmail-custom-solution/\" rel=\"nofollow noreferrer\">Outlook NewMail unleashed: writing a working solution (C# example)</a></li>\n</ul>\n<p>Finally, is your macro enabled in Outlook? Have you checked out the Trust center settings?</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1422564821, "creation_date": 1422564821, "answer_id": 28224400, "question_id": 28052041, "link": "https://stackoverflow.com/questions/28052041/moving-outlook-message-with-specific-subject-to-subfolders/28224400#28224400", "title": "Moving Outlook message with specific subject to Subfolders", "body": "<p>Put your code in ThisOutlookSession.</p>\n\n<p>Just above your code put </p>\n\n<pre><code>Public WithEvents Items As Items\n</code></pre>\n\n<p>When using the built-in class module ThisOutlookSession, Sub Application_Startup() initializes the handler.</p>\n"}], "owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2567, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1422564821, "creation_date": 1421776565, "last_edit_date": 1421778841, "question_id": 28052041, "link": "https://stackoverflow.com/questions/28052041/moving-outlook-message-with-specific-subject-to-subfolders", "title": "Moving Outlook message with specific subject to Subfolders", "body": "<p>I am trying to write a brief VBA script that will move incoming messages from my Outlook Inbox to a subfolder.  This is what I currently have (assembled from various posts), but I'm not getting any result when I send test emails.  If there are any other posts that would relate to this, I would appreciate it!</p>\n\n<pre><code>Private Sub Application_Startup()\n  Dim olApp As Outlook.Application\n  Dim objNS As Outlook.NameSpace\n  Set olApp = Outlook.Application\n  Set objNS = olApp.GetNamespace(\"MAPI\")\n  ' Default local Inbox\n  Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal item As Object)\n\n  On Error GoTo ErrorHandler\n  Dim Msg As Outlook.MailItem\n  Set myInbox = GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)\n  If TypeName(item) = \"MailItem\" Then\n    Set Msg = item\n\n    If Msg.SenderEmailAddress = \"name@example.com\" Then\n        If InStr(0, Msg.Subject, \"Subject Title\", vbTextCompare) &gt; 0 Then\n        Msg.Move myInbox.Folders(\"Test\").Subfolder(\"Destination\")\n        End If\n    End If\n\n  End If\nProgramExit:\n  Exit Sub\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "outlook-2010", "vba"], "answers": [{"tags": [], "owner": {"reputation": 564, "user_id": 4175088, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KlNYj.jpg?s=128&g=1", "display_name": "blindguy", "link": "https://stackoverflow.com/users/4175088/blindguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1421783883, "creation_date": 1421783883, "answer_id": 28054103, "question_id": 28051988, "link": "https://stackoverflow.com/questions/28051988/exporting-custom-outlook-formula-field-that-includes-a-checkbox-to-excel/28054103#28054103", "title": "Exporting custom Outlook formula field that includes a checkbox to Excel", "body": "<p>You cannot check the value of a checkbox directly in a formula.  The following link shows you how to set a surrogate cell to store the answer.</p>\n\n<p><a href=\"http://blog.contextures.com/archives/2013/07/09/use-check-box-result-in-excel-formula/\" rel=\"nofollow\">http://blog.contextures.com/archives/2013/07/09/use-check-box-result-in-excel-formula/</a></p>\n"}], "owner": {"reputation": 1378, "user_id": 3668839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VwtYm.jpg?s=128&g=1", "display_name": "ksp585", "link": "https://stackoverflow.com/users/3668839/ksp585"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519402934, "creation_date": 1421776358, "last_edit_date": 1531164843, "question_id": 28051988, "link": "https://stackoverflow.com/questions/28051988/exporting-custom-outlook-formula-field-that-includes-a-checkbox-to-excel", "title": "Exporting custom Outlook formula field that includes a checkbox to Excel", "body": "<p>I am exporting Outlook emails in custom table view to Excel. There are custom formula fields in the custom view. All the custom fields export except the formula field.</p>\n\n<p>This is the formula field:<br>\n'AssignedDate' formula field: IIf([RequestAssigned]=True,Now(),\"\")</p>\n\n<p>'RequestAssigned' is a checkbox field, when checked AssignedDate field will capture the date and time when it is checked.</p>\n\n<p>I get a run-time error message-</p>\n\n<blockquote>\n  <p>Run-time error '-2147024809(8070057)':\n  could not complete the operation. One or more parameter values are not valid</p>\n</blockquote>\n\n<p>If I remove that formula field the macro works.</p>\n\n<pre><code>Sub InboxToExcel()\n\n    Dim objOL As Outlook.Application\n    Dim objNS As Outlook.Namespace\n    Dim objInbox As Outlook.Folder\n    Dim objTable As Outlook.Table\n    Dim objRow As Outlook.Row\n    Dim objMsg As Outlook.MailItem\n    Dim objWB As Excel.Workbook\n    Dim objWS As Excel.Worksheet\n    Dim objRange As Excel.Range\n    Dim strFind As String\n    Dim strProps As String\n    Dim arr() As String\n    Dim val As Variant\n    Dim i As Integer\n    Dim intRow As Integer\n\n    strProps = _\n      \"SenderName,To,Subject,SentOn,ReadReceiptRequested\"\n    Set objOL = Application\n    Set objNS = objOL.Session\n    Set objInbox = objNS.GetDefaultFolder(olFolderInbox)\n    Set objTable = objInbox.GetTable\n\n    Set objWB = GetExcelWB()\n    Set objWS = objWB.Sheets(1)\n    objWS.Name = \"Inbox\"\n    arr = Split(strProps, \",\")\n    intRow = 1\n    For i = 0 To UBound(arr)\n        objWS.Cells(intRow, i + 1) = arr(i)\n        objTable.Columns.Add arr(i)\n    Next\n    Set objRange = objWS.Range _\n                   (objWS.Cells(1, 1), objWS.Cells(1, i + 1))\n    objRange.Font.Bold = True\n    Do Until objTable.EndOfTable 'POINTING HERE WHILE DEBUGGING\n        intRow = intRow + 1\n        Set objRow = objTable.GetNextRow\n        For i = 0 To UBound(arr)\n            val = objRow(arr(i))\n\n            objWS.Cells(intRow, i + 1) = val\n        Next\n    Loop\n    For i = 1 To (UBound(arr) + 1)\n        objWS.Columns(i).EntireColumn.AutoFit\n    Next\n    objWS.Application.Visible = True\n    objWS.Activate\n    Set objOL = Nothing\n    Set objNS = Nothing\n    Set objRow = Nothing\n    Set objWB = Nothing\n    Set objWS = Nothing\n    Set objRange = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5015074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d2cd6a2f392e1d064bcb8e330381bf8e?s=128&d=identicon&r=PG", "display_name": "user5015074", "link": "https://stackoverflow.com/users/5015074/user5015074"}, "is_accepted": false, "score": 0, "last_activity_date": 1434451893, "creation_date": 1434451893, "answer_id": 30865516, "question_id": 28051917, "link": "https://stackoverflow.com/questions/28051917/choose-printer-tray-automatically-from-excel-vba-to-print-word-document/30865516#30865516", "title": "Choose Printer Tray automatically From Excel VBA to print Word Document", "body": "<p>We use a really great utility called Tray Selector which you can download from <a href=\"http://us.trayselector.com\" rel=\"nofollow\">http://us.trayselector.com</a> and try for free. You can set up one click buttons to print to any printer and tray combination and even call these buttons using VBA macros. It's been very useful in our law firm.</p>\n"}], "owner": {"reputation": 15, "user_id": 3698448, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d44ac7bf42804575d7130b6a800270c?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath", "link": "https://stackoverflow.com/users/3698448/bharath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1327, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489929801, "creation_date": 1421776097, "last_edit_date": 1531164843, "question_id": 28051917, "link": "https://stackoverflow.com/questions/28051917/choose-printer-tray-automatically-from-excel-vba-to-print-word-document", "title": "Choose Printer Tray automatically From Excel VBA to print Word Document", "body": "<p>I am trying to print Word Document From Excel\nI want to choose printer tray to print word document in default printer. \nFirst 2 pages in Tray one (Letter Heads) and 3rd to 5th page in Tray Two (A4 Sheets) Using excel VBA.</p>\n\n<p>Below code is working fine to print in default printer and tray.\nHelp me to Choose Trays</p>\n\n<pre><code>'Print in letter head:- Choose Tray one\n</code></pre>\n\n<p>and</p>\n\n<pre><code>'Print Other pages in A4:- Choose Tray Two\n</code></pre>\n\n<p>Printer details:</p>\n\n<p>*Network Printer\n*Hp Laser printer 5200 dtn</p>\n\n<pre><code>Dim directory As String, fileName As String, ans As String, i As Integer\n            Dim objWord As Object\n            Dim intpage As Integer, intcopies As Integer, intnrml As Integer\n\n            Set objWord = CreateObject(\"Word.Application\")\n            objWord.Visible = True\n\n            ' path to the folder\n            directory = \"C:\\Users\\bharath.a.raj.DIR\\Desktop\\Print\\\"\n            fileName = Dir(directory &amp; \"*.doc*\") ' Open Multiple Word Docs Both .doc and .docx\n            Do While fileName &lt;&gt; \"\"\n            objWord.Documents.Open (directory &amp; fileName)\n\n            On Error Resume Next\n           '\n            intcopies = CInt(InputBox(\"How many copies?\"))\n            intpage = 1 'Letter head page no.\n            intnrml = 3 'A4 page no.\n            On Error GoTo 0\n\n            If intpage * intcopies &lt;&gt; 0 Then\n                For i = 1 To intcopies ' Loop to print next page of uer Choice Note: simplex is not working in my Office, Default Duplex\n                    'Network Printer :- HP Laser Printer 5200dtn\n                    'Print in letter head:- Choose Tray one\n                    objWord.PrintOut Range:=4, Pages:=CStr(intpage) '1st page\n                    intpage = intpage + 1\n                    objWord.PrintOut Range:=4, Pages:=CStr(intpage) '2nd page\n                    intpage = 1\n                    'Print Other pages in A4:- Choose Tray Two\n                    objWord.PrintOut Range:=4, Pages:=CStr(intnrml) '3rd page\n                    intnrml = intnrml + 1\n                    objWord.PrintOut Range:=4, Pages:=CStr(intnrml) '4th page\n                    intnrml = intnrml + 1\n                    objWord.PrintOut Range:=4, Pages:=CStr(intnrml) '5th page\n                    intnrml = 3\n\n                Next\n            Else\n                MsgBox \"sorry, wrong page or copies, try again\"\n            End If\n               ' Next\n            objWord.Documents.Close\n                ' set file to next in Dir\n            fileName = Dir()\n            Loop\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1450031902, "post_id": 28051381, "comment_id": 56251199, "body": "Which version of Word are you using? Is this your VBA or the VBA of the tools you mention? If this is the VBA of the tools you mention then there&#39;s nothing you, as an end-user, can do to affect how these tools are writing to the Undo list short of complaining to the software manufacturer. Note that you can continue to &quot;Undo&quot; to the end of the list multiple times - eventually it will undo everything. It&#39;s also possible to clear the Undo list, but then you can not undo to a previous point, anymore..."}], "answers": [{"tags": [], "owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "is_accepted": false, "score": 1, "last_activity_date": 1491450649, "creation_date": 1491450649, "answer_id": 43245388, "question_id": 28051381, "link": "https://stackoverflow.com/questions/28051381/how-to-disable-the-changes-made-by-vba-in-undo-list-in-ms-word/43245388#43245388", "title": "How to disable the changes made by vba in undo list in MS word", "body": "<p>UndoRecords allow you to group the changes. </p>\n\n<p>I don't know how to suspend or remove them from the undo stack altogether however, :(</p>\n\n<pre><code>Dim ur As UndoRecord\nSet ur = Application.UndoRecord\n'Make it easy to undo, rather then spam 50 undo commands.\nur.StartCustomRecord \"Remove eform validation formatting\"\n    For Each 1 To 50\n        Selection.TypeBackspace\n    Next\nur.EndCustomRecord\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4290217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ec8b4a4e65fa80b081d4e77b6dbf29?s=128&d=identicon&r=PG&f=1", "display_name": "Longfei Zhao", "link": "https://stackoverflow.com/users/4290217/longfei-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1491450649, "creation_date": 1421774367, "last_edit_date": 1495542737, "question_id": 28051381, "link": "https://stackoverflow.com/questions/28051381/how-to-disable-the-changes-made-by-vba-in-undo-list-in-ms-word", "title": "How to disable the changes made by vba in undo list in MS word", "body": "<p>I have an MS word document, which refer EndNote, MathType, and other things. Each time a reference or equation changes, there will changes added to the undo history. </p>\n\n<p>The history list is full of user-unfriendly records after I delete two lines. The \"Undo\" loses its function since I never know where I would reach after some unreadable records are \"undid\". This generated list is so long that I could not find its head, which means I could only \"undo\" unknown partial of my changes. </p>\n\n<p>I am looking for a solution to skip these \"vba\" changes.</p>\n\n<p>There was <a href=\"https://stackoverflow.com/questions/14832053/dont-add-changes-made-via-vba-to-the-undo-history\">another question</a> with similar topic. The question is not exact same and the link provided in answer does not exist anymore.</p>\n"}, {"tags": ["excel", "vba", "for-loop", "block", "cells"], "answers": [{"tags": [], "owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "is_accepted": true, "score": 0, "last_activity_date": 1421773858, "creation_date": 1421773858, "answer_id": 28051223, "question_id": 28051078, "link": "https://stackoverflow.com/questions/28051078/apply-block-cells-to-multiple-cells-depending-on-value/28051223#28051223", "title": "Apply block cells to multiple cells depending on value", "body": "<pre><code>Let Copyrange1 = \"k\" &amp; Startrow\nLet Copyrange2 = \"h\" &amp; Startrow\nLet Copyrange3 = \"i\" &amp; Startrow\nLet Copyrange4 = \"l\" &amp; Startrow\nLet Copyrange5 = \"m\" &amp; Startrow\n</code></pre>\n\n<p>You are only working with the <code>Startrow</code>. Change the <code>Startrow</code> inside the for-loop to <code>n</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 4475002, "user_type": "registered", "profile_image": "https://graph.facebook.com/632716046/picture?type=large", "display_name": "Danilo Rojas", "link": "https://stackoverflow.com/users/4475002/danilo-rojas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 28051223, "answer_count": 1, "score": 0, "last_activity_date": 1421773858, "creation_date": 1421773352, "last_edit_date": 1421773487, "question_id": 28051078, "link": "https://stackoverflow.com/questions/28051078/apply-block-cells-to-multiple-cells-depending-on-value", "title": "Apply block cells to multiple cells depending on value", "body": "<p>Im trying to apply a value block/unblock control for multiple cells but unlucky, any ideas?  I really apreciate your help!</p>\n\n<pre><code>Dim Copyrange1 As String\nDim Copyrange2 As String\nDim Copyrange3 As String\nDim Copyrange4 As String\nDim Copyrange5 As String\n\n\n\n\nStartrow = 14\nLastrow = 61\n\n\nFor n = Startrow To Lastrow\n        Let Copyrange1 = \"k\" &amp; Startrow\n        Let Copyrange2 = \"h\" &amp; Startrow\n        Let Copyrange3 = \"i\" &amp; Startrow\n        Let Copyrange4 = \"l\" &amp; Startrow\n        Let Copyrange5 = \"m\" &amp; Startrow\n\n\n        If Range(Copyrange1).Value = \"LLEGA AL ODF DESTINO\" Then\n\n            ActiveSheet.Unprotect \"extend\"\n            Range(Copyrange2).Locked = False\n            Range(Copyrange3).Locked = False\n            ActiveSheet.Protect \"extend\"\n\n            ActiveSheet.Unprotect \"extend\"\n            Range(Copyrange4).Locked = False\n            Range(Copyrange5).Locked = False\n            ActiveSheet.Protect \"extend\"\n\n         Else\n\n            ActiveSheet.Unprotect \"extend\"\n\n            Range(Copyrange2).Locked = True\n\n            Range(Copyrange3).Locked = True\n            ActiveSheet.Protect \"extend\"\n\n            ActiveSheet.Unprotect \"extend\"\n            Range(Copyrange4).Locked = True\n            Range(Copyrange5).Locked = True\n            ActiveSheet.Protect \"extend\"\n\n         End If\n Next\n</code></pre>\n\n<p>And the code works whit a singe Range selection, like Range(\"k14\"), but im trying to do this for a 60 rows.</p>\n"}, {"tags": ["algorithm", "vba", "excel"], "comments": [{"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421773774, "post_id": 28051057, "comment_id": 44484472, "body": "...just commenting as I read... &quot;next ID is null&quot; is impossible for there are no NULL cell values in Excel..."}, {"owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "edited": false, "score": 0, "creation_date": 1421774253, "post_id": 28051057, "comment_id": 44484770, "body": "Do you want to solve this via VBA or formulas?"}, {"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421774411, "post_id": 28051057, "comment_id": 44484852, "body": "via VBA I tried use formulas but no effect... Can you solved this via formulas?"}, {"owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "edited": false, "score": 0, "creation_date": 1421774557, "post_id": 28051057, "comment_id": 44484938, "body": "either way works, hoever formula seems more suited for this problem"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1421775272, "post_id": 28051057, "comment_id": 44485401, "body": "hi, I think you need to give more details about what if value in B column is false. because the table which you referred is not understandable. If value in B column is &quot;TRUE&quot;, D is definatelly &quot;NEGATIVE&quot;. What about if it is &quot;FALSE&quot;?"}, {"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421775725, "post_id": 28051057, "comment_id": 44485636, "body": "When FALSE then I check characters in range (column C): POSITIVE = (POSITIVE) or (POSITIVE, NEUTRAL) or (POSITIVE,POSITIVE...); NEGATIVE (ever when is NEGATIVE without POSITIVE in range result = NEGATIVE); MIX = (POSITIVE, NEGATIVE) or (POSITIVE,NEGATIVE,NEUTRAL) or (POSITIVE,POSITIVE,NEGATIVE,POSITIVE...) and NEUTRAL (when is only NEUTRAL - (NEUTRAL) or (NEUTRAL,NEUTRAL,NEUTRAL)"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1421776015, "post_id": 28051057, "comment_id": 44485790, "body": "Now it is more clear however I think it is not possible with formulas. You need to go for VBA, unless someone here can provide this to you with formula. For VBA you can start with some While/For loops and range management. I do not know how much you know about VBA, if you try something and update your topic with your trials, I am sure people (including myself) will help you to improve it but I am not sure if someone will write if for you from scratch."}, {"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421776452, "post_id": 28051057, "comment_id": 44486008, "body": "I tried via VBA, but I dont know how take a range. In first loop range will have two cells, next four, next only one. Here I have a problem..."}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1421774553, "creation_date": 1421774553, "answer_id": 28051448, "question_id": 28051057, "link": "https://stackoverflow.com/questions/28051057/checking-algorithm-with-two-conditions-in-ranges/28051448#28051448", "title": "Checking algorithm with two conditions in ranges", "body": "<p>The formula in \"D1\" is a s follows:</p>\n\n<pre><code>=IF(B1=TRUE,\"NEGATIVE\",IF(B1=\"\",\"\", C1))\n</code></pre>\n\n<p>Paste down form \"D1\"</p>\n"}, {"comments": [{"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421774866, "post_id": 28051482, "comment_id": 44485143, "body": "this is yet another implementation of the same logic--a very good learning moment for the OP"}, {"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421775158, "post_id": 28051482, "comment_id": 44485337, "body": "This solved problem first problem when B1=TRUE, but else I need check range (1,2,3,4), (POSSITIVE, POSITIVE, NEGATIVE, NEUTRAL) = MIX. I need to assign a value to column D according to the table next to - table combination."}, {"owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "edited": false, "score": 0, "creation_date": 1421776803, "post_id": 28051482, "comment_id": 44486204, "body": "Sorry, I had problem to understand how your columnA worked with columnC. Could you provide a truth table or a better explanation?"}], "tags": [], "owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "is_accepted": false, "score": 2, "last_activity_date": 1421774664, "creation_date": 1421774664, "answer_id": 28051482, "question_id": 28051057, "link": "https://stackoverflow.com/questions/28051057/checking-algorithm-with-two-conditions-in-ranges/28051482#28051482", "title": "Checking algorithm with two conditions in ranges", "body": "<pre><code>=IF(ISBLANK(B1),\"\", IF(B1=\"TRUE\", \"NEGATIVE\", C1))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421777962, "post_id": 28052131, "comment_id": 44486842, "body": "It&#39;s brilliant! but when I have four times &#39;POSITIVES&#39; result is &#39;ERROR&#39; and should be &#39;POSITIVE&#39;. Why? meritorious green checkmark!"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421778241, "post_id": 28052131, "comment_id": 44486960, "body": "@user3815737 Try now.  Updated to remove the Neutral condition on Positive and Negative found (because either way you want Positive or Negative).  You did forget the condition where you have Positive and Negative but no Neutral.  That isn&#39;t in your table!"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421778428, "post_id": 28052131, "comment_id": 44487049, "body": "@user3815737 I have added BUT COMMENTED OUT the case of Positive and Negative but no Neutral.  You will need to assign a result to it and remove the comment <code>&#39;</code>"}, {"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421778658, "post_id": 28052131, "comment_id": 44487168, "body": "You&#39;re my master! Thanks bro!"}, {"owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "edited": false, "score": 0, "creation_date": 1421782383, "post_id": 28052131, "comment_id": 44489201, "body": "I can&#39;t move this discussion to chat :( I&#39;m working with code and in situation when I have only single ranges code crazy. VBA sees the range as all. Can you check this case? Try run the macro without spaces in column B"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 4, "last_activity_date": 1421783047, "last_edit_date": 1421783047, "creation_date": 1421776908, "answer_id": 28052131, "question_id": 28051057, "link": "https://stackoverflow.com/questions/28051057/checking-algorithm-with-two-conditions-in-ranges/28052131#28052131", "title": "Checking algorithm with two conditions in ranges", "body": "<p>And boom goes the dynamite.  This will take an input like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/owJS8.png\" alt=\"enter image description here\"></p>\n\n<p>And give you this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pyz4I.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Sub TestIt()\n\nDim LastRow As Long, CurRow As Long, InLast As Long, FindRng As Range\n\nLastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nFor CurRow = 1 To LastRow\n    If Not Range(\"B\" &amp; CurRow).Value = \"\" Then\n        If Range(\"B\" &amp; CurRow + 1).Value = \"\" Then\n            InLast = Range(\"B\" &amp; CurRow).End(xlDown).Row - CurRow - 1\n        Else\n            InLast = 0\n        End If\n        If InLast &gt; LastRow Then InLast = LastRow - CurRow\n        If InLast &gt; 0 Then Set FindRng = Range(Cells(CurRow, 3), Cells(InLast + CurRow, 3))\n        Select Case True\n            Case Range(\"B\" &amp; CurRow).Value = \"TRUE\"\n                Range(\"D\" &amp; CurRow).Value = \"NEGATIVE\"\n            Case InLast = 0\n                Range(\"D\" &amp; CurRow).Value = Range(\"C\" &amp; CurRow).Value\n            Case Not FindRng.Find(\"POSITIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And Not FindRng.Find(\"NEGATIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And Not FindRng.Find(\"NEUTRAL\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And InLast &gt; 0\n                Range(\"D\" &amp; CurRow).Value = \"MIX\"\n            Case Not FindRng.Find(\"POSITIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And FindRng.Find(\"NEGATIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And InLast &gt; 0\n                Range(\"D\" &amp; CurRow).Value = \"POSITIVE\"\n            Case FindRng.Find(\"POSITIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And Not FindRng.Find(\"NEGATIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And InLast &gt; 0\n                Range(\"D\" &amp; CurRow).Value = \"NEGATIVE\"\n            Case FindRng.Find(\"POSITIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And FindRng.Find(\"NEGATIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And Not FindRng.Find(\"NEUTRAL\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n                    And InLast &gt; 0\n                Range(\"D\" &amp; CurRow).Value = \"NEUTRAL\"\n            'Case Not FindRng.Find(\"POSITIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n            '        And Not FindRng.Find(\"NEGATIVE\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n            '        And FindRng.Find(\"NEUTRAL\", LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n            '        And InLast &gt; 0\n            '    Range(\"D\" &amp; CurRow).Value = \"CASE POSITIVE AND NEGATIVE NO NEUTRAL\"\n            Case Else\n                Range(\"D\" &amp; CurRow).Value = \"ERROR\"\n        End Select\n    End If\nNext CurRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 3815737, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d66642d92aef1e59d06321d66b48f0bf?s=128&d=identicon&r=PG&f=1", "display_name": "caruzo", "link": "https://stackoverflow.com/users/3815737/caruzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 28052131, "answer_count": 3, "score": 2, "last_activity_date": 1421783047, "creation_date": 1421773291, "last_edit_date": 1421774718, "question_id": 28051057, "link": "https://stackoverflow.com/questions/28051057/checking-algorithm-with-two-conditions-in-ranges", "title": "Checking algorithm with two conditions in ranges", "body": "<p>I have a problem with checking algorithm with two conditions in ranges...\nI want to assign a value after checking the two conditions in ranges...</p>\n\n<p>Example:\n<img src=\"https://i.stack.imgur.com/sim4d.jpg\" alt=\"enter image description here\"></p>\n\n<p>I want to assign a value to column D... and I have numbered ranges with ID (1,2,3...). Column B have value only near ID = 1, next ID is null, but all rows in range have character.\nSo, I need to assign a value to column D according to the table next to.\nWhen column B have TRUE then value in column D = NEGATIVE... end, but when value in column B = FALSE check combination in range.</p>\n\n<p>Expected result:\n<img src=\"https://i.stack.imgur.com/2iDzs.jpg\" alt=\"enter image description here\"></p>\n\n<p>Do you have an idea? Thanks for help!</p>\n"}, {"tags": ["java", "excel", "vba"], "comments": [{"owner": {"reputation": 520, "user_id": 3745734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qj07x.jpg?s=128&g=1", "display_name": "Solano", "link": "https://stackoverflow.com/users/3745734/solano"}, "edited": false, "score": 0, "creation_date": 1421773058, "post_id": 28050923, "comment_id": 44483928, "body": "Try to call a WEBSERVICE from VBA-excel that communicates with a Java application. I already did it once"}], "answers": [{"comments": [{"owner": {"reputation": 749, "user_id": 3962288, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7378c5a9b1a8cd7ae38f49b6cffef83?s=128&d=identicon&r=PG&f=1", "display_name": "Anup Ash", "link": "https://stackoverflow.com/users/3962288/anup-ash"}, "edited": false, "score": 0, "creation_date": 1421780049, "post_id": 28051097, "comment_id": 44487897, "body": "Thanks Solano but i dont have much knowledge on setting up webservice. I will try to read some more... and get back to you .. once again thank you for your help"}, {"owner": {"reputation": 749, "user_id": 3962288, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7378c5a9b1a8cd7ae38f49b6cffef83?s=128&d=identicon&r=PG&f=1", "display_name": "Anup Ash", "link": "https://stackoverflow.com/users/3962288/anup-ash"}, "edited": false, "score": 0, "creation_date": 1421784510, "post_id": 28051097, "comment_id": 44490355, "body": "Solano, is there a way to use jvm process instead of having tomcat servers service such a code."}, {"owner": {"reputation": 520, "user_id": 3745734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qj07x.jpg?s=128&g=1", "display_name": "Solano", "link": "https://stackoverflow.com/users/3745734/solano"}, "reply_to_user": {"reputation": 749, "user_id": 3962288, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7378c5a9b1a8cd7ae38f49b6cffef83?s=128&d=identicon&r=PG&f=1", "display_name": "Anup Ash", "link": "https://stackoverflow.com/users/3962288/anup-ash"}, "edited": false, "score": 0, "creation_date": 1421800431, "post_id": 28051097, "comment_id": 44497103, "body": "you need tomcat to receive the calls to your webservice. it will handle the tcp connections that you dont need to worry. tomcat is really easy just install and deploy on it using eclipse or netbeans."}], "tags": [], "owner": {"reputation": 520, "user_id": 3745734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qj07x.jpg?s=128&g=1", "display_name": "Solano", "link": "https://stackoverflow.com/users/3745734/solano"}, "is_accepted": false, "score": 1, "last_activity_date": 1421773415, "last_edit_date": 1495540619, "creation_date": 1421773415, "answer_id": 28051097, "question_id": 28050923, "link": "https://stackoverflow.com/questions/28050923/calling-or-using-java-jar-module-inside-excel-macro/28051097#28051097", "title": "calling or using java jar module inside excel macro", "body": "<p>My suggestion would be:</p>\n\n<ol>\n<li>Create a Java webservice to provide your business logic<br>\n<a href=\"http://docs.oracle.com/javaee/5/tutorial/doc/bnbor.html\" rel=\"nofollow noreferrer\">First Option</a><br></li>\n<li>Call this webservice from your VBA<br>\n<a href=\"https://stackoverflow.com/questions/474936/call-web-service-in-excel\">First Option</a><br>\n<a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/16900c74-0ee3-469a-b44d-6c00bb58f7c0/web-service-calls-from-vba-excel\" rel=\"nofollow noreferrer\">Second option</a></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 749, "user_id": 3962288, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7378c5a9b1a8cd7ae38f49b6cffef83?s=128&d=identicon&r=PG&f=1", "display_name": "Anup Ash", "link": "https://stackoverflow.com/users/3962288/anup-ash"}, "edited": false, "score": 0, "creation_date": 1421780173, "post_id": 28051177, "comment_id": 44487977, "body": "I did not understand the Spring Boot very well.. Is there a way i can just use the .jar file without being to actually have user run any application servers on their machines, I just want them to use this jar as a function on the excel sheet.."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "reply_to_user": {"reputation": 749, "user_id": 3962288, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7378c5a9b1a8cd7ae38f49b6cffef83?s=128&d=identicon&r=PG&f=1", "display_name": "Anup Ash", "link": "https://stackoverflow.com/users/3962288/anup-ash"}, "edited": false, "score": 0, "creation_date": 1421786368, "post_id": 28051177, "comment_id": 44491280, "body": "If you use spring boot everything will be embedded into 20 to 30 MB. Then you simply call &quot;Java -jar yourwebservice.jar&quot; and from then the web service sits there and waits for incoming connections. No need to install tomcat, jboss or alike ... Packtpub has a great book on spring boot, I think it still has a discount these days. For an instant start this should be a good base and there are even more examples linked from the spring.io blog"}], "tags": [], "owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "is_accepted": false, "score": 0, "last_activity_date": 1421773704, "creation_date": 1421773704, "answer_id": 28051177, "question_id": 28050923, "link": "https://stackoverflow.com/questions/28050923/calling-or-using-java-jar-module-inside-excel-macro/28051177#28051177", "title": "calling or using java jar module inside excel macro", "body": "<p>just an idea: I think it is possible to have Java code converted into something that can be called from .Net. And then .Net from VBA ...\nPerhaps that is another option if you need to have the code locally instead of on a webservice (which might run locally too)\nBut I think having the webservice is way better ... And easier to be maintained. Use Spring Boot for that, will be very easy ...</p>\n"}, {"tags": [], "owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "is_accepted": false, "score": 0, "last_activity_date": 1421822947, "creation_date": 1421822947, "answer_id": 28061165, "question_id": 28050923, "link": "https://stackoverflow.com/questions/28050923/calling-or-using-java-jar-module-inside-excel-macro/28061165#28061165", "title": "calling or using java jar module inside excel macro", "body": "<p>If you go for Spring Boot this is an example how to define a webservice:</p>\n\n<pre><code>@RequestMapping(value = \"/complexlogic\" )\n@ResponseBody\npublic String getTopTen( @RequestParam(value = \"input\", defaultValue = 42) Integer input ) {\n        return \"The answer to anything is: \" + input;\n    }\n</code></pre>\n\n<p>This enables you to call <code>http://localhost:8080/complexlogic?input=42</code> and get a result string. You need JSON ? No big deal, just define an object and modify one of the annotations.</p>\n\n<p>Here is a <a href=\"https://www.packtpub.com/application-development/learning-spring-boot\" rel=\"nofollow\">link</a> to the mentioned book.</p>\n"}], "owner": {"reputation": 749, "user_id": 3962288, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7378c5a9b1a8cd7ae38f49b6cffef83?s=128&d=identicon&r=PG&f=1", "display_name": "Anup Ash", "link": "https://stackoverflow.com/users/3962288/anup-ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1421822947, "creation_date": 1421772886, "last_edit_date": 1531164843, "question_id": 28050923, "link": "https://stackoverflow.com/questions/28050923/calling-or-using-java-jar-module-inside-excel-macro", "title": "calling or using java jar module inside excel macro", "body": "<p>I want to create a simplified function that takes couple of inputs from user.. The inputs are parameters to the java module that has a very complex logic and returns output. This output is passed to excel cell. I tried using ogga.But it is only sheet level. Any suggestions.</p>\n\n<p>I have also tried running the shell commands but it just gives return.</p>\n"}, {"tags": ["excel", "vba", "loops", "export", "text-files"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1421772966, "post_id": 28050871, "comment_id": 44483860, "body": "Where is <code>strName</code> defined?  I would suggest you use <code>Option Explicit</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421774389, "post_id": 28050871, "comment_id": 44484837, "body": "Why are you using <code>Print #1 ... </code> instead of <code>Print hndFile</code>? Also, you probably want to assign <code>hndFile = FreeFile</code> <i>inside</i> the loop (assuming each iteration needs to be a new file)."}, {"owner": {"reputation": 47, "user_id": 4474833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637521930/picture?type=large", "display_name": "Klaas Siderius", "link": "https://stackoverflow.com/users/4474833/klaas-siderius"}, "edited": false, "score": 0, "creation_date": 1421790680, "post_id": 28050871, "comment_id": 44493326, "body": "The <code>strName</code> is defined somewhere else, I left this out for readibility... Thanks for your reply. I tried your sugestion but another error pops up... <code>Compile error: Method not valid without suitable object</code> I find it very strange that I can run the files seperate form eachother..."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4474833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637521930/picture?type=large", "display_name": "Klaas Siderius", "link": "https://stackoverflow.com/users/4474833/klaas-siderius"}, "edited": false, "score": 0, "creation_date": 1421791073, "post_id": 28052927, "comment_id": 44493505, "body": "Thank you for your reply. I tried the adjustment but another error pops up <code>Compile error: Method not valid without suitable object</code> ... I find it very strange that I can run the files seperate from eachother succesfully..."}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 47, "user_id": 4474833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637521930/picture?type=large", "display_name": "Klaas Siderius", "link": "https://stackoverflow.com/users/4474833/klaas-siderius"}, "edited": false, "score": 0, "creation_date": 1421792642, "post_id": 28052927, "comment_id": 44494270, "body": "I apologize, I missed the required # symbol see the updated answer."}, {"owner": {"reputation": 47, "user_id": 4474833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637521930/picture?type=large", "display_name": "Klaas Siderius", "link": "https://stackoverflow.com/users/4474833/klaas-siderius"}, "edited": false, "score": 0, "creation_date": 1421827477, "post_id": 28052927, "comment_id": 44505294, "body": "Yes, It worked! Thank you very much! Should have been able to figure that out for my self, excuse me for my laziness..."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": true, "score": 1, "last_activity_date": 1421792344, "last_edit_date": 1421792344, "creation_date": 1421779625, "answer_id": 28052927, "question_id": 28050871, "link": "https://stackoverflow.com/questions/28050871/vba-creating-textfiles-in-a-loop-from-a-worksheet/28052927#28052927", "title": "VBA creating textfiles in a loop from a worksheet", "body": "<p>There's a bit of inconsistency in your code, you are using hndFile to create the file and #1 to Print to it:</p>\n\n<pre><code>Open strName &amp; \"-DEL_AFT.gef\" For Output As hndFile\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>Print #1, Left$(strOutput, Len(strOutput) - 1)\n</code></pre>\n\n<p>Change the Print statement to the following to maintain consistency:</p>\n\n<pre><code>Print #hndFile, Left$(strOutput, Len(strOutput) - 1)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4474833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637521930/picture?type=large", "display_name": "Klaas Siderius", "link": "https://stackoverflow.com/users/4474833/klaas-siderius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 28052927, "answer_count": 1, "score": 1, "last_activity_date": 1421792344, "creation_date": 1421772713, "last_edit_date": 1421791627, "question_id": 28050871, "link": "https://stackoverflow.com/questions/28050871/vba-creating-textfiles-in-a-loop-from-a-worksheet", "title": "VBA creating textfiles in a loop from a worksheet", "body": "<p>I'm trying to create a loop to process multiple excel files and create for every excel file text-files. I've came a long way but I ran into an error.</p>\n\n<p>I have three pieces of code: 1) a loop, 2) some calculations 3) creation of text-files. Separate from eachother they work like a charm, but when I put them togehter in a single sub (as displayed in the Loop below) I get \"Bad file mode (Error 54)\" for the command [Print #1, Left$(strOutput, Len(strOutput) - 1) ' strString] when creating the text-file. I can't figure out why there is a conflict between the different codes.</p>\n\n<p>The loop is as </p>\n\n<pre><code>Sub GEF_Processor()\nDim i As Integer\nDim fd As FileDialog\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nWith fd\n    .AllowMultiSelect = True\n    .Show\nEnd With\n\nFor i = 1 To fd.SelectedItems.Count\n    addNewWorkBook (fd.SelectedItems.Item(i))\n    Call macro3\nNext i\n\nSet fd = Nothing\nEnd Sub\n</code></pre>\n\n<p>The creating of the text files goes like</p>\n\n<pre><code>Sub macro3()\n\nDim hndFile                                           As Long\nDim intColumn                                         As Integer\nDim intLast_Column                                    As Integer\nDim lngLast_Row                                       As Long\nDim lngRow                                            As Long\nDim strOutput                                         As String\n\n\nintLast_Column = Worksheets(\"CPT_DEL_AFT\").UsedRange.Column - 1 +     Worksheets(\"CPT_DEL_AFT\").UsedRange.Columns.Count\nlngLast_Row =  Worksheets(\"CPT_DEL_AFT\").UsedRange.Rows(Worksheets(\"CPT_DEL_AFT\").UsedRange.Row s.Count).Row\n\nhndFile = FreeFile\n\nOpen \"-DEL_AFT.gef\" For Output As hndFile\n\nFor lngRow = 1&amp; To lngLast_Row\n\n  strOutput = \"\"\n\n  For intColumn = 1 To intLast_Column\n      strOutput = strOutput &amp; Worksheets(\"CPT_DEL_AFT\").Cells(lngRow, intColumn).Value &amp; \"  \"\n  Next intColumn\n\n  If Len(Trim$(Replace(strOutput, \";\", \"\"))) &gt; 0 Then\n     Print hndFile, Left$(strOutput, Len(strOutput) - 1) ' strString\n  End If\n\nNext lngRow\n\nClose #hndFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1421775756, "post_id": 28050443, "comment_id": 44485655, "body": "If the code you want to prevent is running from your add-in then testing for  <code>ThisWorkbook.Name = ActiveWorkbook.Name</code> wouldn&#39;t be sufficient ?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421787742, "post_id": 28050443, "comment_id": 44491928, "body": "@TimWilliams, maybe the name property is too weak (user might name the file as the add-in) but you gave me a good input for using <code>.FullName</code>, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421775138, "post_id": 28051513, "comment_id": 44485326, "body": "Thank you for your answer, you got a point when highlighting my real objective. I have edited the body of my question, I hope it&#39;s clearer now."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421776017, "post_id": 28051513, "comment_id": 44485792, "body": "I think Tim&#39;s suggestion in the comment above is probably on the right track. Seems like you can just compare the workbook&#39;s <code>.Name</code> property, you may <i>also</i> need to check the <code>.IsAddIn</code> property depending on the specific restrictions/needs, but that should take care of it, no?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421788395, "post_id": 28051513, "comment_id": 44492226, "body": "You&#39;re right, didn&#39;t think about that either! As you can see from my above answer, I have found several solutions for the moment but the real question still stays there: why is the <code>FileFormat</code> property changing if the file is still the same? I didn&#39;t find anything in the docs."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421789042, "post_id": 28051513, "comment_id": 44492539, "body": "No, that&#39;s not the &quot;real question&quot;, that&#39;s only to satisfy your curiosity now that your actual implementation problem has been solved :)  Could be a bug, or it could be by design, i.e., maybe there is some background copy of the file being saved in the other format, temporarily..."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421791520, "post_id": 28051513, "comment_id": 44493734, "body": "Mmm maybe you&#39;re right, if we look at &quot;is the problem solved?&quot; I&#39;d say yes, but this looks a bit buggy to me still. However, bug or design, I will mark your answer since it&#39;s the only direct one: &quot;no, the add-in = True doesn&#39;t change the file format but it does this, that and this.&quot;. But I still think MS lacks of documentation on this point. Thanks a lot"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1421792363, "post_id": 28051513, "comment_id": 44494132, "body": "MS lacks documentation on a lot of things :-)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1421774750, "creation_date": 1421774750, "answer_id": 28051513, "question_id": 28050443, "link": "https://stackoverflow.com/questions/28050443/catching-fileformat-property-of-xlam-without-confusion-with-xlsm/28051513#28051513", "title": "Catching FileFormat property of .XLAM without confusion with .XLSM", "body": "<p>The <a href=\"http://msdn.microsoft.com/en-us/library/office/ff838249(v=office.14).aspx\" rel=\"nofollow\"><code>.IsAddIn</code> workbook property simply indicates whether the file is being run <em>as an Add-in</em></a>. It does not change the file format.  From the documentation:</p>\n\n<blockquote>\n  <p>When you set this property to True, the workbook has the following characteristics:</p>\n  \n  <ul>\n  <li>You won\u2019t be prompted to save the workbook if changes are made while the workbook is open.</li>\n  <li>The workbook window won\u2019t be visible.</li>\n  <li>Any macros in the workbook won\u2019t be visible in the Macro dialog box (displayed by pointing to Macro on the Tools menu and clicking Macros).</li>\n  <li>Macros in the workbook can still be run from the Macro dialog box even though they\u2019re not visible. In addition, macro names don\u2019t need to be qualified with the workbook name.</li>\n  <li>Holding down the SHIFT key when you open the workbook has no effect.</li>\n  </ul>\n</blockquote>\n\n<p>I sense that this is the real problem you're trying to tackle:</p>\n\n<blockquote>\n  <p>However, the user should not be able to perform some operations when he's/she's working on the add-in's spreadsheets rather than on the normal workbook where the Add-In is running.</p>\n</blockquote>\n\n<p>Perhaps it will be best if you can specify what actions you're trying to restrict? There may be a better way to solve this.</p>\n"}, {"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 1, "last_activity_date": 1421788536, "last_edit_date": 1421788536, "creation_date": 1421788179, "answer_id": 28055187, "question_id": 28050443, "link": "https://stackoverflow.com/questions/28050443/catching-fileformat-property-of-xlam-without-confusion-with-xlsm/28055187#28055187", "title": "Catching FileFormat property of .XLAM without confusion with .XLSM", "body": "<p>For the moment I have found four possible solutions, that I'm going to post here just in case someone would have my same issue:  </p>\n\n<h2>Comparing the full names - credit to Tim Williams</h2>\n\n<p><em>The \"special code\" cannot run if the full names are different</em>: </p>\n\n<pre><code>If ActiveWorkbook.FullName = ThisWorkbook.FullName Then\n    Exit Sub\nEnd If\n'\"special code\"\n</code></pre>\n\n<h2>Comparing the isAddIn property - credit to David Zemens</h2>\n\n<p><em>The \"special code\" cannot run if this workbook is not currently an add-in</em>: </p>\n\n<pre><code>If ThisWorkbook.IsAddIn = False Then\n    Exit Sub\nEnd If\n'\"special code\"\n</code></pre>\n\n<h2>Comparing the two objects</h2>\n\n<p><em>The \"special code\" cannot run if the active workbook is the add-in workbook</em>: </p>\n\n<pre><code>If ActiveWorkbook Is ThisWorkbook Then\n    Exit Sub\nEnd If \n'\"special code\"\n</code></pre>\n\n<h2>Checking for \"xlam\" extension</h2>\n\n<p><em>The \"special\" code will not be run if the extension of the file is xlam:</em></p>\n\n<pre><code>If Right(ActiveWorkbook.FullName,4) = \"xlam\" Then\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>The four solutions above work fine for the purpose, but the question is still opened : <em>why the <code>FileFormat</code> property changes over the same file depending on <code>ThisWorkbook.IsAddIn</code> being <code>False</code> rather than <code>True</code></em>?</p>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 28051513, "answer_count": 2, "score": 0, "last_activity_date": 1421788536, "creation_date": 1421771416, "last_edit_date": 1421775071, "question_id": 28050443, "link": "https://stackoverflow.com/questions/28050443/catching-fileformat-property-of-xlam-without-confusion-with-xlsm", "title": "Catching FileFormat property of .XLAM without confusion with .XLSM", "body": "<h2>Context</h2>\n\n<p>I have developed a <code>.xlam</code> add-in that contains user-data inside. In other words, the user can decide to show the add-in file through a <code>ThisWorkbook.IsAddIn = False</code> to edit the content, which is functional to the add-in itself. </p>\n\n<p><em>However</em>, the user should not be able to perform some operations when he's/she's working on the add-in's spreadsheets rather than on the normal workbook where the Add-In is running. </p>\n\n<h2>Need to check for file extension</h2>\n\n<p>From here, it comes my need of checking for the file extension and validate it when some specific \"forbidden\" procedures might get called. I have made the following tests:</p>\n\n<ul>\n<li>If <code>ThisWorkbook.IsAddIn = True</code>, then <code>ThisWorkbook.FileFormat = 55</code>;</li>\n<li>If <code>ThisWorkbook.IsAddIn = False</code>, then <code>ThisWorkbook.FileFormat = 52</code>;</li>\n</ul>\n\n<h2>The source of confusion</h2>\n\n<p>This is not what I was expecting. By simply executing a <code>FullName</code> request <strong>when the Add-In is set visible</strong>:</p>\n\n<pre><code>ThisWorkbook.IsAddIn = False\nMsgBox ThisWorkbook.FullName\n</code></pre>\n\n<p>I can read that my file is still named <code>C:\\myFile.xlam</code>, even if in that moment is visible to the user. So, I would expect <code>ThisWorkbook.FileFormat</code> to raise a <code>55</code> even if visible at run-time. But it doesn't do that, apparently. </p>\n\n<h2>The question</h2>\n\n<p>I need to make sure to distinguish between modifications <em>on the Add-In (.xlam)</em> and modifications <em>on a possible .xlsm file that the user created, from which is using my Add-In</em>. \nWhy is the <code>FileFormat</code> of my add-in being equal to the one of an <code>xlsm</code>, if the file is clearly <code>xlam</code> to which is associated a <code>55</code> instead of a <code>52</code>? Where am I being wrong? </p>\n\n<h2>EDIT - Example of the action to forbid</h2>\n\n<p>On the ribbon there's a button created and added from the add-in, which is connected to a macro that <em>cannot be run into the Add-In</em>. So the check I had in mind was something like this: </p>\n\n<pre><code>If ActiveWorkbook.FileFormat = 55 Then\n    Exit Sub\nEnd If \n</code></pre>\n\n<p>However, as said above, this check will not be performed because the Add-In has <code>FileFormat = 52</code> in the moment in which is set to <code>.IsAddIn = False</code>; hence, even if the <code>ActiveWorkbook</code> is the add-in where I do <strong>not</strong> want to run the macro, the check will fail and the macro will run anyway. </p>\n"}, {"tags": ["excel", "activex", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 4349726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h-QNkmL8uYs/AAAAAAAAAAI/AAAAAAAABaY/HIbcLrBTzGk/photo.jpg?sz=128", "display_name": "Ian Jenkins", "link": "https://stackoverflow.com/users/4349726/ian-jenkins"}, "edited": false, "score": 0, "creation_date": 1421772010, "post_id": 28050291, "comment_id": 44483260, "body": "My Mistake. See above"}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1421780482, "last_edit_date": 1421780482, "creation_date": 1421773905, "answer_id": 28051241, "question_id": 28050291, "link": "https://stackoverflow.com/questions/28050291/vba-activex-button-to-activate-specific-keypress-seq/28051241#28051241", "title": "VBA Activex button to activate specific keypress seq", "body": "<p>As a general note, mimicking the actions of the keyboard through VBA involves using the <code>Application.SendKeys</code> command. In your specific case, the code would be:</p>\n\n<pre><code>Application.SendKeys \"{F5}\"\nApplication.Wait (Now + TimeValue(\"00:00:01\"))\nApplication.SendKeys \"~\" 'The tilde is the Enter key  \n</code></pre>\n\n<p>Generally, I prefer <em>not</em> to use this methodology. On my computer, for example, the third line of code runs before the first line has completed its action. In that case, I'm sitting with the Go To dialog box on my screen. That's why I separate the two lines with a call for the system to delay processing.</p>\n\n<p>EDIT: (I think I cut off part of my original post)</p>\n\n<p>In my opinion, your best bet is to allow Excel to handle the flow back to the hyperlink cells. The also opens up the possibility to move back beyond just the last cell. Below is a loose example of the code, which should be adapted.</p>\n\n<p>In a module, enter the below code:</p>\n\n<pre><code>Public strLastSheet(1 To 10) As Worksheet\nPublic strLastRange(1 To 10) As Range\nPublic nLastCell As Integer\nPublic nCurrentIndex As Integer\n\n\nSub SelectLastHyperlinkedCellFoShizzle()\n    strLastSheet(nCurrentIndex).Activate\n    strLastRange(nCurrentIndex).Select\n\n     If nCurrentIndex &lt;= 1 Then\n         'Do Nothing\n    Else\n        nCurrentIndex = nCurrentIndex - 1\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>In the ThisWorkbook  code, enter the following:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    nLastCell = 0\n    nCurrentIndex = 0\nEnd Sub\nPrivate Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)\n    nLastCell = nLastCell + 1\n    Set strLastSheet(nLastCell) = Sh\n    Set strLastRange(nLastCell) = Target.Parent\n    nCurrentIndex = nLastCell\nEnd Sub\n</code></pre>\n\n<p>This is set to store the previous 10 hyperlink addresses. It should be further modified to disallow entries beyond 10 into the array, and perhaps shift the previous entries down the array.</p>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": true, "score": 0, "last_activity_date": 1421774760, "creation_date": 1421774760, "answer_id": 28051519, "question_id": 28050291, "link": "https://stackoverflow.com/questions/28050291/vba-activex-button-to-activate-specific-keypress-seq/28051519#28051519", "title": "VBA Activex button to activate specific keypress seq", "body": "<p>Since application.goto function stores the last reference as default you can simply bind a key for the following command</p>\n\n<pre><code>    Application.Goto\n</code></pre>\n\n<p>This is not the perfect solution but it will do what you want. All you need to do is add this line to button_click.</p>\n"}], "owner": {"reputation": 3, "user_id": 4349726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h-QNkmL8uYs/AAAAAAAAAAI/AAAAAAAABaY/HIbcLrBTzGk/photo.jpg?sz=128", "display_name": "Ian Jenkins", "link": "https://stackoverflow.com/users/4349726/ian-jenkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 28051519, "answer_count": 2, "score": 0, "last_activity_date": 1421780482, "creation_date": 1421770993, "last_edit_date": 1531164843, "question_id": 28050291, "link": "https://stackoverflow.com/questions/28050291/vba-activex-button-to-activate-specific-keypress-seq", "title": "VBA Activex button to activate specific keypress seq", "body": "<p>While Navigating my sheet I use the F5+[enter] to navigate back to the cell that I hyperlinked from on a different sheet in the same workbook.\nI have now made an Activex button to act as a back button but I need the script to make it do an F5+[enter] when clicked on.</p>\n\n<p>I have lots of hyperlinks from different areas that go to one specific sheet and I basically want the Activex button to return the cursor back from whence it came.</p>\n\n<p>Any help would be appreciated\nThank you</p>\n\n<p>*****Sorry My fault I meant Active X Button*****\nEdited and re tagged. Much appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421772805, "post_id": 28050232, "comment_id": 44483758, "body": "Why are you not defining the property of the cell using <code>.Value</code>, <code>.Text</code>, or <code>.Formula</code>?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421773433, "post_id": 28050232, "comment_id": 44484230, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6458941/vba-entering-as-the-first-character-in-a-cell\">VBA Entering &#39;=&#39; as the first character in a cell</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 2, "last_activity_date": 1421771084, "creation_date": 1421771084, "answer_id": 28050331, "question_id": 28050232, "link": "https://stackoverflow.com/questions/28050232/enter-value-as-text-to-cell-using-vba-even-if-value-starts-with/28050331#28050331", "title": "Enter value as text to cell using VBA even if value starts with =?", "body": "<p>You can add a Single Quotes before the value making it treat as a String,</p>\n\n<pre><code>wksWrite.Cells(lWriteRow, \"F\") = \"'\" &amp; Trim(wksRead.Cells(lReadRow, 2))\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1421771084, "creation_date": 1421770814, "question_id": 28050232, "link": "https://stackoverflow.com/questions/28050232/enter-value-as-text-to-cell-using-vba-even-if-value-starts-with", "title": "Enter value as text to cell using VBA even if value starts with =?", "body": "<p>I get an error on the following expression:</p>\n\n<pre><code>wksWrite.Cells(lWriteRow, \"F\") = Trim(wksRead.Cells(lReadRow, 2))\n</code></pre>\n\n<p>because <code>Trim(wksRead.Cells(lReadRow, 2))</code> evaluates to:</p>\n\n<pre><code>=SKYDDSFOLIE F\u00d6R SR-72 5424\n</code></pre>\n\n<p>I guess Excel evaluates that as a formula and doesn't allow VBA to enter it. But I want to enter that value as text. I tried adding:</p>\n\n<pre><code>    wksWrite.Cells(lWriteRow, \"B\").NumberFormat = \"@\"\n    wksWrite.Cells(lWriteRow, \"F\").Value = CStr(Trim(wksRead.Cells(lReadRow, 2)))\n</code></pre>\n\n<p>But I still get the same error. How can I force Excel to interpret the value as text and accept it?</p>\n"}, {"tags": ["excel", "excel-formula", "rate", "vba"], "comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1421912990, "post_id": 28050109, "comment_id": 44545135, "body": "@pnuts Check this out: <a href=\"http://www.provident.com.mx/\" rel=\"nofollow noreferrer\">provident.com.mx</a> As for today (2015-01-22) there is an offer of a loan right on the landing page. You borrow a 1000 pesos. After 31 weeks you have to pay back 1890 pesos. If compounding for a loan with such parameters was weekly then APR=857%. Google for <code>pay day loans</code>:-)"}], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 2430171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kEarE.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/2430171/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1421883132, "creation_date": 1421883132, "answer_id": 28078853, "question_id": 28050109, "link": "https://stackoverflow.com/questions/28050109/excel-vba-formula-for-apr/28078853#28078853", "title": "Excel VBA formula for APR", "body": "<p>This seems to be quite a unrealistic scenario but it is possible to figure out.  I am sure there is an easier way to do this but you can use the <code>=PMT</code> formula to back into it.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=MXf0HU-JQ1Q\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=MXf0HU-JQ1Q</a></p>\n\n<p>Download the file included form this YouTube video and update with your values.  For now use a dummy APR as a plug.  Delete all rows after 60 periods and <code>sum</code> the Interest Paid column.  You are looking for a scenario in which you paid 1,000.00 in interest considering the loan was for 1,000 and you say you paid 2,000.00 total in equal payments.  So you need sum of Intest over 60 periods should be 1,000.</p>\n\n<p>From there you can start adjusting the APR, noting the total inerest paid until you reach your goal.  I come up with 136.87% which is unrealistic, but as I said, your scenario seems rather unrealistic unless I am reading it incorrectly.</p>\n\n<p><img src=\"https://i.stack.imgur.com/l9hMQ.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 7509, "user_id": 879601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/27cc474aabcf747afb847f66499a1b7c?s=128&d=identicon&r=PG", "display_name": "Chris Degnen", "link": "https://stackoverflow.com/users/879601/chris-degnen"}, "edited": false, "score": 0, "creation_date": 1422021936, "post_id": 28084325, "comment_id": 44596895, "body": "+1 Calculation works as advertised, delivering APR as <a href=\"http://en.wikipedia.org/wiki/Effective_interest_rate\" rel=\"nofollow noreferrer\">effective annual interest rate</a>."}], "tags": [], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "is_accepted": true, "score": 2, "last_activity_date": 1423562762, "last_edit_date": 1492086330, "creation_date": 1421916005, "answer_id": 28084325, "question_id": 28050109, "link": "https://stackoverflow.com/questions/28050109/excel-vba-formula-for-apr/28084325#28084325", "title": "Excel VBA formula for APR", "body": "<p>Here goes the code for APR. I will appreciate any remarks on optimizing the search mechanism and the types I assigned to variables (Double, Integer). </p>\n\n<p>The idea of the macro is to increase <em>nominal interest rate (i)</em> starting from 1% by a very small value <em>(step)</em> as long as it brings us closer for proper calculation of <em>Total cost of a loan paid in equal installments (B)</em>.</p>\n\n<pre><code>Function APR(A As Double, B As Double, c As Integer, k As Integer, Optional i As Double = 0.01, Optional step As Double = 0.0001) As Double\n'Author Przemyslaw Remin, thanks for explanation to Chris Degnen\n'\n'A - Loan amount we borrow\n'B - Total amount we pay back in equal installments in k periods\n'c - Number of compoundings per year\n'k - Number of periodic payments\n'i - Nominal interest rate, here it will be used as iterator to find correct B\n'step - how much we change i, the smaller the step the more precision we get\n'\nDim target1 As Double\nDim target2 As Double\n\nDo Until target1 &lt; target2 'we do the loop until the target falls\n    target1 = ((i / c) / (1 - (1 + i / c) ^ (-k)) - (B / (k * A))) ^ 2\n    i = i + step\n    target2 = (((i + step) / c) / (1 - (1 + (i + step) / c) ^ (-k)) - (B / (k * A))) ^ 2\nLoop\n\nAPR = (1 + i / c) ^ c - 1\nEnd Function\n</code></pre>\n\n<p>Thanks to Chris Degnen for his kind explanation on APR calculation mechanism provided here: <a href=\"https://money.stackexchange.com/questions/43450/how-to-calculate-annual-percentage-rate?noredirect=1#comment64347_43450\">https://money.stackexchange.com/questions/43450/how-to-calculate-annual-percentage-rate?noredirect=1#comment64347_43450</a> </p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 2555436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7bN7.gif?s=128&g=1", "display_name": "DJohnM", "link": "https://stackoverflow.com/users/2555436/djohnm"}, "is_accepted": false, "score": 1, "last_activity_date": 1423589010, "creation_date": 1423589010, "answer_id": 28437905, "question_id": 28050109, "link": "https://stackoverflow.com/questions/28050109/excel-vba-formula-for-apr/28437905#28437905", "title": "Excel VBA formula for APR", "body": "<p>Here's a modification of the OP's solution:</p>\n\n<p>First, make sure that B > A;  i.e. there is a positive interest rate</p>\n\n<p>Then, assume a ridiculously tiny interest rate: say, 0.000000000001%</p>\n\n<p>Use this with the other data in the annuity formula to calculate the regular payment expected from this assumed interest rate.  The calculated payment will be smaller than the one specified in the problem, since the true interest rate is higher than the assumed one.</p>\n\n<p>Double the assumed interest rate and repeat the previous step.  Eventually, the calculated payment will exceed the given payment.  You now have a current assumed interest rate that is too big, and the previous one, which was too small. </p>\n\n<p>Do a binary search between these two values until the too-high rate and the too-low rate converge to the degree desired...</p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2195, "favorite_count": 1, "accepted_answer_id": 28084325, "answer_count": 3, "score": 0, "last_activity_date": 1464037077, "creation_date": 1421770476, "last_edit_date": 1531164843, "question_id": 28050109, "link": "https://stackoverflow.com/questions/28050109/excel-vba-formula-for-apr", "title": "Excel VBA formula for APR", "body": "<p>How to calculate Annual Percentage Rate (APR) given the following:</p>\n\n<p><em>A</em> - Loan borrowed at the beginning (USD 1000),<br>\n<em>B</em> - The sum of total loan final costs paid by the borrower in equal installments (USD 2000),<br>\n<em>c</em> - Number of compounding periods per year (52 weeks),<br>\n<em>k</em> - Number of periods to pay the loan (60 weeks)<br></p>\n\n<p>All the formulas found in literature use <em>nominal interest rate</em> (also Excel <code>Effective</code> function) but here we do not have this argument.</p>\n\n<p>By APR I mean: <a href=\"http://en.wikipedia.org/wiki/Annual_percentage_rate\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Annual_percentage_rate</a></p>\n\n<p>I have constructed a spreadsheet where I can find APR with Excel Solver by changing <em>nominal interest rate</em>. Wouldn't there be more elegant solution for that?</p>\n"}, {"tags": ["vba", "file-io"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1421770287, "post_id": 28049913, "comment_id": 44482100, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/11126551/vb-appending-to-a-text-file\">VB appending to a text file</a>"}], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 2088914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a4d24cb5d6da522a873a69be1fe8fe?s=128&d=identicon&r=PG", "display_name": "o.carltonne", "link": "https://stackoverflow.com/users/2088914/o-carltonne"}, "edited": false, "score": 0, "creation_date": 1421779741, "post_id": 28049985, "comment_id": 44487729, "body": "@duDE you are right, the create parameter will create if the file doesn&#39;t exist and just open it if it does. So the create parameter on this function is not needed.  see edits."}, {"owner": {"reputation": 123, "user_id": 4457272, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2b8207de8c61e586201e4e935b35ab59?s=128&d=identicon&r=PG&f=1", "display_name": "baboufight", "link": "https://stackoverflow.com/users/4457272/baboufight"}, "edited": false, "score": 0, "creation_date": 1421833372, "post_id": 28049985, "comment_id": 44508222, "body": "Thanks! Working perfectly, just one more question, fso object will be create every time I will call the function right? Is it better to create it one time outside the function to optimize the code or it doesn&#39;t make sense?"}, {"owner": {"reputation": 310, "user_id": 2088914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a4d24cb5d6da522a873a69be1fe8fe?s=128&d=identicon&r=PG", "display_name": "o.carltonne", "link": "https://stackoverflow.com/users/2088914/o-carltonne"}, "reply_to_user": {"reputation": 123, "user_id": 4457272, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2b8207de8c61e586201e4e935b35ab59?s=128&d=identicon&r=PG&f=1", "display_name": "baboufight", "link": "https://stackoverflow.com/users/4457272/baboufight"}, "edited": false, "score": 0, "creation_date": 1421854595, "post_id": 28049985, "comment_id": 44521374, "body": "Since you&#39;re saying you want to reuse this, or potentially include this script in some other yet unknown scripts, keep the functionality encapsulated.  It is slightly more efficient to have one fso declared at the top of the script - but for this the encapsulation of the functionality is more important.  You don&#39;t want to have to remember to put the new fso at the top of every calling script to make sure your log function has what it needs."}, {"owner": {"reputation": 123, "user_id": 4457272, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2b8207de8c61e586201e4e935b35ab59?s=128&d=identicon&r=PG&f=1", "display_name": "baboufight", "link": "https://stackoverflow.com/users/4457272/baboufight"}, "edited": false, "score": 0, "creation_date": 1421922756, "post_id": 28049985, "comment_id": 44550285, "body": "Thank you for this clarification"}], "tags": [], "owner": {"reputation": 310, "user_id": 2088914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a4d24cb5d6da522a873a69be1fe8fe?s=128&d=identicon&r=PG", "display_name": "o.carltonne", "link": "https://stackoverflow.com/users/2088914/o-carltonne"}, "is_accepted": true, "score": 1, "last_activity_date": 1421779771, "last_edit_date": 1421779771, "creation_date": 1421770164, "answer_id": 28049985, "question_id": 28049913, "link": "https://stackoverflow.com/questions/28049913/create-and-manage-log-txt-file/28049985#28049985", "title": "Create and manage Log.txt file", "body": "<p>use OpenTextFile instead of CreateTextFile.  </p>\n\n<pre><code>fso.OpenTextFile(filename, 8)\n</code></pre>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/314cz14s%28v=vs.85%29.aspx\" rel=\"nofollow\"><em>MSDN - OpenTextFile Documentation</em></a></p>\n\n<pre><code>Function WriteLog(text)\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Dim oFile As Object\n    Set oFile = fso.OpenTextFile(\"C:\\Log.txt\", 8)\n    oFile.writeline text\n    oFile.Close\n    Set fso = Nothing\n    Set oFile = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1421770235, "creation_date": 1421770235, "answer_id": 28050009, "question_id": 28049913, "link": "https://stackoverflow.com/questions/28049913/create-and-manage-log-txt-file/28050009#28050009", "title": "Create and manage Log.txt file", "body": "<p>You need to use OpenTextFile instead of CreateTextFile like this:</p>\n\n<pre><code>' Set oFile = fso.CreateTextFile(\"C:\\Log.txt\", True)\n\nSet oFile = fso.OpenTextFile(\"C:\\Log.txt\", ForAppending, True)\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4457272, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2b8207de8c61e586201e4e935b35ab59?s=128&d=identicon&r=PG&f=1", "display_name": "baboufight", "link": "https://stackoverflow.com/users/4457272/baboufight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 28049985, "answer_count": 2, "score": 1, "last_activity_date": 1421779771, "creation_date": 1421769933, "last_edit_date": 1421770340, "question_id": 28049913, "link": "https://stackoverflow.com/questions/28049913/create-and-manage-log-txt-file", "title": "Create and manage Log.txt file", "body": "<p>I have vba code to run which include many functions, and I would like to add a function called \"WriteLog\" which will create (if it not already exist) a text file named Log.txt and write the string \"text\" (passed as argument) to this file.</p>\n\n<p>I want this function to be launch from several other functions to monitor their execution. My problem is that my actual code overwrite the text file, instead of adding a new line into it when I call my function.</p>\n\n<p>Here my actual code :</p>\n\n<pre><code>Function WriteLog(text)\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Dim oFile As Object\n    Set oFile = fso.CreateTextFile(\"C:\\Log.txt\", True)\n    oFile.writeline (text)\n    oFile.Close\n    Set fso = Nothing\n    Set oFile = Nothing\nEnd Function\n\nSub Logtesting()\n    WriteLog (\"Testing\")\n    WriteLog (\"123\")\nEnd Sub\n</code></pre>\n\n<p>Output result:</p>\n\n<blockquote>\n  <p>123</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "excel-udf"], "comments": [{"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1421769431, "post_id": 28049579, "comment_id": 44481431, "body": "I guess the solution is you need to check every cell in range for color change. And on change call your UDF"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421773720, "post_id": 28049579, "comment_id": 44484427, "body": "The short answer (you have several workarounds below) is no. Formatting should be used to <i>reflect</i> data, not as data. ;)"}, {"owner": {"reputation": 43, "user_id": 4473708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj2bU.png?s=128&g=1", "display_name": "SimonMoon", "link": "https://stackoverflow.com/users/4473708/simonmoon"}, "edited": false, "score": 0, "creation_date": 1421781439, "post_id": 28049579, "comment_id": 44488654, "body": "That&#39;s what I said. :-) I suggested to have the user type a value into the cell changing the color by conditional formatting. And then it would be much easier for calculations. But no, the people are used to using the colors. Change Management :-)"}], "answers": [{"tags": [], "owner": {"reputation": 659, "user_id": 2502511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c47afe6ea5176ebe6e6618776971351?s=128&d=identicon&r=PG", "display_name": "ignotus", "link": "https://stackoverflow.com/users/2502511/ignotus"}, "is_accepted": true, "score": 1, "last_activity_date": 1421770707, "last_edit_date": 1421770707, "creation_date": 1421770397, "answer_id": 28050076, "question_id": 28049579, "link": "https://stackoverflow.com/questions/28049579/automatic-calculation-of-excel-vba-udf-related-to-cell-properties/28050076#28050076", "title": "Automatic calculation of Excel VBA UDF related to cell properties", "body": "<p>I don't think it is possible, but a quite fair solution would be to recalculate when you leave a cell or change it:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Me.Calculate\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Me.Calculate\nEnd Sub\n</code></pre>\n\n<p>Or as an alternative, place a button on the sheet that calls <code>Me.Calculate</code></p>\n\n<p>FYI: What is <code>Me</code>? <a href=\"http://forum.chandoo.org/threads/proper-use-of-me-in-vba.14980/\" rel=\"nofollow\">Source</a></p>\n\n<p><code>Me</code> refers to the parent object from which the code is \"sitting\" in. If you are writing in a Sheet module, the <code>Me</code> will refer to that specific sheet.</p>\n\n<p>Using <code>Me</code> is handy because we don't have to worry about the sheet name changing, and it also makes it a little easy for future code readers as they don't have to remember that \"Main UserForm\" is the UserForm we are currently working on. You can apply the same methods to the <code>Me</code> that you would be able to apply to the object if you gave the full name.</p>\n\n<p>Within the <code>Sheet1 module</code>, the following lines are identical in purpose:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\").Select\nMe.Range(\"A1\").Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1421770933, "creation_date": 1421770933, "answer_id": 28050269, "question_id": 28049579, "link": "https://stackoverflow.com/questions/28049579/automatic-calculation-of-excel-vba-udf-related-to-cell-properties/28050269#28050269", "title": "Automatic calculation of Excel VBA UDF related to cell properties", "body": "<p>If your function executes very quickly (say, under 50 msec) then you can call it from the event handler <code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</code>; users will not notice it happens. One other problem with this solution would be when the user changes format and leaves the worksheet straight away. Then, if you care for recalc to happen, you can, perhaps, use the <code>Private Sub Worksheet_Deactivate()</code> to run it. There are other possibilities, none bullet-proof or remotely simple.</p>\n"}], "owner": {"reputation": 43, "user_id": 4473708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj2bU.png?s=128&g=1", "display_name": "SimonMoon", "link": "https://stackoverflow.com/users/4473708/simonmoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "accepted_answer_id": 28050076, "answer_count": 2, "score": 4, "last_activity_date": 1421781328, "creation_date": 1421768998, "last_edit_date": 1421781328, "question_id": 28049579, "link": "https://stackoverflow.com/questions/28049579/automatic-calculation-of-excel-vba-udf-related-to-cell-properties", "title": "Automatic calculation of Excel VBA UDF related to cell properties", "body": "<p>I have written an UDF to count cells of certain color and with certain LineStyles, I'm posting the entire function: </p>\n\n<pre><code>Function CountTime(rData As Range, cellRefColor As Range) As Variant    \n\n    Dim indRefColor As Long\n    Dim cellCurrent As Range\n    Dim cntRes As Variant\n\n    Application.Volatile\n\n    cntRes = 0\n    indRefColor = cellRefColor.Cells(1, 1).Interior.Color\n    For Each cellCurrent In rData\n        If indRefColor = cellCurrent.Interior.Color Then\n            cntRes = cntRes + 1\n        End If\n        If cellCurrent.Borders(xlDiagonalUp).LineStyle &lt;&gt; xlNone Then\n            cntRes = cntRes + 0.5\n        End If\n    Next cellCurrent\n\n    CountTime = cntRes\nEnd Function\n</code></pre>\n\n<p>Now, the problem I have is that the formula does not automatically calculate when one of the cells in <code>rData</code> has it's color or line properties changed. \nI have added <code>Application.Volatile</code>, and I also tried to trigger the calculation by a <code>Worksheet_Change</code> sub, however that does not work as Excel does not seem to consider changing color a change to the cell/worksheet. </p>\n\n<p>Is there any way to make the cell calculate and update automatically when a user changes the color or line properties of a cell in <code>rData</code>?</p>\n\n<p>EDIT -- SOLVED\nThanks very much ignotus, the ChangeSelection workaround is good enough for my purposes. Didn't think of that.\nAnd the background info is also handy, thanks a lot. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1421768440, "post_id": 28049266, "comment_id": 44480696, "body": "your example data is a little confusing.  It looks like you&#39;re calling columns rows.  Where is this information to be output? Another sheet, another column?"}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 2430171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kEarE.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/2430171/mitch"}, "edited": false, "score": 0, "creation_date": 1422382861, "post_id": 28050207, "comment_id": 44723721, "body": "Did this do the trick?  Please accept the answer to the left with a green checkmark if this works.  If not, perhaps more clarification on the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user983988"}, "edited": false, "score": 0, "creation_date": 1439808763, "post_id": 28050207, "comment_id": 51996616, "body": "Sorry for the late response. This did work perfectly."}], "tags": [], "owner": {"reputation": 522, "user_id": 2430171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kEarE.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/2430171/mitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1421770754, "creation_date": 1421770754, "answer_id": 28050207, "question_id": 28049266, "link": "https://stackoverflow.com/questions/28049266/check-the-length-of-data-in-a-cell-and-add-a-zero/28050207#28050207", "title": "Check the length of data in a cell and add a zero", "body": "<p>VBA is not needed in this case.  A simple <code>IF Statement</code> should do the trick.  Assuming the column you want to evalutate is column A place this in column B and duplicate down the column:</p>\n\n<pre><code>=+IF(LEN(A1)=5,\"0\" &amp; A1,A1)\n</code></pre>\n\n<p>This will work provided all values are 5 or 6 characters long as it appears in your sample data.</p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1423870775, "creation_date": 1423870775, "answer_id": 28510595, "question_id": 28049266, "link": "https://stackoverflow.com/questions/28049266/check-the-length-of-data-in-a-cell-and-add-a-zero/28510595#28510595", "title": "Check the length of data in a cell and add a zero", "body": "<p>It seems OP may be happy with a Custom Format of:</p>\n\n<pre><code>#000000  \n</code></pre>\n\n<p>This is easy to apply but mainly may be a good idea because most other ways of prepending a <code>0</code> are only possible by conversion of numeric values to strings (as otherwise Excel will automatically strip leading zeros). If that is done selectively (for length 5 but not length 6) a column of what appears to be numbers might end up with mixed types (of different behaviour) and so confuse or inconvenience.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user983988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 28050207, "answer_count": 2, "score": 0, "last_activity_date": 1423870775, "creation_date": 1421768114, "last_edit_date": 1421769423, "question_id": 28049266, "link": "https://stackoverflow.com/questions/28049266/check-the-length-of-data-in-a-cell-and-add-a-zero", "title": "Check the length of data in a cell and add a zero", "body": "<p>I have a spreadsheet containing data in the following format:</p>\n\n<pre><code>         Col1            Col2\nROW1:    21211     Customer 3873721\nROW2:   101111     Customer 2321422\nROW3:    91214     Customer 2834712\nROW4:   231014     Customer 3729123\n</code></pre>\n\n<p>I need to be able to create a macro that goes through each row and determines the number of characters that make up the row1 data.</p>\n\n<p>For example: </p>\n\n<blockquote>\n  <p>If data contained in the first cell or ROW1 consisted of a total of 6\n  characters then this will remain the same. If it consisted of 5\n  characters then a zero needs to be added to the front of it.</p>\n</blockquote>\n\n<p>I'm using Excel 2003.</p>\n"}, {"tags": ["vba", "for-loop", "increment", "activexobject"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1421768462, "post_id": 28049107, "comment_id": 44480712, "body": "maybe because some of the values are hardcoded?"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421769066, "post_id": 28049107, "comment_id": 44481167, "body": "I do not know what you mean by hardcoded. I have next to no programming knowledge, I am surprisingly ignorant, but willing to learn."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421770048, "post_id": 28049107, "comment_id": 44481911, "body": "@BOB so what is special about <code>Cells(16, 3)</code>? Aka <code>C16</code>?"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421770593, "post_id": 28049107, "comment_id": 44482319, "body": "It displays the number of rows on this sheet. By rows here, I mean the number which have been filled in by the machine operator. There are other rows of headers and fluff on top of the rows being filled in, these don&#39;t count. The initial value is set at 1."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421770866, "post_id": 28049844, "comment_id": 44482513, "body": "I am not sure of the logic behind your code.  Here is what I grasp:  I should create a variable which is the end row (lEndRow).  I should create a variable which is the start row (lStartRow).  Then using the Row.Count function make the loop cycle in function of how many rows there are...?"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421771170, "post_id": 28049844, "comment_id": 44482721, "body": "I don&#39;t think I need the start row really, as all I need to know is where the last row is on the sheet so I can plus a new row just beneath it. Thanks, for helping!"}, {"owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "reply_to_user": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421779500, "post_id": 28049844, "comment_id": 44487597, "body": "If all you need is the last row on the sheet then store this value. When you insert a new row add one to the value. This will save you having to worry about the number of rows etc."}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1421780171, "post_id": 28049844, "comment_id": 44487973, "body": "Not quite, I need both the last row so that I may add another row beneath it and the number of rows added + 1."}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": true, "score": 0, "last_activity_date": 1421769740, "creation_date": 1421769740, "answer_id": 28049844, "question_id": 28049107, "link": "https://stackoverflow.com/questions/28049107/incrementing-vba-for-loop-through-command-button/28049844#28049844", "title": "Incrementing VBA For loop through command button", "body": "<p>Writing a for loop like this </p>\n\n<pre><code>For y = ThisWorkbook.Worksheets(\"Flags\").Cells(16.3) To y + 1\n</code></pre>\n\n<p>is the same as writing it like this </p>\n\n<pre><code>For y = ThisWorkbook.Worksheets(\"Flags\").Cells(16.3) To 1\n</code></pre>\n\n<p>I'm guessing the value in the cell is zero so it will execute the loop for 0 and 1 - i.e. the two times you are seeing.</p>\n\n<p>You need something like</p>\n\n<pre><code>lEndRow = lStartRow + (lRowCount - 1)\nFor y = lStartRow to  lEndRow\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1421779607, "creation_date": 1421779607, "answer_id": 28052921, "question_id": 28049107, "link": "https://stackoverflow.com/questions/28049107/incrementing-vba-for-loop-through-command-button/28052921#28052921", "title": "Incrementing VBA For loop through command button", "body": "<p>I have this going fine now. Just can't get it to do all the columns with the right borders... I am not sure how to to call them while using the cells(#, #) notation and I can't see how to use the Range(''Z#,Z#'') notation with my i variable being a Long...</p>\n\n<p>Anyways: here's the result so far:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub NewLineRedButton_Click()\n\n        Dim i As Long\n        Dim y As Long\n        Dim RowEnd As Long\n\n\n        RowEnd = ThisWorkbook.Worksheets(\"Flags\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For y = 19 To RowEnd\n        ThisWorkbook.Worksheets(\"Flags\").Cells(16, 3) = y - 17 ' First row which is already on the sheet is on row 19, first row appearing by button clicking is on row 20 and the program is counting the header hence the y - 17 for the value of the number of rows.\n        For i = 19 To RowEnd + 1 Step 1\n            ThisWorkbook.Worksheets(\"Flags\").Rows(i).RowHeight = 45\n            ThisWorkbook.Worksheets(\"Flags\").Cells(i, 1).Borders.LineStyle = xlContinuous\n            ThisWorkbook.Worksheets(\"Flags\").Cells(i, 1).Borders.Weight = xlMedium\n\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for the help and ideas, finally wiggled around and found other resources from the leads given here.</p>\n"}], "owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 0, "accepted_answer_id": 28049844, "answer_count": 2, "score": 1, "last_activity_date": 1421779607, "creation_date": 1421767621, "last_edit_date": 1421769216, "question_id": 28049107, "link": "https://stackoverflow.com/questions/28049107/incrementing-vba-for-loop-through-command-button", "title": "Incrementing VBA For loop through command button", "body": "<p>Good day!</p>\n\n<p>I am currently having a slight issue with a command button, which, I would like to be able to do the following: format a specific row to a certain row height, add thick borders to a certain number of cells in this same row and counting and adding the number of rows thus produced to the initial number in the file. Basically, the button should enable the user of the spread sheet to add a new row with specific formatting into which the user will input data and keep track of the number of rows added.</p>\n\n<p>My current code stands as is:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub NewLineRedButton_Click()\n\n    Dim i As Long\n    Dim y As Long\n\n    For y = ThisWorkbook.Worksheets(\"Flags\").Cells(16.3) To y + 1\n        ThisWorkbook.Worksheets(\"Flags\").Cells(16, 3) = y + 1\n        For i = 20 To i + y Step 1\n            ThisWorkbook.Worksheets(\"Flags\").Rows(i).RowHeight = 45\n            ThisWorkbook.Worksheets(\"Flags\").Cells(i, 1).Borders.LineStyle = xlContinuous\n            ThisWorkbook.Worksheets(\"Flags\").Cells(i, 1).Borders.Weight = xlMedium\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>At the moment the code executes only for two rows below and stops. I am not quite sure, why...?</p>\n"}, {"tags": ["sql-server", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421767672, "post_id": 28048957, "comment_id": 44480173, "body": "Welcome to Stack Overflow.  <code>CAST</code> is not a supported function in Access SQL."}, {"owner": {"reputation": 23, "user_id": 4474367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ddd4833bbb9fa507809cd236703e97?s=128&d=identicon&r=PG&f=1", "display_name": "RGiesler", "link": "https://stackoverflow.com/users/4474367/rgiesler"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421838669, "post_id": 28048957, "comment_id": 44511449, "body": "Thanks! That feels like something I really should have thought of a lot earlier, if there was a facepalm-smiley to add, I would most certainly use it now! Thanks again for your fast response!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4474367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ddd4833bbb9fa507809cd236703e97?s=128&d=identicon&r=PG&f=1", "display_name": "RGiesler", "link": "https://stackoverflow.com/users/4474367/rgiesler"}, "edited": false, "score": 0, "creation_date": 1421838833, "post_id": 28049222, "comment_id": 44511527, "body": "Thank you for your answer! After testing with both solutions from here, I went with editing my SQL-query in VBA, and it worked like a charm. The link you submitted has helped me out in some other aspects though, thank you!"}], "tags": [], "owner": {"reputation": 4956, "user_id": 1508467, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/462d1a0d5f9b49042e775c46e7ca5344?s=128&d=identicon&r=PG", "display_name": "Rhys Jones", "link": "https://stackoverflow.com/users/1508467/rhys-jones"}, "is_accepted": true, "score": 3, "last_activity_date": 1421767989, "last_edit_date": 1495542035, "creation_date": 1421767989, "answer_id": 28049222, "question_id": 28048957, "link": "https://stackoverflow.com/questions/28048957/ms-access-vba-runtime-error-3075-on-sql-query-with-subquery/28049222#28049222", "title": "MS Access VBA Runtime error 3075 on SQL Query with subquery", "body": "<p>That's a SQL Server dialect query, not MS Access. You need to perform the query on SQL Server, a pass-through query. See <a href=\"https://stackoverflow.com/questions/17241898/sql-server-passthrough-query-stored-into-an-access-vba-recordset\">SQL Server Passthrough query stored into an Access VBA recordset</a> for more info and a solution.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4474367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ddd4833bbb9fa507809cd236703e97?s=128&d=identicon&r=PG&f=1", "display_name": "RGiesler", "link": "https://stackoverflow.com/users/4474367/rgiesler"}, "is_accepted": false, "score": 2, "last_activity_date": 1421839139, "creation_date": 1421839139, "answer_id": 28065936, "question_id": 28048957, "link": "https://stackoverflow.com/questions/28048957/ms-access-vba-runtime-error-3075-on-sql-query-with-subquery/28065936#28065936", "title": "MS Access VBA Runtime error 3075 on SQL Query with subquery", "body": "<p>So, after following HansUp's answer, I edited my SQL-query and replaced CAST with Cdbl.</p>\n\n<p>Now it looks like this:</p>\n\n<pre><code>\"SELECT DealerCode, ((SELECT CDbl(COUNT(A2)) FROM dbo_Service WHERE A2 = 5 AND MarketCode = 'CA' AND DealerCode = '3140' AND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20') / COUNT(*)) * 100 AS TopBox FROM dbo_Service WHERE DealerCode = '3140' AND MarketCode = 'CA' AND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20' GROUP BY DealerCode;\"\n</code></pre>\n\n<p>When changing to Cdbl instead of CAST I also had to remove \"AS FLOAT\" after  the CAST.</p>\n\n<p>So in short, it looks like this:</p>\n\n<pre><code>SELECT CDbl(COUNT(A2))\n</code></pre>\n\n<p>Instead of this:</p>\n\n<pre><code>SELECT CAST(COUNT(A2) AS FLOAT)\n</code></pre>\n\n<p>A quick fix that does the job!</p>\n\n<p>Thanks for your answers!</p>\n"}], "owner": {"reputation": 23, "user_id": 4474367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ddd4833bbb9fa507809cd236703e97?s=128&d=identicon&r=PG&f=1", "display_name": "RGiesler", "link": "https://stackoverflow.com/users/4474367/rgiesler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 28049222, "answer_count": 2, "score": 0, "last_activity_date": 1526571355, "creation_date": 1421767212, "last_edit_date": 1526571355, "question_id": 28048957, "link": "https://stackoverflow.com/questions/28048957/ms-access-vba-runtime-error-3075-on-sql-query-with-subquery", "title": "MS Access VBA Runtime error 3075 on SQL Query with subquery", "body": "<p>I am encountering a problem in VBA, where the execution of an SQL-query generates Run-time Error 3075.</p>\n\n<p>Running the same query in Microsoft SQL Server Manager, I encounter no problems and the desired result is returned. </p>\n\n<p>I tried printing the sql-query with Debug.print (as suggested here: <a href=\"https://stackoverflow.com/a/3136299/4474367\">https://stackoverflow.com/a/3136299/4474367</a>) to see what the query looks like -  it looks ok and is working perfectly fine pasted into SQL Server Manager.</p>\n\n<p>What I'm doing is selecting total count of rows (survey responses) for a certain Dealer (and some other criteria), dividing the result with the total amount of rows where A2 = 5 (which is selected with a subquery) and then multiplying with 100 to get percentage of A2 = 5.</p>\n\n<p>What do you guys think is wrong? Are there any limitations in Access that I may not have taken consideration of? Only the sub-query is shown in the error-message.</p>\n\n<p>Here is my query (I cut it up a little with line breaks to make it easier for reading):</p>\n\n<pre><code>SELECT DealerCode, \n    (SELECT CAST(COUNT(A2) AS FLOAT) \n    FROM dbo_Service \n    WHERE A2 = 5 \n    AND MarketCode = 'CA' \n    AND DealerCode = '3140' \n    AND CompleteDate BETWEEN '2014-01-20' \n    AND '2015-01-20') / COUNT(*) * 100 AS TopBox \nFROM dbo_Service \nWHERE DealerCode = '3140' \nAND MarketCode = 'CA' \nAND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20' \nGROUP BY DealerCode;\n</code></pre>\n\n<p>Uncut version (exactly the same as above, but without line breaks):</p>\n\n<pre><code>SELECT DealerCode, (SELECT CAST(COUNT(A2) AS FLOAT) FROM dbo_Service WHERE A2 = 5 AND MarketCode = 'CA' AND DealerCode = '3140' AND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20') / COUNT(*) * 100 AS TopBox FROM dbo_Service WHERE DealerCode = '3140' AND MarketCode = 'CA' AND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20' GROUP BY DealerCode;\n</code></pre>\n\n<p>VBA Snippet, query procedure:</p>\n\n<pre><code>strSQL = \"SELECT DealerCode, (SELECT CAST(COUNT(A2) AS FLOAT) FROM dbo_Service WHERE A2 = 5 AND MarketCode = 'CA' AND DealerCode = '3140' AND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20') / COUNT(*) * 100 AS TopBox FROM dbo_Service WHERE DealerCode = '3140' AND MarketCode = 'CA' AND CompleteDate BETWEEN '2014-01-20' AND '2015-01-20' GROUP BY DealerCode;\"\nDebug.Print strSQL\nSet rs = db.OpenRecordset(strSQL)\ntopBox = rs!topBox\ndb.Close\n</code></pre>\n\n<p>Here is a link to an image of the error I receive</p>\n\n<p><img src=\"https://i.imgur.com/edGobkG.png\" alt=\"screenshot1\"></p>\n\n<p>Best Regards and thanks for reading!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1421780798, "post_id": 28050140, "comment_id": 44488320, "body": "Row numbers don&#39;t always fit into Integers anymore, use Long"}], "tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": false, "score": 0, "last_activity_date": 1449794831, "last_edit_date": 1449794831, "creation_date": 1421770575, "answer_id": 28050140, "question_id": 28048872, "link": "https://stackoverflow.com/questions/28048872/insert-rows-on-excel-based-on-value-in-other-column/28050140#28050140", "title": "insert rows on excel based on value in other column", "body": "<p>One for loop nested in a while loop should do your job. Why we are suing while instead of for because we can not dynamically change the limit of For loop when we add a new row in between existing data. So there you go:</p>\n\n<pre><code>Dim LastRow As Long\nDim RowAddNo As Long\nLastRow = Range(\"A1\").End(xlDown).Row\ni = 2\nWhile i &lt;= LastRow\n    RowAddNo = Range(\"B\" &amp; i).Value\n    For J = 1 To RowAddNo\n        Rows(i + 1 &amp; \":\" &amp; i + 1).Insert shift:=xlUp\n        LastRow = LastRow + 1\n        i = i + 1 'increasing the 'i' value to find the address for the next not empty row\n    Next\n    i = i + 1 'increasing the 'i' value to find the address for the next not empty row\nWend\n</code></pre>\n\n<p>PS: Do not try without i = i + 1. it goes in an endless loop :)</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1449795223, "creation_date": 1449795223, "answer_id": 34214478, "question_id": 28048872, "link": "https://stackoverflow.com/questions/28048872/insert-rows-on-excel-based-on-value-in-other-column/34214478#34214478", "title": "insert rows on excel based on value in other column", "body": "<p>This will do it for you:</p>\n\n<pre><code>Sub AddRows()\nDim X As Long\nFor X = Range(\"A\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1 'Work backwards when inserting or deleting rows, so much easier than incrementing numbers\n    Range(\"A\" &amp; X).Offset(1, 0).Resize(Range(\"B\" &amp; X).Value, 1).EntireRow.Insert 'Insert the number of rows against the target row offset by 1 ie below it\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4474392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bca1d14fa703c0ce581ffde9a327517?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Tunnicliffe", "link": "https://stackoverflow.com/users/4474392/paul-tunnicliffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1594643019, "creation_date": 1421766977, "last_edit_date": 1594643019, "question_id": 28048872, "link": "https://stackoverflow.com/questions/28048872/insert-rows-on-excel-based-on-value-in-other-column", "title": "insert rows on excel based on value in other column", "body": "<p>New to this so bear with me.</p>\n\n<p>I want to automatically insert a certain number or rows based on a value in another column. Can this be done?</p>\n\n<p>eg</p>\n\n<pre><code>Container Lifts\nB0237       1\nB0238       7\nB0239       7\nA8783       2\n</code></pre>\n\n<p>So the containers would be split by the number of lifts </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "wildcard"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421766754, "post_id": 28048671, "comment_id": 44479592, "body": "What error are you getting?  A debug error?  An invalid result?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421767238, "post_id": 28048671, "comment_id": 44479878, "body": "Is there any reason why you&#39;ve offset your wildcard with spaces? Should work if you do <code>Match(&quot;*&quot;&amp;C2&amp;&quot;*&quot;&amp;T2, ...</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421767323, "post_id": 28048671, "comment_id": 44479934, "body": "You&#39;re also mixing VBA functions with Worksheet functions, which probably would explain any errors you may be getting."}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421767435, "post_id": 28048671, "comment_id": 44480020, "body": "@Chrismas007 I am getting a <code>Expected: Expression</code> error when I run the code as shown above.  If I switch to the <code>Range(&quot;D2&quot;).Formula = &quot;=Index(&#39;Future_220_140_MON&#39;!$B$20:$AK$24, Match(&quot; * &quot;&amp;C2&amp;&quot; * &quot;&amp;T2, &#39;Future_220_140_MON&#39;!$B$1:$AK$1&amp;&#39;Future_220_140_MON&#39;!$A$20:$&zwnj;&#8203;A$24, 0))&quot;</code> then I get a type mismatch"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421767603, "post_id": 28048671, "comment_id": 44480134, "body": "@ksmit144 You were getting the expression error because of the <code>&quot;</code> at the end of the line which I see you have edited out now.  I have also edited that errant quote out of my solution."}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421767973, "post_id": 28048671, "comment_id": 44480381, "body": "Actually I removed the <code>&quot;</code> because I mistakenly placed that in my question without using it during my coding.  My code above still results in an <code>Expected: Expression</code>"}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1421768703, "post_id": 28048671, "comment_id": 44480881, "body": "Your <code>MATCH</code> function will always return #N/A error because the lookup array isn&#39;t a single row or column - you are concatenating a horizontal range (36 columns) with a vertical one (5 rows) which will give you a 36x5 matrix - if that&#39;s intentional then you will need to find a different way"}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 1, "creation_date": 1421769007, "post_id": 28048671, "comment_id": 44481113, "body": "I supect you need to use <b>two</b> MATCH functions like this: = <code>=Index(&#39;Future_220_140_MON&#39;!$B$20:$AK$24, Match(&quot;*&quot;&amp;C2&amp;&quot;*&quot;,&#39;Future_220_140_MON&#39;!$A$20:$A$24, 0),MATCH(&quot;*&quot;&amp;T2&amp;&quot;*&quot;,&#39;Future_220_140_MON&#39;!$B$1:$AK$1,0))</code> - one MATCH gives you the row, the next MATCH gives the column and then INDEX returns the value at the intersection"}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "reply_to_user": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1421769587, "post_id": 28048671, "comment_id": 44481543, "body": "@barry houdini Ah that makes sense.  I have used concatenation before to solve an <code>index(match())</code> function, but I guess the circumstances are slightly different.  Let me check if this solves my problem."}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 1, "creation_date": 1421769719, "post_id": 28048671, "comment_id": 44481652, "body": "Yes, you might use concatenation in some circumstances (e.g. 2 criteria in two different columns) but when you have to match a row and a column you need two MATCH functions, in the order shown"}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "reply_to_user": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1421770261, "post_id": 28048671, "comment_id": 44482084, "body": "@barryhoudini So <code>Range(&quot;D2&quot;) = Index(&#39;Future_220_140_MON&#39;!$B$20:$AK$24, Match(&quot; * &quot;&amp;C2&amp;&quot; * &quot;,&#39;Future_220_140_MON&#39;!$A$20:$A$24, 0),MATCH($T2,&#39;Future_220_140_MON&#39;!$B$1:$AK$1,0))</code> is still resulting in a syntax error.  Is that because I need to reformat the code as an <code>application.worksheetfunction</code>?"}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1421770562, "post_id": 28048671, "comment_id": 44482297, "body": "That&#39;s one for Rory!"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421767862, "post_id": 28048928, "comment_id": 44480307, "body": "I am not entirely sure why the code outputs a Syntax Error but both lines of code in my worksheet are faulty.  <code>MatchResult = Application.WorksheetFunction.Match(&quot;*&quot;&amp;C2&amp;&quot;*&quot;&amp;T2, &#39;Future_220_140_MON&#39;!$B$1:$AK$1&amp;&#39;Future_220_140_MON&#39;!$A$20:$&zwnj;&#8203;A$24, 0)</code> and <code>Range(&quot;D2&quot;).Value = Application.WorksheetFunction.Index(&#39;Future_220_140_MON&#39;!$B$&zwnj;&#8203;20:$AK$24, MatchResult)</code> result in errors."}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421768314, "post_id": 28048928, "comment_id": 44480589, "body": "The error results from <code>&quot;*&quot;&amp;C2&amp;&quot;*&quot;</code>.  It highlights that portion and states <code>Expected: List separator or )</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1421768453, "post_id": 28048928, "comment_id": 44480703, "body": "You can&#39;t use strings instead of ranges for <code>AWF.Index</code> or <code>AWF.Match</code> and you can&#39;t concatenate ranges like that either. You&#39;d need <code>Evaluate</code> with a formula string. However that original formula looks wrong to me anyway."}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421768766, "post_id": 28048928, "comment_id": 44480936, "body": "@Rory So concatenating the search criteria when using a wildcard is an understandable error, but is there a way to search for multiple criterion in another way?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 1, "creation_date": 1421768875, "post_id": 28048928, "comment_id": 44481015, "body": "@ksmit144 What does your data look like? It appears to me at first glance as though you actually need an <code>INDEX(...,match(), match())</code> syntax - i.e. looking one value up in the first column and one in the top row to return a cell from a table."}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1421769186, "post_id": 28048928, "comment_id": 44481247, "body": "See my comment on your question - you can only use MATCH with a single row or column, so it&#39;s the way you are using MATCH that is the problem, not an issue with any VBA issue - you need two MATCH functions, see above - Hey rory! Snap!"}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421769237, "post_id": 28048928, "comment_id": 44481276, "body": "@Rory Basically, I am trying to match <code>T2</code> to the correct value in Column <code>$A$20:$A$24</code> to get a row value, while matching <code>C2</code> to a similar value in Row <code>$B$1:$AK$1</code> to get a column value.  Then the index gives me the value from the Range <code>$B$20:$AK$24</code> to place in <code>D2</code>"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 1, "last_activity_date": 1421774634, "last_edit_date": 1421774634, "creation_date": 1421767155, "answer_id": 28048928, "question_id": 28048671, "link": "https://stackoverflow.com/questions/28048671/using-wildcards-in-indexmatch-function/28048928#28048928", "title": "Using Wildcards in Index(Match) function", "body": "<p>First, you should always define what you want your result to be stored as.  By default, just writing <code>Range(\"D2\")</code> will use the <code>.Value</code> property of the cell, but it is better to write <code>Range(\"D2\").Value</code>.  Also both of your functions are actually <code>Application.WorksheetFunction</code>s.  Try this code:</p>\n\n<pre><code>Dim MatchResult As Double\nMatchResult = Application.WorksheetFunction.Match(Conditions)\nRange(\"D2\").Value = Application.WorksheetFunction.Index(Conditions, MatchResult)\n</code></pre>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff197581%28v=office.15%29.aspx\" rel=\"nofollow\"><code>WorksheetFunction.Index</code> Method MSDN</a></p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff835873%28v=office.15%29.aspx\" rel=\"nofollow\"><code>WorksheetFunction.Match</code> Method MSDN</a></p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421771098, "post_id": 28049993, "comment_id": 44482679, "body": "The value in <code>C2</code> that I am trying to match to <code>B1:AK1</code> does not want to acknowledge the similarities.  The value of <code>C2</code> has a number before it, such as <code>1_Unpack</code> and I am trying to match that to the value in <code>B1:AK1</code> that says <code>Unpack</code>.  Because it does not see the match, the cell in <code>D1</code> reads <code>#N&#47;A</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421771237, "post_id": 28049993, "comment_id": 44482767, "body": "You can&#39;t add wildcards to C2 for that. Is it always a number followed by underscore?"}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421771323, "post_id": 28049993, "comment_id": 44482818, "body": "Yes, it is always a number from 1-35 followed by an underscore."}, {"owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "edited": false, "score": 0, "creation_date": 1421772364, "post_id": 28049993, "comment_id": 44483480, "body": "The equation works great thanks! However, I tried to implement it with an <code>autofill</code> from <code>D2</code> to <code>D3150</code> and it doesn&#39;t seem to want to move <code>C2</code> to <code>C3</code> or <code>T2</code> to <code>T3</code> etc."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1421772871, "last_edit_date": 1421772871, "creation_date": 1421770189, "answer_id": 28049993, "question_id": 28048671, "link": "https://stackoverflow.com/questions/28048671/using-wildcards-in-indexmatch-function/28049993#28049993", "title": "Using Wildcards in Index(Match) function", "body": "<p>Try this:</p>\n\n<pre><code>    Range(\"D2\").Value = Application.Index(Sheets(\"Future_220_140_MON\").Range(\"B20:AK24\"), _\nApplication.Match(Range(\"T2\").Value, Sheets(\"Future_220_140_MON\").Range(\"A20:A24\"),0), _\nApplication.Match(\"*\" &amp; Range(\"C2\").Value &amp; \"*\", Sheets(\"Future_220_140_MON\").Range(\"B1:AK1\"),0))\n</code></pre>\n\n<p>Based on clarification, the code would need to be like this:</p>\n\n<pre><code>    Range(\"D2\").Value = Application.Index(Sheets(\"Future_220_140_MON\").Range(\"B20:AK24\"), _\nApplication.Match(Range(\"T2\").Value, Sheets(\"Future_220_140_MON\").Range(\"A20:A24\"),0), _\nApplication.Match(Mid$(Range(\"C2\").Value, Instr(Range(\"C2\").Value, \"_\") + 1), Sheets(\"Future_220_140_MON\").Range(\"B1:AK1\"),0))\n</code></pre>\n\n<p>Further edit: if you want to actually put a formula in place:</p>\n\n<pre><code>Range(\"D2\").Formula = \"=Index('Future_220_140_MON'!$B$20:$AK$24,Match(T2,'Future_220_140_MON'!$A$20:$A$24,0),Match(MID(C2,FIND(\"\"_\"\",C2)+1,LEN(C2)),'Future_220_140_MON'!$B$1:$AK$1,0))\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4055588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c68dcd351191904bd4a9bacbdf42327?s=128&d=identicon&r=PG&f=1", "display_name": "ksmit144", "link": "https://stackoverflow.com/users/4055588/ksmit144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4022, "favorite_count": 0, "accepted_answer_id": 28049993, "answer_count": 2, "score": 2, "last_activity_date": 1421774634, "creation_date": 1421766398, "last_edit_date": 1421772333, "question_id": 28048671, "link": "https://stackoverflow.com/questions/28048671/using-wildcards-in-indexmatch-function", "title": "Using Wildcards in Index(Match) function", "body": "<p>I am using an <code>Index(Match())</code> function in my vba code that seems to be experiencing some issues.  Because some of the searched criterion aren't exactly alike, I am trying to use a <code>\"*\"</code> wildcard operator around cell <code>C2</code> to search for like items.  Also, I do not want to simply place the formula I am using into cells with a <code>Range(\"D2\").Formula</code> code that will cause auto-updating, therefore, I am experiencing issues around this as well.  </p>\n\n<p>Here is my code.</p>\n\n<p><code>Range(\"D2\") = Index('Future_220_140_MON'!$B$20:$AK$24, Match(\" * \"&amp;C2&amp;\" * \"&amp;T2, 'Future_220_140_MON'!$B$1:$AK$1&amp;'Future_220_140_MON'!$A$20:$A$24, 0))</code></p>\n\n<p>Am I simply misformatting the code, or is there a particular way to call out wildcards when matching multiple criterion.</p>\n"}, {"tags": ["vba", "excel", "activex", "excel-2013"], "comments": [{"owner": {"reputation": 1874, "user_id": 3761815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Zrlop.png?s=128&g=1", "display_name": "Rusan Kax", "link": "https://stackoverflow.com/users/3761815/rusan-kax"}, "edited": false, "score": 0, "creation_date": 1421768127, "post_id": 28048549, "comment_id": 44480475, "body": "I see &quot;Symptoms&quot; and &quot;Environment&quot; but no &quot;Question&quot;. Maybe edit your post to include the question clearly: at the top/bottom, or somewhere?"}, {"owner": {"reputation": 164, "user_id": 1216449, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vscMm.png?s=128&g=1", "display_name": "JLee", "link": "https://stackoverflow.com/users/1216449/jlee"}, "reply_to_user": {"reputation": 1874, "user_id": 3761815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Zrlop.png?s=128&g=1", "display_name": "Rusan Kax", "link": "https://stackoverflow.com/users/3761815/rusan-kax"}, "edited": false, "score": 0, "creation_date": 1422462342, "post_id": 28048549, "comment_id": 44763242, "body": "@Rusan Kax The question is kind of obvious. It is: What is the solution to this problem? I have had the exact same problem since mid December and it&#39;s very annoying. I have not found an answer, and the fact that this page has nothing makes me wonder if there is a way to fix this. Is there a setting in Excel that tells it to treat files created on other machines the same as files created on itself?"}, {"owner": {"reputation": 1874, "user_id": 3761815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Zrlop.png?s=128&g=1", "display_name": "Rusan Kax", "link": "https://stackoverflow.com/users/3761815/rusan-kax"}, "reply_to_user": {"reputation": 164, "user_id": 1216449, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vscMm.png?s=128&g=1", "display_name": "JLee", "link": "https://stackoverflow.com/users/1216449/jlee"}, "edited": false, "score": 0, "creation_date": 1422466344, "post_id": 28048549, "comment_id": 44763668, "body": "@JLee Sure. But obvious is not the same as &quot;exactly stated&quot;. If the OP is going to ask other people for help, it helps to state the problem. Its all documented <a href=\"http://stackoverflow.com/help/how-to-ask\">here</a>. And no, there is no such setting for Excel. The <i>real</i> solution is to never use ActiveX...especially if you develop for others and distribute code. Its a pile of &quot;nonsense&quot; see <a href=\"http://stackoverflow.com/questions/15455179/what-is-the-difference-between-form-controls-and-activex-control-in-excel-20\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4502342, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7af35c8c9a2d0a8b921ac2442f44d47f?s=128&d=identicon&r=PG", "display_name": "Kartik", "link": "https://stackoverflow.com/users/4502342/kartik"}, "is_accepted": false, "score": 1, "last_activity_date": 1422438919, "creation_date": 1422438919, "answer_id": 28189208, "question_id": 28048549, "link": "https://stackoverflow.com/questions/28048549/activex-button-renaming/28189208#28189208", "title": "ActiveX Button Renaming", "body": "<p>Ask user to copy the sheet containing the code into another workbook, rename the sheet in the original workbook &amp; copy the sheet back into the original workbook... its a temporary workaround...</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 4474465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dJAjXPBaABY/AAAAAAAAAAI/AAAAAAAAApc/1dXrLCxJwRo/photo.jpg?sz=128", "display_name": "Matthew Stockton", "link": "https://stackoverflow.com/users/4474465/matthew-stockton"}, "is_accepted": false, "score": 2, "last_activity_date": 1422540786, "creation_date": 1422540786, "answer_id": 28216806, "question_id": 28048549, "link": "https://stackoverflow.com/questions/28048549/activex-button-renaming/28216806#28216806", "title": "ActiveX Button Renaming", "body": "<p><strong><em>Update</em></strong>:</p>\n\n<p><strong>First</strong>: Let me formally state the question(s): How do is stop MS Excel from renaming the ActiveX button name?  Additionally, is there something that needs to be addressed within our office?</p>\n\n<p><strong>Second</strong>: My company has a support agreement with Microsoft.  Finally wound through our internal IT process to get that help.</p>\n\n<p>According to Microsoft, the problem does stem from the December 2014 ActiveX update.  The date of that update was 12/9/2014.  The associated KBs are KB2553154 for office 2010 and KB2726958 for office 2013.  If all the machines that are sharing documents that contain ActiveX controls are not in the same state regarding the KB updates mentioned above, then this problem will occur.  So if you have it and they don't there is a problem.  If they have it and you don't there is a problem.  We have tested this on a handful of machines and getting everyone in sync regarding the KB seems to resolve it.</p>\n\n<p>Why it didn't \"resolve\" when I got the updates in January.  Evidently I did NOT get all the updates in January.  Our IT department pushes updates via Symantec Management Agent, there is a breakdown in that process that they are now investigating.</p>\n\n<p><strong>Third</strong>: To person that stating I didn't properly ask a question.  While I technically have no qualms with your observation, I agree with JLee \"If a person reads this problem description and doesn't know the question, that person's comments are not needed anyway\".  I additionally find it interesting that someone who is that obsessive about posting etiquette would use undefined acronyms such as \"OP\" - which I had to look up since I do not use forum's extensively.</p>\n"}], "owner": {"reputation": 59, "user_id": 4474465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dJAjXPBaABY/AAAAAAAAAAI/AAAAAAAAApc/1dXrLCxJwRo/photo.jpg?sz=128", "display_name": "Matthew Stockton", "link": "https://stackoverflow.com/users/4474465/matthew-stockton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1517, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423856537, "creation_date": 1421766104, "last_edit_date": 1531164843, "question_id": 28048549, "link": "https://stackoverflow.com/questions/28048549/activex-button-renaming", "title": "ActiveX Button Renaming", "body": "<p>First, I am aware of the nearly ubiquitous issue with ActiveX controls and the Dec 2014 MS Excel update.  This appears to be different than the common symptoms, but it may be related.  </p>\n\n<p><strong>Symptoms:</strong></p>\n\n<ol>\n<li><p>Open an existing excel sheet that contains an ActiveX control.</p></li>\n<li><p>Click the button and nothing happens (macro does not launch)</p></li>\n<li><p>Investigation shows that the button name has changed from \"BtnMacroLaunch\" to \"CommandButton3\"</p></li>\n<li><p>I open the file on other users machines and the button has NOT been renamed and it works correctly.</p></li>\n</ol>\n\n<p><strong>Environment:</strong></p>\n\n<ul>\n<li><p>The sheets that have this were last saved on another users machines, not mine.  When I save a new spreadsheet with an ActiveX, this does not happen.</p></li>\n<li><p>If another users opens and executes a sheet I created, then saves that sheet, when I open it again, the button is renamed</p></li>\n<li><p>This has been a problem since mid Dec 2014 (approx). - which is why I think it is related to the common ActiveX issue.</p></li>\n<li><p>The majority of my office coworkers (I think everyone but me) had the Dec Update done in Dec.  My updates were turned off inadvertently by our IT department.  All my coworkers also did the delete \"<em>forms</em>.exd\" workaround.</p></li>\n<li><p>I suspected that since my machine had not gotten the updates, that was the cause of the issue.  However, yesterday (Jan 19) I finally got my machine fixed and all the updates applied.  I then did the the delete \"<em>forms</em>.exd\" workaround.  Unfortunately, the buttons are still renaming.</p></li>\n<li><p>This does not appear to be exactly the same as the other button rename problem.  This is not appending a number to the back of a name, but resetting the name compeletly.</p></li>\n</ul>\n\n<p>**</p>\n\n<ul>\n<li>The Question:</li>\n</ul>\n\n<p>** </p>\n\n<p>How do is stop MS Excel from renaming the ActiveX button name? Additionally, is there something that needs to be addressed within our office?</p>\n"}, {"tags": ["vba", "excel", "filtering", "dynamic-typing"], "comments": [{"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1421764312, "post_id": 28047677, "comment_id": 44477856, "body": "I don&#39;t think this is possible. With the cells, you aren&#39;t actually making any changes to the cell UNTIL you hit enter. With the textbox, though, every keystroke is a change."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1421764314, "post_id": 28047677, "comment_id": 44477858, "body": "You can trigger an action via change events. You have change events for left clicking, right clicking and some other stuff I guess. Gotta admit I&#39;m slightly pessimistic towards your objective. If VBA is used to compare the cell and certain critera, I think it can be only done after pressing Enter. But I&#39;m not sure about that"}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1421764483, "post_id": 28047677, "comment_id": 44477967, "body": "Just thought of something. You could link a cell to a textbox, then use VBA to hide/show the textbox on a selection change event. you could place the textbox right over the cell so that it looks like you&#39;re typing in the cell...."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421765411, "post_id": 28047677, "comment_id": 44478654, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/26848266/excel-vba-start-macro-when-editing\">Excel VBA: start macro when editing</a>"}, {"owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "edited": false, "score": 1, "creation_date": 1488218922, "post_id": 28047677, "comment_id": 72124821, "body": "As of this demo at 03:40, it is possible <a href=\"https://youtu.be/mAXiZbhEfr4\" rel=\"nofollow noreferrer\">youtu.be/mAXiZbhEfr4</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 2, "last_activity_date": 1421765400, "last_edit_date": 1495540411, "creation_date": 1421765400, "answer_id": 28048281, "question_id": 28047677, "link": "https://stackoverflow.com/questions/28047677/filter-while-typing-in-a-cell/28048281#28048281", "title": "Filter while typing in a cell", "body": "<p>@PermaNoob has the best solution.  Excel does not allow you to check the value of a cell with VBA when you are in \"edit\" mode.  You could however, put a text box over <code>A1</code> and use that to run your \"dynamic\" search.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26848266/excel-vba-start-macro-when-editing\">Start VBA macro when editing a cell</a></p>\n\n<pre><code>Private Sub TextBox1_Change()\n Dim searchArea As Range, searchRow As Range, searchCell As Range\n Dim searchString As String\n Dim lastRow As Integer\n\n Application.ScreenUpdating = False\n searchString = \"*\" &amp; LCase(TextBox1.Value) &amp; \"*\"\n\n ' unhide rows to have the full search field when editing\n Rows.Hidden = False\n\n lastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n Set searchArea = Me.Range(\"A5\", \"A\" &amp; lastRow) 'Me.Range(\"A5\").End(xlDown))\n searchArea.EntireRow.Hidden = True\n\n For Each searchRow In searchArea.Rows\n   For Each searchCell In searchRow.Cells\n     If LCase(searchCell) Like searchString Then\n       searchRow.Hidden = False\n       Exit For\n     End If\n   Next searchCell\n Next searchRow\n\n Application.Goto Cells(1), True\n Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10391292, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9KptYzk0Izo/AAAAAAAAAAI/AAAAAAAAACI/JNyINdlQXZo/photo.jpg?sz=128", "display_name": "Chris Constantinou", "link": "https://stackoverflow.com/users/10391292/chris-constantinou"}, "is_accepted": false, "score": 1, "last_activity_date": 1537451902, "last_edit_date": 1537451902, "creation_date": 1537446530, "answer_id": 52425212, "question_id": 28047677, "link": "https://stackoverflow.com/questions/28047677/filter-while-typing-in-a-cell/52425212#52425212", "title": "Filter while typing in a cell", "body": "<p>I've tried the above solution and it works fine but extremely slow.</p>\n\n<p>In column with 950 rows it took 13 secs to do the first letter filter.  Speed improves from 2nd letter on but for me the initial wait was unacceptable.</p>\n\n<p>I ended up doing the following:</p>\n\n<ol>\n<li><p>Created a new column (C) to filter my data in column A based on the value of cell I1\nEnter this in cell <code>C2: =IF(ISERR(FIND(LOWER(I$1);LOWER(A2);1));\" \";\"F\")</code></p></li>\n<li><p>Created the TextBox and linked it with cell I1</p></li>\n<li><p>Added the following code in VBA:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    Call Worksheet_SelectionChange(Range(\"I1\"))\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)    \n  If Not Application.Intersect(Target, Range(\"I1\")) Is Nothing Then    \n     Range(Range(\"C2\"), Range(\"C2\").End(xlDown)).AutoFilter Field:=1, Criteria1:=\"F\"    \n  End If    \nEnd Sub\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "is_accepted": true, "score": 0, "last_activity_date": 1537519448, "last_edit_date": 1537519448, "creation_date": 1537450394, "answer_id": 52426364, "question_id": 28047677, "link": "https://stackoverflow.com/questions/28047677/filter-while-typing-in-a-cell/52426364#52426364", "title": "Filter while typing in a cell", "body": "<p>I ended up using the solution based on pivot tables. It filters hundreds of items on the file, narrowing results after typing each letter. What is more, it allows to select multiple items. </p>\n\n<p>I put the item list to page filter of the pivot table. You can hide the entire rows below the page filter for aesthetics so it does not even look like a pivot table, but just a cell for type/drop-down selection of the value. </p>\n\n<p><a href=\"https://i.stack.imgur.com/MPGeE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MPGeE.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5020, "favorite_count": 0, "accepted_answer_id": 52426364, "answer_count": 3, "score": 0, "last_activity_date": 1537519448, "creation_date": 1421763778, "last_edit_date": 1537518965, "question_id": 28047677, "link": "https://stackoverflow.com/questions/28047677/filter-while-typing-in-a-cell", "title": "Filter while typing in a cell", "body": "<p>Would that be possible to dynamically filter rows based on a value that I type in a cell? Suppose I have a column-range with data <code>A10:A1000</code> and I filter that range on criteria I am typing in <code>A1</code> cell. </p>\n\n<p>I want the filter to react dynamically, in a run time, as I am typing, not after I hit [Enter]. I found a solution for that with a text box. \n<a href=\"http://www.vbforums.com/showthread.php?647621-Excel-filtering-while-typing\" rel=\"nofollow\">http://www.vbforums.com/showthread.php?647621-Excel-filtering-while-typing</a> </p>\n\n<p>However, preferably, I would like to do typing in a cell not in some text box. Is it possible?</p>\n"}]