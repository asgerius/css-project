[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10034261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8_pY-x315ow/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HBoNe00cEySNr9jc0-oWkrP33sQ/mo/photo.jpg?sz=128", "display_name": "Felipe Munoz", "link": "https://stackoverflow.com/users/10034261/felipe-munoz"}, "edited": false, "score": 0, "creation_date": 1530756594, "post_id": 51181898, "comment_id": 89347249, "body": "Hello udearboy! Thank you so much for taking the time in helping me with my problem. I executed your code and received a &quot;Compile error: Variable not defined&quot; error message with cell highlighted in the 1st cell.EntireRow.Copy Hard.Range(......"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1530757325, "post_id": 51181898, "comment_id": 89347356, "body": "try defining <code>cell</code> as range."}, {"owner": {"reputation": 1, "user_id": 10034261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8_pY-x315ow/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HBoNe00cEySNr9jc0-oWkrP33sQ/mo/photo.jpg?sz=128", "display_name": "Felipe Munoz", "link": "https://stackoverflow.com/users/10034261/felipe-munoz"}, "edited": false, "score": 0, "creation_date": 1530757559, "post_id": 51181898, "comment_id": 89347402, "body": "good evening excelguy! thanks for your respose. I defined cell as range and now I get &quot;Run-time error 91&quot; Object or With block variable not set&quot; with the following hightlighted &#39;cell.EntireRow.Copy Easy.Range(&quot;A&quot; &amp; Easy.Range(&quot;A&quot; &amp; Easy.Rows.Count).End(xlUp).Offset(1).Row)&#39;"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530796144, "post_id": 51181898, "comment_id": 89365895, "body": "Updated. The search range was only defined to one cell. Changed <code>For Each MyCell in Master.Range(&quot;K2:K&quot; &amp; .....)</code> Sorry about that"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530796121, "last_edit_date": 1530796121, "creation_date": 1530748875, "answer_id": 51181898, "question_id": 51181655, "link": "https://stackoverflow.com/questions/51181655/excel-vba-copy-and-paste-to-multiple-sheets-based-on-conditions/51181898#51181898", "title": "Excel VBA Copy and Paste to Multiple Sheets Based on Conditions", "body": "<p>You can easily do this using advance filters. Or you can write a macro to filter for each criteria, and copy/paste accordingly. </p>\n\n<p>Or you can use this less efficient code. </p>\n\n<p>Assumptions: </p>\n\n<ol>\n<li>You already have 3 sheets named \"Master\", \"Hard\", \"Easy\" on your workbook</li>\n<li>Each sheet has headers</li>\n<li>All headers are identical</li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub MoveData()\n\nDim Master As Worksheet: Set Master = ThisWorkbook.Sheets(\"Master\")\nDim Hard As Worksheet: Set Hard = ThisWorkbook.Sheets(\"Hard\")\nDim Easy As Worksheet: Set Easy = ThisWorkbook.Sheets(\"Easy\")\n\nDim String1, String2, String3, String4, String5, String6 As String\nString1 = \"DEL-LPT-PRECISN\"\nString2 = \"DEL-LPT-XPS\"\nString3 = \"DEL-LT-ALIENWARE\"\nString4 = \"DEL-PC-AIO-OPTI\"\nString5 = \"DEL-PC-AIO-XPS\"\nString6 = \"DEL-PC-PRECISION\"\n\nDim MyCell As Range\n\nApplication.ScreenUpdating = False\n    For Each MyCell In Master.Range(\"K2:K\" &amp; Master.Range(\"K\" &amp; Master.Rows.Count).End(xlUp).Row)\n        If MyCell.Text = String1 Or MyCell.Text = String2 Or MyCell.Text = String3 Or MyCell.Text = String4 Or MyCell.Text = String5 Or MyCell.Text = String6 Then\n            Cell.EntireRow.Copy Hard.Range(\"A\" &amp; Hard.Range(\"A\" &amp; Hard.Rows.Count).End(xlUp).Offset(1).Row)\n        Else\n            Cell.EntireRow.Copy Easy.Range(\"A\" &amp; Easy.Range(\"A\" &amp; Easy.Rows.Count).End(xlUp).Offset(1).Row)\n        End If\n    Next MyCell\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10034261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8_pY-x315ow/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HBoNe00cEySNr9jc0-oWkrP33sQ/mo/photo.jpg?sz=128", "display_name": "Felipe Munoz", "link": "https://stackoverflow.com/users/10034261/felipe-munoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1530796121, "creation_date": 1530745854, "last_edit_date": 1531161705, "question_id": 51181655, "link": "https://stackoverflow.com/questions/51181655/excel-vba-copy-and-paste-to-multiple-sheets-based-on-conditions", "title": "Excel VBA Copy and Paste to Multiple Sheets Based on Conditions", "body": "<p>I need Excel VBA code that will help me automate the following:</p>\n\n<p>I need to be able to copy and paste rows from a \"master\" worksheet to multiple newly created worksheets based on the data found in Column \"K\" with a header called \"Skill\". If Column K has any of the following \"DEL-LPT-PRECISN\", \"DEL-LPT-XPS\", \"DEL-LT-ALIENWARE\", \"DEL-PC-AIO-OPTI\", \"DEL-PC-AIO-XPS\", \"DEL-PC-PRECISION\" copy the entire row to newly created worksheet \"Hard\" If column \"K\" has anything else move it to newly created workshieet \"Easy\"</p>\n\n<p>The column headers should be the same from the master to the 2 newly created wks \"easy\" and \"hard\"</p>\n\n<p>The master worksheet changes daily and can have anywhere from 200 to 500 rows of data.</p>\n\n<p>Thanks in advance for the help!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1530739964, "post_id": 51180931, "comment_id": 89344383, "body": "If this is your actual path, have you tried <code>D:\\test.doc</code>?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 2, "creation_date": 1530766134, "post_id": 51180931, "comment_id": 89348916, "body": "Probably <code>D:\\test.docx</code> :-)"}], "answers": [{"tags": [], "owner": {"reputation": 3578, "user_id": 2780480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oBkUP.jpg?s=128&g=1", "display_name": "Jagrut Sharma", "link": "https://stackoverflow.com/users/2780480/jagrut-sharma"}, "is_accepted": false, "score": 1, "last_activity_date": 1530740995, "last_edit_date": 1530740995, "creation_date": 1530740084, "answer_id": 51180983, "question_id": 51180931, "link": "https://stackoverflow.com/questions/51180931/word-vba-documents-open-filename-not-working/51180983#51180983", "title": "Word VBA - Documents.Open FileName not working", "body": "<p>You just need to specify the full file name with extension.</p>\n\n<pre><code>Sub clearup()\n\nDocuments.Open FileName:=\"D:\\test.doc\"\n\nEnd Sub\n</code></pre>\n\n<p>You may have to grant permissions, but then it should open.</p>\n\n<p><strong>Updated</strong>:</p>\n\n<p>To help in debugging the issue, you can take a look at the additional parameters the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/documents-open-method-word\" rel=\"nofollow noreferrer\">Documents.Open</a> method accepts. </p>\n\n<p>For example, to use the <code>OpenAndRepair</code> parameter:</p>\n\n<pre><code>Documents.Open FileName:=\"D:\\test.doc\", OpenAndRepair:=True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 5509505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3030287183e4b3b8b2519e43b9478cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Noir", "link": "https://stackoverflow.com/users/5509505/noir"}, "is_accepted": true, "score": 0, "last_activity_date": 1530797193, "creation_date": 1530797193, "answer_id": 51192544, "question_id": 51180931, "link": "https://stackoverflow.com/questions/51180931/word-vba-documents-open-filename-not-working/51192544#51192544", "title": "Word VBA - Documents.Open FileName not working", "body": "<p>I have figured out the problem, the first part of the issue was that I didn't use .docx ending (I didn't notice as the doc had no ending after its name), very much in line with the suggestion of AJD and what also threw me off track, was that the document has opened but I did not notice, so I started receiving an invalid name error, not knowing why.</p>\n\n<p>Thanks for your suggestions. </p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 10173250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f697f9643d97eab346dea265c632f8?s=128&d=identicon&r=PG&f=1", "display_name": "Fr4nc01s", "link": "https://stackoverflow.com/users/10173250/fr4nc01s"}, "is_accepted": false, "score": 0, "last_activity_date": 1533243636, "creation_date": 1533243636, "answer_id": 51662092, "question_id": 51180931, "link": "https://stackoverflow.com/questions/51180931/word-vba-documents-open-filename-not-working/51662092#51662092", "title": "Word VBA - Documents.Open FileName not working", "body": "<p>This discussion is for those writing macros using VBA with Word, Excel, etc and have faced this error when executing your macro:</p>\n\n<p>Documents.Open (..)</p>\n\n<p>error  5174 Sorry, we couldn't find your file. Was it moved, renamed, or deleted?\n (\"drive letter:...\\filename...\")</p>\n\n<p>I have seen a lot of posts around this error. There are 2 main scenarios, and the easiest one is the only one that is getting discussed.</p>\n\n<p>Scenario 1</p>\n\n<p>You are trying to open a \"path\\file\" name that has actually moved between the time your program started and came up with the \"path\\file\" name value, and the time it actually tried to open the file. That is easy to fix.</p>\n\n<p>Scenario 2</p>\n\n<p>THE MOST IMPORTANT ONE AND MOST DIFFICULT TO DETECT</p>\n\n<p>The value you are using to designate the \"path\\file\" name to open using your macro code such as:</p>\n\n<pre><code>        Documents.Open (....\n</code></pre>\n\n<p>...said value contains non printable characters (I am not talking about non alphanum like \".\" or \"&amp;, or characters not allowed, I am talking about ASCII 13 most likely being the last character at the end of the value for your filename. But when you use Debug.Print, that character is not printed.</p>\n\n<p>Steps To Confirm:</p>\n\n<p>When you are in debug mode, Debug.Print \"the value of the path\\file you are trying to open\".</p>\n\n<p>This will print as expect with no visible issues, you can then confirm the file exists by copy pasting the printed value in windows explorer and the file should open automatically. If it does open manually, then you are likely dealing with scenario #2</p>\n\n<p>THEREFORE</p>\n\n<p>while in debug mode, using the variable that contains the path\\file vallue, write a FOR statement to iterate through each character of the string using Debug.Print Asc(&lt;>), where &lt;> is the variable in the FOR iteration that gets assigned 1 character from the path\\file string at a time. Most likely you will see the last character will print as 13</p>\n\n<p>The VBA function</p>\n\n<pre><code>        Trim(....\n</code></pre>\n\n<p>does not take care of this problem. you need to use the </p>\n\n<pre><code>         Replace (...\n</code></pre>\n\n<p>function with \"Chr(13)\" as the value sought to be replaced with vbNullString</p>\n\n<p>There are some hacks that consist in adding ASCII char 13 (carriage return, without a line fee) to file names and then appending the name, etc</p>\n\n<p>There are utilities that clean those issues up, maybe not completely?... this might be the cause.</p>\n\n<p>Another possible cause in my radar is the DOS prompt adding an extra char 13 when redirecting the output of a DIR command using \">>\"  into a file to create a list of files from the DIR command. It does not happen for all files in the results of the DIR command, it could be for files having special characters that are allowed. I do not have the time to investigate that further.</p>\n"}], "owner": {"reputation": 161, "user_id": 5509505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3030287183e4b3b8b2519e43b9478cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Noir", "link": "https://stackoverflow.com/users/5509505/noir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3663, "favorite_count": 0, "accepted_answer_id": 51192544, "answer_count": 3, "score": 0, "last_activity_date": 1533243636, "creation_date": 1530739653, "last_edit_date": 1530801379, "question_id": 51180931, "link": "https://stackoverflow.com/questions/51180931/word-vba-documents-open-filename-not-working", "title": "Word VBA - Documents.Open FileName not working", "body": "<p>I have this code (this code is a part of a larger stack, but this is clearly what is not working.</p>\n\n<pre><code>Sub clearup()\n\nDocuments.Open FileName:=\"D:\\test\"\n\nEnd Sub\n</code></pre>\n\n<p>test is a <code>.doc</code> file. I know <code>test.doc</code> is there as I created it, to be where it is. But if I run the macro I get \"Sorry, we couldn't find your file. Was it moved, renamed, or deleted?\". I also tried to change the name to <code>test.doc</code> to no avail. Any idea what I am doing wrong?</p>\n"}, {"tags": ["vba", "move"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530736889, "post_id": 51180500, "comment_id": 89343457, "body": "<b>TLDR</b> <b>TLDR</b>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530737563, "post_id": 51180500, "comment_id": 89343647, "body": "You have wayyyy to much info here. Also, you are telling us that cell <code>K1</code> is in row 1 which is completely not necessary. Please <a href=\"https://stackoverflow.com/posts/51180500/edit\">edit</a> your question down. Explain 1 specific problem, what you have tried, and state a actual question. Not that &quot;Can you help me&quot; is not a question :) <i>Good luck</i>"}, {"owner": {"reputation": 1, "user_id": 9951451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3c766f7c8495cfc12a62f291a1c68be?s=128&d=identicon&r=PG&f=1", "display_name": "RUSS ANDERSON", "link": "https://stackoverflow.com/users/9951451/russ-anderson"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1530738548, "post_id": 51180500, "comment_id": 89343957, "body": "I have have fixed my request, thanks Russ"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9951451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3c766f7c8495cfc12a62f291a1c68be?s=128&d=identicon&r=PG&f=1", "display_name": "RUSS ANDERSON", "link": "https://stackoverflow.com/users/9951451/russ-anderson"}, "edited": false, "score": 0, "creation_date": 1530807486, "post_id": 51182210, "comment_id": 89373477, "body": "Thank-you dcromley I will definitely try it out."}, {"owner": {"reputation": 1, "user_id": 9951451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3c766f7c8495cfc12a62f291a1c68be?s=128&d=identicon&r=PG&f=1", "display_name": "RUSS ANDERSON", "link": "https://stackoverflow.com/users/9951451/russ-anderson"}, "edited": false, "score": 0, "creation_date": 1530903442, "post_id": 51182210, "comment_id": 89413640, "body": "Hi, I tried your code but I can&#39;t get it to work so I have posted the program to see if can spot the issue.                   Sub do_it()      Dim n, sht As Worksheet, cell As Range, num, tmp, rngDest As Range      Set sht = ActiveSheet      n = sht.Range(&quot;A1&quot;)      For Each cell In sht.Range(&quot;D1:D12,A16:A30,D16:D30,G16:G30,J16:J30,M16:M30&quot;).&zwnj;&#8203;Cells          tmp = cell.Offset(0, 1).Value          If cell.Value = n And tmp Like &quot;<i>#-#</i>&quot; Then              &#39;get the first number             num = CLng(Trim(Split(tmp, &quot;-&quot;)(0)))             Debug.Print &quot;Found a positive result in"}], "tags": [], "owner": {"reputation": 1198, "user_id": 3361377, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b2278758c8fd94df86e3e7f155e96bdb?s=128&d=identicon&r=PG&f=1", "display_name": "dcromley", "link": "https://stackoverflow.com/users/3361377/dcromley"}, "is_accepted": false, "score": 0, "last_activity_date": 1530752826, "creation_date": 1530752826, "answer_id": 51182210, "question_id": 51180500, "link": "https://stackoverflow.com/questions/51180500/how-to-move-a-cell-contents-using-vba/51182210#51182210", "title": "How to Move a cell contents using VBA", "body": "<blockquote>\n  <p>I not sure how does the program move contents down from one cell to the next if the next cell is full without overwriting it and then move that one down.</p>\n</blockquote>\n\n<p>This should help with that:</p>\n\n<pre><code>  Cells(irow + 1, icol).Insert Shift:=xlDown\n  Cells(irow, icol).Copy Cells(irow + 1, icol)\n  Cells(irow, icol).Clear\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9951451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3c766f7c8495cfc12a62f291a1c68be?s=128&d=identicon&r=PG&f=1", "display_name": "RUSS ANDERSON", "link": "https://stackoverflow.com/users/9951451/russ-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530752826, "creation_date": 1530736793, "last_edit_date": 1530744814, "question_id": 51180500, "link": "https://stackoverflow.com/questions/51180500/how-to-move-a-cell-contents-using-vba", "title": "How to Move a cell contents using VBA", "body": "<p>I\u2019m trying to develop a small program using VBA and would like to add to it. As always I\u2019m struggling to get it right any really could use some help on this project. I not sure how does the program move contents down from one cell to the next if the next cell is full without overwriting it and then move that one down.\nI hope you can help.</p>\n\n<p>I'm currently using the program below.</p>\n\n<pre><code>Sub do_it()\n\n    Dim n, sht As Worksheet, cell As Range, num, tmp, rngDest As Range\n\n    Set sht = ActiveSheet\n\n    n = sht.Range(\"A1\")\n\n    For Each cell In sht.Range(\"D1:D12,A16:A31,D16:D31,G16:G31,J16:J31,M16:M31\").Cells\n\n        tmp = cell.Offset(0, 1).Value\n\n        If cell.Value = n And tmp Like \"*#-#*\" Then\n\n            'get the first number\n            num = CLng(Trim(Split(tmp, \"-\")(0)))\n            Debug.Print \"Found a positive result in \" &amp; cell.Address\n\n            'find the next empty cell in the appropriate row\n            Set rngDest = sht.Cells(num, sht.Columns.Count).End(xlToLeft).Offset(0, 1)\n            'make sure not to add before col L\n            If rngDest.Column &lt; 12 Then Set rngDest = sht.Cells(num, 12)\n\n            cell.Offset(0, 1).Copy rngDest\n            Exit For\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I'm trying to have the program move all the number sets down in the column in the 6 column ranges E1:E12,B16:B30,E16:E30,H16:H30,K16:K30,N16:N30.</p>\n\n<p>In only column E1:E12 I need the program to move the set of numbers (could be more than one set of numbers in the range) down to the following cell below it and increase the last number in the set (no limit to the count). So in the example of cell E1 (8-16)  would move to E2 and become 8-17 (cell E1 would be blank when after the move). \nWhen sets of number are located in cell E12 they would move to E1 but still increase the last number and would go round and round. Need help on the next one, how does the program move contents down from one cell to the next if the next cell is full without overwriting it and then move that one down, if this makes sense. An example is cell E12, how does it move up to E1 if E1 is full but has to be moved, which goes first?</p>\n\n<p>For the remaining column ranges B16:B30,E16:E30,H16:H30,K16:K30,N16:N30 I need the program to move the set of numbers (could be more than one set of numbers in the range) down to the following cell below it and increase the last number in the set (no limit to the count). So in the example of cell N18 (5-3) it would move it to N19 and become 5-4 (delete the contents in N18 when finished). The second adjacent column to the right of the above, N18 in this case and located in only the following locations: C16:C30,F16:F30,I16:I30,L16:L30,O16:O30 have cells that contain values that must move but with no change in number. Cell O18 would move down to O19 and still have the number of 9.99. After the operation N18 and O18 would then be blank).  </p>\n\n<p>The two exceptions are if the last number is a 15, see cell B30 (8-15).  Two things must happen: </p>\n\n<p>1) I need the program to reference the number in the following 5 possible cells:</p>\n\n<pre><code>Cell B30 go to cell B32, reference number 1\nCell E30 go to cell E32, reference number 2\nCell H30 go to cell H32, reference number 3\nCell K30 go to cell K32, reference number 4\nCell N30 go to cell N32, reference number 5\n</code></pre>\n\n<p>Using example B30 the reference number is 1 (B32) so the program would search the range in column D1:D12 for the number 1 and move the set of numbers and increase the last digit, so it would become 8-16 in cell number E1. </p>\n\n<p>2) The value in cell C31 must be moved via referencing the first number in cell B30 as a reference and search the following 10 possible cells: A35,D35,G35,J35,M35,Q35,A39,D39G39,J39,M39,O39 to find that number (in this example 8 would be cell D39 and the number 2.22 would be moved to cell D40.</p>\n\n<p>After this operation there is no contents in either cell B30 and C30.</p>\n\n<p>That\u2019s it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gySQK.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1530732869, "post_id": 51179870, "comment_id": 89342229, "body": "Your post makes no mention of what the problem is... remove or comment-out <code>On Error Resume Next</code> and re-run it. Are you getting any error? Where?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7160563, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1dd49753b4fd4edfe43bb2b0d8dde8da?s=128&d=identicon&r=PG&f=1", "display_name": "skryt", "link": "https://stackoverflow.com/users/7160563/skryt"}, "edited": false, "score": 0, "creation_date": 1530734832, "post_id": 51180031, "comment_id": 89342835, "body": "Thanks for all your help. I completely overlooked the on error part, thanks for the heads up. I also forgot to reference the excel spreadsheet with its object, which ultimately made the code not work. Thanks again, i&#39;ll clean this code up for sure now."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1530733528, "creation_date": 1530733528, "answer_id": 51180031, "question_id": 51179870, "link": "https://stackoverflow.com/questions/51179870/vba-export-access-to-excel-select-all-cells-format-table/51180031#51180031", "title": "VBA: Export Access to Excel -&gt; Select All Cells - &gt; format Table", "body": "<p>Your code is silently failing, <code>On Error Resume Next</code> is preventing you from knowing what the problem is. <strong>Never</strong> use <code>On Error Resume Next</code> to shove errors under the carpet like this.</p>\n\n<p>Assuming the Excel type library isn't referenced (you wouldn't be late-binding then, would you?), <code>Range</code> is likely an undefined identifier. Assuming <code>Option Explicit</code> isn't specified (if it were, the code wouldn't even compile/run), these unqualified <code>Range</code> identifiers are being \"declared\" on-the-spot like any other typo, as an unassigned <code>Variant/Empty</code> variable that can't possibly be an object to make member calls against.</p>\n\n<p>So I'm going to wager that the <em>actual</em> error you're getting is \"Object Required\", on this line:</p>\n\n<pre><code>Set rng = Range(Range(\"A1\"), Range(\"A1\").SpecialCells(xlLastCell))\n</code></pre>\n\n<p>You know what the <code>Worksheet</code> is supposed to be:</p>\n\n<pre><code>Set Page = XL.Worksheets(\"Sheet1\").Range(\"A1:I1\")\n</code></pre>\n\n<p>Declare a variable for it:</p>\n\n<pre><code>Dim ws As Object\nSet ws = XL.Worksheets(\"Sheet1\")\n</code></pre>\n\n<p>Now use that <code>Worksheet</code> object (I'd declare it well above that, and use it everywhere that sheet needs to be referenced) to qualify these <code>Range</code> calls:</p>\n\n<pre><code>Set rng = ws.Range(ws.Range(\"A1\"), ws.Range(\"A1\").SpecialCells(xlLastCell))\n</code></pre>\n\n<p>...which can be simplified to:</p>\n\n<pre><code>Set rng = ws.Range(\"A1\").SpecialCells(xlLastCell)\n</code></pre>\n\n<p>...except <code>xlLastCell</code> is also an identifier that doesn't exist.</p>\n\n<p>In the Excel type library, the correct identifier is <code>xlCellTypeLastCell</code> - but since you're not referencing that library, VBA couldn't know what that stands for either.</p>\n\n<p><code>xlCellTypeLastCell</code> is defined in an enum, with a value of <code>11</code>.</p>\n\n<p>So you could declare it like this:</p>\n\n<pre><code>Const xlCellTypeLastCell = 11\n</code></pre>\n\n<p>And then use it in your code:</p>\n\n<pre><code>Set rng = ws.Range(\"A1\").SpecialCells(xlCellTypeLastCell)\n</code></pre>\n\n<hr>\n\n<p>Edit - I missed these two:</p>\n\n<blockquote>\n<pre><code>Dim tbl As ListObject\nDim rng As Range\n</code></pre>\n</blockquote>\n\n<p>If you <em>are</em> referencing the Excel type library, then you're making your life much harder than it needs to be by declaring everything Excel <code>As Object</code>. Use the types if you have them!</p>\n"}], "owner": {"reputation": 41, "user_id": 7160563, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1dd49753b4fd4edfe43bb2b0d8dde8da?s=128&d=identicon&r=PG&f=1", "display_name": "skryt", "link": "https://stackoverflow.com/users/7160563/skryt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 51180031, "answer_count": 1, "score": -1, "last_activity_date": 1594632477, "creation_date": 1530732440, "last_edit_date": 1594632477, "question_id": 51179870, "link": "https://stackoverflow.com/questions/51179870/vba-export-access-to-excel-select-all-cells-format-table", "title": "VBA: Export Access to Excel -&gt; Select All Cells - &gt; format Table", "body": "<p>I apologize for the title in advance. What I want to do is export Microsoft access data to an Excel spreadsheet, select all the Cells and format it as a table. </p>\n\n<p>Problem: The data in the excel spreadsheet is not being formatted in a table as specified with the last 5 lines of code.</p>\n\n<p>code:</p>\n\n<pre><code>Private Sub button3_Click()\nDim tbl As ListObject\nDim rng As Range\n\nDim XL As Object\nDim Page As Object\nDim xlrngCell As Object\nDim rs As DAO.Recordset\nDim intF As Integer\n\n\nOn Error Resume Next\nSet XL = GetObject(, \"Excel.Application\")\nIf XL Is Nothing Then\n    Set XL = CreateObject(\"Excel.Application\")\n    If XL Is Nothing Then\n        MsgBox \"Can't find Excel!\", vbCritical\n        Exit Sub\n    End If\n    XL.Visible = True\n    XL.UserControl = True\nEnd If\n\nSet xlrngCell = XL.Workbooks.Add.Worksheets(1).Range(\"A1\")\nSet rs = Me.subformMain.Form.RecordsetClone\nFor intF = 0 To rs.Fields.Count - 1\n    xlrngCell(, intF + 1) = rs.Fields(intF).Name\nNext intF\nrs.MoveFirst\nxlrngCell.Offset(1).CopyFromRecordset rs\n\nxlrngCell.Worksheet.Parent.Saved = True\nSet Page = XL.Worksheets(\"Sheet1\").Range(\"A1:I1\")\nPage.Font.Bold = True\nPage.Font.Size = 16\nxlrngCell.Worksheet.Cells.EntireColumn.AutoFit\n\n\nSet rng = Range(Range(\"A1\"), Range(\"A1\").SpecialCells(xlLastCell))\nSet tbl = ActiveSheet.ListObjects.Add(xlSrcRange, rng, , xlYes)\ntbl.TableStyle = \"TableStyleDark10\"\nxlrngCell.Worksheet.Parent.Saved = True\nXL.Work\n\nEnd Sub\n</code></pre>\n\n<p>The last 5 lines of code are what should be selecting all the placed data and then selecting all of the cells and formatting them. Any tips/advice would be greatly appreciated.</p>\n\n<p>NOTE: I understand that I should modularize this code into separate functions and call them as methods.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1530734099, "post_id": 51179449, "comment_id": 89342599, "body": "Have a look <a href=\"https://excelmacromastery.com/vba-user-forms-1/#Cancelling_the_UserForm\" rel=\"nofollow noreferrer\">here</a> how to do it"}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1530734356, "creation_date": 1530734356, "answer_id": 51180164, "question_id": 51179449, "link": "https://stackoverflow.com/questions/51179449/vba-automation-error-server-not-server-application-upon-closing-form/51180164#51180164", "title": "VBA Automation Error - &quot;server [not server application]&quot; upon closing form", "body": "<p>To fix your code</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        Cancel = True\n    End If\n    Hide\n    cancelling = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": false, "score": 0, "last_activity_date": 1613030437, "creation_date": 1613030437, "answer_id": 66150817, "question_id": 51179449, "link": "https://stackoverflow.com/questions/51179449/vba-automation-error-server-not-server-application-upon-closing-form/66150817#66150817", "title": "VBA Automation Error - &quot;server [not server application]&quot; upon closing form", "body": "<p>For me, I don't have a &quot;red x&quot; (I hide it) and I didn't want to use Booleans. I call my UserForms like so via an Event:</p>\n<pre><code>Public Sub UserForm_Sub()\n\n'Application.ScreenUpdating = False\n\nSet UserFormUserForm = New UserFormUserForm\nOn Error GoTo ErrorHandler\nUserFormUserForm.ShowUserFormUserForm\n\nGoTo Continue\nErrorHandler:\nModelessFormShowing = False\nContinue:\n\nEnd Sub\n</code></pre>\n<p>It was a simple matter of utilizing Excel's Error Handler in my case. You might be find w/ <code>On Error Resume Next</code>, but in my case, I needed to set a <code>ModelessFormShowing</code> boolean to false if form errored during launch.</p>\n"}], "owner": {"reputation": 110, "user_id": 4460023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiFp7.jpg?s=128&g=1", "display_name": "RiverBanana", "link": "https://stackoverflow.com/users/4460023/riverbanana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1364, "favorite_count": 0, "accepted_answer_id": 51180164, "answer_count": 2, "score": 2, "last_activity_date": 1613030437, "creation_date": 1530729788, "last_edit_date": 1553800759, "question_id": 51179449, "link": "https://stackoverflow.com/questions/51179449/vba-automation-error-server-not-server-application-upon-closing-form", "title": "VBA Automation Error - &quot;server [not server application]&quot; upon closing form", "body": "<p>I've tried creating a form in the object-oriented manner as shown in this answer: <a href=\"https://stackoverflow.com/a/38382104/4460023\">https://stackoverflow.com/a/38382104/4460023</a>. Upon closing the form, I'd like to refer to the object property <code>IsCancelled</code> to check if the calling subroutine should continue executing. However, when I check this property outside of the form, I run into the following error:</p>\n\n<blockquote>\n  <p>\"Run-time error '-2147418105': Automation error. The callee (server\n  [not server application]) is not available and disappeared; all\n  connections are invalid. The call may have executed.\"</p>\n</blockquote>\n\n<p>I'm guessing this has something to do with the form being closed. As an alternative solution, I simply write to a global variable stored within the calling sub's module. Ideally though, I'd like to use the property within this form object. My code is included below:</p>\n\n<p>Within the form:</p>\n\n<pre><code>Private cancelling As Boolean\n\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = cancelling\nEnd Property\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        cancelling = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>And then within the calling subroutine:</p>\n\n<pre><code>Set frm = New ViewByWorkerForm\nfrm.Show\n\nIf frm.IsCancelled Then 'error happens here\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Note that I have other string properties within the class that I can use when I do not close the form - it's only the form closing that triggers this problem.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530730235, "post_id": 51179384, "comment_id": 89341485, "body": "What data does your cell contain? Are there any delimeters? In general your question is very vague and could use some editing. Specifically to adhere to <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a>"}, {"owner": {"reputation": 1, "user_id": 9274031, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208370024167662/picture?type=large", "display_name": "Talha Mahmood", "link": "https://stackoverflow.com/users/9274031/talha-mahmood"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530730622, "post_id": 51179384, "comment_id": 89341601, "body": "Updated my question."}, {"owner": {"reputation": 1, "user_id": 9274031, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208370024167662/picture?type=large", "display_name": "Talha Mahmood", "link": "https://stackoverflow.com/users/9274031/talha-mahmood"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530730680, "post_id": 51179384, "comment_id": 89341619, "body": "Different cells of the row have different data values such as string,integer"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530730969, "post_id": 51179384, "comment_id": 89341714, "body": "Provide an actual example of the input data. I&#39;m not asking for the data type, I&#39;m asking to determine your delimeter so it can be <code>split</code> into an array!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1530732256, "post_id": 51179384, "comment_id": 89342048, "body": "You haven&#39;t actually asked a question."}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1530733237, "creation_date": 1530733237, "answer_id": 51179994, "question_id": 51179384, "link": "https://stackoverflow.com/questions/51179384/how-to-get-values-of-selected-row-in-a-2d-array-excel-vba/51179994#51179994", "title": "How to get values of selected row in a 2d array excel vba?", "body": "<p>Something like this should do the trick:</p>\n\n<pre><code>Sub Test()\n\nDim COL As Long, X As Long, Y As Long\nDim MyArray() As Variant\n\nCOL = Cells(ActiveCell.Row, Columns.Count).End(xlToLeft).Column\nFor X = 1 To COL\n    ReDim Preserve MyArray(Y)\n    MyArray(Y) = Cells(ActiveCell.Row, X).Value\n    Y = Y + 1\nNext X\n\nFor X = LBound(MyArray) To UBound(MyArray)\n    Debug.Print MyArray(X)\nNext X\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9274031, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208370024167662/picture?type=large", "display_name": "Talha Mahmood", "link": "https://stackoverflow.com/users/9274031/talha-mahmood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 51179994, "answer_count": 1, "score": -2, "last_activity_date": 1530733237, "creation_date": 1530729406, "last_edit_date": 1531161705, "question_id": 51179384, "link": "https://stackoverflow.com/questions/51179384/how-to-get-values-of-selected-row-in-a-2d-array-excel-vba", "title": "How to get values of selected row in a 2d array excel vba?", "body": "<p>I want to store the values of the selected row in a dynamic 2d array.</p>\n\n<pre><code>Dim values() As Variant\nvalues=ActiveCell.EntireRow.Select\n</code></pre>\n\n<p>I am new to VBA.I have data in rows and columns.I want to store all the values of a particular selected row in an array and then plan to further use those values.</p>\n"}, {"tags": ["excel", "vba", "search", "vlookup", "userform"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531340570, "post_id": 51179143, "comment_id": 89564816, "body": "I don&#39;t understand what the random numbers are for.  If you haven&#39;t found a solution yet I&#39;d suggest you <a href=\"https://stackoverflow.com/posts/51179143/edit\">edit</a> your question to provide more specific information like sample data and expected output. For example, <code>return alternate rows</code> could mean various things. Also, check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (and earn a badge doing so!) as well as tips here: &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  (...and welcome to Stack Overflow!)"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530740060, "last_edit_date": 1530740060, "creation_date": 1530735388, "answer_id": 51180314, "question_id": 51179143, "link": "https://stackoverflow.com/questions/51179143/search-from-excel-combobox-returing-results-to-userform/51180314#51180314", "title": "Search from Excel combobox, returing results to userform", "body": "<p>You can use the <code>Find</code> function.</p>\n\n<p>If a value is found, you can return the <strong>Row Number</strong> with <code>Found.Row</code> and <strong>Column Index</strong> with <code>Count.Column</code></p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nDim Found As Range\nSet Found = Sheet1.Range(\"A1:A99\").Find(ComboBox1.Text, , xlValues, xlWhole)\n\n    If Found Is Nothing Then\n        'What do you want to do if your value in CommboBox is not found in the range?\n    Else\n        oHousing.Text = Sheet1.Cells(Found.Row, 2)\n        oMeal.Text = Sheet1.Cells(Found.Row, 3)\n    End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you are sure that your ComboBox value will always exist in your range (maybe you systematically programmed your ComboBox values this way) you can skip the check and simply use: </p>\n\n<pre><code>Dim Found As Range\nSet Found = Sheet1.Range(\"A1:A99\").Find(ComboBox1.Text, , xlValues, xlWhole)\n    oHousing.Text = Sheet1.Cells(Found.Row, 2)\n    oMeal.Text = Sheet1.Cells(Found.Row, 3)\n</code></pre>\n\n<hr>\n\n<p>You can find properties of the <code>Find</code> method <a href=\"https://excelmacromastery.com/excel-vba-find/\" rel=\"nofollow noreferrer\">here</a>. If you are looking for text, you may need to distinguish between case sensitivity (for your needs, does <code>THIS</code> = <code>this</code>?). The properties that are currently applied means the function is looking for values (<code>xlValues</code>), specifically, looking at the whole value of the cell (<code>xlWhole</code>). <em>I.E.</em> (<code>this value</code> will not match with <code>this</code>)</p>\n"}], "owner": {"reputation": 11, "user_id": 10033504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bvUYVCnU3bU/AAAAAAAAAAI/AAAAAAAAAEs/snF5sdfFl5k/photo.jpg?sz=128", "display_name": "Jauhn S", "link": "https://stackoverflow.com/users/10033504/jauhn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531340380, "creation_date": 1530728179, "last_edit_date": 1531340380, "question_id": 51179143, "link": "https://stackoverflow.com/questions/51179143/search-from-excel-combobox-returing-results-to-userform", "title": "Search from Excel combobox, returing results to userform", "body": "<p>I'd like search from a combobox on a userform, returning 2 items from 2 different rows. So far I am using a predetermined location set to return the alternate rows. </p>\n\n<p><strong>My question is about this section:</strong></p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    If ComboBox1.Text = Sheet1.Cells(3, 1) Then\n        oHousing.Text = Sheet1.Cells(3, 2)\n        oMeal.Text = Sheet1.Cells(3, 3)\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Here is what the pseudocode would do:</strong></p>\n\n<ol>\n<li>User selects item in combobox</li>\n<li>combobox will search <code>A1:A99</code> for item</li>\n<li>then once item is found it will output <code>B#</code> and <code>C#</code> (<code>#</code> is based on location of <code>A#</code>)</li>\n<li><code>B#</code> is outputted to <code>oHousing</code> (textbox)</li>\n<li><code>C#</code> is outputted to <code>oMeal</code> (textbox)</li>\n</ol>\n\n<hr>\n\n<p><strong>On my sheet I have:</strong></p>\n\n<ul>\n<li><code>A2:A28</code> with random text (I used ABC's)</li>\n<li><code>B2:B28</code> are random 3 digit numbers (numeric, eg: 001-999)</li>\n<li><code>C2:C28</code> is Random 3 numbers (numeric, eg: 001-999)</li>\n</ul>\n\n<hr>\n\n<p><strong>Here's the rest of my code:</strong></p>\n\n<pre><code>'Finds the difference in 2 known dates (returns whole number in textbox)\nPrivate Sub CommandButton1_Click()\n    Dim firstDate As Date, secondDate As Date, n As Integer\n    firstDate = DateValue(sDate.Text)\n    secondDate = DateValue(EDate.Text)\n    n = DateDiff(\"d\", firstDate, secondDate) - 0.5\n    dTotal.Text = n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()    'Exit the userform (PerDiem)\n    Unload PerDiem\nEnd Sub\n</code></pre>\n\n<p>Thanks to all in advance!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 0, "creation_date": 1530985123, "post_id": 51179534, "comment_id": 89431312, "body": "Where do I paste the first part of the code beginning with &quot;Public Function GetFiles&quot; please?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 0, "creation_date": 1531000751, "post_id": 51179534, "comment_id": 89434433, "body": "@Marc Within the same module. Or, if you like, in a separate module; the function is marked <code>Public</code> so it doesn&#39; matter."}, {"owner": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 0, "creation_date": 1531026900, "post_id": 51179534, "comment_id": 89437751, "body": "I pasted both in the same module and got   Run-time error &#39;13&#39;: Type mismatch  did Debug and got this line highlighted  roots = Array(roots)"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 0, "creation_date": 1531150937, "post_id": 51179534, "comment_id": 89477527, "body": "(I&#39;m sorry for the delay.) 1) What does your call to <code>GetFiles</code> look like? In the code above it&#39;s <code>GetFiles(sourceFolder)</code>, but your code might be different. 2) Also, look in the <b>Locals Window</b> (available from the <b>View</b> menu) and see what value <code>roots</code> has at the error."}, {"owner": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 0, "creation_date": 1531244769, "post_id": 51179534, "comment_id": 89520820, "body": "(No prob Zev, thanks for the help) 1) If by &quot;call to GetFiles&quot; you mean the path, it is the same as in the macro above (sorry I&#39;m a newbie to VB).  2) In the Locals Window root shows a value of Empty and roots shows a Value of &quot;&quot;C:\\Users\\Administrator\\Desktop\\Unprocessed\\&quot;"}, {"owner": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 0, "creation_date": 1531244944, "post_id": 51179534, "comment_id": 89520891, "body": "BTW - the macro runs perfectly when started manually when there are NO subfolders and all the Word documents are in the Unprocessed folder and the processed files get saved in the Processed folder."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "edited": false, "score": 1, "creation_date": 1531251947, "post_id": 51179534, "comment_id": 89523960, "body": "From the <a href=\"https://stackoverflow.com/a/51272853/111794\">answers</a> to the <a href=\"https://stackoverflow.com/questions/51272430/type-mismatch-when-passing-string-variable-into-variant-parameter-and-assigning\">question I posted on the issue</a> the first parameter in <code>GetFiles</code> has to be defined as <code>ByVal</code>, which means that changes to the parameter inside of <code>GetFiles</code> won&#39;t be reflected outside of <code>GetFiles</code>. I&#39;ve updated the answer."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1531251824, "last_edit_date": 1531251824, "creation_date": 1530730305, "answer_id": 51179534, "question_id": 51178997, "link": "https://stackoverflow.com/questions/51178997/soft-returns-macro/51179534#51179534", "title": "Soft returns macro", "body": "<p>I personally prefer to work with the <code>Scripting.FileSystemObject</code>; it's generally easier to work with than parsing and recombining the output of the VBA <code>Dir</code> function. Add a reference to the <strong>Microsoft Scripting Runtime</strong> library, via <strong>Tools</strong> -> <strong>References...</strong>.</p>\n\n<p>I would suggest using the following functions :</p>\n\n<pre><code>Public Function GetFiles(ByVal roots As Variant) As Collection\n    Select Case TypeName(roots)\n        Case \"String\", \"Folder\"\n            roots = Array(roots)\n    End Select\n\n    Dim results As New Collection\n    Dim fso As New Scripting.FileSystemObject\n\n    Dim root As Variant\n    For Each root In roots\n        AddFilesFromFolder fso.GetFolder(root), results\n    Next\n\n    Set GetFiles = results\nEnd Function\n\nPrivate Sub AddFilesFromFolder(folder As Scripting.folder, results As Collection)\n    Dim file As Scripting.file\n    For Each file In folder.Files\n        results.Add file\n    Next\n\n    Dim subfolder As Scripting.folder\n    For Each subfolder In folder.SubFolders\n        AddFilesFromFolder subfolder, results\n    Next\nEnd Sub\n</code></pre>\n\n<p>This takes a path, or a <code>Scripting.Folder</code> object (or an array of either), and returns a collection of <code>File</code> objects for each file in all the subfolders for the passed in folder(s).</p>\n\n<p>Then you can write your code as follows:</p>\n\n<pre><code>Sub ConvertReturns()\n    'This Sub loops through docx files in a folder recursively, opens each file, finds manual line breaks, replaces each with a paragraph return, saves changed file to a new folder, closes original file.\n\n    Dim targetFolder As String\n    Dim oFile As Scripting.file, oFso As New Scripting.FileSystemObject\n    Dim oDoc As Document, oRng As Range\n    Dim fileName As String, fileExtension As String\n    Dim targetPath As String\n\n    'Set paths to folders for original and converted files on user's hard drive.\n    Const sourceFolder = \"C:\\Users\\Administrator\\Desktop\\Unprocessed\\\"\n    targetFolder = \"C:\\Users\\Administrator\\Desktop\\Processed\\\"\n\n    'Repeat the following code for each File object in the Collection returned by GetFiles\n    For Each oFile In GetFiles(sourceFolder)\n        'This handles any Word Document -- .doc and .docx\n        If oFile.Type Like \"Microsoft Word*\" Then\n            'Open the file\n            '.Path returns the full path of the file\n            Set oDoc = Documents.Open(fileName:=oFile.Path)\n\n            'Find all manual line breaks and replace them with paragraph markers\n            Set oRng = ActiveDocument.Range\n            With oRng.Find\n                .Text = \"^l\"\n                .Replacement.Text = \"^p\"\n                .Forward = True\n                .Wrap = wdFindContinue\n                .Format = False\n                .MatchCase = False\n            End With\n            oRng.Find.Execute Replace:=wdReplaceAll\n\n            fileName = oFso.GetBaseName(oFile.Name)\n            fileExtension = oFso.GetExtensionName(oFile.Name)\n            targetPath = oFso.BuildPath(targetFolder, fileName &amp; \"_Converted.\" &amp; fileExtension)\n\n            'Save the changed document with the same name but appended with \"_Converted\" in your target folder\n            oDoc.SaveAs targetPath\n\n            'Close the original document without saving changes\n            oDoc.Close SaveChanges:=False\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>References:</p>\n\n<h3>Scripting Runtime</h3>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/6kxy1a51%28v%3dvs.84%29\" rel=\"nofollow noreferrer\">FileSystemObject object</a>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/xhxzwwe1%28v%3dvs.84%29\" rel=\"nofollow noreferrer\">GetBaseName method</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/x0fxha2a%28v%3dvs.84%29\" rel=\"nofollow noreferrer\">GetExtensionName method</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/z0z2z1zt%28v%3dvs.84%29\" rel=\"nofollow noreferrer\">BuildPath method</a></li>\n</ul></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/1ft05taf%28v%3dvs.84%29\" rel=\"nofollow noreferrer\">File object</a>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/y7k0wsxy%28v%3dvs.84%29\" rel=\"nofollow noreferrer\">Type property</a></li>\n</ul></li>\n</ul>\n\n<h3>Word object model</h3>\n\n<ul>\n<li>Global <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/application-activedocument-property-word\" rel=\"nofollow noreferrer\">ActiveDocument property</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/application-object-word\" rel=\"nofollow noreferrer\">Application object</a>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/application-documents-property-word\" rel=\"nofollow noreferrer\">Documents property</a></li>\n</ul></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/documents-object-word\" rel=\"nofollow noreferrer\">Documents collection</a>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/documents-open-method-word\" rel=\"nofollow noreferrer\">Open method</a></li>\n</ul></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/document-object-word\" rel=\"nofollow noreferrer\">Document object</a>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/document-range-method-word\" rel=\"nofollow noreferrer\">Range method</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/document-saveas2-method-word\" rel=\"nofollow noreferrer\">SaveAs2 method</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/document-close-method-word\" rel=\"nofollow noreferrer\">Close method</a></li>\n</ul></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/range-object-word\" rel=\"nofollow noreferrer\">Range object</a>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/range-find-property-word\" rel=\"nofollow noreferrer\">Find method</a></li>\n</ul></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-object-word\" rel=\"nofollow noreferrer\">Find object</a>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-text-property-word\" rel=\"nofollow noreferrer\">Text property</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-format-property-word\" rel=\"nofollow noreferrer\">Format</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-wrap-property-word\" rel=\"nofollow noreferrer\">Wrap</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-forward-property-word\" rel=\"nofollow noreferrer\">Forward</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-matchcase-property-word\" rel=\"nofollow noreferrer\">MatchCase</a> properties</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-replacement-property-word\" rel=\"nofollow noreferrer\">Replacement property</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/find-execute-method-word\" rel=\"nofollow noreferrer\">Execute method</a></li>\n</ul></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/replacement-object-word\" rel=\"nofollow noreferrer\">Replacement object</a>, \n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/replacement-text-property-word\" rel=\"nofollow noreferrer\">Text property</a></li>\n</ul></li>\n</ul>\n\n<h3>VBA</h3>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/typename-function\" rel=\"nofollow noreferrer\">TypeName function</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/array-function\" rel=\"nofollow noreferrer\">Array function</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/collection-object\" rel=\"nofollow noreferrer\">Collection object</a>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/add-method-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Add method</a></li>\n</ul></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/like-operator\" rel=\"nofollow noreferrer\">Like operator</a></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 10032138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512a0c7f557509f559a229033fb1e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/10032138/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531251824, "creation_date": 1530727491, "last_edit_date": 1530729870, "question_id": 51178997, "link": "https://stackoverflow.com/questions/51178997/soft-returns-macro", "title": "Soft returns macro", "body": "<p>How do I modify the following Word macro to convert soft returns to hard returns and process all files in <strong>subfolders</strong> as well using \"new file\" as an event trigger?</p>\n\n<pre><code>Sub ConvertReturns()\n'This Sub loops through docx files in a folder, opens each file, finds manual line breaks, replaces each with a paragraph return, saves changed file to a new folder, closes original file.\nDim oSourceFolder, oTargetFolder, oDocName As String\nDim oDoc As Document\nDim oRng As Range\n\n'Set paths to folders for original and converted files on user's hard drive.\noSourceFolder = \"C:\\Users\\Administrator\\Desktop\\Unprocessed\\\"\noTargetFolder = \"C:\\Users\\Administrator\\Desktop\\Processed\\\"\n\n'Get a handle on the first file in the source folder\noFile = Dir(oSourceFolder &amp; \"*.doc\")\n\n'Continue doing the following steps until there are no more unprocessed files in the source folder\nDo While oFile &lt;&gt; \"\"\n    'Open the file\n    Set oDoc = Documents.Open(FileName:=oSourceFolder &amp; oFile)\n    'Get the name of the document you just opened\n    oDocName = Left(oDoc.Name, Len(oDoc.Name) - 3)\n\n    'Find all manual line breaks and replace them with paragraph markers\n    Set oRng = ActiveDocument.Range\n    With oRng.Find\n        .Text = \"^l\"\n        .Replacement.Text = \"^p\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n    End With\n    oRng.Find.Execute Replace:=wdReplaceAll\n\n    'Save the changed document with the same name but appended with \"_Converted\" in your target folder\n    oDoc.SaveAs oTargetFolder &amp; oDocName &amp; \"doc\"\n\n    'Close the original document without saving changes\n    oDoc.Close SaveChanges:=False\n\n    'Get a handle on the next file in your source folder\n    oFile = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2016", "page-break", "vba"], "comments": [{"owner": {"reputation": 134, "user_id": 1565951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J67yv.jpg?s=128&g=1", "display_name": "Antonio Rodulfo", "link": "https://stackoverflow.com/users/1565951/antonio-rodulfo"}, "edited": false, "score": 0, "creation_date": 1530733539, "post_id": 51178814, "comment_id": 89342442, "body": "What are you storing on &quot;i&quot;?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1530744038, "post_id": 51178814, "comment_id": 89345282, "body": "Your image shows Cust5 then blank then Cust5 again. But the others only have CustX on the first line, then blanks. Is this a mistake?"}], "answers": [{"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1530862945, "post_id": 51185349, "comment_id": 89391627, "body": "@Morg Was this the kind of thing you were after?"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1530774908, "creation_date": 1530774908, "answer_id": 51185349, "question_id": 51178814, "link": "https://stackoverflow.com/questions/51178814/how-to-insert-page-breaks-to-keep-certain-data-ranges-together/51185349#51185349", "title": "How to insert page breaks to keep certain data ranges together?", "body": "<p>This code seems to work for me:</p>\n\n<pre><code>Option Explicit\n\nSub BreakPagesCleanly()\nDim pb As HPageBreak\nDim rng As Range\nDim i As Long\n\nActiveWindow.View = xlPageBreakPreview\nActiveSheet.ResetAllPageBreaks\nFor Each pb In ActiveSheet.HPageBreaks\n    If pb.Location.Value = \"\" Then\n        'go back to the last value\n        Set rng = pb.Location.End(xlUp)\n        ActiveSheet.HPageBreaks.Add before:=rng\n        DoEvents 'Seems to be required to give Excel time to catch up\n    End If\nNext pb\n\nEnd Sub\n</code></pre>\n\n<p>Here's the before view, vs the after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mcO0i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mcO0i.png\" alt=\"enter image description here\"></a> <a href=\"https://i.stack.imgur.com/UH5eO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UH5eO.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 191, "user_id": 10005884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1192916b983dba9b7b170877d19f7d9?s=128&d=identicon&r=PG&f=1", "display_name": "morg", "link": "https://stackoverflow.com/users/10005884/morg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530774908, "creation_date": 1530726606, "last_edit_date": 1531161705, "question_id": 51178814, "link": "https://stackoverflow.com/questions/51178814/how-to-insert-page-breaks-to-keep-certain-data-ranges-together", "title": "How to insert page breaks to keep certain data ranges together?", "body": "<p>I'm trying to create a monthly report for my company and I'm having troubles with the aesthetics of it.  I have tables (with lots more data) that looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/AE8lN.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>textwise looks like this (if picture is unavailable)</p>\n\n<p>Customer 1 - 2018-###-#33</p>\n\n<p>Customer 2 - 2017-###-###</p>\n\n<p>----------------2018-###-###</p>\n\n<p>Customer 3- 2018-###-###\netc</p>\n\n<p>but sometimes there is a page break in the middle of a customer data, so that the title shows up on the first page but the last row(s) are on a new page. </p>\n\n<p>I am trying to come up with a code to sense whether or not the data range will be split up, but I can not. I had thought maybe the pagebreak could be anticipated with the row number (as that's how I'm grouping the data) but one sheet has the break on row 101 (because this data starts at row 46) and the other has the pagebreak on row 106. </p>\n\n<p>I have tried doing something similar to this: </p>\n\n<pre><code>If i &gt;= 102 And start.row &lt;= 101 Then\nWorksheets(storenumber).HPageBreaks.Add before:=Rows(start.row)\nElse\nIf i &gt;= 176 And start.row &lt;= 166 Then\nWorksheets(storenumber).HPageBreaks.Add before:=Rows(start.row)\nEnd If\nEnd If\n</code></pre>\n\n<p>(with varying i = numbers and combination) but I haven't had any success. </p>\n\n<p>Does anyone else have any other ideas? there normally is only one page break per storenumber sheet, with the except of one sheet.  (and some sheets don't need a page break as they only have say 5 customers)</p>\n\n<p>I'm looking for an easier code (excel beginner/intermediate) but I'm open to any ideas.  Thanks for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 3, "creation_date": 1530723492, "post_id": 51178134, "comment_id": 89339012, "body": "Hello and welcome to Stackoverflow! Unfortunately the site does not work like this, you do not come here requesting a code (there are a lot of coders for hire if you want that), <b>what you should do, is try to solve this yourself first, post your coding efforts here and then we will be willing to help you with your code :)</b>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1530725958, "post_id": 51178134, "comment_id": 89340001, "body": "Exactly what &quot;help&quot; do you need?"}], "answers": [{"tags": [], "owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "is_accepted": false, "score": -1, "last_activity_date": 1530724958, "creation_date": 1530724958, "answer_id": 51178518, "question_id": 51178134, "link": "https://stackoverflow.com/questions/51178134/excel-vba-find-minimum-value-for-each-row-based-on-selected-columns-and-highli/51178518#51178518", "title": "Excel VBA - Find minimum value for each row based on selected columns and highlight the lowest value", "body": "<p>Well you actually don't need VBA to do something like this. Conditional formatting will work just fine. Highlight the range (you could go to the bottom of the worksheet), the N/A don't matter, and on the Home Tab click conditional formatting > New Rule... > Use a formula to determine which cells to format and in the formula enter the following:</p>\n\n<p><code>=IF(B1=\"\",FALSE,MIN(B1:H1)=B1)</code></p>\n\n<p>Click Format and select the Fill color you want. So the way this works starts with the cell you first select, B1. If you click and select B1:H4 then select condition formatting you have to use the first row in the formula. It will try to use exact references with $B$1, just hit F4 a couple of times to remove them, so <code>=MIN(B1:H1)=B1</code> is where I started. Once that worked I added the `=IF(b1=\"\",FALSE,MIN(B1:H1)=B1) so you can make it go way down and it will not color the blank cells.</p>\n"}], "owner": {"reputation": 23, "user_id": 10033276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191d1876aba761153a6ebef74b0a02e0?s=128&d=identicon&r=PG&f=1", "display_name": "user10033276", "link": "https://stackoverflow.com/users/10033276/user10033276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1585886975, "creation_date": 1530723045, "last_edit_date": 1585886975, "question_id": 51178134, "link": "https://stackoverflow.com/questions/51178134/excel-vba-find-minimum-value-for-each-row-based-on-selected-columns-and-highli", "title": "Excel VBA - Find minimum value for each row based on selected columns and highlight the lowest value", "body": "<p>I would like to seek some help on the problem that I'm facing. I'm trying to highlight the lowest value in the sheet for each row based on selected columns, i.e. iot1, iot2, iot3. </p>\n\n<p>If you see the before and after image below, <strong>I would like to have the code that works to highlight the lowest (minimum) value</strong>. Thank you very much, any assistance is much appreciated! </p>\n\n<p>Before:\n<a href=\"https://i.stack.imgur.com/r4Q75.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r4Q75.png\" alt=\"https://i.stack.imgur.com/r4Q75.png\"></a></p>\n\n<p>After: \n<a href=\"https://i.stack.imgur.com/9S9Bp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9S9Bp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530727664, "post_id": 51177727, "comment_id": 89340551, "body": "I&#39;d recommend replacing empty cells with a &quot;-&quot; then use a helper column where you concatenate all your columns together. E.g. a simple four column sample would be <code>x--x</code> and you can just look for duplicates for <code>x--x</code> - your current approach is pretty messy and is bound to get messier!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530728166, "post_id": 51177727, "comment_id": 89340705, "body": "@jamheadart thank you for your suggestions, do you Have an example because in my case I&#39;m limited in modification which mean I can&#39;t modify this template but I can highlight or use  &quot;AN&quot; /&quot;AO&quot; column to indicate results"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530772183, "post_id": 51177727, "comment_id": 89351051, "body": "any help regarding this ?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530813496, "post_id": 51177727, "comment_id": 89376487, "body": "If you can&#39;t modify the existing sheet can you set up another background sheet where you can use something like <code>=IF(E1=&quot;&quot;,&quot;-&quot;,E1)</code> to fill a sheet with <code>x</code> and <code>-</code> which you CAN modify. After that use a column at the end like <code>=E3&amp;F3&amp;G3&amp;H3</code> and fill it down. Then you can search for duplicates in that column and push back to the AN/AO columns in the non-modifiable sheet"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530869272, "post_id": 51177727, "comment_id": 89395193, "body": "It&#39;s a good Idea but I can&#39;t do that , Because if I concatinate the Values togeather , I will face another problem ,macro will find alot of matchs based on length of that value E.G : cells (A,B,C) it&#39;s different than cells (B,F,G) but they got the same length which is 3 :( * and I won&#39;t do that Because I need to keep their actual position"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1530729560, "post_id": 51178834, "comment_id": 89341241, "body": "your code doesn&#39;t return any errors  but it&#39;s comparing cells E.G comparing cells 1 for row 2 and row 3 and if it found match it returns directly 1 in colum &quot;AO&quot; and that&#39;s not What I want .:D ... but I need  to show 1 only if cells 1 , cells 2 , cells i  for row 1 is exactly the same for row 2 cells 1,cells 2 , cells i .  until now your code got the same function as my code :("}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530729679, "post_id": 51178834, "comment_id": 89341275, "body": "It should be checking the array as a whole, not individual values"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1530772237, "post_id": 51178834, "comment_id": 89351085, "body": "you mean with a whole as empty ?"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530727433, "last_edit_date": 1530727433, "creation_date": 1530726703, "answer_id": 51178834, "question_id": 51177727, "link": "https://stackoverflow.com/questions/51177727/excel-vba-fixing-row-to-compare/51178834#51178834", "title": "Excel VBA-Fixing Row to compare", "body": "<p>Can you try this (not tested on my end)?</p>\n\n<pre><code>Option Explicit\n\n\nSub check()\n Dim check1, check2 As Variant\n Dim i, d As Long\n\nFor i = 2 To 74\n    check1 = Array(Range(\"F\" &amp; i), Range(\"G\" &amp; i), Range(\"H\" &amp; i), Range(\"I\" _\n    &amp; i), Range(\"J\" &amp; i), Range(\"K\" &amp; i), Range(\"L\" &amp; i), Range(\"M\" &amp; i), _\n    Range(\"N\" &amp; i), Range(\"O\" &amp; i), Range(\"P\" &amp; i), Range(\"Q\" &amp; i), _\n    Range(\"R\" &amp; i), Range(\"S\" &amp; i), Range(\"T\" &amp; i), Range(\"U\" &amp; i), _\n    Range(\"V\" &amp; i), Range(\"W\" &amp; i), Range(\"X\" &amp; i), Range(\"Y\" &amp; i), _\n    Range(\"Z\" &amp; i), Range(\"AA\" &amp; i), Range(\"AB\" &amp; i), Range(\"AC\" &amp; i), _\n    Range(\"AD\" &amp; i), Range(\"AE\" &amp; i), Range(\"AF\" &amp; i), Range(\"AG\" &amp; i), _\n    Range(\"AH\" &amp; i), Range(\"AI\" &amp; i), Range(\"AJ\" &amp; i), Range(\"AL\" &amp; i), _\n    Range(\"AM\" &amp; i))\n        For d = 3 To 74\n            check2 = Array(Range(\"F\" &amp; d), Range(\"G\" &amp; d), Range(\"H\" &amp; d), Range(\"I\" _\n            &amp; d), Range(\"J\" &amp; d), Range(\"K\" &amp; d), Range(\"L\" &amp; d), Range(\"M\" &amp; d), _\n            Range(\"N\" &amp; d), Range(\"O\" &amp; d), Range(\"P\" &amp; d), Range(\"Q\" &amp; d), _\n            Range(\"R\" &amp; d), Range(\"S\" &amp; d), Range(\"T\" &amp; d), Range(\"U\" &amp; d), _\n            Range(\"V\" &amp; d), Range(\"W\" &amp; d), Range(\"X\" &amp; d), Range(\"Y\" &amp; d), _\n            Range(\"Z\" &amp; d), Range(\"AA\" &amp; d), Range(\"AB\" &amp; d), Range(\"AC\" &amp; d), _\n            Range(\"AD\" &amp; d), Range(\"AE\" &amp; d), Range(\"AF\" &amp; d), Range(\"AG\" &amp; d), _\n            Range(\"AH\" &amp; d), Range(\"AI\" &amp; d), Range(\"AJ\" &amp; d), Range(\"AL\" &amp; d), _\n            Range(\"AM\" &amp; d))\n\n            If Join(check1, Chr(0)) = Join(check2, Chr(0)) Then\n                Range(\"AO\" &amp; i) = 1\n                Range(\"AO\" &amp; d) = 1\n            Else\n                Range(\"AN\" &amp; d) = 0\n            End If\n        Next d\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530727433, "creation_date": 1530721099, "last_edit_date": 1531164843, "question_id": 51177727, "link": "https://stackoverflow.com/questions/51177727/excel-vba-fixing-row-to-compare", "title": "Excel VBA-Fixing Row to compare", "body": "<p>Thanks to this site I adapted a code for my own needs , this macro allows me to compare specific cells of an X rows with another cells of Y row and there is a match between all cells not only 1 or 2 cells but all cells of that row then it give <strong>1</strong> and <strong>0</strong> if no match is found</p>\n\n<ul>\n<li>the problem that the macro is comparing row X with Y which what I want but i doesn't compare X with Y+1 or Y+2  , it passes directly to X+1 and compare it with Y+1 </li>\n</ul>\n\n<p><strong>to better understand my problem see below :</strong></p>\n\n<p>in this image two line with yellow color are identical and in column AO there is 1 infront of the first line and 1 infront of the second line \n<a href=\"https://i.stack.imgur.com/3uSxe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3uSxe.png\" alt=\"enter image description here\"></a></p>\n\n<p>so what is to compare every row with the other rows(X with Y,Y+1,Y+2) and passe on to the next Row and when there is match that is highlighted or returns 1 in column \"AO\"</p>\n\n<p><strong>Code :</strong></p>\n\n<pre><code>Sub check()\n Dim check1, check2 As Variant\n Dim l As Long\n Dim ElementsSame As Boolean\n   For i = 2 To 74\n     check1 = Array(Range(\"F\" &amp; i), Range(\"G\" &amp; i), Range(\"H\" &amp; i), Range(\"I\" \n       &amp; i), Range(\"J\" &amp; i), Range(\"K\" &amp; i), Range(\"L\" &amp; i), Range(\"M\" &amp; i), \n      Range(\"N\" &amp; i), Range(\"O\" &amp; i), Range(\"P\" &amp; i), Range(\"Q\" &amp; i), \n      Range(\"R\" &amp; i), Range(\"S\" &amp; i), Range(\"T\" &amp; i), Range(\"U\" &amp; i), \n      Range(\"V\" &amp; i), Range(\"W\" &amp; i), Range(\"X\" &amp; i), Range(\"Y\" &amp; i), \n      Range(\"Z\" &amp; i), Range(\"AA\" &amp; i), Range(\"AB\" &amp; i), Range(\"AC\" &amp; i), \n      Range(\"AD\" &amp; i), Range(\"AE\" &amp; i), Range(\"AF\" &amp; i), Range(\"AG\" &amp; i), \n       Range(\"AH\" &amp; i), Range(\"AI\" &amp; i), Range(\"AJ\" &amp; i), Range(\"AL\" &amp; i), \n      Range(\"AM\" &amp; i))\nFor D = 3 To 74\n     check2 = Array(Range(\"F\" &amp; D), Range(\"G\" &amp; D), Range(\"H\" &amp; D), Range(\"I\" \n     &amp; D), Range(\"J\" &amp; D), Range(\"K\" &amp; D), Range(\"L\" &amp; D), Range(\"M\" &amp; D), \n     Range(\"N\" &amp; D), Range(\"O\" &amp; D), Range(\"P\" &amp; D), Range(\"Q\" &amp; D), \n     Range(\"R\" &amp; D), Range(\"S\" &amp; D), Range(\"T\" &amp; D), Range(\"U\" &amp; D), \n      Range(\"V\" &amp; D), Range(\"W\" &amp; D), Range(\"X\" &amp; D), Range(\"Y\" &amp; D), \n       Range(\"Z\" &amp; D), Range(\"AA\" &amp; D), Range(\"AB\" &amp; D), Range(\"AC\" &amp; D), \n       Range(\"AD\" &amp; D), Range(\"AE\" &amp; D), Range(\"AF\" &amp; D), Range(\"AG\" &amp; D), \n      Range(\"AH\" &amp; D), Range(\"AI\" &amp; D), Range(\"AJ\" &amp; D), Range(\"AL\" &amp; D), \n       Range(\"AM\" &amp; D))\n ElementsSame = True\n For l = 0 To 32 \n   If check1(l) &lt;&gt; check2(l) Then\n    ElementsSame = False\n\n    Exit For\n End If\n Next l\n\nIf ElementsSame = False Then\n\n  Range(\"AO\" &amp; i) = 1\n  Range(\"AO\" &amp; D) = 1 \nElse\n   Range(\"AN\" &amp; D) = 0 \nEnd If\nNext D\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Anyone can light me about solving this and If anything is not clear about my problem , please feel free to ask </p>\n\n<p>B.R\nPolos</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1530720716, "post_id": 51177613, "comment_id": 89337854, "body": "Like it highlights <code>Set cn = New ADODB.Connection</code>?"}, {"owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1530720926, "post_id": 51177613, "comment_id": 89337934, "body": "No. It is highlights Dim cn As ADODB.Connection @Brad"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530720944, "post_id": 51177613, "comment_id": 89337940, "body": "Go to the VBE&#39;s Tools, References then locate and put a check beside &#39;Microsoft ActiveX Data Objects 6.1 Library&#39; to include the library in your project."}, {"owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "edited": false, "score": 0, "creation_date": 1530721140, "post_id": 51177613, "comment_id": 89338015, "body": "Thanks @Jeeped. It worked."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1530771225, "post_id": 51177613, "comment_id": 89350614, "body": "Then please mark as answered."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1530721092, "creation_date": 1530721092, "answer_id": 51177726, "question_id": 51177613, "link": "https://stackoverflow.com/questions/51177613/adodb-connection-adodb-recordset-user-define-type-not-defined/51177726#51177726", "title": "ADODB.Connection &amp; ADODB.Recordset - User define type not defined", "body": "<p>Go to the VBE's Tools, References then locate and put a check beside 'Microsoft ActiveX Data Objects 6.1 Library' to include the library in your project.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yPkA8.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/yPkA8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 49, "user_id": 9703883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d9137cb8a913ec805e2e2d745137bb?s=128&d=identicon&r=PG&f=1", "display_name": "Maitreya", "link": "https://stackoverflow.com/users/9703883/maitreya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10380, "favorite_count": 1, "accepted_answer_id": 51177726, "answer_count": 1, "score": 2, "last_activity_date": 1590753180, "creation_date": 1530720533, "last_edit_date": 1530729754, "question_id": 51177613, "link": "https://stackoverflow.com/questions/51177613/adodb-connection-adodb-recordset-user-define-type-not-defined", "title": "ADODB.Connection &amp; ADODB.Recordset - User define type not defined", "body": "<p>I am facing a strange error while connecting Access DB using VBA. The VBA code goes like this:</p>\n\n<pre><code>Sub DBC()\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n\n    Set cn = New ADODB.Connection\n\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\\\\Bmcstr01\\grp\\SRV\\Allsrv\\Resource Planning\\Forecasting &amp; MI\\MI\\backup DM\\HH Complaints\\Database (TCS Version)\\Complaints DB.accdb;\"\n\n    Set rs = New ADODB.Recordset\n\n    rs.Open \"Access_Log\", cn, adOpenKeyset, adLockOptimistic, adCmdTable\n\n    rs.Filter = \"ID='335266' AND Work='Test'\"\n    rs(\"Login\").Value = \"02/07/2018\"\n    rs.Update\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The error it is giving is: \"Compile Error: User define type not defined\" and it is pointing to first line of the sub.</p>\n\n<p>My table is present in the DB. It structures as follows:</p>\n\n<pre><code>ID  Login   Work\n335266  04/07/2018  Test\n335266  03/07/2018  Test2\n</code></pre>\n\n<p>Can anyone please help me with the reason why it is not accepting the ADODB and how to resolve this?</p>\n"}, {"tags": ["vba", "ms-office", "visio"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 10009777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KDXV0Y6miqQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1jNLtoIJVjeZLns6StLEbHYnlhPw/mo/photo.jpg?sz=128", "display_name": "ksbawpn", "link": "https://stackoverflow.com/users/10009777/ksbawpn"}, "edited": false, "score": 0, "creation_date": 1530722084, "post_id": 51177794, "comment_id": 89338410, "body": "Thanks a lot! Do you know how to change the name of the Master shape? I modified an existing shape (i.e. Concentric Layer 1) and added it to my own stencil. I changed the name of the shape in my stencil but I still have to refer to it as Concentric Layer 1 to get the code to work. Could not find the right cell in the ShapeSheet of the master. When I print mst.Name it returns the name which is also shown in the stencil."}, {"owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "reply_to_user": {"reputation": 123, "user_id": 10009777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KDXV0Y6miqQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1jNLtoIJVjeZLns6StLEbHYnlhPw/mo/photo.jpg?sz=128", "display_name": "ksbawpn", "link": "https://stackoverflow.com/users/10009777/ksbawpn"}, "edited": false, "score": 0, "creation_date": 1530727417, "post_id": 51177794, "comment_id": 89340479, "body": "Visio has the concept of local (Name) and universal (NameU) names.  The name you see in the UI is the local name, but in your code you&#39;re using the ItemU.  Spin through your masters colection and report both Name and NameU and you should see the differences, if there are any.  If you want to &#39;reset&#39; then you can set the NameU in code.  Have a look at this post for more details: <a href=\"https://blogs.msdn.microsoft.com/visio/2006/07/27/name-and-nameu/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/visio/2006/07/27/name-and-nameu</a>"}, {"owner": {"reputation": 123, "user_id": 10009777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KDXV0Y6miqQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1jNLtoIJVjeZLns6StLEbHYnlhPw/mo/photo.jpg?sz=128", "display_name": "ksbawpn", "link": "https://stackoverflow.com/users/10009777/ksbawpn"}, "edited": false, "score": 0, "creation_date": 1530795964, "post_id": 51177794, "comment_id": 89365760, "body": "You are right. Thanks to the link I now understand the difference. When I try to change NameU, it returns an error &quot;Requested operation is currently disabled&quot;. I could not find any documentation on wheter there is another way of changing it. (Thanks a lot for all the help I have gotten from you already!)"}, {"owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "reply_to_user": {"reputation": 123, "user_id": 10009777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KDXV0Y6miqQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1jNLtoIJVjeZLns6StLEbHYnlhPw/mo/photo.jpg?sz=128", "display_name": "ksbawpn", "link": "https://stackoverflow.com/users/10009777/ksbawpn"}, "edited": false, "score": 0, "creation_date": 1530799636, "post_id": 51177794, "comment_id": 89368250, "body": "I&#39;m guessing that your target document (stencil) is ReadOnly so you&#39;ll need to right click on the stencil and hit &#39;Edit Stencil&#39; before performing your changes.  You can also do the same thing in code by closing and reopening the stencil in Read-Write mode to edit it.  (This is what Visio does in the background when hitting &#39;Edit Stencil&#39; in the UI).  For the code version you can use <code>Documents.OpenEx &quot;shapes.vssx&quot;, visOpenDocked + visOpenRW</code> however unless you need to to this a lot I would just go through the manual method."}], "tags": [], "owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "is_accepted": true, "score": 3, "last_activity_date": 1530721389, "creation_date": 1530721389, "answer_id": 51177794, "question_id": 51177491, "link": "https://stackoverflow.com/questions/51177491/ms-visio-drop-a-custom-shape-using-vba/51177794#51177794", "title": "MS Visio Drop a custom shape using VBA", "body": "<p>You're looking to drop a <code>Master</code> rather than a <code>Shape</code> so try this modification of your code (untested):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   Dim mst as Visio.Master\n   Dim shp As Visio.Shape\n   Dim pag As Visio.page\n   Set pag = Application.ActiveWindow.Page\n   Set mst = Application.Documents.Item(\"shapes.vssx\").Masters.ItemU(\"ressource\")\n   'You might also want to add some checks that the target document and then master exist\n   Set shp = pag.Drop(mst, 1, 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 10009777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KDXV0Y6miqQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1jNLtoIJVjeZLns6StLEbHYnlhPw/mo/photo.jpg?sz=128", "display_name": "ksbawpn", "link": "https://stackoverflow.com/users/10009777/ksbawpn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 0, "accepted_answer_id": 51177794, "answer_count": 1, "score": 1, "last_activity_date": 1530721389, "creation_date": 1530719982, "question_id": 51177491, "link": "https://stackoverflow.com/questions/51177491/ms-visio-drop-a-custom-shape-using-vba", "title": "MS Visio Drop a custom shape using VBA", "body": "<p>I can't seem to figure out how to drop a shape using VBA.</p>\n\n<p>What I want to do is: The user opens a UserForm and enters something in the TextBoxes. When clicking on the commandbutton I want to load a Shape (i.e. ressource) from a custom stencil (i.e. shapes.vssx) write the User-Entries into the ShapeData (i.e. write a Name string in Props.Name) and then Drop it somewhere on the sheet. I know I have to use the Shape.Drop method but how do I reference the specific Master-Shape I want to use for creating the new shape?</p>\n\n<p>So far I am trying with this</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   Dim shp As Visio.Shape\n   Dim page As Visio.page\n   Set page = Application.ActiveWindow.page\n   Set shp = Application.Documents.Item(\"shapes.vssx\").Masters.ItemU(\"ressource\")\n\n   page.Drop shp, 1, 1\nEnd Sub\n</code></pre>\n\n<p>Which returns a type mismatch. What am I missing?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1530719969, "post_id": 51177344, "comment_id": 89337562, "body": "I noticed a few things in your code - have a look at <a href=\"https://stackoverflow.com/questions/11886284/usedrange-count-counting-wrong\">UsedRange</a> as that may return the wrong number.  Also when you use <code>FIND</code> it&#39;s good practice to check if it found anything - <code>IF NOT zelle2 IS NOTHING THEN</code> will return TRUE if the FIND found anything.  You&#39;ve also not accepted any answers on your previous questions."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530723252, "post_id": 51177344, "comment_id": 89338913, "body": "Count &quot;raws&quot; or count &quot;rows&quot;?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1530726451, "post_id": 51177344, "comment_id": 89340174, "body": "How about some examples of data, actual results and desired results?  And when you post the data, have it in a form that can be used by others (eg: text and NOT a screenshot, which cannot be pasted into an Excel sheet).  There are many ways to count unique instances of data, both in VBA and with worksheet formulas.  Or even with certain varieties of Pivot Tables."}, {"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1530727121, "post_id": 51177344, "comment_id": 89340391, "body": "Derek\u2019s answer at <a href=\"https://stackoverflow.com/questions/18586815/count-unique-values-in-a-column-in-excel\" title=\"count unique values in a column in excel\">stackoverflow.com/questions/18586815/&hellip;</a> would allow you do this without vba. But if you want to use vba, you can get at the sumproduct function through the application."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "edited": false, "score": 0, "creation_date": 1530781766, "post_id": 51186388, "comment_id": 89356504, "body": "i need to do it automatically in VBA)"}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1530778582, "creation_date": 1530778582, "answer_id": 51186388, "question_id": 51177344, "link": "https://stackoverflow.com/questions/51177344/vba-how-do-not-count-rows-or-count-only-once-if-they-have-the-same-parameter/51186388#51186388", "title": "vba how do not count rows (or count only once) if they have the same parameter", "body": "<p>You can sort your data on <code>rating_status2</code> and use subtotals (use the count function), like this you don't even need VBA.</p>\n"}], "owner": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530778582, "creation_date": 1530719439, "last_edit_date": 1530777292, "question_id": 51177344, "link": "https://stackoverflow.com/questions/51177344/vba-how-do-not-count-rows-or-count-only-once-if-they-have-the-same-parameter", "title": "vba how do not count rows (or count only once) if they have the same parameter", "body": "<p>I Need to count rows in column \"rating_status2\" with value \"unclear\" and if they have the same \"customer_nbr\" only once. How it can be done? The structure of the data is following: </p>\n\n<pre><code>rating_status2   customer_nbr\nunclear            1         \nunclear            2\napproved           3\napproved           4\nunclear            1\nunclear            1\nunclear            2\n</code></pre>\n\n<p>Here number of row with value \"unclear\" should be calculated as 2, because  of the same \"customer_nbr\"</p>\n\n<p>my code is below, but it only for counting cells which are \"unclear\". How can i modified it? `</p>\n\n<pre><code>Function Unclear_Rating()\nDim i As Integer\nDim intCounter(1) As Integer\nDim intLastRow As Integer\nDim zelle2 As Range\nDim posMonitoring2 As Integer\nDim zelle3 As Range\nDim posMonitoring3 As Integer\n\nWith Sheets(\"ICS Analysis\")\n\n    Set zelle2 = .Cells.Find(\"rating_status2\", lookat:=xlWhole)\n    posMonitoring2 = zelle2.Column\n    Set zelle3 = .Cells.Find(\"customer_nbr\", lookat:=xlWhole)\n    posMonitoring3 = zelle3.Column\n\n   intLastRow = .UsedRange.Rows.Count\n\n    For i = 2 To intLastRow\n\n            If .Cells(i, posMonitoring2).Value = \"unclear\" Then\n                intCounter(1) = intCounter(1) + 1\n\n            End If\n    Next i\n\n   Unclear_Rating = intCounter\n    End With\nEnd Function`\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1530719418, "post_id": 51177091, "comment_id": 89337277, "body": "As to making your code easier to read: Work with a <code>Range</code> or even a <code>ListFormat</code> object instead of a Selection object and that will make things not only easier to read, but more accurate, more efficient and more pleasant for the user to look at the screen during execution."}, {"owner": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530773322, "post_id": 51177091, "comment_id": 89351622, "body": "I&#39;m not very used to word-vba, I don&#39;t know how to use Range object yet, but I&#39;ll work on it. How do you propose to use them here?   I&#39;ll edit my first post to show the entire code with the <code>With...End With</code> Thanks for your help"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "edited": false, "score": 0, "creation_date": 1530807642, "post_id": 51195416, "comment_id": 89373569, "body": "I tried to avoid looping on all paragraphe with a <code>For Each</code> loop since my document is quite long (I can&#39;t give you more details about it, sorry. It&#39;s a professionnal document that I&#39;m not allowed to talk about here) but maybe this is the most efficient way to do. I&#39;ll try to work out something thanks to the exemple you provided me and let you know if it works. Once again thanks a lot !"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "edited": false, "score": 0, "creation_date": 1530810015, "post_id": 51195416, "comment_id": 89374829, "body": "you&#39;re welcome... The other thought that went through my mind, if you want to target paragraphs formatted with a Heading style, is <code>Find</code> - you can use that to search style formatting. That will let you &quot;jump&quot; to each Heading 1 (or 2, or 3) paragraph."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "edited": false, "score": 0, "creation_date": 1530879782, "post_id": 51195416, "comment_id": 89401367, "body": "@Ezor It (finally) occurred to me that there is a more efficient way to loop: Word can &quot;look at&quot; only paragraphs that have numbering. I&#39;ve edited the Answer with that info."}, {"owner": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "edited": false, "score": 0, "creation_date": 1531121692, "post_id": 51195416, "comment_id": 89459252, "body": "That actually a pretty good solution in this case. It will perfectly do the trick !  FYI, it decreases the amount of comparisons by 16 in some of my documents !"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1530879857, "last_edit_date": 1530879857, "creation_date": 1530805545, "answer_id": 51195416, "question_id": 51177091, "link": "https://stackoverflow.com/questions/51177091/word-macro-doesnt-work-as-soon-as-i-use-with-end-with/51195416#51195416", "title": "Word macro doesn&#39;t work as soon as I use With...End With", "body": "<p>The reason what you've attempted is not working is that <code>With</code> is always referencing <code>Selection.Paragraphs(1).Range</code> <em>at the time this line is called</em> and testing whether the left-most character is \"3\". Since the number at the beginning of that first paragraph never changes, the code doesn't work as you hope. If you put <code>Debug.Print .ListString</code> just before the <code>Wend</code> you can see that it never changes.</p>\n\n<p>Here's a different way to write your code to make it easier to follow, just to give you an idea how to work with a <code>Range</code> object. It loops all the numbered (\"list\") paragraphs in the document and will skip any non-numbered paragraphs. This may not be optimal in your case - since you don't give any details about the document, it's hard to know.</p>\n\n<pre><code>Sub MyMacro()\n    Dim rng As Word.Range\n    Dim paras As Word.ListParagraphs\n    Dim para As Word.Paragraph\n    Dim lvl As Long, listVal As Long\n\n    Set paras = ActiveDocument.ListParagraphs\n\n    For Each para In paras\n        Set rng = para.Range\n        If Left(rng.ListFormat.ListString, 1) = \"3\" Then\n            lvl = rng.ListFormat.ListLevelNumber\n            listVal = rng.ListFormat.ListValue\n            Select Case lvl\n                Case 2\n                    If listVal &lt; 4 Then\n                        Debug.Print \"Case 2: lvl \" &amp; lvl &amp; \"; listVal \" &amp; listVal\n                    End If\n                Case 3\n                    If listVal &lt;&gt; 4 And Left(rng.ListFormat.ListString, 4) = \"3.1.\" Then\n                        Debug.Print \"Case 3: lvl \" &amp; lvl &amp; \"; listVal \" &amp; listVal\n                    End If\n                Case 4\n                    If Left(rng.ListFormat.ListString, 5) = \"3.2.1\" Then\n                        Debug.Print \"Case 4: lvl \" &amp; lvl &amp; \"; listVal \" &amp; listVal\n                    End If\n                Case Else\n                    Debug.Print \"Case else\"\n            End Select\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 51195416, "answer_count": 1, "score": 0, "last_activity_date": 1530879857, "creation_date": 1530718483, "last_edit_date": 1530773506, "question_id": 51177091, "link": "https://stackoverflow.com/questions/51177091/word-macro-doesnt-work-as-soon-as-i-use-with-end-with", "title": "Word macro doesn&#39;t work as soon as I use With...End With", "body": "<p>I've experienced something weird today while making a macro. \nI have a lot of documents using the same template so my macro scan one of them and do some stuff depending on the title (level and number). Anyway, it doesn't realy matter. Here is the code</p>\n\n<pre><code>Private Sub MyMacro()\n     Selection.HomeKey Unit:=wdStory\n\n        While Not (Left(Selection.Paragraphs(1).Range.ListFormat.ListString, 1) = \"3\")  'go to Title n\u00b03\n            Selection.GoTo what:=wdGoToHeading, which:=wdGoToNext\n        Wend\n\n        While ((Left(Selection.Paragraphs(1).Range.ListFormat.ListString, 1) = \"3\"))  'do not go further than title n\u00b03\n            'if the curent title level is 2 and ended with 1,2 or 3 then\n            If Selection.Paragraphs(1).Range.ListFormat.ListLevelNumber = 2 And Selection.Paragraphs(1).Range.ListFormat.ListValue &lt; 4 Then\n                'Do Something\n            ElseIf Selection.Paragraphs(1).Range.ListFormat.ListLevelNumber = 3 And Selection.Paragraphs(1).Range.ListFormat.ListValue &lt;&gt; 4 And Left(Selection.Paragraphs(1).Range.ListFormat.ListString, 4) = \"3.1.\" Then\n                'Do something else\n            ElseIf Selection.Paragraphs(1).Range.ListFormat.ListLevelNumber = 4 And Left(Selection.Paragraphs(1).Range.ListFormat.ListString, 5) = \"3.2.1\" Then\n                'and a last one\n            End If\n            'go to the next title in the document\n            Selection.GoTo what:=wdGoToHeading, which:=wdGoToNext\n        Wend\nEnd Sub\n</code></pre>\n\n<p>This code works but as you can see it's not very easy to read... \nI try to insert a <code>With...End With</code> statement to improve this. </p>\n\n<pre><code>    With Selection.Paragraphs(1).Range.ListFormat\n        'isert here the same code as before with only .ListString and .ListLevelNumber\n    End With\n</code></pre>\n\n<p>Unfortunately, this makes my <code>While</code> loops failed, and I can't figure out why.\nI monitored the outputs and it appears <code>ListString</code> always return the first title (where the macro starts). \nHave you got any idea why? </p>\n\n<p>Thanks a lot in advance</p>\n\n<p>Regards </p>\n\n<p>EDIT : \nThe final code is supposed to look like this</p>\n\n<pre><code>Private Sub MyMacro()\nSelection.HomeKey Unit:=wdStory\n\nWith Selection.Paragraphs(1).Range.ListFormat\n    While Not (Left(.ListString, 1) = \"3\")  'go to Title n\u00b03\n        Selection.GoTo what:=wdGoToHeading, which:=wdGoToNext\n    Wend\n\n    While ((Left(.ListString, 1) = \"3\"))  'do not go further than title n\u00b03\n        'if the curent title level is 2 and ended with 1,2 or 3 then\n        If .ListLevelNumber = 2 And .ListValue &lt; 4 Then\n            'Do Something\n        ElseIf .ListLevelNumber = 3 And .ListValue &lt;&gt; 4 And Left(.ListString, 4) = \"3.1.\" Then\n            'Do something else\n        ElseIf .ListLevelNumber = 4 And Left(.ListString, 5) = \"3.2.1\" Then\n            'and a last one\n        End If\n        'go to the next title in the document\n        Selection.GoTo what:=wdGoToHeading, which:=wdGoToNext\n    Wend\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530717212, "post_id": 51176737, "comment_id": 89336151, "body": "Is your formula used in the worksheet or in your code?"}, {"owner": {"reputation": 1, "user_id": 10032933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k65d37Tlgs4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1dCUA02N4UDGqnZKhfpKeVUavigw/mo/photo.jpg?sz=128", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/10032933/nicholas"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530717266, "post_id": 51176737, "comment_id": 89336192, "body": "It is used in the worksheet"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530717479, "post_id": 51176737, "comment_id": 89336290, "body": "Why do yo need a macro for this? You can just copy that formula down and Excel adjusts the formula automatically. Please provide more background information. What are you actually trying to do? What is the goal behind your question?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530717587, "post_id": 51176737, "comment_id": 89336345, "body": "The simply solution is to modify the formula to use a helper cell to determine the range, <code>=100*((Q$180&#47;INDIRECT(&quot;Q$&quot;&amp;A1,TRUE))-1)</code>"}, {"owner": {"reputation": 1, "user_id": 10032933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k65d37Tlgs4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1dCUA02N4UDGqnZKhfpKeVUavigw/mo/photo.jpg?sz=128", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/10032933/nicholas"}, "edited": false, "score": 0, "creation_date": 1530718042, "post_id": 51176737, "comment_id": 89336585, "body": "So the formulas will remain in the same cells.  Essentially what I am doing is that I have a worksheet that I need to update at the end of every month. I insert a new row above for every month and then these formulas need to be updated by one to link to the new row of data that I make."}, {"owner": {"reputation": 1, "user_id": 10032933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k65d37Tlgs4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1dCUA02N4UDGqnZKhfpKeVUavigw/mo/photo.jpg?sz=128", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/10032933/nicholas"}, "edited": false, "score": 0, "creation_date": 1530718167, "post_id": 51176737, "comment_id": 89336656, "body": "Imagine this, I have rows of data above (one row for every month). At the end of the month, I insert a new row below last month&#39;s data. I have a section below with formulas that calculate data based on the new month&#39;s data. Obviously, with the new row, I must now link these formulas to the new month as they are previously linked to last month&#39;s data. They are all different formulas calculating different things which is why it makes it complicated otherwise I would just update one and then paste special the rest."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "edited": false, "score": 0, "creation_date": 1530719462, "post_id": 51176737, "comment_id": 89337304, "body": "If the number you need to update is the last row of column Q I\u2019ll use indirect to retrieve last row value: =INDIRECT(&quot;Q$&quot;&amp;(MIN(ROW(Q:Q))+ROW(Q:Q)-1))"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530722328, "post_id": 51176737, "comment_id": 89338510, "body": "This doesn&#39;t really help answer your particuar question but if you&#39;re having to do this in the first place I think your worksheet setup could be optimised a little!"}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 9873038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7307104004465b1d5fafe0de28e894a?s=128&d=identicon&r=PG&f=1", "display_name": "Cullen", "link": "https://stackoverflow.com/users/9873038/cullen"}, "is_accepted": false, "score": 0, "last_activity_date": 1530718442, "creation_date": 1530718442, "answer_id": 51177084, "question_id": 51176737, "link": "https://stackoverflow.com/questions/51176737/excel-vba-add-one-to-each-referenced-cell-when-running-macro/51177084#51177084", "title": "Excel VBA - Add one to each referenced cell when running macro", "body": "<p>If you want it to persist when the workbook is closed, you'll need to store your number somewhere in a worksheet. Say it's in Cell(1,1) of Sheets(2), you could use</p>\n\n<pre><code>    dim incVal as integer\n    incVal = cint(Sheets(2).Cells(1,1))+1\n    Sheets(2).Cells(1,1) = incVal\n    dim formula as string\n    formula = \"=100*((Q$\" &amp; incVal &amp; \"/Q$\" &amp; (incVal-12) &amp; \")-1)\"\n</code></pre>\n\n<p>Then just set the desired Cell's formula to that formula. Hope this helps. </p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1530719286, "last_edit_date": 1530719286, "creation_date": 1530718923, "answer_id": 51177208, "question_id": 51176737, "link": "https://stackoverflow.com/questions/51176737/excel-vba-add-one-to-each-referenced-cell-when-running-macro/51177208#51177208", "title": "Excel VBA - Add one to each referenced cell when running macro", "body": "<p>Personally I'd use RegEx to achieve this. The following will increment every cells row by 1 in your formula. This should also work on columns other then <code>Q</code> as well</p>\n\n<pre><code>Option Explicit\nSub IncrementFormula()\n    Dim tmpFormula As String\n    Dim RegEx As Object\n    Dim Match, SubMatch\n\n    tmpFormula = \"=100*((Q$179/Q$167)-1)\"\n\n    Set RegEx = CreateObject(\"vbscript.regexp\")\n    With RegEx\n        .Global = True\n        .Pattern = \"(?:[A-Z]{1,})(?:\\$|)([0-9]{1,})\"\n\n        If .test(tmpFormula) Then\n            For Each Match In .Execute(tmpFormula)\n                For Each SubMatch In Match.submatches\n                    tmpFormula = Replace(tmpFormula, Match, Replace(Match, SubMatch, vbNullString) &amp; CLng(SubMatch) + 1)\n                Next SubMatch\n            Next Match\n        End If\n    End With\n    MsgBox tmpFormula\nEnd Sub\n</code></pre>\n\n<p>Using your formula above it will output <code>=100*((Q$180/Q$168)-1)</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10032933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k65d37Tlgs4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1dCUA02N4UDGqnZKhfpKeVUavigw/mo/photo.jpg?sz=128", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/10032933/nicholas"}, "edited": false, "score": 0, "creation_date": 1530722237, "post_id": 51177273, "comment_id": 89338473, "body": "Thank you very much for this, this solved my problem - did not even need to use VBA."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1530719197, "creation_date": 1530719197, "answer_id": 51177273, "question_id": 51176737, "link": "https://stackoverflow.com/questions/51176737/excel-vba-add-one-to-each-referenced-cell-when-running-macro/51177273#51177273", "title": "Excel VBA - Add one to each referenced cell when running macro", "body": "<p>A different approach is to use <code>OFFSET</code> in your formula</p>\n\n<p>Assuming the formula is in <code>Q185</code></p>\n\n<p>then:</p>\n\n<pre><code>=100*((Q$180/Q$168)-1)\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code> =100*((OFFSET(Q185,-5,0)/OFFSET(Q185,-17,0)-1))\n</code></pre>\n\n<p>As you insert rows at the bottom of the table (and above the formulas), the formula and the cell it refers to will also move down</p>\n"}], "owner": {"reputation": 1, "user_id": 10032933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k65d37Tlgs4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1dCUA02N4UDGqnZKhfpKeVUavigw/mo/photo.jpg?sz=128", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/10032933/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1530729830, "creation_date": 1530717064, "last_edit_date": 1531161705, "question_id": 51176737, "link": "https://stackoverflow.com/questions/51176737/excel-vba-add-one-to-each-referenced-cell-when-running-macro", "title": "Excel VBA - Add one to each referenced cell when running macro", "body": "<p>I have tried searching for the answer for the past couple hours but cannot seem to find what I am looking for - mind you, I am really new to VBA and macros.</p>\n\n<p>What I am trying to do is to add one to what my formula is referencing to every time the macro is run. For example:</p>\n\n<p>Currently the formula is <code>=100*((Q$179/Q$167)-1)</code></p>\n\n<p>When run, I would like it to be <code>=100*((Q$180/Q$168)-1)</code></p>\n\n<p>I have to do this for multiple formulas. Is there an easy way to do this with a macro?</p>\n\n<p>Thank you so much in advance</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530717267, "post_id": 51176642, "comment_id": 89336193, "body": "Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!  This doesn&#39;t need VBA -- you just need to add the query listing the addresses to the <code>FROM</code> list on this query, either with a <code>JOIN</code> or a comma, then use the field name containing the addresses in your <code>WHERE</code> clause. Here is <a href=\"https://support.office.com/en-us/article/nest-a-query-inside-another-query-or-in-an-expression-by-using-a-subquery-a8532322-e42f-4f94-bc38-ace7c182916a\" rel=\"nofollow noreferrer\">related info</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1530717674, "post_id": 51176642, "comment_id": 89336393, "body": "Should you be selecting from <code>SubQuery</code> rather than <code>EverythingCMDB</code>? Your <code>FROM</code> argument is aliased as <code>SubQuery</code>."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1530724803, "post_id": 51176642, "comment_id": 89339536, "body": "What is your end goal? Why do you need say 50+ queries each with different addresses?"}, {"owner": {"reputation": 1, "user_id": 10032918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60612304fadda9813cb06cfd5df6baee?s=128&d=identicon&r=PG&f=1", "display_name": "sysadmin55", "link": "https://stackoverflow.com/users/10032918/sysadmin55"}, "edited": false, "score": 0, "creation_date": 1530726130, "post_id": 51176642, "comment_id": 89340056, "body": "I&#39;m trying to get the number of people per department at each location; each location having its own query. Although it&#39;s called EverythingCMDB.company, it should be aliased as department, as that&#39;s what it is. This query works perfectly for each location I&#39;ve done manually, I just need to find a way to automatically create new queries and change the addresses as prescribed by another query that holds distinct addresses."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1531173566, "post_id": 51176642, "comment_id": 89488087, "body": "@sysadmin55: everybody has valid points here. ashleedawg is right: you don&#39;t need 50 different queries to do this. Darren is right that you should alias the subquery properly. But, nothing in your last comment seems to answer the question of why you need separate queries. Is there some other requirement we don&#39;t know about?"}], "owner": {"reputation": 1, "user_id": 10032918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60612304fadda9813cb06cfd5df6baee?s=128&d=identicon&r=PG&f=1", "display_name": "sysadmin55", "link": "https://stackoverflow.com/users/10032918/sysadmin55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530726417, "creation_date": 1530716771, "last_edit_date": 1530726417, "question_id": 51176642, "link": "https://stackoverflow.com/questions/51176642/vba-script-to-create-queries-based-on-entries-in-an-existing-table-query", "title": "VBA script to create Queries based on entries in an existing table/Query", "body": "<p>I have the following SQL code:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT  EverythingCMDB.company\n        , COUNT(EverythingCMDB.company) AS People \nFROM    (\n         SELECT DISTINCT    EverythingCMDB.MacAddress\n                            , EverythingCMDB.company\n                            , Monthly.street\n                            , Monthly.MacVendor \n         FROM   EverythingCMDB INNER JOIN Monthly ON EverythingCMDB.MacAddress = Monthly.MAC \n         WHERE  Monthly.street =\"222 Testing AVE\" AND \n                EverythingCMDB.company &lt;&gt; NULL\n        )  \nGROUP BY EverythingCMDB.company;\n</code></pre>\n\n<p>I also have a query called <em>AllAddresses</em>. This query has 1 column containing all distinct addresses from the <em>Monthly</em> table.   </p>\n\n<p>Is there any way to create a VBA script that creates a query for all the addresses in my above query?</p>\n\n<p>In a sense, the <code>Monthly.street =\"222 Testing AVE\"</code> will be changed in order to create a unique count for each location (<em>\"222 Testing AVE\"</em> will change to <em>\"123 Fake Street\"</em> in the new query, as that is an address in the <em>AllAddresses</em> query).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["python", "vba", "http", "ssl", "python-requests"], "answers": [{"comments": [{"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1530795566, "post_id": 51180696, "comment_id": 89365472, "body": "Thanks Steffen, this was my guess as well. However, I tried exporting the certificate in all available formats and used it with requests as per documentation: <code>cert=cert_path</code>, but I get <code>Error: [(&#39;PEM routines&#39;, &#39;PEM_read_bio&#39;, &#39;no start line&#39;), (&#39;SSL routines&#39;, &#39;SSL_CTX_use_PrivateKey_file&#39;, &#39;PEM lib&#39;)]. </code> Do you possibly know why?"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 1, "creation_date": 1530802955, "post_id": 51180696, "comment_id": 89370652, "body": "@barciewicz: it looks like the format is wrong. It should be a PEM file with both certificate and subject, i.e. should be base64 with delimiters like <code>-----BEGIN CERTIFICATE-----</code> and <code>-----BEGIN PRIVATE KEY-----</code>."}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1530867198, "post_id": 51180696, "comment_id": 89393853, "body": "Thanks Steffen. The format is .cer, so it is a PEM file. However, while exporting the certificate, the option to export private key as well is not available. So there is BEGIN CERTIFICATE in the file, but no BEGIN PRIVATE KEY. Do you think this might be the issue?"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 1, "creation_date": 1530873163, "post_id": 51180696, "comment_id": 89397579, "body": "@barciewicz: To authenticate with a client certificate you need both the (public) certificate and the private key."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": false, "score": 2, "last_activity_date": 1530738023, "creation_date": 1530738023, "answer_id": 51180696, "question_id": 51176474, "link": "https://stackoverflow.com/questions/51176474/ssl-certificate-error-in-python-requests-module-but-not-in-vba/51180696#51180696", "title": "SSL certificate error in Python requests module, but not in VBA", "body": "<blockquote>\n  <p>SSLError: (\"bad handshake: Error([('SSL routines', 'ssl3_read_bytes', 'sslv3 alert bad certificate')],)\",)</p>\n</blockquote>\n\n<p>This likely means that the server is expecting you to authenticate with a client certificate. My guess is that the specific certificate is in the Windows certificate store and will be automatically used by your VB script the same as it is used automatically by the browser. Only, Python does not use the windows certificate store. This mean you need to somehow extract the specific certificates from the store and use these explicitly as client certificates in your Python program <a href=\"http://docs.python-requests.org/en/master/user/advanced/#client-side-certificates\" rel=\"nofollow noreferrer\">as documented</a>.</p>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530738023, "creation_date": 1530716199, "question_id": 51176474, "link": "https://stackoverflow.com/questions/51176474/ssl-certificate-error-in-python-requests-module-but-not-in-vba", "title": "SSL certificate error in Python requests module, but not in VBA", "body": "<p>I am trying to send a request to company's intranet page like below:</p>\n\n<pre><code>import requests\n\nhttp_proxy  = 'some_proxy1'\nhttps_proxy = 'some_proxy2'\nURL = 'some_url'\n\n\nproxyDict = { \n              \"http\"  : some_proxy1, \n              \"https\" : some_proxy2\n            }\n\nresponse = requests.get(some_url, proxies=proxyDict, verify=False)\n</code></pre>\n\n<p>Even though <code>verify</code> is set to <code>False</code>, I get </p>\n\n<p><code>SSLError: (\"bad handshake: Error([('SSL routines', 'ssl3_read_bytes', 'sslv3 alert bad certificate')],)\",)</code></p>\n\n<p>The code works fine for external pages.</p>\n\n<p>Strangely, I tried same request (but without proxies) through VBA, and it works:</p>\n\n<pre><code>Sub request()\n\nSet objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\nURL = \"some_url\"\nobjHTTP.Open \"GET\", URL, False\nobjHTTP.send\nDebug.Print objHTTP.responseText\n\nend sub\n</code></pre>\n\n<p>Is there anything I can do to make the Python code work?</p>\n\n<p>And why does VBA not have a problem with SSL certificate? Is it because it somehow knows it beforehand - since it is native to Windows - and no verification is required?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1530715862, "post_id": 51176263, "comment_id": 89335436, "body": "This may help: <a href=\"https://stackoverflow.com/questions/18020670/excel-vba-how-to-insert-values-only\">https://stackoverflow.com/questions/18020670/excel-vba-how-t&zwnj;&#8203;o-insert-values-only</a>"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1530716863, "post_id": 51176263, "comment_id": 89335963, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18020670/excel-vba-how-to-insert-values-only\">Excel VBA - How to insert values only?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8376194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d68f1ef87f251493e75c84ce6a3151?s=128&d=identicon&r=PG&f=1", "display_name": "noobie", "link": "https://stackoverflow.com/users/8376194/noobie"}, "edited": false, "score": 0, "creation_date": 1530716433, "post_id": 51176433, "comment_id": 89335723, "body": "I need it to insert rows and paste values."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 3, "last_activity_date": 1530719850, "last_edit_date": 1530719850, "creation_date": 1530716061, "answer_id": 51176433, "question_id": 51176263, "link": "https://stackoverflow.com/questions/51176263/insert-copied-cell-values-vba/51176433#51176433", "title": "insert copied cell values [vba]", "body": "<p>Or bypass the clipboard entirely:</p>\n\n<pre><code>Sheets(\"Invoice Data\").Range(\"A14:H\" &amp; LastRow + 11).Value = Sheets(\"Driver\").Range(\"A3:H\" &amp; LastRow).Value\n</code></pre>\n\n<p>To bypass the clipboard and insert rows use:</p>\n\n<pre><code>Sheets(\"Invoice Data\").Rows(\"14:\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nSheets(\"Invoice Data\").Range(\"A14:H\" &amp; LastRow + 11).Value = Sheets(\"Driver\").Range(\"A3:H\" &amp; LastRow).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8376194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d68f1ef87f251493e75c84ce6a3151?s=128&d=identicon&r=PG&f=1", "display_name": "noobie", "link": "https://stackoverflow.com/users/8376194/noobie"}, "edited": false, "score": 0, "creation_date": 1530719929, "post_id": 51176585, "comment_id": 89337548, "body": "Thank you works great. Except if I have 4 rows of data, it pastes only 3"}, {"owner": {"reputation": 15, "user_id": 8376194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d68f1ef87f251493e75c84ce6a3151?s=128&d=identicon&r=PG&f=1", "display_name": "noobie", "link": "https://stackoverflow.com/users/8376194/noobie"}, "edited": false, "score": 0, "creation_date": 1530720473, "post_id": 51176585, "comment_id": 89337773, "body": "Like a charm. Thank you"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1530720013, "last_edit_date": 1530720013, "creation_date": 1530716579, "answer_id": 51176585, "question_id": 51176263, "link": "https://stackoverflow.com/questions/51176263/insert-copied-cell-values-vba/51176585#51176585", "title": "insert copied cell values [vba]", "body": "<p>Try using something like the following:</p>\n\n<pre><code>Sub create_payroll()\n    'copies values from 'Driver' Worksheet (till last row) and pastes values into Invoice Data A14\n    Dim LastRow As Long\n    Dim srcRng As Range\n    Application.ScreenUpdating = False\n\n    With Sheets(\"Driver\")\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        Set srcRng = .Range(\"A3:H\" &amp; LastRow)\n    End With\n\n\n    With Sheets(\"Invoice Data\")\n        .Range(\"A14\").Resize(srcRng.Rows.Count - 1, srcRng.Columns.Count).Insert shift:=xlDown\n        .Range(\"A14\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8376194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d68f1ef87f251493e75c84ce6a3151?s=128&d=identicon&r=PG&f=1", "display_name": "noobie", "link": "https://stackoverflow.com/users/8376194/noobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 0, "accepted_answer_id": 51176585, "answer_count": 2, "score": 1, "last_activity_date": 1530720013, "creation_date": 1530715485, "last_edit_date": 1530716483, "question_id": 51176263, "link": "https://stackoverflow.com/questions/51176263/insert-copied-cell-values-vba", "title": "insert copied cell values [vba]", "body": "<p>I have the following code it copies a certain range and paste inserts it in the next worksheet, but it copies formulas, I want it to insert the amount of rows copied and paste values only.</p>\n\n<pre><code>Sub create_payroll()\n'copies values from 'Driver' Worksheet (till last row) and pastes values into Invoice Data A14\nDim LastRow As Long\nApplication.ScreenUpdating = False\nLastRow = Worksheets(\"Driver\").Cells(Rows.Count, \"B\").End(xlUp).Row\nSheets(\"Driver\").Range(\"A3:H\" &amp; LastRow).Copy\nSheets(\"Invoice Data\").Range(\"A14\").Insert xlShiftDown\n</code></pre>\n"}, {"tags": ["excel", "vba", "text", "cell"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1530728771, "post_id": 51176211, "comment_id": 89340930, "body": "You can collect the features and values in a dictionary, allowing you to combine the values where the features are the same.  Or you can just use <code>Power Query</code> if you have Excel 2010 or later, and have a routine that you can use to refresh (or replace) the downloaded data."}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530716183, "creation_date": 1530716183, "answer_id": 51176469, "question_id": 51176211, "link": "https://stackoverflow.com/questions/51176211/how-to-search-a-text-file-for-multiple-matching-strings-and-put-the-sum-value-in/51176469#51176469", "title": "How to search a text file for multiple matching strings and put the sum value in to an Excel cell", "body": "<p>It sounds like you need a function to count the occurences of a substring.</p>\n\n<pre><code>Function CountOccurences(ByVal Text As String, ByVal SearchString As String) As Long\n    Dim length As Long\n    length = Len(Text) - Len(Replace(Text, SearchString, \"\"))\n    CountOccurences = length / Len(SearchString)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10032701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OPtUjf6y7fo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0qboYhxLdhl5qBCKSP0_4ozev4gA/mo/photo.jpg?sz=128", "display_name": "Pete Richardson", "link": "https://stackoverflow.com/users/10032701/pete-richardson"}, "edited": false, "score": 0, "creation_date": 1530795688, "post_id": 51176830, "comment_id": 89365565, "body": "this is great. What I believe I need to do is work on the <code>.pattern</code> in the rgx function. In truth the lines in the text file have a bit more rubbish in them. So instead of them being <b>FEATURE_A X</b> where X is the value I want to pull out, they are actually something like <b>FEATURE_A DATE RUBBISH X</b>. Been flicking through <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference\" rel=\"nofollow noreferrer\">here</a> I think the answer is there somewhere!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 10032701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OPtUjf6y7fo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0qboYhxLdhl5qBCKSP0_4ozev4gA/mo/photo.jpg?sz=128", "display_name": "Pete Richardson", "link": "https://stackoverflow.com/users/10032701/pete-richardson"}, "edited": false, "score": 0, "creation_date": 1530796336, "post_id": 51176830, "comment_id": 89366020, "body": "You should be able to build a pattern that includes one or more oprional words between FEATURES and the digit you are retrieving."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1530717420, "creation_date": 1530717420, "answer_id": 51176830, "question_id": 51176211, "link": "https://stackoverflow.com/questions/51176211/how-to-search-a-text-file-for-multiple-matching-strings-and-put-the-sum-value-in/51176830#51176830", "title": "How to search a text file for multiple matching strings and put the sum value in to an Excel cell", "body": "<p>This is a pretty rudimentary RegEx pattern but it fulfills your sample requirements.</p>\n\n<pre><code>Sub Macro3()\n    Dim myFile As String, txt As String, txtl As String\n    Dim i As Long, features As Variant\n\n    myFile = \"C:\\test\\input.txt\"\n\n    Open myFile For Input As #1\n    Do Until EOF(1)\n        Line Input #1, txtl\n        txt = txt &amp; txtl\n    Loop\n    Close #1\n\n    features = Array(\"FEATURE_A\", \"FEATURE_B\", \"FEATURE_C\")\n\n    With Worksheets(\"sheet2\")\n        For i = LBound(features) To UBound(features)\n            .Cells(1, \"A\").Offset(i, 0).Resize(1, 2) = _\n                Array(features(i), sumFeatures(CStr(features(i)), txt))\n        Next i\n    End With\n\nEnd Sub\n\nFunction sumFeatures(f As String, t As String) As Double\n    Dim n As Long\n    Static rgx As Object, cmat As Object\n\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n\n    sumFeatures = 0\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = f &amp; \" \\d\"\n        If .Test(t) Then\n            Set cmat = .Execute(t)\n            'sum the matches\n            For n = 0 To cmat.Count - 1\n                sumFeatures = sumFeatures + _\n                    CDbl(Replace(cmat.Item(n), f, vbNullString, 1, 1, vbTextCompare))\n            Next n\n        End If\n    End With\n\nEnd Function\n\nFEATURE_A   1\nFEATURE_B   4\nFEATURE_C   13\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10032701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OPtUjf6y7fo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0qboYhxLdhl5qBCKSP0_4ozev4gA/mo/photo.jpg?sz=128", "display_name": "Pete Richardson", "link": "https://stackoverflow.com/users/10032701/pete-richardson"}, "edited": false, "score": 0, "creation_date": 1530795797, "post_id": 51179017, "comment_id": 89365638, "body": "This is really interesting, I didn&#39;t know this was in Excel actually!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 35, "user_id": 10032701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OPtUjf6y7fo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0qboYhxLdhl5qBCKSP0_4ozev4gA/mo/photo.jpg?sz=128", "display_name": "Pete Richardson", "link": "https://stackoverflow.com/users/10032701/pete-richardson"}, "edited": false, "score": 0, "creation_date": 1530814389, "post_id": 51179017, "comment_id": 89376902, "body": "@PeteRichardson <code>Power Query</code> is a free, Microsoft supplied add-in for Excel 2010 and later.  <code>Get &amp; Transform</code> is included with Excel 2016."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1530728678, "last_edit_date": 1530728678, "creation_date": 1530727559, "answer_id": 51179017, "question_id": 51176211, "link": "https://stackoverflow.com/questions/51176211/how-to-search-a-text-file-for-multiple-matching-strings-and-put-the-sum-value-in/51179017#51179017", "title": "How to search a text file for multiple matching strings and put the sum value in to an Excel cell", "body": "<p>No real need for VBA.  In Excel 2010+ you can use <code>Power Query</code>  (AKA <code>Get&amp;Transform</code> in 2016).  And all this can be done via the GUI</p>\n\n<ul>\n<li>Define your source</li>\n<li><p>Group the rows by column 1</p>\n\n<ul>\n<li>Sum Column 1</li>\n</ul></li>\n<li><p>Merge the two columns with some spaces as the separator</p></li>\n</ul>\n\n<p>Here is the M code, but, as I wrote above, you can do this using the Power Query Editor:</p>\n\n<pre><code>let\n    Source = Csv.Document(File.Contents(\"C:\\Users\\Ron\\Desktop\\Input.txt\"),2,\"\",null,1252),\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}, {\"Column2\", Int64.Type}}),\n    #\"Grouped Rows\" = Table.Group(#\"Changed Type\", {\"Column1\"}, {{\"Count\", each List.Sum([Column2]), type number}}),\n    #\"Merged Columns\" = Table.CombineColumns(Table.TransformColumnTypes(#\"Grouped Rows\", {{\"Count\", type text}}, \"en-US\"),{\"Column1\", \"Count\"},Combiner.CombineTextByDelimiter(\"   \", QuoteStyle.None),\"Feature Sums\")\nin\n    #\"Merged Columns\"\n</code></pre>\n\n<p>You now have a query which you can apply repeatedly to the file.  Either \"refreshing\" if new data is added, or replacing if that is what you want to do.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l3f9z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l3f9z.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 10032701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OPtUjf6y7fo/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0qboYhxLdhl5qBCKSP0_4ozev4gA/mo/photo.jpg?sz=128", "display_name": "Pete Richardson", "link": "https://stackoverflow.com/users/10032701/pete-richardson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 51176830, "answer_count": 3, "score": 3, "last_activity_date": 1530728678, "creation_date": 1530715283, "question_id": 51176211, "link": "https://stackoverflow.com/questions/51176211/how-to-search-a-text-file-for-multiple-matching-strings-and-put-the-sum-value-in", "title": "How to search a text file for multiple matching strings and put the sum value in to an Excel cell", "body": "<p>This is probably reasonably simple - I'm trying to write a VBA code that will run through a given text file and collate the values for a given string and then add that in to a cell on my excel spreadsheet.</p>\n\n<p>I have succeeded in the first instance in that I can get the VBA script to read the text file and enter the value for a matching string. However, the issue I have is there are some strings which appear more than once. What I want the code to do is to add all the values it finds for that given value together and put that number in the cell. </p>\n\n<p>This is an example of the code I have written so far -</p>\n\n<pre><code>Dim myFile As String, text As String, textline As String\n\nmyFile = \"C:\\Support\\test\\input.txt\"\n\nOpen myFile For Input As #1\nDo Until EOF(1)\n    Line Input #1, textline\n    text = text &amp; textline\nLoop\nClose #1\n\n'FEATURES\nFeatureA = InStr(text, \"FEATURE_A\")\nFeatureB = InStr(text, \"FEATURE_B\")\nFeatureC = InStr(text, \"FEATURE_C\")\n\nRange(\"a1\").Value = Mid(text, FeatureA + 9, 3)\nRange(\"a2\").Value = Mid(text, FeatureB + 9, 3)\nRange(\"a3\").Value = Mid(text, FeatureC + 9, 3)\n\nEnd Sub\n</code></pre>\n\n<p>I guess I need it to loop around to add the values together but not sure how to do that. So if the dataset looks like the one below, at current my code will pick up the first match and put that value in the cell, it won't continue on the rest of the list. For Feature_C it will only pick up '4' as the value, as opposed to adding all the values it finds for the matching string (4+9)</p>\n\n<p>Example txt -</p>\n\n<pre><code>FEATURE_A 1\nFEATURE_B 4\nFEATURE_C 4\nFEATURE_C 9\n</code></pre>\n\n<p>Hope that makes sense, and thanks in advance for the help/suggestions. </p>\n"}, {"tags": ["vba", "cell", "powerpoint"], "comments": [{"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1530769169, "post_id": 51176203, "comment_id": 89349807, "body": "foundText1 returns a TextRange object, so you should be checking if the object is nothing or not prior to checking against the text value."}, {"owner": {"reputation": 1, "user_id": 9497641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8949c0944a8db31ab6bf30d5fe6c9c9?s=128&d=identicon&r=PG&f=1", "display_name": "martinLB", "link": "https://stackoverflow.com/users/9497641/martinlb"}, "reply_to_user": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1530775068, "post_id": 51176203, "comment_id": 89352641, "body": "Thanks for this quick reply but I tried it already with the function :      - Do While Not (foundText1 Is Nothing)     - Loop  But my application crashed .."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9497641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8949c0944a8db31ab6bf30d5fe6c9c9?s=128&d=identicon&r=PG&f=1", "display_name": "martinLB", "link": "https://stackoverflow.com/users/9497641/martinlb"}, "is_accepted": false, "score": 0, "last_activity_date": 1530781649, "creation_date": 1530781649, "answer_id": 51187385, "question_id": 51176203, "link": "https://stackoverflow.com/questions/51176203/find-string-in-table-vba-powerpoint/51187385#51187385", "title": "Find string in table VBA Powerpoint", "body": "<p>I found the solution !!</p>\n\n<p>For those who're lost with this same problem, here is my code:</p>\n\n<pre><code>Public Sub CreateTable1()\n' d\u00e9claration of variables\nDim objSld As Slide\nDim objShp As Shape\nDim foundText1 As Object\nDim TextRng As TextRange\nDim FindWhat As String\nDim I As Integer\nDim j As Integer\n\nSet objSld = ActivePresentation.Slides(8)\nSet objShp = objSld.Shapes.AddTable(3, 3, 15, 150, 700, 500)\n\n' Give a name to table\n objShp.Name = \"Table1\"\n\n' Define size of cells\nWith objSld.Shapes(\"Table1\").Table\n    .Columns(1).Width = 115\n    .Columns(2).Width = 115\n    .Columns(3).Width = 115\n    .Rows(1).Height = 120\n    .Rows(2).Height = 120\n    .Rows(3).Height = 120\n\n    'Write in cells\n    With .Cell(1, 1).Shape.TextFrame\n        .TextRange.Text = \"Composition\"\n    End With\n    With .Cell(2, 1).Shape.TextFrame\n        .TextRange.Text = \"Material\"\n    End With\n    With .Cell(3, 1).Shape.TextFrame\n        .TextRange.Text = \"Method\"\n    End With\n\n' Define text position\n    For I = 1 To 3\n        For j = 1 To 3\n            With .Cell(j, I).Shape.TextFrame\n                .VerticalAnchor = msoAnchorMiddle\n                .HorizontalAnchor = msoAnchorCenter\n                .TextRange.Font.Size = 18\n            End With\n        Next j\n    Next I\n\n'Command find\n'Browse row 1 from line 1 to 3\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Creation of a second sub to understand where does script failed\n    Sub yolo()</p>\n\n<pre><code>Dim objSld As Slide\nDim oTbl As Table\nDim lRow As Long\nDim lCol As Long\nDim foundText1 As Object\nSet objSld = ActivePresentation.Slides(8)\n\nSet oTbl = objSld.Shapes(\"Table1\").Table\nWith oTbl\n\n    For lRow = 1 To .Rows.Count\n            With .Cell(lRow, 1).Shape\n\n               'Do something with each cell's text\n               'Does this shape has text?\n                If .HasTextFrame Then\n                    Set TextRng = oTbl.Cell(lRow, 1).Shape.TextFrame.TextRange\n                        Set foundText1 = TextRng.Find(FindWhat:=\"Comp\")\n                        Do While Not (foundText1 Is Nothing)\n                            With foundText1\n                                oTbl.Cell(lRow, 2).Shape.TextFrame.TextRange.Text = \"OK\"\n                                Set foundText1 = TextRng.Find(FindWhat:=\"Comp\", After:=.Start + .Length - 1)\n                            End With\n                        Loop\n                End If\n            End With\n        Next lRow\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9497641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8949c0944a8db31ab6bf30d5fe6c9c9?s=128&d=identicon&r=PG&f=1", "display_name": "martinLB", "link": "https://stackoverflow.com/users/9497641/martinlb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530781649, "creation_date": 1530715259, "last_edit_date": 1530728180, "question_id": 51176203, "link": "https://stackoverflow.com/questions/51176203/find-string-in-table-vba-powerpoint", "title": "Find string in table VBA Powerpoint", "body": "<p>After 2 days trying to find a solution to my problem, I need your help please.\nI'm working on powerpoint VBA script, and I've got a Table (3,3). In the row 1, I've already input some string in cells. </p>\n\n<p>I want to know why my script doesn't want to write NOK in cells when the string does'nt match \"comp\" for example</p>\n\n<p>Here is my VBA script:</p>\n\n<pre><code>Public Sub CreateTable1()\n' d\u00e9claration of variables\nDim objSld As Slide\nDim objShp As Shape\nDim foundText1 As Object\nDim FindWhat As String\nDim I As Integer\nDim j As Integer\n\nSet objSld = ActivePresentation.Slides(1)\nSet objShp = objSld.Shapes.AddTable(3, 3, 15, 150, 700, 500)\n\n' Give a name to table\nobjShp.Name = \"Table1\"\n\n' Define size of cells\nWith objSld.Shapes(\"Table1\").Table\n    .Columns(1).Width = 115\n    .Columns(2).Width = 115\n    .Columns(3).Width = 115\n    .Rows(1).Height = 120\n    .Rows(2).Height = 120\n    .Rows(3).Height = 120\n\n    'Write in cells\n    With .Cell(1, 1).Shape.TextFrame\n        .TextRange.Text = \"Composition\"\n    End With\n    With .Cell(2, 1).Shape.TextFrame\n        .TextRange.Text = \"Material\"\n    End With\n    With .Cell(3, 1).Shape.TextFrame\n        .TextRange.Text = \"Method\"\n    End With\n\n' Define text position\n    For I = 1 To 3\n        For j = 1 To 3\n            With .Cell(j, I).Shape.TextFrame\n                .VerticalAnchor = msoAnchorMiddle\n                .HorizontalAnchor = msoAnchorCenter\n                .TextRange.Font.Size = 18\n            End With\n        Next j\n    Next I\n\n'Command find\n'Browse row 1 from line 1 to 3\nFor x = 1 To 3\n    Set foundText1 = objSld.Shapes(\"Table1\").Table.Cell(x, 1).Shape.TextFrame.TextRange.Find(FindWhat:=\"Comp\")\n    If foundText1 = \"Comp\" Then\n        'MsgBox foundText1 &amp; x\n        'Will write in cell (x,2) OK and x\n        objSld.Shapes(\"Table1\").Table.Cell(x, 2).Shape.TextFrame.TextRange.Text = \"OK \" &amp; x\n    Else\n   'Will write in cell (x,2) NOK and x\n    'Doesn't works !! Why??\n        objSld.Shapes(\"Table1\").Table.Cell(x, 2).Shape.TextFrame.TextRange.Text = \"NOK \" &amp; x\n    End If\nNext x\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I Would like to know if you see where is the mistake. The function Else seems not working.. </p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 3, "last_activity_date": 1530717014, "creation_date": 1530717014, "answer_id": 51176722, "question_id": 51175851, "link": "https://stackoverflow.com/questions/51175851/vba-check-if-the-values-from-one-column-are-present-in-the-other-and-if-so-tran/51176722#51176722", "title": "VBA check if the values from one column are present in the other and if so, transfer associated data", "body": "<p>Collections are ideal for matching unique identifiers.  My code stores cells references along with the unique IDs to simplify the tasks.</p>\n\n<pre><code>Sub MovenMatch2()\n    Dim cell As Range, dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With ThisWorkbook.Worksheets(\"Tab1\")\n        For Each cell In .Range(\"A2\", .Range(\"A\" &amp; .Rows.count).End(xlUp))\n            Set dict(cell.Value) = cell\n        Next\n    End With\n\n    With ThisWorkbook.Worksheets(\"Tab0\")\n        For Each cell In .Range(\"A2\", .Range(\"A\" &amp; .Rows.count).End(xlUp))\n            If dict.Exists(cell.Value) Then\n                dict(cell.Value).Resize(1, 4).Value = cell.Resize(1, 4).Value\n            Else\n                With ThisWorkbook.Worksheets(\"Tab1\")\n                    .Range(\"A\" &amp; .Rows.count).End(xlUp).Offset(1).Resize(1, 4).Value = cell.Resize(1, 4).Value\n                End With\n            End If\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 51176722, "answer_count": 1, "score": 2, "last_activity_date": 1530717014, "creation_date": 1530713969, "question_id": 51175851, "link": "https://stackoverflow.com/questions/51175851/vba-check-if-the-values-from-one-column-are-present-in-the-other-and-if-so-tran", "title": "VBA check if the values from one column are present in the other and if so, transfer associated data", "body": "<p>The code I have (below) does the job to an extent. My question is, how do I get the data in col B, C and D, to match the transfer to Tab1. </p>\n\n<p>At the moment, the code looks at the values in the column A in Tab0, then checks whether any of them are present in col A in Tab 1 and if some are not there, it adds them on the bottom.</p>\n\n<p><a href=\"https://i.stack.imgur.com/D5Xwy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D5Xwy.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My current code:</p>\n\n<pre><code>Sub MovenMatch()\n\nDim varfirst1 As Range, varsecond2 As Range\nDim n&amp;, m&amp;\nDim first1 As Range, second2 As Range\nDim rowCount1&amp;, rowCount2&amp;\nDim mFlag As Boolean\n\nrowCount1 = Sheets(\"Tab0\").Cells(Sheets(\"Tab0\").Rows.Count, \"A\").End(xlUp).Row\nrowCount2 = Sheets(\"Tab1\").Cells(Sheets(\"Tab1\").Rows.Count, \"A\").End(xlUp).Row\n\nSet varfirst1 = Sheets(\"Tab0\").Range(\"A2:A\" &amp; rowCount1)\nSet varsecond2 = Sheets(\"Tab1\").Range(\"A2:A\" &amp; rowCount2)\nm = rowCount2 + 1\n\nFor Each first1 In varfirst1\n    mFlag = False\n    For Each second2 In varsecond2\n        If CStr(first1) = CStr(second2) Then\n            mFlag = True\n            Exit For\n        End If\n    Next second2\n\n    If mFlag = False Then\n        Sheets(\"Tab1\").Range(\"A\" &amp; m).Value = first1\n</code></pre>\n\n<p><strong>'My assumption is that the fix should come around here, replacing <code>\"xyz\"</code>:</strong></p>\n\n<pre><code>    Sheets(\"Tab1\").Range(\"B\" &amp; m).Value = \"xyz\"\n\n\n    m = m + 1\nEnd If\n\nNext first1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "url", "sharepoint-2010"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530728198, "post_id": 51177719, "comment_id": 89340714, "body": "Thank you!! I changed the folder path to what you have suggested since they are all in the same folder, however it is stating there is now an issue with the File Name (error 52). Do you know if there is something else I am doing wrong?"}, {"owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "reply_to_user": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530728950, "post_id": 51177719, "comment_id": 89340994, "body": "Try using <code>Debug.Print(Filename)</code> in the line below <code>Filename = Dir(FolderPath&amp; &quot;*.xls*&quot;)</code> to see what file is giving the error. I don&#39;t know if you are familiar  with Debug.Print, but it will print in the Immediate window (Ctrl+G in VBA Editor)."}, {"owner": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530729450, "post_id": 51177719, "comment_id": 89341195, "body": "Sorry and a issue with Workbooks(Filename).Close (Error 9)"}, {"owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "reply_to_user": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530730953, "post_id": 51177719, "comment_id": 89341705, "body": "Did you try adding <code>SaveChanges:=False</code> after .Close? I was wondering what happens when it gets to the open workbook?"}, {"owner": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530732119, "post_id": 51177719, "comment_id": 89342011, "body": "Hi Blake, I tried running it with the Debug.Print(Filename) however it is still stating the file name is incorrect and would not run.                                                        FolderPath = ActiveWorkbook.Path &amp; &quot;\\&quot; Filename = Dir(FolderPath &amp; &quot;*.xls&quot;)"}, {"owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "reply_to_user": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530732683, "post_id": 51177719, "comment_id": 89342168, "body": "Are all of the excel files in a newer excel format like *.xlsx or are they *.xls format? The issue here is in how the wildcard is used to select the files."}, {"owner": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530734599, "post_id": 51177719, "comment_id": 89342763, "body": "They are all xlsx. However if I change the extension the error persists. Should I remove the * as well?"}, {"owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "reply_to_user": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530736018, "post_id": 51177719, "comment_id": 89343209, "body": "Change <code>Filename = Dir(FolderPath &amp; &quot;*.xlsx&quot;)</code> and see if there is one file that is causing the error by looking at the immediate window in the VBA editor."}, {"owner": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "edited": false, "score": 0, "creation_date": 1530744484, "post_id": 51177719, "comment_id": 89345375, "body": "I dont think the Dir() is working, I tried changing the filename, but I still get the Error 52."}], "tags": [], "owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "is_accepted": false, "score": 0, "last_activity_date": 1530735933, "last_edit_date": 1530735933, "creation_date": 1530721055, "answer_id": 51177719, "question_id": 51175802, "link": "https://stackoverflow.com/questions/51175802/excel-files-on-sharepoint/51177719#51177719", "title": "Excel Files on Sharepoint", "body": "<p>If you are opening workbooks that are all in the same folder, then change FolderPath to: </p>\n\n<p><code>FolderPath = ActiveWorkbook.Path &amp; \"\\\"</code> </p>\n\n<p>I just tested this and it will open files in that folder even if they are on SharePoint. It will work where ever the folder is located. Another solution would be to sync that folder with OneDrive and then they will have a fixed path on your computer.</p>\n\n<p>Edit: I got this to open and close two other <code>*.xlsx</code> workbooks and skip over the workbook with the macro. I am guessing that it has been saved as a <code>*.xlsm</code> workbook and would be picked up with <code>*.xls*</code>. I also had the Debug.Print in the wrong spot. </p>\n\n<pre><code>    Sub ConslidateWorkbooks()\n\n    Dim FolderPath As String, Filename As String, TWB As String\n    Dim Sheet As Worksheet\n\n    Application.ScreenUpdating = False\n\n    FolderPath = ThisWorkbook.Path &amp; \"\\\"\n    Filename = Dir(FolderPath &amp; \"*.xlsx\") 'only will open *.xlsx files\n\nDo While Filename &lt;&gt; \"\"\nDebug.Print (Filename &amp; \" will open.\")\n        Workbooks.Open Filename:=FolderPath &amp; Filename, ReadOnly:=True\n        Debug.Print(Filename &amp; \" is active.\")\n        For Each Sheet In ActiveWorkbook.Sheets\n            copyOrRefreshSheet ThisWorkbook, Sheet\n        Next Sheet\n        Debug.Print (Filename &amp; \" will close.\")\n        Workbooks(Filename).Close SaveChanges:=False\n        Filename = Dir()\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10032620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-35wBjlrDkPA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UScNgBh3GXolvsDcmT-aGb2Kcew/mo/photo.jpg?sz=128", "display_name": "Jenna Devereaux", "link": "https://stackoverflow.com/users/10032620/jenna-devereaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 844, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530959774, "creation_date": 1530713796, "last_edit_date": 1530959774, "question_id": 51175802, "link": "https://stackoverflow.com/questions/51175802/excel-files-on-sharepoint", "title": "Excel Files on Sharepoint", "body": "<p>I have a question regarding Excel VBA. I have multiple excel files located in a sharepoint folder. I need a macro that will combine these files into one document and has refresh capabilities. I have a code that works great when the excel files are on my D: drive, however I am not sure how to change my code if the files are now in a file on sharepoint.  The code has an error at the File Name stage. Does anyone know how to change my code below if the folder path is now a url?Any help would be great! Thanks so much!!!</p>\n\n<pre><code>    Sub copyOrRefreshSheet(destWb As Workbook, sourceWs As Worksheet)\n      Dim ws As Worksheet\n      On Error Resume Next\n      Set ws = destWb.Worksheets(sourceWs.Name)\n      On Error GoTo 0\n      If ws Is Nothing Then\n        sourceWs.Copy After:=destWb.Worksheets(destWb.Worksheets.Count)\n      Else\n        ws.Cells.ClearContents\n        ws.Range(sourceWs.UsedRange.Address).Value = sourceWs.UsedRange.Value2\n      End If\n    End Sub\n\nSub ConslidateWorkbooks()\n\nDim FolderPath As String\nDim Filename As String\nDim Sheet As Worksheet\n\nApplication.ScreenUpdating = False\nFolderPath = \"D:\\Users\\jfreds\\Desktop\\temp folder\\\"  \nFilename = Dir(FolderPath&amp; \"*.xls*\")                                                             \n\nDo While Filename &lt;&gt; \"\"\nWorkbooks.Open Filename:=FolderPath &amp; Filename, ReadOnly:=True\nFor Each Sheet In ActiveWorkbook.Sheets\ncopyOrRefreshSheet ThisWorkbook, Sheet\nNext Sheet\nWorkbooks(Filename).Close\nFilename = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 2480, "user_id": 2496333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ec55c68fb65605cd8350519d09b08?s=128&d=identicon&r=PG", "display_name": "d-stroyer", "link": "https://stackoverflow.com/users/2496333/d-stroyer"}, "edited": false, "score": 1, "creation_date": 1530712632, "post_id": 51175343, "comment_id": 89333553, "body": "My preferred way of proceeding in this case : record a macro while manually (through the GUI) setting conditionnal formating on a set of cells. Then look at the generated code it will probably show you the missing bit."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530712950, "post_id": 51175343, "comment_id": 89333753, "body": "fwiw, <code>cellStr = tbl.DataBodyRange.Cells(1).Address(0, 0)</code> produces a relative row/relative column cell address you don&#39;t have to replace the $ out of."}, {"owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 0, "creation_date": 1530713249, "post_id": 51175343, "comment_id": 89333921, "body": "I will attempt recording a macro now/"}, {"owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 0, "creation_date": 1530713284, "post_id": 51175343, "comment_id": 89333948, "body": "Thank you Jeeped that is very useful information."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 0, "creation_date": 1530713788, "post_id": 51175607, "comment_id": 89334256, "body": "It is possible that I am doing something wrong, but running the macro with the code amended to your suggestion above results in the same situation. Any further thoughts?"}, {"owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 1, "creation_date": 1530714685, "post_id": 51175607, "comment_id": 89334783, "body": "The above answer did not seem to work for the original workbook for some reason. However it does work when placed into another workbook. I am not sure why this is but you have answered the question posted. Thanks a million!"}, {"owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 0, "creation_date": 1530719678, "post_id": 51175607, "comment_id": 89337418, "body": "I have one more question related to this thread. Is there any reason as to why this is not working as part of an addin?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 0, "creation_date": 1530719785, "post_id": 51175607, "comment_id": 89337481, "body": "As an XLA or COM add-in? No, I cannot think of anything off the top of my head."}, {"owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "edited": false, "score": 0, "creation_date": 1530719974, "post_id": 51175607, "comment_id": 89337566, "body": "XLA, It produces an error in the line where the formatcondition is being added.  Invalid procedure or call"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1530714087, "last_edit_date": 1530714087, "creation_date": 1530713163, "answer_id": 51175607, "question_id": 51175343, "link": "https://stackoverflow.com/questions/51175343/conditional-formatting-although-applied-no-format-comes-up/51175607#51175607", "title": "Conditional Formatting, although applied no format comes up", "body": "<p>You aren't telling it which FormatConditions to apply the formatting to.</p>\n\n<pre><code>With tbl.DataBodyRange\n    .FormatConditions.Delete\n    .FormatConditions.Add Type:=xlExpression, Formula1:=formulaStr\n    .FormatConditions(.FormatConditions.Count).Interior.Color = RGB(191, 191, 191)\nEnd With\n</code></pre>\n\n<p>You've deleted all other .FormatConditions so legitimately, this could be referred to as .FormatConditions(1) but when you add a .FormatConditions, it is always the last one in the queue until you do something like .FormatConditions(.FormatConditions.Count).SetFirstPriority which moves it to the front of the queue.</p>\n\n<p>You can also use the object created with .FormatConditions.Add to form a nested With ... End With block for correctly referencing multiple operations.</p>\n\n<pre><code>With tbl.DataBodyRange\n    .FormatConditions.Delete\n    with .FormatConditions.Add(Type:=xlExpression, Formula1:=formulaStr)\n        .Interior.Color = RGB(191, 191, 191)\n        .SetFirstPriority\n    end with\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10032512, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHaD4tYNisw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FFrfiHlzS2s92X6qzUQia2PHVmA/mo/photo.jpg?sz=128", "display_name": "Daniel McGeever", "link": "https://stackoverflow.com/users/10032512/daniel-mcgeever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 51175607, "answer_count": 1, "score": 3, "last_activity_date": 1530714087, "creation_date": 1530712322, "last_edit_date": 1530713474, "question_id": 51175343, "link": "https://stackoverflow.com/questions/51175343/conditional-formatting-although-applied-no-format-comes-up", "title": "Conditional Formatting, although applied no format comes up", "body": "<p>First off this is one of the best forums ive been on. I've only recently created an account but I have already learned so much from this forum. </p>\n\n<p>My question as per the title is with regards to Conditional Formatting. As seen below in the code I have so far I have applied a background color as the formatting. But after running this macro, although the conditions are applied to the selected cells there is no formatting to with it. When I click on manage existing rules, the conditions are there but it comes up with \"No Format Set\". As can be seen here: <img src=\"https://i.stack.imgur.com/C1fQt.png\" alt=\"Screenshot\"></p>\n\n<pre><code>Sub tableSetup()\n\n    Dim tbl As ListObject\n\n    Set tbl = ActiveSheet.ListObjects.Add(SourceType:=xlSrcRange, Source:=Selection, xllistobjecthasheaders:=xlYes, tablestylename:=\"Custom\")\n\n    cellStr = tbl.DataBodyRange.Cells(1).Address\n    cellStr = Replace(cellStr, \"$\", \"\")\n    formulaStr = \"=IsFormula(\" &amp; cellStr &amp; \")\"\n\n    With tbl.DataBodyRange\n        .FormatConditions.Delete\n        .FormatConditions.Add Type:=xlExpression, Formula1:=formulaStr\n        .FormatConditions.Interior.Color = RGB(191, 191, 191)\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1530712387, "post_id": 51175241, "comment_id": 89333396, "body": "<code>NextRowB</code> returns a number so <code>Range(NextRowB)</code> is incorrect. Perhaps <code>Range(&quot;B&quot; &amp; NextRowB)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530723473, "post_id": 51176095, "comment_id": 89339003, "body": "Hello TinMan, Thank you for your help but I always get this problem (note I am new to VBA). With this line: (and a few others that have .Range)                                                                                                 For Each key In .Range(&quot;B2&quot;, .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp)).Value                                                                      I get the error application defined or object defined error. Do you know how do fix this?"}, {"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530801270, "post_id": 51176095, "comment_id": 89369351, "body": "Thanks again TinMan, but I am getting another error (sorry I&#39;m really new to VBA and I am not good at debugging). For Each key In Target.Value --&gt; I get a type mismatch error"}, {"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530802653, "post_id": 51176095, "comment_id": 89370432, "body": "For Each key In Target.Value, this is the exact line of error, in each sheet there are text values for customer names."}, {"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530803110, "post_id": 51176095, "comment_id": 89370758, "body": "the pages have varying amounts of customer names, till the last row I believe."}, {"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530803797, "post_id": 51176095, "comment_id": 89371254, "body": "I get the value 1"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530807893, "last_edit_date": 1530807893, "creation_date": 1530714871, "answer_id": 51176095, "question_id": 51175241, "link": "https://stackoverflow.com/questions/51175241/vba-unique-values-count-along-with-sheet-name/51176095#51176095", "title": "VBA unique values count along with sheet name", "body": "<p>My code stores an ArrayList for each key in the Dictionary to hold the list of Worksheet names associated with the key.  After all the data has been gathered it uses another ArrayList to store an array for each key, <code>Array(Worksheet Name, Key Value, Count)</code>.  It extracts the data from that ArrayList to an Array which is written to the Summary Worksheet.</p>\n\n<pre><code>Sub SummaryReport()\n    Dim n As Long\n    Dim dict As Object, list As Object, Target As Range, ws As Worksheet\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Dim key As Variant, keyWSName As Variant, data As Variant\n\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If Not .Name = \"Summary\" Then\n                Set Target = .Range(\"B2\", .Range(\"B\" &amp; .Rows.Count).End(xlUp))\n                If Not Target Is Nothing Then\n                    For n = 1 To Target.Count\n                        key = Target.Cells(1)\n                        If Trim(key) &lt;&gt; \"\" Then\n                            If Not dict.exists(key) Then\n                                dict.Add key, CreateObject(\"System.Collections.ArrayList\")\n                            End If\n                            dict(key).Add ws.Name\n                        End If\n                    Next\n\n                End If\n            End If\n        End With\n    Next ws\n\n    Set list = CreateObject(\"System.Collections.ArrayList\")\n    For Each key In dict\n        For Each keyWSName In dict(key)\n            list.Add Array(keyWSName, key, dict(key).Count)\n        Next\n    Next\n\n    ReDim data(1 To list.Count, 1 To 3)\n    For n = 0 To list.Count - 1\n        data(n + 1, 1) = list(n)(0)\n        data(n + 1, 2) = list(n)(1)\n        data(n + 1, 3) = list(n)(2)\n    Next\n\n    With ThisWorkbook.Worksheets(\"Summary\")\n        .Columns(\"B:D\").ClearContents\n        .Range(\"B2:D2\").Resize(list.Count).Value = data\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530813772, "post_id": 51195906, "comment_id": 89376614, "body": "Thank you very much this worked!, I was also wondering if it would be possible to leave a formula on the existing sheet in column D and E or after the macro runs.                   =IF(B7=&quot;&quot;,&quot;&quot;,COUNTIFS(INDIRECT(&quot;&#39;&quot;&amp;B7&amp;&quot;&#39;!&quot;&amp;&quot;B:B&quot;),&#39;Summary (2)&#39;!C7,INDIRECT(&quot;&#39;&quot;&amp;B7&amp;&quot;&#39;!&quot;&amp;&quot;Q:Q&quot;),&quot;&lt;=5&quot;))"}, {"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530813812, "post_id": 51195906, "comment_id": 89376633, "body": "I am very new to VBA sorry if it is a dumb question!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1530816367, "post_id": 51195906, "comment_id": 89377789, "body": "There&#39;s no such thing as a dumb question. When you say the <i>existing</i> sheet do you mean the Summary sheet? What does the formula do? I can&#39;t check it at the moment &amp; may not be able to reply for another 12 hours."}, {"owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "edited": false, "score": 0, "creation_date": 1531157740, "post_id": 51195906, "comment_id": 89481160, "body": "I figured it out Darren thanks for all the help anyway!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1530808054, "last_edit_date": 1530808054, "creation_date": 1530807248, "answer_id": 51195906, "question_id": 51175241, "link": "https://stackoverflow.com/questions/51175241/vba-unique-values-count-along-with-sheet-name/51195906#51195906", "title": "VBA unique values count along with sheet name", "body": "<p>Rather than using a dictionary this code uses a temporary sheet and formula.<br>\nThe names are copied from each sheet, the duplicates removed and then a <code>COUNTIF</code> formula is applied to make the count.<br>\nThe final figures are then copied and the values pasted into column A of the temporary sheet.</p>\n\n<pre><code>Sub Test()\n\n    Dim wrkSht As Worksheet\n    Dim tmpSht As Worksheet\n    Dim rLastCell As Range\n    Dim rTmpLastCell As Range\n    Dim rLastCalculatedCell As Range\n\n    'Add a temporary sheet to do calculations and store the list to be printed.\n    Set tmpSht = ThisWorkbook.Worksheets.Add\n\n   '''''''''''''''''''''''''''''''''''''''\n   'Comment out the line above, and uncomment the next two lines\n   'to print exclusively to the \"Summary\" sheet.\n   '''''''''''''''''''''''''''''''''''''''\n   'Set tmpSht = ThisWorkbook.Worksheets(\"Summary\")\n   'tmpSht.Cells.ClearContents\n\n    For Each wrkSht In ThisWorkbook.Worksheets\n\n        With wrkSht\n            'Decide what to do with the sheet based on its name.\n            Select Case .Name\n\n                Case tmpSht.Name\n                    'Do nothing\n                Case Else 'Process sheet.\n\n                    Set rLastCell = .Cells(.Rows.Count, 2).End(xlUp)\n                    'tmpSht.Columns(4).Resize(, 3).ClearContents\n\n                    'Copy names to temp sheet and remove duplicates.\n                    .Range(.Cells(1, 2), rLastCell).Copy Destination:=tmpSht.Cells(1, 5)\n                    tmpSht.Columns(5).RemoveDuplicates Columns:=1, Header:=xlNo\n\n                    'Calculate how many names appear on the sheet and place sheet name\n                    'to left of people names.\n                    Set rTmpLastCell = tmpSht.Cells(Rows.Count, 5).End(xlUp)\n                    tmpSht.Range(tmpSht.Cells(1, 5), rTmpLastCell).Offset(, 1).FormulaR1C1 = _\n                        \"=COUNTIF('\" &amp; wrkSht.Name &amp; \"'!R1C2:R\" &amp; rLastCell.Row &amp; \"C2,RC[-1])\"\n                    tmpSht.Range(tmpSht.Cells(1, 5), rTmpLastCell).Offset(, -1) = wrkSht.Name\n\n                    'Find end of list to be printed.\n                    Set rLastCalculatedCell = tmpSht.Cells(Rows.Count, 1).End(xlUp).Offset(1)\n\n                    'Copy columns D:F which contain the sheet name, person name and count.\n                    'Paste at the end of column A:C\n                    tmpSht.Range(tmpSht.Cells(1, 4), rTmpLastCell).Resize(, 3).Copy\n                    rLastCalculatedCell.PasteSpecial xlPasteValues\n\n                    'Clear columns D:F\n                    tmpSht.Columns(4).Resize(, 3).ClearContents\n\n            End Select\n\n        End With\n\n    Next wrkSht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10002122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4I9DG-bad0/AAAAAAAAAAI/AAAAAAAABLg/ZierlDQkwXc/photo.jpg?sz=128", "display_name": "Indusha Sembakutti", "link": "https://stackoverflow.com/users/10002122/indusha-sembakutti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 51195906, "answer_count": 2, "score": 2, "last_activity_date": 1530808054, "creation_date": 1530712094, "last_edit_date": 1530716401, "question_id": 51175241, "link": "https://stackoverflow.com/questions/51175241/vba-unique-values-count-along-with-sheet-name", "title": "VBA unique values count along with sheet name", "body": "<p>Hello I am trying to go through each sheet in my workbook and print the name of the sheet along with each of the unique items and a count of them. But I am getting an error, please help.\nThis is a broad example of the result I am trying to achieve, right now I have the commented out.</p>\n\n<p>\"Sheet1\"    Dan       2<br/>\n\"Sheet1\"    Bob       23<br/>\n\"Sheet1\"    Mark      1<br/>\n\"Sheet2\"    Ban       3<br/>\n\"Sheet2\"    Dan       2<br/></p>\n\n<p>I get an error with this line:</p>\n\n<blockquote>\n<pre><code>Sheets(\"Summary\").Range(NextRowB).Resize(dict.Count - 1, 1).Value = ActiveSheet.Name\n</code></pre>\n</blockquote>\n\n<pre><code>    Sub summaryReport()\n\n    Dim dict As Object\n    Set dict = CreateObject(\"scripting.dictionary\")\n    Dim varray As Variant, element As Variant\n\n    For Each ws In ThisWorkbook.Worksheets\n\n\n        varray = ActiveSheet.Range(\"B:B\").Value\n\n\n        'Generate unique list and count\n         For Each element In varray\n\n        If dict.exists(element) Then\n            dict.Item(element) = dict.Item(element) + 1\n        Else\n            dict.Add element, 1\n        End If\n\n    Next\n\n    NextRowB = Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n    NextRowC = Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n    Sheets(\"Summary\").Range(NextRowB).Resize(dict.Count - 1, 1).Value=ActiveSheet.Name\n    Sheets(\"Summary\").Range(NextRowC).Resize(dict.Count, 1).Value = _WorksheetFunction.Transpose(dict.keys)\n    'Sheets(\"Summary\").Range(\"D3\").Resize(dict.Count, 1).Value = _\n    WorksheetFunction.Transpose(dict.items)\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 1, "creation_date": 1530711930, "post_id": 51175177, "comment_id": 89333089, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, especially where it discusses providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Basically: show; don&#39;t tell."}, {"owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "edited": false, "score": 0, "creation_date": 1530712084, "post_id": 51175177, "comment_id": 89333186, "body": "but how can i show when i can&#39;t post images? :P"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1530712138, "post_id": 51175177, "comment_id": 89333224, "body": "What weird value? What code? What is to be fixed?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1530712371, "post_id": 51175177, "comment_id": 89333386, "body": "@Linexxlol it is unlikely you should be posting images. <a href=\"https://stackoverflow.com/posts/51175177/edit\">Edit</a> and format the question and put the relevant code that reproduces or illustrates your problem in the body of the question. Don&#39;t post images of code or error messages, as this is textual information that should easy to copy and search."}, {"owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "edited": false, "score": 0, "creation_date": 1530712429, "post_id": 51175177, "comment_id": 89333427, "body": "I have an activex combobox. Its job is to show dates that it gets from another sheet, like &quot;13-03-2018&quot;. So it shows these dates no problem, BUT. When i SELECT them in the combobox dropdown menu, they change to some weird value like 43124. I have edited my original post with code"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1530712545, "post_id": 51175177, "comment_id": 89333496, "body": "@Linexxlol <a href=\"https://stackoverflow.com/posts/51175177/edit\">Edit</a> your question and put details like this in the question. Comments can be deleted and questions should contain everything necessary to understand the problem posed. SO is not a thread forum. It is a question-and-answer model, where the idea is that good questions not only help you, but help others in the future."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530713293, "post_id": 51175177, "comment_id": 89333955, "body": "@Linexxlol there you go, you have 11 reputation now. Go ahead and attach the picture please as you promised"}, {"owner": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1530713776, "post_id": 51175177, "comment_id": 89334247, "body": "Excel (or office in general) stores dates in a numeric format. 43124 is actually the value representing the date of 2018-01-24. You can verify this by executing the following command in the direct window of the VBA editor: <code>print CDate(43124)</code>. You can also see this when you change the format of a date formatted column to a numeric format, then all dates should also change to these &quot;weird values&quot; ;)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1530714314, "post_id": 51175177, "comment_id": 89334540, "body": "You could format your source dates as text so they appear in your drop-down looking like dates rather than the number that @bassfader mentions.  Your linked cell will display the date as text as well, but you should still be able to calculate with it."}, {"owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "reply_to_user": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1530717347, "post_id": 51175177, "comment_id": 89336231, "body": "@bassfader Setting the cells to &quot;text&quot; instead of &quot;date&quot; fixed my problem, thank you very much! :)"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "edited": false, "score": 0, "creation_date": 1530717155, "post_id": 51176443, "comment_id": 89336120, "body": "This partially fixes the problem, however i can&#39;t drag the formula down because all my other dates will be the same date as my original. I also can&#39;t paste special as values, only unicode text and text.  EDIT: @bassfader fixed my problem"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "edited": false, "score": 0, "creation_date": 1530717542, "post_id": 51176443, "comment_id": 89336325, "body": "Why can&#39;t you drag down?  <code>D2</code> will update as you drag down as it&#39;s a <a href=\"https://support.office.com/en-us/article/switch-between-relative-absolute-and-mixed-references-dfec08cd-ae65-4f56-839e-5f0d8d0baca9\" rel=\"nofollow noreferrer\">relative reference</a>.  <code>Unicode text</code> &amp; <code>text</code> make it sound like you&#39;re using a new instance of the Excel application rather than just entering the formula in a blank range next to your original range."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1530716087, "creation_date": 1530716087, "answer_id": 51176443, "question_id": 51175177, "link": "https://stackoverflow.com/questions/51175177/excel-activex-combobox-displays-selected-date-as-number-rather-than-date/51176443#51176443", "title": "Excel ActiveX combobox displays selected date as number rather than date", "body": "<p>The number you're getting is the number of days since 1st January 1900 - this is how Excel stores dates.  </p>\n\n<p><strong>One solution to the problem is:</strong></p>\n\n<p>You have your dates, formatted as dates, in the range <code>D2:D100</code> named as <code>ProductionList</code>. </p>\n\n<p>When you select the drop-down the dates appear correctly in the drop-down, but the selected date appears as a number - 4th July 2018 showing the number 43285 (days since January 1st 1900).  </p>\n\n<ul>\n<li>In a blank range enter the formula <code>=TEXT(D2,\"dd/mm/yyyy\")</code> where <code>D2</code> is the first date in your <code>ProductionList</code> named range.  Drag the formula down to the end of the dates.  </li>\n<li>Copy this new range of formula and <em>paste special</em> as <em>values</em> only over your original list.  </li>\n</ul>\n\n<p>Your original list should now show correctly in the combo-box, but you'll have problems when trying to compare dates to your linked cell.  </p>\n\n<p>For example, if your linked cell is <code>A5</code> the formula <code>=MATCH(DATE(2018,3,1),$A$5,0)</code> will return <code>#N/A</code>.  </p>\n\n<p>To solve this enter a formula in cell <code>B5</code>:  <code>=A5+0</code> and compare against this.  The act of adding 0 to your text date will force it to recalculate as a real date.</p>\n"}], "owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530716448, "creation_date": 1530711887, "last_edit_date": 1530716448, "question_id": 51175177, "link": "https://stackoverflow.com/questions/51175177/excel-activex-combobox-displays-selected-date-as-number-rather-than-date", "title": "Excel ActiveX combobox displays selected date as number rather than date", "body": "<p>I have an ActiveX combobox. Its ListFillRange is a range on another sheet. It finds the dates, but when I select them I get this weird value. Anybody know whats up and how to fix it? </p>\n\n<p>I have tried fixing it through VBA code but its the same problem, I would really appreciate it.</p>\n\n<p>Example code:</p>\n\n<pre><code>Private Sub ProdDateCombobox_DropButtonClick()\nProdDateCombobox.ListFillRange = \"ProductionList\"\nEnd Sub\n</code></pre>\n\n<p>ProductionList being a range of cells D2;D100 with dates</p>\n"}, {"tags": ["excel", "vba", "combobox"], "owner": {"reputation": 11, "user_id": 7950987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9YjTP.jpg?s=128&g=1", "display_name": "Rishabh Agrawal", "link": "https://stackoverflow.com/users/7950987/rishabh-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1539254625, "creation_date": 1530711868, "last_edit_date": 1539254625, "question_id": 51175171, "link": "https://stackoverflow.com/questions/51175171/how-to-use-combobox-without-selecting-items-when-down-up-arrow-is-pressed-vba", "title": "How to use ComboBox without Selecting items when down/up arrow is pressed? VBA", "body": "<p>I have a list of items which gets filtered as soon as the user types in the combobox. So if the user presses down arrow then the first item gets selected and the list is filtered again so it remains the last selected item available in the list. </p>\n\n<p>I don't want the items to be selected unless enter key is pressed. Same like a mouse hovering and clicking on an item to select it.</p>\n\n<p>EDIT: My question still remain Unanswered by our VBA Experts. </p>\n\n<p>EDIT_2: I am still searching for the solution. I have tried different ways to achieve this, still something seems wrong. Could anyone look into the code I have provided. </p>\n\n<p>Here's my code which i tried but it Failed:</p>\n\n<pre><code>Option Explicit\nDim Abort As Boolean\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim xCombox As OLEObject\n    Dim xStr As String\n    Dim xWs As Worksheet\n    Set xWs = Application.ActiveSheet\n    On Error Resume Next\n    Set xCombox = xWs.OLEObjects(\"TempCombo\")\n    With xCombox\n        .ListFillRange = \"\"\n        .LinkedCell = \"\"\n        .Visible = False\n        .ListRows = \"5\"\n    End With\n    If Target.Validation.Type = 3 Then\n        Target.Validation.InCellDropdown = False\n        Cancel = True\n        xStr = Target.Validation.Formula1\n        xStr = Right(xStr, Len(xStr) - 1)\n        If xStr = \"\" Then Exit Sub\n        With xCombox\n            .Visible = True\n            .Left = Target.Left\n            .Top = Target.Top\n            .Width = Target.Width + 5\n            .Height = Target.Height + 3\n            .ListFillRange = xStr\n            .LinkedCell = Target.Address\n        End With\n        xCombox.Activate\n        'Me.TempCombo.DropDown\n    End If\n\nEnd Sub\n\n Private Sub TempCombo_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    Select Case KeyCode\n\n\n        Case 38  'Up\n            If TempCombo.ListIndex &lt;= 0 Then KeyCode = 0 'ignore \"Up\" press if already on the first selection, or if not on a selection\n            Abort = True\n            If Not KeyCode = 0 Then ' If on a selection past the first entry\n                KeyCode = 0\n            'Manually choose next entry, cancel key press\n                TempCombo.ListIndex = TempCombo.ListIndex - 1\n\n            End If\n            Me.TempCombo.DropDown\n\n        Case 40 'Down\n            If TempCombo.ListIndex = TempCombo.ListCount - 1 Then KeyCode = 0\n        ' This method was from the discussion I linked, prevents \"falling off the bottom of the list\"\n            Abort = True\n            If Not KeyCode = 0 Then ' If on a selection before the last entry\n                KeyCode = 0\n            'Manually choose next entry, cancel key press\n                TempCombo.ListIndex = TempCombo.ListIndex + 1\n\n            End If\n            Me.TempCombo.DropDown\n    End Select\n    Abort = False\n\nEnd Sub\n\nPrivate Sub TempCombo_Change()\n    If Abort Then Exit Sub ' Stop Event code if flag set\n    Abort = True\n    ' sets the flag until finished with commands to prevent changes made by code triggering the event multiple times\n\n        Case 9\n            Application.ActiveCell.Offset(0, 1).Activate\n        Case 13\n\n        'Start\n        If Not Intersect(ActiveCell, Range(\"N8\")) Is Nothing Then\n        Application.OnKey \"~\", ActiveSheet.Range(\"P9\").Select\n        Application.OnKey \"~\"\n        ElseIf Not Intersect(ActiveCell, Range(\"P9\")) Is Nothing Then\n        Application.OnKey \"~\", ActiveSheet.Range(\"N11\").Select\n                Application.OnKey \"~\"\n\n        End If\n        Me.TempCombo.DropDown\n\n    ' ~~~ Insert Code you want to run for other cases here ~~~\n\n    Abort = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1530711874, "post_id": 51175147, "comment_id": 89333059, "body": "<i>&quot;I am sure I am using it correctly.&quot;</i> Nope. It&#39;s a boolean operator."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1530711993, "post_id": 51175147, "comment_id": 89333115, "body": "<code>CStr(Worksheets(&quot;MINUTES&quot;).Cells(x, 2)) = &quot;A1.2&quot; Or CStr(Worksheets(&quot;MINUTES&quot;).Cells(x, 2)) = &quot;B1.1&quot;</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1530712486, "creation_date": 1530712486, "answer_id": 51175402, "question_id": 51175147, "link": "https://stackoverflow.com/questions/51175147/vba-or-operator-not-executing/51175402#51175402", "title": "VBA: Or Operator not executing", "body": "<p>You can write each criteria out longhand like,</p>\n\n<pre><code>If CStr(Worksheets(\"MINUTES\").Cells(x, 2)) = \"A1.2\" Or _\n   CStr(Worksheets(\"MINUTES\").Cells(x, 2)) = \"B1.1\" Then\n    Worksheets(\"MINUTES\").Rows(x).Hidden = True\nEnd If\n</code></pre>\n\n<p>Alternately, stack the multiple OR criteria into an array and look for a match.</p>\n\n<pre><code>if not iserror(application.match(CStr(Worksheets(\"MINUTES\").Cells(x, 2)), array(\"A1.2\", \"B1.1\"), 0)) then\n    Worksheets(\"MINUTES\").Rows(x).Hidden = True\nEnd If\n</code></pre>\n\n<p>... or use a Select Case statement.</p>\n\n<pre><code>select case CStr(Worksheets(\"MINUTES\").Cells(x, 2))\n    case \"A1.2\", \"B1.1\"\n        Worksheets(\"MINUTES\").Rows(x).Hidden = True\n    case else\n        'do nothing\nend select\n</code></pre>\n\n<p>The match-to-an-array works well with multiple OR conditions, the Select Case works well with multiple conditions and multiple outcomes.</p>\n"}], "owner": {"reputation": 147, "user_id": 5596962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ujIQW.png?s=128&g=1", "display_name": "CivilSigma", "link": "https://stackoverflow.com/users/5596962/civilsigma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "closed_date": 1530713253, "accepted_answer_id": 51175402, "answer_count": 1, "score": 2, "last_activity_date": 1530712486, "creation_date": 1530711761, "question_id": 51175147, "link": "https://stackoverflow.com/questions/51175147/vba-or-operator-not-executing", "closed_reason": "Duplicate", "title": "VBA: Or Operator not executing", "body": "<p>I am trying to use the OR operator in VBA, but I am getting an error when compiling. I have checked the syntax online, and I am sure I am using it correctly.</p>\n\n<p>For example, if I do something like this:</p>\n\n<pre><code> If CStr(Worksheets(\"MINUTES\").Cells(x, 2)) = \"A1.2\" Or \"B1.1\" Then\n    Worksheets(\"MINUTES\").Rows(x).Hidden = True\n    End If\n</code></pre>\n\n<p>I get a Type Mismatch error. But, the following code executes:</p>\n\n<pre><code>If CStr(Worksheets(\"MINUTES\").Cells(x, 2)) = \"A1.2\" Then\n        Worksheets(\"MINUTES\").Rows(x).Hidden = True\n        End If\n\nIf CStr(Worksheets(\"MINUTES\").Cells(x, 2)) = \"B1.1\" Then\n        Worksheets(\"MINUTES\").Rows(x).Hidden = True\n        End If\n</code></pre>\n\n<p>Can some one please advise?</p>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["excel", "vba", "transpose"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530710898, "post_id": 51174829, "comment_id": 89332452, "body": "Application.transpose also has an iteration limit of 32768."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1530711666, "post_id": 51174829, "comment_id": 89332929, "body": "what about using a range in a hidden sheet with copy and paste special/transpose ?"}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1530712377, "post_id": 51174829, "comment_id": 89333390, "body": "Can you have two different functions? One for 1D to 2D and other for 2D to 1D?"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1530777250, "post_id": 51174829, "comment_id": 89353949, "body": "@ Sorry for late answer, i dont want to evolve more sheet as this may be &quot;unknown&quot; if the user changes workbook or something else."}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1530777299, "post_id": 51174829, "comment_id": 89353972, "body": "@Aneta That is what I have come up with so far but I do not like the solution. Can update the text above with what I have and hopefully someone can help me make it more efficient."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1530780709, "post_id": 51174829, "comment_id": 89355845, "body": "@Fredrik Perfect, now you just have to find out how many dimensions has your array... <code>on error resume next if UBound(arrIn, 2)=1 then  on error goto 0 call Transpose1(arrIn) else on error goto 0 call Transpose2(arrIn) end if</code>"}], "owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530777361, "creation_date": 1530710724, "last_edit_date": 1530777361, "question_id": 51174829, "link": "https://stackoverflow.com/questions/51174829/vba-manual-transpose", "title": "VBA manual transpose", "body": "<p>So I have noticed that Application.transpose doesnt take more than 255 characters and my array contain more than 300 characters or so. Is there a manual or another way to transpose an array? Currently I use</p>\n\n<pre><code>Function Transpose(arrIn) As String()\n    Dim arrOut() As String, r As Long, ln As Long, i As Long\n\n    ln = (UBound(arrIn) - LBound(arrIn)) + 1\n    ReDim arrOut(1 To ln, 1 To 1)\n    i = 1\n    For r = LBound(arrIn) To UBound(arrIn)\n        arrOut(i, 1) = arrIn(r)\n        i = i + 1\n    Next r\n    Transpose = arrOut\n\nEnd Function\n</code></pre>\n\n<p>But I have noticed that this only takes a 1D array and transposes it, but I must be able to go from 1D to 2D and vise verse. Anyone who knows how to do this in a efficient way?</p>\n\n<p>Updated: This is what I currently use, but I think it needs some improvements.</p>\n\n<pre><code>Function Transpose1(arrIn) As String()\n    Dim arrOut() As String, r As Long, ln As Long, i As Long\n\n    ln = (UBound(arrIn) - LBound(arrIn)) + 1\n    ReDim arrOut(1 To ln)\n    i = 1\n    For r = LBound(arrIn) To UBound(arrIn)\n        arrOut(i) = arrIn(r, UBound(arrIn, 2))\n        i = i + 1\n    Next r\n    Transpose1 = arrOut\n\nEnd Function\n\n\n' From one 2 two\nFunction Transpose2(arrIn) As String()\n    Dim arrOut() As String, r As Long, ln As Long, i As Long\n\n    ln = (UBound(arrIn) - LBound(arrIn)) + 1\n    ReDim arrOut(1 To ln, 1 To 1)\n    i = 1\n    For r = LBound(arrIn) To UBound(arrIn)\n        arrOut(i, 1) = arrIn(r)\n        i = i + 1\n    Next r\n    Transpose2 = arrOut\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "userform", "file-copying"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530710572, "post_id": 51174579, "comment_id": 89332237, "body": "When answering a question, I generally copy, paste and refactor.  This is tough to do when the subroutine&#39;s header is missing.  I edited the OP&#39;s code to make it easier work with."}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 17, "user_id": 6922376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-q6OEDrmzcIc/AAAAAAAAAAI/AAAAAAAAAEY/6xy4Lw5bYdM/photo.jpg?sz=128", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/6922376/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1530715782, "post_id": 51175432, "comment_id": 89335393, "body": "I missed something when I read your post.  I updated my answer to simply do what you had asked."}, {"owner": {"reputation": 17, "user_id": 6922376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-q6OEDrmzcIc/AAAAAAAAAAI/AAAAAAAAAEY/6xy4Lw5bYdM/photo.jpg?sz=128", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/6922376/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1530716876, "post_id": 51175432, "comment_id": 89335970, "body": "this way i can use a variable in the <code>For</code> statement to get the first and last file name and create the folder and then move the files once it reaches 100. Could you explain this part <code>If Not Right(SourceFolder, 1) = &quot;\\&quot; Then SourceFolder = SourceFolder &amp; &quot;\\&quot;     If Not Right(TargetFolder, 1) = &quot;\\&quot; Then TargetFolder = TargetFolder &amp; &quot;\\&quot;</code>"}, {"owner": {"reputation": 17, "user_id": 6922376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-q6OEDrmzcIc/AAAAAAAAAAI/AAAAAAAAAEY/6xy4Lw5bYdM/photo.jpg?sz=128", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/6922376/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1530809773, "post_id": 51175432, "comment_id": 89374693, "body": "if i store the files in an array, is it possible to sort it out numerically? My files are numbered from 1-1000 and the code keeps starting from &quot;1,10,11,12,13,14...&quot; instead of &quot;1,2,3,4,5,6...&quot; and so on. Could you help me out again?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 17, "user_id": 6922376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-q6OEDrmzcIc/AAAAAAAAAAI/AAAAAAAAAEY/6xy4Lw5bYdM/photo.jpg?sz=128", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/6922376/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1530812447, "post_id": 51175432, "comment_id": 89375993, "body": "@AnthonyCox I updated my answer to return a 2D array of the file names."}, {"owner": {"reputation": 17, "user_id": 6922376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-q6OEDrmzcIc/AAAAAAAAAAI/AAAAAAAAAEY/6xy4Lw5bYdM/photo.jpg?sz=128", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/6922376/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1530820187, "post_id": 51175432, "comment_id": 89379463, "body": "will this put 100 files into an array and sort it out numerically before moving it to the folder?"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 1, "last_activity_date": 1530812414, "last_edit_date": 1530812414, "creation_date": 1530712584, "answer_id": 51175432, "question_id": 51174579, "link": "https://stackoverflow.com/questions/51174579/how-to-copy-100-files-to-a-folder-based-on-first-and-last-file-name-and-display/51175432#51175432", "title": "How to copy 100 files to a folder based on first and last file name and display in listbox vba", "body": "<p>Back to the basics:</p>\n\n<h2>CopyXNumberOfFiles:Sub</h2>\n\n<pre><code>Sub CopyXNumberOfFiles(SourceFolder As String, TargetFolder As String, Optional MaxNumFiles As Long = 100)\n    Dim fso As Object, objFile As Object\n    Dim count As Long\n    Dim Path As String\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    If Not Right(SourceFolder, 1) = \"\\\" Then SourceFolder = SourceFolder &amp; \"\\\"\n    If Not Right(TargetFolder, 1) = \"\\\" Then TargetFolder = TargetFolder &amp; \"\\\"\n\n    For Each objFile In fso.GetFolder(SourceFolder).Files\n        If objFile.Path Like \"*.xls?\" Then\n            Path = TargetFolder &amp; objFile.Name\n            If Len(Dir(Path)) = 0 Then\n                FileCopy objFile.Path, Path\n                count = count + 1\n                If count &gt;= MaxNumFiles Then Exit For\n            End If\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<h2>Usage</h2>\n\n<blockquote>\n<pre><code> CopyXNumberOfFiles \"C:\\\",\"C:\\Data\"\n</code></pre>\n</blockquote>\n\n<h2>Addendum</h2>\n\n<p>This function will copy the files over and return an array of the new file paths.</p>\n\n<pre><code>Function getCopyXNumberOfFiles(SourceFolder As String, TargetFolder As String, Optional MaxNumFiles As Long = 100) As String()\n    Dim fso As Object, objFile As Object\n    Dim count As Long, n As Long\n    Dim Path As String\n    Dim data() As String, results() As String\n    ReDim data(1 To 2, 1 To MaxNumFiles)\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    If Not Right(SourceFolder, 1) = \"\\\" Then SourceFolder = SourceFolder &amp; \"\\\"\n    If Not Right(TargetFolder, 1) = \"\\\" Then TargetFolder = TargetFolder &amp; \"\\\"\n\n    For Each objFile In fso.GetFolder(SourceFolder).Files\n        If objFile.Path Like \"*.xls?\" Then\n            Path = TargetFolder &amp; objFile.Name\n            If Len(Dir(Path)) = 0 Then\n                FileCopy objFile.Path, Path\n                count = count + 1\n                data(1, count) = objFile.Path\n                data(2, count) = Path\n                If count &gt;= MaxNumFiles Then Exit For\n            End If\n        End If\n    Next\n    ReDim Preserve results(1 To count, 1 To 2)\n    For n = 1 To count\n        results(n, 1) = data(1, n)\n        results(n, 2) = data(2, n)\n    Next\n    getCopyXNumberOfFiles = results\nEnd Function\n</code></pre>\n\n<h2>Usage</h2>\n\n<p>Column 1 has the original paths and column 2 has the new paths.</p>\n\n<blockquote>\n<pre><code>Dim Files() as String, firstFilePath as String, lastFilePath as String\n\nFiles = getCopyXNumberOfFiles(\"C:\\\", \"C:\\New Folder\\\", 100)\n</code></pre>\n</blockquote>\n\n<p>Original Paths</p>\n\n<blockquote>\n<pre><code>firstFilePath  = Files(1, 1)\nlastFilePath  = Files(Ubound(Files), 1)\n</code></pre>\n</blockquote>\n\n<p>New Paths</p>\n\n<blockquote>\n<pre><code>firstFilePath  = Files(1, 2)\nlastFilePath  = Files(Ubound(Files), 2)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 6922376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-q6OEDrmzcIc/AAAAAAAAAAI/AAAAAAAAAEY/6xy4Lw5bYdM/photo.jpg?sz=128", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/6922376/anthony-cox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51175432, "answer_count": 1, "score": 1, "last_activity_date": 1530812414, "creation_date": 1530709933, "last_edit_date": 1530713095, "question_id": 51174579, "link": "https://stackoverflow.com/questions/51174579/how-to-copy-100-files-to-a-folder-based-on-first-and-last-file-name-and-display", "title": "How to copy 100 files to a folder based on first and last file name and display in listbox vba", "body": "<p>Im trying to come up with a piece of script that will allow me to copy 100 files from one folder and create a new folder based on the first file and last file name and then move those 100 files to that folder.\nAfter moving those files, i want it to display the folders in a userform listbox as clickable items.\nFor example, each item in the listbox will be a folder, if i double click on a folders name it will display all the contents of the file (of each of 100 files) in a sheet i've set up.</p>\n\n<p>I haven't been able to test this code yet, all i've done for the past week was research and rewrite the code over and over until i could understand it properly before adding it to the program. So there's bound to be some or more errors along the way.</p>\n\n<p>What i did notice was the \"objFile.CopyFile Folderpath &amp; FCount &amp; \"_\" &amp; LCount\" piece of code that doesnt specify which files could be copied specifically. For example, i want it to start at the first file and start coping the first 100 files, when the code is executed again, it will start at file 101 and copy the next 100 files. If there's way to ensure that it wouldnt keep copying the first 100 files, that would be awesome!</p>\n\n<pre><code>Sub Main()\n'====CHECK IF THERE'S 100 FILES====\n\n    Dim filename, folderpath, path As String\n    Dim count As Integer\n    Dim FCount, LCount, FlagCount, IntCount As Integer\n    Dim objFSO As Object\n    Dim obj As Object\n\n    FCount = 0                                        ' First File name\n    LCount = 0                                        'Last file name\n    count = 0                                         'file count\n    FlagCount = Sheets(\"Flag Sheet\").Range(\"A2\").Value\n\n    folderpath = \"Work\\Big Book\\\"                     '==================Location Of The Book\n    path = folderpath &amp; \"*.xls\"\n    filename = Dir(path)\n\n    Do While filename &lt;&gt; \"\"\n        count = count + 1\n        filename = Dir(path)\n    Loop\nIf count &lt; 100 Then\n\n        '====CREATE A FOLDER FOR THE FILES====\n\n        If FlagCount &lt;&gt; \"\" Then                       '====If there is a flag count, it will create a folder based on the last number it was used\n            FCount = FlagCount + 1\n            LCount = FlagCount + 101\n            MkDir folderpath &amp; FCount &amp; \"_\" &amp; LCount\n        Else                                          '=======================else if there isnt one, it will use the first file name to create the folder\n            FCount = IntCount + 1\n            LCount = IntCount + 100\n            MkDir folderpath &amp; FCount &amp; \"_\" &amp; LCount\n        End If\n\n\n        '====MOVE 100 FILES TO FOLDER====\n\n\n        For Each objFile In objFSO.GetFolder(path)\n            If FlagCount &lt;&gt; \"\" Then                   '====================if theres a flag count it will move the files starting after the flag count + 101\n                objFile.CopyFile folderpath &amp; FCount &amp; \"_\" &amp; LCount\n                IntCount = FlagCount + 1\n                If IntCount = FlagCount + 100 Then Exit For\n            Else                                      '======================================else it will just move the first 100 files\n                objFile.CopyFile folderpath &amp; FCount &amp; \"_\" &amp; LCount\n                IntCount = IntCount + 1\n                If IntCount = IntCount + 100 Then Exit For\n            End If\n        Next\n\n    End If\n\nElse\n    '===Do Nothing===\nEnd If\n\nEnd Sub\n\n'=====Display Folders In Listbox=====\n    '====Display Folder Items In Book====\n\n\n'Call the function\nDisplayFoldersInListBox folderpath &amp; FCount &amp; \"_\" &amp; LCount, Me.Listbox1\n\nSub Button_Click()\n\n    For Each File in Folderpath &amp; FCount &amp; \"_\" &amp; LCount &amp; \"\\\" &amp; Listbox.value\n        '[INSERT BIG BOOK CODE]\n\n    Next\n\nEnd Sub\n\nPrivate Sub DisplayFoldersInListBox(ByVal strRootFolder As String, ByRef lbxDisplay As MSForms.ListBox)\n\n    Dim fso As Object\n    Dim fsoRoot As Object\n    Dim fsoFolder As Object\n\n    'Make sure that root folder contains trailing backslash\n    If Right$(strRootFolder, 1) &lt;&gt; \"\\\" Then strRootFolder = strRootFolder &amp; \"\\\"\n\n    'Get reference to the FileSystemObject\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    'Get the root folder\n    Set fsoRoot = fso.GetFolder(strRootFolder)\n\n    'Clear the listbox\n    lbxDisplay.Clear\n\n    'Populate the listbox with subfolders of Root\n    For Each fsoFolder In fsoRoot.SubFolders\n        lbxDisplay.AddItem fsoFolder.Name\n    Next fsoFolder\n\n    'Clean up\n    Set fsoRoot = Nothing\n    Set fso = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This link: <a href=\"https://stackoverflow.com/questions/43249898/copy-only-the-first-file-of-a-folder-vba\">Copy only the first file of a folder VBA</a>\nSeems to be the answer for the coping of the files, but im not entirely sure how to add it to my script. Can anyone help me out?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530712683, "post_id": 51175328, "comment_id": 89333578, "body": "Thanks @IRENE G  But &quot;Set wbMaster = ActiveWorkbook.Name&quot; Type mismatch here. Any idea?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "reply_to_user": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530713097, "post_id": 51175328, "comment_id": 89333827, "body": "Try ThisWorkbook.Name or set wbMaster = Workbooks.Open(&quot;C:\\myMasterworkbook.xlsm&quot;) or wbMaster = Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\myMasterworkbook.xlsm&quot;)"}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530713261, "post_id": 51175328, "comment_id": 89333932, "body": "This master file will be circulated for different teams to use. Therefore, is there any way not to quote File Name?"}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530713546, "post_id": 51175328, "comment_id": 89334117, "body": "Tried    Set wbMaster = ThisWorkbook.Name  still prompt &quot;Type mismatch&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "reply_to_user": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530713978, "post_id": 51175328, "comment_id": 89334349, "body": "If you move Set wbMaster = ThisWorkbook.Name to the beginning just after &quot;Dims&quot; it works? ( I edited the post)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "reply_to_user": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530714463, "post_id": 51175328, "comment_id": 89334641, "body": "Sorry :(, I tested and it worked for me... Try set wbMaster = Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\&quot; &amp; ThisWorkbook.Name)"}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530714720, "post_id": 51175328, "comment_id": 89334804, "body": "Okay - after changing it. I think it worked. But the copy-paste doesn&#39;t take place now.   So sorry to trouble you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "reply_to_user": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530715057, "post_id": 51175328, "comment_id": 89335000, "body": "Sorry I forgot to update sh1.Columns(1) to  wbMaster.wsMaster.Columns(1). Try now :)"}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530715450, "post_id": 51175328, "comment_id": 89335222, "body": "Saw that. I have changed it. Copy-paste is not working."}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530874549, "post_id": 51175328, "comment_id": 89398406, "body": "Prompted error at this line&quot; Set FR = wbMaster.wsMaster.Columns(1).Find(What:=c)&quot;. Error message is Object required"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "reply_to_user": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530875048, "post_id": 51175328, "comment_id": 89398672, "body": "Sorry, FR is no longuer a Long here, so don&#39;t Dim FR As Long, do Dim FR or Dim FR As Range...."}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530875638, "post_id": 51175328, "comment_id": 89398971, "body": "my dear. So sorry to trouble you. I have updated it. Now, I can select my source file. But copy-paste does not take place."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "reply_to_user": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530881700, "post_id": 51175328, "comment_id": 89402525, "body": "Try replacing &quot; wbMaster.wsMaster.Cells(FR.Row, 3).Value = wbSource.wsSource.Cells(t, 2).Value&quot; for  &quot;wbMaster.wsMaster.Cells(FR.Row, 3).Copy  wbSource.wsSource.Cells(t, 2).PasteSpecial Paste:=xlPasteValues&quot;"}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1530977781, "post_id": 51175328, "comment_id": 89429475, "body": "tried that. And amended the other 2 lines after it according to the format. But it&#39;s not working."}, {"owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "edited": false, "score": 0, "creation_date": 1531009136, "post_id": 51175328, "comment_id": 89435752, "body": "Found a solution to it. Please refer to my updated code"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1530881744, "last_edit_date": 1530881744, "creation_date": 1530712274, "answer_id": 51175328, "question_id": 51174442, "link": "https://stackoverflow.com/questions/51174442/vba-copy-paste-from-multiple-worksheets-multiple-workbooks/51175328#51175328", "title": "VBA: Copy-Paste from multiple worksheets multiple workbooks", "body": "<p>I have modified your code, please try this:</p>\n\n<pre><code>    Sub CommandButton2_Click()\n\n\n    Dim fileDialog As fileDialog\n    Dim strPathFile As String\n    Dim strFileName As String\n    Dim strPath As String\n    Dim dialogTitle As String\n    Dim wbSource As Workbook\n    Dim wbMaster As Workbook\n    Dim wsSource, wsMaster As Worksheet\n    Dim rngToCopy As Range\n    Dim rngRow As Range\n    Dim rngDestin As Range\n    Dim lngRowsCopied As Long\n    Dim dic        As Object\n    Dim ky          As Variant\n    Dim c          As Variant\n    Dim cel        As Range\n    Dim x          As String\n    Dim tgt As Range\n    Dim FR\n\n    Set wbMaster = ThisWorkbook.Name\n\n\n    dialogTitle = \"Navigate to and select required file.\"\n    Set fileDialog = Application.fileDialog(msoFileDialogFilePicker)\n    With fileDialog\n    .InitialFileName = \"C:\\Users\\User\\Documents\"\n    '.InitialFileName = ThisWorkbook.Path &amp; \"\\\" 'Alternative to previous line\n    .AllowMultiSelect = False\n    .Filters.Clear\n    .Title = dialogTitle\n\n\n\n    If .Show = False Then\n        MsgBox \"File not selected to import. Process Terminated\"\n        Exit Sub\n    End If\n    strPathFile = .SelectedItems(1)\n    End With\n\n    ''''''''\n    'this is what I've modified:\n\n\n    Set wbSource = Workbooks.Open(Filename:=strPathFile)\n\n    For Each wsSource In wbSource.Sheets\n\n    For Each wsMaster In wbMaster.Sheets\n\n        If wsSource.Name = wsMaster.Name Then\n\n        t = 2\n            Do Until t = wbSource.wsSource.Cells(Rows.Count, 1).End(xlUp).Row\n\n            c = wbSource.wsSource.Cells(t, 1).Value\n            Set FR = wbMaster.wsMaster.Columns(1).Find(What:=c)\n\n                If Not FR Is Nothing Then\n                    Do Until FR Is Nothing\n\n                    wbMaster.wsMaster.Cells(FR.Row, 3).Value = wbSource.wsSource.Cells(t, 2).Value\n                    'Or\n                     'wbMaster.wsMaster.Cells(FR.Row, 3).Copy  \n                     'wbSource.wsSource.Cells(t, 2).PasteSpecial Paste:=xlPasteValues\n                    wbMaster.wsMaster.Cells(FR.Row, 4).Value = wbSource.wsSource.Cells(t, 3).Value\n                    wbMaster.wsMaster.Cells(FR.Row, 5).Value = wbSource.wsSource.Cells(t, 4).Value\n\n                    Loop\n                End If\n\n            t = t + 1\n\n            Loop\n\n        End If\n    Next wsMaster\nNext wsSource\n\n    ''''''''\n\n    wbSource.Close SaveChanges:=False\n\n    Set fileDialog = Nothing\n    Set rngRow = Nothing\n    Set rngToCopy = Nothing\n    Set wbSource = Nothing\n    Set rngDestin = Nothing\n\n    'MsgBox \"The data is copied\"\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "is_accepted": true, "score": 0, "last_activity_date": 1531009239, "creation_date": 1531009239, "answer_id": 51227909, "question_id": 51174442, "link": "https://stackoverflow.com/questions/51174442/vba-copy-paste-from-multiple-worksheets-multiple-workbooks/51227909#51227909", "title": "VBA: Copy-Paste from multiple worksheets multiple workbooks", "body": "<p>Found a solution to it</p>\n\n<pre><code>    Sub CommandButton2_Click()\n\n    Dim fileDialog As fileDialog\n   Dim strPathFile As String\n   Dim dialogTitle As String\n   Dim wbSource As Workbook, Mwb As Workbook\n   Dim Ws As Worksheet, Mws As Worksheet\n   Dim Cl As Range\n   Dim FR As Long\n\n   Set Mwb = ThisWorkbook\n   dialogTitle = \"Navigate to and select required file.\"\n   Set fileDialog = Application.fileDialog(msoFileDialogFilePicker)\n   With fileDialog\n      .InitialFileName =\"C:\\Users\\User\\Documents\"\n      .AllowMultiSelect = False\n      .Filters.Clear\n      .Title = dialogTitle\n      If .Show = False Then\n         MsgBox \"File not selected to import. Process Terminated\"\n         Exit Sub\n      End If\n      strPathFile = .SelectedItems(1)\n   End With\n   Application.ScreenUpdating = False\n   Set wbSource = Workbooks.Open(FileName:=strPathFile)\n\n   For Each Ws In wbSource.Worksheets\n      If ShtExists(Ws.name, Mwb) Then\n         Set Mws = Mwb.Sheets(Ws.name)\n         For Each Cl In Ws.Range(\"A2\", Ws.Range(\"A\" &amp; Rows.Count).End(xlUp))\n            FR = 0\n            On Error Resume Next\n            FR = Application.Match(Cl.Value, Ws.Columns(1), 0)\n            On Error GoTo 0\n            If FR &lt;&gt; 0 Then Mws.Range(\"C\" &amp; FR).Value = Cl.Offset(, 2)\n            If FR &lt;&gt; 0 Then Mws.Range(\"D\" &amp; FR).Value = Cl.Offset(, 3)\n            If FR &lt;&gt; 0 Then Mws.Range(\"E\" &amp; FR).Value = Cl.Offset(, 4)\n         Next Cl\n      End If\n      Set Mws = Nothing\n   Next Ws\n\n   wbSource.Close SaveChanges:=False\nEnd Sub\nPublic Function ShtExists(ShtName As String, Optional Wbk As Workbook) As Boolean\n    If Wbk Is Nothing Then Set Wbk = ActiveWorkbook\n    On Error Resume Next\n    ShtExists = (LCase(Wbk.Sheets(ShtName).name) = LCase(ShtName))\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9985203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DbzT5iBLKtM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ZtMiVdQyKQIlCvzjjVoKQXyrACw/mo/photo.jpg?sz=128", "display_name": "user9985203", "link": "https://stackoverflow.com/users/9985203/user9985203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 51227909, "answer_count": 2, "score": 1, "last_activity_date": 1531009239, "creation_date": 1530709536, "last_edit_date": 1530710755, "question_id": 51174442, "link": "https://stackoverflow.com/questions/51174442/vba-copy-paste-from-multiple-worksheets-multiple-workbooks", "title": "VBA: Copy-Paste from multiple worksheets multiple workbooks", "body": "<p>I have a Master File and Source File.<br>\nMaster File: multiple worksheets, Column A to J<br>\nSource File: multiple worksheets, Column A to E</p>\n\n<p>I have managed to come out with<br>\n1) Prompt window to select Source File<br>\n2) Copy Column C, D, E from Source File and Paste it to Column C, D, E by matching value in Column A within a worksheet  </p>\n\n<p>I am now trying to repeat this copy-paste in multiple worksheets.<br>\nThe worksheet name ranges from \"F.01, F.02 to F.10\", \"T.01, T.02 to T.10\", \"IS.01 to IS.05\" for both Master and Source File.      </p>\n\n<p>I am a newbie in VBA - I managed to get below code done by checking all forums and forums.   </p>\n\n<p>Really need your help in helping me to code something along the line making it Copy-Paste to be repetitive based on range of worksheets as stated above.<br>\nSource \"F.01\" to Master \"F.01\" and it goes on</p>\n\n<pre><code>Sub CommandButton2_Click()\n\n\nDim fileDialog As fileDialog\nDim strPathFile As String\nDim strFileName As String\nDim strPath As String\nDim dialogTitle As String\nDim wbSource As Workbook\nDim rngToCopy As Range\nDim rngRow As Range\nDim rngDestin As Range\nDim lngRowsCopied As Long\nDim dic        As Object\nDim ky          As Variant\nDim c          As Variant\nDim cel        As Range\nDim x          As String\nDim tgt As Range\nDim FR As Long\nDim SSheetList As Variant\nDim MSheetList As Variant\n\n\ndialogTitle = \"Navigate to and select required file.\"\nSet fileDialog = Application.fileDialog(msoFileDialogFilePicker)\nWith fileDialog\n.InitialFileName = \"C:\\Users\\User\\Documents\"\n'.InitialFileName = ThisWorkbook.Path &amp; \"\\\" 'Alternative to previous line\n.AllowMultiSelect = False\n.Filters.Clear\n.Title = dialogTitle\n\n\n\nIf .Show = False Then\n    MsgBox \"File not selected to import. Process Terminated\"\n    Exit Sub\nEnd If\nstrPathFile = .SelectedItems(1)\nEnd With\n\nSet wbSource = Workbooks.Open(Filename:=strPathFile)\n\nSSheetList = Array(\"F.01\", \"F.02\")\nMSheetList = Array(\"F.01\", \"F.02\")\n\nSet sh1 = ThisWorkbook.Sheets(MSheetList)\nSet sh2 = wbSource.Sheets(SSheetList)\n\nApplication.ScreenUpdating = False\n\nIf sh1 Is sh2 Then\n\nFor Each c In sh2.Range(\"A2\", sh2.Range(\"A\" &amp; Rows.Count).End(xlUp))\nFR = 0\nOn Error Resume Next\nFR = Application.Match(c, sh1.Columns(1), 0)\nOn Error GoTo 0\n\nIf FR &lt;&gt; 0 Then sh1.Range(\"C\" &amp; FR).Value = c.Offset(, 2)\nIf FR &lt;&gt; 0 Then sh1.Range(\"D\" &amp; FR).Value = c.Offset(, 3)\nIf FR &lt;&gt; 0 Then sh1.Range(\"E\" &amp; FR).Value = c.Offset(, 4)\nNext c\n\nEnd If\n\nwbSource.Close SaveChanges:=False\n\nSet fileDialog = Nothing\nSet rngRow = Nothing\nSet rngToCopy = Nothing\nSet wbSource = Nothing\nSet rngDestin = Nothing\n\n'MsgBox \"The data is copied\"\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 1, "creation_date": 1530709387, "post_id": 51174374, "comment_id": 89331467, "body": "It refers to the workbook it resides in."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 1, "creation_date": 1530709610, "post_id": 51174374, "comment_id": 89331614, "body": "or to be even more specific you can use <code>Workbooks(&quot;Book1.xlsm&quot;).Worksheets(&quot;Sheet1&quot;)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1530709801, "post_id": 51174374, "comment_id": 89331718, "body": "No, the Sheets or Worksheets collection refers to the ActiveWorkbook not necessarily ThisWorkbook unless you qualify the parent workbook like ThisWorkbook.Worksheets(&quot;sheet1&quot;). It&#39;s the same as range or cells defaulting to the Activesheet if used without a parent worksheet reference in a public module code sheet. Use a With ThisWorkbook ... End With block so you don&#39;t have to repeat ThisWorkbook  too many times."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 3, "creation_date": 1530710200, "post_id": 51174374, "comment_id": 89331994, "body": "Fully qualifying your reference is analogous to using a condom:  &quot;You don&#39;t have to use them all the time but eventually you are going to regret not having used it!&quot;"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1530710727, "post_id": 51174374, "comment_id": 89332338, "body": "Rather than ThisWorkbook.Sheets(strMySheetName) everywhere, dim a variable to point to the worksheet and set that appropriately. Dim wsMySheet as Worksheet;Set wsMySheet = Thisworkbook.sheets(strmysheetname). Once set wsMysheet will always point to the right sheet"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530712079, "post_id": 51174374, "comment_id": 89333180, "body": "Doesn&#39;t the sheet codename always refer to <code>ThisWorkbook</code> when it&#39;s used.  e.g. <code>Sheet1.Range(&quot;A1&quot;)</code> is the same as <code>Thisworkbook.Worksheets(&quot;TabNameFor_Sheet1&quot;).Range(&quot;A1&quot;)</code>?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530712633, "post_id": 51174374, "comment_id": 89333555, "body": "In addition to my last comment I found <a href=\"http://www.ozgrid.com/VBA/excel-vba-sheet-names.htm\" rel=\"nofollow noreferrer\">The only times you cannot use a sheets CodeName is when you reference a Sheet that is in a different Workbook to the one that the code resides.</a>.  I&#39;d suggest using the codename - your users can then move sheets about and rename them but your code will still know what you meant."}], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 1349511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6f52ab9ce3508ba99f0369fe16a3f1?s=128&d=identicon&r=PG", "display_name": "martin.lindenlauf", "link": "https://stackoverflow.com/users/1349511/martin-lindenlauf"}, "edited": false, "score": 0, "creation_date": 1530829601, "post_id": 51175347, "comment_id": 89382920, "body": "Thank&#39;s for your answer - helped me to clarify my understanding. I decided to fully qualify using <code>ThisWorkbook</code> anyway, following TinMan&#39;s comment above. You never know - especially if you tend to reuse code later (as I do). (<code>Workbook(&quot;MyWorkbookName&quot;)</code> is no option in my case: my users will have to rename the workbook to personalize it.)"}], "tags": [], "owner": {"reputation": 2480, "user_id": 2496333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ec55c68fb65605cd8350519d09b08?s=128&d=identicon&r=PG", "display_name": "d-stroyer", "link": "https://stackoverflow.com/users/2496333/d-stroyer"}, "is_accepted": true, "score": 0, "last_activity_date": 1530712329, "creation_date": 1530712329, "answer_id": 51175347, "question_id": 51174374, "link": "https://stackoverflow.com/questions/51174374/do-i-need-to-refer-thisworkbook-excel-vba/51175347#51175347", "title": "do I need to refer ThisWorkbook (Excel VBA)", "body": "<p>Short answer : No you don't need to.</p>\n\n<p>The default context of execution of the macro it the currently active Workbook.\nSo if your macro is launched through action on the Workbook sheets (calculate, widgets such as buttons, save or load events), there is no risk. </p>\n\n<p>If your macro is cross-workbook, can be triggered by action on another workbook or intends to set focus, load, modify other workbooks, then its a must to specify <code>ThisWorkbook.</code></p>\n\n<p>As already mentionned in the comments of your questions, alternatives such as <code>Workbook(\"myworkbookname\")</code> are better for disambiguation in many cases, but have side effect in case you change the filename.</p>\n"}], "owner": {"reputation": 372, "user_id": 1349511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6f52ab9ce3508ba99f0369fe16a3f1?s=128&d=identicon&r=PG", "display_name": "martin.lindenlauf", "link": "https://stackoverflow.com/users/1349511/martin-lindenlauf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 51175347, "answer_count": 1, "score": 2, "last_activity_date": 1530712329, "creation_date": 1530709329, "last_edit_date": 1530711807, "question_id": 51174374, "link": "https://stackoverflow.com/questions/51174374/do-i-need-to-refer-thisworkbook-excel-vba", "title": "do I need to refer ThisWorkbook (Excel VBA)", "body": "<p>I do some VBA operations on specific sheets in a Workbook that may be copied later, enabling the end user to open more than one copy at a time (and filling the tables with different data). </p>\n\n<p><strong>Question:</strong><br>\nDo I need to refer explicitly <code>ThisWorkbook.Sheets(strMySheetName)</code> to avoid any code to operate on the sheet <em>with the same name</em> but <em>inside another copy</em> of the workbook (opened at the same time), or does the <code>Sheets</code> collection always refer to the workbook <em>the code resides in</em> (i.e. <code>ThisWorkbook</code>)?</p>\n"}, {"tags": ["vba", "outlook", "gal"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10031045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c20519d8c4036c590c55cdb23420df?s=128&d=identicon&r=PG&f=1", "display_name": "swideer", "link": "https://stackoverflow.com/users/10031045/swideer"}, "edited": false, "score": 0, "creation_date": 1530872803, "post_id": 51179167, "comment_id": 89397360, "body": "It work now without a problem. That&#39;s something new for me, so thank you for letting me learn new solutions in VBA :)"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1530728280, "creation_date": 1530728280, "answer_id": 51179167, "question_id": 51174299, "link": "https://stackoverflow.com/questions/51174299/warn-before-sending-messages-outside-of-multiple-possible-internal-domains/51179167#51179167", "title": "Warn before sending messages outside of multiple possible internal domains?", "body": "<p>You could replace the single internal domain with an array of domains.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    Dim recips As Recipients\n    Dim recip As Recipient\n\n    Dim pa As propertyAccessor\n\n    Dim prompt As String\n    Dim Address As String\n\n    Dim lLen As Long\n    Dim Str1 As String\n\n    Dim arrayDomains() As Variant\n    Dim i As Long\n\n    Dim internalFlag As Boolean\n    Dim externalFlag As Boolean\n\n    Dim strExtAdd As String\n\n    arrayDomains = Array(\"PAM domain\", \"EMEA domain\", \"other internal domain\")\n\n    Const PR_SMTP_ADDRESS As String = \"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\"\n\n    Set recips = Item.Recipients\n\n    For Each recip In recips\n\n        Set pa = recip.propertyAccessor\n\n        Address = LCase(pa.GetProperty(PR_SMTP_ADDRESS))\n        lLen = Len(Address) - InStrRev(Address, \"@\")\n        Str1 = Right(Address, lLen)\n\n        internalFlag = False\n\n        For i = LBound(arrayDomains) To UBound(arrayDomains)\n            If Str1 = arrayDomains(i) Then\n                internalFlag = True\n                Exit For\n            End If\n        Next\n\n        If internalFlag = False Then\n            externalFlag = True\n            strExtAdd = strExtAdd &amp; vbCr &amp; Address\n        End If\n\n    Next\n\n    If externalFlag = True Then\n\n        prompt = \"This email is being sent to external addresses. Do you still wish to send?\" &amp; strExtAdd\n        If MsgBox(prompt, vbYesNo + vbExclamation + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n            Cancel = True\n        End If\n\n    'Else\n\n        'Debug.Print \"Internal addresses only.\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10031045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c20519d8c4036c590c55cdb23420df?s=128&d=identicon&r=PG&f=1", "display_name": "swideer", "link": "https://stackoverflow.com/users/10031045/swideer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 51179167, "answer_count": 1, "score": 1, "last_activity_date": 1531081359, "creation_date": 1530709145, "last_edit_date": 1531081359, "question_id": 51174299, "link": "https://stackoverflow.com/questions/51174299/warn-before-sending-messages-outside-of-multiple-possible-internal-domains", "title": "Warn before sending messages outside of multiple possible internal domains?", "body": "<p>I'm trying to check if recipients of my e-mail are in our Global Address List in Outlook 2016.</p>\n\n<p>If all the recipients are internal (our GAL includes only internal addresses) then the message is released.</p>\n\n<p>If at least one of the recipients are external (from outside of GAL), then I should get a warning message, which will ask if I still want to send this e-mail.</p>\n\n<p>I tried <a href=\"https://stackoverflow.com/questions/47253329/vba-code-to-verify-email-address-found-in-outlook-global-address-list\">this</a> topic, but I need a solution without copying the addresses to external Excel spreadsheet.</p>\n\n<p>I also worked with <a href=\"https://www.slipstick.com/how-to-outlook/prevent-sending-messages-to-wrong-email-address/\" rel=\"nofollow noreferrer\">this</a> solution, but our company is big, and has multiple branches all around the globe. The cited solution checks if my domain is the same with the recipients domains. The problem occurs when I'm trying to send an e-mail to people from my company, but outside my region - I'm from EMEA, and e.g. I'm sending an e-mail to PAM. Unfortunately, this solution is not enough in this moment. Because PAM is using a different domain - the warning message occurs. </p>\n\n<p>The simplest way for me, would be to check the recipients in GAL, but I'm not sure if this is even possible.</p>\n\n<p>Code from the second solution below:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n Dim recips As Outlook.Recipients\n Dim recip As Outlook.Recipient\n Dim pa As Outlook.propertyAccessor\n Dim prompt As String\n Dim Address As String\n Dim lLen\n Dim strMyDomain\n Dim internal As Long\n Dim external As Long\n\nConst PR_SMTP_ADDRESS As String = \"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\"\n\n' non-exchange\n' userAddress = Session.CurrentUser.Address\n' use for exchange accounts\nuserAddress = Session.CurrentUser.AddressEntry.GetExchangeUser.PrimarySmtpAddress\nlLen = Len(userAddress) - InStrRev(userAddress, \"@\")\nstrMyDomain = Right(userAddress, lLen)\n\nSet recips = Item.Recipients\n For Each recip In recips\n Set pa = recip.propertyAccessor\n\nAddress = LCase(pa.GetProperty(PR_SMTP_ADDRESS))\n lLen = Len(Address) - InStrRev(Address, \"@\")\nstr1 = Right(Address, lLen)\n\n  If str1 = strMyDomain Then internal = 1\n  If str1 &lt;&gt; strMyDomain Then external = 1\nNext\n\n If internal + external = 2 Then\nprompt = \"This email is being sent to Internal and External addresses. Do you still wish to send?\"\n\n If MsgBox(prompt, vbYesNo + vbExclamation + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n    Cancel = True\n End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "shell"], "comments": [{"owner": {"reputation": 2102, "user_id": 7027964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9375ffaba941e8b2cb7454e5870c684b?s=128&d=identicon&r=PG&f=1", "display_name": "kosnik", "link": "https://stackoverflow.com/users/7027964/kosnik"}, "edited": false, "score": 0, "creation_date": 1530708241, "post_id": 51173791, "comment_id": 89330743, "body": "I suspect you need to pass the working directory path from VBA to the <code>python.exe</code> as an argument. The python program has no way to know otherwise which directory your excel file was. It is an independent process."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1530708840, "post_id": 51173791, "comment_id": 89331118, "body": "you can try to change the working directory of WScript with  <code>wsh.CurrentDirectory = ...</code> before the <code>wsh.Run ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7315144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zh8NM.jpg?s=128&g=1", "display_name": "Atik", "link": "https://stackoverflow.com/users/7315144/atik"}, "edited": false, "score": 0, "creation_date": 1530710988, "post_id": 51174132, "comment_id": 89332511, "body": "Thank you guys for all your help. None other than @Vincent&#39;s Answer worked perfectly. So I have used  <code>wsh.CurrentDirectory = Thisworkbook.path</code>  before <code>wsh.Run...</code> Thanks a lot...!"}], "tags": [], "owner": {"reputation": 104, "user_id": 6174826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc9c00862d09a4bd8ad70f56798dff90?s=128&d=identicon&r=PG&f=1", "display_name": "PythonParka", "link": "https://stackoverflow.com/users/6174826/pythonparka"}, "is_accepted": true, "score": 0, "last_activity_date": 1530708621, "creation_date": 1530708621, "answer_id": 51174132, "question_id": 51173791, "link": "https://stackoverflow.com/questions/51173791/automatically-changing-python-directory-after-running-python-script-from-excel-u/51174132#51174132", "title": "Automatically changing Python directory after running python script from excel using VBA", "body": "<p>Before saving the file you can use <code>os.chdir(some_path_to_directory)</code> to set the current working directory, and then save in this directory.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1530737153, "last_edit_date": 1530737153, "creation_date": 1530709083, "answer_id": 51174280, "question_id": 51173791, "link": "https://stackoverflow.com/questions/51173791/automatically-changing-python-directory-after-running-python-script-from-excel-u/51174280#51174280", "title": "Automatically changing Python directory after running python script from excel using VBA", "body": "<p>try specifying the path for your csv file:</p>\n\n<pre><code>import os.path\nsave_path = 'C:/example/'\ncsvName = os.path.join(save_path, \"Mycsv\"+\".csv\") \ncsvfile = open(csvName, \"w\")\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7315144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zh8NM.jpg?s=128&g=1", "display_name": "Atik", "link": "https://stackoverflow.com/users/7315144/atik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 51174132, "answer_count": 2, "score": 1, "last_activity_date": 1530737153, "creation_date": 1530707440, "question_id": 51173791, "link": "https://stackoverflow.com/questions/51173791/automatically-changing-python-directory-after-running-python-script-from-excel-u", "title": "Automatically changing Python directory after running python script from excel using VBA", "body": "<p>Thanks for looking at my problem.\nI have a python script which is writing a new csv file in my current directory. I have make it python.exe using pyinstaller. What I am doing is, running this exe file using VBA form excel on a button click. Problem is after running exe using VBA my csv is saving in default documents folder instead of folder where my python.exe is. But If I run the python.exe directly without VBA then it's saving csv in my current directory. So how can I save csv in current directory after running python.exe using VBA</p>\n\n<p>Here is my python code which creating new csv file:</p>\n\n<pre><code>csvfile = open(\"Mycsv\" + '.csv', 'w')\ncr = csv.writer(csvfile, dialect='excel')\n</code></pre>\n\n<p>I have also tried using: <code>csvfile = open(os.getcwd() + \"\\Mycsv\" + '.csv', 'w')</code> But didn't worked.</p>\n\n<p>Here is my VBA code:</p>\n\n<pre><code>    Dim wsh As Object\n    Set wsh = VBA.CreateObject(\"WScript.Shell\")\n    Dim waitOnReturn As Boolean: waitOnReturn = True\n    Dim windowStyle As Integer: windowStyle = 1\n    Dim errorCode As Integer\n    wsh.Run Chr(34) &amp; ThisWorkbook.path &amp; \"\\python.exe\" &amp; Chr(34), windowStyle, waitOnReturn\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1530707242, "post_id": 51173667, "comment_id": 89330104, "body": "<a href=\"https://www.jkp-ads.com/articles/apideclarations.asp\" rel=\"nofollow noreferrer\">jkp-ads.com/articles/apideclarations.asp</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530707420, "post_id": 51173667, "comment_id": 89330207, "body": "More on <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/ptrsafe-keyword\" rel=\"nofollow noreferrer\">PtrSafe</a>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530708261, "post_id": 51173667, "comment_id": 89330757, "body": "Private Declare PtrSafe Function as per links suggested"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1530708523, "post_id": 51173667, "comment_id": 89330912, "body": "You have two compiler issues. a) xl2007 uses VB6 and xl2010 (and up) uses VB7. b) You have one system on Win64 and one not. If you are planning to use compiler directives to cover multiple versions and platforms then decide if you are going to cover every possibility or just the ones you need."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1530708634, "post_id": 51173667, "comment_id": 89330991, "body": "Hi Marc - Have updated my original answer with the answer to this. <a href=\"https://stackoverflow.com/questions/50964442/how-to-create-nested-dropdowns-in-excel-vba-combo-boxes/50965620?noredirect=1#comment89329852_50965620\">link</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 3, "creation_date": 1530708647, "post_id": 51173667, "comment_id": 89331004, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50964442/how-to-create-nested-dropdowns-in-excel-vba-combo-boxes\">How to create &quot;nested&quot; dropdowns in Excel VBA combo boxes?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1530709031, "post_id": 51173667, "comment_id": 89331237, "body": "@Tom - good find! I think that posts covers basic compatibility."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1530709105, "post_id": 51173667, "comment_id": 89331291, "body": "@Tom thanks. I asked a new question here because I felt it was a different topic. But feel free to close if ever"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1530709288, "post_id": 51173667, "comment_id": 89331410, "body": "@MarcSantos That&#39;s fair - I just voted to close as you asked in two places and had answered it elsewhere"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1530732031, "post_id": 51179645, "comment_id": 89341992, "body": "<code>GetWindowLongA</code> returns a <code>Long</code>. <code>GetWindowLongPtr</code> does return a <code>LongPtr</code>, and it works for both x86 and x64, so there is no need for a branch to <code>GetWindowLongA</code> to begin with, just like you don&#39;t have it for <code>SetWindowLongPtrA</code>."}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 5, "last_activity_date": 1530731311, "last_edit_date": 1530731311, "creation_date": 1530731001, "answer_id": 51179645, "question_id": 51173667, "link": "https://stackoverflow.com/questions/51173667/how-to-convert-32-bit-excel-vba-code-to-run-on-64-bit-excel/51179645#51179645", "title": "How to convert 32-bit excel VBA code to run on 64-bit excel?", "body": "<p>I found this equivalences for x64 systems :</p>\n\n<pre><code>Private Declare PtrSafe Function FindWindow Lib \"user32\" _\nAlias \"FindWindowA\" ( _\nByVal lpClassName As String, _\nByVal lpWindowName As String) As LongPtr\n\n\n#If Win64 Then\n    Private Declare PtrSafe Function GetWindowLongPtr Lib \"user32\" _\n    Alias \"GetWindowLongPtrA\" ( _\n    ByVal hWnd As LongPtr, _\n    ByVal nIndex As Long) As LongPtr\n#Else\n    Private Declare PtrSafe Function GetWindowLongPtr Lib \"user32\" _\n    Alias \"GetWindowLongA\" ( _\n    ByVal hWnd As LongPtr, _\n    ByVal nIndex As Long) As LongPtr\n#End If\n\nPrivate Declare PtrSafe Function SetWindowLongPtr Lib \"user32\" _\nAlias \"SetWindowLongPtrA\" ( _\nByVal hWnd As LongPtr, _\nByVal nIndex As Long, _\nByVal dwNewLong As LongPtr) As LongPtr\n\nPublic Declare PtrSafe Function DrawMenuBar Lib \"user32\" ( _\nByVal hWnd As LongPtr) As Long\n</code></pre>\n\n<p>Source : <a href=\"https://www.jkp-ads.com/articles/apideclarations.asp\" rel=\"noreferrer\">https://www.jkp-ads.com/articles/apideclarations.asp</a></p>\n\n<p>I didn't try the functions, I only past this code and it isn't highlighted in red despite of your version in your answer.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8947, "favorite_count": 3, "answer_count": 1, "score": 7, "last_activity_date": 1607115684, "creation_date": 1530707125, "question_id": 51173667, "link": "https://stackoverflow.com/questions/51173667/how-to-convert-32-bit-excel-vba-code-to-run-on-64-bit-excel", "title": "How to convert 32-bit excel VBA code to run on 64-bit excel?", "body": "<p>I am able to use these codes in my Excel 2007 at the office, but how come I cannot use it in my Excel 2016?</p>\n\n<p>It says that it isn't built on 64-bit, but how do I convert it? The code below is highlighted in red.</p>\n\n<pre><code>Private Declare Function FindWindow Lib \"User32\" _\nAlias \"FindWindowA\" ( _\nByVal lpClassName As String, _\nByVal lpWindowName As String) As Long\n\nPrivate Declare Function GetWindowLong Lib \"User32\" _\nAlias \"GetWindowLongA\" ( _\nByVal hwnd As Long, _\nByVal nIndex As Long) As Long\n\nPrivate Declare Function SetWindowLong Lib \"User32\" _\nAlias \"SetWindowLongA\" (ByVal hwnd As Long, _\nByVal nIndex As Long, _\nByVal dwNewLong As Long) As Long\n\nPrivate Declare Function DrawMenuBar Lib \"User32\" ( _\nByVal hwnd As Long) As Long\n</code></pre>\n\n<p>Error is shown below:\n<a href=\"https://i.stack.imgur.com/CbJ4g.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/CbJ4g.png\" alt=\"Error\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530707457, "post_id": 51173584, "comment_id": 89330232, "body": "Why <code>100136  2,000,000   681500</code> in one and <code>123456  2,000,000   681500</code> in the other?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530708237, "post_id": 51173584, "comment_id": 89330739, "body": "@SunilT is your &quot;Super&quot; column always sorted? (eg. <code>12345</code> will always follow <code>12345</code> until a Super Change, or can it also be like <code>12345</code>, <code>41415</code>, <code>12345</code>) ??"}, {"owner": {"reputation": 1, "user_id": 9994241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c5aa03b29349b393d6df38b9a5e21f5?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil T", "link": "https://stackoverflow.com/users/9994241/sunil-t"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530765354, "post_id": 51173584, "comment_id": 89348760, "body": "@rawrplus super customer column will be always sorted before the report is prepared."}, {"owner": {"reputation": 1, "user_id": 9994241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c5aa03b29349b393d6df38b9a5e21f5?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil T", "link": "https://stackoverflow.com/users/9994241/sunil-t"}, "edited": false, "score": 0, "creation_date": 1530765519, "post_id": 51173584, "comment_id": 89348793, "body": "@Jeeped super customer numbers will be different but Super Cust Credit Limit and Super Cust Balance can be same for other customers as well"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1530708419, "creation_date": 1530708419, "answer_id": 51174068, "question_id": 51173584, "link": "https://stackoverflow.com/questions/51173584/deleting-duplicate-rows-in-excel-and-leaving-the-deleted-cells-blank/51174068#51174068", "title": "deleting duplicate rows in excel and leaving the deleted cells blank", "body": "<pre><code> Sub KillEm\n dim c as range\n dim lastrow as long\n lastrow = cells(rows.count,3).end(xlup).row\n set c = range(\"c2\")\n c.currentregion.sort key1:=c,key2:=c.offset(0,1)\n Do\n if c = c.offset(1,0) and c.offset(0,1)=c.offset(1,1) then\n      c.offset(1,0).entirerow.clearcontents\n      set c = c.offset(1,0)\n end if\n set c = c.offset(1,0)\n Loop until c.row &gt; lastrow\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9994241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c5aa03b29349b393d6df38b9a5e21f5?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil T", "link": "https://stackoverflow.com/users/9994241/sunil-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1530708419, "creation_date": 1530706888, "last_edit_date": 1531161705, "question_id": 51173584, "link": "https://stackoverflow.com/questions/51173584/deleting-duplicate-rows-in-excel-and-leaving-the-deleted-cells-blank", "title": "deleting duplicate rows in excel and leaving the deleted cells blank", "body": "<p>I have a worksheet with ~600+ rows of data and 20 columns. A lot of the values in column C (customer Numbers) and D (credit limit) are duplicates, and I would like to delete those duplicates. The problem I'm able to delete the duplicates customer numbers in Columns C using </p>\n\n<pre><code>=IF(C3=\"\",\"\",IF(COUNTIF($C2:C657,C3)=1,C3,\"\")\n</code></pre>\n\n<p>... but I'm not able to use same for Col D since many customers will be having same CL limits.</p>\n\n<p>Is there a way to do this for each data in Col C and D in the worksheet by giving criteria as Col C? I imagine it involves \"For Each...\", but i don't have a lot of experience with that and haven't been able to find any other macros that can complete this task. Let me know if you need me to elaborate on what I am trying to accomplish.</p>\n\n<p>Data at present:</p>\n\n<pre><code>Super Customer Number   Super Cust Credit Limit Super Cust Balance \n12345   7,000,000   3954758.62\n12345   7,000,000   3954758.62\n12345   7,000,000   3954758.62\n12345   7,000,000   3954758.62\n12345   7,000,000   3954758.62\n123456  6,000,000   4634651.09\n100136  2,000,000   681500\n100131  8,000,000   9159719.01\n100131  8,000,000   9159719.01\n</code></pre>\n\n<p>Data should be after running macros:</p>\n\n<pre><code>Super Customer Number   Super Cust Credit Limit Super Cust Balance \n12345   7,000,000   3954758.62\n12345       \n12345       \n12345       \n12345       \n123456  6,000,000   4634651.09\n123456  2,000,000   681500\n100131  8,000,000   9159719.01\n100131      \n</code></pre>\n"}, {"tags": ["excel", "vba", "sap-gui"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530704772, "post_id": 51172626, "comment_id": 89328500, "body": "Be aware that VBA and VBScript are 2 totally different languages. Please clarify which one of them you actually mean and adjust your question and tags."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1530705048, "post_id": 51172626, "comment_id": 89328677, "body": "Good question, but I guess you probably just can&#39;t"}, {"owner": {"reputation": 65, "user_id": 10031771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Krscw.png?s=128&g=1", "display_name": "ViktorovicsL", "link": "https://stackoverflow.com/users/10031771/viktorovicsl"}, "edited": false, "score": 0, "creation_date": 1530715577, "post_id": 51172626, "comment_id": 89335292, "body": "I still hope, that there is a solution for that. I have searched everywhere in google, but no luck."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10031771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Krscw.png?s=128&g=1", "display_name": "ViktorovicsL", "link": "https://stackoverflow.com/users/10031771/viktorovicsl"}, "edited": false, "score": 0, "creation_date": 1544091547, "post_id": 51259584, "comment_id": 94156549, "body": "Hi! Sorry for the very late reply. That kinda solved the problem, thank you!"}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": true, "score": 1, "last_activity_date": 1531986784, "last_edit_date": 1531986784, "creation_date": 1531208223, "answer_id": 51259584, "question_id": 51172626, "link": "https://stackoverflow.com/questions/51172626/stop-transaction-in-sap-with-vba/51259584#51259584", "title": "Stop transaction in SAP with VBA", "body": "<p>It is assumed that the VBA macro is running in the first session. If a second session is opened before starting the macro, it can be used to close the first session.</p>\n\n<p>for example:</p>\n\n<pre><code>Set SapGuiAuto  = GetObject(\"SAPGUI\")\nSet SAPapp = SapGuiAuto.GetScriptingEngine\nSet SAPconnection = SAPapp.Children(0)\nSet session    = SAPconnection.Children(1)\n\nsession.findById(\"wnd[0]/tbar[0]/okcd\").text = \"/i1\"\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.createSession\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nsession.findById(\"wnd[0]/tbar[0]/okcd\").text = \"/i3\"\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.createSession\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n</code></pre>\n\n<p>Whether a \"rollback\" is carried out or not, would be to test.</p>\n\n<p>Regards,\nScriptMan</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4787699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvzp0.jpg?s=128&g=1", "display_name": "lazov", "link": "https://stackoverflow.com/users/4787699/lazov"}, "is_accepted": false, "score": 1, "last_activity_date": 1572532932, "last_edit_date": 1572532932, "creation_date": 1571229241, "answer_id": 58413446, "question_id": 51172626, "link": "https://stackoverflow.com/questions/51172626/stop-transaction-in-sap-with-vba/58413446#58413446", "title": "Stop transaction in SAP with VBA", "body": "<p>I guess you better record a script with this scenario, then you can re-use it any time.\nOtherwise, I am at the very moment struggling with the same case, but with the run time counter part to leave the tcode if running too long.\nIt is a hart nut to crack too, but a different topic.</p>\n\n<p>Update: realizing that there is no way to get the 'Stop Transaction' step recorded, I applied the above method - thank you Script Man, it was not the first time you saved the day.\nFor anyone reading this thread - may be useful to know how to split the SAP runtime from VBA script runtime.\nI introduced an object that is the 'Execute' command itself. This way, SAP takes the command and starts execution, while the macro will step over as it is not an actual command but applying a new object only. This trick can help users to write a time counter and drop the session if running too long.\nFor reference, see my code here - I quoted the part of my code that contains the relevant method.</p>\n\n<pre><code>'check whether you already have an extra session open to close the long running session\n'open one if needed\nOn Error Resume Next\nSet session1 = Connection.Children(1)\nIf Err.Number &lt;&gt; 0 Then\n   session.CreateSession\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n    're-set the sessions, ensuring you use the first session for actual work and keep session1 in background\n    Set session = Connection.Children(0)\n    Set session1 = Connection.Children(1)\n    SesCount = Connection.Sessions.Count()\n    Err.Clear\nOn Error GoTo 0\nEnd If\n\n'get the ID of first session, so you can enter the correct terminating transaction code when needed\nsessionID = Mid(session.ID, (InStrRev(session.ID, \"[\") + 1), 1)\nTerminator = \"/i\" &amp; sessionID + 1\nsession.FindById(\"wnd[0]\").Maximize\n\n'some code comes here\n\n'here I use an object to apply the execute button - this way parallel with the SAP runtime, the VBA script can proceed.\nperec = session.FindById(\"wnd[0]/tbar[1]/btn[8]\").press\n\n'here we set a loop to check whether system is busy over a certain time then we may interrupt:\nDo\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\nSecondsElapsed = SecondsElapsed + 5\nfityirc = session.Busy()\nif fityirc = False then\nexit Do\nend if\nLoop Until SecondsElapsed &gt;= 100\n\n\nIf fityirc = True Then\nsession1.FindById(\"wnd[0]/tbar[0]/okcd\").Text = Terminator\nsession1.FindById(\"wnd[0]\").sendVKey 0\nEnd If\n\n'...and so on. This solution is applied in a loop to extract datasets massively without human interaction.\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10031771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Krscw.png?s=128&g=1", "display_name": "ViktorovicsL", "link": "https://stackoverflow.com/users/10031771/viktorovicsl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1704, "favorite_count": 0, "accepted_answer_id": 51259584, "answer_count": 2, "score": 3, "last_activity_date": 1610180459, "creation_date": 1530703778, "last_edit_date": 1610180459, "question_id": 51172626, "link": "https://stackoverflow.com/questions/51172626/stop-transaction-in-sap-with-vba", "title": "Stop transaction in SAP with VBA", "body": "<p>I have a working VBA macro which enters SAP, starts a transaction and then extracts the data in spreadsheet.</p>\n<p>But sometimes the calculation runs too long, or I just would like to stop it to intervene. There is a functionality on the toolbar at the top left corner, where the user can &quot;stop transaction&quot; manually.</p>\n<p>Is there any SAP script code for the &quot;stop transaction&quot; button, so I can avoid the manual step?</p>\n<p>SAP toolbar:</p>\n<img src=\"https://i.stack.imgur.com/jLMvO.jpg\" width=\"200\" alt=\"SAP toolbar\">\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 0, "creation_date": 1530703265, "post_id": 51172418, "comment_id": 89327503, "body": "You should use If statement. Check cells value and populate a string in case of &#39;true&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1530704704, "creation_date": 1530704704, "answer_id": 51172902, "question_id": 51172418, "link": "https://stackoverflow.com/questions/51172418/how-to-return-value-in-another-cell-if-a-cell-contains-certain-text-in-excel-mac/51172902#51172902", "title": "how to return value in another cell if a cell contains certain text in excel Macro", "body": "<p>In <strong>B13</strong> enter:</p>\n\n<pre><code>=IF(B14=\"Jun\",$Q$4,\"\")\n</code></pre>\n\n<p>and copy across.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10031790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c1e22cff28b7bb1d388cf930b2fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "niki1419", "link": "https://stackoverflow.com/users/10031790/niki1419"}, "edited": false, "score": 0, "creation_date": 1530872548, "post_id": 51174094, "comment_id": 89397199, "body": "It Works , Thank you (y) ."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1530708484, "creation_date": 1530708484, "answer_id": 51174094, "question_id": 51172418, "link": "https://stackoverflow.com/questions/51172418/how-to-return-value-in-another-cell-if-a-cell-contains-certain-text-in-excel-mac/51174094#51174094", "title": "how to return value in another cell if a cell contains certain text in excel Macro", "body": "<p>Try this code:</p>\n\n<pre><code>Sub PopulateCells()\n    Dim rng As Range, c As Range\n    Set rng = Range(\"B14:Z14\")\n\n    For Each c In rng\n        If InStr(1, c.Value, \"Jun\") &gt; 0 Then c.Offset(-1, 0).Value = \"Q4\" \n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10031790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c1e22cff28b7bb1d388cf930b2fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "niki1419", "link": "https://stackoverflow.com/users/10031790/niki1419"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5609, "favorite_count": 0, "accepted_answer_id": 51174094, "answer_count": 2, "score": -1, "last_activity_date": 1530708484, "creation_date": 1530703129, "last_edit_date": 1531164843, "question_id": 51172418, "link": "https://stackoverflow.com/questions/51172418/how-to-return-value-in-another-cell-if-a-cell-contains-certain-text-in-excel-mac", "title": "how to return value in another cell if a cell contains certain text in excel Macro", "body": "<p>how to return value in another cell if a cell contains certain text in excel using VBA. \nFor suppose if any cell in range B14 to Z14 contains \"Jun\" then the cell above that should be populated with Q4, and so on. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1530702323, "post_id": 51172131, "comment_id": 89326933, "body": "If <code>a</code> is numeric, then you convert to int <code>b</code> but you never use <code>b</code> and you attempt using <code>a</code> regardless."}, {"owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1530702717, "post_id": 51172131, "comment_id": 89327163, "body": "Oh my god i&#39;m stupid. I&#39;ll try it and see if it works."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530703699, "post_id": 51172131, "comment_id": 89327796, "body": "Are you printing to a file? <code>PrintToFile:=True</code>"}, {"owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "edited": false, "score": 0, "creation_date": 1530708048, "post_id": 51172131, "comment_id": 89330601, "body": "Okay i&#39;m back, sorry for the wait. It still does not print. Do i need to specify a certain printer?"}], "owner": {"reputation": 67, "user_id": 6657255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbeea2f1e2025251ac10b175f5363907?s=128&d=identicon&r=PG&f=1", "display_name": "Linexxlol", "link": "https://stackoverflow.com/users/6657255/linexxlol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530702156, "creation_date": 1530702156, "question_id": 51172131, "link": "https://stackoverflow.com/questions/51172131/how-do-i-create-a-button-in-excel-that-will-print-my-sheet-an-x-number-of-times", "title": "How do i create a button in excel that will print my sheet an X number of times specified by the user?", "body": "<p>so i have this code</p>\n\n<pre><code>Sub PrintArk()\n\nDim a As Variant\nDim b As Integer\n\na = InputBox(\"Antal kopier\")\nIf Not IsNumeric(a) Then\n    MsgBox \"Det var ikke et tal. Try 'End' for at g\u00e5 tilbage\"\nElse\nb = CInt(a)\nEnd If\n\nActiveSheet.PrintOut From:=1, To:=1, PrintToFile:=True, Copies:=a, PrToFileName:=\"Label\"\n\nEnd Sub\n</code></pre>\n\n<p>Which when the user presses a button that this is assigned to, it will ask how many copies and and it will give the \"Now printing\" splash screen thingy. \nHowever it doesn't actually print despite it saying it does.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530701651, "post_id": 51171906, "comment_id": 89326474, "body": "This works. I just tried this with a value &quot;Hi!&quot; in C1, and then the value &quot;C1&quot; written in cell A1. When run, the cell B1 duplicates the &quot;Hi!&quot; - what was it supposed to do?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1530701840, "post_id": 51171906, "comment_id": 89326594, "body": "Are you familiar with the INDIRECT function? It sounds like what you&#39;re trying to do"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1530701903, "post_id": 51171906, "comment_id": 89326641, "body": "You could use the formula <code>=CELL(&quot;address&quot;,A1)</code> in <code>B1</code> and drag down.  This will give you the absolute address - <code>$A$1</code>.  Is that what you&#39;re after but using VBA?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1530701909, "post_id": 51171906, "comment_id": 89326645, "body": "Oh, I think you want <code>Sheet1.Range(&quot;B1&quot;).Value = Sheet1.Range(&quot;A1&quot;).Address</code>"}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530701957, "post_id": 51171906, "comment_id": 89326679, "body": "@Darren Bartrup-Coop: That is exactly what I am looking for in VBA."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1530701987, "post_id": 51171906, "comment_id": 89326700, "body": "In that case - it&#39;s just what @jamheadart has commented."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1530702231, "post_id": 51172078, "comment_id": 89326867, "body": "If you place in a function you can use as a worksheetfunction as well - <code>Public Function GetMyAddress(Cell_Ref As Range) As String: GetMyAddress = Cell_Ref.Address: End Function</code>."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530702351, "post_id": 51172078, "comment_id": 89326955, "body": "Good addition - <code>Address</code> is a very handy property I use often - not quite sure what OP&#39;s final goal is though"}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1530702735, "post_id": 51172078, "comment_id": 89327178, "body": "@jamheadart: Exactly, what I was looking for. Thanks a lot for your answer."}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 1, "last_activity_date": 1530712170, "last_edit_date": 1530712170, "creation_date": 1530702007, "answer_id": 51172078, "question_id": 51171906, "link": "https://stackoverflow.com/questions/51171906/getting-cell-reference-via-vba/51172078#51172078", "title": "Getting cell reference via VBA", "body": "<p>To get the full address of Cell A1 into Cell B1 you can use the function:</p>\n\n<pre><code>Sub AdressCell ()\nSheet1.Range(\"B1\").Value = Sheet1.Range(\"A1\").Address\nEnd Sub\n</code></pre>\n\n<p>To get rid of the absolute references you can use:</p>\n\n<pre><code>Sub AdressCell ()\nSheet1.Range(\"B1\").Value = Sheet1.Range(\"A1\").Address(False, False)\nEnd Sub\n</code></pre>\n\n<p>For only getting the Column you can use:</p>\n\n<pre><code>Sub AdressColumn ()\nSheet1.Range(\"B1\").Value = Sheet1.Range(\"A1\").Column\nEnd Sub\n</code></pre>\n\n<p>For only getting the rows you can use:</p>\n\n<pre><code>Sub AdressRow ()\nSheet1.Range(\"B1\").Value = Sheet1.Range(\"A1\").Row\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51172078, "answer_count": 1, "score": 1, "last_activity_date": 1530712170, "creation_date": 1530701470, "last_edit_date": 1531161705, "question_id": 51171906, "link": "https://stackoverflow.com/questions/51171906/getting-cell-reference-via-vba", "title": "Getting cell reference via VBA", "body": "<p>In my Excel spreadsheet I want to insert the cell reference from <strong>Cell A1</strong> into <strong>Cell B1</strong> via VBA. <br>In the end the spreadsheet should look like this:</p>\n\n<pre><code>     A       B\n1           A1\n2\n3\n4\n</code></pre>\n\n<p><strong>Cell B1</strong> is filled by running a VBA that gets the cell reference from <strong>Cell A1</strong>. <br> I tried the following VBA but could not make it work (runtime error 1001):</p>\n\n<pre><code>Sub test()\nSheet1.Range(\"B1\").Value = Sheet1.Range(Sheet1.Range(\"A1\").Value)\nEnd Sub\n</code></pre>\n\n<p>What do I need to change in my VBA to solve my issue?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 73, "user_id": 8931717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a66ac648f4c79fcdff3f71ebd65bddbd?s=128&d=identicon&r=PG&f=1", "display_name": "SenthamilVM", "link": "https://stackoverflow.com/users/8931717/senthamilvm"}, "edited": false, "score": 0, "creation_date": 1530705750, "post_id": 51172059, "comment_id": 89329150, "body": "Pleased to hear it. Would you mind accepting the answer which will just take me over the 9k mark?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1530701961, "creation_date": 1530701961, "answer_id": 51172059, "question_id": 51171893, "link": "https://stackoverflow.com/questions/51171893/copy-data-according-to-the-length-of-the-adjucent-column/51172059#51172059", "title": "copy data according to the length of the adjucent column", "body": "<p>Try this (\"O3\" &amp; Rows.Count caused problems). Also no need to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?s=1%7C193.8044\">select cells</a>.</p>\n\n<pre><code>Columns(\"Q:Q\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nDim lastRow As Long\nlastRow = Range(\"O\" &amp; Rows.Count).End(xlUp).Row\nRange(\"P4:P\" &amp; lastRow).Copy Range(\"Q4\")\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8931717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a66ac648f4c79fcdff3f71ebd65bddbd?s=128&d=identicon&r=PG&f=1", "display_name": "SenthamilVM", "link": "https://stackoverflow.com/users/8931717/senthamilvm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 51172059, "answer_count": 1, "score": 0, "last_activity_date": 1530701987, "creation_date": 1530701445, "last_edit_date": 1531161705, "question_id": 51171893, "link": "https://stackoverflow.com/questions/51171893/copy-data-according-to-the-length-of-the-adjucent-column", "title": "copy data according to the length of the adjucent column", "body": "<pre><code>Columns(\"Q:Q\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nDim lastRow As Long\nlastRow = Range(\"O3\" &amp; Rows.Count).End(xlUp).Row\nRange(\"P4:P\" &amp; lastRow).Select\nSelection.Copy\nRange(\"Q4\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I am trying to insert a column next to Q column, copy the data from P column based on the length of the adjacent column (\"O\") and paste the data into the inserted column.</p>\n\n<p>Above is the code I am using to achieve this. But the problem is column P and O don't have the same length of data every time.</p>\n\n<p>I am not sure what I am missing here. Someone correct me where I am doing it wrong.</p>\n\n<p>Thanks in Advance!</p>\n"}, {"tags": ["excel", "ado", "vba"], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1530722324, "post_id": 51177892, "comment_id": 89338508, "body": "what is weird is that the format is as expected but not the way the cell is displayed. Once the format was set and if I enter the cell and press carriage return the good format appears. I made progress by the time doing <b>.Value = . Value</b> . It worked but for the integer neither percentage case ! I ll look over what the Style property is for the range Object."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1530785858, "post_id": 51177892, "comment_id": 89359070, "body": "@pascalsautot I&#39;ve tested the updated version of my answer and it will force the cell to be shown in the right format, please do try it and let me know if any further issues."}, {"owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1530887170, "post_id": 51177892, "comment_id": 89405977, "body": "This is what I came up with. Still lopping over cells for large ranges (1000 x 200 cells) is not an ideal solution. Never the less I d like to understand the logics behind all this and why when a format is set it is not applied. What .value = .value is hiding. In I all languages I have practiced this kind of assignment should not change anything unless the setting of value (even if it does not change) trigger event behind which seems to be the case.  That kind of trick is not documented or my eyes did come to cross over it. As such your help was kind but does not answer my questions."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1530785892, "last_edit_date": 1530785892, "creation_date": 1530721806, "answer_id": 51177892, "question_id": 51171663, "link": "https://stackoverflow.com/questions/51171663/excel-range-format-not-rendered-as-expected-conversion-issue/51177892#51177892", "title": "Excel range Format not rendered as expected (conversion issue)", "body": "<p>I'm not sure if this will answer your question, but it might help, the following will convert a specified range into Currency (ignoring blank cells):</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"B1:B13\").Style = \"Currency\"\n'set the currency format for a specified range\n</code></pre>\n\n<p>Or to be more specific you could do something like below:</p>\n\n<pre><code>Dim rng As Range, c as Range\nSet rng = Range(\"A1:A50\") 'set the range to be used\n\nFor Each c In rng 'for each cell in the specified range\n    If c.Value &lt;&gt; \"\" Then c.NumberFormat = \"$#,##0.00\"\n    'if cell is not blank then format it\nNext c\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<pre><code>Dim rng As Range, c as Range\nSet rng = Range(\"A1:A50\") 'set the range to be used\n\nFor Each c In rng 'for each cell in the specified range\n    If c.Value &lt;&gt; \"\" Then c.NumberFormat = \"$#,##0.00\"\n    'if cell is not blank then format it\n    c.Value = c.Value\n    'force the format into the cell\nNext c\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530785892, "creation_date": 1530700603, "last_edit_date": 1531164843, "question_id": 51171663, "link": "https://stackoverflow.com/questions/51171663/excel-range-format-not-rendered-as-expected-conversion-issue", "title": "Excel range Format not rendered as expected (conversion issue)", "body": "<p>The context : I have a sheet called \"ForUser\" with first row defining headers, following row corresponding to data. I have a second sheet called \"ForBuffer\" to retreive data from a data base.</p>\n\n<p><a href=\"https://i.stack.imgur.com/k1y3z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k1y3z.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Each column in \"ForUser\" is associated with a format, applied dynamically (the format can be set up by the user and changed). In the example below there is a column header with value \"Att $\" in \"ForUser\" sheet which format is dollar.</p>\n\n<pre><code>    Dim objRs As ADODB.Recordset\n    Dim rngDataBuffer As Range\n    With Application.Workbooks(ThisWorkbook.Name()).Sheets(\"ForBuffer\")\n        Set rngDataBuffer = .Range(\"A1\")\n    End With\n    rngDataBuffer.CopyFromRecordset Data:=objRs\n</code></pre>\n\n<p>Data are loaded column by column from a data base and copied to a range using <strong>CopyFromRecordset</strong> with data parameter set to a valid <strong>ADODB.Recordset</strong> into the sheet called \"ForBuffer\"</p>\n\n<pre><code>  Dim rDest As Range\n  With Application.Workbooks(ThisWorkbook.Name()).Sheets(\"ForBuffer\")\n      With .Range(\"A1\").CurrentRegion\n       set rDest= .rows(1).Find( _\n          What:=\"Att $\", MatchCase:=True, LookIn:=xlFormulas, lookAt:=xlWhole)\n      End With\n  End With \n</code></pre>\n\n<p>This buffer is then copied to the \"ForUser\" sheet in column where \"Att $\" header is defined. Some cells have a value set some don't.</p>\n\n<pre><code>  rngDataBuffer.Copy Destination:=rDest\n</code></pre>\n\n<p>I could have copied data stored in <strong>objRs</strong> directly in rDest (but that not the point) using something like</p>\n\n<pre><code>rDest.Offset(1).CopyFromRecordset Data:=objRs\n</code></pre>\n\n<p>Offset(1) is necessary to preserve the first row where there is \"Att $\" header.</p>\n\n<p>Data are saved as string on the data base side, hence then fall has strings in <strong>rngDataBuffer</strong></p>\n\n<p>Afterwards I apply the format using something like :</p>\n\n<pre><code> rDest.Offset(1).Resize(rDest.rows.count-1).NumberFormat = \"#,##0.00 [$USD]\"\n</code></pre>\n\n<p>for other types I use (dollar currency, text, percentage, float, integer)</p>\n\n<pre><code>                    .NumberFormat = \"#,##0.00 $\"\n                    .NumberFormat = \"@\"\n                    .NumberFormat = \"0.00%\"\n                    .NumberFormat = \"0.0\"\n                    .NumberFormat = \"0\"\n</code></pre>\n\n<p>I can check that the format is set but not rendered probably because the data have been copied as strings.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Oh0yx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Oh0yx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How can convert a range of cells to some 'type' (here I say 'type' because 'format' seems to be just the way it looks). ?</p>\n\n<p>I tried to Copy value 1 from some cell and then PasteSpecial with different options. I can get the expected format rendered but this has the drawback to set a 0 (zero) in cells which had no content (null or empty). A zero cell value or an empty cell has a different meaning in the context of my application. Also this solution does not work to render dates.</p>\n\n<p>I also tried to convert data according to the type. It fails all the time with a very explicit message : Type mismatch (error 13). Value is a string but they in deed can be converted to the expected type. The conversion is applied to a range value (multiple cells)</p>\n\n<p>For date </p>\n\n<pre><code> .Value = CDate(.Value)\n</code></pre>\n\n<p>For numeric \"types\" (integer, float and currency respectively)</p>\n\n<pre><code>.Value = CLgn(.Value)\n.Value = CDbl(.Value)\n.Value = CCur(.Value)\n</code></pre>\n\n<p>None of this worked. </p>\n\n<p>I came up with something which realy left me quite astonished </p>\n\n<pre><code>.Value = .Value \n</code></pre>\n\n<p>What's the heck or should i ask what is the magic behind this. By the way this works for Date, currency and double  not for integer neither for percentage !</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530701139, "post_id": 51171657, "comment_id": 89326151, "body": "After watching <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;t=3123s&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>, you should be able to write a macro that loops over <code>Range(&quot;A1:A150&quot;)</code>.  Next record a macro of you creating a workbook in the proper format.  If you get stuck comeback and post you code attempts.  Alternatively, try <a href=\"https://www.upwork.com/\" rel=\"nofollow noreferrer\">Upwork</a>."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1530708959, "post_id": 51171657, "comment_id": 89331203, "body": "Are the 150 copies going to be identical?"}, {"owner": {"reputation": 1, "user_id": 10031594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee30cae61003c6a066e5e5439810e04?s=128&d=identicon&r=PG&f=1", "display_name": "atee", "link": "https://stackoverflow.com/users/10031594/atee"}, "edited": false, "score": 0, "creation_date": 1530802174, "post_id": 51171657, "comment_id": 89370069, "body": "Yes, the 150 will be identical at the point of saving them from the template as new files.  Then the team will work on the individual files and add different information to them manually.  this bit cannot be automated.  I just need 150 copies of the template with the new names from the list.  Thanks,"}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530703822, "post_id": 51172456, "comment_id": 89327866, "body": "The OP wants to create 150 Workbooks, not Worksheets."}], "tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": false, "score": 0, "last_activity_date": 1530703271, "creation_date": 1530703271, "answer_id": 51172456, "question_id": 51171657, "link": "https://stackoverflow.com/questions/51171657/vba-create-new-workbooks-using-another-workbook-as-a-template-and-naming-each-n/51172456#51172456", "title": "VBA. Create new workbooks using another workbook as a template and naming each new workbook from a list", "body": "<p>This code should help you:</p>\n\n<pre><code>Sub Sample()\n    Dim wsToCopy As Worksheet, wsNew As Worksheet\n\n    With Sheets(\"Sheet1\")\n        LastRow = Sheets(\"Sheet1\").Cells(.Rows.Count, 1).End(xlUp).Row\n\n        For a = 1 To LastRow\n            Set wsToCopy = ThisWorkbook.Sheets(\"TemplateSheet\")\n            Set wsNew = ThisWorkbook.Sheets.Add\n            wsNew.Name = Sheets(\"Sheet1\").Cells(a, 1).Value\n            wsToCopy.Cells.Copy wsNew.Cells\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Explaining:\nAt a sheet named <strong>\"Sheet1\"</strong>, you need to have a list of the to-create sheets names, starting at the first row, always in the first column.</p>\n\n<p>The macro will create a new sheet, rename-it and copy everything from the sheet <strong>\"TemplateSheet\"</strong>. And then, will pass to the next Sheet1's row.</p>\n\n<p>So basically, just name your template sheet as \"TemplateSheet\" and add the 150 names at the first row of \"Sheet1\".</p>\n\n<p>You can delete the template and the Sheet1 later.</p>\n"}], "owner": {"reputation": 1, "user_id": 10031594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee30cae61003c6a066e5e5439810e04?s=128&d=identicon&r=PG&f=1", "display_name": "atee", "link": "https://stackoverflow.com/users/10031594/atee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 736, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530714882, "creation_date": 1530700586, "last_edit_date": 1530714882, "question_id": 51171657, "link": "https://stackoverflow.com/questions/51171657/vba-create-new-workbooks-using-another-workbook-as-a-template-and-naming-each-n", "title": "VBA. Create new workbooks using another workbook as a template and naming each new workbook from a list", "body": "<p>I have a workbook that I need to create 150 copies of.  I have the list of what I want to save each new workbook as in cells A1 to A150 in another workbook.</p>\n\n<p>I've looked around but I can't find any code that does what I need.  If it makes it easier, I could put the list into the template workbook, but would need to delete that sheet from each new workbook before saving and closing it.</p>\n"}, {"tags": ["vba", "image", "excel", "detect"], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1530702199, "creation_date": 1530702199, "answer_id": 51172144, "question_id": 51171601, "link": "https://stackoverflow.com/questions/51171601/excel-macro-vba-check-if-image-is-in-cell/51172144#51172144", "title": "Excel Macro VBA - Check if Image is in Cell", "body": "<p>Here is the code for my Answer. :)</p>\n\n<pre><code>Function isImageInRange(Target As Range) As Boolean\n    Dim pic As Picture\n    Dim PictureRanges As Range\n\n    With Target.Parent\n        For Each pic In .Pictures\n            With Range(pic.TopLeftCell, pic.BottomRightCell)\n                If PictureRanges Is Nothing Then\n                    Set PictureRanges = .Cells\n                Else\n                    Set PictureRanges = Union(PictureRanges, .Cells)\n                End If\n            End With\n        Next\n    End With\n\n    If Not PictureRanges Is Nothing Then isImageInRange = Not Intersect(Target, PictureRanges) Is Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9907666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530703786, "creation_date": 1530700409, "last_edit_date": 1530703786, "question_id": 51171601, "link": "https://stackoverflow.com/questions/51171601/excel-macro-vba-check-if-image-is-in-cell", "title": "Excel Macro VBA - Check if Image is in Cell", "body": "<p>I have a macro that inserts image in a cell when clicking on the cell.</p>\n\n<p>When you click on the which already has an image, the macro repeats and there are 2 Images in the cell.</p>\n\n<p>But I want to limit it. When there is already an Image in the cell, the Macro should do nothing.</p>\n\n<p>How to achieve it?</p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Column = 20 Then\n        Call Makro1\n    End If\nEnd Sub\n\n\nSub Makro1()\n    On Error GoTo Ende\n\n    Application.Cursor = xlWait\n    ActiveSheet.Pictures.Insert( _\n    ThisWorkbook.Path &amp; \"\\Fotos\\\" &amp; Range(\"A\" &amp; ActiveCell.Row).Value &amp; \".jpg\" _\n      ).Select\n    Selection.ShapeRange.ScaleWidth 0.28, msoFalse, msoScaleFromTopLeft\n    Selection.ShapeRange.ScaleHeight 0.28, msoFalse, msoScaleFromTopLeft\n    Selection.ShapeRange.LockAspectRatio = msoFalse\n    Selection.ShapeRange.IncrementLeft 4\n    Selection.ShapeRange.IncrementTop 4\n    Selection.Placement = xlMoveAndSize\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection.ShapeRange.Item(1), Address:= _\n      \"Fotos\\\" &amp; Range(\"A\" &amp; ActiveCell.Row).Value &amp; \".jpg\"\n    Range(\"A1\").Select\n    Application.Cursor = xlDefault\n\nEnde:\n    Application.Cursor = xlDefault\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "database", "vba", "ms-access", "adodb"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1530698671, "post_id": 51170879, "comment_id": 89324614, "body": "<a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server?view=sql-server-2017\" rel=\"nofollow noreferrer\">SQLOLEDB</a> seems to be deprecated, see MSOLEDBSQL. Why do you have parenthesis around your request?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1530698768, "post_id": 51170879, "comment_id": 89324668, "body": "As you don&#39;t seem to care about the current values there is no reason to SELECT, just execute an UPDATE instead."}, {"owner": {"reputation": 19, "user_id": 6677398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f24473765d33d9f1ac50b48dc7547f5?s=128&d=identicon&r=PG&f=1", "display_name": "potatochucker", "link": "https://stackoverflow.com/users/6677398/potatochucker"}, "edited": false, "score": 0, "creation_date": 1530698949, "post_id": 51170879, "comment_id": 89324776, "body": "I do not have Parenthesis in my actual select query. I will edit this now. However, I have looked into what you have mentioned and this is relevant but not the issue. I will look into changing over to MSOLEDBSQL in the future."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1530699399, "post_id": 51170879, "comment_id": 89325048, "body": "I generally recommend just using the ODBC SQL server driver, though. Works fine, and then you don&#39;t have a different type of connection for your ADO queries and linked tables, which makes managing dependencies and troubleshooting easier."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530703250, "post_id": 51170879, "comment_id": 89327491, "body": "<a href=\"http://www.accessallinone.com/updating-adding-and-deleting-records-in-a-recordset/\" rel=\"nofollow noreferrer\">Updating, Adding And Deleting Records In a Recordset</a> has excellent sample code."}], "owner": {"reputation": 19, "user_id": 6677398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f24473765d33d9f1ac50b48dc7547f5?s=128&d=identicon&r=PG&f=1", "display_name": "potatochucker", "link": "https://stackoverflow.com/users/6677398/potatochucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 731, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530700657, "creation_date": 1530698205, "last_edit_date": 1530699022, "question_id": 51170879, "link": "https://stackoverflow.com/questions/51170879/update-error-on-vba-execute-on-adodb-recordset", "title": "Update Error on VBA .Execute on ADODB Recordset", "body": "<p>I am trying to update a SQL DB table through the input from my textbox. The issue I am having can be seen with the generic VBA Sub seen below:</p>\n\n<pre><code>Dim conn As ADODB.Connection\nSet conn = New ADODB.Connection\nDim rst As ADODB.Recordset\nSet rst = New ADODB.Recordset\n\nDim strSql As String\nDim strADOCon As String\n\nstrADOConTechSub = \"PROVIDER=SQLOLEDB;Data Source=______;Initial Catalog=______;User ID = _______; Password = ______;Trusted_Connection=Yes\"\n\nconn.Open strADOCon\n\nstrSql = \"SELECT this \" &amp; _ \n         \"FROM there  \" &amp; _\n         \"WHERE that &lt;&gt; ''\"\n\nSet rst = conn.Execute(strSql)\n\nrst!this.Value = Me.Textbox1\n\nconn.Close\n</code></pre>\n\n<p>I am receiving the error message;</p>\n\n<blockquote>\n  <p>Run-Time error '3251':</p>\n  \n  <p>Current Recordset does not support updating. This may be a limitation\n  of the provider, or of the selected locktype.</p>\n</blockquote>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1530697668, "post_id": 51170628, "comment_id": 89323939, "body": "Your first range is relative to sheet &quot;Check&quot;, but the others are relative to the active sheet."}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530698329, "creation_date": 1530698329, "answer_id": 51170913, "question_id": 51170628, "link": "https://stackoverflow.com/questions/51170628/converting-cells-to-a-range-of-cells-within-a-beforeclose-vba/51170913#51170913", "title": "Converting cells to a range of cells within a BeforeClose VBA", "body": "<p>Use <code>WorksheetFunction.CountA()</code> to count the number of non blank values in the range and compare it against the ranges cell count.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim Target As Range\n    Set Target = Range(\"G17:G20,G33:G38\")\n    If Sheets(\"Check\").Range(\"G16\").Value = \"Special Request\" And _\n        WorksheetFunction.CountA(Target) &lt; Target.count Then\n\n        MsgBox \"Please verify that all tabs are check using the check tab\"\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10031323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eUiLQVaRDyA/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pvIw6leE5RXrKM7wYOfHK5OXO1KQ/mo/photo.jpg?sz=128", "display_name": "Werner", "link": "https://stackoverflow.com/users/10031323/werner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530698329, "creation_date": 1530697400, "question_id": 51170628, "link": "https://stackoverflow.com/questions/51170628/converting-cells-to-a-range-of-cells-within-a-beforeclose-vba", "title": "Converting cells to a range of cells within a BeforeClose VBA", "body": "<p>I have looked and tried all the arrays and set functions but when I run it in the program it does not work.\nThis is my program</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nIf Sheets(\"Check\").Range(\"G16\").Value = \"Special Request\" And _\nRange(\"G17\").Value = \"\" Or _\nRange(\"G18\").Value = \"\" Or _\nRange(\"G19\").Value = \"\" Or _\nRange(\"G20\").Value = \"\" Then\nMsgBox \"Please verify that all tabs are check using the check tab\"\nCancel = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Instead of naming each cell i would like to insert ranges. an example will be; \nG17:G20 or \nG24:G29 or\nG33:G38 then_</p>\n\n<p>If anyone has any suggestions it would be greatly appreciated </p>\n"}, {"tags": ["vba", "excel", "rtm"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1530698363, "post_id": 51170460, "comment_id": 89324425, "body": "There is no need to check if the value already exists in the dictionary, just do <code>xDic(LookupValue) = &quot;&quot;</code>. Also convert <code>LookupRange</code> to 2d array before loop <code>aRows = LookupRange.Value</code>, and process the array within loop instead of the range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4934574"}, "edited": false, "score": 1, "creation_date": 1530698902, "post_id": 51170460, "comment_id": 89324748, "body": "RTM is requirement traceability Matrix"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1530700692, "post_id": 51170460, "comment_id": 89325839, "body": "If no-one manages to work the word REDEMPTION into their answer I will be sorely disappointed."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4934574"}, "edited": false, "score": 0, "creation_date": 1530698640, "post_id": 51170658, "comment_id": 89324593, "body": "Now it is getting hanged more than 5 mins.. It is not optimized. Still not working"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530700538, "post_id": 51170658, "comment_id": 89325740, "body": "@SHASHANKBalaganchi I appended another version of the function that trims the range to fit the data.  The only way that it would take the previous answer that long to process is if <code>LookupRange</code> had +500K cells."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4934574"}, "edited": false, "score": 0, "creation_date": 1530700860, "post_id": 51170658, "comment_id": 89325946, "body": "Superb Code @TinMan. Very happy . The Ultra version is awesome and working perfectly. did not expect so fast"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530700887, "post_id": 51170658, "comment_id": 89325970, "body": "At your service!!  Happy Coding :)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530701387, "post_id": 51170658, "comment_id": 89326309, "body": "Wondering if <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">FIND</a> would speed it up a bit more."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4934574"}, "edited": false, "score": 0, "creation_date": 1530701486, "post_id": 51170658, "comment_id": 89326367, "body": "Now it is working as soon as i tab out from the cell.. Not sure if more speed up is required."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530701962, "post_id": 51170658, "comment_id": 89326683, "body": "Lol..I&#39;m glad to hear it."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530702972, "post_id": 51170658, "comment_id": 89327326, "body": "@DarrenBartrup-Cook  There is no need to further optimise this code, arrays are super fast.  You might like this articel:  <a href=\"https://analystcave.com/excel-vlookup-vs-index-match-vs-sql-performance/\" rel=\"nofollow noreferrer\">EXCEL VLOOKUP VS INDEX MATCH VS SQL VS VBA</a>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530706226, "post_id": 51170658, "comment_id": 89329441, "body": "@TinMan  Yep, you&#39;re right.  I wasn&#39;t thinking about the array side of it - just finding it on the sheet which will always be slower than an array."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 1, "last_activity_date": 1530700369, "last_edit_date": 1530700369, "creation_date": 1530697485, "answer_id": 51170658, "question_id": 51170460, "link": "https://stackoverflow.com/questions/51170460/how-to-optimize-the-below-vb-code-it-is-taking-lot-of-time-to-run-and-excel-is/51170658#51170658", "title": "How to optimize the below VB Code? It is taking lot of time to run and Excel is hanging every time", "body": "<p>\u2193Concatenate all the keys in a Dictionary \u2193</p>\n\n<blockquote>\n<pre><code>Join(Dictionary.Key(), \",\")\n</code></pre>\n</blockquote>\n\n<pre><code>Function MultipleLookupNoRept(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer) As String\n\n    Dim xDic As New Dictionary\n    Dim xRows As Long\n    Dim xStr As String\n    Dim i As Long\n\n    On Error Resume Next\n    xRows = LookupRange.Rows.count\n    For i = 1 To xRows\n        If LookupRange.Columns(1).Cells(i).Value = Lookupvalue Then\n            xDic.Add LookupRange.Columns(ColumnNumber).Cells(i).Value, \"\"\n        End If\n    Next\n\n    If xDic.count &gt; 0 Then\n        MultipleLookupNoRept = Join(xDic.Keys(), \",\")\n    End If\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Here is the ultra modified version of the code.  The previous code should process 10K rows in 2-5 seconds.  </p>\n\n<pre><code>Function MultipleLookupNoRept(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer) As String\n\n    Dim addresses As Variant, values As Variant\n    Dim r As Long\n\n    With LookupRange.Parent\n        With Intersect(LookupRange.Columns(1), .UsedRange)\n            values = .Value\n            addresses = .Columns(ColumnNumber).Value\n        End With\n    End With\n\n    With CreateObject(\"System.Collections.ArrayList\")\n        For r = 1 To UBound(values)\n            If values(r, 1) = Lookupvalue And r &lt;= UBound(addresses) And addresses(r, 1) &lt;&gt; \"\" Then\n                .Add addresses(r, 1)\n            End If\n        Next\n\n        MultipleLookupNoRept = Join(.ToArray(), \",\")\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4934574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 51170658, "answer_count": 1, "score": 0, "last_activity_date": 1530800691, "creation_date": 1530696922, "last_edit_date": 1530800691, "question_id": 51170460, "link": "https://stackoverflow.com/questions/51170460/how-to-optimize-the-below-vb-code-it-is-taking-lot-of-time-to-run-and-excel-is", "title": "How to optimize the below VB Code? It is taking lot of time to run and Excel is hanging every time", "body": "<h2>I am creating a Requirement Traceablity M matrix in the Excel sheet and below VB code is taking more time to execute and excel sheet is hanging for 5 minutes every time I enter something in a cell.</h2>\n\n<hr>\n\n<h2>VBA code:</h2>\n\n<pre><code>Function MultipleLookupNoRept(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer)\n\n    Dim xDic As New Dictionary\n    Dim xRows As Long\n    Dim xStr As String\n    Dim i As Long\n\n    On Error Resume Next\n    xRows = LookupRange.Rows.Count\n    For i = 1 To xRows\n        If LookupRange.Columns(1).Cells(i).Value = Lookupvalue Then\n            xDic.Add LookupRange.Columns(ColumnNumber).Cells(i).Value, \"\"\n        End If\n    Next\n    xStr = \"\"\n    MultipleLookupNoRept = xStr\n    If xDic.Count &gt; 0 Then\n        For i = 0 To xDic.Count - 1\n            xStr = xStr &amp; xDic.Keys(i) &amp; \",\"\n        Next\n        MultipleLookupNoRept = Left(xStr, Len(xStr) - 1)\n    End If \n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 1, "creation_date": 1530697802, "post_id": 51170356, "comment_id": 89324028, "body": "What have you tried so far?"}, {"owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1530703006, "post_id": 51170356, "comment_id": 89327347, "body": "I am using INDEX and MATCH in my dependant drop down list and this causes a type mismatch."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530709771, "post_id": 51170356, "comment_id": 89331705, "body": "I wasn&#39;t going to answer this question till I seen the code that you are trying to modify.  If <code>Range1</code>, <code>Range2</code>, and <code>Range3</code> each have ten cells then this code will add 1000 rows."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "edited": false, "score": 0, "creation_date": 1531136199, "post_id": 51174469, "comment_id": 89467707, "body": "This code works but it only gives me one list where I expect two lists, dropdown 1 and 2."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530709598, "creation_date": 1530709598, "answer_id": 51174469, "question_id": 51170356, "link": "https://stackoverflow.com/questions/51170356/excel-vba-for-each-loop-with-data-validation-lists/51174469#51174469", "title": "Excel VBA For each loop with data validation lists", "body": "<p>This code will still work even if the named ranges using <code>INDEX</code> and <code>MATCH</code> are invalid.</p>\n\n<h2>ExtractDataValidationList:Sub</h2>\n\n<pre><code>Sub ExtractDataValidationList(Source As Range, Optional TargetWorkSheet As Worksheet)\n    Dim cell As Range, rValidation As Range\n    Dim list As Object, item As Variant, values As Variant\n    On Error Resume Next\n    Set rValidation = Source.SpecialCells(xlCellTypeAllValidation)\n    On Error GoTo 0\n\n    If rValidation Is Nothing Then\n        MsgBox \"No Data Validation Found\"\n    Else\n        Set list = CreateObject(\"System.Collections.ArrayList\")\n        For Each cell In rValidation\n            On Error Resume Next\n            values = Range(cell.Validation.Formula1).Value\n            If Err.Number &lt;&gt; 0 Then values = Split(cell.Validation.Formula1, \",\")\n            On Error GoTo 0\n\n            For Each item In values\n                If Not list.Contains(item) Then list.Add item\n            Next\n        Next\n\n        If list.Count = 0 Then\n            MsgBox \"No Items in Data Validation Formula1\"\n        Else\n            list.Sort\n            If TargetWorkSheet Is Nothing Then Set TargetWorkSheet = Worksheets.Add\n            TargetWorkSheet.Range(\"A1\").Resize(list.Count).Value = WorksheetFunction.Transpose(list.ToArray)\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<h2>Usage</h2>\n\n<blockquote>\n<pre><code> ExtractDataValidationList ActiveSheet.Cells\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3069, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533369110, "creation_date": 1530696643, "last_edit_date": 1533369110, "question_id": 51170356, "link": "https://stackoverflow.com/questions/51170356/excel-vba-for-each-loop-with-data-validation-lists", "title": "Excel VBA For each loop with data validation lists", "body": "<p>I have 4 data validation drop downs and I want to use a for each loop to iterate through all possible values of the 4 data validation drop downs and copy the result to a worksheet.</p>\n\n<p>The drop downs are in cells H3 and H4 and U3 and U4. H3 and U3 contains identical values and H4 and U4 contains identical values.</p>\n\n<p>First I would like to check if there are data validation list in my worksheet.</p>\n\n<p>Then I would like to iterate through all possible values of the 4 drop downs values and save the result in a new worksheet! </p>\n\n<p>I found a thread here on stackoverflow <a href=\"https://stackoverflow.com/questions/36398323/iterate-through-vba-dropdown-list\">Iterate through VBA dropdown list</a></p>\n\n<p>and from that thread I am using the following code:</p>\n\n<pre><code>Sub LoopThroughList()\nDim Dropdown1, Dropdown2, Dropdown3, Dropdown4 As String\nDim Range1, Range2, Range3, Range4 As Range\nDim option1, option2, option3, option4 As Range\n\nDim Counter As Long\n\nCounter = 1\n\n' *** SET DROPDOWN LOCATIONS HERE ***\n' ***********************************\n\n    Dropdown1 = \"H3\"\n    Dropdown2 = \"H4\"\n    Dropdown2 = \"U3\"\n    Dropdown2 = \"U4\"\n\n' ***********************************\n' ***********************************\n\nSet Range1 = Evaluate(Range(\"H3\").Validation.Formula1)\nSet Range2 = Evaluate(Range(\"H4\").Validation.Formula1)\nSet Range3 = Evaluate(Range(\"U3\").Validation.Formula1)\nSet Range4 = Evaluate(Range(\"U4\").Validation.Formula1)\n\nFor Each option1 In Range1\n    For Each option2 In Range2\n        For Each option3 In Range3\n            For Each option4 In Range4\n\n            Sheets(2).Cells(Counter, 1) = option1\n            Sheets(2).Cells(Counter, 2) = option2\n            Sheets(2).Cells(Counter, 3) = option3\n            Sheets(2).Cells(Counter, 3) = option4\n            Counter = Counter + 1\n            Debug.Print option1, option2, option3, option4\n            Next option4\n        Next option3\n    Next option2\nNext option1\n\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I found another thread on <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/134028-loop-through-excel-drop-down-list-and-copy-paste-the-value?t=190022\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-general/134028-loop-through-excel-drop-down-list-and-copy-paste-the-value?t=190022</a> which loops through two data validation drop down lists with VBA.</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub LoopThroughDv()\n    Dim dvCell As Range\n    Dim inputRange As Range\n    Dim c As Range\n    Dim i As Long\n\n     'Which cell has data validation\n    Set dvCell = Worksheets(\"Input Output\").Range(\"I4\")\n\n     'Determine where validation comes from\n    Set inputRange = Evaluate(dvCell.Validation.Formula1)\n\n    i = 0\n     'Begin our loop\n    Application.ScreenUpdating = True\n    For Each c In inputRange\n            dvCell = c.Value\n       ' Worksheets(\"Output\").Cells(i, \"A\").Value = dvCell\n        'Worksheets(\"Output\").Cells(i, \"A\").Value = Worksheets(\"Input Output\").Range(\"A1\").Value\n        MsgBox dvCell\n        Debug.Print dvCell\n        i = i + 1\n    Next c\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>How can I improve on this code? Also, would it be possible to save the entire worksheet under the loop? For each loop the value of my vlookups change and I want to copy the information to a new worksheet and finally use it in a pivottable.</p>\n\n<p>Also, found this code in a thread <a href=\"https://stackoverflow.com/questions/46488642/loop-through-multiple-data-validation-lists?rq=1\">loop through multiple data validation lists</a></p>\n\n<pre><code>Sub CopyPaste()\nApplication.ScreenUpdating = False\nDim inputRange1, inputRange2 As Range\nDim option1, option2 As Range\nSet inputRange1 = \nEvaluate(Worksheets(\"Scenario\").Range(\"TabSelection\").Validation.Formula1)\nSet inputRange2 = \nEvaluate(Worksheets(\"Scenario\").Range(\"IndexSelection\").Validation.Formula1)\nFor Each option1 In inputRange1\nWorksheets(\"Scenario\").Range(\"TabSelection\").Value = option1.Value\n    For Each option2 In inputRange2\n    ActiveSheet.EnableCalculation = True\n    Worksheets(\"Scenario\").Range(\"IndexSelection\").Value = option2.Value\n        Worksheets(\"Scenario\").Range(\"CopyRange\").Copy\n        With Sheets(\"Paste\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(2)\n            .PasteSpecial Paste:=xlPasteColumnWidths\n            .PasteSpecial Paste:=xlPasteValues\n            .PasteSpecial Paste:=xlPasteFormats\n        End With\nNext option2\nNext option1\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I have tried to minimize the code to this:</p>\n\n<pre><code>Sub LoopThroughDv()\nApplication.ScreenUpdating = True\nDim inputRange1, inputRange2 As Range\nDim option1, option2 As Range\nSet inputRange1 = Evaluate(Worksheets(\"Input Output\").Range(\"I4\").Validation.Formula1)\nSet inputRange2 = Evaluate(Worksheets(\"Input Output\").Range(\"M4\").Validation.Formula1)\nActiveSheet.EnableCalculation = True\n\nFor Each option1 In inputRange1\n    ActiveSheet.EnableCalculation = True\n    Debug.Print option1\n    Worksheets(\"Input Output\").Range(\"D10\").Value = option1.Value\n    For Each option2 In inputRange2\n        Debug.Print option2\n\n        Worksheets(\"Input Output\").Range(\"E10\").Value = option2.Value\n\n    Next option2\nNext option1\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/28821686/excel-data-validation-list-from-filtered-table\">Excel - Data Validation list from filtered table</a> This thread is also useful!</p>\n\n<p>I found another thread with instructions <a href=\"https://stackoverflow.com/questions/18642930/determine-if-cell-contains-data-validation/31346246#31346246\">Determine if cell contains data validation</a> to find data validation cells. Now that I have the address, formula1 and incelldropdown of my data validation cells.</p>\n\n<p>How can I loop through the data validation step by step?</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ShowValidationInfo()\n\n    Dim rngCell             As Range\n    Dim lngValidation       As Long\n\n    For Each rngCell In ActiveSheet.UsedRange\n\n        lngValidation = 0\n\n        On Error Resume Next\n        lngValidation = rngCell.SpecialCells(xlCellTypeSameValidation).Count\n        On Error GoTo 0\n\n        If lngValidation &lt;&gt; 0 Then\n            Debug.Print rngCell.Address\n            Debug.Print rngCell.Validation.Formula1\n            Debug.Print rngCell.Validation.InCellDropdown\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I have found that this code does what I want, however it only does it for one data validation drop down. How can I modify this code to use 2 or #n dropdowns?</p>\n\n<pre><code>Sub LoopThroughDv()\n    Dim dvCell As Range\n    Dim inputRange As Range\n    Dim c As Range\n    Dim i As Long\n\n     'Which cell has data validation\n    Set dvCell = Worksheets(\"Input Output\").Range(\"I4\")\n\n     'Determine where validation comes from\n    Set inputRange = Evaluate(dvCell.Validation.Formula1)\n\n    i = 0\n     'Begin our loop\n    Application.ScreenUpdating = True\n    For Each c In inputRange\n            dvCell = c.Value\n       ' Worksheets(\"Output\").Cells(i, \"A\").Value = dvCell\n        'Worksheets(\"Output\").Cells(i, \"A\").Value = Worksheets(\"Input Output\").Range(\"A1\").Value\n        MsgBox dvCell\n        Debug.Print dvCell\n        i = i + 1\n    Next c\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE 2018 07 24:</p>\n\n<p>I am still trying to loop through my 4 data validation lists, Could someone help me adapt the code below to use 2 data validation lists?</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughValidationList()\n    Dim lst As Variant\n    Dim rCl As Range\n    Dim str As String\n    Dim iX As Integer\n\n    str = Range(\"B1\").Validation.Formula1\n    On Error GoTo exit_proc:\n    If Left(str, 1) = \"=\" Then\n        str = Right(str, Len(str) - 1)\n        For Each rCl In Worksheets(Range(str).Parent.Name).Range(str).Cells\n            Range(\"B1\").Value = rCl.Value\n        Next rCl\n    Else\n        lst = Split(str, \",\")\n        For iX = 0 To UBound(lst)\n            Range(\"B1\").Value = lst(iX)\n        Next iX\n    End If\n    Exit Sub\nexit_proc:\n    MsgBox \"No validation list \", vbCritical, \"Error\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1530697232, "post_id": 51170319, "comment_id": 89323677, "body": "A to F are columns, not rows. You get the 8 blank rows because of this line <code>LastRow = LastRow + 9</code>. I don&#39;t think I follow what you&#39;re trying to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "edited": false, "score": 0, "creation_date": 1530697673, "post_id": 51170319, "comment_id": 89323944, "body": "you will need to unmerge and merge again later to be able to paste"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1530697709, "post_id": 51170319, "comment_id": 89323966, "body": "Do you mean you want to start at F10 and then paste without gaps?"}, {"owner": {"reputation": 23, "user_id": 10030544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123ee3285f0c018b207aaa441fde9db5?s=128&d=identicon&r=PG&f=1", "display_name": "quantamz", "link": "https://stackoverflow.com/users/10030544/quantamz"}, "edited": false, "score": 0, "creation_date": 1530716247, "post_id": 51170319, "comment_id": 89335635, "body": "I would like to rephrase my question about the merged cells. I need it to copy from two unmerged cells, for example &quot;A1:B1&quot; and paste it to a single merged cell &quot;F1:H1&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10030544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123ee3285f0c018b207aaa441fde9db5?s=128&d=identicon&r=PG&f=1", "display_name": "quantamz", "link": "https://stackoverflow.com/users/10030544/quantamz"}, "edited": false, "score": 0, "creation_date": 1530714998, "post_id": 51170661, "comment_id": 89334965, "body": "I appreciate the effort but its not quite what I was looking for. SJR&#39;s answer above pretty much solved my problem."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1530697488, "creation_date": 1530697488, "answer_id": 51170661, "question_id": 51170319, "link": "https://stackoverflow.com/questions/51170319/excel-vba-copy-and-paste-to-last-row/51170661#51170661", "title": "Excel VBA Copy and Paste to last row", "body": "<p>Assuming that you start copying from Row 1 of Column A, try this:</p>\n\n<pre><code>Sub pastebelowlastcell()\n\nDim FirstRow, ALastRow, FLastRow As Long\n\nt = 1\nALastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Do Until t = ALastRow\n\n        ActiveSheet.Range(\"A\" &amp; t &amp; \":C\" &amp; t).Copy\n\n        FLastRow = ActiveSheet.Cells(Rows.Count, 6).End(xlUp).Row\n        If t = 1 Then FLastRow = 10\n\n        ActiveSheet.Range(\"F\" &amp; FLastRow).PasteSpecial Paste:=xlPasteValues\n\n        t = t + 1\n\n    Loop\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1530698124, "creation_date": 1530698124, "answer_id": 51170862, "question_id": 51170319, "link": "https://stackoverflow.com/questions/51170319/excel-vba-copy-and-paste-to-last-row/51170862#51170862", "title": "Excel VBA Copy and Paste to last row", "body": "<p>Try changing the LastRow line to </p>\n\n<pre><code>LastRow = WorksheetFunction.Max(Sheets(\"Sheet1\").Cells(Rows.Count, \"F\").End(xlUp).Row, 9)\n</code></pre>\n\n<p>When you start it will be assigned the value of 9 (before you add 1) and henceforth it will find the last used row.</p>\n"}], "owner": {"reputation": 23, "user_id": 10030544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123ee3285f0c018b207aaa441fde9db5?s=128&d=identicon&r=PG&f=1", "display_name": "quantamz", "link": "https://stackoverflow.com/users/10030544/quantamz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16248, "favorite_count": 0, "accepted_answer_id": 51170862, "answer_count": 2, "score": 1, "last_activity_date": 1530698124, "creation_date": 1530696528, "question_id": 51170319, "link": "https://stackoverflow.com/questions/51170319/excel-vba-copy-and-paste-to-last-row", "title": "Excel VBA Copy and Paste to last row", "body": "<p>A complete beginner with Excel VBA here. I want to be able to copy and paste a chunk of information from one cell in one row to cells in another row. For example a chunk of information from Row \"A\" to Row \"F\". However I want to be able to do this multiple times even after i have already run the macro once and i want the information to be pasted below the last used cell of Row \"F\", so the list can be continued. I want to paste the information with no lines between each column when I run the macro multiple times but I want it to start from a specific column. However I can't seem to do it.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub pastebelowlastcell()\nDim lRow As Long\nDim LastRow As Long\nlRow = Sheets(\"Sheet1\").Cells(Rows.Count,\"A\").End(xlUp).Row\nlRow = lRow + 1\nLastRow = Sheets(\"Sheet1\").Cells(Rows.Count,\"F\").End(xlUp).Row\nLastRow = LastRow + 1\nActiveSheet.Range(\"A1:C\" &amp; lRow).Copy\nActiveSheet.Range(\"F\" &amp; LastRow).PasteSpecial\nApplication.CutCopyMode = False\nEnd sub\n</code></pre>\n\n<p>For example, I want to paste the code starting from \"F10\" but if i change my code to:</p>\n\n<pre><code>LastRow = Sheets(\"Sheet1\").Cells(Rows.Count,\"F\").End(xlUp).Row\nLastRow = LastRow + 9\n</code></pre>\n\n<p>It will paste starting from \"F10\", but it will paste with 8 blank lines in between each time it pastes, when I run the code multiple times.</p>\n\n<p>Also, is it possible to be able to paste the information from single cells into merged cells using this method?</p>\n"}, {"tags": ["vba", "excel", "powerpoint", "shapes"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530706066, "post_id": 51169904, "comment_id": 89329339, "body": "The <i>short answer</i> is to see the section <code>Retrieve &quot;Last Shape Created&quot;</code> in the <a href=\"https://stackoverflow.com/a/51170453/8112776\">answer below</a> and instead of using <code>.Count</code>, use the <code>idxLastShape</code>function  to retrieve the number of the most recently created shape.   I would also suggested you use the proper VBA copy and <a href=\"https://msdn.microsoft.com/vba/powerpoint-vba/articles/shapes-pastespecial-method-powerpoint\" rel=\"nofollow noreferrer\"><code>PasteSpecial</code></a> methods rather than the <code>CommandBars</code> methods. See the links at bottom of post.)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530841610, "post_id": 51169904, "comment_id": 89385325, "body": "were you able to get it figured out?"}, {"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530868598, "post_id": 51169904, "comment_id": 89394762, "body": "Hi.  I&#39;ve been out of the office for the past couple of days, so haven&#39;t had a chance to look in to this until now.  Reading through it&#39;s making sense, just need to try and implement it."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1530869948, "post_id": 51170453, "comment_id": 89395595, "body": "Fantastic, that&#39;s a really thorough and useful answer, thank you."}, {"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1530870372, "post_id": 51170453, "comment_id": 89395857, "body": "I&#39;m now just struggling to get my Excel VBA to talk to the PowerPoint correctly in the function.  Where it&#39;s <code>ActivePresentation.Slides(slideNum).shapes</code> it returns <i>italic</i> Run-time error &#39;429&#39;: ActiveX component can&#39;t be created object. <i>italic</i> .  I thought this would be my PPPres variable instead of ActivePresentation, but that in turn returned <i>italic</i> Run-time error &#39;13&#39;: Type mismatch <i>italic</i>  So I&#39;ve now got to work out that issue to get it to work.  I&#39;m basically learning as I go along with this project.  Thanks for your help!"}, {"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1530875730, "post_id": 51170453, "comment_id": 89399021, "body": "I&#39;ve worked it out.  Instead of <code>Dim shp as Shape</code> I should have used <code>Dim shp as PowerPoint.shape</code>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1530890339, "post_id": 51170453, "comment_id": 89407681, "body": "are you doing this from an application other than PowerPoint?"}, {"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1531211563, "post_id": 51170453, "comment_id": 89499277, "body": "Sorry, yes, I&#39;m running from Excel.  All working now, thanks for your help."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 5, "last_activity_date": 1530706294, "last_edit_date": 1530706294, "creation_date": 1530696909, "answer_id": 51170453, "question_id": 51169904, "link": "https://stackoverflow.com/questions/51169904/pasted-shape-not-seen-as-latest-shape/51170453#51170453", "title": "Pasted Shape not seen as &quot;Latest&quot; Shape", "body": "<h1><em>'Shapes.Count' \u2260 Shape Index# !</em></h1>\n\n<p>The <code>.Count</code> is not the same as the upper limit of current shape <code>.Index</code> numbers.</p>\n\n<p>The numbering system is easier understood by listing all the shapes within the document:</p>\n\n<pre><code>Sub ListShapes()\n    'hit CTRL+G to view output in Immediate Window\n    Dim sh As Shape, sld As Slide, idx As Long\n    Set sld = ActivePresentation.Slides(1) '&lt;-- change to your slide number\n    For Each sh In sld.Shapes\n        idx = idx + 1\n        Debug.Print \"Shape ID#\" &amp; sh.Id, \"Index #\" &amp; idx, \"Name: \" &amp; sh.Name\n    Next sh\n    Debug.Print \"Count of shapes: \" &amp; sld.Shapes.Count\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><sup><strong>NOTE:</strong> <em>There is <strong>alternative code for Excel</strong> at the bottom of this post!</em></sup></p>\n</blockquote>\n\n<p>To demonstrate, we can <a href=\"https://support.office.com/en-us/article/add-shapes-0e492bb4-3f91-43b5-803f-dd0998e0eb89\" rel=\"nofollow noreferrer\">add shapes</a> to a new document:  </p>\n\n<ul>\n<li>First, add one rectangle manually by clicking <code>Insert</code> (on the ribbon)  </li>\n<li>[If using Excel, click <code>Illustrations</code>], then <code>Shapes</code>, and the rectangle symbol. <a href=\"https://i.stack.imgur.com/Zt115.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zt115.gif\" alt=\"&lt;code&gt;\u25af&lt;/code&gt;\"></a>   </li>\n<li>Draw the shape, then hit <kbd>Ctrl</kbd>+<kbd>C</kbd> to copy it, and hit <kbd>Ctrl</kbd>+<kbd>C</kbd> four times to paste 4 copies.   </li>\n<li><p>Run the above procedure, and the output will be:  </p>\n\n<p><code>Shape ID#2    Index #1      Name: Rectangle 1</code><br>\n<code>Shape ID#3    Index #2      Name: Rectangle 2</code><br>\n<code>Shape ID#4    Index #3      Name: Rectangle 3</code><br>\n<code>Shape ID#5    Index #4      Name: Rectangle 4</code><br>\n<code>Shape ID#6    Index #5      Name: Rectangle 5</code><br>\n<code>Count of shapes: 5                          \u200a\u200a\u200a\u200a\u200a\u200a\u200a\u200a</code>  </p></li>\n</ul>\n\n<p>Note that the <strong>Index</strong> is not a property of this object, but it counted in order that Excel's storing the shapes in memory (same as the order returned by the <code>For Each..Next</code> statement.</p>\n\n<ul>\n<li><p>You can prove this by running:</p>\n\n<pre><code>Debug.Print ActivePresentation.Slides(1).Shapes(5).Name  \n</code></pre>\n\n<p>...which in this case return <code>Rectangle 5</code>.</p></li>\n</ul>\n\n<p>Another way to understand how Excel is storing the shapes is with the <strong>Watch Window</strong>.  Add a breakline or <code>Stop</code> in the middle of the loop, then highlight <code>ws.Shapes</code>, right-click it, choose <code>Add Watch...</code> and click OK.  Browse through the tree to discover the varies properties/attributes of the shapes within the document.</p>\n\n<hr>\n\n<ul>\n<li><p>Next, if we <strong>delete</strong> the \"middle rectangle\" and run the above procedure again, we will get:</p>\n\n<p><code>Shape ID#2    Index #1      Name: Rectangle 1</code><br>\n<code>Shape ID#3    Index #2      Name: Rectangle 2</code><br>\n<code>Shape ID#5    Index #3      Name: Rectangle 4</code><br>\n<code>Shape ID#6    Index #4      Name: Rectangle 5</code><br>\n<code>Count of shapes: 4                          \u200a\u200a\u200a\u200a\u200a\u200a\u200a\u200a</code>  </p></li>\n</ul>\n\n<p>The <code>ID</code> and <code>Name</code> of remaining shapes do not change, but <strong>the <em>Index</em> is renumbered</strong> to reflect the new \"order\".</p>\n\n<p>...thus to return the name <code>Rectangle 5</code> we now need to use:</p>\n\n<pre><code>Debug.Print ActivePresentation.Slides(1).Shapes(4).Name  \n</code></pre>\n\n<hr>\n\n<h1>Referring to shapes <em>(including <a href=\"https://stackoverflow.com/q/50144020/8112776\">controls</a>)</em></h1>\n\n<p>When you refer to a shape by number, like <code>.Shapes(\ud835\udd01)</code>, you're referring to the shape <strong><em>Index Number \ud835\udd01</em></strong>, not the <code>ID</code> number.  <em>Index numbers</em> are dynamically assigned as needed as therefore are <strong><em>not a stable method</em></strong> to refer to a shape.</p>\n\n<ul>\n<li>Therefore, <code>.Count</code> is irrelevant to the shape <em>Index number</em>.</li>\n</ul>\n\n<p>Ideally, you should refer to the shape by the <code>.Name</code> or <code>.ID</code> number. If generating shapes dynamically, you'd ideally store a list of shapes in an array or collection, so you can look at the list as required.</p>\n\n<hr>\n\n<h2>Retrieve \"Last Shape Created\"</h2>\n\n<p>If the only reason for using the <em>Index Number</em> is to retrieve the \"last shape created\", then you could use a function like this to get the index number:</p>\n\n<pre><code>Function idxLastShape(slideNum As Long) As Long\n    Dim sh As Shape\n    For Each sh In ActivePresentation.Slides(slideNum).Shapes\n        idxLastShape = idxLastShape + 1\n    Next sh\nEnd Function\n</code></pre>\n\n<p><strong>Example Usage:</strong></p>\n\n<pre><code>Debug.Print idxLastShape(1) 'Returns index of last shape on slide#1\n</code></pre>\n\n<blockquote>\n  <p><sup><strong>NOTE:</strong> <em>There is <strong>alternate code for Excel</strong> at the bottom of this post!</em></sup></p>\n</blockquote>\n\n<hr>\n\n<p>Alternatively, you could have the function return a reference to the actual <strong><em>shape object</em></strong>, rather than the number, like this:  </p>\n\n<pre><code>Function LastShape(slideNum As Long) As Shape\n    Dim sh As Shape\n    For Each sh In ActivePresentation.Slides(slideNum).Shapes\n        Set LastShape = sh\n    Next sh\nEnd Function\n</code></pre>\n\n<p>...so you could get the name of the \"last shape\" with:  </p>\n\n<pre><code>Debug.Print LastShape(1).Name\n</code></pre>\n\n<hr>\n\n<h1>Delete the most recently created shape</h1>\n\n<p>Using the function above, you can use any methods you would normally use with shapes.  For example, you can delete the \"last shape\" that was created on Slide #1:</p>\n\n<pre><code>LastShape(1).Delete\n</code></pre>\n\n<blockquote>\n  <h2><a href=\"https://i.stack.imgur.com/ObOCo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ObOCo.png\" alt=\"Caution\"></a> <em>CAUTION!</em></h2>\n  \n  <p>The examples in the post <em>(including the deletion example!)</em> are indiscriminate of what type of shape they're returning/editing/deleting!  </p>\n  \n  <p><strong>There are <em>dozens</em> of types of shapes</strong>, from graphics to sound/video and <a href=\"https://stackoverflow.com/q/50144020/8112776\">controls</a>.  You can filter the shapes being enumerated by these procedures using the <code>.Type</code> property of the <code>Shape</code> object, as well as other methods.  There is a partial list <a href=\"https://msdn.microsoft.com/VBA/Office-Shared-VBA/articles/msoshapetype-enumeration-office\" rel=\"nofollow noreferrer\">here</a>, and more information in the links below.</p>\n</blockquote>\n\n<hr>\n\n<h1>Alternative code for Excel:</h1>\n\n<p><strong><em>List all shapes on worksheet (Excel)</em></strong></p>\n\n<pre><code>Sub ListShapes()\n    'hit CTRL+G to view output in Immediate Window\n    Dim sh As Shape, ws As Worksheet, idx As Long\n    Set ws = Sheets(\"Sheet1\") '&lt;-- change to your worksheet name\n    For Each sh In ws.Shapes\n        idx = idx + 1\n        Debug.Print \"Shape ID#\" &amp; sh.ID, \"Index #\" &amp; idx, \"Name: \" &amp; sh.Name\n    Next sh\n    Debug.Print \"Count of shapes: \" &amp; Sheets(\"Sheet1\").Shapes.Count\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em>Return index number of \"last shape\" (Excel)</em></strong></p>\n\n<pre><code>Function idxLastShape(shtName As String) As Long\n    Dim sh As Shape\n    For Each sh In Sheets(shtName).Shapes\n        idxLastShape = idxLastShape + 1\n    Next sh\nEnd Function\n</code></pre>\n\n<p><em>Example Usage:</em>   <code>Debug.Print idxLastShape(\"Sheet1\")</code></p>\n\n<hr>\n\n<p><strong><em>Return reference to \"last shape\" object (Excel)</em></strong></p>\n\n<pre><code>Function LastShape(shtName As String) As Shape\n    Dim sh As Shape\n    For Each sh In Sheets(shtName).Shapes\n        Set LastShape = sh\n    Next sh\nEnd Function\n</code></pre>\n\n<p><em>Example Usage:</em>   <code>Debug.Print LastShape(\"Sheet1\").Name</code></p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/powerpoint-vba/articles/shape-object-powerpoint\" rel=\"nofollow noreferrer\"><strong><code>Shapes</code> Object</strong> (PowerPoint/VBA)</a>  </li>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/shapes-object-excel\" rel=\"nofollow noreferrer\"><strong><code>Shapes</code> Object</strong> (Excel/VBA)</a>  </li>\n<li>MSDN : <a href=\"https://msdn.microsoft.coms/VBA/Office-Shared-VBA/articles/msoshapetype-enumeration-office\" rel=\"nofollow noreferrer\"><strong><em>MsoShapeType</em> Enumeration</strong> (Office)</a>  </li>\n<li>Stack Overflow : <a href=\"https://stackoverflow.com/q/50144020/8112776\"><strong>Overview of working with <em>Form Controls</em> and <em>ActiveX Controls</em></strong></a>  </li>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/working-with-shapes-drawing-objects\" rel=\"nofollow noreferrer\"><strong>Working with Shapes</strong> (Drawing Objects)</a>  </li>\n<li>Office.com : <a href=\"https://support.office.com/en-us/article/add-shapes-0e492bb4-3f91-43b5-803f-dd0998e0eb89\" rel=\"nofollow noreferrer\"><strong>How to add Shapes</strong></a>   </li>\n<li>BreezeTree : <a href=\"http://www.breezetree.com/articles/excel-2007-autoshapes-vba.htm\" rel=\"nofollow noreferrer\"><strong>Programming Shapes (AutoShapes) with VBA</strong></a>  </li>\n<li>WiseOwl : <a href=\"https://www.wiseowl.co.uk/blog/s394/shapes.htm\" rel=\"nofollow noreferrer\"><strong>Working with Shapes</strong> (Tutorial)</a></li>\n</ul>\n\n<h2>Other ways to copy from Excel to Powerpoint:</h2>\n\n<ul>\n<li>SpreadsheetGuru : <a href=\"https://www.thespreadsheetguru.com/blog/2014/3/17/copy-paste-an-excel-range-into-powerpoint-with-vba\" rel=\"nofollow noreferrer\"><strong>Copy &amp; Paste An Excel Range Into PowerPoint With VBA</strong></a>  </li>\n<li>ExcelOffTheGrid : <a href=\"https://exceloffthegrid.com/controlling-powerpoint-from-excel-using-vba/\" rel=\"nofollow noreferrer\"><strong>Controlling Powerpoint from Excel using VBA</strong></a>  </li>\n<li>mvps.org  : <a href=\"http://skp.mvps.org/ppt00036.htm\" rel=\"nofollow noreferrer\"><strong>Paste Excel chart as pictures in PowerPoint</strong> (Paste Special)</a></li>\n</ul>\n"}], "owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 0, "accepted_answer_id": 51170453, "answer_count": 1, "score": 2, "last_activity_date": 1530706294, "creation_date": 1530695287, "last_edit_date": 1530705787, "question_id": 51169904, "link": "https://stackoverflow.com/questions/51169904/pasted-shape-not-seen-as-latest-shape", "title": "Pasted Shape not seen as &quot;Latest&quot; Shape", "body": "<p>I'm in the process of automating the production of a PowerPoint report from and Excel spreadsheet.  I've got the process working up until I paste a table.</p>\n\n<p>I'm pasting the table to PowerPoint using <code>PPApp.CommandBars.ExecuteMso (\"PasteSourceFormatting\")</code> and the table appears as a shape on my slide (the third shape). </p>\n\n<p>To refer to the new shape I was using <code>Set pShape = Slide2.Shapes(Slide2.Shapes.Count)</code> but now now when I paste, the <code>pShape</code> is assigned \"Shape 2\" (not \"Shape 3\").  Is there something that needs to be done between the pasting and the assignment of the object?</p>\n\n<p>Code below, commented where the issue occurs. (Full code removed; viewable <a href=\"https://stackoverflow.com/revisions/51169904/1\">here</a>)</p>\n\n<pre><code>'Copy tables from Excel\nSet rng = ws.Range(\"A:A\")\nrng.ColumnWidth = 22.75\nSet rng = ws.Range(\"A4:C27\")\n\n'Copy the table range\nApplication.CutCopyMode = False\nrng.Copy\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\n'The issue occurs here!!! '-------------------------------------\n'Paste the table in to the slide\nSlide2.Select\nPPApp.CommandBars.ExecuteMso (\"PasteSourceFormatting\")\n\n'Name the new shape object\nSet pShape = Slide2.Shapes(Slide2.Shapes.Count)\npShape.Name = \"Slide_2_Table_1\"\npShape.LockAspectRatio = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530695360, "post_id": 51169757, "comment_id": 89322452, "body": "Use usedrange.columns.count.... Here you can find information to study on this: <a href=\"https://stackoverflow.com/questions/21172108/activesheet-usedrange-columns-count-8-what-does-it-mean\" title=\"activesheet usedrange columns count 8 what does it mean\">stackoverflow.com/questions/21172108/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1530695794, "post_id": 51169887, "comment_id": 89322744, "body": "Thankyou for your answer, but still couldn&#39;t make it work in my code."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1530696037, "post_id": 51169887, "comment_id": 89322917, "body": "It does work.. you&#39;re just not executing anything I presume. Eg do <code>Debug print lc</code> after the lc assignment in for loop or check if your sheet is named &quot;Sheet1&quot;. Can&#39;t give you a better answer than that with the info you provided in your question"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1530696535, "post_id": 51169887, "comment_id": 89323269, "body": "I meant, I couldn&#39;t integrate your solution in my answer to extend selection from activecell to the last used column. Thanks again. I&#39;ll try it."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1530697287, "post_id": 51169887, "comment_id": 89323710, "body": "@Rawrplus: D&#39;accord with not to use <code>Select</code> at all. But what else except <code>ActiveSheet</code> should be used if the macro shall run in the current active sheet?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1530698259, "post_id": 51169887, "comment_id": 89324354, "body": "@AxelRichter I do get your point. Though the thing is, in large majority of cases, the programmer will know to which Sheet will the code apply to. I&#39;m not necessarily implying you should never ever use <code>ActiveSheet</code>. Actually for that matter, even <code>Select</code> could have it&#39;s uses - what I am however saying is, that it is a bad habit which can almost always be avoided and should be used when only absolutely necessary (which almost never is)"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1530695231, "creation_date": 1530695231, "answer_id": 51169887, "question_id": 51169757, "link": "https://stackoverflow.com/questions/51169757/extend-selection-to-last-used-column-vba/51169887#51169887", "title": "extend selection to last used column vba", "body": "<p>Bit of googling would have absolutely yielded an answer. This is the most common way of retrieving the last actively used row</p>\n\n<p><code>Shets(\"Sheetname\").Cells(Rows.Count, &lt;inColumn&gt;).End(xlUp).Row</code></p>\n\n<p>and column</p>\n\n<p><code>Shets(\"Sheetname\").Cells(&lt;inRow&gt;, Columns.Count).End(xlToLeft).Column</code></p>\n\n<p>In your case, presuming your sheet is named \"<code>Sheet1</code>\" it would be:</p>\n\n<pre><code>Dim lr as Long\nDim lc as Long\nlr = Sheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\nlc = Sheets(\"Sheet1\").Cells(4, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>Obviously, if your column ranges vary, you should retrieve them in a loop (eg. loop through all the active rows)</p>\n\n<pre><code>For i = 3 to lr\n   lc = Sheets(\"Sheet1\").Cells(i, Columns.Count).End(xlToLeft).Column\n   ' do something\nNext i\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/10717999/5512705\">Also, do absolutely read up on why you should not use <code>Select</code>, <code>ActiveSheet</code> and so on..</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 1, "last_activity_date": 1530696771, "creation_date": 1530696771, "answer_id": 51170402, "question_id": 51169757, "link": "https://stackoverflow.com/questions/51169757/extend-selection-to-last-used-column-vba/51170402#51170402", "title": "extend selection to last used column vba", "body": "<p>Try this:</p>\n\n<pre><code>Sub MyColumnSelect()\n\nDim myRow, myLastColumn As Long\n\n For myRow = 3 To ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row\n\n  myLastColumn = ActiveSheet.Cells(myRow, Columns.Count).End(xlToLeft).Column\n\n  ActiveSheet.Range(Cells(myRow, 1), Cells(myRow, myLastColumn)).Copy\n\n Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1530697394, "post_id": 51170565, "comment_id": 89323768, "body": "Yeah same thing was happening with my code. once I use the code in a data of 4 columns, that last used column will be 4, but when I change the data, still the selection is till 4 columns. Yours worked perfectly. Thankyou so much. I do have one question though, I have same problem in last used row, can U give me answer for that too or should I ask another question. ?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 1, "creation_date": 1530697634, "post_id": 51170565, "comment_id": 89323921, "body": "Read <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">Ron de Bruin - Find last row, column or last cell</a>.  It&#39;s <code>Select Case 2</code> in <code>Function Last(choice As Long, rng As Range)</code>."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530723126, "post_id": 51170565, "comment_id": 89338866, "body": "@TinMan Yuck!!! <code>ActiveSheet</code>, <code>.Select</code> <code>On Error Resume next</code> inside code.. Damn, don&#39;t be so cruel and make him learn bad beginner coding habits that he will have to forcefully unlearn. I absolutely would <b>not</b> recommend studying from those excerpts!"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530817783, "post_id": 51170565, "comment_id": 89378442, "body": "@Rawrplus I added a disclaimer.  I hesitated in answering this one but decided to because I have hot keyed similar code before.  Being able to extend the selection like this can be very handy while formatting and editing large worksheets."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 2, "last_activity_date": 1530817548, "last_edit_date": 1530817548, "creation_date": 1530697198, "answer_id": 51170565, "question_id": 51169757, "link": "https://stackoverflow.com/questions/51169757/extend-selection-to-last-used-column-vba/51170565#51170565", "title": "extend selection to last used column vba", "body": "<p><a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">Ron de Bruin - Find last row, column or last cell</a> show you how to find the last used column.</p>\n\n<pre><code>Sub MyColumnSelect()\n    Dim myCurrentRow As Long\n    Dim myLastColumn As Long\n    myCurrentRow = ActiveCell.Row\n    myLastColumn = Cells.Find(What:=\"*\", After:=Cells(1, 1), _\n                        Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, MatchCase:=False).Column\n\n    Range(ActiveCell, Cells(myCurrentRow, myLastColumn)).Select\nEnd Sub\n</code></pre>\n\n<p>This also works.  But beware that <code>UsedRange</code> can sometimes extend past the data do to non-continuous formatting.</p>\n\n<blockquote>\n<pre><code>  Intersect(ActiveCell.EntireRow, ActiveSheet.UsedRange).Select\n</code></pre>\n</blockquote>\n\n<h2>Addendum</h2>\n\n<p>As @Rawrplus pointed out using <code>ActiveCell</code> and <code>Selection</code> are bad habits and should be avoided.  Watch: <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;t=3123s&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a></p>\n"}], "owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1240, "favorite_count": 0, "accepted_answer_id": 51170565, "answer_count": 3, "score": 0, "last_activity_date": 1530817548, "creation_date": 1530694890, "question_id": 51169757, "link": "https://stackoverflow.com/questions/51169757/extend-selection-to-last-used-column-vba", "title": "extend selection to last used column vba", "body": "<p>Code :<br></p>\n\n<pre><code>Sub MyColumnSelect()\nDim myCurrentRow As Long\nDim myLastColumn As Long\nmyCurrentRow = ActiveCell.Row\nmyLastColumn = ActiveCell.SpecialCells(xlLastCell).Column\nRange(ActiveCell, Cells(myCurrentRow, myLastColumn)).Select\nEnd Sub\n</code></pre>\n\n<p><br></p>\n\n<p>I need to extend my selection from any colum or any row to the last used column in the sheet. This code extends the selection to a particular column, in my case to <code>column P</code>. I don't know why is this the case but even if there are only 4 columns, it still extends the selection to <code>column P</code>.</p>\n\n<p>Image :<br>\n<a href=\"https://i.stack.imgur.com/SAEN4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SAEN4.jpg\" alt=\"enter image description here\"></a>\n<br></p>\n\n<p>PS: I know I shouldn't use <code>select</code>, but I can't make it work even with <code>select</code>. Need Help. </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 2133, "user_id": 1928691, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/trtts.png?s=128&g=1", "display_name": "Federico Navarrete", "link": "https://stackoverflow.com/users/1928691/federico-navarrete"}, "edited": false, "score": 1, "creation_date": 1530694725, "post_id": 51169579, "comment_id": 89322027, "body": "Please share your code."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9542575, "user_type": "registered", "profile_image": "https://graph.facebook.com/1714678045253220/picture?type=large", "display_name": "Dorin", "link": "https://stackoverflow.com/users/9542575/dorin"}, "edited": false, "score": 1, "creation_date": 1530704275, "post_id": 51170167, "comment_id": 89328188, "body": "Thank you for your answer! There is no need to handle the &quot;sheet not existing&quot; problem because is have made a script that creates sheets based on ctr_type"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1530696119, "creation_date": 1530696119, "answer_id": 51170167, "question_id": 51169579, "link": "https://stackoverflow.com/questions/51169579/excel-copy-values-from-table-depending-on-value-type/51170167#51170167", "title": "excel - Copy values from table depending on value type", "body": "<p>Could use something like the following. Assumes you data has headers and starts in column 1 and that there is no data to the right of the table. Otherwise, change the method for determining the last column.</p>\n\n<p>I have helper functions to find the last row and column. I loop the last column to get the unique sheet names stored in a dictionary and at the same time add the range to the left of the sheet name into the dictionary. If the sheet name exists as a key in the dictionary, I use Union to add the current range to the left to the existing rows found for this sheet name.</p>\n\n<p>I re-loop the dictionary using the sheet name keys to write the values to the appropriate sheets. You should add error handling e.g. what if sheet is not present?</p>\n\n<pre><code>Option Explicit\nPublic Sub WriteValues()\n    Dim rng As Range, ws As Worksheet, loopRange As Range, sheetDict As Object\n    Set ws = ActiveSheet: Set sheetDict = CreateObject(\"Scripting.Dictionary\")\n    With ws\n        Set loopRange = Range(.Cells(2, GetLastColumn(ws, 1)), .Cells(GetLastRow(ws, 1), GetLastColumn(ws, 1)))\n        For Each rng In loopRange\n            If Not sheetDict.Exists(rng.Value) Then\n                Dim tempRange As Range\n                Set tempRange = .Range(.Cells(rng.Row, 1), .Cells(rng.Row, GetLastColumn(ws, 1) - 1))\n                sheetDict.Add rng.Value, tempRange.Address\n            Else\n                Set tempRange = Union(.Range(sheetDict(rng.Value)), .Range(.Cells(rng.Row, 1), .Cells(rng.Row, GetLastColumn(ws, 1) - 1)))\n                sheetDict(rng.Value) = tempRange.Address\n            End If\n        Next rng\n        For Each rng In loopRange\n            Set tempRange = .Range(sheetDict(rng.Value))\n            If Not tempRange Is Nothing Then\n                tempRange.Copy Worksheets(rng.Value).Range(\"A\" &amp; GetLastRow(Worksheets(rng.Value), 1))\n            End If\n        Next rng\n    End With\nEnd Sub\n\nPublic Function GetLastColumn(ByVal ws As Worksheet, Optional ByVal rowNumber As Long = 1) As Long\n    With ws\n        GetLastColumn = .Cells(rowNumber, .Columns.Count).End(xlToLeft).Column\n    End With\nEnd Function\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9542575, "user_type": "registered", "profile_image": "https://graph.facebook.com/1714678045253220/picture?type=large", "display_name": "Dorin", "link": "https://stackoverflow.com/users/9542575/dorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51170167, "answer_count": 1, "score": 1, "last_activity_date": 1530696119, "creation_date": 1530694346, "last_edit_date": 1531161705, "question_id": 51169579, "link": "https://stackoverflow.com/questions/51169579/excel-copy-values-from-table-depending-on-value-type", "title": "excel - Copy values from table depending on value type", "body": "<p>I have the following table in sheet1(Export):</p>\n\n<pre><code>-----------------------------\n| col1 | col2 |..cN..|ctr_type|\n-----------------------------\n|value |value |valueN|CtrType1|\n-----------------------------\n|value |value |valueN|CtrType2|\n-----------------------------\n|value |value |valueN|CtrType3|\n-----------------------------\n|value |value |valueN|CtrType1|\n-----------------------------\n|value |value |valueN|CtrType3|\n-----------------------------\n|value |value |valueN|CtrType2|\n-----------------------------\n</code></pre>\n\n<p>Where <strong>ctr_type</strong> is the name of the <strong>sheet</strong> in which the afferent values must be copied.</p>\n\n<p>So my question is: how to copy values in their afferent sheets.</p>\n\n<p>One expected output would be that all the value from the table which have CtrType1 in the column ctr_type would be copied in a existin sheet with the name CtrType1.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1530693310, "post_id": 51169108, "comment_id": 89321223, "body": "Maybe <code>ActiveSheet.Cells.Formula</code> instead of <code>Sheet1.Formula</code> would work? But I&#39;m not pretty sure if all formulas can be converted at once."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1530694081, "post_id": 51169108, "comment_id": 89321641, "body": "Tried it but now I get runtime error 7"}], "answers": [{"comments": [{"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1530696239, "post_id": 51169545, "comment_id": 89323067, "body": "Perfect solution. Thanks a lot."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 3, "last_activity_date": 1530695187, "last_edit_date": 1530695187, "creation_date": 1530694235, "answer_id": 51169545, "question_id": 51169108, "link": "https://stackoverflow.com/questions/51169108/change-multiple-cell-references-from-relative-to-absolute-at-once/51169545#51169545", "title": "Change multiple cell references from relative to absolute ($) at once", "body": "<p>Changing this at once will not be possible. A kind of loop over the single formula cells is needed.</p>\n\n<p>You can get special cells using <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel\" rel=\"nofollow noreferrer\">Range.SpecialCells Method</a>. Thus you can get all formula cells and then do looping over them and converting them to absolute:</p>\n\n<pre><code>Sub convertAllSheetFormulasToAbsolute()\n Dim oCell As Range\n With ActiveSheet\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsolute)\n  Next\n End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 1770086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a340753e3b1e420a2af7aa1e2167e76?s=128&d=identicon&r=PG", "display_name": "Aran", "link": "https://stackoverflow.com/users/1770086/aran"}, "is_accepted": false, "score": 0, "last_activity_date": 1551963221, "creation_date": 1551963221, "answer_id": 55044291, "question_id": 51169108, "link": "https://stackoverflow.com/questions/51169108/change-multiple-cell-references-from-relative-to-absolute-at-once/55044291#55044291", "title": "Change multiple cell references from relative to absolute ($) at once", "body": "<p>As an alternative, the <a href=\"https://www.asap-utilities.com/index.php\" rel=\"nofollow noreferrer\">ASAP Utilities for Excel</a> add-in provides a menu command that converts your selected range of cells to absolute references, mixed references, or relative references. It's worked flawlessly for me for years. </p>\n\n<p>Once you have the add-in installed, in the Formulas menu, select \"Change formula reference style (e.g. A1 to $A1, etc.). </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14858801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e538664746b10a187ed88cdff992f56?s=128&d=identicon&r=PG&f=1", "display_name": "user14858801", "link": "https://stackoverflow.com/users/14858801/user14858801"}, "is_accepted": false, "score": 0, "last_activity_date": 1613537824, "last_edit_date": 1613537824, "creation_date": 1613525362, "answer_id": 66234541, "question_id": 51169108, "link": "https://stackoverflow.com/questions/51169108/change-multiple-cell-references-from-relative-to-absolute-at-once/66234541#66234541", "title": "Change multiple cell references from relative to absolute ($) at once", "body": "<pre><code>Sub Formulas_To_AbsoluteReference()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsolute)\n  Next\n End With\nEnd Sub\n\n\nSub Formulas_To_LockRowNumber_RelColumnLetter()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsRowRelColumn)\n  Next\n End With\nEnd Sub\n\n\nSub FormulasTo_LockColLetter_RelRowNum()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlRelRowAbsColumn)\n  Next\n End With\nEnd Sub\n\n\nSub FormulasTo_AllRealative_Reference()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlRelative)\n  Next\n End With\nEnd Sub\n\n\n`'building on my friend above - use this, with SELECTION:\n\nSub Formulas_To_AbsoluteReference()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsolute)\n  Next\n End With\nEnd Sub\n\n\nSub Formulas_To_LockRowNumber_RelColumnLetter()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsRowRelColumn)\n  Next\n End With\nEnd Sub\n\n\nSub FormulasTo_LockColLetter_RelRowNum()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlRelRowAbsColumn)\n  Next\n End With\nEnd Sub\n\n\nSub FormulasTo_AllRealative_Reference()\n Dim oCell As Range\n With Selection\n  For Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\n   oCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlRelative)\n  Next\n End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14858801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e538664746b10a187ed88cdff992f56?s=128&d=identicon&r=PG&f=1", "display_name": "user14858801", "link": "https://stackoverflow.com/users/14858801/user14858801"}, "is_accepted": false, "score": 1, "last_activity_date": 1613525573, "creation_date": 1613525573, "answer_id": 66234565, "question_id": 51169108, "link": "https://stackoverflow.com/questions/51169108/change-multiple-cell-references-from-relative-to-absolute-at-once/66234565#66234565", "title": "Change multiple cell references from relative to absolute ($) at once", "body": "<p>Sub Formulas_To_AbsoluteReference()\nDim oCell As Range\nWith Selection\nFor Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\noCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsolute)\nNext\nEnd With\nEnd Sub</p>\n<p>Sub Formulas_To_LockRowNumber_RelColumnLetter()\nDim oCell As Range\nWith Selection\nFor Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\noCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlAbsRowRelColumn)\nNext\nEnd With\nEnd Sub</p>\n<p>Sub FormulasTo_LockColLetter_RelRowNum()\nDim oCell As Range\nWith Selection\nFor Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\noCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlRelRowAbsColumn)\nNext\nEnd With\nEnd Sub</p>\n<p>Sub FormulasTo_AllRealative_Reference()\nDim oCell As Range\nWith Selection\nFor Each oCell In .Cells.SpecialCells(Type:=xlCellTypeFormulas)\noCell.Formula = Application.ConvertFormula(oCell.Formula, xlA1, xlA1, xlRelative)\nNext\nEnd With\nEnd Sub</p>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1796, "favorite_count": 0, "accepted_answer_id": 51169545, "answer_count": 4, "score": 1, "last_activity_date": 1613537824, "creation_date": 1530692832, "last_edit_date": 1531161705, "question_id": 51169108, "link": "https://stackoverflow.com/questions/51169108/change-multiple-cell-references-from-relative-to-absolute-at-once", "title": "Change multiple cell references from relative to absolute ($) at once", "body": "<p>I have the following values and formulas in my Excel spreadsheet:</p>\n\n<pre><code>          A                             \n1      Shirt         =Sheet2!A2\n2        50          =C1\n3       350          =Sheet3!D7\n4    Product B       =F8\n5\n6\n</code></pre>\n\n<p>The values in <strong>Column A</strong> I get from other parts of the Excel file by using <strong>only</strong> relative cell references.</p>\n\n<p>Now I want to change those cell references from relative to <strong>absolute</strong> so they look like this:</p>\n\n<pre><code>          A                             \n1      Shirt         =Sheet2!$A$2\n2        50          =$C$1\n3       350          =Sheet3!$D$7\n4    Product B       =$F$8\n5\n6\n</code></pre>\n\n<p>Therefore, I tried to go with the VBA from <a href=\"https://stackoverflow.com/questions/38821608/change-cell-reference-between-absolute-and-relative\">here</a>:</p>\n\n<pre><code>Sub Test()\nActiveCell.Formula = Application.ConvertFormula(ActiveCell.Formula, xlA1, xlA1, 1)\nEnd Sub\n</code></pre>\n\n<p>However, it only works for the active cell but I want that the VBA goes through the entire sheet. Therefore, I was trying something like this:</p>\n\n<pre><code>Sub Test()\nSheet1.Formula = Application.ConvertFormula(Sheet1.Formula, xlA1, xlA1, 1)\nEnd Sub\n</code></pre>\n\n<p>Now I get the error \"Object or method not found\".\nHow do I have to change the VBA to make it work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1530692422, "post_id": 51168903, "comment_id": 89320749, "body": "If your code already works then this might be a better question for <a href=\"https://codereview.stackexchange.com\">Code Review Stack Exchange</a> if you are looking for code optimization."}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1530692560, "post_id": 51168903, "comment_id": 89320830, "body": "Thank you i never realised this existed! i will move on over there :)"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530693261, "post_id": 51169053, "comment_id": 89321203, "body": "Thank you for this, I am still relatively new to VBA could you give me some quick pointers on incorporating it to my code?"}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530693844, "post_id": 51169053, "comment_id": 89321501, "body": "This is exactly what I am after! I am going to work through and familiarise myself with what is going on. do you mind me asking the difference in doing in memory or not? what problems i may face with either method? Thank you"}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530694476, "post_id": 51169053, "comment_id": 89321880, "body": "That makes a lot more sense, I assume my orignal method would be very simialr to the first code in as much as it &quot;touches&quot; the sheet a lot of times? whereas your array like you said figures out how many cells to change before going ahead? I may have made a mistake asking my question though. i need the dates to be generated in teh same blocks each time. so the gap needs to be 42 cells from the top of the first block to the top of the second block if that makes sense? i assume this could be done by altering the rowgap?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530694600, "post_id": 51169053, "comment_id": 89321956, "body": "Yes. I size the array to make sure it can hold all the rows and columns. I could keep using ReDim to resize but that is inefficient as it keeps making copies of the array. You know in advance how many rows and columns there will be. You work with that and then just write once to the sheet with .Cells(1, 1).Resize(UBound(outputArr), UBound(outputArr, 2)) = outputArr"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530694655, "post_id": 51169053, "comment_id": 89321980, "body": "Note I am writing to range A1 in activesheet and resizing that to the number of rows and columns in the array. outputArr,1 is the rows outputArr,2 is the number of columns."}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530695659, "post_id": 51169053, "comment_id": 89322644, "body": "So by changing the &#39;With Activesheet&#39; to a set range, for example Range(&quot;A5&quot;) would start the loop in that cell. then to fix the spacing between the start of each block i could do something with ROWGAP? maybe 42-(Enddate - Startdate) ; with 42 being the difference between the top of each block?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530696494, "post_id": 51169053, "comment_id": 89323243, "body": "It wouldn&#39;t start the loop with that cell per se. It would say write values into this range. So rowCounter = 1 would go to the first row in that range i.e. 5."}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530697711, "post_id": 51169053, "comment_id": 89323968, "body": "That makes sense. How do i go about making ROWGAP dynamic as in Set ROWGAP = (42 - (Enddate-Startdate))? I assume that would be the best way to ensure the distance stays the same between blocks?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530704350, "post_id": 51169053, "comment_id": 89328234, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/174340/discussion-between-qharr-and-dean-cohen\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1530713927, "last_edit_date": 1530713927, "creation_date": 1530692691, "answer_id": 51169053, "question_id": 51168903, "link": "https://stackoverflow.com/questions/51168903/excel-vba-date-generation-loop/51169053#51169053", "title": "Excel VBA Date Generation Loop", "body": "<p>Just seen the comments. Yes Code Review would be good. You probably want to move the entire process into an array.</p>\n\n<p>This demonstrates all the required elements.</p>\n\n<pre><code>Option Explicit\nPublic Sub GenerateDates()\n    Const LOOPCOUNT As Long = 54\n    Dim i As Long, j As Long\n    Dim startDate As Long, endDate As Long, rowCounter As Long\n    startDate = CLng(Now)\n    endDate = startDate + 7\n    Application.ScreenUpdating = False\n    With ActiveSheet\n        For i = 1 To LOOPCOUNT\n            For j = startDate To endDate\n                rowCounter = rowCounter + 1\n                .Cells(rowCounter, 1) = j\n            Next j\n             rowCounter = rowCounter + 5 '&lt;== Add gap\n        Next i\n        .Columns(\"A\").NumberFormat = \"m/d/yyyy\"\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Doing the same thing in memory (I have included a second dimension as you may have additional columns in your data. My principle was really about showing the dates increment with row gap.)</p>\n\n<pre><code>Option Explicit\nPublic Sub GenerateDates() '697\n    Const LOOPCOUNT As Long = 54      \n    Dim i As Long, j As Long\n    Dim startDate As Long, endDate As Long, rowCounter As Long\n    startDate = CLng(Now)\n    endDate = startDate + 7\n    Dim ROWGAP As Long: ROWGAP = 41-(Enddate-StartDate)\n    Dim outputArr()\n    ReDim outputArr(1 To (((endDate - startDate + 1) + ROWGAP) * LOOPCOUNT) - ROWGAP, 1 To 1)\n    Application.ScreenUpdating = False\n    With ActiveSheet\n        For i = 1 To LOOPCOUNT\n            For j = startDate To endDate\n                rowCounter = rowCounter + 1\n                outputArr(rowCounter, 1) = j\n            Next j\n            rowCounter = rowCounter + ROWGAP '&lt;== Add gap\n        Next i\n        .Cells(1, 1).Resize(UBound(outputArr), UBound(outputArr, 2)) = outputArr 'This is only with one dimensional\n        .Columns(\"A\").NumberFormat = \"m/d/yyyy\"\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>tl;dr;</strong></p>\n\n<p>The principle is basically that you want an outer loop that increments from 1 to 54. Then an inner loop that increments from start date to end date. I treat date as a Long and simply add one to the <code>startDate</code> until I reach the <code>endDate</code> in the inner loop. <code>For i = 1 To LOOPCOUNT</code> is doing the repeat work... here you could be using your copy paste. I increment the <code>rowCounter</code> variable by 5 before the next repeat to leave some blank rows between repeats. </p>\n\n<p>The first version writes to the sheet for every row with <code>.Cells(rowCounter, 1) = j</code> . That is an expensive operation \"touching\" the sheet each time. The second version does the same process but doesn't write to the sheet until the very end. Instead, it writes to an array. This is much faster as is all done in memory (no going to disk).</p>\n\n<p>I know how many rows I will have in the array because I know how many times I am repeating the entire process (54), the number of days from <code>startDate</code> and <code>endDate</code> (8) and the number of padding rows I am adding (5). So I can size my array to write to with <code>ReDim outputArr(1 To (((endDate - startDate + 1) + ROWGAP) * LOOPCOUNT) - ROWGAP, 1 To 1)</code>. I don't need 5 rows padding on the 54th loop so I remove these from the total row count.</p>\n\n<hr>\n\n<p>For understanding working with arrays and data in the worksheet the article <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">VBA Arrays And Worksheet Ranges</a> is worth a read, a long with the more general <a href=\"http://www.cpearson.com/excel/vbaarrays.htm\" rel=\"nofollow noreferrer\">VBA Arrays</a></p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530698183, "post_id": 51170235, "comment_id": 89324299, "body": "Thank you, I have had a quick go with this and it seems to run fine, how can I refer the start and end dates to cells in my sheet? just substitute dates with Range(&quot;b1&quot;) for example?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530698426, "post_id": 51170235, "comment_id": 89324469, "body": "The first two parameters of <code>getDatesArray( )</code> are  <code>StartDate</code> and <code>EndDate </code>."}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530698567, "post_id": 51170235, "comment_id": 89324555, "body": "so I wouldn&#39;t be able to change <code>data = getDatesArray(#6&#47;1&#47;2018#, #6&#47;30&#47;2018#)</code> to <code>data = getDatesArray(Range(&quot;J4&quot;), Range(&quot;J5&quot;))</code> for example? Ultimately i need the flexibility to change dates within the sheet itself by a data validation dropdown EDIT: that worked"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530698732, "post_id": 51170235, "comment_id": 89324647, "body": "Just pass the variable to the function.  <code>data = getDatesArray(startDate, endDate)</code>"}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530698804, "post_id": 51170235, "comment_id": 89324691, "body": "Sorry, I don&#39;t understand what you mean by &#39;pass the variable to the function&#39;"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530699079, "post_id": 51170235, "comment_id": 89324848, "body": "You should watch this video <a href=\"https://www.youtube.com/watch?v=Bsfe-2VcvZg&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;index=20\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 18 - Creating Functions</a> and then watch the rest of the series."}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1530699341, "post_id": 51170235, "comment_id": 89325015, "body": "Thank you, ill take a look :)"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 2, "last_activity_date": 1530696304, "creation_date": 1530696304, "answer_id": 51170235, "question_id": 51168903, "link": "https://stackoverflow.com/questions/51168903/excel-vba-date-generation-loop/51170235#51170235", "title": "Excel VBA Date Generation Loop", "body": "<p>The fewer tasks that a subroutine performs, the easier it is to write, test, and modify.  For this reason I created a function to generate the output Array.</p>\n\n<p><code>OffsetValue</code> has a somewhat ambiguous name.  I used <code>SectionLength</code> instead.</p>\n\n<pre><code>Sub AddDates()\n    Const OffsetValue = 42\n    Dim data() As Variant\n    data = getDatesArray(#6/1/2018#, #6/30/2018#)\n    With Worksheets(\"Sheet1\")\n        .Columns(1).ClearContents\n        .Range(\"A1\").Resize(UBound(data)).Value = data\n    End With\nEnd Sub\n\nFunction getDatesArray(StartDate As Date, EndDate As Date, Optional SectionLength As Long = 42, Optional RepeatCount As Long = 54) As Variant()\n    Dim results() As Variant\n    Dim count As Long, n As Long\n    ReDim results(1 To SectionLength * RepeatCount, 1 To 1)\n\n    If EndDate &gt;= StartDate Then\n        Do\n            count = count + 1\n            For n = 0 To UBound(results) - SectionLength Step SectionLength\n                results(n + count, 1) = StartDate\n            Next\n            StartDate = StartDate + 1\n        Loop Until StartDate = EndDate\n    End If\n    getDatesArray = results\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 51169053, "answer_count": 2, "score": 3, "last_activity_date": 1530713927, "creation_date": 1530692142, "question_id": 51168903, "link": "https://stackoverflow.com/questions/51168903/excel-vba-date-generation-loop", "title": "Excel VBA Date Generation Loop", "body": "<p>I have a sheet i am working on that i need to populate all the days between 2 dates for a month 54 times.</p>\n\n<p>I have got together a loop that can do this for the first section - I now need ti replicated 54 times.</p>\n\n<p>I have figured out a loop to copy and paste this range the 54 times which works as it should. however I am wondering whether there is a way to put the date generation loop inside the duplication loop and generate every date rather than copy and paste?</p>\n\n<p>I am mainly looking for the most efficient method as this will potentially be scaled up in future so any pointers with my code would be greatly appreciated.</p>\n\n<pre><code>Sub WriteDatesLoopTest()\n\n'Disables Screen Flickering on Copy/Paste\nApplication.ScreenUpdating = False\nOffsetValue = 42\n'----------------------------------------------\n    Dim StartDate       As Range\n    Dim EndDate         As Range\n    Dim OutputRange     As Range\n    Dim ClearRange      As Range\n    Dim StartValue      As Variant\n    Dim EndValue        As Variant\n    Dim DateRangeCopy   As Range\n    Dim EmployeeCount   As Range\n    Dim MonthValue      As Range\n'----------------------------------------------\n    Set ClearRange = Range(\"A9:A39\")\n    Set StartDate = Range(\"T4\")\n    Set EndDate = Range(\"T5\")\n    Set OutputRange = Range(\"A9\")\n    Set DateRangeCopy = Range(\"A9:A39\")\n    Set EmployeeCount = Range(\"O1\")\n    Set MonthValue = Range(\"J1\")\n    StartValue = StartDate\n    EndValue = EndDate\n\n'----------Date Generation Loop----------------\n\n    If EndValue - StartValue &lt;= 0 Then\n        Exit Sub\n        End If\n        ColIndex = 0\n            For i = StartValue To EndValue\n                OutputRange.Offset(ColIndex, 0) = i\n                ColIndex = ColIndex + 1\n            Next\n\n'----------Copy &amp; Paste------------------------\nn = EmployeeCount\nFor j = 0 To (n - 1)\n    'ClearRange.Offset(OffsetValue * j, 0).ClearContents\n    DateRangeCopy.Copy\n    With DateRangeCopy.Offset(OffsetValue * j, 0)\n      .PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n       SkipBlanks = False\n    End With\n\n    'Show Status Bar in Bottom Left\n    Application.StatusBar = \"Progress: \" &amp; Format(j / n, \"0%\")\n\n   Next\n\n'Display Message on completion\nMsgBox \"Dates Generated\"\n'Removes 'Walking Ants' From copied selection\nApplication.CutCopyMode = False\n'Enables Screen Flickering on Copy/Paste\nApplication.ScreenUpdating = True\n'Reset Status Bar in Bottom Left\nApplication.StatusBar = False\n'-----------------------------------\n\n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tIZQK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tIZQK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "pdf", "pdf-generation", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530689899, "post_id": 51168150, "comment_id": 89319425, "body": "Always think of a PDF like being a already printed sheet of paper. It is very hard to change PDF files once they are generated. \u2022 Additionally there is no built in function in Excel to change PDF files so therefore it might be the wrong tool. \u2022 Consider making a PDF-Form from your PDF once you generated it, where you then can fill in the values every week and print/save that. This would be the easiest way I think."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1530691064, "post_id": 51168150, "comment_id": 89320034, "body": "AutoCAD seems to support vba programming (see <a href=\"https://knowledge.autodesk.com/support/autocad/downloads/caas/downloads/content/download-the-microsoft-visual-basic-for-applications-module-vba.html\" rel=\"nofollow noreferrer\">here</a> ), you might want to create a form directly in you AutoCAD project (I personally don&#39;t know AutoCAD)"}], "owner": {"reputation": 41, "user_id": 8536734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PURwHAt_fwk/AAAAAAAAAAI/AAAAAAAAAEM/8Ex-GVjDL6c/photo.jpg?sz=128", "display_name": "NvG", "link": "https://stackoverflow.com/users/8536734/nvg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530689562, "creation_date": 1530689462, "last_edit_date": 1531161705, "question_id": 51168150, "link": "https://stackoverflow.com/questions/51168150/changing-the-values-of-a-drawing-using-excel-or-script", "title": "Changing the values of a drawing using excel or script", "body": "<p>I'm currently trying to figure out a way to change the measurement values of a AutoCAD drawing (plot/printed). I have 1 drawing with multiple parts, but the only thing that needs to be changed (almost weekly) and that is the values of some measurements for these parts. </p>\n\n<p><a href=\"https://i.stack.imgur.com/dERQd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dERQd.png\" alt=\"VIEW EXAMPLE HERE\"></a></p>\n\n<p>I've looked to Excel for a way to make a sheet where i can fill in these values and they get changed instantly. It can be an .PDF file that gets changed, the drawing needs to be printed anyway so no direct insert into AutoCAD needed. </p>\n\n<p>Any tips or advice is welcome!</p>\n\n<p>Cheers,\nNvG</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "renaming"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530689405, "post_id": 51168002, "comment_id": 89319187, "body": "What happens if you  Dim OldName As String?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1530689464, "post_id": 51168002, "comment_id": 89319214, "body": "Use <code>&amp;</code> to concatenate strings. Otherwise Excel may be want to calculate with <code>+</code>: <code>OldName = &quot;&quot; &amp; n &amp; &quot;.xlsm&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "edited": false, "score": 0, "creation_date": 1530690055, "post_id": 51168149, "comment_id": 89319515, "body": "This error disappeared , but the new occurs in line (first one)     Name OldName As NewName R-t error 53 file not found"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "edited": false, "score": 0, "creation_date": 1530690254, "post_id": 51168149, "comment_id": 89319612, "body": "Does the old filename exist?"}, {"owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "edited": false, "score": 0, "creation_date": 1530690407, "post_id": 51168149, "comment_id": 89319703, "body": "Yes (1.xlsm ,4.xlsm ...)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "edited": false, "score": 1, "creation_date": 1530690480, "post_id": 51168149, "comment_id": 89319748, "body": "You need the full file path in the cell."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1530690538, "last_edit_date": 1530690538, "creation_date": 1530689457, "answer_id": 51168149, "question_id": 51168002, "link": "https://stackoverflow.com/questions/51168002/run-time-error-13-in-renaming-book/51168149#51168149", "title": "Run-time error 13 in renaming book", "body": "<p>I would try <code>Dim oldName As String</code> as you are working with a string and then use <code>&amp;</code> to concatenate, not <code>+</code>. </p>\n\n<p>You can explicitly convert <code>n</code> with <code>CStr(n)</code> rather than let it be implicitly converted. </p>\n\n<p>And what is the point of <code>\"\" +</code> at the start? It won't add anything. Just <code>Cstr(n) &amp; \".xlsm\"</code> should suffice.</p>\n\n<p><code>n</code> must contain the full file path as the <code>Name</code> function requires the <strong><em>location</em></strong> and the filename.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/name-statement\" rel=\"nofollow noreferrer\">Name statement:</a></p>\n\n<blockquote>\n  <p><strong>oldpathname</strong>   Required. String expression that specifies the existing\n  file name and location \u2014 may include directory or folder, and drive.</p>\n  \n  <p><strong>newpathname</strong>   Required. String expression that specifies the new file\n  name and location \u2014 may include directory or folder, and drive. The\n  file name specified by newpathname can't already exist.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10030580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e77afdf5d2c05c54bf34559a7d8cdf?s=128&d=identicon&r=PG&f=1", "display_name": "P. Green", "link": "https://stackoverflow.com/users/10030580/p-green"}, "is_accepted": false, "score": 1, "last_activity_date": 1530690923, "last_edit_date": 1530690923, "creation_date": 1530690153, "answer_id": 51168342, "question_id": 51168002, "link": "https://stackoverflow.com/questions/51168002/run-time-error-13-in-renaming-book/51168342#51168342", "title": "Run-time error 13 in renaming book", "body": "<p>I think that the <code>+</code> should be an <code>&amp;</code>. line should read </p>\n\n<pre><code>oldname = \"path\\filename\" &amp; n &amp; \".xlsm\" \n</code></pre>\n\n<p>Possible <code>cstr(n)</code> or <code>text(n , \"format\")</code> could do the same</p>\n"}], "owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 51168149, "answer_count": 2, "score": 2, "last_activity_date": 1530690923, "creation_date": 1530688982, "last_edit_date": 1531164843, "question_id": 51168002, "link": "https://stackoverflow.com/questions/51168002/run-time-error-13-in-renaming-book", "title": "Run-time error 13 in renaming book", "body": "<p>There is book1 where in one column are the names of old books , and in another the names of new ones (old ones need to be renamed in new ones). n,m-numbers. </p>\n\n<p>An error occurs: </p>\n\n<blockquote>\n  <p>Run-time error \u201813\u2019 Type mismatch in line </p>\n</blockquote>\n\n<pre><code>OldName = \"\" + n + \".xlsm\"\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>    Sub \u041a\u043b()\n\n    Dim OldName, NewName\n    Dim book1 As Workbook\n    Dim t As Long, m As Long, n As Long\n\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n     Set book1 = Workbooks.Open(\"E:\\Super M\\\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u0442\u0430\u0432\u043a\u0438\\\u041f\u043e\u0438\u0441\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u044f\\\u0423\u0441\u043e\u0432 \n           7\\\u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b\\\u041a\u043d\u0438\u0433\u0430 \u0432 \u043b\u0438\u0441\u0442\\\u0432\u0438\u0437.xlsx\")\n     For t = 3 To 5\n\n      n = book1.Worksheets(\"\u043e\u0431\u0449\").Range(\"C\" &amp; t).Value\n      m = book1.Worksheets(\"\u043e\u0431\u0449\").Range(\"C\" &amp; t).Offset(0, 1).Value\n\n      OldName = \"\" + n + \".xlsm\"\n      NewName = \"\" + m + \".xlsm\"\n\n      Name OldName As NewName\n\n      OldName = \"E:\\Super M\\\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u0442\u0430\u0432\u043a\u0438\\\u041f\u043e\u0438\u0441\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u044f\\\u0423\u0441\u043e\u0432 \n            7\\\u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b\\\u041a\u043d\u0438\u0433\u0430 \u0432 \u043b\u0438\u0441\u0442\\\u041e\u0442\u0431\u043e\u0440\u043d\u044b\u0435 \n            \u0443\u0441\u043b\u043e\u0432\u0438\u044f\\\u041e\u0442\u043a\u0443\u0434\u0430\\\" + n + \".xlsm\"\n      NewName = \"E:\\Super M\\\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u0442\u0430\u0432\u043a\u0438\\\u041f\u043e\u0438\u0441\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u044f\\\u0423\u0441\u043e\u0432 \n              7\\\u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b\\\u041a\u043d\u0438\u0433\u0430 \u0432 \u043b\u0438\u0441\u0442\\\u041e\u0442\u0431\u043e\u0440\u043d\u044b\u0435 \n             \u0443\u0441\u043b\u043e\u0432\u0438\u044f\\\u041a\u0443\u0434\u0430\\\" + m + \".xlsm\"\n\n      Name OldName As NewName\n\n      Next t\n      book1.Close\n\n      Application.ScreenUpdating = True\n      Application.Calculation = xlCalculationAutomatic\n      Application.EnableEvents = True\n\n      End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2549, "user_id": 823321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrwbB.png?s=128&g=1", "display_name": "s\u0250un\u0131\u0254\u05df\u0250q\u0250p", "link": "https://stackoverflow.com/users/823321/s%c9%90un%c4%b1%c9%94%d7%9f%c9%90q%c9%90p"}, "edited": false, "score": 0, "creation_date": 1530688249, "post_id": 51167723, "comment_id": 89318525, "body": "Welcome to Stack Overflow! Questions like these are <a href=\"https://stackoverflow.com/help/on-topic\">too broad</a>. Try asking <a href=\"https://stackoverflow.com/help/mcve\">minimal specific questions about programming issues</a>, by splitting your problem into smaller questions. If you require tutorials and courses on how to accomplish your goals, unfortunately Stack Overflow is not the right place to do it."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530688876, "post_id": 51167723, "comment_id": 89318900, "body": "\u2460 Your code seems to be incomplete. There is a <code>Loop</code> but no <code>Do</code>. \u2461 Read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>, this will already prevent issues and makes your code faster and more reliable. \u2462 Because Stack Overflow is no code writing service the question <i>&quot;What is the correct code on this?&quot;</i> is too broad to answer. You must show what errors you get and where, or explain what your code actually does and what you expected instead. So we need to know what exactly in your code doesn&#39;t work."}, {"owner": {"reputation": 21, "user_id": 9999402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bfd238211e52c7a1ff08740222c51?s=128&d=identicon&r=PG&f=1", "display_name": "user9999402", "link": "https://stackoverflow.com/users/9999402/user9999402"}, "edited": false, "score": 0, "creation_date": 1530692460, "post_id": 51167723, "comment_id": 89320766, "body": "@PEH Hi, thank you for pointing that out. actually, the code is working fine. My problem is when the code reads the file name of the second file I inputted in the master data sheet, instead it goes to the next tab, it will only go under the data of the first file."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530692747, "post_id": 51167723, "comment_id": 89320930, "body": "@user9999402 Your code is still incomplete! Please first update your question. Add the relevant code part (we need to see the complete loop). And by &quot;next tab&quot; you mean a worksheet? Please put all your questions into the question part above and be as detailed as possible and use the correct terms."}, {"owner": {"reputation": 21, "user_id": 9999402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bfd238211e52c7a1ff08740222c51?s=128&d=identicon&r=PG&f=1", "display_name": "user9999402", "link": "https://stackoverflow.com/users/9999402/user9999402"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530693895, "post_id": 51167723, "comment_id": 89321536, "body": "@P\u1d07\u029c, apologies for that. My pc crashed and I thought it is already complete. I already edited this. Would this suffice? I attached also the screenshots."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9999402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bfd238211e52c7a1ff08740222c51?s=128&d=identicon&r=PG&f=1", "display_name": "user9999402", "link": "https://stackoverflow.com/users/9999402/user9999402"}, "edited": false, "score": 0, "creation_date": 1530696842, "post_id": 51170183, "comment_id": 89323449, "body": "I tried, but the error message is showing that it is not complete."}, {"owner": {"reputation": 26, "user_id": 10031182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-biaYI6Hczy4/AAAAAAAAAAI/AAAAAAAAABY/1nC1mbR2mrU/photo.jpg?sz=128", "display_name": "Mick Fuller", "link": "https://stackoverflow.com/users/10031182/mick-fuller"}, "reply_to_user": {"reputation": 21, "user_id": 9999402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bfd238211e52c7a1ff08740222c51?s=128&d=identicon&r=PG&f=1", "display_name": "user9999402", "link": "https://stackoverflow.com/users/9999402/user9999402"}, "edited": false, "score": 0, "creation_date": 1530701149, "post_id": 51170183, "comment_id": 89326157, "body": "That is odd, it is working fine for me.  Try commenting out the onerror line so that you will be able to see at which point the code fails."}, {"owner": {"reputation": 21, "user_id": 9999402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bfd238211e52c7a1ff08740222c51?s=128&d=identicon&r=PG&f=1", "display_name": "user9999402", "link": "https://stackoverflow.com/users/9999402/user9999402"}, "edited": false, "score": 0, "creation_date": 1530755599, "post_id": 51170183, "comment_id": 89347113, "body": "Sorry for that. I have mistakenly updated the vba code. It is now working. But one help needed please. for the text files, before it pasted to the necessary sheets, I want first to open the text wizard so the user would be able to format it first. (It is the user option to use delimited or fixed width."}], "tags": [], "owner": {"reputation": 26, "user_id": 10031182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-biaYI6Hczy4/AAAAAAAAAAI/AAAAAAAAABY/1nC1mbR2mrU/photo.jpg?sz=128", "display_name": "Mick Fuller", "link": "https://stackoverflow.com/users/10031182/mick-fuller"}, "is_accepted": true, "score": 0, "last_activity_date": 1530696476, "last_edit_date": 1530696476, "creation_date": 1530696162, "answer_id": 51170183, "question_id": 51167723, "link": "https://stackoverflow.com/questions/51167723/get-and-transfer-files-in-specific-sheets/51170183#51170183", "title": "Get and Transfer files in Specific sheets", "body": "<p>I suspect that to solve the pasting issue the line that reads:</p>\n\n<pre><code>Sheets(\"Master Data\").select\n</code></pre>\n\n<p>should read</p>\n\n<pre><code>Sheets(strWhereToCopy).select\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9999402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bfd238211e52c7a1ff08740222c51?s=128&d=identicon&r=PG&f=1", "display_name": "user9999402", "link": "https://stackoverflow.com/users/9999402/user9999402"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 51170183, "answer_count": 1, "score": 0, "last_activity_date": 1530696476, "creation_date": 1530688061, "last_edit_date": 1530694450, "question_id": 51167723, "link": "https://stackoverflow.com/questions/51167723/get-and-transfer-files-in-specific-sheets", "title": "Get and Transfer files in Specific sheets", "body": "<p>I am currently doing a report in which I will get the reports based on the link/path and file name I indicated in a specific cell and data should be transferred in the specific sheet I also indicated. This is needed as the path is always changing depending on where the user saved the files.</p>\n\n<p>1st thing is, I have the \"List\" tab where I have inputted the file name and full path of each files and in what location should it be pasted. For example, File A should be pasted to \"MasterData\" sheet. File B, should be in the next tab, File C should be in the other tab.</p>\n\n<p>Then, when I use the vba, it will get my files. File has been copied to \"MasterData\" sheet but the 2nd and 3rd file were copied under the data of File A which is my problem.</p>\n\n<p>The 2nd file and 3rd files also are in text format but I want the Text Wizard to pop up first so the user can choose if the data should be delimited or Fixed width before copying it to the assigned sheets. </p>\n\n<p><strong>List Sheet</strong>\n<a href=\"https://i.stack.imgur.com/Lp9Z2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lp9Z2.png\" alt=\"List Sheet\"></a> </p>\n\n<p><strong>MasterData Sheet Results</strong>\n<a href=\"https://i.stack.imgur.com/5h81x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5h81x.png\" alt=\"MasterData Sheet Results\"></a></p>\n\n<p>I cannot attach my file here :(</p>\n\n<p><strong>This is my current VBA code:</strong></p>\n\n<pre><code>Public strFileName As String\nPublic currentWB As Workbook\nPublic dataWB As Workbook\nPublic strCopyRange As String\n\nSub GetData()\n    Dim strWhereToCopy As String, strStartCellColName As String\n    Dim strListSheet As String\n\n    strListSheet = \"List\"\n\n    On Error GoTo ErrH\n    Sheets(strListSheet).Select\n    Range(\"B2\").Select\n\n    'this is the main loop, we will open the files one by one and copy their data into the masterdata sheet\n    Set currentWB = ActiveWorkbook\n    Do While ActiveCell.Value &lt;&gt; \"\"\n\n        strFileName = ActiveCell.Offset(0, 1) &amp; ActiveCell.Value\n        strCopyRange = ActiveCell.Offset(0, 2) &amp; \":\" &amp; ActiveCell.Offset(0, 3)\n        strWhereToCopy = ActiveCell.Offset(0, 4).Value\n        strStartCellColName = Mid(ActiveCell.Offset(0, 5), 2, 1)\n\n        Application.Workbooks.Open strFileName, UpdateLinks:=False, ReadOnly:=False\n        Set dataWB = ActiveWorkbook\n\n        Range(strCopyRange).Select\n        Selection.Copy\n\n        currentWB.Activate\n        Sheets(\"MasterData\").Select\n        lastRow = LastRowInOneColumn(strStartCellColName)\n        Cells(lastRow + 1, 1).Select\n\n        Selection.PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n        Application.CutCopyMode = False\n        dataWB.Close False\n        Sheets(\"List\").Select\n        ActiveCell.Offset(1, 0).Select\n\n\n    Loop\n\n\n    Exit Sub\n\nErrH:\n    MsgBox \"It seems some file was missing. The data copy operation is not complete.\"\n    Exit Sub\nEnd Sub\n\nPublic Function LastRowInOneColumn(col)\n    'Find the last used row in a Column: column A in this example\n    'http://www.rondebruin.nl/last.htm\n    Dim lastRow As Long\n    With ActiveSheet\n    lastRow = .Cells(.Rows.Count, col).End(xlUp).Row\n    End With\n    LastRowInOneColumn = lastRow\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1530681643, "post_id": 51166200, "comment_id": 89315583, "body": "are you trying to expand the existing table, or create a new one? If the latter, then it seems to be a pretty simple vba task"}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1530681815, "post_id": 51166200, "comment_id": 89315632, "body": "Both are fine. I seem to be just not good enough to do it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530682034, "post_id": 51166200, "comment_id": 89315701, "body": "Of course it&#39;s possible."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530682252, "post_id": 51166200, "comment_id": 89315774, "body": "Have you looked into Do Loops?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1530682253, "post_id": 51166200, "comment_id": 89315775, "body": "Have you tried any code at all that we can build on?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530684208, "post_id": 51166641, "comment_id": 89316537, "body": "It ssems you just need another outer loop to go through the cells row by row."}], "tags": [], "owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "is_accepted": false, "score": 1, "last_activity_date": 1530683730, "creation_date": 1530683730, "answer_id": 51166641, "question_id": 51166200, "link": "https://stackoverflow.com/questions/51166200/list-name-and-numbers-between-two-values/51166641#51166641", "title": "List name and numbers between two values", "body": "<p>This is what I have so far. And it semi works. I need to make it jump on the next line ( it just repeats the first one forever ) and make it stop when done. \nI havent been able to make it add +1 on the row portion of (Row, Column) in starti and endi and Name i after it is done with first row range. Mine also runs indefinitely so I also miss a stop once done.</p>\n\n<pre><code>Sub FillIN()\n\nDim ws As Worksheet\nDim stri As Long, endi As Long\nDim Name As Variant\n\nSet ws = Sheets(1)\nName = Sheets(1).Cells(2, 1).Value\nstrti = Sheets(1).Cells(2, 2).Value\nendi = Sheets(1).Cells(2, 3).Value\n\nFor i = strti To endi\nws.Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Value = i\nws.Cells(Rows.Count, 5).End(xlUp).Offset(1, 0).Value = Name\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530684411, "post_id": 51166693, "comment_id": 89316638, "body": "Much better idea +1"}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1530684880, "post_id": 51166693, "comment_id": 89316861, "body": "I love your solution Jeeped. And it starts but then throws an error: Out of memory. It gives maybe a quarter values thought the process. So the solution is nice and elegant but it seems that the list is too long. Is it possible to tweak the other one with outer loop? Maybe that will work."}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1530684886, "post_id": 51166693, "comment_id": 89316869, "body": "I love your solution Jeeped. And it starts but then throws an error: Out of memory. It gives maybe a quarter values thought the process. So the solution is nice and elegant but it seems that the list is too long. Is it possible to tweak the other one with outer loop? Maybe that will work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530685074, "post_id": 51166693, "comment_id": 89316962, "body": "Just how large do Value1 and value2 get?"}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1530685577, "post_id": 51166693, "comment_id": 89317183, "body": "Max Value 9800. And the difference between Value 1 &amp; 2 is between 2-50ish. But there was around 900 rows of data with Value 1 &amp; 2. With QHars solution I got 18k pairs of Name &amp; Value. Your solution is perfect Jepped. I just failed to mention the size because I didnt think it would make a problem. Apparently for array it could be."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530685702, "post_id": 51166693, "comment_id": 89317276, "body": "I&#39;ve added an outer loop to your code in an addendum above."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530685792, "post_id": 51166693, "comment_id": 89317315, "body": "tbh, it shouldn&#39;t have blown up with those numbers but it did so back to the drawing board."}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1530686725, "post_id": 51166693, "comment_id": 89317780, "body": "Thank you Jepeed!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1530685631, "last_edit_date": 1530685631, "creation_date": 1530683979, "answer_id": 51166693, "question_id": 51166200, "link": "https://stackoverflow.com/questions/51166200/list-name-and-numbers-between-two-values/51166693#51166693", "title": "List name and numbers between two values", "body": "<p>I wrote one based on an array to collect then transfer the values.</p>\n\n<pre><code>Sub expandValues()\n    Dim i As Long, j As Long, arr As Variant\n\n    With Worksheets(\"sheet5\")\n        .Cells(1, \"E\").Resize(1, 2) = Array(\"Name\", \"Value\")\n\n        For i = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            ReDim arr(.Cells(i, \"B\").Value2 To .Cells(i, \"C\").Value2, 1 To 2)\n            For j = LBound(arr, 1) To UBound(arr, 1)\n                arr(j, 1) = .Cells(i, \"A\").Value2\n                arr(j, 2) = j\n            Next j\n            .Cells(.Rows.Count, \"E\").End(xlUp).Offset(1, 0). _\n              Resize(UBound(arr, 1) - LBound(arr, 1) + 1, UBound(arr, 2)) = arr\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MNq7N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MNq7N.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/51166200/list-name-and-numbers-between-two-values/51166693#51166693\">Addendum:</a></strong></p>\n\n<p>Here is yours with an outer loop to process through the rows.</p>\n\n<pre><code>Sub FillIN()\n    Dim stri As Long, endi As Long\n    Dim nm As string, i as long, j as long\n\n    with workSheets(1)\n        For i = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            nm = .Cells(i, \"A\").Value\n            strti = .Cells(i, \"B\").Value\n            endi = .Cells(i, \"C\").Value\n\n            For j= strti To endi\n                .Cells(.Rows.Count, \"E\").End(xlUp).Offset(1, 0) = nm\n                .Cells(.Rows.Count, \"E\").End(xlUp).Offset(0, 1) = j\n            Next j\n        next i\n    end with\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1530685061, "post_id": 51166784, "comment_id": 89316957, "body": "QHarr, this is great. Jeppeds solution is prettier and both work but it was my fault that I didnt state how long is the list so his runs out of memory."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 0, "creation_date": 1530685301, "post_id": 51166784, "comment_id": 89317064, "body": "Jeeped&#39;s answer, as usual, is first rate. Mine is less efficient by a mile (+ a lot)  but does show you how to use a Loop which was my intention. :-)"}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "edited": false, "score": 1, "creation_date": 1530685609, "post_id": 51166784, "comment_id": 89317210, "body": "Jepped is amazing. Super fast and super creative solutions."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1530684378, "creation_date": 1530684378, "answer_id": 51166784, "question_id": 51166200, "link": "https://stackoverflow.com/questions/51166200/list-name-and-numbers-between-two-values/51166784#51166784", "title": "List name and numbers between two values", "body": "<p>Something like the following?</p>\n\n<pre><code>Option Explicit\nPublic Sub ListLines()\n    Dim ws As Worksheet, i As Long, y As Long, rowCounter As Long\n    Application.ScreenUpdating = False\n    Set ws = ActiveSheet: rowCounter = 1\n    With ws\n        For i = 2 To GetLastRow(ws, 1)\n            For y = .Cells(i, 2) To .Cells(i, 3)\n                .Cells(rowCounter, 5) = .Cells(i, 1)\n                .Cells(rowCounter, 6) = y\n                 rowCounter = rowCounter + 1\n            Next y\n        Next i\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetLastRow(ByVal ws As Worksheet, ByVal columNum As Long) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "accepted_answer_id": 51166693, "answer_count": 3, "score": 1, "last_activity_date": 1530685631, "creation_date": 1530681364, "last_edit_date": 1531164843, "question_id": 51166200, "link": "https://stackoverflow.com/questions/51166200/list-name-and-numbers-between-two-values", "title": "List name and numbers between two values", "body": "<p>I have been googling a lot and I couldnt make this one work in any way. </p>\n\n<p>I have a table of three columns (Name, Value1, Value2) with lots of names.\nI need a vba to list all numbers between value 1&amp;2 including them and their respective names. </p>\n\n<p>For example for row A, 3000, 3003 make rows A, 3000; A, 3001; A, 3002; A, 3003 and then continue on the next name and split that name's range into individual numbers. </p>\n\n<p>Is this even possible?</p>\n\n<p>Thank you so much. </p>\n"}, {"tags": ["vba", "filter", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530680531, "post_id": 51166044, "comment_id": 89315239, "body": "Is this code in a worksheet&#39;s private code sheet or a public module code sheet?"}, {"owner": {"reputation": 1, "user_id": 10001621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J8HavI4sZVw/AAAAAAAAAAI/AAAAAAAADkU/rbGFogud_Sg/photo.jpg?sz=128", "display_name": "IceBurnHex", "link": "https://stackoverflow.com/users/10001621/iceburnhex"}, "edited": false, "score": 0, "creation_date": 1530681558, "post_id": 51166044, "comment_id": 89315554, "body": "It is in the public I believe. I can&#39;t say I&#39;m 100% sure, as I haven&#39;t delved very far into that stuff yet, but I don&#39;t think I have any private stuff on my vba yet. I literally just have a huge list of Sub Commands. Basically what I have displayed is exactly what I have in my actual code, just more Filters and such."}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 3966789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qbBtF.jpg?s=128&g=1", "display_name": "Nagarajan Sathish", "link": "https://stackoverflow.com/users/3966789/nagarajan-sathish"}, "is_accepted": false, "score": 1, "last_activity_date": 1530692826, "creation_date": 1530692826, "answer_id": 51169103, "question_id": 51166044, "link": "https://stackoverflow.com/questions/51166044/vba-filter-function-prevent-error-on-click/51169103#51169103", "title": "VBA Filter Function - Prevent Error On Click", "body": "<p>You didn't get error after \"Filter 1\" or \"Filter 2\" is because the module selects a range.</p>\n\n<blockquote>\n  <p>Sub Clear()</p>\n  \n  <p>'Must select before working with selection</p>\n  \n  <p>Range(\"A1\").Select</p>\n  \n  <p><strong>Selection</strong>.AutoFilter</p>\n  \n  <p>End Sub</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 10001621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J8HavI4sZVw/AAAAAAAAAAI/AAAAAAAADkU/rbGFogud_Sg/photo.jpg?sz=128", "display_name": "IceBurnHex", "link": "https://stackoverflow.com/users/10001621/iceburnhex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530692826, "creation_date": 1530680365, "question_id": 51166044, "link": "https://stackoverflow.com/questions/51166044/vba-filter-function-prevent-error-on-click", "title": "VBA Filter Function - Prevent Error On Click", "body": "<p>hopefully this is an easy fix, but I'm still too new to this to know what to look for in the functions. I'm basically making an autofilter function for a work in progress, and everything works fine, unless I start off clicking the \"clear filter\" function block I made. </p>\n\n<p>I wanted to include this function so I can click on \"Filter 1\", \"Filter 2\" and then a quick \"Clear Filter\" to bring things back to normal. If I didn't click \"Filter 1\" or \"Filter 2\" before clicking \"Clear Filter\", it goes into debug mode. Is there a way around that?</p>\n\n<pre><code>Sub Filter1()\n  Dim LastRow As Long\n\n  LastRow = Range(\"C1\").CurrentRegion.Rows.Count\n  Range(\"A1:H\" &amp; LastRow).Select\n  Selection.AutoFilter Field:=3, Criteria1:=\"VariableX\"\n\nEnd Sub\n\nSub Clear()\n\n  Selection.AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance on any help with this!</p>\n"}, {"tags": ["ms-access", "hyperlink", "properties", "vba", "controls"], "answers": [{"tags": [], "owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "is_accepted": false, "score": 1, "last_activity_date": 1530729810, "last_edit_date": 1530729810, "creation_date": 1530683924, "answer_id": 51166681, "question_id": 51165863, "link": "https://stackoverflow.com/questions/51165863/ms-access-vba-how-to-determine-if-a-control-has-a-specific-property/51166681#51166681", "title": "MS Access VBA - how to determine if a control has a specific property", "body": "<p>Here's some code that will run on a button click and check a specific control, in this case, a <code>Link</code> (which is actually a <code>Label</code> with a <code>Hyperlink Address</code> property).</p>\n\n<pre><code>Private Sub cmdCheckForHyperlink_Click()\n\n    Dim prp As Property\n\n    On Error GoTo Props_Err\n\n    For Each prp In Me.lblHyperlink.Properties\n        'Debug.Print vbTab &amp; prp.Name &amp; \" = \" &amp; prp.Value\n        If prp.Name = \"HyperlinkAddress\" Then\n            MsgBox \"It's a hyperlink.\"\n        End If\n    Next prp\n\nProps_Exit:\n    Set prp = Nothing\n    Exit Sub\n\nProps_Err:\n    If Err = 2187 Then\n        'Property is only available at design time.\n        Resume Next\n    Else\n        'An Error Occurred.\n        Resume Next\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong>: Note, I haven't checked to see if any other controls have a hyperlink address property, <em>presumably</em> not.</p>\n\n<p><strong>Edit 2</strong>: There are good approaches in the given answers but be aware that checking the length will not tell you anything if the length is zero. A good approach would probably be a combination of checking all controls that have a hyperlink property (see Erik's answer) and looping the properties to double-check the property exists, and if you need a property-value.</p>\n"}, {"comments": [{"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1530728810, "post_id": 51166689, "comment_id": 89340943, "body": "The <code>For Each</code> won&#39;t tell you it&#39;s a hyperlink if Len(ctl.HyperlinkAddress) equals 0."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1530683949, "creation_date": 1530683949, "answer_id": 51166689, "question_id": 51165863, "link": "https://stackoverflow.com/questions/51165863/ms-access-vba-how-to-determine-if-a-control-has-a-specific-property/51166689#51166689", "title": "MS Access VBA - how to determine if a control has a specific property", "body": "<p><a href=\"http://allenbrowne.com/AppPrintMgtCode.html#HasProperty\" rel=\"nofollow noreferrer\">http://allenbrowne.com/AppPrintMgtCode.html#HasProperty</a></p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function HasProperty(obj As Object, strPropName As String) As Boolean\n    'Purpose: Return true if the object has the property.\n    Dim varDummy As Variant\n\n    On Error Resume Next\n    varDummy = obj.Properties(strPropName)\n    HasProperty = (Err.Number = 0)\nEnd Function\n</code></pre>\n\n<p>Basically this just handles the error if the property doesn't exist.</p>\n\n<p>So in your case, you could simply ignore all errors:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For Each ctl in Me.Controls\n    ' Init for error case\n    isHyperlink = False\n    On Error Resume Next\n    isHyperlink = (Len(ctl.HyperlinkAddress) &gt; 0)\n    On Error Goto ErrHandler\n\n    If isHyperlink Then\n        ' ...\n    End If\nNext ctl\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1530702146, "post_id": 51167411, "comment_id": 89326806, "body": "I tend to value efficiency over politeness in this case. :) Looping the whole properties collection is meh. It&#39;s one of the issues with all collections - from <a href=\"http://www.cpearson.com/Excel/CollectionsAndDictionaries.htm\" rel=\"nofollow noreferrer\">CPearson</a>: <i>In a rather poor object design, the Key of an item in a Collection is write-only. [...] you cannot retrieve the Key associated with an Item nor can you determine (directly) whether a key exists in a Collection.</i>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1530686917, "creation_date": 1530686917, "answer_id": 51167411, "question_id": 51165863, "link": "https://stackoverflow.com/questions/51165863/ms-access-vba-how-to-determine-if-a-control-has-a-specific-property/51167411#51167411", "title": "MS Access VBA - how to determine if a control has a specific property", "body": "<p>Just using error catching is kind off brute force. It is more polite to loop the properties:</p>\n\n<pre><code>Public Function IsProperty( _\n  ByVal obj As Object, _\n  ByVal strName As String) _\n  As Boolean\n\n  Dim prp       As Property\n  Dim booFound  As Boolean\n\n  For Each prp In obj.Properties\n    If StrComp(prp.Name, strName, vbTextCompare) = 0 Then\n      ' Property exists.\n      booFound = True\n      Exit For\n    End If\n  Next\n\n  IsProperty = booFound\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1530687730, "creation_date": 1530687730, "answer_id": 51167636, "question_id": 51165863, "link": "https://stackoverflow.com/questions/51165863/ms-access-vba-how-to-determine-if-a-control-has-a-specific-property/51167636#51167636", "title": "MS Access VBA - how to determine if a control has a specific property", "body": "<p>If you don't want to use error trapping, you can use <code>TypeOf</code> to test if the control has an interface that supports <code>.HyperlinkAddress</code>.</p>\n\n<p>Using the object browser, you can find that the <code>Access.CommandButton</code>, <code>Access.Image</code>, <code>Access.Label</code> and <code>Access.NavigationButton</code> interface support this property.</p>\n\n<p>You might want to split this condition, but in one line, it would be:</p>\n\n<pre><code>If TypeOf ctl Is Access.CommandButton Or TypeOf ctl Is Access.Image Or TypeOf ctl Is Access.Label Or TypeOf ctl Is Access.NavigationButton Then\n    If Len(ctl.HyperlinkAddress) &gt; 0 Then\n\n    End If\nEnd If\n</code></pre>\n\n<p>You can, of course, omit <code>Access.</code> here. But I tend to keep it to differentiate between MSForms controls.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10049059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155566388734249/picture?type=large", "display_name": "Tom", "link": "https://stackoverflow.com/users/10049059/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1531049785, "last_edit_date": 1531049785, "creation_date": 1531046001, "answer_id": 51231099, "question_id": 51165863, "link": "https://stackoverflow.com/questions/51165863/ms-access-vba-how-to-determine-if-a-control-has-a-specific-property/51231099#51231099", "title": "MS Access VBA - how to determine if a control has a specific property", "body": "<p>There are lots of ways to do anything in VBA but looking at the answers given, Andre's answer seems to be the most efficient to me and is also the way I deal with this type of issue</p>\n\n<p>For Each ctl in Me.Controls</p>\n\n<pre><code>' Init for error case\n\nisHyperlink = False\n\nOn Error Resume Next\n\nisHyperlink = (Len(ctl.HyperlinkAddress) &gt; 0)\n\nOn Error Goto ErrHandler\n\nIf isHyperlink Then\n    ' ...\nEnd If\n</code></pre>\n\n<p>Next ctl</p>\n\n<p>Setting the default of false and turning off error checking for the single command means you are doing one check only for the control, if it fails then the false is already set otherwise it will make it true for the next block of code. Be sure to turn error checking back on.</p>\n\n<p>Cycling through all the properties as Gustav suggested will work but there are so many properties to cycle through therefore so many checks = longer time to execute, by the time you multiply this by all the controls on the form will prove a big time waster, especially if there are a lot of controls.</p>\n"}], "owner": {"reputation": 125, "user_id": 2514675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/jiLwU.jpg?s=128&g=1", "display_name": "lmorse", "link": "https://stackoverflow.com/users/2514675/lmorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1768, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1531049785, "creation_date": 1530679212, "last_edit_date": 1530682405, "question_id": 51165863, "link": "https://stackoverflow.com/questions/51165863/ms-access-vba-how-to-determine-if-a-control-has-a-specific-property", "title": "MS Access VBA - how to determine if a control has a specific property", "body": "<p>I am trying to check if a control on a form is a hyperlink using:</p>\n\n<pre><code>If (Len(ctl.HyperlinkAddress) &lt; 0) Then\n</code></pre>\n\n<p>... however an error is being thrown by some controls that do not contain this property.</p>\n\n<p>How can I test to see if this property exists before checking the length?</p>\n\n<p>Is there a better approach to test for a hyperlink?</p>\n\n<p>Thanks in advance</p>\n\n<p>Lee</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1530679264, "post_id": 51165814, "comment_id": 89314840, "body": "You want to check \\ or currency symbol?"}, {"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1530680285, "post_id": 51165814, "comment_id": 89315157, "body": "I want check 2 both? text exist or set currency."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1530680450, "post_id": 51165814, "comment_id": 89315215, "body": "try this  <code>If InStr(strText, &quot;&#165;&quot;, vbTextCompare) &gt; 0 And InStr(strText, &quot;\\&quot;, vbTextCompare) &gt; 0 Then</code>"}, {"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1530680682, "post_id": 51165814, "comment_id": 89315280, "body": "value  &quot;&#165;&quot; can&#39;t copy to vba,"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1530680738, "post_id": 51165814, "comment_id": 89315299, "body": "use Ascii as below shown by @Jeeped"}, {"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1530682160, "post_id": 51165814, "comment_id": 89315739, "body": "It still not ok,If InStr(strText, Chr(165), vbTextCompare) &gt; 0 Or InStr(strText, &quot;\\&quot;, vbTextCompare) &gt; 0 Then"}], "answers": [{"comments": [{"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "edited": false, "score": 0, "creation_date": 1530680196, "post_id": 51165907, "comment_id": 89315127, "body": "It still not ok,"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530682780, "post_id": 51165907, "comment_id": 89315962, "body": "This doesn&#39;t work because the cell does not containg the YEN symbol, it is applied visually only since the cell has accounting format."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530683212, "post_id": 51165907, "comment_id": 89316142, "body": "@jamheadart - Actually, you would be wrong on that point. You would be right if I was looking at the range.value or range.value2 but the range.text is the cell&#39;s <b>displayed text</b> and that includes any symbols added by a currency number format."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530683270, "post_id": 51165907, "comment_id": 89316161, "body": "Hmm well in that case I&#39;m not sure - I tried it and it didn&#39;t work but let me make sure I&#39;ve got <code>.Text</code> - I wonder if OP is using the <code>.Text</code> property also"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530683350, "post_id": 51165907, "comment_id": 89316190, "body": "Put 100 in any cell and format that cell as a currency with the &#165; symbol. Select that cell then put <code>cbool(InStr(1, activecell.Text, Chr(165)))</code> in the VBE&#39;s Immediate window and hit enter."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1530683421, "post_id": 51165907, "comment_id": 89316221, "body": "I tested against .Text, .Value, .NumberFormat and you&#39;re correct I get hit, mis, hit"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1530683735, "post_id": 51165907, "comment_id": 89316342, "body": "Thanks @jamheadart. Good to know I&#39;m not any crazier than usual."}, {"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "edited": false, "score": 0, "creation_date": 1530686414, "post_id": 51165907, "comment_id": 89317621, "body": "@Jeeped AscW(Mid(strText, 1, 1)) =165, but InStr(1, strText, Chr(165)) still return 0"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530686582, "post_id": 51165907, "comment_id": 89317698, "body": "This may be the same thing but try `InStr(1, strText, ChrW(165))&#39;,"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530686781, "post_id": 51165907, "comment_id": 89317798, "body": "Your regional system must be treating the symbol as a 2 byte unicode character."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1530726245, "post_id": 51165907, "comment_id": 89340105, "body": "Unless there is some very special reason to use the user&#39;s default character encoding, use Unicode&#39;s UTF-16 encoding (<code>ChrW</code> and <code>AscW</code>). VBA/VB4/VB5/VB6/VB.NET use UTF-16 for strings and must convert the Chr and Asc to/from UTF-16. [BTW\u2014the user&#39;s default character encoding is almost certainly not ASCII.] Normally you don&#39;t want programs to behave differently based on user settings, espcially very old ones that they might not understand or even know about."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1530726774, "post_id": 51165907, "comment_id": 89340264, "body": "&quot;&#165;&quot; is the <a href=\"http://www.fileformat.info/info/unicode/char/00A5/index.htm\" rel=\"nofollow noreferrer\">Unicode codepoint U+00A5</a>. In UTF-16, codepoints &lt;U+10000 take one code unit and its numeric value is equal to the codepont&#39;s numeric value; So <code>ChrW(&amp;H00A5)</code>. Same as 195 but it&#39;s easier to recognize and reference in hexadecimal."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 5, "last_activity_date": 1530686812, "last_edit_date": 1530686812, "creation_date": 1530679523, "answer_id": 51165907, "question_id": 51165814, "link": "https://stackoverflow.com/questions/51165814/how-can-check-exist-in-a-string-vba/51165907#51165907", "title": "How can check exist &quot;\\&quot; in a string vba?", "body": "<p>The <strong>\u00a5</strong> is ASCII 165 dec. Try,</p>\n\n<pre><code>strText = oSheet.Cells(1, 1).Text\nIf cbool(InStr(1, strText, ChrW(165))) Then\n    bPrice = True       \nEnd If\n</code></pre>\n\n<p>Here's a test to make sure you are getting the right ASCII dec code. With the cell formatted as you like, select it and run this short sub.</p>\n\n<pre><code>sub find165()\n    dim str as string, i as long\n    str = activecell.text\n    for i = 1 to len(str)\n        debug.print ascw(mid(str, i, 1))\n    next i\nend sub\n</code></pre>\n\n<p>Look at the VBE's Immediate window for the ASCII dec code of each character displayed in the cell.</p>\n"}], "owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 51165907, "answer_count": 1, "score": 1, "last_activity_date": 1530686812, "creation_date": 1530678858, "last_edit_date": 1531164843, "question_id": 51165814, "link": "https://stackoverflow.com/questions/51165814/how-can-check-exist-in-a-string-vba", "title": "How can check exist &quot;\\&quot; in a string vba?", "body": "<p>This is my code , but it not working:\n<a href=\"https://i.stack.imgur.com/mNXiH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mNXiH.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>strText = oSheet.Cells(1, 1).Text\nIf InStr(strText, \"\\\") &gt; 0 Then\n    bPrice = True       \nEnd If\n</code></pre>\n\n<p>How can check exist \"\\\" in a string?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530678107, "post_id": 51165573, "comment_id": 89314568, "body": "At what point do you set the FullReport object type var to the ListObject table?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530678696, "post_id": 51165573, "comment_id": 89314699, "body": "Is the worksheet protected?"}, {"owner": {"reputation": 57, "user_id": 6755800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd6b931ca278b78028d95dd1fd4c8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Midori", "link": "https://stackoverflow.com/users/6755800/akira-midori"}, "edited": false, "score": 0, "creation_date": 1530678697, "post_id": 51165573, "comment_id": 89314701, "body": "@Jeeped When I called in the PubVarSet method"}, {"owner": {"reputation": 57, "user_id": 6755800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd6b931ca278b78028d95dd1fd4c8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Midori", "link": "https://stackoverflow.com/users/6755800/akira-midori"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530678740, "post_id": 51165573, "comment_id": 89314713, "body": "@TinMan No protections as of now whatsoever"}], "owner": {"reputation": 57, "user_id": 6755800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd6b931ca278b78028d95dd1fd4c8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Midori", "link": "https://stackoverflow.com/users/6755800/akira-midori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530679558, "creation_date": 1530676985, "last_edit_date": 1531164843, "question_id": 51165573, "link": "https://stackoverflow.com/questions/51165573/vba-listobjects-databodyrange-clearcontents-does-not-work-in-2010", "title": "VBA: ListObjects.DataBodyRange.ClearContents does not work in 2010", "body": "<p>I made an excel file and filled it with macros. I developed it in 2016 but the user who will be using it works with excel 2010. (Yes I know how dumb of me)</p>\n\n<p>Anyways, here's the code</p>\n\n<pre><code>Sub Clear()\n    Application.ScreenUpdating = False\n    PubVarSet                                         'This just calls a method that sets all public objects. i.e. listobjects and worksheets\n    FullReport.AutoFilter.ShowAllData\n    FullReport.DataBodyRange.ClearContents\n    Dim asd As Integer\n    If FullReport.ListRows.Count &gt; 1 Then\n        FullReport.DataBodyRange.Offset(1, 0).Resize(FullReport.DataBodyRange.Rows.Count - 1, _\n                                                     FullReport.DataBodyRange.Columns.Count).Rows.Delete\n    End If\n    Cells(6, FullReport.ListColumns.Count).Interior.Color = RGB(255, 255, 255)\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The entire macros work in 2016 but when im using using 2010, it gives me an error of </p>\n\n<blockquote>\n  <p>Run-time Error '1004':\n  ClearContents method of Range class failed.</p>\n</blockquote>\n\n<p>Any possible workarounds? TIA</p>\n\n<p>edit: If youre wondering, the table has records inside</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530676874, "post_id": 51165526, "comment_id": 89314265, "body": "<code>Range.Copy</code> will automatically size the <code>Destination</code> range to fit."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530676977, "post_id": 51165526, "comment_id": 89314282, "body": "Both samples look correct.  What is the problem?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530677015, "post_id": 51165526, "comment_id": 89314294, "body": "It would be better to show the complete subroutine."}, {"owner": {"reputation": 35, "user_id": 4963501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152937904333297/picture?type=large", "display_name": "Eduardo Hinterholz", "link": "https://stackoverflow.com/users/4963501/eduardo-hinterholz"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530677052, "post_id": 51165526, "comment_id": 89314306, "body": "thx for replying. i guess the problem is I&#39;m calling <code>Cells</code> in destination...isn&#39;t it, TinMan? What would your line look like?"}, {"owner": {"reputation": 35, "user_id": 4963501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152937904333297/picture?type=large", "display_name": "Eduardo Hinterholz", "link": "https://stackoverflow.com/users/4963501/eduardo-hinterholz"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530677112, "post_id": 51165526, "comment_id": 89314321, "body": "the sub is quite large, given that there&#39;s a bunch of ifs and fors"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530677508, "post_id": 51165526, "comment_id": 89314419, "body": "<code>rs.Cells(N, 1).End(xlUp).Offset(1, 0)</code> is a range that refers to the first empty cell in the first column on the worksheet <code>rs</code>.  The code above will expand that range to fit <code>db.Range(db.Cells(i, 1), db.Cells(i, M))</code>.  Unless your <code>Cells</code> parameters are incorrect, the code should function properly."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1530679670, "post_id": 51165526, "comment_id": 89314955, "body": "I guess for next empty row, the destination should be <code>Destination:=rs.Cells(rows.Count, 1).End(xlUp).Offset(1, 0)</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1530690105, "creation_date": 1530690105, "answer_id": 51168331, "question_id": 51165526, "link": "https://stackoverflow.com/questions/51165526/vba-copy-range-to-cell-in-new-worksheet/51168331#51168331", "title": "vba copy range to cell in new worksheet", "body": "<p>I think you are mixing ranges with cells, I'd try something like:</p>\n\n<pre><code>rsLastRow = rs.UsedRange.Rows.Count\n\ndb.Range(Cells(i, 1), Cells(i, M)).Copy\nrs.Range(\"A\" &amp; rsLastRow).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4963501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152937904333297/picture?type=large", "display_name": "Eduardo Hinterholz", "link": "https://stackoverflow.com/users/4963501/eduardo-hinterholz"}, "edited": false, "score": 0, "creation_date": 1530728247, "post_id": 51169531, "comment_id": 89340735, "body": "really helped a lot! I had to make some adjustments to my specific case, but you nailed it!"}], "tags": [], "owner": {"reputation": 137, "user_id": 3966789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qbBtF.jpg?s=128&g=1", "display_name": "Nagarajan Sathish", "link": "https://stackoverflow.com/users/3966789/nagarajan-sathish"}, "is_accepted": true, "score": 0, "last_activity_date": 1530694196, "creation_date": 1530694196, "answer_id": 51169531, "question_id": 51165526, "link": "https://stackoverflow.com/questions/51165526/vba-copy-range-to-cell-in-new-worksheet/51169531#51169531", "title": "vba copy range to cell in new worksheet", "body": "<p>Avoid Copy &amp; Paste to reduce memory usage and improve the VBA performance</p>\n\n<pre><code>Set rng1 = db.Cells(Rows.Count, \"A\").End(xlUp)\nSet rn2 = db.UsedRange\ncol = rn2.Columns.Count\n\nFor Each cel In db.Range(\"A2:A\" &amp; rng1.Row)\n   if (condition) then\n      Set rng2 = rs.Cells(Rows.Count, \"A\").End(xlUp)\n      rs.Range(Cells(rng2.row, 1), Cells(rng2.row, col)).Value = db.Range(cells(cel.row,1),Cells(cel.row,col)).Value\n   end if\nNext\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4963501, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152937904333297/picture?type=large", "display_name": "Eduardo Hinterholz", "link": "https://stackoverflow.com/users/4963501/eduardo-hinterholz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 51169531, "answer_count": 2, "score": 1, "last_activity_date": 1530694196, "creation_date": 1530676541, "question_id": 51165526, "link": "https://stackoverflow.com/questions/51165526/vba-copy-range-to-cell-in-new-worksheet", "title": "vba copy range to cell in new worksheet", "body": "<p>I have two sheets I am working with, within the same workbook. For each one I defined the variables <code>db</code> and <code>rs</code>.<br>\nThe goal here is to copy a certain row (given it matches my conditions) from <code>db</code> to the <strong>next empty row</strong> on <code>rs</code>.  </p>\n\n<p>I've tried:<br>\n<code>db.Range(db.Cells(i, 1), db.Cells(i, M)).Copy _\n     Destination:=rs.Cells(N, 1).End(xlUp).Offset(1, 0)</code><br>\nand<br>\n<code>Set resrow = db.Range(db.Cells(i, 1), db.Cells(i, M))\n 'next line is completely wrong inside the Range bracket\n   rs.Range(rs.Cells(N, 1).End(xlUp).Offset(1, 0)).Resize(1, M).Value = resrow.Value</code></p>\n\n<p>Note that <code>i</code> and <code>M</code> are <code>integers</code>.<br>\nI appears to me that I am trying to set a range value to a cell. How can I best fix it?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530677542, "post_id": 51165477, "comment_id": 89314425, "body": "Do you know if the date in A1 (1/7/2018) was originally 01-Jul-2018 or 07-Jan-2018 before it was imported? You haven&#39;t mentioned where these dates came from. If they were imported properly (by specifying DMY or MDY whichever the original was) then it doesn&#39;t matter what date system your computer is on nor what date format you have the cells set to."}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530679579, "post_id": 51165477, "comment_id": 89314927, "body": "Hi @Jeeped! Just a side note, your solution to the original popular convert text to date is brilliant! It doesn&#39;t solve my problem though. The date is just strings of text imported from data entry, a single piece of a much larger problem. It&#39;s ddmmyyyy. And I&#39;m looking to change them all to mmddyyyy"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530679812, "post_id": 51165477, "comment_id": 89315008, "body": "OK, so the whole column is left-aligned, that&#39;s the default for text. If any got accidentally converted then some would be right aligned. But these are all left-aligned, correct? And when you narrow the column so the whole string doesn&#39;t fit, they either look truncated or spill over into the next column, right? None look like #######."}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530679988, "post_id": 51165477, "comment_id": 89315066, "body": "Hi @Jeeped, it&#39;s a combination of both. Some, converted after the code, are right-aligned, while some are left-aligned... The converted ones become ###### while the unconverted ones spills to the other cells"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530680070, "post_id": 51165477, "comment_id": 89315082, "body": "the converted ones are 7/1/2018 7/2/2018 19/5/2018 12/2/2018 31/12/2018 17/6/2018 3/12/2018 17/6/2018 3/12/2018"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530680088, "post_id": 51165477, "comment_id": 89315088, "body": "How was the data &#39;imported&#39;?"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530680164, "post_id": 51165477, "comment_id": 89315109, "body": "it came from my boss, compiled by the salesperson who uses the ddmmyyyy format."}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530680379, "post_id": 51165707, "comment_id": 89315188, "body": "Hi @Eureka, that is the popular solution proposed by Jeeped, With ActiveSheet.UsedRange.Columns(&quot;A&quot;).Cells &#39;    .TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, FieldInfo:=Array(0, xlYMDFormat) &#39;    .NumberFormat = &quot;mm-dd-yyyy&quot;   &#39;change to any date-based number format you prefer the cells to display   Which i have mentioned also gave the same result"}, {"owner": {"reputation": 1983, "user_id": 7549483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986a0b7cfec95b191249f7c907a249e4?s=128&d=identicon&r=PG&f=1", "display_name": "Eureka", "link": "https://stackoverflow.com/users/7549483/eureka"}, "reply_to_user": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 1, "creation_date": 1530775111, "post_id": 51165707, "comment_id": 89352668, "body": "Try the snippet above. Would be neat."}], "tags": [], "owner": {"reputation": 1983, "user_id": 7549483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986a0b7cfec95b191249f7c907a249e4?s=128&d=identicon&r=PG&f=1", "display_name": "Eureka", "link": "https://stackoverflow.com/users/7549483/eureka"}, "is_accepted": true, "score": 1, "last_activity_date": 1539582943, "last_edit_date": 1592644375, "creation_date": 1530678077, "answer_id": 51165707, "question_id": 51165477, "link": "https://stackoverflow.com/questions/51165477/if-then-statement-with-date-in-vba/51165707#51165707", "title": "If then statement with date in VBA", "body": "<h3>Avoid number-only date formats</h3>\n<p>I have often fallen into the trap of thinking I understand that dates are dd/mm or mm/dd, but I have in fact misunderstood and it is doing something odd like using different conventions on different rows.</p>\n<p>I now never use number-only date formats, if I can avoid it. Not only in Excel but elsewhere. Unless it is ordered as yyyy mm dd, which is unlikely to be misentered, misdisplayed or misunderstood.</p>\n<h3>Column A begins as text entered in the spreadsheet, not as a number or date</h3>\n<p>So where you have written 1-7-2018 and are happily assuming this to be 1 July, it is just text. Excel interprets in its default way (for someone in North America) as 7 Jan. Only when the mm-dd interpretation doesn't work, does Excel try to interpret it as dd-mm. Unfortunately, Excel does this silently.</p>\n<p>To avoid this trap, use your second approach, but apply it to the <em>original</em> text formatted dates and explicitly tell Excel to interpret them (all) as dd/mm/yyyy.</p>\n<p>First tell Excel to <em>read</em> the input text as though it is in dd/mm/yyyy format. Do this with the xlDMYFormat option. Note xl <em>DMY</em> Format, not <em>YMD</em>.</p>\n<p>More details here <a href=\"https://msdn.microsoft.com/en-us/library/office/aa215749(v=office.11).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa215749(v=office.11).aspx</a></p>\n<p>Then tell Excel how to format the <em>display</em> of the resulting date, i.e. mm-dd-yyyy, using the &quot;.NumberFormat&quot; option.</p>\n<h3>An example to try</h3>\n<pre><code>With ActiveSheet.UsedRange.Columns(&quot;A&quot;).Cells\n.TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, FieldInfo:=Array(0, xlDMYFormat)\n.NumberFormat = &quot;mm-dd-yyyy&quot;  \n</code></pre>\n<p>This short and easy to follow. Note that:</p>\n<p><strong>FieldInfo</strong> tells Excel how to <em>interpret</em> the text string into a date in internal format.</p>\n<p><strong>NumberFormat</strong> tells Excel how to <em>display</em> the date, i.e. convert internal format date into a text string.</p>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530679858, "post_id": 51165769, "comment_id": 89315020, "body": "Hi, tried it with the dataset, it gives the same messy output."}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530680558, "post_id": 51165769, "comment_id": 89315248, "body": "Hi, nope it&#39;s not working, it&#39;s still giving the same result"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530680668, "post_id": 51165769, "comment_id": 89315278, "body": "@MT32 What is the current date time setting of your system?"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530680712, "post_id": 51165769, "comment_id": 89315292, "body": "My current system is mmddyyyy. The original dataset is taken from a guy who uses input the data in ddmmyyyy"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1530680297, "last_edit_date": 1530680297, "creation_date": 1530678481, "answer_id": 51165769, "question_id": 51165477, "link": "https://stackoverflow.com/questions/51165477/if-then-statement-with-date-in-vba/51165769#51165769", "title": "If then statement with date in VBA", "body": "<p>You can change the date to ddmmyyyy using format function.</p>\n\n<p>See below code</p>\n\n<pre><code>Sub convert()\n\nDim i As Long\n\n\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n For i = 1 To finalrow\n\nCells(i, 2).Value = Format(CDate(Cells(i, 1)), \"d/m/yyyy\")\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, try this</p>\n\n<pre><code>Sub convert()\n\nDim i As Long\nDim d As Long\nDim m As Long\nDim y As Long\n\n\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n For i = 1 To finalrow\n\nd = Day(CDate(Cells(i, 1)))\nm = Month(CDate(Cells(i, 1)))\ny = Year(CDate(Cells(i, 1)))\n\nCells(i, 2) = d &amp; \"/\" &amp; m &amp; \"/\" &amp; y\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 10031182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-biaYI6Hczy4/AAAAAAAAAAI/AAAAAAAAABY/1nC1mbR2mrU/photo.jpg?sz=128", "display_name": "Mick Fuller", "link": "https://stackoverflow.com/users/10031182/mick-fuller"}, "is_accepted": false, "score": 0, "last_activity_date": 1530698307, "creation_date": 1530698307, "answer_id": 51170904, "question_id": 51165477, "link": "https://stackoverflow.com/questions/51165477/if-then-statement-with-date-in-vba/51170904#51170904", "title": "If then statement with date in VBA", "body": "<p>You could try the following</p>\n\n<pre><code>sub convert()\n\nDim i as Long\nDim d as Integer\nDim m as Integer\nDim y as Integer\nDim holder as String\nDim output as Date\n\nfinalrow = cells(Rows.Count,1).End(xlUp).Row\n\nFor i = 1 to finalrow\n\n     holder = cells(i,1).value\n     d = Left(holder,2)\n     m = Mid(holder,4,2)\n     y = Right(holder,4)\n\n     output = DateSerial(y,m,d)\n\n     cells(i,2).value=output\n     cells(i,2).NumberFormat=\"mm/dd/yyyy\"\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530760555, "post_id": 51171346, "comment_id": 89347865, "body": "Hi, I must say this is a VERY long code for a simple question, but it worked like a charm! This is the one code that really solve the problem, and it should go viral."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1530782507, "post_id": 51171346, "comment_id": 89356979, "body": "@MT32 Your problem is a subset of what the code was designed for. So once you understand what it is doing, you could shorten it to eliminate the non-applicable portions.  But it probably doesn&#39;t cause any harm to have that in there."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1530703756, "last_edit_date": 1530703756, "creation_date": 1530699639, "answer_id": 51171346, "question_id": 51165477, "link": "https://stackoverflow.com/questions/51165477/if-then-statement-with-date-in-vba/51171346#51171346", "title": "If then statement with date in VBA", "body": "<p>There is no foolproof method of detecting which format the dates are in.  The macro below depends on there being at least one date in text format.  That will happen if and only if the format of the dates being input differ from the window regional short date setting of the computer, and the \"Month\" portion is > 12, and also if there are some dates which have been converted (albeit incorrectly) to real dates, and other dates which are text strings.</p>\n\n<p>If your original data source is really <strong>all text</strong> in DMY format, then all you need to do is select the <code>Text-to-Columns</code> wizard, and, at the appropriate step, select <code>DMY</code> for the column format.</p>\n\n<p>If the original data is <strong>mixed text and \"real dates\"</strong>, you might find the below macro helpful.  It was written to try to handle that issue, which is what you are running into.</p>\n\n<p>The foolproof solution is to ensure that your DMY sales person inputs dates correctly. Exactly how to do that depends on how he is inputting dates now.</p>\n\n<p>For this macro, the results will be in the numberformat determined by the Windows Regional Short Date settings.  But you can change it as required.</p>\n\n<pre><code>Option Explicit\nSub ConvertDates()\n    'converts dates that have been mismatched MDY / DMY\n    'Assumes dates are all in selected column\n    '   Only need to select a single cell in the column\n    '   will place results in a column next to original data\n    ' If adjacent column is not blank, a column will be inserted\n    'Figures out the original format by analyzing a \"text\" date\n    'Time components are converted directly.  This might be OK unless\n    ' in a non standard format such as 1400Z\n\nDim R As Range, C As Range\nDim sDelim As String\nDim FileDateFormat As String * 3\nDim I As Long, J As Long, V As Variant\nDim vDateParts As Variant\nDim YR As Long, MN As Long, DY As Long\nDim TM As Double\nDim vRes As Variant 'to hold the results of conversion\n\nSet R = Selection\n\n'Test that selected cell contains a date\nIf Not IsDate(R(1)) Then\n    MsgBox \"Select a cell containing a date\"\n    Exit Sub\nEnd If\n\nSet R = Intersect(R.EntireColumn, ActiveSheet.UsedRange)\nReDim vRes(1 To R.Rows.Count, 1 To 1)\n\n'Find a \"text date\" cell to analyze\nFor Each C In R\n    With C\n    If IsDate(.Value) And Not IsNumeric(.Value2) Then\n        'find delimiter\n        For I = 1 To Len(.Text)\n            If Not Mid(.Text, I, 1) Like \"#\" Then\n                sDelim = Mid(.Text, I, 1)\n                Exit For\n            End If\n        Next I\n\n        'split off any times\n        V = Split(.Text &amp; \" 00:00\")\n        vDateParts = Split(V(0), sDelim)\n\n        If vDateParts(0) &gt; 12 Then\n            FileDateFormat = \"DMY\"\n            Exit For\n        ElseIf vDateParts(1) &gt; 12 Then\n            FileDateFormat = \"MDY\"\n            Exit For\n        Else\n            MsgBox \"cannot analyze data\"\n            Exit Sub\n        End If\n    End If\n    End With\nNext C\n\nIf sDelim = \"\" Then\n   MsgBox \"cannot find problem\"\n   Exit Sub\nEnd If\n\n'Check that analyzed date format different from Windows Regional Settings\nSelect Case Application.International(xlDateOrder)\n    Case 0 'MDY\n        If FileDateFormat = \"MDY\" Then\n            MsgBox \"File Date Format and Windows Regional Settings match\" &amp; vbLf _\n                &amp; \"Look for problem elsewhere\"\n            Exit Sub\n        End If\n    Case 1 'DMY\n        If FileDateFormat = \"DMY\" Then\n            MsgBox \"File Date Format and Windows Regional Settings match\" &amp; vbLf _\n                &amp; \"Look for problem elsewhere\"\n            Exit Sub\n        End If\nEnd Select\n\n'Process dates\n'Could shorten this segment but probably more understandable this way\nJ = 0\nSelect Case FileDateFormat\n    Case \"DMY\"\n        For Each C In R\n        With C\n            If IsDate(.Value) And IsNumeric(.Value2) Then\n            'Reverse the day and the month\n                YR = Year(.Value2)\n                MN = Day(.Value2)\n                DY = Month(.Value2)\n                TM = .Value2 - Int(.Value2)\n            ElseIf IsDate(.Value) And Not IsNumeric(.Value2) Then\n                V = Split(.Text &amp; \" 00:00\") 'remove the time\n                vDateParts = Split(V(0), sDelim)\n                YR = vDateParts(2)\n                MN = vDateParts(1)\n                DY = vDateParts(0)\n                TM = TimeValue(V(1))\n            Else\n                YR = 0\n            End If\n\n            J = J + 1\n            If YR = 0 Then\n                vRes(J, 1) = C.Value\n            Else\n                vRes(J, 1) = DateSerial(YR, MN, DY) + TM\n            End If\n        End With\n        Next C\n    Case \"MDY\"\n        For Each C In R\n        With C\n            If IsDate(.Value) And IsNumeric(.Value2) Then\n            'Reverse the day and the month\n                YR = Year(.Value2)\n                MN = Day(.Value2)\n                DY = Month(.Value2)\n                TM = .Value2 - Int(.Value2)\n            ElseIf IsDate(.Value) And Not IsNumeric(.Value2) Then\n                V = Split(.Text &amp; \" 00:00\") 'remove the time\n                vDateParts = Split(V(0), sDelim)\n                YR = vDateParts(2)\n                MN = vDateParts(0)\n                DY = vDateParts(1)\n                TM = TimeValue(V(1))\n            Else\n                YR = 0\n            End If\n\n            J = J + 1\n            If YR = 0 Then\n                vRes(J, 1) = C.Value\n            Else\n                vRes(J, 1) = DateSerial(YR, MN, DY) + TM\n            End If\n        End With\n        Next C\nEnd Select\n\nWith R.Offset(0, 1).EntireColumn\n    Set C = .Find(what:=\"*\", LookIn:=xlFormulas)\n    If Not C Is Nothing Then .EntireColumn.Insert\nEnd With\n\nR.Offset(0, 1).Value = vRes\n\nEnd Sub\n</code></pre>\n\n<p><strong>Results in MDY format</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/XGetu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XGetu.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4647, "favorite_count": 0, "accepted_answer_id": 51165707, "answer_count": 4, "score": 1, "last_activity_date": 1539582943, "creation_date": 1530676151, "question_id": 51165477, "link": "https://stackoverflow.com/questions/51165477/if-then-statement-with-date-in-vba", "title": "If then statement with date in VBA", "body": "<p>I asked a question this morning regarding changing the date format in VBA, and I've found a partial solution from other discussions:</p>\n\n<p>So I have the following dates (in ddmmyyyy format) in Excel</p>\n\n<pre><code>   A\n1/7/2018\n2/7/2018\n19/5/2018\n2/12/2018\n31/12/2018\n17/6/2018\n12/3/2018\n17/6/2018\n12/3/2018\n</code></pre>\n\n<p>I use the following code in VBA to change them to date:</p>\n\n<pre><code>Sub convert()\n\nDim i As Long\n\n\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n For i = 1 To finalrow\n\nCells(i, 2).Value = CDate(Cells(i, 1))\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>and obtained the following:</p>\n\n<pre><code>  A           B\n1/7/2018    1/7/2018\n2/7/2018    2/7/2018\n5/19/2018   19/5/2018\n2/12/2018   2/12/2018\n12/31/2018  31/12/2018\n6/17/2018   17/6/2018\n12/3/2018   12/3/2018\n6/17/2018   17/6/2018\n12/3/2018   12/3/2018\n</code></pre>\n\n<p>So my problem now is the original ddmmyyyy now becomes a messy combination of mmddyyyy and ddmmyyyy.</p>\n\n<p>I know the cdate have effectively changed the entire date format to mmddyyyy, but it confuses the date and month for some of the entries.</p>\n\n<p>NOTE: I also tried the popular jeeped's solution but it gives the same messy result.</p>\n\n<p>So now I'm thinking of a solution to use the if-then statement.</p>\n\n<p>If the DAY in the B column (contain mmddyyyy date) exceeds 12, then change the format to ddmmyyyy.</p>\n\n<p>I guess it's something like</p>\n\n<pre><code>With ActiveSheet.UsedRange.Columns(\"A\").Cells\n.TextToColumns Destination:=.Cells(2), DataType:=xlFixedWidth, FieldInfo:=Array(0, xlYMDFormat)\n.NumberFormat = \"mm/dd/yyyy\"   'change to any date-based number format you prefer the cells to display\nEnd With\n\nif (**the dd in mmddyyyy exceeds 12**) then \nnumberformat = \"ddmmyyyy\"\n\nend sub\n</code></pre>\n\n<p>So how do I set about doing that?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 6863844, "user_type": "registered", "profile_image": "https://graph.facebook.com/989745891147306/picture?type=large", "display_name": "Shyam Pandey", "link": "https://stackoverflow.com/users/6863844/shyam-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1530691885, "last_edit_date": 1530691885, "creation_date": 1530684302, "answer_id": 51166773, "question_id": 51165442, "link": "https://stackoverflow.com/questions/51165442/add-data-to-the-next-free-row-at-bottom-of-column-list/51166773#51166773", "title": "Add data to the next free row at bottom of column list", "body": "<p>Hi you can use this kind of code.</p>\n\n<p>because as my personal view that \"=\" is not work to copy data.</p>\n\n<pre><code>Sub btnS()\nDim b As Object\nDim r As Long, c As Long\nDim dest As Range, origin As Range\nDim i As Long\nDim lastrow As Long\n\nThisWorkbook.Sheets(\"Sheet1\").Range(\"a1:a5\").Copy\nr = Cells(Rows.Count, \"a\").End(xlUp).Row + 1\n\nThisWorkbook.Sheets(\"Sheet2\").Range(\"a\" &amp; Cells(Rows.Count, \"a\").End(xlUp).Row + 1).PasteSpecial xlPasteAll\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 3966789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qbBtF.jpg?s=128&g=1", "display_name": "Nagarajan Sathish", "link": "https://stackoverflow.com/users/3966789/nagarajan-sathish"}, "is_accepted": false, "score": 0, "last_activity_date": 1530695372, "creation_date": 1530695372, "answer_id": 51169930, "question_id": 51165442, "link": "https://stackoverflow.com/questions/51165442/add-data-to-the-next-free-row-at-bottom-of-column-list/51169930#51169930", "title": "Add data to the next free row at bottom of column list", "body": "<p>Avoid Copy &amp; Paste to reduce memory usage and improve the VBA performance</p>\n\n<pre><code> Set b = .Buttons(Application.Caller)          'references button\n With b.TopLeftCell                            'returns row and col of button pushed\n    r = .row\n    c = .Column\n End With\n\n Set rng2 = Sheets(\"Skill Summary\").Cells(Rows.Count, \"A\").End(xlUp)\n\n Sheets(\"Skill Summary\").Range(\"A\" &amp; rng2.Row + 1 &amp; \":A\" &amp; rng2.Row + 5).Value = Sheets(\"Form\").Range(Cells(r, c), Cells(r, c+5)).Value\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9959257, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozo2Od47c0I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3hSgfTIW1H0fw376z17PhHeIFYzA/mo/photo.jpg?sz=128", "display_name": "T Wilken", "link": "https://stackoverflow.com/users/9959257/t-wilken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530697294, "creation_date": 1530675899, "last_edit_date": 1530697294, "question_id": 51165442, "link": "https://stackoverflow.com/questions/51165442/add-data-to-the-next-free-row-at-bottom-of-column-list", "title": "Add data to the next free row at bottom of column list", "body": "<p>pretty basic question but can't seem to get it working. I'm trying to get data from the \"origin\" cell to copy over to a cell called \"destination\" in the next <em>empty</em> row of a list on the second sheet \"Skill Summary\". Thanks in advance.    </p>\n\n<pre><code>Sub btnS()\n\nDim b As Object\nDim r As Long, c As Long\nDim dest As Range, origin As Range\nDim i As Long\nDim lastrow As Long\n\nWith Worksheets(\"Form\")\n    Set b = .Buttons(Application.Caller)          'references button\n    With b.TopLeftCell                            'returns row and col of button pushed\n        r = .row\n        c = .Column + 5\n    End With\n\n    Set origin = .Cells(r, c)\nEnd With\n</code></pre>\n\n<p>Here is the section that doesn't work </p>\n\n<pre><code>    With Worksheets(\"Skill Summary\")\n        lastrow = .Cells(.Rows.Count, \"B\").End(xlUp).row + 1\n        Set dest = .Cells(lastrow, 2)\n    End With\n\n    dest.Value = origin.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530675459, "post_id": 51165347, "comment_id": 89313984, "body": "If you are going to use VBA to modify a protected worksheet, unprotect it then protect it once with UserInterfaceOnly:=True (see <a href=\"https://stackoverflow.com/questions/49990911/losing-excel-clipboard-data-after-protecting-sheet/49991531#49991531\">this</a>). After that has been done once you will not have to unprotect to modify with VBA. If you have to unprotect it for another reason, reprotect it with with UserInterfaceOnly:=True."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530675925, "post_id": 51165347, "comment_id": 89314079, "body": "It seems like you have the same teacher as T Wilken <a href=\"https://stackoverflow.com/q/51164543/9912714\">Dynamic button - Runtime error 1004 - Unable to get the Buttons property of the Worksheet class</a>.  Your Timesheet password doesn&#39;t match.  Consider passing the target range as a parameter.  This can be a difficult error to get around.  Follow @Jeeped &#39;s advice."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530676425, "post_id": 51165347, "comment_id": 89314160, "body": "Watch: <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;t=3123s&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10029454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a179315a008c1ddf53d41fd69b7b16d9?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/10029454/richard"}, "edited": false, "score": 0, "creation_date": 1530697622, "post_id": 51165574, "comment_id": 89323910, "body": "Thanks very much, appreciate it!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1530676989, "creation_date": 1530676989, "answer_id": 51165574, "question_id": 51165347, "link": "https://stackoverflow.com/questions/51165347/excel-vba-random-runtime-errors/51165574#51165574", "title": "Excel VBA - random runtime errors", "body": "<p>If you are going to use VBA to repeatedly modify a protected worksheet, unprotect it then protect it once with UserInterfaceOnly:=True.</p>\n\n<pre><code>sub protectOnce()\n    worksheets(\"Timesheet\").unprotect password:=\"mypasswd\"\n    worksheets(\"sheet4\").unprotect password:=\"mypasswd\"\n    worksheets(\"Timesheet\").protect password:=\"mypasswd\", UserInterfaceOnly:=True\n    worksheets(\"sheet4\").protect password:=\"mypasswd\", UserInterfaceOnly:=True\nend sub\n</code></pre>\n\n<p>After that has been done once you will not have to unprotect to modify with VBA. If you have to unprotect it for another reason, reprotect it with with UserInterfaceOnly:=True.</p>\n\n<p>This cuts your NewSlot code down significantly. It is considered 'best practise' to avoid using Select and Activate, particularly across worksheets.</p>\n\n<pre><code>Sub NewSlot()\n\n    ' select row 8 in sheet4\n    workSheets(\"Sheet4\").Rows(\"8\").Copy\n\n    ' go back to timesheet\n    with workSheets(\"Timesheet\")\n        ' insert copied row\n        Dim r As Range\n        Set r = .Buttons(Application.Caller).TopLeftCell\n        .Cells(r.Row, \"A\").entirerow.Insert shift:=xlDown\n    end with\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10029454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a179315a008c1ddf53d41fd69b7b16d9?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/10029454/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530676989, "creation_date": 1530674964, "question_id": 51165347, "link": "https://stackoverflow.com/questions/51165347/excel-vba-random-runtime-errors", "title": "Excel VBA - random runtime errors", "body": "<p>I\u2019m very new to Excel VBA but managed to create three buttons in a staff timesheet.  All buttons work as needed, however, one particular button is causing random issues \u2013 about 90% of the time it works, but from time to time it will crash Excel or give an error such as runtime error '-2147417848 (800 10 108)': Automation error    The object invoked has disconnected from its clients.  Other times it\u2019s a similar message, saying Method \u2018Insert\u2019 of object \u2018Range\u2019 failed.\nIt\u2019s happening in different versions of Excel on different computers.  The task is not complex but I\u2019m stumbling with my VBA knowledge.<br>\nThe user clicks the button to set up each formatted row in the sheet called \u201cTimesheet\u201d, i.e. clicking the button in \u201cTimesheet\u201d copies a row from sheet4 (formatted and containing formulae) and inserts it into the \u201cTimesheet\u201d above the button.<br>\nI\u2019d be very grateful if someone could suggest alternative code that won\u2019t crash Excel - many thanks in advance!</p>\n\n<pre><code>Sub NewSlot()\n\n' NewSlot Macro used in Timesheet\n'\n    'turn protection off\n    Worksheets(\"Sheet4\").Unprotect Password:=\"mypasswd\"\n    Worksheets(\"Timesheet\").Unprotect Password:=\" mypasswd \"\n\n    ' select row 8 in sheet4\n    Sheets(\"Sheet4\").Select\n    Rows(\"8\").Select\n    Selection.Copy\n\n    ' go back to timesheet\n    Sheets(\"Timesheet\").Select\n\n    ' insert copied row\n    Dim r As Range\n    Set r = ActiveSheet.Buttons(Application.Caller).TopLeftCell\n    Range(Cells(r.Row, r.Column), Cells(r.Row, r.Column)).Offset(0, 0).Select\n\n    Selection.Insert shift:=xlDown\n    Application.CutCopyMode = False\n\n\n    'turn protection on\n    Worksheets(\"Sheet4\").Protect Password:=\" mypasswd \"\n    Worksheets(\"Timesheet\").Protect Password:=\" mypasswd\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10029633, "user_type": "registered", "profile_image": "https://graph.facebook.com/1018888241613784/picture?type=large", "display_name": "Carol Pearl", "link": "https://stackoverflow.com/users/10029633/carol-pearl"}, "edited": false, "score": 0, "creation_date": 1530836066, "post_id": 51173950, "comment_id": 89384271, "body": "Oh my god, thank you! I just didn&#39;t realise the difference between ars= , set ars= as well as the proper use of the address property(?)\u2026. I can&#39;t thank you enough for helping me.... this site is just amazing, I&#39;ve learned so much from it and people like you :)"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1530707988, "creation_date": 1530707988, "answer_id": 51173950, "question_id": 51165244, "link": "https://stackoverflow.com/questions/51165244/how-to-use-variables-in-an-r1c1-range-in-pivot-table-consolidation-excel-2010/51173950#51173950", "title": "How to use variables in an R1C1 range in pivot table consolidation, excel 2010?", "body": "<p>This line  </p>\n\n<pre><code>arS = Cells(RS, CS)   \n</code></pre>\n\n<p>sets the variant arS to whatever value or text is held in the cell. I think that you think it holds a pointer to the cell - but that would require the line</p>\n\n<pre><code>       Set arS = cells(rs,cs)\n</code></pre>\n\n<p>You would have eliminated this error if you had Option Explicit set and had declared arS as a range with</p>\n\n<pre><code>     Dim arS as Range\n</code></pre>\n\n<p>With the code you have you would use</p>\n\n<pre><code>  \"'Calculated Stock'!R32C1:R\" &amp; RS &amp; \"C\" &amp; CS\n</code></pre>\n\n<p>With arS set as a pointer you would use</p>\n\n<pre><code> \"'Calculated Stock'!R32C1:\" &amp; arS.address(true,true,xlR1C1)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10029633, "user_type": "registered", "profile_image": "https://graph.facebook.com/1018888241613784/picture?type=large", "display_name": "Carol Pearl", "link": "https://stackoverflow.com/users/10029633/carol-pearl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530707988, "creation_date": 1530673903, "last_edit_date": 1530699362, "question_id": 51165244, "link": "https://stackoverflow.com/questions/51165244/how-to-use-variables-in-an-r1c1-range-in-pivot-table-consolidation-excel-2010", "title": "How to use variables in an R1C1 range in pivot table consolidation, excel 2010?", "body": "<p>How can I get my new cells ref or Variables containing the row &amp; Column number recognised as an actual eg. R38C8 reference for use by the consolidate function? </p>\n\n<p>My two pivot tables rows and columns constantly change, I've got the new row and column number range - ready for a R1C1 ref but can't get the consolidate to work using a variable or cell reference in the formula - I'm new at this, just done a 3week crash course... Please help, it's driving me crazy!...</p>\n\n<p>Last part of my code, trying a cells ref (consolidate doesn't like \"&amp; arS\" or RarS:</p>\n\n<pre><code>RS = 32 + RowCountS\nCS = ColCountS\nRI = 63 + RowCountI\nCI = ColCountI\n\narS = Cells(RS, CS)  ' Stock table, last cell in the range \narI = Cells(RI, CI) 'Invoiced Table last cell in the range\n\n' Creates a new table by consolidating the negative invoiced amounts with the stock movements totals\n'\nSheets(\"Calculated Stock\").Range(\"A4\").Select\n\n Selection.Consolidate Sources:=Array( _\n    \"'Calculated Stock'!R32C1:R\" &amp; arS\"\" _\n    , _\n    \"'Calculated Stock'!R63C1:R\" &amp; arI\"\" _\n    ), Function:=xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False\n Range(\"A4\").Select\n</code></pre>\n"}, {"tags": ["excel", "abap", "vba"], "comments": [{"owner": {"reputation": 8295, "user_id": 911419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa0d95b3830549589afbbc79d886c466?s=128&d=identicon&r=PG", "display_name": "Suncatcher", "link": "https://stackoverflow.com/users/911419/suncatcher"}, "edited": false, "score": 0, "creation_date": 1530689571, "post_id": 51165023, "comment_id": 89319262, "body": "Give you code. What happens when you click? Are they disabled or what? Give screenshot"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1530703188, "post_id": 51165023, "comment_id": 89327452, "body": "When you protect a sheet in Excel there&#39;s a tickbox &quot;Allow Filtering&quot; in the protection dialog. If that&#39;s not ticked you can add the filters but can&#39;t use them. I suspect that&#39;s what&#39;s happening here"}, {"owner": {"reputation": 97, "user_id": 2209961, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2d45c30e33d5bc599b1d58cdc4d2362d?s=128&d=identicon&r=PG", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/2209961/abhishek"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1530762701, "post_id": 51165023, "comment_id": 89348243, "body": "@HarassedDad : exactly this is what I have to write in ABAP code, I have tried setting this property to true but it\u2019s not working. If possible please can you share code block how to lock sheet and allow filter using ABAP code."}, {"owner": {"reputation": 307, "user_id": 9395045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQgGi.jpg?s=128&g=1", "display_name": "VXLozano", "link": "https://stackoverflow.com/users/9395045/vxlozano"}, "edited": false, "score": 0, "creation_date": 1530783581, "post_id": 51165023, "comment_id": 89357668, "body": "I would advice you to NOT use OLE, because Microsoft tends to change everything every time it changes Office versions. Take a look at ABAP2EXCEL in github (or something like that... google for &quot;ZCL_EXCEL&quot;)"}, {"owner": {"reputation": 97, "user_id": 2209961, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2d45c30e33d5bc599b1d58cdc4d2362d?s=128&d=identicon&r=PG", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/2209961/abhishek"}, "reply_to_user": {"reputation": 8295, "user_id": 911419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa0d95b3830549589afbbc79d886c466?s=128&d=identicon&r=PG", "display_name": "Suncatcher", "link": "https://stackoverflow.com/users/911419/suncatcher"}, "edited": false, "score": 0, "creation_date": 1531167810, "post_id": 51165023, "comment_id": 89485905, "body": "@Suncatcher : Yes they are coming disabled. Below is code which I have :"}, {"owner": {"reputation": 97, "user_id": 2209961, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2d45c30e33d5bc599b1d58cdc4d2362d?s=128&d=identicon&r=PG", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/2209961/abhishek"}, "reply_to_user": {"reputation": 8295, "user_id": 911419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa0d95b3830549589afbbc79d886c466?s=128&d=identicon&r=PG", "display_name": "Suncatcher", "link": "https://stackoverflow.com/users/911419/suncatcher"}, "edited": false, "score": 0, "creation_date": 1531168509, "post_id": 51165023, "comment_id": 89486190, "body": "@Suncatcher : Yes they are coming disabled. Below is code which I have : &lt;pre&gt; CALL METHOD OF w_excel &#39;RANGE&#39; = w_range     EXPORTING     #1 = &#39;A1&#39;                                       &quot;  Column A1  TO D11   Range     #2 = &#39;F1&#39;.   CALL METHOD OF w_range &#39;AutoFilter&#39; = w_filtering.   PERFORM err_hdl USING &#39;AutoFilter&#39;.   &lt;/pre&gt; &lt;br/&gt; I dont know how to upload Image here but what I have figured out is I have to enable &quot;use AutoFilter&quot; checkbox under &quot;Review &gt;&gt; Protect Sheet &gt;&gt;&quot; then in Popup &quot;use AutoFilter&quot;.&lt;br/&gt; Please help me how can I set this checkbox using ABAP code.&lt;br/&gt;Thanks-"}, {"owner": {"reputation": 8295, "user_id": 911419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa0d95b3830549589afbbc79d886c466?s=128&d=identicon&r=PG", "display_name": "Suncatcher", "link": "https://stackoverflow.com/users/911419/suncatcher"}, "edited": false, "score": 0, "creation_date": 1531488298, "post_id": 51165023, "comment_id": 89627410, "body": "Insert your code <a href=\"https://stackoverflow.com/help/formatting\">as appropriate</a>, not as comment."}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 9616782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba35fc108fd02c413ae9fedac01c38b?s=128&d=identicon&r=PG&f=1", "display_name": "fixeln", "link": "https://stackoverflow.com/users/9616782/fixeln"}, "is_accepted": true, "score": 0, "last_activity_date": 1531493365, "last_edit_date": 1531493365, "creation_date": 1531493038, "answer_id": 51327710, "question_id": 51165023, "link": "https://stackoverflow.com/questions/51165023/how-to-enable-filters-on-protected-excel-file-in-ole2-abap/51327710#51327710", "title": "How to enable filters on protected excel file in OLE2 ABAP", "body": "<pre><code>DATA: go_application TYPE ole2_object,\n      go_column      TYPE ole2_object,\n\nCALL METHOD OF go_application 'Columns' = go_column.\nCALL METHOD OF go_column 'AutoFit'.\nSET PROPERTY OF go_column 'AutoFilter' = 1.\n CALL METHOD OF go_sheet 'Protect'\n      EXPORTING\n        #1  = 'pass' \" Password\n        #2  = 1 \" Protect Drawing Objects\n        #3  = 1 \" Protect Contents\n        #4  = 1 \" Protect Scenarios\n        #5  = 0\n        #6  = 0\n        #7  = 0\n        #8  = 0\n        #9  = 0\n        #10 = 0\n        #11 = 0\n        #12 = 0\n        #13 = 0\n        #14 = 0\n        #15 = 1.\n</code></pre>\n\n<p>Where #15 put filter ON. Give me feedback if it worked for you</p>\n"}], "owner": {"reputation": 97, "user_id": 2209961, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2d45c30e33d5bc599b1d58cdc4d2362d?s=128&d=identicon&r=PG", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/2209961/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 51327710, "answer_count": 1, "score": 1, "last_activity_date": 1531493365, "creation_date": 1530671555, "last_edit_date": 1531164843, "question_id": 51165023, "link": "https://stackoverflow.com/questions/51165023/how-to-enable-filters-on-protected-excel-file-in-ole2-abap", "title": "How to enable filters on protected excel file in OLE2 ABAP", "body": "<p>I am able to add filters using OLE2 in ABAP and my excel file getting created successfully. Issue is filter is not working, I can see filters attached on field columns but I can not click . Please help me.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530682330, "post_id": 51164790, "comment_id": 89315799, "body": "Can you give a more specific example?"}, {"owner": {"reputation": 13, "user_id": 4359388, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000048773304/picture?type=large", "display_name": "Eleazer Mojica", "link": "https://stackoverflow.com/users/4359388/eleazer-mojica"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530682917, "post_id": 51164790, "comment_id": 89316022, "body": "For example, I have an application (app.exe) there is a specific line in this app that will tell the user to press any key to continue in the console, when this happens I will send again a command in the console to continue the program."}, {"owner": {"reputation": 13, "user_id": 4359388, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000048773304/picture?type=large", "display_name": "Eleazer Mojica", "link": "https://stackoverflow.com/users/4359388/eleazer-mojica"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530683028, "post_id": 51164790, "comment_id": 89316064, "body": "Here is the problem, I tried to run the app.exe in MSExcel VBA application, but I was not able to detect or read the output of the console, and I cannot send another command because when I do the shell.run command it opens another console window."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530683703, "post_id": 51164790, "comment_id": 89316328, "body": "Hi, where is your current code? Please include that and <a href=\"https://stackoverflow.com/posts/51164790/edit\">edit</a> it and information about what you want to see happen, and what is actually happening into the question.  We need to be able to try and reproduce this problem. Hence the requirement for <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 13, "user_id": 4359388, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000048773304/picture?type=large", "display_name": "Eleazer Mojica", "link": "https://stackoverflow.com/users/4359388/eleazer-mojica"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530756940, "post_id": 51164790, "comment_id": 89347303, "body": "Hi QHarr, This is my code for this project. Thank you very much for helping me."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530682469, "creation_date": 1530682469, "answer_id": 51166393, "question_id": 51164790, "link": "https://stackoverflow.com/questions/51164790/read-and-write-to-console-using-vba/51166393#51166393", "title": "read and write to console using vba", "body": "<p>A more specific example would help.</p>\n\n<p>The following for example both reads and writes to the command line from VBE:</p>\n\n<pre><code>Dim myDir As String: myDir = \"C:\\Users\\User\\Desktop\\Testfolder\"\nDebug.Print CreateObject(\"wscript.shell\").exec(\"cmd /V /C cd \" &amp; myDir &amp; \" &amp;&amp; (for /f \"\"eol=: delims=\"\" %F in ('dir /b /od *.csv') do @set \"\"newest=%F\"\" ) &amp;&amp; echo !newest!\").StdOut.ReadAll\n</code></pre>\n\n<p>The above writes to the command line asking it to csv files in the specified folder and reads the file name of the file with the most recent modified date.</p>\n"}], "owner": {"reputation": 13, "user_id": 4359388, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000048773304/picture?type=large", "display_name": "Eleazer Mojica", "link": "https://stackoverflow.com/users/4359388/eleazer-mojica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1037, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530769733, "creation_date": 1530669149, "last_edit_date": 1530769733, "question_id": 51164790, "link": "https://stackoverflow.com/questions/51164790/read-and-write-to-console-using-vba", "title": "read and write to console using vba", "body": "<p>Is there a way to read and write to command prompt console using VBA? \nIm currently using Shell.Run command but the problem is it cannot read the output of the console while Shell.Exec read the output but wait for the program to finish. \nI want an interactive communication between a third party program and vba through the use of command prompt console.</p>\n\n<pre><code>Sub Main()\n    Dim vbtShell As New WshShell\n    Dim appPath As String\n    Dim errRet As Long\n    Dim strOut As String\n\n    'Set the directory of the application\n    appPath = \"C:\\Users\\MyPC\\Documents\"\n    vbtShell.CurrentDirectory = appPath\n\n    'Run the application\n    errRet = vbtShell.Run(\"app.exe &gt;C:\\Users\\MyPC\\Documents\\Log.txt\", 1, False)\n\n    'Try to read to console\n    ''When I try to read to Console there was no Output\n    strOut = GetFileContent(\"C:\\Users\\MyPC\\Documents\\Log.txt\")\n\n    'If reading to console is successful send another command to continue.\n    ''I cannot send another console command because it opens another command prompt window.\n    If strOut = \"Press Any Key To Continue:\" Then\n        errRet = vbtShell.Run(\"cmd.exe /k y\", 1, False)\n    End If\n    'Read Final Output of the Console Application\n    ''No final Ouput was read because we was not able to send a key to continue the program.\n    strOut = GetFileContent(\"C:\\Users\\MyPC\\Documents\\Log.txt\")\n    MsgBox (strOut)\nEnd Sub\nPublic Function GetFileContent(Name As String) As String\n    Dim intUnit As Integer\n\n    On Error GoTo ErrGetFileContent\n    intUnit = FreeFile\n    Open Name For Input As intUnit\n    GetFileContent = Input(LOF(intUnit), intUnit)\n\nErrGetFileContent:\n    Close intUnit\n    Exit Function\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1530693192, "creation_date": 1530693192, "answer_id": 51169219, "question_id": 51164543, "link": "https://stackoverflow.com/questions/51164543/dynamic-button-runtime-error-1004-unable-to-get-the-buttons-property-of-the/51169219#51169219", "title": "Dynamic button - Runtime error 1004 - Unable to get the Buttons property of the Worksheet class", "body": "<p>Add these lines: </p>\n\n<pre><code> Option Explicit      ' :)\n Dim origin As Range\n Dim dest As Range\n</code></pre>\n\n<p>Correct these lines: </p>\n\n<pre><code> c = .colUMN\n ...\n SET origin = Worksheets(\"Form\").Cells(r, c)\n SET dest = Worksheets(\"Form Output\").Cells(1, 1)\n</code></pre>\n\n<p>Some advice: you can use <code>.Cells(i, 4)</code> instead of <code>.Range(Cells(i, 4), Cells(i, 4)))</code></p>\n"}], "owner": {"reputation": 25, "user_id": 9959257, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozo2Od47c0I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3hSgfTIW1H0fw376z17PhHeIFYzA/mo/photo.jpg?sz=128", "display_name": "T Wilken", "link": "https://stackoverflow.com/users/9959257/t-wilken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1423, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530693192, "creation_date": 1530666119, "question_id": 51164543, "link": "https://stackoverflow.com/questions/51164543/dynamic-button-runtime-error-1004-unable-to-get-the-buttons-property-of-the", "title": "Dynamic button - Runtime error 1004 - Unable to get the Buttons property of the Worksheet class", "body": "<p>Hi I'm getting \"Runtime error 1004 - Unable to get the Buttons property of the Worksheet class\" and it's coming from line near the bottom <code>Set b = Worksheets(\"Form\").Buttons(Application.Caller) 'references button</code>. </p>\n\n<p>I'm basically trying to copy the data in the column next to a dynamic button that appears next to the fully expanded fields of a pivot table. I've got the buttons appearing fine, I just need them to copy the data in the adjacent cell to a list in another sheet when that particular button is clicked.</p>\n\n<pre><code>Sub buttonGenerator()\n\nDim btn As Button\nApplication.ScreenUpdating = False\nActiveSheet.Buttons.Delete\nDim t As Range\nDim size As Long\n\nsize = Worksheets(\"Form\").PivotTables(\"Pivottable1\").TableRange2.Rows.Count 'returns number of rows in expanding pivot table\n\nFor i = 2 To size Step 1 'cycles through from row 2 to last row of pivot table\n    If Not IsEmpty(Worksheets(\"Form\").Range(Cells(i, 4), Cells(i, 4))) Then 'only shows button if last col of pivot table has data\n      Set t = Worksheets(\"Form\").Range(Cells(i, 5), Cells(i, 5))\n      Set btn = Worksheets(\"Form\").Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n      With btn\n        .OnAction = \"btnS\" 'call btnS subroutine\n        .Caption = \"Button\" &amp; i 'button label\n        .Name = \"Button\" &amp; i 'button name\n        End With\n    End If\n\nNext i\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n\n\nPublic Sub btnS()\n\nDim b As Object\nDim r As Integer\nDim c As Integer\n\nSet b = Worksheets(\"Form\").Buttons(Application.Caller) 'references button\nWith b.TopLeftCell 'returns row and col of button pushed\nr = .row\nc = .col\nEnd With\n\norigin = Range(r, c)\ndest = Worksheets(\"Form Output\").Range(Cells(1, 1))\ndest.Value = origin.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10001403, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eqiGhDUgDGI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0FMxfwFicMegTGFZTU33ejZXc-lQ/mo/photo.jpg?sz=128", "display_name": "Nicolas Klebusits", "link": "https://stackoverflow.com/users/10001403/nicolas-klebusits"}, "edited": false, "score": 0, "creation_date": 1530667775, "post_id": 51164372, "comment_id": 89312591, "body": "This doesn&#39;t seem to be working. The message box doesn&#39;t pop up even when I get rid of the cancel command. I also get a compile error message when I just try and throw it in &quot;this document&quot;"}, {"owner": {"reputation": 2322, "user_id": 851272, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3314debd6f46b2807d84d1336a054da4?s=128&d=identicon&r=PG", "display_name": "David Colwell", "link": "https://stackoverflow.com/users/851272/david-colwell"}, "reply_to_user": {"reputation": 37, "user_id": 10001403, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eqiGhDUgDGI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0FMxfwFicMegTGFZTU33ejZXc-lQ/mo/photo.jpg?sz=128", "display_name": "Nicolas Klebusits", "link": "https://stackoverflow.com/users/10001403/nicolas-klebusits"}, "edited": false, "score": 0, "creation_date": 1530674928, "post_id": 51164372, "comment_id": 89313901, "body": "hey @NicolasKlebusits, I added a screengrab.  You will need to save the document (with the macro) then re-open it. The event registration only occurs during DocumentOpen event."}], "tags": [], "owner": {"reputation": 2322, "user_id": 851272, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3314debd6f46b2807d84d1336a054da4?s=128&d=identicon&r=PG", "display_name": "David Colwell", "link": "https://stackoverflow.com/users/851272/david-colwell"}, "is_accepted": true, "score": 0, "last_activity_date": 1530674839, "last_edit_date": 1530674839, "creation_date": 1530664202, "answer_id": 51164372, "question_id": 51164313, "link": "https://stackoverflow.com/questions/51164313/stop-save-capability-in-a-word-doc/51164372#51164372", "title": "Stop save capability in a word doc", "body": "<p>A decent answer on how to subscribe to events can be found in this question: <a href=\"https://stackoverflow.com/questions/24702493/how-to-run-a-macro-in-word-before-save\">How to run a macro in Word before save?</a></p>\n\n<pre><code>Private WithEvents App As Word.Application\n\nPrivate Sub Document_Open()\n    Set App = Word.Application\nEnd Sub\n\nPrivate Sub App_DocumentBeforeSave(ByVal Doc As Document, SaveAsUI As Boolean, Cancel As Boolean)\n    Cancel = True\n    MsgBox (\"Cancelled\")\nEnd Sub\n</code></pre>\n\n<p>This will run after you open the document</p>\n\n<p><a href=\"https://i.stack.imgur.com/GJjys.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GJjys.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 10001403, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eqiGhDUgDGI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0FMxfwFicMegTGFZTU33ejZXc-lQ/mo/photo.jpg?sz=128", "display_name": "Nicolas Klebusits", "link": "https://stackoverflow.com/users/10001403/nicolas-klebusits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 51164372, "answer_count": 1, "score": 0, "last_activity_date": 1530674839, "creation_date": 1530663540, "question_id": 51164313, "link": "https://stackoverflow.com/questions/51164313/stop-save-capability-in-a-word-doc", "title": "Stop save capability in a word doc", "body": "<p>I\u2019m wondering if there is a way to block the \u201csave as\u201d function (I.e. being able to change the name) of a word doc through VBA. The user should only be able to save as if they\u2019ve filled in certain mandatory fields. I\u2019m not sure if this is even possible as I have really found nothing on the topic.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1530669892, "post_id": 51164480, "comment_id": 89312982, "body": "Shoot. Looks like automatic line breaks are not a part of the document object model at all. The Selection machinery uses the UI rather than queries the document, so there really is no &quot;clean&quot; way. I really wish there was."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "reply_to_user": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 1, "creation_date": 1530670125, "post_id": 51164480, "comment_id": 89313025, "body": "It does not use the UI; it uses the text layout modules. By default, the UI is updated to reflect what you do with the <code>Selection</code>, but (a) you can move the selection outside the visible area (that&#39;s why you need <code>Selection.ScrollIntoView</code>) and (b) you can always say <code>Application.ScreenUpdating = False</code>."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": true, "score": 1, "last_activity_date": 1533441562, "last_edit_date": 1533441562, "creation_date": 1530665405, "answer_id": 51164480, "question_id": 51164283, "link": "https://stackoverflow.com/questions/51164283/check-if-a-range-fits-onto-a-single-line/51164480#51164480", "title": "Check if a Range fits onto a single line", "body": "<p>The only way is to <code>.Select</code> that text, them manipulate the selection. <code>Selection</code> in the only object for which you can use <code>wdLine</code> as a boundary. Nothing else in the Word object model works with automatic line breaks.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GetFirstLineOfRange(RangeToCheck As Range, FirstLineRange As Range)\n\n  'Otherwise, Word doesn't always insert automatic line breaks\n  'and all the text will programmatically look like it's on a single line\n  If Not Application.Visible Or Not Application.ScreenUpdating Then\n    Application.ScreenRefresh\n  End If\n\n  Dim SelectionRange As Range\n\n  Set SelectionRange = Selection.Range\n  Set FirstLineRange = RangeToCheck\n\n  FirstLineRange.Select\n  Selection.Collapse Direction:=wdCollapseStart\n  Selection.EndOf Unit:=wdLine, Extend:=wdExtend\n\n  Set FirstLineRange = Selection.Range\n  If FirstLineRange.End &gt; RangeToCheck.End Then\n    FirstLineRange.End = RangeToCheck.End\n  End If\n\n  SelectionRange.Select\n\nEnd Sub\n\nFunction IsRangeOnOneLine(RangeToCheck As Range) As Boolean\n\n  Dim FirstLineRange As Range\n\n  GetFirstLineOfRange RangeToCheck, FirstLineRange\n  IsRangeOnOneLine = FirstLineRange.End &gt;= RangeToCheck.End\n\nEnd Function\n</code></pre>\n\n<p>The subroutine <code>GetFirstLineOfRange</code> takes a <code>RangeToCheck</code> and sets <code>FirstLineRange</code> to the first text line in the given range.</p>\n\n<p>The function <code>IsRangeOnOneLine</code> takes a <code>RangeToCheck</code> and returns <code>True</code> if the range fits on one line of text, and <code>False</code> otherwise. The function works by getting the first text line in the given range and checking whether it contains the range or not.</p>\n\n<p>The manipulation of the <code>Selection</code> in <code>GetFirstLineOfRange</code> is necessary because the subroutine wants to move the end of the range to the end of the line, and the movement unit <code>wdLine</code> is available only with <code>Selection</code>. The subroutine saves and restores the current <code>Selection</code>; if this is not necessary then the temporary variable <code>SelectionRange</code> and the associated statements can be deleted.</p>\n\n<p>Note: </p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1542322189, "creation_date": 1542322189, "answer_id": 53328972, "question_id": 51164283, "link": "https://stackoverflow.com/questions/51164283/check-if-a-range-fits-onto-a-single-line/53328972#53328972", "title": "Check if a Range fits onto a single line", "body": "<p>There is no need to scroll anything - which in any event is not reliable. Try something based on:</p>\n\n<pre><code>With Selection\n  If .Characters.First.Information(wdVerticalPositionRelativeToPage) = _\n  .Characters.Last.Information(wdVerticalPositionRelativeToPage) Then\n    MsgBox .Text &amp; vbCr &amp; vbCr &amp; \"Spans one line or less.\"\n  Else\n    MsgBox .Text &amp; vbCr &amp; vbCr &amp; \"Spans more than one line.\"\n  End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51164480, "answer_count": 2, "score": 0, "last_activity_date": 1542322189, "creation_date": 1530663284, "last_edit_date": 1542283785, "question_id": 51164283, "link": "https://stackoverflow.com/questions/51164283/check-if-a-range-fits-onto-a-single-line", "title": "Check if a Range fits onto a single line", "body": "<p>I'm programmatically filling in a regulated form template where lines are predefined (as table cells):<br>\n<sub>(Using plain text Content Controls as placeholders but this isn't relevant to the current question.)</sub></p>\n\n<p><a href=\"https://i.stack.imgur.com/y6Oat.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y6Oat.png\" alt=\"predefined lines\"></a></p>\n\n<p>So, I have to break long text into lines manually (auto-adding rows or something is not an option because page breaks are also predefined).</p>\n\n<p>Now, since characters have different width, I cannot just set some hardcoded character limit to break at (or rather, I can, and that's what I'm doing now, but this has proven to be inefficient and unreliable, as expected). So:</p>\n\n<p><strong>How do I check if a Range of text fits on a single line -- and if it doesn't, how much of it fits?</strong></p>\n\n<p>I've checked out <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194034.aspx\" rel=\"nofollow noreferrer\">Range Members (Word)</a> but can't see anything relevant.</p>\n"}, {"tags": ["vba", "click", "keydown"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530664614, "post_id": 51164107, "comment_id": 89312047, "body": "It would be simpler to implement a Key Logger."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1530710015, "post_id": 51164107, "comment_id": 89331860, "body": "What is the active/selected control when it doesnot work anymore? Don&#39;t use a message box and don&#39;t call event-handlers"}, {"owner": {"reputation": 1, "user_id": 6029274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ifhXj.jpg?s=128&g=1", "display_name": "Sergio Fr&#237;as", "link": "https://stackoverflow.com/users/6029274/sergio-fr%c3%adas"}, "edited": false, "score": 0, "creation_date": 1530987204, "post_id": 51164107, "comment_id": 89431815, "body": "EvR, so sorry for my delayed reply.  I just used a Msgbox to simplify code reading on this site, just as an example. You mean I shouldn&#39;t use this?:  Private Sub UserForm_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer) TinMan, I will read about Key Logger. I think I haven&#39;t tried it, yet."}], "owner": {"reputation": 1, "user_id": 6029274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ifhXj.jpg?s=128&g=1", "display_name": "Sergio Fr&#237;as", "link": "https://stackoverflow.com/users/6029274/sergio-fr%c3%adas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530661486, "creation_date": 1530661486, "question_id": 51164107, "link": "https://stackoverflow.com/questions/51164107/vba-keydown-events-stops-working-after-clicking-a-button", "title": "Vba: KeyDown events stops working after clicking a button", "body": "<p>Excuse me for asking. I've been reading for 3 hours and I couldn't solve this yet. How can I make a form to respond to KeyDown events again after mouse clicking a button . At first it responds to letter \"n\" on the keyboard ,for example. But if the user chooses to click on a button Keydown events won't fire anymore.\nI tried calling the code which sets my form to wait for keydown events but it doesn't work.</p>\n\n<pre><code>Private Sub Btn_NextStudent_Click()\n    MsgBox \"You clicked the button\" \n    'GETS READY FOR KEYDOWN EVENTS AGAIN (*****THIS DOESN'T WORK*****)\n    TabstopFocusOnClick      \nEnd Sub\n\nPrivate Sub UserForm_Initialize()   \n    'PREPARAR CONTROLES PARA LOS EVENTOS KEYDOWN\n    TabstopFocusOnClick         \nEnd Sub\n\nSub TabstopFocusOnClick()\n    Dim I As Integer\n\n    '''PARA USAR EVENTOS DE TECLAS PRESIONADAS EN EL TECLADO\n    On Error Resume Next\n    For I = 0 To Controls.Count - 1   ' Use the Controls collection\n        Controls(I).TabStop = False\n        Controls(I).TakeFocusOnClick = False\n    Next\nEnd Sub\n\nPrivate Sub UserForm_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    'AL PRESIONAR \"N\" \n    If KeyCode = 78 Then\n        Btn_NextStudent_Click\n    End If        \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "hyperlink", "click", "frame"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1530661131, "post_id": 51163922, "comment_id": 89311403, "body": "Have to try Set a tmp IE object (<code>oTmpIE</code>) to that iframe then use <code>oTmpIE.document.getElementsByTagName(&quot;a&quot;)</code> to get all the links, then loop for the <code>innertext</code> to find a match, if found, <code>.Click</code>."}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1530735521, "post_id": 51163922, "comment_id": 89343070, "body": "<code>oTmpIE.document.getElementsByTagName(&quot;a&quot;)</code> nothing happens. there is no link found in the loop"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1530744756, "post_id": 51163922, "comment_id": 89345423, "body": "Did you do something like <code>Set oTmpIE = IEDocument.frames(1) : For Each oItem In oTmpIE.document.getElementsByTagName(&quot;a&quot;) : Debug.Print oItem.innerText, oItem.href : Next</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 1, "creation_date": 1530687332, "post_id": 51166610, "comment_id": 89318079, "body": "<code>choose(&#39;Objektnummer, Referenznummer&#39;)&quot;, &quot;JavaScrip</code>, is an link in the iframe you can see. its written in the href. so later i will try with the <code>oTmpIE</code> and the Loop with innertext. i tried it before but without <code>oTmpIE</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530687708, "post_id": 51166610, "comment_id": 89318281, "body": "I have added a different answer to try."}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530726619, "post_id": 51166610, "comment_id": 89340218, "body": "No, it go through without doing anything. Maybe there is an other part of the link i have to write in &#39;IEDocument.frames(&quot;IFRAME&quot;).document.querySelector(&quot;a[href=&zwnj;&#8203;javascript:choose(&#39;O&zwnj;&#8203;bjektnummer, Referenznummer&#39;)]&quot;).Click&#39;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530726943, "post_id": 51166610, "comment_id": 89340326, "body": "If you do  Debug.Print IEDocument.frames(&quot;IFRAME&quot;).document.querySelector(&quot;a[href=j&zwnj;&#8203;avascript:choose(&#39;Ob&zwnj;&#8203;jektnummer, Referenznummer&#39;)]&quot;).innerText can you verify correct element is selected? It may be that there is some javascript being executed that needs to be observed and replicated."}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530732076, "post_id": 51166610, "comment_id": 89342003, "body": "Debug.Print IEDocument.frames(&quot;IFRAME&quot;).document.querySelector(&quot;a[href=j&zwnj;&#8203;avascript:choose(&#39;Or&zwnj;&#8203;iginalObjektnummer, OriginalReferenznummer&#39;)]&quot;).innertext showing nothing -.- it only adds 5 Rows with nothing. sorry for writing"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530732510, "post_id": 51166610, "comment_id": 89342122, "body": "sorry for wrong writing. yes of course i add in my code <code>Debug.Print IEDocument.frames(&quot;IFRAME&quot;).document.querySelector(&quot;a[href=j&zwnj;&#8203;avascript:choose(&#39;Or&zwnj;&#8203;iginalObjektnummer, OriginalReferenznummer&#39;)]&quot;).innertext</code> but nothing"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530733223, "post_id": 51166610, "comment_id": 89342338, "body": "Sorry for going slowly. If you now do IEDocument.frames(&quot;IFRAME&quot;).document.querySelector(&quot;a[href=j&zwnj;&#8203;avascript:choose(&#39;Or&zwnj;&#8203;iginalObjektnummer, OriginalReferenznummer&#39;)]&quot;).OuterHTML is  it the HTML for the element you are trying to work with?"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530734137, "post_id": 51166610, "comment_id": 89342617, "body": "With <code>IEDocument.frames(&quot;IFRAME&quot;).document.querySelector(&quot;a[href=j&zwnj;&#8203;avascript:choose(&#39;Or&zwnj;&#8203;iginalObjektnummer, OriginalReferenznummer&#39;)]&quot;).OuterHTML</code> do nothing before i only can go to the direct URL of the Frame and can make <code>strURL = IEApp.document.DocumentElement.outerHTML</code> to put the complet IFRAME to my Sheet. There i make a varmax function so i can choose the right link. But i dont see any option to click on the link"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530734192, "post_id": 51166610, "comment_id": 89342639, "body": "Nothing is printed out?"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530736828, "post_id": 51166610, "comment_id": 89343446, "body": "i have the problem.... timing... the right one that works is <code>Call IEDocument.iframe.execScript(&quot;Choose(&#39;Objektnummer,Referenzn&zwnj;&#8203;ummer&#39;)&quot;, &quot;JavaScript&quot;)</code>but that can i do that i wait the right timing?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530768854, "post_id": 51166610, "comment_id": 89349676, "body": "Couple of examples added"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530779692, "post_id": 51166610, "comment_id": 89355321, "body": "Have I the chance that I can control the event? Maybe can I look at the event of the .focus value? Then it is true? Because I have to use this code of many different machines so the speed is different and I  won&#39;t to go this way with a fix time variable when I have an other option. Some machines are fast and can work with 2 seconds, other need 8 seconds. But till now thank you so much for your help"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530779775, "post_id": 51166610, "comment_id": 89355358, "body": "Then use the first of the two options"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530779919, "post_id": 51166610, "comment_id": 89355422, "body": "I will try it later, I thought it also waits always 10 seconds"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1530779988, "post_id": 51166610, "comment_id": 89355451, "body": "That is the timeout. The loop itself attempts to loop until item set. So faster computers would exit the loop earlier, potentially, as ele is nothing = false.   You can adjust t to be a bit longer."}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1531222731, "post_id": 51166610, "comment_id": 89506277, "body": "Sorry but by both of the Options the Code is waiting 10 seconds. So"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1531222797, "post_id": 51166610, "comment_id": 89506316, "body": "And then both failing? If you are sure it is a timing issue then increase the time."}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1531223382, "post_id": 51166610, "comment_id": 89506700, "body": "So, with focus i can ask <code>if setfocus then</code>. Maybe there is an option like if sendkey ?send? then. and i search for an option to take Text from my iframe directly to my Sheet. Till now i go to the iframe URL and <code>IEApp.document.DocumentElement.outerHTML</code> i search for something like <code>IEAPP.document.iframe.outerHTML</code>that i haven&#39;t navigate to the iframe URL"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 0, "creation_date": 1531223448, "post_id": 51166610, "comment_id": 89506763, "body": "The code go through no problem but the WaitingTime is always by max ... 10s"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1530768836, "last_edit_date": 1530768836, "creation_date": 1530683571, "answer_id": 51166610, "question_id": 51163922, "link": "https://stackoverflow.com/questions/51163922/click-to-a-link-in-iframe/51166610#51166610", "title": "click to a link in iframe", "body": "<p>Try using a CSS selector to target the element within the iframe.</p>\n\n<p>If you think it is a timing problem you can</p>\n\n<p>1) loop while target element is nothing i.e. not set; with timeout to avoid potential for infinite loop</p>\n\n<pre><code>Dim t As Date, ele As Object, waitTime As Long\nt = Timer\nwaitTime = 10 '&lt;== secs\nDo\n    DoEvents\n    On Error Resume Next\n    Set ele = IEDocument.frames(\"IFRAME\").document.querySelector(\"a[href=javascript:choose('Objektnummer, Referenznummer')]\")\n    On Error GoTo 0\n    If Timer - t = waitTime Then Exit Do     '&lt;==To avoid infinite loop\nLoop While ele Is Nothing\nCall IEDocument.iframe.execScript(\"Choose('Objektnummer,Referenznummer')\", \"JavaScript\")\n</code></pre>\n\n<p>2) Set an explicit wait</p>\n\n<pre><code>Application.Wait Now + TimeSerial(0,0,5) '&lt;== adjust 5 which is number of seconds\nCall IEDocument.iframe.execScript(\"Choose('Objektnummer,Referenznummer')\", \"JavaScript\")\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 51166610, "answer_count": 1, "score": -1, "last_activity_date": 1530768836, "creation_date": 1530659846, "last_edit_date": 1530688378, "question_id": 51163922, "link": "https://stackoverflow.com/questions/51163922/click-to-a-link-in-iframe", "title": "click to a link in iframe", "body": "<p>i search for a method to click to a link in an iframe in VBA code</p>\n\n<p>what i still done:</p>\n\n<pre><code>Set IEApp = GetObject(\"new:{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}\")\nIEApp.Visible = True\nIEApp.navigate \"https://meineseite.../LoginForm.jsp\" 'anpassen\nStart = Now\nDo: Loop Until IEApp.Busy = False\nDo: Loop Until IEApp.Busy = False\nDo: Loop Until IEApp.Document.ReadyState = \"complete\"\nDo\n'On Error Resume Next\nIf DateDiff(\"s\", Start, Now) &gt; 0 Then Exit Do\nLoop Until IEApp.ReadyState &lt;&gt; 4\nSet IEDocument = IEApp.Document\nIEDocument.all.USER.Value = \"Benutzer\"\nIEDocument.all.PASS.Value = \"Passwort\"\nIEDocument.getElementsByName(\"LoginForm\")(0).submit\n</code></pre>\n\n<p>work perfectly. so now there is a field to give a Name in, and then it's open a frame with 2 to or more links. so i have to search the right. \nits done... but how can i click on one of these links?</p>\n\n<p>I tried these:</p>\n\n<pre><code>Call IEDocument.frames(1).execScript(\"choose('Objektnummer, Referenznummer')\", \"JavaScript\")\n    IEDocument.parentWindow.frames.Navigate \"choose('Objektnummer, Referenznummer')\"\n    IEDocument.parentWindow.Links(2).Click\n</code></pre>\n\n<p>maybe i have write it like that:</p>\n\n<pre><code>IE.Document.getElementById(\"?\").contentDocument.getElementById(\"?\").Click\n</code></pre>\n\n<p>but what have i put into \"?\" ?</p>\n\n<p>so here is the iframe code:</p>\n\n<pre><code>DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"&gt;\n&lt;html&gt;\n\n  &lt;head&gt;\n   &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n&lt;/head&gt;\n  &lt;script type=\"text/javascript\"&gt;\n    function choose(wert) {\n      top.document.getElementById(\"links\").value=wert;\n      parent.absenden(\"LINKS\");\n      top.document.getElementById(\"IFRAME\").style.visibility = \"hidden\";\n    }\n    function close(){\n      top.document.getElementById(\"IFRAME\").style.visibility = \"hidden\";\n    }\n  &lt;/script&gt;\n&lt;body bgcolor=\"white\"&gt;\n  &lt;span style=\"font-family:sans-serif; font-size:12px;\"&gt;\n    &lt;table style=\"font-size:12px;font-weight:none;\" width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n      &lt;tr&gt;\n        &lt;td colspan=\"2\" align=\"right\"&gt;\n          &lt;a href=\"JavaScript:close();\" style=\"text-decoration:none;color:#000000;font-weight:bolder;\"&gt;X&amp;nbsp;&amp;nbsp;&lt;/a&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt; &lt;td colspan='2' nowrap=\"nowrap\"&gt; &lt;a href=\"javascript:choose('nichtgewaehlt')\"&gt;Bitte w\u00e4hlen&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt;\n&lt;tr&gt; &lt;td colspan='2' nowrap=\"nowrap\"&gt; &lt;a href=\"javascript:choose('Objektnummer, Referenznummer')\"&gt;Objektname&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt;\n&lt;tr&gt; &lt;td colspan='2' nowrap=\"nowrap\"&gt; &lt;a href=\"javascript:choose('Objektnummer2, Referenznummer2')\"&gt;Objektname2&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt;\n&lt;/table&gt;\n  &lt;/span&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>and the full srccode</p>\n\n<pre><code>&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"&gt;\n&lt;html&gt;\n&lt;!-- Deutsches Format dd.mm.yyyy --&gt;\n&lt;script language=\"JavaScript\" src=\"calendar_de.js\"&gt;&lt;/script&gt;&lt;!-- Datum mit Jahresauswahlmoeglichkeit --&gt;\n&lt;!-- Englisches Format mm/dd/yyyy --&gt;\n&lt;script language=\"JavaScript\" src=\"calendar_en.js\"&gt;&lt;/script&gt;&lt;!-- Datum mit Jahresauswahlmoeglichkeit --&gt;\n&lt;LINK REL=\"STYLESHEET\" media=\"screen\" TYPE=\"text/css\" HREF=\"__default.css\"&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n&lt;title&gt;Auswahl&lt;/title&gt;\n\n&lt;/head&gt;\n&lt;script type=\"text/javascript\"&gt;\nfunction absenden(feldname)\n{\ndocument.CheckForm.FKT.value = feldname;\nif (\"SUBMITREP\" == feldname) {\ndocument.CheckForm.SUBTYP.value=\"SUBANDREP\";\n}\ndocument.CheckForm.submit();\ndocument.CheckForm.ANZB.value=\"\";\n}\n\nfunction enableBtn(wert) {\nif (wert &gt; 0) {\ndocument.CheckForm.btn_submit_repair.disabled=false;\n}\nelse {\ndocument.CheckForm.btn_submit_repair.disabled=true;\n}\n}\n\nfunction Auswahl_link(){\nvar vLink = document.getElementById(\"link\");\nvar vNameNr = document.getElementById(\"Name\");\nvar vMin = 0;\n\n// Link in Grossbuchstaben umwandeln\nvLink.value = vLink.value.toUpperCase();\n// bei 'ESC' Popup schlie\u00dfen\nif(window.event.keyCode == 27) {\ntop.document.getElementById(\"IFRAME\").style.visibility = \"hidden\";\nreturn;\n}\n\n\n// Workaround f\u00fcr fehlerhaftes Encoding von Umlauten beim ersten Aufruf\nif (vLink.value.length &gt; vMin-1) {\nwindow.IFRAME.location.href = \"PopupLink.jsp?LINK=\"+vLink.value+\n\"&amp;LANG=de\"+\n\"&amp;Name=G\"+\n\"&amp;Ort=\"+\"B\".replace(\"%\",\"%25\")+\n\"&amp;Gliederung=\"+document.HauptForm.Gliederung.value.replace(\"%\",\"%25\")+\n\"&amp;Name=\"+vNameNr.value.replace(\"%\",\"%25\")+\n\"&amp;SORT1=1\"+\n\"&amp;Mandat=Bereich\";\n}\nif (vLink.value.length &gt; vMin) {\nvar Element = document.getElementById(\"link\");\nvar x=0, y=0;\nvar pos=0;\nwhile (Element) {\nx = x + Element.offsetLeft;\ny = y + Element.offsetTop;\nElement = Element.offsetParent;\n}\ndocument.getElementById(\"IFRAME_DIV\").style.top = y + 25;\ndocument.getElementById(\"IFRAME_DIV\").style.left = x;\ndocument.getElementById(\"IFRAME\").width = 700;\ndocument.getElementById(\"IFRAME\").height = 200;\ndocument.getElementById(\"IFRAME\").style.backgroundColor = 'white';\ndocument.getElementById(\"IFRAME\").style.visibility = \"visible\";\n} else {\ndocument.getElementById(\"IFRAME\").style.visibility = \"hidden\";\n}\n}\n\nfunction Auswahl_NameNr(){\nvar vNameNr = document.getElementById(\"Name\");\nvar vMin = 0;\n\n// Link in Grossbuchstaben umwandeln\nvNameNr.value = vNameNr.value.toUpperCase();\n// bei 'ESC' Popup schlie\u00dfen\nif(window.event.keyCode == 27) {\ntop.document.getElementById(\"IFRAME\").style.visibility = \"hidden\";\nreturn;\n}\n\n\nif (vNameNr.value.length &gt; vMin-1) {\nwindow.IFRAME.location.href = \"PopupNameNr.jsp?NAMEANR=\"+vNAMENr.value.replace(\"%\",\"%25\")+\n\"&amp;LANG=de\"+\n\"&amp;Name=G\"+\n\"&amp;Ort=\"+\"B\".replace(\"%\",\"%25\")+\n\"&amp;Gliederung=\"+\"%\".replace(\"%\",\"%25\")+\n\"&amp;SORT1=1\"+\n\"&amp;Mandat=Bereich\";\n}\nif (vNameNr.value.length &gt; vMin) {\nvar Element = document.getElementById(\"NAME\");\nvar x=0, y=0;\nvar pos=0;\nwhile (Element) {\nx = x + Element.offsetLeft;\ny = y + Element.offsetTop;\nElement = Element.offsetParent;\n}\ndocument.getElementById(\"IFRAME_DIV\").style.top = y + 25;\ndocument.getElementById(\"IFRAME_DIV\").style.left = x;\ndocument.getElementById(\"IFRAME\").width = 300;\ndocument.getElementById(\"IFRAME\").height = 200;\ndocument.getElementById(\"IFRAME\").style.backgroundColor = 'white';\n\ndocument.getElementById(\"IFRAME\").style.visibility = \"visible\";\n} else {\ndocument.getElementById(\"IFRAME\").style.visibility = \"hidden\";\n}\n}\n\nfunction Auswahl(){\nif (document.getElementById(\"IFRAME\").height == 125 &amp;&amp; document.getElementById(\"IFRAME\").style.visibility == \"visible\"){\ndocument.getElementById(\"IFRAME\").style.visibility = \"hidden\";\n}\nelse {\nwindow.IFRAME.location.href = \"PopupAuswahl.jsp?MANDAT=Bereich\"+\n\"&amp;ORT=\"+document.HauptForm.ORT.options[document.HauptForm.ORT.selectedIndex].text.replace(\"%\",\"%25\")+\n\"&amp;GLIEDERUNG=\"+document.HAUPTForm.GLIEDERUNG.value.replace(\"%\",\"%25\");\n\nvar Element = document.HauptForm.GLIEDERUNG;\nvar x=0, y=0;\nwhile (Element) {\nx = x + Element.offsetLeft;\ny = y + Element.offsetTop;\nElement = Element.offsetParent;\n}\ndocument.getElementById(\"IFRAME_DIV\").style.top = y + 16;\ndocument.getElementById(\"IFRAME_DIV\").style.left = x;\ndocument.getElementById(\"IFRAME\").width = 160;\ndocument.getElementById(\"IFRAME\").height = 125;\ndocument.getElementById(\"IFRAME\").style.backgroundColor = 'white';\ndocument.getElementById(\"IFRAME\").style.visibility = \"visible\";\n}\n}\n\nfunction Auswahl_BELinkNr(){\nvar vBELinkNr = document.getElementById(\"belinknnr\");\nvar vMin = 0;\n\n// Link in Grossbuchstaben umwandeln\nvBELinkNr.value = vBELinkNr.value.toUpperCase();\n// bei 'ESC' Popup schlie\u00dfen\nif(window.event.keyCode == 27) {\ntop.document.getElementById(\"IFRAME\").style.visibility = \"hidden\";\nreturn;\n}\n\n\nif (vBELinkNr.value.length &gt; vMin) {\nwindow.IFRAME.location.href = \"PopupBELinknNr.jsp?BELINKNR=\"+vBELinkNr.value.replace(\"%\",\"%25\")+\n\"&amp;BTGRP=\"+\"%\".replace(\"%\",\"%25\")+\n\"&amp;BTKLA=\"+\"%\".replace(\"%\",\"%25\")+\n\"&amp;MANDAT=Bereich\";\nvar Element = document.getElementById(\"belinknr\");\nvar x=0, y=0;\nvar pos=0;\nwhile (Element) {\nx = x + Element.offsetLeft;\ny = y + Element.offsetTop;\nElement = Element.offsetParent;\n}\ndocument.getElementById(\"IFRAME_DIV\").style.top = y + 25;\ndocument.getElementById(\"IFRAME_DIV\").style.left = x ;\ndocument.getElementById(\"IFRAME\").width = 700;\ndocument.getElementById(\"IFRAME\").height = 200;\ndocument.getElementById(\"IFRAME\").style.backgroundColor = 'white';\n\ndocument.getElementById(\"IFRAME\").style.visibility = \"visible\";\n} else {\ndocument.getElementById(\"IFRAME\").style.visibility = \"hidden\";\n}\n}\n&lt;/script&gt;\n\n&lt;body onLoad=\"javascript:document.CheckForm.PDAT.focus();\"&gt;\n\n&lt;div id=\"IFRAME_DIV\" style=\"position:absolute;z-index:2;visibility:hidden;\"&gt;\n&lt;iframe src=\"JavaScript:void(0);\" id=\"IFRAME\" name=\"IFRAME\" width=\"650\" height=\"200\" marginheight=\"0\" marginwidth=\"0\" align=\"middle\" scrolling=\"yes\"&gt;\n&lt;/iframe&gt;\n&lt;/div&gt;\n\n&lt;!-- ===== top navigation ===== --&gt;\n&lt;div style=\"position:absolute;top:0;left:0;\"&gt;\n&lt;TABLE border=\"0\" height=\"100%\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n&lt;TR ALIGN=\"center\" NOWRAP bgcolor=\"#336699\" height=\"1%\"&gt;\n&lt;TD align=\"right\" rowspan=\"3\" width=\"1%\"&gt;\n&lt;A HREF=\"Prozess.COMMON.SHOW\" onMouseOver=\"document.keyvisual.src='img/key-visual_light.gif';\" onMouseOut=\"document.keyvisual.src='img/key-visual.gif';\"&gt;\n&lt;IMG SRC=\"img/key-visual.gif\" name=\"keyvisual\" border=\"0\" width=\"144\" height=\"83\"&gt;\n&lt;/A&gt;\n&lt;/TD&gt;\n&lt;TD width=\"1%\"&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;Sprache&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;Ort&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;Name&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;Ger\u00e4t&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;Prozess&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;Sortierung&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;&amp;nbsp&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" style=\"color:#FFFFFF;\"&gt;&lt;nobr&gt;&amp;nbsp&lt;/nobr&gt;&lt;/TD&gt;\n&lt;TD width=\"1%\"&gt;&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;TR ALIGN=\"center\" NOWRAP bgcolor=\"#336699\" height=\"1%\"&gt;\n&lt;form name=\"ArbeitsplatzForm\" action=/delta-beleg/HauptContro.jsp method=post&gt;\n&lt;TD&gt;&lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;select name=\"LANG\" size=\"1\"&gt;\n&lt;option selected value=\"de\" &gt;Deutsch&lt;/option&gt;\n&lt;option value=\"en\" &gt;Englisch&lt;/option&gt;\n&lt;/select&gt;\n&lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;SELECT name=\"BEREICH\" size=\"1\"&gt;\n&lt;OPTION&gt;%&lt;/OPTION&gt;\n&lt;OPTION&gt;A&lt;/OPTION&gt;\n&lt;OPTION selected&gt;B&lt;/OPTION&gt;\n&lt;OPTION&gt;C&lt;/OPTION&gt;\n&lt;OPTION&gt;nn&lt;/OPTION&gt;\n&lt;/SELECT&gt;\n&amp;nbsp;&lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;span style=\"position:relative;top:-6px;left:0px;\"&gt;&lt;INPUT readonly onClick=\"Auswahl_Gliederung();\" name=\"GLIEDERUNG\" id=\"FAGRU\" type=\"text\" value=\"%\" size=\"21\"/&gt;&lt;IMG onClick=\"Auswahl_Gliederung();\" src=\"img/DropDown.gif\" height=\"22\" width=\"18\" style=\"position:relative;top:5px;left:-1px;\"/&gt;&amp;nbsp;&lt;/span&gt; &lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;INPUT type=\"text\" name=\"NAME\" id=\"NAME\" onKeyUp=\"Auswahl_NameNr();\" value=\"%\" size=\"21\"/&gt; &lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;select name=\"NAME\" size=\"1\"&gt;\n&lt;option value=\"fp\" &gt;Prozess1&lt;/option&gt;\n&lt;option value=\"fr\" &gt;Prozess2&lt;/option&gt;\n&lt;option value=\"bp\" &gt;Prozess3&lt;/option&gt;\n&lt;option value=\"br\" &gt;Prozess4&lt;/option&gt;\n&lt;option selected value=\"gp\" &gt;Prozess5&lt;/option&gt;\n&lt;option value=\"gr\" &gt;Prozess6&lt;/option&gt;\n&lt;option value=\"rf\" &gt;Prozess7&lt;/option&gt;\n&lt;/select&gt;\n&lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;select name=\"SORT1\" size=\"1\"&gt;\n&lt;option selected value=\"1\" &gt;NAME, Nr, Index&lt;/option&gt;\n&lt;option value=\"2\" &gt;Nr, Index, Name&lt;/option&gt;\n&lt;/select&gt;\n&lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&amp;nbsp\n&lt;/TD&gt;\n&lt;TD align=\"left\" valign=\"top\" NOWRAP&gt;\n&lt;input type=\"submit\" value=\"Absenden\"&gt;\n&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" width=\"50\"&gt;&lt;/TD&gt;\n&lt;/FORM&gt;\n&lt;/TR&gt;\n&lt;TR ALIGN=\"center\" NOWRAP height=\"1%\" bgcolor=\"#99CCFF\"&gt;\n&lt;TD colspan=\"6\" align=\"right\" nowrap=\"nowrap\"&gt;&lt;/TD&gt;\n&lt;TD colspan=\"2\" align=\"left\" nowrap=\"nowrap\"&gt;Benutzer&lt;/TD&gt;\n&lt;TD align=\"left\" nowrap=\"nowrap\"&gt;\n&lt;nobr&gt;&amp;nbsp;&lt;/nobr&gt;&lt;A HREF=\"LoginForm.jsp\" class=\"navigation\"&gt;logout&lt;/A&gt;\n&lt;/TD&gt;\n&lt;TD ALIGN=\"left\" width=\"50\"&gt;&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;/TABLE&gt;\n&lt;/div&gt;\n&lt;!-- ===== END - top navigation ===== --&gt;\n&lt;!-- ===== left navigation ===== --&gt;\n&lt;div style=\"position:absolute;top:83;left:0;z-index:0;\"&gt;\n&lt;TABLE width=\"144\" height=\"445\" bgcolor=\"#99CCFF\"&gt;\n&lt;TR&gt;\n&lt;TD&gt;&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;/TABLE&gt;\n&lt;/div&gt;\n&lt;div style=\"position:absolute;top:83;left:0;\"&gt;\n&lt;TABLE border=\"0\" width=\"144\" height=\"41\" bgcolor=\"#336699\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n&lt;TR bgcolor=\"#336699\"&gt;\n&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;\n&lt;TD align=\"LEFT\" style=\"color:#FFFFFF;font-weight:bold;\"&gt;DELTA-&lt;br&gt; FER&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;/TABLE&gt;\n&lt;/div&gt;\n&lt;!-- ===== inner page ===== --&gt;\n&lt;div style=\"position:absolute;top:86;left:144;\"&gt;\n&lt;table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"&gt;\n&lt;tr&gt;\n&lt;td width=\"300\" align=left valign=bottom&gt;\n&lt;img src=\"img/chip_01.jpg\" width=300 height=24 border=0&gt;\n&lt;/td&gt;\n&lt;td align=\"left\" valign=\"bottom\" style=\"FONT-FAMILY:Arial;FONT-SIZE:18px;font-weight:bold;COLOR:#000000;\"&gt;Ger\u00e4te-Pr\u00fcfung&lt;/td&gt;\n&lt;td align=\"right\" valign=\"bottom\"&gt;&lt;a href=\"./help.htm\"&gt;\n&lt;img src=\"img/icohelp1.gif\" width=24 height=20 border=0 alt=\"Hilfe\"&gt;&lt;/a&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td colspan=3 align=left bgcolor=#0000ff&gt;\n&lt;img src=\"img/1x1.gif\" width=1 height=1 border=0&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;table ALIGN=\"CENTER\" width=\"100%\"&gt;\n&lt;TR&gt;\n&lt;TD WIDTH=\"1%\" colspan=\"2\"&gt;&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;/TABLE&gt;\n&lt;!-- ===== START - Anwendungsbereich ===== --&gt;\n&lt;form name=\"CheckForm\" action=\"/delta-beleg/CheckContro.jsp\" method=post width=\"500\" autocomplete=\"off\"&gt;\n&lt;center&gt;\n&lt;table cellpadding=4 cellspacing=2 border=0&gt;\n\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;Pruefdatum&lt;/b&gt;\n&lt;br&gt;\n&lt;input type=\"text\" name=\"PDAT\" size=10 value=\"\" maxlength=10&gt;&lt;a href=\"javascript:cal1.popup();\"&gt;&lt;img src=\"img/cal.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"Click Here to Pick up the date\"&gt;&lt;/a&gt;\n&lt;script language=\"JavaScript\"&gt;\nfunction setHeute(){\nvar jetzt = new Date();\nvar Tag = jetzt.getDate()&lt;10?\"0\"+jetzt.getDate():jetzt.getDate();\nvar Monat = jetzt.getMonth()+1&lt;10?\"0\"+(jetzt.getMonth()+1):(jetzt.getMonth()+1);\nvar Jahr = jetzt.getFullYear();\n\nvar txt = Tag+\".\"+Monat+\".\"+Jahr;\n\ndocument.getElementsByName(\"PDAT\")[0].value = txt;\n}\n&lt;/script&gt;\n&amp;nbsp;&amp;nbsp;&lt;a href=\"JavaScript:setHeute();\" style=\"font-size:10px;text-decoration:none;color:#000000;cursor:hand;\"&gt;[heute]&lt;/a&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;Ger\u00e4t / Ger\u00e4t St&lt;/b&gt;\n&lt;br&gt;\n&lt;input type=\"text\" name=\"LINK\" id=\"link\" size=\"70\" value=\"\" onKeyUp=\"Auswahl_Link();\"&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n\n\n\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;Plan&lt;/b&gt;\n&lt;br&gt;\n&lt;SELECT name=\"PLALT\" size=\"1\" null&gt;\n&lt;OPTION selected value=\"-\" &gt;-, -&lt;/OPTION&gt;\n&lt;/SELECT&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;Anzahl geprueft&lt;/b&gt;\n&lt;br&gt;\n&lt;input type=\"text\" name=\"ANZG\" size=10 value=\"\" maxlength=10&gt;&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;Anzahl beanstandet&lt;/b&gt;\n&lt;br&gt;\n&lt;input type=\"text\" name=\"ANZB\" size=10 value=\"\" maxlength=10 onkeyup=\"enableBtn(this.value)\"&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;!--\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;%= Translator.getTranslation(Constants.CHECKFORM_ANZ_REPARIERT, lang) %&gt;&lt;/b&gt;\n&lt;br&gt;\n&lt;input type=\"text\" name=\"%=Constants.PARA_ANZ_REPARIERT %&gt;\" size=10 value=\"\" maxlength=10&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n--&gt;\n\n\n\n&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td align=center colspan=2&gt;\n&lt;input type=\"button\" value=\"Speichern\" onClick=\"absenden('SUBMIT')\"&gt;\n&lt;input type=\"button\" name=\"btn_submit_repair\" value=\"Speichern\" onClick=\"absenden('SUBMITREP')\"&gt;\n&lt;input type=\"button\" value=\"Zur\u00fccksetzen\" onClick=\"absenden('CLEAR')\"&gt;\n\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;/table&gt;\n&lt;input type=\"hidden\" name=\"FKT\" value=\"\"&gt;\n&lt;input type=\"hidden\" name=\"SUBTYP\" value=\"\"&gt;\n&lt;/center&gt;\n&lt;/form&gt;\n\n&lt;!-- ===== END - Anwendungsbereich ===== --&gt;\n&lt;table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n&lt;tr&gt;\n&lt;td colspan=\"3\" align=left bgcolor=#0000ff&gt;\n&lt;img src=\"img/1x1.gif\" width=1 height=1 border=0&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td align=\"left\" valign=\"top\" width=\"1%\"&gt;\n&lt;img src=\"img/chip_01b.jpg\" width=\"300\" height=\"23\" border=\"0\"&gt;\n&lt;/td&gt;\n&lt;td align=\"left\" valign=\"bottom\"&gt;&amp;nbsp;&lt;/td&gt;\n&lt;td align=\"right\" valign=\"bottom\"&gt;\n&lt;SCRIPT LANGUAGE='JavaScript'&gt; jetzt = new Date(); Std = jetzt.getHours(); Min = jetzt.getMinutes(); Tag = jetzt.getDate(); Jahr = jetzt.getYear();\nif(Jahr &lt; 100) Jahr+=1900; Jahresmonat = jetzt.getMonth(); var Monat = new Array(\"Jan\",\"Feb\",\"M&amp;auml;r\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\");\nvar StdAusgabe = ((Std &lt; 10) ? \"0\" + Std : Std); var MinAusgabe = ((Min &lt; 10) ? \"0\" + Min : Min);\ndocument.write(\"&lt;span style='color:#000000;font-size:10px;font-family:Arial,sans-serif;'&gt;Stand: \" + Tag+ \".\" + Monat[Jahresmonat] + \".\" + Jahr + \" \" + StdAusgabe + \":\" + MinAusgabe + \" Uhr\" + \"&amp;nbsp;&lt;/span&gt;&lt;br/&gt;\");&lt;/SCRIPT&gt;\n&lt;span style=\"FONT-FAMILY:Arial;FONT-SIZE:12px;font-weight:900;COLOR:#000055;\"&gt;---&amp;nbsp;&lt;/span&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n&lt;script language=\"JavaScript\"&gt;\n&lt;!-- // create calendar object(s) just after form tag closed\n// specify form element as the only parameter (document.forms['formname'].elements['inputname']);\n// note: you can have as many calendar objects as you need for your application\nvar cal1 = new calendar_de(document.forms['CheckForm'].elements['PDAT']);\ncal1.year_scroll = true;\ncal1.time_comp = false;\n//--&gt;\n&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>thank you very much</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530664019, "post_id": 51163705, "comment_id": 89311964, "body": "FALSE (aka No) is zero and anything that is not FALSE is TRUE. While a worksheet&#39;s TRUE is numerically 1, VBA&#39;s True is numerically -1. Why would you opt to change that?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1530664820, "post_id": 51163705, "comment_id": 89312077, "body": "You should check which row is selected when you do the <code>.End(xlUp)</code>, but before the offset (since the offset is moving one row down and 10 columns to the right)."}, {"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1530702697, "post_id": 51163705, "comment_id": 89327151, "body": "Jeeped- I already have the spreadsheet setup that way. The conditional formatting / cell format uses 1 for \u201cYes\u201d (TRUE) and -1 for \u201cNO\u201d (FALSE\u201d). I can see if I can change it easily, but it\u2019s in multiple places."}, {"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1530702861, "post_id": 51163705, "comment_id": 89327252, "body": "Mistella- how would I go about this? The userform adds a row to the end of the populated rows each time the save button is pressed in the form. Thanks for the assistance to both of you! I\u2019m pretty good in Excel, but totally new to VBA."}], "owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530657982, "creation_date": 1530657982, "last_edit_date": 1531164843, "question_id": 51163705, "link": "https://stackoverflow.com/questions/51163705/excel-vba-userform-checkbox-duplicating-row", "title": "Excel VBA - Userform checkbox duplicating row", "body": "<p>I have a userform with a checkbox that needs to return a value of \"1\" or \"-1\" to the worksheet instead of \"TRUE\" or \"FALSE\". (My spreadsheet converts 1 to Yes and -1 to No) </p>\n\n<p>The code sort of works, but its using true/false on the row with my data, and using the 1 / -1 on the very next line (see screenshot). The grey lines in the screenshot are the duplicate rows. Any ideas what I am doing wrong?</p>\n\n<p>Here is the code for the checkbox:</p>\n\n<pre><code>If ConstRel.Value Then\nws.Range(\"A65535\").End(xlUp).Offset(1, 10).Value = \"1\"\nElse\nws.Range(\"A65535\").End(xlUp).Offset(1, 10).Value = \"-1\"\nEnd If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bc8Gu.jpg\" rel=\"nofollow noreferrer\">Screenshot</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "edited": false, "score": 0, "creation_date": 1530658659, "post_id": 51163674, "comment_id": 89310828, "body": "Did you copy and paste your source above or type it? I ask because the code above has a typo in the loop: note the space <code>Step by - 1</code>. Same with the cell <code>Cells(i - 1, 8)</code>"}, {"owner": {"reputation": 103, "user_id": 10029177, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QMri-2uK6xw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7quqzTnR2TSxw2vpJJOMAwsvM23jA/mo/photo.jpg?sz=128", "display_name": "Stephen Wyka", "link": "https://stackoverflow.com/users/10029177/stephen-wyka"}, "edited": false, "score": 0, "creation_date": 1530661273, "post_id": 51163674, "comment_id": 89311425, "body": "The images show the spaces. It inserts a row between row #177 and #176 which corresponds to ID# 176 and 175. I also copied the code from a file I save codes on, so I know it worked before."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "edited": false, "score": 0, "creation_date": 1530662643, "post_id": 51163674, "comment_id": 89311685, "body": "@Alan - oddly enough with     Option Explicit  disabled, that code actually runs. Apparently, <i>by</i> is considered an undeclared var that is instantiated as numerically zero so <code>Step by - 1</code> is the same as <code>Step -1</code>. The <code>i - 1</code> is intentional as it refers to the row above i."}, {"owner": {"reputation": 103, "user_id": 10029177, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QMri-2uK6xw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7quqzTnR2TSxw2vpJJOMAwsvM23jA/mo/photo.jpg?sz=128", "display_name": "Stephen Wyka", "link": "https://stackoverflow.com/users/10029177/stephen-wyka"}, "edited": false, "score": 0, "creation_date": 1530662918, "post_id": 51163674, "comment_id": 89311746, "body": "I figured it out. Turns out you can&#39;t have anything in columns that are after the columns in questions. For example, in here I had other values in cells in column 9 and I was separating by column 8."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530663227, "post_id": 51163674, "comment_id": 89311823, "body": "1. Of course you can have values in columns 9 and higher. 2. You really should fix that For ... Next Step syntax. I&#39;m sure it is going to come back and bite you sometime in the future if you don&#39;t."}, {"owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "edited": false, "score": 1, "creation_date": 1530663300, "post_id": 51163674, "comment_id": 89311838, "body": "@Jeeped @stephen-wyka <b>by</b> is not used in Step syntax. It should simply be <code>For Words = 10 To 1 Step -1</code> as per <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/fornext-statement\" rel=\"nofollow noreferrer\">the documentation</a> which is why it considered by to be a variable and ran with Option Explicit turned off."}, {"owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "edited": false, "score": 1, "creation_date": 1530663516, "post_id": 51163674, "comment_id": 89311873, "body": "@Jeeped Well spotted on my eyes catching a false match."}, {"owner": {"reputation": 103, "user_id": 10029177, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QMri-2uK6xw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7quqzTnR2TSxw2vpJJOMAwsvM23jA/mo/photo.jpg?sz=128", "display_name": "Stephen Wyka", "link": "https://stackoverflow.com/users/10029177/stephen-wyka"}, "edited": false, "score": 0, "creation_date": 1530665379, "post_id": 51163674, "comment_id": 89312165, "body": "Well I switched the columns and had my search column as the last column and the code worked perfectly, so I don&#39;t know. I&#39;ll take a look at re-phrasing the code. Thanks"}], "owner": {"reputation": 103, "user_id": 10029177, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QMri-2uK6xw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7quqzTnR2TSxw2vpJJOMAwsvM23jA/mo/photo.jpg?sz=128", "display_name": "Stephen Wyka", "link": "https://stackoverflow.com/users/10029177/stephen-wyka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1530661552, "creation_date": 1530657749, "last_edit_date": 1531161705, "question_id": 51163674, "link": "https://stackoverflow.com/questions/51163674/excel-for-if-not-working-correctly-one-one-sheet-versus-other-sheets", "title": "Excel For If not working correctly one one sheet versus other sheets", "body": "<p>I have this loop that I found that has worked plenty of times in the past. All it does it look at the previous cell and if the value in the cell is different than it will insert a row. The code is below. </p>\n\n<pre><code>Dim lr As Integer\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nApplication.ScreenUpdating = False\nFor i = lr To 2 Step by - 1\n    If Cells(i, 8).Value &gt; Cells(i - 1, 8).Value Then\n        Cells(i, 8).EntireRow.Insert\n    End If\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>What is currently does for this particular sheet is stop after the first iteration and doesn't continue the loop. The column that the code is searching for is the last one (column 8) and the first column is just a list to count the rows from 1 to \"lr\" (last row).</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lO7cd.png\" rel=\"nofollow noreferrer\">Original sheet</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Mk9fw.png\" rel=\"nofollow noreferrer\">After the macro is run</a></p>\n\n<p>Does anyone know why it stops after the first iteration?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 1, "last_activity_date": 1530656504, "creation_date": 1530656504, "answer_id": 51163494, "question_id": 51163323, "link": "https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute/51163494#51163494", "title": "Custom Function for Formula using Substitute", "body": "<p>You could create a User-Defined-Function - look at <a href=\"https://www.excel-easy.com/vba/examples/user-defined-function.html\" rel=\"nofollow noreferrer\">This Link</a> to get the basics on how to create a UDF, but basically, open the VBA code-edit, insert a module, and then paste in the following - it should work and you can try to interpret the code (It's fairly easy to get what it's doing)</p>\n\n<pre><code>Function WBSReplace(x As String) As String\nx = Replace(x, \"/\", \"\")\nx = Replace(x, \"-\", \"\")\nx = Replace(x, \".\", \"\")\nx = Replace(x, \" \", \"\")\nWBSReplace = x\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530658803, "post_id": 51163522, "comment_id": 89310863, "body": "Possibly put the UDF in a <a href=\"https://support.office.com/en-us/article/copy-your-macros-to-a-personal-macro-workbook-aa439b90-f836-4381-97f0-6e4c3f5ee566\" rel=\"nofollow noreferrer\">Personal Macro Workbook</a>."}], "tags": [], "owner": {"reputation": 1844, "user_id": 5736633, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rM1Fw.png?s=128&g=1", "display_name": "vatbub", "link": "https://stackoverflow.com/users/5736633/vatbub"}, "is_accepted": false, "score": 1, "last_activity_date": 1530658406, "last_edit_date": 1530658406, "creation_date": 1530656655, "answer_id": 51163522, "question_id": 51163323, "link": "https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute/51163522#51163522", "title": "Custom Function for Formula using Substitute", "body": "<p>You can put all of that into VBA, but it won't be prettier nor simpler or easy to reuse. The issue is that VBA code is bound to one workbook and if you want to reuse your VBA Code, you will either have to copy-paste it or you will have to write complex copy paste logic that does it for you. In any case, your life will probably be harder than it is right now. But since you asked for it, here's the VBA code for it:</p>\n\n<pre><code>Public Function WBSReplace(rng As Range) As String\n    WBSReplace = Replace(Replace(Replace(Replace(rng.Value, \"/\", \"\"), \".\", \"\"), \"-\", \"\"), \" \", \"\")\nEnd Function\n</code></pre>\n\n<p>In your VBA Editor click \"Insert\" -> \"New module\" and paste that code. Then, you will be able to use the function <code>WBSReplace</code> much like you mentioned it in your question, but, as said before, you will have to copy-paste that VBA code to every workbook that you wish to use it in.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10029077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hv06_5d6UW8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r3cTsUiq2CJjH1nf4ibysdquJqtw/mo/photo.jpg?sz=128", "display_name": "Paul Whittem", "link": "https://stackoverflow.com/users/10029077/paul-whittem"}, "edited": false, "score": 0, "creation_date": 1530662395, "post_id": 51163736, "comment_id": 89311632, "body": "Wow. Really impressed with the quick responses and options provided by all. I&#39;ll take a look at this in morning and see what might work best for me and let you know. Thanks again for your help"}, {"owner": {"reputation": 1, "user_id": 10029077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hv06_5d6UW8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r3cTsUiq2CJjH1nf4ibysdquJqtw/mo/photo.jpg?sz=128", "display_name": "Paul Whittem", "link": "https://stackoverflow.com/users/10029077/paul-whittem"}, "edited": false, "score": 0, "creation_date": 1530721520, "post_id": 51163736, "comment_id": 89338179, "body": "Thanks Jeeped. That worked a treat. Taking this a stage further and I appreciate this may not be using function.. what if I wanted to highlight a range of cells and have the characters stripped out of them as opposed to running a calculation next to them to do that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 10029077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hv06_5d6UW8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r3cTsUiq2CJjH1nf4ibysdquJqtw/mo/photo.jpg?sz=128", "display_name": "Paul Whittem", "link": "https://stackoverflow.com/users/10029077/paul-whittem"}, "edited": false, "score": 0, "creation_date": 1530722434, "post_id": 51163736, "comment_id": 89338558, "body": "See method added in above."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1530722408, "last_edit_date": 1530722408, "creation_date": 1530658231, "answer_id": 51163736, "question_id": 51163323, "link": "https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute/51163736#51163736", "title": "Custom Function for Formula using Substitute", "body": "<p><strong><a href=\"https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute/51163736#51163736\">Example 1: ParamArray</a></strong></p>\n\n<p>This is an ideal case for a <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/modifiers/paramarray\" rel=\"nofollow noreferrer\">ParamArray</a> type parameter arguement. This allows for a virtually limitless number of characters or text strings to remove without passing in an array.</p>\n\n<pre><code>Function getRidOf(str As String, ParamArray dels())\n    Dim i As Long\n\n    For i = LBound(dels) To UBound(dels)\n        str = Replace(str, dels(i), vbNullString, 1, -1, vbTextCompare)\n    Next i\n\n    getRidOf = str\nEnd Function\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>=getRidOf(C8, \"/\",\".\",\"-\",\" \")      'result: ACBPR01AB\n</code></pre>\n\n<p>Note that the vbTextCompare makes the replacement non-case-sensitive. For a case-sensitive replacement, use vbBinaryCompare.</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute/51163736#51163736\">Example 2: RegEx.Replace</a></strong></p>\n\n<p>This example may be easier to use for a long list of removal characters as it simply strips anything that isn't an uppercase letter or a number. It should be especially helpful to remove 'special' or unicode characters.</p>\n\n<pre><code>Function getRidOf2(str As String)\n    Static rgx As Object\n\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"[^A-Z0-9]\"\n\n        If .test(str) Then\n            str = .Replace(str, vbNullString)\n        End If\n    End With\n\n    getRidOf2 = str\nEnd Function\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>=getRidOf2(C8)      'result: ACBPR01AB\n</code></pre>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute/51163736#51163736\">Putting it into Practice with the Selection Object</a></strong></p>\n\n<p>After putting this sub procedure into a public module code sheet, select one or more cells, full columns, full rows or the entire worksheet then run this sub procedure through Alt+F8 or assign it to a hot-key combination.</p>\n\n<pre><code>sub stripThis()\n    dim rng as range\n\n    for each rng in intersect(selection, selection.parent.usedrange)\n        rng = getRidOf2(rng.value2)\n        'or the other one\n        'rng = getRidOf(rng.value2, \"/\",\".\",\"-\",\" \")\n    next rng\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10029077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hv06_5d6UW8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r3cTsUiq2CJjH1nf4ibysdquJqtw/mo/photo.jpg?sz=128", "display_name": "Paul Whittem", "link": "https://stackoverflow.com/users/10029077/paul-whittem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1530722408, "creation_date": 1530655108, "last_edit_date": 1530658425, "question_id": 51163323, "link": "https://stackoverflow.com/questions/51163323/custom-function-for-formula-using-substitute", "title": "Custom Function for Formula using Substitute", "body": "<p>I have a formula that I am having to use to strip out certain characters from another cell. For example, cell <code>C8</code> might contain something like: <code>A/CB.PR.01-AB</code>\nCurrently I use this formula: </p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(C8,\"/\",\"\"),\".\",\"\"),\"-\",\"\"),\" \",\"\")\n</code></pre>\n\n<p>The result would then be <code>ACBPR01AB</code>. This is all fine and well but I can never remember the above formula and have to keep finding it and copying it over. I'm thinking that I could possibly create a VBA Function that would run this formula without me having to type it all in. So for example instead of the above I could just type <code>=WBSReplace(C8)</code> and the result would be the same as typing the full formula. </p>\n\n<p>I'd also like to be able to run the function on any workbook and not have it restricted to just the workbook I am in. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1530655273, "post_id": 51163310, "comment_id": 89309945, "body": "I wish I could understand"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530804596, "post_id": 51163462, "comment_id": 89371766, "body": "The issue I&#39;m having is DirCurrentArray is a String Array.  Both DirCurrentArray and DirHistoryArray are filenames (e.g. text).  I need exact matches."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530805068, "post_id": 51163462, "comment_id": 89372063, "body": "Well the latter method I provided would seem to support that."}, {"owner": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530806206, "post_id": 51163462, "comment_id": 89372730, "body": "You&#39;re right about the whole word, but the issue is I have Dim DirCurrentArray As String and I think you&#39;re expecting As Variant so I get a mismatch when getting to: &quot;For Each k In DirCurrentArray&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530806411, "post_id": 51163462, "comment_id": 89372871, "body": "That&#39;s true. I find working in anything but a variant array restrictive. Same goes for dictionaries and collections which are of variant type. Of course, you could always write your own string based loop."}, {"owner": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530806670, "post_id": 51163462, "comment_id": 89373021, "body": "Thanks. That&#39;s a good best practice to get used to.  I added code to my original question.  The only reason I went with a String was because that&#39;s the only way I knew to get filenames from a directory into an array.  Is there any easy way to pull in filenames into a variant?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530806957, "post_id": 51163462, "comment_id": 89373173, "body": "See adjusted loop added above."}, {"owner": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530807665, "post_id": 51163462, "comment_id": 89373584, "body": "Yes, see that creates the type mismatch at:  &quot;For Each k In DirCurrentArray&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530808099, "post_id": 51163462, "comment_id": 89373813, "body": "Well, I had to use <code>Dim DirCurrentArray() As Variant</code> but other than that it works for me."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1530808070, "last_edit_date": 1530808070, "creation_date": 1530656322, "answer_id": 51163462, "question_id": 51163310, "link": "https://stackoverflow.com/questions/51163310/excel-vba-get-unique-values/51163462#51163462", "title": "Excel VBA Get Unique Values", "body": "<p>The validity of this code will depend somewhat on the nature of the data you are comparing as text based values may produce false positives on partial matches like a wildcarded search. Even a <em>1</em> will find a filter match in <em>11</em> or <em>15</em>, etc. I've added 'whole word' matching using the worksheet's Match function as an alternative.</p>\n\n<pre><code>Option Explicit\n\nSub ytrte()\n    Dim DirCurrentArray As Variant, DirHistoryArray As Variant\n    Dim i As Long, k As Variant, DirNewArray As Variant\n\n    DirCurrentArray = Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 0)\n    DirHistoryArray = Array(3, 4, 5, 6, 7, 8, 11)\n\n    ReDim DirNewArray(0)\n    i = 0\n\n    ' 'wildcard' matching\n    For Each k In DirCurrentArray\n        If UBound(Filter(DirHistoryArray, k, True, vbBinaryCompare)) &lt; 0 Then\n            ReDim Preserve DirNewArray(i)\n            DirNewArray(i) = k\n            i = i + 1\n        End If\n    Next k\n\n    If Not IsEmpty(DirNewArray(LBound(DirNewArray))) Then\n        For i = LBound(DirNewArray) To UBound(DirNewArray)\n            Debug.Print DirNewArray(i)\n        Next i\n    End If\n\n'contents of DirNewArray\n 2 \n 9 \n 0 \n\n    ReDim DirNewArray(0)\n    i = 0\n\n    ' 'whole word' matching\n    For Each k In DirCurrentArray\n        If IsError(Application.Match(k, DirHistoryArray, 0)) Then\n            ReDim Preserve DirNewArray(i)\n            DirNewArray(i) = k\n            i = i + 1\n        End If\n    Next k\n\n    If Not IsEmpty(DirNewArray(LBound(DirNewArray))) Then\n        For i = LBound(DirNewArray) To UBound(DirNewArray)\n            Debug.Print DirNewArray(i)\n        Next i\n    End If\n'contents of DirNewArray\n 1 \n 2 \n 9 \n 0 \n\nEnd Sub\n</code></pre>\n\n<p>Adjusted loop to fill file names.</p>\n\n<pre><code>Dim DirCurrentArray() As Variant\nDim fileCount As long\n...\n'Gets Filenames into Array\nfileCount = 0\nDo While xFile &lt;&gt; \"\"\n    redim preserve DirCurrentArray(fileCount)\n    DirCurrentArray(fileCount) = xFile\n    fileCount = fileCount + 1\n    xFile = Dir$\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "edited": false, "score": 0, "creation_date": 1530804654, "post_id": 51164300, "comment_id": 89371799, "body": "The issue I&#39;m having is DirCurrentArray is a String Array. Both DirCurrentArray and DirHistoryArray are filenames (e.g. text). I need exact matches.  I&#39;m not familiar enough with how to pull in the filenames to a Variant object so it pulls into DirCurrentArray which is a String array"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530663426, "creation_date": 1530663426, "answer_id": 51164300, "question_id": 51163310, "link": "https://stackoverflow.com/questions/51163310/excel-vba-get-unique-values/51164300#51164300", "title": "Excel VBA Get Unique Values", "body": "<p>Collections are built to lookup unique values.  My code first adds all the values in DirCurrentArray to an ArrayList and then removes all values in DirHistoryArray from the ArrayList.  Finally, it assigns the values in the ArrayList to DirFinalArray.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XXWAX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XXWAX.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub GetUniqueValuesFrom2Arrays()\n    Dim DirCurrentArray As Variant, DirHistoryArray As Variant, DirFinalArray, Key As Variant\n    Dim list As Object\n    Set list = CreateObject(\"System.Collections.ArrayList\")\n\n    Dim i As Long, k As Variant, DirNewArray As Variant\n\n    DirCurrentArray = Array(\"A\", \"B\", \"C\", 1, 2, 3, 4, 5)\n    DirHistoryArray = Array(\"C\", \"D\", 1, 3, 5)\n\n    For Each Key In DirCurrentArray\n        list.Add Key\n    Next\n\n    For Each Key In DirHistoryArray\n        If list.Contains(Key) Then list.Remove Key\n    Next\n\n    DirFinalArray = list.ToArray()\n\n    MsgBox \"DirCurrentArray: \" &amp; Join(DirCurrentArray, \",\") &amp; vbNewLine &amp; _\n        \"DirCurrentArray: \" &amp; Join(DirHistoryArray, \",\") &amp; vbNewLine &amp; _\n        \"DirFinalArray: \" &amp; Join(DirFinalArray, \",\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1530680729, "creation_date": 1530680729, "answer_id": 51166101, "question_id": 51163310, "link": "https://stackoverflow.com/questions/51163310/excel-vba-get-unique-values/51166101#51166101", "title": "Excel VBA Get Unique Values", "body": "<p>I think you can use <code>Dictionary</code> to store, compare and retrieve the array items as per your requirement. </p>\n\n<p>You may try something like this...</p>\n\n<pre><code>Dim dict\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\n'Load DirCurrentArray into dictionary\nFor i = LBound(DirCurrentArray) To UBound(DirCurrentArray)\n    dict.Item(DirCurrentArray(i)) = \"\"\nNext i\n\n'Remove from dictionary if DirHistoryArray elements are found in dictionary\nFor i = LBound(DirHistoryArray) To UBound(DirHistoryArray)\n    If dict.exists(DirHistoryArray(i)) Then dict.Remove (DirHistoryArray(i))\nNext i\n\n'If dictionary is not empty then populate the DirCurrentArray with dictionary keys\nIf dict.Count Then\n    DirCurrentArray = dict.keys\n    MsgBox Join(DirCurrentArray, \", \")\nElse\n    MsgBox \"DirCurrentArray is empty.\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1530682191, "creation_date": 1530682191, "answer_id": 51166345, "question_id": 51163310, "link": "https://stackoverflow.com/questions/51163310/excel-vba-get-unique-values/51166345#51166345", "title": "Excel VBA Get Unique Values", "body": "<p>Check this out</p>\n\n<pre><code>Option Base 1\nSub test()\n\n    Dim DirCurrentArray(5) As Integer\n    Dim DirHistoryArray(5) As Integer\n    Dim DirFinalArray() As Integer\n\n\n    DirCurrentArray(1) = 1\n    DirCurrentArray(2) = 4\n    DirCurrentArray(3) = 5\n    DirCurrentArray(4) = 1\n    DirCurrentArray(5) = 7\n\n\n    DirHistoryArray(1) = 1\n    DirHistoryArray(2) = 2\n    DirHistoryArray(3) = 1\n    DirHistoryArray(4) = 4\n    DirHistoryArray(5) = 1\n\n    Dim blnExist As Boolean\n\n    For Each i In DirCurrentArray\n        For Each j In DirHistoryArray\n\n            If i = j Then\n                blnExist = True\n                Exit For\n            End If\n\n        Next\n\n        If blnExist = False Then\n            finalcount = finalcount + 1\n            ReDim Preserve DirFinalArray(finalcount)\n            DirFinalArray(finalcount) = i\n        End If\n\n        blnExist = False\n    Next\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 2041907, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/574779f6bbce5d7eb32adb955816697c?s=128&d=identicon&r=PG", "display_name": "user2041907", "link": "https://stackoverflow.com/users/2041907/user2041907"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 51163462, "answer_count": 4, "score": 2, "last_activity_date": 1530808070, "creation_date": 1530655046, "last_edit_date": 1530804737, "question_id": 51163310, "link": "https://stackoverflow.com/questions/51163310/excel-vba-get-unique-values", "title": "Excel VBA Get Unique Values", "body": "<p>I have 2 arrays: DirCurrentArray and DirHistoryArray but I can't seem to get the values in DirCurrentArray unique from DirHistoryArray</p>\n\n<pre><code>Dim DirCurrentArray As String\nDim DirHistoryArray As Variant\n\n'Gets Filenames into Array\nDo While xFile &lt;&gt; \"\"\n    DirCurrentArray(fileCount) = xFile\n    xFile = Dir$\n    fileCount = fileCount + 1\nLoop\n\nFor Each i In DirCurrentArray\n        For Each j In DirHistoryArray\n            If i = j Then\n                finalCount = finalCount + 1\n                DirFinalArray(finalCount) = i\n            End If\n        Next j\n    Next i\n</code></pre>\n\n<p>The result I want is the DirCurrentyArray with any values that are found in DirHistoryArray removed</p>\n"}, {"tags": ["vba", "google-drive-api"], "comments": [{"owner": {"reputation": 5995, "user_id": 5995040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wp8l0.png?s=128&g=1", "display_name": "Mr.Rebot", "link": "https://stackoverflow.com/users/5995040/mr-rebot"}, "edited": false, "score": 0, "creation_date": 1530699123, "post_id": 51162810, "comment_id": 89324876, "body": "Please <a href=\"http://stackoverflow.com/posts/43463046/edit\">edit</a> the question to be on-topic: include a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that duplicates the problem. Questions seeking debugging help (&quot;why isn&#39;t this code working the way I want?&quot;) must include: (1) the desired behavior, (2) a specific problem or error and (3) the shortest code necessary to reproduce it in the question itself. Please also see: <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a>, and <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 151, "user_id": 6194416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z7wSz.gif?s=128&g=1", "display_name": "Baud", "link": "https://stackoverflow.com/users/6194416/baud"}, "reply_to_user": {"reputation": 5995, "user_id": 5995040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wp8l0.png?s=128&g=1", "display_name": "Mr.Rebot", "link": "https://stackoverflow.com/users/5995040/mr-rebot"}, "edited": false, "score": 0, "creation_date": 1530707504, "post_id": 51162810, "comment_id": 89330263, "body": "I have edited the question to be more specific on the goal"}], "owner": {"reputation": 151, "user_id": 6194416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z7wSz.gif?s=128&g=1", "display_name": "Baud", "link": "https://stackoverflow.com/users/6194416/baud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530707451, "creation_date": 1530651948, "last_edit_date": 1530707451, "question_id": 51162810, "link": "https://stackoverflow.com/questions/51162810/vba-how-to-convert-a-local-path-of-a-file-in-a-folder-managed-by-drive-file-stre", "title": "VBA-How to convert a local path of a file in a folder managed by Drive File Stream into an URL", "body": "<p>My goal is to create an xls sheet containing a list of files (file name + link to the file) contained in a folder.</p>\n\n<p>This folder is a GDrive synchronized folder (using Drive File Stream)</p>\n\n<p>I have a VBA macro which is producing this list of files but the link is a local link (G:...) and not an URL link (<a href=\"https://drive.google.com/..\" rel=\"nofollow noreferrer\">https://drive.google.com/..</a>.) that can be used outside my computer.</p>\n\n<p>Here is an exemple\nLet say I have a file in my \"Drive File Stream\" folder like this one:</p>\n\n<pre><code>G:\\Team Drives\\Test\\my_file.txt\n</code></pre>\n\n<p>How to convert this path (using excel vba) into a GDrive's URL:</p>\n\n<pre><code>https://drive.google.com/file/d/FILE_ID/edit?usp=sharing\n</code></pre>\n\n<p>Another way to ask is how to get the file_id from a local path?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1530808965, "post_id": 51167293, "comment_id": 89374255, "body": "Also, what is &#39;ns.Logon&#39; doing?"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1530686414, "creation_date": 1530686414, "answer_id": 51167293, "question_id": 51162762, "link": "https://stackoverflow.com/questions/51162762/create-draft-emails-and-save-in-folder-other-than-the-default-drafts-folder/51167293#51167293", "title": "Create draft emails and save in folder other than the default Drafts folder", "body": "<p>Instead of using <code>Application.CreateItemFromTemplate</code>, use <code>MAPIFolder.Items.Add</code>, where <code>MAPIFolder</code> is a folder retrieved from OOM. Assuming that folder is on the same level as the Drafts folder, try something like the following:</p>\n\n<pre><code>set app = CreateObject(\"Outlook.Application\")\nset ns = app.GetNamespace(\"MAPI\")\nns.Logon\nset drafts = ns.GetDefaultFolder(olFolderDrafts)\non error resume next 'the line below can raise an exception if the folder is not found\nset myFolder = drafts.Parent.Folders(\"Reclass\")\nif myFolder Is Nothing Then\n  set myFolder = drafts.Parent.Folders.Add(\"Reclass\")\nend If\nset OutMail = myFolder.Items.Add\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 51167293, "answer_count": 1, "score": 0, "last_activity_date": 1604470259, "creation_date": 1530651691, "last_edit_date": 1604470259, "question_id": 51162762, "link": "https://stackoverflow.com/questions/51162762/create-draft-emails-and-save-in-folder-other-than-the-default-drafts-folder", "title": "Create draft emails and save in folder other than the default Drafts folder", "body": "<p>I have written code that pulls information from an Excel table to an Outlook template.</p>\n<p>I would like two more things.</p>\n<ol>\n<li><p>Instead of saving the emails in &quot;Draft&quot; I would like to make a new folder called &quot;Reclass&quot; and save the unsent emails there.</p>\n</li>\n<li><p>Using a If statement (I think) so only the users (this is a section in my Excel table that I am pulling from for the MailTo part of my email) that have Y in their row (Reclass column in the table has either Y or N in it) will get a email drafted to be sent on a later date.</p>\n<pre><code>Public Enum EmailColumns\n    ecEmailAdresses = 44\n    ecSubject = 43\nEnd Enum\nPublic Sub SaveEmails()\n    Dim r As Long\n    'The With Statement allows the user to &quot;Perform a series of statements on a specified object without specifying the name of the object multiple times&quot;\n    '.Cells(.Row.Count, ecEmailAdresses).End(xlUp).Row actually refers to ThisWorkbook.Worksheets(&quot;Data insert&quot;).Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row\n    With ThisWorkbook.Worksheets(&quot;Report&quot;)\n        '.Cells(): references a cell or range of cells on Worksheets(&quot;Data insert&quot;)\n        '.Cells(.Rows.Count, ecEmailAdresses): References the last cell in column 43 of the worsheet\n        '.End(xlUp): Changes the reference from the last cell to the first used cell above the last cell in column 44\n        '.Cells(.Rows.Count, ecEmailAdressess).End(xlUp).Row: returns the Row number of the last cell column 44\n        For r = 2 To .Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row\n            getPOAccrualTemplate(MailTo:=.Cells(r, ecEmailAdresses), Subject:=.Cells(r, ecSubject)).Save\n        Next\n    End With\n\nEnd Sub\nPublic Function getPOAccrualTemplate(MailTo As String, Optional CC As String, Optional BC As String, Optional Subject As String) As Object\n    Const TEMPLATE_PATH As String = &quot;C:\\Users\\JoeDoe\\Documents\\Project\\Email Template.oft&quot;\n    Dim OutApp As Object, OutMail As Object\n    'CreateObject(&quot;Outlook.Application&quot;): Creates an instance of an Outlook Application.\n    'Outlook.Application.CreatItemFromTemplate returns a new MailItem Based on a saved email Template\n    Set OutMail = CreateObject(&quot;Outlook.Application&quot;).CreateItemFromTemplate(TEMPLATE_PATH)\n\n    With OutMail\n        .To = MailTo\n        .CC = CC\n        .BCC = BC\n        .Subject = Subject\n    End With\n    'Returns the new MailItem to the caller of the function\n    Set getTemplate = OutMail\n\nEnd Function  \n</code></pre>\n</li>\n</ol>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 0, "creation_date": 1530662789, "post_id": 51162734, "comment_id": 89311716, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29528166/ambiguous-name-detected-worksheet-change\">Ambiguous name detected Worksheet_Change</a>"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1530666718, "post_id": 51162734, "comment_id": 89312392, "body": "Welcome! Please look at the possible duplicate question, and see if that answers your problem."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530660404, "post_id": 51163953, "comment_id": 89311267, "body": "Yes, I know you dont have to use the <code>Call</code> line. It just makes it clear what\u2019s happening and gives context, and sometimes that is more important than shortening the character limit of a macro. (Preemptively getting out ahead of the comment I get 9/10 for using <code>Call</code>)"}, {"owner": {"reputation": 3, "user_id": 10028904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5a8bea878189d36a9e310aaf2a909c?s=128&d=identicon&r=PG&f=1", "display_name": "RMau", "link": "https://stackoverflow.com/users/10028904/rmau"}, "edited": false, "score": 0, "creation_date": 1530660820, "post_id": 51163953, "comment_id": 89311340, "body": "thank you so very much, I was trying to break it as some suggested to tackle the &quot;procedure too large&quot; error, but couldn;t tackle how the pass the target value for the worksheet change event. I am going to try your suggestion tomorrow. thanks so much!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 3, "user_id": 10028904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5a8bea878189d36a9e310aaf2a909c?s=128&d=identicon&r=PG&f=1", "display_name": "RMau", "link": "https://stackoverflow.com/users/10028904/rmau"}, "edited": false, "score": 0, "creation_date": 1530661198, "post_id": 51163953, "comment_id": 89311409, "body": "You can also pass parameters into the subs, but that is off-topic as far as how to do that in this question. If you need to pass some variable into your sub (maybe the target address?) you can google that. Pretty straight forward, or you can come back here for help"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1530661413, "last_edit_date": 1530661413, "creation_date": 1530660084, "answer_id": 51163953, "question_id": 51162734, "link": "https://stackoverflow.com/questions/51162734/visual-basic-procedure-too-large-error-ambiguous-name-detected-worksheet-chang/51163953#51163953", "title": "visual basic procedure too large error &amp; ambiguous name detected worksheet_change", "body": "<p>You can only have one <code>WorkSheet_Change</code> event on a worksheet which is why you are getting the <strong>Ambiguous Name Detected</strong> error.  </p>\n\n<p>If your code is too long, try to create your actions in a <code>Sub</code> and then call those subs given certain criteria. This way, you can limit your <code>WorkSheet_Change</code> code to <em>strictly</em> evaluate the <code>Target</code>. </p>\n\n<p>In you <code>WorkSheet_Change</code> code you can have something like: </p>\n\n<pre><code>If Target.Value = \u201cx\u201d Then\n  Call SubX\nElseIF Target.Value = \u201cy\u201d Then\n  Call SubY\nElseIF Target.Value = \u201cz\u201d Then\n  Call SubZ\nEnd IF\n</code></pre>\n\n<hr>\n\n<pre><code>SubX ()\n   \u2018Do Something\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>SubY ()\n   \u2018Do Something\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>SubZ ()\n   \u2018Do Something\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Note:</h2>\n\n<p>You will need to disable events before you make any physical change to your sheet otherwise you will find yourself in a infinite loop and crash your instance of excel. Use the below method to avoid this issue: </p>\n\n<pre><code>Application.EnableEvents = False\n   \u2018Physical changes to worksheet\nApplication.EnableEvents = True\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10028904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5a8bea878189d36a9e310aaf2a909c?s=128&d=identicon&r=PG&f=1", "display_name": "RMau", "link": "https://stackoverflow.com/users/10028904/rmau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 51163953, "answer_count": 1, "score": 0, "last_activity_date": 1530737955, "creation_date": 1530651503, "last_edit_date": 1530737955, "question_id": 51162734, "link": "https://stackoverflow.com/questions/51162734/visual-basic-procedure-too-large-error-ambiguous-name-detected-worksheet-chang", "title": "visual basic procedure too large error &amp; ambiguous name detected worksheet_change", "body": "<p>I have a large VBA macro which consists of one large Private Sub Worksheet_Change(ByVal Target As Range). </p>\n\n<p>It first gives me the procedure too large error as it is really big. </p>\n\n<p>When I tried to break it into 3 Private Sub Worksheet_Change(ByVal Target As Range).  </p>\n\n<p>this error shows up:</p>\n\n<blockquote>\n  <p>ambiguous name detected worksheet_change</p>\n</blockquote>\n\n<p>any clues I can work around these 2 errors?</p>\n\n<p>thanks in advance</p>\n\n<p>here are my codes, the actual codes have tonnes of conditions and text check for each target address</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) \nIf Target.Address = [rng_opt1].Address Then \nIf [rng_opt1] = \"x\" Then \nIf [rng1_1] = \"z\" then \n[rng1_1] = \" \" \nEnd if \nEnd If \nEnd if\nEnd sub\n</code></pre>\n\n<p>thanks to @urdearboy, I got it solved, my final codes is like this (much simplified version). it's tricky and took me a while as my target has defined name</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n On Error GoTo Whoa\n\n    Application.EnableEvents = False\n\n    If Target.Address = [rng_opt1].Address Then\n      Call Opt1(Target)\n    ElseIf Target.Address = [rng1_1].Address Then\n      Call Opt11(Target)\n    End if\n\nLetsContinue:\n    Application.EnableEvents = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume LetsContinue\n\nEnd Sub\n\nSub Opt1(Target As Range)\n\n    If Target.Address = [rng_opt1].Address Then\n           If [rng_opt1] = \"x\" Or [rng_opt1] = \"y\" Then\n              If [rng1_1] = \"z\" \n                   [rng1_1] = \" \"\n              End If\n           End if\n    End if\nEnd Sub\n\nSub Opt11(Target As Range)\n\n    If Target.Address = [rng1_1].Address Then\n      If [rng1_1] = \" \" Then\n        If [rng1_2] = \" \" And [rng1_3] = \" \" And [rng1_4] = \" \" Then\n           [rng1_1] = \"y\"\n           [rng1_2] = \"x\"\n        End If\n      End If\n    End if \n End sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1530687133, "post_id": 51162721, "comment_id": 89317973, "body": "Firstly, you cannot concatenate multiple HTML strings and expect valid HTML. HTML strings must be merged (which can be far from trivial). To get the CC recipients as well, use ReplyAll instead of Reply."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1530708129, "post_id": 51162721, "comment_id": 89330668, "body": "Thank you for the reply Dmitry Streblechenko. Would you mind displaying the code so I can understand what you mean. I am new to VBA :)"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1531251447, "post_id": 51162721, "comment_id": 89523779, "body": "Does anyone know of another forum I could ask this question, as it is time sensitive. Thanks!"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1531253490, "post_id": 51162721, "comment_id": 89524588, "body": "What have you tried and what exactly does not work?"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1531254675, "post_id": 51162721, "comment_id": 89525084, "body": "The furthest I got with this was using the codes lines above. I have tried all that I could find with the knowledge of VBA I have, which is not too experienced (Started about a month ago). In the new code lines I posted, I can&#39;t seem to figure out how to have the email content I want to reply, in the body of the email I am displaying. I have tried (.bodyformat = olformathtml) after (with olMail.ReplyAll) in the new lines of coding. This opens up the email I want to reply to, but I can not input my own custom body."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531266228, "post_id": 51162721, "comment_id": 89528635, "body": "<a href=\"https://stackoverflow.com/a/31818677\">Outlook Reply or ReplyAll to an Email</a> demonstrates how to add to the htmlBody when replying. Ignore the use of vbCrLf it is not proper html. In the update to <a href=\"https://stackoverflow.com/q/36211195\">Outlook Email and Signature from Excel VBA - .Body vs .HTMLbody</a> the OP demonstrates the use of &lt;br&gt; instead of vbCrLf."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1531319757, "post_id": 51162721, "comment_id": 89554160, "body": "Unfortunately that code does not work for me. I have tried it alone as well as combining it with my code and was unsuccessful. All that I can not figure out now is the customized body. I have the line of code &quot; With olMail.ReplyAll      .HTMLBody = &quot;Dear All,&quot; &amp; &quot;&lt;br&gt;&quot; &amp; signature&quot; but it is ignored."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531329582, "post_id": 51162721, "comment_id": 89559896, "body": "@Tmacjoshua that was a hint that you had from Dimitry as well to use all html not some. <code>.HTMLBody = &quot;&lt;p&gt;&quot; &amp; &quot;Dear All, &quot; &amp; &quot;&lt;&#47;p&gt;&lt;br&gt;&quot; &amp; signature &amp; .HTMLBody</code> as well move the <code>.Display</code> inside the With. To respond non-owners of the post in a comment put an @ before the username."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531333556, "post_id": 51162721, "comment_id": 89561689, "body": "@niton your help was much appreciated! That is the solution. If there is another email with the same subject, is there a way to pin point a specific email. In my case, occasionally someone will reply to the email and CC me, causing this macro to reply to that one instead of the one intended."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531339471, "post_id": 51162721, "comment_id": 89564378, "body": "<code>If InStr(olMail.To, &quot;your name as it appears in the To line&quot;) Then</code>"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531418240, "post_id": 51162721, "comment_id": 89600325, "body": "@niton Can you explain what this code does, not quite sure how to use it? The code will be used by numerous people. Is there a way to pin point a specific email if there are numerous emails with the same subject?"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531418906, "post_id": 51162721, "comment_id": 89600679, "body": "@niton to be more clear. My team and I are sent emails once another team completes their work. Sometimes there are questions/changes asked in an email with the same subject but not the same addresses as the first email (the email we reply to). Is there a way for the macro to reply to the specific macro. If not grab all the addresses from all the emails with the specific subject."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531422538, "post_id": 51162721, "comment_id": 89602456, "body": "I suggest then the subsequent subjects would have &quot;Re:&quot; in front of the subject. If this still does not address the issue, try formulating a new question, with applicable code, sample mail..."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531951849, "post_id": 51162721, "comment_id": 89794991, "body": "It occurred to me after all the confusion caused by asking two question in the same post you may want current active item <a href=\"https://stackoverflow.com/questions/4134967/how-do-you-get-a-reference-to-the-mail-item-in-the-current-open-window-in-outloo\" title=\"how do you get a reference to the mail item in the current open window in outloo\">stackoverflow.com/questions/4134967/&hellip;</a> or selecton <a href=\"https://stackoverflow.com/questions/45485283/how-to-save-selected-item-in-outlook-vba\" title=\"how to save selected item in outlook vba\">stackoverflow.com/questions/45485283/&hellip;</a>."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1532021504, "post_id": 51162721, "comment_id": 89828570, "body": "@niton Thankyou. I have one more question adding onto my solution. So the email I have picks of all the recipients, but is it possible to have the CC pick up all the recipients but also be able to add an if then statement to add in additional recipients."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1532033213, "post_id": 51162721, "comment_id": 89833829, "body": "You may post a separate question with adequate explanation and code."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1532035496, "post_id": 51162721, "comment_id": 89834728, "body": "Ok @niton will do thanks. With regards to this question, the email that is being generated is the first email that contains the text input into the specified cell. For example, if I want to reply to the email with the subject &quot;Checklist&quot; it will grab the first email with the word checklist in the subject. Do you know what I should change in the code to have it grab the most recent or a specific email? Your help is much appreciated Niton really."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1558984469, "post_id": 51162721, "comment_id": 99269606, "body": "@DmitryStreblechenko could you take a look at this question please <a href=\"https://stackoverflow.com/questions/56327603/userform-combobox-values-linked-cells-depend-on-all-combobox-values\" title=\"userform combobox values linked cells depend on all combobox values\">stackoverflow.com/questions/56327603/&hellip;</a>"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592950122, "creation_date": 1530651465, "last_edit_date": 1592950122, "question_id": 51162721, "link": "https://stackoverflow.com/questions/51162721/reply-to-a-specific-outlook-email-using-vba-with-a-customized-body-subject", "title": "Reply to a specific Outlook email using VBA with a customized Body/Subject", "body": "<pre><code>Sub Display()\nDim myMail As Outlook.MailItem\nDim myReply As Outlook.MailItem\nDim numItems As Integer\nDim mySelected As Selection\nDim i As Integer\nDim myText As String\nDim signature As String\n\nsignature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\nIf Dir(signature, vbDirectory) &lt;&gt; vbNullString Then\n    signature = signature &amp; Dir$(signature &amp; \"*.htm\")\nElse:\n    signature = \"\"\nEnd If\nsignature = CreateObject(\"Scripting.FileSystemObject\").GetFile(signature).OpenAsTextStream(1, -2).ReadAll\nSet mySelected = Outlook.ActiveExplorer.Selection\nnumItems = mySelected.Count\n\nFor i = 1 To numItems\nSet myMail = mySelected(1)\nSet myReply = myMail.Reply\nmyText = myMail.Body\nmyReply.Subject = \"RO Finalized WF: Annual Review. Entity\"\nmyText = \"Hi All,\" &amp; vbCrLf &amp; vbCrLf &amp; \"Worflow ID:\" &amp; vbCrLf &amp; vbCrLf &amp; \"infoinfoinfoinfo\" &amp; vbCrLf &amp; vbCrLf &amp; \"Thanks,\" &amp; vbCrLf &amp; \"Josh\" &amp; signature\nmyReply.HTMLBody = myText &amp; vbCrLf &amp; vbCrLf &amp; myMail.HTMLBody \nMyreply.display\n  Set myMail = Nothing\n  Set myReply = Nothing\nNext\nSet mySelected = Nothing\nEnd Sub\n</code></pre>\n\n<p>The code above displays a reply to the email you currently have open in Outlook including who sent it (placed in To:) with the whole body of the email you currently have open in Outlook. </p>\n\n<p>This is what I want it to do except instead of replying to the open email, I want it to reply to the email specifically by it's subject. Also I want it to include exactly what all replies include in Outlook (the line separating each email, with the From:, Sent,: To:, CC:, Subject: of the previous email showing). Also vbCrLf is not doing it's purpose after MyText.</p>\n\n<p>I would also like it to place the CC: from the previous email in the CC of the email I am creating.</p>\n\n<p>I am not an expert in VBA and have tried as much as I could think of.\nThank you for the help in advance :) </p>\n\n<p><strong>I have found another option and the code is displayed below.</strong> \nThis will populate a reply email, with everything I need <strong>except</strong> my customized body.</p>\n\n<pre><code>Sub Display()\n\nDim olApp As Outlook.Application\nDim olNs As Namespace\nDim Fldr As MAPIFolder\nDim olMail As Variant\nDim i As Integer\n\nDim IsExecuted As Boolean\n\n signature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\n If Dir(signature, vbDirectory) &lt;&gt; vbNullString Then\n    signature = signature &amp; Dir$(signature &amp; \"*.htm\")\nElse:\n    signature = \"\"\nEnd If\nsignature = CreateObject(\"Scripting.FileSystemObject\").GetFile(signature).OpenAsTextStream(1, -2).ReadAll\nSet olApp = New Outlook.Application\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\nIsExecuted = False\nFor Each olMail In Fldr.Items\nIf InStr(olMail.Subject, \"checklist\") &lt;&gt; 0 Then\nIf Not IsExecuted Then\n        With olMail.ReplyAll\n\n    .HTMLBody = \"Dear All,\" &amp; \"&lt;br&gt;\" &amp; signature\n\n\n        End With\n    IsExecuted = True\n    olmail.ReplyAll.Display\nEnd If\nEnd If\nNext olMail\nEnd Sub\n</code></pre>\n\n<p><strong>Solution</strong> </p>\n\n<pre><code>Sub Display()\nDim olApp As Outlook.Application\nDim olNs As Namespace\nDim Fldr As MAPIFolder\nDim olMail As Variant\nDim i As Integer\nDim IsExecuted As Boolean\nsignature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\nIf Dir(signature, vbDirectory) &lt;&gt; vbNullString Then\nsignature = signature &amp; Dir$(signature &amp; \"*.htm\")\nElse:\nsignature = \"\"\nEnd If\nsignature = CreateObject(\"Scripting.FileSystemObject\").GetFile(signature).OpenAsTextStream(1, -2).ReadAll\nSet olApp = New Outlook.Application\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\n\nIsExecuted = False\nFor Each olMail In Fldr.Items\nIf InStr(olMail.Subject, \"Subject\") &lt;&gt; 0 Then\nIf Not IsExecuted Then\n\n    With olMail.ReplyAll\n\n.HTMLBody = \"&lt;p&gt;\" &amp; \"Dear All,\" &amp; \"&lt;/p&gt;&lt;br&gt;\" &amp; signature &amp; .HTMLBody\n\n.Display\n  End With\nIsExecuted = True\n\n\nEnd If\nEnd If\nNext olMail\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530651268, "post_id": 51162611, "comment_id": 89308679, "body": "You&#39;d have a similar problem if you <code>Shell</code>&#39;d your IE instance, you know."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1530651463, "post_id": 51162611, "comment_id": 89308734, "body": "Look into <a href=\"https://codereview.stackexchange.com/q/168959/23788\">Selenium</a>"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1530812308, "post_id": 51163178, "comment_id": 89375923, "body": "thanks, this seems like the best solution.  Now I just have to figure out how to use Selenium lol.  Already posted a question trying to figure it out."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1530654627, "last_edit_date": 1530654627, "creation_date": 1530654285, "answer_id": 51163178, "question_id": 51162611, "link": "https://stackoverflow.com/questions/51162611/call-document-getelementbyname-when-no-ie-object-is-launched/51163178#51163178", "title": "call .document.getElementByName when no ie object is launched", "body": "<p>Easy if you do the launch via selenium. Much harder if not impossible (haven't yet found a vba method) to attach to an existing browser instance e.g. one launched from command line that is different from that used by the current WebDriver instance.</p>\n\n<p>I am gonna go out on a limb and say that because your commandline stuff is done via <code>Shell</code>, and is only to launch Chrome, then you can simply replace with installing <a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">selenium basic</a>, adding a reference to <code>selenium type library</code> and then using selenium to open Chrome as follows:</p>\n\n<pre><code>Option Explicit\nPublic Sub OpenChromeAndSelect()\n'References to Selenium type library\n    Dim d As WebDriver, el As WebElement\n    Set d = New ChromeDriver\n    Const URL = \"https://clients.mindbodyonline.com/Report/Sales/Sales/Generate?reportID=undefined\"\n    With d\n        .Start \"Chrome\"\n        .get URL\n        Set el = .FindElementById(\"myID\")\n        'Do other stuff\n        '.Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 51163178, "answer_count": 1, "score": 0, "last_activity_date": 1530654627, "creation_date": 1530650807, "last_edit_date": 1531164843, "question_id": 51162611, "link": "https://stackoverflow.com/questions/51162611/call-document-getelementbyname-when-no-ie-object-is-launched", "title": "call .document.getElementByName when no ie object is launched", "body": "<p>I want to launch a browser and click an element that is not accessible through the Tab so I can't SendKeys.  If it were on internet explorer I would try to use the ie.document.getElementByName function but that is not an option because I launched Google Chrome through a shell function (see code below for Chrome launch methodology).  Is there a way to still access html elements when there is no object for .document.getElementByName to invoke?</p>\n\n<pre><code>Dim chromePath As String\nchromePath = \"\"\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\"\"\"\nShell (chromePath &amp; \" -url https://clients.mindbodyonline.com/Report/Sales/Sales/Generate?reportID=undefined\")\n</code></pre>\n"}, {"tags": ["excel", "extended-properties", "vba"], "owner": {"reputation": 471, "user_id": 4682879, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/y4f9X.png?s=128&g=1", "display_name": "MapEngine", "link": "https://stackoverflow.com/users/4682879/mapengine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1757, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530656606, "creation_date": 1530650485, "last_edit_date": 1531164843, "question_id": 51162563, "link": "https://stackoverflow.com/questions/51162563/getting-all-of-a-files-properties-with-vba", "title": "Getting all of a file&#39;s properties with VBA", "body": "<p>I'm trying to read and write a list of properties from files (mainly doc and xls), like Title, Author, Tags or Comments. I can easily get basic attributes, but not these extended ones.</p>\n\n<p><strong>GetDetailsOf</strong> used to work ( <a href=\"https://technet.microsoft.com/en-us/library/ee176615.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://technet.microsoft.com/en-us/library/ee176615.aspx?f=255&amp;MSPPError=-2147217396</a> ) however now it stops dead at index <strong>6</strong>.</p>\n\n<p>According to the Docs ( <a href=\"https://docs.microsoft.com/en-us/windows/desktop/shell/shellfolderitem-extendedproperty\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/shell/shellfolderitem-extendedproperty</a> ) <strong>.ExtendedProperty</strong> is supposed to be able to read attributes, but it doesn't return most of them. For example Author(s), which is even cited as an example in the link above (<em>There are two ways to specify a property. The first is to assign the property's well-known name, such as \"Author\"</em>), returns nothing. </p>\n\n<p>Is there another way?</p>\n\n<p>Test script for a single file:</p>\n\n<pre><code>Sub PrintDocumentProperties()\n\n    With CreateObject(\"Shell.Application\").Namespace(\"D:\\VBA\")\n        MsgBox .GetDetailsOf(.Items.Item(\"derp.xlsm\"), 5) &amp; vbNewLine &amp; _\n         .Items.Item(\"derp.xlsm\").ExtendedProperty(\"Date modified\") &amp; vbNewLine &amp; _\n         .Items.Item(\"derp.xlsm\").ExtendedProperty(\"Type\") &amp; vbNewLine &amp; _\n         .Items.Item(\"derp.xlsm\").ExtendedProperty(\"Size\") &amp; vbNewLine &amp; _\n         .Items.Item(\"derp.xlsm\").ExtendedProperty(\"Author\") &amp; vbNewLine &amp; _\n         .Items.Item(\"derp.xlsm\").ExtendedProperty(\"Authors\")\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qn03f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qn03f.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530650763, "post_id": 51162380, "comment_id": 89308520, "body": "You should indent your code to line up your loops. Will make it easier for you to see what is going on"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530650801, "post_id": 51162380, "comment_id": 89308533, "body": "Your screenshot has no error message... What&#39;s the actual text of the error? (<a href=\"https://stackoverflow.com/posts/51162380/edit\">edit</a> your question to include it!) - that said, unqualified <code>Cells</code> calls are implicit references to <code>ActiveSheet</code>, depending on <i>where</i> that code is written."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530651293, "post_id": 51162380, "comment_id": 89308687, "body": "@MathieuGuindon there is a photo of the error. It just looks like 1 link, but there is really 2 there. Sneaky OP. <code>Run time Error 1004</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530651370, "post_id": 51162380, "comment_id": 89308710, "body": "@urdearboy gah, got it. Fixed."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1530650737, "last_edit_date": 1530650737, "creation_date": 1530650160, "answer_id": 51162497, "question_id": 51162380, "link": "https://stackoverflow.com/questions/51162380/why-do-i-get-this-error-when-exporting-an-excel-file-to-a-csv-with-visual-basics/51162497#51162497", "title": "Why do I get this error when exporting an excel file to a CSV with Visual Basics?", "body": "<h2>You need to qualify your <code>Cells</code> object.</h2>\n\n<hr>\n\n<p>You can do this directly by using <code>Thisworkbook.Sheets(\"Sheet1\").Cells(j-1, 2)</code><br>\n(Hopefully <code>j</code> here is an integer that is properly defined elsewhere in your code)</p>\n\n<hr>\n\n<p>A faster way to do this would be to create a shortcut to your qualification by using: </p>\n\n<pre><code>Dim ws as WorkSheet\nSet ws = Thisworkbook.Sheets(\"Sheet1\")\n</code></pre>\n\n<p>and then reffering to your qualification by using <code>ws.Cells(j-1, 2)</code></p>\n\n<hr>\n\n<p>Another way to do this is use the <code>With</code> block. </p>\n\n<pre><code>Dim ws as WorkSheet\nSet ws = Thisworkbook.Sheets(\"Sheet1\")\n\n    With ws\n        .Cells(j-1, 2)\n    End With\n</code></pre>\n\n<p>or</p>\n\n<pre><code>With Thisworkbook.Sheets(\"Sheet1\")\n    .Cells(j-1, 2)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10028804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84977b29ff589e6498f44ff76b2abe6e?s=128&d=identicon&r=PG&f=1", "display_name": "B Hall", "link": "https://stackoverflow.com/users/10028804/b-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530651361, "creation_date": 1530649589, "last_edit_date": 1530651361, "question_id": 51162380, "link": "https://stackoverflow.com/questions/51162380/why-do-i-get-this-error-when-exporting-an-excel-file-to-a-csv-with-visual-basics", "title": "Why do I get this error when exporting an excel file to a CSV with Visual Basics?", "body": "<p>When the error message appears and I click debug it brings up the code in visual basics which I also have attached.   </p>\n\n<p><img src=\"https://i.stack.imgur.com/fgowz.png\" alt=\"Error Message\"></p>\n\n<p>To fix the problem we have to:<br>\n1.  Backspace the yellow highlighted line to the previous line<br>\n2.  Then return it to the original position. Doing so \u201cmoves\u201d the yellow/error highlight to the next line.<br>\n3.  Continue \u201cpushing\u201d the yellow/error highlight to line 1If CICheck &lt;> \u201cCI\u201d And Cost > 0 Then1<br>\n4.  Re-run program in VBE.<br>\n5.  Close VBE<br>\n6.  Exported <code>CSV</code> should exist in the <code>CSV</code> tab of the original Excel file.</p>\n\n<pre><code> AltContract = Cells(j, 1)\n CICheck = Cells(j, 2)\n\n\nIf Len(AltContract) &gt; 0 Then 'picking CI num between CI group or Alt CI\n    SetContract = AltContract\n\nElse 'no alt contract\n\n    For i = 1 To 1000 'loop to set CI from above\n    If Cells(j - i, 2) = \"CI\" Then '&lt;~~~ ERRROR HERE\n    BillDsc = Cells(j - i, 7)\n    BillGrp = Cells(j - i, 6)\n        Exit For\n    End If\n    Next\nEnd If\n\n\nIf CICheck &lt;&gt; \"CI\" And Cost &gt; 0 Then\n\n\nDo Until Cells(j + i, 2) &lt;&gt; \"CI\"\n\n    If Len(Cells(j + i, 1)) &gt; 0 Then GoTo NextIteration\n\n   i = i + 1\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010", "excel-2007"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1530650045, "post_id": 51162375, "comment_id": 89308264, "body": "Your variables do not match with the variables you set, Values Vs Value."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1530650062, "post_id": 51162375, "comment_id": 89308273, "body": "<code>Search</code> does not exist in vba, use <a href=\"https://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow noreferrer\">instr</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1530650157, "post_id": 51162375, "comment_id": 89308309, "body": "actually use: <code>x=split(Values,&quot;|&quot;)(1)</code> to return the value between the first and second <code>|</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1530650393, "post_id": 51162375, "comment_id": 89308391, "body": "The VBE should be highlighting precisely what&#39;s wrong with your code. Is <code>Option Explicit</code> specified at the top of the module?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1530651149, "creation_date": 1530651149, "answer_id": 51162668, "question_id": 51162375, "link": "https://stackoverflow.com/questions/51162375/vba-sub-or-function-not-defined-compiler-error-while-using-search/51162668#51162668", "title": "VBA : Sub or Function Not Defined Compiler Error While Using Search", "body": "<p>Search is a worksheet function.  It's equivilent in vba is Instr.</p>\n\n<p>But in this case using Split will return what you want with less effort:</p>\n\n<pre><code>Dim Values As String    \nDim x As String\n\nValues = Worksheets(\"Pivot\").Range(\"B3\").Value \n\nx=split(Values,\"|\")(1)\n\nMsgBox \"\" &amp; x\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 7799875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3ed928c84daf4d7c711fa8d08d761e?s=128&d=identicon&r=PG&f=1", "display_name": "avik", "link": "https://stackoverflow.com/users/7799875/avik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530652098, "creation_date": 1530649544, "last_edit_date": 1530649789, "question_id": 51162375, "link": "https://stackoverflow.com/questions/51162375/vba-sub-or-function-not-defined-compiler-error-while-using-search", "title": "VBA : Sub or Function Not Defined Compiler Error While Using Search", "body": "<p>I am very much stuck , i tied searching but i am not getting satisfactory solution  </p>\n\n<h3>Below is my code</h3>\n\n<pre><code>Dim i As Integer    \nDim k As Integer    \nDim Values As String    \nDim x As String\n\nWorksheets(\"Pivot\").Activate\n\nValues = Range(\"B3\").Value    \n'Values = Mid(Values, 5, 16)    \n'k = Search(\"|\", Values)\n\nx = Mid(Value, Search(\"|\", Value) + 1, Search(\"|\", Value, Search(\"|\", Value) + 1) - Search(\"|\", Value) - 1)))\n\nMsgBox \"\" &amp; x\n</code></pre>\n\n<h3>Note :</h3>\n\n<p>The Error is \"Sub or Function not defined \" , I am getting this compiler error only if i use search formula , when i use Mid formula (the one that is commented i am not getting the error \" anyone has any solution that can help me . \nIn the Code i am trying to extract the string contained in a cell between occurrence of \"|\" contained in the entire string in the  cell .</p>\n"}, {"tags": ["vba", "vbscript", "hp-uft", "uft14"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10028672, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uA6anXuHn5g/AAAAAAAAAAI/AAAAAAAAAAc/XnFLCNot63o/photo.jpg?sz=128", "display_name": "Antonio Barazarte", "link": "https://stackoverflow.com/users/10028672/antonio-barazarte"}, "edited": false, "score": 0, "creation_date": 1530650680, "post_id": 51162405, "comment_id": 89308490, "body": "Thanks for your help Tomalak! God bless you!"}], "tags": [], "owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_accepted": true, "score": 3, "last_activity_date": 1530649712, "creation_date": 1530649712, "answer_id": 51162405, "question_id": 51162248, "link": "https://stackoverflow.com/questions/51162248/uft-14-00-how-to-use-a-property-of-function-in-different-actions/51162405#51162405", "title": "UFT 14.00 how to use a property of function in different actions", "body": "<p>You forgot <code>Set</code>.</p>\n\n<pre><code>Set Stream = fso.CreateTextFile(\"C:\\Users\\HCCMD\\Documents\\test.txt\")\nSet Escrito = Stream\n</code></pre>\n\n<p>Or, easier</p>\n\n<pre><code>Set Escrito = fso.CreateTextFile(\"C:\\Users\\HCCMD\\Documents\\test.txt\")\n</code></pre>\n\n<p>Also see: <a href=\"https://stackoverflow.com/q/349613/18771\">What does the keyword Set actually do in VBA?</a> (applies to VBScript as well)</p>\n"}], "owner": {"reputation": 81, "user_id": 10028672, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uA6anXuHn5g/AAAAAAAAAAI/AAAAAAAAAAc/XnFLCNot63o/photo.jpg?sz=128", "display_name": "Antonio Barazarte", "link": "https://stackoverflow.com/users/10028672/antonio-barazarte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 51162405, "answer_count": 1, "score": 2, "last_activity_date": 1530902504, "creation_date": 1530648858, "last_edit_date": 1530902504, "question_id": 51162248, "link": "https://stackoverflow.com/questions/51162248/uft-14-00-how-to-use-a-property-of-function-in-different-actions", "title": "UFT 14.00 how to use a property of function in different actions", "body": "<p>I have this problem in UFT/QTP 14.00. I want use a property from a function to write a log file, but return this error when run the action.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ogwiZ.png\" rel=\"nofollow noreferrer\">Error message: Object doesn't support property or method</a></p>\n\n<p>Here is my code: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function Escrito\n    'Function in VBS\n    'Habilitamos la creacion y modificacion de archivos\n        'Enable Create and update files\n     Set fso=createobject(\"Scripting.FileSystemObject\")\n     set Stream = fso.CreateTextFile(\"C:\\Users\\HCCMD\\Documents\\test.txt\")\n     Escrito = Stream\nEnd Function\n</code></pre>\n\n<p>I want use <code>Escrito().write \"Hola mundo\"</code> for example.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1530652045, "last_edit_date": 1530652045, "creation_date": 1530649472, "answer_id": 51162360, "question_id": 51161917, "link": "https://stackoverflow.com/questions/51161917/hide-rows-in-excel-based-off-multiple-column-value/51162360#51162360", "title": "Hide rows in Excel based off multiple column value", "body": "<p>I saw your other post, and I don't really think this is the way you should go about building your dashboard. You are essentially creating a copy of your other sheet. It seems like an <code>Advance Filter</code> would be better suited here. </p>\n\n<p>If you are set on your current method, this will determine lowest used cell in your columns, and hide rows above that cell based on your criteria. I would add a command button named something like <strong>\"Refresh My Dash\"</strong> and link it to this macro. </p>\n\n<pre><code>Option Explicit\n\nSub HideRow()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim LRowC, LRowD, LRowF, LRowH, LRow As Long\n    LRowC = ws.Range(\"C\" &amp; ws.Rows.Count).End(xlUp).Row\n    LRowD = ws.Range(\"D\" &amp; ws.Rows.Count).End(xlUp).Row\n    LRowF = ws.Range(\"F\" &amp; ws.Rows.Count).End(xlUp).Row\n    LRowH = ws.Range(\"H\" &amp; ws.Rows.Count).End(xlUp).Row\n    LRow = Application.WorksheetFunction.Max(LRowC, LRowD, LRowF, LRowH)\n\nDim i As Long\n\nApplication.ScreenUpdating = False\nws.Rows.Hidden = False\n    For i = LRow To 2 Step -1\n        If ws.Range(\"C\" &amp; i).Text = \"\" And ws.Range(\"D\" &amp; i).Text = \"\" And ws.Range(\"F\" &amp; i).Text = \"\" And ws.Range(\"H\" &amp; i).Text = \"\" Then\n            ws.Rows(i).EntireRow.Hidden = True\n        End If\n    Next i\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 51162360, "answer_count": 1, "score": -2, "last_activity_date": 1530652045, "creation_date": 1530647239, "last_edit_date": 1531161705, "question_id": 51161917, "link": "https://stackoverflow.com/questions/51161917/hide-rows-in-excel-based-off-multiple-column-value", "title": "Hide rows in Excel based off multiple column value", "body": "<p>How can I hide rows based off multiple column values? Example: If the \"Projects\", \"Team Member\", \"Priority\", &amp; \"Status\" fields are all blank, then the row will hide itself.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Gb9vK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gb9vK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530645351, "post_id": 51161134, "comment_id": 89306476, "body": "Have you tried <code>.Sort.Apply</code>? That said your life would be much easier if you worked with a <code>ListObject</code> aka &quot;table&quot; - if your data is laid out in rows &amp; columns, consider &quot;format as table&quot; and then you don&#39;t need to work out what the <code>Range</code> is, just get the table by name; the <code>DataBodyRange</code> gets you the <code>Range</code> for the table&#39;s body, <code>ListRows</code> lets you iterate the rows, etc."}, {"owner": {"reputation": 93, "user_id": 9700724, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GSIvnYFb2pw/AAAAAAAAAAI/AAAAAAAAHoo/3ULpSXRsKP8/photo.jpg?sz=128", "display_name": "Jose Cortez", "link": "https://stackoverflow.com/users/9700724/jose-cortez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530645578, "post_id": 51161134, "comment_id": 89306557, "body": "@mathieu guindon where would I place that code?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530646245, "post_id": 51161134, "comment_id": 89306799, "body": "I&#39;ve no idea - it&#39;s very unclear where &amp; how your current sorting is invoked. If you want to re-apply the current sorting after a click on [Save Client Data], then that&#39;s where it goes..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530646631, "post_id": 51161134, "comment_id": 89306937, "body": "Oh, just realized <code>.Sort</code>  <i>as a property</i> is a member of <code>ListObject</code>. Hold on, answer on the way."}, {"owner": {"reputation": 93, "user_id": 9700724, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GSIvnYFb2pw/AAAAAAAAAAI/AAAAAAAAHoo/3ULpSXRsKP8/photo.jpg?sz=128", "display_name": "Jose Cortez", "link": "https://stackoverflow.com/users/9700724/jose-cortez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530647162, "post_id": 51161134, "comment_id": 89307131, "body": "@mathieu guindon thanks"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 93, "user_id": 9700724, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GSIvnYFb2pw/AAAAAAAAAAI/AAAAAAAAHoo/3ULpSXRsKP8/photo.jpg?sz=128", "display_name": "Jose Cortez", "link": "https://stackoverflow.com/users/9700724/jose-cortez"}, "edited": false, "score": 0, "creation_date": 1530663415, "post_id": 51161978, "comment_id": 89311856, "body": "@Jose my pleasure! I&#39;ve added something to address the fact that column names are &quot;magic strings&quot; in the code, prone to typos - with an enum you get intellisense for it, compiler-enforced with <code>Option Explicit</code> =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1530663277, "last_edit_date": 1530663277, "creation_date": 1530647498, "answer_id": 51161978, "question_id": 51161134, "link": "https://stackoverflow.com/questions/51161134/repeat-active-filter-after-userform-entry/51161978#51161978", "title": "Repeat Active Filter After Userform Entry", "body": "<p>The little code you've shown is very redundant - by making the hard-coded <code>Key1</code> sort argument a parameter, you instantly remove the need for two of these three clones, and repurpose the third to do the job for all three. </p>\n\n<p>Sorting and applying a sort, is something very easy to do when your range is a <code>ListObject</code> aka \"table\". Take your range, select \"format as table\" from the Home Ribbon. Now you never need to work out the last row ever again.</p>\n\n<p>Also, if the <code>wss(w)</code> sheet exists in <code>ThisWorkbook</code> at compile-time, there's no reason to dereference it from the <code>Worksheets</code> collection - just use its <em>code name</em> identifier (you can change it by selecting the sheet in the <em>Project Explorer</em> / Ctrl+R, then changing its <code>(Name)</code> property in the <em>Properties</em> toolwindow / F4) - then you can do <code>TheSheetName.Range(\"whatever\")</code>. Or better - since that code only ever needs to work on a specific sheet, <em>put it in that sheet's code-behind</em>, and use <code>Me</code> to refer to the <code>Worksheet</code> instance:</p>\n\n<pre><code>Public Sub ApplySortOrder(Optional ByVal sortColumn As String = vbNullString)\n\n    With Me.ListObjects(1)\n\n        Dim sortColumnRange As Range\n        If sortColumn &lt;&gt; vbNullString Then\n            'assumes sortColumn is an existing column header\n            Set sortColumnRange = .ListColumns(sortColumn).DataBodyRange\n        End If\n        With .Sort\n            If Not sortColumnRange Is Nothing Then\n                .SortFields.Clear\n                .SortFields.Add sortColumnRange\n            End If\n            .Apply\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Now, assuming I got the assumed column headings right, the code you have that's calling <code>depositbalance</code> can look like this:</p>\n\n<pre><code>TheSheetName.ApplySortOrder \"DepositBalance\"\n</code></pre>\n\n<p>Sorting by <code>contactdate</code> would be this:</p>\n\n<pre><code>TheSheetName.ApplySortOrder \"ContactDate\"\n</code></pre>\n\n<p>Sorting by <code>creditbalance</code>:</p>\n\n<pre><code>TheSheetName.ApplySortOrder \"CreditBalance\"\n</code></pre>\n\n<p>And if you want to re-apply the current sorting:</p>\n\n<pre><code>TheSheetName.ApplySortOrder\n</code></pre>\n\n<p>And the day you need to sort by something else, you can just do:</p>\n\n<pre><code>TheSheetName.ApplySortOrder \"ThatFancyNewColumn\"\n</code></pre>\n\n<p>And be done with it, without needing to copy-paste yet another procedure.</p>\n\n<p>You could even declare a <code>Public Enum</code> for the valid columns...</p>\n\n<pre><code>Public Enum SortingColumn\n    Current = 0\n    CreditBalance = 97\n    DepositBalance = 68\n    ContactDate = 2\nEnd Enum\n</code></pre>\n\n<p>Then change the signature to accept a <code>SortingColumn</code> parameter:</p>\n\n<pre><code>Public Sub ApplySortOrder(Optional ByVal sortColumn As SortingColumn = Current)\n\n    With Me.ListObjects(1)\n\n        Dim sortColumnRange As Range\n        If sortColumn &lt;&gt; Current Then\n            'assumes sortColumn is an existing column header\n            Set sortColumnRange = .ListColumns(sortColumn).DataBodyRange\n        End If\n        With .Sort\n            If Not sortColumnRange Is Nothing Then\n                .SortFields.Clear\n                .SortFields.Add sortColumnRange\n            End If\n            .Apply\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Or even better, leave out the explicit enum values, and map each value to a string column name - then write a function that gets you the <code>ListColumn.Index</code> for it, so the user can't rename the headings, but they can still move these 90-something columns as they please. ...but that's for another post I guess.</p>\n"}], "owner": {"reputation": 93, "user_id": 9700724, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GSIvnYFb2pw/AAAAAAAAAAI/AAAAAAAAHoo/3ULpSXRsKP8/photo.jpg?sz=128", "display_name": "Jose Cortez", "link": "https://stackoverflow.com/users/9700724/jose-cortez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 51161978, "answer_count": 1, "score": 1, "last_activity_date": 1530663277, "creation_date": 1530643379, "question_id": 51161134, "link": "https://stackoverflow.com/questions/51161134/repeat-active-filter-after-userform-entry", "title": "Repeat Active Filter After Userform Entry", "body": "<p>I have a macro that sorts clients based off of \"Contact Dates\", \"Deposits\", and \"Credit\". Say I select to sort by \"Contact Date\" and then I add a new client to my list, how would can I have the <strong>active</strong> sort re-run after I have entered a new client from my user form?</p>\n\n<blockquote>\n  <p>Userform I use to add client data</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/BzGG0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BzGG0.png\" alt=\"UserForm I use to enter Data\"></a></p>\n\n<blockquote>\n  <p>Filter Options</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/Cx3Zd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cx3Zd.png\" alt=\"Filter Options\"></a></p>\n\n<p>Here is my code:</p>\n\n<blockquote>\n  <p>Credit Balance Sort</p>\n</blockquote>\n\n<pre><code>Sub creditbalance()\n\n    Dim w As Long, lr As Long, wss As Variant\n\n    wss = Array(\"contactunder\")\n\n\n    For w = LBound(wss) To UBound(wss)\n        With ThisWorkbook.Worksheets(wss(w))\n            lr = Application.Max(.Cells(.Rows.Count, \"a\").End(xlUp).Row, _\n                                 .Cells(.Rows.Count, \"da\").End(xlUp).Row)\n            With .Range(.Cells(10, \"a\"), .Cells(lr, \"da\"))\n                .Cells.Sort Key1:=.Columns(97), Order1:=xlDescending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes\n            End With\n        End With\n    Next w\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Contact Date Sort</p>\n</blockquote>\n\n<pre><code>Sub contactdate()\n    Dim w As Long, lr As Long, wss As Variant\n\n    wss = Array(\"contactunder\")\n\n\n    For w = LBound(wss) To UBound(wss)\n        With ThisWorkbook.Worksheets(wss(w))\n            lr = Application.Max(.Cells(.Rows.Count, \"a\").End(xlUp).Row, _\n                                 .Cells(.Rows.Count, \"da\").End(xlUp).Row)\n            With .Range(.Cells(10, \"a\"), .Cells(lr, \"da\"))\n                .Cells.Sort Key1:=.Columns(2), Order1:=xlDescending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes\n            End With\n        End With\n    Next w\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Deposit Balance Sort</p>\n</blockquote>\n\n<pre><code>Sub depositbalance()\n    Dim w As Long, lr As Long, wss As Variant\n\n    wss = Array(\"contactunder\")\n\n\n    For w = LBound(wss) To UBound(wss)\n        With ThisWorkbook.Worksheets(wss(w))\n            lr = Application.Max(.Cells(.Rows.Count, \"a\").End(xlUp).Row, _\n                                 .Cells(.Rows.Count, \"da\").End(xlUp).Row)\n            With .Range(.Cells(10, \"a\"), .Cells(lr, \"da\"))\n                .Cells.Sort Key1:=.Columns(68), Order1:=xlDescending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes\n            End With\n        End With\n    Next w\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "database", "string", "vba", "edit"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9836855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57581b511d63706521e3c827c6d65518?s=128&d=identicon&r=PG&f=1", "display_name": "Ugo", "link": "https://stackoverflow.com/users/9836855/ugo"}, "edited": false, "score": 0, "creation_date": 1530651778, "post_id": 51161188, "comment_id": 89308832, "body": "Thanks but the problem is that &quot;The Boss&quot; wants me to develop a macro to achieve it. He wants a shiny button that can do it automatically. I just need to understand how i can work with strings in that way.  Thanks again for your help my friend."}], "tags": [], "owner": {"reputation": 17, "user_id": 8825081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70309a63734481e7e06e95118f1bfb6b?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Adams", "link": "https://stackoverflow.com/users/8825081/ken-adams"}, "is_accepted": false, "score": 0, "last_activity_date": 1530643665, "creation_date": 1530643665, "answer_id": 51161188, "question_id": 51161092, "link": "https://stackoverflow.com/questions/51161092/macro-to-edit-strings-and-write-them-on-other-sheet/51161188#51161188", "title": "Macro to edit strings and write them on other sheet", "body": "<p>well, you don't exactly need programming to achieve this. This is achievable using formulas in both Excel and Google Sheets. <strong>Substitute</strong> formula will remove the '-' and concatenate formula in combination with <strong>IF</strong> and <strong>ROW</strong> will add the '_PV'. <strong>Arrayformula</strong> on top of these other formulas will do this calculation in the entire column without having to drag-down the formula each time.</p>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 0, "last_activity_date": 1530650768, "last_edit_date": 1530650768, "creation_date": 1530650457, "answer_id": 51162559, "question_id": 51161092, "link": "https://stackoverflow.com/questions/51161092/macro-to-edit-strings-and-write-them-on-other-sheet/51162559#51162559", "title": "Macro to edit strings and write them on other sheet", "body": "<p>Untested, written on mobile, but maybe something like this. I assume that your data (excluding column headers/names) begins in cell A2 on a sheet called 'Source' -- and that the data is column A is contiguous.</p>\n\n<p>Save a copy of your workbook before running code, as code will try to overwrite data on sheet 'Template' (assuming it exists).</p>\n\n<pre><code>Option Explicit\n\nSub FillTemplateSheet()\n\nWith Thisworkbook\n\n' Change this to whatever sheet your data is on and change cell reference to the first tag name (excluding header) '\nWith .worksheets(\"Source\").range(\"A2\")\n\nDim lastRow as long\nlastRow = .end(xldown).row ' This is not the best way to find the last row, but might work in your use case '\n\nDim arrayOfValues() as variant\narrayOfValues = .resize(lastRow - .row+1, 4).value2 ' Assumes we want the first four columns '\n\nEnd with\n\nDim rowIndex as long\nDim columnIndex as long\nDim alteredTagName as string\n\n' Appending PV and PB to each tag name means we basically need twice as many body rows in the output.'\n\nDim outputArray() as variant\nRedim outputArray(lbound(arrayOfValues,1) to (ubound(arrayOfValues,1)*2), lbound(arrayOfValues,2) to ubound(arrayOfValues,2))\n\nFor rowIndex = lbound(arrayOfValues,1) to ubound(arrayOfValues,1)\n\nFor columnIndex = lbound(arrayOfValues,2) to ubound(arrayOfValues,2)\n\nIf columnIndex &lt;&gt; 1 then\n' d) copy all other attributes to outputArray'\n\noutputArray(rowIndex, columnIndex) = arrayOfValues(rowIndex,columnIndex)\n\noutputArray(rowIndex+1, columnIndex) = arrayOfValues(rowIndex,columnIndex)\n\nElse\n\nalteredTagName = arrayOfValues(rowIndex,columnIndex) \n\n'a) get rid of all - '\nalteredTagName = vba.strings.join(VBA.strings.split(alteredTagName,\"-\",-1,vbbinarycompare),vbnullstring)\n\n'b) write to output array '\n'c) append PV and PB '\n\noutputArray(rowIndex, columnIndex) = alteredTagname &amp; \"_PV\"\n\noutputArray (rowIndex +1, columnIndex) = alteredTagName &amp; \"_PB\"\n\nEnd if\n\nNext columnIndex\n\nNext rowIndex\n\nEnd with\n\n' Assumes headers are on row 1 of sheet Template, and therefore first tag name will be in cell A2'\n.worksheets(\"Template\").range(\"A2\").resize(ubound(outputArray,1),ubound(outputArray,2)).value2 = outputArray\n\nEnd with\n\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9836855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57581b511d63706521e3c827c6d65518?s=128&d=identicon&r=PG&f=1", "display_name": "Ugo", "link": "https://stackoverflow.com/users/9836855/ugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 51162559, "answer_count": 2, "score": 0, "last_activity_date": 1530650768, "creation_date": 1530643210, "question_id": 51161092, "link": "https://stackoverflow.com/questions/51161092/macro-to-edit-strings-and-write-them-on-other-sheet", "title": "Macro to edit strings and write them on other sheet", "body": "<p>I'm a noob at programing and i'm having a hard time trying to figure out how could i accomplish my task.</p>\n\n<p>I Have a template sheet that is organized in a way that after it has been filled, it will be converted to \".csv\" and then imported to a program do build a database.</p>\n\n<p>And i have another Sheet with some the data i need and some that i dont need. \nThe first column i want to read is the \"Tag Names\" that follows this model above:</p>\n\n<p>TAG NAMES        /// LOW   /// HIGH /// ELU</p>\n\n<p>80-PIT-0001    ///   0    ///  1   ///  C</p>\n\n<p>32-XI-004B     ///   1    ///  0   ///  C</p>\n\n<p>45-CIT-4001    ///   0    ///  1   ///  D</p>\n\n<p>I need to get all these tags and:</p>\n\n<p>a) remove the \"-\" from tag names\nb) write the tag names without \"-\" in the template sheet\nc) when writing it to the template sheet it has to add \"_PV\" and \"_PB\" at the end of the tag name. Each one need to be in a difrent line.\nd) All attributes need to be copied aswell</p>\n\n<p>Just like this: </p>\n\n<p>80PIT0001_PV    ///   0    ///  1   ///  C</p>\n\n<p>80PIT0001_PB    ///   0    ///  1   ///  C</p>\n\n<p>32XI004B_PV    ///   1    ///  0   ///  C</p>\n\n<p>32XI004B_PB    ///   1    ///  0   ///  C</p>\n\n<p>45CIT4001_PV   ///   0    ///  1   ///  D</p>\n\n<p>45CIT4001_PB   ///   0    ///  1   ///  D</p>\n\n<p>If somebody could give me a light on how to manipulate and edit properly these strings and how to write these to a new sheet, in my case, the template sheet.</p>\n\n<p>I Really Thanks anyone that would try to help me.</p>\n"}, {"tags": ["excel", "stored-procedures", "oraoledb", "vba"], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1531237715, "post_id": 51261555, "comment_id": 89517192, "body": "I always use Option Explicit Just posted the relevant code for the Oracle Function :)"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1531238833, "last_edit_date": 1531238833, "creation_date": 1531214437, "answer_id": 51261555, "question_id": 51160897, "link": "https://stackoverflow.com/questions/51160897/run-stored-procedure-via-oraoledb/51261555#51261555", "title": "Run Stored Procedure via OraOLEDB", "body": "<p>Assuming that your connection is correct and you want to get only the output var as result, you don't need any Recordset variable (and if execute returns a recordset, it will create it for you).</p>\n\n<p>I found some things to correct, after that I could successfully execute your code</p>\n\n<ul>\n<li>Even if <code>p_valid_flag</code>, you have to set a value. </li>\n<li>The proc is called without the <code>?</code>-placeholder.</li>\n</ul>\n\n<p>Just an advice (not related to your actual problem): Declare you variables and use <code>Option Explicit</code></p>\n\n<pre><code> Set pCommand = New ADODB.Command\n With pCommand\n\n    Set .ActiveConnection = pConnection\n    .CommandType = adCmdStoredProc\n\n    Set p_Segment1 = .CreateParameter(\"p_segment1\", adVarChar, adParamInput, 25, \"code segment here\")\n    ...\n    Set p_Valid_Flag = .CreateParameter(\"p_valid_flag\", adVarChar, adParamInputOutput, 1, \"\")\n\n    .Parameters.Append p_Segment1\n    ...\n    .Parameters.Append p_Valid_Flag\n\n    .CommandText = \"apps.key_validate_gl_code_comb\"\n    .Execute\n    Debug.Print \"--&gt;\" &amp; p_Valid_Flag.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531238833, "creation_date": 1530642406, "last_edit_date": 1531164843, "question_id": 51160897, "link": "https://stackoverflow.com/questions/51160897/run-stored-procedure-via-oraoledb", "title": "Run Stored Procedure via OraOLEDB", "body": "<p>I have the following stored procedure that I have to call from VBA. </p>\n\n<pre><code>declare\n    p_segment1 varchar(25);\n    p_segment2 varchar(25);\n    p_segment3 varchar(25);\n    p_segment4 varchar(25);\n    p_segment5 varchar(25);\n    p_valid_flag varchar(1);\nbegin\n    p_segment1 := 'code segment here';\n    p_segment2 := 'code segment here';\n    p_segment3 := 'code segment here';\n    p_segment4 := 'code segment here';\n    p_segment5 := 'code segment here';\n\n    apps.key_validate_gl_code_comb(p_segment1, p_segment2, p_segment3, p_segment4, p_segment5, p_valid_flag);\n    dbms_output.put_line('Flag: ' || p_valid_flag);\nend;\n</code></pre>\n\n<p>I need to call this procedure in VBA from Excel, but I am getting an error message by running the following code:</p>\n\n<pre><code>    Set pCommand = New Command\n    Set pProcedureRecordset = New Recordset\n    With pCommand\n        Set .ActiveConnection = pConnection\n        .CommandType = adCmdStoredProc\n        Set p_Segment1 = .CreateParameter(\"p_segment1\", adVarChar, adParamInput, 25, 'code segment here')\n        Set p_Segment2 = .CreateParameter(\"p_segment2\", adVarChar, adParamInput, 25, 'code segment here')\n        Set p_Segment3 = .CreateParameter(\"p_segment3\", adVarChar, adParamInput, 25, 'code segment here')\n        Set p_Segment4 = .CreateParameter(\"p_segment4\", adVarChar, adParamInput, 25, 'code segment here')\n        Set p_Segment5 = .CreateParameter(\"p_segment5\", adVarChar, adParamInput, 25, 'code segment here')\n        Set p_Valid_Flag = .CreateParameter(\"p_valid_flag\", adVarChar, adParamInputOutput, 1)\n        .Parameters.Append p_Segment1\n        .Parameters.Append p_Segment2\n        .Parameters.Append p_Segment3\n        .Parameters.Append p_Segment4\n        .Parameters.Append p_Segment5\n        .Parameters.Append p_Valid_Flag\n        .CommandText = \"apps.key_validate_gl_code_comb(?,?,?,?,?,?)\"\n        Set pProcedureRecordset = .Execute\n    End With\n</code></pre>\n\n<p>When I run this in SQL Developer, I get the desired output, but when I run it from VBA I get an <code>Unspecified Error</code> message.</p>\n\n<p>How can I call a stored procedure from VBA to get an output?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530642133, "post_id": 51160814, "comment_id": 89305079, "body": "Could you please go back over your Q&#39;s title and narrative to decide whether you are speaking os a row or column?"}, {"owner": {"reputation": 13, "user_id": 10028357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eecea4f0cf8e8ba19c186b91c5ab101?s=128&d=identicon&r=PG&f=1", "display_name": "Jav171", "link": "https://stackoverflow.com/users/10028357/jav171"}, "edited": false, "score": 0, "creation_date": 1530709213, "post_id": 51160814, "comment_id": 89331367, "body": "Have done. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10028357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eecea4f0cf8e8ba19c186b91c5ab101?s=128&d=identicon&r=PG&f=1", "display_name": "Jav171", "link": "https://stackoverflow.com/users/10028357/jav171"}, "edited": false, "score": 0, "creation_date": 1530726264, "post_id": 51171181, "comment_id": 89340112, "body": "Thank you. That has allowed me to add the column I need. With the formula how can I get it to loop so it works for every cell where there is a value. Currently it will apply to the top cell only and then stop. My data set is approx 6000 lines long."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 1, "last_activity_date": 1530699170, "creation_date": 1530699170, "answer_id": 51171181, "question_id": 51160814, "link": "https://stackoverflow.com/questions/51160814/vba-code-to-insert-column-and-formula/51171181#51171181", "title": "VBA code to insert column and formula", "body": "<p>For Insertion locate the cell and issue: </p>\n\n<pre><code>If Not A Is Nothing Then A.EntireColumn.Insert\n</code></pre>\n\n<p>To insert a formula, use <code>cell.formula=</code> with the coresponding string value, e.g.</p>\n\n<pre><code>Cells(1, A.column - 1).Formula = \"=max(\" &amp; cells(9, A.column - 2).Address &amp; \",0)\" \n</code></pre>\n\n<p>Note A as a range of the found value will shift to the right when inserting a column that's why you need <code>- 1</code> nad <code>- 2</code> in cell references. </p>\n"}], "owner": {"reputation": 13, "user_id": 10028357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eecea4f0cf8e8ba19c186b91c5ab101?s=128&d=identicon&r=PG&f=1", "display_name": "Jav171", "link": "https://stackoverflow.com/users/10028357/jav171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3785, "favorite_count": 0, "accepted_answer_id": 51171181, "answer_count": 1, "score": 0, "last_activity_date": 1530709199, "creation_date": 1530642026, "last_edit_date": 1530709199, "question_id": 51160814, "link": "https://stackoverflow.com/questions/51160814/vba-code-to-insert-column-and-formula", "title": "VBA code to insert column and formula", "body": "<p>I have a file where I need to delete certain columns. I then need to insert a column called 'positive values' and add a formula so that only the positive values from another column are picked up in this new column.</p>\n\n<p>So far I have pieced together the following code to delete the columns I do not need, but I am stuck at how to insert a new column next to an existing column called \"net\" and then have this column only show the positive values from column net in the relevant cells.</p>\n\n<p><strong>Current code</strong></p>\n\n<pre><code>Sub ArrayLoop()\n  Dim ColumnsToRemove As Variant\n  Dim vItem As Variant\n  Dim A As Range\n\n  Sheets(\"sheet 1\").Select\n\n  ColumnsToRemove = Array(\"acronym\", \"valueusd\", \"value gbp\")\n  For Each vItem In ColumnsToRemove\n    Set A = Rows(8).Find(What:=vItem, LookIn:=xlValues, lookat:=xlPart)\n    Debug.Print vItem, Not A Is Nothing\n\n    If Not A Is Nothing Then A.EntireColumn.Delete\n  Next\nEnd Sub\n</code></pre>\n\n<p>Currently I manually insert the new column and enter the formula max(E9,0) so the new column either shows 0 or a value if the value in the other column is greater than 0. Is it possible to automate this part as well.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530642739, "post_id": 51160587, "comment_id": 89305372, "body": "Here is an interesting link for you to study on: <a href=\"https://stackoverflow.com/questions/2860797/how-do-i-open-a-file-if-i-only-know-part-of-the-file-name\" title=\"how do i open a file if i only know part of the file name\">stackoverflow.com/questions/2860797/&hellip;</a>. I\u2019m currently on my phone and unable to help further. Surely others here will."}, {"owner": {"reputation": 2586, "user_id": 4152976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/329e1c5cb7a3c664e6ad3376b4d062b6?s=128&d=identicon&r=PG&f=1", "display_name": "PaulH", "link": "https://stackoverflow.com/users/4152976/paulh"}, "edited": false, "score": 0, "creation_date": 1530646300, "post_id": 51160587, "comment_id": 89306815, "body": "Please edit all the code with 4 spaces or more (including first and last line of code) to have it layout correctly."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530645428, "post_id": 51161460, "comment_id": 89306507, "body": "ShanayL Your below code is very helpful. Now just how do I make the filename pull up without the date? There is only one of that filename in the folder (ignoring the date). I want the VBA code to ignore the date.                                                  Dim wb As Workbook Set wb = Workbooks.Open(Filename:=&quot;C:\\Directory\\BACKEND_Purchases_New&zwnj;&#8203;_6-14-2018.xlsm&quot;)"}, {"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "reply_to_user": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530645918, "post_id": 51161460, "comment_id": 89306677, "body": "You cant ignore the date if you are trying to open it, its a part of the filename. If you ignore the date, the filename will no longer be valid. Are you trying to paste the filename somewhere without the date?"}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530646119, "post_id": 51161460, "comment_id": 89306745, "body": "No, because I repeat the same process every week. Only difference is date is updated on the file. So next week&#39;s file will say &quot;C:\\Directory\\BACKEND_Purchases_New_6-21-2018.xlsm&quot;). The process I&#39;m trying to do is the same. I don&#39;t want to update VBA everytime for filename. Is there no way to ignore date?"}, {"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "reply_to_user": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530646381, "post_id": 51161460, "comment_id": 89306835, "body": "oh ok. your title and description is a little misleading. You can use the filepicker method where a dialog box opens and you choose the file or you can set a folder and have your code navigate through files in the folder. I modified my answer."}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530647628, "post_id": 51161460, "comment_id": 89307327, "body": "Your VBA for selecting file works, but it debugs after that. After that last part of VBA for file selection. It should go to tab &quot;Contract Fixed&quot; to copy information, but it&#39;s not doing that.                          Last line of your VBA Code: Filepath = strPath  Next line of my VBA code: Sheets(&quot;1.1 Contract Fixed&quot;).Select"}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530648547, "post_id": 51161460, "comment_id": 89307705, "body": "NVM...my bad...it worked. I didn&#39;t use the whole code properly. Thanks a bunch!!!"}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530649558, "post_id": 51161460, "comment_id": 89308091, "body": "Please enlighten me...is there a way to mark your answer as the answer or do I click Answer Your Question at the bottom and copy your response there? First day on this website :/"}, {"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "reply_to_user": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1530650062, "post_id": 51161460, "comment_id": 89308272, "body": "Ah! Just click the check mark beside my answer. Welcome to stack overflow!!"}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 1, "creation_date": 1531323365, "post_id": 51161460, "comment_id": 89556606, "body": "Sorry for the late reply...done! Your code has helped a lot!!"}], "tags": [], "owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "is_accepted": true, "score": 0, "last_activity_date": 1530646583, "last_edit_date": 1530646583, "creation_date": 1530644883, "answer_id": 51161460, "question_id": 51160587, "link": "https://stackoverflow.com/questions/51160587/opening-another-source-file-from-macro-code/51161460#51161460", "title": "Opening another source file from macro code", "body": "<p>If you would like to choose a file to open you can use the File picker method like below:</p>\n\n<pre><code>Dim wb As Workbook\n\nSet FileDialog = application.FileDialog(msoFileDialogFilePicker)\nFileDialog.AllowMultiSelect = False\nFileDialog.Title = \"Select a file\"\nIf FileDialog.Show = -1 Then\n    strPath = FileDialog.SelectedItems(1)\nEnd If\n\nfilepath = strPath\n\n'open workbook\nSet wb = Workbooks.Open(Filename:=filepath)\n</code></pre>\n\n<p>If you want to access a cell from Backend Purchase you can use:</p>\n\n<pre><code>wb.Sheets(index).Cells(1,1) 'Access Cell from workbook - change \"index\" to fit tab number\n</code></pre>\n\n<p>and modify it as you see fit.</p>\n\n<p>If you want to copy information from one sheet to the other you could use the <code>Range.Find</code> method then copy and paste the results like:</p>\n\n<pre><code>Dim headernamerow as Integer\nDim headernamecolumn as Integer\n\n'Get location first cell with data - change \"index\" to fit tab number\nheadernamerow = wb.Sheets(index).Range(\"A1:Z500\").Find(What:=\"HeaderName\", LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns).row + 1\nheadernamecolumn = wb.Sheets(index).Range(\"A1:Z500\").Find(What:=\"HeaderName\", LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns).Column\n\n'Paste information into 1.1 Fixed Purch tab - modify cell as needed\nThisWorkbook.Sheets(\"FixedPurchTab\").Cells(1, 1).value = wb.Sheets(index).Cells(headernamerow,headernamecolumn).value\n</code></pre>\n\n<p>There may be a better way but this is the way I know.</p>\n"}], "owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 51161460, "answer_count": 1, "score": 1, "last_activity_date": 1530654536, "creation_date": 1530640990, "last_edit_date": 1530654536, "question_id": 51160587, "link": "https://stackoverflow.com/questions/51160587/opening-another-source-file-from-macro-code", "title": "Opening another source file from macro code", "body": "<p>So, I'm working on a file in <code>1.1 Fixed Purch</code> tab. Just basically clearing contents from certain cells and bringing updated material from <code>BACKEND_Purchases_New_6-14-2018.xlsm</code> file tab called \"Contract Fixed\". Both files are in same directory. Only one issue, I want the macro to ignore date when I'm pulling from <code>BACKEND_Purchases_New_6-14-2018.xlsm</code> file. How will I do that using below VBA? </p>\n\n<p>Please explain in a way I can understand completely since I'm a beginner.</p>\n\n<pre><code>Sub attri_kinda_new()\n '\n ' attri_kinda_new Macro\n '\n\n  Sheets(\"1.1 Fixed Purch\").Select\n  ActiveWindow.SmallScroll Down:=-3\n  Range(\"B4:G4500\").Select\n  Selection.ClearContents\n  Call Workbooks.Open(Filename:=\"BACKEND_Purchases_New_6-14-2018.xlsm\", local:=True)\n  Sheets(\"Contract Fixed\").Select\n  ActiveWindow.SmallScroll Down:=-18\n  Range(\"AG2:AL5000\").Select\n  Selection.Copy\n  Windows(\"US M2M Attribution 6-14-2018 training.xlsm\").Activate\n  Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1530641502, "post_id": 51160601, "comment_id": 89304762, "body": "I was thinking that formatting may be lost in a direct value transfer."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1530642169, "post_id": 51160601, "comment_id": 89305100, "body": "@Jeeped - you are right. I was too lazy this time to really consider that - which tells me I need to stop for the day :)\\"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1530641058, "creation_date": 1530641058, "answer_id": 51160601, "question_id": 51160490, "link": "https://stackoverflow.com/questions/51160490/excel-vba-run-time-error-438-when-trying-to-copy-data-from-one-sheet-in-a-wor/51160601#51160601", "title": "Excel VBA; Run-time error &#39;438&#39; when trying to copy data from one sheet in a work book to another sheet in the same workbook", "body": "<p>You don't specify where you get your error, but change the structure of all the blocks of code like this:</p>\n\n<pre><code>Sheets(\"Data\").Cells(x, 4).Select\nSelection.Copy\nWorksheets(\"Printable Report\").Activate\nSheets(\"Printable Report\").Range(\"B1\").Select\nSelection.Paste\n</code></pre>\n\n<p>To this: </p>\n\n<pre><code>Sheets(\"Printable Report\").Range(\"B\" &amp; x - 1).Value = Sheets(\"Data\").Cells(x,4).Value\n</code></pre>\n\n<p>and it should work and be easier to read / refactor later.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1530641442, "creation_date": 1530641442, "answer_id": 51160679, "question_id": 51160490, "link": "https://stackoverflow.com/questions/51160490/excel-vba-run-time-error-438-when-trying-to-copy-data-from-one-sheet-in-a-wor/51160679#51160679", "title": "Excel VBA; Run-time error &#39;438&#39; when trying to copy data from one sheet in a work book to another sheet in the same workbook", "body": "<p>Change this,</p>\n\n<pre><code>Worksheets(\"Data\").Activate\nSheets(\"Data\").Cells(x, 9).Select\nSelection.Copy\nWorksheets(\"Printable Report\").Activate\nSheets(\"Printable Report\").Range(\"B2\").Select\nSelection.Paste\n</code></pre>\n\n<p>... to this,</p>\n\n<pre><code>Worksheets(\"Data\").Cells(x, 9).Copy _\n  destination:=Worksheets(\"Printable Report\").Range(\"B2\")\n</code></pre>\n\n<p>You should be able to repeat that change in methodology in a few more places further down in your code.</p>\n\n<p>Please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n"}], "owner": {"reputation": 9, "user_id": 9995883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1a95e5263c72b7d80b6037b5ada3da7?s=128&d=identicon&r=PG&f=1", "display_name": "JJung", "link": "https://stackoverflow.com/users/9995883/jjung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530641442, "creation_date": 1530640605, "question_id": 51160490, "link": "https://stackoverflow.com/questions/51160490/excel-vba-run-time-error-438-when-trying-to-copy-data-from-one-sheet-in-a-wor", "title": "Excel VBA; Run-time error &#39;438&#39; when trying to copy data from one sheet in a work book to another sheet in the same workbook", "body": "<p>I am developing a tool that takes rows of data from one sheet (named \"Data\"), and then paste it into another sheet (named \"Printable Report\"). Each row coincides with a different job, and will get its own report. When I run the code I get the run-time error 438. I have tried different solutions and none seem to be working. If someone could take look at this and help me figure out where my problem is, that would be greatly appreciated. The error is occurring on the 8th line down. Thanks!</p>\n\n<pre><code>Sub ExportToReport()\n\nWorksheets(\"Data\").Activate\n\n\nDim x As Long, y As Long, z As Long\n\n\ny = Sheets(\"Data\").Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n\nFor x = 2 To y\n\n    Sheets(\"Data\").Cells(x, 4).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B1\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 9).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B2\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 8).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B3\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 10).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B4\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 11).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B5\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 12).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B6\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 29).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B7\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 25).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B8\").Select\n    Selection.Paste\n\n    Worksheets(\"Data\").Activate\n    Sheets(\"Data\").Cells(x, 15).Select\n    Selection.Copy\n    Worksheets(\"Printable Report\").Activate\n    Sheets(\"Printable Report\").Range(\"B9\").Select\n    Selection.Paste\n    'Then insert a set number of cells on print report when move to next row on Data\n    Sheets(\"Printable Report\").Range(\"A1\").EntireRow.Offset(1).Resize(36).Insert Shift:=xlDown\nNext x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1530717214, "post_id": 51160263, "comment_id": 89336152, "body": "If you want, we can discuss your problem in Skype :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10028156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff88347acbb5706e2a3f5ffdf06c5f50?s=128&d=identicon&r=PG&f=1", "display_name": "DavenIT", "link": "https://stackoverflow.com/users/10028156/davenit"}, "edited": false, "score": 0, "creation_date": 1530640971, "post_id": 51160516, "comment_id": 89304517, "body": "Many thanks Johny, How do I refer to the current filename in my code? I am writing the filename to a cell."}, {"owner": {"reputation": 3, "user_id": 10028156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff88347acbb5706e2a3f5ffdf06c5f50?s=128&d=identicon&r=PG&f=1", "display_name": "DavenIT", "link": "https://stackoverflow.com/users/10028156/davenit"}, "edited": false, "score": 0, "creation_date": 1530641739, "post_id": 51160516, "comment_id": 89304887, "body": "Thanks I will give that a try and replace references to wdDoc to strFile."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1530642108, "post_id": 51160516, "comment_id": 89305062, "body": "Personally I&#39;d prefer the &quot;&amp;&quot; sign to concatenate two strings:  <code>strFile = strFolder &amp; strFile</code>. Cf. <a href=\"https://stackoverflow.com/questions/1727699/how-can-i-concatenate-strings-in-vba\">Concatenate strings in VBA</a>."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1530642256, "post_id": 51160516, "comment_id": 89305135, "body": "@T.M. This case is safe :)"}, {"owner": {"reputation": 3, "user_id": 10028156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff88347acbb5706e2a3f5ffdf06c5f50?s=128&d=identicon&r=PG&f=1", "display_name": "DavenIT", "link": "https://stackoverflow.com/users/10028156/davenit"}, "edited": false, "score": 0, "creation_date": 1530642723, "post_id": 51160516, "comment_id": 89305364, "body": "I edited the original question with the new code, sorry I a little confused as I am sure you will see by my code..."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1530642341, "last_edit_date": 1530642341, "creation_date": 1530640728, "answer_id": 51160516, "question_id": 51160263, "link": "https://stackoverflow.com/questions/51160263/excel-vba-need-help-processing-multiple-files-in-folder/51160516#51160516", "title": "Excel VBA need help processing multiple files in folder", "body": "<p>You can use <code>Dir()</code> function. The main idea is following:</p>\n\n<pre><code>Sub G()\n\n    Dim r&amp;\n    Dim strFile$, strFolder$\n\n    strFolder = \"C:\\Temp\\\"\n    strFile = Dir(strFolder) '//First file\n\n    While Not strFile = \"\"\n\n        '// Next row in Excel file\n        r = r + 1\n\n        strFile = strFolder + strFile\n\n        '// Write down file name (into column A).\n        '// If you need only file name, the put this line\n        '// before \"strFile = strFolder + strFile\"\n        Cells(r, \"A\") = strFile\n\n        '// Do your things...\n\n        strFile = Dir() '//Fetch next fille\n\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10028156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff88347acbb5706e2a3f5ffdf06c5f50?s=128&d=identicon&r=PG&f=1", "display_name": "DavenIT", "link": "https://stackoverflow.com/users/10028156/davenit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 51160516, "answer_count": 1, "score": 0, "last_activity_date": 1530716821, "creation_date": 1530639658, "last_edit_date": 1531161705, "question_id": 51160263, "link": "https://stackoverflow.com/questions/51160263/excel-vba-need-help-processing-multiple-files-in-folder", "title": "Excel VBA need help processing multiple files in folder", "body": "<p>I only have basic Excel VBA knowledge, I need some help to adapt the code to process all .docx in a directory.\nI have adapted some Excel VBA code I found here to open a word document and copy table data to the spreadsheet. It then copies that data to a new line in a  worksheet. This all works fine for a single file, however I am not sure how to adapt this to process through all .docx files in a specified folder (300+). Any help or suggestions will be greatly appreciated.</p>\n\n<pre><code>Sub ImportWordTableWorking()\n'Import Word table into Excel and paste in new row\n\nDim ws As Object\nDim wdDoc As Object\nDim wdFileName As Variant\nDim TableNo As Integer 'table number in Word\nDim iRow As Long 'row index in Word\nDim jRow As Long 'row index in Excel\nDim iCol As Integer 'column index in Excel\nDim lastrow As Long\n\n\nwdFileName = Application.GetOpenFilename(\"Word files (*.docx),*.doc\", , _\n\"Browse for file containing table to be imported\")\nIf wdFileName = False Then Exit Sub '(user cancelled import file browser)\nSet wdDoc = GetObject(wdFileName) 'open Word file\n\n'write filename to sheet\n\nCells(2, 9) = wdFileName\nSheets(\"GrabData\").Select\n\nWith wdDoc\n    If wdDoc.Tables.Count = 0 Then\n        MsgBox \"This document contains no tables\", _\n            vbExclamation, \"Import Word Table\"\n    Else\n        jRow = 0\n       Set ws = Worksheets(\"Invoice-Import\")\n       Sheets(\"Invoice-Import\").Select\n    Cells.Select\n    Selection.ClearContents\n    Range(\"A1\").Select\n        For TableNo = 1 To wdDoc.Tables.Count\n            With .Tables(TableNo)\n'copy cell contents from Word table cells to Excel cells\n                For iRow = 1 To .Rows.Count\n                    jRow = jRow + 1\n                    For iCol = 1 To .Columns.Count\n                        On Error Resume Next\n                        ActiveSheet.Cells(jRow, iCol) = WorksheetFunction.Clean(.Cell(iRow, iCol).Range.Text)\n                        On Error GoTo 0\n                    Next iCol\n                Next iRow\n            End With\n            jRow = jRow + 1\n        Next TableNo\n    End If\nEnd With\n\n'\u00c7opy and paste selection as values in last row of GL sheet\n        Sheets(\"GrabData\").Range(\"A2:J2\").Copy\n        Sheets(\"GL\").Activate\nlastrow = Range(\"A65536\").End(xlUp).Row\nSheets(\"GL\").Activate\nCells(lastrow + 1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nSet wdDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>OK, sorry for my ignorance, I have tried adjusting the code to refer to strFile instead for wdDoc but I am getting and error \"Object must be defined\" from With strFile see new code:</p>\n\n<pre><code>Sub G()\n\n   Dim r&amp;\n    Dim strFile$, strFolder$\n\n    strFolder = \"C:\\Temp\\\"\n    strFile = Dir(strFolder) '//First file\n\n    While Not strFile = \"\"\n\n        '// Next row in Excel file\n        r = r + 1\n\n        strFile = strFolder + strFile\n\n'Import Word table into Excel and paste in new row\n\nDim ws As Object\nDim wdDoc As Object\nDim wdFileName As Variant\nDim TableNo As Integer 'table number in Word\nDim iRow As Long 'row index in Word\nDim jRow As Long 'row index in Excel\nDim iCol As Integer 'column index in Excel\nDim lastrow As Long\n\n\n''wdFileName = Application.GetOpenFilename(\"Word files (*.docx),*.doc\", , _\n''\"Browse for file containing table to be imported\")\n''If wdFileName = False Then Exit Sub '(user cancelled import file browser)\n''Set wdDoc = GetObject(wdFileName) 'open Word file\n\n'write filename to sheet\n\nCells(2, 9) = strFile\nSheets(\"GrabData\").Select\n\nWith strFile\n    If strFile.Tables.Count = 0 Then\n        MsgBox \"This document contains no tables\", _\n            vbExclamation, \"Import Word Table\"\n    Else\n        jRow = 0\n       Set ws = Worksheets(\"Invoice-Import\")\n       Sheets(\"Invoice-Import\").Select\n    Cells.Select\n    Selection.ClearContents\n    Range(\"A1\").Select\n        For TableNo = 1 To strFile.Tables.Count\n            With .Tables(TableNo)\n'copy cell contents from Word table cells to Excel cells\n                For iRow = 1 To .Rows.Count\n                    jRow = jRow + 1\n                    For iCol = 1 To .Columns.Count\n                        On Error Resume Next\n                        ActiveSheet.Cells(jRow, iCol) = WorksheetFunction.Clean(.Cell(iRow, iCol).Range.Text)\n                        On Error GoTo 0\n                    Next iCol\n                Next iRow\n            End With\n            jRow = jRow + 1\n        Next TableNo\n    End If\nEnd With\n\n'\u00c7opy and paste selection as values in last row of GL sheet\n        Sheets(\"GrabData\").Range(\"A2:J2\").Copy\n        Sheets(\"GL\").Activate\nlastrow = Range(\"A65536\").End(xlUp).Row\nSheets(\"GL\").Activate\nCells(lastrow + 1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nSet strFile = Nothing\n\n        strFile = Dir() '// Fetch next file in a folder\n\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance\nPD</p>\n\n<p>Many thanks Johny,</p>\n\n<p>You are a guru. After some sleep and further debugging I found the issue was my code was referring to wddoc (open word document filename) which I realised was expecting an object not a string. After using <code>Set wdDoc = GetObject(strFile)</code> it fixed the undefined object type issue and it all started working. My only other question is how to limit it to only open .docx?\nHere is the working code:</p>\n\n<pre><code>Sub ImportWordInvoice()\n\nDim r&amp;\nDim strFile$, strFolder$\nDim ws As Object\nDim wdDoc As Object\nDim wdFileName As Variant\nDim TableNo As Integer 'table number in Word\nDim iRow As Long 'row index in Word\nDim jRow As Long 'row index in Excel\nDim iCol As Integer 'column index in Excel\nDim lastrow As Long\n\n\n strFolder = \"C:\\testmacro\\Invoices\\\"\n    strFile = Dir(strFolder) '//First file\n    While Not strFile = \"\"\n        strFile = strFolder + strFile\n\n        Set wdDoc = GetObject(strFile)\n\n'write filename to static cell\nSheets(\"GrabData\").Select\nCells(2, 9) = strFile\n\nWith wdDoc\n    If wdDoc.Tables.Count = 0 Then\n        MsgBox \"This document contains no tables\", _\n            vbExclamation, \"Import Word Table\"\n    Else\n        jRow = 0\n       Set ws = Worksheets(\"Invoice-Import\")\n       Sheets(\"Invoice-Import\").Select\n    Cells.Select\n    Selection.ClearContents\n    Range(\"A1\").Select\n        For TableNo = 1 To wdDoc.Tables.Count\n            With .Tables(TableNo)\n'copy cell contents from Word table cells to Excel cells\n                For iRow = 1 To .Rows.Count\n                    jRow = jRow + 1\n                    For iCol = 1 To .Columns.Count\n                        On Error Resume Next\n                        ActiveSheet.Cells(jRow, iCol) = WorksheetFunction.Clean(.Cell(iRow, iCol).Range.Text)\n                        On Error GoTo 0\n                    Next iCol\n                Next iRow\n            End With\n            jRow = jRow + 1\n        Next TableNo\n    End If\nEnd With\n\n'\u00c7opy and paste selection as values in last row of GL sheet\n        Sheets(\"GrabData\").Range(\"A2:J2\").Copy\n        Sheets(\"GL\").Activate\nlastrow = Range(\"A65536\").End(xlUp).Row\nSheets(\"GL\").Activate\nCells(lastrow + 1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nSet wdDoc = Nothing\n\n        strFile = Dir() '// Fetch next file in a folder\n\n    Wend\nMsgBox \"Complete\"\nEnd Sub\n</code></pre>\n\n<p>Thanks once again, now I don't need to double entry all my wife's word invoices into a spreadsheet. I really appreciate your time and knowledge.</p>\n\n<p>Regards</p>\n\n<p>PD </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1530639654, "post_id": 51160230, "comment_id": 89303870, "body": "I tend to use FormulaR1C1 personally."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9947686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Sg2Uh9cUfkY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq25H_whSu0jxMlEDFjrO5fxUYzj7g/mo/photo.jpg?sz=128", "display_name": "Sean Paul", "link": "https://stackoverflow.com/users/9947686/sean-paul"}, "edited": false, "score": 0, "creation_date": 1530639951, "post_id": 51160291, "comment_id": 89304015, "body": "OMG yes it was that exactly"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1530639764, "creation_date": 1530639764, "answer_id": 51160291, "question_id": 51160230, "link": "https://stackoverflow.com/questions/51160230/checked-statement-causing-error-on-a-vba-macro-for-excel/51160291#51160291", "title": "&quot;checked&quot; statement causing error on a vba macro for excel", "body": "<p>In VBA you must double-up all the quotes inside, viz (there might be other issues, I haven't checked). I expect a google search would have solved this for you.</p>\n\n<pre><code>Range(\"S2:S\" &amp; lastRow).Formula = \"=IF(TRIM(N2)=\"\"checked\"\",M2,IF(LEN(P2)&gt;=60, P2, IF(LEN(SUBSTITUTE(R2,CONCATENATE(\"\" \"\", $J$2),\"\"\"\"))&gt;=60,SUBSTITUTE(R2,CONCATENATE(\"\" \"\", $J$2),\"\"\"\"),R2)))\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9947686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Sg2Uh9cUfkY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq25H_whSu0jxMlEDFjrO5fxUYzj7g/mo/photo.jpg?sz=128", "display_name": "Sean Paul", "link": "https://stackoverflow.com/users/9947686/sean-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 51160291, "answer_count": 1, "score": 0, "last_activity_date": 1530639764, "creation_date": 1530639525, "question_id": 51160230, "link": "https://stackoverflow.com/questions/51160230/checked-statement-causing-error-on-a-vba-macro-for-excel", "title": "&quot;checked&quot; statement causing error on a vba macro for excel", "body": "<p>So i need to add a formula to an entire column using a macro,\nso far i have:</p>\n\n<pre><code>Range(\"S2:S\" &amp; lastRow).Formula = \"=IF(TRIM(N2)=\"checked\",M2,IF(LEN(P2)&gt;=60, P2, IF(LEN(SUBSTITUTE(R2,CONCATENATE(\" \", $J$2),\"\"))&gt;=60,SUBSTITUTE(R2,CONCATENATE(\" \", $J$2),\"\"),R2)))\"\n</code></pre>\n\n<p>Which is supposed to take several values of different cells and form a new one, the problem is that the code sends an error \"Syntax Error\" but if i put the formula in a cell in excel the formula works perfectly.</p>\n\n<p>Any idea on what could be causing the error? i think it could be linked with how its writen and how vba reads it.</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530640190, "post_id": 51160225, "comment_id": 89304127, "body": "Your code contradicts itself and the narrative in terms of what columns are to be used for the conditions. Perhaps it would be best to simply spell it out word-for-word what you are trying to achieve."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1530639927, "creation_date": 1530639927, "answer_id": 51160323, "question_id": 51160225, "link": "https://stackoverflow.com/questions/51160225/highlight-rows-based-pf-column-criteria-vba/51160323#51160323", "title": "Highlight rows based pf column criteria VBA", "body": "<p>try a conditional formatting rule.</p>\n\n<pre><code>With worksheets(\"sheet1\").usedrange.offset(1, 0).entirerow\n    .FormatConditions.Delete\n    With .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=and($a2=$a1, $b2=$b1, $f2&gt;$f1)\")\n        .font.Color = vbRed\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10028231, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N99LJbMWzi4/AAAAAAAAAAI/AAAAAAAAADo/ZtIy3SxEk3Y/photo.jpg?sz=128", "display_name": "JPetree", "link": "https://stackoverflow.com/users/10028231/jpetree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530640280, "creation_date": 1530639508, "last_edit_date": 1530640280, "question_id": 51160225, "link": "https://stackoverflow.com/questions/51160225/highlight-rows-based-pf-column-criteria-vba", "title": "Highlight rows based pf column criteria VBA", "body": "<p>Im trying to write a VBA script to compare two = rows and have the spreadsheet highlight the duplicate rows only if certain criteria is met, such as (Value of row, column a = Value of row-1, column) AND Value of row, column b > Value of row-1, column b) Then entirerow of the greater value in column b.font.color = vbRed.</p>\n\n<p>Here is a section of the table I'm running...</p>\n\n<p><a href=\"https://i.stack.imgur.com/o9s6s.jpg\" rel=\"nofollow noreferrer\">Table Selection</a></p>\n\n<p>Here is the code I am using...</p>\n\n<pre><code>Sub RemoveDuplicates()\n\nDim i As Long, R As Long\n'Dim DeviceName As Range, SerialNumber As Range, LastContact As Range\n\nApplication.ScreenUpdating = False\n\nR = Cells(Rows.Count, 1).End(xlUp).Row\n\n'Set DeviceName = Columns(2)\n'Set SerialNumber = Columns(3)\n'Set LastContact = Columns(7)\n\nFor i = R To 2 Step -1\n\n'If Cells(i, \"F\").Value &gt; Cells(i - 1, \"F\").Value Then\n'Code above doesn't work\n\nIf Cells(i, 3).Value = Cells(i - 1, 3).Value And Cells(i, 2).Value = Cells(i - 1, 2).Value Then\n\n    'If Cells(i, 3).Value = Cells(i - 1, 3).Value And Cells(i, 2).Value = Cells(i - 1, 2).Value And Cells(i, 5).Value &gt; Cells(i - 1, 5).Value Then\n    'Code above doesn't work\n\n    Cells(i, 1).EntireRow.Font.Color = vbRed\n    End If\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I can get the duplicates to highlight, but when I try to introduce the greater than check, the system gets janky. </p>\n\n<p><a href=\"https://i.stack.imgur.com/o9s6s.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o9s6s.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "vba", "excel", "com", "com-interop"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530639851, "post_id": 51160152, "comment_id": 89303969, "body": "<i>thereafter admin not required</i> - depends. Did the class or its members change since registration? If the order of the members changed, their <code>DISPID</code> changed."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530639900, "post_id": 51160152, "comment_id": 89303993, "body": "Matt (&#39;s Mug), ok, go ahead and always run it under admin as I always do."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530640014, "post_id": 51160152, "comment_id": 89304044, "body": "Oh, I don&#39;t do Python! [un?]fortunately! =)  ...was just grasping at straws, not sure why it&#39;s not working."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530640071, "post_id": 51160152, "comment_id": 89304068, "body": "@Mat: you don;t know what you&#39;re missing, I done a whole month of blog posts on Python/VBA <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/06/python-some-month-end-observations.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/06/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530640275, "post_id": 51160152, "comment_id": 89304165, "body": "I don&#39;t think I&#39;ll ever be sold to Python. C# does everything I need to do, including COM interop.... <i>that works</i> (wink-wink ;-)"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530640368, "post_id": 51160152, "comment_id": 89304212, "body": "@Mat : Watch my blog as I&#39;ll later be doing BigData and Machine Learning leveraging the Python libraries (wink ;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530640507, "post_id": 51160152, "comment_id": 89304280, "body": "(off-topic) Man, that&#39;s over-the-top prolific! Ever considered nominating yourself for Microsoft MVP?"}, {"owner": {"reputation": 2943, "user_id": 9014308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6e0464313ca63c239f5d973213daf9?s=128&d=identicon&r=PG&f=1", "display_name": "kunif", "link": "https://stackoverflow.com/users/9014308/kunif"}, "edited": false, "score": 0, "creation_date": 1530652876, "post_id": 51160152, "comment_id": 89309212, "body": "What happens if MyParent&#39;s self.child = MyChild () is changed to self.child = win32com.client.Dispatch (&quot;PythonInVBA.MyChild&quot;)?"}], "answers": [{"tags": [], "owner": {"reputation": 2943, "user_id": 9014308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6e0464313ca63c239f5d973213daf9?s=128&d=identicon&r=PG&f=1", "display_name": "kunif", "link": "https://stackoverflow.com/users/9014308/kunif"}, "is_accepted": true, "score": 1, "last_activity_date": 1530657880, "creation_date": 1530657880, "answer_id": 51163690, "question_id": 51160152, "link": "https://stackoverflow.com/questions/51160152/python-com-interop-factory-pattern/51163690#51163690", "title": "Python COM Interop - Factory Pattern", "body": "<p>I converted the contents of the comment into the answer.</p>\n\n<p>This is because MyChild is not generated as a COM Object in MyParent.<br>\nIt will work if you change it as follows.</p>\n\n<p>original:</p>\n\n<pre><code>    def __init__(self):  # Rules of Com say paramerless constructors\n        self.child = MyChild()\n        self.child.SetName(\"foo\")\n</code></pre>\n\n<p>modified:</p>\n\n<pre><code>    def __init__(self):  # Rules of Com say paramerless constructors\n        self.child = win32com.client.Dispatch(\"PythonInVBA.MyChild\")\n        self.child.SetName(\"foo\")\n</code></pre>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 51163690, "answer_count": 1, "score": 1, "last_activity_date": 1530657880, "creation_date": 1530639143, "question_id": 51160152, "link": "https://stackoverflow.com/questions/51160152/python-com-interop-factory-pattern", "title": "Python COM Interop - Factory Pattern", "body": "<p>I have two python classes, both of them scriptable independently from VBA using COM interop mechanisms.  But I want one to control the creation of the other, in a Parent Child pattern or Factory pattern.</p>\n\n<p>I have experimented but cannot get to work, I have distilled into MCRE below.  I am new at Python.  I was wondering if there was someway to inherit a mixin which will give the class the necessary COM interop methods.</p>\n\n<p>Ok, so I have created a MCRE, here is the Python code which must be run at least one from command line with admin privileges to get the COM registration done (thereafter admin not required).</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import win32com.client\n\n\nclass MyParent(object):\n    _reg_clsid_ = \"{C61A7C6E-B657-4D55-AD36-8850B2E501AC}\"\n    _reg_progid_ = 'PythonInVBA.MyParent'\n    _public_methods_ = ['Greet', 'GetChild']\n\n    def __init__(self):  # Rules of Com say paramerless constructors\n        self.child = MyChild()\n        self.child.SetName(\"foo\")\n\n    def Greet(self):\n        return \"Hello world\"\n\n    def GetChild(self):\n        return self.child\n\n\nclass MyChild(object):\n    _reg_clsid_ = \"{15DAAEE2-3A37-4DE1-9973-CCD011DF4888}\"\n    _reg_progid_ = 'PythonInVBA.MyChild'\n    _public_methods_ = ['Initialize', 'GetName', 'SetName']\n\n    def __init__(self):  # Rules of Com say paramerless constructors\n        pass\n\n    def GetName(self):\n        return self.name\n\n    def SetName(self, sName):\n        self.name = sName\n\nif __name__ == '__main__':\n    print (\"Registering COM servers...\")\n    import win32com.server.register\n    win32com.server.register.UseCommandLine(MyParent)\n    win32com.server.register.UseCommandLine(MyChild)\n</code></pre>\n\n<p>And here is the VBA code, the first two Sub Procedures work but the third one fails.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Test_MyParent_OnItsOwn()\n    On Error GoTo ErrHand:\n\n    Dim objMyParent As Object\n    Set objMyParent = VBA.CreateObject(\"PythonInVBA.MyParent\")\n    Debug.Assert objMyParent.Greet = \"Hello world\"\n    Exit Sub\nErrHand:\n    Debug.Print Err.Description\nEnd Sub\n\nSub Test_MyChild_OnItsOwn()\n    On Error GoTo ErrHand:\n\n    Dim objMyChild As Object\n    Set objMyChild = VBA.CreateObject(\"PythonInVBA.MyChild\")\n\n    objMyChild.SetName \"Kevin\"\n    Debug.Assert objMyChild.GetName = \"Kevin\"\n    ''' success MyChild is scriptable\n    Exit Sub\nErrHand:\n    Debug.Print Err.Description\nEnd Sub\n\n\nSub Test_MyParent_Returning_MyChild()\n    On Error GoTo ErrHand:\n\n    Dim objMyParent As Object\n    Set objMyParent = VBA.CreateObject(\"PythonInVBA.MyParent\")\n\n    Dim objMyChild As Object\n\n    '* errors with Unexpected Python Error: TypeError: Objects of type 'MyChild' can not be converted to a COM VARIANT (but obtaining the buffer() of this object could)\n    Set objMyChild = objMyParent.GetChild()\n\n    Exit Sub\nErrHand:\n    Debug.Print Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 1, "creation_date": 1530639126, "post_id": 51159998, "comment_id": 89303606, "body": "just use Conditional Formatting&gt;Highlight Cell Rules&gt;Less Than &quot;1000&quot;  and set whatever color you want."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1530639579, "creation_date": 1530639579, "answer_id": 51160241, "question_id": 51159998, "link": "https://stackoverflow.com/questions/51159998/coding-certain-cells-a-color/51160241#51160241", "title": "Coding certain cells a color", "body": "<p>Try,</p>\n\n<pre><code>'this to set a conditional formatting rule on E11:E28\n with range(\"E11:E28\")\n     .FormatConditions.Delete\n     With .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=and(len($e11), $e11&lt;1000)\")\n         .Interior.Color = vbred\n     End With\n end with\n\n'this should get you started cleaning up the text labels\nRange(\"A10:E10\") = array(\"AMOUNT\",\"SALES\",\"PRICE PER UNIT\",\"TAX\",\"TOTAL\")\n\nRange(\"A11:A28\") = application.transpose(array(\"Calculators\",\"Pencils\",\"Loose Leaf Paper\", _\n                               \"Balloons\",\"Mirrors\",\"Axles\",\"Wheels\",\"Masking Tape\", _\n                               \"Electrical Tape\",\"Mini Blocks\",\"Tongue Depressors\", _\n                               \"Slinkys\",\"Beakers\",\"Test Tubes\",\"Colored Pencils\", _\n                               \"Lenses\",\"Newspapers\",\"Cardboard\"))\n</code></pre>\n\n<p>Note that filling in a number of columns in a single row only requires passing the array into the range but to fill in a number of rows in a single column you must Transpose the array.</p>\n\n<p>Please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n"}], "owner": {"reputation": 27, "user_id": 10012630, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155313094132471/picture?type=large", "display_name": "Kimberly Souba", "link": "https://stackoverflow.com/users/10012630/kimberly-souba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530639579, "creation_date": 1530638551, "question_id": 51159998, "link": "https://stackoverflow.com/questions/51159998/coding-certain-cells-a-color", "title": "Coding certain cells a color", "body": "<p>How do I code something to say: If the total amount is under $1000 (E11:E28) then it will turn red? Also, is there a way to clean up this vba so that it's no so lengthy? </p>\n\n<p>This is a project that I want to teach my students to do as a way to do some basic budgeting. </p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub ClassroomSupplies()\n\nRange(\"A7\").Select\nActiveCell.FormulaR1C1 = \"Week of July 2-6, 2018\"\nRange(\"A10\").Select\nColumns(\"B:B\").ColumnWidth = 9.57\nRange(\"A8:B8\").Select\nWith Selection\n.HorizontalAlignment = xlLeft\n.VerticalAlignment = xlBottom\n.WrapText = False\n.Orientation = 0\n.AddIndent = False\n.IndentLevel = 0\n.ShrinkToFit = False\n.ReadingOrder = xlContext\n.MergeCells = True\nEnd With\nRange(\"A10\").Select\nActiveCell.FormulaR1C1 = \"AMOUNT\"\nRange(\"B10\").Select\nActiveCell.FormulaR1C1 = \"SALES\"\nRange(\"C10\").Select\nActiveCell.FormulaR1C1 = \"PRICE PER UNIT\"\nRange(\"D10\").Select\nActiveCell.FormulaR1C1 = \"TAX\"\nRange(\"E10\").Select\nActiveCell.FormulaR1C1 = \"TOTAL\"\nRange(\"A11\").Select\nActiveCell.FormulaR1C1 = \"Calculators\"\nRange(\"A12\").Select\nActiveCell.FormulaR1C1 = \"Pencils\"\nRange(\"A13\").Select\nActiveCell.FormulaR1C1 = \"Loose Leaf Paper\"\nRange(\"A14\").Select\nActiveCell.FormulaR1C1 = \"Balloons\"\nRange(\"A15\").Select\nActiveCell.FormulaR1C1 = \"Mirrors\"\nRange(\"A16\").Select\nActiveCell.FormulaR1C1 = \"Axles\"\nRange(\"A17\").Select\nActiveCell.FormulaR1C1 = \"Wheels\"\nRange(\"A18\").Select\nActiveCell.FormulaR1C1 = \"Masking Tape\"\nRange(\"A19\").Select\nActiveCell.FormulaR1C1 = \"Electrical Tape\"\nRange(\"A20\").Select\nActiveCell.FormulaR1C1 = \"Mini Blocks\"\nRange(\"A21\").Select\nActiveCell.FormulaR1C1 = \"Tongue Depressors\"\nRange(\"A22\").Select\nActiveCell.FormulaR1C1 = \"Slinkys\"\nRange(\"A23\").Select\nActiveCell.FormulaR1C1 = \"Beakers\"\nRange(\"A24\").Select\nActiveCell.FormulaR1C1 = \"Test Tubes\"\nRange(\"A25\").Select\nActiveCell.FormulaR1C1 = \"Colored Pencils\"\nRange(\"A26\").Select\nActiveCell.FormulaR1C1 = \"Lenses\"\nRange(\"A27\").Select\nActiveCell.FormulaR1C1 = \"Newspapers\"\nRange(\"A28\").Select\nActiveCell.FormulaR1C1 = \"Cardboard\"\nRange(\"B11\").Select\nActiveCell.FormulaR1C1 = \"10392\"\nRange(\"B12\").Select\nActiveCell.FormulaR1C1 = \"10788\"\nRange(\"B13\").Select\nActiveCell.FormulaR1C1 = \"15588\"\nRange(\"B14\").Select\nActiveCell.FormulaR1C1 = \"1188\"\nRange(\"B15\").Select\nActiveCell.FormulaR1C1 = \"5970\"\nRange(\"B16\").Select\nActiveCell.FormulaR1C1 = \"8970\"\nRange(\"B17\").Select\nActiveCell.FormulaR1C1 = \"7980\"\nRange(\"B18\").Select\nActiveCell.FormulaR1C1 = \"5990\"\nRange(\"B19\").Select\nActiveCell.FormulaR1C1 = \"2970\"\nRange(\"B20\").Select\nActiveCell.FormulaR1C1 = \"4788\"\nRange(\"B21\").Select\nActiveCell.FormulaR1C1 = \"3192\"\nRange(\"B22\").Select\nActiveCell.FormulaR1C1 = \"6487\"\nRange(\"B23\").Select\nActiveCell.FormulaR1C1 = \"490\"\nRange(\"B24\").Select\nActiveCell.FormulaR1C1 = \"490\"\nRange(\"B25\").Select\nActiveCell.FormulaR1C1 = \"15684\"\nRange(\"B26\").Select\nActiveCell.FormulaR1C1 = \"80\"\nRange(\"B27\").Select\nActiveCell.FormulaR1C1 = \"100\"\nRange(\"B28\").Select\nActiveCell.FormulaR1C1 = \"95\"\nRange(\"B29\").Select\nRange(\"C11:C28\").Select\nSelection.Style = \"Currency\"\nRange(\"D11\").Select\nActiveCell.FormulaR1C1 = \"=SUM((RC[-2]*RC[-1])*0.0625)\"\nRange(\"D11\").Select\nSelection.AutoFill Destination:=Range(\"D11:D28\"), Type:=xlFillDefault\nRange(\"D11:D28\").Select\nSelection.Style = \"Currency\"\nRange(\"E11\").Select\nActiveCell.FormulaR1C1 = \"=SUM((RC[-3]*RC[-2])+RC[-1])\"\nRange(\"E11\").Select\nSelection.AutoFill Destination:=Range(\"E11:E28\"), Type:=xlFillDefault\nRange(\"E11:E28\").Select\nRange(\"E31\").Select\nActiveCell.FormulaR1C1 = \"=SUM(R[-20]C:R[-3]C)\"       \nActiveCell.FormulaR1C1 = \"=SUM(R[-20]C:R[-3]C)\"\nRange(\"E34\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(R[-3]C/5)\"\nRange(\"E35\").Select\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1530638197, "post_id": 51159804, "comment_id": 89303130, "body": "This seems like the type of thing you want to do in Access, rather than Excel. Have you tried making a copy of the table in question, editing the copy the way you want, renaming the old table and then renaming the edited copy to the original name?"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 4, "creation_date": 1530638332, "post_id": 51159804, "comment_id": 89303207, "body": "You can&#39;t determine the value of an autonumber field. instead of importing the old data into an existing new table, import the old table as new table including structure and data. This is not a matter of VBA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530639446, "post_id": 51159804, "comment_id": 89303759, "body": "Gaps would be records that were deleted. You would hit the exact same problem if this were SQL Server with an <code>int</code> primary key with <code>identity</code> specification, which is pretty much standard and best practice. In SQL Server you can <code>set identity insert on</code>; not sure if Access has something similar, or if it lets you just insert values in an <i>autonumber</i> column."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530639737, "post_id": 51159804, "comment_id": 89303914, "body": "So I asked around, and it appears you can use plain SQL in Access to insert into an autonumber column (the UI doesn&#39;t let you do it)."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1530639851, "post_id": 51159804, "comment_id": 89303971, "body": "Just to add something - autonumber can have gaps if you start to insert then cancel. All the autonumber guarantees is that the key you get is <i>unique</i>, not <i>contiguous</i>. If you want contigous sequence, you need something else. I would consider using a tally table as a general solution for that type of problem. OTOH, if the numbers have meaning (and normally they should not!), they probably shouldn&#39;t be an autonumber to begin with."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1530639932, "post_id": 51159804, "comment_id": 89304008, "body": "@Olivier If I understand you correctly, that&#39;s just not true. You can determine the seed of an autonumber field using VBA. See <a href=\"http://allenbrowne.com/func-ADOX.html#GetSeedADOX\" rel=\"nofollow noreferrer\">Allen Browne&#39;s GetSeedADOX</a>. Also, the <code>ResetSeed</code> function on that same page can be used to reset the identity seed after manually importing data (strongly recommended if you&#39;re going to do inserts in autonumber fields to avoid conflicts)"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1530647759, "post_id": 51159804, "comment_id": 89307388, "body": "Yes, but you cannot import existing, non-contiguous numbers into an autonumber field."}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530645790, "creation_date": 1530645790, "answer_id": 51161650, "question_id": 51159804, "link": "https://stackoverflow.com/questions/51159804/vba-code-to-add-number-in-sequence-and-rows-of-data/51161650#51161650", "title": "VBA code to add number in sequence and rows of data", "body": "<p>The best way to resequence the IDs is to take advantage of \"Cascade Update Related Fields\".<br>\nWhat you will have to do is </p>\n\n<ul>\n<li>Delete all the relationships to your table</li>\n<li>Change the ID field to Number - Long Integer</li>\n<li>Add the relationships back, inforcing cascading updates</li>\n<li>Shift all the indices to a number larger than the current max ID</li>\n<li>Renumber than starting at 1</li>\n<li>Delete all the relationships</li>\n<li>Delete the ID field</li>\n<li>Save the table</li>\n<li>Add the ID field back as auto-increment - primary key</li>\n<li>Add the relationships back</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/acRI8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/acRI8.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/DTUbd.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DTUbd.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>ReImcrementCustomerIDs:Sub</h2>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Sub ReImcrementCustomerIDs(ByVal FirstIndex As Long)\n    Dim rs As DAO.Recordset\n    Dim db As Database\n    Dim SQL As String\n    Dim ID As Long\n    Set db = CurrentDb\n\n    SQL = \"SELECT CustomerID FROM Customers ORDER BY CustomerID;\"\n\n    Set rs = db.OpenRecordset(SQL, dbOpenDynaset)\n\n    Do While Not rs.EOF\n        rs.Edit\n        rs(\"CustomerID\") = FirstIndex\n        FirstIndex = FirstIndex + 1\n        rs.Update\n        rs.MoveNext\n    Loop\nEnd Sub\n</code></pre>\n\n<h2>Usage</h2>\n\n<pre><code>ReImcrementCustomerIDs 50000\nReImcrementCustomerIDs 1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10028005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf93477477da8ac64c1c49322dd27f8?s=128&d=identicon&r=PG&f=1", "display_name": "Paul McCloy", "link": "https://stackoverflow.com/users/10028005/paul-mccloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530645790, "creation_date": 1530637712, "last_edit_date": 1531164843, "question_id": 51159804, "link": "https://stackoverflow.com/questions/51159804/vba-code-to-add-number-in-sequence-and-rows-of-data", "title": "VBA code to add number in sequence and rows of data", "body": "<p>I am converting an old 2010 Access data base to Access 2016, the database being originally built in Access 2000. My customer table used an <strong>autonumber</strong> field to generate a <code>CustomerId</code> number.</p>\n\n<p>I used this field to connect to my repairs table which currently has 13,000 records. I have not been able to find away to maintain this field in new database, so I thought if I can export the table to an Excel file than add numbers in sequence of missing ID numbers along with data to fill name and address fields for temp import to new database, after import I can delete these fields.</p>\n\n<p>I don't know if there are other ways to maintain this id. I imported customer table with Old ID field name, but access won't allow me to use this field to create relationships to new repairs table. </p>\n\n<p>The ID numbers go from 1 to 8,437 yet there are only 7,884 records in the spreadsheet. </p>\n"}]