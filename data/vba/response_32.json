[{"tags": ["vba", "excel", "replace"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1500190044, "last_edit_date": 1500190044, "creation_date": 1440030091, "answer_id": 32107693, "question_id": 32107473, "link": "https://stackoverflow.com/questions/32107473/search-and-replace-in-excel-based-on-a-list/32107693#32107693", "title": "Search and replace in excel based on a list", "body": "<pre><code>Option Explicit\n\nPublic Sub searchAndReplaceFromList()\n\n    Dim cel As Range\n\n    With Sheet2\n\n        For Each cel In Sheet2.Range(\"A1:A\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row)\n\n            Sheet1.UsedRange.Replace cel.Value2, cel.Offset(0, 1).Value2\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5245404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17157d76d5e2f0a4943db27a87d4bcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Tamas", "link": "https://stackoverflow.com/users/5245404/tamas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500190044, "creation_date": 1440028377, "last_edit_date": 1531164843, "question_id": 32107473, "link": "https://stackoverflow.com/questions/32107473/search-and-replace-in-excel-based-on-a-list", "title": "Search and replace in excel based on a list", "body": "<p>I need to replace values on Sheet1 based on a table on Sheet2.</p>\n\n<ul>\n<li>Sheet1 has a long list of names all over the sheet in different columns that I need to replace with standardized names based on the table on Sheet2.</li>\n<li>On Sheet2, column A has the values to be replaced and column B has the values to be replaced with.</li>\n</ul>\n\n<p>I use Ms Excel 2011 for Mac. Is there a simple VBA macro for it?</p>\n"}, {"tags": ["arrays", "excel", "vba", "dialog"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 4982306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826156a6858058df00b0034f54857fd6?s=128&d=identicon&r=PG&f=1", "display_name": "xlJunkie", "link": "https://stackoverflow.com/users/4982306/xljunkie"}, "is_accepted": true, "score": 0, "last_activity_date": 1440114762, "creation_date": 1440114762, "answer_id": 32130282, "question_id": 32107306, "link": "https://stackoverflow.com/questions/32107306/using-checkboxes-in-dialog-sheet-to-specify-sheets-to-perform-actions/32130282#32130282", "title": "Using Checkboxes in Dialog Sheet to Specify Sheets to Perform Actions", "body": "<p>Nevermind everyone.... Through a few hours of trial &amp; error, I was able to get the following code to work perfectly... Not sure if I did this correctly (syntax, best practices, etc...), but it is definitely working exactly how I wanted it to...</p>\n\n<pre><code>Option Explicit\nSub Create_NewEvent()\n\n Const DBLSPACE As String = vbNewLine &amp; vbNewLine\n Const BESTNFL As String = DBLSPACE &amp; vbNewLine &amp; _\n\"The Baltimore Ravens Rule!\" &amp; _\n\"The Forty-Winers Do NOT\"\n\n Const openMSG As String = \"After pressing OK button this \" &amp; _\n  \"will take some time.\" &amp; DBLSPACE &amp; \"Amount of time \" &amp; _\n  \"depends on whether or not the Ravens have a winning record,\" &amp; _\n  \"and whether or not...\" &amp; DBLSPACE &amp; _\n  \"Just be patient! Root for the Ravens and...!\" &amp; BESTNFL\n\n    Dim tPos As Integer, cb As CheckBox, SheetCount As Integer, sDlg As DialogSheet\nDim w As Long, I As Long, y As Variant, x As Long, z As Long, sNames As Variant, invNames As Variant, colm As Range, tbl As Range, col1 As Range, invRng As Range\nDim wb As Workbook, ws As Worksheet, fbDate As Variant, fbEvent As Variant\nSet wb = ThisWorkbook\n\n\n\n'************************************IF YOU ADD A NEW STAND SHEET, PLEASE ADD THE SHEET NAME THIS ARRAY*********************************************************\nsNames = Array(Sheet1, Sheet3, Sheet5, Sheet7, Sheet9, Sheet13, _\n                   Sheet17, Sheet21, Sheet23, Sheet27, Sheet31, Sheet35, _\n                   Sheet39, Sheet43, Sheet47, Sheet54, Sheet56, _\n                   Sheet58, Sheet60, Sheet61, Sheet62, Sheet63, Sheet64, _\n                   Sheet65, Sheet82, Sheet83, Sheet84, Sheet85, Sheet90, _\n                   Sheet91, Sheet93, Sheet94)\n'***************************************************************************************************************************************************************\n\n\n\n'*************************IF YOU ADD A NEW NPO INVOICE, PLEASE ADD THE SHEET NAME &amp; NUMBER IN THIS ARRAY********************************************************\n   invNames = Array(Sheet2, Sheet4, Sheet6, Sheet8, Sheet11, Sheet15, Sheet19, Sheet25, Sheet29, Sheet33, Sheet37, _\n                Sheet41, Sheet45, Sheet52, Sheet53, Sheet55, Sheet66, Sheet87)\n'***************************************************************************************************************************************************************\n\n\n\n\n   If MsgBox(\"Are you sure that you want to create a new event?\", vbYesNo, \"Confirm\") = vbYes Then\n\n    MsgBox openMSG\n\n      Application.DisplayAlerts = False\n      Application.ScreenUpdating = False\n\n  Set sDlg = ActiveWorkbook.DialogSheets.Add\n\nSheetCount = 0\n\n\ntPos = 40\n\n  For z = LBound(sNames) To UBound(sNames)\n  Set ws = sNames(z)\n\n    If Application.CountA(ws.Cells) &lt;&gt; 0 Then\n        SheetCount = SheetCount + 1\n        sDlg.CheckBoxes.Add 78, tPos, 150, 16.5\n            sDlg.CheckBoxes(SheetCount).Text = _\n                ws.Name\n        tPos = tPos + 13\n\n    End If\n\n   Set ws = Nothing\n  Next z\n\n   sDlg.Buttons.Left = 240\n\n   With sDlg.DialogFrame\n    .Height = Application.Max _\n        (68, sDlg.DialogFrame.Top + tPos - 34)\n    .Width = 230\n    .Caption = \"Select Stands to Open\"\n   End With\n\n\nsDlg.Buttons(\"Button 2\").BringToFront\nsDlg.Buttons(\"Button 3\").BringToFront\n\nIf SheetCount &lt;&gt; 0 Then\n    If sDlg.Show Then\n        For Each cb In sDlg.CheckBoxes\n            If cb.Value = xlOn Then\n             y = cb.Caption\n              With Sheets(y)\n               Debug.Print .Name\n\n               .Range(\"D7:D38\") = .Range(\"M7:M38\").Value\n\n               Set tbl = .Range(\"B6:P38\"): Set colm = .Range(\"M4\")\n\n               wb.Names.Add Name:=\"sTable\", RefersTo:=tbl\n               wb.Names.Add Name:=\"col\", RefersTo:=colm\n\n\n        .Range(\"E7\").Formula = \"=IFERROR(IF(VLOOKUP(B7,sTable,3,FALSE)&gt;=VLOOKUP(B7,parTable,col,FALSE),0,ROUND(SUM((VLOOKUP(B7,parTable,col,FALSE)-VLOOKUP(B7,sTable,3,FALSE))/VLOOKUP(B7,parTable,4,FALSE)),0)*VLOOKUP(B7,parTable,4,FALSE)),0)\"\n        .Range(\"E7\").Copy\n        .Range(\"E8:E38\").PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _\n          :=False, Transpose:=False\n           Application.CutCopyMode = False\n\n        .Range(\"E7:E38\").Copy\n        .Range(\"E7:E38\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n         :=False, Transpose:=False\n         Application.CutCopyMode = False\n\n        .Range(\"G7:M38,P43:P45\").ClearContents\n\n      wb.Names(\"sTable\").Delete\n      wb.Names(\"col\").Delete\n\n\n      Set tbl = Nothing: Set col1 = Nothing\n\n            End With\n            End If\n\n        Next cb\n    End If\nElse\n    MsgBox \"All worksheets are empty.\"\nEnd If\n sDlg.Delete\n\n\nFor I = LBound(invNames) To UBound(invNames)\n With invNames(I)\n   Debug.Print .Name\n     Set invRng = .Range(\"B56:I56\")\n\n     .Range(\"E55\").Value = 0\n\n      For x = 1 To invRng.Cells.Count\n       invRng.Cells(x) = \"\"\n      Next x\n    Set invRng = Nothing\n  End With\nNext I\n\n fbDate = InputBox(\"Please enter the new event date in the format of 2/3/2013.  This will be inserted onto the standsheets. And by the way... 2/3/2013 happens to be a past superbowl. Can you guess which one?\")\n fbEvent = InputBox(\"Please Enter the new event name. This will be inserted into the cell provided for Event Name\")\n\n  Sheet49.Range(\"B3\").Value = fbDate\n  Sheet49.Range(\"B4\").Value = fbEvent\n\n   Application.DisplayAlerts = True\n   Application.ScreenUpdating = True\n\n  MsgBox \"Your new event has been created... Don't mess anything up today Mark!  The Baltimore Ravens rule!!\"\n\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4982306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826156a6858058df00b0034f54857fd6?s=128&d=identicon&r=PG&f=1", "display_name": "xlJunkie", "link": "https://stackoverflow.com/users/4982306/xljunkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 32130282, "answer_count": 1, "score": 0, "last_activity_date": 1440114762, "creation_date": 1440027221, "question_id": 32107306, "link": "https://stackoverflow.com/questions/32107306/using-checkboxes-in-dialog-sheet-to-specify-sheets-to-perform-actions", "title": "Using Checkboxes in Dialog Sheet to Specify Sheets to Perform Actions", "body": "<p>I'm currently using the following code to reset an event/inventory/sales workbook.  However, I was hoping to find a way to have the user select (via dialog sheet or userform with checkboxes) which sheets need to be reset.  As it is right now, when the \"Create New Event\" button is clicked, every sheet in the sNames array is reset, but I would like for a dialog sheet or userform to popup which would allow the user to choose which sheets would be reset (aka... which ones that array would contain).  So the sheets being reset would not be fixed and/or could be different each time the \"Create new event\" macro is run.  In other words, the remaining code would stay the same, only the sheets included in the sNames array would change.  </p>\n\n<p>The full code that I have right now is as follows (Please note that this currently works, but the sheets being reset are fixed and/or are always the same)</p>\n\n<pre><code>Option Explicit\nSub Create_NewEvent()\n\nConst DBLSPACE As String = vbNewLine &amp; vbNewLine\nConst BESTNFL As String = DBLSPACE &amp; vbNewLine &amp; _\n\"The Baltimore Ravens Rule!\" &amp; _\n\"The Forty-Winers Do NOT\"\n\nConst openMSG As String = \"After pressing OK button this \" &amp; _\n \"will take some time.\" &amp; DBLSPACE &amp; \"Amount of time \" &amp; _\n \"depends on whether or not the Ravens have a winning record,\" &amp; _\n \"and whether or not...\" &amp; DBLSPACE &amp; _\n \"Just be patient! Root for the Ravens and...!\" &amp; BESTNFL\n\n    Dim w As Long, I As Long, x As Long, sNames As Variant, invNames As     Variant, colm As Range, tbl As Range, col1 As Range, invRng As Range\nDim wb As Workbook, ws As Worksheet, fbDate As Variant, fbEvent As Variant\nSet wb = ThisWorkbook\n\n\n\n'************************************IF YOU ADD A NEW STAND SHEET, PLEASE ADD THE SHEET NAME THIS ARRAY*********************************************************\nsNames = Array(Sheet1, Sheet3, Sheet5, Sheet7, Sheet9, Sheet13, _\n                   Sheet17, Sheet21, Sheet23, Sheet27, Sheet31, Sheet35, _\n                   Sheet39, Sheet43, Sheet47, Sheet54, Sheet56, _\n                   Sheet58, Sheet60, Sheet61, Sheet62, Sheet63, Sheet64, _\n                   Sheet65, Sheet82, Sheet83, Sheet84, Sheet85, Sheet90, _\n                   Sheet91, Sheet93, Sheet94)\n  '***************************************************************************************************************************************************************\n\n\n\n'*************************IF YOU ADD A NEW NPO INVOICE, PLEASE ADD THE SHEET NAME &amp; NUMBER IN THIS ARRAY********************************************************\n   invNames = Array(Sheet2, Sheet4, Sheet6, Sheet8, Sheet11, Sheet15, Sheet19, Sheet25, Sheet29, Sheet33, Sheet37, _\n                Sheet41, Sheet45, Sheet52, Sheet53, Sheet55, Sheet66, Sheet87)\n'***************************************************************************************************************************************************************\n\n\n\n\n   If MsgBox(\"Are you sure that you want to create a new event?\", vbYesNo, \"Confirm\") = vbYes Then\n\n    MsgBox openMSG\n\n      Application.DisplayAlerts = False\n      Application.ScreenUpdating = False\n\n    For w = LBound(sNames) To UBound(sNames)\n        With sNames(w)\n            Debug.Print .Name\n\n            .Range(\"D7:D38\") = .Range(\"M7:M38\").Value\n\n         Set tbl = .Range(\"B6:P38\"): Set colm = .Range(\"M4\")\n\n       ActiveWorkbook.Names.Add Name:=\"sTable\", RefersTo:=tbl\n       ActiveWorkbook.Names.Add Name:=\"col\", RefersTo:=colm\n\n\n        .Range(\"E7\").Formula = \"=IFERROR(IF(VLOOKUP(B7,sTable,3,FALSE)&gt;=VLOOKUP(B7,parTable,col,FALSE),0,ROUND(SUM((VLOOKUP(B7,parTable,col,FALSE)-VLOOKUP(B7,sTable,3,FALSE))/VLOOKUP(B7,parTable,4,FALSE)),0)*VLOOKUP(B7,parTable,4,FALSE)),0)\"\n        .Range(\"E7\").Copy\n        .Range(\"E8:E38\").PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _\n          :=False, Transpose:=False\n           Application.CutCopyMode = False\n\n        .Range(\"E7:E38\").Copy\n        .Range(\"E7:E38\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n         :=False, Transpose:=False\n         Application.CutCopyMode = False\n\n        .Range(\"G7:M38,P43:P45\").ClearContents\n\n      ActiveWorkbook.Names(\"sTable\").Delete\n      ActiveWorkbook.Names(\"col\").Delete\n\n\n      Set tbl = Nothing: Set col1 = Nothing\n\n    End With\nNext w\n\n\nFor I = LBound(invNames) To UBound(invNames)\n With invNames(I)\n   Debug.Print .Name\n     Set invRng = .Range(\"B56:I56\")\n\n     .Range(\"E55\").Value = 0\n\n      For x = 1 To invRng.Cells.Count\n       invRng.Cells(x) = \"\"\n      Next x\n    Set invRng = Nothing\n  End With\nNext I\n\n fbDate = InputBox(\"Please enter the new event date in the format of 2/3/2013.  This will be inserted onto the standsheets. And by the way... 2/3/2013 happens to be a past superbowl. Can you guess which one?\")\n fbEvent = InputBox(\"Please Enter the new event name. This will be inserted into the cell provided for Event Name\")\n\n  Sheet49.Range(\"B3\").Value = fbDate\n  Sheet49.Range(\"B4\").Value = fbEvent\n\n   Application.DisplayAlerts = True\n   Application.ScreenUpdating = True\n\n  MsgBox \"Your new event has been created... \n\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "shell", "excel", "cmd"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440026366, "post_id": 32107108, "comment_id": 52108678, "body": "Did you define <code>SW_SHOWNORMAL</code>?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 2, "creation_date": 1440026988, "post_id": 32107108, "comment_id": 52108830, "body": "Add <code>As Long</code> to the end of the declaration. You&#39;re returning a <code>Variant</code> because you haven&#39;t specified the return type so it doesn&#39;t match the function declaration in the DLL."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440027597, "post_id": 32107108, "comment_id": 52108998, "body": "Added as long and it now runs without the error."}], "answers": [{"comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440027143, "post_id": 32107270, "comment_id": 52108879, "body": "Not necessary. It will get cast to a long based on the function declaration."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1440027347, "post_id": 32107270, "comment_id": 52108939, "body": "Declared it as a long and still got the same error."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1440027409, "post_id": 32107270, "comment_id": 52108957, "body": "I think @Bond got it right.  You have not defined the return type <code>As Long</code> at the end of your <code>Declare</code> statement.  Well spotted. +1 for you..."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 1, "creation_date": 1440027770, "post_id": 32107270, "comment_id": 52109048, "body": "@jony I suggest you start another question for the new problem."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440028055, "post_id": 32107270, "comment_id": 52109116, "body": "Please upvote @Bond for his answer via comment so future visitors will get the benefits."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1440028486, "post_id": 32107270, "comment_id": 52109241, "body": "He needs to post an answer so that I can do that. (Is another way to upvote him?)"}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1440028583, "post_id": 32107270, "comment_id": 52109273, "body": "You can upvote the comment.  It is up to him if he wants to repost it as the answer."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1440028700, "post_id": 32107270, "comment_id": 52109309, "body": "Thank you for the information. I had never noticed that elusive feature!"}], "tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": true, "score": 2, "last_activity_date": 1440026972, "creation_date": 1440026972, "answer_id": 32107270, "question_id": 32107108, "link": "https://stackoverflow.com/questions/32107108/vba-how-to-use-shellexecute/32107270#32107270", "title": "VBA - How to use ShellExecute?", "body": "<p>There is a problem with the definition of <code>SW_SHOWNORMAL</code>. The way you have defined it assumes it is an <code>Integer</code> (default for VBA which is a 16 bit value) where it needs to be <code>Long</code> (32 bit value).</p>\n\n<p>Change your declaration to this:-</p>\n\n<p><code>Const SW_SHOWNORMAL As Long = 1</code></p>\n"}], "owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3412, "favorite_count": 0, "accepted_answer_id": 32107270, "answer_count": 1, "score": 0, "last_activity_date": 1440037742, "creation_date": 1440025958, "last_edit_date": 1531164843, "question_id": 32107108, "link": "https://stackoverflow.com/questions/32107108/vba-how-to-use-shellexecute", "title": "VBA - How to use ShellExecute?", "body": "<p>I'm trying to  get the computer to sleep through excel VBA. For that to happen I need to disable hybernation which can only be done with elevated permissions. So I'm trying ShellExecute - following Microsoft's instructions on <a href=\"https://support.microsoft.com/en-us/kb/170918\" rel=\"nofollow\">this page</a>, but I'm getting an runtime error ('49' Bad DLL calling convention).</p>\n\n<p>Edit:\nChanged the code and it works now, but the parameters are incorrect.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" ( _\n                                                             ByVal hwnd As Long, _\n                                                             ByVal lpszOp As String, _\n                                                             ByVal lpszFile As String, _\n                                                             ByVal lpszParams As String, _\n                                                             ByVal lpszDir As String, _\n                                                             ByVal FsShowCmd As Long) as long\nConst SW_SHOWNORMAL as long = 1\nSub DoSleep()\n    ShellExecute 0, \"runas\", \"C:\\WINDOWS\\System32\\rundll32.exe\", \"powercfg -h off\", \"C:\\\", SW_SHOWNORMAL\n    Shell \"C:\\WINDOWS\\System32\\rundll32.exe powrprof.dll,SetSuspendState 0,1,0\"\n    ShellExecute 0, \"runas\", \"C:\\WINDOWS\\System32\\rundll32.exe\", \"powercfg -h on\", \"C:\\\", SW_SHOWNORMAL\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "web-scraping", "getelementbyid", "getelementsbytagname", "getelementsbyclassname"], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1440025695, "creation_date": 1440025695, "answer_id": 32107067, "question_id": 32106864, "link": "https://stackoverflow.com/questions/32106864/extracting-text-from-html-table/32107067#32107067", "title": "Extracting text from HTML table", "body": "<p><code>getElementById()</code> should be all you need, since the node has an ID attribute. You may be having an issue because you're trying to assign <code>responseText</code> to the document body but the document doesn't have a <code>&lt;body&gt;</code> node yet. Just use <code>write()</code> to write the entire response into the empty document. Here's an example I threw together that returns the proper value:</p>\n\n<pre><code>Dim objHttp\nSet objHttp = CreateObject(\"MSXML2.XMLHTTP\")\nobjHttp.Open \"GET\", \"http://partsurfer.hp.com/Search.aspx?searchText=4CE0460D0G\", False\nobjHttp.Send\n\nDim doc\nSet doc = CreateObject(\"htmlfile\")\ndoc.write objHttp.responseText\n\nMsgBox doc.getElementById(\"ctl00_BodyContentPlaceHolder_lblSerialNumber\").innerText\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>4CE0460D0G\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 1230679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bf2424f454ebcb6a93b537ddaf0b921e?s=128&d=identicon&r=PG", "display_name": "jquerynewbie", "link": "https://stackoverflow.com/users/1230679/jquerynewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "accepted_answer_id": 32107067, "answer_count": 1, "score": 0, "last_activity_date": 1480002068, "creation_date": 1440024491, "last_edit_date": 1480002068, "question_id": 32106864, "link": "https://stackoverflow.com/questions/32106864/extracting-text-from-html-table", "title": "Extracting text from HTML table", "body": "<p>I'm trying to extract various elements from this page:</p>\n\n<p><a href=\"http://partsurfer.hp.com/Search.aspx?searchText=4CE0460D0G\" rel=\"nofollow\">http://partsurfer.hp.com/Search.aspx?searchText=4CE0460D0G</a></p>\n\n<p>I want to start with <code>ctl00_BodyContentPlaceHolder_lblSerialNumber</code>.</p>\n\n<p>Surely there must be an easy solution to extract elements you want from the HTML page if you know the ID? I thought something like <code>getElementsByName</code> or <code>getElementById</code> or even <code>getElementsByTagName</code> would work but I cannot get it to extract what I want, try as I might!</p>\n\n<p>This doesn't work:</p>\n\n<pre><code> Function GetHPModelName()\n\n     Dim ie As Object\n        Dim Oelement As Object\n        Dim Ohtml As New MSHTML.HTMLDocument\n        Dim lrow As Integer\n\n        With CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n        .Open \"GET\", \"http://partsurfer.hp.com/Search.aspx?searchText=\" &amp; Worksheets(\"HP_Lookup\").Range(\"A2\").Value, False\n        .send\n        Ohtml.body.innerHTML = .responseText\n\n        End With\n\n\n    FetchHPInfo \"ctl00_BodyContentPlaceHolder_lblSerialNumber\", \"A\", Oelement, Ohtml \nEnd Function\n</code></pre>\n\n<p>Calling</p>\n\n<pre><code>Public Function FetchHPInfo(tablename As String, thiscolumn As String, Oelement As Object, Ohtml As MSHTML.HTMLDocument)\nlrow = 1\nFor Each Oelement In Ohtml.getElementsById(tablename)\n    Worksheets(\"HP_main\").Range(thiscolumn &amp; lrow).Value = Oelement.innerText\n    lrow = lrow + 1\n    Next Oelement\n    Worksheets(\"HP_main\").Columns(thiscolumn).cells.HorizontalAlignment = xlHAlignLeft\n    Worksheets(\"HP_main\").Columns(thiscolumn).AutoFit\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 4253, "user_id": 1715367, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/44b6d47c80295643b1aa5a4ad860d8bb?s=128&d=identicon&r=PG", "display_name": "taswyn", "link": "https://stackoverflow.com/users/1715367/taswyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1440022697, "creation_date": 1440022697, "answer_id": 32106570, "question_id": 32106569, "link": "https://stackoverflow.com/questions/32106569/how-can-i-macro-appointment-creation-in-outlook-2013-with-user-selected-times-fo/32106570#32106570", "title": "How can I macro Appointment creation in Outlook 2013 with user selected times for pre-set Subjects?", "body": "<h2>The problem with Office 2007 macro code relying on CommandBar actions is that Office 2010 and forward no longer use CommandBars.</h2>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/Ff865324.aspx\" rel=\"nofollow\">This Office DevCenter article</a> describes how to update code that previously relied on <code>CommandBars</code> to instead use the ribbon extensibility. Yay, deprecation!</p>\n\n<p>But wait! Before we tread down that path of refactoring, let's revisit why the macro is using <code>CommandBars</code> in the first place: in Office 2007 and prior, there was no way to get enough information back from a user selection <em>itself</em>\u2014you could only operate on items themselves within the selection, which doesn't work for finding the start and stop times of a blank span of time that has been selected in the Calendar.</p>\n\n<p>So the macro was relying on firing a New Appointment from the menu (called using <code>CommandBars</code>), which would automatically be populating the start and stop time from the user selection because that's how the New Appointment command from the Outlook menu works.</p>\n\n<p>Office 2010 apparently changed that.</p>\n\n<h2>You can now directly reference user selections of [blank] spans of time made in the Calendar pane.</h2>\n\n<p>All we need to do is take the <code>.SelectedStartTime</code> and <code>.SelectedEndTime</code> from the <code>CalendarView</code> and apply them to our new Appointment. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869571.aspx\" rel=\"nofollow\">CalendarView.SelectedStartTime Property (Outlook)</a> article in the Office Dev Center not only lays this out explicitly, but even comes with example code.</p>\n\n<p>Some light modifications to that code result in a private sub that we can use as a drop in for the previous macro, to be called by the publicly exposed specific macros.</p>\n\n<p>The code below has minor changes from the code originally detailed in that page, which are: adding parameters, adding the <code>With</code> segment to apply them, and saving the new appointment directly to the calendar instead of only opening it for view/editing. And slightly better formatting.</p>\n\n<pre><code>Private Sub CreateAppointmentUsingSelectedTime(strSubject, strCategories, strLocation, strBody, bolRemindMe, intRemindMe)\n Dim datStart As Date\n Dim datEnd As Date\n Dim oView As Outlook.View\n Dim oCalView As Outlook.CalendarView\n Dim oExpl As Outlook.Explorer\n Dim oFolder As Outlook.Folder\n Dim oAppt As Outlook.AppointmentItem\n Const datNull As Date = #1/1/4501#\n\n ' Obtain the calendar view using\n ' Application.ActiveExplorer.CurrentFolder.CurrentView.\n ' If you use oExpl.CurrentFolder.CurrentView,\n ' this code will not operate as expected.\n Set oExpl = Application.ActiveExplorer\n Set oFolder = Application.ActiveExplorer.CurrentFolder\n Set oView = oExpl.CurrentView\n\n ' Check whether the active explorer is displaying a calendar view.\n If oView.ViewType = olCalendarView Then\n    Set oCalView = oExpl.CurrentView\n    ' Create the appointment using the values in\n    ' the SelectedStartTime and SelectedEndTime properties as\n    ' appointment start and end times.\n    datStart = oCalView.SelectedStartTime\n    datEnd = oCalView.SelectedEndTime\n    Set oAppt = oFolder.Items.Add(\"IPM.Appointment\")\n    With oAppt\n       .Subject = strSubject\n       .Location = strLocation\n       .Categories = strCategories\n       .ReminderSet = bolRemindMe\n       .Body = strBody\n       If bolRemindMe = True Then\n           .ReminderMinutesBeforeStart = intRemindMe\n       End If\n    End With\n    If datStart &lt;&gt; datNull And datEnd &lt;&gt; datNull Then\n       oAppt.Start = datStart\n       oAppt.End = datEnd\n    End If\n    oAppt.Save\n    ' oAppt.Display\n End If\nEnd Sub\n</code></pre>\n\n<p>Hopefully this helps someone else, because I spent far longer (mostly futiley searching, hence being about to post this as just a question before finally isolating the issues and solution) on it than I expected to, or even than it probably will ever save me, time-wise, in creating new pre-set appointments!</p>\n"}], "owner": {"reputation": 4253, "user_id": 1715367, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/44b6d47c80295643b1aa5a4ad860d8bb?s=128&d=identicon&r=PG", "display_name": "taswyn", "link": "https://stackoverflow.com/users/1715367/taswyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "accepted_answer_id": 32106570, "answer_count": 1, "score": 0, "last_activity_date": 1593517282, "creation_date": 1440022697, "last_edit_date": 1593517282, "question_id": 32106569, "link": "https://stackoverflow.com/questions/32106569/how-can-i-macro-appointment-creation-in-outlook-2013-with-user-selected-times-fo", "title": "How can I macro Appointment creation in Outlook 2013 with user selected times for pre-set Subjects?", "body": "<p>I have a very nice VBA appointment macro I found posted online ages ago for creating new appointments with pre-set parameters at a <strong>user selected</strong> time and date in the calendar.</p>\n\n<p>It worked so well in Office 2007, but then we were recently moved to Office 2013 for an institutional shift to using Office 365 Enterprise (Educational). And it totally broke. Permissions are fine so it is actually running (finally: tested via stepping into it via debugger) but it's still not doing anything\u2026 not even throwing errors.</p>\n\n<p>Here's the code for the macro:</p>\n\n<pre><code>Private Sub CreateAppt(strSubject, strCategories, strLocation, strBody, bolRemindMe, intRemindMe)\n\n    Dim objExpl As Outlook.Explorer\n    Dim objFolder As Outlook.MAPIFolder\n    Dim objCB As Office.CommandBarButton\n    Dim objAppt As Outlook.AppointmentItem\n    Dim objApptCustom As Outlook.AppointmentItem\n    On Error Resume Next\n\n    Set objExpl = Outlook.Application.ActiveExplorer\n    If Not objExpl Is Nothing Then\n        Set objFolder = objExpl.CurrentFolder\n        If objFolder.DefaultItemType = olAppointmentItem Then\n            Set objCB = objExpl.CommandBars.FindControl(, 1106)\n            If Not objCB Is Nothing Then\n                objCB.Execute\n                Set objAppt = Outlook.Application.ActiveInspector.CurrentItem\n                Set objApptCustom = objFolder.Items.Add(olAppointmentItem)\n                With objApptCustom\n                    .Start = objAppt.Start\n                    .End = objAppt.End\n                    .Subject = strSubject\n                    .Location = strLocation\n                    .Categories = strCategories\n                    .ReminderSet = bolRemindMe\n                    .Body = strBody\n                    If bolRemindMe = True Then\n                        .ReminderMinutesBeforeStart = intRemindMe\n                    End If\n                    .Save\n                End With\n                objAppt.Delete\n            End If\n        End If\n    End If\n\n    Set objCB = Nothing\n    Set objAppt = Nothing\n    Set objApptCustom = Nothing\n    Set objFolder = Nothing\n    Set objExpl = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This was called by exposed macros that populated the function's parameters appropriately, for example:</p>\n\n<pre><code>Sub NewSupport()\n\nCall CreateAppt(\"CMS Open Support\", \"Support\", \"Roberts 109\", \"\", True, 20)\n\nEnd Sub\n</code></pre>\n\n<p>I've tried explicitly referencing the Outlook.Application for the ActiveInspector, I've tried using the global supplied constant (<code>olAppointmentItem</code>) for an Item type instead of the string <code>\"IPM.Appointment\"</code>.</p>\n\n<p>I've also tried using some code to iterate through available Commands and CommandBars, in case the ID for <code>Commandbars.FindControl(, 1106)</code> changed between versions, and all I'm getting back is \"Task Pane\" under Inspector for Appointment, with ID 5746.</p>\n\n<p>I feel like I'm running out of ideas: even just something pointing me in the right direction for new things to try would be great at this point.</p>\n\n<p>Recurring appointments won't work, as those require some form of regular structure to the recurrence, which isn't the case for this.</p>\n\n<p>A custom form might be a solution, but I really prefer just being able to click a single button to schedule that span of time for the specific appointment \"type\" and never having to even open the appointment directly at all.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440022521, "post_id": 32106467, "comment_id": 52107586, "body": "Don&#39;t copy/paste but to answer, you need <code>Destination:=Worksheets(&quot;sheet2&quot;).Rows(erow+1)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440023059, "post_id": 32106467, "comment_id": 52107774, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/12837297/how-to-copy-rows-from-one-excel-sheet-to-another-and-create-duplicates-using-vba\">How to copy rows from one excel sheet to another and create duplicates using VBA?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440023145, "post_id": 32106467, "comment_id": 52107804, "body": "@findwindow - <code>erow</code> is already sequenced to a new blank row with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow noreferrer\">Range.Offset property</a>."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440023371, "post_id": 32106467, "comment_id": 52107871, "body": "You know @Jeeped, not everyone is a codewarrior like you who can read code UNFORMATTED as it was like you can =P Btw, tangent, but wanna do me a favor and solve <a href=\"http://stackoverflow.com/questions/32012834/delete-excel-file\">this</a> for me please?"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440023474, "post_id": 32106596, "comment_id": 52107903, "body": "I was close =P I knew it had to do with incrementing erow. Edit: I am surprised you kept copy/paste. Why not just set row to row? Isn&#39;t that faster?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1440024017, "post_id": 32106596, "comment_id": 52108058, "body": "You never know when bringing along formatting is essential and .Value transfer won&#39;t do that. If an OP uses copy, then I stick with it; if it is a Copy, Paste Special, Values then I move to value transfer."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440024168, "post_id": 32106596, "comment_id": 52108101, "body": "Teach me to be like you~"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440025493, "post_id": 32106596, "comment_id": 52108454, "body": "Lately, I&#39;ve been playing around with <code>erow = Sheet2.Cells(Rows.Count, 1).End(xlUp)(2).Row</code> which seems to give consistent results in getting the next blank row. Make the code a little shorter but you will probably have to explain it a hundred times in a hundred questions."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440079932, "post_id": 32106596, "comment_id": 52133577, "body": "Can you explain it to me =P I get it until (2).row. Before that, you get the last row so what&#39;s the 2 doing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440082583, "post_id": 32106596, "comment_id": 52135553, "body": "Well <code>B2:C3</code> has 4 cells right? What happens if you ask for a cell index that is larger than 4? Try this - <code>Dim i As Long: For i = 1 To 10: Debug.Print Range(&quot;B2:C3&quot;)(i).Address(0, 0): Next i</code>."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083098, "post_id": 32106596, "comment_id": 52135963, "body": "You go over but still can&#39;t tell what 2 is doing. Edit: I don&#39;t know what second index of a cell means XD"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083252, "post_id": 32106596, "comment_id": 52136067, "body": "The <code>Sheet2.Cells(Rows.Count, 1).End(xlUp)</code> is a single cell. The <code>(2)</code> is saying the next cell which happens to be the one directly below it. The <code>.Row</code> is the row number of that cell. And that is why I don&#39;t use it in code posted here because it requires too much of an explanation."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083299, "post_id": 32106596, "comment_id": 52136107, "body": "Ahh see, to me, it makes more logical sense to be (1) like x=x+1 but I guess with index, 1 is itself XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083511, "post_id": 32106596, "comment_id": 52136277, "body": "Hmm when do you use an index? I mean, how is using second index superior than +1? If you&#39;re worried about explaining, +1 makes far more sense =P"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083787, "post_id": 32106596, "comment_id": 52136467, "body": "Actually to me, the more verbose <code>.Offset(1, 0)</code> makes more sense but it is all a matter of programming preferences. I try to use <code>vbNullString</code> instead of <code>&quot;&quot;</code> even though it takes more typing. Some say that <code>vbNullString</code> is faster but if that minute amount of speed is important then why are you in VBA to begin with?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083868, "post_id": 32106596, "comment_id": 52136522, "body": "Oh ok. So it&#39;s more just how people think XD Thanks!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440083960, "post_id": 32106596, "comment_id": 52136585, "body": "Well, you can&#39;t C++ in Excel XD"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1440022830, "last_edit_date": 1495541677, "creation_date": 1440022830, "answer_id": 32106596, "question_id": 32106467, "link": "https://stackoverflow.com/questions/32106467/copy-an-entire-row-from-1-worksheet-to-another/32106596#32106596", "title": "Copy an entire row from 1 worksheet to another", "body": "<p>Avoid using <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221681(v=office.11).aspx\" rel=\"nofollow noreferrer\">Range .Activate method</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838003.aspx\" rel=\"nofollow noreferrer\">Worksheet.Activate method</a> altogether. You only need to specify the first cell in a multi-cell paste.</p>\n\n<pre><code>Sub mybus()\n    Dim x As Long, erow As Long\n\n    x = 2\n\n    With Workbooks(\"book1\").Worksheets(\"Sheet2\")\n        erow = .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    End With\n\n    With Workbooks(\"book1\").Worksheets(\"Sheet1\")\n        Do While Cells(x, 1) &lt;&gt; \"\"\n            'look for data with \"bus\"\n            If Cells(x, 1).Value = \"bus\" Then\n                'copy the entire row if it contains bus to Sheet2's erow\n                .Rows(x).Copy _\n                   Destination:=.Parent.Worksheets(\"sheet2\").Cells(erow, 1)\n                'sequence erow to a new blank row\n                erow = erow + 1\n            End If\n            x = x + 1\n        Loop\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}], "owner": {"reputation": 1, "user_id": 5245223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b7a80f14e843ccc3e8bb02e90bc04b?s=128&d=identicon&r=PG&f=1", "display_name": "NoeBol", "link": "https://stackoverflow.com/users/5245223/noebol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440022942, "creation_date": 1440022222, "last_edit_date": 1440022942, "question_id": 32106467, "link": "https://stackoverflow.com/questions/32106467/copy-an-entire-row-from-1-worksheet-to-another", "title": "Copy an entire row from 1 worksheet to another", "body": "<p>I had some code sent below but cant get it to work.</p>\n\n<pre><code>Sub mybus()\n    Dim x As Long\n\n    x = 2\n\n    'start the loop\n    Do While Cells(x, 1) &lt;&gt; \"\"\n        'look for data with \"bus\"\n        If Cells(x, 1).Value = \"bus\" Then\n            'copy the entire row if it contains bus\n            Workbooks(\"book1\").Worksheets(\"Sheet1\").Rows(x).Copy\n            'Go to sheet 2 activate it, we want the data here\n            Workbooks(\"book1\").Worksheets(\"Sheet2\").Activate\n            'Find the first empty row in sheet2\n            erow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n            'paste the data here\n            ActiveSheet.Paste Destination:=Worksheets(\"sheet2\").Rows(erow)\n        End If\n        'go to sheet1 again and activate it\n        Worksheets(\"Sheet1\").Activate\n        x = x + 1\n\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "reference"], "comments": [{"owner": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "edited": false, "score": 0, "creation_date": 1440018459, "post_id": 32105646, "comment_id": 52105871, "body": "not sure if you checked here but i think this may help: <a href=\"http://www.mrexcel.com/forum/excel-questions/87334-automatically-add-solver-reference-visual-basic-applications.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440023092, "post_id": 32105646, "comment_id": 52107784, "body": "Can you show a few lines of your solver-related code?  You should be able to use late binding to resolve this problem."}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440018271, "creation_date": 1440018271, "question_id": 32105646, "link": "https://stackoverflow.com/questions/32105646/cant-find-project-or-library-error-message", "title": "Can&#39;t find project or library error message", "body": "<p>I am running an add-in that uses solver as reference. Moving this add-in to a computer that has no reference to solver causes the following error message:</p>\n\n<pre><code>Can't find project or library \n</code></pre>\n\n<p>So I was trying to execute a routine to automatically add solver. But the problem is the routine is not even initialized, even if I place the routine inside the workbook_open event (to run when the add-in is opened), Excel shows this message. The whole project do not run because because of this missing reference. How can I deal with this problem if I am not able to run a code to deal with it?   </p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440023881, "post_id": 32105529, "comment_id": 52108007, "body": "Your link requires a user to &quot;request access&quot; - would be better if we didn&#39;t have to do that...."}, {"owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440075766, "post_id": 32105529, "comment_id": 52130351, "body": "@Tim Williams You&#39;re right, I changed it so that anyone with the link should be able to see it now. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "edited": false, "score": 0, "creation_date": 1440082199, "post_id": 32106978, "comment_id": 52135227, "body": "Thank you, this seems to be working. I made some minor modifications, which I&#39;ve posted to my original post as an edit if you&#39;re curious."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1440049972, "last_edit_date": 1440049972, "creation_date": 1440025139, "answer_id": 32106978, "question_id": 32105529, "link": "https://stackoverflow.com/questions/32105529/summary-report-modifying-solution/32106978#32106978", "title": "Summary Report: Modifying Solution", "body": "<p>You could try something like this:</p>\n\n<pre><code>'Type to track data for each of the bit positions (event types)\nPublic Type flag\n    tStart As Variant  'flag start time\n    tLast As Variant   'last event time\n    Count As Long      'number of 1's\nEnd Type\n\nSub Report()\n\n    Dim flags() As flag\n    Dim c As Range, nF As Long, i As Long, v, f, t\n    Dim shtReport As Worksheet, bContinue As Boolean\n\n    Set shtReport = ThisWorkbook.Sheets(\"Report\")\n    Set c = Sheet1.Range(\"B2\")\n    nF = Len(c.Value)\n    ReDim flags(1 To nF)\n    bContinue = True\n\n    Do\n        v = c.Value               'bitstring\n        t = c.Offset(0, -1).Value 'timestamp\n\n        If Len(v) = 0 Then\n            'No more data, so insert a \"dummy\" value to trigger\n            ' writing out any current \"events\"\n            v = String(nF, \"0\")\n            bContinue = False\n        End If\n\n        'loop over each \"bit\" in the string\n        For i = 1 To nF\n            f = Mid(v, i, 1)\n            If f = \"1\" Then\n                'first instance of this flag ?\n                If flags(i).Count = 0 Then\n                    flags(i).tStart = t 'event begins - set start time\n                Else\n                    flags(i).tLast = t 'event continues - set \"last\" time\n                End If\n                flags(i).Count = flags(i).Count + 1\n            End If\n            If f = \"0\" Then\n                'end of a run of 5 or more 1's ?\n                If flags(i).Count &gt;= 5 Then\n                    'write event to Report sheet\n                    With shtReport.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n                        .Value = \"Flag#:\" &amp; i\n                        .Offset(0, 1).Value = flags(i).tStart\n                        .Offset(0, 2).Value = flags(i).tLast\n                    End With\n                End If\n                flags(i).Count = 0\n            End If\n        Next i\n\n        Set c = c.Offset(1, 0)\n\n    Loop While bContinue\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: fixed up a couple of typos and accounted for what happens at the end of the data if there are events \"ongoing\"</p>\n"}], "owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 32106978, "answer_count": 1, "score": 0, "last_activity_date": 1462532540, "creation_date": 1440017780, "last_edit_date": 1495535288, "question_id": 32105529, "link": "https://stackoverflow.com/questions/32105529/summary-report-modifying-solution", "title": "Summary Report: Modifying Solution", "body": "<p>This is a follow up to a question found <a href=\"https://stackoverflow.com/questions/31747896/searching-column-for-consecutive-values-and-returning-three-different-values-to/31749320?noredirect=1#comment52104446_31749320\">here</a>.</p>\n\n<p>The solution provided by Grade 'Eh' Bacon assumed that each decimal code corresponded to a specific status, however that is not the case. The decimal code must first be converted to binary and each bit corresponds to a specific description. So, for example, 0000000000000001 would correspond to just one status \"Idle Cutout Active\", and 0000000001000001 would correspond to two statuses \"High Coolant Temperature\" <em>and</em> \"Idle Cutout Active\".</p>\n\n<p>I've devised a way to split the 16-bit string into each bit and populate a series of columns such that my data looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TZ3A6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TZ3A6.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Note:</strong> The data continues well beyond the row that can be seen in the image above; it goes until Row 8651.   </p>\n\n<p>Is there a way that this solution could be modified to count the 1s columns D through S rather than look at the decimal code in Column B?. I imagine this would result in a great number of columns being used, so perhaps there's a more optimal way to do what I'm trying to get done. To reiterate, what I want to do is find the Start and End time of five or more consecutive 1s with timestamps that are within 2 minutes of eachtoher, and have the corresponding descriptor appear with that Start and End time stamp so that I can achieve a more readable format for the data that appears above. It'd look something like: </p>\n\n<p><a href=\"https://i.stack.imgur.com/Nj62Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nj62Q.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, is there a way to modify the current solution or should I consider an entirely new solution? If the later, what would you recommend?</p>\n\n<p><strong>To Experiment:</strong></p>\n\n<p>I've put together a sample Workbook with Grade 'Eh' Bacon's solution implemented and an example of the data that I'm working with. The workbook can be downloaded from <a href=\"https://drive.google.com/open?id=0B_fZnVjXU9YANlpCXzFlaUVwSXM\" rel=\"nofollow noreferrer\">here</a>.     </p>\n\n<p>Thank you,</p>\n\n<p>Dan</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>I've altered the code Tim Williams posted to suit my needs, and also added some functionality to make it better for what I'm doing. The file on Google Drive has the updated code in full, but to summarize I made some slight alterations to Tim's code so that it fit the data I had and then wrote two additional subs. The first is to replace all the various \"Flag#:XX\" values that appear when the code is run with the engine status descriptors, and the other is to sort the values by their start time stamps. Here's what his code looks like with the alterations that I made:</p>\n\n<pre><code>Public Type flag\n        tStart As Variant  'flag start time\n        tLast As Variant   'last event time\n        Count As Long      'number of 1's\nEnd Type\nSub Report()\n'Type to track data for each of the bit positions (event types)\n\n    Dim flags() As flag\n    Dim c As Range, nF As Long, i As Long, v, f, t\n    Dim shtReport As Worksheet, bContinue As Boolean\n\n    Set shtReport = ThisWorkbook.Sheets(\"Technician Report Summary\")\n    Set c = Sheets(\"RAW DATA\").Range(\"C2\")\n    nF = Len(c.Value)\n    ReDim flags(1 To nF)\n    bContinue = True\n\n    Do\n        v = c.Value               'bitstring\n        t = c.Offset(0, -2).Value 'timestamp\n\n        If Len(v) = 0 Then\n            'No more data, so insert a \"dummy\" value to trigger\n            ' writing out any current \"events\"\n            v = String(nF, \"0\")\n            bContinue = False\n        End If\n\n        'loop over each \"bit\" in the string\n        For i = 1 To nF\n            f = Mid(v, i, 1)\n            If f = \"1\" Then\n                'first instance of this flag ?\n                If flags(i).Count = 0 Then\n                    flags(i).tStart = t 'event begins - set start time\n                Else\n                    flags(i).tLast = t 'event continues - set \"last\" time\n                End If\n                flags(i).Count = flags(i).Count + 1\n            End If\n            If f = \"0\" Then\n                'end of a run of 5 or more 1's ?\n                If flags(i).Count &gt;= 5 Then\n                    'write event to Report sheet\n                    With shtReport.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n                        .Value = \"Flag#:\" &amp; i\n                        .Offset(0, 1).Value = flags(i).tStart\n                        .Offset(0, 2).Value = flags(i).tLast\n                    End With\n                End If\n                flags(i).Count = 0\n            End If\n        Next i\n\n        Set c = c.Offset(1, 0)\n\n    Loop While bContinue\n    Call Sort\n    Call FindAndReplace\n\nEnd Sub\n</code></pre>\n\n<p>I think it now does what I'm looking for. I'll verify further, but as it stands I think I've found a solution that works. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1440019009, "post_id": 32105314, "comment_id": 52106121, "body": "Not sure the urgency or your willingness to give up but ... You could always make a loop that goes through each row deleting one at a time. I never used that command you are, if you run it  multiple times does it do anything? Maybe it has some weird limit of 4 entire rows or something..."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1440019204, "post_id": 32105314, "comment_id": 52106206, "body": "I suspect this has something to do with when copying and pasting as value, even if the formula had a 0 length output it is still not considered <code>EMPTY</code> by excel. You might have to add a loop that cycles through your &quot;Approved&quot; column range and if the output is = &quot;&quot; (different then being empty) you can append it to a range. Once your loop is done you can have VBA delete all the rows for that range in one fell swoop. Cheers"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440028376, "post_id": 32105314, "comment_id": 52109213, "body": "Shouldn&#39;t you be be searching for &quot;Approve&quot; in <code>A1:Z1</code>? What is the point of looking through the other 4 rows?"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1440022343, "last_edit_date": 1495540682, "creation_date": 1440022343, "answer_id": 32106495, "question_id": 32105314, "link": "https://stackoverflow.com/questions/32105314/delete-row-if-cell-in-changing-column-is-blank/32106495#32106495", "title": "Delete row if cell in changing column is blank", "body": "<p>Try this (based on <a href=\"https://stackoverflow.com/a/30959316/4914662\">delete rows optimization</a> solution)</p>\n\n<pre><code>Option Explicit\n\nSub deleteRowsWithBlanks()\n    Const KEY_STRING As String = \"Approve\"\n    Dim oldWs As Worksheet, newWs As Worksheet, rowHeights() As Long\n    Dim wsName As String, rng As Range, filterCol As Long\n\n    Set oldWs = ActiveSheet\n    wsName = oldWs.Name\n    Set rng = oldWs.Range(\"A1:Z5\")\n    filterCol = getHeaderColumn(rng, KEY_STRING, True)\n\n    If filterCol &gt; 0 Then\n        FastWB True\n        If rng.Rows.Count &gt; 1 Then\n            Set newWs = Sheets.Add(After:=oldWs)\n            With oldWs.UsedRange\n                .AutoFilter Field:=filterCol, Criteria1:=\"&lt;&gt;\"\n                .Copy\n            End With\n            With newWs.Cells\n                .PasteSpecial xlPasteColumnWidths\n                .PasteSpecial xlPasteAll\n                .Cells(1, 1).Select\n                .Cells(1, 1).Copy\n            End With\n            oldWs.Delete\n            newWs.Name = wsName\n        End If\n        FastWB False\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Helper functions:</p>\n\n<pre><code>Public Function getHeaderColumn(ByVal rng As Range, ByVal headerName As String, _\n                                Optional matchLtrCase As Boolean = True) As Long\n    Dim found As Range, foundCol As Long\n\n    If Not rng Is Nothing Then\n        headerName = Trim(headerName)\n        If Len(headerName) &gt; 0 Then\n            Set found = rng.Find(What:=headerName, MatchCase:=matchLtrCase, _\n                                 LookIn:=xlFormulas, LookAt:=xlWhole)\n            If Not found Is Nothing Then foundCol = found.Column\n        End If\n    End If\n    getHeaderColumn = foundCol\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub FastWB(Optional ByVal opt As Boolean = True)\n    With Application\n        .Calculation = IIf(opt, xlCalculationManual, xlCalculationAutomatic)\n        .DisplayAlerts = Not opt\n        .DisplayStatusBar = Not opt\n        .EnableAnimations = Not opt\n        .EnableEvents = Not opt\n        .ScreenUpdating = Not opt\n    End With\n    FastWS , opt\nEnd Sub\n\nPublic Sub FastWS(Optional ByVal ws As Worksheet = Nothing, _\n                  Optional ByVal opt As Boolean = True)\n    If ws Is Nothing Then\n        For Each ws In Application.ActiveWorkbook.Sheets\n            EnableWS ws, opt\n        Next\n    Else\n        EnableWS ws, opt\n    End If\nEnd Sub\nPrivate Sub EnableWS(ByVal ws As Worksheet, ByVal opt As Boolean)\n    With ws\n        .DisplayPageBreaks = False\n        .EnableCalculation = Not opt\n        .EnableFormatConditionsCalculation = Not opt\n        .EnablePivotTable = Not opt\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5245044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c9003198faf5c012e1575cb6dd5165?s=128&d=identicon&r=PG&f=1", "display_name": "thorspinkhammer", "link": "https://stackoverflow.com/users/5245044/thorspinkhammer"}, "edited": false, "score": 0, "creation_date": 1440535070, "post_id": 32107591, "comment_id": 52311046, "body": "Thanks, this is exactly what I needed!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1440029258, "creation_date": 1440029258, "answer_id": 32107591, "question_id": 32105314, "link": "https://stackoverflow.com/questions/32105314/delete-row-if-cell-in-changing-column-is-blank/32107591#32107591", "title": "Delete row if cell in changing column is blank", "body": "<p>If you have zero-length strings returned by formulas, it is not sufficient to revert the formula results to their values. You need to quickly sweep the column with a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow\">Range.TextToColumns method</a>, using Fixed Width and returning the column's values back to their original cells to make the cells truly blank.</p>\n\n<pre><code>Sub DeleteCol()\n    Dim iCOL As Long, sFND As String\n\n    With ActiveSheet\n        With .Range(.Cells(1, 1), .Cells(1, 1).SpecialCells(xlLastCell))\n            .Value = .Value\n        End With\n        sFND = \"Approve\"\n\n        If CBool(Application.CountIf(.Rows(1), sFND)) Then\n            iCOL = Application.Match(sFND, .Rows(1), 0)\n            If CBool(Application.CountBlank(.Columns(iCOL))) Then\n                With .Columns(iCOL)\n                    .TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, _\n                                   FieldInfo:=Array(0, 1)\n                    .SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n                End With\n            End If\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The worksheet's <a href=\"https://support.office.com/en-au/article/countblank-function-c72134a2-695e-43ab-a3f3-714aa770f385\" rel=\"nofollow\">COUNTBLANK function</a> will count zero-length strings in its blank count so we can determine whether there are blank cells before proceeding. The same goes for using the <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow\">COUNTIF function</a> to make sure that there is a column header with 'Approve' in the first row.</p>\n"}], "owner": {"reputation": 3, "user_id": 5245044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c9003198faf5c012e1575cb6dd5165?s=128&d=identicon&r=PG&f=1", "display_name": "thorspinkhammer", "link": "https://stackoverflow.com/users/5245044/thorspinkhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 32107591, "answer_count": 2, "score": 0, "last_activity_date": 1440545744, "creation_date": 1440016990, "last_edit_date": 1440545744, "question_id": 32105314, "link": "https://stackoverflow.com/questions/32105314/delete-row-if-cell-in-changing-column-is-blank", "title": "Delete row if cell in changing column is blank", "body": "<p>This is is Excel 2010 on Windows 7.</p>\n\n<p>I receive spreadsheets where one of the columns is called \"Approved.\" This column is filled with x's and blanks. I want to delete all rows that have blanks in that column. This is a simple problem but has two confounding issues:</p>\n\n<ol>\n<li>The location of the Approved column changes, so I can't just do Columns(\"R\").SpecialCells(xlBlanks).EntireRow.Delete. I try to get around this by searching for \"Approve\" in A1:Z5 (since there are always fewer than 26 rows), and selecting the column in which it is found. </li>\n<li>Much of the data is pulled from a previous month's document so some of the \"blank\" cells are populated with a vlookup. I try to get around this by first selecting all data and pasting as values.</li>\n</ol>\n\n<p>Here is the current code:</p>\n\n<pre><code>Sub DeleteCol()\nRange(\"A1\").Select\nRange(Selection, Selection.SpecialCells(xlLastCell)).Select\nSelection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n  Dim rngApprove As Range\n  Set rngApprove = Range(\"A1:Z5\").Find(\"Approve\")\n  If rngApprove Is Nothing Then\n    MsgBox \"Approved column was not found.\"\n    Exit Sub\n  End If\n  Dim approved_column As Range\n  Set approved_column = rngApprove.EntireColumn\n  approved_column.SpecialCells(xlBlanks).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>The copy + paste as value works as intended. However, the row deletion only deletes rows 1-4 and leaves everything below row 5 alone, even though some of those cells are blank. If I replace the last line with </p>\n\n<pre><code>approved_column.select\n</code></pre>\n\n<p>it selects the whole column, as it should. This leads me to believe that the issue is with my deletion method.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1440016658, "post_id": 32105150, "comment_id": 52104950, "body": "Nearly there - think about (in words not code!) what you want to do if both numbers are equal.  There are a couple of options, depending on how worried you are about bias etc."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4313052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-791zmXsipWo/AAAAAAAAAAI/AAAAAAAAAO0/B5xrejMz9HI/photo.jpg?sz=128", "display_name": "HeliPilot17", "link": "https://stackoverflow.com/users/4313052/helipilot17"}, "edited": false, "score": 0, "creation_date": 1440018668, "post_id": 32105285, "comment_id": 52105965, "body": "Well I feel sheepish.  Duh, how simple.  I need to learn not to over think it.  Thanks a million."}, {"owner": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "edited": false, "score": 0, "creation_date": 1440030470, "post_id": 32105285, "comment_id": 52109695, "body": "I think you can avoid one extra line of code if you do <code>Loop until txtRand1 &lt;&gt; txtRand2</code>."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 23, "user_id": 4313052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-791zmXsipWo/AAAAAAAAAAI/AAAAAAAAAO0/B5xrejMz9HI/photo.jpg?sz=128", "display_name": "HeliPilot17", "link": "https://stackoverflow.com/users/4313052/helipilot17"}, "edited": false, "score": 0, "creation_date": 1440171624, "post_id": 32105285, "comment_id": 52178097, "body": "@floatpilot99 If I answered you well it would be nice of you to accept the answer :)"}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1440016883, "creation_date": 1440016883, "answer_id": 32105285, "question_id": 32105150, "link": "https://stackoverflow.com/questions/32105150/i-have-2-textboxes-with-random-number-in-them-how-can-i-prevent-duplicates-with/32105285#32105285", "title": "I have 2 textboxes with random number in them. How can I prevent duplicates with vba", "body": "<p>Restate it, simply. But in a loop, so if you're really unlucky and it's the same again, it does it until they are not equal anymore:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Me.txtDate.Value = Format(Date, \"mm/dd/yyyy\")\n     Columns(\"H:K\").Select\n    Selection.NumberFormat = \"# ??/??\"\n    Range(\"A1\").Select\n    Me.txtId.SetFocus\n\n    txtRand1 = Evaluate(\"randbetween(1,52)\")\n    txtRand2 = Evaluate(\"randbetween(1,52)\")\n\n    Do until txtRand1 &lt;&gt; txtRand2\n        txtRand2 = Evaluate(\"randbetween(1,52)\")\n    Loop\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4313052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-791zmXsipWo/AAAAAAAAAAI/AAAAAAAAAO0/B5xrejMz9HI/photo.jpg?sz=128", "display_name": "HeliPilot17", "link": "https://stackoverflow.com/users/4313052/helipilot17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440016883, "creation_date": 1440016385, "last_edit_date": 1531164843, "question_id": 32105150, "link": "https://stackoverflow.com/questions/32105150/i-have-2-textboxes-with-random-number-in-them-how-can-i-prevent-duplicates-with", "title": "I have 2 textboxes with random number in them. How can I prevent duplicates with vba", "body": "<p>I have 2 textboxes with a random number in each one.  How can I prevent duplicates from being picked.   I thought an if statement would work but don't know how to return to the line that choose the random numbers.  Seriously puzzled.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nMe.txtDate.Value = Format(Date, \"mm/dd/yyyy\")\n Columns(\"H:K\").Select\nSelection.NumberFormat = \"# ??/??\"\nRange(\"A1\").Select\nMe.txtId.SetFocus\n\ntxtRand1 = Evaluate(\"randbetween(1,52)\")\ntxtRand2 = Evaluate(\"randbetween(1,52)\")\n\nIf txtRand1 = txtRand2 Then\n\n\n End If\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "ms-word", "powerpoint", "office-2013"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440016769, "post_id": 32105003, "comment_id": 52105009, "body": "Welcome to SO, please show what you have tried so far and put your code in your question. SO is not a place to request code to be made but to get answers to a problem or error in your code."}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1440083212, "creation_date": 1440083212, "answer_id": 32121896, "question_id": 32105003, "link": "https://stackoverflow.com/questions/32105003/vba-code-to-auto-update-powerpoint-links-to-word/32121896#32121896", "title": "VBA code to auto update PowerPoint links to Word", "body": "<p>DragonSamu's right ... but to get you started, try this from within PPT itself, then work out how to rewrite it in a scripting language or something that will compile to an EXE</p>\n\n<p>For each file you want to process, open the file (via code) then </p>\n\n<pre><code>Call UpdateLinks(ActivePresentation)\n\n\nSub UpdateLinks(oPres As Presentation)\n\n    Dim oSl As Slide\n    Dim oSh As Shape\n\n    For Each oSl In oPres.Slides\n        For Each oSh In oSl.Shapes\n            If oSh.Type = msoLinkedOLEObject Then\n                oSh.LinkFormat.Update\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4650543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359b1b9837a01b5b7cdf5b8b5a4a3efe?s=128&d=identicon&r=PG&f=1", "display_name": "derek_", "link": "https://stackoverflow.com/users/4650543/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440083212, "creation_date": 1440015888, "last_edit_date": 1440018773, "question_id": 32105003, "link": "https://stackoverflow.com/questions/32105003/vba-code-to-auto-update-powerpoint-links-to-word", "title": "VBA code to auto update PowerPoint links to Word", "body": "<p>I have hundreds of PowerPoint presentations that all have linked Word objects in them.  How can I auto-update all of the links without opening each presentation?  I'm assuming it'll be done with VBA, but the only VBA examples I can find are for auto-updating linked Excel objects.  I'm not familiar enough with VBA to modify the code.  </p>\n\n<p>Ultimately, I'd like to run this via Command Prompt.</p>\n\n<p>Using PowerPoint &amp; Word 2013.</p>\n"}, {"tags": ["vba", "excel", "drag-and-drop"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1440017238, "post_id": 32104713, "comment_id": 52105270, "body": "Use VBS.  What didn&#39;t work about that??"}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1440074211, "post_id": 32104713, "comment_id": 52129226, "body": "The page wasn&#39;t very descriptive about what to do. I am not familiar with VBS and need detailed instructions about what to do. I was getting some kind of runtime error while trying to follow their instructions. Just FYI, the website that I was using was:  <a href=\"http://fulldecent.blogspot.com/2012/01/run-excel-macro-on-any-file-using-drag.html\" rel=\"nofollow noreferrer\">fulldecent.blogspot.com/2012/01/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1440099626, "post_id": 32122535, "comment_id": 52145245, "body": "Do I just copy the macro VBA code into the DO STUFF TO THE FILE HERE spot? Or does it need to be changed for VBS?"}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1440099980, "post_id": 32122535, "comment_id": 52145447, "body": "I am going to assume something needs to be changed because when I did this, it errored out on the first line of VBA which was a DIM. I tried it without using the beginning and ending SUB statements."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "reply_to_user": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1440103857, "post_id": 32122535, "comment_id": 52147559, "body": "You asked for the VBS, so that&#39;s what I gave you.  Yes, you will probably need to tweak your VBA as well.  You can write the entire VBA macro in the VBS script if you assign a handle to the workbook.  Or you can just execute a macro.  But you&#39;ve provided nothing other than a description of what you want, so I don&#39;t know how else I could help you."}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1441135800, "post_id": 32122535, "comment_id": 52553338, "body": "I got this to work by passing using the VBscript to just open the excel file and pass the file name in. I am curious, though, is it possible to drop multiple files onto a VBS file and save them to separate variables? Say I wanted to drop 2 files onto the VBS file name ABC.txt and XYZ.txt and wanted to read the path names into two different variable ABCPath and XYZPath."}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1441212118, "post_id": 32122535, "comment_id": 52590153, "body": "Just in case anyone comes and sees my previous comment, I figured out how to do the multiple file thing. Basically all the file names become arguments. Unfortunately, you have no way to determine which file is which argument initially, so I used a  <code>For i = 0 to objArgs.Count - 1</code> loop to cycle through them and assign them to variables based on string format."}], "tags": [], "owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1440085074, "creation_date": 1440085074, "answer_id": 32122535, "question_id": 32104713, "link": "https://stackoverflow.com/questions/32104713/would-like-to-run-an-excel-macro-with-drag-and-drop/32122535#32122535", "title": "Would like to run an Excel macro with drag and drop", "body": "<p>Here's the bare bones of what you need to do:</p>\n\n<pre><code>Wscript.echo \"Begin...\"           'just letting you know it's working\nSet objArgs = Wscript.Arguments   'capture arguments; arg 0 is the name of the dropped file\nWscript.echo \"The file name you dropped is:\" &amp; objArgs(0)\n\n'DO STUFF TO THE FILE HERE\n\nWscript.echo \"...Finished\"        'all done\n</code></pre>\n\n<ol>\n<li>Save this to a file with a \"vbs\" extension.</li>\n<li>Drag and drop a file onto it.</li>\n<li>If your Windows file associations are properly setup,\n    you'll see this output a message for each of the <code>wscript.echo</code>\n    lines.</li>\n</ol>\n"}], "owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2741, "favorite_count": 0, "accepted_answer_id": 32122535, "answer_count": 1, "score": 2, "last_activity_date": 1440085074, "creation_date": 1440014858, "last_edit_date": 1440071059, "question_id": 32104713, "link": "https://stackoverflow.com/questions/32104713/would-like-to-run-an-excel-macro-with-drag-and-drop", "title": "Would like to run an Excel macro with drag and drop", "body": "<p>I have a macro that asks the user to choose an excel file and then outputs two text files based on the data. </p>\n\n<p>I am looking for a way to just drop the excel file onto the macro file and have it process without the need for opening the macro file, a command button, an open file dialog, etc. I would like to drop the file on the other file and just have the two text files output.</p>\n\n<p>I saw something that looked promising using a VBS file, but was unable to get it to work. </p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1440014596, "post_id": 32104330, "comment_id": 52103793, "body": "You didn&#39;t say what is failing/not working."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440015427, "post_id": 32104330, "comment_id": 52104268, "body": "Didn&#39;t you ask this/similar yesterday? <a href=\"http://stackoverflow.com/questions/32081548/how-to-make-my-automated-pdf-creator-skip-drowdown-selections-where-a-certain-ro\" title=\"how to make my automated pdf creator skip drowdown selections where a certain ro\">stackoverflow.com/questions/32081548/&hellip;</a>"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1440015785, "post_id": 32104330, "comment_id": 52104449, "body": "Yes, I didn&#39;t get a response so I re-asked it I really need help.  @Nelly27281 it&#39;s still just creating PDF&#39;s for every dropdown selection and is only acknowledging the &quot;Exclude&quot; but not if the value at B266 is 0."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440016511, "post_id": 32104330, "comment_id": 52104870, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/87420/discussion-between-user3666237-and-findwindow\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440017217, "post_id": 32104330, "comment_id": 52105250, "body": "Does your IF work? If so, it&#39;s just the print to pdf part? How are we supposed to help you when we don,t even know what the thing you,re trying to print looks like?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440017283, "post_id": 32104330, "comment_id": 52105297, "body": "@DavidG  The If works but not the second IF to skip creating PDFs for files that have zero values in cell B266 after the selection has changed"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440017304, "post_id": 32104330, "comment_id": 52105309, "body": "Does the pdf print correctly when it prints? I need to leave work but the best thing would be for you to write what is happening when you debug. Where are the errors, what&#39;s going wrong, etc. Then people will assist you."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440017456, "post_id": 32104330, "comment_id": 52105389, "body": "@DavidG yes the PDFS are created correctly but I going to sift thru almost 200 names so If I can skip the ones and not create Pdfs for when the value is zero at that cell for that criteria will be awesome."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440017557, "post_id": 32104330, "comment_id": 52105434, "body": "Well have you tried to add another if; If sheet.range(&quot;b226&quot;).value &lt;&gt; 0 then"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440018039, "post_id": 32104330, "comment_id": 52105680, "body": "@DavidG Maybe I have to change the logic because when I add that IF nothing happens is it because the value in b226 is a vlookup?"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440018302, "post_id": 32105631, "comment_id": 52105809, "body": "I want to code to continue running thru the list of names just skips the ones where the B226 is 0 and don&#39;t create a PDF."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440018407, "post_id": 32105631, "comment_id": 52105850, "body": "So you don&#39;t want both the conditions in one IF?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440018487, "post_id": 32105631, "comment_id": 52105885, "body": "Yeah so for example let say the first name in the dropdown is Alfred, b266 is 1000 create the pdf the next name is bryan and b266 is 0 skip creating the pdf and the next name is carl and b266 is 15 create the pdf"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440018904, "post_id": 32105631, "comment_id": 52106077, "body": "So insert that under line Application.StatusBar?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440019865, "post_id": 32105631, "comment_id": 52106531, "body": "appreciate the help now I&#39;m getting Compile error:  Next without For"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440087666, "post_id": 32105631, "comment_id": 52138892, "body": "Can you assist I&#39;m getting a error that says Compile error: Next without For"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440161336, "post_id": 32105631, "comment_id": 52170845, "body": "@user3666237 , I am not assisting because I don&#39;t see your effort hear. Show me what have you tried with my suggestion."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1440164842, "post_id": 32105631, "comment_id": 52173249, "body": "I added the line like you said and share with you the result  I will write the full code in your answer edit"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1440018700, "last_edit_date": 1440018700, "creation_date": 1440018240, "answer_id": 32105631, "question_id": 32104330, "link": "https://stackoverflow.com/questions/32104330/vba-to-create-pdf-for-excel-sheets-based-on-criteria/32105631#32105631", "title": "VBA to Create PDF for excel sheets based on criteria", "body": "<p><strong>Edit</strong> (based on the comment)<strong>:</strong> </p>\n\n<p>Add one more IF condition below your 2nd condition:  </p>\n\n<pre><code>If ThisWorkbook.Sheets(\"INDIVIDUAL PERFORMANCE SUMMARY\").Range(\"C1\") &lt;&gt; \"TRUE\" Then\n    If (sheet.range(\"B226\").value &lt;&gt; 0) Then\n        'your code to create PDF\n    End If\nEnd If\n</code></pre>\n\n<p>This way the code won't create PDF if B226 is 0.</p>\n"}, {"tags": [], "owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "is_accepted": false, "score": 0, "last_activity_date": 1457017362, "creation_date": 1457017362, "answer_id": 35775681, "question_id": 32104330, "link": "https://stackoverflow.com/questions/32104330/vba-to-create-pdf-for-excel-sheets-based-on-criteria/35775681#35775681", "title": "VBA to Create PDF for excel sheets based on criteria", "body": "<p>Add and AND statement and logic test for B226&lt;>0</p>\n\n<pre><code>If ThisWorkbook.Sheets(\"INDIVIDUAL PERFORMANCE SUMMARY\").Range(\"C1\") &lt;&gt; \"TRUE\" And ThisWorkbook.Sheets(\"INDIVIDUAL PERFORMANCE SUMMARY).Range(\"B226\").value &lt;&gt; 0 Then\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1381, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457017362, "creation_date": 1440013481, "last_edit_date": 1440016295, "question_id": 32104330, "link": "https://stackoverflow.com/questions/32104330/vba-to-create-pdf-for-excel-sheets-based-on-criteria", "title": "VBA to Create PDF for excel sheets based on criteria", "body": "<p>So I have a dashboard report that shows the sale performance based on my drop down selection from another sheet (Name Key).  In Cell \"B266\" It has the total sales from the current month.  I have working on a VBA that will create the PDF report and save it if the following conditions are met:  </p>\n\n<p><strong>1.</strong> In the name key drop down look up it doesn't say \"Exclude\" (I have exclude for salespeople who were not including in reporting)<br>\n<strong>2.</strong> When that value is selected in the sheet where the report is (INDIVIDUAL PERFORMANCE SUMMARY) with the drop down location $A$7, cell b266 on the report sheet isn't 0.  </p>\n\n<p>If these two conditions are met, create a pdf and save if not skip to the next cell in the selection.  I have following code:</p>\n\n<pre><code>Sub PDF_Generator()\n\nDim cell As Range\nDim wsSummary As Worksheet\nDim counter As Long\n\nSet wsSummary = Sheets(\"INDIVIDUAL PERFORMANCE SUMMARY\")\n\nFor Each cell In Worksheets(\"NAME KEY\").Range(\"$H2:$H60\")\n  If cell.Value &lt;&gt; \"Exclude\" Then\n     'progress in status bar\n     counter = counter + 1\n     Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n  If ThisWorkbook.Sheets(\"INDIVIDUAL PERFORMANCE SUMMARY\").Range(\"C1\") &lt;&gt; \"TRUE\" Then\n  counter = counter + 1\n     Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n     With wsSummary\n        .Range(\"$A$7\").Value = cell.Value\n        .ExportAsFixedFormat _\n              Type:=xlTypePDF, _\n              Filename:=ThisWorkbook.Sheets(\"INDIVIDUAL PERFORMANCE SUMMARY\").Range(\"J1\").Value &amp; _\n      \"\\\" &amp; cell.Value &amp; \".pdf\", _\n              Quality:=xlQualityStandard, _\n              IncludeDocProperties:=True, _\n              IgnorePrintAreas:=False, _\n              OpenAfterPublish:=False\n     End With\n  End If\n  End If\nNext cell\n\n Set wsSummary = Nothing\nEnd Sub\n</code></pre>\n\n<p>I'm still very new to VBA please help this will save me a lot of time.</p>\n"}, {"tags": ["sql-server", "vba", "excel", "stored-procedures"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1440013439, "post_id": 32104228, "comment_id": 52103076, "body": "you need to write a better stored proc to capture error with output params."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440013926, "post_id": 32104228, "comment_id": 52103416, "body": "Maybe you need: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms677539(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>  (never done this myself though)"}, {"owner": {"reputation": 6511, "user_id": 4765200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb1ac82079e2f813975cfa1aad1e234?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Pressler", "link": "https://stackoverflow.com/users/4765200/brian-pressler"}, "edited": false, "score": 0, "creation_date": 1440018737, "post_id": 32104228, "comment_id": 52105997, "body": "Another link that might be helpful to you: <a href=\"https://support.microsoft.com/en-us/kb/245179\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/245179</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1440019844, "post_id": 32104228, "comment_id": 52106516, "body": "What does the SP look like?"}, {"owner": {"reputation": 63, "user_id": 2559299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694f784582ef4fe2bb7cc2e89a420af8?s=128&d=identicon&r=PG", "display_name": "user2559299", "link": "https://stackoverflow.com/users/2559299/user2559299"}, "edited": false, "score": 0, "creation_date": 1440611083, "post_id": 32104228, "comment_id": 52348955, "body": "I was able to use rs.NextRecordset to figure it out. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2559299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694f784582ef4fe2bb7cc2e89a420af8?s=128&d=identicon&r=PG", "display_name": "user2559299", "link": "https://stackoverflow.com/users/2559299/user2559299"}, "edited": false, "score": 0, "creation_date": 1440390159, "post_id": 32107476, "comment_id": 52234951, "body": "Awesome, got it to work. Just created rs2 and stored the next recordset there. Thanks!"}], "tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": true, "score": 0, "last_activity_date": 1440028391, "creation_date": 1440028391, "answer_id": 32107476, "question_id": 32104228, "link": "https://stackoverflow.com/questions/32104228/execute-sql-server-stored-procedure-in-vba-with-multiple-outputs/32107476#32107476", "title": "Execute SQL Server stored procedure in VBA with multiple outputs", "body": "<p>To access the second recordset, you need to execute this line:-</p>\n\n<pre><code>'Activate the next available recordset\nSet rs = rs.NextRecordset\n\nIf Not rs Is Nothing Then\n\n  'Add code in here\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 2559299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694f784582ef4fe2bb7cc2e89a420af8?s=128&d=identicon&r=PG", "display_name": "user2559299", "link": "https://stackoverflow.com/users/2559299/user2559299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1589, "favorite_count": 0, "accepted_answer_id": 32107476, "answer_count": 1, "score": 1, "last_activity_date": 1440028391, "creation_date": 1440013109, "last_edit_date": 1440016778, "question_id": 32104228, "link": "https://stackoverflow.com/questions/32104228/execute-sql-server-stored-procedure-in-vba-with-multiple-outputs", "title": "Execute SQL Server stored procedure in VBA with multiple outputs", "body": "<p>I have a stored procedure in SQL Server that I am trying to execute from Excel via some VBA code. However, the stored procedure has two outputs (see below). </p>\n\n<p>My record set is only pulling in the first table (added 0 error messages...) whereas I want to pull in the second table.</p>\n\n<p>Image here: <a href=\"http://i.stack.imgur.com/LxyLi.png\" rel=\"nofollow\">http://i.stack.imgur.com/LxyLi.png</a></p>\n\n<p>Here is my code, compiled from other sources I found on here:</p>\n\n<pre><code>Sub RefreshBarcodes()\nDim Database As String\nDim con As ADODB.Connection\nDim strconn As String\nDim SQLServer As String\nDim Session As String\nDim strSQLCommandOne As String\n\n\nApplication.ScreenUpdating = False\nWorksheets(\"Master\").Activate\nDatabase = Worksheets(\"Master\").Cells(5, \"H\").Value\nSQLServer = Worksheets(\"Master\").Cells(4, \"H\").Value\nSession = Worksheets(\"Master\").Cells(6, \"H\").Value\n\n'Connect to Database\nSet con = New ADODB.Connection\nstrconn = \"Provider=sqloledb; Data Source=\" &amp; SQLServer &amp; \";Initial Catalog = \" &amp; _\nDatabase &amp; \"; INTEGRATED SECURITY=SSPI; \"\ncon.Open strconn\n\n'Set SQL Commands\nstrSQLCommandOne = \"set nocount on; exec spGetSessionSourceCounts 'HNW-CLU-001-024_01_0005'\"\n\n'Open Recordset\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\n'Execute and copy to Excel\nrs.Open strSQLCommandOne, strconn\n    rs.MoveFirst\n    Worksheets(\"Session\").Activate\n    Cells(1, 1).Select\n    ActiveCell.CopyFromRecordset rs\nrs.Close\n\nWorksheets(\"Master\").Activate\nCells(6, \"H\").Value = \"Session updated\"\n\ncon.Close\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Excel output: <a href=\"http://i.stack.imgur.com/b7i3B.png\" rel=\"nofollow\">http://i.stack.imgur.com/b7i3B.png</a></p>\n\n<p>I would love to be able to pull in the first (error message) and second results (session info), but mainly need only the second table. Thanks so much in advance!</p>\n"}, {"tags": ["excel", "vba", "dir", "fso"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 4, "creation_date": 1440012533, "post_id": 32103915, "comment_id": 52102534, "body": "What is the <code>Dir()</code> in <code>SourceFile = Dir()</code> in FSO version?"}, {"owner": {"reputation": 307, "user_id": 5221266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6599b58fb516e1d9fa68956b52888301?s=128&d=identicon&r=PG&f=1", "display_name": "mrlemmer11", "link": "https://stackoverflow.com/users/5221266/mrlemmer11"}, "edited": false, "score": 0, "creation_date": 1440012863, "post_id": 32103915, "comment_id": 52102743, "body": "&#39;I do not need to exclude files from a search within a folder, but include them all.&#39; ... but in your Dir() method you are restricting it to .xls files. So it would it be fair to assume your goal is to see every single .xls file only, and your problem is that 1 of your .xls isn&#39;t showing at random?"}, {"owner": {"reputation": 153, "user_id": 5190910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a1ad5ba79f69d67c132b56628d32cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5190910/mike"}, "edited": false, "score": 0, "creation_date": 1440012952, "post_id": 32103915, "comment_id": 52102802, "body": "Yes, all files are .xls or .xlsx and 1 of them at random does not show up."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440013205, "post_id": 32103915, "comment_id": 52102931, "body": "Never seen that behavior with either Dir() or FSO."}, {"owner": {"reputation": 153, "user_id": 5190910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a1ad5ba79f69d67c132b56628d32cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5190910/mike"}, "edited": false, "score": 0, "creation_date": 1440013251, "post_id": 32103915, "comment_id": 52102966, "body": "Nelly, the Dir() in the FSO version is there to set SourceFile to the next file in the directory."}, {"owner": {"reputation": 307, "user_id": 5221266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6599b58fb516e1d9fa68956b52888301?s=128&d=identicon&r=PG&f=1", "display_name": "mrlemmer11", "link": "https://stackoverflow.com/users/5221266/mrlemmer11"}, "edited": false, "score": 0, "creation_date": 1440013351, "post_id": 32103915, "comment_id": 52103028, "body": "I can only replicate this when I make a file hidden in my directory. Other than that, I can&#39;t seem to see what the issue is."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1440013519, "post_id": 32103915, "comment_id": 52103139, "body": "It might be interesting to see if you have the problem with a completely different programming language. For example this question gives a Python snippet you can try: <a href=\"http://stackoverflow.com/q/3964681/4996248\">stackoverflow.com/q/3964681/4996248</a>  If you get the problem there then the problem lies with your OS"}, {"owner": {"reputation": 153, "user_id": 5190910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a1ad5ba79f69d67c132b56628d32cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5190910/mike"}, "edited": false, "score": 0, "creation_date": 1440014267, "post_id": 32103915, "comment_id": 52103604, "body": "Nelly your question helped me solve the issue with the FSO version, which is that SourceFile = Dir() was setting the variable to the next file in the list before it set the value to the active cell, thus skipping the first file each time. Though this doesn&#39;t appear to be the case in the Dir() version."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1440014973, "post_id": 32103915, "comment_id": 52103997, "body": "Glad that caught the attention and helped fixing the issue."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 5190910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a1ad5ba79f69d67c132b56628d32cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5190910/mike"}, "is_accepted": true, "score": 4, "last_activity_date": 1440017554, "last_edit_date": 1440017554, "creation_date": 1440015036, "answer_id": 32104771, "question_id": 32103915, "link": "https://stackoverflow.com/questions/32103915/dir-and-fso-both-missing-1-file/32104771#32104771", "title": "Dir() and FSO Both Missing 1 File", "body": "<p>In both versions, <code>SourceFile = Dir()</code> was above the <code>ActiveCell.Value = SourceFile</code>. This caused the first file to be missed by skipping to the next file in the list prior to adding the file name to the list.</p>\n\n<p>Corrected code:</p>\n\n<p>Dir() version:</p>\n\n<pre><code>FilePath = \"C:\\Test\\\"\n\nSourceFile = Dir(FilePath &amp; \"*.xls*\")\n\nDo While SourceFile &lt;&gt; \"\"   \n   ActiveCell.Value = SourceFile\n   ActiveCell.Offset(1, 0).Activate\n   SourceFile = Dir()\nLoop\n</code></pre>\n\n<p>FSO version:</p>\n\n<pre><code>Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\nDoFolder FileSystem.GetFolder(FilePath)\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n\n    Dim File\n    For Each File In Folder.Files\n        If File.Name &lt;&gt; \"\" Then                \n            ActiveCell.Value = File.Name\n            ActiveCell.Offset(1, 0).Activate\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5190910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a1ad5ba79f69d67c132b56628d32cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5190910/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 32104771, "answer_count": 1, "score": 2, "last_activity_date": 1440017554, "creation_date": 1440012023, "last_edit_date": 1440014913, "question_id": 32103915, "link": "https://stackoverflow.com/questions/32103915/dir-and-fso-both-missing-1-file", "title": "Dir() and FSO Both Missing 1 File", "body": "<p>All search attempts to find a solution to this issue have come up with the opposite of what I'm looking for. I do not need to exclude files from a search within a folder, but include them all.</p>\n\n<p>My issue is that my searches are returning all files within the folder except 1. The 1 file that is not found each time is completely random. I have tried using both Dir() and FSO methods, different directories, different number of files, etc. No matter what I try, 1 file is always missing from the list.</p>\n\n<p>Here are simplified snippets of my code:</p>\n\n<p>Dir() version:</p>\n\n<pre><code>FilePath = \"C:\\Test\\\"\n\nSourceFile = Dir(FilePath &amp; \"*.xls*\")\n\nDo While SourceFile &lt;&gt; \"\" \n   SourceFile = Dir()\n   ActiveCell.Value = SourceFile\n   ActiveCell.Offset(1, 0).Activate\nLoop\n</code></pre>\n\n<p>FSO version:</p>\n\n<pre><code>Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\nDoFolder FileSystem.GetFolder(FilePath)\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n\n    Dim File\n    For Each File In Folder.Files\n        If File.Name &lt;&gt; \"\" Then\n            SourceFile = Dir()\n            ActiveCell.Value = SourceFile\n            ActiveCell.Offset(1, 0).Activate\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Again, these both return all of the files except 1 (at random). </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1440012049, "creation_date": 1440012049, "answer_id": 32103926, "question_id": 32103651, "link": "https://stackoverflow.com/questions/32103651/generate-a-straight-sequence-of-numbers-depending-on-the-lastrow/32103926#32103926", "title": "Generate a straight sequence of numbers depending on the lastrow", "body": "<p>So your question is how to speed this up?  A first suggestion is to add the following to the beginning and end to your Macro:</p>\n\n<p>At the beginning:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n</code></pre>\n\n<p>then at the end:</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440015167, "post_id": 32104646, "comment_id": 52104124, "body": "Ooh - what are the [] doing around the formulas? and the `[c3]?  I&#39;ve not seen it used like that before, only in a table where it refers to headers/columns."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1440015482, "post_id": 32104646, "comment_id": 52104298, "body": "The square brackets in VBA are used as a shortcut notation for Evaluate, which of course is a completely different beast from Structured References in tables."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440015519, "post_id": 32104646, "comment_id": 52104319, "body": "Aha! That&#39;s excellent - I never knew that and use Evaluate a few times. Thanks!"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1440022529, "last_edit_date": 1440022529, "creation_date": 1440014618, "answer_id": 32104646, "question_id": 32103651, "link": "https://stackoverflow.com/questions/32103651/generate-a-straight-sequence-of-numbers-depending-on-the-lastrow/32104646#32104646", "title": "Generate a straight sequence of numbers depending on the lastrow", "body": "<p>This will output both the columns you are looking for; numbers in one column and the names in the next:</p>\n\n<pre><code>Public Sub YourSolution()\n    Dim v\n    v = Sheet1.[CHOOSE({1,2},ROW(OFFSET(A1,,,COUNTA(A:A))),A1:INDEX(A:A,COUNTA(A:A)))]\n    Sheet2.[b3:c3].Resize(UBound(v)) = v\nEnd Sub\n</code></pre>\n\n<p>It should be quick enough that you need not bother turning off screen updating or setting calculation to manual.</p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 3, "last_activity_date": 1440020232, "last_edit_date": 1440020232, "creation_date": 1440017109, "answer_id": 32105344, "question_id": 32103651, "link": "https://stackoverflow.com/questions/32103651/generate-a-straight-sequence-of-numbers-depending-on-the-lastrow/32105344#32105344", "title": "Generate a straight sequence of numbers depending on the lastrow", "body": "<p>I was curious about this so I measured 4 options:</p>\n\n<pre><code>Max itms:    65,000\n  Transpose: 0.0586 sec\n  Formula:   0.0938 sec\n  Fill down: 0.0273 sec &lt;&lt;&lt;\n  2D Array:  0.0547 sec\n\nMax itms:    1,000,000\n  Formula:   0.4688 sec\n  Fill down: 0.2305 sec &lt;&lt;&lt;\n  2D Array:  0.6992 sec\n</code></pre>\n\n<p>.</p>\n\n<p>Test code:</p>\n\n<pre><code>Public Sub idSequence()\n    Const MAXR As Long = 1000000\n    Const CRx2 As String = \" sec\" &amp; vbCrLf  ' &amp; vbCrLf\n    Const NFRM As String = \"#,##0.0000\"\n    Dim arr As Variant, i As Long, msg As String, t As Double\n\n    If MAXR &lt;= 65000 Then    'Upper Limit: 65,000\n        t = Timer\n        ReDim arr(1 To MAXR)\n        For i = 1 To MAXR\n            arr(i) = i\n        Next\n        Range(\"A1:A\" &amp; MAXR).Formula = Application.Transpose(arr)\n        msg = msg &amp; \"Transp: \" &amp; vbTab &amp; Format(Timer - t, NFRM) &amp; CRx2\n    End If\n\n    t = Timer\n    Range(\"B1:B\" &amp; MAXR).Formula = \"=Row()\"\n    msg = msg &amp; \"Formula:\" &amp; vbTab &amp; Format(Timer - t, NFRM) &amp; CRx2\n\n    t = Timer\n    Range(\"C1\") = 1\n    Range(\"C1:C\" &amp; MAXR).DataSeries Rowcol:=xlColumns, Type:=xlLinear, Step:=1\n    msg = msg &amp; \"Fill down:\" &amp; vbTab &amp; Format(Timer - t, NFRM) &amp; CRx2\n\n    t = Timer\n    ReDim arr(1 To MAXR, 1 To 1)\n    For i = 1 To MAXR\n        arr(i, 1) = i\n    Next\n    Range(\"D1:D\" &amp; MAXR) = arr\n    msg = msg &amp; \"2D Array:\" &amp; vbTab &amp; Format(Timer - t, NFRM) &amp; CRx2\n\n    Debug.Print \"Max itms: \" &amp; vbTab &amp; Format(MAXR, \"#,##0\")\n    Debug.Print msg\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 2, "accepted_answer_id": 32104646, "answer_count": 3, "score": 2, "last_activity_date": 1440022529, "creation_date": 1440011133, "question_id": 32103651, "link": "https://stackoverflow.com/questions/32103651/generate-a-straight-sequence-of-numbers-depending-on-the-lastrow", "title": "Generate a straight sequence of numbers depending on the lastrow", "body": "<pre><code>lrow = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\nFor p = 1 To lrow\n    period(p) = p\nNext p\nWith ws2\n    lrow2 = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Range(\"A1\").Offset(lrow2, 1).Resize(lrow).Value = Application.Transpose(period)\n    ws1.Range(ws1.Cells(5, 1), ws1.Cells(lrow, 1)).Copy .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 2)\nEnd With\n</code></pre>\n\n<p>As you see, I am trying to copy data columns from one sheet to another and it works well. But if notice I am generating a <strong>sequence in p from 1 to lastrow</strong> , which looks very dumb to me because I am using a loop and I am sure there is another way to generate it and copy it in to another sheet. How can I fasten this as removing the <strong>application.transpose(period)</strong> line from the code makes it run in half the time. I am requesting for an faster method if anyone can advice on. Thanks. </p>\n\n<p>E.g.</p>\n\n<pre><code>  Sheet1                           Sheet2\n  John                          1  John\n  Jim                           2  Jim\n  Jack                          3  Jack\n</code></pre>\n\n<p>I am generating Sheet2 from Sheet1 and the numbers and names are in different columns. I can use copy like I have in my code for names, but I need to generate the numbers myself. </p>\n"}, {"tags": ["string", "vba", "validation", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1440024592, "post_id": 32103642, "comment_id": 52108237, "body": "Not sure if this is the best (most efficient) way but I&#39;d implement it like this: (1.) AlphaSort &#39;Mapping&#39; on B, C, D (2.) AlphaSort &#39;Compare&#39; on col B (for duplicates). (3.) Make function GetPatterns(ByVal strFromCompareColB As String) As String() - returns the array of all possible patterns. (4.) Move CompareColC to memArray. (5.) For Each itemX in memArray and For Each itemZ in patternArray RegEx.Pattern = patternArray(i), then if Not RegEx.Test(itemX) Then resultMemArray() = &quot;Invalid Value&quot;, Next itemZ (pattern) , Next itemX (memArray). At the end (6,) CompareColD = resultMemArray"}], "answers": [{"tags": [], "owner": {"reputation": 438, "user_id": 3007188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WbZIr.jpg?s=128&g=1", "display_name": "AndrewT", "link": "https://stackoverflow.com/users/3007188/andrewt"}, "is_accepted": true, "score": 3, "last_activity_date": 1440034015, "creation_date": 1440034015, "answer_id": 32108137, "question_id": 32103642, "link": "https://stackoverflow.com/questions/32103642/vba-excel-data-validation-of/32108137#32108137", "title": "VBA Excel Data Validation of", "body": "<p>Assuming * is anything # is a number and ? is a char I came up with this</p>\n\n<pre><code>Sub CompareToMapping()\n   Dim mapSheet As Worksheet: Set mapSheet = Sheets(\"Mapping\")\n   Dim compSheet As Worksheet: Set compSheet = Sheets(\"Compare\")\n   Dim mcell As Range\n   Dim ccell As Range\n   Dim rcell As Range\n\n   'Loop throw all the rows in the compare sheet\n   For Each ccell In compSheet.Range(\"a1\", compSheet.Range(\"a\" &amp; compSheet.Rows.Count).End(xlUp))\n      'loop through and find a matching row from Mapping sheet\n      For Each mcell In mapSheet.Range(\"a1\", mapSheet.Range(\"a\" &amp; mapSheet.Rows.Count).End(xlUp))\n         If mcell = ccell And mcell.Offset(0, 1) = ccell.Offset(0, 1) Then\n            'loop through valid format strings\n            For Each rcell In mapSheet.Range(mcell, mapSheet.Cells(mcell.Row, mapSheet.Columns.Count).End(xlToLeft))\n               ccell.Offset(0, 3) = \"Error: Invalid value\"\n               If FormatCorrect(ccell.Offset(0, 2).Text, rcell.Offset(0, 2).Text) Then\n                  'show error in column d\n                  ccell.Offset(0, 3) = \"\"\n                  Exit For\n               End If\n            Next rcell\n            Exit For\n         End If\n      Next mcell\n   Next ccell\nEnd Sub\n\nFunction FormatCorrect(inString As String, inFormat As String) As Boolean\n   Dim i As Integer: i = 0\n   Dim curS, curF As String\n   FormatCorrect = True\n\n   ' first check for *\n   If inFormat = \"*\" Then\n      FormatCorrect = True\n   ' next check if strings are the same length\n   ElseIf Len(inString) &lt;&gt; Len(inFormat) Then\n      FormatCorrect = False\n   Else\n      'compare 1 character at a time\n      For i = 1 To Len(inString)\n         curS = Mid(inString, i, 1)\n         curF = Mid(inFormat, i, 1)\n         If curF = \"?\" Then ' needs to be a letter\n            If IsNumeric(curS) Then\n               FormatCorrect = False\n               Exit For\n            End If\n         ElseIf curF = \"#\" Then ' needs to be a number\n            If Not IsNumeric(curS) Then\n               FormatCorrect = False\n               Exit For\n            End If\n         Else ' needs to be an exact match\n            If curF &lt;&gt; curS Then\n               FormatCorrect = False\n               Exit For\n            End If\n         End If\n      Next i\n   End If\nEnd Function\n</code></pre>\n\n<p>Tested and worked for me. Good luck :)</p>\n"}], "owner": {"reputation": 47, "user_id": 5062504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8878e2a59118112b6e991bc3276877cd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Charnow", "link": "https://stackoverflow.com/users/5062504/chris-charnow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 32108137, "answer_count": 1, "score": 1, "last_activity_date": 1440034015, "creation_date": 1440011102, "question_id": 32103642, "link": "https://stackoverflow.com/questions/32103642/vba-excel-data-validation-of", "title": "VBA Excel Data Validation of", "body": "<p>I was looking for some help on creating a sub which does data validation on the values in column C in a worksheet 'Compare' based on possible values listed in a different worksheet 'mapping' in columns C, D, E etc. I wanted to have the possible values use string/pattern characters like # ? * to make the data validation more flexible. There could be anywhere from 1 to 5+ different possible values which varies by key.  Validation differences would be spit into an empty column D in worksheet Compare.</p>\n\n<p>An Example with Data is likely most helpful here. </p>\n\n<pre><code>Static sheet 'mapping' . Key is Column A. Possible values in Columns C onwards\nA               B               C               D               E               F               G\nv1              CDID            ####            ###?            0\nc52             FHAID           ER#             EP#             INVA            Z*              \nc48             PLID            *\nv24             CUSTID          ###             ###Q            ###P\nc22             MATID           ???#            ??#             ?#\nq23             LKKID           *\n\n\nInput original sheet 'Compare'. Key is Column B. Column C contains Data to validate\nA               B               C               D\nc22             MATID           RT3FG\nv24             CUSTID          456P\nv1              CDID            5   \nq23             LKKID           PORTA\n\nOutput sheet 'Compare'. Invalid values noted in Column D.\n    A               B               C               D\nc22             MATID           RT3FG           Error: Invalid value\nv24             CUSTID          456P\nv1              CDID            5               Error: Invalid Value    \nq23             LKKID           PORTA\n</code></pre>\n\n<p>Any ideas on how to make this work? Compare worksheet will have all data starting in A1 with no headers. mapping sheet will be quite large with 100+ rows and probably requires a vlookup or similar to find correct row.</p>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1440007861, "post_id": 32102612, "comment_id": 52099650, "body": "This is quite an easy program flow. What did you try to debug the program?"}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "reply_to_user": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1440009286, "post_id": 32102612, "comment_id": 52100529, "body": "I made k a public variable and I&#39;m still getting the same issue for some reason."}], "answers": [{"comments": [{"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1440009214, "post_id": 32102702, "comment_id": 52100489, "body": "This code would cause an infinite loop, for certain"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440009550, "post_id": 32102702, "comment_id": 52100721, "body": "I wouldn&#39;t use <code>GoTo</code>, it&#39;s generally frowned upon unless absolutely necessary. In this case, there are solutions easily done without <code>GoTo</code>."}, {"owner": {"reputation": 105, "user_id": 3956919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0eefe8938fb09b2e91e5c6ac7c27112?s=128&d=identicon&r=PG&f=1", "display_name": "MVAmorim", "link": "https://stackoverflow.com/users/3956919/mvamorim"}, "edited": false, "score": 0, "creation_date": 1440010021, "post_id": 32102702, "comment_id": 52101039, "body": "I agree, just thought it would be a simple macro with a simple solution."}, {"owner": {"reputation": 105, "user_id": 3956919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0eefe8938fb09b2e91e5c6ac7c27112?s=128&d=identicon&r=PG&f=1", "display_name": "MVAmorim", "link": "https://stackoverflow.com/users/3956919/mvamorim"}, "reply_to_user": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1440010127, "post_id": 32102702, "comment_id": 52101101, "body": "@UriGoren no, it dont, just show up numbers higher than 51"}], "tags": [], "owner": {"reputation": 105, "user_id": 3956919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0eefe8938fb09b2e91e5c6ac7c27112?s=128&d=identicon&r=PG&f=1", "display_name": "MVAmorim", "link": "https://stackoverflow.com/users/3956919/mvamorim"}, "is_accepted": false, "score": 0, "last_activity_date": 1440007918, "creation_date": 1440007918, "answer_id": 32102702, "question_id": 32102612, "link": "https://stackoverflow.com/questions/32102612/vba-for-loop-ending-early/32102702#32102702", "title": "VBA for loop ending early", "body": "<p>You can use goto: </p>\n\n<pre><code>Sub Example()\n\nFor k = 1 To 100\n\nCall ExampleExtended\n\nNext k\n\nEnd Sub\n\n\nSub ExampleExtended()\nDim Val As Integer\nstart:\nVal = Int((100 - 1 + 1) * Rnd)\n\nIf Val &lt; 51 Then\ngoto start\nk = k - 1\nExit Sub\nEnd If\n\nDebug.Print Val\n\nEnd Sub\n</code></pre>\n\n<p>see if it works</p>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1440009371, "post_id": 32102853, "comment_id": 52100593, "body": "My example isn&#39;t the best, but I need to have the randomization be between 1 and 100 but have a check between 51 and 100. I can&#39;t just randbetween 50,100"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1440010511, "post_id": 32102853, "comment_id": 52101320, "body": "@Fubudis not sure if my edit is what you&#39;re after...but this will print 100 numbers, each over 50."}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1440011089, "post_id": 32102853, "comment_id": 52101674, "body": "Found the problem:  My code was in fact looping through 100,000 times like I wanted it to , but the debug.print was only saying 34464 because I was trying to use a count function on an array. Apparently there&#39;s 65K limit on those."}], "tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": true, "score": 4, "last_activity_date": 1440010472, "last_edit_date": 1440010472, "creation_date": 1440008438, "answer_id": 32102853, "question_id": 32102612, "link": "https://stackoverflow.com/questions/32102612/vba-for-loop-ending-early/32102853#32102853", "title": "VBA for loop ending early", "body": "<p>k is considered a local variable for both subs in your example, so you're not updating k like you think you are. Either increase the scope of k (which I don't recommend) or make ExampelExtended() a function that returns something you can use in the calling sub.</p>\n\n<p>Here is one way. Obviously the function is kind of overkill, but trying to show how you can use a function to return a value to the calling sub:</p>\n\n<pre><code>    Sub Example()\n    Dim counter     As Integer, _\n        randNumber   As Integer\n\n    For counter = 1 To 100\n\n        randNumber = RandomBetween(50, 100)\n        Debug.Print randNumber\n\n    Next counter\n\n    End Sub\n\n\n    Function RandomBetween(lowerBound As Integer, upperBound As Integer) As Integer\n        RandomBetween = Application.WorksheetFunction.RandBetween(lowerBound, upperBound)\n    End Function\n</code></pre>\n\n<p>Is this closer?</p>\n\n<pre><code>Option Explicit\n\nSub Example()\nDim counter     As Integer, _\n    randNumber   As Integer\n\nFor counter = 1 To 100\n\n    randNumber = RandomBetween(1, 100)\n\n\n    If randNumber &lt; 50 Then\n        counter = counter - 1\n    Else ' this is here just as a check...should only print 100 numbers\n        Debug.Print randNumber\n    End If\n\nNext counter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 2, "last_activity_date": 1440008940, "last_edit_date": 1525816098, "creation_date": 1440008940, "answer_id": 32103014, "question_id": 32102612, "link": "https://stackoverflow.com/questions/32102612/vba-for-loop-ending-early/32103014#32103014", "title": "VBA for loop ending early", "body": "<p>It looks like this would be better suited by using a Do While loop. Do While makes a loop indefinate until a condition is met - in this case, until a random number is > 51. Like so:</p>\n\n<pre><code>val = 1\nDo While val &lt; 51\n    Val = Int((100 - 1 + 1) * Rnd)\nLoop\n</code></pre>\n\n<p>Although in your case, this could be further simplified by just forcing the random number to be between 51 &amp; 100, like so [taken from here: <a href=\"http://www.cpearson.com/excel/randomNumbers.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/randomNumbers.aspx</a>:</p>\n\n<pre><code>Dim Low As Double\nDim High As Double\nLow = 51 '&lt;&lt;&lt; CHANGE AS DESIRED\nHigh = 100 '&lt;&lt;&lt; CHANGE AS DESIRED\nval = Int((High - Low + 1) * Rnd() + Low)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1440009815, "post_id": 32103056, "comment_id": 52100895, "body": "Thanks this is what I was looking for.   I&#39;m still having some trouble with my actual code though despite using this method.   I&#39;m iterating 100,000 times but I&#39;m consistently getting 34,464 outputs. Is this a memory issue perhaps?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1440012275, "post_id": 32103056, "comment_id": 52102341, "body": "@Fubudis - Try changing <code>Val as Integer</code> to <code>Val as Long</code>. ...Edit: Err, maybe not <code>Val</code>, but I am betting your issue is due to using <code>Integer</code>, <a href=\"http://spreadsheetsuperstar.com/vba-integer-variable-data-type/\" rel=\"nofollow noreferrer\">&quot;An Integer variable does not store fractional values, holds whole numbers from -32,768 to 32,767...&quot;</a>"}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 1, "last_activity_date": 1440009101, "creation_date": 1440009101, "answer_id": 32103056, "question_id": 32102612, "link": "https://stackoverflow.com/questions/32102612/vba-for-loop-ending-early/32103056#32103056", "title": "VBA for loop ending early", "body": "<p>Your loop has at least 100 iterations, and 150 iterations on average !</p>\n\n<p>However, the <code>Debug.Print Val</code> is called 50 times on average.\nTherefore, you will almost always see less then 100 values in the console window.</p>\n\n<p>(There's a <code>2^(-100)</code> chance of seeing 100 lines in the console window)</p>\n\n<p>If you change your code to:</p>\n\n<pre><code>Public k as long\nSub Example()\n\nFor k = 1 To 100\n    Call ExampleExtended\nNext k\n\nEnd Sub\n\n\nSub ExampleExtended()\nDim Val As Integer\n\nVal = Int((100 - 1 + 1) * Rnd)\n\nDebug.Print Val\n\nIf Val &lt; 51 Then\n    k = k - 1\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The amount of time the loop is executed will be the same as the amount of lines you have in your console</p>\n"}], "owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 32102853, "answer_count": 4, "score": 0, "last_activity_date": 1440010472, "creation_date": 1440007646, "last_edit_date": 1440008142, "question_id": 32102612, "link": "https://stackoverflow.com/questions/32102612/vba-for-loop-ending-early", "title": "VBA for loop ending early", "body": "<p>If I'm iterating k = 1 to 100, I need to sometimes restart an iteration if a criteria isn't met. In this case, I'm creating a random number between 1 and 100, but if that number is below 51, I want the iteration to start over.</p>\n\n<p>Right now the code is returning a variable number of values. Sometimes 1, sometimes 90. </p>\n\n<p>Any ideas why?</p>\n\n<pre><code>Public k as long\nSub Example()\n\nFor k = 1 To 100\n    Call ExampleExtended\nNext k\n\nEnd Sub\n\n\nSub ExampleExtended()\nDim Val As Integer\n\nVal = Int((100 - 1 + 1) * Rnd)\n\nIf Val &lt; 51 Then\n    k = k - 1\n    Exit Sub\nEnd If\n\nDebug.Print Val\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vsto", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 31309, "user_id": 149573, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a7702f74f3814b23e7aa6040a211f487?s=128&d=identicon&r=PG", "display_name": "Todd Main", "link": "https://stackoverflow.com/users/149573/todd-main"}, "edited": false, "score": 0, "creation_date": 1440142544, "post_id": 32129560, "comment_id": 52160019, "body": "Ah, this is too bad. At least now I know it can&#39;t be done. Looks like I&#39;ll have to run with a <code>SelectionChanged</code> listener to log discontiguous selections in a module variable and then act on them that way."}], "tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": true, "score": 3, "last_activity_date": 1440110110, "creation_date": 1440110110, "answer_id": 32129560, "question_id": 32102252, "link": "https://stackoverflow.com/questions/32102252/format-multiple-text-selections-in-powerpoint/32129560#32129560", "title": "Format multiple text selections in PowerPoint", "body": "<p>You cannot do it because of lack of support in the object model. Take a look at this kb article - <a href=\"https://support.microsoft.com/en-us/kb/288424\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/288424</a>. Though it pertains to Word, the limitations are similarly applicable to PowerPoint. </p>\n"}], "owner": {"reputation": 31309, "user_id": 149573, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a7702f74f3814b23e7aa6040a211f487?s=128&d=identicon&r=PG", "display_name": "Todd Main", "link": "https://stackoverflow.com/users/149573/todd-main"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 32129560, "answer_count": 1, "score": 3, "last_activity_date": 1593807358, "creation_date": 1440006422, "last_edit_date": 1593807358, "question_id": 32102252, "link": "https://stackoverflow.com/questions/32102252/format-multiple-text-selections-in-powerpoint", "title": "Format multiple text selections in PowerPoint", "body": "<p>I'm trying to see if there is a way to programmatically access multiple text selections in shapes/textboxes in PowerPoint. </p>\n\n<p>The scenario is this - create a textbox that has the words \"one two three\" inside. Now, with the Ctrl button held down, select the words \"one\" and \"three\" (but not \"two\").</p>\n\n<p>The <code>ActiveWindow.Selection.TextRange</code> and <code>ActiveWindow.Selection.TextRange2</code> objects only provide a single selection. I was hoping it would provide both selections, like in a series of <code>Runs</code>, <code>Paragraphs</code> or whatnot. The <code>ActiveWindow.Selection.ShapeRange</code> object doesn't provide anything on this well - it's still a single shape.</p>\n\n<p>In the PPT client, when you have multiple (disconnected) text selections, you can perform the same actions on them, like setting the font color to red. I'm looking for the same access, but programmatically - VBA, C#/VB.NET, VSTO, - any of those technologies are fine if you have a way to do this.</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 3, "creation_date": 1440006543, "post_id": 32102105, "comment_id": 52098941, "body": "When you say &#39;its not working at all&#39;, do you mean, it doesn&#39;t find any cells which match your criteria? Are you sure your data is set up in such a way that in at least one instance, it matches the criteria? With the brackets seems to me like it should work. Possible reason - you have the AND criteria listed as &quot;FALSE&quot; - but thats text value, different different from the boolean FALSE [with no brackets]."}, {"owner": {"reputation": 286, "user_id": 5049651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cd55a8c32a0ce5677880cf5a8830e9?s=128&d=identicon&r=PG&f=1", "display_name": "bbishopca", "link": "https://stackoverflow.com/users/5049651/bbishopca"}, "edited": false, "score": 0, "creation_date": 1440008112, "post_id": 32102105, "comment_id": 52099789, "body": "This is also easily obtainable with Conditional Formatting."}], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440007791, "post_id": 32102606, "comment_id": 52099614, "body": "While your ordering may be correct, the OP&#39;s use of brackets should resolve his ordering to work the way s/he wants - there is something else going on in his/her data."}, {"owner": {"reputation": 286, "user_id": 5049651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cd55a8c32a0ce5677880cf5a8830e9?s=128&d=identicon&r=PG&f=1", "display_name": "bbishopca", "link": "https://stackoverflow.com/users/5049651/bbishopca"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440008007, "post_id": 32102606, "comment_id": 52099734, "body": "Possibly but that is not for me to determine since I cannot see the data."}], "tags": [], "owner": {"reputation": 286, "user_id": 5049651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cd55a8c32a0ce5677880cf5a8830e9?s=128&d=identicon&r=PG&f=1", "display_name": "bbishopca", "link": "https://stackoverflow.com/users/5049651/bbishopca"}, "is_accepted": false, "score": -1, "last_activity_date": 1440008346, "last_edit_date": 1440008346, "creation_date": 1440007623, "answer_id": 32102606, "question_id": 32102105, "link": "https://stackoverflow.com/questions/32102105/how-to-combine-or-and-and-in-the-if-statement-vba-in-with-do-until/32102606#32102606", "title": "How to combine or and and in the if statement vba in with do until", "body": "<p>It is a simple case of realizing how excel reads the IF statement. It is evaluating the <code>Or</code> statement first and going True and never looking at the <code>And</code> It can get a little ugly but you have to use the <code>And</code> first and then <code>Or</code> it. Try this</p>\n\n<pre><code>If Cells(i, 13) = \"Role Adjustment\" And Cells(i, 15) = \"FALSE\" Or Cells(i, 13) = \"New Role\" And Cells(i, 15) = \"FALSE\" Then\n</code></pre>\n\n<p>This evaluates the And condition first and if False then looks at the Or.</p>\n\n<p>Conditional Formatting way.</p>\n\n<pre><code>=AND($O1=\"FALSE\", OR($M1=\"Role Adjustment\", $M1=\"New Role\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1440026678, "creation_date": 1440026678, "answer_id": 32107222, "question_id": 32102105, "link": "https://stackoverflow.com/questions/32102105/how-to-combine-or-and-and-in-the-if-statement-vba-in-with-do-until/32107222#32107222", "title": "How to combine or and and in the if statement vba in with do until", "body": "<p>Your second option should work, and @Grade'Eh'Bacon is probably correct:</p>\n\n<p>Change this:</p>\n\n<pre><code>If Cells(i, 13) = \"Role Adjustment\" Or Cells(i, 13) = \"New Role\" _\n        And Cells(i, 15) = \"FALSE\" Then\n</code></pre>\n\n<hr>\n\n<p>to this:</p>\n\n<pre><code>If (UCase(Cells(i, 13).Value2) = \"ROLE ADJUSTMENT\" _\n    Or _\n    UCase(Cells(i, 13).Value2) = \"NEW ROLE\") _\n    And _\n    Cells(i, 15).Value2 = False Then\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If (UCase(Cells(i, 13).Value2) = \"ROLE ADJUSTMENT\" _\n    Or _\n    UCase(Cells(i, 13).Value2) = \"NEW ROLE\") _\n    And _\n    UCase(Cells(i, 15).Text) = \"FALSE\" Then\n</code></pre>\n\n<hr>\n\n<p>Test code:</p>\n\n<pre><code>Sub testLogicalOps()\n    Dim y As Range\n    For Each y In Range(\"B1:B10\")\n        Debug.Print IIf((y = 5 Or y = 3) And y.Offset(0, 1) = False, \"Yes\", \"No\")\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4896353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a563a62ebd346735340fe9680d4b399?s=128&d=identicon&r=PG&f=1", "display_name": "bennes", "link": "https://stackoverflow.com/users/4896353/bennes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7045, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1609542125, "creation_date": 1440005859, "last_edit_date": 1440013483, "question_id": 32102105, "link": "https://stackoverflow.com/questions/32102105/how-to-combine-or-and-and-in-the-if-statement-vba-in-with-do-until", "title": "How to combine or and and in the if statement vba in with do until", "body": "<p>Is it possible to combine <code>Do Until</code> with <code>If</code> statement containing <code>Or</code> and <code>And</code>?</p>\n\n<p>This is not working correctly, it doesn't take <code>AND</code> condition into consideration, it runs but like <code>AND</code> wouldn't be there</p>\n\n<pre><code>i = 2\nDo Until IsEmpty(Cells(i, 1))\n    If Cells(i, 13) = \"Role Adjustment\" Or Cells(i, 13) = \"New Role\" _\n            And Cells(i, 15) = \"FALSE\" Then\n        Cells(i, 15).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 49407\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n    End If\n    i = i + 1\nLoop\n</code></pre>\n\n<p>And when I try it to do with <code>And</code> and <code>Or</code> combination with brackets, it's not working at all</p>\n\n<pre><code>i = 2\nDo Until IsEmpty(Cells(i, 1))\n    If (Cells(i, 13) = \"Role Adjustment\" Or Cells(i, 13) = \"New Role\") _\n            And Cells(i, 15) = \"FALSE\" Then\n        Cells(i, 15).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 49407\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n    End If\n    i = i + 1\nLoop\n</code></pre>\n\n<p>Is there any possibility how to combine it?\nWhat I am trying to achieve is, when one cell is containing <code>\"Role Adjustment\"</code> or <code>\"New Role\"</code> and other cell is containing <code>\"FALSE\"</code>, to change the color of the cell.</p>\n"}, {"tags": ["excel", "ms-access", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1440006855, "post_id": 32102057, "comment_id": 52099104, "body": "Are you saying you want to basically Loop through the  Column with Ids and delete each Row that has that id ?"}, {"owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1440006996, "post_id": 32102057, "comment_id": 52099172, "body": "@HolmesIV  i like to loop through the column with IDs and delete that particular cell which contains same id as the input from userform, i keep getting error from my existing code"}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1440008264, "post_id": 32102057, "comment_id": 52099882, "body": "Well it seems the line Worksheets(&quot;data&quot;).TextBox2.Value.Delete , should refer to the Cell not the text box?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1440015996, "last_edit_date": 1440015996, "creation_date": 1440010029, "answer_id": 32103328, "question_id": 32102057, "link": "https://stackoverflow.com/questions/32102057/find-row-and-column-of-value-which-key-in-at-userform/32103328#32103328", "title": "Find Row and Column of value which key in at userform", "body": "<p><code>Find()</code> returns the cell which was found: if no match was made then it returns <code>Nothing</code>. </p>\n\n<p>As long as <code>Find()</code> finds a match then you can work with it directly: no need to extract <code>f.Row</code> and <code>f.Column</code> and then turn those back into the same Range. ie <code>f</code> and <code>Worksheets(\"data\").Cells(f.Row, f.Column)</code> refer to the same object.</p>\n\n<pre><code>Set f = Worksheets(\"data\").Range(\"4:4\").Find(What:=TextBox2.Value, lookat:=xlWhole)\n\nIf Not f Is Nothing Then\n    f.Delete\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594643841, "creation_date": 1440005615, "last_edit_date": 1594643841, "question_id": 32102057, "link": "https://stackoverflow.com/questions/32102057/find-row-and-column-of-value-which-key-in-at-userform", "title": "Find Row and Column of value which key in at userform", "body": "<p>i've a userform for user to keyin their id number into one table. but how can i capture the number of row and column of the id inside the table and delete them.</p>\n\n<pre><code>Set f = Worksheets(\"data\").Range(\"4:4\").Find(What:=TextBox2.Value)\n\nIf Worksheets(\"data\").Cells(f.Row, f.Column).Value = TextBox2.Value Then\nWorksheets(\"data\").TextBox2.Value.Delete\nEnd If\n</code></pre>\n\n<p>thank you very much</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 3674157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/34fa3687b27c8f2029f2d6b46bc5bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Zajonc", "link": "https://stackoverflow.com/users/3674157/zajonc"}, "edited": false, "score": 0, "creation_date": 1440099856, "post_id": 32102158, "comment_id": 52145377, "body": "Thank you Excel Hero. This doesn&#39;t quite work for me because I use a connection string rather than a file but it&#39;s the same idea. So for a pivot table I can swap connections in and out, but for a list table I need to edit the connection. This is fine because every list table has its own connection, unlike pivot tables, several of which can run off one connection."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1440006082, "creation_date": 1440006082, "answer_id": 32102158, "question_id": 32101853, "link": "https://stackoverflow.com/questions/32101853/change-data-source-of-a-list-table-in-excel-2010/32102158#32102158", "title": "Change data source of a list table in Excel 2010", "body": "<p>You can do it from the Excel interface without VBA.</p>\n\n<p>Under the Data tab, click on Connections.</p>\n\n<p>From the Workbook Connections dialog, click Properties.</p>\n\n<p>From the Connection Properties dialog, click Definition.</p>\n\n<p>Browse for a connection file and then select a table.</p>\n\n<p>That's it.</p>\n"}, {"tags": [], "owner": {"reputation": 1184, "user_id": 7740387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hZ8g.jpg?s=128&g=1", "display_name": "Birel", "link": "https://stackoverflow.com/users/7740387/birel"}, "is_accepted": false, "score": 0, "last_activity_date": 1606294213, "last_edit_date": 1606294213, "creation_date": 1606293906, "answer_id": 65001205, "question_id": 32101853, "link": "https://stackoverflow.com/questions/32101853/change-data-source-of-a-list-table-in-excel-2010/65001205#65001205", "title": "Change data source of a list table in Excel 2010", "body": "<p>If your data source is inside Excel on another sheet and you're using OLE DB Query, you might find changing the data source impossible (which was the case with me).</p>\n<p>To change the data source in this instance, you need to click on <code>Resize Table</code> under the Table Design tab in Excel, as can be seen below:</p>\n<p><a href=\"https://i.stack.imgur.com/au7A2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/au7A2.png\" alt=\"Excel Ribbon\" /></a></p>\n<p>When you click on this, you are able to change the range of your query, as can be seen below:</p>\n<p><a href=\"https://i.stack.imgur.com/DZPv5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DZPv5.png\" alt=\"Resizing the Table\" /></a></p>\n"}], "owner": {"reputation": 359, "user_id": 3674157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/34fa3687b27c8f2029f2d6b46bc5bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Zajonc", "link": "https://stackoverflow.com/users/3674157/zajonc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 32102158, "answer_count": 2, "score": 1, "last_activity_date": 1606294213, "creation_date": 1440004882, "question_id": 32101853, "link": "https://stackoverflow.com/questions/32101853/change-data-source-of-a-list-table-in-excel-2010", "title": "Change data source of a list table in Excel 2010", "body": "<p>Is there a way to change the data source of a list table in Excel? It's easy to change the data source of a pivot table but the only way I have found to change the data source of a list table is to delete the table and start again.</p>\n\n<p>Just to be clear, what I mean by a list table is what you get when you set up a connection to a table or query in Access (for example) and then click on \"Existing Connections\" under the Data tab.</p>\n\n<p>I would prefer a method using the usual user interface but if there is a method that works only in VBA, that would be fine.</p>\n"}, {"tags": ["excel", "rounding", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1440003665, "post_id": 32101465, "comment_id": 52097325, "body": "Why do you think it makes sense to have -4 places after the decimal point? What are you hoping to do?"}, {"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1440003679, "post_id": 32101465, "comment_id": 52097341, "body": "The <code>Round()</code>  function can&#39;t receive a negative value for the decimal positions. I think that you&#39;re trying to round to a closest power of ten"}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1440006955, "post_id": 32101465, "comment_id": 52099157, "body": "Can you show a before and after ?"}], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 1, "user_id": 5244401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6fcb98c01aa22d63ca8ab4b3fd1c63?s=128&d=identicon&r=PG&f=1", "display_name": "Kat R", "link": "https://stackoverflow.com/users/5244401/kat-r"}, "edited": false, "score": 0, "creation_date": 1440007670, "post_id": 32101581, "comment_id": 52099532, "body": "@KatR Glad I could help - if this answered your question then don&#39;t forget to click &#39;answered&#39; next to this answer&#39;s score."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1440003920, "creation_date": 1440003920, "answer_id": 32101581, "question_id": 32101465, "link": "https://stackoverflow.com/questions/32101465/excel-vba-rounding/32101581#32101581", "title": "Excel VBA Rounding", "body": "<p>I believe you will need to make this function yourself, as follows (I'm not aware of a function in VBA which works as Excel's native Round function, which allows you to round to the nearest 1000 etc):</p>\n\n<pre><code>Sub add_round()\n\nDim rng As Range\n    For Each rng In Selection\n        rng.Value = Round(rng.Value / 10000, 0) * 10000\n    Next rng\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively you can tell VBA to use the native Excel function like this:</p>\n\n<pre><code>Sub add_round()\n\nDim rng As Range\n    For Each rng In Selection\n        rng.Value = Application.WorksheetFunction.Round(rng.Value, - 4)\n    Next rng\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5244401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6fcb98c01aa22d63ca8ab4b3fd1c63?s=128&d=identicon&r=PG&f=1", "display_name": "Kat R", "link": "https://stackoverflow.com/users/5244401/kat-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2111, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1440003920, "creation_date": 1440003545, "last_edit_date": 1531164843, "question_id": 32101465, "link": "https://stackoverflow.com/questions/32101465/excel-vba-rounding", "title": "Excel VBA Rounding", "body": "<p>I am trying to use the following code to replace each cell within a selected range with the rounded number of the cell within that range but I continue to get an error. </p>\n\n<pre><code>Sub add_round()\nDim rng As Range\n    For Each rng In Selection\n        rng.Value = Round(rng.Value, -4)\n    Next rng\n\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": false, "score": 0, "last_activity_date": 1440029390, "creation_date": 1440029390, "answer_id": 32107603, "question_id": 32101453, "link": "https://stackoverflow.com/questions/32101453/copying-values-across-a-dynamic-column-and-row-range/32107603#32107603", "title": "Copying values across a dynamic column and row range", "body": "<p>Yes there is a way to write the code which will make the copy dynamic across the columns and rows.  What you need to do is to identify a distinct quality about  the cost centres so that you locate it using something like <code>ActiveSheet.Cells.Find(Txt)</code>.\nThen you'll be able to determine what CTNameCol should be. There is some helpful info here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find Method</a>.</p>\n\n<p>If you add add a picture of your spreadsheet I will update this answer with more precise information.</p>\n"}], "owner": {"reputation": 1, "user_id": 5243977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a160d059db454e002d05194c6a380d?s=128&d=identicon&r=PG&f=1", "display_name": "jip_88", "link": "https://stackoverflow.com/users/5243977/jip-88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440030518, "creation_date": 1440003491, "question_id": 32101453, "link": "https://stackoverflow.com/questions/32101453/copying-values-across-a-dynamic-column-and-row-range", "title": "Copying values across a dynamic column and row range", "body": "<p>I have the following code that:</p>\n\n<ul>\n<li>copies the column headings (in row 1) from column C across to the second last column</li>\n<li>pastes these column headings in row 1 in the column 2 across from the last column with data</li>\n<li><p>pastes the column headings alongside each row of data through to the bottom row</p>\n\n<pre><code>Sub GLDR()\n\n'use End(xlUp) to determine Last Row with Data, in column A of the GLDRYYPP tab\nDim lastRowDR As Long\nlastRowDR = Sheets(\"GLDRYYPP\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'copy the cost type categories and paste alongside the cost centres\nCTNameCol = \"S2:AF\" &amp; lastRowDR\n\nSheets(\"GLDRYYPP\").Range(\"C1\", Range(\"C1\").End(xlToRight).Offset(0, -1)).Copy\nSheets(\"GLDRYYPP\").Paste Destination:=Sheets(\"GLDRYYPP\").Range(\"C1\").End(xlToRight).Offset(0, 2)\nSheets(\"GLDRYYPP\").Range(Range(\"C1\").End(xlToRight).Offset(0, 2), Range(\"C1\").End(xlToRight).Offset(0, 2).End(xlToRight)).Copy\n\nSheets(\"GLDRYYPP\").Paste Destination:=Sheets(\"GLDRYYPP\").Range(CTNameCol)\n\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>The first two steps have been set to be dynamic for any additional columns added but I am having trouble writing some code that will paste the data through to the bottom row. As you can see the range \"S2:AF(last row)\" has been written to make use of the result from the lastRowDR dimension.</p>\n\n<p>Is there a way to write the code which will make the copy dynamic across the columns and rows?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "edited": false, "score": 0, "creation_date": 1440003426, "post_id": 32101406, "comment_id": 52097181, "body": "Set rs = New ADODB.Recordset With rs Set .ActiveConnection = cn .Source = &quot;select distinct assignedto from pc3claims where assignedto is not null order by AssignedTo&quot; .LockType = adLockOptimistic .CursorType = adOpenKeyset &#39;must use aduseclient to have a bindable recordset. .CursorLocation = adUseClient .Open End With Set Me.Recordset = rs &#39;Me.RecordSource = rs.Source Set cboAssociate.Recordset = Me.Recordset cboAssociate.ControlSource = AssignedTo Set rs = Nothing Set cn = Nothing"}], "answers": [{"tags": [], "owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "is_accepted": false, "score": 0, "last_activity_date": 1440423654, "creation_date": 1440423654, "answer_id": 32183799, "question_id": 32101406, "link": "https://stackoverflow.com/questions/32101406/access2010-form-with-a-non-selectable-combo-box/32183799#32183799", "title": "access2010 form with a non selectable combo box", "body": "<p>I think the problem is that you are using the same recordset for the form and the combo box.</p>\n\n<p>You can use just the sql statement to populate your combo box using the Row Source property and set the Bound Column to 1. </p>\n\n<pre><code>cboAssociate.RowSource =  \"Select distinct assignedto from pc3claims where assignedto is not null order by AssignedTo\" \ncboAssociate.BoundColumn = 1\n</code></pre>\n\n<p>This will populate your combo with the AssignedTo values and you can then set the Control Source to the AssignedTo field in your form's recordset.</p>\n"}], "owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459429603, "creation_date": 1440003339, "last_edit_date": 1459429603, "question_id": 32101406, "link": "https://stackoverflow.com/questions/32101406/access2010-form-with-a-non-selectable-combo-box", "title": "access2010 form with a non selectable combo box", "body": "<p>I have an access 2010 form with a combo box. When I run the Ado query the drop down list shows but when I try and select nothing is selected and the message at the bottom of the screen says form 'readonly'.</p>\n"}, {"tags": ["excel", "vba", "excel-addins"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440003608, "post_id": 32101259, "comment_id": 52097297, "body": "Have you considered checking the filename and path and only showing the message if it&#39;s the &quot;oginial&quot; path?  Or if you mark the template as &quot;read only&quot; then your users will always need to &quot;save as&quot;..."}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440010130, "post_id": 32101259, "comment_id": 52101104, "body": "Marking it read as will ask them to enable macros, Simply need a statement that says <code>If file saved As Then remove the auto_open macro</code>   and    <code>if save function is used Then ask for password</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440010332, "post_id": 32101259, "comment_id": 52101225, "body": "Some code here you could use: <a href=\"http://www.mrexcel.com/forum/excel-questions/535724-how-open-save-dialog-box-visual-basic-applications.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440011466, "post_id": 32101259, "comment_id": 52101880, "body": "I don&#39;t think that helps me any, I&#39;ve actually used alot of that code with the other modules"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440012156, "post_id": 32101259, "comment_id": 52102271, "body": "Yes - my bad: did not read your code completely.  You&#39;re not checking the value of <code>bFileSaveAs</code> before deleting the code though ?"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440012564, "post_id": 32101259, "comment_id": 52102552, "body": "what do you mean checking the value?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440013136, "post_id": 32101259, "comment_id": 52102894, "body": "<code>bFileSaveAs</code> will be False if the user cancels the &quot;save as&quot; dialog, and True if they actually use it to save the file."}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440015189, "post_id": 32101259, "comment_id": 52104145, "body": "So <code>If True Then Disable Unload Me</code>     <code>If False Then Unload Me</code>? Ok that fixes half the problem but if I cancel and use the save as in file tab it wont disable the auto open."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1440012439, "post_id": 32101616, "comment_id": 52102470, "body": "I have nothing to replace the Auto_Open module with, and its only job is to prompt the userform. I looked into using the <code>before save</code> but that would try to remove the Auto_Open every time someone saved the new file and it would error out because it already removed it the first time it SavedAs. This did work for another excel project so thank you for that!"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1440025130, "post_id": 32101616, "comment_id": 52108364, "body": "@Duraholiday I don&#39;t mean to replace the entire module, just comment out the line that calls <code>SaveAsUserForm.Show</code>."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1440005010, "last_edit_date": 1440005010, "creation_date": 1440004022, "answer_id": 32101616, "question_id": 32101259, "link": "https://stackoverflow.com/questions/32101259/disabling-vba-module-after-save-as-function/32101616#32101616", "title": "Disabling VBA module after Save As function", "body": "<p>You can modify the code at runtime. You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264478.aspx\" rel=\"nofollow\">ReplaceLine</a> method to replace the line calling <code>SaveAsUserForm.Show</code> with a comment:</p>\n\n<pre><code>Dim mdl As CodeModule\nSet mdl = x.Item(\"Auto_Open\")\nmdl.ReplaceLine(3, \"'SaveAsUserForm.Show\")\n</code></pre>\n\n<p>Caveat: If the line number to replace ever changes, this code will overwrite the new line. I suggest finding the line number of the text in question, and then using <code>ReplaceLine</code> with that line number.</p>\n\n<p>(This should be straightforward, but it isn't. Apparently, you have to get the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264494.aspx\" rel=\"nofollow\">count of lines in the module</a>, read all the <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264604.aspx\" rel=\"nofollow\">lines in the module</a> by passing in the count of lines, split the text by line, and find the line with the matching text.)</p>\n"}], "owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440015746, "creation_date": 1440002799, "last_edit_date": 1440015746, "question_id": 32101259, "link": "https://stackoverflow.com/questions/32101259/disabling-vba-module-after-save-as-function", "title": "Disabling VBA module after Save As function", "body": "<p>When the template is opened it runs an Auto_open module.</p>\n\n<pre><code> Sub Auto_Open()\n\n SaveAsUserForm.Show\n\n End Sub\n</code></pre>\n\n<p>This then brings up a userform that says please save as and a Ok command button. </p>\n\n<p><a href=\"https://i.stack.imgur.com/IrIw4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IrIw4.png\" alt=\"enter image description here\"></a></p>\n\n<p>When Ok is clicked it runs this code.</p>\n\n<pre><code>Private Sub SaveAs_Click()\n\nDim bFileSaveAs As Boolean\nbFileSaveAs = Application.Dialogs(xlDialogSaveAs).Show\n\nIf Not bFileSaveAs Then Unload Me\n\nIf bFileSaveAs Then    \n    Dim x As Object\n    Set x = Application.VBE.ActiveVBProject.VBComponents\n    x.Remove VBComponent:=x.Item(\"Auto_Open\")\n\n    Unload Me\n\nEnd Sub\n</code></pre>\n\n<p>This deletes the Auto_Open module so the save as user form doesn't pop up in the new file that was just saved. But I only want it disabled if the save as function is used (both using the auto open module or in the file tab</p>\n\n<p>I also need it so if the user cancels the box it will disable the save function completely and only allow save as. But if the save function is used it ask for a password, so i can edit the template. </p>\n\n<p>So basically when the user opens the template he cant do or change anything unless he SaveAs first, Then once its Saved As and the file name changes it will disable the Auto_Open module so it doesn't ask to save as every time the new file is opened. </p>\n"}, {"tags": ["vba", "powershell"], "answers": [{"tags": [], "owner": {"reputation": 765, "user_id": 747675, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/O1DeD.jpg?s=128&g=1", "display_name": "ATek", "link": "https://stackoverflow.com/users/747675/atek"}, "is_accepted": false, "score": 0, "last_activity_date": 1440005057, "creation_date": 1440005057, "answer_id": 32101897, "question_id": 32101010, "link": "https://stackoverflow.com/questions/32101010/run-a-powershell-command-not-script-from-excel-vba/32101897#32101897", "title": "Run a Powershell command (not script) from Excel VBA", "body": "<p>Haven't tested but this but the execution policy may be a factor.</p>\n\n<pre><code>pscmd = \"PowerShell -NoProfile -NoLogo -ExecutionPolicy Bypass -Command {\" &amp; _\nChr(34) &amp; \"Get-ScheduledTask\" &amp; _\n  \" -TaskName \" &amp; Chr(34) &amp; \"My Task\" &amp; Chr(34) &amp; _\n  \" -CimSession MYLAPTOP\" &amp; Chr(34) &amp; \"}\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 2, "creation_date": 1440005643, "post_id": 32101992, "comment_id": 52098464, "body": "Thanks Bond. Obviously I need to brush up on my PowerShell switches. :/"}, {"owner": {"reputation": 347, "user_id": 2122818, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/13e57a10586ebe494f03549d8d8038ff?s=128&d=identicon&r=PG", "display_name": "Franz Kiermaier", "link": "https://stackoverflow.com/users/2122818/franz-kiermaier"}, "edited": false, "score": 0, "creation_date": 1573498443, "post_id": 32101992, "comment_id": 103893728, "body": "I have tried this in a Word macro, but it didn&#39;t work in the described way. Passing the PowerShell command without curly braces and surrounding quotation-marks worked for me."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 11, "last_activity_date": 1440005371, "creation_date": 1440005371, "answer_id": 32101992, "question_id": 32101010, "link": "https://stackoverflow.com/questions/32101010/run-a-powershell-command-not-script-from-excel-vba/32101992#32101992", "title": "Run a Powershell command (not script) from Excel VBA", "body": "<p>To run an inline Powershell command, you'll probably need to use the <code>-Command</code> param and surround your statement with quotes. It'll also be easier if you use single quotes within the command.</p>\n\n<p>Try this out:</p>\n\n<pre><code>pscmd = \"PowerShell -Command \"\"{Get-ScheduledTask -TaskName 'My Task' -CimSession MYLAPTOP}\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29697, "favorite_count": 1, "accepted_answer_id": 32101992, "answer_count": 2, "score": 11, "last_activity_date": 1440005371, "creation_date": 1440001821, "question_id": 32101010, "link": "https://stackoverflow.com/questions/32101010/run-a-powershell-command-not-script-from-excel-vba", "title": "Run a Powershell command (not script) from Excel VBA", "body": "<p>I've searched SO, and I can find plenty of examples of running a PowerShell script from VBA, but I can't find any examples of just running a simple command.</p>\n\n<p>For example, this works:</p>\n\n<pre><code>Dim retval As Variant\nretval = Shell(\"PowerShell \"\"C:\\MyScript.ps1\"\"\", vbNormalFocus)\n</code></pre>\n\n<p>But this does not:</p>\n\n<pre><code>Dim retval As Variant\nDim pscmd As String\n\npscmd = \"PowerShell \" &amp; _\n  Chr(34) &amp; \"Get-ScheduledTask\" &amp; _\n  \" -TaskName \" &amp; Chr(34) &amp; \"My Task\" &amp; Chr(34) &amp; _\n  \" -CimSession MYLAPTOP\" &amp; Chr(34)\nretval = Shell(pscmd, vbNormalFocus)\n\nDebug.Print pscmd\n'pscmd = PowerShell \"Get-ScheduledTask -TaskName \"My Task\" -CimSession MYLAPTOP\"\n</code></pre>\n\n<p>I know I could write the PS command to a file, execute it as a script, and then delete the file, but that does not seem to be very elegant.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 411, "user_id": 5244155, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a6a65335dcd3483f9240771217882802?s=128&d=identicon&r=PG&f=1", "display_name": "H. Dave", "link": "https://stackoverflow.com/users/5244155/h-dave"}, "edited": false, "score": 0, "creation_date": 1440003020, "post_id": 32100451, "comment_id": 52096982, "body": "Thank you to Ariful Haque for the help on how to edit a question."}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 5244155, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a6a65335dcd3483f9240771217882802?s=128&d=identicon&r=PG&f=1", "display_name": "H. Dave", "link": "https://stackoverflow.com/users/5244155/h-dave"}, "edited": false, "score": 0, "creation_date": 1440007477, "post_id": 32101535, "comment_id": 52099438, "body": "Thank you for your comment. The errHandler works but sometime an error occurs during the first line of the errHandler (in that case If msgBox...). It looks like I need an error Handler of my error handler !!"}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": false, "score": 0, "last_activity_date": 1440003760, "creation_date": 1440003760, "answer_id": 32101535, "question_id": 32100451, "link": "https://stackoverflow.com/questions/32100451/prevent-user-to-stop-a-macro-excel-vba/32101535#32101535", "title": "Prevent user to stop a macro (Excel VBA)", "body": "<p>I've never done this, but this is how I would start from your code:</p>\n\n<pre><code>On Error GoTo errHandler:\nApplication.EnableCancelKey = xlErrorHandler\n\nActiveWorkbook.Save\n\nApplication.EnableCancelKey = xlInterrupt\n\nexitHere:\n  Exit Sub\n\n\nerrHandler:\n  If MsgBox(\"something\", vbOKCancel) = vbCancel Then\n    Application.EnableCancelKey = xlInterrupt\n    Exit Sub\n  End If\n\n  Resume\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 5244155, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a6a65335dcd3483f9240771217882802?s=128&d=identicon&r=PG&f=1", "display_name": "H. Dave", "link": "https://stackoverflow.com/users/5244155/h-dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1808, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1440005207, "creation_date": 1439999952, "last_edit_date": 1440005207, "question_id": 32100451, "link": "https://stackoverflow.com/questions/32100451/prevent-user-to-stop-a-macro-excel-vba", "title": "Prevent user to stop a macro (Excel VBA)", "body": "<p>I would like to prevent a user from stopping a macro during saving.\nI have found the following code :</p>\n\n<pre><code>Application.EnableCancelKey = xlDisabled\n</code></pre>\n\n<p>It works if you hit the <kbd>ESC</kbd> key once, but if you hold the key a long time you  can stop the macro.</p>\n\n<p>I tried <code>Application.EnableCancelKey = xlErrorHandler</code> as follow :</p>\n\n<pre><code>Application.EnableCancelKey = xlErrorHandler\nOn Error GoTo errHandler:\n\nActiveWorkbook.Save\n\nexitHere:\n  Exit Sub\n\nerrHandler:\n  msgbox\"something\"\n  Resume exitHere\n</code></pre>\n\n<p>Sometime it works perfectly, but sometimes if I hit the <kbd>ESC</kbd> key at the perfect moment and for a few seconds, I am able to stop the macro.</p>\n\n<p>Do you know if there is a way to inactive <kbd>ESC</kbd> key for real?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1440000588, "post_id": 32100178, "comment_id": 52095683, "body": "Create a copy of  Sheet1 and name it &quot;Orders&quot;. In a new column (Column 11) on the &quot;Orders&quot; sheet , use the match formula to see when column F matches column A in sheet2.  Then filter the &quot;Orders&quot; sheet and delete all of the #NA&#39;s in your data and you are done."}, {"owner": {"reputation": 1, "user_id": 5243922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab1575a5c72aeb459e24dff90145b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Pats", "link": "https://stackoverflow.com/users/5243922/pats"}, "reply_to_user": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1440005207, "post_id": 32100178, "comment_id": 52098171, "body": "Thanks rwilson for your reply. I have a feeling though that it won&#39;t be as straightforward as I hope it to be for repeated, weekly use. Especially given that I want to share the method / macro for use by my colleagues. Thanks again."}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1440005533, "post_id": 32100178, "comment_id": 52098398, "body": "I&#39;m just giving you the steps you can take in Excel to complete the process. Using these steps, the macro recorder, and a little work, you should be able to do this. Nobody on SO knows your data better than you do."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 3787529, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/17eafb02019036f15991cc645e34f2ae?s=128&d=identicon&r=PG&f=1", "display_name": "Tnimni", "link": "https://stackoverflow.com/users/3787529/tnimni"}, "is_accepted": false, "score": 0, "last_activity_date": 1439999596, "creation_date": 1439999596, "answer_id": 32100327, "question_id": 32100178, "link": "https://stackoverflow.com/questions/32100178/excel-2010-take-whole-rows-from-one-sheet-and-display-them-in-the-2nd-sheet-ba/32100327#32100327", "title": "Excel 2010 - Take whole rows from one sheet and display them in the 2nd sheet based on match in 3rd sheet", "body": "<p>I do believe you'll need to use VBA script to copy the entire row.</p>\n\n<p>Please make sure your data in both sheets 1 &amp; 2 is sorted if you wish to use vlookup, but I don't think it will help since vlookup will \"stop\" on the first hit, meaning if you have a customer names John on sheet1 which repeats several times, vlookup will only pick the first occurrence</p>\n\n<p>Regards,</p>\n"}], "owner": {"reputation": 1, "user_id": 5243922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab1575a5c72aeb459e24dff90145b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Pats", "link": "https://stackoverflow.com/users/5243922/pats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442276516, "creation_date": 1439999181, "last_edit_date": 1442276516, "question_id": 32100178, "link": "https://stackoverflow.com/questions/32100178/excel-2010-take-whole-rows-from-one-sheet-and-display-them-in-the-2nd-sheet-ba", "title": "Excel 2010 - Take whole rows from one sheet and display them in the 2nd sheet based on match in 3rd sheet", "body": "<p>I'll cut to the chase:</p>\n\n<p>Excel 2010</p>\n\n<p>I have <code>Sheet1</code> with a list of orders. Customer name is in column <code>F</code>.</p>\n\n<p><code>Sheet2</code> contains list of customers with just their names in column <code>A</code>.</p>\n\n<p>I would like to run a macro / vlookup / index (whatever works) to run through the list of thousands of orders in <code>Sheet1</code> and copy to <code>Sheet3</code> the rows (whole rows) where the customer name from <code>Sheet2</code> matches. </p>\n\n<p><code>Sheet1</code> has 10 columns and about 10000 rows. \n<code>Sheet2</code> has about 50 rows in column A only. </p>\n\n<p>I have tried a few types of macros and did a proper search but couldn't find anything that would work. I would paste what I have but that would only be an embarrassment. </p>\n\n<p>I might add that I will need to run this weekly and the list of orders will be changing. List of names may too but with little frequency. </p>\n\n<p>Can you help? :)</p>\n\n<p><strong>EDIT</strong>: From the answers so far I can see that I would need to use VBA script. I would appreciate help with that as I know next to nothing about the language. I should be able to manage modifying the script to suit my needs but I need something to start. Perhaps this pseudocode will make it easier for you good people:</p>\n\n<hr>\n\n<p><em>Read data from A1:A50 in Sheet2</em></p>\n\n<p><em>Compare F1, Sheet1 with A1:A50, Sheet2</em></p>\n\n<p><em>If no match - continue to F2</em></p>\n\n<p><em>If match - copy whole row to A1 in Sheet3</em></p>\n\n<p>(...)</p>\n\n<p><em>Compare Fx, Sheet1 with A1:A50, Sheet2</em></p>\n\n<p><em>If no match - continue to Fx+1</em></p>\n\n<p><em>If match - copy whole row to A(n+1) [n=number of matches] in Sheet3</em></p>\n\n<p><em>Continue comparing rows in Sheet1 to A1:A50, Sheet2 and return next match in An, Sheet3</em></p>\n\n<hr>\n\n<p>So far I have something like this but the problem is that it returns data to Sheet3 <em>only</em> if row number in Sheet2 matches row number in Sheet1. Also, it returns it to Sheet3, row number matching Sheet1. So I end up with one result in row 45 in Sheet3 instead of around 20 results in rows 1-20.</p>\n\n<pre><code>Sub asd()\nFor Counter = 1 To Sheets(1).UsedRange.Rows.Count\n    If Sheets(1).Range(\"F\" &amp; Counter).Value = Sheets(2).Range(\"A\" &amp; Counter).Value Then\n      Sheets(3).Range(\"C\" &amp; (Counter)).Value = Sheets(1).Range(\"A\" &amp; Counter).Value\n      Sheets(3).Range(\"D\" &amp; (Counter)).Value = Sheets(1).Range(\"B\" &amp; Counter).Value\n    End If\nNext Counter\nEnd Sub\n</code></pre>\n\n<p>Thank you,\nPat</p>\n"}, {"tags": ["excel", "vba", "set", "range"], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1439999682, "post_id": 32099955, "comment_id": 52095062, "body": "Just doubling down on the &quot;...use a different name for your variable...&quot;.  I tend to use <code>rng</code> or <code>myRange</code> or something instead of <code>Range</code>."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 2, "last_activity_date": 1439998565, "creation_date": 1439998565, "answer_id": 32099955, "question_id": 32099891, "link": "https://stackoverflow.com/questions/32099891/set-a-range-and-use-that-range-in-a-formula/32099955#32099955", "title": "Set a range and use that range in a formula", "body": "<p>Your formula is a string, so you need to concatenate your range address into your formula:</p>\n\n<pre><code>Sheets(\"sheet1\").Cells(3, 4).Formula = \"=sum(\" &amp; range.Address &amp; \")\"\n</code></pre>\n\n<p>You should probably use a different name for your variable, however, as <code>Range</code> is a built-in type/function in Excel VBA.</p>\n"}], "owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 32099955, "answer_count": 1, "score": 1, "last_activity_date": 1439999498, "creation_date": 1439998390, "last_edit_date": 1439999498, "question_id": 32099891, "link": "https://stackoverflow.com/questions/32099891/set-a-range-and-use-that-range-in-a-formula", "title": "Set a range and use that range in a formula", "body": "<p>I am unable to figure out how to use a <code>set</code> range in a formula:</p>\n\n<pre><code>set range = Application.InputBox(prompt:=\"test\", Title:=\"test\", Type:=8)\nSheets(\"sheet1\").Cells(3, 4).Formula = \"=sum(range)\"\n</code></pre>\n\n<p>All that is returned is <code>sum(range)</code>, not the actual sum of the selected cells.</p>\n\n<p>I've tried <code>range.address</code> and a couple other variations to no avail. </p>\n"}, {"tags": ["vba", "excel", "ms-access", "windows-server-2008"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1439999693, "post_id": 32099791, "comment_id": 52095071, "body": "<i>Did</i> you try saving to a local folder? Does it give the same error?"}, {"owner": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1440000137, "post_id": 32099791, "comment_id": 52095404, "body": "@Andre451 Yes, same error on local folder."}, {"owner": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1440000160, "post_id": 32099791, "comment_id": 52095418, "body": "@HansUp Yes. The processes work correctly when run manually on the same machine."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1440001846, "post_id": 32099791, "comment_id": 52096308, "body": "Sounds like a a security setting that interdicts scripts and automated COM objects, but not manual actions: the leading suspect for that is &#39;Trusted Locations&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "edited": false, "score": 0, "creation_date": 1440001770, "post_id": 32100877, "comment_id": 52096258, "body": "I&#39;m looking at Trusted Locations currently -- should I be adding my input/output folders to this section and checking &quot;allow trusted locations on my network&quot; to test? I don&#39;t see any unusual Excel add-ins anywhere, either."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "reply_to_user": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "edited": false, "score": 0, "creation_date": 1440002187, "post_id": 32100877, "comment_id": 52096529, "body": "Yes, you should... Provided that you believe that these folders are in locations you can trust! It would be embarrassing to do this in a &#39;sandbox&#39; folder, or an FTP drop receiving external files."}, {"owner": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "edited": false, "score": 0, "creation_date": 1440002972, "post_id": 32100877, "comment_id": 52096956, "body": "Unfortunately, same error even when enabling all the trust center folders/options/etc."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "reply_to_user": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "edited": false, "score": 0, "creation_date": 1440063663, "post_id": 32100877, "comment_id": 52122326, "body": "...So what&#39;s with the answer <i>We added BOTH folders:&#39;</i> ?   - It looks like adding a folder to Trusted Locations seems to have worked for you."}], "tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": false, "score": 0, "last_activity_date": 1441980843, "last_edit_date": 1441980843, "creation_date": 1440001348, "answer_id": 32100877, "question_id": 32099791, "link": "https://stackoverflow.com/questions/32099791/ms-access-2010-excel-2010-windows-server-2008-r2-64-bit-saveas-method-of-work/32100877#32100877", "title": "MS Access 2010, Excel 2010, Windows Server 2008 R2 64-bit: SaveAs method of Workbook class failed", "body": "<p>My first suggestion would be to check for Excel add-ins that run automatically - especially a corporate security document classification / copyright notice script.</p>\n\n<p>Your next suspect is <strong>Trusted Locations</strong>, which I've mentioned elsewhere under the heading <A HREF=\"http://excellerando.blogspot.co.uk/2015/01/trusted-locations-source-of-misleading.html\" rel=\"nofollow\">Trusted Locations: a source of misleading error messages</A>. </p>\n\n<p>This is the leading suspect, because 'Trusted Locations' is a security setting that interdicts scripts and automated COM objects, but not manual actions. Or at least, not <em>all</em> 'user is present' manual actions. So you won't catch it by trying to reproduce the error  manually - and you might find that your attempts at debugging give inconsistent results.</p>\n\n<p>You can set a folder to be a trusted location manually, in any Microsoft Office Application, under the 'File' menus as Options; Trust Center; Trusted Locations - but this is user-specific and you might not be able to do it for whoever (or whatever) runs your application. So this should give you a hint about automating it:</p>\n\n<p><H3>VBA Code to set a Trusted Location:</H3></p>\n\n<p><PRE>\n<CODE>\nPublic&nbsp;Sub&nbsp;TrustThisFolder(Optional&nbsp;FolderPath&nbsp;As&nbsp;String,&nbsp;_\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optional&nbsp;TrustSubfolders&nbsp;As&nbsp;Boolean&nbsp;=&nbsp;True,&nbsp;_\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optional&nbsp;TrustNetworkFolders&nbsp;As&nbsp;Boolean&nbsp;=&nbsp;False,&nbsp;_\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optional&nbsp;sDescription&nbsp;As&nbsp;String)<BR />\n'&nbsp;Add&nbsp;a&nbsp;folder&nbsp;to&nbsp;the&nbsp;'Trusted&nbsp;Locations'&nbsp;list&nbsp;so&nbsp;that&nbsp;your&nbsp;project's&nbsp;VBA&nbsp;can\n'&nbsp;open&nbsp;Excel&nbsp;files&nbsp;without&nbsp;raising&nbsp;errors&nbsp;like&nbsp;\"Office&nbsp;has&nbsp;detected&nbsp;a&nbsp;problem\n'&nbsp;with&nbsp;this&nbsp;file.&nbsp;To&nbsp;help&nbsp;protect&nbsp;your&nbsp;computer&nbsp;this&nbsp;file&nbsp;cannot&nbsp;be&nbsp;opened.\"<BR />\n'&nbsp;Ths&nbsp;function&nbsp;has&nbsp;been&nbsp;implemented&nbsp;to&nbsp;fail&nbsp;silently&nbsp;on&nbsp;error:&nbsp;if&nbsp;you&nbsp;suspect\n'&nbsp;that&nbsp;users&nbsp;don't&nbsp;have&nbsp;permission&nbsp;to&nbsp;assign&nbsp;'Trusted&nbsp;Location'&nbsp;status&nbsp;in&nbsp;all\n'&nbsp;locations,&nbsp;reformulate&nbsp;this&nbsp;as&nbsp;a&nbsp;function&nbsp;returning&nbsp;True&nbsp;or&nbsp;False<BR /><BR />\n'&nbsp;&nbsp;This&nbsp;should&nbsp;be&nbsp;used&nbsp;with&nbsp;caution:&nbsp;although&nbsp;I&nbsp;regard&nbsp;Microsoft's&nbsp;rationale\n'&nbsp;&nbsp;for&nbsp;'Trusted&nbsp;Locations'&nbsp;to&nbsp;be&nbsp;flawed&nbsp;(in&nbsp;this&nbsp;specific&nbsp;case,&nbsp;perverse&nbsp;and\n'&nbsp;&nbsp;worse&nbsp;than&nbsp;ineffective)&nbsp;bypassing&nbsp;a&nbsp;security&nbsp;feature&nbsp;is&nbsp;never&nbsp;a&nbsp;good&nbsp;idea\n'&nbsp;&nbsp;without&nbsp;letting&nbsp;the&nbsp;users&nbsp;know&nbsp;what&nbsp;they&nbsp;are&nbsp;doing,&nbsp;and&nbsp;offering&nbsp;a&nbsp;choice<BR />\n'&nbsp;&nbsp;You&nbsp;are&nbsp;strongly&nbsp;advised&nbsp;to&nbsp;keep&nbsp;the&nbsp;confirmation&nbsp;dialogue,&nbsp;unless&nbsp;you've\n'&nbsp;&nbsp;run&nbsp;into&nbsp;something&nbsp;stupid&nbsp;-&nbsp;like&nbsp;refusing&nbsp;to&nbsp;open&nbsp;files&nbsp;in&nbsp;the&nbsp;user's&nbsp;own\n'&nbsp;&nbsp;local&nbsp;temp&nbsp;folder&nbsp;-&nbsp;which&nbsp;is&nbsp;what&nbsp;we're&nbsp;dealing&nbsp;with&nbsp;here,&nbsp;in&nbsp;basExcelSQL<BR /><BR />\n'&nbsp;Author:<BR />\n'&nbsp;Nigel&nbsp;Heffernan&nbsp;January&nbsp;2015&nbsp;http:\\Excellerando.blogspot.com<BR />'\n'&nbsp;Based&nbsp;on&nbsp;code&nbsp;published&nbsp;by&nbsp;Daniel&nbsp;Pineault&nbsp;in&nbsp;DevHut.net&nbsp;on&nbsp;June&nbsp;23,&nbsp;2010:\n'&nbsp;www.devhut.net\\2010\\06\\23\\vbscript-createset-trusted-location-using-vbscript\\<BR />\n'&nbsp;****&nbsp;****&nbsp;****&nbsp;****&nbsp;&nbsp;THIS&nbsp;CODE&nbsp;IS&nbsp;IN&nbsp;THE&nbsp;PUBLIC&nbsp;DOMAIN&nbsp;&nbsp;****&nbsp;****&nbsp;****&nbsp;****<BR />\n'&nbsp;This&nbsp;code&nbsp;has&nbsp;been&nbsp;widely&nbsp;published,&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;sites&nbsp;carrying\n'&nbsp;it&nbsp;(and&nbsp;derived&nbsp;works)&nbsp;asserts&nbsp;that&nbsp;it&nbsp;is&nbsp;subject&nbsp;to&nbsp;an&nbsp;open-source&nbsp;license,\n'&nbsp;which&nbsp;explicitly&nbsp;forbids&nbsp;us&nbsp;from&nbsp;asserting&nbsp;ownership,&nbsp;copyright,&nbsp;or&nbsp;other\n'&nbsp;intellectual&nbsp;property&nbsp;rights,&nbsp;or&nbsp;attempting&nbsp;to&nbsp;impose&nbsp;restrictive&nbsp;commercial\n'&nbsp;secrecy&nbsp;terms&nbsp;on&nbsp;its&nbsp;use,&nbsp;re-use,&nbsp;or&nbsp;publication.&nbsp;Take&nbsp;care&nbsp;to&nbsp;<em>label</em>&nbsp;this\n'&nbsp;this&nbsp;code,&nbsp;and&nbsp;segregate&nbsp;it&nbsp;from&nbsp;proprietary&nbsp;source&nbsp;code,&nbsp;or&nbsp;other&nbsp;material\n'&nbsp;with&nbsp;embedded&nbsp;business&nbsp;process&nbsp;information&nbsp;which&nbsp;should&nbsp;be&nbsp;kept&nbsp;private.<BR /><BR />\n'&nbsp;UNIT&nbsp;TESTING:<BR />'\n'&nbsp;1:&nbsp;&nbsp;&nbsp;&nbsp;Reinstate&nbsp;the&nbsp;commented-out&nbsp;line&nbsp;'Debug.Print&nbsp;sSubKey&nbsp;&amp;&nbsp;vbTab&nbsp;&amp;&nbsp;sPath\n'&nbsp;2:&nbsp;&nbsp;&nbsp;&nbsp;Open&nbsp;the&nbsp;Immediate&nbsp;Window&nbsp;and&nbsp;run&nbsp;this&nbsp;command:\n'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TrustThisFolder&nbsp;\"Z:\\\",&nbsp;True,&nbsp;True,&nbsp;\"The&nbsp;user's&nbsp;home&nbsp;directory\"\n'&nbsp;3:&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;&nbsp;\"Z:\\\"&nbsp;&nbsp;is&nbsp;already&nbsp;in&nbsp;the&nbsp;list,&nbsp;choose&nbsp;another&nbsp;folder\n'&nbsp;4:&nbsp;&nbsp;&nbsp;&nbsp;Repeat&nbsp;step&nbsp;2&nbsp;or&nbsp;3:&nbsp;the&nbsp;folder&nbsp;should&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;debug&nbsp;output\n'&nbsp;5:&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&nbsp;isn't&nbsp;listed,&nbsp;disable&nbsp;the&nbsp;error-handler&nbsp;and&nbsp;record&nbsp;any&nbsp;errors<BR /><BR />\nOn&nbsp;Error&nbsp;GoTo&nbsp;ErrSub<BR /><BR />\nDim&nbsp;sKeyPath&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;String<BR />\nDim&nbsp;oRegistry&nbsp;&nbsp;&nbsp;As&nbsp;Object\nDim&nbsp;sSubKey&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;String\nDim&nbsp;oSubKeys&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;type&nbsp;not&nbsp;specified.&nbsp;After&nbsp;it's&nbsp;populated,&nbsp;it&nbsp;can&nbsp;be&nbsp;iterated\nDim&nbsp;oSubKey&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;type&nbsp;not&nbsp;specified.<BR />\nDim&nbsp;bSubFolders&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;Boolean\nDim&nbsp;bNetworkLocation&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;Boolean<BR />\nDim&nbsp;iTrustNetwork&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;Long\nDim&nbsp;bTempFolder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;Long<BR />\nDim&nbsp;sMsg&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;String\nDim&nbsp;sPath&nbsp;&nbsp;&nbsp;As&nbsp;String\nDim&nbsp;sDate&nbsp;&nbsp;&nbsp;As&nbsp;String\nDim&nbsp;sDesc&nbsp;&nbsp;&nbsp;As&nbsp;String\nDim&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;Long<BR />\nConst&nbsp;HKEY_CURRENT_USER&nbsp;=&nbsp;&amp;H80000001<BR />\nbSubFolders&nbsp;=&nbsp;True\nbNetworkLocation&nbsp;=&nbsp;False<BR />\nIf&nbsp;FolderPath&nbsp;=&nbsp;\"\"&nbsp;Then<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;FolderPath&nbsp;=&nbsp;FSO.GetSpecialFolder(2).Path\n&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;sDescription&nbsp;=&nbsp;\"\"&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sDescription&nbsp;=&nbsp;\"The&nbsp;user's&nbsp;local&nbsp;temp&nbsp;folder\"\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;bTempFolder&nbsp;=&nbsp;True<BR />&nbsp;&nbsp;&nbsp;&nbsp;\nEnd&nbsp;If<BR />\nIf&nbsp;Right(FolderPath,&nbsp;1)&nbsp;&LT;&GT;&nbsp;\"\\\"&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;FolderPath&nbsp;=&nbsp;FolderPath&nbsp;&amp;&nbsp;\"\\\"\nEnd&nbsp;If<BR /><BR />\nsKeyPath&nbsp;=&nbsp;\"\"\nsKeyPath&nbsp;=&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"SOFTWARE\\Microsoft\\Office\\\"\nsKeyPath&nbsp;=&nbsp;sKeyPath&nbsp;&amp;&nbsp;Application.Version\nsKeyPath&nbsp;=&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"\\Excel\\Security\\Trusted&nbsp;Locations\\\"<BR /><BR />&nbsp;\nSet&nbsp;oRegistry&nbsp;=&nbsp;GetObject(\"winmgmts:\\.\\root\\default:StdRegProv\")\n'&nbsp;&nbsp;&nbsp;Note:&nbsp;not&nbsp;the&nbsp;usual&nbsp;\\root\\cimv2&nbsp;&nbsp;for&nbsp;WMI&nbsp;scripting:&nbsp;the&nbsp;StdRegProv&nbsp;isn't&nbsp;in&nbsp;that&nbsp;folder<BR />&nbsp;\noRegistry.EnumKey&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath,&nbsp;oSubKeys<BR /><BR /></p>\n\n<p>For&nbsp;Each&nbsp;oSubKey&nbsp;In&nbsp;oSubKeys<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;sSubKey&nbsp;=&nbsp;CStr(oSubKey)\n&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.GetStringValue&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"\\\"&nbsp;&amp;&nbsp;sSubKey,&nbsp;\"Path\",&nbsp;sPath<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;'Debug.Print&nbsp;sSubKey&nbsp;&amp;&nbsp;vbTab&nbsp;&amp;&nbsp;sPath<BR />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;sPath&nbsp;=&nbsp;FolderPath&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;For\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If<BR />&nbsp;&nbsp;&nbsp;&nbsp;\nNext&nbsp;oSubKey<BR />\nIf&nbsp;sPath&nbsp;&LT;&GT;&nbsp;FolderPath&nbsp;Then<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;bTempFolder&nbsp;=&nbsp;False&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMsg&nbsp;=&nbsp;\"\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMsg&nbsp;=&nbsp;sMsg&nbsp;&amp;&nbsp;\"Microsoft&nbsp;Office&nbsp;will&nbsp;not&nbsp;allow&nbsp;\"&nbsp;&amp;&nbsp;APP_NAME&nbsp;&amp;&nbsp;\"&nbsp;to&nbsp;open&nbsp;files&nbsp;from&nbsp;this&nbsp;location:&nbsp;\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMsg&nbsp;=&nbsp;sMsg&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;vbCrLf\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMsg&nbsp;=&nbsp;sMsg&nbsp;&amp;&nbsp;vbTab&nbsp;&amp;&nbsp;\"'\"&nbsp;&amp;&nbsp;FolderPath&nbsp;&amp;&nbsp;\"'\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMsg&nbsp;=&nbsp;sMsg&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;vbCrLf\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sMsg&nbsp;=&nbsp;sMsg&nbsp;&amp;&nbsp;\"Would&nbsp;you&nbsp;like&nbsp;to&nbsp;add&nbsp;this&nbsp;folder&nbsp;to&nbsp;Microsoft&nbsp;Office's&nbsp;list&nbsp;or&nbsp;Trusted&nbsp;Locations?\"<BR />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;MsgBox(sMsg,&nbsp;vbQuestion&nbsp;+&nbsp;vbYesNo,&nbsp;APP_NAME&nbsp;&amp;&nbsp;\":&nbsp;do&nbsp;you&nbsp;trust&nbsp;files&nbsp;from&nbsp;this&nbsp;location?\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;vbYes\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;continue\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;Else&nbsp;&nbsp;&nbsp;'&nbsp;Else&nbsp;captures&nbsp;cancel&nbsp;actions&nbsp;as&nbsp;well&nbsp;as&nbsp;an&nbsp;explicit&nbsp;'No'\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Err.Raise&nbsp;-559038737,&nbsp;APP_NAME&nbsp;&amp;&nbsp;\":&nbsp;TrustThisFolder\",&nbsp;\"user&nbsp;chose&nbsp;not&nbsp;to&nbsp;add&nbsp;folder&nbsp;to&nbsp;'Trusted&nbsp;Locations'\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;Sub&nbsp;'&nbsp;This&nbsp;is&nbsp;dead&nbsp;code&nbsp;...unless&nbsp;error-handling&nbsp;is&nbsp;bypassed.&nbsp;One&nbsp;day,&nbsp;you'll&nbsp;thank&nbsp;me&nbsp;for&nbsp;this.\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;IsNumeric(Replace(sSubKey,&nbsp;\"Location\",&nbsp;\"\"))&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;CLng(Replace(sSubKey,&nbsp;\"Location\",&nbsp;\"\"))&nbsp;+&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;Else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;UBound(oSubKeys)&nbsp;+&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;sSubKey&nbsp;=&nbsp;\"Location\"&nbsp;&amp;&nbsp;CStr(i)<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;TrustNetworkFolders&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iTrustNetwork&nbsp;=&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.GetDWordValue&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath,&nbsp;\"AllowNetworkLocations\",&nbsp;iTrustNetwork\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;iTrustNetwork&nbsp;=&nbsp;0&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.SetDWordValue&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath,&nbsp;\"AllowNetworkLocations\",&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.CreateKey&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"\\\"&nbsp;&amp;&nbsp;sSubKey\n&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.SetStringValue&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"\\\"&nbsp;&amp;&nbsp;sSubKey,&nbsp;\"Path\",&nbsp;FolderPath\n&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.SetStringValue&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"\\\"&nbsp;&amp;&nbsp;sSubKey,&nbsp;\"Description\",&nbsp;sDescription\n&nbsp;&nbsp;&nbsp;&nbsp;oRegistry.SetDWordValue&nbsp;HKEY_CURRENT_USER,&nbsp;sKeyPath&nbsp;&amp;&nbsp;\"\\\"&nbsp;&amp;&nbsp;sSubKey,&nbsp;\"AllowSubFolders\",&nbsp;1<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;MsgPopup&nbsp;\"Successfully&nbsp;added&nbsp;'\"&nbsp;&amp;&nbsp;FolderPath&nbsp;&amp;&nbsp;\"'&nbsp;to&nbsp;the&nbsp;Microsoft&nbsp;Office&nbsp;Trusted&nbsp;Folders&nbsp;list.\",&nbsp;vbInformation,&nbsp;APP_NAME&nbsp;&amp;&nbsp;\":&nbsp;Action&nbsp;confirmed.\",&nbsp;3<BR />&nbsp;&nbsp;&nbsp;&nbsp;\nEnd&nbsp;If<BR /><BR />\nExitSub:<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;oRegistry&nbsp;=&nbsp;Nothing\n&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;Sub<BR />\nErrSub:<BR />&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;Resume&nbsp;ExitSub<BR />\nEnd&nbsp;Sub<BR />\n</CODE>\n</PRE></p>\n\n<p>Note that this code is dependent on user intervention to confirm removing the 'Trusted Location' setting. You can remove the dialogues, but I'd urge you to consult your sysadmin before you do.</p>\n\n<p>(Note: I'm using 'popup' dialogue boxes, which disappear automatically after a preset interval, allowing the code to continue. Ask if you want the code)</p>\n\n<p>After that, it gets arcane. Here's the code I wrote for the last time I had to use a separate instance of Excel.exe to open a file:</p>\n\n<p><PRE>\n<CODE>\nWith New Excel.Application<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;.ShowStartupDialog = False\n&nbsp;&nbsp;&nbsp;&nbsp;.Visible = False\n&nbsp;&nbsp;&nbsp;&nbsp;.EnableCancelKey = xlDisabled\n&nbsp;&nbsp;&nbsp;&nbsp;.UserControl = False\n&nbsp;&nbsp;&nbsp;&nbsp;.Interactive = False\n&nbsp;&nbsp;&nbsp;&nbsp;.EnableEvents = False<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;.DisplayAlerts = False\n&nbsp;&nbsp;&nbsp;&nbsp;.AutomationSecurity = msoAutomationSecurityForceDisable<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;.Workbooks.Add  ' Calculation property is not available if no workbooks are open\n&nbsp;&nbsp;&nbsp;&nbsp;If .Calculation &lt;> xlCalculationManual Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Calculation = xlCalculationManual\n&nbsp;&nbsp;&nbsp;&nbsp;End If<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next<BR /> \n&nbsp;&nbsp;&nbsp;&nbsp;For i = .Workbooks.Count To 1 Step -1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Workbooks(i).Close False\n&nbsp;&nbsp;&nbsp;&nbsp;Next i<BR /><br>\n&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next<BR />\n&nbsp;&nbsp;&nbsp;&nbsp;For i = 1 To .AddIns.Count\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If .AddIns(i).IsOpen Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddIns(i).Installed = False\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If\n&nbsp;&nbsp;&nbsp;&nbsp;Next i<BR /><br>\n&nbsp;&nbsp;&nbsp;&nbsp;For i = 1 To .COMAddIns.Count\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If .COMAddIns(1).progID Like \"&#42;Information&#42;Classification&#42;\" Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' no action\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.COMAddIns(i).Connect = False\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Not .COMAddIns(i).Object Is Nothing Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.COMAddIns(i).Object.Close\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.COMAddIns(i).Object.Quit\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If\n&nbsp;&nbsp;&nbsp;&nbsp;Next i<BR /> \nEnd With\n</CODE>\n</PRE></p>\n\n<p>You'll note the&nbsp;&nbsp;<CODE>'On error Resume Next'</CODE>&nbsp;&nbsp;in there: some Add-Ins can't be closed.</p>\n\n<p>After that, it's phases of the moon and human sacrifice. Or, maybe, a quick look at the other answers on Stack Oveflow.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "is_accepted": false, "score": 2, "last_activity_date": 1440009066, "creation_date": 1440009066, "answer_id": 32103048, "question_id": 32099791, "link": "https://stackoverflow.com/questions/32099791/ms-access-2010-excel-2010-windows-server-2008-r2-64-bit-saveas-method-of-work/32103048#32103048", "title": "MS Access 2010, Excel 2010, Windows Server 2008 R2 64-bit: SaveAs method of Workbook class failed", "body": "<p>Finally got it fixed. Here was what worked, in case anyone in the future has this same error.</p>\n\n<p>We added BOTH folders:</p>\n\n<pre><code>C:\\Windows\\System32\\config\\systemprofile\\Desktop\nC:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5239568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23aeca5519540252d2d6c31c4cb1b8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user5239568", "link": "https://stackoverflow.com/users/5239568/user5239568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1441980843, "creation_date": 1439998144, "last_edit_date": 1495541680, "question_id": 32099791, "link": "https://stackoverflow.com/questions/32099791/ms-access-2010-excel-2010-windows-server-2008-r2-64-bit-saveas-method-of-work", "title": "MS Access 2010, Excel 2010, Windows Server 2008 R2 64-bit: SaveAs method of Workbook class failed", "body": "<p>Services used: MS Access 2010, Excel 2010, Windows Server 2008 R2 (64-bit)</p>\n\n<p>In our MS Access database, we wrote a process that exports queries to .xlsx format and saves them on the network drive. It uses this syntax:</p>\n\n<pre><code>objxl.ActiveWorkbook.SaveAs filename, FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n\n<p>and</p>\n\n<pre><code>xlWBk.SaveAs filename, FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n\n<p>where objxl is declared as:</p>\n\n<pre><code>Private objxl As Object\n</code></pre>\n\n<p>And files are opened via:</p>\n\n<pre><code>Dim xlWBk As Object\n\nIf objxl Is Nothing Then\n    Set objxl = CreateObject(\"Excel.Application\")\nEnd If\n\nIf Dir(sourceFile) = vbNullString Then\n    Set xlWBk = objxl.Workbooks.Add\nElse\n    Set xlWBk = objxl.Workbooks.Open(sourceFile)\n    blnFileExists = True\nEnd If\n</code></pre>\n\n<p>This code works fine when we run it manually. I am reasonably confident that the code is correct, but I'm posting it here just in case.</p>\n\n<p>However, we need to automate this database so we have it run from an account via scheduled task, set to run even if the account is not logged in (and this account has admin rights, etc). Unfortunately, when running the program like this, we get this error in our logs:</p>\n\n<pre><code>\"SaveAs method of Workbook class failed.\"\n</code></pre>\n\n<p>We've verified that it isn't a network read/write problem (it writes all sorts of other files, such as .txt and .pdf, just fine to the network drive. This issue appears to be localized to Excel).</p>\n\n<p>We've tried a fix as per this post: <a href=\"https://stackoverflow.com/a/1090864/5239568\">https://stackoverflow.com/a/1090864/5239568</a></p>\n\n<p>But nothing seems to be working so far.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1439998403, "post_id": 32099764, "comment_id": 52094122, "body": "@Gary&#39;sStudent - wouldn&#39;t you need <code>Interior</code>? like  <code>cArray(i,j) = rng(i,j).Interior.ColorIndex</code>."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 1, "creation_date": 1439998459, "post_id": 32099764, "comment_id": 52094171, "body": "<code>rng(i, j).</code> + (choose one:) 1. <code>Font.</code> 2. <code>Border.</code> 3. <code>Interior.</code> + <code>ColorIndex</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1439998480, "post_id": 32099764, "comment_id": 52094189, "body": "@BruceWayne  You are correct!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1439999640, "post_id": 32099764, "comment_id": 52095034, "body": "Maybe you could use paste-special to copy the formats to an unused section of the spreadsheet, reorganize the table, and then paste the formats back. Also -- are you sure that there isn&#39;t a simple solution using the ListObject&#39;s <code>TableStyle</code> property?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1439998839, "last_edit_date": 1439998839, "creation_date": 1439998507, "answer_id": 32099938, "question_id": 32099764, "link": "https://stackoverflow.com/questions/32099764/store-range-of-color-values-as-array-in-vba/32099938#32099938", "title": "Store range of color values as array in VBA", "body": "<p>I'm not sure that <code>.ColorValue</code> is something recognized by VBA.  Instead, use <code>cArray(i,j) = rng(i,j).Interior.ColorIndex</code>.</p>\n\n<p>Then, when you want to set a cell's color, just do <code>Cells(1,1).Interior.ColorIndex = [whatever]</code>.  </p>\n\n<p><a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow\">Here's a</a> pretty detailed page discussing <code>ColorIndex</code> and the HTML/Hex/RGB equivalents/related things.</p>\n\n<p>Edit: I assumed you wanted the background color.  If you instead want the font color, it'd just be <code>cArray(i,j) = rng(i,j).Font.Color</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5096096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1dcd82fa0c77ca09145b6d622d462a?s=128&d=identicon&r=PG&f=1", "display_name": "Nippers", "link": "https://stackoverflow.com/users/5096096/nippers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5037, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440029297, "creation_date": 1439998078, "last_edit_date": 1440002853, "question_id": 32099764, "link": "https://stackoverflow.com/questions/32099764/store-range-of-color-values-as-array-in-vba", "title": "Store range of color values as array in VBA", "body": "<p>I want to get color values from a table in excel, store them as an array while I reorganize the table, and then put the color values back into the table. The following code works for values and number formats but not for color values. \nAny help will be greatly appreciated.</p>\n\n<pre><code>Sub Colors()\n    Dim cArray As Variant\n    Set Rng = Range(\"A1: T300\")\n    ReDim cArray(1 To Rng.Rows.Count, 1 To Rng.Columns.Count)\n    For i = 1 To Rng.Rows.Count\n        For j = 1 To Rng.Columns.Count\n            cArray(i, j) = Rng(i, j).ColorValue\n        Next j\n    Next i\n    Call SortTable\n    Rng.ColorValue = cArray\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "is_accepted": true, "score": 1, "last_activity_date": 1440020567, "last_edit_date": 1440020567, "creation_date": 1440020211, "answer_id": 32106059, "question_id": 32099582, "link": "https://stackoverflow.com/questions/32099582/sorting-of-a-calculated-field-fails-when-using-report-within-a-form-in-access/32106059#32106059", "title": "Sorting of a calculated field fails when using report within a form in Access", "body": "<p>I was able to re-create the issue. It's not with the complicated calculation which you may want to add to the recordsource. I re-created it with a simple sort of a single field. Here's what I found:</p>\n\n<p>(Sorry I don't seem to be able to upload images here; which is unfortunate)</p>\n\n<p>Check your report properties' [Data] tab and see <code>Order By On Load</code>. It's probably set to Yes. That means that you don't need to turn it On, because it's already on.</p>\n\n<p>But at the same time, the default value for <code>OrderBy</code> is Null. The report will tell you that <code>OrderByOn = False</code> if there's a null value in OrderBy, despite the fact that <code>Order By On Load</code> is true!</p>\n\n<p>So basically, you need to set a default <code>OrderBy</code> in the Properties, set a default <code>OderBy</code> in the <code>Report_Activate()</code> event, or update your code to look for a/the one time null value.</p>\n\n<p>Why your given code works in report, but not subreport is a mystery; maybe a bug. I was able to resolve the issue by doing any one of the 3 suggestions above.</p>\n\n<p>Oh, and don't forget to remove the <code>Me.OrderByOn = True</code> because that is what's causing the issue...some sort of half baked read-only error only triggered in a subreport.</p>\n"}], "owner": {"reputation": 37, "user_id": 4080561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVslc.jpg?s=128&g=1", "display_name": "Ricardo de la Cruz", "link": "https://stackoverflow.com/users/4080561/ricardo-de-la-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 32106059, "answer_count": 1, "score": 0, "last_activity_date": 1459430400, "creation_date": 1439997545, "last_edit_date": 1459430400, "question_id": 32099582, "link": "https://stackoverflow.com/questions/32099582/sorting-of-a-calculated-field-fails-when-using-report-within-a-form-in-access", "title": "Sorting of a calculated field fails when using report within a form in Access", "body": "<p>I have a report with some code to sort on a calculated column, so when the user clicks the label the report is sorted, here's the code: </p>\n\n<pre><code>Private Sub Label44_Click()\n\nIf Me.OrderBy = \"IIf([SumOfCurrentPriceVol]&lt;&gt;0,([SumOfOfferedPriceVolume]-[SumOfCurrentPriceVol])/[SumOfCurrentPriceVol],0) DESC\" Then\n    Me.OrderBy = \"IIf([SumOfCurrentPriceVol]&lt;&gt;0,([SumOfOfferedPriceVolume]-[SumOfCurrentPriceVol])/[SumOfCurrentPriceVol],0) ASC\"\nElse\n    Me.OrderBy = \"IIf([SumOfCurrentPriceVol]&lt;&gt;0,([SumOfOfferedPriceVolume]-[SumOfCurrentPriceVol])/[SumOfCurrentPriceVol],0) DESC\"\nEnd If\n\nMe.OrderByOn = True\nEnd Sub\n</code></pre>\n\n<p>When I use the report by itself it works fine. But If I put the report inside of a Form I get the following error message: </p>\n\n<p><code>\"Run-Time Error '5': Invalid procedure call or argument\"</code> </p>\n\n<p>at the </p>\n\n<pre><code>Me.OrderByOn = True\n</code></pre>\n\n<p>I tried changing the <code>Me</code> to <code>Report</code> and I get the same results. any idea of what may be failing? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439998003, "post_id": 32099487, "comment_id": 52093846, "body": "Yea it&#39;s possible. What have you tried?"}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1440009910, "post_id": 32100153, "comment_id": 52100962, "body": "Hey thanks so much for answering me back so quickly! I copied the exact code and changed the Active Sheet Name, the Column number and , the StartingLine number and I am getting an &quot;Object doesnt support theis property or method&quot; on the OriginalSheet = line.. the workbook is saved as an Macro-Enabled Excel sheet"}, {"owner": {"reputation": 46, "user_id": 5243002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQsbJ.jpg?s=128&g=1", "display_name": "SieluLintu", "link": "https://stackoverflow.com/users/5243002/sielulintu"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1440012711, "post_id": 32100153, "comment_id": 52102655, "body": "In this case, you shouldn&#39;t change the active sheet name - the purpose of storing it in the &quot;Original_Sheet&quot; variable is for the macro to accept whatever sheet you are on as the first one, so it can paste the rows elsewhere and return to it later. Try leaving this variable as it is, and tell me if that worked."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1440069810, "post_id": 32100153, "comment_id": 52126278, "body": "Ok.. I changed the variable back to the original like you said, now I am getting an &quot;Subscript out of range&quot; Error on the Sheets(myType).Select line. So sorry Im having all these problems :/"}, {"owner": {"reputation": 46, "user_id": 5243002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQsbJ.jpg?s=128&g=1", "display_name": "SieluLintu", "link": "https://stackoverflow.com/users/5243002/sielulintu"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1440074280, "post_id": 32100153, "comment_id": 52129272, "body": "Not a problem... let me just clarify a question: you want each &quot;Type&quot; to go into a corresponding sheet, isn&#39;t it? The way I coded, the sheet name must be EXACTLY the Type on that row, for example, if in row 5 the type is, let&#39;s say, &quot;A_1&quot;, and the corresponding sheet is named &quot;A&quot;, it won&#39;t work. Can you confirm if the string (text) in the &quot;Type&quot; cells and the corresponding sheet names is indeed the same? Give me some examples, if you can..."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1440077050, "post_id": 32100153, "comment_id": 52131347, "body": "Yes they are exactly the same the types I have are airplane types so on each row the type will be either 757, 767, 777, A300, MD10-10 and the sheets are names exactly the same"}], "tags": [], "owner": {"reputation": 46, "user_id": 5243002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQsbJ.jpg?s=128&g=1", "display_name": "SieluLintu", "link": "https://stackoverflow.com/users/5243002/sielulintu"}, "is_accepted": false, "score": 0, "last_activity_date": 1439999109, "creation_date": 1439999109, "answer_id": 32100153, "question_id": 32099487, "link": "https://stackoverflow.com/questions/32099487/command-button-in-excel-to-make-a-copy-of-a-row-of-data-and-move-that-row-to-a-d/32100153#32100153", "title": "Command button in Excel to make a copy of a row of data and move that row to a different tab in the same workbook", "body": "<p>Brianna!</p>\n\n<p>Try this macro (copy and paste it into a new module in VB Editor), see if it fits your need; if it's good, create a button, right-click it, \"Assign Macro\" then select 'copyRow'.</p>\n\n<pre><code>&gt;Sub copyRow()\n&gt;\n&gt;\n&gt;Dim OriginalSheet As String\n&gt;Dim TypeColumn As Integer\n&gt;Dim StartingLine As Integer\n&gt;Dim myType As String\n&gt;\n&gt;OriginalSheet = ActiveSheet.Name\n&gt;\n&gt;'edit this number to match the column where the \"Type\" information is\n&gt;TypeColumn = 1\n&gt;'edit this part to match the starting point of your records\n&gt;StartingLine = 3\n&gt;\n&gt;Cells(StartingLine, TypeColumn).Select\n&gt;\n&gt;Counter = 0\n&gt;\n&gt;Do While ActiveCell.Offset(Counter, 0) &lt;&gt; \"\"\n&gt;\n&gt;    myType = ActiveCell.Offset(Counter, 0).Value\n&gt;    ActiveCell.Offset(Counter, 0).EntireRow.Copy\n&gt;    Sheets(myType).Select\n&gt;    Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n&gt;    Selection.Insert Shift:=xlDown\n&gt;    Sheets(OriginalSheet).Select\n&gt;    Cells(StartingLine, TypeColumn).Select\n&gt;    Counter = Counter + 1\n&gt;\n&gt;Loop\n&gt;\n&gt;'this will exclude the rows already copied\n&gt;'you can comment, alter or exclude this line if you wish\n&gt;Range(Cells(StartingLine, TypeColumn), Cells(StartingLine + Counter, &gt;TypeColumn)).EntireRow.Delete\n&gt;\n&gt;End Sub\n</code></pre>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1267, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1439999109, "creation_date": 1439997243, "last_edit_date": 1439998210, "question_id": 32099487, "link": "https://stackoverflow.com/questions/32099487/command-button-in-excel-to-make-a-copy-of-a-row-of-data-and-move-that-row-to-a-d", "title": "Command button in Excel to make a copy of a row of data and move that row to a different tab in the same workbook", "body": "<p>I am trying to get a command button that is placed on a worksheet in Excel that will transfer a line of data to a different sheet based on a certain field in a field. For example I have all the data in a row that has 6 different fields and one is names Type. Then I have worksheets that have the same names as all the Type options. What I want to happen is the user press and update button and the Type for each row is located and then the row is placed in the worksheet that corresponds with that Type. I dont know if this is even possible.</p>\n\n<p>Thanks in advance!\nBri</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1449565370, "post_id": 32099387, "comment_id": 56050280, "body": "did you find the answer yet?"}], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1446189563, "creation_date": 1446189563, "answer_id": 33430637, "question_id": 32099387, "link": "https://stackoverflow.com/questions/32099387/vba-word-conditional-text-replacement/33430637#33430637", "title": "VBA Word: conditional text replacement", "body": "<p>Not sure of you application and by \"first word in the line\" i assume you meant first word of a paragraph, but this works to apply the search to the entire paragraph (except the first word) </p>\n\n<pre><code>'Array position 0    1    2    3    4\narray1 = Array(\"1\", \"2\", \"3\", \"4\", \"5\")\narray2 = Array(\"one\", \"two\", \"three\", \"four\", \"five\")\n\nFor p = 1 To ActiveDocument.Paragraphs.Count\n   'Seelcting the paragraph\n   ActiveDocument.Paragraphs(p).Range.Select\n   'Checking if the paragraph is not a blank line\n    If Len(Selection) &gt; 1 Then\n        'Moving to begining of the paragraph\n        Selection.HomeKey\n        'Moving one word to the left\n        Selection.MoveRight Unit:=wdWord, Count:=1\n        'Selecting the rest of the paragraph\n        Selection.MoveEnd Unit:=wdParagraph\n        'Setting the selection as a Bookmark\n        ActiveDocument.Bookmarks.Add Range:=Selection.Range, Name:=\"TempBM\"\n\n        For i = 0 To 4\n            With Selection.Find\n                .Text = array1(i)\n                .Replacement.Text = array2(i)\n                .Forward = True\n                .Wrap = wdFindStop\n                .Format = False\n                         'Replace that text\n                Do While .Execute(Replace:=wdReplaceOne)\n                  'Reselect the Bookmark\n                  Selection.GoTo What:=wdGoToBookmark, Name:=\"TempBM\"\n                Loop\n\n            End With\n        Next\n        'Deleting Bookmark\n        ActiveDocument.Bookmarks(\"TempBM\").Delete\n    End If\nNext\n</code></pre>\n\n<p>For a test it change this (I added the 1 to the first word to verify it ignores it:</p>\n\n<blockquote>\n  <p>1This is a test        1         2        3        4       5   </p>\n  \n  <p>1This is a test        1         2        3        4       5   </p>\n</blockquote>\n\n<p>to:</p>\n\n<blockquote>\n  <p>1This is a test        one         two        three        four       five   </p>\n  \n  <p>1This is a test        one         two        three        four       five   </p>\n</blockquote>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 580, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446189563, "creation_date": 1439997008, "last_edit_date": 1531164843, "question_id": 32099387, "link": "https://stackoverflow.com/questions/32099387/vba-word-conditional-text-replacement", "title": "VBA Word: conditional text replacement", "body": "<p>I have a macro that successfully searches a replaces a series of words in a document with this code:</p>\n\n<pre><code>'define array1 with words I want replaced\n'define array2 with words I want to replace with so that they have the same index\n'loop through array and search and replace\nwith application.activedocument.content.find\nfor i=1 to 565\n.text=array1(i)\n.replacement.text=array2(i)\n.wrap=wdfindcontinue\n.format=false\n.matchcase=false\n.matchwholeword=true\n.matchwildcards=false\n.matchallwordsforms=false\n.matchsoundslike=false\n.matchsuffix=true\n.matchprefix=true\n.execute replace:=wdreplaceall\nnext\nend with\n</code></pre>\n\n<p>I want to change the functionality so that it won't replace the word if it is the first word in the line, however I realize that the find function doesn't work line by line, or allow conditional testing of properties, so I think the best approach is for me to change the range that my function operates on to exclude the first word in each line.</p>\n\n<p>So instead of ActiveDocument.Content.Find I need ActiveDocument.Range defined somehow so that it excludes the first word of each line.</p>\n\n<p>Does anyone know how to define the range so that it excludes the first word of each line.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 1, "creation_date": 1439997275, "post_id": 32099447, "comment_id": 52093344, "body": "Thanks i&#39;ll have a look, I did actually, quite a bit, I have tried a few but they seemed to either explode or copy the entire worksheet..."}, {"owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "reply_to_user": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 0, "creation_date": 1439997411, "post_id": 32099447, "comment_id": 52093444, "body": "No problem! I actually had to figure out this problem a while back myself. The key is once you have the workbook open (in code), you can narrow down your search parameter to a single cell rather than just a worksheet."}, {"owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 0, "creation_date": 1439998310, "post_id": 32099447, "comment_id": 52094056, "body": "Ahhh its close but not quite what I&#39;m after, this gets the file names, what i need is the data from a certain cell."}, {"owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "reply_to_user": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 0, "creation_date": 1439998874, "post_id": 32099447, "comment_id": 52094457, "body": "@DigitalLightcraft Yes but you have to edit very little to do what you want it to do. I&#39;ll post an answer that should hopefully do what you need it to do."}, {"owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "reply_to_user": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 0, "creation_date": 1440005743, "post_id": 32099447, "comment_id": 52098525, "body": "@DigitalLightcraft any luck?"}, {"owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 1, "creation_date": 1440007956, "post_id": 32099447, "comment_id": 52099705, "body": "not yet, something cropped up at work, will carry on in the morning and report back!"}], "tags": [], "owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "is_accepted": false, "score": 1, "last_activity_date": 1439999388, "last_edit_date": 1439999388, "creation_date": 1439997162, "answer_id": 32099447, "question_id": 32099270, "link": "https://stackoverflow.com/questions/32099270/excel-macro-to-open-a-folder-of-excel-workbooks-and-copy-1-cell/32099447#32099447", "title": "Excel macro to open a folder of excel workbooks and copy 1 cell", "body": "<p>Here is (pretty much) exactly what you're trying to do. Next time do a little bit of googling before you ask! :)</p>\n\n<p><a href=\"http://www.excel-easy.com/vba/examples/files-in-a-directory.html\" rel=\"nofollow\">http://www.excel-easy.com/vba/examples/files-in-a-directory.html</a></p>\n\n<p><strong><em>ROUGH CODE UNSURE IF IT WILL WORK:</em></strong> But here is the basic idea of what you need to modify in the example I sent you. If you look at the example again, it does everything you need and then some. Since you weren't interested in all worksheets, you don't have to loop through all worksheets in a workbook. You can just open it up, read your cell of interest, and then close it. The Do While loop will do this for every Excel file in your directory. AGAIN! Please modify this example accordingly before you use it. </p>\n\n<pre><code>Dim directory As String, fileName As String, sheet As Worksheet, i As Integer, j As Integer\n\nApplication.ScreenUpdating = False\n\ndirectory = \"c:\\test\\\"\nfileName = Dir(directory &amp; \"*.xl??\")\n\nDo While fileName &lt;&gt; \"\"\n\n    i = i + 1\n    Workbooks.Open (directory &amp; fileName)\n    Workbooks(\"files-in-a-directory.xls\").Worksheets(1).Cells(i, 1).Value = Workbooks(fileName).Worksheets(1).Cells(x, y) &lt;-- whatever your cell of interest is\n    Workbooks(fileName).Close\n    fileName = Dir()\n\nLoop\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440070957, "creation_date": 1439996773, "last_edit_date": 1440070957, "question_id": 32099270, "link": "https://stackoverflow.com/questions/32099270/excel-macro-to-open-a-folder-of-excel-workbooks-and-copy-1-cell", "title": "Excel macro to open a folder of excel workbooks and copy 1 cell", "body": "<p>I have a folder of .xlsx files, each identical in layout.</p>\n\n<p>I need to write a macro in excel to open each file in turn (100+ files)\nthen get the data (a name) from a single cell, and drop it in a new excel worksheet, move on to the next and insert that below the last one etc.</p>\n\n<p>Giving me basically a list of names from data not file names)</p>\n"}, {"tags": ["vba", "excel", "email", "copy-paste"], "comments": [{"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1439997702, "post_id": 32099138, "comment_id": 52093648, "body": "Do you mean to say that your conditional formatting doesn&#39;t work when you paste it into Outlook?  If this is the case, I believe this may be because Outlook doesn&#39;t have the inbuilt logic to work with the rules in the same way as Excel.  As such you would have to build the conditional formatting into the VBA - and manually change the color index of the cells prior to pasting"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1439999223, "post_id": 32099138, "comment_id": 52094724, "body": "@Trum I&#39;ve worked out what the problem is but am not sure how to get around it, please see my edit."}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1439999843, "post_id": 32099138, "comment_id": 52095194, "body": "I&#39;m not sure if there is a way to &#39;lock&#39; the conditional formatting. There&#39;s an article here - which has A fix you could try  <a href=\"http://stackoverflow.com/questions/18548156/how-to-copy-the-formatting-without-copying-the-rules-from-a-conditional-formatte\" title=\"how to copy the formatting without copying the rules from a conditional formatte\">stackoverflow.com/questions/18548156/&hellip;</a> . Otherwise I would suggest maybe looping through the range and changing the colorindex that way."}, {"owner": {"reputation": 163, "user_id": 5234882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146adee9deef4f890991e541ed0c5892?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/5234882/dan"}, "edited": false, "score": 0, "creation_date": 1440000890, "post_id": 32099138, "comment_id": 52095764, "body": "I would rewrite the rangeToHTML function and instead of copy / pasting the data and using the &quot;publish to html&quot; , generate myself the html code for the table representing the data...but I am some kind of &quot;old school&quot;....but otherwise, instead of copying / pasting special, did you try a simple paste in the new workbook ? might solve your problem as well"}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 5234882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146adee9deef4f890991e541ed0c5892?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/5234882/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1440002597, "creation_date": 1440002597, "answer_id": 32101210, "question_id": 32099138, "link": "https://stackoverflow.com/questions/32099138/vba-why-when-i-paste-cells-in-a-email-using-vba-does-it-remove-some-conditional/32101210#32101210", "title": "VBA: Why when I paste cells in a email using VBA does it remove some conditional formatting?", "body": "<p>I just tried to create the HTML code of the table by simply using Excel formula and pasted it in HTML document... works pretty good (of course, only if your formatting is pretty simple as you explain)....</p>\n\n<p>Providing the table is on A1 to Cnnn</p>\n\n<p>For the header line, type this for example in E1 cell</p>\n\n<pre><code>=\"&lt;TR&gt;&lt;TH&gt;\"&amp;A1&amp;\"&lt;/TH&gt;&lt;TH&gt;\"&amp;B1&amp;\"&lt;/TH&gt;&lt;TH&gt;\"&amp;C1&amp;\"&lt;/TH&gt;&lt;/TR&gt;\"\n</code></pre>\n\n<p>and for line 2 of data in E2</p>\n\n<pre><code>=\"&lt;TR&gt;&lt;TD&gt;\"&amp;TRIM(A2)&amp;\"&lt;/TD&gt;&lt;TD BGCOLOR=\" &amp; IF(B2&lt;5;\"RED\";\"GREEN\") &amp; \"&gt;\" \n&amp; B2 &amp;\"&lt;/TD&gt;&lt;TD BGCOLOR=\" &amp; IF(C2&gt;50%;\"GREEN\";\"RED\") &amp; \"&gt;\" \n&amp; TEXT(C2;\"0%\") &amp; \"&lt;/TD&gt;&lt;/TR&gt;\"\n</code></pre>\n\n<p>and copy /past formula to all rows with data. then you encapsulate the generated code between table tags</p>\n\n<pre><code>&lt;TABLE&gt;...&lt;/TABLE&gt;\n</code></pre>\n\n<p>and you get a html code for a table as you like it which you can paste in the .htmlbody of your email....</p>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440002597, "creation_date": 1439996483, "last_edit_date": 1439999194, "question_id": 32099138, "link": "https://stackoverflow.com/questions/32099138/vba-why-when-i-paste-cells-in-a-email-using-vba-does-it-remove-some-conditional", "title": "VBA: Why when I paste cells in a email using VBA does it remove some conditional formatting?", "body": "<p>What I want to be able to do is copy and paste cells from a spread sheet into an email with all the conditional formatting applied. For example, say I have the following cells:</p>\n\n<pre><code>    A                      B            C\n 1  Name:                  Sales:       Percentage\n 2  Dave Grohl             3            80%\n 3  Kurt Cobain            6            40%\n 4  Pat Smear              7            66%\n 5  Freddie Mercury        2            25%\n 6  Roger Taylor           8            95%\n 7  Brian May              1            74%\n 8  Taylor Hawkins         0            32%\n 9  Noel Gallagher         9            63%\n10  Michael Jackson        8            30%\n11  Whitney Houston        2            82%\n</code></pre>\n\n<p>And there was conditional formatting on column B (<code>Sales</code>) where anything > 5 was green and anything &lt;= 5 was red and conditional formatting on column C (<code>Percentage</code>) where anything >50% was green and &lt;= 50% is red, what happens is it keeps the values but removes some of the formatting, e.g. removes the chosen font on the data but not the headings and removes the color of the <code>Sales</code> column but not the <code>Percentage</code> column.</p>\n\n<p>The code I am using is as follows:</p>\n\n<pre><code>Sub EmailExtract()\n\nDim objOutlook As Object\nDim objMail As Object\nDim TempFilePath As String\nDim Location As String\nDim Individual As String\nDim rng As Range\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\nWorksheets(\"Contacts\").Activate\nRange(\"A2\").Select\nWhile ActiveCell &lt;&gt; \"\"\n\n    ActiveCell.Offset(1, 0).Select\n    Location = ActiveCell.Address\n    Individual = ActiveCell.Value\n    Worksheets(\"Individual Output 2\").Activate\n    Range(\"C2\").Value = Individual\n\n    Set rng = ActiveSheet.Range(\"A1:M28\").Rows.SpecialCells(xlCellTypeVisible)\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n\n\n    With objMail\n            .To = \"joe.bloggs@hotmail.com\"\n            .Subject = \"\"\n\n            Dim Greeting As String\n            If Time &gt;= #12:00:00 PM# Then\n                Greeting = \"Afternoon ,\"\n            Else\n                Greeting = \"Morning,\"\n            End If\n\n\n\n            .HTMLBODY = \"&lt;font face=Arial&gt;&lt;p&gt;\" &amp; \"Good \" + Greeting + \"&lt;/p&gt;\"\n            .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Please find below your \" &amp; MonthName((Month(Date)) - 1) &amp; \" Information.\" &amp; \"&lt;/p&gt;\"\n            .HTMLBODY = .HTMLBODY + RangetoHTML(rng)\n            .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Kind Regards\" &amp; \"&lt;/p&gt;\"\n            .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Joe Bloggs\" &amp; \"&lt;/p&gt;&lt;/font&gt;\"\n            .Display\n    End With\n    Worksheets(\"Contacts\").Activate\nWend\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.ReadAll\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n\n<p>I have tried changing the following:</p>\n\n<pre><code>Set TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Set TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n</code></pre>\n\n<p>And to:</p>\n\n<pre><code>Set TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    rng.Copy Destination:=.Cells(1)\n    .Cells(1).Select\n    On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n</code></pre>\n\n<p>But neither of them have worked.</p>\n\n<p>Can someone please help?</p>\n\n<p><strong>I've found out what the problem is but how I can get round it:</strong></p>\n\n<p>The conditional formatting is applied on workbook A, what the code does is copy the range from workbook A to workbook B, on workbook A some of the conditional formatting is calculated using data on other sheets within workbook A, when this is copied over the conditional formatting for the cells that are using data in other sheets are no longer formatted because the links break. So what I need is for it to work in a way that copies the conditional formatting, removes the conditional formatting but keeps the colors, copies and pastes the cells into workbook B, then reapplies the conditional formatting in workbook A for next time. Any ideas?</p>\n"}, {"tags": ["excel", "add-in", "solver", "vba"], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "is_accepted": false, "score": 0, "last_activity_date": 1439996720, "creation_date": 1439996720, "answer_id": 32099246, "question_id": 32098972, "link": "https://stackoverflow.com/questions/32098972/check-if-an-add-in-is-installed-and-running-vba/32099246#32099246", "title": "Check if an Add-in is installed and running VBA", "body": "<p>Answering my on question:\nIt is necessary to access the .installed property like this:</p>\n\n<p>myBoolean1 = SolverNome1.Installed 'will return false because the add-in is set and not installed\nmyBoolean2 = SolverNome1.Installed 'won't return because add-in is not set</p>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439996720, "creation_date": 1439996079, "last_edit_date": 1531164843, "question_id": 32098972, "link": "https://stackoverflow.com/questions/32098972/check-if-an-add-in-is-installed-and-running-vba", "title": "Check if an Add-in is installed and running VBA", "body": "<p>I am trying to check if an add-in is installed and running. I am using this piece of code:  </p>\n\n<pre><code>On Error Resume Next:\n\nSet SolverNome1 = AddIns(\"Solver Add-In\") 'Solver may have two different names\nSet SolverNome2 = AddIns(\"Solver\")\nMsgBox IsEmpty(SolverNome1)\nMsgBox IsEmpty(SolverNome2)\n\nIf IsEmpty(SolverNome1) And IsEmpty(SolverNome2) Then\n    MsgBox \"Install Solver add-in before trying to install this add-in.\", vbExclamation\n    Application.myAddInName.Installed = False 'uninstall my add-in\nEnd If\n</code></pre>\n\n<p>The problem is that even with the Solver Uninstalled I still get IsEmpty(SolverNome1) = false so my condition clause doesn't work as desired. I guess there I am misunderstanding the concept of installed or not. What piece of code should I be using to check if solver is running?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ON8J1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ON8J1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1439999911, "post_id": 32098889, "comment_id": 52095244, "body": "Please add your table(s) with some sample data. If suppliers and POCs are in one table, you need to split them."}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1440001819, "post_id": 32098889, "comment_id": 52096289, "body": "I apologize for my ignorance on this but how do I the files on here? If it requires something along the lines of dropbox or similar program then I will not be able to due to network restrictions"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1440004206, "post_id": 32098889, "comment_id": 52097597, "body": "@ColeStratton you can&#39;t post the files per se. You can paste your data into the question body (a representative subset) and format it so it looks decent/workable."}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440005284, "post_id": 32098889, "comment_id": 52098231, "body": "Table has been added in the best format I could get it"}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1440009917, "post_id": 32098889, "comment_id": 52100964, "body": "It looks like this should be two separate tables, one for your supplies, and one for the Point of Contacts. However, either way have you tried using a subform in datasheet view do display your POC&#39;s related tot he chosen supplier?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440014279, "post_id": 32103396, "comment_id": 52103612, "body": "Code is supposed to be unique to Supplier. I realize in the example I have above that is violated. Is there a work around to accomodate this?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440022030, "post_id": 32103396, "comment_id": 52107418, "body": "Yeah, I wasn&#39;t sure if Code is a supplier code or a part code. Just move it to the table where it belongs. And I assumed that suppliers can have more than one Part, therefore Parts belong in a separate table.  To quote from the first link above, &quot;normalization is basically just the common sense&quot;. Think about the objects/things/whatever you are storing: suppliers, parts, contact persons. These things determine the structure of your tables, and their relations."}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440040939, "post_id": 32103396, "comment_id": 52112057, "body": "In addition to this, I am having to take a daily report sent through Excel and import into this database. I can append the records to the end of the table no problem however setting up the relationship for this table is causing me issues. If I let Access add the primary key upon import would that fix the issue? I would be linking a supplier field in the import data to the Supplier table suggested above."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440055147, "post_id": 32103396, "comment_id": 52117010, "body": "If the import data doesn&#39;t have a column that qualifies as primary key, then yes, let Access create an autonumber field as PK. I can&#39;t really tell you more without seeing the table."}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440081613, "post_id": 32103396, "comment_id": 52134780, "body": "The import table has 25 fields worth of data so posting it here would be too much. I let access add the primary key however, it still says the Relationship must be on the same number of fields with the same data types. Supplier field in import data is Text format. The supplier field in the import data will eventually be updated depending on what is currently in the field. If you really need to see the table then I will work on getting it posted here."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440081825, "post_id": 32103396, "comment_id": 52134940, "body": "Only the relevant columns are needed, of course. But please post it in a new question."}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440083001, "post_id": 32103396, "comment_id": 52135896, "body": "I was able to find a way to get it to work. Thank you for your assistance."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1440011754, "last_edit_date": 1495535197, "creation_date": 1440010241, "answer_id": 32103396, "question_id": 32098889, "link": "https://stackoverflow.com/questions/32098889/show-all-records-for-given-field-filter-in-access-2010-table/32103396#32103396", "title": "Show All Records For Given Field Filter In Access 2010 Table", "body": "<p>Your table needs heavy normalization (see e.g. <a href=\"https://stackoverflow.com/questions/246701/what-is-normalisation-or-normalization\">What is Normalisation (or Normalization)?</a> or <a href=\"http://r937.com/relational.html\" rel=\"nofollow noreferrer\">http://r937.com/relational.html</a> )</p>\n\n<p>I would suggest (Note: I'm not sure about the Supplier/Code/Part relation) :</p>\n\n<pre><code>- tSupplier\nSupplierID   SupplierName\n1            Ajin\n2            KSR\n\n- tParts\nPartID     SupplierID   Code      Part\n1          1            AKVN\n2          2            C03A05    Brake Pedal \n\n- tContactTypes\nTypeID    Type\n1         Supplier \n2         Procurement \n3         QC\n\n- tContacts\nContactID  SupplierID  TypeID  ContactName\n1          1           1       Patrick\n2          1           1       Chase\n3          1           2       Yong\n4          1           3       Jack\n</code></pre>\n\n<p>and so on.\nThe first column of each table is the <strong>primary key</strong>, an autonumber field.\nAll other ID columns are <strong>foreign keys</strong>, linking to a parent table.</p>\n\n<p>Now you can have a combobox for the Supplier, which gives the SupplierID.<br>\nWith that, you can filter the Contacts and show them in a datasheet subform.<br>\nEither all in one table, with the ContactTypes as column, or in three subforms, each filtered by one ContactType.</p>\n\n<p>To be able to add new contacts, use the <code>BeforeInsert</code> event to assign the current SupplierID.</p>\n"}], "owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 32103396, "answer_count": 1, "score": 0, "last_activity_date": 1440011754, "creation_date": 1439995888, "last_edit_date": 1440005243, "question_id": 32098889, "link": "https://stackoverflow.com/questions/32098889/show-all-records-for-given-field-filter-in-access-2010-table", "title": "Show All Records For Given Field Filter In Access 2010 Table", "body": "<p>Hopefully this will make sense...I have a table in Access 2010 that contains a list of suppliers and their point of contacts at the supplier and where I work. The POCs vary in number, anywhere from 1-4 up to this point. The table is set up so each POC is on a separate line.</p>\n\n<p>The supplier could have one contact but work could have three different contacts and vice versa.  </p>\n\n<p>What I want to happen is when I select a value from a combobox on a form, all the related POCs need to be shown instead of cycling through them one by one. </p>\n\n<p>For example, Supplier1 has two POCs at their facility and we have three at our facility. I would like to have the combobox find Supplier1 in the table and then show all the contacts for that supplier (their facility and ours) in a textbox.</p>\n\n<p>The user will be able to edit the contact information and, if it is not too difficult, would be able to add/delete a contact.</p>\n\n<p>I'm sure a question similar to this one has been asked before, however I have been unable to word it correctly to find a solution through google searches/this website. I'm comfortable enough with VBA to use that if required but am by no means an expert. I am completely unfamiliar with SQL and would like to avoid going that direction if at all possible.</p>\n\n<p>I have to be careful with any data I provide but will do what I can if you need to see the data or anything like that. </p>\n\n<pre><code>Supplier    Code    Part    Supplier Contact   Procurement Contact  QC Contact\nAjin        AKVN            Patrick                 Yong                 Jack   \nAjin        AKVN            Chase                   Yong                 Jack   \nAutoliv     AMNP   Seatbelt Daryl                   James                Lewis  \nBosch       AG48            Hancheul                Kevin           \nCarlex      AKJ5  QTR Glasses  Bob                  Joy                   Zack  \nContinental ANKC            Jacob           \nKSR       C03A05 Brake Pedal Jose                   Paul                 David\nKSR       C03A05 Brake Pedal Jose                  Paul                  Gary\nKSR      C03A05  Brake Pedal Jose                  Paul                  Steven\nKSR      AG5Z   Accelerator Pedal Jack             Paul                  David\nKSR      AG5Z   Accelerator Pedal Jack             Paul                  Gary\nKSR     AG5Z    Accelerator Pedal Jack             Paul                 Steven\nKSR     AG5Z    Accelerator Pedal Cory             Paul                 David\nKSR     AG5Z    Accelerator Pedal Cory             Paul                 Gary\nKSR     AG5Z    Accelerator Pedal Cory             Paul                 Steven\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1439996006, "post_id": 32098835, "comment_id": 52092361, "body": "It should be <code>emp.validateSSN ssn_vals</code> without parentheses and the routine needs to take a String array, not Variant. Since you already set the SSN as a property of the employee, I&#39;m not sure why you need to pass the array again to validate it."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1439998393, "creation_date": 1439998393, "answer_id": 32099893, "question_id": 32098835, "link": "https://stackoverflow.com/questions/32098835/arrays-vba-type-mismatch-array-or-user-defined-type-expected/32099893#32099893", "title": "arrays vba - type mismatch: array or user-defined type expected", "body": "<p>You are using <strong>cell</strong> as a Range, but have not <em>Dim</em>'ed it or <em>Set</em> it.  There may be other problems</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 1223903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04845ce7e47e49f0b2df3bc0f45296d1?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1223903/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1440099138, "creation_date": 1440099138, "answer_id": 32126819, "question_id": 32098835, "link": "https://stackoverflow.com/questions/32098835/arrays-vba-type-mismatch-array-or-user-defined-type-expected/32126819#32126819", "title": "arrays vba - type mismatch: array or user-defined type expected", "body": "<p>thank you for the useful comments - this had made me realize that I didn't have to pass ssn array again to employee object, since its data was saved inside Employee already. To correct issue I created a method within Employee that verified SIN based on an Employee's existing SIN. Thanks a bunch...</p>\n"}], "owner": {"reputation": 79, "user_id": 1223903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04845ce7e47e49f0b2df3bc0f45296d1?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1223903/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1440099138, "creation_date": 1439995758, "last_edit_date": 1531164843, "question_id": 32098835, "link": "https://stackoverflow.com/questions/32098835/arrays-vba-type-mismatch-array-or-user-defined-type-expected", "title": "arrays vba - type mismatch: array or user-defined type expected", "body": "<p>I am having an issue with passing an array to a sub (receiving type mismatch: array or user-defined type expected). I have worked with array structures in other languages and I must be missing something here in vba since I can't get this to work. I have posted code snippets below for comment:</p>\n\n<pre><code>Private Sub x()\n    Dim ssn_vals(1 To 9) As String\n    Dim ssn_cells(1 To 9) As String\n\n    'define employee object\n     Dim emp As Employee\n\n     'create new employee foreach row\n      Set emp = New Employee\n\n    'ssn values\n        ssn_vals(1) = cell.Offset(0, 60)\n        ssn_vals(2) = cell.Offset(0, 61)\n        ssn_vals(3) = cell.Offset(0, 62)\n        ssn_vals(4) = cell.Offset(0, 63)\n        ssn_vals(5) = cell.Offset(0, 64)\n        ssn_vals(6) = cell.Offset(0, 65)\n        ssn_vals(7) = cell.Offset(0, 66)\n        ssn_vals(8) = cell.Offset(0, 67)\n        ssn_vals(9) = cell.Offset(0, 68)\n\n\n\n        'ssn cell addresses\n        ssn_cells(1) = cell.Offset(0, 60).Address\n        ssn_cells(2) = cell.Offset(0, 61).Address\n        ssn_cells(3) = cell.Offset(0, 62).Address\n        ssn_cells(4) = cell.Offset(0, 63).Address\n        ssn_cells(5) = cell.Offset(0, 64).Address\n        ssn_cells(6) = cell.Offset(0, 65).Address\n        ssn_cells(7) = cell.Offset(0, 66).Address\n        ssn_cells(8) = cell.Offset(0, 67).Address\n        ssn_cells(9) = cell.Offset(0, 68).Address\n\n        emp.setSSN = ssn_vals\n        emp.setSSN_cells = ssn_cells\n\n        'validate ssn\n        emp.validateSSN (ssn_vals)\n\nend sub\n</code></pre>\n\n<p>i have a sub defined inside employee class</p>\n\n<pre><code>'validate SSN\nPublic Sub validateSSN(ssn() As Variant)\n    Dim i As Integer\n    'Dim orig_array(1 To 9) As Variant\n    Dim multipler_array(1 To 9) As Integer\n    Dim summation_array(1 To 9) As Integer\n\n\n    multipler_array(1) = 1\n    multipler_array(2) = 2\n    multipler_array(3) = 1\n    multipler_array(4) = 2\n    multipler_array(5) = 1\n    multipler_array(6) = 2\n    multipler_array(7) = 1\n    multipler_array(8) = 2\n    multipler_array(9) = 1\n\n\n\n    If Me.getSinOrT = \"sin\" Then\n        For i = LBound(ssn(i)) To UBound(ssn(i))\n           summation_array(i) = (Int(ssn(i)) * Int(multipler_array(i)))\n           Debug.Print summation_array(i)\n    Next i\n\n    Else\n\n\n     End If\n\n End Sub\n</code></pre>\n\n<p>Any suggestions on how to fix this trivial thing would be greatly appreciated.\nThanks in advance,\nMichael   </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439995107, "post_id": 32098540, "comment_id": 52091645, "body": "Record a macro and manually change the options to &#39;automatic calculation&#39;. Stop the macro - copy the code there into the Workbook - Open sub."}], "answers": [{"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 3, "last_activity_date": 1439996223, "last_edit_date": 1439996223, "creation_date": 1439995353, "answer_id": 32098678, "question_id": 32098540, "link": "https://stackoverflow.com/questions/32098540/macro-activate-automatic-caluclation-when-opening-an-excel-workbook/32098678#32098678", "title": "Macro: activate &quot;automatic caluclation&quot; when opening an excel workbook", "body": "<p>Open the VB Editor (<kbd>ALT</kbd>+<kbd>F11</kbd>) and right click <code>ThisWorkbook</code> (under Microsoft Excel Objects) --> View Code.</p>\n\n<p>This area handles the workbook event code.</p>\n\n<p>Paste in the following code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n        Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>This just changes the Excel settings to make calculation automatic.  If you want to actually calculate the workbook on open you can do that as well like so:</p>\n\n<pre><code>Private Sub Workbook_Open()\n        Application.Calculation = xlCalculationAutomatic 'Change calculation setting to automatic\n        Application.Calculate 'Perform workbook calculations\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 32098678, "answer_count": 1, "score": 1, "last_activity_date": 1439996223, "creation_date": 1439994973, "question_id": 32098540, "link": "https://stackoverflow.com/questions/32098540/macro-activate-automatic-caluclation-when-opening-an-excel-workbook", "title": "Macro: activate &quot;automatic caluclation&quot; when opening an excel workbook", "body": "<p>How to activate the option \" automatic calculation\" when directly after opening an excel workbook with a macro?</p>\n"}, {"tags": ["database", "vba", "ms-access", "odbc"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1440000113, "post_id": 32098435, "comment_id": 52095389, "body": "Can you post the code that connects to the other database?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1440020149, "post_id": 32098435, "comment_id": 52106688, "body": "What is the external database? Another Access DB? If so, why not use linked tables instead of ODBC?"}, {"owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "edited": false, "score": 0, "creation_date": 1440058726, "post_id": 32098435, "comment_id": 52119125, "body": "The external database is KB_SQL. I have the tables set up as linked tables in Access via the ODBC DSN Data Source so there is no code in how this works. When I access one of these tables (either directly or as part of an Access query) I then authenticate with the KB_SQL server. However the issue is that from that point on Access retains the connection until the database is closed. I want to be able to force this open connection to close so that I can re-authenticate without having to close Access. So far I&#39;ve not been able to find any VBA functions which will do this."}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "edited": false, "score": 0, "creation_date": 1440082017, "post_id": 32114847, "comment_id": 52135099, "body": "Thanks for your suggestions @Andre451 - I think the issue is that Access is still retaining an underlying cache of the connection which isn&#39;t released until the application is closed. When I tried this it is re-creating the linked tables without prompting for credentials. I&#39;ve since come across <a href=\"https://blogs.office.com/2011/04/08/power-tip-improve-the-security-of-database-connections/\" rel=\"nofollow noreferrer\">this page</a> which mentions this behaviour in Access so perhaps it isn&#39;t possible to manually clear this cache."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1440063795, "creation_date": 1440063795, "answer_id": 32114847, "question_id": 32098435, "link": "https://stackoverflow.com/questions/32098435/manually-close-odbc-dsn-connection/32114847#32114847", "title": "Manually Close ODBC DSN Connection", "body": "<p>Oh, linked tables. I don't think this is possible.<br>\nYou can try to reset the connection information, but I doubt it will work:</p>\n\n<pre><code>Dim TD As TableDef\n\nFor Each TD In DB.TableDefs\n    ' Linked table? You can also check the .Connect string more specifically for KB_SQL\n    If TD.Connect &lt;&gt; \"\" Then\n        TD.Connect = TD.Connect\n        TD.RefreshLink\n    End If\nNext TD\n</code></pre>\n\n<p>A more radical approach that might actually work is to delete the table links and re-add them.</p>\n\n<pre><code>Dim TD As TableDef\nDim sConn As String, sName As String\n\nFor Each TD In DB.TableDefs\n    If TD.Connect &lt;&gt; \"\" Then\n        sName = TD.Name\n        sConn = TD.Connect\n        ' Remove linked table\n        DB.TableDefs.Delete sName\n        ' and add it as new link\n        DoCmd.TransferDatabase acLink, \"ODBC Database\", sConn, acTable, sName, sName\n    End If\nNext TD\n</code></pre>\n\n<p>You may need a different sort of loop than For Each, since you are modifying the DB.TableDefs collection in the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "edited": false, "score": 0, "creation_date": 1440086092, "post_id": 32122059, "comment_id": 52137961, "body": "I think you&#39;re on to something here - having a few issues with the DSN-less connection string (no error message defined, using <a href=\"http://kbs.custhelp.com/app/answers/detail/a_id/748/kw/odbc\" rel=\"nofollow noreferrer\">their example</a> so this is separate kb_sql issue I think) - but changing it to use a different User DNS that points to the same server does prompt it for credentials again, so I think this suggests that your idea would work."}, {"owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "edited": false, "score": 0, "creation_date": 1455199342, "post_id": 32122059, "comment_id": 58389978, "body": "It&#39;s been a while since you posted this but I&#39;ve finally been able to fully test your suggestion to confirm that it works. Your suggestion of a DSN-less connection where you change the <code>Database=...</code> (or in my case <code>Server=...</code>) to something unique then Access will re-prompt you for credentials and open a brand new connection... allowing me to seamlessly switch which connection my linked tables are authenticating with."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1440083654, "creation_date": 1440083654, "answer_id": 32122059, "question_id": 32098435, "link": "https://stackoverflow.com/questions/32098435/manually-close-odbc-dsn-connection/32122059#32122059", "title": "Manually Close ODBC DSN Connection", "body": "<p>Two things:<br>\n1) You can make the process of closing and re-opening Access as painless as possible for your users by doing:</p>\n\n<pre><code>' Close and restart\nShell \"restart.bat\", vbNormalFocus\nApplication.Quit\n</code></pre>\n\n<p>with restart.bat consisting of something like</p>\n\n<pre><code>REM wait for Access to close\nTIMEOUT 3\nREM your actual command line goes here\nmsaccess.exe mydatabase.mdb\n</code></pre>\n\n<p>2) You mentioned:</p>\n\n<blockquote>\n  <p>What I want to be able to do is switch which database the ODBC\n  connection is accessing</p>\n</blockquote>\n\n<p>The link you posted gave me an idea:  </p>\n\n<blockquote>\n  <p>Any subsequent ODBC objects that happen to match on three\n  parameters\u2014ODBC driver, server, and database\u2014will reuse that cached\n  connection.</p>\n</blockquote>\n\n<p>If you switch your linked tables from User DSN to DSN-less connections, your desired behaviour should happen automatically.<br>\nJust change the .Connect string of all tables by altering the \"Database=...\" part, and Access should ask for credentials when a table is accessed the next time.</p>\n"}], "owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3351, "favorite_count": 0, "accepted_answer_id": 32122059, "answer_count": 2, "score": 0, "last_activity_date": 1440083654, "creation_date": 1439994730, "question_id": 32098435, "link": "https://stackoverflow.com/questions/32098435/manually-close-odbc-dsn-connection", "title": "Manually Close ODBC DSN Connection", "body": "<p>I have an MS Access database that connects to another database via a user level DNS ODBC data source. </p>\n\n<p>When the connection is first initiated the ODBC driver will prompt me for a username and password. The database that it then connects to on the server is dependent on the username I use.</p>\n\n<p>Once the connection is established Access will retain / keep it alive until I close the Access database.</p>\n\n<p>Is there a way to force Access to close all open ODBC connections, requiring me to provide the login credentials again when I next try to access an object on the server. What I want to be able to do is switch which database the ODBC connection is accessing without having to completely close Access and re-open the database.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1439996982, "creation_date": 1439996982, "answer_id": 32099373, "question_id": 32098066, "link": "https://stackoverflow.com/questions/32098066/how-to-copy-table-rows-without-knowing-its-containing-sheet/32099373#32099373", "title": "How to copy table rows without knowing it&#39;s containing sheet", "body": "<p>Answer to your first problem (maybe you could break your question up and ask different questions for different problems)</p>\n\n<p>Since <code>ListObjects</code> is a child of <code>WorkSheet</code> -- I don't see of any way to avoid iterating through the workbooks looking for the sheet containing the table. Something like this:</p>\n\n<pre><code>Function FindTable(WB As Workbook, TableName As String) As String\n    Dim ws As Worksheet\n    Dim wsName As String\n    On Error Resume Next\n    For Each ws In WB.Sheets\n        wsName = ws.ListObjects(TableName).Parent.Name\n    Next\n    If Len(wsName) = 0 Then\n        FindTable = \"Table Not Found\"\n    Else\n        FindTable = wsName\n    End If\nEnd Function\n</code></pre>\n\n<p>To test it I created a table named \"Hidden Table\" and put it on sheet 3. Then I ran this:</p>\n\n<pre><code>Sub test()\n    Debug.Print FindTable(ActiveWorkbook, \"Hidden Table\")\n    Debug.Print FindTable(ActiveWorkbook, \"Nonexistant Table\")\nEnd Sub\n</code></pre>\n\n<p>Which printed:</p>\n\n<pre><code>Sheet3\nTable Not Found\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 0, "last_activity_date": 1439997726, "creation_date": 1439997726, "answer_id": 32099628, "question_id": 32098066, "link": "https://stackoverflow.com/questions/32098066/how-to-copy-table-rows-without-knowing-its-containing-sheet/32099628#32099628", "title": "How to copy table rows without knowing it&#39;s containing sheet", "body": "<p>To answer question 2:</p>\n\n<pre><code>Dim loSource as ListObject\nDim loDestination as ListObject\n\nSet loSource = ...   'To do\nSet loDestination = ...   'To do\n\nloDestination.Range(2,1).Resize(loSource.ListRows.Count, loSource.ListColumns.Count).Value = loSource.DataBodyRange.Value\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 2418364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/859f98db49b0a05d9ae1a4e1d0d500e7?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/2418364/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 32099628, "answer_count": 2, "score": 0, "last_activity_date": 1439997726, "creation_date": 1439993838, "last_edit_date": 1531164843, "question_id": 32098066, "link": "https://stackoverflow.com/questions/32098066/how-to-copy-table-rows-without-knowing-its-containing-sheet", "title": "How to copy table rows without knowing it&#39;s containing sheet", "body": "<p>I want to copy data from one table to another, from one workbook to another.\nI know the table names, they are identical.\nThe source table has an unknown number of data rows plus an unknown number of empty rows. The destination table (same name, same sheet) has only empty rows, but not necessarily the same overall number of rows as the origin.</p>\n\n<p>i know i can do something like </p>\n\n<pre><code>sourceBook.Activate\nActiveSheet.ListObjects(knownTableName).DataBodyRange.Select\nSelection.Copy\ndestinationBook.Activate\nActiveSheet.ListObjects(knownTableName).DataBodyRange.Select\nActiveSheet.Paste\n</code></pre>\n\n<p>However there are a number of problems: </p>\n\n<ol>\n<li>The table is not on the activeSheet. How do i find the sheet that the table is on? or is  there a better way to reference it (ideally without having to find the sheet first)?</li>\n<li>I know <code>.Activate</code> and <code>Selection.Copy</code> is slow and bad. How can i do it better?</li>\n<li>How do i find the \"used\" data range of both tables without looping through the table rows?</li>\n<li>Is it possible to copy the data row by row (so that only non empty rows are copied)? ideally, i would like to just insert all non-empty source rows to the destination table and subsequently delete all empty rows in the destination table</li>\n</ol>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1440002583, "post_id": 32097841, "comment_id": 52096751, "body": "So if <code>Me.Sort.Text</code> contains the text <i>&quot;foo&quot;</i>, you want to build a filter expression string such as <code>&quot;[Student ID] Like &#39;foo*&#39; OR [First Name] Like &#39;foo*&#39; OR [Last Name] Like &#39;foo*&#39;&quot;</code>  Did I understand correctly?"}, {"owner": {"reputation": 43, "user_id": 5216907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDzrG.jpg?s=128&g=1", "display_name": "robosheep", "link": "https://stackoverflow.com/users/5216907/robosheep"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1440008353, "post_id": 32097841, "comment_id": 52099960, "body": "I think this is correct"}], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 43, "user_id": 5216907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDzrG.jpg?s=128&g=1", "display_name": "robosheep", "link": "https://stackoverflow.com/users/5216907/robosheep"}, "edited": false, "score": 0, "creation_date": 1440019921, "post_id": 32105675, "comment_id": 52106562, "body": "Good, I thought that&#39;s what you were after.  One point which bothers me a little is that you will alter the subform <code>.Filter</code> with each keystroke in the <i>Sort</i> text box.  If that proves to be too much load on the database engine, consider using the text box&#39;s After Update (instead of its Change event) to apply the <code>.Filter</code>"}, {"owner": {"reputation": 43, "user_id": 5216907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDzrG.jpg?s=128&g=1", "display_name": "robosheep", "link": "https://stackoverflow.com/users/5216907/robosheep"}, "edited": false, "score": 0, "creation_date": 1440020203, "post_id": 32105675, "comment_id": 52106711, "body": "Thats a good idea. I will switch to that If I start to have problems."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1440018412, "creation_date": 1440018412, "answer_id": 32105675, "question_id": 32097841, "link": "https://stackoverflow.com/questions/32097841/filter-subform-starts-with-multiple-criteria/32105675#32105675", "title": "Filter Subform, Starts With, Multiple criteria", "body": "<p>It sounds to me like you need a filter expression with 3 <code>Like</code> conditions <code>OR</code>'d together.</p>\n\n<p>For example if <code>Me.Sort.Text</code> contains the text <em>\"foo\"</em>, build a filter expression string such as ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code> \"[Student ID] Like 'foo*' OR [First Name] Like 'foo*' OR [Last Name] Like 'foo*'\"\n</code></pre>\n\n<p>I tested this code in Access 2010 and it filters the subform as I think you want ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Sort_Change()\n    Dim strFilter As String\n\n    With Me.Sort\n        If Len(.Text &amp; vbNullString) &gt; 0 Then\n            strFilter = \"[Student ID] Like '\" &amp; .Text &amp; _\n                \"*' OR [First Name] Like '\" &amp; .Text &amp; _\n                \"*' OR [Last Name] Like '\" &amp; .Text &amp; \"*'\"\n        End If\n    End With\n    Debug.Print \"strFilter: \" &amp; strFilter '&lt;- inspect this in Immediate window\n                                          ' Ctrl+g will take you there\n    With Me.Students_subform.Form\n        If Len(strFilter) = 0 Then\n            .FilterOn = False\n        Else\n            .Filter = strFilter\n            .FilterOn = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5216907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDzrG.jpg?s=128&g=1", "display_name": "robosheep", "link": "https://stackoverflow.com/users/5216907/robosheep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 1, "accepted_answer_id": 32105675, "answer_count": 1, "score": 3, "last_activity_date": 1440018412, "creation_date": 1439993244, "question_id": 32097841, "link": "https://stackoverflow.com/questions/32097841/filter-subform-starts-with-multiple-criteria", "title": "Filter Subform, Starts With, Multiple criteria", "body": "<p>I would like to filter a subform based on data put into a text box.\nThe code below will show the record if the <code>Student ID</code> is typed perfectly.\nI want to have my filter show any records in which the <code>Student ID</code>, <code>First Name</code> or <code>Last Name</code> starts with <code>Me.Sort.Text</code></p>\n\n<pre><code>Private Sub Sort_Change()\nIf IsNull(Me.Sort.Text) Or Me.Sort.Text = \"\" Then\n    Me.Students_subform.Form.FilterOn = False\nElse\n    Me.Students_subform.Form.FilterOn = True\n    Me.Students_subform.Form.Filter = \"[Student ID] ='\" &amp; Me.Sort.Text &amp; \"'\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visual-studio-2010", "charts"], "answers": [{"comments": [{"owner": {"reputation": 1279, "user_id": 781970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef1e51a7a1e596d943685c7d93a4d071?s=128&d=identicon&r=PG", "display_name": "JanuskaE", "link": "https://stackoverflow.com/users/781970/januskae"}, "edited": false, "score": 0, "creation_date": 1440856878, "post_id": 32102427, "comment_id": 52451344, "body": "The chart has to have enough data so that the data set is larger then the chart."}], "tags": [], "owner": {"reputation": 1279, "user_id": 781970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef1e51a7a1e596d943685c7d93a4d071?s=128&d=identicon&r=PG", "display_name": "JanuskaE", "link": "https://stackoverflow.com/users/781970/januskae"}, "is_accepted": true, "score": 0, "last_activity_date": 1440006949, "creation_date": 1440006949, "answer_id": 32102427, "question_id": 32097750, "link": "https://stackoverflow.com/questions/32097750/how-to-make-a-scrollbar-visible-on-a-chart-in-visual-basic-forms/32102427#32102427", "title": "How to make a ScrollBar visible on a chart in Visual Basic forms", "body": "<p>In code not shown the x Axes was disabled.\nStill doesn't explain why I could interact with an invisible scroll bar but its working now.</p>\n"}], "owner": {"reputation": 1279, "user_id": 781970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef1e51a7a1e596d943685c7d93a4d071?s=128&d=identicon&r=PG", "display_name": "JanuskaE", "link": "https://stackoverflow.com/users/781970/januskae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 32102427, "answer_count": 1, "score": 0, "last_activity_date": 1440006949, "creation_date": 1439992957, "question_id": 32097750, "link": "https://stackoverflow.com/questions/32097750/how-to-make-a-scrollbar-visible-on-a-chart-in-visual-basic-forms", "title": "How to make a ScrollBar visible on a chart in Visual Basic forms", "body": "<p>I have a chart that needs a ScrollBar. Funny thing is that the ScrollBar is there, but its not visible. I can interact with it on the bottom of the chart and it functions OK. It just isn't visible. Anyhow here is some code...</p>\n\n<pre><code>'ch is the Chart\n    With ch.ChartAreas(0)\n        With .AxisX\n            .Minimum = chartMin\n            .Maximum = chartMax\n            .Interval = 1\n            .ScaleView.Size = chartRows\n            .ScaleView.Position = chartMax\n            With .ScrollBar\n                .Size = 20\n                .ButtonStyle = ScrollBarButtonStyles.SmallScroll\n                .IsPositionedInside = True\n                .Enabled = True\n                .BackColor = Color.LightGray\n                .ButtonColor = Color.Gray\n            End With\n        End With\n        .RecalculateAxesScale()\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 0, "last_activity_date": 1439996791, "last_edit_date": 1439996791, "creation_date": 1439993875, "answer_id": 32098079, "question_id": 32097723, "link": "https://stackoverflow.com/questions/32097723/exporting-a-certain-worksheet-from-a-workbook-to-pdf/32098079#32098079", "title": "exporting a certain worksheet from a workbook to pdf", "body": "<p>Instead of exporting each sheet individually, select them all first and then call the <code>ExportAsFixedFormat</code> method.</p>\n\n<p>Here is my test code, which worked as expected:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TestPDF()\n\n        Dim i As Integer\n        Dim arrSheets() As String\n        Dim strSheets As String\n\n        'Get our sheet names\n        For i = 1 To 3\n                strSheets = Worksheets(i).Name &amp; \",\" &amp; strSheets\n        Next\n\n        'Trim the trailing comma\n        strSheets = Left(strSheets, Len(strSheets) - 1)\n\n        arrSheets = Split(strSheets, \",\")\n\n        ThisWorkbook.Sheets(arrSheets).Select\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\Users\\qzbcjs\\Documents\\Useful Workbooks\\test.pdf\", Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n        True\n\nEnd Sub\n</code></pre>\n\n<p>I declared an array of strings, populated a string variable with the comma-delimited names of the worksheets (in my case I just wanted the first through third sheets), split that comma-delimited string into an array and used the array to select all of the desired sheets and only called the <code>ExportAsFixedFormat</code> method once.</p>\n\n<p>Adapting this method to your code, beginning as the <code>lois</code> part would look something like this:</p>\n\n<pre><code>lois:\n\n        Dim ws As Worksheet\n        Dim arrSheets() As String\n        Dim strWs As String\n\n        For i = 0 To ListBox2.ListCount - 1\n                While ListBox2.List(i) &lt;&gt; \"\"\n\n                        For Each ws In Worksheets\n                                If ws.Name = ListBox2.List(i) Then\n                                        strWs = ws.Name &amp; \",\" &amp; strWs\n                                End If\n                        Next\n                Wend\n        Next i\n\n        strWs = Left(strWs, Len(strWs) - 1)\n\n        arrSheets = Split(strWs, \",\")\n\n        ThisWorkbook.Sheets(arrSheets).Select\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\Export\\Resultats__\" &amp; ListBox2.List(i - counter) &amp; \".pdf\", Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n        True\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5243638, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5fa04dc71f38af9460be97d74a17935a?s=128&d=identicon&r=PG&f=1", "display_name": "maximus", "link": "https://stackoverflow.com/users/5243638/maximus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 32098079, "answer_count": 1, "score": 0, "last_activity_date": 1439998273, "creation_date": 1439992888, "last_edit_date": 1439998273, "question_id": 32097723, "link": "https://stackoverflow.com/questions/32097723/exporting-a-certain-worksheet-from-a-workbook-to-pdf", "title": "exporting a certain worksheet from a workbook to pdf", "body": "<p>i am an amateur programmer learning how to program using vba</p>\n\n<p>without further a due, my question is :</p>\n\n<p>i have created a listbox (listbox1) where i've listed all my sheets(ws) name in a specific workbook.\ni've also created another listbox(listbox2) where when i select some  sheets name on the listbox1, they will be transfer to listbox2.</p>\n\n<p>my main objective is that by choosing  one or more sheets listed in the listbox2, and by clicking a button, i'll manage to save all the selected sheets in one pdf file. </p>\n\n<p>here is the code for the button used to export the file in pdf that i've written but i've only managed to export them not in one pdf file but in numerous amount of pdf file.</p>\n\n<pre><code>Dim NomTableau() As String\n\nFor Each WkbkName In application.Workbooks()    \nIf WkbkName.Name = choix_poteau.Value &amp; \"_\" &amp; section &amp; \"_\" &amp; projet &amp; \".xlsx\" Then\nWkbkName.Activate\nGoTo lois\nEnd If    \nNext\n\nSet wbk = Workbooks.Open(add1 &amp; \"\\\" &amp; Me.projet.Value &amp; \"\\\" &amp; Me.section.Value &amp; \"\\poteaux\\\" &amp; Me.choix_poteau.Value &amp; \"_\" &amp; Me.section &amp; \"_\" &amp; Me.projet &amp; \".xlsx\")\n\nlois:\n\nFor i = 0 To ListBox2.ListCount - 1\nWhile ListBox2.List(i) &lt;&gt; \"\"\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n\nIf ws.Name = ListBox2.List(i) Then\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"C:\\Export\\Resultats__\" &amp; ListBox2.List(i - counter) &amp; \".pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\n\nEnd If\n\nNext\nWend\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>thanks alot, really appreciate your help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439992697, "post_id": 32097512, "comment_id": 52089723, "body": "This site is not meant for people to simply request prepackaged code be written for them. Have you attempted this yourself yet? And if you are okay with simply highlighting the offending rows, have you considered just using conditional formatting?"}, {"owner": {"reputation": 29, "user_id": 4142405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_kNW2JH9ZSk/AAAAAAAAAAI/AAAAAAAAFJw/DNp7ph3eyKc/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4142405/chris"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439994574, "post_id": 32097512, "comment_id": 52091210, "body": "I didn&#39;t even know how to begin with this problem.  I did a lot of google searching but I hadn&#39;t found anyone with an issue like this before.  If you have a link to something similar to what I&#39;m looking for, where entries are being compared to other entries within a certain threshold, I&#39;d be happy to begin there and come back with more specific queries later."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439996028, "post_id": 32097512, "comment_id": 52092384, "body": "Do you want to compare points or just latitudes to each other?"}, {"owner": {"reputation": 29, "user_id": 4142405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_kNW2JH9ZSk/AAAAAAAAAAI/AAAAAAAAFJw/DNp7ph3eyKc/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4142405/chris"}, "edited": false, "score": 0, "creation_date": 1439996583, "post_id": 32097512, "comment_id": 52092816, "body": "Points.  I just thought the easiest way to go about it would be to compare all x coordinates to each other, take the events that had similar x coordinates and out of that group compare all y coordinates to each other, and then copy all events that fit both criteria to a new sheet.  I think it&#39;s pretty convoluted but I didn&#39;t see a better way of doing it."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4142405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_kNW2JH9ZSk/AAAAAAAAAAI/AAAAAAAAFJw/DNp7ph3eyKc/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4142405/chris"}, "edited": false, "score": 0, "creation_date": 1439993933, "post_id": 32097693, "comment_id": 52090694, "body": "Will this compare all coordinates in the columns to each other?  In other words, I&#39;m not picking the coordinate to compare all entries to, I want to see if each coordinate is next to any other coordinate in their respective two columns.  And how can I get it to transfer those entries to a new sheet?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 29, "user_id": 4142405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_kNW2JH9ZSk/AAAAAAAAAAI/AAAAAAAAFJw/DNp7ph3eyKc/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4142405/chris"}, "edited": false, "score": 0, "creation_date": 1439994754, "post_id": 32097693, "comment_id": 52091346, "body": "No, you will have to write a loop that goes through each row.  Then load the values into the OrigPoint and CheckPoint.  To transfer the data you will have to do a copy paste on the range from one worksheet to the next or something like that.  Here are some examples of looping row.  <a href=\"http://stackoverflow.com/questions/24377197/iterating-through-populated-rows-in-excel-using-vba\" title=\"iterating through populated rows in excel using vba\">stackoverflow.com/questions/24377197/&hellip;</a>  And here is how to copy data.  <a href=\"http://stackoverflow.com/questions/28038263/copy-data-from-one-excel-sheet-to-another-complex-using-vba-based-on-column-na\" title=\"copy data from one excel sheet to another complex using vba based on column na\">stackoverflow.com/questions/28038263/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 4142405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_kNW2JH9ZSk/AAAAAAAAAAI/AAAAAAAAFJw/DNp7ph3eyKc/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4142405/chris"}, "edited": false, "score": 0, "creation_date": 1439996174, "post_id": 32097693, "comment_id": 52092502, "body": "Thank you very much for your advice.  I&#39;m very much a beginner at working with VBA and I need all the help I can get.  :)"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1439995063, "last_edit_date": 1439995063, "creation_date": 1439992799, "answer_id": 32097693, "question_id": 32097512, "link": "https://stackoverflow.com/questions/32097512/comparing-goegraphic-points-where-x-and-y-are-in-two-columns/32097693#32097693", "title": "Comparing goegraphic points where X and Y are in two columns", "body": "<p>I'm not sure if you just want to compare x coords.  You could find two x coords that are close but the y coords are far apart. Not sure if that is what you want, just things that are close in one aspect.  If that is what you want just loop the rows subtracting one from another.  If you want to find the distance between two geographic points see below.</p>\n\n<p>You can get the distance between two points using the pythagorean theorem.</p>\n\n<pre><code>Dim OrigPoint As Double\nDim CheckPoint As Double\nDim Distance As Double\n\nOrigPoint = point1X - point2X\nCheckPoint = point1Y - point2Y\n\nDistance = Sqr((OrigPoint * OrigPoint) + (CheckPoint * CheckPoint))\n\nIf Distance &lt; 300 Then\n    'Copy or highlight your data\nEnd If\n</code></pre>\n\n<p>You will need to loop rows doing something like this.  Then using this these in the code above will compare the point on the current row to the point on the next row.</p>\n\n<pre><code>OrigPoint = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"V\" &amp; lrow).Value - ActiveWorkbook.Sheets(\"Sheet1\").Range(\"V\" &amp; lrow + 1).Value\n\nCheckPoint = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"W\" &amp; lrow).Value - ActiveWorkbook.Sheets(\"Sheet1\").Range(\"W\" &amp; lrow + 1).Value\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4142405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_kNW2JH9ZSk/AAAAAAAAAAI/AAAAAAAAFJw/DNp7ph3eyKc/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4142405/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "accepted_answer_id": 32097693, "answer_count": 1, "score": 1, "last_activity_date": 1519270306, "creation_date": 1439992323, "last_edit_date": 1439998365, "question_id": 32097512, "link": "https://stackoverflow.com/questions/32097512/comparing-goegraphic-points-where-x-and-y-are-in-two-columns", "title": "Comparing goegraphic points where X and Y are in two columns", "body": "<p>I have a huge data set with x and y coordinates in them.  I'm looking to see if two events are close to each other in proximity, and if so, highlight those events or pull them out and put them in a separate worksheet.  </p>\n\n<p>X coordinates are in column V<br>\nY coordinates are in column W</p>\n\n<p>I am looking for points that are within a given distance of each other.  I want to either highlight or put them in a new worksheet. </p>\n\n<p>One question is how to report this. I might have two points close to each other that are far from two other point that are also close to each other.</p>\n\n<p>My goal is to take a list of thousands of events and pull out the ones that are close to each other on a map without actually having to search through them all.  My data set is continuously growing so this would be a huge time saver in the long run.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1439993023, "post_id": 32097496, "comment_id": 52089960, "body": "What happens when you try <code>Reports!rptTest!lblTest.Visible = True</code>?  If there is an error, what is the full text of the error message for that one?"}, {"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1439993445, "post_id": 32097496, "comment_id": 52090291, "body": "Thanks for your reply.  It gives the exact same error, minus my flustered parentheticals, as above."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439994430, "post_id": 32098035, "comment_id": 52091082, "body": "Thanks, but I&#39;ve never used the Immediate window.  I entered what you advised into it, but I can&#39;t figure out how to make it do anything.  MSDN doesn&#39;t seem to explain how to run whatever&#39;s in it.  I should also mention that I&#39;m attempting to reference the Report&#39;s controls through a subform control on a parent Form."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439994557, "post_id": 32098035, "comment_id": 52091191, "body": "I&#39;m not sure what you said, but it sounds like you got to the Immediate window.  From there, paste in <code>? Reports.Count</code> and press Enter.  What number does Access show you for <code>Count</code>?"}, {"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439995148, "post_id": 32098035, "comment_id": 52091667, "body": "It shows &#39;1&#39;, which I would expect, but the For... line you gave above does nothing.  I am viewing the Report through a subform/subreport control within a Form."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439995326, "post_id": 32098035, "comment_id": 52091813, "body": "OK, Access believes there is one &quot;top-level&quot; report open.  Try the <code>for each rpt ... </code> statement again, making sure to press Enter at the end of that line.  Then on the next line Access should show you the name it recognizes for the open report.  What is that name?"}, {"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439996125, "post_id": 32098035, "comment_id": 52092465, "body": "The <code>for each rpt ...</code> in Immediate still returns nothing (it auto-capitalizes <code>For</code>, so it&#39;s obviously parsing it).  However, the <code>Reports!rptParent!SubreportControl!lblTest.Visible</code> syntax you provided works like a champ!  I now have direct access to the control.  Also for posterity, the <code>Reports!rptTest!lblTest.Visible = True</code> syntax works when the report is opened directly.  Thank you!!!  :D"}, {"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439996279, "post_id": 32098035, "comment_id": 52092582, "body": "The only complication I could foresee is if I wanted the code to work in both subreport view as well as directly, in Report view (which I don&#39;t need here).  For my general fund of knowledge, is there perchance a way to detect (in OnLoad or OnOpen?) whether it&#39;s being loaded into a subreport control.  I could use that to control visibility of different versions of buttons, or (better) set a public var that governs which syntax to use."}, {"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439996771, "post_id": 32098035, "comment_id": 52092954, "body": "OnLoad or OnOpen for the Report.  Can it detect that?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 1, "creation_date": 1439997095, "post_id": 32098035, "comment_id": 52093214, "body": "Check <code>CurrentProject.AllReports(Me.Name).IsLoaded</code> in <code>Report_Load()</code> ... it will be True when the report is opened directly as a &quot;top-level&quot; report, and False when it is &quot;sort of open&quot; as a subform/subreport control when its   parent form or report is opened."}, {"owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "edited": false, "score": 0, "creation_date": 1439997302, "post_id": 32098035, "comment_id": 52093369, "body": "Oops.  I should have known that.  :)  Thanks again!!"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1439995663, "last_edit_date": 1439995663, "creation_date": 1439993756, "answer_id": 32098035, "question_id": 32097496, "link": "https://stackoverflow.com/questions/32097496/cannot-explicitly-refer-to-controls-on-a-report-ms-access-vba/32098035#32098035", "title": "Cannot explicitly refer to controls on a report (MS Access/VBA)", "body": "<p>Check the names of the reports Access thinks are open.</p>\n\n<p>With your report open, go to the Immediate window.  <kbd>Ctrl</kbd>+<kbd>g</kbd> will take you there.</p>\n\n<p>Paste in <code>for each rpt in reports : ? rpt.name : next</code> as one line and press <kbd>Enter</kbd>.  Access will tell you the names of the open reports as it sees them.</p>\n\n<p>Here is an Immediate window example from my system with one report, <em>rptFoo</em>, open ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>for each rpt in reports : ? rpt.name : next\nrptFoo\n</code></pre>\n\n<p>The problem you're facing is that <em>rptTest</em> is open, but Access disagrees.  That discrepancy can be caused at least 3 ways:</p>\n\n<ol>\n<li><em>rptTest</em> is what you see when the report is open, but that is the report's <code>Caption</code> property instead of its <code>Name</code></li>\n<li><em>rptTest</em> is a subreport contained in some other open report.  The <code>Reports</code> collection, which is where Access looks to find open reports, contains only the \"top-level\" reports which are open. If you're dealing with a subreport, reference it via its parent report ... <code>Reports!rptParent!SubreportControl!lblTest.Visible</code> where <code>SubreportControl</code> is the name of the subreport control which contains <em>rptTest</em>.  Be careful because the name of that subreport control may not be <em>rptTest</em> --- you need the name of the subreport control, not the name of the report it contains.</li>\n<li>If <em>rptTest</em> is contained in a subform/subreport control within a form (instead of within a report), the situation is similar to #2, but you must reference it via its parent form ... <code>Forms!YourFormName!SubcontrolName!lblTest.Visible</code></li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 5243528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e63613d51c196610c70fd43033af414?s=128&d=identicon&r=PG&f=1", "display_name": "CayCay", "link": "https://stackoverflow.com/users/5243528/caycay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2216, "favorite_count": 0, "accepted_answer_id": 32098035, "answer_count": 1, "score": 2, "last_activity_date": 1439995663, "creation_date": 1439992286, "last_edit_date": 1439994625, "question_id": 32097496, "link": "https://stackoverflow.com/questions/32097496/cannot-explicitly-refer-to-controls-on-a-report-ms-access-vba", "title": "Cannot explicitly refer to controls on a report (MS Access/VBA)", "body": "<p>How do I refer to a report's controls explicitly?  Referring implicitly works as expected:</p>\n\n<pre><code>Me.lblTest.Visible = True\n</code></pre>\n\n<p>However, all of my attempts at referencing the control <em>explicitly</em> meet with various nonsensical runtime errors.  Access' favorite:</p>\n\n<blockquote>\n  <p>\"The report name 'rptTest' you entered is misspelled <em>(it's not)</em> or refers to a report that isn't open <em>(it is)</em> or doesn't exist <em>(it does)</em>.\"</p>\n</blockquote>\n\n<p>I've tried a dozen syntax variations from MSDN and everywhere else I could find, all producing errors:</p>\n\n<pre><code>Reports!rptTest.lblTest.Visible = True\n    ' ^--expected syntax, like Forms!frmName.ctlName.Property\nReports!(\"rptTest\").lblTest.Visible = True\nReports![rptTest].lblTest.Visible = True\nReports(\"rptTest\").Controls(\"lblTest\").Visible = True\netc. etc.\n</code></pre>\n\n<p>This should be no different from referring to forms' controls, right?  There must be a way to refer explicitly to a report's controls.</p>\n"}, {"tags": ["vba", "excel", "web-crawler"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1439992865, "creation_date": 1439992865, "answer_id": 32097712, "question_id": 32097486, "link": "https://stackoverflow.com/questions/32097486/get-data-from-a-website-based-on-content-in-worksheet/32097712#32097712", "title": "Get data from a website based on content in worksheet", "body": "<p>Try running the javascript directly.</p>\n\n<pre><code>Call HTMLDoc.parentWindow.execScript(\"submitSearch();\", \"javascript\")\n</code></pre>\n\n<p>The <code>href</code> in the <code>a</code> element is set to do nothing but the <code>onClick</code> is set to run the above script.</p>\n"}], "owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440026087, "creation_date": 1439992268, "last_edit_date": 1440026087, "question_id": 32097486, "link": "https://stackoverflow.com/questions/32097486/get-data-from-a-website-based-on-content-in-worksheet", "title": "Get data from a website based on content in worksheet", "body": "<pre><code>        Sub try()\n        Dim ie As Object\n        Dim MyHTML_Element As IHTMLElement\n        Dim MyURL As String\n        Dim MyURLSer As String\n        Set ie = CreateObject(\"InternetExplorer.Application\")\n   On Error GoTo Err_Clear\n    MyURL = \"[http://test.com/login][1]\"\n   Set MyBrowser = New InternetExplorer\n    MyBrowser.Silent = True\n   MyBrowser.navigate MyURL\n   MyBrowser.Visible = True\n        Do\n      Loop Until MyBrowser.readyState = READYSTATE_COMPLETE\nSet HTMLDoc = MyBrowser.document\nHTMLDoc.all.j_username.Value = \"User\" 'Enter your email id here\nHTMLDoc.all.j_password.Value = Password'Enter your password here\nFor Each MyHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf MyHTML_Element.Type = \"button\" Then MyHTML_Element.Click: Exit For\nNext\nOn Error GoTo Err_Clear\nMyURL = \"http://test.com/home\"\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.navigate MyURL\nMyBrowser.Visible = True\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nErr.Clear\nResume Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p>My problem is when I try to enter the number that I want to search in the website I'm unable to do that. Unable to enter the submit button.\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;FORM name=menuSearchForm id=menuSearchForm style=\"PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px\" action=abc/search/default method=post&gt;\r\n&lt;INPUT name=searchKeyword class=search-field id=search value=\"Enter number\" jQuery19101740035784191712=\"16\"&gt;\r\n&lt;TD class=search_btn&gt;&lt;A style=\"MARGIN: 0px\" onclick=javascript:submitSearch(); href=\"javascript:void(0);\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1439992392, "post_id": 32097449, "comment_id": 52089479, "body": "The easiest way to answer this is for you to post the code you got with the macro recorder and for someone to show you how to alter it to get what you want."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439993832, "post_id": 32097449, "comment_id": 52090626, "body": "Create a variable and set it to cell A1. Then save filename as that variable."}, {"owner": {"reputation": 39, "user_id": 5243656, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206347774247156/picture?type=large", "display_name": "Neil Capper", "link": "https://stackoverflow.com/users/5243656/neil-capper"}, "edited": false, "score": 0, "creation_date": 1440143532, "post_id": 32097449, "comment_id": 52160518, "body": "Thanks very very much.  As I said im new to VBA and the idea to create the variable ion A! put me on the right track and its now working perfectly."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1539484097, "last_edit_date": 1539484097, "creation_date": 1526723585, "answer_id": 50423952, "question_id": 32097449, "link": "https://stackoverflow.com/questions/32097449/vba-to-save-worksheet-with-a-specific-name/50423952#50423952", "title": "VBA to save worksheet with a specific name", "body": "<pre><code>Option Explicit\nSub FileNameToFolder()\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Title: FileNameToFolder\n'Description: Uses 'filename-valid' contents of a cell in a worksheet of a\n'    'source' workbook as the filename for a 'destination' workbook containing\n'    only a copy of the worksheet itself to be created in an existing folder in\n'    the 'source' worksbook's folder.\n'Remarks: The program will fail if you use characters like &lt;, &gt;, :, \", /, \\, |,\n'    ? or * in the cell and if the existing folder does not exist. If the\n'    'destination' workbook exists, excel will display an alert to overwrite it;\n'    if you don't click yes, the program will fail.\n'Idea Source Title: VBA to save worksheet with a specific name\n'Idea Source Link Address: https://stackoverflow.com/questions/32097449/vba-to-save-worksheet-with-a-specific-name\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Variables\n  'Const\n    Const cStrFolder As String = \"Orders\"\n    Const cStrSep As String = \"\\\"\n    Const cStrRef As String = \"A1\"\n    Const cStrExt As String = \".xls\"\n  'Dim\n    Dim wbActive As Workbook 'DefaultFilePath Issue\n    Dim wsActive As Worksheet\n    Dim strFile As String\n    Dim strPath As String\n    Dim strFullPath As String\n    Dim wbDest As Workbook\n'Program\n    Set wbActive = ActiveWorkbook\n    Set wsActive = wbActive.ActiveSheet\n    strPath = wbActive.Path\n    strFile = wsActive.Range(cStrRef).Value\n    strFullPath = strPath &amp; cStrSep &amp; cStrFolder &amp; cStrSep &amp; strFile &amp; cStrExt\n  'Creates a copy of the worksheet in a new workbook (no need for workbooks.Add)\n    wsActive.Copy\n    On Error GoTo ProgErr\n        ActiveWorkbook.SaveAs Filename:=strFullPath\n        Set wbDest = ActiveWorkbook\n        wbDest.Close\n    Exit Sub\nProgErr:\n    MsgBox \"Read the remarks section of the code.\"\nEnd Sub\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5243656, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206347774247156/picture?type=large", "display_name": "Neil Capper", "link": "https://stackoverflow.com/users/5243656/neil-capper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1901, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539484097, "creation_date": 1439992194, "last_edit_date": 1440071942, "question_id": 32097449, "link": "https://stackoverflow.com/questions/32097449/vba-to-save-worksheet-with-a-specific-name", "title": "VBA to save worksheet with a specific name", "body": "<p>Hi  probably a simple answer but im new to VBA. </p>\n\n<p>I have a worksheet in a workbook.  This worksheet has a specific reference in cell A1 which changes each time its used.  It is basically an order number and formatted 03 01 15.  The next will be 03 02 15, then 03 03 15 and so on.  </p>\n\n<p>What I want to do is to use VBA to save the sheet in a new workbook in my orders folder, and for the new workbook to be called the order number.  </p>\n\n<p>I can use the record macro function to get the basic VBA to copy the sheet, open a new workbook, paste the values and close the workbook, but im struggling with getting the name right.  Each new workbook will have a different name based on the order number.  </p>\n\n<p>Any help would be appriciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1439992100, "post_id": 32097383, "comment_id": 52089227, "body": "Have you tried changing <code>xlWhole</code> to <code>xlPart</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 1, "last_activity_date": 1439992101, "creation_date": 1439992101, "answer_id": 32097409, "question_id": 32097383, "link": "https://stackoverflow.com/questions/32097383/find-text-which-is-part-of-cell-value-in-find-function-vba-excel/32097409#32097409", "title": "Find text which is part of cell value in .Find function VBA excel", "body": "<p>Just change <code>LookAt:=xlWhole</code> to <code>LookAt:=xlPart</code></p>\n\n<pre><code>Set cell1 = Selection.Find(What:=SomeText, After:=ActiveCell, LookIn:=xlValues, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5226510, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6d955acd378d3594d359cbeb442553b?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej", "link": "https://stackoverflow.com/users/5226510/maciej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439992101, "creation_date": 1439992026, "question_id": 32097383, "link": "https://stackoverflow.com/questions/32097383/find-text-which-is-part-of-cell-value-in-find-function-vba-excel", "title": "Find text which is part of cell value in .Find function VBA excel", "body": "<p>I have code like below, but I have problem, I do not know how can I find row where SomeText is included in cell value. If my explanation is not clear example: SomeText = 1200 and want to get row index where cell value are as follow: 1200.0 and 1200.1. Thanks in advance for any help. </p>\n\n<pre><code>Set cell1 = Selection.Find(What:=SomeText, After:=ActiveCell, LookIn:=xlValues, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1439991766, "post_id": 32096966, "comment_id": 52088929, "body": "Nothing that you described seems particularly hard. You need some sort of abbreviation scheme (and maybe a worksheet which functions as a sort of dictionary with the unabbreviated name in one column and the corresponding abbreviation in the other). You haven&#39;t provided enough information to say what the solution is, but it seems straightforward enough. You need to provide more detail and also show what you have tried to do to solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 122, "user_id": 1228044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ff53ef435188d85f8c05b1a7f6072e14?s=128&d=identicon&r=PG", "display_name": "er_jack", "link": "https://stackoverflow.com/users/1228044/er-jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1439991507, "creation_date": 1439991507, "answer_id": 32097180, "question_id": 32096966, "link": "https://stackoverflow.com/questions/32096966/naming-sheets-and-copying-data-based-on-cell-names/32097180#32097180", "title": "Naming sheets and copying data based on cell names", "body": "<p>After you create a new worksheet you can navigate using:</p>\n\n<pre><code>Sheets(\"NewWorksheetName\").Range(\"A1\")=\"Data\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5188798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e8a7d2a582f04dea412633aac777f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Zakrzewski", "link": "https://stackoverflow.com/users/5188798/rados%c5%82aw-zakrzewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1441291376, "creation_date": 1439991041, "last_edit_date": 1441291376, "question_id": 32096966, "link": "https://stackoverflow.com/questions/32096966/naming-sheets-and-copying-data-based-on-cell-names", "title": "Naming sheets and copying data based on cell names", "body": "<p>I have a database created with following information:\nCompany, worksite, element name, date, number, and few columns with numerical values.</p>\n\n<p>Thing I need is to create a new worksheet (that's easy), with worksheets named after unique company/worksite information (that's the hard part). \nAfter the sheets are created, I need the whole information regarding each combination from the database to be copied there to respective worksheets (also not sure how to do it).\nThe worst part is that the company/worksite name is usually longer then 31 characters, so i can't directly use their full names to move within sheets. </p>\n\n<p>Is that even possible ?</p>\n\n<p>I could probably count the unique company/worksite rows, and then copy them whole, while creating a new worksheet for that index. \nBut I still have no idea how to deal with the naming.</p>\n\n<p>Edit:\nHad some free time on my hands, and decided to work on this.</p>\n\n<pre><code>    Sub Zaloz_Arkusze()\n\n    With Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    End With\n\n    Dim wbk3 As Workbook\n    Dim wbk4 As Workbook\n    Dim LW As Long\n    Dim LR As Long\n    Dim i As Integer\n    Dim j As Integer\n    Dim test As Integer\n    Dim Rng As Range, rCell As Range, MyTable As Range, MyTable2 As Range\n    i = 1\n    j = 4\n\n    'Optimize Macro Speed\n      Application.ScreenUpdating = False\n      Application.EnableEvents = False\n      Application.DisplayAlerts = False\n      Application.Calculation = xlCalculationManual\n\n    Set wbk3 = ActiveWorkbook\n    Set wbk4 = Workbooks.Open(\"C:\\Users\\rzakrzewski\\Desktop\\Przeroby.xlsm\")\n\n    wbk3.Activate\n    Set Rng = Range(\"A1\", Range(\"R\" &amp; Rows.Count).End(xlUp))\n\n    LR = Sheets(2).Cells(Rows.Count, \"S\").End(xlUp).Row\n         Sheets(2).Range(\"Q1:R\" &amp; LR).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Sheets(4).Range(\"A1\"), Unique:=True\n    LW = Sheets(4).Range(\"B1\", Sheets(4).Range(\"B1\").End(xlDown)).Rows.Count\n\n    Set MyTable = wbk3.Sheets(4).Range(\"B1\", Range(\"B1\").End(xlDown))\n    Set MyTable = wbk3.Sheets(4).Range(\"A1\", Range(\"A1\").End(xlDown))\n\n    test = MyTable.Rows.Count\n\n    wbk3.Sheets(2).Activate\n\n    For Each rCell In MyTable\n    On Error Resume Next\n        wbk4.Activate\n        wbk4.Worksheets.Add(After:=Sheets(Worksheets.Count)).Name = i\n        wbk3.Activate\n         With Rng\n            .AutoFilter , Field:=18, Criteria1:=rCell.Value\n            .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Copy _\n                wbk4.Sheets(j).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n            .AutoFilter\n        End With\n    On Error GoTo 0\n    i = i + 1\n    j = j + 1\n\nNext rCell\n\nApplication.EnableEvents = True\n\n    End Sub\n</code></pre>\n\n<p>The above sorts data according to company/object name, copies the unique entries and creates a number worksheets in seperate workbook according to number of unique entries. \nI decided to skip the naming part according to company/object. Name length restriction makes this hard to make. </p>\n\n<p>Next part I'm trying to figure out, is to copy data for each unique combination and paste it worksheets. \nIe. I have unique data combination in Cells B1:C6. I need data in cells D1:T6\ncopied to second workbook to worksheet(1). \nHave no idea to select the data I require. Any ideas ?</p>\n\n<p>Edit2: As show in above, I tried to work on Autofilter Option.\nProblem is, that I need 2 step checking for unique data. Companies have lots of objects under them, and sometimes the same object have a different company. But I've got no idea how to make it work.\nTried a double \"For Each\" loop, but it's not working.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439990998, "post_id": 32096857, "comment_id": 52088307, "body": "do you want to ignore empty cells within the range of <code>A1:A &amp; lastRow</code>?"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 1, "creation_date": 1439991192, "post_id": 32096857, "comment_id": 52088447, "body": "in this case i recommend copying cell by cell"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5127997, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c3fc863276d86918bc6fdfeb6e2906d4?s=128&d=identicon&r=PG&f=1", "display_name": "sandi", "link": "https://stackoverflow.com/users/5127997/sandi"}, "edited": false, "score": 0, "creation_date": 1439991460, "post_id": 32097077, "comment_id": 52088679, "body": "Thank you very very much"}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": false, "score": 3, "last_activity_date": 1439991612, "last_edit_date": 1439991612, "creation_date": 1439991295, "answer_id": 32097077, "question_id": 32096857, "link": "https://stackoverflow.com/questions/32096857/ignore-empty-cells-in-for-each-vba/32097077#32097077", "title": "Ignore empty cells in for each VBA", "body": "<p>I altered this line of code:</p>\n\n<pre><code>Ws.Range(\"A1:A\" &amp; lastRow).Copy Destination:=Worksheets(\"Podatki plana\").Range(\"A\" &amp; lastRowMaster)\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Ws.Range(\"A1:A\" &amp; lastRow).SpecialCells(xlCellTypeConstants).Copy Destination:=Worksheets(\"Podatki plana\").Range(\"A\" &amp; lastRowMaster)\n</code></pre>\n\n<p>Using the <code>.SpecialCells(xlCellTypeConstants)</code> qualifier selects only cells that have a value in them.  You could change <code>xlCellTypeConstants</code> to <code>xlCellTypeFormulas</code> or any of the options listed on <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">this MSDN article</a>.</p>\n\n<p>The benefit with this is that you don't have to loop through each cell, which is a perfectly good solution but comes with a performance penalty.</p>\n\n<p>Tested in Excel 2013.</p>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1439991410, "creation_date": 1439991410, "answer_id": 32097137, "question_id": 32096857, "link": "https://stackoverflow.com/questions/32096857/ignore-empty-cells-in-for-each-vba/32097137#32097137", "title": "Ignore empty cells in for each VBA", "body": "<p>Maybe just set each of the destination cells to the origin cell when the cell is not empty, like so</p>\n\n<pre><code>Application.ScreenUpdating = False\nlastRowMaster = 1\nlastRow = Ws.Range(\"A\" &amp; Rows.Count).End(xlUp).row\nnextRow = 1\nFor Each Ws In Sheets(Array(\"1L\", \"5L\"))     \n    for i = 1 to lastRow\n        if Not IsEmpty(Ws.Cells(i, 1)) then        \n            Worksheets(\"Podatkiplana\").cells(nextRow, 1) = Ws.cells(i,1)\n            nextRow = nextRow + 1\n        end if\n    next i\nNext\n\nApplication.ScreenUpdating = True\nMsgBox \"Done!\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1439992072, "post_id": 32097138, "comment_id": 52089193, "body": "This answer is similar to mine, but would produce potentially many blank cells. Also it looks like you meant <code>.cells(i, 1)</code> not <code>.cells(1, i)</code>."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1439992438, "post_id": 32097138, "comment_id": 52089511, "body": "thank you very much for your hint, when I posted my answer, I didn&#39;t see that others were already posted."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1439992577, "post_id": 32097138, "comment_id": 52089614, "body": "Multiple answers are just fine, in my opinion. I just thought I&#39;d offer suggestions for improvement where yours was concerned."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1439992766, "post_id": 32097138, "comment_id": 52089782, "body": "No problem, I do often mix up the <code>cells</code> property"}, {"owner": {"reputation": 23, "user_id": 5127997, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c3fc863276d86918bc6fdfeb6e2906d4?s=128&d=identicon&r=PG&f=1", "display_name": "sandi", "link": "https://stackoverflow.com/users/5127997/sandi"}, "edited": false, "score": 0, "creation_date": 1440053345, "post_id": 32097138, "comment_id": 52116015, "body": "Guys... one more question, how about if i need to copy column A and M from &quot;1L&quot; and paste all in A? any sugestions?"}], "tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 0, "last_activity_date": 1439992546, "last_edit_date": 1439992546, "creation_date": 1439991411, "answer_id": 32097138, "question_id": 32096857, "link": "https://stackoverflow.com/questions/32096857/ignore-empty-cells-in-for-each-vba/32097138#32097138", "title": "Ignore empty cells in for each VBA", "body": "<pre><code>Application.ScreenUpdating = False\nlastRowMaster = 1\n\nFor Each Ws In Sheets(Array(\"1L\", \"5L\"))\n\n        lastRow = Ws.Range(\"A\" &amp; Rows.Count).End(xlUp).row\n        For i = 1 to lastrow\n            lastRowMaster = Worksheets(\"Podatki plana\").Range(\"A\" &amp; rows.Count).End(xlUp).row + 1\n            If ws.cells(i, 1)&lt;&gt; \"\" Then Worksheets(\"Podatki plana\").Cells(lastRowMaster, 1) = ws.cells(i,1) \n\n        next i  \nNext\n\nApplication.ScreenUpdating = True\nMsgBox \"Done!\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5127997, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c3fc863276d86918bc6fdfeb6e2906d4?s=128&d=identicon&r=PG&f=1", "display_name": "sandi", "link": "https://stackoverflow.com/users/5127997/sandi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1778, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439992546, "creation_date": 1439990788, "question_id": 32096857, "link": "https://stackoverflow.com/questions/32096857/ignore-empty-cells-in-for-each-vba", "title": "Ignore empty cells in for each VBA", "body": "<p>I am having a problem with my loop(i go throu columns in every worksheet and copy them common column ) in VBA. And I wan't to ignore empty cells... any ideas? Bellow is my code </p>\n\n<pre><code>Application.ScreenUpdating = False\nlastRowMaster = 1\n\nFor Each Ws In Sheets(Array(\"1L\", \"5L\"))\n\n        lastRow = Ws.Range(\"A\" &amp; Rows.Count).End(xlUp).row\n        Ws.Range(\"A1:A\" &amp; lastRow).Copy Destination:=Worksheets(\"Podatki plana\").Range(\"A\" &amp; lastRowMaster)\n        lastRowMaster = Worksheets(\"Podatki plana\").Range(\"A\" &amp; Rows.Count).End(xlUp).row + 1\n\nNext\n\nApplication.ScreenUpdating = True\nMsgBox \"Done!\"\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1439997983, "last_edit_date": 1439997983, "creation_date": 1439992538, "answer_id": 32097603, "question_id": 32096585, "link": "https://stackoverflow.com/questions/32096585/ms-access-or-excel-formula-or-code-to-result-in-desired-output-column/32097603#32097603", "title": "MS ACCESS or Excel formula or code to result in desired output column", "body": "\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT\n    y2.ID,\n    y2.ALT_ID,\n    y2.ALT_SPEC_CODE,\n    Switch\n        (\n            CountOfALT_SPEC_CODE Is Null, 'N/A',\n            sub2.CountOfALT_SPEC_CODE = 2, 'Both',\n            sub2.CountOfALT_SPEC_CODE = 1, sub2.MinOfALT_SPEC_CODE\n        ) AS DESIRED_OUTCOME\nFROM\n    YourTable AS y2\n    LEFT JOIN\n        (\n            SELECT\n                sub1.ID,\n                Count(sub1.ALT_SPEC_CODE) AS CountOfALT_SPEC_CODE,\n                Min(sub1.ALT_SPEC_CODE) AS MinOfALT_SPEC_CODE\n            FROM\n                (\n                    SELECT DISTINCT y1.ID, y1.ALT_SPEC_CODE\n                    FROM YourTable AS y1\n                    WHERE y1.ALT_SPEC_CODE&lt;&gt;'N/A'\n                ) AS sub1\n            GROUP BY sub1.ID\n        ) AS sub2\n    ON y2.ID = sub2.ID;\n</code></pre>\n\n<p>I didn't know how to explain that coherently.  You can figure out how it works by breaking out each subquery into a new Access query, starting from the lowest level, <code>SELECT DISTINCT ...</code></p>\n\n<p>But basically the strategy is to compute <em>CountOfALT_SPEC_CODE</em> and <em>MinOfALT_SPEC_CODE</em> for each <em>ID</em>.  Then the top-level <code>Switch</code> expression can use that information to compute <em>DESIRED_OUTCOME</em>.</p>\n"}], "owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 32097603, "answer_count": 1, "score": 1, "last_activity_date": 1531321610, "creation_date": 1439990115, "last_edit_date": 1531321610, "question_id": 32096585, "link": "https://stackoverflow.com/questions/32096585/ms-access-or-excel-formula-or-code-to-result-in-desired-output-column", "title": "MS ACCESS or Excel formula or code to result in desired output column", "body": "<p>I have some data that has a 1 to many relation. Below is dummy data to represent my data.  I have an ID that will have multiple ALT_IDs. Those Alt_IDs have a relation to a column called Alt_Spec_Code.  I need or desire an output column that would populate let's say ID_Spec_Code with only one of the Alt_Spec_Codes.</p>\n\n<p><pre> <B>ID          ALT_ID          ALT_SPEC_CODE          DESIRED_OUTCOME(ID_SPEC_CODE)</B>\n 123456      111111          PA                     PA\n 123456      222222          N/A                    PA\n 123456      121212          N/A                    PA\n 654321      333333          N/A                    ST\n 654321      444444          ST                     ST\n 654321      434343          N/A                    ST\n 987654      222222          N/A                    N/A\n 987654      121212          N/A                    N/A\n 987654      333333          N/A                    N/A\n 456789      111111          PA                     BOTH\n 456789      444444          ST                     BOTH\n 456789      555555          N/A                    BOTH\n</PRE></p>\n\n<p>I was thinking I could even do an update statement to update the Desired_Outcome field with the Max or maybe even doa row_number type query to rank the Alt_Spec_Code and then update Desired_Outcome field with the first value it finds. But then I wasn't sure how to handle the last scenario where it might be Both.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439990471, "post_id": 32096549, "comment_id": 52087864, "body": "(1) You are missing your commas in your concatenate formula; (2) I can&#39;t see where RowCount is defined - is that not simply the total count of all rows in a worksheet? ie: 1M? I doubt this is what you want; (3) Look into .FormulaR1C1; it allows you to write formulas relative to a given cell&#39;s position, which seems to be ideal for you."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439990956, "post_id": 32096549, "comment_id": 52088278, "body": "Of course... Commas.  Yes, rowcount is defined elsewhere.  R1C1 I need to dive into for sure. :)"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1439991378, "post_id": 32096747, "comment_id": 52088599, "body": "@ Bond, I tried your suggestion and that works just fine."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 0, "last_activity_date": 1439990496, "creation_date": 1439990496, "answer_id": 32096747, "question_id": 32096549, "link": "https://stackoverflow.com/questions/32096549/concatenate-formula-with-rowcount/32096747#32096747", "title": "Concatenate formula with rowcount", "body": "<p>You're not creating your string properly and you need to change <code>= Formula =</code> to <code>.Formula =</code>. Also, I'm assuming <code>RowCount</code> is defined somewhere?</p>\n\n<p>Change:</p>\n\n<pre><code>.Offset(RowCount, 0) = Formula = \"=CONCATENATE(P\" &amp; RowCount &amp; \"J\" &amp; RowCount &amp; \"DG\" &amp; RowCount\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>.Offset(RowCount, 0).Formula = \"=CONCATENATE(P\" &amp; RowCount &amp; \",J\" &amp; RowCount &amp; \",DG\" &amp; RowCount &amp; \")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439991520, "post_id": 32096847, "comment_id": 52088728, "body": "@Chis.Wisselo I recommend you look at this one; this may look a little confusing at first but knowing how to use this notation can be very valuable in the long run. Note how in this case, it completely eliminates the need to even use the RowCount variable."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1439992353, "post_id": 32096847, "comment_id": 52089444, "body": "Yes, I think it can be simpler using this. But why the R[-1]? Does that look at the row above?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1439993082, "post_id": 32096847, "comment_id": 52089996, "body": "Yes, it does. Since you&#39;re offsetting by <code>rowcount</code>, you want to look one row up."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1439990762, "creation_date": 1439990762, "answer_id": 32096847, "question_id": 32096549, "link": "https://stackoverflow.com/questions/32096549/concatenate-formula-with-rowcount/32096847#32096847", "title": "Concatenate formula with rowcount", "body": "<p>You might also use R1C1 addressing instead:</p>\n\n<pre><code>.Offset(RowCount, 0).FormulaR1C1 = \"=CONCATENATE(R[-1]C16,R[-1]C10,R[-1]C111)\"\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32096747, "answer_count": 2, "score": 0, "last_activity_date": 1439990799, "creation_date": 1439990043, "last_edit_date": 1439990799, "question_id": 32096549, "link": "https://stackoverflow.com/questions/32096549/concatenate-formula-with-rowcount", "title": "Concatenate formula with rowcount", "body": "<p>I am trying to enter a <code>CONCATENATE</code> formula in a cell with VBA. But the result it writes keep returning false... I need to use a rowcount, since the table grows longer and I need it for THAT row. </p>\n\n<p>This is the latest code I tried, again to no avail:</p>\n\n<pre><code>.Offset(RowCount, 0) = Formula = \"=CONCATENATE(P\" &amp; RowCount &amp; \"J\" &amp; RowCount &amp; \"DG\" &amp; RowCount\n</code></pre>\n\n<p>Any suggestions would be greatly appreciated.</p>\n"}, {"tags": ["sql", "vba", "date", "ms-access"], "comments": [{"owner": {"reputation": 175, "user_id": 2750188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRNL5.jpg?s=128&g=1", "display_name": "aebailey", "link": "https://stackoverflow.com/users/2750188/aebailey"}, "edited": false, "score": 0, "creation_date": 1439989987, "post_id": 32096342, "comment_id": 52087480, "body": "Does excel recognise all the cells as dates?"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 175, "user_id": 2750188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRNL5.jpg?s=128&g=1", "display_name": "aebailey", "link": "https://stackoverflow.com/users/2750188/aebailey"}, "edited": false, "score": 0, "creation_date": 1439990738, "post_id": 32096342, "comment_id": 52088108, "body": "Sorry if you say my earlier comment, I misread that. It does mark them as dates in excel"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1439990050, "post_id": 32096456, "comment_id": 52087529, "body": "Well, there is a world outside the US, so the single proper way is to format as yyyy-mm-dd."}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439990551, "post_id": 32096456, "comment_id": 52087940, "body": "Do you mean format them in the excel sheet? or how would I do this in vba? I&#39;m first transferring the spreadsheet to a temporary table, then using SQL to extract only the columns I need, but the dates don&#39;t show up even in this temporary table"}, {"owner": {"reputation": 175, "user_id": 2750188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRNL5.jpg?s=128&g=1", "display_name": "aebailey", "link": "https://stackoverflow.com/users/2750188/aebailey"}, "edited": false, "score": 0, "creation_date": 1439991196, "post_id": 32096456, "comment_id": 52088448, "body": "Can you share the code you use? you could always use Day/Month/Year functions on the data before extracting to put the data in a single format"}], "tags": [], "owner": {"reputation": 12895, "user_id": 358538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b25f37035fdc1276a3990f9d2adf1b83?s=128&d=identicon&r=PG", "display_name": "Madhivanan", "link": "https://stackoverflow.com/users/358538/madhivanan"}, "is_accepted": true, "score": 1, "last_activity_date": 1439989788, "creation_date": 1439989788, "answer_id": 32096456, "question_id": 32096342, "link": "https://stackoverflow.com/questions/32096342/select-date-from-excel-sheet-that-may-be-in-one-of-many-formats/32096456#32096456", "title": "Select Date from Excel sheet that may be in one of many formats", "body": "<p>The proper way is to format all dates in mm/dd/yyyy format before loading them to Access table.</p>\n"}], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 32096456, "answer_count": 1, "score": 0, "last_activity_date": 1439989788, "creation_date": 1439989470, "question_id": 32096342, "link": "https://stackoverflow.com/questions/32096342/select-date-from-excel-sheet-that-may-be-in-one-of-many-formats", "title": "Select Date from Excel sheet that may be in one of many formats", "body": "<p>In Access, I am transferring several columns (not all) from a spreadsheet to an Access table. It works fine so long as the date on the excel sheet is in the same format as the Access table, that format being \"mm/dd/yyyy\". </p>\n\n<p>However, not all of the dates on the excel sheets are in the format \"mm/dd/yyyy\". Sometimes it is Mon-dd-yyyy, and sometimes dd/mm/yyyy. I am currently using a simple select statement to put the date in the access table, so the date transfers when it is in the correct format (mm/dd/yyyy) and leaves the date column blank for that entry when it is in any other format.</p>\n\n<p>Is there a way I can ensure the date is always formatted as \"mm/dd/yyyy\" before selecting it into the access table?</p>\n"}, {"tags": ["html", "vba", "excel", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 3149, "user_id": 215576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4469e02132e6bd78c3cb2e478cad6f2c?s=128&d=identicon&r=PG", "display_name": "ssarabando", "link": "https://stackoverflow.com/users/215576/ssarabando"}, "is_accepted": false, "score": 1, "last_activity_date": 1439991272, "last_edit_date": 1439991272, "creation_date": 1439990936, "answer_id": 32096916, "question_id": 32095995, "link": "https://stackoverflow.com/questions/32095995/vba-script-to-pull-values-within-specific-html-classes/32096916#32096916", "title": "VBA script to pull values within specific HTML classes", "body": "<p>Combine both classes in the call to <code>querySelector</code> and if <code>result</code> is <code>Nothing</code>, call it again with the alternative class.</p>\n\n<p>Example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' ...\nSet result = doc.querySelector(\".VariantPrice .NowValue\")\nIf result Is Nothing Then\n    Set result = doc.querySelector(\".VariantPrice .price\")\nEnd If\n' You should consider the fact that you can have neither\nIf result Is Nothing Then\n    Worksheets(...etc...).Value = \"N/A\"\nElse\n    Worksheets(...etc...).Value = result.innerText\nEnd If\n</code></pre>\n\n<p>Of course you can also check for the existence of the <code>NowValue</code> class after setting <code>result</code> like so:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' ...\nSet result = doc.querySelector(\".VariantPrice\")\nIf IsNull(result.querySelector(\".NowValue\")) Then\n    Set result2 = result.querySelector(\".price\")\nElse\n    Set result2 = result.querySelector(\".NowValue\")\nEnd If\n</code></pre>\n\n<p>Personally, I prefer the 1st option but it's up to your use case.</p>\n"}], "owner": {"reputation": 1033, "user_id": 4354202, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1504230130/picture?type=large", "display_name": "Jess Murray", "link": "https://stackoverflow.com/users/4354202/jess-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439991272, "creation_date": 1439988538, "last_edit_date": 1495542584, "question_id": 32095995, "link": "https://stackoverflow.com/questions/32095995/vba-script-to-pull-values-within-specific-html-classes", "title": "VBA script to pull values within specific HTML classes", "body": "<p>I created a VBA script to pull prices from websites by getting the value within an HTML Class. </p>\n\n<p>Please see <a href=\"https://stackoverflow.com/questions/30943791/vba-script-pull-data-from-website\">VBA Script pull data from website</a> for more context.</p>\n\n<p>This works really well however there are some cases where there is only 1 price (no RRP &amp; sale price) and therefore i need to somehow incorporate an if statement to look for the a class name, if that doesn't exist look for another.</p>\n\n<p>For example I have the following spreadsheet:</p>\n\n<pre><code>| A | B | C |\n| | Item | Price |\n| | bfd/garden-structures/arbours/arbours-sunflower | |\n| | bfd/garden-structures/arbours/tatton-corner-arbour-seat | |\n| | bsd/garden-storage/wooden-storage/4-x-2-windsor-garden-storage-chest | |\n</code></pre>\n\n<p>In this example the first 2 work with the code below: (looking int class <code>VariantPrice</code> &amp; <code>NowValue</code>) however the 3rd example doesn't work as the classes <code>VariantPrice</code> &amp; <code>NowValue</code> do not exist, however it does have the class <code>price</code> &amp; <code>SinglePrice</code>.</p>\n\n<p>The code I have used is below:</p>\n\n<pre><code>Sub BuyDeckingDirect()\n\n    Dim ie As New InternetExplorer\n    Dim doc As HTMLDocument\n    Dim result As IHTMLElement\n    Dim result2 As IHTMLElement\n    Dim item As String\n    Dim lRow As Long\n\n    'ie.Visible = True'\n    lRow = 2\n    item = Worksheets(\"BuyDeckingDirect\").Range(\"B\" &amp; lRow).Value\n    MsgBox \"Price Dump Started\"\n    Do Until item = \"\"\n        ie.navigate \"http://www.buydeckingdirect.co.uk/\" &amp; item\n\n        Do\n            DoEvents\n        Loop Until ie.readyState = READYSTATE_COMPLETE\n\n        Set doc = ie.document\n\n        Set result = doc.querySelector(\".VariantPrice\")\n        Set result2 = result.querySelector(\".NowValue\")\n\n        Worksheets(\"BuyDeckingDirect\").Range(\"C\" &amp; lRow).Value = result2.innerText\n\n        lRow = lRow + 1\n        item = Worksheets(\"BuyDeckingDirect\").Range(\"B\" &amp; lRow).Value\n\n    Loop\n    MsgBox \"BuyDeckingDirect Price Dump Complete\"\nEnd Sub\n</code></pre>\n\n<p>Any help would be really appreciated!</p>\n\n<p>Thanks</p>\n\n<p>Jess</p>\n"}, {"tags": ["vba", "copy", "ms-access-2010"], "comments": [{"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1439988518, "post_id": 32095852, "comment_id": 52086391, "body": "I&#39;m not sure it is possible to disable copy/paste.  What specifically are you attempting to achieve?"}, {"owner": {"reputation": 35, "user_id": 2405479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdd9e1f47013c74ebb5a5dcb5ed5dda?s=128&d=identicon&r=PG", "display_name": "raestro", "link": "https://stackoverflow.com/users/2405479/raestro"}, "reply_to_user": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1439988895, "post_id": 32095852, "comment_id": 52086669, "body": "@David I&#39;ve listboxes with critical data in it, which shouldn&#39;t be exported to an excel-file. But of course, with copy/paste it is possible. Any suggestions?"}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1439988990, "post_id": 32095852, "comment_id": 52086738, "body": "If the user can see the data then the user has the data.  Somehow disabling copy/paste may slow the user down, but if they want to copy the data they <i>always</i> can.  Doing this (again, if it&#39;s even possible), wouldn&#39;t secure the data in any way."}], "owner": {"reputation": 35, "user_id": 2405479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdd9e1f47013c74ebb5a5dcb5ed5dda?s=128&d=identicon&r=PG", "display_name": "raestro", "link": "https://stackoverflow.com/users/2405479/raestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439988199, "creation_date": 1439988199, "question_id": 32095852, "link": "https://stackoverflow.com/questions/32095852/disable-copying-from-access-datasheet", "title": "Disable Copying from Access Datasheet", "body": "<p>How is it possible to disable the cut- and copy-function  on forms or datasheets in MS Access 2010?</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5332780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689dd9dfa0ad26c58999f9a9a2ebbab4?s=128&d=identicon&r=PG&f=1", "display_name": "Eng.JGEsteves", "link": "https://stackoverflow.com/users/5332780/eng-jgesteves"}, "is_accepted": false, "score": 0, "last_activity_date": 1442214812, "creation_date": 1442214812, "answer_id": 32559069, "question_id": 32095842, "link": "https://stackoverflow.com/questions/32095842/how-to-change-sketch-support-in-catia-using-vba/32559069#32559069", "title": "How to change sketch support in CATIA using vba?", "body": "<p>You are trying by winapi and this is not the easiest way.\nYou have two alternatives:</p>\n\n<p>Or you use copy and paste method</p>\n\n<pre><code>Dim osel As Selection = CATIA.ActiveDocument.Selection\nosel.Clear()\nosel.Add(sketch3)\nosel.Copy()\nosel.Clear()\nosel.Add(Plane_a)\nosel.Paste()\nDim RsltSketch As Sketch = osel.Item2(1).Value\nosel.Clear()\n'You can delete the first one if you want\nosel.Add(sketch3)\nosel.Delete()\n</code></pre>\n\n<p>Or you define the precise vectors</p>\n\n<pre><code>Dim arrayOfVariantOfDouble(8)\narrayOfVariantOfDouble(0) = OriginPointX\narrayOfVariantOfDouble(1) = OriginPointY\narrayOfVariantOfDouble(2) = OriginPointZ\narrayOfVariantOfDouble(3) = DirectionHorizontalX\narrayOfVariantOfDouble(4) = DirectionHorizontalY\narrayOfVariantOfDouble(5) = DirectionHorizontalZ\narrayOfVariantOfDouble(6) = DirectionVerticalX\narrayOfVariantOfDouble(7) = DirectionVerticalY\narrayOfVariantOfDouble(8) = DirectionVerticalZ\nsketch3.SetAbsoluteAxisData(arrayOfVariantOfDouble)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5355942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lubnz.jpg?s=128&g=1", "display_name": "Lardman363", "link": "https://stackoverflow.com/users/5355942/lardman363"}, "is_accepted": false, "score": 1, "last_activity_date": 1450008457, "last_edit_date": 1450008457, "creation_date": 1449973228, "answer_id": 34247334, "question_id": 32095842, "link": "https://stackoverflow.com/questions/32095842/how-to-change-sketch-support-in-catia-using-vba/34247334#34247334", "title": "How to change sketch support in CATIA using vba?", "body": "<p>This link says to select the sketch then select the plane and run StartCommand \"Change Sketch Support\"</p>\n\n<pre><code>'Get the part object (Assume the part is open in it\u2019s own window)\nSet objPart = CATIA.ActiveDocument.Part\n\n'Get the first sketch in the first geometrical set\nSet objSketch = objPart.HybridBodies.Item(1).HybridSketches.Item(1)\n\n'Get the plane called Plane.1 in the first geometrical set\nSet objPlane = objPart.HybridBodies.Item(1).HybridShapes.Item(\u201cPlane.1\u201d)\n\n'Select the sketch first then the new support plane\nSet objSel = CATIA.ActiveDocument.Selection\nobjSel.Clear\nobjSel.Add objSketch\nobjSel.Add objPlane\n\n'Call the Change Sketch Support command\nCATIA.StartCommand \u201cChange Sketch Support\u201d\n</code></pre>\n\n<p><a href=\"https://v5vb.wordpress.com/2010/01/20/startcommand/\" rel=\"nofollow\">https://v5vb.wordpress.com/2010/01/20/startcommand/</a></p>\n"}], "owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2081, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505313275, "creation_date": 1439988163, "last_edit_date": 1441511593, "question_id": 32095842, "link": "https://stackoverflow.com/questions/32095842/how-to-change-sketch-support-in-catia-using-vba", "title": "How to change sketch support in CATIA using vba?", "body": "<p>I want to Change a sketch Support from one plane to another in macro.\nI tried with StartCommand but that did not work. How can this be done without user Input?</p>\n\n<p>I have tried the following code but it did not work.</p>\n\n<pre><code> CATIA.StartCommand \"Change Sketch Support\"\n selection1.Add sketch3\n SendKeys \"{ENTER}\", True\n selection1.Add Plane_a\n SendKeys \"{ENTER}\", True\n part1.Update\n</code></pre>\n"}, {"tags": ["vba", "loops", "select", "case"], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 4, "last_activity_date": 1439986487, "creation_date": 1439986487, "answer_id": 32095234, "question_id": 32095170, "link": "https://stackoverflow.com/questions/32095170/creating-a-loop-around-my-select-case/32095234#32095234", "title": "creating a loop around my select Case", "body": "<p><code>Select Case</code> runs the code block following the first matching <code>Case</code> statement only. If you need to check each of your conditions regardless, you should write them as individual <code>If</code> statements instead:</p>\n\n<pre><code>If Me.CustName   = \"\" Then Me.CustName.BackColor   = &amp;H8080FF\nIf Me.RegAddress = \"\" Then Me.RegAddress.BackColor = &amp;H8080FF\nIf Me.PostInput  = \"\" Then Me.PostInput.BackColor  = &amp;H8080FF\n....\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 4, "last_activity_date": 1439987802, "last_edit_date": 1439987802, "creation_date": 1439986685, "answer_id": 32095313, "question_id": 32095170, "link": "https://stackoverflow.com/questions/32095170/creating-a-loop-around-my-select-case/32095313#32095313", "title": "creating a loop around my select Case", "body": "<p>You are using <code>Select Case</code> for the wrong purpose.  Its purpose is to test a single expression and execute <em>one</em> branch based on the value of that expression.</p>\n\n<p>What you need to do is test each of your text boxes individually, using if statements:</p>\n\n<pre><code>If Me.CustName = \"\" Then Me.CustName.BackColor = &amp;H8080FF\n\n'etc.\n</code></pre>\n"}], "owner": {"reputation": 264, "user_id": 4948368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UbYt4.jpg?s=128&g=1", "display_name": "Peter Mogford", "link": "https://stackoverflow.com/users/4948368/peter-mogford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 32095234, "answer_count": 2, "score": 3, "last_activity_date": 1439987802, "creation_date": 1439986310, "last_edit_date": 1439986725, "question_id": 32095170, "link": "https://stackoverflow.com/questions/32095170/creating-a-loop-around-my-select-case", "title": "creating a loop around my select Case", "body": "<p>At present, I have a functioning <code>Select Case</code> that states that if a textbox is blank then it is to be highlighted red, but it only seems to be highlighting one of the textboxes. For instance, if 2 textboxes are left blank, it only highlights the first on it comes across.</p>\n\n<pre><code>Select Case True\n    Case Me.CustName = \"\"\n    Me.CustName.BackColor = &amp;H8080FF\n    Case Me.RegAddress = \"\"\n    Me.RegAddress.BackColor = &amp;H8080FF\n    Case Me.PostInput = \"\"\n    Me.PostInput.BackColor = &amp;H8080FF\n    Case Me.Landline = \"\"\n    Me.Landline.BackColor = &amp;H8080FF\n    Case Me.Contact = \"\"\n    Me.Contact.BackColor = &amp;H8080FF\n    Case Me.DOBInput = \"\"\n    Me.DOBInput.BackColor = &amp;H8080FF\nEnd Select\n</code></pre>\n\n<p>Being new to VBA, my only thinking is to create a loop round my current code that state (loop until x,y or z is &lt;> \"\")  but I can't seem to figure out how to do this.</p>\n\n<p>Any advice will be greatly appreciated.</p>\n"}, {"tags": ["regex", "vba", "ms-word"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1439986460, "post_id": 32095169, "comment_id": 52084833, "body": "What is the code point for the Arabic character? Please check with <a href=\"http://r12a.github.io/apps/conversion/\" rel=\"nofollow noreferrer\">this converter</a>."}, {"owner": {"reputation": 3801, "user_id": 1182207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/JOREX.png?s=128&g=1", "display_name": "Moha the almighty camel", "link": "https://stackoverflow.com/users/1182207/moha-the-almighty-camel"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1439986593, "post_id": 32095169, "comment_id": 52084946, "body": "<code>002E</code> which is the same as the English one apparently"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439987199, "post_id": 32095169, "comment_id": 52085354, "body": "If it&#39;s the same code point, I wonder what would cause it to use RTL."}, {"owner": {"reputation": 3801, "user_id": 1182207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/JOREX.png?s=128&g=1", "display_name": "Moha the almighty camel", "link": "https://stackoverflow.com/users/1182207/moha-the-almighty-camel"}, "edited": false, "score": 0, "creation_date": 1439987282, "post_id": 32095169, "comment_id": 52085417, "body": "Maybe it is an attribute msword attach to each character, not just through code points. I don&#39;t know how MS WORD deals with that"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1439987634, "post_id": 32095169, "comment_id": 52085672, "body": "Could be. Unfortunately, it sounds like the key to your fix will be distinguishing <code>.</code> (English) from <code>.</code> (Arabic)."}, {"owner": {"reputation": 3801, "user_id": 1182207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/JOREX.png?s=128&g=1", "display_name": "Moha the almighty camel", "link": "https://stackoverflow.com/users/1182207/moha-the-almighty-camel"}, "edited": false, "score": 0, "creation_date": 1439987706, "post_id": 32095169, "comment_id": 52085734, "body": "yeah, it boils down to that, there is this method <a href=\"https://msdn.microsoft.com/en-us/library/office/aa171960(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>  , but not sure how can I use it with the RegEx"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1439989035, "post_id": 32095169, "comment_id": 52086773, "body": "There is a pair of methods on <code>Selection</code>: <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff839502.aspx\" rel=\"nofollow noreferrer\"><code>LtrRun</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821034.aspx\" rel=\"nofollow noreferrer\"><code>RtlRun</code></a> which set the text direction of the run. If both Arabic <code>.</code> and English <code>.</code> are the same code point, then this might help."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1439989267, "post_id": 32095169, "comment_id": 52086942, "body": "These methods refer to a mysterious <b>ReadingOrder</b> property, which is probably a better choice; but I can&#39;t find it in the MSDN reference."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1439989696, "post_id": 32095169, "comment_id": 52087246, "body": "Please post the code you are using to find and replace."}, {"owner": {"reputation": 3801, "user_id": 1182207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/JOREX.png?s=128&g=1", "display_name": "Moha the almighty camel", "link": "https://stackoverflow.com/users/1182207/moha-the-almighty-camel"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1440053565, "post_id": 32095169, "comment_id": 52116120, "body": "@ZevSpitz, here you go but I started to think it is the wrong approach to begin with"}], "owner": {"reputation": 3801, "user_id": 1182207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/JOREX.png?s=128&g=1", "display_name": "Moha the almighty camel", "link": "https://stackoverflow.com/users/1182207/moha-the-almighty-camel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440616244, "creation_date": 1439986307, "last_edit_date": 1440616244, "question_id": 32095169, "link": "https://stackoverflow.com/questions/32095169/ms-word-find-and-replace-change-how-to-replace-based-on-captured-values-in-find", "title": "MS word find and replace: Change how to replace based on captured values in Find&#39;s RegEx", "body": "<p>I am working on bilingual documents (Arabic-English), The two languages have different directions (RTL and LTR respectively) which makes working with it a bit more challenging.</p>\n\n<p>I am writing a macro to change numbers of the form (x.x) to (x,x), a change in the comma.</p>\n\n<p>now here is the problem, sometimes the two numbers are switched when I do the replace, for example: x.y becomes y,x.</p>\n\n<p>after some debugging it turned out that sometimes this (.) in the first form is an Arabic character and when it is replaced with (,) which is an English one it is causing this change in order.</p>\n\n<p>so I want to do is the following, but I don't know how to translate it to VBA:  </p>\n\n<pre><code>1- look for a match to the expression ([0-9]{1, }).([0-9]{1, }) 'two numbers with a dot in between\n\n2- if the dot in between is English, replace as follows \\1,\\2  'no change  \n3- else if it is Arabic, replace as follows \\2,\\1\n</code></pre>\n\n<p>Thanks for your help</p>\n\n<p><strong>EDIT</strong><br>\nhere is the current version of the macro, it is a recorded macro. I just added the if else statement.</p>\n\n<pre><code>Sub fixComma()\n'\n' fixComma Macro\n'\n'\n   If (Selection.Start &lt;&gt; Selection.End) Then\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    Selection.Find.Replacement.LanguageID = wdEnglishUS\n    With Selection.Find\n        .Text = \"([0-9]).([0-9])\"\n        .Replacement.Text = \"\\1,\\2\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchByte = False\n        .MatchAllWordForms = False\n        .MatchSoundsLike = False\n        .MatchWildcards = True\n    End With\n\n    Selection.Find.Execute Replace:=wdReplaceAll\n\n    Else\n      MsgBox \"Nothing is selected, Macro terminated\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT 2</strong><br>\nMaybe I am taking the wrong approach here and I should go through the paragraphs myself and check for a match for the RegEx instead of using Find and Replace ?</p>\n\n<p><strong>EDIT 3</strong><br>\nMaybe I am using the wrong tool here and VBA can't help me with this ? if so is there anything else I can use ? maybe a C# add in for example. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1439985503, "post_id": 32094806, "comment_id": 52084142, "body": "<code>MsgBox a.address</code> unless I&#39;m missing something."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1439985597, "post_id": 32094892, "comment_id": 52084193, "body": "Could skip the <code>Select</code> at once."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1439985707, "post_id": 32094892, "comment_id": 52084252, "body": "Yes, but then I would feel guilty about not defining the parent worksheet. By using the OP&#39;s code for that, I can leave it to the OP to make sure that the correct worksheet is being referenced."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 1, "creation_date": 1439986045, "post_id": 32094892, "comment_id": 52084509, "body": "<code>.Find</code> doesn&#39;t require the error handling turning off, it will just return nothing if it can&#39;t find the value provided."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 1, "creation_date": 1439986514, "post_id": 32094892, "comment_id": 52084880, "body": "@lturner - Thanks for catching that. It also gave me the excuse to revisit and fix the <code>end fi</code>."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1440061811, "post_id": 32094892, "comment_id": 52121039, "body": "For an empty sheet <code>MsgBox Cells.Find(&quot;*&quot;).Address</code> halted into an error fir me. The safeguard seems necessary."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1440062354, "post_id": 32094892, "comment_id": 52121448, "body": "@user3819867 - I believe that depends upon what the VBE&#39;s Tools \u25ba Options \u25ba General \u25ba Error Trapping is set to. But you&#39;re right, it should probably be there to catch all scenarios."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 4, "last_activity_date": 1440062406, "last_edit_date": 1440062406, "creation_date": 1439985518, "answer_id": 32094892, "question_id": 32094806, "link": "https://stackoverflow.com/questions/32094806/get-address-of-cell-in-function-find/32094892#32094892", "title": "Get address of cell in function .Find", "body": "<p>You need to guard against not finding anything.</p>\n\n<pre><code>dim a as range\nRange(SomeRange).Select\non error resume next\nSet a = Selection.Find(What:=Something, After:=ActiveCell, LookIn:=xlValues, _\n   LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n   MatchCase:=False, SearchFormat:=False)\nif not a is nothing then\n     debug.print a.address(0, 0)\n     a = \"changed value\"\nend if\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5226510, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6d955acd378d3594d359cbeb442553b?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej", "link": "https://stackoverflow.com/users/5226510/maciej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513416735, "creation_date": 1439985303, "last_edit_date": 1513416735, "question_id": 32094806, "link": "https://stackoverflow.com/questions/32094806/get-address-of-cell-in-function-find", "title": "Get address of cell in function .Find", "body": "<p>I have code like below, I would like to get address of cell in which value is if value is found. Because if macro find existing value in SomeRange, I would like change value of this cell.</p>\n\n<pre><code>Range(SomeRange).Select\n    Set a = Selection.Find(What:=Something, After:=ActiveCell, LookIn:=xlValues, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1439985605, "post_id": 32094794, "comment_id": 52084198, "body": "A UDF cannot add a hyperlink - at least not without convoluted workarounds. Why do you want to do it from a function rather than say an event?"}, {"owner": {"reputation": 15, "user_id": 3059678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ffff5baa6635937c5ed4c469b72008?s=128&d=identicon&r=PG&f=1", "display_name": "KamilKrzes", "link": "https://stackoverflow.com/users/3059678/kamilkrzes"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1439985846, "post_id": 32094794, "comment_id": 52084360, "body": "You are my personal Jesus Christ. Now I know what to search for."}], "answers": [{"tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1439988598, "last_edit_date": 1495535197, "creation_date": 1439988283, "answer_id": 32095888, "question_id": 32094794, "link": "https://stackoverflow.com/questions/32094794/excel-vba-add-hyperlink-to-shape-in-group/32095888#32095888", "title": "excel vba add hyperlink to shape in group", "body": "<p>If I were you I would assign a macro to my shape so that it would run the following sub when clicked:</p>\n\n<pre><code>sub hyperlinkShape\n    ThisWorkbook.FollowHyperlink (\"C:\\temp\\test.xlsx\")\nEnd sub\n</code></pre>\n\n<p>If you're looking for a hyperlink within the workbook, such as changing sheets, you can write </p>\n\n<pre><code>sub hyperlinkShape\n    Sheets(\"Desiredsheet\").Select\nEnd sub\n</code></pre>\n\n<p>This way the hyperlink would not be attached to the shape, but the sub. Clicking the shape can launch the sub.</p>\n\n<p>For error handling, I suggest you read the answers from this thread I posted a few months back: <a href=\"https://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling\">VBA Excel simple Error Handling</a></p>\n"}], "owner": {"reputation": 15, "user_id": 3059678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ffff5baa6635937c5ed4c469b72008?s=128&d=identicon&r=PG&f=1", "display_name": "KamilKrzes", "link": "https://stackoverflow.com/users/3059678/kamilkrzes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 1, "accepted_answer_id": 32095888, "answer_count": 1, "score": 1, "last_activity_date": 1439988598, "creation_date": 1439985276, "question_id": 32094794, "link": "https://stackoverflow.com/questions/32094794/excel-vba-add-hyperlink-to-shape-in-group", "title": "excel vba add hyperlink to shape in group", "body": "<p>I have absolutely no idea why i cannot add hyperlink to shape but only if its trigged by in-cell function. When I run it manually from immediate window, everything is working well. Also I don't have any troubles with doing it manually.</p>\n\n<p>I have also no idea how write good error handling in vba</p>\n\n<p>This is sample code.</p>\n\n<pre><code>function testCase(xlLabelName as String)\nDim sht As Worksheet\n    For Each sht In ActiveWorkbook.Sheets\n        If shapeExist(sht, xlLabelName) Then\n            sht.Hyperlinks.Add Anchor:=sht.Shapes(xlLabelName), Address:=\"\", SubAddress:=\"a1\" \n            testCase = \"Bingo\"\n        End If\n    Next sht\nEnd Function\n</code></pre>\n\n<p>From immediate window I get <code>Bingo</code> answer and in cell I get <code>#arg!</code> error and this is only line which is not executed.\nI tried to ungroup shapes first using  </p>\n\n<pre><code>Dim gshp As Shape\nDim shrng As ShapeRange\nDim tmp As String\nSet gshp = sht.Shapes(getParentShape(xlLabelName))\ntmp = gshp.Name\nSet shrng = gshp.Ungroup\nsht.Hyperlinks.Add Anchor:=sht.Shapes(xlLabelName), Address:=\"\", SubAddress:=\"a1\"\nshrng.Regroup\nshrng.name = tmp\n</code></pre>\n\n<p>But it also failed. And still immediate window gives me correct answer (<code>bingo</code>)\nAll other operations are done as I needed (painting), only this one fails.\nIf I remove this problematic line I got correct response in cell.\nThe shape I'm trying to deal with is <code>msoFreeform</code><br>\nThe function to check if shape exist is just loop through all shapes in sheet and compare names (Lame but for now its working)</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1439985664, "post_id": 32094586, "comment_id": 52084235, "body": "Shouldn&#39;t the <code>On Error GoTo Error_Handler</code> not deal with errors caused by values not found?"}], "tags": [], "owner": {"reputation": 422, "user_id": 5226518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/M08sM.jpg?s=128&g=1", "display_name": "Blind Seer", "link": "https://stackoverflow.com/users/5226518/blind-seer"}, "is_accepted": false, "score": 0, "last_activity_date": 1439984700, "creation_date": 1439984700, "answer_id": 32094586, "question_id": 32094426, "link": "https://stackoverflow.com/questions/32094426/run-time-error-91-object-variable-or-with-block-not-set/32094586#32094586", "title": "Run-time error 91: Object variable or With block not set", "body": "<p>Usually this error comes up if the searched string is not found. VBA doesn't come up with \"Couldn't find what you are looking for\" but throws this error message at you. So you need to make sure that everything you are feeding VBA to look for is actually there, or catch the error and resolve what to do if it isn't.</p>\n"}, {"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1439985301, "post_id": 32094666, "comment_id": 52084005, "body": "Shouldn&#39;t the <code>On Error GoTo Error_Handler</code> not deal with values not found?"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1439984931, "creation_date": 1439984931, "answer_id": 32094666, "question_id": 32094426, "link": "https://stackoverflow.com/questions/32094426/run-time-error-91-object-variable-or-with-block-not-set/32094666#32094666", "title": "Run-time error 91: Object variable or With block not set", "body": "<p>The <code>Find()</code> function returns a <code>Range</code> object <em>if</em> it's successful. You're assuming it always will be and you're chaining an <code>Activate()</code> call to the end:</p>\n\n<pre><code>Cells.Find(What:=SearchValue, SearchOrder:=xlByRows, SearchDirection:=xlNext, SearchFormat:=False).Activate\n</code></pre>\n\n<p>This will fail if the <code>Find()</code> fails. Instead, assign the return value to a <code>Range</code> object and test for success:</p>\n\n<pre><code>Dim r As Range\nSet r = Cells.Find(What:=SearchValue, SearchOrder:=xlByRows, SearchDirection:=xlNext, SearchFormat:=False)\n\nIf Not r Is Nothing Then\n    ' Find successful\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439986707, "post_id": 32094757, "comment_id": 52085017, "body": "Jeeped, add checking for nothing in finding cell as shown in Bond&#39;s answer. If you do, you answer is more complete."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439986827, "post_id": 32094757, "comment_id": 52085093, "body": "I didn&#39;t set up a full test environment for this but the error handler throwing to <code>Error_handler:</code> should take care of that and more closely resembles the OP&#39;s original code."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1439985168, "last_edit_date": 1495540280, "creation_date": 1439985168, "answer_id": 32094757, "question_id": 32094426, "link": "https://stackoverflow.com/questions/32094426/run-time-error-91-object-variable-or-with-block-not-set/32094757#32094757", "title": "Run-time error 91: Object variable or With block not set", "body": "<p>Try it without so much <code>.Select</code>.</p>\n\n<pre><code>Sub Update()\n    Dim SearchValue As String, rFnd As Range, o As Long\n\n    Application.ScreenUpdating = False\n    Application.CutCopyMode = False\n    Application.StatusBar = \"Cleaning New Roles...\"\n\n    With Sheets(\"new\")\n        o = 0\n\n        Do Until IsEmpty(Range(\"A2\").Offset(o, 0))\n            SearchValue = vbNullString\n            SearchValue = .Range(\"A2\").Offset(o, 0).Value\n\n            With Sheets(\"Old\")\n                On Error GoTo Error_handler\n                Set rFnd = .Cells.Find(What:=SearchValue, SearchOrder:=xlByRows, SearchDirection:=xlNext, SearchFormat:=False)\n\n                Sheets(\"new\").Range(\"R2\").Offset(o, 0).Resize(1, 3) = _\n                  .Range(\"R\" &amp; rFnd.Row).Resize(1, 3).Value\n            End With\n\nError_handler:\n            o = o + 1\n        Loop\n    End With\n\n    Application.ScreenUpdating = True\n    Application.StatusBar = vbNullString\n\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4081, "favorite_count": 0, "accepted_answer_id": 32094666, "answer_count": 3, "score": 1, "last_activity_date": 1440080078, "creation_date": 1439984250, "last_edit_date": 1440080078, "question_id": 32094426, "link": "https://stackoverflow.com/questions/32094426/run-time-error-91-object-variable-or-with-block-not-set", "title": "Run-time error 91: Object variable or With block not set", "body": "<p>I have a macro that searches and copies some date from one sheet back into another, if that value is found, and repeats for every row that's not blank.</p>\n\n<p>In my current document, of around 150 rows, the following macro runs fine, but randomly throws up the error:</p>\n\n<blockquote>\n  <p>Run-time error '91': Object variable or With block variable not set</p>\n</blockquote>\n\n<p>This is the macro:</p>\n\n<pre><code>Sub Update()\n\nApplication.ScreenUpdating = False\nApplication.CutCopyMode = False\nApplication.StatusBar = \"Cleaning New Roles...\"\n\nSheets(\"new\").Select\nRange(\"A2\").Select\n\nDo Until IsEmpty(ActiveCell)\n\n    Dim SearchValue As String\n\n    SearchValue = ActiveCell.Value\n    Sheets(\"Old\").Select\n    On Error GoTo Error_handler\n    Cells.Find(What:=SearchValue, SearchOrder:=xlByRows, SearchDirection:=xlNext, SearchFormat:=False).Activate\n\n    Range(\"R\" &amp; Selection.Row &amp; \":T\" &amp; Selection.Row).Select\n    Selection.Copy\n    ActiveCell.Offset(0, -1).Select\n    Sheets(\"new\").Select\n    Range(\"R\" &amp; Selection.Row).Select\n    Selection.PasteSpecial Paste:=xlPasteValues\n\nError_handler:\n    Sheets(\"new\").Select\n    Range(\"A\" &amp; Selection.Row).Select\n    ActiveCell.Offset(1, 0).Select\n\nLoop\n\nApplication.ScreenUpdating = True\nApplication.StatusBar = False\n\nEnd Sub\n</code></pre>\n\n<p>The debug highlights the <code>Cells.Find</code> row.</p>\n\n<p>I can't see why the first 100 rows are OK and then it breaks.</p>\n\n<p>Any guidance would be very helpful.</p>\n"}, {"tags": ["excel", "vba", "function"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4548350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d4d99aa8e074d1fb21cdcb87e2fbd22?s=128&d=identicon&r=PG&f=1", "display_name": "AL92", "link": "https://stackoverflow.com/users/4548350/al92"}, "edited": false, "score": 0, "creation_date": 1439983727, "post_id": 32094168, "comment_id": 52082914, "body": "Thank you, I&#39;m still getting an error for .range(&quot;B6:B16&quot;) when I call secect_data....  Invalid or unqualified reference"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 35, "user_id": 4548350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d4d99aa8e074d1fb21cdcb87e2fbd22?s=128&d=identicon&r=PG&f=1", "display_name": "AL92", "link": "https://stackoverflow.com/users/4548350/al92"}, "edited": false, "score": 0, "creation_date": 1439983862, "post_id": 32094168, "comment_id": 52083008, "body": "You&#39;re using a <code>.</code> before <code>.Range(...)</code> which I assumed was because you had a <code>With Sheets(...)</code> block that you just weren&#39;t showing. If you want to pass a range from the active sheet, just remove the <code>.</code> when you pass your range. Otherwise, prefix it with your sheet name: <code>Call select_data(Sheets(&quot;mysheet&quot;).Range(&quot;B6:B12&quot;))</code>."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1439983563, "creation_date": 1439983563, "answer_id": 32094168, "question_id": 32094098, "link": "https://stackoverflow.com/questions/32094098/pass-range-as-a-parameter-vba/32094168#32094168", "title": "Pass .Range as a parameter VBA", "body": "<p><code>C</code> already is a <code>Range</code> object so there's no need to pass it to the <code>Range()</code> function (which expects a string anyway) to create it.</p>\n\n<p>Change:</p>\n\n<pre><code>Worksheets(\"sheet1\").Range(\"I6:I16\") = Worksheets(\"Sheet1\").Range(C).Value\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Worksheets(\"sheet1\").Range(\"I6:I16\") = C\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1439983662, "creation_date": 1439983662, "answer_id": 32094198, "question_id": 32094098, "link": "https://stackoverflow.com/questions/32094098/pass-range-as-a-parameter-vba/32094198#32094198", "title": "Pass .Range as a parameter VBA", "body": "<p>You are confusing the range as a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> with its <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow\">Address property</a>.</p>\n\n<p>Method 1:</p>\n\n<pre><code>Sub movedata()\n    Call select_data(Range(\"B6:B12\").address)\nEnd Sub\n\nFunction select_data(C As string)\n    with Worksheets(\"sheet1\")\n        .Range(\"I6:I16\") = .Range(C).Value\n    end with\nEnd Function\n</code></pre>\n\n<p>Method 2:</p>\n\n<pre><code>Sub movedata()\n    Call select_data(Worksheets(\"sheet1\").Range(\"B6:B12\"))\nEnd Sub\n\nFunction select_data(C As range)\n    C.parent.Range(\"I6\").resize(C.rows.count, C.columns.count) = C.Value\nEnd Function\n</code></pre>\n\n<p>fwiw, there is going to be some difficulties stuffing B6:B12's values into I6:I16's cells. There seem to be 4 missing values.</p>\n"}], "owner": {"reputation": 35, "user_id": 4548350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d4d99aa8e074d1fb21cdcb87e2fbd22?s=128&d=identicon&r=PG&f=1", "display_name": "AL92", "link": "https://stackoverflow.com/users/4548350/al92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9680, "favorite_count": 0, "accepted_answer_id": 32094168, "answer_count": 2, "score": 2, "last_activity_date": 1439983662, "creation_date": 1439983373, "last_edit_date": 1439983628, "question_id": 32094098, "link": "https://stackoverflow.com/questions/32094098/pass-range-as-a-parameter-vba", "title": "Pass .Range as a parameter VBA", "body": "<p>Hi Please help me with the below, </p>\n\n<pre><code>Sub movedata()\n\n    Call select_data(.Range(\"B6:B12\"))\n\n\nEnd Sub\n\n\nFunction select_data(C As Range)\n\n    Worksheets(\"sheet1\").Range(\"I6:I16\") = Worksheets(\"Sheet1\").Range(C).Value\n\nEnd Function\n</code></pre>\n\n<p>I can't see where I am going wrong, </p>\n\n<p>Thanks, </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1439982800, "post_id": 32093697, "comment_id": 52082271, "body": "complete shot in the dark but isn&#39;t &quot;Workbook&quot; already used by VBA to denote the actual workbook object? It probably shouldn&#39;t be used as a variable name.  Perhaps dim the Workbook as wb and set wb = Excel.Workbooks.Open(&quot;MyWorkbook.xlsx&quot;, Password:=&quot;MyPassword&quot;) and wb.RefreshAll will get you better results?  Again, just throwing it out there..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4720237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b344467f102e374d74709ee8f68b58?s=128&d=identicon&r=PG&f=1", "display_name": "Rath", "link": "https://stackoverflow.com/users/4720237/rath"}, "edited": false, "score": 0, "creation_date": 1439993715, "post_id": 32094647, "comment_id": 52090533, "body": "I&#39;ve copied and pasted the code as you suggest and received an error: &quot;Compile error: Method or data member not found&quot; with Excel.Visible = True highlighted.  Could this be because I have spelt Excel whereas you have used Excl?  I made the spelling the same which ran the script but the update still didn&#39;t happen.  I receive a different error &quot;Run-Time error &#39;424&#39;: Object required."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1439994298, "post_id": 32094647, "comment_id": 52090973, "body": "change the Excel in the copied code to Excl (missing e). I&#39;ve edited the code to correct that error."}, {"owner": {"reputation": 11, "user_id": 4720237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b344467f102e374d74709ee8f68b58?s=128&d=identicon&r=PG&f=1", "display_name": "Rath", "link": "https://stackoverflow.com/users/4720237/rath"}, "edited": false, "score": 0, "creation_date": 1439995026, "post_id": 32094647, "comment_id": 52091571, "body": "Thanks sous2817, i thought that was the problem so i fixed that up and then got the &quot;Run-Time error &#39;424&#39;: Object required."}, {"owner": {"reputation": 11, "user_id": 4720237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b344467f102e374d74709ee8f68b58?s=128&d=identicon&r=PG&f=1", "display_name": "Rath", "link": "https://stackoverflow.com/users/4720237/rath"}, "edited": false, "score": 0, "creation_date": 1440059071, "post_id": 32094647, "comment_id": 52119349, "body": "any other ideas on how i can get the code to do what i want it to?  I&#39;m still unable to complete the refresh."}, {"owner": {"reputation": 615, "user_id": 5229407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2d93fec7bff7029bfa7d792d76785?s=128&d=identicon&r=PG", "display_name": "Jake Bourne", "link": "https://stackoverflow.com/users/5229407/jake-bourne"}, "reply_to_user": {"reputation": 11, "user_id": 4720237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b344467f102e374d74709ee8f68b58?s=128&d=identicon&r=PG&f=1", "display_name": "Rath", "link": "https://stackoverflow.com/users/4720237/rath"}, "edited": false, "score": 0, "creation_date": 1440065890, "post_id": 32094647, "comment_id": 52123832, "body": "@Rath where is it bugging on?"}, {"owner": {"reputation": 11, "user_id": 4720237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b344467f102e374d74709ee8f68b58?s=128&d=identicon&r=PG&f=1", "display_name": "Rath", "link": "https://stackoverflow.com/users/4720237/rath"}, "edited": false, "score": 0, "creation_date": 1440077887, "post_id": 32094647, "comment_id": 52132008, "body": "When i use the code which you/sous provided i get a &quot;Run-Time error &#39;424&#39;: Object required.&quot;"}], "tags": [], "owner": {"reputation": 615, "user_id": 5229407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2d93fec7bff7029bfa7d792d76785?s=128&d=identicon&r=PG", "display_name": "Jake Bourne", "link": "https://stackoverflow.com/users/5229407/jake-bourne"}, "is_accepted": false, "score": 0, "last_activity_date": 1485450441, "last_edit_date": 1485450441, "creation_date": 1439984863, "answer_id": 32094647, "question_id": 32093697, "link": "https://stackoverflow.com/questions/32093697/auto-refresh-pivot-tables-vba-code/32094647#32094647", "title": "Auto refresh pivot tables VBA code", "body": "<p>Your using workbook which is a VBA predefined object, alter your code slightly:</p>\n\n<pre><code>Sub Autorefresh()\n\nDim Excl\nSet Excl = CreateObject(\"Excel.Application\")\n\nExcl.Visible = True\nExcl.DisplayAlerts = False\nExcl.AskToUpdateLinks = False\nExcl.AlertBeforeOverwriting = False\n\nSet Wbk = Excel.Workbooks.Open(\"MyWorkbook.xlsx\", Password:=\"MyPassword\")\nWbk.RefreshAll\nWorkbook.Save\n\nExcel.Quit\nSet Wbk = Nothing\nSet Excl = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Or add in extra code between Refresh all and Save as \n<code>Workbook.RefreshAll</code> which is the predefined command to refresh the active workbook (after changing your variables).</p>\n"}], "owner": {"reputation": 11, "user_id": 4720237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b344467f102e374d74709ee8f68b58?s=128&d=identicon&r=PG&f=1", "display_name": "Rath", "link": "https://stackoverflow.com/users/4720237/rath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485450441, "creation_date": 1439982234, "question_id": 32093697, "link": "https://stackoverflow.com/questions/32093697/auto-refresh-pivot-tables-vba-code", "title": "Auto refresh pivot tables VBA code", "body": "<p>I am responsible for updating an Excel spreadsheet which pulls its information from an Access database on a daily basis. All the data that i need for my excel spreadsheet is available for me and all that i need to do is click the refresh button.</p>\n\n<p>I've sourced a VBA code which serves my purposes for small documents, however, when i open the larger files it doesn't work correctly.  The code opens the workbook specified but does not run its refresh step - it simply saves and closes the document.  I tried to put in time delays to allow time for the refresh but it seems the refresh never actually starts on the bigger files.   </p>\n\n<p>Any ideas?  The code i am using is as follows</p>\n\n<pre><code>Sub Autorefresh()\n\nDim Excel\nSet Excel = CreateObject(\"Excel.Application\")\n\nExcel.Visible = True\nExcel.DisplayAlerts = False\nExcel.AskToUpdateLinks = False\nExcel.AlertBeforeOverwriting = False\n\nSet Workbook = Excel.Workbooks.Open(\"MyWorkbook.xlsx\", Password:=\"MyPassword\")\nWorkbook.RefreshAll\nWorkbook.Save\n\nExcel.Quit\nSet Workbook = Nothing\nSet Excel = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "for-loop", "foreach", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1439983010, "post_id": 32093645, "comment_id": 52082431, "body": "Have you tried to use the mid command?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1439985396, "post_id": 32093645, "comment_id": 52084072, "body": "No, I have not @Balinti. How should that help me? :-)"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1439985537, "post_id": 32093645, "comment_id": 52084164, "body": "I guess I could loop through the range in worksheet(10) looking for a match with the cc. If there is a match, then do all the stuff and move to next cc, etc. Can you help?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439987864, "post_id": 32093645, "comment_id": 52085859, "body": "Can you give examples as to what a ccc and a cc look like? I have no idea what you&#39;re working with at this point. Do you only want to compare them if they are on the same row? Becasue right now each of them will be compared with the each of the others. So you may get a match... between 1 and 3 for example."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439988725, "post_id": 32093645, "comment_id": 52086554, "body": "Hi @DavidG sorry if it was very unclear. So basically, I am working with some suppliers. So cc and ccc is the same supplier just different ranges (if it makes sense). I have added my new code below, this is working (so far) - I am gonna test it some more. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": false, "score": 0, "last_activity_date": 1439988633, "creation_date": 1439988633, "answer_id": 32096025, "question_id": 32093645, "link": "https://stackoverflow.com/questions/32093645/for-each-loop-inside-a-for-each-loop/32096025#32096025", "title": "For Each loop inside a For Each loop", "body": "<p>I ended up doing it slightly different :)   </p>\n\n<pre><code>     For Each cc In rngMyRange\n        For Each ccc In Worksheets(10).Range(\"F3:F\" &amp; lastrow2).Cells\n\n            Dim FoundCell As Range\n            Dim ContactID As String\n\n                ContactID = Sheets(10).Range(\"F\" &amp; ccc.Row).Value\n\n                If ContactID Like cc &amp; \"*\" Then\n                    ContactID = Replace(ContactID, ContactID, cc)\n                End If\n\n            Set FoundCell = Sheets(10).Columns(6).Find(what:=ContactID &amp; \"*\", _\n                                                             LookIn:=xlValues, _\n                                                             LookAt:=xlWhole)\n            If Not FoundCell Is Nothing Then\n                If cc Like ContactID Then\n                    If Sheets(1).Range(\"M\" &amp; cc.Row).Value Like \"AN*\" Then\n                        Sheets(1).Range(\"M\" &amp; cc.Row).Copy Destination:=Sheets(10).Range(\"G\" &amp; ccc.Row)\n                    Else\n                        ' Do nothing\n                    End If\n                End If\n            Else\n                ' Not found\n            End If\n        Next ccc\n    Next cc\n</code></pre>\n"}], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439988633, "creation_date": 1439982090, "last_edit_date": 1531161705, "question_id": 32093645, "link": "https://stackoverflow.com/questions/32093645/for-each-loop-inside-a-for-each-loop", "title": "For Each loop inside a For Each loop", "body": "<p>I have 2 sheets, so I want to <code>loop</code> the suppliers in the two ranges (they should always match, however the ccc-name will have some extra text added behind, hence the <code>replace</code>).</p>\n\n<p>My issue is that I, obviously, cannot run cc and ccc simultaneously, but I need to compare cc and ccc. How can I make something like that possible?</p>\n\n<pre><code>    For Each cc In rngMyRange\n        For Each ccc In Worksheets(10).Range(\"F3:F\" &amp; lastrow2).Cells\n\n            Dim ContactID As String, ContactID2 As String\n            ContactID = Sheets(10).Range(\"F\" &amp; ccc.Row).Value\n            ContactID = Replace(ContactID, ContactID, cc)\n\n            Debug.Print ContactID\n\n            If cc Like ContactID Then\n                If Sheets(1).Range(\"M\" &amp; cc.Row).Value Like \"AN*\" Then\n                    Sheets(1).Range(\"M\" &amp; cc.Row).Copy Destination:=Sheets(10).Range(\"G\" &amp; ccc.Row)\n                End If\n            End If\n\n        Next ccc\n    Next cc\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1439986063, "post_id": 32094017, "comment_id": 52084525, "body": "Sheets(2).Range(&quot;C1&quot;) contains the header of the column (a String). The same header is located in Sheets(5).Range(&quot;A1&quot;). If I try to include them, the way you did, I get a &quot;Runttime Error 1004: The extract range has a missing or illegal field name&quot;"}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1439986510, "post_id": 32094017, "comment_id": 52084877, "body": "I made it work, after having clear the sheet that I am copying to. Maybe you could add this to your answer, in case other people had the same issue. None-the-less, it was the correct answer, so thanks :-)"}, {"owner": {"reputation": 116, "user_id": 5228878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BtIFL.jpg?s=128&g=1", "display_name": "Phil192", "link": "https://stackoverflow.com/users/5228878/phil192"}, "reply_to_user": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1439987279, "post_id": 32094017, "comment_id": 52085413, "body": "Sheets(2).Cells.Clear added. :-)"}], "tags": [], "owner": {"reputation": 116, "user_id": 5228878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BtIFL.jpg?s=128&g=1", "display_name": "Phil192", "link": "https://stackoverflow.com/users/5228878/phil192"}, "is_accepted": true, "score": 5, "last_activity_date": 1439987211, "last_edit_date": 1439987211, "creation_date": 1439983113, "answer_id": 32094017, "question_id": 32093570, "link": "https://stackoverflow.com/questions/32093570/first-value-twice-when-using-unique-filtering-vba/32094017#32094017", "title": "First value twice when using unique filtering (VBA)", "body": "<p>The AdvancedFilter is using the top row of your range as the title and then providing distict values from the rest of the range. As you have provided row 2 as the first row, it is using this as the header and then rows 3 onwards as the data. As a result you are getting duplicates. I suggest you change your ranges to the below which will then copy the heading across.</p>\n\n<pre><code>Sub getUniqueRuns()\n    Sheets(2).Cells.Clear\n    Sheets(2).Range(\"C1:C65536\").AdvancedFilter Action:=xlFilterCopy, \n    CopyToRange:=Sheets(5).Range(\"A1\"), Unique:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14365290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a98c562ee7a89069f84377682f95da6?s=128&d=identicon&r=PG", "display_name": "David Little", "link": "https://stackoverflow.com/users/14365290/david-little"}, "is_accepted": false, "score": 0, "last_activity_date": 1601443868, "creation_date": 1601443868, "answer_id": 64131452, "question_id": 32093570, "link": "https://stackoverflow.com/questions/32093570/first-value-twice-when-using-unique-filtering-vba/64131452#64131452", "title": "First value twice when using unique filtering (VBA)", "body": "<p>I had the same issue with a script of mine, I resolved it with a .offset(1) to offset the extra row in rgData.</p>\n<pre><code>Sub modHouse_Popularity()\n'\n' modHouse_Popularity Macro\n' Select Houses and remove duplicates\n\n'define range\n    Dim rg As Range\n    Set rg = ThisWorkbook.Worksheets(&quot;Popularity&quot;).Range(&quot;A2:A500&quot;)\n\n 'retain header\n    rg.Offset(1).ClearContents\n    \n'define data fields, criteria fields and out put fields\n    Dim rgData As Range, rgCriteria As Range, rgOutput As Range\n    Set rgData = ThisWorkbook.Worksheets(&quot;Facade requests&quot;).Range(&quot;Table1[House]&quot;).Offset(1)\n    Set rgCriteria = ThisWorkbook.Worksheets(&quot;Popularity&quot;).Range(&quot;a2&quot;)\n    Set rgOutput = ThisWorkbook.Worksheets(&quot;Popularity&quot;).Range(&quot;a3:a500&quot;)\n'place data\n\n    rgData.AdvancedFilter xlFilterCopy, rgCriteria, rgOutput, True\n</code></pre>\n"}], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3985, "favorite_count": 0, "accepted_answer_id": 32094017, "answer_count": 2, "score": 2, "last_activity_date": 1601443868, "creation_date": 1439981849, "question_id": 32093570, "link": "https://stackoverflow.com/questions/32093570/first-value-twice-when-using-unique-filtering-vba", "title": "First value twice when using unique filtering (VBA)", "body": "<p>I have made a very simple Visual Basic script, which uses the advanced filter function in Excel, to copy unique values from a column in one sheet, to a column in a different sheet. It works fine on all values, except the first which appears twice. Can anyone tell me the reason for this glitch? I tried using the filter manually, with the same result.</p>\n\n<pre><code>Sub getUniqueRuns()\n\n    Sheets(2).Range(\"C2:C65536\").AdvancedFilter Action:=xlFilterCopy, \n    CopyToRange:=Sheets(5).Range(\"A2\"), Unique:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "find"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 3, "creation_date": 1439981289, "post_id": 32093186, "comment_id": 52081207, "body": "<code>br = ActiveCell.Row</code>, <code>Find</code> does not activate cells, so you should use <code>br = b1.Row</code>"}, {"owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1439986451, "post_id": 32093186, "comment_id": 52084827, "body": "Thanks a lot @user3964075 . It worked."}], "answers": [{"tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": false, "score": 1, "last_activity_date": 1439982059, "creation_date": 1439982059, "answer_id": 32093635, "question_id": 32093186, "link": "https://stackoverflow.com/questions/32093186/vba-find-function-finds-the-wrong-cell/32093635#32093635", "title": "VBA &quot;find&quot; function finds the wrong cell", "body": "<p>Add the activation if you are expecting the target cell to be active:  </p>\n\n<pre><code>If Not b1 Is Nothing Then\n    b1.activate\n    ...\n</code></pre>\n\n<p>Your code might continue to use <code>activecell</code> so this will fix it quickly.</p>\n"}, {"comments": [{"owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "edited": false, "score": 0, "creation_date": 1439988302, "post_id": 32093842, "comment_id": 52086198, "body": "Thanks for the tips. I was trying to prevent long variable names, and I was using mostly &quot;comments&quot; to explain the variables. But maybe it is more &quot;accepted&quot; to use clearer variable names."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "edited": false, "score": 1, "creation_date": 1439988948, "post_id": 32093842, "comment_id": 52086711, "body": "Yes, it is better for the variable names to be clear. For more guidance you can submit working code to the <a href=\"http://codereview.stackexchange.com/\">Code Review site</a> and ask for suggestions."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 1, "last_activity_date": 1439982639, "creation_date": 1439982639, "answer_id": 32093842, "question_id": 32093186, "link": "https://stackoverflow.com/questions/32093186/vba-find-function-finds-the-wrong-cell/32093842#32093842", "title": "VBA &quot;find&quot; function finds the wrong cell", "body": "<p>The <code>Find</code> method does not change the active cell. Your code is mostly correct, just need to get the row &amp; column from the <code>b1</code> range object:</p>\n\n<pre><code>Private Sub Button1_Click()\n\n    Dim b1 As Range\n    Dim bc As Integer, br As Integer\n\n    With Sheet5.Range(\"a1:z200\")\n    Set b1 = .Find(Name:=\"Country\", LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows)\n\n        If Not b1 Is Nothing Then\n            bc = b1.Column\n            br = b1.Row\n            MsgBox (bc)\n\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>BTW, you might want to think about using more meaningful variable names. In a month or so, the variable <code>b1</code> probably won't mean anything to you when you come back to the code...</p>\n"}], "owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1427, "favorite_count": 0, "accepted_answer_id": 32093842, "answer_count": 2, "score": 1, "last_activity_date": 1439982639, "creation_date": 1439980816, "question_id": 32093186, "link": "https://stackoverflow.com/questions/32093186/vba-find-function-finds-the-wrong-cell", "title": "VBA &quot;find&quot; function finds the wrong cell", "body": "<p>I wrote a VBA \"Sub\" which creates a button, and that button does several jobs (I wrote down the code only for the first job, the other jobs are not relevant).</p>\n\n<p>The first job is supposed to find the location of a cell which contains the string \"Country\". So it will find the cell which contains the string \"Country\", then it will find the column number (bc) and the row number (br) of this cell. </p>\n\n<p>The cell with the value \"Country\" is in the \"I7\" cell, or in numeric format Cells(7,9). It works without error, but I get different results like bc=7 and br=1 (\"G1\"). Interesting point is that the cell, \"G1\", is empty. </p>\n\n<p>Now it gives result like \"I4\", and it is also empty as you can see below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/p9mC6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p9mC6.png\" alt=\"The location of the target cell with the string &quot;Country&quot;\"></a></p>\n\n<p>Does anyone have any idea about the bug? </p>\n\n<pre><code>Private Sub Button1_Click()\n\n    Dim b1 As Range\n    Dim bc As Integer, br As Integer\n\n    With Sheet5.Range(\"a1:z200\")\n    Set b1 = .Find(Name:=\"Country\", LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows)\n\n        If Not b1 Is Nothing Then\n            bc = ActiveCell.Column\n            br = ActiveCell.Row\n            MsgBox (bc)\n\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "aspect-ratio"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5242819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d212cafb572cd9d75bc4a8c62d3d7f?s=128&d=identicon&r=PG&f=1", "display_name": "ANG", "link": "https://stackoverflow.com/users/5242819/ang"}, "edited": false, "score": 0, "creation_date": 1439982374, "post_id": 32093311, "comment_id": 52082001, "body": "Thank you! I have added  ActiveWindow.ScrollRow = 1 ActiveWindow.ScrollColumn = 1  To be on top of the page. The command for hide Ribbon is not working in my laptop."}, {"owner": {"reputation": 1, "user_id": 4576472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b32ea711c36aa62cd7ce52f0cfc8a17?s=128&d=identicon&r=PG&f=1", "display_name": "AlexHirst", "link": "https://stackoverflow.com/users/4576472/alexhirst"}, "reply_to_user": {"reputation": 1, "user_id": 5242819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d212cafb572cd9d75bc4a8c62d3d7f?s=128&d=identicon&r=PG&f=1", "display_name": "ANG", "link": "https://stackoverflow.com/users/5242819/ang"}, "edited": false, "score": 0, "creation_date": 1439982736, "post_id": 32093311, "comment_id": 52082227, "body": "replace the last if statement with, hopefully this should work!                             Application.ExecuteExcel4Macro &quot;SHOW.TOOLBAR(&quot;&quot;Ribbon&quot;&quot;,False)&quot;"}, {"owner": {"reputation": 1, "user_id": 5242819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d212cafb572cd9d75bc4a8c62d3d7f?s=128&d=identicon&r=PG&f=1", "display_name": "ANG", "link": "https://stackoverflow.com/users/5242819/ang"}, "edited": false, "score": 0, "creation_date": 1439983797, "post_id": 32093311, "comment_id": 52082963, "body": "That one hides everything.  I have used CommandBars.ExecuteMso &quot;MinimizeRibbon&quot;  and it works if used after Application.ScreenUpdating = True   Thanks for your help!"}], "tags": [], "owner": {"reputation": 1, "user_id": 4576472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b32ea711c36aa62cd7ce52f0cfc8a17?s=128&d=identicon&r=PG&f=1", "display_name": "AlexHirst", "link": "https://stackoverflow.com/users/4576472/alexhirst"}, "is_accepted": false, "score": 0, "last_activity_date": 1439981153, "creation_date": 1439981153, "answer_id": 32093311, "question_id": 32092541, "link": "https://stackoverflow.com/questions/32092541/how-to-lock-excel-aspect-visual-options/32093311#32093311", "title": "How to lock excel aspect/visual options", "body": "<p>I used this in the 'thisworkbook' excel object. The send keys worked but i would be careful as these are prone to errors.</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n\nIf ActiveSheet.Name = \"Sheet1\" Or ActiveSheet.Name = \"Sheet4\" Then\n    ActiveWindow.FreezePanes = False\n    ActiveWindow.Zoom = 90\nElseIf ActiveSheet.Name = \"Sheet2\" Or ActiveSheet.Name = \"Sheet3\" Then\n    Columns(\"d:d\").Select\n    ActiveWindow.FreezePanes = True\n    ActiveWindow.Zoom = 90\nEnd If\n\nApplication.DisplayFormulaBar = False\nActiveWindow.DisplayHeadings = False\n\nIf Application.CommandBars(\"Ribbon\").Height &gt;= 150 Then\n    SendKeys \"^{F1}\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4576472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b32ea711c36aa62cd7ce52f0cfc8a17?s=128&d=identicon&r=PG&f=1", "display_name": "AlexHirst", "link": "https://stackoverflow.com/users/4576472/alexhirst"}, "is_accepted": false, "score": 0, "last_activity_date": 1439982882, "creation_date": 1439982882, "answer_id": 32093931, "question_id": 32092541, "link": "https://stackoverflow.com/questions/32092541/how-to-lock-excel-aspect-visual-options/32093931#32093931", "title": "How to lock excel aspect/visual options", "body": "<p>Hopefully this will work, if not let me know!</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n\nIf ActiveSheet.Name = \"Sheet1\" Or ActiveSheet.Name = \"Sheet4\" Then\n    ActiveWindow.FreezePanes = False\n    ActiveWindow.Zoom = 90\nElseIf ActiveSheet.Name = \"Sheet2\" Or ActiveSheet.Name = \"Sheet3\" Then\n    Columns(\"d:d\").Select\n    ActiveWindow.FreezePanes = True\n    ActiveWindow.Zoom = 90\nEnd If\n\nApplication.DisplayFormulaBar = False\nActiveWindow.DisplayHeadings = False\nApplication.ExecuteExcel4Macro \"SHOW.TOOLBAR(\"\"Ribbon\"\",False)\"\nActiveWindow.ScrollRow = 1\nActiveWindow.ScrollColumn = 1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5242819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d212cafb572cd9d75bc4a8c62d3d7f?s=128&d=identicon&r=PG&f=1", "display_name": "ANG", "link": "https://stackoverflow.com/users/5242819/ang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468807065, "creation_date": 1439978986, "last_edit_date": 1468807065, "question_id": 32092541, "link": "https://stackoverflow.com/questions/32092541/how-to-lock-excel-aspect-visual-options", "title": "How to lock excel aspect/visual options", "body": "<p>I am trying to lock the aspect/visual options of an excel file, so when other people open it, it remains as I set and cannot change it.\nWhen I set the aspect options and other people open it in their PCs, all settings are gone.</p>\n\n<p>I would like to set the aspect as the following:</p>\n\n<ul>\n<li>Do not show formula bar</li>\n<li>Do not show headings</li>\n<li>Minimize the Ribbon</li>\n</ul>\n\n<p>Additionally I would like to lock specific settings for each sheet:</p>\n\n<p>Zoom:</p>\n\n<ul>\n<li>100% for sheet 1 and 4</li>\n<li>90% for sheet 2 and 3</li>\n</ul>\n\n<p>Freeze panes:</p>\n\n<ul>\n<li>Unfreeze for sheet 1 and 4</li>\n<li>Freeze the first 3 columns for sheet 2 and 3</li>\n</ul>\n\n<p>Is there anyway of doing this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1439979252, "post_id": 32092404, "comment_id": 52079856, "body": "Does the worksheet formula return 0? Note: not all that are blank to the naked eye are blank, e.g. nullstrings, &quot;;;;&quot; format numbers."}, {"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1439981643, "post_id": 32092404, "comment_id": 52081439, "body": "@user3819867 Ahh it&#39;s because column E has a formula in it, how can I skip over that specific column?"}], "answers": [{"comments": [{"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1440146964, "post_id": 32093808, "comment_id": 52162447, "body": "The top one works nicely but, isn&#39;t there a way to ignore the formula columns (to check the values of the range maybe?)"}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "reply_to_user": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1440160477, "post_id": 32093808, "comment_id": 52170330, "body": "-? Both subroutines skip over column E completely, as you&#39;ve required in your comment. The second code is only a variation where you can insert multiple, non-contiguous column ranges in a slightly better readable way. This way, you could even skip multiple (formula) columns."}], "tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": false, "score": 0, "last_activity_date": 1439984274, "last_edit_date": 1439984274, "creation_date": 1439982549, "answer_id": 32093808, "question_id": 32092404, "link": "https://stackoverflow.com/questions/32092404/empty-rows-not-showing-as-empty-rows-using-counta/32093808#32093808", "title": "Empty rows not showing as empty rows using CountA", "body": "<p>Just test both column ranges:  </p>\n\n<pre><code>Sub Test()\n    LastRow = 40\n\n    For i = LastRow To 3 Step -1\n        count = WorksheetFunction.CountA(Range(\"B\"&amp;i &amp; \":D\"&amp;i))\n        count = count + WorksheetFunction.CountA(Range(\"F\"&amp;i &amp; \":T\"&amp;i))    \n        If count = 0 Then\n            MsgBox \"Empty \" &amp; i\n        End If\n    Next\nEnd Sub  \n</code></pre>\n\n<p><strong>edit:</strong> or build a range object which contains the two column ranges, intersect that with the last row, and move this range object in the loop. This way, you don't build the range object anew in each iteration:  </p>\n\n<pre><code>Sub Test()\n    Dim rng As Range, colrng As Range\n    Dim LastRow As Long\n    Dim i As Long\n\n    LastRow = 40\n\n    Set colrng = Application.Union(Range(\"B:D\"), Range(\"F:T\"))\n    Set rng = Application.Intersect(colrng, Rows(LastRow))\n    For i = LastRow To 3 Step -1\n        If WorksheetFunction.CountA(rng) = 0 Then\n            MsgBox \"Empty row: \" &amp; i\n        End If\n        Set rng = rng.Offset(-1, 0)\n    Next\nEnd Sub\n</code></pre>\n\n<p>As good practice, always declare your variables, and use <code>long</code> integers for row or column indices.</p>\n"}, {"comments": [{"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 1, "creation_date": 1440146909, "post_id": 32094524, "comment_id": 52162420, "body": "That doesn&#39;t seem to work at all because I have a formula in one of the columns, I want it to ignore the formulas."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1440278329, "post_id": 32094524, "comment_id": 52209296, "body": "Sorry, I messed up big time... It&#39;s <code>If WorksheetFunction.CountIf(myRange,&quot;&quot;) - myRange.Cells.Count = 0</code>. you count all that&#39;s empty (or null), that&#39;s easily doable and then substract the cell count. If the cell count is greater than the number of non-blank cells, then there must be something in there. I see you&#39;ve already found an answer but seek to learn more, kudos to that."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1439984501, "creation_date": 1439984501, "answer_id": 32094524, "question_id": 32092404, "link": "https://stackoverflow.com/questions/32092404/empty-rows-not-showing-as-empty-rows-using-counta/32094524#32094524", "title": "Empty rows not showing as empty rows using CountA", "body": "<pre><code>Sub Test()\nLastRow = 40\n\nFor i = LastRow To 3 Step -1\n    Set myRange = Range(\"B\" &amp; i &amp; \":T\" &amp; i)\n    If WorksheetFunction.CountIf(myRange,\"&lt;&gt;\") = 0 Then 'count where it's not a null or empty string\n        MsgBox \"Empty \" &amp; Cells(i, 1).Row\n    Else\n        x = x\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "is_accepted": true, "score": 0, "last_activity_date": 1440148430, "creation_date": 1440148430, "answer_id": 32136660, "question_id": 32092404, "link": "https://stackoverflow.com/questions/32092404/empty-rows-not-showing-as-empty-rows-using-counta/32136660#32136660", "title": "Empty rows not showing as empty rows using CountA", "body": "<p>The only way I can seem to do it is a slow way:</p>\n\n<pre><code>LastRow = Range(\"B:Z\").Find(What:=\"*\", LookIn:=xlValues, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nLastColumn = Cells.Find(What:=\"*\", LookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n\nFor i = LastRow To 3 Step -1\n    BlankRow = False\n    For j = 2 To LastColumn\n        If Cells(i, j).Value &lt;&gt; \"\" Then\n            Blank = False\n            Exit For\n        End If\n        BlankRow = True\n    Next j\n    If BlankRow = True Then\n        x = x\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 32136660, "answer_count": 3, "score": 0, "last_activity_date": 1440148430, "creation_date": 1439978613, "last_edit_date": 1531164843, "question_id": 32092404, "link": "https://stackoverflow.com/questions/32092404/empty-rows-not-showing-as-empty-rows-using-counta", "title": "Empty rows not showing as empty rows using CountA", "body": "<p>Why does the following VBA script not show any message boxes when row 4, 5 and 6 are all empty...</p>\n\n<pre><code>Sub Test()\nLastRow = 40\n\nFor i = LastRow To 3 Step -1\n    Set myRange = Range(\"B\" &amp; i &amp; \":T\" &amp; i)\n    If WorksheetFunction.CountA(myRange) = 0 Then\n        MsgBox \"Empty \" &amp; Cells(i, 1).Row\n    Else\n        x = x\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 4, "last_activity_date": 1439979978, "creation_date": 1439979978, "answer_id": 32092868, "question_id": 32092387, "link": "https://stackoverflow.com/questions/32092387/how-to-check-the-name-of-picture-inside-the-cell/32092868#32092868", "title": "How to Check the Name of Picture Inside the Cell?", "body": "<p>Pictures aren't reall in cells, they are in the drawing layer above the worksheet. It's easier to just loop through the pictures and put the names in the relevant column based on the cell under the top left corner of the picture:</p>\n\n<pre><code>Sub CheckImageName()\n    Dim pic                   As Excel.Picture\n\n    For Each pic In ActiveSheet.Pictures\n\n        pic.TopLeftCell.Offset(, 2).Value2 = pic.Name\n    Next pic\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1440213404, "post_id": 32093117, "comment_id": 52192854, "body": "Thanks @StefanMichev. Problem Solved."}], "tags": [], "owner": {"reputation": 3908, "user_id": 754571, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bd9b8d657f4faa38458464de7dbbcab7?s=128&d=identicon&r=PG", "display_name": "Stefan Michev", "link": "https://stackoverflow.com/users/754571/stefan-michev"}, "is_accepted": true, "score": 4, "last_activity_date": 1439980683, "creation_date": 1439980683, "answer_id": 32093117, "question_id": 32092387, "link": "https://stackoverflow.com/questions/32092387/how-to-check-the-name-of-picture-inside-the-cell/32093117#32093117", "title": "How to Check the Name of Picture Inside the Cell?", "body": "<p>Images in Excel can be obsereved as shapes. If they are named correctly(with real filename) on insert then you can iterate through them like this </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim doc As Worksheet\nDim spe As Shape\n\nSet doc = Worksheets(1)\n\nFor i = 1 To doc.Shapes.Count - 1\n    Set spe = doc.Shapes(i)\n\n    'for named images\n    Debug.Print doc.Shapes(i).Name\n\n    spe.Select\n\n    'for linked images\n    Debug.Print GetSourceInfo(spe)\nNext\n\nEnd Sub\n\nFunction GetSourceInfo(oShp As Shape) As String\n    On Error GoTo Error_GetSourceInfo\n    GetSourceInfo = oShp.LinkFormat.SourceFullName\n    Exit Function\nError_GetSourceInfo:\n   GetSourceInfo = \"\"\nEnd Function\n</code></pre>\n\n<p>Which in my case shows the excel generated imagenames:</p>\n\n<ul>\n<li>Picture 1 </li>\n<li>Picture 2 </li>\n<li>Picture 3</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9406504, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215667473708789/picture?type=large", "display_name": "Felix S", "link": "https://stackoverflow.com/users/9406504/felix-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1519494570, "creation_date": 1519494570, "answer_id": 48965840, "question_id": 32092387, "link": "https://stackoverflow.com/questions/32092387/how-to-check-the-name-of-picture-inside-the-cell/48965840#48965840", "title": "How to Check the Name of Picture Inside the Cell?", "body": "<p>First of all I have to clarify that in my world I do what ever it takes to make things work, so here is my low level approach to getting an objects name.</p>\n\n<p>Record a macro, copy and paste the object anywhere, stop recording. delete the pasted object. View the code for the macro you just created and in the vba you will see the object's name. Delete the macro.</p>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17970, "favorite_count": 1, "accepted_answer_id": 32093117, "answer_count": 3, "score": 1, "last_activity_date": 1580134110, "creation_date": 1439978578, "last_edit_date": 1580134110, "question_id": 32092387, "link": "https://stackoverflow.com/questions/32092387/how-to-check-the-name-of-picture-inside-the-cell", "title": "How to Check the Name of Picture Inside the Cell?", "body": "<p>I want to check the name of the picture in a cell, then put a value on the next column based on the name of the picture.</p>\n\n<p>My program only checks if the name of the picture exists in the activesheet. </p>\n\n<pre><code>Sub CheckImageName()\n    Dim iRowCountShapes As Integer\n    Dim sFindShape As String\n\n    iRowCountShapes = 2\n\n    While Sheets(\"Data\").Cells(iRowCountShapes, 1) &lt;&gt; \"\"\n\n        If Sheets(\"Data\").Shapes(\"Rock\").Name = \"Rock\" Then\n\n            Sheets(\"Data\").Cells(iRowCountShapes, 3) = \"Rock\"\n\n        ElseIf Sheets(\"Data\").Shapes(\"Roll\").Name = \"Roll\" Then\n\n            Sheets(\"Data\").Cells(iRowCountShapes, 3) = \"Roll\"\n\n        Else\n\n            Sheets(\"Data\").Cells(iRowCountShapes, 3) = \"Neither\"\n\n        End If\n\n        iRowCountShapes = iRowCountShapes + 1\n\n    Wend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "nodes"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 3085135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80325a965eb5fd1a85ed0cd3a74bc20d?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.ke", "link": "https://stackoverflow.com/users/3085135/mr-ke"}, "is_accepted": false, "score": 0, "last_activity_date": 1439990384, "last_edit_date": 1439990384, "creation_date": 1439990071, "answer_id": 32096560, "question_id": 32092280, "link": "https://stackoverflow.com/questions/32092280/import-xml-via-vba-access-attribute/32096560#32096560", "title": "Import XML via VBA, access attribute", "body": "<p><em>You could not directly print object,but could print its child text string\n instead.</em></p>\n\n<p><em>Seems your XML is not an complete one but part of it,right?I only use one node as root node for the example.</em></p>\n\n<pre><code>Set Nodes = xmlDoc.SelectNodes(\"//User\")\nFor Each Node In Nodes\n    For i = 0 To Node.childNodes.Length - 1\n        ' Print Attribute Name\n        Debug.Print Node.childNodes(i).Attributes(0).Text\n        ' Print Attribute Value\n        Debug.Print Node.childNodes(i).Attributes(1).Text\n    Next i\nNext Node\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5242784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e868db0a448f9b83e66f9430f3bc0061?s=128&d=identicon&r=PG&f=1", "display_name": "Coffeecup110", "link": "https://stackoverflow.com/users/5242784/coffeecup110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439990384, "creation_date": 1439978285, "question_id": 32092280, "link": "https://stackoverflow.com/questions/32092280/import-xml-via-vba-access-attribute", "title": "Import XML via VBA, access attribute", "body": "<p>XML sample:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;User id='user1'&gt;\r\n\t&lt;Attribute name='firstname' value='Testname'/&gt;\r\n\t&lt;Attribute name='lastname' value='Testname'/&gt;\r\n\t&lt;Attribute name='id' value='userid'/&gt;\r\n&lt;/User&gt;\r\n&lt;User id='user2'&gt;\r\n\t&lt;Attribute name='firstname' value='Testname'/&gt;\r\n\t&lt;Attribute name='lastname' value='Testname'/&gt;\r\n\t&lt;Attribute name='id' value='userid'/&gt;\r\n&lt;/User&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I want to extract the firstname, lastname, id of the current user via VBA.</p>\n\n<p>VBA snippet:</p>\n\n<pre><code>Dim xmlDoc As MSXML2.DOMDocument\nDim xmlElement As MSXML2.IXMLDOMElement\nDim xmlSelection As MSXML2.IXMLDOMSelection\n\nSet xmlDoc = New MSXML2.DOMDocument\nxmlDoc.async = False\nxmlDoc.Load strUrl\n\nSet xmlSelection = xmlDoc.SelectNodes(\"PATH TO XML\")\n\nFor Each xmlElement In xmlSelection\n    Debug.Print xmlElement.getAttribute(\"name\")\n    &gt;&gt;&gt; how do I debug print the attributes firstname, lastname, name?! I need the values &lt;&lt;&lt;\n\nNext xmlElement\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 163, "user_id": 5234882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146adee9deef4f890991e541ed0c5892?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/5234882/dan"}, "edited": false, "score": 0, "creation_date": 1439978423, "post_id": 32092230, "comment_id": 52079292, "body": "What is the criteria to know that you have reached the last date you want to manage ? Is it the last one in the data set for each ID ? is it todays&#39; date ?"}, {"owner": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "reply_to_user": {"reputation": 163, "user_id": 5234882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146adee9deef4f890991e541ed0c5892?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/5234882/dan"}, "edited": false, "score": 0, "creation_date": 1439980346, "post_id": 32092230, "comment_id": 52080545, "body": "Today&#39;s Date, which will carry the last action to the point (today). Thanks"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1439983089, "post_id": 32092230, "comment_id": 52082482, "body": "Please add more explanation to your question - describe what you want the code to do."}, {"owner": {"reputation": 163, "user_id": 5234882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146adee9deef4f890991e541ed0c5892?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/5234882/dan"}, "edited": false, "score": 1, "creation_date": 1439984614, "post_id": 32092230, "comment_id": 52083510, "body": "Have you tried to program something already or do you expect someone to just write the code for you ?"}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 5228878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BtIFL.jpg?s=128&g=1", "display_name": "Phil192", "link": "https://stackoverflow.com/users/5228878/phil192"}, "reply_to_user": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "edited": false, "score": 0, "creation_date": 1439992146, "post_id": 32094964, "comment_id": 52089271, "body": "You&#39;re welcome. The source list needs to be sorted in ascending date order for it to work correctly."}], "tags": [], "owner": {"reputation": 116, "user_id": 5228878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BtIFL.jpg?s=128&g=1", "display_name": "Phil192", "link": "https://stackoverflow.com/users/5228878/phil192"}, "is_accepted": true, "score": 1, "last_activity_date": 1439985707, "creation_date": 1439985707, "answer_id": 32094964, "question_id": 32092230, "link": "https://stackoverflow.com/questions/32092230/excel-vba-given-a-start-and-end-date-create-an-array-of-the-dates-between-the/32094964#32094964", "title": "Excel- VBA: Given a start and end date, create an array of the dates between the two", "body": "<p>Something like this should do the trick. You will need to modify the sheet references and columns depending on where the data is. The expanded data will now list in the second sheet.</p>\n\n<pre><code>Sub ExpandData()\n\nDim SourceRow, TargetRow As Long\nDim LastDate, NextDate As Date\nDim DateDiff, FillDate As Integer\nSourceRow = 2\nTargetRow = 2\n\n'Loop through source rows\nDo While Sheets(1).Range(\"A\" &amp; CStr(SourceRow)).Value &lt;&gt; \"\"\n    LastDate = Sheets(1).Range(\"B\" &amp; CStr(SourceRow)).Value\n    ' Check for the last row of data and use todays date if last row\n    If Sheets(1).Range(\"B\" &amp; CStr(SourceRow + 1)).Value &lt;&gt; \"\" Then\n        NextDate = Sheets(1).Range(\"B\" &amp; CStr(SourceRow + 1)).Value\n    Else\n        NextDate = Date\n    End If\n    DateDiff = NextDate - LastDate\n    ' create a row in the target sheet for each date in between those in the source sheet\n    For FillDate = 0 To DateDiff - 1\n        Sheets(2).Range(\"A\" &amp; CStr(TargetRow)).Value = Sheets(1).Range(\"A\" &amp; CStr(SourceRow)).Value\n        Sheets(2).Range(\"B\" &amp; CStr(TargetRow)).Value = LastDate + FillDate\n        Sheets(2).Range(\"C\" &amp; CStr(TargetRow)).Value = Sheets(1).Range(\"C\" &amp; CStr(SourceRow)).Value\n        TargetRow = TargetRow + 1\n    Next FillDate\n\n    SourceRow = SourceRow + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1439987715, "creation_date": 1439987715, "answer_id": 32095686, "question_id": 32092230, "link": "https://stackoverflow.com/questions/32092230/excel-vba-given-a-start-and-end-date-create-an-array-of-the-dates-between-the/32095686#32095686", "title": "Excel- VBA: Given a start and end date, create an array of the dates between the two", "body": "<p>try this:</p>\n\n<pre><code>Option Compare Text\nSub test()\n    Dim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Dic.CompareMode = vbTextCompare\n    Dim cl As Range, i&amp;, z&amp;, x&amp;, key As Variant\n    i = Cells(Rows.Count, \"A\").End(xlUp).Row\n    z = 1\n    For Each cl In Range(\"A2:A\" &amp; i)\n    x = 1\n    If cl = cl.Offset(1, 0) And _\n        Trim(cl.Offset(, 2)) &lt;&gt; Trim(cl.Offset(1, 2)) Then\n            Dic.Add z, cl &amp; \"|\" &amp; cl.Offset(, 1) &amp; \"|\" &amp; cl.Offset(, 2)\n            While cl.Offset(, 1) + x &lt; cl.Offset(1, 1)\n                z = z + 1\n                Dic.Add z, cl &amp; \"|\" &amp; cl.Offset(, 1) + x &amp; \"|\" &amp; cl.Offset(, 2)\n                x = x + 1\n            Wend\n    Else\n        Dic.Add z, cl &amp; \"|\" &amp; cl.Offset(, 1) &amp; \"|\" &amp; cl.Offset(, 2)\n    End If\n    z = z + 1\n    Next cl\n    Workbooks.Add\n    x = 2: [A1] = \"ID\": [B1] = \"Trans_Date\": [C1] = \"Action\"\n    For Each key In Dic\n        Range(Cells(x, \"A\"), Cells(x, \"C\")) = Split(Dic(key), \"|\")\n        x = x + 1\n    Next key\n    Columns(\"A:C\").AutoFit\nEnd Sub\n</code></pre>\n\n<p><strong>source</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Iqwo4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iqwo4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>output result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/lUrRx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lUrRx.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1254, "favorite_count": 1, "accepted_answer_id": 32094964, "answer_count": 2, "score": 0, "last_activity_date": 1439987715, "creation_date": 1439978138, "last_edit_date": 1531164843, "question_id": 32092230, "link": "https://stackoverflow.com/questions/32092230/excel-vba-given-a-start-and-end-date-create-an-array-of-the-dates-between-the", "title": "Excel- VBA: Given a start and end date, create an array of the dates between the two", "body": "<p>I need an <strong>Excel-VBA</strong> Solution for below mentioned Issue. The solution I am working with is perfect but very slow and nearly kills my PC for IDs more than 500. (and I have 10000+ IDs to process.)</p>\n\n<p>I have Start Date and end date for some IDs,</p>\n\n<p><strong>Data Set 1</strong></p>\n\n<pre><code>ID          Trans_Date     Action\n1234567890  01-Jan-2012    Active\n1234567890  05-Jan-2012    Dc\n1234567890  06-Jan-2012    Active\n1234567890  12-Jan-2012     Dc\n1234567890  15-Jan-2012    Active\n</code></pre>\n\n<p>I need to expand the set as below,</p>\n\n<p><strong>Required data set,</strong></p>\n\n<pre><code>ID          Trans_Date  Action\n1234567890  01-Jan-12   Active\n1234567890  02-Jan-12   Active\n1234567890  03-Jan-12   Active\n1234567890  04-Jan-12   Active\n1234567890  05-Jan-12   DC\n1234567890  06-Jan-12   Active\n1234567890  07-Jan-12   Active\n1234567890  08-Jan-12   Active\n1234567890  09-Jan-12   Active\n1234567890  10-Jan-12   Active\n1234567890  11-Jan-12   Active\n1234567890  12-Jan-12   DC\n1234567890  13-Jan-12   DC\n1234567890  14-Jan-12   DC\n1234567890  15-Jan-12   Active\n</code></pre>\n\n<p>Currently I\u2019m using the formula given below.</p>\n\n<p>(Thanks to <a href=\"https://stackoverflow.com/users/3894917/tom-sharpe\"><strong>Tom Sharpe</strong></a>)</p>\n\n<pre><code>1) Copy the first ID number into D2\n\n(2) Put this formula in D3\n\n=IF(COUNTIF(D$1:D2,D2)&lt;(MAX(IF(A$2:A$20=D2,B$2:B$20))-MIN(IF(A$2:A$20=D2,B$2:B$20))+1),\n   D2,\n   INDEX($A$2:$A$20, MATCH(0, COUNTIF($D$1:D2, $A$2:$A$20), 0)))\n(3) Put this formula in E2:-\n\n=MIN(IF(A$2:A$20=D2,B$2:B$20))+COUNTIF(D$1:D1,D2)\n(4) Put this formula in F2:-\n\n=INDEX(C$2:C$20,MATCH(E2,IF(A$2:A$20=D2,B$2:B$20),1))\nAll these are array formulae and must be entered with CtrlShiftEnter\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/07aps.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/07aps.png\" alt=\"enter image description here\"></a></p>\n\n<p>But even he is suggesting to use VBA. How to do it in VBA ?</p>\n\n<p>Can you help me? </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1439977952, "post_id": 32091933, "comment_id": 52078929, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/8875567/vba-excel-add-one-second-to-a-time\">VBA Excel: Add one second to a time</a>"}, {"owner": {"reputation": 547, "user_id": 5138682, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/350bb44d6ec3fd33649b91b380a373ce?s=128&d=identicon&r=PG&f=1", "display_name": "F1990", "link": "https://stackoverflow.com/users/5138682/f1990"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1439978276, "post_id": 32091933, "comment_id": 52079180, "body": "Tried to use Date - TIME(0;0;CELL) = , but this results also in the #VALUE! error"}], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 5138682, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/350bb44d6ec3fd33649b91b380a373ce?s=128&d=identicon&r=PG&f=1", "display_name": "F1990", "link": "https://stackoverflow.com/users/5138682/f1990"}, "edited": false, "score": 0, "creation_date": 1439978225, "post_id": 32092222, "comment_id": 52079148, "body": "Tried this but didn&#39;t work. I still get the #Value! error in the cell"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 547, "user_id": 5138682, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/350bb44d6ec3fd33649b91b380a373ce?s=128&d=identicon&r=PG&f=1", "display_name": "F1990", "link": "https://stackoverflow.com/users/5138682/f1990"}, "edited": false, "score": 0, "creation_date": 1439978308, "post_id": 32092222, "comment_id": 52079205, "body": "that means that your A1 may not be a date but a text ... try to change the format of this cell to <b>general</b> or <b>number</b> ... is it numeric then? (I trust your seconds - A2 - are numeric anyway)"}, {"owner": {"reputation": 547, "user_id": 5138682, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/350bb44d6ec3fd33649b91b380a373ce?s=128&d=identicon&r=PG&f=1", "display_name": "F1990", "link": "https://stackoverflow.com/users/5138682/f1990"}, "edited": false, "score": 0, "creation_date": 1439978360, "post_id": 32092222, "comment_id": 52079245, "body": "It is a general format, if I change it to number it remains the same"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 547, "user_id": 5138682, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/350bb44d6ec3fd33649b91b380a373ce?s=128&d=identicon&r=PG&f=1", "display_name": "F1990", "link": "https://stackoverflow.com/users/5138682/f1990"}, "edited": false, "score": 0, "creation_date": 1439978620, "post_id": 32092222, "comment_id": 52079438, "body": "aha !!! so you must bring A1 into a <b>date</b> format ... probably by <code>=DATEVALUE(text)</code> or <code>=DATE(y,m,d) + TIME(h,m,s)</code> ... in the 2nd case you may need to extract portions of your string using the <code>=MID(...)</code> function"}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": true, "score": 2, "last_activity_date": 1439978107, "creation_date": 1439978107, "answer_id": 32092222, "question_id": 32091933, "link": "https://stackoverflow.com/questions/32091933/subtract-seconds-from-date-vba/32092222#32092222", "title": "Subtract seconds from date VBA", "body": "<p>date in A1, # of seconds in A2</p>\n\n<pre><code>=A1-A2/86400\n</code></pre>\n\n<p>86400 being 24*60*60 to convert seconds into decimals</p>\n"}], "owner": {"reputation": 547, "user_id": 5138682, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/350bb44d6ec3fd33649b91b380a373ce?s=128&d=identicon&r=PG&f=1", "display_name": "F1990", "link": "https://stackoverflow.com/users/5138682/f1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 1, "accepted_answer_id": 32092222, "answer_count": 1, "score": 1, "last_activity_date": 1439978107, "creation_date": 1439977431, "question_id": 32091933, "link": "https://stackoverflow.com/questions/32091933/subtract-seconds-from-date-vba", "title": "Subtract seconds from date VBA", "body": "<p>I would like to subtract a number of seconds from a date. I have two columns one that lists the date in the format D/M/YY HH:MM AM/PM and the other lists a number seconds. I want to do: </p>\n\n<pre><code>07/28/15 12:08 AM - 60 = 07/28/15 12:07 AM\n</code></pre>\n\n<p>However if I subtract the two columns I get no value. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4131172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52a8bfb1d8feddbb4ddaa593f7bde2e?s=128&d=identicon&r=PG&f=1", "display_name": "AK47onYou", "link": "https://stackoverflow.com/users/4131172/ak47onyou"}, "edited": false, "score": 0, "creation_date": 1455391440, "post_id": 32093066, "comment_id": 58473066, "body": "Actually, unfortunately I am still confused! I managed of course to open the Editor but I have no idea how to save the code as a Macro that can appear in a special menu I have in my Excel (called My Custom Tools ... I have another two macros in that menu which someone created for me years ago). Can someone please help?"}], "tags": [], "owner": {"reputation": 341, "user_id": 5023744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb6a7bb1753d5cfa94ab260807ff68ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitish", "link": "https://stackoverflow.com/users/5023744/nitish"}, "is_accepted": false, "score": 0, "last_activity_date": 1439980505, "creation_date": 1439980505, "answer_id": 32093066, "question_id": 32091900, "link": "https://stackoverflow.com/questions/32091900/excel-delete-rows-from-sheet-1-based-on-values-from-sheet-2/32093066#32093066", "title": "Excel - Delete Rows From Sheet 1 Based on Values From Sheet 2", "body": "<p>the above code is work fine for your requirement. But you need to change small part according to your scenario your phone no is in column B in sheet1 so you need to change bellow part<br>\n<code>Set rng1 = .Range(\"B2:B\" &amp; lastRow)</code></p>\n\n<p>you have to paste the code in Visual basic editor to open in mac please refer this link <a href=\"http://www.techonthenet.com/excel/macros/visual_basic_editor2011.php\" rel=\"nofollow\">Click here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 4131172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52a8bfb1d8feddbb4ddaa593f7bde2e?s=128&d=identicon&r=PG&f=1", "display_name": "AK47onYou", "link": "https://stackoverflow.com/users/4131172/ak47onyou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1769, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439980505, "creation_date": 1439977351, "question_id": 32091900, "link": "https://stackoverflow.com/questions/32091900/excel-delete-rows-from-sheet-1-based-on-values-from-sheet-2", "title": "Excel - Delete Rows From Sheet 1 Based on Values From Sheet 2", "body": "<p><strong>Scenario:</strong></p>\n\n<p>Sheet 1 \"Client Records\" contains client details for c. 4000 clients in rows, (i.e. name, telephone number, email, address), one client per row.</p>\n\n<p>Sheet 2 \"Invalid Numbers\" contains just one column, which is a list of telephone numbers which are now known to be Invalid and no longer working.</p>\n\n<p><strong>Requirement:</strong></p>\n\n<p>Automatically go through Sheet 1 and (completely) delete any client record (i.e. row) which contains a telephone number (i.e. in column 2) which matches any of the telephone numbers listed in Sheet 2 \"Invalid Numbers\"</p>\n\n<p><strong>Result:</strong></p>\n\n<p>Sheet 1 will be a list of Client Records having deleted all the records that had Invalid numbers in them.</p>\n\n<p>I found the following code on StackOverflow but the problem is that I have no idea how to program it in or use it?! I am using Excel for Mac 2011.</p>\n\n<pre><code>Public Sub delete_selected_rows()\n    Dim rng1 As Range, rng2 As Range, rngToDel As Range, c As Range\n    Dim lastRow as Long\n\n    With Worksheets(\"Sheet1\")\n        lastRow = .Cells(.Rows.Count,\"A\").End(xlUp).Row  \n        Set rng1 = .Range(\"A1:A\" &amp; lastRow)\n    End With\n\n    Set rng2 = Worksheets(\"Sheet2\").Range(\"A:A\")\n\n    For Each c In rng1\n        If Not IsError(Application.Match(c.Value, rng2, 0)) Then\n            'if value from rng1 is found in rng2 then remember this cell for deleting\n            If rngToDel Is Nothing Then\n                Set rngToDel = c\n            Else\n                Set rngToDel = Union(rngToDel, c)\n            End If\n        End If\n    Next c\n\n    If Not rngToDel Is Nothing Then rngToDel.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>Could anyone show me how to do this or if above code is correct for my job, how to actually input it into Excel and run it? I'm simply starting with the workbook open and the two sheets sitting there!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 1, "user_id": 10186429, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154515065231537/picture?type=large", "display_name": "MountainFish", "link": "https://stackoverflow.com/users/10186429/mountainfish"}, "edited": false, "score": 0, "creation_date": 1533556378, "post_id": 32091847, "comment_id": 90385436, "body": "I used Ron De Bruin&#39;s function and made the swap suggested by Kemo and it worked all except for providing the cell widths. upon adding the following I got it looking in an email exactly as I wanted it: .Cells(1).PasteSpecial Paste:=xlPasteColumnWidths"}], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1439984799, "post_id": 32094295, "comment_id": 52083621, "body": "this is what I used for the code, it don&#39;t think it shows how to keep the formats"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 1, "last_activity_date": 1439985357, "last_edit_date": 1439985357, "creation_date": 1439983909, "answer_id": 32094295, "question_id": 32091847, "link": "https://stackoverflow.com/questions/32091847/vba-copy-and-paste-cells-in-a-email-without-losing-formatting/32094295#32094295", "title": "VBA: Copy and paste cells in a email without losing formatting", "body": "<p>The <code>RangetoHTML</code> function on <a href=\"http://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow\">Ron de Bruin's site</a> has always worked fine for me.</p>\n\n<p>Have you checked the <code>BodyFormat</code> property of the email? It might be defaulting to Rich Text.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9395840, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d22a0fa22e27f9b591bab73e1330a851?s=128&d=identicon&r=PG", "display_name": "Suraj Kakwani", "link": "https://stackoverflow.com/users/9395840/suraj-kakwani"}, "is_accepted": false, "score": 0, "last_activity_date": 1519299710, "last_edit_date": 1519299710, "creation_date": 1519296625, "answer_id": 48925527, "question_id": 32091847, "link": "https://stackoverflow.com/questions/32091847/vba-copy-and-paste-cells-in-a-email-without-losing-formatting/48925527#48925527", "title": "VBA: Copy and paste cells in a email without losing formatting", "body": "<p>Replace this line:     </p>\n\n<pre><code>.Cells(1).PasteSpecial Paste:=8 \n</code></pre>\n\n<p>with:</p>\n\n<pre><code>.Cells(1).PasteSpecial Paste:=1\n</code></pre>\n\n<p>&amp; delete these following 2 lines: </p>\n\n<pre><code>.Cells(1).PasteSpecial xlPasteValues, , False, False\n.Cells(1).PasteSpecial xlPasteFormats, , False, False\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5724, "favorite_count": 0, "accepted_answer_id": 32094295, "answer_count": 2, "score": 1, "last_activity_date": 1533556378, "creation_date": 1439977218, "question_id": 32091847, "link": "https://stackoverflow.com/questions/32091847/vba-copy-and-paste-cells-in-a-email-without-losing-formatting", "title": "VBA: Copy and paste cells in a email without losing formatting", "body": "<p>I want to be able to send out an email that contains cells from an Excel spreadsheet. Currently I have the following code that inserts the range I want into the email but the problem I am having is that it removes most of the formatting, e.g. the font changes and some of the conditional formatting is removed.</p>\n\n<pre><code>Sub EmailExtract()\n\nDim objOutlook As Object\nDim objMail As Object\nDim TempFilePath As String\nDim Location As String\nDim Individual As String\nDim rng As Range\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\nWorksheets(\"Contacts\").Activate\nRange(\"A2\").Select\nWhile ActiveCell &lt;&gt; \"\"\n\n    ActiveCell.Offset(1, 0).Select\n    Location = ActiveCell.Address\n    Individual = ActiveCell.Value\n    Worksheets(\"Individual Output 2\").Activate\n    Range(\"C2\").Value = Individual\n\n    Set rng = ActiveSheet.Range(\"A1:M28\").Rows.SpecialCells(xlCellTypeVisible)\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n\n\n    With objMail\n            .To = \"joe.bloggs@hotmail.com\"\n            .Subject = \"\"\n\n            Dim Greeting As String\n            If Time &gt;= #12:00:00 PM# Then\n                Greeting = \"Afternoon ,\"\n            Else\n                Greeting = \"Morning,\"\n            End If\n\n\n\n            .HTMLBODY = \"&lt;font face=Arial&gt;&lt;p&gt;\" &amp; \"Good \" + Greeting + \"&lt;/p&gt;\"\n            .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Please find below your \" &amp; MonthName((Month(Date)) - 1) &amp; \" Information.\" &amp; \"&lt;/p&gt;\"\n            .HTMLBODY = .HTMLBODY + RangetoHTML(rng)\n            .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Kind Regards\" &amp; \"&lt;/p&gt;\"\n            .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Joe Bloggs\" &amp; \"&lt;/p&gt;&lt;/font&gt;\"\n            .Display\n    End With\n    Worksheets(\"Contacts\").Activate\nWend\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.ReadAll\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n\n<p>What I want is to be able to email an extract with the formatting applied, is it possible to do this? Maybe by pasting it as a picture into the email?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1439976222, "post_id": 32091295, "comment_id": 52077655, "body": "<code>R0C1</code> is incorrect absolute reference (zeroth row) (<code>$A$0</code>)."}, {"owner": {"reputation": 1, "user_id": 5242573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e7a2f7d33d8e17508654a5ab6be12bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias H", "link": "https://stackoverflow.com/users/5242573/tobias-h"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1439977085, "post_id": 32091295, "comment_id": 52078325, "body": "Ah.. got it! I have corrected it to R13C9..  Now it is working fine! Thank you very much!!!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5242573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e7a2f7d33d8e17508654a5ab6be12bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias H", "link": "https://stackoverflow.com/users/5242573/tobias-h"}, "edited": false, "score": 0, "creation_date": 1439977217, "post_id": 32091538, "comment_id": 52078416, "body": "yes, thank you very much! I have corrected it to R13C9  - the cell I actually wanted to point to. I guess i was code-blind  ;-)"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1439976358, "creation_date": 1439976358, "answer_id": 32091538, "question_id": 32091295, "link": "https://stackoverflow.com/questions/32091295/vba-formular1c1-rc-expression-is-not-working-when-used-with-division/32091538#32091538", "title": "VBA FormulaR1C1 RC expression is not working when used with division", "body": "<p>Your problem is the zero in your formula - when using absolute reference (i.e. omitting brackets) in <code>R1C1</code>-notation, you count from an imaginary cell one up and one left of <code>A1</code> - in other words, cell <code>A1</code> is <code>R1C1</code> in that notation, <code>B2</code> is <code>R2C2</code>, etc.</p>\n\n<p>And <code>R0C1</code> does not exist, thus why it is interpreted as a string in your formula.</p>\n"}], "owner": {"reputation": 1, "user_id": 5242573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e7a2f7d33d8e17508654a5ab6be12bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias H", "link": "https://stackoverflow.com/users/5242573/tobias-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 902, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439976358, "creation_date": 1439975723, "question_id": 32091295, "link": "https://stackoverflow.com/questions/32091295/vba-formular1c1-rc-expression-is-not-working-when-used-with-division", "title": "VBA FormulaR1C1 RC expression is not working when used with division", "body": "<p>I am new to vba. I try to put a formula into a range which works well, but the formula is troubling me. I feel the issue might be because of the division.. maybe the slash is a kind of escaping character?</p>\n\n<p>Here the code:</p>\n\n<pre><code>MyWorksheet.Range(\"J7\",\"J12\").FormulaR1C1 = \"=R[0]C[-1]/R0C1 *100\"\n</code></pre>\n\n<p>and it gives me this in excel:</p>\n\n<pre><code>=I7/R0C1 *100\n</code></pre>\n\n<p>So R0C1 is not replaced :-(. How comes? and how can I fix this?\nI have goggled a lot but I did not find anything similar.. so hopefully I am not the only one with this issue.</p>\n\n<p>Any help is highly appreciated!</p>\n\n<p>Best regards,\nTobias</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5216229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7acababf21e08e55171955b2f584d9cf?s=128&d=identicon&r=PG&f=1", "display_name": "onok", "link": "https://stackoverflow.com/users/5216229/onok"}, "edited": false, "score": 0, "creation_date": 1439985668, "post_id": 32094378, "comment_id": 52084236, "body": "nice idea. how do i limit solver to an integer only answer?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 33, "user_id": 5216229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7acababf21e08e55171955b2f584d9cf?s=128&d=identicon&r=PG&f=1", "display_name": "onok", "link": "https://stackoverflow.com/users/5216229/onok"}, "edited": false, "score": 0, "creation_date": 1439988846, "post_id": 32094378, "comment_id": 52086641, "body": "I&#39;ve added text and picture to my answer"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1439988827, "last_edit_date": 1439988827, "creation_date": 1439984115, "answer_id": 32094378, "question_id": 32091061, "link": "https://stackoverflow.com/questions/32091061/stop-solver-after-it-has-reached-a-certain-number-of-dps/32094378#32094378", "title": "Stop Solver after it has reached a certain number of dps", "body": "<p>One solution might be to change your sheet so that the \"answer\" is 100x the actual answer and then limit Solver to an integer only answer. You should be able to do this by adding the \"answer\" as a constraint rule - see the picture where solver changes $B$3 subject to keeping it an integer.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yOhSa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yOhSa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5216229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7acababf21e08e55171955b2f584d9cf?s=128&d=identicon&r=PG&f=1", "display_name": "onok", "link": "https://stackoverflow.com/users/5216229/onok"}, "is_accepted": true, "score": 1, "last_activity_date": 1439991475, "creation_date": 1439991475, "answer_id": 32097168, "question_id": 32091061, "link": "https://stackoverflow.com/questions/32091061/stop-solver-after-it-has-reached-a-certain-number-of-dps/32097168#32097168", "title": "Stop Solver after it has reached a certain number of dps", "body": "<p>Figured out the solution:</p>\n\n<pre><code>SolverOptions Precision:=0.01\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5216229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7acababf21e08e55171955b2f584d9cf?s=128&d=identicon&r=PG&f=1", "display_name": "onok", "link": "https://stackoverflow.com/users/5216229/onok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 32097168, "answer_count": 2, "score": 1, "last_activity_date": 1439991475, "creation_date": 1439975138, "question_id": 32091061, "link": "https://stackoverflow.com/questions/32091061/stop-solver-after-it-has-reached-a-certain-number-of-dps", "title": "Stop Solver after it has reached a certain number of dps", "body": "<p>Is there any way to stop solver after it has found a solution to 2 dps and move on to the next solve in the loop?</p>\n\n<p>For example after 3 trials the result may be 3.2454, trial 4 will be 3.2458 and so on until it finds the exact solution. The thing is I only care about the solution 3.24 and any further precision will have no material impact on my calculations and the further trials just slow the whole thing down with no real gain.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "charts", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "edited": false, "score": 0, "creation_date": 1439979643, "post_id": 32092470, "comment_id": 52080097, "body": "I see, I thought that I would have to code in somewhere that it should be starting the loop from a sheet not just a number. Cheers"}], "tags": [], "owner": {"reputation": 422, "user_id": 5226518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/M08sM.jpg?s=128&g=1", "display_name": "Blind Seer", "link": "https://stackoverflow.com/users/5226518/blind-seer"}, "is_accepted": true, "score": 1, "last_activity_date": 1439978796, "creation_date": 1439978796, "answer_id": 32092470, "question_id": 32091006, "link": "https://stackoverflow.com/questions/32091006/vba-looping-through-all-chart-sheets-and-copying-onto-one-worksheet/32092470#32092470", "title": "VBA - Looping through all chart sheets and copying onto one worksheet", "body": "<p>why it isn't working is pretty easy: You try to count from Sheet(2) (which is \u00e1n object) to the number of sheets -1. Of course this wont work, since sheets(2) is an object. Try <code>For I = 2 To Sheets(ActiveWorkbook.Sheets.Count - 1)</code> which will start with 2.\nEven if you want to use the amount of sheets you give the index number of the starting sheet, not the sheet itself.</p>\n"}], "owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 0, "accepted_answer_id": 32092470, "answer_count": 1, "score": 0, "last_activity_date": 1439978796, "creation_date": 1439974976, "question_id": 32091006, "link": "https://stackoverflow.com/questions/32091006/vba-looping-through-all-chart-sheets-and-copying-onto-one-worksheet", "title": "VBA - Looping through all chart sheets and copying onto one worksheet", "body": "<p>I am trying to loop through all the charts generated in my workbook which exist on the 2nd sheet to the 2nd to last sheet. I want to loop through all the charts, copy the chart area and paste it onto the last sheet which has data (just a regular spreadsheet).</p>\n\n<p>I can't see why the code below is not working but I end up with a Run-time error '438' - Object doesn't support this property or method on the first line (for loop). </p>\n\n<p>Any ideas why this isn't working? </p>\n\n<pre><code>Sub chartCopy()\n\n    For I = Sheets(2) To Sheets(ActiveWorkbook.Sheets.Count - 1)\n\n        ActiveChart.ChartArea.Copy\n        Sheets(Sheets.Count).Select\n        ActiveSheet.Paste\n\n    Next I\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "formatting"], "comments": [{"owner": {"reputation": 66, "user_id": 4391917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05e8e5219998b75fa5e9a9746dae2fa0?s=128&d=identicon&r=PG&f=1", "display_name": "StackExchanger", "link": "https://stackoverflow.com/users/4391917/stackexchanger"}, "edited": false, "score": 0, "creation_date": 1439973490, "post_id": 32090315, "comment_id": 52075829, "body": "Have a look at this similar question:    <a href=\"http://stackoverflow.com/questions/23405955/force-english-monthname-in-vba\" title=\"force english monthname in vba\">stackoverflow.com/questions/23405955/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 5235158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed0296cc43f79f534065e711a0fe436?s=128&d=identicon&r=PG&f=1", "display_name": "GOSCHEN", "link": "https://stackoverflow.com/users/5235158/goschen"}, "is_accepted": false, "score": 3, "last_activity_date": 1439973424, "creation_date": 1439973424, "answer_id": 32090445, "question_id": 32090315, "link": "https://stackoverflow.com/questions/32090315/vba-change-date-language/32090445#32090445", "title": "VBA - Change date language", "body": "<p>Try this, found it on a forum and it seems to work.</p>\n\n<pre><code>Public Function Format_en(Datum As Date) As String \nDim DD              As String \nDim MMM             As String \nDim YY              As String \n\nDD = Format(Datum, \"dd\") \nMMM = Choose(Month(Datum), \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\") \nYY = Format(Datum, \"yy\") \n\nFormat_en = DD &amp; \".\" &amp; MMM &amp; \" \" &amp; YY \nEnd Function \n\nMsgBox Format_en(Date) \n</code></pre>\n\n<p>Reference: <a href=\"http://www.office-loesung.de/ftopic99887_0_0_asc.php\" rel=\"nofollow\">http://www.office-loesung.de/ftopic99887_0_0_asc.php</a></p>\n\n<p>Cheers</p>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 11, "last_activity_date": 1439973633, "creation_date": 1439973633, "answer_id": 32090516, "question_id": 32090315, "link": "https://stackoverflow.com/questions/32090315/vba-change-date-language/32090516#32090516", "title": "VBA - Change date language", "body": "<p>Excel formula <code>TEXT</code> allows defining output language, so one of the options is to use it's VBA equivalent:</p>\n\n<pre><code>LastMonth = WorksheetFunction.Text(Date - Day(Date), \"[$-409]mmmm\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11311925, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/722502f69dbf965ecd246b9e7203b80d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/11311925/stefan"}, "is_accepted": false, "score": -1, "last_activity_date": 1554384821, "creation_date": 1554384821, "answer_id": 55517315, "question_id": 32090315, "link": "https://stackoverflow.com/questions/32090315/vba-change-date-language/55517315#55517315", "title": "VBA - Change date language", "body": "<p>Just use [$-409] to force English number format.</p>\n\n<p><strong>.NumberFormat = \"[$-409]mmmm yy\"</strong></p>\n\n<p>gives an output like e.g. \"December 19\".</p>\n\n<p><strong>.NumberFormat = \"[$-409]mmm yy\"</strong></p>\n\n<p>gives an output like e.g. \"Dec 19\".</p>\n"}], "owner": {"reputation": 175, "user_id": 4473866, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-123RQg2lRDI/AAAAAAAAAAI/AAAAAAAAAEA/VF8HVKLqpo8/photo.jpg?sz=128", "display_name": "Yuriy T.", "link": "https://stackoverflow.com/users/4473866/yuriy-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12694, "favorite_count": 0, "accepted_answer_id": 32090516, "answer_count": 3, "score": 5, "last_activity_date": 1554384821, "creation_date": 1439972986, "question_id": 32090315, "link": "https://stackoverflow.com/questions/32090315/vba-change-date-language", "title": "VBA - Change date language", "body": "<p>I'm trying to solve such problem: \nIn macro, that I'm using, one of the parts is to retrieve date month (in full naming), currently is used : </p>\n\n<pre><code>LastMonth = Format(DateSerial(Year(Date), Month(Date) - 1, 1), \"mmmm\")\n</code></pre>\n\n<p>But then one problem appears - for persons, who use different regional language settings, date appears in it's local language, but I need to have it for everyone in <strong>English</strong>. </p>\n\n<p>I was looking around the internet, but haven't found any similar solutions.\nDoes anyone knows, how can this be solved?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1439973000, "post_id": 32090006, "comment_id": 52075531, "body": "<code>Cells(3, rowLoop).Offset(1,0).Resize(4).Value</code> and <code>Cells(3, rowLoop).Offset(6,0).Resize(4).Value</code> is probably what you are looking for."}, {"owner": {"reputation": 213, "user_id": 5210893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89f299e004512373501a569ef02b46?s=128&d=identicon&r=PG&f=1", "display_name": "Savagefool", "link": "https://stackoverflow.com/users/5210893/savagefool"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1439973645, "post_id": 32090006, "comment_id": 52075919, "body": "Awesome, that worked perfectly for the cells below, thank you. You should make this an answer I think and explain it abit. Works perfectly for me."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 5210893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89f299e004512373501a569ef02b46?s=128&d=identicon&r=PG&f=1", "display_name": "Savagefool", "link": "https://stackoverflow.com/users/5210893/savagefool"}, "edited": false, "score": 0, "creation_date": 1439973070, "post_id": 32090239, "comment_id": 52075571, "body": "Can you explain the function and provide more information on this one please. The code is a tad confusing to me here. Specifically the <code>i = 26</code> and the code blocks in &#39;if&#39; and &#39;else&#39; Thank you :]"}, {"owner": {"reputation": 249, "user_id": 5030935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0ca922907f0a1649bcd7c4cc281945?s=128&d=identicon&r=PG&f=1", "display_name": "Excel", "link": "https://stackoverflow.com/users/5030935/excel"}, "reply_to_user": {"reputation": 213, "user_id": 5210893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89f299e004512373501a569ef02b46?s=128&d=identicon&r=PG&f=1", "display_name": "Savagefool", "link": "https://stackoverflow.com/users/5210893/savagefool"}, "edited": false, "score": 0, "creation_date": 1439975284, "post_id": 32090239, "comment_id": 52077003, "body": "i should be rowloop where the desired date is found. The above function converts the rowloop number to its correponding column character"}], "tags": [], "owner": {"reputation": 249, "user_id": 5030935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0ca922907f0a1649bcd7c4cc281945?s=128&d=identicon&r=PG&f=1", "display_name": "Excel", "link": "https://stackoverflow.com/users/5030935/excel"}, "is_accepted": true, "score": 0, "last_activity_date": 1439972753, "creation_date": 1439972753, "answer_id": 32090239, "question_id": 32090006, "link": "https://stackoverflow.com/questions/32090006/excel-vba-define-value-as-cell-position-copy-below-same-cell-position-paste/32090239#32090239", "title": "Excel VBA - Define value as cell position, copy below same cell position, paste", "body": "<p>Try using this function to get the column in which data is found.</p>\n\n<pre><code> Public Function columnletter(i As Integer)\nIf i &gt; 26 Then\n    columnletter = Chr(Int((i - 1) / 26) + 64) &amp; Chr(((i - 1) Mod 26) + 65)\nElse\n    columnletter = Chr(i + 64)\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": false, "score": 0, "last_activity_date": 1439974274, "creation_date": 1439974274, "answer_id": 32090736, "question_id": 32090006, "link": "https://stackoverflow.com/questions/32090006/excel-vba-define-value-as-cell-position-copy-below-same-cell-position-paste/32090736#32090736", "title": "Excel VBA - Define value as cell position, copy below same cell position, paste", "body": "<p>To solve the problem, use</p>\n\n<pre><code>Sheets(\"Vessels\").Range(\"C10:C13\").Value = Cells(3, rowLoop).Offset(1,0).Resize(4).Value\nSheets(\"Vessels\").Range(\"D10:D13\").Value = Cells(3, rowLoop).Offset(6,0).Resize(4).Value\n</code></pre>\n\n<p>Notes: </p>\n\n<p>If you do not specify <code>Sheet</code>, all <code>Cells</code> calls refer to active sheet and it may cause problems. If you want to serach in <code>Tidal</code> sheet, use <code>Sheets(\"Tidal\").Cells(...</code></p>\n\n<p>Look at <code>Range.Find</code> method, you could avoid looping cells.</p>\n"}], "owner": {"reputation": 213, "user_id": 5210893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89f299e004512373501a569ef02b46?s=128&d=identicon&r=PG&f=1", "display_name": "Savagefool", "link": "https://stackoverflow.com/users/5210893/savagefool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 32090239, "answer_count": 2, "score": 0, "last_activity_date": 1439974274, "creation_date": 1439972048, "last_edit_date": 1439972396, "question_id": 32090006, "link": "https://stackoverflow.com/questions/32090006/excel-vba-define-value-as-cell-position-copy-below-same-cell-position-paste", "title": "Excel VBA - Define value as cell position, copy below same cell position, paste", "body": "<p>So I have this code for visual basic in excel:</p>\n\n<pre><code>Sub Tele()\n\n    Dim rowLoop As Long\n    rowLoop = 1\n    strValueToFind = InputBox(\"Enter a Search value in format xx.xx.xxxx\")\n    ' Loop row A to find value, number corrosponds to letter position in alphabet\n    For rowLoop = 1 To Columns.Count\n        If Cells(3, rowLoop).Value = strValueToFind Then ' If value is in C then do something\n            ' start on cell found from date needed - look at copying range on same Column\n\n            Sheets(\"Vessels\").Range(\"C10:C13\").Value = Sheets(\"Tidal\").Range(\"D4:D7\").Value\n            Sheets(\"Vessels\").Range(\"D10:D13\").Value = Sheets(\"Tidal\").Range(\"D9:D12\").Value\n            MsgBox (\"Found value on col \" &amp; rowLoop) '\n            Exit Sub\n        End If\n    Next rowLoop ' This is row number, do something with this\n\n    ' This MsgBox will only show if the loop completes with no success\n    MsgBox (\"Date not found, make sure you have input the date correctly\")\n\nEnd Sub\n</code></pre>\n\n<p>The code looks for a date in a sheet, and copies data based on that cell. \nWhat I need is for this to become automatic.  </p>\n\n<p><strong>The problem:</strong><br>\nIn C, or Python I would grab the 'cell found' as a value. I would then use that value inside the range to represent the column letter so that based on the 'cell found' it would copy the rows below that same column and paste into the new sheet on the same column, one cell down and paste in horrizontal instead of verticle.<br>\nIn short, if date is on column C, copy the data below on that same column.\nThen paste into predetermined positions (C10:C13 and D10:D13 in this case) for displaying numerous fields of data on another sheet. Once I have the basic concept, the method only needs extrapolating to fill the function of the rest.\nAny idea's? </p>\n\n<p><strong>Simplified program is meant to be like this:</strong><br>\nInput number.<br>\nFind column where data appears and define it as 'DATACELLFOUND'<br>\nCopy three cells, one cell below 'DATACELLFOUND' and paste into C10:C13<br>\nCopy three cells, starting from six cells below 'DATACELLFOUND' and paste into D10:D13.  </p>\n\n<p>Thank you in advance!  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4969671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6b78bac44ba0a670867473fbcb6c3?s=128&d=identicon&r=PG&f=1", "display_name": "nani", "link": "https://stackoverflow.com/users/4969671/nani"}, "edited": false, "score": 0, "creation_date": 1439973114, "post_id": 32089765, "comment_id": 52075601, "body": "Okay..thanks -..i will correct it and how about range..because i don&#39;t want my header row colour to get clear..can you please help me.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 13, "user_id": 4969671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6b78bac44ba0a670867473fbcb6c3?s=128&d=identicon&r=PG&f=1", "display_name": "nani", "link": "https://stackoverflow.com/users/4969671/nani"}, "edited": false, "score": 0, "creation_date": 1439973898, "post_id": 32089765, "comment_id": 52076055, "body": "I don&#39;t recall any mention of a header row in your question but you can take a look at the modification I made above."}, {"owner": {"reputation": 13, "user_id": 4969671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6b78bac44ba0a670867473fbcb6c3?s=128&d=identicon&r=PG&f=1", "display_name": "nani", "link": "https://stackoverflow.com/users/4969671/nani"}, "edited": false, "score": 0, "creation_date": 1439976414, "post_id": 32089765, "comment_id": 52077777, "body": "oops..but i didn&#39;t mention specifically in description.. but any way thanks buddy it is working the code u gave me and can i ask one more favour ....is it possible to write in single line..:-) just for my understanding.. \u2013"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1439973829, "last_edit_date": 1439973829, "creation_date": 1439971296, "answer_id": 32089765, "question_id": 32089631, "link": "https://stackoverflow.com/questions/32089631/how-to-clear-cell-filled-colour-using-excel-macro-by-specifying-range-instead-of/32089765#32089765", "title": "How to clear cell filled colour using Excel macro by specifying range instead of UsedRange option", "body": "<p>To clear a fill color, don't reset the color code; change the <code>.Interior.Pattern</code> to xlNone.</p>\n\n<pre><code>with Worksheets(\"Sheet2\")\n    with .cells(1, 1).currentregion\n        with .resize(.rows.count -1, .columns.count).offset(1, 0)\n            .Cells.Interior.Pattern = xlNone\n        end with\n    end with\nend with\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4969671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6b78bac44ba0a670867473fbcb6c3?s=128&d=identicon&r=PG&f=1", "display_name": "nani", "link": "https://stackoverflow.com/users/4969671/nani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8755, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1439981254, "creation_date": 1439970897, "last_edit_date": 1439981254, "question_id": 32089631, "link": "https://stackoverflow.com/questions/32089631/how-to-clear-cell-filled-colour-using-excel-macro-by-specifying-range-instead-of", "title": "How to clear cell filled colour using Excel macro by specifying range instead of UsedRange option", "body": "<p>I need help with the following problem:<br>\nHow can I clear a cell filled color by specifying range or infinite range in Excel VBA instead of using <code>UsedRange</code> to clear filled color?</p>\n\n<pre><code>Worksheets(\"Sheet2\").UsedRange.Cells.Interior.Color = -4142\n</code></pre>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1439970917, "post_id": 32089556, "comment_id": 52074212, "body": "For example <code>A1:C3</code> will be <code>A1:D4</code> ?"}, {"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1439971022, "post_id": 32089556, "comment_id": 52074274, "body": "Try this <code>ActiveCell.Resize(numRows + 1, numColumns + 1).Select</code>"}, {"owner": {"reputation": 393, "user_id": 5219155, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a23c99b150b1a02739f45e10962b281d?s=128&d=identicon&r=PG&f=1", "display_name": "maro", "link": "https://stackoverflow.com/users/5219155/maro"}, "reply_to_user": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1439971200, "post_id": 32089556, "comment_id": 52074386, "body": "No. I want to increase the whole range. I select some range, run macro, and I want to have all these values increased."}, {"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1439972014, "post_id": 32089556, "comment_id": 52074914, "body": "What <code>A1:C3</code> should be increase ? When you run your program what range should it be ?"}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 5219155, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a23c99b150b1a02739f45e10962b281d?s=128&d=identicon&r=PG&f=1", "display_name": "maro", "link": "https://stackoverflow.com/users/5219155/maro"}, "edited": false, "score": 0, "creation_date": 1439972444, "post_id": 32089830, "comment_id": 52075181, "body": "A1:C3 was just an example. The macro doesn&#39;t know what range will be selected. Your second code is that what I meant. Thank you."}, {"owner": {"reputation": 393, "user_id": 5219155, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a23c99b150b1a02739f45e10962b281d?s=128&d=identicon&r=PG&f=1", "display_name": "maro", "link": "https://stackoverflow.com/users/5219155/maro"}, "edited": false, "score": 0, "creation_date": 1439974066, "post_id": 32089830, "comment_id": 52076189, "body": "Is <code>Dim rngSelection As Range</code>     <code>Set rngSelection = Selection</code> necessary? Coudn&#39;t we just write <code>For Each c In Selection</code>?"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 393, "user_id": 5219155, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a23c99b150b1a02739f45e10962b281d?s=128&d=identicon&r=PG&f=1", "display_name": "maro", "link": "https://stackoverflow.com/users/5219155/maro"}, "edited": false, "score": 0, "creation_date": 1439977469, "post_id": 32089830, "comment_id": 52078596, "body": "Yeah you could just write that.. it would operate in exactly the same way. It&#39;s always good practice to declare variables though :)"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1439972214, "last_edit_date": 1439972214, "creation_date": 1439971484, "answer_id": 32089830, "question_id": 32089556, "link": "https://stackoverflow.com/questions/32089556/how-to-change-the-selected-range/32089830#32089830", "title": "How to change the selected range?", "body": "<p>Instead of using the <code>Activecell</code> you will just have to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\"><code>Range</code> object</a> and a <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow\"><code>For Each</code> statement</a>.</p>\n\n<pre><code>For Each c In Range(\"A1:C3\")\n    c.Value = c.Value + 1\nNext c\n</code></pre>\n\n<p>If there are empty cells within the range which you do not want to add <code>1</code> onto, then just add in an <code>If</code> statement.</p>\n\n<p><code>If Not c.Value = vbNullString Then</code></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If you want to be able to select the range, and then run the macro, you can assign your selection to a <code>Range</code>, and then iterate through the <code>Range</code>.</p>\n\n<pre><code>Sub add1()\n    Dim rngSelection As Range\n    Set rngSelection = Selection\n\n    For Each c In rngSelection\n        If Not c.Value = vbNullString Then\n            c.Value = c.Value + 1\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Depending on the size of the <code>Range</code> you wish to perform this over, it could be more efficient to load the cells values into an array and perform the calculations within the array.</p>\n"}], "owner": {"reputation": 393, "user_id": 5219155, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a23c99b150b1a02739f45e10962b281d?s=128&d=identicon&r=PG&f=1", "display_name": "maro", "link": "https://stackoverflow.com/users/5219155/maro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2195, "favorite_count": 0, "accepted_answer_id": 32089830, "answer_count": 1, "score": 0, "last_activity_date": 1439972214, "creation_date": 1439970652, "last_edit_date": 1439971959, "question_id": 32089556, "link": "https://stackoverflow.com/questions/32089556/how-to-change-the-selected-range", "title": "How to change the selected range?", "body": "<p>I have a macro that increases a value in a selected cell.</p>\n\n<pre><code>Sub add_1_to_the_selected_cell()\n    ActiveCell.FormulaR1C1 = ActiveCell.FormulaR1C1 + 1\nEnd Sub\n</code></pre>\n\n<p>and I want to write a macro that changes not only one cell but the selected range. How to do that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1439967136, "post_id": 32088253, "comment_id": 52072099, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/31382682/fill-blank-cells-variation\">Fill blank cells (Variation)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "is_accepted": false, "score": -2, "last_activity_date": 1439967451, "creation_date": 1439967451, "answer_id": 32088489, "question_id": 32088253, "link": "https://stackoverflow.com/questions/32088253/select-blank-cells-after-a-used-cell-and-copy-data/32088489#32088489", "title": "Select blank cells after a used cell and copy data", "body": "<p>I found the answer myself after some time.</p>\n\n<pre><code>For i = 2 To last\n\nIf log.Sheets(\"Entry\").Cells(i, 3) &lt;&gt; \"\" Then\n\n    If log.Sheets(\"Entry\").Cells(i + 1, 3) = \"\" Then\n\n        log.Sheets(\"Entry\").Cells(i + 1, 3) = log.Sheets(\"Entry\").Cells(i, 3)\n\n    End If\n\nEnd If\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 1, "last_activity_date": 1439967757, "creation_date": 1439967757, "answer_id": 32088590, "question_id": 32088253, "link": "https://stackoverflow.com/questions/32088253/select-blank-cells-after-a-used-cell-and-copy-data/32088590#32088590", "title": "Select blank cells after a used cell and copy data", "body": "<p>You can also use this one:</p>\n\n<pre><code>Public Sub fillBlank()\n\n    Dim row, lastRow As Integer\n\n    With Sheets(\"sheetname\")\n\n        'Getting the last use row.\n        lastRow = .Range(\"B1\").SpecialCells(xlCellTypeLastCell).row\n\n        'looping from row 2 to last used row (let row 1 is not blank)\n        For row = 2 To lastRow Step 1\n\n            If .Range(\"C\" &amp; row) = \"\" Then\n                .Range(\"C\" &amp; row) = .Range(\"C\" &amp; row - 1)\n            End If\n\n        Next row\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1439967757, "creation_date": 1439966679, "last_edit_date": 1531164843, "question_id": 32088253, "link": "https://stackoverflow.com/questions/32088253/select-blank-cells-after-a-used-cell-and-copy-data", "title": "Select blank cells after a used cell and copy data", "body": "<p>I have a problem regarding this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/na166.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/na166.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to make the blank cells' value equal to the value of the used cell before them. My desired outcome is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/C8jX4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C8jX4.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can observe that the blank cells' value depends on the value of the used cell before them. Is there any way to achieve this using macro? Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1439959128, "post_id": 32086644, "comment_id": 52069034, "body": "Why not just hyperlink it?"}, {"owner": {"reputation": 123, "user_id": 1270363, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/faa9159e8cfc26d9f30ce42ee8312c3c?s=128&d=identicon&r=PG", "display_name": "Heinser Diaz", "link": "https://stackoverflow.com/users/1270363/heinser-diaz"}, "edited": false, "score": 0, "creation_date": 1439959270, "post_id": 32086644, "comment_id": 52069068, "body": "considering that c1 is a &quot;dynamic&quot; cell, hyperlinking it wouldn&#39;t help me, i think. let&#39;s say that c1 changes to mexico, it should redirect to A5 on WS2 when i click on the button."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1439959334, "post_id": 32086644, "comment_id": 52069093, "body": "You&#39;re going to have to write a dynamic routine anyway. Just write a dynamic hyperlink one."}, {"owner": {"reputation": 123, "user_id": 1270363, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/faa9159e8cfc26d9f30ce42ee8312c3c?s=128&d=identicon&r=PG", "display_name": "Heinser Diaz", "link": "https://stackoverflow.com/users/1270363/heinser-diaz"}, "edited": false, "score": 0, "creation_date": 1439959854, "post_id": 32086644, "comment_id": 52069262, "body": "found this &gt;&gt; <a href=\"http://trumpexcel.com/2014/03/create-dynamic-hyperlinks-in-excel/\" rel=\"nofollow noreferrer\">trumpexcel.com/2014/03/create-dynamic-hyperlinks-in-excel</a>"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 5233492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qo4SH.jpg?s=128&g=1", "display_name": "SY Chen", "link": "https://stackoverflow.com/users/5233492/sy-chen"}, "is_accepted": false, "score": 2, "last_activity_date": 1439959624, "creation_date": 1439959624, "answer_id": 32086754, "question_id": 32086644, "link": "https://stackoverflow.com/questions/32086644/different-worksheet-same-value/32086754#32086754", "title": "Different worksheet, same value", "body": "<p>Try this...</p>\n\n<pre><code>Sub Find()\nAA = Selection.Value\n\nSheets(\"WS2\").Range(\"A1\").Select\nCells.Find(What:=AA, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 1270363, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/faa9159e8cfc26d9f30ce42ee8312c3c?s=128&d=identicon&r=PG", "display_name": "Heinser Diaz", "link": "https://stackoverflow.com/users/1270363/heinser-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1439959624, "creation_date": 1439958935, "question_id": 32086644, "link": "https://stackoverflow.com/questions/32086644/different-worksheet-same-value", "title": "Different worksheet, same value", "body": "<p>I want to be able to click on a button which will take me to a different worksheet cell where the value of this cell is the same as the value of one cell in the original worksheet.</p>\n\n<p>Worksheet 1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/48705.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/48705.png\" alt=\"enter image description here\"></a></p>\n\n<p>Worksheet 2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Awdzx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Awdzx.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I click the blue button on WS1, the value of c1 should be saved, and then go to WS2 cell where the value is the same as c1 in ws1. In this case, it should take me to A1.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "edited": false, "score": 0, "creation_date": 1439980447, "post_id": 32086729, "comment_id": 52080621, "body": "cursor still flashes. Is changing value of a cell cause behind this?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "edited": false, "score": 0, "creation_date": 1439985279, "post_id": 32086729, "comment_id": 52083990, "body": "@Kartiki I see the problem. Hopefully the workaround in the edit could work."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1439985227, "last_edit_date": 1439985227, "creation_date": 1439959489, "answer_id": 32086729, "question_id": 32086555, "link": "https://stackoverflow.com/questions/32086555/cursor-keeps-on-flashing-for-a-macro-that-runs-every-second/32086729#32086729", "title": "Cursor keeps on flashing for a macro that runs every second", "body": "<p>:Put</p>\n\n<pre><code>Application.Cursor = xlDefault\n</code></pre>\n\n<p>As the first line in your sub. At least this works when you do something like:</p>\n\n<pre><code>Sub test()\nDim i As Long\nApplication.Cursor = xlDefault\nFor i = 1 To 100000\n    Debug.Print i 'to chew up time\nNext i\nMsgBox \"Done!\"\nEnd Sub\n</code></pre>\n\n<p>When this is launched from the developer's tab in Excel the cursor looks normal even though it is running. I haven't tested it with your set-up of launching the sub every second (which might cause some flicker perhaps).</p>\n\n<p>On Edit: I tested the situation where the sub is called every second and see that there is still a flicker. The problem is that the change to <code>Application.Cursor</code> doesn't persist past the function call. So in your case you aren't seeing the blue processing cursor (at least I don't see it) but you are seeing the cursor resetting every second, which is just as annoying.</p>\n\n<p>Here is a potential work-around. Your code seems to be a count-down in cell C1. When the countdown reaches 0 the sub <code>startpostprocess</code> is launched. Presumably you did it the way that you did (calling <code>showtimer</code> every second) since you wanted Excel to be usable during the countdown. One way to achieve that is to have a <code>Countdown</code> sub run continuously during the countdown (so its change to the cursor doesn't go out of scope) and use <code>DoEvents</code> to keep Excel responsive:</p>\n\n<pre><code>Sub Countdown(n As Long)\n    Application.Cursor = xlDefault\n    Dim start As Double\n\n    Do While n &gt;= 0\n        ThisWorkbook.Worksheets(\"Convergence_Plot\").Cells(1, 3).Value = n\n        start = Timer()\n        Do While Timer &lt; start + 1\n            DoEvents\n        Loop\n        n = n - 1\n    Loop\n    startpostprocess\nEnd Sub\n\nSub StartCountDown()\n    Countdown ThisWorkbook.Worksheets(\"Convergence_Plot\").Cells(1, 3).Value\nEnd Sub\n</code></pre>\n\n<p>I changed the time value in cell C1 to a simple integer counter. When I put 10 in C1 and invoke <code>StartCountDown</code> the cell is changes to 10, 9, 8, ...,1, 0 at 1 second increments and then <code>startpostprocess</code> (I created a stub for it which just pops up a msgbox) launches. Cells can be edited during the countdown.</p>\n"}], "owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2063, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1439985227, "creation_date": 1439958274, "last_edit_date": 1531164843, "question_id": 32086555, "link": "https://stackoverflow.com/questions/32086555/cursor-keeps-on-flashing-for-a-macro-that-runs-every-second", "title": "Cursor keeps on flashing for a macro that runs every second", "body": "<p>This is the code that updates a cell value every second.</p>\n\n<pre><code>Sub showtimer()\nIf CStr(ThisWorkbook.Worksheets(\"Convergence_Plot\").Cells(1, 3).Value) = \"0\" Then\n    Call startpostprocess\n    Exit Sub\nEnd If\n    ThisWorkbook.Worksheets(\"Convergence_Plot\").Cells(1, 3).Value = ThisWorkbook.Worksheets(\"Convergence_Plot\").Cells(1, 3).Value - TimeSerial(0, 0, 1)\n    timetimer = Now + TimeValue(\"00:00:01\")\n    Application.OnTime timetimer, \"showtimer\", , True\nEnd Sub\n</code></pre>\n\n<p>Cursor keeps on flashing/shows the blue processing cursor.\nHow can it be avoided?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1439961305, "post_id": 32086536, "comment_id": 52069699, "body": "does the text have a dotted underline set on it? I am assuming that you are not refering to the dot line that appears when the shape is selected."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1440000173, "post_id": 32086536, "comment_id": 52095424, "body": "Add a screenshot of what you&#39;re seeing or post a copy of the presentation where people can download it and have a look."}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439958128, "creation_date": 1439958128, "last_edit_date": 1531164843, "question_id": 32086536, "link": "https://stackoverflow.com/questions/32086536/dotted-line-appears-under-shape-in-powerpoint", "title": "Dotted line appears under shape in Powerpoint", "body": "<pre><code>    Set shp = aslide.Shapes.AddShape(Type:=msoShapeRectangle, Left:=24, Top:=50, Width:=672, Height:=26.6)\n    shp.Name = \"First Shape\"\n    shp.Line.Visible = msoFalse\n    shp.Fill.ForeColor.RGB = RGB(255, 255, 255)\n    shp.TextFrame.TextRange.Font.Color.RGB = RGB(0, 102, 204)\n    shp.TextFrame.TextRange.Characters.Text = \"Title \"\n    shp.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignLeft\n    shp.TextFrame2.VerticalAnchor = msoAnchorMiddle\n    shp.TextFrame2.TextRange.Font.Size = 18\n    shp.TextFrame2.TextRange.Font.Name = \"Arial\"\n</code></pre>\n\n<p>Where aslide is the Activeslide. The issue I got is that a dotted line appears under the text box even when I have clearly made the line visibility to False. Please advice. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2013"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1439956048, "post_id": 32086179, "comment_id": 52068157, "body": "Make sure you have a worksheet actually named &quot;<code>...</code>&quot; - verify leading/trailing spaces."}, {"owner": {"reputation": 3, "user_id": 4557516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c180b154611af1e92f263438dce916c?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4557516/josh"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1439956386, "post_id": 32086179, "comment_id": 52068245, "body": "Yeah, I should have specified. The macro works flawlessly in 2013 and I&#39;ve triple checked the &quot;...&quot; part and it&#39;s 101% correct haha"}, {"owner": {"reputation": 3, "user_id": 4557516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c180b154611af1e92f263438dce916c?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4557516/josh"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1439956429, "post_id": 32086179, "comment_id": 52068260, "body": "I seem to have got it working by duplicating the sheet and renaming it... Super weird"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4557516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c180b154611af1e92f263438dce916c?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4557516/josh"}, "edited": false, "score": 0, "creation_date": 1440129577, "post_id": 32106547, "comment_id": 52154981, "body": "I&#39;ve been using .activate so that I can just use &quot;something = cells(x,y)....&quot; and all my subs are around 6000 lines combined to I don&#39;t think I&#39;ll bother changing over but I&#39;m still just learning to code. will definitely incorporate this into my next project! Thanks :)"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 3, "user_id": 4557516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c180b154611af1e92f263438dce916c?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4557516/josh"}, "edited": false, "score": 0, "creation_date": 1440153662, "post_id": 32106547, "comment_id": 52166427, "body": "If your subs are getting to be that long, you should look at &quot;chunking&quot; the work they are doing out into separate functions/subs. This will make your code easier to read and maintain/modify in the future."}, {"owner": {"reputation": 3, "user_id": 4557516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c180b154611af1e92f263438dce916c?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4557516/josh"}, "edited": false, "score": 1, "creation_date": 1441162409, "post_id": 32106547, "comment_id": 52561963, "body": "Thanks, I have haha. About half way through I got an error because my sub was too long haha It&#39;s in many pieces now, so much tidier and easier to work with. Cheers for the advice though :)"}], "tags": [], "owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "is_accepted": false, "score": 0, "last_activity_date": 1440022584, "creation_date": 1440022584, "answer_id": 32106547, "question_id": 32086179, "link": "https://stackoverflow.com/questions/32086179/cant-activate-specific-worksheet-but-i-can-activate-others-s/32106547#32106547", "title": "Can&#39;t activate specific worksheet but I can activate others :S", "body": "<p>I don't have an answer as to why you couldn't activate the sheet, and don't think I could answer it without seeing the workbook in question.  But, I can help you to avoid using activate in the first place ;) </p>\n\n<p>From your description it sounds like you're using <code>Worksheet(index).Activate</code> so then you can use <code>ActiveSheet.SomeMember</code> to work with the worksheet object.  </p>\n\n<p>If this is so, you could save yourself time and make your program more efficient by using a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">with block</a>. </p>\n\n<p>E.g.: </p>\n\n<pre><code>With Worksheets(\"...\")\n    Debug.Print \"working with \"\"\" &amp; .Name &amp; \"\"\".\"\n    Debug.Print \"which belongs to \"\"\" &amp; .Parent.Name &amp;  \"\"\".\"\nEnd With\n</code></pre>\n\n<p>And if you need to reference it in multiple places, I'd recommend assigning the object to a variable. </p>\n\n<p>E.g.:</p>\n\n<pre><code>Dim MySheet as Worksheet \nSet MySheet = Worksheets(\"...\")\n\nWith MySheet\n    'Do something \nEnd With\n\nMySheet.range(\"A:A\").Copy Destination:= WorkSheets(\"Someothersheet\").Range(\"B:B\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4557516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c180b154611af1e92f263438dce916c?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4557516/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440133252, "creation_date": 1439955897, "last_edit_date": 1440133252, "question_id": 32086179, "link": "https://stackoverflow.com/questions/32086179/cant-activate-specific-worksheet-but-i-can-activate-others-s", "title": "Can&#39;t activate specific worksheet but I can activate others :S", "body": "<p>Having some struggles here.. Pretty new to coding and VBA, wrote a code using 2013 without realising I'd have issues moving backward to run on 2010 versions... Derp..</p>\n\n<p>I'm having a bizarre issue.</p>\n\n<p>I'm using worksheets(\"...\").Activate to move between sheets (This was done to reduce the amount of \"worksheets(\"...\").\" before every line of my code).</p>\n\n<p>Anyway, the macro has no issue activating all the sheets except one. The sheet in question is where the original button is to run the code. I also can't seem to use the activex commandbutton (which is probably the source of my issue). </p>\n\n<p>Note: I have already tried the \"delete x files\" which was caused by a windows update - this isn't the source of the issue, I can still add new activex controls etc</p>\n\n<p>Edit: I've resolved the issue by changing from the ActiveX control to a button that calls a macro which calls the userform. It seems that something to do with having the ActiveX control on that sheet prevented it from being able to activate through a module. Anyone have an explanation for this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439955548, "post_id": 32086107, "comment_id": 52068039, "body": "You would need something that keeps your list up-to-date as sheets are added/removed."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439955764, "post_id": 32086107, "comment_id": 52068084, "body": "Something like a summary sheet?Is it like defining a range from the summary sheet for the dropdown list. How do i code it here? @Bond"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439955964, "post_id": 32086107, "comment_id": 52068135, "body": "You&#39;d probably want to iterate the sheets each time before displaying your dialog/dropdown to make sure your list is current."}], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439963939, "post_id": 32087017, "comment_id": 52070709, "body": "Nothing seems to come out from the droplist @paul bica"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439964582, "post_id": 32087017, "comment_id": 52070939, "body": "Did you execute navigateSheets() step by step? (by pressing F8). You also need to have a UserForm called &quot;UserForm1&quot; and on it a ComboBox called &quot;ComboBox1&quot;, and the code in the UserForm module"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439964827, "post_id": 32087017, "comment_id": 52071029, "body": "oh sorry it runs! I ran it on the wrong module. @paul bica"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 3, "last_activity_date": 1439961321, "creation_date": 1439961321, "answer_id": 32087017, "question_id": 32086107, "link": "https://stackoverflow.com/questions/32086107/input-box-to-search-for-sheet/32087017#32087017", "title": "Input box to search for sheet", "body": "<p>This will show a combo box on a user form, but the combo can be placed on a sheet as well</p>\n\n<p>UserForm:</p>\n\n<h2><a href=\"https://i.stack.imgur.com/KaQdg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KaQdg.png\" alt=\"user form with combo box\"></a></h2>\n\n<ul>\n<li>Create a new UserForm with default name \"UserForm1\" (any size)</li>\n<li>Create a new ComboBox with default name \"ComboBox1\" (any size)</li>\n<li>Add this code to the form VBA module:</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub ComboBox1_Change()\n    If Len(ComboBox1) &gt; 0 Then Worksheets(ComboBox1.Text).Activate\nEnd Sub\n\nPrivate Sub ComboBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n    If KeyAscii = vbKeyEscape Then Me.Hide\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Create a new standard VBA module and add this code:</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub navigateSheets()\n    Dim cmb As ComboBox, ws As Worksheet\n\n    Set cmb = UserForm1.ComboBox1\n    cmb.Clear\n    For Each ws In Worksheets\n        If ws.Visible Then cmb.AddItem ws.Name\n    Next\n    cmb.ListIndex = 0\n    setUserForm\nEnd Sub\n\nPrivate Sub setUserForm()\n    With UserForm1\n        .Height = 50:   .Width = 111\n        .Caption = \"Navigate Sheets\"\n        With .ComboBox1\n            .BackColor = RGB(240, 250, 255)\n            .ControlTipText = \"Select Sheet\"\n            .Height = 17:   .Width = UserForm1.Width - 15\n            .Top = 7:       .Left = 7:  .ListRows = 22\n            .MatchEntry = fmMatchEntryFirstLetter   '0\n        End With\n        .Show\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Run <strong><code>navigateSheets()</code></strong> to move between visible sheets, and pres Esc to close the form</li>\n</ul>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "accepted_answer_id": 32087017, "answer_count": 1, "score": 1, "last_activity_date": 1439961321, "creation_date": 1439955350, "last_edit_date": 1531164843, "question_id": 32086107, "link": "https://stackoverflow.com/questions/32086107/input-box-to-search-for-sheet", "title": "Input box to search for sheet", "body": "<p>i was wondering if there is any VBA code which allows an input box to search for a sheet with the use of a drop down list and to redirect to sheet automatically after the user has searched. Similar to how we find data on excel except for that fact that it is sheets now. The  drop down list should contain all the sheets in the workbook so that they can select the sheet they want to go to.  i have a code which works whereby user has to type manually which can be troublesome if the sheet names are too long thus resulting to spelling or format errors.</p>\n\n<pre><code>Sub searchsheet()\n\n\nDim strsheet As String\n' dim i as integer\n\nstrsheet = Application.InputBox(\"put sheet name\", \"Sheet Name Select\", , , , , , 2)\n\n\nWith ThisWorkbook.Worksheets(strsheet)\n.Select\n.Activate\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1439955232, "post_id": 32086022, "comment_id": 52067967, "body": "Yeah, I was writing and testing regex atm as well. If I use this approach however, I would need to create a function that  produces the regex pattern automatically for cases the user needs to enroll a new part. That would be trickier. But yeah I was considering this approach as well. Thanks mate."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1439955345, "post_id": 32086022, "comment_id": 52067994, "body": "If a new part is enrolled, you&#39;ll have work to do using any type of solution, though, right? Somewhere you&#39;ll need to define the rules for the new part number. I guess it would just depend on your comfort level with creating the new regex pattern vs another solution."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1439955596, "post_id": 32086022, "comment_id": 52068047, "body": "<code>I guess it would just depend on your comfort level with creating the new regex pattern</code> True. I&#39;m not strong in regex though but this is favorable considering I&#39;ll just set up 1 field in Access to store the patterns."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1439955674, "post_id": 32086022, "comment_id": 52068068, "body": "Yep, I think it would work out great for you. And I&#39;m sure you could study the five patterns above to see how it could work for other (future) parts. If not, come back to SO and we&#39;ll help you out!"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1439954780, "creation_date": 1439954780, "answer_id": 32086022, "question_id": 32085910, "link": "https://stackoverflow.com/questions/32085910/test-string-based-on-specific-rules/32086022#32086022", "title": "Test string based on specific rules", "body": "<p>I would just store a regex pattern. Then you can just retrieve the pattern based on the part and test the barcode using the associated pattern.</p>\n\n<p>For example, you could use the following patterns (assuming I didn't screw any of them up):</p>\n\n<pre><code>strPattern1 = \"^\\w{3}[2-4]\\w{12}$\"\nstrPattern2 = \"^\\w{3}[3-9]\\w{7}AAB\\w{3}$\"\nstrPattern3 = \"^\\w{3}[4-9]\\w{7}A\\w{4}$\"\nstrPattern4 = \"^CD\\w{9}A\\w{4}$\"\nstrPattern5 = \"^\\w{3}[4-9](0[1-9]|[1-4][0-9]|5[012])\\w{5}E[26][FGH]\\w{5}$\"\n</code></pre>\n\n<p>The only tricky part is the week numbers but I think that pattern should work.</p>\n\n<p>The <code>\\w</code> will match <code>[0-9a-zA-Z_]</code> so, if you don't want the underscore and/or lowercase letters, you can replace <code>\\w</code> with <code>[0-9A-Z]</code>.</p>\n\n<p>To use it:</p>\n\n<pre><code>Dim re\nSet re = CreateObject(\"VBScript.RegExp\")\nre.Pattern = strPattern1     ' Depending on the type of part\n\nIf re.Test(strBarcode) Then\n    ' Checks out\nElse\n    ' Invalid\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1440062285, "post_id": 32093465, "comment_id": 52121388, "body": "My first attempt is somehow similar to yours. Brute force VBA. And the reason is like what you&#39;ve figure out. I need the user to be able to add new Parts with new rules. I just need to make sure they fill up the rules properly. I was not really expecting that you or anyone else would go the miles of actually coding it. Thanks mate."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1440067760, "post_id": 32093465, "comment_id": 52125018, "body": "OK...I do what you provide. If there is any changes or more requirement or any problem when using this code, tell me. I will help you."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1442214755, "post_id": 32093465, "comment_id": 52973982, "body": "I decided to go this route. Not exactly the same code, but the same logic."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 1, "last_activity_date": 1439981548, "last_edit_date": 1495541652, "creation_date": 1439981548, "answer_id": 32093465, "question_id": 32085910, "link": "https://stackoverflow.com/questions/32085910/test-string-based-on-specific-rules/32093465#32093465", "title": "Test string based on specific rules", "body": "<p>In the fixed case, <a href=\"https://stackoverflow.com/users/2237785/bond\">Bond</a> is right. I think that his answer is not compatible for this problem. Because, for sure case, we can use <strong>Regular Expression</strong>. But, for this question, all conditions are store in database and user can add conditions and parts. So, It is not OK.</p>\n\n<p>Therefore, I think and tried in another way. But it is a pure VBA code. Here what I tried for you:</p>\n\n<pre><code>Public Function checkString(inputString As String, length As Integer, position As String, rule As String) As String\n\n    Dim message As String\n\n    'Set blank to message\n    message = \"\"\n\n    'Check string length\n    If Len(inputString) &lt;&gt; length Then\n\n        Call addMessage(message, \"The length must be \" &amp; length &amp; \".\")\n\n    'Check conditions\n    Else\n\n        Dim positionList, ruleList, tempRuleList\n        Dim startPos, endPos, posRange, posIndex\n        Dim index, tempIndex As Integer\n        Dim tempRule, flag As String\n        Dim isValid As Boolean\n        Dim fromRange, toRange As Integer\n\n        'get position list\n        positionList = Split(Trim(position), \",\")\n\n        'get rule list\n        ruleList = getRuleList(rule, UBound(positionList))\n\n        'Looping position list\n        For index = LBound(positionList) To UBound(positionList) Step 1\n\n            'get the rule\n            tempRule = ruleList(index)\n\n            'Condition for operator case (for example: &gt;=3)\n            If InStr(1, tempRule, \"&lt;\") &gt; 0 Or InStr(1, tempRule, \"=\") &gt; 0 Or InStr(1, tempRule, \"&gt;\") &gt; 0 Then\n\n                If InStr(1, tempRule, \"&lt;\") &gt; 0 Then\n                    flag = flag &amp; \"l\"\n                End If\n\n                If InStr(1, tempRule, \"&gt;\") &gt; 0 Then\n                    flag = flag &amp; \"g\"\n                End If\n\n                If InStr(1, tempRule, \"=\") &gt; 0 Then\n                    flag = flag &amp; \"e\"\n                End If\n\n                'Remove operators\n                tempRule = Replace(tempRule, \"&gt;\", \"\")\n                tempRule = Replace(tempRule, \"&lt;\", \"\")\n                tempRule = Replace(tempRule, \"=\", \"\")\n\n                'check\n                Select Case flag\n\n                    Case \"le\":\n                        If Not Mid(inputString, positionList(index), 1) &lt;= tempRule Then\n                            Call addMessage(message, \"The character from position \" &amp; positionList(index) &amp; \" must be less or equal with \" &amp; tempRule &amp; \".\")\n                        End If\n\n                    Case \"ge\":\n                        If Not Mid(inputString, positionList(index), 1) &gt;= tempRule Then\n                            Call addMessage(message, \"The character from position \" &amp; positionList(index) &amp; \" must be greater or equal with \" &amp; tempRule &amp; \".\")\n                        End If\n\n                    Case \"l\":\n                        If Not Mid(inputString, positionList(index), 1) &lt; tempRule Then\n                            Call addMessage(message, \"The character from position \" &amp; positionList(index) &amp; \" must be less than \" &amp; tempRule &amp; \".\")\n                        End If\n\n                    Case \"g\":\n                        If Not Mid(inputString, positionList(index), 1) &gt; tempRule Then\n                            Call addMessage(message, \"The character from position \" &amp; positionList(index) &amp; \" must be greater than \" &amp; tempRule &amp; \".\")\n                        End If\n\n                End Select\n\n            'Condition for range case (for example: [2-5])\n            ElseIf InStr(1, tempRule, \"[\") &gt; 0 Then\n\n                'remove brakets\n                tempRule = Replace(tempRule, \"[\", \"\")\n                tempRule = Replace(tempRule, \"]\", \"\")\n\n                'split by comma\n                tempRuleList = Split(Trim(tempRule), \"-\")\n\n                fromRange = CInt(tempRuleList(0))\n                toRange = CInt(tempRuleList(1))\n\n                If InStr(1, positionList(index), \"-\") &gt; 0 Then\n                    posRange = Split(Trim(positionList(index)), \"-\")\n\n                    startPos = posRange(0)\n                    endPos = posRange(1)\n                Else\n                    startPos = positionList(index)\n                    endPos = positionList(index)\n                End If\n\n                For posIndex = startPos To endPos Step 1\n                    posVal = posVal &amp; Mid(inputString, posIndex, 1)\n                Next posIndex\n\n                If Not (CInt(posVal) &lt;= fromRange And CInt(posVal) &gt;= toRange) Then\n                    Call addMessage(message, \"The character from positions \" &amp; positionList(index) &amp; \" must be between \" &amp; ruleList(index) &amp; \".\")\n                End If\n\n            'Condition for set of value case (for example: {2,4,5})\n            ElseIf InStr(1, tempRule, \"{\") &gt; 0 Then\n\n                If InStr(1, positionList(index), \"-\") &gt; 0 Then\n                    posRange = Split(Trim(positionList(index)), \"-\")\n\n                    startPos = posRange(0)\n                    endPos = posRange(1)\n                Else\n                    startPos = positionList(index)\n                    endPos = positionList(index)\n                End If\n\n                'remove brakets\n                tempRule = Replace(tempRule, \"{\", \"\")\n                tempRule = Replace(tempRule, \"}\", \"\")\n\n                'split by comma\n                tempRuleList = Split(Trim(tempRule), \",\")\n\n                'looping positions\n                For posIndex = startPos To endPos Step 1\n\n                    'Reset isValid flag\n                    isValid = False\n\n                    'looping rule list\n                    For tempIndex = LBound(tempRuleList) To UBound(tempRuleList) Step 1\n\n                        If Mid(inputString, posIndex, 1) = tempRuleList(tempIndex) Then\n                            isValid = True\n                            Exit For\n                        End If\n\n                    Next tempIndex\n\n                    If Not isValid Then\n                        Call addMessage(message, \"The character from position \" &amp; posIndex &amp; \" must be one of \" &amp; ruleList(index) &amp; \".\")\n                    End If\n\n                Next posIndex\n\n            'Condition for must be one case (for example: A)\n            ElseIf Mid(inputString, positionList(index), 1) &lt;&gt; tempRule Then\n\n                Call addMessage(message, \"The character from position \" &amp; positionList(index) &amp; \" must be \" &amp; tempRule &amp; \".\")\n\n            End If\n\n        Next index\n\n    End If\n\n    'Return message\n    If message = \"\" Then\n        checkString = \"Valid\"\n    Else\n        checkString = \"The string '\" &amp; inputString &amp; \"' is not valid. Fixed the following error:\" &amp; vbNewLine &amp; message\n    End If\n\nEnd Function\n\nPrivate Function getRuleList(rule As String, count As Integer) As Variant\n\n    Dim tempList, returnList\n    Dim tempIndex, resultIndex As Integer\n\n    'split by comma\n    tempList = Split(Trim(rule), \",\")\n\n    'If there is no special condition, return list\n    If count = UBound(tempList) Then\n\n        returnList = tempList\n\n    'Else process for special codition\n    Else\n\n        ReDim returnList(count) As String\n\n        resultIndex = 0\n\n        For tempIndex = LBound(tempList) To UBound(tempList) Step 1\n\n            If InStr(1, tempList(tempIndex), \"}\") &gt; 0 Then\n                returnList(resultIndex) = returnList(resultIndex) &amp; \",\" &amp; tempList(tempIndex)\n            Else\n                returnList(resultIndex) = tempList(tempIndex)\n            End If\n\n            If InStr(1, tempList(tempIndex), \"{\") = 0 Then\n                resultIndex = resultIndex + 1\n            End If\n\n        Next tempIndex\n\n    End If\n\n    'Return rule list\n    getRuleList = returnList\n\nEnd Function\n\nPrivate Function addMessage(ByRef dest As String, ByVal message As String)\n\n    If IsEmpty(dest) Or dest = \"\" Then\n        dest = message\n    Else\n        dest = dest &amp; vbNewLine &amp; message\n    End If\n\nEnd Function\n</code></pre>\n\n<p>I know that there are many code line. So, let see below explanation for my code.</p>\n\n<p><strong>Coding Explanation</strong></p>\n\n<blockquote>\n  <p><strong>1.\"checkString\"</strong> method</p>\n</blockquote>\n\n<pre><code>It takes the following parameter:\ninputString: the string for check\nlength     : the desired length for inputted string\nposition   : the position list which separated by comma\n            (\"{2,3,4}\" and \"[2-3]\" are not valid for position but valid range like 2-3)\nrule       : the rule list which separated by comma\n\nIt returns the result message as \"Valid\" for pass case.\nAnd If it is not pass, error messages will come out.\n</code></pre>\n\n<blockquote>\n  <p><strong>2.\"getRuleList\"</strong> method</p>\n  \n  <p>This method is for what? Because the rules are separated by comma(,). But sometime it include range rules like <strong>{2,3,4}</strong>. So, we need to think about it. So, this method is used for getting separated rule list.</p>\n  \n  <p><strong>3.\"addMessage\"</strong> method</p>\n  \n  <p>This method is for adding messages because we can see one or more error (i.e. one or more position has wrong character).</p>\n</blockquote>\n\n<p>I tested my method with the following code:</p>\n\n<pre><code>Public Sub testing()\n\n    Dim returnMessage As String\n\n    returnMessage = checkString(\"00465B\", 6, \"1,2-3,4-5,6\", \"&gt;=1,[01-03],{4,5},A\")\n\n    If returnMessage &lt;&gt; \"Valid\" Then\n        MsgBox returnMessage\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>After running the code, I got the following message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u7Vjf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u7Vjf.png\" alt=\"enter image description here\"></a></p>\n\n<p>I believe, this code will be helpful for you. I already tested the code and it is OK for me.</p>\n\n<p>If there is any problem or code error, let me know.</p>\n"}], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 32093465, "answer_count": 2, "score": 1, "last_activity_date": 1439981548, "creation_date": 1439953836, "last_edit_date": 1531164843, "question_id": 32085910, "link": "https://stackoverflow.com/questions/32085910/test-string-based-on-specific-rules", "title": "Test string based on specific rules", "body": "<p>I am setting up a transaction system. The user will transact 2D barcodes.\nFor each model, the barcode should meet specific requirements. See the table below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mwEtx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mwEtx.png\" alt=\"enter image description here\"></a></p>\n\n<p>So based on above, <code>PRT0001</code>'s 4th character should be 2, 3, or 4.</p>\n\n<p>For <code>PRT0002</code>, the 4th character should be >=3, the 12th character should be <code>A</code>, the 13th should be <code>A</code> and the 14th should be <code>B</code>.</p>\n\n<p>Now, for <code>PRT0005</code> it is even more complicated.\nThe 5th and 6th characters should go together wherein the value should be in the range of <code>01-52</code> (number of weeks in a year).\nThe 13th and 14th characters should be what's within the list.</p>\n\n<p>Now, I am planning on setting up a table in Access where I'll put all the rules somewhat similar to above format and then just retrieve the rules when the user selects the <code>PartNum</code>.</p>\n\n<p>I am planning on retrieving the <code>CharPos</code> field, transfer it to array which will be the basis of what character position to inspect. Do the same for the <code>CharRes</code> field to get the characters to compare to. Something like:</p>\n\n<pre><code>Dim arr1, arr2, myrules, j, c\nmyrules = rec.GetRows 'I'll retrieve the rules in Access using ADO\n\narr1 = Split(myrule(0, 0), \",\")\narr2 = Split(myrule(1, 0), \",\")\n\nFor j = Lbound(arr1) To Ubound(arr1)\n    c = Mid(barcode, j, 1)\n    If Not c = arr2(j) Then MsgBox \"Invalid\": Exit For\nNext\n</code></pre>\n\n<p>This is ok, considering <code>PRT0004</code> above. However, other rules are a bit complicated. I need to employ a standard way of evaluating the rules so that I can produce a common function or sub routine that I can <em>call</em> within my main sub. I thought I cannot achieve such using above approach.</p>\n\n<p>So my question is, do you guys have any suggestion on how I'll do this better?<br>\nThis maybe too much, but let's just say I'm just consulting my old buddies (the community) which might have a better idea or approach.</p>\n\n<p>BTW, I am limited to using Excel as the front-end (user interface) and Access as the back-end (database).</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1439955375, "post_id": 32085816, "comment_id": 52068003, "body": "Why  &quot; &quot; instead of &quot;&quot;? A string containing a single space isn&#39;t an empty string"}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1439954530, "creation_date": 1439954530, "answer_id": 32085993, "question_id": 32085816, "link": "https://stackoverflow.com/questions/32085816/mandatory-fields-in-userform/32085993#32085993", "title": "Mandatory Fields in Userform", "body": "<p>You probably want to end the procedure when the box has popped up:</p>\n\n<pre><code>If CR_Slide.CRNumber.Text = \" \" Then\nMsgBox \"Complete all fields\"\nEnd\nEnd If\n\nIf CR_Slide.Severity.SelText = \" \" Then\nMsgBox \"Complete all fields\"\nEnd\nEnd If\n</code></pre>\n\n<p>Or maybe <code>Exit Sub</code> instead of <code>End</code></p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1439961185, "post_id": 32086215, "comment_id": 52069656, "body": "I completely missed that the OP was searching for a space. I might add though it&#39;s still a good idea to end the code after the message box otherwise if you have say 5 fields without entries that you test, you will get 5 messages."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1439956491, "last_edit_date": 1439956491, "creation_date": 1439956080, "answer_id": 32086215, "question_id": 32085816, "link": "https://stackoverflow.com/questions/32085816/mandatory-fields-in-userform/32086215#32086215", "title": "Mandatory Fields in Userform", "body": "<p>You are testing if the input is a string consisting of a single space. The fact that you said it \"works the first time for the text box\" suggests that sometimes you do have non-empty white space. You could take the text and first run it through the function <code>trim</code> which will trim any all-white space string down to the empty string, which is the unique string of length 0. Something like:</p>\n\n<pre><code>If Len(Trim(CR_Slide.CRNumber.Value)) = 0 Then\nMsgBox \"Complete all fields\"\nEnd If\n\nIf Len(Trim(CR_Slide.Severity.Value)) = 0 Then\nMsgBox \"Complete all fields\"\nEnd If\n</code></pre>\n\n<p>should work. (I switched from <code>Text</code> to <code>Value</code> since it is standard to get user input via the <code>Value</code> property of the control).</p>\n"}], "owner": {"reputation": 27, "user_id": 5191652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de13d27c7b8253c713b8f24e9aebd62?s=128&d=identicon&r=PG&f=1", "display_name": "Jane90", "link": "https://stackoverflow.com/users/5191652/jane90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8863, "favorite_count": 0, "accepted_answer_id": 32086215, "answer_count": 2, "score": 0, "last_activity_date": 1439956491, "creation_date": 1439952964, "last_edit_date": 1439953754, "question_id": 32085816, "link": "https://stackoverflow.com/questions/32085816/mandatory-fields-in-userform", "title": "Mandatory Fields in Userform", "body": "<p>I have a userform with three fields (textbox, command box and list box) and I am trying to make it so that when you press OK, if all the fields aren't completed you will get an error message. So all three fields should be populated.</p>\n\n<p>I have tried the code below, which initially works for the text box (but if you enter a value and then delete it the message won't pop up again) but doesn't work for the command box.</p>\n\n<p>If someone could help with this, it would be greatly appreciated:</p>\n\n<pre><code>If CR_Slide.CRNumber.Text = \" \" Then\nMsgBox \"Complete all fields\"\nEnd If\n\nIf CR_Slide.Severity.SelText = \" \" Then\nMsgBox \"Complete all fields\"\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 1, "creation_date": 1439953502, "post_id": 32085377, "comment_id": 52067547, "body": "If you just need the value you could do <code>cell.Offset(ColumnOffset:=66).Value2 = cellFound.Offset(ColumnOffset:=1).Value2</code> instead of <code>cell.Offset(ColumnOffset:=66).Copy cellFound.Offset(ColumnOffset:=1)</code>"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1439968513, "post_id": 32085377, "comment_id": 52072821, "body": "Hi may i know what does the .Value2 means in the code statement? @simpLEMAn"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1439968627, "post_id": 32085377, "comment_id": 52072884, "body": "@nabilah - Here are the three primary values for a cell: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217.aspx\" rel=\"nofollow noreferrer\">Range.Text property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">Range.Value property</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553.aspx\" rel=\"nofollow noreferrer\">Range.Value2 property</a>."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1440032585, "post_id": 32085377, "comment_id": 52110103, "body": "Alright thank you so much! :) @Jeeped"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1440035320, "post_id": 32085377, "comment_id": 52110737, "body": "Hi i tried using the method you gave, however i realise that instead of Workbook called Active master file values is being copied to workbook called Singapore dashboard it is copied the other way round. how do i solve this? @simpLEMAn"}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1440071783, "post_id": 32085377, "comment_id": 52127599, "body": "My bad, just invert my answer: <code>cellFound.Offset(ColumnOffset:=1).Value2 = cell.Offset(ColumnOffset:=66).Value2</code>"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 1, "creation_date": 1440406045, "post_id": 32085377, "comment_id": 52241609, "body": "Alright thank you so much! it works! :) @simpLEMAn"}], "owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440059271, "creation_date": 1439949710, "last_edit_date": 1440059271, "question_id": 32085377, "link": "https://stackoverflow.com/questions/32085377/extracting-information-from-external-workbook-without-changing-the-current-excel", "title": "Extracting information from external workbook without changing the current excel borders and format previously created", "body": "<p>Hi I was able to run a code that helps me to run each ID from 2 workbooks and once matched, the information from workbook A called Active master file will be copied to workbook B called Singapore dashboard file. However one problem I faced was that when the value is being copied and put into workbook B, the format is different and it also removed the borders from the table when it was copied to workbook B. Is there any additional code I would need to insert in order for the format of  Workbook B to remain the same when the values are copied.\nThis is the code I have:</p>\n\n<pre><code>    Sub UpdatePar()\n    Dim dashboard As Worksheet\n    Dim master As Worksheet\n    Dim cell As Range\n    Dim cellFound As Range\n\n   Set dashboard = Workbooks(\"Singapore Project Dashboard -Jul 2015.xlsm\").Sheets(\"Projects Details\")\n   Set master = Workbooks(\"Active_Project_List_\u2013_Master_Project(s).xlsm\").Sheets(\"Active Master Project List\")\n\n\n    For Each cell In master.Range(\"G6:G800\")\n        ' Try to find this value in the source sheet\n        Set cellFound = dashboard.Range(\"G:G\").Find(What:=cell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n        If Not cellFound Is Nothing Then\n            ' A matching value was found\n            ' So copy the cell 2 columns across to the cell adjacent to matching value\n            ' Do a \"normal\" copy &amp; paste\n            cell.Offset(ColumnOffset:=66).Copy cellFound.Offset(ColumnOffset:=1)\n            ' Or do a copy &amp; paste special values\n            'cell.Offset(ColumnOffset:=2).Copy\n            'cellFound.Offset(ColumnOffset:=1).PasteSpecial xlPasteValues\n\n        Else\n            ' The value in this cell does not exist in the source\n            ' Should anything be done?\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I hope anyone could assist me with this. Thank you :)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 2885747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bad9cf8449e7c8087cf96ce806321f4?s=128&d=identicon&r=PG&f=1", "display_name": "Z9z9z9", "link": "https://stackoverflow.com/users/2885747/z9z9z9"}, "edited": false, "score": 0, "creation_date": 1439951524, "post_id": 32085465, "comment_id": 52067047, "body": "Perfect! Worked like a charm. Thank you! I&#39;ll take note of that."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1439950505, "creation_date": 1439950505, "answer_id": 32085465, "question_id": 32085353, "link": "https://stackoverflow.com/questions/32085353/find-value-in-the-last-cell-based-on-column-header/32085465#32085465", "title": "Find value in the last cell based on column header", "body": "<p>The last line before you close off the <code>End If</code> and <code>End With</code> contains <code>Cells(lastRowInSearchColumn, searchColumn).Value</code>. If this supposed to be from the <strong>FIL</strong> worksheet?</p>\n\n<p>You are using a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> but not taking advantage of the parent worksheet reference opportunities that it offers.</p>\n\n<pre><code>Dim headerRow As Long\nDim totalColumnsInHeaderRow As Long\nDim searchColumn As Long\nDim lastRowInSearchColumn As Long\nDim currentColumn As Long\nDim columnSearchString As String\n\nWith Sheets(\"FIL\")\n    headerRow = 9\n    totalColumnsInHeaderRow = .Cells(headerRow, Columns.Count).End(xlToLeft).Column\n    columnSearchString = \"TOTAL\"\n\n    searchColumn = 0\n    For currentColumn = 1 To totalColumnsInHeaderRow\n        If StrComp(.Cells(headerRow, currentColumn).Value, columnSearchString, vbTextCompare) = 0 Then\n            searchColumn = currentColumn\n            Exit For\n        End If\n    Next currentColumn\n\n    If searchColumn &gt; 0 Then\n        'Set F2 equal to the last value in that column\n        lastRowInSearchColumn = .Cells(Rows.Count, searchColumn).End(xlUp).Row\n        Sheets(\"MACRO TEMPLATE\").Range(\"B2\") = _\n            .Cells(lastRowInSearchColumn, searchColumn).Value\n    End If\nEnd With\n</code></pre>\n\n<p>Note that any <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells property</a> need only a period (aka full stop or <code>.</code>) to have its parent worksheet assigned by the worksheet noted with the With ... End With statement. That does not stop you from specifying another worksheet in special circumstances as in the last value transfer target,</p>\n"}], "owner": {"reputation": 71, "user_id": 2885747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bad9cf8449e7c8087cf96ce806321f4?s=128&d=identicon&r=PG&f=1", "display_name": "Z9z9z9", "link": "https://stackoverflow.com/users/2885747/z9z9z9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 32085465, "answer_count": 1, "score": 0, "last_activity_date": 1440359361, "creation_date": 1439949478, "last_edit_date": 1440359361, "question_id": 32085353, "link": "https://stackoverflow.com/questions/32085353/find-value-in-the-last-cell-based-on-column-header", "title": "Find value in the last cell based on column header", "body": "<p>I'm trying to build a macro that can find and copy the last cell based on its column header(\"TOTAL\")(Sheet name: FIL), and copy it to a specific cell(B2) in another sheet(Sheet name: MACRO TEMPLATE). I found a code for it but it doesn't copy the value in the other sheet. I tried tweaking it to make it work but no luck (The code works if the command button on the same sheet(FIL), but if placed in another sheet (MACRO TEMPLATE), the code doesn't work.). </p>\n\n<p>I also have another problem about the code. The cells in which the header is located are merged (rows 9 and 10). Is it possible to search by columns instead of finding the header row so that the merged cells are untouched? Any help will be greatly appreciated.  </p>\n\n<p>Here's the code:</p>\n\n<pre><code>Dim headerRow As Integer\nDim totalColumnsInHeaderRow As Integer\nDim searchColumn As Integer\nDim lastRowInSearchColumn As Integer\nDim columnSearchString As String\nWith Sheets(\"FIL\")\nheaderRow = 9   \ntotalColumnsInHeaderRow = Sheets(\"FIL\").Cells(headerRow, Columns.Count).End(xlToLeft).Column\ncolumnSearchString = \"TOTAL\" \nsearchColumn = 0\n\n\nDim currentColumn As Integer\nFor currentColumn = 1 To totalColumnsInHeaderRow\n\n    If StrComp(Sheets(\"FIL\").Cells(headerRow, currentColumn).value, columnSearchString, vbTextCompare) = 0 Then\n\n        searchColumn = currentColumn\n        Exit For\n    End If\nNext\n\n\nIf searchColumn &gt; 0 Then\n    'Set F2 equal to the last value in that column\n    lastRowInSearchColumn = Sheets(\"FIL\").Cells(Rows.Count, searchColumn).End(xlUp).Row\n    Sheets(\"MACRO TEMPLATE\").Range(\"B2\").value = Cells(lastRowInSearchColumn, searchColumn).value\nEnd If\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1439949331, "post_id": 32085261, "comment_id": 52066479, "body": "Dim the var that gets the return from the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195768%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">InputBox method</a> as a variant. If the variant is equal to &quot;False&quot; (as a string) then you can exit. Actually, I believe it can also be <i>False</i> as a boolean."}], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1439953029, "creation_date": 1439953029, "answer_id": 32085823, "question_id": 32085261, "link": "https://stackoverflow.com/questions/32085261/vba-input-box-error/32085823#32085823", "title": "VBA Input Box Error", "body": "<p>You can detect all three possible results when using <code>InputBox()</code> to return a string. Those three results are:</p>\n\n<ol>\n<li>The user entered a value</li>\n<li>The user clicked <code>[OK]</code> without entering a value</li>\n<li>The user clicked <code>[Cancel]</code> or <code>[X]</code></li>\n</ol>\n\n<p>The <code>StrPtr()</code> function is the key to differentiating between a blank string and a nonexistent one. The following code demonstrates how to identify each scenario:</p>\n\n<pre><code>Dim s As String\ns = InputBox(\"Enter something:\")\n\nIf StrPtr(s) = 0 Then\n    Debug.Print \"[Cancel] or [X] clicked\"\nElseIf Len(s) = 0 Then\n    Debug.Print \"[OK] clicked but nothing entered\"\nElse\n    Debug.Print \"Something entered: \" &amp; s\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5174339, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5354b9ba58c097e5b27c769d2a21930a?s=128&d=identicon&r=PG&f=1", "display_name": "bmyers", "link": "https://stackoverflow.com/users/5174339/bmyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439953477, "creation_date": 1439948875, "last_edit_date": 1439953477, "question_id": 32085261, "link": "https://stackoverflow.com/questions/32085261/vba-input-box-error", "title": "VBA Input Box Error", "body": "<p>I have an input box in my macro that is in a loop.  The numbers <code>1-4</code> correspond to a specific task that the program will do, and <code>5</code> will save and exit the program.</p>\n\n<p>Right now, the input box is in a continuous loop unless the user types in <code>5</code>.  However, I would also like the loop and sub to end if the user hits <code>Cancel</code> or the <code>X</code> button in the upper-right corner of the input box.  When I hit <code>Cancel</code> or <code>X</code>, it gives me an error.</p>\n\n<p>In summary, is it possible to code the <code>Cancel</code> and <code>X</code> keys of the input box to end the loop and exit the sub without an error message?  For example, this is what I have if the user types <code>6</code>:</p>\n\n<pre><code>If ipAnswer = 6 then\n    ActiveWorkbook.Save\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Is there something that would allow me to do:</p>\n\n<pre><code>If 'cancel' or 'x' then\n    .......\nEnd If\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1439948560, "post_id": 32085146, "comment_id": 52066320, "body": "Ordering is discarded when pulling data from a view but the order that the data is retrieved is still subject to primary keys (largely due to the primary key&#39;s clustering). Do you have one or more primary keys that are producing this behavior?"}, {"owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1439949588, "post_id": 32085146, "comment_id": 52066547, "body": "Hi, I don&#39;t have any primary key. Each udf returns a column with around 20 records, each record is an aggregate function sum(x*y) of other level data."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1439949697, "post_id": 32085146, "comment_id": 52066568, "body": "What&#39;s the order you want to get?"}, {"owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1439949806, "post_id": 32085146, "comment_id": 52066608, "body": "There is no order if I run select * from dbo.vTest in SQL Server, however, in excel, the final output has an alphabetical order. I just want excel to display the same as in sql server"}, {"owner": {"reputation": 241702, "user_id": 61305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eVyZv.jpg?s=128&g=1", "display_name": "Aaron Bertrand", "link": "https://stackoverflow.com/users/61305/aaron-bertrand"}, "edited": false, "score": 1, "creation_date": 1439951811, "post_id": 32085146, "comment_id": 52067118, "body": "If you want a specific ordering, add an ORDER BY clause. There is no way to tell Excel to display &quot;the same as in SQL Server&quot; because, by not including an ORDER BY clause, you&#39;re telling SQL Server you don&#39;t. Therefore, the order is not defined. If you want to define it, add an ORDER BY clause. Please <a href=\"http://blogs.sqlsentry.com/aaronbertrand/t-sql-tuesday-56-sql-server-assumptions/\" rel=\"nofollow noreferrer\">read #3 here, thoroughly</a>."}, {"owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1439953489, "post_id": 32085146, "comment_id": 52067542, "body": "Thank you! I think that make sense!"}], "owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439947963, "creation_date": 1439947963, "question_id": 32085146, "link": "https://stackoverflow.com/questions/32085146/sql-view-auto-sort-when-passing-to-excel-ado", "title": "SQL view auto sort when passing to excel ado", "body": "<p>I have a sql view based on 44 udf functions:</p>\n\n<pre><code>  create view vTest\nas\n  select t1.f1, t1.f2,\n  t2,f2, t3.f2,... t44.f2\nfrom \n  (select * from ufn_data(x1))t1 \ninner join \n  (select * from ufn_data(x2))t2 on t1.f1=t2.f1\ninner join \n  (select * from ufn_data(x3))t3 on t1.f1=t3.f1\n......\ninner join\n  (select * from ufn_data(x44))t44 on t1.f1=t44.f1\n</code></pre>\n\n<p>when I'm trying to pass the data to excel using VBA ADO, the view sort automatically alphabetically (which is what I don't want).</p>\n\n<p>the vba code is below:\n     Sub GetView()</p>\n\n<pre><code>Application.ScreenUpdating = False\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nDim cn As ADODB.Connection\n Set cn = New ADODB.Connection\n\nDim strConn As String\nDim sql6 As String\n\n\n  strConn = \"PROVIDER=SQLOLEDB;DATA SOURCE=.\\SQL2005;INITIAL CATALOG=Database1;Persist Security Info=False;User ID=user1;Password=xxxxx;\"\n\n   cn.Open strConn\n\n\n  sql = \"select * from dbo.vTest\"\n\n\n  rs.Open sql, cn, adOpenDynamic, adLockOptimistic\n   With Sheet1.Range(\"a4:as100\")\n    .ClearContents\n    .CopyFromRecordset rs\n\n  End With\n\nrs.Close\ncn.Close\n\nSet rs = Nothing\nSet cn = Nothing\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I wonder what is the way to prevent the view automatically sorting alphabetically when passing to Excel? When I tried other smaller views, it seems to work OK. I wonder how to handle this situation? Thanks a lot for any advice!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "edited": false, "score": 0, "creation_date": 1440432039, "post_id": 32084878, "comment_id": 52258849, "body": "Did either of our answers help solve your problem? If so, then please choose to accept an answer. Thanks!"}, {"owner": {"reputation": 95, "user_id": 1519549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2b248e2ec098dfab303d39bce4f3f1c0?s=128&d=identicon&r=PG", "display_name": "Dexter Raymund De Guia", "link": "https://stackoverflow.com/users/1519549/dexter-raymund-de-guia"}, "reply_to_user": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "edited": false, "score": 0, "creation_date": 1440482512, "post_id": 32084878, "comment_id": 52277954, "body": "Turns out I wrote a VBA code for this one. As for my estimation for future running of the file. This might take quite some time but Thanks all for the Ideas! I&#39;m fairly new to this and your efforts are not wasted. Glad to learn more of this because of people like you. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": false, "score": 0, "last_activity_date": 1439992015, "last_edit_date": 1439992015, "creation_date": 1439946297, "answer_id": 32084921, "question_id": 32084878, "link": "https://stackoverflow.com/questions/32084878/custom-pathing-on-excel-cells/32084921#32084921", "title": "Custom Pathing on Excel Cells", "body": "<p>You will use <code>INDIRECT()</code>. So <code>INDIRECT(path&amp;\"\\attendance\"&amp;now()&amp;\"!G1I13)</code> and it will create a reference from the calculation string concatenation.</p>\n"}, {"tags": [], "owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "is_accepted": true, "score": 0, "last_activity_date": 1439946729, "last_edit_date": 1525816189, "creation_date": 1439946423, "answer_id": 32084935, "question_id": 32084878, "link": "https://stackoverflow.com/questions/32084878/custom-pathing-on-excel-cells/32084935#32084935", "title": "Custom Pathing on Excel Cells", "body": "<p>You need to use the indirect function to garner a reference to the range that Excel recognizes as such instead of recognizing it as a string.</p>\n\n<p>More on that here:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/indirect.htm\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/indirect.htm</a></p>\n\n<p>\"Since Excel sees \"A1:A10\" as a text string rather than a range reference...\"</p>\n\n<p>Fair warning, however... the indirect function can be VERY slow. In the past, I found it much better to use a custom VBA function to do this.</p>\n"}], "owner": {"reputation": 95, "user_id": 1519549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2b248e2ec098dfab303d39bce4f3f1c0?s=128&d=identicon&r=PG", "display_name": "Dexter Raymund De Guia", "link": "https://stackoverflow.com/users/1519549/dexter-raymund-de-guia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 32084935, "answer_count": 2, "score": 0, "last_activity_date": 1439992015, "creation_date": 1439945976, "last_edit_date": 1439947439, "question_id": 32084878, "link": "https://stackoverflow.com/questions/32084878/custom-pathing-on-excel-cells", "title": "Custom Pathing on Excel Cells", "body": "<p>I'm having problems with the right keywords to research for this further. For now I'm having trouble customizing the path for an excel function. Here is my sample code to give you better visualization:</p>\n\n<pre><code>=VLOOKUP([path]\\Attendance &amp; now() &amp; !G1:I13,[paht]\\Attendance &amp; now()-1 &amp; !G:1,1,FALSE)\n</code></pre>\n\n<p>In here you can see that I added <code>now()</code> to specify the file name as the target workbook.</p>\n\n<p>Would this be even possible? I find it faster than doing a VBA macro.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1439939021, "post_id": 32083644, "comment_id": 52064035, "body": "looks like Dmitry has answered your question. Ron De Bruin writes some excellent OL orientated code: <a href=\"https://msdn.microsoft.com/en-us/library/ff519602(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ff519602(v=office.11).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1440010009, "last_edit_date": 1440010009, "creation_date": 1439937348, "answer_id": 32083699, "question_id": 32083644, "link": "https://stackoverflow.com/questions/32083644/reply-all-in-outlook-from-excel-macro/32083699#32083699", "title": "Reply All in Outlook from Excel Macro", "body": "<p>For the plain text, you can do </p>\n\n<pre><code>.Body = \"blah blah hello world\" &amp; vbCrLf &amp; .Body\n</code></pre>\n\n<p>If you want to preserve formatting, you will need to insert your string into the <code>replyall.HTMLBody</code> property (you cannot just concatenate two HTML strings).</p>\n"}], "owner": {"reputation": 77, "user_id": 4023985, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-602vAfp5ikU/AAAAAAAAAAI/AAAAAAAAAEY/2AKXp8Wb9_M/photo.jpg?sz=128", "display_name": "Ryan", "link": "https://stackoverflow.com/users/4023985/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6595, "favorite_count": 2, "accepted_answer_id": 32083699, "answer_count": 1, "score": 3, "last_activity_date": 1611602987, "creation_date": 1439937013, "last_edit_date": 1592694703, "question_id": 32083644, "link": "https://stackoverflow.com/questions/32083644/reply-all-in-outlook-from-excel-macro", "title": "Reply All in Outlook from Excel Macro", "body": "<p>When you click reply all in outlook, it will open a new email box, but show the previous email thread underneath the body of your email. I am trying to Reply All to the selected email in outlook and input information. I want to do this all from a Macro in Excel. My problem is that if I try to write in the body of the Reply All, it erases the entire previous email thread.</p>\n\n<pre><code>Sub test()\n\nDim mail 'object/mail item iterator\nDim replyall 'object which will represent the reply email\n\nFor Each mail In Outlook.Application.ActiveExplorer.Selection\n    If mail.Class = olMail Then\n        Set replyall = mail.replyall\n        With replyall\n            '.Body = \"blah blah hello world\"  '&lt;-- uncomment and it will delete the thread\n            .Display\n        End With\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Note: the closest I've come is this, but it deletes my signature, the email separator, and the header info from the latest email:</p>\n\n<pre><code>.Body = \"blah blah hello world\" &amp; mail.body\n</code></pre>\n\n<p>Any solutions are appreciated! Thanks!</p>\n"}, {"tags": ["linq", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1439936561, "post_id": 32083502, "comment_id": 52063256, "body": "Perhaps you should edit your question and include your query.  That way, we don&#39;t have to guess what you are doing."}, {"owner": {"reputation": 512, "user_id": 3966654, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0c110e2000319f70cf1a4dd495cdc5a4?s=128&d=identicon&r=PG&f=1", "display_name": "RobertPorter", "link": "https://stackoverflow.com/users/3966654/robertporter"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1439937147, "post_id": 32083502, "comment_id": 52063435, "body": "my query is just &quot;select Id, Category, Points, Place from sometable&quot;, you would like to see results of a query?"}, {"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "edited": false, "score": 1, "creation_date": 1439942398, "post_id": 32083502, "comment_id": 52064935, "body": "Can you please post sample data and expected output?"}, {"owner": {"reputation": 49560, "user_id": 119477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/838f94e4247f0740e8be0cc6a9900278?s=128&d=identicon&r=PG", "display_name": "Conrad Frix", "link": "https://stackoverflow.com/users/119477/conrad-frix"}, "edited": false, "score": 0, "creation_date": 1440015684, "post_id": 32083502, "comment_id": 52104402, "body": "You should probably consider what to do for ties. e.g on ties for 2nd you could do (1,2,2,4) or you could do  (1,2,2,3). Also going from .net to access-vba is ... unpleasant. Is there any reason you can just use .net as the client?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5384454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a12bb646d68c3234f8c5cd7c3f7d37?s=128&d=identicon&r=PG&f=1", "display_name": "Papa Bear", "link": "https://stackoverflow.com/users/5384454/papa-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1443439271, "creation_date": 1443439271, "answer_id": 32821751, "question_id": 32083502, "link": "https://stackoverflow.com/questions/32083502/ms-access-visual-basic-group-recordset-and-modify-values/32821751#32821751", "title": "MS Access Visual Basic Group Recordset and modify values", "body": "<p>Not sure what you mean by separate SQL requests.  In VBA, you could use a single SQL request to fill a temp table with your data (plus an empty \"PLACE\" column), then use a recordset based on a similar query (like yours but against the temp table with \"ORDER BY Category, Points DESC\" added).  Then loop through that recordset and assign the score (using recordset.edit &amp; .update etc.).  (But if you're a .Net programmer, I'm probably not telling you anything you don't already know...)</p>\n"}, {"tags": [], "owner": {"reputation": 512, "user_id": 3966654, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0c110e2000319f70cf1a4dd495cdc5a4?s=128&d=identicon&r=PG&f=1", "display_name": "RobertPorter", "link": "https://stackoverflow.com/users/3966654/robertporter"}, "is_accepted": true, "score": 0, "last_activity_date": 1443647876, "creation_date": 1443647876, "answer_id": 32875803, "question_id": 32083502, "link": "https://stackoverflow.com/questions/32083502/ms-access-visual-basic-group-recordset-and-modify-values/32875803#32875803", "title": "MS Access Visual Basic Group Recordset and modify values", "body": "<p>After reading documentation thoroughly I found that I would have to do a lot of sorting and grouping by hand so I eventually decided it is not worth it and switched to writing a desktop C# app which operated on this database. From there everything was obvious and a lot faster</p>\n"}], "owner": {"reputation": 512, "user_id": 3966654, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0c110e2000319f70cf1a4dd495cdc5a4?s=128&d=identicon&r=PG&f=1", "display_name": "RobertPorter", "link": "https://stackoverflow.com/users/3966654/robertporter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 32875803, "answer_count": 2, "score": 0, "last_activity_date": 1443647876, "creation_date": 1439936295, "last_edit_date": 1440021671, "question_id": 32083502, "link": "https://stackoverflow.com/questions/32083502/ms-access-visual-basic-group-recordset-and-modify-values", "title": "MS Access Visual Basic Group Recordset and modify values", "body": "<p>I have an Access Database where I have a defined query.</p>\n\n<p>This query has 3 fields \"Category\", \"Points\" and \"Place\"\nMultiple records can have the same Category entry.</p>\n\n<p>What I now need to do is group query records by \"Category\".\nIn each of these subgroups order by \"Points\"\nEdit \"Place\" in subgroup starting from \"1st\" and going to \"2nd\" and so on.\nRepeat for next group till there are no more groups.</p>\n\n<p>Maybe it will be easier if I say that the purpose is to assign awards (1st award, 2nd, 3rd (and so on) in different age groups according to points scored by a player).</p>\n\n<p>I am a .NET programmer so I Immediately thought about LINQ but there is no linq here;/</p>\n\n<p>Is there any other better way than to do separate sql requests and then sorting by Points?</p>\n\n<p>Ok so here is the recordset I have (with Place column already filled, originally its empty and this is how it should be filled):</p>\n\n<p>ID    CATEGORY    POINTS    PLACE<br /> \n----------------------------------<br /> \n1  &emsp;CAT1    &emsp;&emsp;&emsp;8   &nbsp; &emsp;&emsp;&emsp;2<br /> \n1  &emsp;CAT1    &emsp;&emsp;&emsp;10    &emsp;&emsp;&emsp;1 <br /> \n1  &emsp;CAT2    &emsp;&emsp;&emsp;12    &emsp;&emsp;&emsp;2<br /> \n1   &emsp;CAT2   &emsp;&emsp;&emsp;11    &emsp;&emsp;&emsp;3<br /> \n1   &emsp;CAT2   &emsp;&emsp;&emsp;13    &emsp;&emsp;&emsp;1<br /> \n1   &emsp;CAT3   &emsp;&emsp;&emsp;12    &emsp;&emsp;&emsp;1<br /> \n1   &emsp;CAT3   &emsp;&emsp;&emsp;9    &nbsp; &emsp;&emsp;&emsp;3<br /> \n1   &emsp;CAT3   &emsp;&emsp;&emsp;3    &nbsp; &emsp;&emsp;&emsp;4<br /> \n1  &emsp;CAT3    &emsp;&emsp;&emsp;10   &emsp;&emsp;&emsp;2<br /> </p>\n\n<p>I don't know up front how many categories are there.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3777693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a283bea7135abd768c242afa3720cf4b?s=128&d=identicon&r=PG&f=1", "display_name": "user65795", "link": "https://stackoverflow.com/users/3777693/user65795"}, "edited": false, "score": 0, "creation_date": 1439936242, "post_id": 32083345, "comment_id": 52063142, "body": "Thanks @Bond that works. I realize now what was going on. Actually now I have your first answer as the method I&#39;m using. Thank you."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1439935490, "creation_date": 1439935490, "answer_id": 32083345, "question_id": 32083316, "link": "https://stackoverflow.com/questions/32083316/why-does-this-vba-msgbox-always-return-zero/32083345#32083345", "title": "Why does this vba MsgBox always return zero?", "body": "<p><code>=</code> is used both as an assignment operator and a comparison operator in VBA. You can't assign and compare in a single statement (at least not without the unexpected results you're getting). Separate the assignment from the comparison:</p>\n\n<pre><code>Do Until RunThis = False\n    strCheckFolders = MsgBox(\"Do you want to check folders for reports to print?\", vbYesNo, \"Check for Reports to Print\")\n    If strCheckFolders = vbNo Then RunThis = False\nLoop\n</code></pre>\n\n<p>You could even remove the need for <code>strCheckFolders</code> altogether:</p>\n\n<pre><code>Do Until RunThis = False\n    If MsgBox(\"Do you want to check folders for reports to print?\", vbYesNo, _\n        \"Check for Reports to Print\") = vbNo Then RunThis = False\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 3777693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a283bea7135abd768c242afa3720cf4b?s=128&d=identicon&r=PG&f=1", "display_name": "user65795", "link": "https://stackoverflow.com/users/3777693/user65795"}, "edited": false, "score": 0, "creation_date": 1440736589, "post_id": 32083501, "comment_id": 52406001, "body": "That&#39;s actually the same answer as above. No difference, except that you added &quot;End If&quot; on a separate line and you wouldn&#39;t really need to do that if you don&#39;t have another &quot;Else&quot; statement. I was looking for the shortest solution and the one marked as the solution(by Bond) is the best one offered."}], "tags": [], "owner": {"reputation": 43, "user_id": 5216907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDzrG.jpg?s=128&g=1", "display_name": "robosheep", "link": "https://stackoverflow.com/users/5216907/robosheep"}, "is_accepted": false, "score": 0, "last_activity_date": 1439936289, "creation_date": 1439936289, "answer_id": 32083501, "question_id": 32083316, "link": "https://stackoverflow.com/questions/32083316/why-does-this-vba-msgbox-always-return-zero/32083501#32083501", "title": "Why does this vba MsgBox always return zero?", "body": "<p>I would place the MsgBox in an if statement. Then based on the result do an action</p>\n\n<pre><code>Do Until RunThis = False\nIf MsgBox(\"Do you want to check folders for reports to print?\", vbYesNo) = vbNo Then\n    RunThis = False\nEnd If\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3777693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a283bea7135abd768c242afa3720cf4b?s=128&d=identicon&r=PG&f=1", "display_name": "user65795", "link": "https://stackoverflow.com/users/3777693/user65795"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 32083345, "answer_count": 2, "score": 1, "last_activity_date": 1439936289, "creation_date": 1439935340, "last_edit_date": 1439935765, "question_id": 32083316, "link": "https://stackoverflow.com/questions/32083316/why-does-this-vba-msgbox-always-return-zero", "title": "Why does this vba MsgBox always return zero?", "body": "<p>I have a VBA <code>MsgBox</code> with <code>vbYesNo</code> as the button-type but no matter what button is pushed it always shows a return result as zero. Sorry this isn't the entire code but the below code is a portion of the code that is giving me trouble.</p>\n\n<pre><code>Sub testMsg()\n\nDim strCheckFolders As Integer ' &lt;== vbyesno MsgBoxResult (7 = no, 6 = yes)\nDim RunThis As Boolean\n\nRunThis = True\n\nDo Until RunThis = False\n    If strCheckFolders = MsgBox(\"Do you want to check folders for reports to print?\", _\n    vbYesNo, \"Check for Reports to Print\") = vbNo Then RunThis = False\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Basically what I'm trying to do is write this loop without using the standard phrase <code>if x=vbNo then Exit Sub</code>. I'd rather try to let it run it's course. But that would only work if <code>MsgBox</code> could change the value of <code>RunThis</code> to <code>False</code>. </p>\n\n<p>Any help is really appreciated. </p>\n"}]