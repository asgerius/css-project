[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1459382219, "creation_date": 1459382219, "answer_id": 36321860, "question_id": 36321724, "link": "https://stackoverflow.com/questions/36321724/how-to-add-sheet-if-name-doesnt-exist-loop/36321860#36321860", "title": "How to Add Sheet if Name doesn&#39;t Exist Loop", "body": "<p>Just wrap it in a <code>Do</code>...<code>Loop</code> and exit after you find a unique name:</p>\n\n<pre><code>Sub partA()\n    Dim State As Worksheet\n    Dim StateName As String\n    Dim NameExist As Boolean\n    Dim HQ As String\n    Dim BO As Integer\n    Dim Sales As Integer\n\n    'Asking for sheet name and then adding one if there is no match\n    Do\n        StateName = InputBox(\"Please Enter a State Name\", \"State Name\")\n        NameExist = False\n        For Each State In ActiveWorkbook.Worksheets\n            If UCase(StateName) = UCase(State.Name) Then\n                NameExist = True\n                MsgBox \"Worksheet \" &amp; StateName &amp; \" Exists\"\n                Exit For\n            End If\n        Next State\n    Loop Until NameExist = False\n\n    Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = StateName\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120, "user_id": 5228994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHICl.png?s=128&g=1", "display_name": "Jhony Donosso Gutierrez", "link": "https://stackoverflow.com/users/5228994/jhony-donosso-gutierrez"}, "is_accepted": false, "score": -2, "last_activity_date": 1459382845, "creation_date": 1459382845, "answer_id": 36321967, "question_id": 36321724, "link": "https://stackoverflow.com/questions/36321724/how-to-add-sheet-if-name-doesnt-exist-loop/36321967#36321967", "title": "How to Add Sheet if Name doesn&#39;t Exist Loop", "body": "<p>Maybe this Sub and this Function could you help.</p>\n\n<pre><code>Function Find_Sheet(Name_Sheet As String) As Boolean\n    For i = 1 To Worksheets.Count\n        If Worksheets(i).Name = Name_Sheet Then\n                   Find_Sheet = True\n            Exit Function\n        End If\n    Next\n    Find_Sheet = False\nEnd Function\n\nSub MySub()\n\nDim Name_Sheet As String\nName_Sheet = Range(\"a1\").Value\nVar = Find_Sheet(Name_Sheet)\nIf Var = True Then\n    MsgBox \"It Sheet Exists\"\nElse\n    Sheets.Add After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = Name_Sheet\n    MsgBox \"Sheet \" &amp; Name_Sheet &amp; \" was created\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1459397218, "creation_date": 1459397218, "answer_id": 36323962, "question_id": 36321724, "link": "https://stackoverflow.com/questions/36321724/how-to-add-sheet-if-name-doesnt-exist-loop/36323962#36323962", "title": "How to Add Sheet if Name doesn&#39;t Exist Loop", "body": "<p>Better to test directly for the sheet existing than looping over every sheet.</p>\n\n<p>Also I have removed redundant variables, and changed your InputBox (to force a string).</p>\n\n<pre><code>Sub ReCut()\nDim State As Worksheet\nDim StateName As String\n\nStateName = Application.InputBox(\"Case Sensitive\", \"Please Enter a State Name\", , , , , , 2)\nOn Error Resume Next\nSet State = Sheets(StateName)\nOn Error GoTo 0\n\nIf State Is Nothing Then\n    Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = StateName\nElse\n    MsgBox \"Worksheet \" &amp; StateName &amp; \" Exists\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5189236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a636e7b690f968a6556e20a4fabe9fd0?s=128&d=identicon&r=PG&f=1", "display_name": "jf12345", "link": "https://stackoverflow.com/users/5189236/jf12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 36321860, "answer_count": 3, "score": 1, "last_activity_date": 1459397265, "creation_date": 1459381443, "last_edit_date": 1459397265, "question_id": 36321724, "link": "https://stackoverflow.com/questions/36321724/how-to-add-sheet-if-name-doesnt-exist-loop", "title": "How to Add Sheet if Name doesn&#39;t Exist Loop", "body": "<p>Hi I am trying to create a loop to see if an input matches an existing sheet's name. </p>\n\n<p>If it does, then I want the sub to restart (So the user is asked for a new state).</p>\n\n<p>If the input does not have a match, then I want a new sheet to be added. I have most of it done, but when it creates a new sheet, it r-eloops and just adds blank sheets. </p>\n\n<p>Please let me know your thoughts!!</p>\n\n<pre><code>Sub partA()\nDim State As Worksheet\nDim StateName As String\nDim NameExist As Boolean\nDim HQ As String\nDim BO As Integer\nDim Sales As Integer\n\nOn Error Resume Next\n'Asking for sheet name and then adding one if there is no match\nStateName = InputBox(\"Please Enter a State Name\", \"State Name\")\n\n  For Each State In ActiveWorkbook.Worksheets\n        If UCase(StateName) = UCase(State.Name) Then\n           NameExist = True\n    MsgBox \"Worksheet \" &amp; StateName &amp; \" Exists\"\n           ElseIf NameExist = False Then\n            Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = StateName\n        End If\n    Next State\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459376984, "post_id": 36320872, "comment_id": 60265048, "body": "If the <code>Cells(Q, &quot;C&quot;).Value = Firstname</code> and <code>Cells(Q, &quot;D&quot;).Value = secondName</code> commands left the &quot;/&quot; character in &quot;C&quot; and &quot;D&quot; that is fine, as I plan on deleting all of those characters from rows &quot;C&quot; and &quot;D&quot; afterwards."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459377083, "post_id": 36320872, "comment_id": 60265086, "body": "If you used <code>instr</code>, you can figure this out ~_^. Think about it some more. Hint: you need another <code>instr</code>."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1459377132, "post_id": 36320872, "comment_id": 60265105, "body": "Hmm, I will ponder this on my drive home and continue this issue at home."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1459377174, "post_id": 36320872, "comment_id": 60265123, "body": "Hint 2: <code>instr</code> takes 3 arguments."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1459377335, "post_id": 36320872, "comment_id": 60265188, "body": "First day ever using <code>instr</code>. VBA has quite a learning curve (for me at least) haha."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1459378301, "post_id": 36320872, "comment_id": 60265523, "body": "Forget Instr and use the <a href=\"https://msdn.microsoft.com/en-us/library/aa263365(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Split function</a>."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459386345, "post_id": 36320872, "comment_id": 60267971, "body": "@findwindow I went with the split function as <code>instr</code> was just giving me a headache trying to get it to work."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459436164, "post_id": 36320872, "comment_id": 60295761, "body": "<code>split</code> is better."}], "answers": [{"comments": [{"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459386003, "post_id": 36321155, "comment_id": 60267887, "body": "This worked absolutely perfect. Thank you very much!"}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459386075, "post_id": 36321155, "comment_id": 60267906, "body": "&quot;Other Team&quot; was just a typo being not in all caps btw."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1459378410, "creation_date": 1459378410, "answer_id": 36321155, "question_id": 36320872, "link": "https://stackoverflow.com/questions/36320872/vba-pulling-names-from-fields-using-instr-and-left-right/36321155#36321155", "title": "vba pulling names from fields using instr and left/right", "body": "<p>Since you have a delimited string, I'd personally use the <code>Split</code> function.  Note also that your <code>If UCase(Cells(Q, \"B\").Value) Like \"*Other Team*\" Then</code> test fails on every input in your sample data - it is only true  for the column header that you skip, <em>assuming</em> that you change the test to uppercase like you do the input.  If you're trying to determine if you're on the correct worksheet, it needs to go outside of the loop.</p>\n\n<p>Something like this:</p>\n\n<pre><code>If UCase$(Cells(1, \"B\").Value) Like \"*OTHER TEAM*\" Then\n    Dim tokens() As String\n    For Q = 2 To 10\n        Name = Cells(Q, \"B\").Value\n        tokens = Split(Name, \"/\")\n        If UBound(tokens) &gt; 0 Then Cells(Q, \"C\").Value = tokens(1)\n        If UBound(tokens) &gt; 1 Then Cells(Q, \"D\").Value = tokens(2)\n    Next Q\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459416411, "creation_date": 1459416411, "answer_id": 36329351, "question_id": 36320872, "link": "https://stackoverflow.com/questions/36320872/vba-pulling-names-from-fields-using-instr-and-left-right/36329351#36329351", "title": "vba pulling names from fields using instr and left/right", "body": "<p>just to put in a \"formula\" approach</p>\n\n<p>Sub main()</p>\n\n<pre><code>If UCase$(Cells(1, \"B\").Value) Like \"*OTHER TEAM*\" Then\n    Range(\"c2:c10\").FormulaR1C1 = \"=MID(RC2,2,SEARCH(\"\"/\"\",RC2,2)-2)\"\n    Range(\"d2:d10\").FormulaR1C1 = \"=IF(ISNUMBER(SEARCH(\"\"/\"\",RC2,SEARCH(\"\"/\"\",RC2,2)+1)),MID(RC2,SEARCH(\"\"/\"\",RC2,2)+1,SEARCH(\"\"/\"\",RC2,SEARCH(\"\"/\"\",RC2,2)+1)-SEARCH(\"\"/\"\",RC2,2)-1),\"\"\"\")\"\nEnd If\n</code></pre>\n\n<p>a more \"clear\" format of which could be</p>\n\n<pre><code>Dim str1 As String, str2 As String, formula1 As String, formula2 As String\n\nstr1 = \"SEARCH(\"\"/\"\",RC2,2)\"\nstr2 = \"SEARCH(\"\"/\"\",RC2,\" &amp; str1 &amp; \"+1)\"\nformula1 = \"=MID(RC2,2,\" &amp; str1 &amp; \"-2)\"\nformula2 = \"=IF(ISNUMBER(\" &amp; str2 &amp; \"),MID(RC2,\" &amp; str1 &amp; \"+1,\" &amp; str2 &amp; \"-\" &amp; str1 &amp; \"-1),\"\"\"\")\"\n\nIf UCase$(Cells(1, \"B\").Value) Like \"*OTHER TEAM*\" Then\n    Range(\"c2:c10\").FormulaR1C1 = formula1\n    Range(\"d2:d10\").FormulaR1C1 = formula2\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 36321155, "answer_count": 2, "score": 0, "last_activity_date": 1459416411, "creation_date": 1459376906, "question_id": 36320872, "link": "https://stackoverflow.com/questions/36320872/vba-pulling-names-from-fields-using-instr-and-left-right", "title": "vba pulling names from fields using instr and left/right", "body": "<p>Me again everyone. I am trying to pull various strings and place a string in a separate field. I cannot seem to get my code to work and I am hoping someone can shine some light in my flawed attempts. Thank you very much.</p>\n\n<p>I have column \"B\" which includes multiple names and is in the following format:</p>\n\n<pre><code>       B                    C         D\n   Other Team            teamOne     teamTwo\n /jdoe/smithjr/\n /someguy/testuser/\n /obiwan/luke/darth\n /vader/\n /hp/dell/lenova/mint/\n</code></pre>\n\n<p>I only need to take the first two names and place one name in one field and one name in another field.</p>\n\n<p>Expected results</p>\n\n<pre><code>       B                    C         D\n   Other Team            teamOne     teamTwo\n /jdoe/smithjr/            jdoe       smithjr\n /someguy/testuser/       someguy     testuser\n /obiwan/luke/darth        obiwan     luke\n /vader/                   vader\n /hp/dell/lenova/mint/     hp         dell\n</code></pre>\n\n<p>The code I have come up with so far is below and does not work. I receive errors that there is no data to replace.</p>\n\n<pre><code>For Q = 2 To 10\nIf UCase(Cells(Q, \"B\").Value) Like \"*Other Team*\" Then\n  Name = Cells(Q, \"B\").Value\n  startingPosition = InStr(Name, \"/\")\n  Firstname = Left(Name, (startingPosition) - 1)\n  secondName = Right(Name, startingPosition - 2)\n  Cells(Q, \"C\").Value = Firstname\n  Cells(Q, \"D\").Value = secondName\nEnd If\nNext Q\n</code></pre>\n\n<p>I am pretty new to VBA (on 3rd day) and cannot seem to figure out how to parse this data. Perhaps someone can explain what I am doing wrong and assist me? Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459375956, "post_id": 36320580, "comment_id": 60264647, "body": "Try <code>cstr</code> on <code>wbname</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459376244, "post_id": 36320580, "comment_id": 60264758, "body": "Are you certain? Use debugger to verify the value assigned in <code>wbName</code> is what you think it is."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459376463, "post_id": 36320580, "comment_id": 60264841, "body": "This works for me using right-to-left, or left-to-right."}, {"owner": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 1, "creation_date": 1459376467, "post_id": 36320580, "comment_id": 60264842, "body": "yeah.. used both the debugger and msgbox, both say wbName eqaules to &quot;30.3.16&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459376541, "post_id": 36320580, "comment_id": 60264868, "body": "Try <code>wbName = &quot;&quot;&quot;&quot; &amp; ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;M145&quot;).value  &amp; &quot;&quot;&quot;&quot;</code>?"}, {"owner": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 0, "creation_date": 1459376713, "post_id": 36320580, "comment_id": 60264937, "body": "Nope.. still doesn&#39;t work"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459377488, "post_id": 36320580, "comment_id": 60265242, "body": "I suggest an alternative answer, but also curious what happens if you hard-code it: <code>fName = Application.GetSaveAsFilename(&quot;31.3.16&quot;)</code> -- if <i>that</i> works, then maybe @Jeeped answer below will help, though you&#39;re casting to a <code>String</code> type already and that is not raising any error..."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1459466549, "post_id": 36320580, "comment_id": 60312520, "body": "i found this, by trying different things and reading microsoft help : <code>?Application.GetSaveAsFilename(&quot;31&quot;,&quot;MyFormat (*.3.16),*.3.16&quot;)</code> in the immediate window.  So you can adapt it by adding a <code>If Instr(wbName,&quot;.&quot;)&gt;0 then ...</code>"}, {"owner": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 0, "creation_date": 1459586159, "post_id": 36320580, "comment_id": 60360633, "body": "Hello Patrick, thanks you for your effort. I am not sure I understood the method that you had suggested.  Instr(wbName,&quot;.&quot;)&gt;0 will always return True since it always refers to a cell that contains a date."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 0, "creation_date": 1459377648, "post_id": 36320925, "comment_id": 60265303, "body": "You&#39;re welcome. Still curious to know what happens if you hardcode it as: <code>fName = Application.GetSaveAsFilename(&quot;31.3.16&quot;)</code>?"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 6, "last_activity_date": 1459377170, "creation_date": 1459377170, "answer_id": 36320925, "question_id": 36320580, "link": "https://stackoverflow.com/questions/36320580/saveas-wont-accept-strings-that-contain-in-excel-vba/36320925#36320925", "title": "SaveAs won&#39;t accept strings that contain &quot;.&quot; in Excel VBA", "body": "<p>While I'm not able to replicate the error, perhaps you will have better luck with a <code>FileDialog</code> object:</p>\n\n<pre><code>Dim wb As Workbook\nDim wbName As String\nDim fdlg As FileDialog\n\nwbName = ThisWorkbook.Sheets(\"Sheet1\").Range(\"M145\").value \n\nSet fdlg = Application.FileDialog(msoFileDialogSaveAs)\nWith fdlg\n    .InitialFileName = wbName\n    .Show\n    Set wb = Workbooks.Add\n    On Error Resume Next 'Suppress any errors due to invalid filename, etc.\n    wb.SaveAs(fdlg.SelectedItems(1))\n    If Err.Number &lt;&gt; 0 Then  \n        MsgBox \"Publish couldn't be completed since you didn't choose where to save the file.\"\n        wb.Close False  'Get rid of the workbook since it's not being saved\n        Exit Sub\n    End If\n    On Error GoTo 0 'Resume normal error handling\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459377582, "post_id": 36320966, "comment_id": 60265277, "body": "Good stuff but OP is casting to a <code>String</code> type already, and has verified via debugger that <code>wbName</code> contains string, so I&#39;m not sure the Date/Long data type would cause this behavior with the <code>InitialFileName</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1459377825, "post_id": 36320966, "comment_id": 60265364, "body": "The way the fName is treated will depend somewhat on what the computer&#39;s short date is set to display but I feel that the .Text property is more universal than the .Value because it is giving you what the worksheet shows, not the formula bar. Additionally, my experiments were chopping off the .yy when used with a <code>*.*</code> file filter."}, {"owner": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 0, "creation_date": 1459412173, "post_id": 36320966, "comment_id": 60277963, "body": "I actually tried to use .Text and it gave me the same results"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 0, "creation_date": 1459412516, "post_id": 36320966, "comment_id": 60278166, "body": "@Sergey - ... and you specified one or more of the workbook file extension filters? e.g <b>not</b> <code>*.*</code>"}, {"owner": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "edited": false, "score": 0, "creation_date": 1459413078, "post_id": 36320966, "comment_id": 60278516, "body": "I am quite new to VBA so I don&#39;t exactly understand what your filefilter does, but I got the same result when I ran your code.. still no file name in the SaveAs prompt.."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1459377370, "creation_date": 1459377370, "answer_id": 36320966, "question_id": 36320580, "link": "https://stackoverflow.com/questions/36320580/saveas-wont-accept-strings-that-contain-in-excel-vba/36320966#36320966", "title": "SaveAs won&#39;t accept strings that contain &quot;.&quot; in Excel VBA", "body": "<p>There two things going on here.</p>\n\n<p>First, M145 likely contains a date that has been given a format mask of <code>dd\\.mm\\.yy</code>. To get that displayed value out of the cell and into a variable you need the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217.aspx\" rel=\"nofollow\">Range.Text property</a>, not the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow\">Range.Value property</a>.</p>\n\n<p>Second, the default filetype for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195734.aspx\" rel=\"nofollow\">Application.GetSaveAsFilename method</a> is <code>*.*</code> which means that it is going to accept the <code>.yy</code> as the file extension. You need to limit the available file extensions to Excel file types.</p>\n\n<pre><code>Dim wb As Workbook\nDim wbName As String, fName As Variant  'variant in case user clicks Cancel\n\nwbName = ThisWorkbook.Sheets(\"Sheet1\").Range(\"M145\").Text\n\nWith Application\n    fName = .GetSaveAsFilename(InitialFileName:=wbName, _\n                               FileFilter:=\"Excel Workbook (*.xlsx), *.xlsx,\" &amp; _\n                                           \"Macro Workbook (*.xlsm), *.xlsm,\" &amp; _\n                                           \"Binary Workbook (*.xlsb), *.xlsb\")\nEnd With\n</code></pre>\n\n<p>That gets you past the problems with your filename selection. However, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow\">Workbook.SaveAs method</a> should also provide the correct <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198017.aspx\" rel=\"nofollow\">XlFileFormat Enumeration</a>.</p>\n\n<pre><code>Select Case fName\n    Case False\n        'user clicked Cancel or Close (\u00d7)\n        Debug.Print fName\n    Case Else\n        With Workbooks.Add\n            Select Case Right(fName, 5)\n                Case \".xlsx\"\n                    .SaveAs Filename:=fName, FileFormat:=xlOpenXMLWorkbook\n                Case \".xlsm\"\n                    .SaveAs Filename:=fName, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n                Case \".xlsb\"\n                    .SaveAs Filename:=fName, FileFormat:=xlExcel12\n                Case Else\n                    'there really shouldn't be a case else\n            End Select\n        End With\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6018803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bbaf925d7fd3ad3910fb97dafe8254c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6018803/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 36320925, "answer_count": 2, "score": 3, "last_activity_date": 1523783291, "creation_date": 1459375545, "last_edit_date": 1523783291, "question_id": 36320580, "link": "https://stackoverflow.com/questions/36320580/saveas-wont-accept-strings-that-contain-in-excel-vba", "title": "SaveAs won&#39;t accept strings that contain &quot;.&quot; in Excel VBA", "body": "<p>I am using the following code in order to add a new workbook,save and name the workbook (based on a date which is located in a certain cell in the sheet).</p>\n\n<pre><code>Dim wb As Workbook\nDim wbName As String\nwbName = ThisWorkbook.Sheets(\"Sheet1\").Range(\"M145\").value \n\n\n    fName = Application.GetSaveAsFilename(wbName)\n    If fName = False Then\n        MsgBox \"Publish couldn't be completed since you didn't choose where to save the file.\"\n        Exit Sub\n    Else\n        Set wb = Workbooks.Add\n        wb.SaveAs (fName)\n    End If\n</code></pre>\n\n<p>But it seems that whenever cell \"M145\" contains dots (\".\")  as in \"31.3.16\", my file name doesn't appear in the SaveAs prompt and I see a blank line without\nany error message.</p>\n\n<p>I don't think that this has anything to do with it, but my sheet is right-to-left. Does anyone has an idea on how to fix this?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1459379072, "creation_date": 1459379072, "answer_id": 36321291, "question_id": 36320265, "link": "https://stackoverflow.com/questions/36320265/mail-merge-vba-access-2016-runtime-error-287/36321291#36321291", "title": "Mail Merge VBA - Access 2016 (Runtime Error 287)", "body": "<p>Your best choice will be to convert these old .dot files to the newer .dotx format.</p>\n\n<p>If this isn't feasible, try unblocking these old formats in Word Options / Trust Center / File Block Settings</p>\n\n<p>see <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2016-word/word-2016-cannot-open-documents-with-doc/bf12fa10-4e28-4a6b-99b2-d42c1aa8cb4b/\" rel=\"nofollow\">http://answers.microsoft.com/en-us/office/forum/office_2016-word/word-2016-cannot-open-documents-with-doc/bf12fa10-4e28-4a6b-99b2-d42c1aa8cb4b/</a></p>\n\n<p>You may also need to set <code>G:</code> as trusted location (I assume that's a network drive).</p>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 36321291, "answer_count": 1, "score": 0, "last_activity_date": 1594642465, "creation_date": 1459374139, "last_edit_date": 1594642465, "question_id": 36320265, "link": "https://stackoverflow.com/questions/36320265/mail-merge-vba-access-2016-runtime-error-287", "title": "Mail Merge VBA - Access 2016 (Runtime Error 287)", "body": "<p>Our company has recently undergone a big upgrade from office 2010 to 2016, and now we are having an issue with one of our VBA macros, shown below.</p>\n\n<pre><code>Function MergeIt()\nDim objWord As Word.Document\nDim SaveAsName As String\nDim Year As String\nDim DANo As String\nDim Revision As String\nDim strSource As String\n\nSet objWord = GetObject(\"G:\\Dev_&amp;_Tech_Serv\\Development\\DAAssessTool\\MailMerge1.dot\", \"Word.Document\")\n' Make Word visible.\nobjWord.Application.Visible = True\n'Set the mail merge data source as the DAApproval Database.\nobjWord.MailMerge.OpenDataSource Name:=\"G:\\Dev_&amp;_Tech_Serv\\Development\\DAAssessTool\" &amp; \"\\DARevD.mdb\", LinkToSource:=True, Connection:=\"QUERY qry_Mailmerge\", SQLStatement:=\"Select * from [DAConCheckID]\"\n' Execute the mail merge.\nobjWord.MailMerge.Execute\n' Close the original form document\nobjWord.Saved = True\nobjWord.Close (False)\nEnd Function\n</code></pre>\n\n<p>The error is throwing at the first Set line - throwing a Runtime error 287 \"Application defined or object defined error\". I'm making the assumption that the previous developer is incorrectly defining the Word document, but I cant find anything online that shows a different method of defining, or how to fix this error.</p>\n\n<p>I now turn to the vast knowledge of the Stack community for some inspiration on what is going wrong, and how to remedy it.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1459372357, "post_id": 36319732, "comment_id": 60262967, "body": "Should you be searching for <code>dFreq.Value</code>?"}, {"owner": {"reputation": 15496, "user_id": 5792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8b7f62698a5d33a0bf49f47118d32b?s=128&d=identicon&r=PG&f=1", "display_name": "Dave2e", "link": "https://stackoverflow.com/users/5792244/dave2e"}, "edited": false, "score": 0, "creation_date": 1459372406, "post_id": 36319732, "comment_id": 60262987, "body": "Try: &quot;If Not (rNew Is Nothing) Then&quot;  The Not operations mostly takes precedent over the Is. So if rNew has value it is most likely being converted to false which is not equal to nothing."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459376364, "post_id": 36319732, "comment_id": 60264814, "body": "Try not to filter first?"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1459376854, "post_id": 36319732, "comment_id": 60264996, "body": "I think BruceWayne is right, because dFreq returns range. I would do <code>dFreq = rBand.Offset(iBand, 0).value</code> and dimension it as a string or something."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1459408864, "post_id": 36319732, "comment_id": 60275832, "body": "Top 3 things to eliminate: 1) check the search value isn&#39;t a date, 2) pass all the <code>Find</code> arguments, 3) check search value is what you think it should be ... default property is <code>.Value</code> but I&#39;d use <code>.Value2</code> in case you have used some rounding or formatting."}, {"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459430321, "post_id": 36319732, "comment_id": 60291190, "body": "Thanks @BruceWayne and @RyszardJ\u0119draszyk for the suggestion. I didn&#39;t even notice the missing <code>.Value</code> beacuse <code>dFreq</code> showed the correct value in the watch window. Changing the line to <code>dFreq = rBand.Offset(iBand, 0).Value</code> did not fix the issue."}, {"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459430485, "post_id": 36319732, "comment_id": 60291330, "body": "@findwindow : The value I&#39;m trying to find shows up in the table multiple times. I&#39;m using the filter to control which iteration it looks for."}, {"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1459432395, "post_id": 36319732, "comment_id": 60292777, "body": "@Ambie - 1) The value is not a date. It is 21.1602429208891 and I have <code>dFreq</code> declared as <code>Double</code>. 2) Changing <code>.Value</code> to <code>.Value2</code> doesn&#39;t resolve the issue. 3) This is curious. When I do the find manually, it says &quot;Excel cannot find the data you&#39;re searching for.&quot; But if I copy the cell and paste values somewhere else, the find works. It looks like I might have to do a Copy/Paste Values to the entire table first."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459444123, "post_id": 36319732, "comment_id": 60301151, "body": "I&#39;m thinking it&#39;s because you&#39;re mixing ranges. <code>rBand</code> is a <code>Range</code>, and so <code>rNew</code> can be looked at like <code>Set rNew = rsData.Range(&quot;A1:P7000&quot;).find(wsNew.Range(&quot;C1&quot;).Offset(iBand&zwnj;&#8203;,0),,xlValues)</code>  ...which should work, I just think the mixing of ranges might be an issue?  What data is in <code>wsNew.Range(&quot;C1&quot;).Offset(iBand,0)</code>, or is expected to be in there?"}, {"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459518479, "post_id": 36319732, "comment_id": 60335721, "body": "@BruceWayne I tried changing rNew to a variant instead of a range, but it didn&#39;t help."}], "owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459454192, "creation_date": 1459371942, "last_edit_date": 1459454192, "question_id": 36319732, "link": "https://stackoverflow.com/questions/36319732/excel-vba-find-method-isnt-finding-what-i-know-is-there", "title": "Excel VBA .Find Method isn&#39;t finding what I know is there", "body": "<p>I have a very large table of data that needs to be broken up into several smaller tables and reorganized. I want to Autofilter the large table, run down a list of values to find in the large table, and compare the values in the cells next door to values on a pre-existing table. Here's the code I wrote:</p>\n\n<pre><code>Set rData = wsData.Range(\"A1:P7000\")\nrData.AutoFilter Field:=6, Criteria1:=sSensor\nSet rBand = wsNew.Range(\"C1\")\nFor iBand = 1 To 149\n    dFreq = rBand.Offset(iBand, 0)\n    Set rNew = rData.Find(dFreq, , xlValues)\n    If Not rNew Is Nothing Then\n        If rNew.Offset(0, 1).Value &gt; rBand.Offset(iBand, 2).Value Then\n            rNew.Offset(0, 1).Copy\n            rBand.Offset(iBand, 2).PasteSpecial xlPasteValues\n        End If\n    End If\nNext\n</code></pre>\n\n<p>The problem I'm having is that the <code>If Not rNew Is Nothing Then</code> line always comes back false, even when I can verify that the value in <code>dFreq</code> exists within <code>rData</code>.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I've changed the code as shown:</p>\n\n<pre><code>Set rData = wsData.Range(\"A1:P7000\")\n\n'New\nrData.Copy\nwsData.Range(\"A1\").PasteSpecial xlPasteValues\n'/New\n\nrData.AutoFilter Field:=6, Criteria1:=sSensor\nSet rBand = wsNew.Range(\"C1\")\nFor iBand = 1 To 149\n    dFreq = rBand.Offset(iBand, 0)\n    Set rNew = rData.Find(dFreq, , xlValues)\n    If Not rNew Is Nothing Then\n        If rNew.Offset(0, 1).Value &gt; rBand.Offset(iBand, 2).Value Then\n            rNew.Offset(0, 1).Copy\n            rBand.Offset(iBand, 2).PasteSpecial xlPasteValues\n        End If\n    End If\nNext\n</code></pre>\n\n<p>This appears to work about 99% of the time. Occasionally, <code>rNew.Offset(0, 1).Copy</code> will copy the wrong cell for some reason. For example, one iteration found the <code>dFreq</code> value in cell I467, but copied cell K452 (the first row of the filtered table) instead of J467. Also, once in a while, <code>rNew.Offset(0, 1).Value</code> = Error 2040.</p>\n"}, {"tags": ["vba", "date", "add"], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1459377562, "creation_date": 1459377562, "answer_id": 36320998, "question_id": 36319225, "link": "https://stackoverflow.com/questions/36319225/adding-days-to-a-specific-date/36320998#36320998", "title": "Adding days to a specific date", "body": "<p>You can do <strong>Next Workday (Mon - Fri)</strong> after 60 days easily with Formula.</p>\n\n<p>Say your Date is on <strong>A1</strong>, and the next workday after 60 days is stored in <strong>B1</strong>, then B1 can use this formula:</p>\n\n<pre><code>=A1+60+IF(WEEKDAY(A1+60,2)&gt;5,8-WEEKDAY(A1+60,2),0)\n</code></pre>\n\n<p>Unless you have a table list of the Public Holidays, you cannot do much when the \"Next Workday\" is a Public Holiday.</p>\n\n<p>If you do, add <code>IFERROR()</code> and <code>VLOOKUP()</code>, but there is still a chance of both Mon &amp; Tue are public holiday (X'mas can do this). You will need a UDF to loop through the calculated next workday until it is not public holiday.</p>\n"}], "owner": {"reputation": 3, "user_id": 4532921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152653133317361/picture?type=large", "display_name": "Felipe ", "link": "https://stackoverflow.com/users/4532921/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459377562, "creation_date": 1459370246, "last_edit_date": 1459371750, "question_id": 36319225, "link": "https://stackoverflow.com/questions/36319225/adding-days-to-a-specific-date", "title": "Adding days to a specific date", "body": "<p>I have a certain date and I want basically to do the following: add 60 days to it (without skipping weekends or holidays - so basically would be <code>date+60</code>), however if the resultant date (the 60th day after the start date) happens to be NOT a working day (a weekend or a holiday) take me to the next working day (skipping weekend and holidays). When adding the 60 days to the date, it doesn't skip any weekends or holidays, but if the result date is not a working day, take me to the next. </p>\n\n<p>for example: 01/25/2016 + 60 = 03/25/2016, which is a holiday, so take me to the next working day (as it is Friday, it will return me the next Monday, as Monday is not a holiday in this case, if it were, i would need it to check if Tuesday is a holiday and if it isn't, return me Tuesday instead).</p>\n\n<p>How can I do this? I would preferably do it with formulas instead of <code>VBA</code> but programming this would definitely not be a problem.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1459538546, "creation_date": 1459538546, "answer_id": 36364302, "question_id": 36318972, "link": "https://stackoverflow.com/questions/36318972/excel-vba-passing-a-calculation-result-array-as-an-argument-to-a-function/36364302#36364302", "title": "Excel VBA: Passing a calculation result array as an argument to a function", "body": "<p>If you're calling your function from another VBA subroutine or function, Excel will not interpret the range calculation for you. You have to perform any data manipulations over the range area yourself before calling your function. </p>\n\n<p>But as long as you're using the function as a UDF from a worksheet cell, Excel will interpret the range parameters as you describe them. The caveat when applying any calculations to the range is you must \"tag\" the cell formula to excel as an array formula by typing with <code>control-shift-enter</code> to complete the cell formula.</p>\n\n<p>Consider this setup:</p>\n\n\n\n<pre><code>Option Explicit\n\nPublic Function CalculateThis(inRange) As Double\n    Dim answer As Double\n    answer = 0#\n    CalculateThis = answer\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/nd72j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nd72j.png\" alt=\"enter image description here\"></a></p>\n\n<p>The range parameter A1:E1 comes in as expected, a <code>Variant/Object/Range</code>. Use the View-->Locals window in the VBA Editor to take a look.</p>\n\n<p><a href=\"https://i.stack.imgur.com/x9lu8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x9lu8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now, if you wanted to apply a calculation to the range <strong>before</strong> it gets to your function, you still can.</p>\n\n<p>Consider the formula <code>=CalculateThis(A1:E1^2)</code>. What you expect is an array of five values, each value squared. But if you enter this formula by typing a simple <code>enter</code>, what you get is a single value instead of an array. (Bonus points to someone who can explain why the value is 9.)</p>\n\n<p><a href=\"https://i.stack.imgur.com/OYcF6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OYcF6.png\" alt=\"enter image description here\"></a></p>\n\n<p>But enter the same formula with <code>control-shift-enter</code> and you get the expected array of five values, with each value squared.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0nyL8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0nyL8.png\" alt=\"enter image description here\"></a></p>\n\n<p>You have to check for some error conditions if your range and array calculation don't quite match up. For example <code>=CalculateThis(A1:E1^{1,2,3,4,5})</code> (entered with <code>control-shift-enter</code>) gets you the expected:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jQGAW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jQGAW.png\" alt=\"enter image description here\"></a></p>\n\n<p>But <code>=CalculateThis(A1:E1^{1,2,3})</code> does not:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Gx7iy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gx7iy.png\" alt=\"enter image description here\"></a></p>\n\n<p>(The errors in the variant array are strings \"Error 2042\" that you can check for.)</p>\n"}], "owner": {"reputation": 1698, "user_id": 2214806, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/RgdBJ.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/2214806/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 1, "accepted_answer_id": 36364302, "answer_count": 1, "score": 3, "last_activity_date": 1459769741, "creation_date": 1459369342, "last_edit_date": 1459769741, "question_id": 36318972, "link": "https://stackoverflow.com/questions/36318972/excel-vba-passing-a-calculation-result-array-as-an-argument-to-a-function", "title": "Excel VBA: Passing a calculation result array as an argument to a function", "body": "<p>I have a VBA function that accepts arrays, it works great if I pass it a reference such as <code>A1:A10</code>.  It does not accept a \"formula\" argument such as <code>A1:A10+1</code> or <code>A1:A10^2</code>, the resulting cells contain <code>#VALUE</code>.</p>\n\n<p>Many excel functions support this, such as linest(...) which i can write the following formula to get a forth order fit without having to manually list the four columns for the <code>X</code> argument.</p>\n\n<pre><code>     =LINEST( B1:B10, A1:A10^{1,2,3} )\n</code></pre>\n\n<p>My function declaration is:</p>\n\n<pre><code>     Function FFT(ByRef A) As Variant\n</code></pre>\n\n<p>I'm expecting Excel to evaluate the expression and pass the result into the function.  Is this not possible with Excel VBA? </p>\n"}, {"tags": ["excel", "ms-access", "vba", "ado"], "comments": [{"owner": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 0, "creation_date": 1459369979, "post_id": 36318954, "comment_id": 60261608, "body": "This has already been asked and answered <a href=\"http://stackoverflow.com/questions/29533346/join-2-tables-case-sensitive-upper-and-lower-case\">here</a>"}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "reply_to_user": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 0, "creation_date": 1459370517, "post_id": 36318954, "comment_id": 60261915, "body": "Thanks for the reply - but how do I solve the problem using ADO? When I add the collation (using COLLATE latin1_bin) I get an error when opening the RecordSet. Using BINARY I get a syntax error. Is there a different key word in ADO?"}, {"owner": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 0, "creation_date": 1459371401, "post_id": 36318954, "comment_id": 60262442, "body": "Hmm, my bad, I didn&#39;t read your question closely enough.  The problem is not with ADO (ADO is just the go-between), it&#39;s with the database engine.  From what I can find, the ACE OLEDB in Excel doesn&#39;t support COLLATE.  You seem to have found your own solution :)"}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "reply_to_user": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 0, "creation_date": 1459371809, "post_id": 36318954, "comment_id": 60262670, "body": "The solution works, but it really brings the performance down... Well, can&#39;t help it I guess ;)"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1459404824, "post_id": 36319504, "comment_id": 60273553, "body": "That&#39;s how to do it."}, {"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1459410954, "post_id": 36319504, "comment_id": 60277196, "body": "Is there any way to do this in a manner that does not bring the performance down so much? I have quite a lot of data to process and with StrComp it takes hours now (what took seconds before)."}], "tags": [], "owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "is_accepted": false, "score": 4, "last_activity_date": 1461331761, "last_edit_date": 1461331761, "creation_date": 1459371236, "answer_id": 36319504, "question_id": 36318954, "link": "https://stackoverflow.com/questions/36318954/ado-excel-ace-oledb-12-0-does-not-compare-key-strings-case-sensitive/36319504#36319504", "title": "ADO (Excel, ACE OLEDB 12.0) does not compare Key-Strings case-sensitive", "body": "<p>I found a workaround for ADO. Seems <code>COLLATE</code> does not exist (see: <a href=\"http://www.utteraccess.com/forum/Collate-Access-t1940463.html\" rel=\"nofollow\">http://www.utteraccess.com/forum/Collate-Access-t1940463.html</a>).</p>\n\n<p>One can <strong>use StrComp</strong> and set it to binary compare:</p>\n\n<pre><code>sQuery = \"Select a1.[Key], a2.[Val] from [AlphaNum1$] a1 LEFT JOIN [AlphaNum2$] a2 **ON StrComp(a1.[Key], a2.[Key], 0)=0**\"\n</code></pre>\n\n<p>If there is a better solution I am happy for more suggestions :)</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "edited": false, "score": 0, "creation_date": 1459422870, "post_id": 36327776, "comment_id": 60285549, "body": "Nice idea, thanks. I understand that the function converts the String to Byte but I don&#39;t really understand the details. How reliable is it? Is there a possibility that it produces the same result for a different string?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "edited": false, "score": 0, "creation_date": 1459423619, "post_id": 36327776, "comment_id": 60286068, "body": "No, it converts to a byte array which is writes out as a string using the hex representation of each character. I can&#39;t see why you think these shouldn&#39;t be unique."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1459412222, "creation_date": 1459412222, "answer_id": 36327776, "question_id": 36318954, "link": "https://stackoverflow.com/questions/36318954/ado-excel-ace-oledb-12-0-does-not-compare-key-strings-case-sensitive/36327776#36327776", "title": "ADO (Excel, ACE OLEDB 12.0) does not compare Key-Strings case-sensitive", "body": "<p>You could add a new indexed text field to each table, then fill this with values using the function below, and then join the tables the normal way using these fields:</p>\n\n<pre><code>Public Function StrToByte(ByVal strChars As String) As String\n\n  Dim abytChar()  As Byte\n  Dim lngChar     As Long\n  Dim strByte     As String\n\n  abytChar() = StrConv(strChars, vbFromUnicode)\n\n  strByte = Space(2 * (1 + UBound(abytChar) - LBound(abytChar)))\n  For lngChar = LBound(abytChar) To UBound(abytChar)\n    Mid(strByte, 1 + 2 * lngChar) = Hex(abytChar(lngChar))\n  Next\n\n  StrToByte = strByte\n\nEnd Function\n</code></pre>\n\n<p>It will produce keys like:</p>\n\n<pre><code>StrToByte(\"a12b\") -&gt; 61313262\nStrToByte(\"A12b\") -&gt; 41313262\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 104, "user_id": 6406135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f71cc10a2c550b7ede967efb11c1479?s=128&d=identicon&r=PG&f=1", "display_name": "robertocm", "link": "https://stackoverflow.com/users/6406135/robertocm"}, "reply_to_user": {"reputation": 2810, "user_id": 3594657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Otook.png?s=128&g=1", "display_name": "Sethmr", "link": "https://stackoverflow.com/users/3594657/sethmr"}, "edited": false, "score": 0, "creation_date": 1483602190, "post_id": 41474714, "comment_id": 70164570, "body": "Yes, but was not possible for me to comment in other posts because of &#39;reputation&#39; ..."}], "tags": [], "owner": {"reputation": 104, "user_id": 6406135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f71cc10a2c550b7ede967efb11c1479?s=128&d=identicon&r=PG&f=1", "display_name": "robertocm", "link": "https://stackoverflow.com/users/6406135/robertocm"}, "is_accepted": false, "score": -1, "last_activity_date": 1483571062, "creation_date": 1483571062, "answer_id": 41474714, "question_id": 36318954, "link": "https://stackoverflow.com/questions/36318954/ado-excel-ace-oledb-12-0-does-not-compare-key-strings-case-sensitive/41474714#41474714", "title": "ADO (Excel, ACE OLEDB 12.0) does not compare Key-Strings case-sensitive", "body": "<p>Just to report that i have reproduced your example, and got the 'Expected Result' at first time, without any modification in your code</p>\n\n<p>I'm using Excel 2007 and ADO 2.8</p>\n"}], "owner": {"reputation": 121, "user_id": 650995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpbDw.png?s=128&g=1", "display_name": "dakami", "link": "https://stackoverflow.com/users/650995/dakami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1594640723, "creation_date": 1459369275, "last_edit_date": 1594640723, "question_id": 36318954, "link": "https://stackoverflow.com/questions/36318954/ado-excel-ace-oledb-12-0-does-not-compare-key-strings-case-sensitive", "title": "ADO (Excel, ACE OLEDB 12.0) does not compare Key-Strings case-sensitive", "body": "<p>Problem Description: When Joining 2 Tables using Excel and ADO (ACE OLEDB 12.0) on alphanumeric Strings, ADO does not distinguish between the Keys \"a12a\" and \"A12a\" (it treats them as if they would be the same, i.e. case-insensitive). I, however, have alphanumeric keys in my data. The Join will link the data wrongly!</p>\n\n<p>I built a small example in an Excel Workbook to reproduce the behavior. \nThe Excel Workbook contains 3 Sheets:</p>\n\n<ol>\n<li>AlphaNum1</li>\n<li>AlphaNum2</li>\n<li>Result</li>\n</ol>\n\n<p>AlphaNum1 Sheet contains the following data</p>\n\n<pre><code>Key   Val\na12b    1\nA12b    2\na12B    3\nA12B    4\ne12f    7\nE12F    8\n1234    9\n</code></pre>\n\n<p>AlphaNum2 Sheet contains the following data:</p>\n\n<pre><code>Key   Val\na12b    1\nA12b    2\na12B    3\nA12B    4\nc12d    5\nC12D    6\n1234    9\n</code></pre>\n\n<p>I Use the following VBA code to connect to ADO and join the tables (LEFT JOIN):</p>\n\n<pre><code>Sub AlphaNumTest()\n    Dim oAdoConnection As New ADODB.Connection\n    Dim oAdoRecordset As New ADODB.Recordset\n    Dim sAdoConnectString As String, sPfad As String\n    Dim sQuery As String\n    On Error GoTo ExceptionHandling\n    sPfad = ThisWorkbook.FullName\n    sAdoConnectString = \"Provider=Microsoft.ACE.OLEDB.12.0; Extended Properties='Excel 12.0 Xml;HDR=YES;';Data Source=\" &amp; sPfad\n\n    oAdoConnection.Open sAdoConnectString\n    sQuery = \"Select a1.[Key], a2.[Val] from [AlphaNum1$] a1 LEFT JOIN [AlphaNum2$] a2 ON a1.[Key] = a2.[Key]\"\n    With oAdoRecordset\n        .Source = sQuery\n        .ActiveConnection = oAdoConnection\n        .Open\n    End With\n\n    Dim writeRange As Range\n    Dim headerRange As Range\n\n    'Set headerRange = ThisWorkbook.Sheets(\"WriteHere\").Range(\"A1\")\n    Set writeRange = ThisWorkbook.Sheets(\"Result\").Range(\"A2\")\n\n    ' print the table header from recordset\n    For i = 0 To oAdoRecordset.Fields.Count - 1\n        ' careful! the recordset is zero-indexed like it should be! Excel table however starts at index one, thus the i+1~\n        ThisWorkbook.Sheets(\"Result\").Cells(1, i + 1).Value = oAdoRecordset.Fields(i).Name\n        ' set bold\n        ThisWorkbook.Sheets(\"Result\").Cells(1, i + 1).Font.Bold = True\n    Next i\n\n    ' print the data directly from recordset!\n    writeRange.CopyFromRecordset oAdoRecordset\n\n\nCleanUp:\n    On Error Resume Next ' Lazy skip\n    oAdoRecordset.Close\n    oAdoConnection.Close\n    Set oAdoRecordset = Nothing\n    Set oAdoConnection = Nothing\n    Exit Sub\nExceptionHandling:\n    MsgBox \"Fehler: \" &amp; Err.Description\n    Resume CleanUp\nEnd Sub\n</code></pre>\n\n<p>Note that it does not matter if I use an INNER or a LEFT JOIN; the result is wrong eiter way - in this example here I use a LEFT JOIN to demonstrate the behavior.</p>\n\n<p>The Result output is AlphaNum1.Key and AlphaNum2.Val joined by LEFT JOIN.</p>\n\n<p>The <strong>Expected Result</strong> (I am joining using \"=\" not LIKE...) is:</p>\n\n<pre><code>Key   Val\na12b    1\nA12b    2\na12B    3\nA12B    4\ne12f    \nE12F    \n1234    9\n</code></pre>\n\n<p>But ADO gives me the <strong>Actual Result</strong> (it treats the Keys case insensitive...):</p>\n\n<pre><code>Key   Val\na12b    4\na12b    3\na12b    2\na12b    1\nA12b    4\nA12b    3\nA12b    2\nA12b    1\na12B    4\na12B    3\na12B    2\na12B    1\nA12B    4\nA12B    3\nA12B    2\nA12B    1\ne12f    \nE12F    \n1234    9\n</code></pre>\n\n<p><strong>Any ideas why ADO behaves like this? Any ideas how/if I can change the behavior?</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1459368806, "post_id": 36318677, "comment_id": 60260932, "body": "A quick note, which may help you understand how it&#39;s working, is to <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code>/<code>.Activate</code></a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459368822, "post_id": 36318677, "comment_id": 60260940, "body": "<code>Dim LastRowIput As String</code> or <code>Dim LastRowInput As Long</code> ? (note both spelling and variable type)"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1459369436, "post_id": 36318677, "comment_id": 60261296, "body": "Find/Replace all <code>F</code> to <code>G</code> and then all <code>E</code> to <code>F</code>"}, {"owner": {"reputation": 11, "user_id": 6136684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d20d171396d2cb62bf55f88dff3907?s=128&d=identicon&r=PG&f=1", "display_name": "sng428", "link": "https://stackoverflow.com/users/6136684/sng428"}, "edited": false, "score": 0, "creation_date": 1459370103, "post_id": 36318677, "comment_id": 60261674, "body": "That&#39;s what I tried. Doesn&#39;t work, it just uses F as the variable as well"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459371300, "post_id": 36318677, "comment_id": 60262368, "body": "I don&#39;t understand the loop. You take all of F from Input and put it into Output starting at the first available row. Then you copy a single row of A:E and do the same thing and fill down to the extent of F. But then you loop through and do the same thing with the next row. Why you are looping makes no sense to me."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1459372814, "creation_date": 1459372814, "answer_id": 36319971, "question_id": 36318677, "link": "https://stackoverflow.com/questions/36318677/add-a-another-constant-column-to-this-macro/36319971#36319971", "title": "Add a another constant/column to this macro?", "body": "<p>It seems that you want to copy the rows from A:G from Input to Output, expanding A:F in Output for every row in G.</p>\n\n<pre><code>Dim i As Long, lastRowInput As Long, nextRowOutput As Long\nDim wso As Worksheet\n\nSet wso = Worksheets(\"Output\")\n\nWith Sheets(\"Input\")\n    lastRowInput = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    For i = 2 To lastRowInput\n        nextRowOutput = wso.Cells(.Rows.Count, \"G\").End(xlUp).Row + 1\n        .Range(.Cells(2, \"G\"), .Cells(2, \"G\").End(xlDown)).Copy _\n          Destination:=wso.Cells(nextRowOutput, \"G\")\n        .Range(\"A\" &amp; i &amp; \":\" &amp; \"F\" &amp; i).Copy _\n          Destination:=wso.Range(wso.Cells(nextRowOutput, \"A\"), _\n                                 wso.Cells(wso.Cells(.Rows.Count, \"G\").End(xlUp).Row, \"F\"))\n    Next i\nEnd With\n</code></pre>\n\n<p>I've removed all methods involving the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197597.aspx\" rel=\"nofollow noreferrer\">Range .Select</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221681.aspx\" rel=\"nofollow noreferrer\">Range .Activate</a> methods in favor of direct referencing.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/xVrIn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xVrIn.png\" alt=\"Input_Sample_Data\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Sample data from Input worksheet</sup></p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/WW1GR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WW1GR.png\" alt=\"Input_Sample_Data_expanded_to_Output\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Sample results from Output worksheet</sup></p>\n"}], "owner": {"reputation": 11, "user_id": 6136684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d20d171396d2cb62bf55f88dff3907?s=128&d=identicon&r=PG&f=1", "display_name": "sng428", "link": "https://stackoverflow.com/users/6136684/sng428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459372814, "creation_date": 1459368348, "last_edit_date": 1459368674, "question_id": 36318677, "link": "https://stackoverflow.com/questions/36318677/add-a-another-constant-column-to-this-macro", "title": "Add a another constant/column to this macro?", "body": "<p>What this does now is take whats inputted Columns A:E and add whatever you list in column F, at the end of it, keeping A:E constant. This makes it much easier rather than copying and pasting but i want to add another row so that A:F is constant, switching the list to column G.</p>\n\n<p>For ex, once it's outputted,</p>\n\n<pre><code>A1,B1,C1,D1,E1,F1\nA1,B1,C1,D1,E1,F2\nA1,B1,C1,D1,E1,F3\netc.\n</code></pre>\n\n<p>I just want to add another column to make it</p>\n\n<pre><code>A1,B1,C1,D1,E1,F1,G1\nA1,B1,C1,D1,E1,F1,G2\nA1,B1,C1,D1,E1,F1,G3\n</code></pre>\n\n<p>This is what I have so far.</p>\n\n<pre><code>Dim LastRowIput As String\n    With Sheets(\"Input\")\n    LastRowInput = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n    End With\n\n\nFor I = 2 To LastRowInput\n\nDim LastRowLoc As String\n    With Sheets(\"Output\")\n    LastRowLoc = .Cells(.Rows.Count, \"F\").End(xlUp).Row + 1\n    End With\n\n\n    Sheets(\"Input\").Select\n    Range(\"F2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Output\").Select\n    Range(\"F\" &amp; LastRowLoc).Select\n    ActiveSheet.Paste\n    Sheets(\"Input\").Select\n    Range(\"A\" &amp; I &amp; \":\" &amp; \"E\" &amp; I).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Output\").Select\n\n    Dim LastRow As String\n    With ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row + 1\n    End With\n\n    Range(\"A\" &amp; LastRow).Select\n    ActiveSheet.Paste\n\n    Dim LastRowLoc2 As String\n    With Sheets(\"Output\")\n    LastRowLoc2 = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n    End With\n\n    Application.CutCopyMode = False\n    Range(\"A\" &amp; LastRow &amp; \":\" &amp; \"E\" &amp; LastRowLoc2).Select\n    Selection.FillDown\n\n    Sheets(\"Input\").Select\n\nNext I\n</code></pre>\n"}, {"tags": ["python", "vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1459367875, "post_id": 36318448, "comment_id": 60260419, "body": "You might be able to use Windows file associations and skip the part about the path to <code>python.exe</code>"}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1459368949, "post_id": 36318448, "comment_id": 60261018, "body": "@JohnColeman: Interesting. How could I do this while using the shell? It insists on a path to an executable as a argument."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1459371175, "post_id": 36318448, "comment_id": 60262298, "body": "I&#39;m not sure how to use it from VBScript -- but it can work from the command prompt."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1459372617, "post_id": 36318448, "comment_id": 60263113, "body": "The <code>Run</code> method seems easier to use with arguments with spaces. I&#39;m not sure why."}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1459426129, "post_id": 36318448, "comment_id": 60287984, "body": "Thanks. I was using Exec to pass a result from Python to VBA through StdOut. Do you know how to do this with Run?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1459427366, "post_id": 36318448, "comment_id": 60288941, "body": "It seems to be a bit of a bug since <i>exactly</i> the same string will work with <code>Run</code> but fail with <code>Exec</code>. How badly do you need to have spaces in the path? Personally, I keep most of my programs in a folder in my documents (in a path which contains spaces) but also keep a folder close to the root directory for programs that I need to invoke from the command line (which isn&#39;t a very common use-case for me). You could create such a folder and move a copy of your script to it."}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1459431464, "post_id": 36318448, "comment_id": 60292036, "body": "@JohnColeman: Thanks. I was thinking of doing just that. Existing path names have spaces in them (for which I will curse MS for all time) and I was hoping to accommodate current circumstances and not introduce any new procedural requirements for others. Seems to be a choice between spaces in path names and being able to pass a return value through StdOut."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 0, "creation_date": 1459368468, "post_id": 36318507, "comment_id": 60260755, "body": "Thanks, hadn&#39;t tried that one, but no success. This causes the terminal window to stay open, which is different, but the argument is still not passed."}], "tags": [], "owner": {"reputation": 4037, "user_id": 3990145, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3d95b7ec21ccd7bf3c8e1604d49faca1?s=128&d=identicon&r=PG&f=1", "display_name": "xi&#186;", "link": "https://stackoverflow.com/users/3990145/xi%c2%ba"}, "is_accepted": false, "score": 1, "last_activity_date": 1459367790, "creation_date": 1459367790, "answer_id": 36318507, "question_id": 36318448, "link": "https://stackoverflow.com/questions/36318448/passing-parameters-to-python-from-vba/36318507#36318507", "title": "Passing parameters to python from VBA", "body": "<p>Try to use multiple quotes:</p>\n\n<pre><code>Set shell_exec = wsh.Exec(\"\"\"C:\\path_to_executable\\python.exe \"\"\" &amp; \"\"\"C:\\path with spaces\\file.py \"\"\" &amp; arg)\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2380, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1459369454, "creation_date": 1459367583, "last_edit_date": 1459369454, "question_id": 36318448, "link": "https://stackoverflow.com/questions/36318448/passing-parameters-to-python-from-vba", "title": "Passing parameters to python from VBA", "body": "<p>In VBA code, I am calling Python and passing an argument successfully like this when there are no spaces in the path to the python file:</p>\n\n<pre><code>Dim wsh As Object\nSet wsh = CreateObject(\"WScript.Shell\")\n\nDim shell_exec As Object\nSet shell_exec = wsh.Exec(\"C:\\path_to_executable\\python.exe \" &amp; \"C:\\path_without_spaces\\file.py \" &amp; arg)\n</code></pre>\n\n<p>However, I cannot find any way to pass an argument to python when the path to the python file contains spaces.  For example, triple double-quoting the path works when there is no argument:</p>\n\n<pre><code>Set shell_exec = wsh.Exec(\"C:\\path_to_executable\\python.exe \" &amp; \"\"\"C:\\path with spaces\\file.py\"\"\")\n</code></pre>\n\n<p>But I am unable to find any way to pass an argument when doing this.  For example, calls like this (and every variation on this theme I can think of) fail:</p>\n\n<pre><code>Set shell_exec = wsh.Exec(\"C:\\path_to_executable\\python.exe \" &amp; \"\"\"C:\\path with spaces\\file.py \"\"\" &amp; arg)\n</code></pre>\n\n<p>Is this possible, or is the use of spaces fatally ambiguous in this situation?</p>\n\n<p>Advice is appreciated.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 1723, "user_id": 510629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgp2Q.jpg?s=128&g=1", "display_name": "jhoepken", "link": "https://stackoverflow.com/users/510629/jhoepken"}, "edited": false, "score": 0, "creation_date": 1459368409, "post_id": 36318413, "comment_id": 60260714, "body": "Welcome to Stackoverflow! Can you show your current state of your code at be more specific about what&#39;s &quot;not working&quot;?!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1459376699, "post_id": 36318413, "comment_id": 60264932, "body": "You have your assignment the wrong way around ,and it&#39;s <code>getElementById</code>, not <code>getElement*s*ById</code>"}, {"owner": {"reputation": 11, "user_id": 6136639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26146dfc06a57192fbac6863f294a9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Anderson Cachiolo", "link": "https://stackoverflow.com/users/6136639/anderson-cachiolo"}, "edited": false, "score": 0, "creation_date": 1461164358, "post_id": 36318413, "comment_id": 61076373, "body": "Thank you Tim, I it was this &quot;S&quot; that was driving me crazy, tyvm."}], "owner": {"reputation": 11, "user_id": 6136639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26146dfc06a57192fbac6863f294a9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Anderson Cachiolo", "link": "https://stackoverflow.com/users/6136639/anderson-cachiolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 600, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459367483, "creation_date": 1459367483, "question_id": 36318413, "link": "https://stackoverflow.com/questions/36318413/vba-to-get-information-fom-div-id", "title": "VBA to get information fom div id", "body": "<p>I was trying to retrieve information from an id, but i simply couldnt.</p>\n\n<p>Can any of you guys help me?</p>\n\n<p>html:</p>\n\n<pre><code>&lt;div id=\"conteudo\" align=\"center\"&gt;\n    &lt;div id=\"cabecaRegistro\"&gt;&lt;/div&gt;\n    &lt;div id=\"warning\" align=\"left\"&gt;\n\n                    N\u00e3o \u00e9 poss\u00edvel incluir mais faturas para este\u2026\"\n</code></pre>\n\n<p>I need to retrieve the innertext for this id \"warning\" and tried it like: </p>\n\n<pre><code>objIE.Document.getElementsById(\"warning\").innertext = Sheets(\"Sheet1\").Range(\"D2\").Value\n</code></pre>\n\n<p>but it didn't work.. is there any other way of doing this?</p>\n"}, {"tags": ["vba", "filter", "ms-access-2013", "subform"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6136520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ezZ8IykBEHk/AAAAAAAAAAI/AAAAAAAAEu4/pKzmMOY-PVE/photo.jpg?sz=128", "display_name": "Dennis Estep", "link": "https://stackoverflow.com/users/6136520/dennis-estep"}, "is_accepted": false, "score": 0, "last_activity_date": 1459450286, "creation_date": 1459450286, "answer_id": 36341370, "question_id": 36318160, "link": "https://stackoverflow.com/questions/36318160/opening-a-record-in-a-subform-based-on-selection-in-another-subform/36341370#36341370", "title": "Opening a Record in a subform, based on selection in another subform", "body": "<p>Ok So after continued testing I have figured out the issue.</p>\n\n<p>It was a minor problem and didn't need a lot of what I tried.</p>\n\n<p>I am leaving this up though for others who may have similar issues.</p>\n\n<p>I had to take the filter and add a requery so for this instance the code looks like this:</p>\n\n<pre><code>Me.Parent.Form.NewTaskSub.Form.Filter = \"[ID]= \" &amp; Me.ID\nMe.Parent.Form.NewTaskSub.Form.FilterOn = True\nMe.Parent.Controls!NewTaskSub.Form.Requery\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6136520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ezZ8IykBEHk/AAAAAAAAAAI/AAAAAAAAEu4/pKzmMOY-PVE/photo.jpg?sz=128", "display_name": "Dennis Estep", "link": "https://stackoverflow.com/users/6136520/dennis-estep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 933, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459450286, "creation_date": 1459366678, "question_id": 36318160, "link": "https://stackoverflow.com/questions/36318160/opening-a-record-in-a-subform-based-on-selection-in-another-subform", "title": "Opening a Record in a subform, based on selection in another subform", "body": "<p>This is my first post, but often view this site to solve issues. Unfortuantely I have not been able to come up with a solution for my current development. I am working on a Task list with a different type of setup. The main form is a one stop shop for multiple users. </p>\n\n<p>There are two tables</p>\n\n<p>Team\n- ID (autonum)\n- First Name (text)\n- Last Name (text)\n- Full Name (Calculated)</p>\n\n<p>Tasks\n-ID (autonum)\n- Task (short text)\n- Description (Long Text)\n- Start Date (short date)\n- Assigned To (Lookup to Full Name)\n- Etc (Additional fields)</p>\n\n<p>The MainMenu (main form) is set up bound to the Team table. With a dropdown field to select a team member. The form has two subforms (CurrentTaskSub and NewTaskSub). Both Subforms are bound to Tasks. CurrentTaskSub is created from a query of Task where tasks are not complete and past the start date. NewTaskSub is a direct form of the task table. </p>\n\n<p>When a name is selected it uses a parent/child relationship to filter the CurrentTaskSub to tasks assigned to that team member. That part works.</p>\n\n<p>What I want to happen is when you select one of the tasks from CurrentTaskSub, it will populate in NewTaskSub to view all the info on the task and to change or update it. Then it will refresh both Subforms when a change is save in NewTaskSub whether that is completing a task, updating it, or creating a new task.</p>\n\n<p>Here is what I have attempted:</p>\n\n<p>On the CurrentTaskSub subform I select the task field and set that on click it will execute VBA code.</p>\n\n<p>the current code of many I have tried is:</p>\n\n<p>Forms!MainMenu![NewTaskSub].Form.Filter = \"[Task] = \" &amp; Me.Task\nForms!MainMenu![NewTaskSub].Form.FilterOn = True</p>\n\n<p>and </p>\n\n<p>'With Forms(NewTaskSub).Recordset\n'run a findfirst against that recordset\n'NewTaskSub.FindFirst \"[Task] = \" &amp; Me.Task\n'if item not found issue warning\n'If NewTaskSub.NoMatch Then MsgBox Me.Task &amp; \" not found\"\n'End With</p>\n\n<p>Both these produce debug errors. I think I am on the right track but can seem to find the solution I am hoping for. Any assistance or advice is appreciated. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "edited": false, "score": 3, "creation_date": 1459366687, "post_id": 36318010, "comment_id": 60259748, "body": "I think you need to post an example of the current sheet, and what you would be looking to get back. Also, how far have you got with the code so far? Post that up too."}, {"owner": {"reputation": 69, "user_id": 4644689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10152687105612724/picture?type=large", "display_name": "Luke Bateson", "link": "https://stackoverflow.com/users/4644689/luke-bateson"}, "reply_to_user": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "edited": false, "score": 0, "creation_date": 1459367323, "post_id": 36318010, "comment_id": 60260108, "body": "@DavyC Here is a link to the workbook <a href=\"https://www.mediafire.com/?vceo3wtac39pxfq\" rel=\"nofollow noreferrer\">mediafire.com/?vceo3wtac39pxfq</a>  Basically, running Macro1 will take the raw data from &#39;FINISH&#39; and however many of that particular product is finished it will add a value to the next available row of that particular item&#39;s column.  Now I want it to do exactly the same with the &#39;RAW&#39; products, but split it between the two, so B&amp;T, C&amp;U, D&amp;V etc etc, because one RAW product can make two types of finish product.  It&#39;s a VERY VAGUE concept and difficult to explain at the moment.."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1459367627, "post_id": 36318010, "comment_id": 60260280, "body": "There are not many people that will download and open a .xlsm worksheet from the web.  It is too dangerous.  Please post the relevant code directly into the original post."}, {"owner": {"reputation": 69, "user_id": 4644689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10152687105612724/picture?type=large", "display_name": "Luke Bateson", "link": "https://stackoverflow.com/users/4644689/luke-bateson"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459368556, "post_id": 36318010, "comment_id": 60260819, "body": "@ScottCraner Have edited original question and explain a little more to try and make sense of the confusing question"}], "owner": {"reputation": 69, "user_id": 4644689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10152687105612724/picture?type=large", "display_name": "Luke Bateson", "link": "https://stackoverflow.com/users/4644689/luke-bateson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459368526, "creation_date": 1459366265, "last_edit_date": 1459368526, "question_id": 36318010, "link": "https://stackoverflow.com/questions/36318010/split-cell-value-into-two-vba-variables", "title": "Split Cell Value Into two VBA variables", "body": "<p>In a scenario, I'm wanting to take the value of a certain cell (raw material) (a number) and split it between two finished products on a production flow sheet.</p>\n\n<p>I need to know what VBA I could execute if for example cell B1 on 'STOCK' sheet was 8. It would then go to 'PLAN' sheet and find the next available row on column A and paste 'RAW', then go to column T, find the next available row and paste 'RAW', then back to column A and so on until I had four 'RAW' cells under each column. </p>\n\n<p>Could anyone give me a hand? Thanks!</p>\n\n<p>Edit.</p>\n\n<p>So here is the current VBA for adding the 'Current stock'. It's not fully complete as it's just a concept.\n<img src=\"https://i.imgur.com/zF4dcKP.png\" alt=\"code\"></p>\n\n<p>It takes this 'raw data'</p>\n\n<p><img src=\"https://i.imgur.com/cyubvmr.png\" alt=\"raw data\"></p>\n\n<p>And puts it in the next blank row for each column.</p>\n\n<p><img src=\"https://i.imgur.com/5if779I.png\" alt=\"populated\"></p>\n\n<p>Now I want to do this in a similar fashion, but instead of using the value, I want it to find the next blank row between TWO COLUMNS. so B&amp;T, C&amp;U etc etc because the raw product makes two types of finished products</p>\n\n<p><img src=\"https://i.imgur.com/PZgxMdx.png\" alt=\"finish\"></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1459367766, "post_id": 36317868, "comment_id": 60260358, "body": "picture is blank ... also, if you don&#39;t show the coding efforts you have made, the question will most likely be ignored and closed."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6136456, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9B03XkNjUo/AAAAAAAAAAI/AAAAAAAAAe0/HLckWFx9FBw/photo.jpg?sz=128", "display_name": "&#222;orsteinn Andri Haraldsson", "link": "https://stackoverflow.com/users/6136456/%c3%9eorsteinn-andri-haraldsson"}, "edited": false, "score": 0, "creation_date": 1459445970, "post_id": 36318585, "comment_id": 60302228, "body": "Thank you so much! It worked like a charm. Had been using a similar code (my first post so I forgot to post it), without any luck."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1459368006, "creation_date": 1459368006, "answer_id": 36318585, "question_id": 36317868, "link": "https://stackoverflow.com/questions/36317868/macro-that-rotates-values/36318585#36318585", "title": "Macro that rotates values", "body": "<p>Not very elegant, but this does what you described ...</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub Simple()\nDim iloop As Integer\n\nFor iloop = 1 To 29\n    If Sheets(\"Sheet1\").Cells(10, iloop) = 1 Then\n        Sheets(\"Sheet1\").Cells(10, iloop) = \"\"\n        Sheets(\"Sheet1\").Cells(11, iloop) = 2\n    Else\n        If Sheets(\"Sheet1\").Cells(11, iloop) = 2 Then\n            Sheets(\"Sheet1\").Cells(11, iloop) = \"\"\n            Sheets(\"Sheet1\").Cells(12, iloop) = 3\n        Else\n            If Sheets(\"Sheet1\").Cells(12, iloop) = 3 Then\n                Sheets(\"Sheet1\").Cells(12, iloop) = \"\"\n                Sheets(\"Sheet1\").Cells(10, iloop) = 1\n            End If\n        End If\n    End If\n\nNext iloop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1459380553, "creation_date": 1459380553, "answer_id": 36321566, "question_id": 36317868, "link": "https://stackoverflow.com/questions/36317868/macro-that-rotates-values/36321566#36321566", "title": "Macro that rotates values", "body": "<p>Not clear by your question as to how column A gets filled in, but something like this should do the trick:</p>\n\n<pre><code>Public Sub MoveRight()\n    Dim sh As Worksheet\n    Dim area As Range\n\n    Set sh = ActiveSheet\n    With sh\n        Set area = .Range(.Cells(10, 1), .Cells(12, 29))\n    End With\n\n    Dim r As Long, c As Long\n\n    With area\n        For c = .Columns.Count To 2 Step -1\n            For r = 1 To .Rows.Count\n                .Cells(r, c).Value = .Cells(r, c - 1).Value\n            Next r\n        Next c\n        For r = 1 To .Rows.Count\n            If .Cells(r, 4).Value = r Then\n                .Cells(r, 1).Value = r\n            Else\n                .Cells(r, 1).Value = vbNullString\n            End If\n        Next r\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6136456, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9B03XkNjUo/AAAAAAAAAAI/AAAAAAAAAe0/HLckWFx9FBw/photo.jpg?sz=128", "display_name": "&#222;orsteinn Andri Haraldsson", "link": "https://stackoverflow.com/users/6136456/%c3%9eorsteinn-andri-haraldsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459380553, "creation_date": 1459365767, "last_edit_date": 1459370244, "question_id": 36317868, "link": "https://stackoverflow.com/questions/36317868/macro-that-rotates-values", "title": "Macro that rotates values", "body": "<p>I'm currently working on a spreadsheet with that includes multiple columns, with rows 10,11 and 12 in each column indicating whether you're number 1, 2 or 3, accordingly. More specifically, see the picture below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2bbw5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2bbw5.png\" alt=\"http://i.imgur.com/QezrzqW.png\"></a> </p>\n\n<p>I need to build a macro that shifts the values each time it is used, so the cells in column A would change to A10=1, A11 and A12 =blank, column B to B12=3, B10 and B12 =blank, column C to C11=2, C10 and C12 =blank) etc. The macro would run until column AC is reached.</p>\n\n<p>Is there any way this is possible? I have to change the values each day so that can become quite tedious for multiple columns. </p>\n\n<p>Kind regards,\nThor</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 1, "creation_date": 1459365507, "post_id": 36317691, "comment_id": 60258954, "body": "Hi Blue apologies i&#39;m not entirely understanding your question.  Currently your searching Column 2 for &quot;<i>Doe</i>&quot; and you&#39;re replacing it with &quot;jdoe&quot;.  Now you&#39;re looking to locate &quot;<i>John Doe</i>&quot; and remove it?"}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1459365869, "post_id": 36317691, "comment_id": 60259177, "body": "@StormsEdge I added some sample data to hopefully better illistrustrate what I am trying to accomplish"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459365907, "post_id": 36317691, "comment_id": 60259202, "body": "No, not without doing cell-wise iteration. You&#39;re wildcards are consuming the entire string, <code>John Doe &#47; Smith Jr &#47; Some Guy</code> <b>is</b> a match for <code>*Doe*</code>, and the <code>Range.Replace</code> method is going to replace that match, with the specified <code>&quot;jdoe&quot;</code> string."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1459365947, "post_id": 36317691, "comment_id": 60259241, "body": "@ScottHoltzman doesn&#39;t work if John Doe is first entry in the cell..."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459366011, "post_id": 36317691, "comment_id": 60259286, "body": "@ScottHoltzman that is actually a really good idea."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1459366046, "post_id": 36317691, "comment_id": 60259308, "body": "@DavidZemens True, but I could always throw in a &quot;/&quot; to the beginning of every cell in the row, run the command he is giving, and then remove that first &quot;/&quot;"}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459366116, "post_id": 36317691, "comment_id": 60259359, "body": "@ScottHoltzman If you want to give that as an answer I will gladly accept it :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459366118, "post_id": 36317691, "comment_id": 60259360, "body": "Or you could use Text to Columns and just run the <code>Replace</code> method against each column. Lots of ways to accomplish it, but the <code>Range.Replace</code> method is kind of clunky sometimes."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459366273, "post_id": 36317691, "comment_id": 60259469, "body": "Thank you for the help everyone!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1459366402, "post_id": 36317691, "comment_id": 60259565, "body": "Add a trailing slash at the <i>end</i> of every cell, too. You&#39;ll also need to keep the slashes in the <code>Replacement</code> value, like <code>What:=&quot;&#47;*Doe*&#47;&quot;, Replacement:=&quot;&#47; jdoe &#47;&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1459366305, "post_id": 36317984, "comment_id": 60259491, "body": "Note: Also needs to add the <code>&#47;</code> as prefix and suffix to the <code>Replacement</code> value., Also needs to add a trailling <code>&#47;</code> to each cell in the range, otherwise it won&#39;t catch the John Doe in <code>Abraham Lincoln &#47; John Doe</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1459366421, "post_id": 36317984, "comment_id": 60259574, "body": "@DavidZemens - thanks. I was going to build a more fully fleshed answer, but the OP seems to be able to handle it. May be worth fleshing out more fully for others though."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 1, "creation_date": 1459366641, "post_id": 36317984, "comment_id": 60259723, "body": "@ScottHoltzman I concur, I understood that a prefix &amp; suffix &quot;/&quot; was needed, but other people may miss it when stumbling upon this question"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1459366884, "last_edit_date": 1459366884, "creation_date": 1459366194, "answer_id": 36317984, "question_id": 36317691, "link": "https://stackoverflow.com/questions/36317691/vba-replace-all-in-column-within-sections-broken-by/36317984#36317984", "title": "vba replace all in column within sections broken by &quot;/&quot;", "body": "<p>Try this: </p>\n\n<p><code>What:=\"/*Doe*/\", Replacement:=\"/jdoe/\"</code> </p>\n\n<p>And add a trailing <code>/</code> to each cell in the range so it catches entries like <code>some name / john doe</code></p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1459369421, "last_edit_date": 1459369421, "creation_date": 1459367071, "answer_id": 36318277, "question_id": 36317691, "link": "https://stackoverflow.com/questions/36317691/vba-replace-all-in-column-within-sections-broken-by/36318277#36318277", "title": "vba replace all in column within sections broken by &quot;/&quot;", "body": "<p>This should also work, and doesn't require prefix/suffix anything. This processes 100K cells in about 6 seconds (per call to the <code>foo</code> function). </p>\n\n<pre><code>Sub main()\n' This is your main procedure and you can specify all _\n  of your replacements here on their own line:\n\nCall foo(\"*Doe*\", \"jdoe\")\nCall foo(\"*Ruth*\", \"bruth\")\nCall foo(\"*Washington*\", \"gwashington\")\n' etc...\n\nEnd Sub\n\nSub foo(replace, replacement)\nDim rng As Range, cl As Range, vals\n\nSet rng = Worksheets(2).Range(\"B1:B100000\")  'Modify as needed\nFor Each cl In rng.Cells\n    vals = Split(cl.Value, \" / \")\n    For i = LBound(vals) To UBound(vals)\n        If vals(i) Like replace Then\n            vals(i) = replacement\n        End If\n    Next\n    cl.Value = Join(vals, \" / \")\nNext\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 36317984, "answer_count": 2, "score": 0, "last_activity_date": 1459369421, "creation_date": 1459365182, "last_edit_date": 1531164843, "question_id": 36317691, "link": "https://stackoverflow.com/questions/36317691/vba-replace-all-in-column-within-sections-broken-by", "title": "vba replace all in column within sections broken by &quot;/&quot;", "body": "<p>So I have some code that goes through a list of names (most are one username per row). A few of the row have multiple names broken up by the \"/\" character (John Doe / Smith Jr / Some Guy). I use the following code (repeated per name case) in order to modify all names to a proper LDAP name.</p>\n\n<pre><code>Worksheets(2).Columns(\"B\").Replace _\nWhat:=\"*smith*\", Replacement:=\"jsmith\", _\nSearchOrder:=xlByColumns, MatchCase:=False\n\nWorksheets(2).Columns(\"B\").Replace _\nWhat:=\"*Doe*\", Replacement:=\"jdoe\", _\nSearchOrder:=xlByColumns, MatchCase:=False\n</code></pre>\n\n<p>This worked for every field that only has a single name entry. Is there a way specify  to remove <em>John Doe</em> with the wildcard \"*\" charcters (some fields may not be spelt correctly etc), but to not modify anything past \"/\". </p>\n\n<p>Example data</p>\n\n<pre><code>John Doe\nAbraham Lincoln / john_doe\ndoe john\ndoe john / Obiwan\njohn doe / jsmith / mark mane\njohn smith / john doe\njohn does\n</code></pre>\n\n<p>Expected Output</p>\n\n<pre><code>jdoe\nAbraham Lincoln / jdoe \njdoe\njdoe / Obiwan\njdoe / joe smith / mark mane\njsmith / jdoe\njdoe\n</code></pre>\n\n<p>What I am receiving</p>\n\n<pre><code>jdoe\njdoe\njdoe\njdoe\njdoe\njsmith\njdoe\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 1, "creation_date": 1459367632, "post_id": 36317612, "comment_id": 60260281, "body": "You might find an answer here: <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-access/cannot-add-new-records-to-a-form-i-just-created/d11f92ac-ba75-48f1-9a23-83ba55895507?auth=1\" rel=\"nofollow noreferrer\">Microsoft Answers</a>  Chances are it is the underlying query that is the problem."}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459381225, "post_id": 36317612, "comment_id": 60266515, "body": "What is the sql statement that is producing the record set?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459416344, "post_id": 36317612, "comment_id": 60280822, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34063231/access-form-cant-update-or-add-records\">Access Form cant update or add records</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1464505210, "creation_date": 1464505210, "answer_id": 37507136, "question_id": 36317612, "link": "https://stackoverflow.com/questions/36317612/vba-new-blank-record-disabled/37507136#37507136", "title": "VBA - New (Blank) Record - Disabled", "body": "<blockquote>\n  <p>Calling a SQL Stored Procedure.</p>\n</blockquote>\n\n<p>Such queries will never be updatable.</p>\n\n<p>You can pull the result set from the query and write it to a temp table (local or on the server), update this, and write the modified data back to the source table(s).</p>\n"}], "owner": {"reputation": 167, "user_id": 3188093, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7107bab362363ec38237d078c04170c6?s=128&d=identicon&r=PG&f=1", "display_name": "mrmcg", "link": "https://stackoverflow.com/users/3188093/mrmcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642041, "creation_date": 1459364946, "last_edit_date": 1594642041, "question_id": 36317612, "link": "https://stackoverflow.com/questions/36317612/vba-new-blank-record-disabled", "title": "VBA - New (Blank) Record - Disabled", "body": "<p>I am running Access 2010.  On the form that we have the New (Blank) Record is disabled.  We need to have this enabled.  This has worked on previous versions of access on the same program.</p>\n<blockquote>\n<p>Allow Additions = Yes</p>\n<p>Data Entry = Yes</p>\n</blockquote>\n<p>Calling a SQL Stored Procedure.</p>\n<p>I added some code and created a button to add a new record...</p>\n<pre><code>Private Sub save_Click()\n    Dim ctl As Control\n    For Each ctl In Me.Controls\n        Select Case ctl.ControlType\n            Case acListBox\n                If Len(ctl.ControlSource) = 0 Then\n                    ctl.Value = Null\n                End If\n            Case acCheckBox\n                ctl.Value = 0\n            Case acTextBox\n                ctl.Value = &quot;&quot;\n        End Select    \n    Next\nEnd Sub\n</code></pre>\n<p>It gave me this message:</p>\n<blockquote>\n<p><strong>Run-Time error '3326' This recordset is not updateable.</strong></p>\n</blockquote>\n<p>I am not sure on what else to try.  Any ideas?</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "edited": false, "score": 0, "creation_date": 1459365131, "post_id": 36317585, "comment_id": 60258738, "body": "Thank you! I see that it was necessary to drill down in the for each statement to the worksheets level rather than just the workbook level."}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 0, "last_activity_date": 1459364868, "creation_date": 1459364868, "answer_id": 36317585, "question_id": 36317305, "link": "https://stackoverflow.com/questions/36317305/object-doesnt-support-property-or-method-error-in-vba-for-each-loop/36317585#36317585", "title": "Object doesn&#39;t support property or method error in VBA For each loop", "body": "<p>Updated code: you were almost there but you need to loop through the workbook worksheets...</p>\n\n<pre><code>Public Sub PrintWorksheets1()\n   'declare variables and assign address to object variable\n    Dim intPrint As Integer, shtCurrent As Worksheet\n    Dim wkbHours As Workbook: Set wkbHours = Workbooks(\"T9-EX-E9D.xls\")\n    'ask user if he or she wants to print the worksheet\n    For Each shtCurrent In wkbHours.Worksheets\n        intPrint = MsgBox(prompt:=\"Print \" &amp; shtCurrent.Name &amp; \"?\", Buttons:=vbYesNo + vbExclamation)\n        'if user wants to print\n        If intPrint = vbYes Then shtCurrent.PrintPreview\n    Next shtCurrent\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 36317585, "answer_count": 1, "score": 0, "last_activity_date": 1459364868, "creation_date": 1459363858, "last_edit_date": 1531164843, "question_id": 36317305, "link": "https://stackoverflow.com/questions/36317305/object-doesnt-support-property-or-method-error-in-vba-for-each-loop", "title": "Object doesn&#39;t support property or method error in VBA For each loop", "body": "<p>I am trying to debug the following code for a class. For the life of me I can't seem to see what is wrong with the for each statement.</p>\n\n<pre><code>Public Sub PrintWorksheets1()\n   'declare variables and assign address to object variable\n    Dim intPrint As Integer, wkbHours As Workbook, shtCurrent As Worksheets\n    Set wkbHours = Application.Workbooks(\"T9-EX-E9D.xls\")\n    'ask user if he or she wants to print the worksheet\nFor Each shtCurrent In wkbHours\n    intPrint = _\n        MsgBox(prompt:=\"Print \" &amp; shtCurrent.Name &amp; \"?\", Buttons:=vbYesNo + vbExclamation)\n    If intPrint = vbYes Then        'if user wants to print\n        shtCurrent.PrintPreview\n    End If\nNext shtCurrent\nEnd Sub\n</code></pre>\n\n<p>I have tried setting shtCurrent to the active sheet and just worksheet(s). Any help would greatly be appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1459364085, "post_id": 36317300, "comment_id": 60258058, "body": "If you want to search multiple values use a &#39;For Each Cell In Range&#39; Loop to process each value in the FName range"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1459364285, "post_id": 36317300, "comment_id": 60258190, "body": "Try adding .EntireColumn to the end of your find statement."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1459366227, "creation_date": 1459366227, "answer_id": 36317994, "question_id": 36317300, "link": "https://stackoverflow.com/questions/36317300/search-column-header-label-values/36317994#36317994", "title": "Search Column Header Label Values", "body": "<p>After identifying the search term from another workbook, you want to locate one or more occurrences in row 1 of this workbook (...?) and record the columns that correspond to the match(es).</p>\n\n<pre><code>Option Explicit\n\nSub get_em_all()\n    Dim fName As String, addr As String\n    Dim rng As Range, fnd As Range\n\n    'get search criteria\n    fName = Workbooks(\"IntChk.xlsm\").Worksheets(\"Data\").Range(\"B3\")\n\n    With ThisWorkbook   '&lt;~~ different from IntChk.xlsm...?\n        With .Worksheets(\"File\").Rows(1)\n            'perform first search\n            Set fnd = .Rows(1).Find(What:=fName, MatchCase:=False, _\n                                    LookIn:=xlValues, LookAt:=xlWhole)\n            'was anything found\n            If Not fnd Is Nothing Then\n                'record the first find\n                Set rng = fnd\n                addr = rng.Address\n                'loop and collect results until we arrive at the first find\n                Do\n                    Set rng = Union(rng, fnd)\n                    Set fnd = .FindNext(after:=fnd)\n                Loop Until addr = fnd.Address\n\n                'expand the found cells from the first row to the columns within the current region\n                With .Parent.Cells(1, 1).CurrentRegion\n                    Set rng = Intersect(rng.EntireColumn, .Cells)\n                End With\n\n                'report the address(es) of the cell(s) found\n                Debug.Print rng.Address(0, 0)\n\n            Else\n                Debug.Print 'nothing found\"\n            End If\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459459649, "post_id": 36326241, "comment_id": 60309958, "body": "sorry, I didn&#39;t understand. is my answer the solution? or what?"}, {"owner": {"reputation": 11, "user_id": 5004506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zU6hC.png?s=128&g=1", "display_name": "SecuredIS", "link": "https://stackoverflow.com/users/5004506/securedis"}, "edited": false, "score": 0, "creation_date": 1459459811, "post_id": 36326241, "comment_id": 60310041, "body": "I was able to use a for loop with a for each inside that to complete the code I needed."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 11, "user_id": 5004506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zU6hC.png?s=128&g=1", "display_name": "SecuredIS", "link": "https://stackoverflow.com/users/5004506/securedis"}, "edited": false, "score": 0, "creation_date": 1459460139, "post_id": 36326241, "comment_id": 60310191, "body": "You may post your solution to give feedback for other users to possibly get advantage of it."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459409010, "last_edit_date": 1459409010, "creation_date": 1459407479, "answer_id": 36326241, "question_id": 36317300, "link": "https://stackoverflow.com/questions/36317300/search-column-header-label-values/36326241#36326241", "title": "Search Column Header Label Values", "body": "<p><strong>edited</strong> to correct some \"optimization\" typos</p>\n\n<p>I think you want to select from a \"headers\" row all the cells whose value is on another range</p>\n\n<p>If that's your goal you could try the following</p>\n\n<pre><code>Option Explicit\n\nFunction GetRange(fnameRng As Range, dataRng As Range) As Range\nDim fName As String\n\n'get search criteria\nfName = GetJoinFromRange(fnameRng)\nWith dataRng\n    .Rows(1).Insert\n    With .Offset(-1).Resize(1)\n        .FormulaR1C1 = \"=if(isnumber(search(\"\"-\"\" &amp; R2C &amp; \"\"-\"\" ,\"\"\" &amp; fName &amp; \"\"\")),1,\"\"\"\")\"\n        .Value = .Value\n        Set GetRange = .SpecialCells(xlCellTypeConstants)).Offset(1)\n    End With\n    .Rows(1).Offset(-1).EntireRow.Delete\nEnd With\n\nEnd Function\n\n\nFunction GetJoinFromRange(rng As Range) As String\nIf rng.Rows.Count &gt; 1 Then\n    GetJoinFromRange = \"-\" &amp; Join(Application.Transpose(rng), \"-\") &amp; \"-\"\nElse\n    GetJoinFromRange = \"-\" &amp; Join(rng, \"-\") &amp; \"-\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>that can be called by a \"main\" sub like follows</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim fnameRng As Range, dataRng As Range, rngFound As Range\n\nSet fnameRng = Workbooks(\"IntChk.xlsm\").Worksheets(\"Data\").Range(\"B3:B6\") '&lt;== adapt it to your needs\nSet dataRng = ThisWorkbook.Worksheets(\"File\").Range(\"B1:I1000\") '&lt;== adapt it to your needs\n\nSet rngFound = GetRange(fnameRng, dataRng)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5004506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zU6hC.png?s=128&g=1", "display_name": "SecuredIS", "link": "https://stackoverflow.com/users/5004506/securedis"}, "is_accepted": false, "score": 0, "last_activity_date": 1459460548, "creation_date": 1459460548, "answer_id": 36344369, "question_id": 36317300, "link": "https://stackoverflow.com/questions/36317300/search-column-header-label-values/36344369#36344369", "title": "Search Column Header Label Values", "body": "<p>after a week of trial and error, I was able to create this code. it works well and its light. </p>\n\n<pre><code>sub IntChk\nDim i As Integer\nLastcol = 5\nFor i = 1 To 1\nFor j = 1 To Lastcol\nMsgBox \"Cell Value = \" &amp; Cells(j) &amp; vbNewLine &amp; \"Column Number = \" &amp; j\n    For Each c In Workbooks(\"IntChk.xlsm\").Worksheets(\"Data\").Range(\"A1:A50\")\n        If c.Value = Cells(j) Then\n        MsgBox \"Match\"\n        Match = \"True\"\n        End If\n    Next c\nNext j    \nIf Match = \"True\" Then\nMsgBox \"Yes, True!\"\nElse:\nMsgBox \"not true ;(\"\nEnd If\nNext I\nend sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5004506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zU6hC.png?s=128&g=1", "display_name": "SecuredIS", "link": "https://stackoverflow.com/users/5004506/securedis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1459460548, "creation_date": 1459363828, "last_edit_date": 1459366334, "question_id": 36317300, "link": "https://stackoverflow.com/questions/36317300/search-column-header-label-values", "title": "Search Column Header Label Values", "body": "<p>Is it possible to search row 1 (headers) for a value defined by a table from another sheet? I need \"FName\" to be a column or range of values as opposed to a single cell. </p>\n\n<p>Here is a sample of what I was able to get working so far:</p>\n\n<pre><code> FName = Workbooks(\"IntChk.xlsm\").Worksheets(\"Data\").Range(\"B3\")\n\n Set rngFound = Worksheets(\"File\").Rows(1).Find(What:=FName, LookIn:=xlValues, LookAt:=xlWhole, _\n     SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "edited": false, "score": 0, "creation_date": 1459372853, "post_id": 36319003, "comment_id": 60263226, "body": "Everything you mention has been taken into account, including Order By and limiting the number of columns. I&#39;m completely baffled, but thanks for trying."}], "tags": [], "owner": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1459369454, "creation_date": 1459369454, "answer_id": 36319003, "question_id": 36317144, "link": "https://stackoverflow.com/questions/36317144/access-writng-to-wrong-row-number/36319003#36319003", "title": "Access writng to wrong row number", "body": "<p>Two things:</p>\n\n<p>1) The order your records is the order they are in the recordset.  If you want them in a particular order, try sorting them (perhaps with an ORDER BY in the underlying SQL statement)</p>\n\n<p>2) For the column issue:  In the first bit of code, I don't see where C is initialized, but keep in mind the Headers and Fields both start with an index of 0, so if you set Header(1) = the first field's header (index 0), but then copy the data in the fields without shifting the index value, it will shift everything over by one column.</p>\n\n<p>As an added note, you might want to consider what happens when you have more than 10 columns.  Using fixed-length arrays means your code will break. You might want to read about using a dynamic array and ReDim.</p>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1460007936, "creation_date": 1460007936, "answer_id": 36467628, "question_id": 36317144, "link": "https://stackoverflow.com/questions/36317144/access-writng-to-wrong-row-number/36467628#36467628", "title": "Access writng to wrong row number", "body": "<p>I don't yet feel like I have completely grasped the entirety of the problem yet, but let me take a stab at it. From what I do understand, data is being written from your record set into excel (good), but it is going into the 'wrong row' (question title) and the 'wrong column' (question text).</p>\n\n<p>From what I see, I don't know the purpose of <code>FieldName = RSNonResourceCosts.Fields(C).Value</code>, but I want to make sure that you understand that <code>RSNonResourceCosts.Fields(C).Value</code> is not necessarily equivalent to <code>RSNonResourceCosts.Fields(Header(C)).Value</code>. More than that, you are likely missing at least one column altogether in your output, or at least skipping over it accidentally. rs.Fields(0).name is the first 'column' in a recordset, but it is completely ignored in your code. Perhaps this is intentional, maybe it is a key field or something useless to you, but it is important that you are making that distinction intentionally. But, since I don't see where your code populates the headers in your worksheet, I wonder if 'wrong column' means every record has been shifted a column and your last column is sitting empty. That, coupled with the dubious omission of C being initialized as 0 (not 1, or anything else) in your above code, makes me concerned that Header(3) could possibly by field(1), or field(4), or I don't know. That would certainly also confuse the columns in your output, or at least make dependence on FieldName frustrating. </p>\n\n<p>Another thing, really a shot in the dark: NRrows. I have had issues before, depending on how I create my recordset, of not getting the correct record count the first time. And, if I base the population of a worksheet, array, etc., on the number of rows and the records relative position in that number, my records get all sorts of wacky. Maybe you did this already, but since it isn't shown, I recommend a <code>RSNonResourceCosts.movelast: RSNonResourceCosts.movefirst</code> line before you define NRrows, just to be sure. </p>\n\n<p>And last, if I am way off base here... then you really are going to have to show us the spreadsheet, even if it isn't your most beautiful work. We all know that if it were, you wouldn't be asking about it here... so set your pride aside, and be more specific as well as show us what the output looks like and how it should look. </p>\n"}], "owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1460007936, "creation_date": 1459363311, "last_edit_date": 1459413386, "question_id": 36317144, "link": "https://stackoverflow.com/questions/36317144/access-writng-to-wrong-row-number", "title": "Access writng to wrong row number", "body": "<p>4150</p>\n\n<pre><code>NRrows = RSNonResourceCosts.RecordCount ' Number of Rows in Non Resource Table\nNRCols = RSNonResourceCosts.Fields.Count ' Number of Fields in NonResource Table\n\nDim CL(1 To 10) As Integer ' This is to count \"filled rows\" when spreadsheet is filled\nDim Header(1 To 10) As String\n\n'-----------\n'Find the Headers (Taken from Actual Table and not predefined as original)\n\nFor Each Recordsetfieldx In RSNonResourceCosts.Fields\n    If C &gt; 0 Then\n        Header(C) = Recordsetfieldx.Name\n    End If\n    C = C + 1\nNext Recordsetfieldx\n</code></pre>\n\n<p>4170</p>\n\n<pre><code>R = 0\n'Write to worksheet\nRSNonResourceCosts.MoveFirst\n\nDo Until RSNonResourceCosts.EOF\n    For C = 1 To NRCols - 1\n        FieldName = RSNonResourceCosts.Fields(C).Value\n\n        If RSNonResourceCosts.Fields(Header(C)).Value &lt;&gt; \"\" Then\n            CL(C) = CL(C) + 1\n            WKS.Cells(200 + R, C) = RSNonResourceCosts.Fields(Header(C)).Value\n        End If\n    Next C\n\n    RSNonResourceCosts.MoveNext\n    R = R + 1\nLoop\n</code></pre>\n\n<p>I attach code. Have solved part of original by defining Recordset. User can add column to Table. First part of code determines the headers. Second part determines values and writes to worksheet.  The new Rows are appearing first on the worksheet and in wrong column. I tried attaching worksheet but it looked awful.  Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1459362301, "post_id": 36316593, "comment_id": 60256878, "body": "Usually one would have and <code>Exit Sub</code> before the error handler. Maybe try putting your error handler at the end of the code. If you don&#39;t exit the sub before the error handler, the code will go through those lines of code as well."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1459362708, "post_id": 36316593, "comment_id": 60257201, "body": "Ok so an exit sub after the last message box?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1459365076, "post_id": 36316593, "comment_id": 60258700, "body": "You could also look into using a Calendar Control"}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459362934, "post_id": 36316943, "comment_id": 60257357, "body": "I tried this and no matter if the format is wrong it still works I need it to stop if the formatting is incorrect"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459363003, "post_id": 36316943, "comment_id": 60257402, "body": "@BriannaCates - can you explain with an example about the &quot;format being wrong&quot;?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459363142, "post_id": 36316943, "comment_id": 60257505, "body": "When I typed in the date like 02/14/2 it still went through.. I want it to stop if its not exactly like dd/mm/yyyy"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 1, "creation_date": 1459363393, "post_id": 36316943, "comment_id": 60257650, "body": "@BriannaCates I think my edits have you covered now, even if it a bit clunky."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459363492, "post_id": 36316943, "comment_id": 60257710, "body": "I tried that and when I put the date like 03/14/2016 it will not accept it"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459363573, "post_id": 36316943, "comment_id": 60257759, "body": "@BriannaCates - sorry. I messed up on the <code>Mid</code> formula. Try it now."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459365111, "post_id": 36316943, "comment_id": 60258725, "body": "well crap I&#39;m stuck in a loop now... I dont know how to break it"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 1, "creation_date": 1459365629, "post_id": 36316943, "comment_id": 60259035, "body": "@BriannaCates <code>Ctrl + Pause</code> to break the code :) always best to debug step-by-step when testing :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459366334, "post_id": 36316943, "comment_id": 60259506, "body": "@BriannaCates - yw. sorry for all the back and forth with simple mistakes :("}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459430030, "post_id": 36316943, "comment_id": 60290958, "body": "No worries what you did was perfect! :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1459363556, "last_edit_date": 1459363556, "creation_date": 1459362803, "answer_id": 36316943, "question_id": 36316593, "link": "https://stackoverflow.com/questions/36316593/relaunch-input-box/36316943#36316943", "title": "Relaunch Input Box", "body": "<p>How about a simple <code>Do Until</code> Loop:</p>\n\n<pre><code>Dim cellvalue As Variant\n\nDo\n\n    cellvalue = Application.InputBox(\"Please Enter The Date for Data Extracted (dd/mm/yyyy)\")\n\nLoop Until IsDate(cellvalue) And IsNumeric(Right(cellvalue, 4)) And IsNumeric(Left(cellvalue, 2)) And IsNumeric(Mid(cellvalue, 4,2))\n\nws.Range(\"A1\").Value = cellvalue\nMsgBox (\"Date Entered!\")\n</code></pre>\n\n<p>I tested this pretty thoroughly and it only accepted dates in the exact format you desire.</p>\n"}, {"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459363348, "post_id": 36317029, "comment_id": 60257625, "body": "Is there any way I can have this set to only accept a certain format?"}, {"owner": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 0, "creation_date": 1459367092, "post_id": 36317029, "comment_id": 60259974, "body": "Just to add one detail, this particular method is giving you a variable of type Date, which you can then format to display with whatever date format you like, i.e. Format(d, &quot;dd/mm/yyyy&quot;).  As such, it doesn&#39;t require the user to follow the strict format rules to enter the date (they can use anything that VBA recognizes as a date), but you can still put it into the format you need.  This might be a bit easier for the end user, depending on your specific situation."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459432795, "post_id": 36317029, "comment_id": 60293093, "body": "@BriannaCates  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1459432766, "last_edit_date": 1459432766, "creation_date": 1459362994, "answer_id": 36317029, "question_id": 36316593, "link": "https://stackoverflow.com/questions/36316593/relaunch-input-box/36317029#36317029", "title": "Relaunch Input Box", "body": "<p>Here is a simple way to repeatedly ask for a date until you get one, but allow the user to cancel out:</p>\n\n<pre><code>Sub fhskjfs()\n    Dim i As String, d As Date\n    i = \"\"\n\n    While Not IsDate(i)\n        i = Application.InputBox(Prompt:=\"Enter a date\", Type:=2)\n        If i = False Then Exit Sub\n        If IsDate(i) Then d = CDate(i)\n    Wend\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Here is a way to implement a simple format check:</p>\n\n<pre><code>Public Function CheckFormat(i As String) As String\n    CheckFormat = \"junk\"\n    ary = Split(i, \"/\")\n    If UBound(ary) &lt;&gt; 2 Then Exit Function\n    If CLng(ary(2)) &lt; 1900 Or CLng(ary(2)) &gt; 9999 Then Exit Function\n    If CLng(ary(1)) &gt; 12 Then Exit Function\n    If CLng(ary(0)) &gt; 31 Then Exit Function\n    CheckFormat = i\nEnd Function\n\nSub GetDate()\n    Dim i As String, d As Date\n    i = \"\"\n\n    While Not IsDate(i)\n        i = Application.InputBox(Prompt:=\"Enter a date\", Type:=2)\n        If i = \"False\" Then Exit Sub\n        i = CheckFormat(i)\n        If IsDate(i) Then d = CDate(i)\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 36316943, "answer_count": 2, "score": 0, "last_activity_date": 1459499521, "creation_date": 1459361710, "last_edit_date": 1459499521, "question_id": 36316593, "link": "https://stackoverflow.com/questions/36316593/relaunch-input-box", "title": "Relaunch Input Box", "body": "<p>I have an excel sheet than when its first opened it asks the user to enter a date into the input box and it places it into a cell in the sheet. I have an error handle to pop up an invalid date error box if someone puts in the wrong date. But what I want to do is when an invalid date is entered the original input box for the date pops up again so they can reenter again. I have the code below of what I have written so far but I keep getting an error. </p>\n\n<p>Thanks</p>\n\n<pre><code>ReShowInputBox: cellvalue = Application.InputBox(\"Please Enter The Date for Data Extracted (dd/mm/yyyy)\")\nOn Error GoTo ErrHandle\n\nErrHandle:\nMsgBox (\"Invalid Date\")\nReShowInputBox: cellvalue = Application.InputBox(\"Please Enter The Date for Data Extracted (dd/mm/yyyy)\")\n\nIf cellvalue = \"\" Then Exit Sub\nws.Select\nws.Range(\"A1\").Value = DateValue(cellvalue)\nMsgBox (\"Date Entered!\")\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459362077, "post_id": 36316385, "comment_id": 60256725, "body": "So you are looking for a VBA based solution and not T-SQL? Can you provide sample code that shows the processes you go through in the loop? That would be the first place to pick up efficiency."}, {"owner": {"reputation": 11, "user_id": 4501403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxzfh1I7cqI/AAAAAAAAAAI/AAAAAAAAACA/7EQvKD6ASZQ/photo.jpg?sz=128", "display_name": "Thomas Xu", "link": "https://stackoverflow.com/users/4501403/thomas-xu"}, "edited": false, "score": 0, "creation_date": 1459362260, "post_id": 36316385, "comment_id": 60256848, "body": "I will after it&#39;s done running. I was just thinking if there is a way to just export a csv file to sql just using vba or something that&#39;ll be faster."}, {"owner": {"reputation": 298, "user_id": 892913, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/99141f9af33f1d55ed6b5d1073b32ff9?s=128&d=identicon&r=PG", "display_name": "teenboy", "link": "https://stackoverflow.com/users/892913/teenboy"}, "edited": false, "score": 0, "creation_date": 1459362314, "post_id": 36316385, "comment_id": 60256890, "body": "Separate the validation from export to sql server. To optimize the network load, you can create stored proc, so only values are passed."}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1459368496, "post_id": 36316385, "comment_id": 60260774, "body": "Not sure how often you have to do this, but if its a 1x or rarely ... right click the database and go to Import, follow the wizard. SSIS is always best if long term."}], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 5228994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHICl.png?s=128&g=1", "display_name": "Jhony Donosso Gutierrez", "link": "https://stackoverflow.com/users/5228994/jhony-donosso-gutierrez"}, "reply_to_user": {"reputation": 11, "user_id": 4501403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxzfh1I7cqI/AAAAAAAAAAI/AAAAAAAAACA/7EQvKD6ASZQ/photo.jpg?sz=128", "display_name": "Thomas Xu", "link": "https://stackoverflow.com/users/4501403/thomas-xu"}, "edited": false, "score": 0, "creation_date": 1459381131, "post_id": 36316982, "comment_id": 60266488, "body": "Thomas, maybe the next video that I record for you, could help you: <a href=\"https://drive.google.com/file/d/0B3p88EQFnMR_SU56SDFBNE1MdEU/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B3p88EQFnMR_SU56SDFBNE1MdEU/&hellip;</a>"}], "tags": [], "owner": {"reputation": 120, "user_id": 5228994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHICl.png?s=128&g=1", "display_name": "Jhony Donosso Gutierrez", "link": "https://stackoverflow.com/users/5228994/jhony-donosso-gutierrez"}, "is_accepted": false, "score": 1, "last_activity_date": 1459362890, "creation_date": 1459362890, "answer_id": 36316982, "question_id": 36316385, "link": "https://stackoverflow.com/questions/36316385/is-there-a-faster-way-to-export-rows-in-excel-to-sql-server/36316982#36316982", "title": "Is there a faster way to export rows in Excel to SQL Server?", "body": "<p>First, you neeed to install this driver ([Microsoft.ACE.OLEDB.12.0]) on your instance of SQl-server </p>\n\n<p><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=13255\" rel=\"nofollow\">Download Here - Driver</a></p>\n\n<p>then execute this query on SQL-Sever:</p>\n\n<pre><code>  select * \n  into mytable\n  from OpenDataSource('Microsoft.ACE.OLEDB.12.0', 'Excel 12.0;HDR=Yes;IMEX=1;Database=c\\desktop\\myExcelfile.xlsm')...[mySheet$] \n</code></pre>\n\n<p>Don't remove this character \"$\"</p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1459365471, "last_edit_date": 1459365471, "creation_date": 1459365145, "answer_id": 36317677, "question_id": 36316385, "link": "https://stackoverflow.com/questions/36316385/is-there-a-faster-way-to-export-rows-in-excel-to-sql-server/36317677#36317677", "title": "Is there a faster way to export rows in Excel to SQL Server?", "body": "<p>You can drastically improve the performance by working with an array and by using a buffer to build the query.\nIt should take just a few millisecond to build a query with 10000 rows.\nHere is an example: </p>\n\n<pre><code>Sub build_query()\n  Dim buffer As String, length&amp;, data(), r&amp;, c&amp;\n\n  ' load the data in an array '\n  data = Range(\"A2:C5\")\n\n  ' create the string buffer '\n  buffer = String$(2048, vbNullChar)\n\n  ' write the header '\n  Append buffer, length, \"INSERT INTO [MyTable] ('ColA', 'ColB', 'ColB') Values(\" &amp; vbCrLf\n\n  ' iterate each cell '\n  For r = 1 To UBound(data)\n    Append buffer, length, \"(\"\n    For c = 1 To UBound(data, 2)\n      If c &gt; 1 Then Append buffer, length, \",\"\n\n      ' convert each type '\n      Select Case VarType(data(r, c))\n        Case vbDate:\n          Append buffer, length, format(data(r, c), \"'yyyy-mm-dd HH:nn:ss'\")\n        Case vbString:\n          Append buffer, length, \"'\" &amp; data(r, c) &amp; \"'\"\n        Case Else:\n          Append buffer, length, CStr(data(r, c))\n      End Select\n\n    Next\n    Append buffer, length, \"),\" &amp; vbCrLf\n  Next\n\n  ' write the footer '\n  length = length - 3 ' remove comma '\n  Append buffer, length, \");\"\n\n  ' display the result '\n  Debug.Print Left$(buffer, length)\nEnd Sub\n\nPrivate Sub Append(buffer$, length&amp;, text$)\n  length = length + Len(text)\n  If length &gt; Len(buffer) Then\n    buffer = buffer &amp; String$(Len(buffer) * (length \\ Len(buffer)), vbNullChar)\n  End If\n  Mid$(buffer, length - Len(text) + 1) = text\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 2280148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a0286090468dbba86dd4530a547d1?s=128&d=identicon&r=PG", "display_name": "JohannesGbg", "link": "https://stackoverflow.com/users/2280148/johannesgbg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459514114, "creation_date": 1459514114, "answer_id": 36356515, "question_id": 36316385, "link": "https://stackoverflow.com/questions/36316385/is-there-a-faster-way-to-export-rows-in-excel-to-sql-server/36356515#36356515", "title": "Is there a faster way to export rows in Excel to SQL Server?", "body": "<p>I've  created an Excel Add-In where you can export Excel data to SQL Server. Did a test with 8500 rows and 40 columns and it took 4.5 seconds to insert the rows in Excel to SQL Server. </p>\n\n<p>I sell it as a commerial prodcut, but if it is a time limited job, you can use the full functional trial for free (and if you need, just send me an email and I'll extended the trial for you). </p>\n\n<p>You can download it here <a href=\"http://sqlspreads.com/download-sql-spreads/\" rel=\"nofollow\">http://sqlspreads.com/download-sql-spreads/</a> </p>\n"}], "owner": {"reputation": 11, "user_id": 4501403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxzfh1I7cqI/AAAAAAAAAAI/AAAAAAAAACA/7EQvKD6ASZQ/photo.jpg?sz=128", "display_name": "Thomas Xu", "link": "https://stackoverflow.com/users/4501403/thomas-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1459514114, "creation_date": 1459361076, "last_edit_date": 1459361951, "question_id": 36316385, "link": "https://stackoverflow.com/questions/36316385/is-there-a-faster-way-to-export-rows-in-excel-to-sql-server", "title": "Is there a faster way to export rows in Excel to SQL Server?", "body": "<p>I have 8,500 rows with 36 columns that I need to insert to a SQL Server table, and currently it's taking 9 minutes. I was wondering if there is a faster way to do this. I've read up on bulk inserts but I'm saving that as a last resort.</p>\n\n<p>Currently how I'm doing it, is that I'm using a for each loop and having an if statement to check if each cell is formatted properly (probably a reason why its slow, but I need it there). And I'm concatenating them all to be exported at once.  </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "edited": false, "score": 0, "creation_date": 1459361905, "post_id": 36316167, "comment_id": 60256619, "body": "This looks wrong to me: &quot;# AND ASSET_MONTH &lt;= #&quot;  - remove the AND from the date string."}, {"owner": {"reputation": 35, "user_id": 4455039, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1U3r_VpCcgY/AAAAAAAAAAI/AAAAAAAAANc/h1eeIUxhKM0/photo.jpg?sz=128", "display_name": "Alvin van der Kuech", "link": "https://stackoverflow.com/users/4455039/alvin-van-der-kuech"}, "reply_to_user": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "edited": false, "score": 0, "creation_date": 1459363724, "post_id": 36316167, "comment_id": 60257836, "body": "Thx Ron, I&#39;ve tried that.  Doesn&#39;t really work.  I know the syntax is totally off, that&#39;s why I&#39;m looking for a correct example of how to do this.  Thx again."}], "answers": [{"comments": [{"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 35, "user_id": 4455039, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1U3r_VpCcgY/AAAAAAAAAAI/AAAAAAAAANc/h1eeIUxhKM0/photo.jpg?sz=128", "display_name": "Alvin van der Kuech", "link": "https://stackoverflow.com/users/4455039/alvin-van-der-kuech"}, "edited": false, "score": 0, "creation_date": 1459453237, "post_id": 36321998, "comment_id": 60306426, "body": "Glad I could help, Alvin."}], "tags": [], "owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "is_accepted": true, "score": 1, "last_activity_date": 1459383030, "creation_date": 1459383030, "answer_id": 36321998, "question_id": 36316167, "link": "https://stackoverflow.com/questions/36316167/ms-access-search-criteria-by-month/36321998#36321998", "title": "MS Access - Search criteria by month", "body": "<p>Since your are matching a month to a month, you do not use the # - this is only for dates:</p>\n\n<pre><code>adjust = \"(ASSET_MONTH &gt;= \" &amp; Me.month_filt &amp; \" AND #ASSET_MONTH &lt;= \" &amp; Me.month_filt &amp; \")\"\n</code></pre>\n\n<p>only \nOR</p>\n\n<pre><code>adjust = \"(ASSET_MONTH BETWEEN \" &amp; Me.month_filt &amp; \" AND \" &amp; Me.month_filt &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4455039, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1U3r_VpCcgY/AAAAAAAAAAI/AAAAAAAAANc/h1eeIUxhKM0/photo.jpg?sz=128", "display_name": "Alvin van der Kuech", "link": "https://stackoverflow.com/users/4455039/alvin-van-der-kuech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 36321998, "answer_count": 1, "score": 0, "last_activity_date": 1459383030, "creation_date": 1459360418, "question_id": 36316167, "link": "https://stackoverflow.com/questions/36316167/ms-access-search-criteria-by-month", "title": "MS Access - Search criteria by month", "body": "<p>I'm trying to make a month &amp; year search criteria for the below SQL code.  I'm making an MS Access app that lets the user choose the company - which I've done.  Then let's the user choose the month &amp; year then the user clicks ok and get's the info for the filtered month along with 2 prior months.  I know this is a lot, but I've had no luck with the date filter.  I've followed all kinds of examples, but I can't seem to get my head around it.  Can someone please help me out with a code example or something similar.  Thanks so much</p>\n\n<p>Here's the SQL code:</p>\n\n<pre><code>TRANSFORM Sum(dbo_ASSET_HISTORY.MARKET_VALUE) AS SumOfMARKET_VALUE\nSELECT [dbo_FIRM]![NAME] AS [FIRM NAME], dbo_FUND.CUSIP, dbo_FUND.FUND_NAME,dbo_FUND.PRODUCT_NAME                                     \nFROM (dbo_ASSET_HISTORY INNER JOIN dbo_FIRM ON dbo_ASSET_HISTORY.FIRM_ID = dbo_FIRM.FIRM_ID) INNER JOIN dbo_FUND ON dbo_ASSET_HISTORY.FUND = dbo_FUND.FUND\nWHERE (((dbo_FIRM.NAME) Like \"Voya F*\") AND     ((dbo_ASSET_HISTORY.ASSET_YEAR)=Year(DateAdd('m',-1,Date()))) AND     ((dbo_ASSET_HISTORY.ASSET_MONTH) In (Month(DateAdd('m',-1,Date())))))\nGROUP BY [dbo_FIRM]![NAME], dbo_FUND.CUSIP, dbo_FUND.FUND_NAME, dbo_FUND.PRODUCT_NAME\nPIVOT [dbo_ASSET_HISTORY]![ASSET_YEAR] &amp; '-' &amp; [dbo_ASSET_HISTORY]!    [ASSET_MONTH];\n</code></pre>\n\n<p>Here's a piece of VBA\nThis was only for the \"month filter\" just as a test to see if it works</p>\n\n<pre><code>Dim adjust As String\nDim task As String\n\nPrivate Sub Command0_Click()\nIf IsNull(Me.month_filt) Then\n    DoCmd.Close\n    DoCmd.OpenQuery \"ct_VoysF_AUM_Q\"\nElse\n    adjust = \"(ASSET_MONTH &gt;= #\" &amp; Me.month_filt &amp; \"# AND ASSET_MONTH &lt;= #\"    &amp; Me.month_filt &amp; \"#)\"\n    task = \"Select * from ct_VoysF_AUM_Q where (\" &amp; adjust &amp; \")\"\n    DoCmd.ApplyFilter task\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 2, "last_activity_date": 1459360881, "creation_date": 1459360881, "answer_id": 36316313, "question_id": 36315909, "link": "https://stackoverflow.com/questions/36315909/excel-vba-printout-and-define-dynamic-print-area/36316313#36316313", "title": "Excel VBA printout and define dynamic print area", "body": "<h2>Set your print area</h2>\n\n<pre><code>Sub Button1_Click()\n    Dim LstRw As Long, PrnG As Range\n\n    LstRw = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set PrnG = Range(\"A1:C\" &amp; LstRw)    ' or whatever column you want\n    ActiveSheet.PageSetup.PrintArea = PrnG.Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6136082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21434fc068b31b7eb0e839089b9e57ed?s=128&d=identicon&r=PG&f=1", "display_name": "Anarchy98", "link": "https://stackoverflow.com/users/6136082/anarchy98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459360881, "creation_date": 1459359519, "question_id": 36315909, "link": "https://stackoverflow.com/questions/36315909/excel-vba-printout-and-define-dynamic-print-area", "title": "Excel VBA printout and define dynamic print area", "body": "<p>i'm actually trying to, for a command button, set a print area based on colomn A (if A is empty then this row is last row. and when the print area is set, just print it out with landscape layout. My code for now is as follow. When i clic it prints but doesn't update the print area can you help me plz</p>\n\n<pre><code>Private Sub Imprimer_Click()\n\nActiveSheet.Unprotect Password:=\"mypass\"\n\nDim usedRangeEx As Range\nSet usedRangeEx = GetUsedRangeIncludingCharts(ActiveSheet)\nusedRangeEx.Activate\nDebug.Print usedRangeEx.Address\n\nActiveSheet.Protect Password:=\"mypass\" \n\nEnd Sub\n\nPrivate Function GetUsedRangeIncludingCharts(target As Worksheet) As Range\n\nActiveSheet.Unprotect Password:=\"mypass\"\n\nDim firstRow As Long\nDim firstColumn As Integer\nDim lastRow As Long\nDim lastColumn As Integer\nDim oneChart As ChartObject\n\n    For Each cell In Range(\"A5:A65\")\n                If Not IsEmpty(cell) Then\n                        lastRow = cell.Row\n\nEnd If\n\nNext\n\nWith target\n    firstRow = .UsedRange.cells(1).Row\n    firstColumn = .UsedRange.cells(1).Column\n    lastColumn = .UsedRange(.UsedRange.cells.Count).Column\n\nSet GetUsedRangeIncludingCharts = .Range(.cells(firstRow, firstColumn), _\n                                             .cells(lastRow, lastColumn))\nEnd With\n\nThisWorkbook.ActiveSheet.PrintOut\nWith ActiveSheet.PageSetup\n    .Zoom = False\n    .FitToPagesTall = 1\n    .FitToPagesWide = 1\n\nEnd With\n\nActiveSheet.Protect Password:=\"mypass\"\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook", "ms-access-2007"], "comments": [{"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459381481, "post_id": 36315611, "comment_id": 60266599, "body": "There is no such thing on SO as pinging to bring the post up again, as other forums have."}, {"owner": {"reputation": 1, "user_id": 5762563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1233693069978994/picture?type=large", "display_name": "Endoftheland Endoftheland", "link": "https://stackoverflow.com/users/5762563/endoftheland-endoftheland"}, "reply_to_user": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459381738, "post_id": 36315611, "comment_id": 60266693, "body": "Was my question clear ??"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5762563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1233693069978994/picture?type=large", "display_name": "Endoftheland Endoftheland", "link": "https://stackoverflow.com/users/5762563/endoftheland-endoftheland"}, "edited": false, "score": 0, "creation_date": 1459440028, "post_id": 36321920, "comment_id": 60298530, "body": "thanks MikeC for reply but unfortunately the situation still the same .any other idea ?"}, {"owner": {"reputation": 1, "user_id": 5762563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1233693069978994/picture?type=large", "display_name": "Endoftheland Endoftheland", "link": "https://stackoverflow.com/users/5762563/endoftheland-endoftheland"}, "edited": false, "score": 0, "creation_date": 1459445482, "post_id": 36321920, "comment_id": 60301941, "body": "I used Shell function at the beginning of my code like this .. is it OK ?? Shell (&quot;outlook.exe&quot;)"}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "reply_to_user": {"reputation": 1, "user_id": 5762563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1233693069978994/picture?type=large", "display_name": "Endoftheland Endoftheland", "link": "https://stackoverflow.com/users/5762563/endoftheland-endoftheland"}, "edited": false, "score": 0, "creation_date": 1459448399, "post_id": 36321920, "comment_id": 60303624, "body": "Your posted code shows <code>Set oOutlook = New Outlook.Application</code>?! If you are Shelling it out, how were you able to process SyncObjects according to the code I posted?"}, {"owner": {"reputation": 1, "user_id": 5762563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1233693069978994/picture?type=large", "display_name": "Endoftheland Endoftheland", "link": "https://stackoverflow.com/users/5762563/endoftheland-endoftheland"}, "edited": false, "score": 0, "creation_date": 1459478010, "post_id": 36321920, "comment_id": 60315468, "body": "Thank you MIceC ,but i told you that the situation is the same with Syncobjects .mails stay in outbox and i must open the outlook, but with shell its ok now , but i need your advice if there is any thing i dont know about shell."}], "tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": false, "score": 0, "last_activity_date": 1459382564, "creation_date": 1459382564, "answer_id": 36321920, "question_id": 36315611, "link": "https://stackoverflow.com/questions/36315611/ms-access-vba-sending-email-using-outlook-stay-in-outbox/36321920#36321920", "title": "ms access vba sending Email using outlook .. stay in outbox", "body": "<p>You can Sync the account to ensure the email is sent (and new email is received). Send/Receive settings can be modified for Outlook to change its behavior in interactive use.</p>\n\n<pre><code>Dim oSyncObjects As Outlook.SyncObjects\nDim i As Long\n\n\nSet oSyncObjects = oOutlook.GetNamespace(\"MAPI\").SyncObjects\n\nFor i = 1 To oSyncObjects.Count\n    OSyncObjects.Item(i).Start\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5762563, "user_type": "registered", "profile_image": "https://graph.facebook.com/1233693069978994/picture?type=large", "display_name": "Endoftheland Endoftheland", "link": "https://stackoverflow.com/users/5762563/endoftheland-endoftheland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459382564, "creation_date": 1459358454, "last_edit_date": 1459365884, "question_id": 36315611, "link": "https://stackoverflow.com/questions/36315611/ms-access-vba-sending-email-using-outlook-stay-in-outbox", "title": "ms access vba sending Email using outlook .. stay in outbox", "body": "<p>i am using this code to send an email using outlook, but the problem is that I must open outlook then the messages will be sent.</p>\n\n<p>i used .display but the problem still the same.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Private Sub btnSend_Click()\n\nOn Error GoTo errHandelrs\n\nDim oOutlook As Outlook.Application\nDim oeMailitem As MailItem\nDim rs As Recordset\nDim CustmrEmail As String\nDim n As Integer\n\nIf oOutlook Is Nothing Then\nSet oOutlook = New Outlook.Application\nEnd If\nSet oeMailitem = oOutlook.CreateItem(olMailItem)\nWith oeMailitem\nSet rs = CurrentDb.OpenRecordset(\"select *from tbl\")\n\n If rs.RecordCount &gt; 0 Then\n rs.MoveFirst\n Do Until rs.EOF\n If IsNull(rs!Email) Then\n rs.MoveNext\n Else\n CustmrEmail = CustmrEmail &amp; rs!Email &amp; \";\"\n     .To = CustmrEmail\n     rs.MoveNext\n     End If\n     Loop\nElse\n     MsgBox \"nO bOdy\"\nEnd If\n    .CC = \"\"\n    .Subject = \"mYSUbject\"\n    For n = 0 To Me.list3.ListCount - 1\n    .Attachments.Add (Me.list3.ItemData(n))\n    Next n\n    .Send\n\nEnd With\nExit_ErrHandelrs:\nExit Sub\nerrHandelrs:\nMsgBox Err.Description, vbCritical\nResume Exit_ErrHandelrs\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1459366901, "post_id": 36315510, "comment_id": 60259858, "body": "If you have Excel 2016 / Office 365, you can use the <code>TEXTJOIN</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 1311, "user_id": 3187469, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/084457aefeaaf01ccfa0af33a0128292?s=128&d=identicon&r=PG", "display_name": "user3187469", "link": "https://stackoverflow.com/users/3187469/user3187469"}, "edited": false, "score": 0, "creation_date": 1459362454, "post_id": 36315888, "comment_id": 60256990, "body": "can you give an example? I&#39;m not sure I understand"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 1311, "user_id": 3187469, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/084457aefeaaf01ccfa0af33a0128292?s=128&d=identicon&r=PG", "display_name": "user3187469", "link": "https://stackoverflow.com/users/3187469/user3187469"}, "edited": false, "score": 0, "creation_date": 1459363887, "post_id": 36315888, "comment_id": 60257943, "body": "Let&#39;s say your data for Entry ID is in column A, your Contest Name is in column B and your Entry ID is in column C and you want all cells combined in column D. The formula for field D2 would be =CONCATENATE(A2,&quot;,&quot;,B2,&quot;,&quot;,C2), which will output: 372085759, NBA $10K, Quarter Arcade"}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 2, "last_activity_date": 1459359427, "creation_date": 1459359427, "answer_id": 36315888, "question_id": 36315510, "link": "https://stackoverflow.com/questions/36315510/combine-multiple-cells-into-one-and-seperate-text-by-comma/36315888#36315888", "title": "Combine Multiple Cells into one and seperate text by comma", "body": "<p>You can use CONCATENATE, e.g. =CONCATENATE(field1,\",\",field2,\",\",field3,...), which field1 being the Entry ID, field2 being the Contest name, field3 being the Contest ID and so on.</p>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 3758099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gE6bK.jpg?s=128&g=1", "display_name": "tc_NYC", "link": "https://stackoverflow.com/users/3758099/tc-nyc"}, "is_accepted": false, "score": 0, "last_activity_date": 1459362655, "creation_date": 1459362655, "answer_id": 36316895, "question_id": 36315510, "link": "https://stackoverflow.com/questions/36315510/combine-multiple-cells-into-one-and-seperate-text-by-comma/36316895#36316895", "title": "Combine Multiple Cells into one and seperate text by comma", "body": "<p>You can create an excel UDF to concatenate a comma to each of the cells:</p>\n\n<pre><code>Function addCommas(myRange As Range) As String\n\naddCommas = \"\"\n\nFor Each cell In myRange\n\n    addCommas = addCommas &amp; cell.Value &amp; \", \"\n\nNext cell\n\nEnd Function\n</code></pre>\n\n<p>Just write the addCommas function on a column on the right and point at the columns you want to concat a comma to.</p>\n"}], "owner": {"reputation": 1311, "user_id": 3187469, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/084457aefeaaf01ccfa0af33a0128292?s=128&d=identicon&r=PG", "display_name": "user3187469", "link": "https://stackoverflow.com/users/3187469/user3187469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459362655, "creation_date": 1459358157, "last_edit_date": 1531161705, "question_id": 36315510, "link": "https://stackoverflow.com/questions/36315510/combine-multiple-cells-into-one-and-seperate-text-by-comma", "title": "Combine Multiple Cells into one and seperate text by comma", "body": "<p>So I have these tables as you can see below, each in it's own cell. My questions is, what is the easiest way to combine all cells in each row into one cell, and seperate text by comma.</p>\n\n<p>So for example I would like to achieve in A1 and same for others:</p>\n\n<pre><code>Entry ID,Contest Name,Contest ID,Entry Fee,PG,SG,SF,PF,C,G,F,UTIL\n\n\n\n&gt; Entry ID  Contest Name    Contest ID  Entry Fee   PG  SG  SF  PF  C   G   F   UTIL\n&gt;     372085759 NBA $10K Quarter Arcade [Just $0.25!]   22552804    $0.25   6444834 6444876 6444974 6445030 6445047 6444918 6445025 6445083\n&gt;     372085760 NBA $10K Quarter Arcade [Just $0.25!]   22552804    $0.25   6444832 6444868 6444939 6444986 6445083 6444878 6445022 6444853\n&gt;     372085761 NBA $10K Quarter Arcade [Just $0.25!]   22552804    $0.25   6444821 6444911 6444974 6445000 6445068 6444856 6444938 6444909\n&gt;     372085762 NBA $10K Quarter Arcade [Just $0.25!]   22552804    $0.25   6444856 6444885 6444938 6445001 6445081 6444867 6445005 6445083\n&gt;     372085763 NBA $10K Quarter Arcade [Just $0.25!]   22552804    $0.25   6444821 6444876 6444929 6445030 6445083 6444844 6445025 6444853\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 13, "user_id": 6129561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0af7818e6026f1527bd659f86e539be?s=128&d=identicon&r=PG&f=1", "display_name": "Queen", "link": "https://stackoverflow.com/users/6129561/queen"}, "edited": false, "score": 0, "creation_date": 1460018810, "post_id": 36315286, "comment_id": 60552706, "body": "hello anyone have any idea?"}], "owner": {"reputation": 13, "user_id": 6129561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0af7818e6026f1527bd659f86e539be?s=128&d=identicon&r=PG&f=1", "display_name": "Queen", "link": "https://stackoverflow.com/users/6129561/queen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459372472, "creation_date": 1459357460, "last_edit_date": 1459372472, "question_id": 36315286, "link": "https://stackoverflow.com/questions/36315286/multiple-selected-items-from-listbox-to-select-stored-procedure-in-sql-server-us", "title": "multiple selected items from listbox to select stored procedure in sql server using excel vba", "body": "<p>I have a list box in <code>excel</code> that allows multiple selection, but i'm not sure how to pass the selected items to a single parameter for my sql server <code>stored procedure</code>. say i want to:</p>\n\n<pre><code>select * from where field in ('selected', 'items', 'from', 'list', 'box')\n</code></pre>\n\n<p>Any idea how to do this in excel with vba?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1459368044, "creation_date": 1459368044, "answer_id": 36318596, "question_id": 36315235, "link": "https://stackoverflow.com/questions/36315235/how-to-transpose-a-unique-list-of-values-from-a-column-using-copytorange/36318596#36318596", "title": "How to transpose a unique list of values from a column using &#39;CopyToRange&#39;", "body": "<p>I think the only way is to do it in 2 steps:</p>\n\n<pre><code>Sub GetComponents()\n\nActiveSheet.Range(\"G2:G65536\").AdvancedFilter Action:=xlFilterCopy, _ \n     CopyToRange:=ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1\"), Unique:=True\n\nWith ThisWorkbook.Worksheets(\"Sheet2\")\n    .Range(.Range(\"A1\"), .Range(\"A1\").End(xlDown)).Copy\n    .Range(\"B1\").PasteSpecial xlPasteValues, Transpose:=True\n    .Columns(\"A\").EntireColumn.Delete\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 324, "user_id": 3284580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/963a7e46a2ea84e21989c9a80e4a6a57?s=128&d=identicon&r=PG&f=1", "display_name": "JMari&#241;a", "link": "https://stackoverflow.com/users/3284580/jmari%c3%b1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2319, "favorite_count": 0, "accepted_answer_id": 36318596, "answer_count": 1, "score": 0, "last_activity_date": 1459500744, "creation_date": 1459357293, "last_edit_date": 1459500744, "question_id": 36315235, "link": "https://stackoverflow.com/questions/36315235/how-to-transpose-a-unique-list-of-values-from-a-column-using-copytorange", "title": "How to transpose a unique list of values from a column using &#39;CopyToRange&#39;", "body": "<p>After some research I've found ways to transpose using 'pastespecial'. However, I don't think this will work for me since I'm using copy to range to get unique values.</p>\n\n<p>The following code works in copying unique values to a workbook:</p>\n\n<pre><code>Sub GetComponents()\n\nActiveSheet.Range(\"G2:G65536\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1\"), Unique:=True\n\nEnd Sub\n</code></pre>\n\n<p>However, when I try to transpose it fails</p>\n\n<pre><code>Sub GetComponents()\n\nActiveSheet.Range(\"G2:G65536\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1\"), Unique:=True, Transpose:=True\n\nEnd Sub\n</code></pre>\n\n<p>Is there a way To get 'CopyToRange' to transpose? If not can I get 'PasteSpecial' to filter on unique values?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 1, "creation_date": 1459356151, "post_id": 36314799, "comment_id": 60253007, "body": "What about <code>trList.Count</code>?"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "reply_to_user": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1459357127, "post_id": 36314799, "comment_id": 60253661, "body": "trList.Count makes the program return an error: &quot;Object doesn&#39;t support this property or method&quot;  trList is an IHTMLElementCollection if that is of any help"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459359300, "post_id": 36314799, "comment_id": 60254951, "body": "If you put a break on the <code>Set trList = ...</code> line and wait a little while before continuing execution, does that change the outcome ?"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1459359338, "post_id": 36314799, "comment_id": 60254980, "body": "Try declaring <code>trList</code> like this instead: <code>Dim trList As Object</code>, then try using <code>.count</code>"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1459359738, "post_id": 36314799, "comment_id": 60255191, "body": "i just tested that for &#39;div&#39; it is returning the correct length - 18 divs total - but for tr it is not and the page is not showing any frames in its source code as well (considering that the tr&#39;s may be in a separate frame)"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1459359821, "post_id": 36314799, "comment_id": 60255240, "body": "and Dim trList As Object returns an error &quot;Object doesn&#39;t support this property or method&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1459360302, "post_id": 36316031, "comment_id": 60255527, "body": "Good point, but I would go for <code>Or</code> instead of <code>And</code> just to be extra safe. Still doesn&#39;t guarantee anything though."}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1459360306, "post_id": 36316031, "comment_id": 60255531, "body": "Thanks!  Your answer is correct. Although <code>Do While IE.readyState &lt; 4 and IE.Busy</code> didn&#39;t return the results, but the problem was that the &#39;tr&#39; elements were loading sometime after the page loaded.   On putting the script on <code>Wait</code> for 5 seconds before it started looking for tr&#39;s, it finally returned them!  Thanks again!!"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1459360526, "post_id": 36316031, "comment_id": 60255678, "body": "It is true that the statement should be with &quot;or&quot;, not &quot;and&quot;, my mistake as I got used to condition with &quot;until&quot;."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 2, "last_activity_date": 1459360411, "last_edit_date": 1459360411, "creation_date": 1459359972, "answer_id": 36316031, "question_id": 36314799, "link": "https://stackoverflow.com/questions/36314799/vba-data-scraping-from-websites/36316031#36316031", "title": "VBA Data Scraping from Websites", "body": "<p>No tr tags found on your website can be caused by macro being executed before page fully loads. Try changing:</p>\n\n<pre><code>Do While IE.readyState &lt; 4\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Do While IE.readyState &lt; 4 or IE.Busy\n</code></pre>\n\n<p>Even this doesn't guarantee that everything loads before firing macro, but often helps and is a good practice to always include it. Sometimes you need to find object which displays \"loading\" etc. in frontend and loop through HTML elements until it disappears - then you are safe to run your script.</p>\n"}], "owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 36316031, "answer_count": 1, "score": 0, "last_activity_date": 1459360411, "creation_date": 1459355947, "question_id": 36314799, "link": "https://stackoverflow.com/questions/36314799/vba-data-scraping-from-websites", "title": "VBA Data Scraping from Websites", "body": "<p>document.getElementsByTagName(\"tr\").length returns zero when I execute a VBA script to find the number of tr elements on a specific web page</p>\n\n<pre><code>Sub AutomaticMode()\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.Navigate \"https://www.example.com/\"\nDo While IE.readyState &lt; 4\n    Application.StatusBar = \"DOM Loading ...\"\nLoop\nSet username_field = IE.document.getElementByID(\"username\")\nusername_field.Value = \"username\"\nSet password_field = IE.document.getElementByID(\"password\")\npassword_field.Value = \"password\"\nSendKeys \"{Tab}{Enter}\"\nDo While IE.readyState &lt; 4\n    Application.StatusBar = \"DOM Loading ...\"\nLoop\nDim trList As IHTMLElementCollection\nSet trList = IE.document.getElementsByTagName(\"tr\")\nMsgBox (trList.Length)\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459358511, "post_id": 36314789, "comment_id": 60254541, "body": "Some sample data and expected result would help. Use <a href=\"http://www.sensefulsolutions.com/2010/10/format-text-as-table.html\" rel=\"nofollow noreferrer\">sensefulsolutions.com/2010/10/format-text-as-table.html</a>"}, {"owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459428570, "post_id": 36314789, "comment_id": 60289837, "body": "Provided in question area by editing it. Did not succeed in html or txt format, so added png."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459428983, "post_id": 36314789, "comment_id": 60290173, "body": "For future reference, I meant: use the &quot;MySQL&quot; style, insert the text and format as code."}, {"owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1460537193, "post_id": 36314789, "comment_id": 60783355, "body": "Thanks Andre, will try that."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "edited": false, "score": 0, "creation_date": 1459358903, "post_id": 36315033, "comment_id": 60254749, "body": "Appreciated is yr fast response anyway. Thank you"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "reply_to_user": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "edited": false, "score": 0, "creation_date": 1459359645, "post_id": 36315033, "comment_id": 60255144, "body": "Does the second suggest SQL work for you?  (<code>DISTINCT</code> can be removed, but it doesn&#39;t hurt anything.)"}, {"owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "edited": false, "score": 0, "creation_date": 1459361975, "post_id": 36315033, "comment_id": 60256667, "body": "That sql finds all matches regardless of having a relevant pair or not. One cancellation note can only cancel one original. Pairs."}, {"owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "edited": false, "score": 0, "creation_date": 1459368845, "post_id": 36315033, "comment_id": 60260957, "body": "You are right - unfortunately there is no positive identification. I am looking for the &quot;most likely solution&quot;, as noted in my question - &quot;assumed matches&quot; link."}], "tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": false, "score": 0, "last_activity_date": 1460143958, "last_edit_date": 1460143958, "creation_date": 1459356644, "answer_id": 36315033, "question_id": 36314789, "link": "https://stackoverflow.com/questions/36314789/controlled-multiple-results-in-access-sql-find-all-n-matches/36315033#36315033", "title": "Controlled multiple results in Access SQL. Find all n matches", "body": "<p>Is <code>InvNum</code> is a primary key, a unique identifier for an invoice?  Then let the CN table have a field to hold that value.  This will let you <code>JOIN</code> in a decent way.  </p>\n\n<pre><code>SELECT InvNum FROM Invoices \nINNER JOIN CancelInvs \n    ON Invoices.InvNum = CancelInvs.InvNum \n</code></pre>\n\n<p>You must have a way to positively identify the original from the CN.  Typically that would be <code>InvNum</code>, stored in the CN as a foreign key.  Without that, you have been using Customer and Amount.  But that combo doesn't let you positively identify the original.  Therefore you can't do what you want. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "is_accepted": false, "score": 0, "last_activity_date": 1459512914, "last_edit_date": 1459512914, "creation_date": 1459428884, "answer_id": 36334120, "question_id": 36314789, "link": "https://stackoverflow.com/questions/36314789/controlled-multiple-results-in-access-sql-find-all-n-matches/36334120#36334120", "title": "Controlled multiple results in Access SQL. Find all n matches", "body": "<p>Let us leave it. Proved to be too complex so simple Select queries can not handle. Decided to do vba cycle and manage flagging by using tmp tables. Thank you all.</p>\n\n<p>A stupidly complex procedure was finally used due to the nature of this real life task. My SQL includes VBA-controlled adaptive parameter. Just to give an insight, here is the process (in form of human-friendly script). </p>\n\n<pre><code>Begin cycle\nCount and collect matching Invoices per CreditNote (criteria: same repairer &amp; customer &amp; amount, not cancelled)\nFlag lines in collection table as 'Duplicate' where same Invoice appears for several CNs\nProcess the 1-1 matches by flagging Invoices as 'Cancelled'\nFlag the processed CNs as 'Done', in CN matches collection table\nIf there are no 1-1 matches, allow multiple matches for CNs for one cycle - find earliest occurence of Invoice matches\nLoop cycle while any matches remain\nDrop any unpaired CN\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6134306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258f7270a4eee5ac4a74c3bf47d84d01?s=128&d=identicon&r=PG&f=1", "display_name": "Tony68", "link": "https://stackoverflow.com/users/6134306/tony68"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1460143958, "creation_date": 1459355920, "last_edit_date": 1459373274, "question_id": 36314789, "link": "https://stackoverflow.com/questions/36314789/controlled-multiple-results-in-access-sql-find-all-n-matches", "title": "Controlled multiple results in Access SQL. Find all n matches", "body": "<p>Given a database of invoices that also includes cancellation invoices (=credit notes or CNs).\nI want to select the <strong><em>cancelled</em></strong> invoices for flagging them.\nTo link from credit note to original invoice, we assume customer &amp; amount matches.\nProblem: There are multiple CNs that fall in above creiteria, so I need to find each and every cancelled originals.\nE.g. if there are 5 CNs, then we may find 6 original invoices, and 5 of them should be flagged assuming the most recent one valid (no flag for this latest).</p>\n\n<p>My statement to identify credit notes, referred to later as \"CancelInvs\" (CN is a yes/no flag)</p>\n\n<p>SELECT * FROM Invoices WHERE CN</p>\n\n<p>Below simply finds cancelled invoices but, in case multiple cancellations exist, it only finds one original, repeating it multiple times with each additional CN.</p>\n\n<pre><code>SELECT Min(InvNum) FROM Invoices \nINNER JOIN CancelInvs ON Invoices.Customer = CancelInvs.Customer AND Invoices.Amount = CancelInvs.Amount \nGROUP BY CancelInvs.InvNum\n</code></pre>\n\n<p>I need to also find the other ones to be flagged as cancelled. No problem to add VBA if needed. Thanks for your attention.</p>\n\n<p>Sample data:\n<a href=\"http://i.stack.imgur.com/jP5uK.png\" rel=\"nofollow\">sample data img</a></p>\n\n<p>Invoices and CreditNotes are in the same table. For simplicity, I made both amounts as positive. \nThose cancelled by means of a matching CN shall be flagged. Valid ones need no flagging. A CN may be preceeded by more than one matching invoices. In such case, only the first one is to be flagged.</p>\n\n<p>In the sample, record 1400 is a CreditNote. The only invoice before it, with matching parametres is record 1003. So, 1003 shall be flagged as 'Cancelled'.\nThe next CN is 1580. An invoice before it, with matching fields is 1412, so 1412 shall be flagged as 'Cancelled'. 1003 is already out of the game. No more unused CreditNotes, so nothing more invoice to be flagged. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1459355928, "post_id": 36314728, "comment_id": 60252860, "body": "My guess is that there are formulas in column H that return <code>&quot;&quot;</code>.  BTW, the line should be <code>ws.Range(&quot;H2&quot;, ws.Range(&quot;H&quot; &amp; ws.Rows.count).End(xlUp)).Select</code>"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459357142, "post_id": 36314728, "comment_id": 60253673, "body": "So is there a way to have an if formula put a nothing so I can find the last row?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1459359135, "creation_date": 1459359135, "answer_id": 36315791, "question_id": 36314728, "link": "https://stackoverflow.com/questions/36314728/finding-last-row-in-column-when-adjacent-column-has-data-past-original-column-en/36315791#36315791", "title": "Finding last row in column when adjacent column has data past original column end point", "body": "<p>Quite easy to avoid any <em>NULL</em> cells at the bottom column column <strong>H</strong>:</p>\n\n<pre><code>Sub dural()\n    Dim nr As Long\n\n    nr = [MAX((H:H&lt;&gt;\"\")*(ROW(H:H)))]\n    Range(\"H\" &amp; nr).Select\nEnd Sub\n</code></pre>\n\n<p>This is quite slow so consider replacing <code>H:H</code> with something like <code>H1:H9999</code></p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1459359648, "last_edit_date": 1459359648, "creation_date": 1459359282, "answer_id": 36315849, "question_id": 36314728, "link": "https://stackoverflow.com/questions/36314728/finding-last-row-in-column-when-adjacent-column-has-data-past-original-column-en/36315849#36315849", "title": "Finding last row in column when adjacent column has data past original column end point", "body": "<p>Try this line instead of the one you have:</p>\n\n<pre><code>ws.Range(\"H2\", ws.Range(\"H:H\").Find(\"*\", , , , , xlPrevious)).Select\n</code></pre>\n\n<p>It will find the last cell with a value that is not <code>\"\"</code>.</p>\n\n<p>The photo shows that there is a formula in H11:</p>\n\n<p><a href=\"https://i.stack.imgur.com/x9AVD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x9AVD.png\" alt=\"enter image description here\"></a></p>\n\n<p>But the following code:</p>\n\n<pre><code>Sub finnnn()\nDim ws As Worksheet\n\nSet ws = Sheets(\"Sheet13\")\n\nDebug.Print ws.Range(\"H1\", ws.Range(\"H:H\").Find(\"*\", , , , , xlPrevious)).Address\n\nEnd Sub\n</code></pre>\n\n<p>When run lists <code>$H$1:$H$5</code> in the immediate window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8qjis.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8qjis.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459359648, "creation_date": 1459355749, "last_edit_date": 1531164843, "question_id": 36314728, "link": "https://stackoverflow.com/questions/36314728/finding-last-row-in-column-when-adjacent-column-has-data-past-original-column-en", "title": "Finding last row in column when adjacent column has data past original column end point", "body": "<p>I have an excel sheet that has two columns G and H. Column G has 25 rows that are not empty and column H has 15 columns. I have written some vba code to find the last row in column H but it selects all the way down to column G's end not stopping at column H's end. Is there a way to write the code to not look at whats in column G? I have added the code I have below.</p>\n\n<p>Thanks!</p>\n\n<pre><code>ws.Range(\"H2:H\" &amp; Range(\"H\" &amp; Rows.count).End(xlUp).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459356518, "post_id": 36314587, "comment_id": 60253245, "body": "Just set Sheet1&#39;s column A to be Sheet2 Column A, then wait, then Sheet1 Col A, equal to column B, etc."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459356564, "post_id": 36314882, "comment_id": 60253275, "body": "Just what I was thinking!  Just curious, why you did a separate sub for the wait part?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1459356716, "post_id": 36314882, "comment_id": 60253379, "body": "@BruceWayne just personal preference, certainly not necessary in this very simple case, but <code>Wait</code>, if used in a larger application might use various wait times depending on when/where it&#39;s called from, etc., so IMO it&#39;s best to subroutine it and just pass the parameter. Plus, it&#39;s a good and very simple example for OP to learn about using subroutines :D"}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1459361371, "post_id": 36314882, "comment_id": 60256238, "body": "David-  I have a followup question. So i wanted graph the data from sheet1 while it is cycling through the numbers but once i setup the graph the graph does not change. Is there a way to make it change dynamically while the data is cycling?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1459362329, "post_id": 36314882, "comment_id": 60256899, "body": "@Leofig123 it should be possible, give me a second to try a few things."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1459362606, "post_id": 36314882, "comment_id": 60257119, "body": "@Leofig123 is your chart <i>already</i> configured to pull data from the range A1:A50?  If so, the data should be updating while the macro runs (it does when I test it). If not, then you should configure the chart accordingly."}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1459362938, "post_id": 36314882, "comment_id": 60257358, "body": "@DavidZemens IDK what happen but after i restarted it started working. thanks once again"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1459356211, "creation_date": 1459356211, "answer_id": 36314882, "question_id": 36314587, "link": "https://stackoverflow.com/questions/36314587/display-one-column-at-a-time/36314882#36314882", "title": "Display one column at a time", "body": "<p>Add these procedures to the VBA module. Then add a button or textbox/etc. to the Sheet1, and right-click the shape, and choose \"Assign Macro\", then select the <code>MyButtonClick</code> procedure. This will associate the macro with the button.</p>\n\n<p>Then, you just need to loop over the columns and copy/paste like so:</p>\n\n<pre><code>Sub MyButtonClick()\nDim ws1 as Worksheet, ws2 as Worksheet\nDim cols as Range, c as Range\n\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n\nSet cols = ws2.Range(\"A1:G50\")  '## Modify as needed\n\nFor Each c in cols.Columns\n\n    c.Copy Destination:=ws1.Range(\"A1\")  '## Puts the column in Sheet1, Column A\n    Call WaitForIt(5)\nNext\n\nEnd Sub\n\nSub WaitForIt(seconds as Long)\n\n    Application.Wait Now + TimeSerial(0, 0, seconds)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1459357013, "creation_date": 1459357013, "answer_id": 36315144, "question_id": 36314587, "link": "https://stackoverflow.com/questions/36314587/display-one-column-at-a-time/36315144#36315144", "title": "Display one column at a time", "body": "<p>A somewhat minimal-VBA approach:</p>\n\n<p>Say that sheet2 looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VyZYc.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VyZYc.gif\" alt=\"enter image description here\"></a></p>\n\n<p>then in sheet1, create a 1-cell named range <code>record</code> (cell A2 in this case):</p>\n\n<p><a href=\"https://i.stack.imgur.com/J3Phz.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J3Phz.gif\" alt=\"enter image description here\"></a></p>\n\n<p>In column B put the formula: </p>\n\n<pre><code>=IF(NOT(ISBLANK(INDIRECT(\"Sheet2!R\"&amp;ROW()&amp;\"C\"&amp;record,FALSE))),INDIRECT(\"Sheet2!R\"&amp;ROW()&amp;\"C\"&amp;record,FALSE),\"\")\n</code></pre>\n\n<p>and copy it down for as many rows as the longest record in sheet 2</p>\n\n<p>Then -- the VBA part can just have a loop where it has the statement</p>\n\n<pre><code>Range(\"record\").Value = i\n</code></pre>\n\n<p>(with an <code>i</code> that cycles through the column numbers containing records). The spreadsheet formula takes care of pulling the correct values.</p>\n"}], "owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 36314882, "answer_count": 2, "score": 0, "last_activity_date": 1459357013, "creation_date": 1459355358, "last_edit_date": 1459355661, "question_id": 36314587, "link": "https://stackoverflow.com/questions/36314587/display-one-column-at-a-time", "title": "Display one column at a time", "body": "<p>I would like to know if this is possible and how i could do this. \nI have a workbook with 2 sheets. Sheet2 has multiple columns with 50 different records. sheet1 i would like to have a play button or run button when i click \"play/run\" it it will have one column and that one column will display the records of each column from sheet2 until there are no more columns form sheet2. Additionally, the display will have a 5 sec interval before cycling to the next column. </p>\n\n<p>i found out how to do the time interval but not the displaying </p>\n\n<pre><code>'time interval \nApplication.Wait Now + TimeSerial(0, 0, 5)\n\n'displaying i have been using copy/paste but it does not work. \n</code></pre>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["xml", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1459356783, "creation_date": 1459356783, "answer_id": 36315082, "question_id": 36314542, "link": "https://stackoverflow.com/questions/36314542/generate-xml-from-excel-for-recurring-tags-under-each-unique-element/36315082#36315082", "title": "Generate XML from Excel for recurring tags under each unique Element", "body": "<p>You need to use nested loops. Something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GenerateXML_Test()\n    Dim myFile As String\n    Dim i As Integer\n    'Create XML File\n    myFile = ThisWorkbook.Path + \"\\TestXML.xml\"\n    Open myFile For Output As #1\n    'Get Last Row\n    LastRow = ActiveSheet.Cells.Find(\"*\", _\n        SearchOrder:=xlByRows, _\n        LookIn:=xlValues, _\n        SearchDirection:=xlPrevious).Row\n    Print #1, \"&lt;List&gt;\" &amp; vbNewLine\n    'Print recurring text in xml file\n    For RowIndex = 2 To LastRow\n        Print #1, \"&lt;Data name=\"\"\" &amp; Cells(RowIndex, 2).Value &amp; _\n                  \"\"\" Description=\"\"\" &amp; Cells(RowIndex, 3).Value &amp; \"\"\"&gt;\" &amp; _\n                  vbNewLine\n        'Now loop through the attributes until we find another Data element\n        Do While Cells(RowIndex, 2).Value &lt;&gt; \"\"\n            Print #1, \"&lt;Attribute Name=\"\"\" &amp; Cells(RowIndex, 4).Value &amp; _\n                      \"\"\" Value=\"\"\" &amp; Cells(RowIndex, 5).Value &amp; \"\"\"/&gt;\" &amp; _\n                      vbNewLine\n            'btw, incrementing a For variable manually like this is very bad form\n            RowIndex = RowIndex + 1\n            'I would restructure this once you grasp nesting loops.\n        Loop\n        Print #1, \"&lt;/Data&gt;\" &amp; vbNewLine\n    Next RowIndex\n    Print #1, \"&lt;/List&gt;\"\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>Also, use double quotes <code>\"\"</code> instead of CHR(34). </p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1459359911, "creation_date": 1459359911, "answer_id": 36316014, "question_id": 36314542, "link": "https://stackoverflow.com/questions/36314542/generate-xml-from-excel-for-recurring-tags-under-each-unique-element/36316014#36316014", "title": "Generate XML from Excel for recurring tags under each unique Element", "body": "<p>VBA comes equipped with a DOM builder using the <a href=\"https://msdn.microsoft.com/en-us/library/ms763742%28v=vs.85%29.aspx\" rel=\"nofollow\">MSXML</a> object. Hence, you should not need to build a concatenated string in Excel of the XML document using a text stream.</p>\n\n<p>Consider the following macro using the MSXML v6.0 reference interacting with node and attribute objects set up conditionally for empty column A values. Additionally, an XSLT (an <a href=\"https://en.wikipedia.org/wiki/Identity_transform\" rel=\"nofollow\">identity transform</a>) is run on the raw output to pretty print the XML (without it XML content will show up on one long line):</p>\n\n<pre><code>Option Explicit\n\nSub xmlExport()\nOn Error GoTo ErrHandle\n    Dim doc As New MSXML2.DOMDocument60, xslDoc As New MSXML2.DOMDocument60, newDoc As New MSXML2.DOMDocument60\n    Dim root As IXMLDOMElement, dataNode As IXMLDOMElement, attribNode As IXMLDOMElement\n    Dim dataNameAttrib As IXMLDOMAttribute, descAttrib As IXMLDOMAttribute\n    Dim nameAttrib As IXMLDOMAttribute, valueAttrib As IXMLDOMAttribute\n    Dim i As Long\n\n    ' DECLARE XML DOC OBJECT '\n    Set root = doc.createElement(\"List\")\n    doc.appendChild root\n\n    ' WRITE TO XML '\n    For i = 2 To Sheets(1).UsedRange.Rows.Count\n\n        If Len(Trim(Range(\"A\" &amp; i))) &lt;&gt; 0 Then\n            ' DATA NODE '\n            Set dataNode = doc.createElement(\"Data\")\n            root.appendChild dataNode\n\n            ' NAME ATTRIBUTE '\n            Set dataNameAttrib = doc.createAttribute(\"name\")\n            dataNameAttrib.Value = Range(\"B\" &amp; i)\n            dataNode.setAttributeNode dataNameAttrib\n\n            ' DESCRIPTION ATTRIBUTE '\n            Set descAttrib = doc.createAttribute(\"description\")\n            descAttrib.Value = Range(\"C\" &amp; i)\n            dataNode.setAttributeNode descAttrib\n\n            ' ATTRIBUTE NODE '\n            Set attribNode = doc.createElement(\"Attribute\")\n            dataNode.appendChild attribNode\n            ' NAME ATTRIBUTE '\n            Set nameAttrib = doc.createAttribute(\"Name\")\n            nameAttrib.Value = Range(\"D\" &amp; i)\n            attribNode.setAttributeNode nameAttrib\n            ' VALUE ATTRIBUTE '\n            Set valueAttrib = doc.createAttribute(\"Value\")\n            valueAttrib.Value = Range(\"E\" &amp; i)\n            attribNode.setAttributeNode valueAttrib\n        Else\n            ' ATTRIBUTE NODE '\n            Set attribNode = doc.createElement(\"Attribute\")\n            dataNode.appendChild attribNode\n            ' NAME ATTRIBUTE '\n            Set nameAttrib = doc.createAttribute(\"Name\")\n            nameAttrib.Value = Range(\"D\" &amp; i)\n            attribNode.setAttributeNode nameAttrib\n            ' VALUE ATTRIBUTE '\n            Set valueAttrib = doc.createAttribute(\"Value\")\n            valueAttrib.Value = Range(\"E\" &amp; i)\n            attribNode.setAttributeNode valueAttrib\n        End If\n\n    Next i\n\n    ' PRETTY PRINT RAW OUTPUT '\n    xslDoc.LoadXML \"&lt;?xml version=\" &amp; Chr(34) &amp; \"1.0\" &amp; Chr(34) &amp; \"?&gt;\" _\n            &amp; \"&lt;xsl:stylesheet version=\" &amp; Chr(34) &amp; \"1.0\" &amp; Chr(34) _\n            &amp; \"                xmlns:xsl=\" &amp; Chr(34) &amp; \"http://www.w3.org/1999/XSL/Transform\" &amp; Chr(34) &amp; \"&gt;\" _\n            &amp; \"&lt;xsl:strip-space elements=\" &amp; Chr(34) &amp; \"*\" &amp; Chr(34) &amp; \" /&gt;\" _\n            &amp; \"&lt;xsl:output method=\" &amp; Chr(34) &amp; \"xml\" &amp; Chr(34) &amp; \" indent=\" &amp; Chr(34) &amp; \"yes\" &amp; Chr(34) &amp; \"\" _\n            &amp; \"            encoding=\" &amp; Chr(34) &amp; \"UTF-8\" &amp; Chr(34) &amp; \"/&gt;\" _\n            &amp; \" &lt;xsl:template match=\" &amp; Chr(34) &amp; \"node() | @*\" &amp; Chr(34) &amp; \"&gt;\" _\n            &amp; \"  &lt;xsl:copy&gt;\" _\n            &amp; \"   &lt;xsl:apply-templates select=\" &amp; Chr(34) &amp; \"node() | @*\" &amp; Chr(34) &amp; \" /&gt;\" _\n            &amp; \"  &lt;/xsl:copy&gt;\" _\n            &amp; \" &lt;/xsl:template&gt;\" _\n            &amp; \"&lt;/xsl:stylesheet&gt;\"\n\n    xslDoc.async = False\n    doc.transformNodeToObject xslDoc, newDoc\n    newDoc.Save ActiveWorkbook.Path &amp; \"\\Output.xml\"\n\n    MsgBox \"Successfully exported Excel data to XML!\", vbInformation\n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;List&gt;\n    &lt;Data name=\"A\" description=\"Test1\"&gt;\n        &lt;Attribute Name=\"Width\" Value=\"33\"&gt;&lt;/Attribute&gt;\n        &lt;Attribute Name=\"Height\" Value=\"50\"&gt;&lt;/Attribute&gt;\n        &lt;Attribute Name=\"Length\" Value=\"25\"&gt;&lt;/Attribute&gt;\n    &lt;/Data&gt;\n    &lt;Data name=\"B\" description=\"Test2\"&gt;\n        &lt;Attribute Name=\"Width\" Value=\"55\"&gt;&lt;/Attribute&gt;\n        &lt;Attribute Name=\"Depth\" Value=\"88\"&gt;&lt;/Attribute&gt;\n    &lt;/Data&gt;\n&lt;/List&gt;\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 2757053, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5e829807ed142a215886755876ce319d?s=128&d=identicon&r=PG&f=1", "display_name": "Renee", "link": "https://stackoverflow.com/users/2757053/renee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 36316014, "answer_count": 2, "score": 1, "last_activity_date": 1459359911, "creation_date": 1459355201, "question_id": 36314542, "link": "https://stackoverflow.com/questions/36314542/generate-xml-from-excel-for-recurring-tags-under-each-unique-element", "title": "Generate XML from Excel for recurring tags under each unique Element", "body": "<p>I need to generate XML file from Excel for recurring Attribute tags under each unique Data element. \nBelow is the excel format. Uniqueness of the Data element is identified by the ID column which will not be displayed in the XML file.</p>\n\n<p><b> Excel Format: (Input)</b></p>\n\n<pre><code>ID | Name | Description | AttributeName | AttributeValue\n--------------------------------------------------------\n01 | A    | Test1       | Width         | 33\n   |      |             | Height        | 50\n   |      |             | Length        | 25\n02 | B    | Test2       | Width         | 55\n   |      |             | Depth         | 88\n</code></pre>\n\n<p><b>XML Format: (Expected Output)</b></p>\n\n<p></p>\n\n<pre><code>&lt;Data name=\"A\" description=\"Test1\"&gt;\n   &lt;Attribute Name=\"Width\" Value=\"33\"/&gt;\n   &lt;Attribute Name=\"Heigth\" Value=\"50\"/&gt;\n   &lt;Attribute Name=\"Length\" Value=\"25\"/&gt;\n&lt;/Data&gt;\n\n&lt;Data name=\"B\" description=\"Test2\"&gt;\n   &lt;Attribute Name=\"Width\" Value=\"55\"/&gt;\n   &lt;Attribute Name=\"Depth\" Value=\"88\"/&gt;\n&lt;/Data&gt;\n\n&lt;/List&gt;\n</code></pre>\n\n<p>This is what I have attempted to code. </p>\n\n<p><b>VBA Code:</b></p>\n\n<pre><code>Sub GenerateXML_Test()\n Dim myFile As String\n\n 'Create XML File\n  myFile = ThisWorkbook.Path + \"\\TestXML.xml\"\n  Open myFile For Output As #1\n\n 'Get Last Row\n  LastRow = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n\n\n  Print #1, \"&lt;List&gt;\" &amp; vbNewLine\n\n 'Print recurring text in xml file\n  For RowIndex = 2 To LastRow\n\n   Print #1, \"&lt;Data name=\" &amp; Chr(34) &amp; Cells(RowIndex, 2).Value &amp; Chr(34) &amp; \" Description=\" &amp; Chr(34) &amp; Cells(RowIndex, 3).Value &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine &amp; \"&lt;Attribute Name=\" &amp; Chr(34) &amp; Cells(RowIndex, 4).Value &amp; Chr(34) &amp; \" Value=\" &amp; Chr(34) &amp; Cells(RowIndex, 5).Value &amp; Chr(34) &amp; \"/&gt;\" &amp; \"&lt;/Data&gt;\" &amp; vbNewLine\n\n  Next RowIndex\n\n  Print #1, \"&lt;/List&gt;\"\n\n  Close #1\n\nEnd Sub\n</code></pre>\n\n<p><b>XML Format: (Actual Output)</b></p>\n\n<pre><code>&lt;List&gt;\n  &lt;Data name=\"A\" Description=\"Test1\"&gt;\n    &lt;Attribute Name=\"Width\" Value=\"33\" /&gt; \n  &lt;/Data&gt;\n  &lt;Data name=\"\" Description=\"\"&gt;\n    &lt;Attribute Name=\"Height\" Value=\"50\" /&gt; \n  &lt;/Data&gt;\n  &lt;Data name=\"\" Description=\"\"&gt;\n    &lt;Attribute Name=\"Length\" Value=\"25\" /&gt; \n  &lt;/Data&gt;\n  &lt;Data name=\"B\" Description=\"Test2\"&gt;\n    &lt;Attribute Name=\"Width\" Value=\"55\" /&gt; \n  &lt;/Data&gt;\n  &lt;Data name=\"\" Description=\"\"&gt;\n    &lt;Attribute Name=\"Depth\" Value=\"88\" /&gt; \n  &lt;/Data&gt;\n&lt;/List&gt;\n</code></pre>\n\n<p>The output is not as Expected as I need to add the appropriate logic. The Attribute tags needs to be repeated in a single Data element for each unique ID. There can be any number of attributes for each of the data elements. \nPlease help to add logic to achieve the same.</p>\n"}, {"tags": ["vba", "ms-word", "footer"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1459353378, "post_id": 36313673, "comment_id": 60251159, "body": "you will need to open the footer and then perform your steps.   ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "edited": false, "score": 0, "creation_date": 1459430447, "post_id": 36315494, "comment_id": 60291294, "body": "Hi, how would I get the footer to include the DocName in the footer on page2 and 3 etc. I can only have one bookmark named DocName per document (correct me if I&#39;m wrong)!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "edited": false, "score": 0, "creation_date": 1459431431, "post_id": 36315494, "comment_id": 60292016, "body": "Well, if this is Word&#39;s Footer (and not just a position at the bottom of the page) then anything you put there will repeat throughout the document, on every page. That&#39;s the advantage of Headers and Footers :-) Things only get tricky if you don&#39;t want content on every page... If you don&#39;t want it on the <i>first</i> page, then you need to activate the &quot;Different First Page&quot; option in the document. (Note: this code will <i>not</i> write to a &quot;different first page&quot;.)"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1459358114, "creation_date": 1459358114, "answer_id": 36315494, "question_id": 36313673, "link": "https://stackoverflow.com/questions/36313673/word-vba-run-action-in-footer-only-and-not-anywhere-else/36315494#36315494", "title": "Word VBA run action in footer only and not anywhere else", "body": "<p>The problem with your code is that it's addressing all parts of the document - which you don't want. You want only the footer(s). A Word document can have many footers, depending on how many sections the document has and whether the footers in the sections have been unlinked from previous sections. So if you wanted to check all the footers, you'd need to loop all the sections, something like</p>\n\n<pre><code>Dim sec as Word.Section\nDim rngFooter as Word.Range\nFor each sec in ActiveDocument.Sections\n  Set rngFooter = sec.Footers(wdHeaderFooterPrimary).Range\n  For each field in rngFooter.Fields\n    aField.Result.Text = oldFilename\n  Next field\nNext sec\n</code></pre>\n\n<p>But keep in mind this will address <em>all</em> fields in the Footers, so it would end up affecting any Page numbers or Dates you might have...</p>\n\n<p>There's another issue with the approach you're using: Field codes will update, and when they do, anything you've written to them, as you do in your code, will be lost. So you might be in for a very unpleasant surprise when you print this document, or when some other action triggers a field code update.</p>\n\n<p>Since you aren't relying on the field code to generate the document name automatically, don't use a field code (whatever it might be). Delete the field code and use a bookmark, instead. Then you can assign the document name to the bookmark, something like this:</p>\n\n<pre><code>Dim rngBkm as Word.Range\nDim sBkmName as String\nsBkmName = \"DocName\"\nIf ActiveDocument.Bookmarks.Exists(sBkmName) Then\n  Set rngBkm = ActiveDocument.Bookmarks(sBkmName)\n  rngBkm.Text = oldFileName\n  'Assigning the text deletes the bookmark, so add it back\n  ActiveDocument.Bookmarks.Add sBkmName, rngBkm\nEnd If\n</code></pre>\n\n<p>Note: I do NOT recommend you use the suggestion in Comments to open the Footer - no need to actually OPEN it and better not to.</p>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459358114, "creation_date": 1459352579, "question_id": 36313673, "link": "https://stackoverflow.com/questions/36313673/word-vba-run-action-in-footer-only-and-not-anywhere-else", "title": "Word VBA run action in footer only and not anywhere else", "body": "<p>the following code is part of a much bigger piece of work (where it all works exactly as I wanted except this part).\nI have a field in the footer with the document name and this takes the .doc/.docx off the end.\nThe problem is that it appears that this code also updates any links within the body of the document with the name of the document also e.g. if a link in the document is www.google.co.uk this macro will change that link on the document to the name of the document - I want this to only happen in the footer.</p>\n\n<p>Can you please advise on how to get this code to do that? I have tried a few different things but none of them work.</p>\n\n<pre><code>        oldFilename = wdDocTgt.Name\n         If Right(oldFilename, 5) = \".docx\" Then\n        oldFilename = Left(oldFilename, Len(oldFilename) - 5)\n        ElseIf Right(oldFilename, 4) = \".doc\" Then\n        oldFilename = Left(oldFilename, Len(oldFilename) - 4)\n '       MsgBox (oldFilename)   'UNCOMMENT TO TEST\n\n            'Updates all fields in the target document with the file name\n For Each aStory In wdDocTgt.StoryRanges\n    For Each aField In aStory.Fields\n    aField.Result.Text = oldFilename\n        Next aField\n        Next aStory\n</code></pre>\n"}, {"tags": ["arrays", "vba", "callbyname"], "comments": [{"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 1, "creation_date": 1459353679, "post_id": 36313575, "comment_id": 60251382, "body": "Did you read up on what a &quot;param array&quot; is? I&#39;m unable to follow this statement of yours: &quot;Unfortunately CallByName accepts a param array, therefore it&#39;s not straightforward to pass a variable number.&quot;"}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "reply_to_user": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459357200, "post_id": 36313575, "comment_id": 60253714, "body": "Hi Mike, apologies for the confusion. it is not straightforward to pass a variable number of arguments without knowing how many there are, essentially dynamically. Ideally what I need to do is to pass an array of my arguments. If I could get TypeLib information working on my computer then that would be doable but I don&#39;t have admin rights so can&#39;t register it"}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459360974, "post_id": 36313575, "comment_id": 60255979, "body": "Did you write the routines that might be called?"}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "reply_to_user": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459516581, "post_id": 36313575, "comment_id": 60334330, "body": "@MikeC I, did not write the routines, these are external and there will be a large variable number that are updated daily in a database which is then called by this vba program. By actually changing the method signature (as below) I was able to pass the array of arguments"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1459355655, "post_id": 36314301, "comment_id": 60252670, "body": "That&#39;s actually wrong, and completely contradicts what you previously said. I suggest you read the MSDN article about the CallByName method in VBA where they use 2 arguments in the working example."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1459356228, "post_id": 36314301, "comment_id": 60253061, "body": "My bad it works, the signature is incorrect in the object explorer and documentation: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278760.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg278760.aspx</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1459360232, "post_id": 36314301, "comment_id": 60255493, "body": "If <code>Method_Parameters</code> is an array, a <code>Select Case UBound(Method_Parameters)</code> would make much more sense. Switching on <code>Method_Name</code> defeats the purpose of using <code>CallByName</code>.  You could just call the function directly..."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459360431, "post_id": 36314301, "comment_id": 60255615, "body": "@Comintern It was more to demonstrate the point of having to account for the different amount of arguments but you&#39;re point is very valid so +1"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1459355115, "last_edit_date": 1459355115, "creation_date": 1459354479, "answer_id": 36314301, "question_id": 36313575, "link": "https://stackoverflow.com/questions/36313575/passing-an-array-of-arguments-to-callbyname-vba/36314301#36314301", "title": "Passing an array of Arguments to CallByName VBA", "body": "<p>You can't do this <em>dynamically</em> because different methods will require a different amount of arguments and you can't pass arguments where they aren't expected.</p>\n\n<p>If you know the amount of arguments required, then you could call each item of the array and pass that:</p>\n\n<pre><code>CallByName TaskObject, Task_begin, VbMethod, Method_Parameters(0), Method_Parameters(1), Method_Parameters(2)\n</code></pre>\n\n<p>but you would probably have to set up a <code>Select Case</code> block or similar to handle all the different methods:</p>\n\n<pre><code>Select Case Method_Name\n    Case \"Method_1\": CallByName TaskObject, Task_begin, VbMethod, Method_Parameters(0), Method_Parameters(1)\n    Case \"Method_2\": CallByName TaskObject, Task_begin, VbMethod, Method_Parameters(0)\n    Case \"Method_3\": CallByName TaskObject, Task_begin, VbMethod, Method_Parameters(0), Method_Parameters(1), Method_Parameters(2)\nEnd Select\n</code></pre>\n\n<p>Which can get messy quite easily.</p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459362300, "post_id": 36316527, "comment_id": 60256875, "body": "Nice one. Just need to think outside the box."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459423900, "post_id": 36316527, "comment_id": 60286268, "body": "<code>lcid</code> looks like it should be a <code>LongPtr</code> in x64 to me."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459424665, "post_id": 36316527, "comment_id": 60286867, "body": "@Macro Man, No the lcid is type U4, but I fixed the ProcName which should have been. Thx"}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459425592, "post_id": 36316527, "comment_id": 60287582, "body": "@Comintern I&#39;m fairly new to VBA so haven&#39;t encountered declaring Ptrsafe functions before or changing the method signatures. Is this actually allowing me to change the method arguments within the dll file itself? Do you know where I can read up on this? my program also crashes when it goes to call rtcCallByName"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 1, "creation_date": 1459427246, "post_id": 36316527, "comment_id": 60288841, "body": "@maracuja - The calling convention for the dll function is the same, but it&#39;s specifying the marshalling signature that the compiler uses.  VBA treats a ParamArray as distinct from a Variant(), but under the hood they are the same thing.  The declare essentially bypasses the built in typedef and allow COM to decide if the calling convention is valid. As for your error, try changing <code>ByVal ProcName As LongPtr</code> to <code>ByRef ProcName As String</code>."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 0, "creation_date": 1459427314, "post_id": 36316527, "comment_id": 60288896, "body": "@maracuja, the VBA Declare statement provides a way to directly call a function in a dll. In this case, it doesn&#39;t alter the function, but provides a way to change the arguments type. Regarding the crash, is it after or before I updated the answer and which version of Excel do you have? is it 32 bits or 64bits? mac or windows?"}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 0, "creation_date": 1459516521, "post_id": 36316527, "comment_id": 60334281, "body": "@florentB , I have it working now, I was passing the array incorrectly, so I&#39;m passing ProcName  As LongPtr now. Thank you for your help!"}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 0, "creation_date": 1463485579, "post_id": 36316527, "comment_id": 62075812, "body": "@FlorentB, I have run into a new problem with the above. When I call methods where the expected output/result is the object passed back with one or more properties changed this works perfectly. However I am now calling a method where I pass three arguments ByRef that should be passed back populated with values of double type. For some reason the method is called but the arguments are passed back unpopulated. Any idea?"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 6, "last_activity_date": 1459424209, "last_edit_date": 1459424209, "creation_date": 1459361532, "answer_id": 36316527, "question_id": 36313575, "link": "https://stackoverflow.com/questions/36313575/passing-an-array-of-arguments-to-callbyname-vba/36316527#36316527", "title": "Passing an array of Arguments to CallByName VBA", "body": "<p>You could use CallByName with an array as argument by changing the method signature :</p>\n\n<pre><code>#If VBA7 Or Win64 Then\n  Private Declare PtrSafe Function rtcCallByName Lib \"VBE7.DLL\" ( _\n    ByVal Object As Object, _\n    ByVal ProcName As LongPtr, _\n    ByVal CallType As VbCallType, _\n    ByRef args() As Any, _\n    Optional ByVal lcid As Long) As Variant\n#Else\n  Private Declare Function rtcCallByName Lib \"VBE6.DLL\" ( _\n    ByVal Object As Object, _\n    ByVal ProcName As Long, _\n    ByVal CallType As VbCallType, _\n    ByRef args() As Any, _\n    Optional ByVal lcid As Long) As Variant\n#End If\n\nPublic Function CallByName2(Object As Object, ProcName As String, args() As Variant)\n   AssignResult CallByName2, rtcCallByName(Object, StrPtr(ProcName), VbMethod, args)\nEnd Function\n\nPrivate Sub AssignResult(target, result)\n  If VBA.IsObject(result) Then Set target = result Else target = result\nEnd Sub\n</code></pre>\n\n<p>Here is a usage example:</p>\n\n<pre><code>Sub UsageExample()\n  Dim obj As Object, arguments()\n\n  Dim obj As New Class1\n  arguments = Array(1, 3)\n\n  CallByName2 obj, \"MyMethod\", arguments\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1990, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1459424209, "creation_date": 1459352330, "question_id": 36313575, "link": "https://stackoverflow.com/questions/36313575/passing-an-array-of-arguments-to-callbyname-vba", "title": "Passing an array of Arguments to CallByName VBA", "body": "<p>I'm using callByName I VBA to dynamically call different methods of a class. Depending on the method, I will have a different number of arguments which will be held in an array. Unfortunately CallByName accepts a param array, therefore it's not straightforward to pass a variable number. Is there a way around this, I found a solution using the Type Information Library but this does not seem to work on VBA even though I have added it as a reference. Below is an illustration of what I want</p>\n\n<pre><code> Public Sub Initialize_Object(ByRef TaskObject, Task_Collection)\n\n Dim Task_begin As Variant, Method_Parameters As Variant\n\n Task_begin = Task_Collection(\"Method\")\n\n CallByName TaskObject, Task_begin, VbMethod, Method_Parameters\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot"], "answers": [{"comments": [{"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1459356742, "post_id": 36314319, "comment_id": 60253395, "body": "This assumes that there&#39;s a place where the name appears, but it doesn&#39;t. So is there a way to parse out the currently active Pivot Field and then maybe pass that value into a range?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1459356860, "post_id": 36314319, "comment_id": 60253479, "body": "@GregdeLima can you update our question with a screenshot explanation? I don&#39;t know what you mean by <i>currently active Pivot Field</i>."}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1459357123, "post_id": 36314319, "comment_id": 60253659, "body": "Added the screenshot."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 0, "creation_date": 1459357330, "post_id": 36314319, "comment_id": 60253789, "body": "okay - I see now. give me a moment and I wll update my answer"}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "edited": false, "score": 1, "creation_date": 1459361622, "post_id": 36314319, "comment_id": 60256428, "body": "had to add <code>.Count</code> to the <code>RowFields = 1</code>."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1459361616, "last_edit_date": 1459361616, "creation_date": 1459354530, "answer_id": 36314319, "question_id": 36313462, "link": "https://stackoverflow.com/questions/36313462/pass-a-variable-pivot-filed-name-to-sort-vba/36314319#36314319", "title": "Pass A Variable Pivot Filed Name To Sort VBA", "body": "<p>You can loop through the <code>RowFields</code> of the PivotTable to find the name of the current field. The code checks to ensure that the table currently has only 1 <code>RowField</code>. Make adjustments for your specific object names.</p>\n\n<pre><code>Sub SortCTRDescending()\n\nDim ws As Worksheet\nDim pt As PivotTable\nDim pf As PivotField, pField As PivotField\nDim sField As String\n\nSet ws = Worksheets(\"Sheet1\") 'change as needed\nSet pt = ws.PivotTables(\"PivotTable6\")\n\nIf pt.RowFields.Count = 1 Then\n\n    'note that even though there is only one field, the loop is needed to get the name\n    For Each pField In pt.RowFields\n        sField = pField.Name\n    Next\n\nElse\n\n    MsgBox \"Whoa! More Than 1 Row Field!\"\n    Exit Sub\n\nEnd If\n\nSet pf = pt.PivotFields(sField)\n\npf.AutoSort xlDescending, \"Total CTR\", pt.PivotColumnAxis.PivotLines(6), 1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 36314319, "answer_count": 1, "score": 0, "last_activity_date": 1459361616, "creation_date": 1459352094, "last_edit_date": 1592644375, "question_id": 36313462, "link": "https://stackoverflow.com/questions/36313462/pass-a-variable-pivot-filed-name-to-sort-vba", "title": "Pass A Variable Pivot Filed Name To Sort VBA", "body": "<p>I'm working with a pivot table, and am using the following code:</p>\n<pre><code>Sub SortCTRDescending()\n    ActiveSheet.PivotTables(&quot;PivotTable6&quot;).PivotFields(&quot;Industry&quot;).AutoSort _\n        xlDescending, &quot;Total CTR&quot;, ActiveSheet.PivotTables(&quot;PivotTable6&quot;). _\n        PivotColumnAxis.PivotLines(6), 1\nEnd Sub\n</code></pre>\n<p>Is there a way to pass the Pivot Field <code>&quot;Industry&quot;</code> as a variable depending on what is selected in the pivot table rows? i.e. if Industry changes to &quot;List Name&quot;, have the variable set to whatever row label selected (assumes only 1 row label)? These then get passed to a button, which would &quot;sort by CTR&quot; or &quot;sort by Open Rate&quot; where column numbers stay the same.</p>\n<p>Edit: Added a screenshot of the data. The Row Label is Industry, but this can change to any of the other fields, how can I make the first row label the primary sorting variable.</p>\n<p><a href=\"https://i.stack.imgur.com/1OqPm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1OqPm.png\" alt=\"Excel sheet\" /></a></p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1459351827, "post_id": 36313276, "comment_id": 60249944, "body": "Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a question</a>."}, {"owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "edited": false, "score": 0, "creation_date": 1459352247, "post_id": 36313276, "comment_id": 60250306, "body": "Sorry please be more specific in what you need. do you have two sheets, one is a list of parts and one is a list of parts you want to disregard in the first sheet ?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6135738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iiGfv.png?s=128&g=1", "display_name": "Foraze", "link": "https://stackoverflow.com/users/6135738/foraze"}, "is_accepted": false, "score": 0, "last_activity_date": 1459356335, "creation_date": 1459356335, "answer_id": 36314925, "question_id": 36313276, "link": "https://stackoverflow.com/questions/36313276/how-to-hide-rows-that-contain-one-number-out-of-a-large-list-of-part-numbers/36314925#36314925", "title": "How to hide rows that contain one number out of a large list of part numbers", "body": "<p>I'm not sure how you are getting the list of parts to check but the loop to hide any row which isn't in a given parts list could be done like below:</p>\n\n<pre><code>    Sub HideRows(ByVal PartNumArray As Variant, ByVal ColumnToSearch As String)\n\nDim LastRowData As Long\nDim i As Long, j As Long\nDim HideRow As Boolean\n\nLastRowData = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nRows(1 &amp; \":\" &amp; LastRowData).EntireRow.Hidden = False 'Unhide All the rows (optional)\n\nApplication.ScreenUpdating = False 'Use this to speed up the processing\nFor i = LastRowData To 1 Step -1\n    HideRow = True\n    For j = LBound(PartNumArray) To UBound(PartNumArray)\n        If ActiveSheet.Range(ColumnToSearch &amp; i).Text = PartNumArray(j) Then\n        'Alternatives for boolean condition\n            'ActiveSheet.Range(ColumnToSearch &amp; i).Text like \"*\" &amp; PartNumArray(j) &amp; \"*\" 'For similar matches\n            'Instr(1, ActiveSheet.Range(ColumnToSearch &amp; i).value, PartNumArray(j)) &gt; 0 'See if the part number is anywhere in the string\n            HideRow = False\n\n        End If\n        If HideRow Then\n            Rows(i).EntireRow.Hidden = True\n        End If\n    Next 'Part to look for\nNext 'Row\nApplication.ScreenUpdating = True 'Turn this back on so you can click on the screen again\n\nEnd Sub\n</code></pre>\n\n<p>The trick is initializing the PartNumArray with the list of parts you want. I've included two different methods here:</p>\n\n<pre><code>'Sample of how to call the hide function\nSub TestSample()\n    Dim PartNumArray As Variant\n\n    PartNumArray = Array(\"42\", \"45A2\", \"573A-5\")\n\n    Call HideRows(PartNumArray, \"A\")\nEnd Sub\n\n'Sample of how to fill an array from a worksheet\nSub Fill_Array_With_Part_Numbers()\nDim LastRowData As Long, i As Long\nDim PartNumArray() As String\nDim ColumnToSearch As String\nColumnToSearch = \"A\"\n\nLastRowData = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To LastRowData\n    ReDim Preserve PartNumArray(0 To (i - 1))\n    PartNumArray(i - 1) = ActiveSheet.Range(ColumnToSearch &amp; i).Value\nNext\n\nFor i = LBound(PartNumArray) To UBound(PartNumArray)\n    Debug.Print \"Array Index : \" &amp; i &amp; \" value is : \" &amp; PartNumArray(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6135503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a13f39d67e5afacf1e1b8d768a28c40e?s=128&d=identicon&r=PG&f=1", "display_name": "m00ch", "link": "https://stackoverflow.com/users/6135503/m00ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459356335, "creation_date": 1459351663, "last_edit_date": 1531161705, "question_id": 36313276, "link": "https://stackoverflow.com/questions/36313276/how-to-hide-rows-that-contain-one-number-out-of-a-large-list-of-part-numbers", "title": "How to hide rows that contain one number out of a large list of part numbers", "body": "<p>I am looking to be able to hide rows in a large spreadsheet where each row that gets hidden contains one of the part numbers in a large list of part numbers. The list of part numbers will be added to daily and will contain hundreds of part numbers.\nThe real world application is that I have a build list which has part numbers that need to be built but my shop only has to build certain ones so I would like to remove the ones that I do not have to build. Although our company is constantly coming up with new part numbers so the list keeps getting bigger and the items that we have to build changes on each project.</p>\n"}, {"tags": ["excel", "vba", "unicode", "utf-8"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1459354109, "post_id": 36313270, "comment_id": 60251679, "body": "Why? &quot;Because&quot; is as good an answer as any. Unicode, UTF, ANSI, ASCII, are all various standards for character encoding. Here&#39;s a <a href=\"http://www.joelonsoftware.com/articles/Unicode.html\" rel=\"nofollow noreferrer\">fantastic history lesson on the evolution of character encoding methods</a>."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459354625, "post_id": 36313270, "comment_id": 60251999, "body": "You&#39;ve answered your own question in your question. <code>Unfortunately, not all applications can encode files in UTF-8 by default, and Microsoft Excel is one of them</code>"}, {"owner": {"reputation": 31, "user_id": 6135426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99910ac75ea1c91947dc4babebf348da?s=128&d=identicon&r=PG&f=1", "display_name": "Ro.", "link": "https://stackoverflow.com/users/6135426/ro"}, "edited": false, "score": 0, "creation_date": 1459497981, "post_id": 36313270, "comment_id": 60322696, "body": "So with this version I think it is not possible to force the encoding... :("}, {"owner": {"reputation": 12460, "user_id": 4864425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9e4a4282276cbce5a5a6bf6964f37d?s=128&d=identicon&r=PG&f=1", "display_name": "Ruard van Elburg", "link": "https://stackoverflow.com/users/4864425/ruard-van-elburg"}, "edited": false, "score": 0, "creation_date": 1470089928, "post_id": 36313270, "comment_id": 64795542, "body": "Your code confuses me. What is Range2Save.SaveToFile doing in the if of the nested for loop? It may be overwritten multiple times without knowing. And why are you opening two output files with the same filename? Are they also in the same location? Are you looking at the correct output file? I did some testing in Excel 2007 and if I try to save a file with just the Range2Save code I can save it as UTF-8, UTF-16, etc. with or without special characters. I suggest you simplify your code and remove the #1 file output lines and use Range2Save output instead."}, {"owner": {"reputation": 31, "user_id": 6135426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99910ac75ea1c91947dc4babebf348da?s=128&d=identicon&r=PG&f=1", "display_name": "Ro.", "link": "https://stackoverflow.com/users/6135426/ro"}, "edited": false, "score": 0, "creation_date": 1473170793, "post_id": 36313270, "comment_id": 66031836, "body": "According your last comment: What would be the correct code ?  Thanks Best regards"}], "owner": {"reputation": 31, "user_id": 6135426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99910ac75ea1c91947dc4babebf348da?s=128&d=identicon&r=PG&f=1", "display_name": "Ro.", "link": "https://stackoverflow.com/users/6135426/ro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2515, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459379954, "creation_date": 1459351652, "last_edit_date": 1459379954, "question_id": 36313270, "link": "https://stackoverflow.com/questions/36313270/vba-excel-2013-save-csv-file-with-utf-8-encoding", "title": "VBA (Excel 2013) save csv file with UTF-8 encoding", "body": "<p>I am using Excel 2013 to create a VBA macro that generates a CSV file with UTF-8 encoding.</p>\n\n<p>When I run my macro, if there are special characters used (<code>\u00e4\u00f6\u00fc\u00df</code>, ...), the file is encoded as ANSI, but if there there no special characters, the file is encoded as UTF-8.</p>\n\n<pre><code>Private Sub SaveAsCSV(Filename As String, Directory As String, Sheet As Object)\n    Dim Zeile As Object, Zelle As Object\n    Dim strTemp As String\n    Const adSaveCreateOverWrite = 2\n    Const adTypeText = 2\n    Dim Range2Save\n    Set Range2Save = CreateObject(\"ADODB.Stream\")\n    Range2Save.Charset = \"UTF-8\"\n    Range2Save.Type = adTypeText\n    Range2Save.Open\n\n    If Sheet.PageSetup.PrintArea &lt;&gt; \"\" Then\n        Open Directory &amp; Filename For Output As #1\n        Sheet.Select\n        For Each Zeile In Range(Sheet.PageSetup.PrintArea).Rows\n            For Each Zelle In Zeile.Cells\n                If InStr(1, Zelle.Text, Separator) &gt; 0 Then\n                    'Zellen, die das Trennzeichen beinhalten in Anf\u00fchrungsstriche setzen\n                     Range2Save.WriteText \"special characters: \u00e4\u00f6\u00fc\u00df\"\n                     strTemp = strTemp &amp; \"\" &amp; CStr(Zelle.Text) &amp; \"\" &amp; \";\"\n                     Range2Save.WriteText strTemp, 1\n                     Range2Save.SaveToFile Filename, adSaveCreateOverWrite\n                Else\n                    strTemp = strTemp &amp; CStr(Zelle.Text) &amp; Separator\n                End If\n            Next\n            Print #1, strTemp\n            strTemp = \"\"\n        Next\n        MsgBox (\"Print areas of sheet '\" &amp; Sheet.Name &amp; \"' saved as '\" &amp; Directory &amp; Filename &amp; \"'\")\n    End If\n    Range2Save.Close\n    Close #1\n    Set Range2Save = Nothing\nEnd Sub\n</code></pre>\n\n<p>What is the reason?</p>\n\n<p>Also, if I use FILE - SAVE AS - tools - Web options - Encoding, and select Unicode (UTF-8), I have the same problem.</p>\n\n<p>In my search I found statements like:</p>\n\n<blockquote>\n  <p>UTF-8 is an encoding set that can contain any Unicode character. Unfortunately, not all applications can encode files in UTF-8 by default, and Microsoft Excel is one of them.\n  Instead of Unicode, Excel encodes CSV files using ANSI.</p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>Excel 2011 and beyond do not have options to encode UTF files</p>\n</blockquote>\n\n<p>Thanks for your time and your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1459352132, "post_id": 36313189, "comment_id": 60250213, "body": "What code have you tried? update the question with it so we can help you"}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 1857195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/612ed0870a3cfb6ac98def4babb688b5?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1857195/peter"}, "edited": false, "score": 0, "creation_date": 1459361912, "post_id": 36314313, "comment_id": 60256623, "body": "thx, it works good but my data is in multiple rows...aprox. 200 and it is in number format rounded to 2 decimal points, for example if i have number  103,57 then it is converted to 10 357 408 171 688"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 299, "user_id": 1857195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/612ed0870a3cfb6ac98def4babb688b5?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1857195/peter"}, "edited": false, "score": 0, "creation_date": 1459364720, "post_id": 36314313, "comment_id": 60258480, "body": "Okay, I updated my code from above. Let me know whether it now works properly."}, {"owner": {"reputation": 299, "user_id": 1857195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/612ed0870a3cfb6ac98def4babb688b5?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1857195/peter"}, "edited": false, "score": 0, "creation_date": 1459366244, "post_id": 36314313, "comment_id": 60259452, "body": "this solution seems to be better and simple...thx"}], "tags": [], "owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "is_accepted": true, "score": 2, "last_activity_date": 1459364657, "last_edit_date": 1459364657, "creation_date": 1459354519, "answer_id": 36314313, "question_id": 36313189, "link": "https://stackoverflow.com/questions/36313189/split-every-5-columns-to-another-rows/36314313#36314313", "title": "Split every 5 columns to another rows", "body": "<p>I am assuming that the data you want to separate is located only in the first row. If that's the case the following should be helpful:</p>\n\n<pre><code> Sub columnsInRows()\n\n        Dim rngData As Range\n        Dim intDelimiter As Integer\n        Dim arrRows As Variant\n        Dim cell As Range\n        Dim counter As Integer\n        Dim row As Integer\n\n\n        row = 1\n        intDelimiter = 5\n\n        Worksheets(\"Table1\").Activate\n\n        Set rngData = Worksheets(\"Table1\").UsedRange\n\n        ReDim arrRows(rngData.Cells.Count - 1)\n\n        For Each cell In rngData.Rows.Cells\n            arrRows(counter) = cell.Value\n            counter = counter + 1\n        Next\n\n        Worksheets(\"Table2\").Activate\n\n        For counter = 0 To UBound(arrRows)\n            Cells(row, counter Mod intDelimiter + 1).Value = arrRows(counter)\n                If (counter + 1) Mod intDelimiter = 0 Then\n                    row = row + 1\n                End If\n        Next\n        Worksheets(\"Table2\").UsedRange.NumberFormat = \"#,##0.00\"\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 299, "user_id": 1857195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/612ed0870a3cfb6ac98def4babb688b5?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1857195/peter"}, "edited": false, "score": 0, "creation_date": 1459365783, "post_id": 36317540, "comment_id": 60259131, "body": "great...thank you so much"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1459365993, "last_edit_date": 1459365993, "creation_date": 1459364702, "answer_id": 36317540, "question_id": 36313189, "link": "https://stackoverflow.com/questions/36313189/split-every-5-columns-to-another-rows/36317540#36317540", "title": "Split every 5 columns to another rows", "body": "<p>This will do it all:</p>\n\n<pre><code>Sub evyfifth()\n    Dim ws As Worksheet\n    Dim ows as Worksheet\n    Dim rngarr() As Variant\n    Dim oarr() As Variant\n    Dim lastclm As Long\n    Dim lastrw As Long\n    Dim i&amp;, j&amp;, x&amp;, y&amp;, clms&amp;\n\n    clms = 5\n\n    Set ws = Sheets(\"Sheet16\") 'Change to the sheet of data\n    Set ows = Sheets(\"Sheet17\") ' Change to output sheet\n\n    With ws\n        lastclm = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n        lastrw = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n        rngarr = .Range(.Cells(1, 1), .Cells(lastrw, lastclm)).Value\n        ReDim oarr(1 To Application.RoundUp(lastrw * (lastclm / clms), 0), 1 To clms)\n        x = 1\n        For i = 1 To UBound(rngarr, 1)\n            y = 1\n            For j = 1 To UBound(rngarr, 2)\n                If y &lt; clms Then\n                    oarr(x, y) = rngarr(i, j)\n                    y = y + 1\n                Else\n                    oarr(x, y) = rngarr(i, j)\n                    y = 1\n                    x = x + 1\n                End If\n            Next j\n        Next i\n\n    End With\n    ows.Range(\"A1\").Resize(UBound(oarr, 1), clms).Value = oarr\n\n\n\nEnd Sub\n</code></pre>\n\n<p>And very quickly.</p>\n"}], "owner": {"reputation": 299, "user_id": 1857195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/612ed0870a3cfb6ac98def4babb688b5?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/1857195/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1459371589, "accepted_answer_id": 36314313, "answer_count": 2, "score": -1, "last_activity_date": 1459365993, "creation_date": 1459351436, "last_edit_date": 1531161705, "question_id": 36313189, "link": "https://stackoverflow.com/questions/36313189/split-every-5-columns-to-another-rows", "closed_reason": "Not suitable for this site", "title": "Split every 5 columns to another rows", "body": "<p>i have these columns in one excel table:</p>\n\n<pre><code>1,2,3,4,5,6,7,8,9,10...\n1a,2a,3a,4a,5a,6a,7a,8a,9a,10a...\n...\n</code></pre>\n\n<p>and i want to copy these columns to another excel file and split every 5th column to another rows</p>\n\n<pre><code>1,2,3,4,5\n6,7,8,9,10\n1a,2a,3a,4a,5a\n6a,7a,8a,9a,10a\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "edited": false, "score": 0, "creation_date": 1504646296, "post_id": 36312916, "comment_id": 79087751, "body": "So Many answers completely wrong !!!"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "edited": false, "score": 0, "creation_date": 1459362693, "post_id": 36313802, "comment_id": 60257183, "body": "TestColumn\tA\tA\tA\tA\tA\tA\tA AnotherColumn\tB\tB\tB\tB\tB\tB\tB CostType\tSoftwareCosts\tHardwareCosts\tExpenses\tTravel\tBuildin&zwnj;&#8203;g\tTestColumn\t SoftwareCosts\tLicensing\tEnvironment &amp; Infrastructure\tTraining\tAir Fare\tSeating\t\t HardwareCosts\tSupport\tLaptops\tAccomodation\tTaxi\tConcrete\t\t Expenses\t\tServers\tTelephony\tMileage\tBricks\t\t Travel\t\tPhysical Memory\tMeals\tRailFare\tFlooring\t\t Building\t\t\tPer Diems"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "edited": false, "score": 1, "creation_date": 1459370194, "post_id": 36313802, "comment_id": 60261724, "body": "Sorry, I don&#39;t follow."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1459352936, "creation_date": 1459352936, "answer_id": 36313802, "question_id": 36312916, "link": "https://stackoverflow.com/questions/36312916/access-does-not-movelast-record-in-table/36313802#36313802", "title": "Access does not MoveLast Record in Table", "body": "<p>It sounds like you need to sort the table, otherwise there is no \"first\" or \"last\" record.</p>\n\n<p>Create a simple select query with the table as source and apply the sorting:</p>\n\n<pre><code>Select * From YourTable Order By [SomeField]\n</code></pre>\n\n<p>Now use this query as source for your form.</p>\n"}], "owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36313802, "answer_count": 1, "score": -1, "last_activity_date": 1459411558, "creation_date": 1459350733, "last_edit_date": 1459411558, "question_id": 36312916, "link": "https://stackoverflow.com/questions/36312916/access-does-not-movelast-record-in-table", "title": "Access does not MoveLast Record in Table", "body": "<p>I am using a table in Access.  When I add columns and rows to this table, either manually or programmatically and examine the table the new records are there. The number of rows and columns are correct, both visually and by the program counting them. However, when I use the MoveLast command it moves to the original last record. I can close everything, turn off the computer and rerun, but still can only move to the original Last record.  This happens if I add a single record or multiple records.  Can anyone help ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459351137, "post_id": 36312997, "comment_id": 60249346, "body": "To set ranges equal to each other, they have to be the same size."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6135311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6bcd2059e23fc1ba62d09e13f17d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit MShake", "link": "https://stackoverflow.com/users/6135311/rabbit-mshake"}, "edited": false, "score": 0, "creation_date": 1459377630, "post_id": 36313856, "comment_id": 60265298, "body": "Great thanks for the answer. Is there a way to assign a range of cells = a changing range? Or do I need to use .Copy for this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 6135311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6bcd2059e23fc1ba62d09e13f17d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit MShake", "link": "https://stackoverflow.com/users/6135311/rabbit-mshake"}, "edited": false, "score": 0, "creation_date": 1459377977, "post_id": 36313856, "comment_id": 60265401, "body": "What is a &quot;changing&quot; range?  It might help if you explain how you would do this manually."}, {"owner": {"reputation": 3, "user_id": 6135311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6bcd2059e23fc1ba62d09e13f17d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit MShake", "link": "https://stackoverflow.com/users/6135311/rabbit-mshake"}, "edited": false, "score": 0, "creation_date": 1459452039, "post_id": 36313856, "comment_id": 60305716, "body": "Each day I get an activity log via Excel format. The columns remain the same but there may be 0-100 rows of data depending on the day. I copy these rows and paste them into a master spreadsheet which contains data from multiple spreadsheets. My goal is to automate moving the data from these logs into their corresponding tabs in the master spreadsheet."}, {"owner": {"reputation": 3, "user_id": 6135311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6bcd2059e23fc1ba62d09e13f17d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit MShake", "link": "https://stackoverflow.com/users/6135311/rabbit-mshake"}, "edited": false, "score": 0, "creation_date": 1459452846, "post_id": 36313856, "comment_id": 60306196, "body": "I wanted to add that the change in range would be in the count of rows of data I get each day."}, {"owner": {"reputation": 3, "user_id": 6135311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6bcd2059e23fc1ba62d09e13f17d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit MShake", "link": "https://stackoverflow.com/users/6135311/rabbit-mshake"}, "edited": false, "score": 0, "creation_date": 1459519118, "post_id": 36313856, "comment_id": 60336165, "body": "Wonderful I will try it. Thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1459454602, "last_edit_date": 1459454602, "creation_date": 1459353095, "answer_id": 36313856, "question_id": 36312997, "link": "https://stackoverflow.com/questions/36312997/make-range-of-cells-equal-to-another-range-of-cells-in-different-workbooks/36313856#36313856", "title": "Make range of cells equal to another range of cells in different workbooks", "body": "<p>Your referencing of objects is incorrect - you dont need to include the full \"path\" once you have set the Range objects:</p>\n\n<pre><code>Sub CopyData()\n\n\n    Dim wk1 As Workbook\n    Dim wk2 As Workbook\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim Origin As Range\n    Dim Destination As Range\n\n    Set wk1 = Workbooks(\"Device\")\n    Set wk2 = Workbooks(\"Pri Access Master\")\n    Set sht1 = wk1.Worksheets(1)\n    Set sht2 = wk2.Worksheets(\"Device\")\n    Set Destination = sht2.Range(\"D120000\").End(xlUp).Offset(1, 0)\n\n    'EDIT - dynamic copy range\n    Set Origin = sht1.Range(sht1.Range(\"B2\"), sht1.Cells(sht1.Rows.Count, \"B\").End(xlUp))\n\n\n\n    Destination.Resize(Origin.Rows.Count, Origin.Columns.Count).Value = _\n                                                           Origin.Value\nEnd Sub\n</code></pre>\n"}], "migrated_from": {"other_site": {"aliases": ["http://programmer.stackexchange.com", "http://programmers.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1292524346, "open_beta_date": 1283972400, "closed_beta_date": 1283367600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon@2.png", "twitter_account": "StackSoftEng", "favicon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon.png", "audience": "professionals, academics, and students working within the systems development life cycle", "site_url": "https://softwareengineering.stackexchange.com", "api_site_parameter": "softwareengineering", "logo_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/logo.png", "name": "Software Engineering", "site_type": "main_site"}, "on_date": 1459350889, "question_id": 314263}, "owner": {"reputation": 3, "user_id": 6135311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6bcd2059e23fc1ba62d09e13f17d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Rabbit MShake", "link": "https://stackoverflow.com/users/6135311/rabbit-mshake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5956, "favorite_count": 0, "accepted_answer_id": 36313856, "answer_count": 1, "score": 0, "last_activity_date": 1459454602, "creation_date": 1459349380, "question_id": 36312997, "link": "https://stackoverflow.com/questions/36312997/make-range-of-cells-equal-to-another-range-of-cells-in-different-workbooks", "title": "Make range of cells equal to another range of cells in different workbooks", "body": "<p>I would like to take a range of values from multiple workbooks and enter it into the next blank row of a master workbook. I\u2019m trying to streamline this code as much as possible as there will be multiple workbooks that will be entered into its corresponding tab in the Masterwork book.</p>\n\n<p>Example:</p>\n\n<pre><code>Column C (MasterWorkbook,Sheet 2) = Column A (Workbook 1, Sheet 1)\n</code></pre>\n\n<p>Questions:</p>\n\n<ol>\n<li>Can you make a range of cells = to another range if the amount of rows will change daily?</li>\n<li>Is there an easy way to reference workbooks and worksheets variables within the code? For example:\n<code>wk1.sht1.Origin.Value = wk2.sht2.Destination.Value</code></li>\n</ol>\n\n<p>The code:</p>\n\n<pre><code>Sub CopyData()\n\n\nDim wk1 As Workbook\nDim wk2 As Workbook\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim Origin As Range\nDim Destination As Range\n\nSet wk1 = Workbooks(\"Device\")\nSet wk2 = Workbooks(\"Pri Access Master)\nSet sht1 = Worksheets(1)\nSet sht2 = Worksheets(\"Device\")\n\nSet Origin = Range(\"B2\").End(xlDown)\nSet Destination = Range(\"D120000\").End(xlUp).Offset(1, 0)\n\n'(Isn't working)Copy data in column B and paste in next blank row of another    workbook in another column\nwk2.sht2.Destination.Value = wk1.sht1.Origin.Value\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 6110302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7fc13b15b9e1239c7aaa663bd0e1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Fercstar", "link": "https://stackoverflow.com/users/6110302/fercstar"}, "is_accepted": false, "score": 1, "last_activity_date": 1459349909, "creation_date": 1459349909, "answer_id": 36312612, "question_id": 36312352, "link": "https://stackoverflow.com/questions/36312352/selecting-a-table-of-data-vba/36312612#36312612", "title": "Selecting a table of data VBA", "body": "<p>You can select the table instead of a range of cells (change \"Table1\" to whatever your table is named).</p>\n\n<pre><code>    ActiveSheet.ListObjects(\"Table1\").Range.Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6135194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bed79332fb0264a5b6284ce281487c?s=128&d=identicon&r=PG&f=1", "display_name": "Richards440", "link": "https://stackoverflow.com/users/6135194/richards440"}, "edited": false, "score": 0, "creation_date": 1459419257, "post_id": 36312858, "comment_id": 60282977, "body": "Thanks, I&#39;ve tried this with many different alterations and all I get back is run time error 1004, application-defined or object-defined error"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 1, "user_id": 6135194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bed79332fb0264a5b6284ce281487c?s=128&d=identicon&r=PG&f=1", "display_name": "Richards440", "link": "https://stackoverflow.com/users/6135194/richards440"}, "edited": false, "score": 0, "creation_date": 1459420091, "post_id": 36312858, "comment_id": 60283571, "body": "That&#39;s strange. I tested it and it worked perfectly for me. In which line does the error occur?"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 1, "user_id": 6135194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bed79332fb0264a5b6284ce281487c?s=128&d=identicon&r=PG&f=1", "display_name": "Richards440", "link": "https://stackoverflow.com/users/6135194/richards440"}, "edited": false, "score": 0, "creation_date": 1459423095, "post_id": 36312858, "comment_id": 60285717, "body": "You can step through the code line by line by pressing F8. The error most likely occurs because you have used a different name either for the worksheet or for the first cell containing data (here B8)."}], "tags": [], "owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "is_accepted": false, "score": 0, "last_activity_date": 1459351420, "last_edit_date": 1459351420, "creation_date": 1459350573, "answer_id": 36312858, "question_id": 36312352, "link": "https://stackoverflow.com/questions/36312352/selecting-a-table-of-data-vba/36312858#36312858", "title": "Selecting a table of data VBA", "body": "<p>Given that the overall design of your table does not change (i.e. the first observation is always in cell <code>B8</code>) you can use</p>\n\n<pre><code>Sub SelectData()\n\n    Dim rngData As Range\n\n    Set rngData = Worksheets(\"Table1\").UsedRange\n    rngData.Offset(7, 1).Resize(rngData.Rows.Count - 7, rngData.Columns.Count - 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>In case there can be changes, the following should be quite robust:</p>\n\n<pre><code>Sub SelectData()\n\n    Dim rngData As Range\n    Dim intRow As Integer\n    Dim intColumn As Integer\n\n        intRow = Range(\"Table1!FirstDataPoint\").Row\n        intColumn = Range(\"Table1!FirstDataPoint\").Column\n\n        Set rngData = Worksheets(\"Table1\").UsedRange\n        rngData.Offset(intRow - 1, intColumn - 1).Resize(rngData.Rows.Count - intRow + 1, rngData.Columns.Count - intColumn + 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>In order to apply this you have to name the upper left data point, in your case cell <code>B8</code> (I used the name \"FirstDataPoint\"). When you insert rows or columns to the left or above of this cell the code should still work.</p>\n"}], "owner": {"reputation": 1, "user_id": 6135194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bed79332fb0264a5b6284ce281487c?s=128&d=identicon&r=PG&f=1", "display_name": "Richards440", "link": "https://stackoverflow.com/users/6135194/richards440"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6372, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459351420, "creation_date": 1459349284, "question_id": 36312352, "link": "https://stackoverflow.com/questions/36312352/selecting-a-table-of-data-vba", "title": "Selecting a table of data VBA", "body": "<p>I am very new to VBA/coding and so I'm in need of some help and so will likely be posting on here quite a bit within the next few weeks. I have been teaching myself as much as I can over the last week or so and I have decided to start a project.</p>\n\n<p>I need to select and copy a table of data but the problem is the table of data changes size every single day so I cannot set a specific range. The code I am using is this but it isn't selecting the whole table.</p>\n\n<pre><code>Workbooks.open \"filepath\\filename.xls\"\nWorkbooks (\"filename.xls\").Activate\nRange (\"b8\").Select\nRange (Selection, Selection.end(xlDown)).Select\nRange (Selection, Selection.end(xlToRight)).Select\n</code></pre>\n\n<p>The attached picture is the table and the first cell with data in is b8(Target SLA &amp; Category) and I want it to copy down to the bottom right of the image. as i have stated the table changes size each day so I can't have a set range. <a href=\"http://i.stack.imgur.com/NoYGY.jpg\" rel=\"nofollow\">Table Data</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1459349122, "creation_date": 1459349122, "answer_id": 36312294, "question_id": 36312115, "link": "https://stackoverflow.com/questions/36312115/vba-copy-pasting/36312294#36312294", "title": "VBA copy pasting", "body": "<p>you need to use Offset to do this</p>\n\n<p>example:</p>\n\n<pre><code>     pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = .Value\n     pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(0, 1).Value = .Value\n     pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(0, 2).Value = .Value\n</code></pre>\n\n<p>I included multiple examples so that you know how to navigate between columns and rows :)    Offset(rows,columns) </p>\n"}], "owner": {"reputation": 1, "user_id": 6135199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8775e62086ed6ae276ee5ade7448c3e9?s=128&d=identicon&r=PG&f=1", "display_name": "tompio", "link": "https://stackoverflow.com/users/6135199/tompio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1459414628, "creation_date": 1459348658, "last_edit_date": 1531164843, "question_id": 36312115, "link": "https://stackoverflow.com/questions/36312115/vba-copy-pasting", "title": "VBA copy pasting", "body": "<p>I wrote a VBA which copy and paste data from one sheet to another. The VBA only works for on row which data is in sheet2. I need the VBA to automatically go to the next row. It needs to do that until there is no data in the next row. In the example down below it's already after 3 rows.</p>\n\n<p><a href=\"http://i.stack.imgur.com/jIHpM.png\" rel=\"nofollow\">data</a></p>\n\n<pre><code>Sub goeie()\n    With Sheets(\"A\")\n\n    'bord 2 verwijzingen\n    .[C42].FormulaR1C1 = \"=blad2!R[4]C[13]\"\n    .[D42].FormulaR1C1 = \"=blad2!R[4]C[10]\"\n    .[E42].FormulaR1C1 = \"=blad2!R[4]C[10]\"\n    .[F42].FormulaR1C1 = \"=IF(blad2!R[4]C[11]=\"\"S235\"\",235,355)\"\n\n    'bord 1 verwijzingen\n    .[C43].FormulaR1C1 = \"=blad2!R[3]C[9]\"\n    .[D43].FormulaR1C1 = \"=blad2!R[3]C[6]\"\n    .[E43].FormulaR1C1 = \"=blad2!R[3]C[6]\"\n    .[F43].FormulaR1C1 = \"=IF(blad2!R[3]C[7]=\"\"S235\"\",235,355)\"\n\n    'deur\n    .[C56].FormulaR1C1 = \"=blad2!R[-10]C[3]\"\n    .[D56].FormulaR1C1 = \"=blad2!R[-10]C[1]\"\n    .[E56].FormulaR1C1 = \"=blad2!R[-10]C[2]\"\n    .[F56].FormulaR1C1 = \"=IF(blad2!R[3]C[2]=\"\"V\"\",\"\"X-as\"\",\"\"Y-as\"\")\"\n    End With\n\n    With Sheets(\"Blad2\")\n    .[R46].FormulaR1C1 = \"=A!R[12]C[1]\"\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "search", "replace", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1459359871, "post_id": 36311923, "comment_id": 60255275, "body": "Why not just use the filter on the Car Vendors column shown in your example?"}], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 3658953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b51f144a17c8c6f5bcdede77b8734f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike M", "link": "https://stackoverflow.com/users/3658953/mike-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1459348759, "creation_date": 1459348759, "answer_id": 36312166, "question_id": 36311923, "link": "https://stackoverflow.com/questions/36311923/search-by-text-and-find-all-values-in-that-row/36312166#36312166", "title": "Search by text and find all values in that row", "body": "<p>You could use a simple macro and link it to a button on the page. Change Criteria1 to whatever cell you are typing the Vendor into.</p>\n\n<pre><code>Sub dataFilter()\n    ActiveSheet.ListObjects(*table name*).Range.AutoFilter Field:=1, _\n    Criteria1:=\"B2\", Operator:=xlFilterValues\n\nend sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1459352655, "creation_date": 1459352655, "answer_id": 36313701, "question_id": 36311923, "link": "https://stackoverflow.com/questions/36311923/search-by-text-and-find-all-values-in-that-row/36313701#36313701", "title": "Search by text and find all values in that row", "body": "<p>You can use an array formula, entered with <kbd>CTRL+SHIFT+ENTER</kbd>, to get this.</p>\n\n<p>Assuming your main data is in <code>A1:D6</code> (including header row), you can use this formula:</p>\n\n<pre><code>=INDEX(A$2:A$6,SMALL(IF($A$2:$A$6=$G$2,ROW(A$2:A$6)-ROW(A$2)+1),ROWS(A$2:A2)))\n</code></pre>\n\n<p>Where <code>G2</code> is the cell with the Car you want to return the values for.  Enter the formula, and you can drag right:\n<a href=\"https://i.stack.imgur.com/GTIGz.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GTIGz.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Finally, just wrap <code>IfError([that formula],\"\")</code> around it, to put empty cells where there's not a match.</p>\n\n<p>(Adjust your ranges as necessary).</p>\n"}], "owner": {"reputation": 21, "user_id": 5485923, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/897e21c551bb30b2909b577e6613b225?s=128&d=identicon&r=PG&f=1", "display_name": "Dler Ari", "link": "https://stackoverflow.com/users/5485923/dler-ari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36313701, "answer_count": 2, "score": 0, "last_activity_date": 1478215397, "creation_date": 1459348221, "last_edit_date": 1531161705, "question_id": 36311923, "link": "https://stackoverflow.com/questions/36311923/search-by-text-and-find-all-values-in-that-row", "title": "Search by text and find all values in that row", "body": "<p>What I am trying to achieve is I want to search and retrieve data from an table. However, the problem is I do not know how to create a function that searches through a table and retreives an array from the search text. </p>\n\n<p>Please, take a look at the picture and you will understand what I am trying to achieve. What I want is, when I for instance search \"BMW\", it searches through the table and retrieves those rows which has same vendors.</p>\n\n<p>Any ideas how I can solve this problem? I have used VLOOKUP, but it retrieves one data. \n<a href=\"https://i.stack.imgur.com/egT8l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/egT8l.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1459347769, "post_id": 36311493, "comment_id": 60246679, "body": "What are you expecting it to do? you&#39;re assigning the last row number to a variable but then you&#39;re not actually doing anything with it"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459347870, "post_id": 36311493, "comment_id": 60246773, "body": "Activesheet.Cells requires two numbers as arguments. You give number and &quot;C&quot;."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459348063, "post_id": 36311493, "comment_id": 60246967, "body": "@Vityata That&#39;s simply not true - try the code and see. <code>Cells()</code> is a collection object and you can access elements using their index or key (number or letter)"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459348096, "post_id": 36311493, "comment_id": 60246999, "body": "Sorry but no @Vityata. Number and &quot;C&quot; is valid input. In fact, Cells only requires one argument: Rows. The column index is optional."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459348732, "post_id": 36311493, "comment_id": 60247548, "body": "True. I have simply never used it like this."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 1, "creation_date": 1459348737, "post_id": 36311493, "comment_id": 60247551, "body": "There is a syntax error in this code snippet: x1Up should be xlUp (see my detailed answer). Best regards,"}], "answers": [{"tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 1, "last_activity_date": 1459348661, "last_edit_date": 1459348661, "creation_date": 1459347830, "answer_id": 36311752, "question_id": 36311493, "link": "https://stackoverflow.com/questions/36311493/vba-is-not-selecting-the-last-row-in-my-data/36311752#36311752", "title": "VBA is not selecting the last row in my data", "body": "<p>You may use the following simple VBA code snippet to select the last cell with data in Column \"C\":</p>\n\n<pre><code>Sub MoveToLastRow()\n    ActiveSheet.Range(\"C\" &amp; Rows.Count).End(xlUp).Select\nEnd Sub\n</code></pre>\n\n<p><strong><em>Note</em></strong>: your original code contains a syntax error, thus it doesn't work: End(<strong>x1Up</strong>).Row should be written as End(<strong>xlUp</strong>).Row. Following is the corrected code snippet performing the same action (i.e. selecting the last cell with data in Column \"C\")</p>\n\n<pre><code>Sub MoveToLastRow()\n    Dim LastRow As Long\n    LastRow = ActiveSheet.Cells(Rows.Count, \"C\").End(xlUp).Row\n    ActiveSheet.Range(\"C\" &amp; LastRow).Select\nEnd Sub\n</code></pre>\n\n<p>Hope this may help.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1459347852, "creation_date": 1459347852, "answer_id": 36311761, "question_id": 36311493, "link": "https://stackoverflow.com/questions/36311493/vba-is-not-selecting-the-last-row-in-my-data/36311761#36311761", "title": "VBA is not selecting the last row in my data", "body": "<p>Add:</p>\n\n<pre><code>Application.GoTo Range(\"C\" &amp; LastRow)\n</code></pre>\n\n<p>at the end of your code to make the cursor move to that cell.</p>\n"}, {"tags": [], "owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "is_accepted": false, "score": 0, "last_activity_date": 1459348214, "creation_date": 1459348214, "answer_id": 36311917, "question_id": 36311493, "link": "https://stackoverflow.com/questions/36311493/vba-is-not-selecting-the-last-row-in-my-data/36311917#36311917", "title": "VBA is not selecting the last row in my data", "body": "<p>In your code change <code>.End(x1Up)</code> to <code>.End(xlUp)</code> if you use <code>Option Explicit</code> at the top of your code it will show you that VBA thought it was a variable.</p>\n"}], "owner": {"reputation": 1, "user_id": 6135105, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RwV6SMxqB1c/AAAAAAAAAAI/AAAAAAAAAxk/51Q_jbBuEcM/photo.jpg?sz=128", "display_name": "Don Corcoran", "link": "https://stackoverflow.com/users/6135105/don-corcoran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "closed_date": 1459348545, "answer_count": 3, "score": 0, "last_activity_date": 1459348661, "creation_date": 1459347224, "question_id": 36311493, "link": "https://stackoverflow.com/questions/36311493/vba-is-not-selecting-the-last-row-in-my-data", "closed_reason": "Duplicate", "title": "VBA is not selecting the last row in my data", "body": "<p>I feel like I am missing something. \nI have a table with ID, Name, Status as headers.\nThe table's headers start at B2 and data starts at B3\nThe table is dynamic and generated by vba code from another workbook.\nThere may be times it is filtered data but there are no gaps in the table.</p>\n\n<p>There are times a user will select someone in the Name column (C).\nA button click should bring them down to the last record.</p>\n\n<p>I get that there are lots of ways to accomplish this but I cannot seem to get any of them to work and I can't figure out why.</p>\n\n<p>Here is my current code but I have tried UsedRange, CurrentRegion, Table names, the whole works.</p>\n\n<pre><code>Sub MoveToLastRow()\n\n    Dim LastRow As Long\n\n    LastRow = ActiveSheet.Cells(Rows.Count, \"C\").End(x1Up).Row\n\nEnd Sub\n</code></pre>\n\n<p>I click on the button or try to step through the code with a name selected and it just does nothing.</p>\n\n<p>Thank you for your input.\n~Don</p>\n"}, {"tags": ["arrays", "vba", "excel", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1459347372, "post_id": 36311432, "comment_id": 60246338, "body": "Thanks for your quick reply. The third parameter it&#39;s not the index. The GetRecData method needs the three parameters to return a 1D array."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1459347106, "creation_date": 1459347106, "answer_id": 36311432, "question_id": 36311004, "link": "https://stackoverflow.com/questions/36311004/copy-1d-array-to-multidimensional-array-vba/36311432#36311432", "title": "Copy 1D array to multidimensional array - VBA", "body": "<p>Change this:</p>\n\n<pre><code>For j = 0 To total_time\n    AllChannelsData(i, j + 1) = RecChannelData.GetRecData(RecChannel, 1, 0)\nNext\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>For j = 0 To total_time\n    AllChannelsData(i, j + 1) = RecChannelData.GetRecData(RecChannel, 1, j)\nNext\n</code></pre>\n\n<p>maybe?</p>\n\n<p>I'm assuming the third parameter of the <code>.GetRecData(RecChannel, 1, 0)</code> method is the index since 1D arrays like you're describing don't take 3 parameters. If that's not it, you may need to expand on what the <code>GetRecData</code> method is/does/returns/etc.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459347320, "creation_date": 1459347320, "answer_id": 36311540, "question_id": 36311004, "link": "https://stackoverflow.com/questions/36311004/copy-1d-array-to-multidimensional-array-vba/36311540#36311540", "title": "Copy 1D array to multidimensional array - VBA", "body": "<p>this \"base\" code works</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim arr1 As Variant\nDim arr2() As Variant\nDim total_time As Integer, i As Integer, j As Integer\n\ntotal_time = 4\n\nReDim arr2(0 To 3, 0 To total_time)\nFor i = 0 To 3\n    arr2(i, 0) = i\n    For j = 1 To total_time\n        arr2(i, j) = GetRecData(j + 1)\n    Next j\nNext i\n\nEnd Sub\n\nFunction GetRecData(n As Integer) As Variant\nReDim arr(0 To n - 1) As Variant\nDim i As Integer\n\nFor i = 1 To n\n    arr(i - 1) = i\nNext i\n\nGetRecData = arr\nEnd Function\n</code></pre>\n\n<p>just adapt it to your needs</p>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1459347707, "creation_date": 1459347707, "answer_id": 36311695, "question_id": 36311004, "link": "https://stackoverflow.com/questions/36311004/copy-1d-array-to-multidimensional-array-vba/36311695#36311695", "title": "Copy 1D array to multidimensional array - VBA", "body": "<p>please refer the code below.</p>\n\n<pre><code>Sub Array_test()\n    Dim GetRecData(9) As String\n    Dim AllChannelsData(9, 2) As String\n    For i = 0 To 9\n        GetRecData(i) = i\n        For j = 0 To 9\n            AllChannelsData(j, 0) = j\n            AllChannelsData(j, 1) = GetRecData(j)\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "accepted_answer_id": 36311695, "answer_count": 3, "score": 0, "last_activity_date": 1459349975, "creation_date": 1459346167, "last_edit_date": 1459349975, "question_id": 36311004, "link": "https://stackoverflow.com/questions/36311004/copy-1d-array-to-multidimensional-array-vba", "title": "Copy 1D array to multidimensional array - VBA", "body": "<p>I have two functions in VBA. Function1 returns a 1D array. Then I have function2 which is a multidimensional array. I would like to copy the array in Function1 to the columns of the multidimensional array starting at index 1.</p>\n\n<pre><code>arr2(0,0) = \"Something\"\narr2(0,1) = (\"Something\",arr1(0))\narr2(0,2) = (\"Something\",arr1(1))\n</code></pre>\n\n<p>This is what I have. arr1 is GetRecData and arr2 is AllChannelsData.</p>\n\n<pre><code>For i = 0 To UBound(channelList)\n    'the first row in the array is the channels names\n    AllChannelsData(i, 0) = channelList(i)\n    Set RecChannel = Rec.FindChannel(channelList(i), RecDevice.Name)\n    For j = 0 To total_time\n        AllChannelsData(i, j + 1) = RecChannelData.GetRecData(RecChannel, 1, 0)\n    Next\nNext\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 153, "user_id": 5730761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hkyPh.jpg?s=128&g=1", "display_name": "SnakeFoot", "link": "https://stackoverflow.com/users/5730761/snakefoot"}, "edited": false, "score": 0, "creation_date": 1459346335, "post_id": 36310924, "comment_id": 60245408, "body": "maybe is rst.OpenRecordset()"}, {"owner": {"reputation": 153, "user_id": 5730761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hkyPh.jpg?s=128&g=1", "display_name": "SnakeFoot", "link": "https://stackoverflow.com/users/5730761/snakefoot"}, "edited": false, "score": 0, "creation_date": 1459346424, "post_id": 36310924, "comment_id": 60245491, "body": "check out this link for more info :<a href=\"http://stackoverflow.com/questions/6034959/open-recordset-in-access-2003-2007\" title=\"open recordset in access 2003 2007\">stackoverflow.com/questions/6034959/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1459346877, "post_id": 36311237, "comment_id": 60245892, "body": "@whatin1992: or see <a href=\"http://stackoverflow.com/a/32118340/3820271\">stackoverflow.com/a/32118340/3820271</a> if you need this regularly."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1459347242, "post_id": 36311237, "comment_id": 60246207, "body": "Yep, pulled it from my own function which does something similar (but also exports to Excel) - one change I&#39;d make to the link is that the parameters are part of a collection so can use a <code>For...Each</code> construct rather than a <code>For...Next</code>."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459349017, "post_id": 36311237, "comment_id": 60247775, "body": "@DarrenBartrup-Cook: Heh, true. I think that function dates back to Access 2.0 when there was no <code>For Each</code>. :) -- Edited the answer."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1459346701, "creation_date": 1459346701, "answer_id": 36311237, "question_id": 36310924, "link": "https://stackoverflow.com/questions/36310924/access-vba-opening-the-recordset-asks-for-4-parameters/36311237#36311237", "title": "Access VBA: Opening the recordset asks for 4 parameters", "body": "<p>Try this (not tested) update to the code:</p>\n\n<pre><code>Private Sub Command22_Click()\n\n    ' This section deals with grabbing the 3 calculations from qry_LiveOEE\n    Dim dbs As DAO.Database\n    Dim rst As DAO.Recordset\n    Dim qdf AS DAO.QueryDef\n    Dim prm As DAO.Parameter\n\n    Set dbs = CurrentDb\n\n    Set qdf = dbs.QueryDefs(\"qry_LiveOEE\")\n    For Each prm In qdf.Parameters\n        prm.Value = Eval(prm.Name)\n    Next prm\n    Set rst = qdf.OpenRecordset\n\n    rst.MoveFirst\n    numfg_posted = rst!SumOfqty_complete\n    numOEE = rst!OEE\n    numpp_lhr = rst!ACT_PPLHR\n\n    rst.Close\n    dbs.Close\n\n    Set rst = Nothing\n    Set dbs = Nothing\n</code></pre>\n\n<p>Make sure all the values in the parameters are available - i.e. the form is open.</p>\n"}], "owner": {"reputation": 159, "user_id": 5125921, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/034f2e7643ae425f5db23d8c404817a1?s=128&d=identicon&r=PG&f=1", "display_name": "whatin1992", "link": "https://stackoverflow.com/users/5125921/whatin1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 36311237, "answer_count": 1, "score": 0, "last_activity_date": 1594642469, "creation_date": 1459345986, "last_edit_date": 1594642469, "question_id": 36310924, "link": "https://stackoverflow.com/questions/36310924/access-vba-opening-the-recordset-asks-for-4-parameters", "title": "Access VBA: Opening the recordset asks for 4 parameters", "body": "<pre><code>Private Sub Command22_Click()\n\n    ' This section deals with grabbing the 3 calculations from qry_LiveOEE\n    Dim dbs As DAO.Database\n    Dim rst As DAO.Recordset\n\n    Set dbs = CurrentDb\n\n    'Open a dynaset-type Recordset using a saved query\n    Set rst = dbs.OpenRecordset(\"qry_LiveOEE\", dbOpenDynaset)\n\n    rst.MoveFirst\n    numfg_posted = rst!SumOfqty_complete\n    numOEE = rst!OEE\n    numpp_lhr = rst!ACT_PPLHR\n\n    rst.Close\n    dbs.Close\n\n    Set rst = Nothing\n    Set dbs = Nothing\n</code></pre>\n\n<p>I get an error saying <code>Too few parameters. Expected 4.</code> This query has 5 things in the <strong><em>criteria</em></strong> section (design view), so why is it saying I need 4 parameters?</p>\n\n<p>The 5 things in the criteria section (all under different fields) are:</p>\n\n<ol>\n<li>input from a form</li>\n<li>input from a form</li>\n<li>Switch statement based on current time</li>\n<li>Date()</li>\n<li>Is Not Null</li>\n</ol>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1459346169, "post_id": 36310565, "comment_id": 60245260, "body": "Here you go <a href=\"https://support.microsoft.com/en-us/kb/177760\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/177760</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459352068, "post_id": 36310565, "comment_id": 60250158, "body": "The file containing the macro must be opened in Excel and Word VBA must have a connection to the Excel application in order to run the macro, as described in the link posted by Sorceri."}, {"owner": {"reputation": 53, "user_id": 1737942, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a68bc5997a297574f8c601d23a183998?s=128&d=identicon&r=PG", "display_name": "LandShark", "link": "https://stackoverflow.com/users/1737942/landshark"}, "edited": false, "score": 0, "creation_date": 1459404297, "post_id": 36310565, "comment_id": 60273266, "body": "Sorry, I was not clear enough in my qestion, and will edit it now. I ment: Is it possible to call a macro in a Word-file located in any given folder from an instance of Word that has not opened that file?"}, {"owner": {"reputation": 657, "user_id": 6806508, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/32c37fdf82511bfcb25114d9a5dd0f89?s=128&d=identicon&r=PG&f=1", "display_name": "3D0G", "link": "https://stackoverflow.com/users/6806508/3d0g"}, "edited": false, "score": 0, "creation_date": 1591894933, "post_id": 36310565, "comment_id": 110235840, "body": "The link in the initial comment is broken."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 6806508, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/32c37fdf82511bfcb25114d9a5dd0f89?s=128&d=identicon&r=PG&f=1", "display_name": "3D0G", "link": "https://stackoverflow.com/users/6806508/3d0g"}, "edited": false, "score": 0, "creation_date": 1591895005, "post_id": 36448786, "comment_id": 110235877, "body": "Although I&#39;m on my own computer and no one else uses it, Windows says I don&#39;t have permission to save anything in the designated STARTUP folder."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1459939578, "creation_date": 1459939578, "answer_id": 36448786, "question_id": 36310565, "link": "https://stackoverflow.com/questions/36310565/how-to-call-a-vba-macro-in-another-ms-word-document/36448786#36448786", "title": "How to call a VBA-macro in another MS Word document?", "body": "<p>No, it's not possible to call and run a macro in <em>any</em> Office application if the file that contains the macro is not loaded in the application interface.</p>\n\n<p>That being said, if you place the macro in a *.dotm template and have the user put the template in the STARTUP folder used by the Word application, then Word will load the template as an \"Add-in\". And in that case you should be able to access the macro.</p>\n\n<p>Or, if you don't want it in the Startup folder and you have code that automates the Word.Application, anyway, then that code can <em>load</em> the *.dotm as an \"Addin\", which should make the macro available (and remove it when you're done with it). Research <code>Application.Addins.Load</code> and <code>Addin.Installed</code> in the Word language reference as well as on-line for examples.</p>\n"}], "owner": {"reputation": 53, "user_id": 1737942, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a68bc5997a297574f8c601d23a183998?s=128&d=identicon&r=PG", "display_name": "LandShark", "link": "https://stackoverflow.com/users/1737942/landshark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2188, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594050755, "creation_date": 1459345117, "last_edit_date": 1594050755, "question_id": 36310565, "link": "https://stackoverflow.com/questions/36310565/how-to-call-a-vba-macro-in-another-ms-word-document", "title": "How to call a VBA-macro in another MS Word document?", "body": "<p>in MS Excel I have been distributing a xls-file that contains a macro. From the users \"random\" current open workbook I have successfully been calling this macro by telling Word in which file to look for it. Like this, when the user clicks a button on the ribbon:</p>\n\n<p>C:\\\\\"'MyExcelFileWithTheMacro.xls'!MyMacroName\"</p>\n\n<p><strong>Can I do the same in MS Word?</strong>\nThat is, to call a macro in a Word-file located in any given folder from an instance of Word that has not opened that file?</p>\n\n<p>I have tried, of course, but Word keeps saying it can't find the macro.</p>\n\n<p>The reason I want to do it this way is that it is makes for easy distribution and updating of the macro. Next up is signing the macro. I hope it can be done when doing things this way, but not sure.</p>\n"}, {"tags": ["vba", "excel", "connection"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1459351815, "post_id": 36310265, "comment_id": 60249934, "body": "I think you&#39;ll need ret.selecteditems(1)"}, {"owner": {"reputation": 33, "user_id": 6038327, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e60879878fa89c4050d93a5ca0a1346d?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzvc", "link": "https://stackoverflow.com/users/6038327/lorenzvc"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1459354701, "post_id": 36310265, "comment_id": 60252043, "body": "&quot;object required&quot; error.. :/"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1459356292, "post_id": 36310265, "comment_id": 60253104, "body": "try selecteditems.count it might be (0)"}, {"owner": {"reputation": 33, "user_id": 6038327, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e60879878fa89c4050d93a5ca0a1346d?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzvc", "link": "https://stackoverflow.com/users/6038327/lorenzvc"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1459426988, "post_id": 36310265, "comment_id": 60288639, "body": "I&#39;m pretty new to all vba.. What are you trying to accomplish by using that count? what should happen?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1459429903, "post_id": 36310265, "comment_id": 60290876, "body": "it should count the selected items, so you should have 1.   Do a bit of reading on how to debug VBA, it will help, a lot of questions can be answered by using Locals/Immediate and Watches."}], "owner": {"reputation": 33, "user_id": 6038327, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e60879878fa89c4050d93a5ca0a1346d?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzvc", "link": "https://stackoverflow.com/users/6038327/lorenzvc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1459347972, "creation_date": 1459344407, "last_edit_date": 1459347972, "question_id": 36310265, "link": "https://stackoverflow.com/questions/36310265/vba-excel-change-query-connection-via-button-and-promptwindow", "title": "VBA - Excel. Change query connection via button and promptwindow", "body": "<p>I have a query linked to a textfile (with extension .eqp)\nI placed a button next to my pivottable, which should open a promptwindow, and change the connection's location to the new selected *.eqp file. All other query-settings should stay the same.</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim Ret\n\n    Ret = Application.GetOpenFilename(\"EQP Files (*.eqp), *.eqp\")\n\n    If Ret &lt;&gt; False Then\n        Sheets(\"CalculationSheet\").QueryTables(1).Connection = \"TEXT;\" &amp; Ret\n    End If\n    ActiveWorkbook.RefreshAll\nEnd Sub\n</code></pre>\n\n<p>I put the refreshAll in there too, since I saw no change happen when I just replaced the connections location. Can anyone explain me what goes wrong? the prompt shows up, the refresh happens, but the query is just empty. nothing there. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9864, "user_id": 2693545, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jxhDd.jpg?s=128&g=1", "display_name": "refactor", "link": "https://stackoverflow.com/users/2693545/refactor"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1459344984, "post_id": 36310238, "comment_id": 60244260, "body": "Yes i did , I verified msdn link <a href=\"https://msdn.microsoft.com/en-us/library/te33kb6t.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/te33kb6t.aspx</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 4, "last_activity_date": 1459345190, "creation_date": 1459345190, "answer_id": 36310597, "question_id": 36310238, "link": "https://stackoverflow.com/questions/36310238/check-for-pattern-in-a-string-in-vba/36310597#36310597", "title": "Check for pattern in a string in VBA", "body": "<p>You could use a simple RegExp:</p>\n\n<pre><code>Function strOut(strIn As String) As String\n    Dim objRegex As Object\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    With objRegex\n        .Pattern = \"^P\\d+$\"\n        strOut = .Test(strIn)\n    End With\nEnd Function\n</code></pre>\n\n<p><em>test code</em> </p>\n\n<pre><code>Sub Test()\nDebug.Print strOut(\"P22\")\nDebug.Print strOut(\"aP22\")\nDebug.Print strOut(\"P12344\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 2, "creation_date": 1459345884, "post_id": 36310776, "comment_id": 60245001, "body": "REPT and LEN a clever way to avoid multiple LIKE tests"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 4, "last_activity_date": 1459345606, "creation_date": 1459345606, "answer_id": 36310776, "question_id": 36310238, "link": "https://stackoverflow.com/questions/36310238/check-for-pattern-in-a-string-in-vba/36310776#36310776", "title": "Check for pattern in a string in VBA", "body": "<p>You can also use the native <code>Like</code> operator:</p>\n\n<pre><code>Sub Foo()\n\nDim x As String, matches As Boolean\nx = \"P123\"\n\nmatches = (x Like \"P\" &amp; Application.Rept(\"[0-9]\", Len(x) - 1))\n\nDebug.Print matches\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1476446312, "last_edit_date": 1476446312, "creation_date": 1459346468, "answer_id": 36311143, "question_id": 36310238, "link": "https://stackoverflow.com/questions/36310238/check-for-pattern-in-a-string-in-vba/36311143#36311143", "title": "Check for pattern in a string in VBA", "body": "<pre><code>(mystr Like \"P#\") or (mystr Like \"P##\") or (mystr Like \"P###\")  \n</code></pre>\n\n<p>is probably the fastest solution, and the simplest one.  </p>\n\n<pre><code>mystr like left(\"P######\", len(mystr)) \n</code></pre>\n\n<p>could work as well, and be more generic.  </p>\n\n<p>Anyway, if this is to be used in a query, a generic <code>LIKE</code> should be much more efficient than any VBA function.</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459351471, "post_id": 36312738, "comment_id": 60249651, "body": "I actually assumed that &quot;P&quot; would always be the first character. Were it not, it must be changed to <code>IsNumeric(Right(x, Len(x) - 1))</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459350530, "last_edit_date": 1459350530, "creation_date": 1459350228, "answer_id": 36312738, "question_id": 36310238, "link": "https://stackoverflow.com/questions/36310238/check-for-pattern-in-a-string-in-vba/36312738#36312738", "title": "Check for pattern in a string in VBA", "body": "<p>my 0.02 cents</p>\n\n<pre><code>Sub Foo2()\nx = \"P0123\"\nDebug.Print IsNumeric(Replace(x, \"P\", \"\",,1))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9864, "user_id": 2693545, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jxhDd.jpg?s=128&g=1", "display_name": "refactor", "link": "https://stackoverflow.com/users/2693545/refactor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6226, "favorite_count": 0, "accepted_answer_id": 36310597, "answer_count": 4, "score": 3, "last_activity_date": 1476446312, "creation_date": 1459344343, "last_edit_date": 1459346133, "question_id": 36310238, "link": "https://stackoverflow.com/questions/36310238/check-for-pattern-in-a-string-in-vba", "title": "Check for pattern in a string in VBA", "body": "<p>My requirement is that I need to check whether a string variable has first character \"P\" followed by digits.</p>\n\n<p>For example</p>\n\n<blockquote>\n  <p>P0<br>\n   P123<br>\n   P22</p>\n</blockquote>\n\n<p>To-date I have looked at options for using <code>Like</code> as per <a href=\"https://msdn.microsoft.com/en-us/library/te33kb6t.aspx\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 3658953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b51f144a17c8c6f5bcdede77b8734f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike M", "link": "https://stackoverflow.com/users/3658953/mike-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1459343763, "creation_date": 1459343763, "answer_id": 36310017, "question_id": 36309617, "link": "https://stackoverflow.com/questions/36309617/column-copy-and-paste-using-macro/36310017#36310017", "title": "Column copy and paste using macro", "body": "<p>You can write a Sub to cut down on some of the repetitiveness of your code.</p>\n\n<p>Ex.</p>\n\n<pre><code>Sub copyPaste(sheetNum as integer, copyCol as string, pasteCol as string)\n\n    Sheets(sheetNum).Select\n    Columns(copyCol).Copy Columns(pasteCol)\n    Columns(copyCol).ClearContents\n\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459344552, "post_id": 36310167, "comment_id": 60243899, "body": "How can I get rid of Column B after being copied and pasted? And this helped tremendously! Thank you so much!--I edited my question."}, {"owner": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459345892, "post_id": 36310167, "comment_id": 60245010, "body": "For those who need to know how to clear Column B, add this .Columns(2).ClearContents"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459345896, "post_id": 36310167, "comment_id": 60245018, "body": "@Chris  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459346284, "post_id": 36310167, "comment_id": 60245360, "body": "I have noticed tho, my B column on Sheet2 has moved to Column D, which isn&#39;t what I want. How can I make Column B stay on Column B on Sheet2? and on Sheet 3, I want Column B on Column C and clear Column B. On sheet4, I want column B on Column D and clear Column B. Im sorry that I confused you. See my edited post. thank you so much for your help."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459346469, "post_id": 36310167, "comment_id": 60245535, "body": "@Chris  Do you want to start the process to start with <i>Sheet3</i> and skip the first two sheets <b>??</b>"}, {"owner": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459346699, "post_id": 36310167, "comment_id": 60245741, "body": "Yes. I want to start the process to start with Sheet2. On sheet 2, I want Column B stay as it is. On sheet3, I want Column B to be on Column C and clear column B. On sheet 4, I want column B to be on Column D and clear column B. So on."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "edited": false, "score": 0, "creation_date": 1459346831, "post_id": 36310167, "comment_id": 60245848, "body": "@Chris  See my <b>EDIT#2</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1459346802, "last_edit_date": 1459346802, "creation_date": 1459344161, "answer_id": 36310167, "question_id": 36309617, "link": "https://stackoverflow.com/questions/36309617/column-copy-and-paste-using-macro/36310167#36310167", "title": "Column copy and paste using macro", "body": "<p>How about:</p>\n\n<pre><code>Sub ytrewq()\n    Dim i As Long\n    For i = 1 To Sheets.Count\n        With Sheets(i)\n            .Columns(2).Copy .Columns(i + 2)\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To <strong>clear</strong> column <strong>B</strong> in each sheet:</p>\n\n<pre><code>   Sub ytrewq()\n        Dim i As Long\n        For i = 1 To Sheets.Count\n            With Sheets(i)\n                .Columns(2).Copy .Columns(i + 2)\n                .Columns(2).Clear\n            End With\n        Next i\n    End Sub\n</code></pre>\n\n<p><strong>EDIT#2</strong></p>\n\n<p>This starts on <em>Sheet3</em>:</p>\n\n<pre><code>Sub ytrewq()\n    Dim i As Long\n    For i = 3 To Sheets.Count\n        With Sheets(i)\n            .Columns(2).Copy .Columns(i)\n            .Columns(2).Clear\n        End With\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6134758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83ff26405286a9c906995249f96f84?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6134758/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459500016, "creation_date": 1459342736, "last_edit_date": 1459500016, "question_id": 36309617, "link": "https://stackoverflow.com/questions/36309617/column-copy-and-paste-using-macro", "title": "Column copy and paste using macro", "body": "<p>I am not familiar with VBA or Macro and I use Microsoft excel quite often. </p>\n\n<p>what's better way to write this? What I want is to copy Column B and paste Column B to right next column and every other column. </p>\n\n<p>For example:</p>\n\n<p>on sheet2, I want B column to be on B column</p>\n\n<p>on sheet3, I want B column to be on C column and clear Column B</p>\n\n<p>on sheet4, I want B column to be on E column and clear Column B</p>\n\n<p>on sheet5, I want B column to be on F column and clear Column B</p>\n\n<p>.</p>\n\n<p>.</p>\n\n<p>.</p>\n\n<p>.\non sheet 26, I want B column to be on Z column and clear column B</p>\n\n<p>on sheet 27, I want B column to be on AA column and clear column B</p>\n\n<p>so on</p>\n\n<p>I have used \" Record Macro\" to come up with this but I'd like to use VBA programming. what'd be the best way to copy/cut paste columns? </p>\n\n<pre><code>Sheets(2).Select\nColumns(\"B:B\").Select\nSheets(3).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"C:C\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\nSheets(4).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"D:D\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\nSheets(5).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"E:E\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\nSheets(6).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"F:F\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\nSheets(7).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"G:G\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\nSheets(8).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"H:H\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\nSheets(9).Select\nColumns(\"B:B\").Select\nSelection.Copy\nColumns(\"I:I\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nColumns(\"B:B\").Select\nSelection.ClearContents\n</code></pre>\n"}, {"tags": ["vba", "excel", "variables", "named-ranges"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459344161, "post_id": 36309199, "comment_id": 60243557, "body": "Well asked question btw - great start."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459344444, "post_id": 36309199, "comment_id": 60243798, "body": "@brettdj seconded, nice to see a good first question in the vba arena."}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1459366157, "post_id": 36309199, "comment_id": 60259384, "body": "Thank you both for the compliment :)"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1459365907, "post_id": 36309987, "comment_id": 60259203, "body": "This was the answer I was looking for! If I understand you correctly I was not calling upon the new variable at all. I was talking directly to a sheet and was asking for a Named Range that was not there.   This concludes a nice first quest :)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1459366123, "post_id": 36309987, "comment_id": 60259366, "body": "That&#39;s exactly what I was explaining - glad you understood the concept, shouldn&#39;t take you long to pick up VBA at all."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1459343707, "creation_date": 1459343707, "answer_id": 36309987, "question_id": 36309199, "link": "https://stackoverflow.com/questions/36309199/a-variable-of-a-named-range-excel-in-a-userform-gives-me-an-error/36309987#36309987", "title": "A variable of a Named Range (Excel) in a Userform gives me an error", "body": "<p>Change</p>\n\n<pre><code>Format(wsTest.Range(\"rnTest\")(1).Value, \"$#,##0\")\n</code></pre>\n\n<p>To</p>\n\n<pre><code>Format(rnTest(1).Value, \"$#,##0\")\n</code></pre>\n\n<p><code>rnTest</code> is the name of the range object you are targeting, but when you pass it in quotation marks within the <code>Range()</code> method it is treated as a literal string. Unless you also have a named range called \"rnTest\" this will always fail.</p>\n\n<p>As you can see from the above example, you can now access the <code>rnTest</code> object directly, as the reference has been <strong>Set</strong> earlier. Hope that makes sense.</p>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459344173, "post_id": 36310127, "comment_id": 60243573, "body": "Or even <code>Test1.Caption = Format([NamedRange].Cells(1), &quot;$#,##0&quot;)</code>"}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1459366111, "post_id": 36310127, "comment_id": 60259350, "body": "I cut out the variable to point to the worksheet. For now I am working with global Named Ranges. I did not even know you were able to make localised Named Ranges specific to sheets. Thanks for the helpfull tip."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1459344193, "last_edit_date": 1459344193, "creation_date": 1459344072, "answer_id": 36310127, "question_id": 36309199, "link": "https://stackoverflow.com/questions/36309199/a-variable-of-a-named-range-excel-in-a-userform-gives-me-an-error/36310127#36310127", "title": "A variable of a Named Range (Excel) in a Userform gives me an error", "body": "<p>You should able to cut this code down to just this presuming the range name is global, i.e. you don't need to work with the worksheet.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim rnTest As Range\nSet rnTest = Range(\"NamedRange\")\nMe.Test1.Caption = Format(rnTest.Cells(1).Value, \"$#,##0\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "accepted_answer_id": 36309987, "answer_count": 2, "score": 3, "last_activity_date": 1459344193, "creation_date": 1459341678, "question_id": 36309199, "link": "https://stackoverflow.com/questions/36309199/a-variable-of-a-named-range-excel-in-a-userform-gives-me-an-error", "title": "A variable of a Named Range (Excel) in a Userform gives me an error", "body": "<p>I am very new to Excel-VBA (any kind of programming actually) and I am looking for help. </p>\n\n<p>I am trying to make a variable of a Named Range in a Userform (Excel-VBA), but when I try to use the macro with the created variable I receive an error: </p>\n\n<blockquote>\n  <p>Run-time error '1004': Method 'Range' of object '_Worksheet' failed</p>\n</blockquote>\n\n<p>How to reproduce:</p>\n\n<p>1) Make a Userform with a label (named test1 in my code).</p>\n\n<p>2) Make Module for the macro.</p>\n\n<p>Here is the code for the Userform and the Module.</p>\n\n<p>The Userform</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim wsTest As Worksheet\nDim rnTest As Range\n\nSet wsTest = Sheets(\"Test\")\nMsgBox wsTest.Name\n\nSet rnTest = wsTest.Range(\"NamedRange\")\nMsgBox rnTest.Name\n\nMe.Test1.Caption = Format(wsTest.Range(\"rnTest\")(1).Value, \"$#,##0\")\n\nEnd Sub\n</code></pre>\n\n<p>And the Module</p>\n\n<pre><code>Sub NR_Test()\n\nUserForm1.Show False\n\nEnd Sub\n</code></pre>\n\n<p>The variable 'wsTest' works. I know this because when I enter the Named Range-name that I see in the Name Manager (NamedRange), the Macro works. </p>\n\n<p>I have searched Stackoverflow and other resources to look for a solution. Most posts tell me I need to use \"Set\" to make a variable from a range, but unfortunately that is not enough. I am missing some vital piece and I can't put my finger on it. </p>\n\n<p>Any help would be very much appreciated. If there are any question, please don't hesitate to ask. </p>\n\n<p>Cheers,\nSimon</p>\n"}, {"tags": ["excel", "delphi", "vba"], "comments": [{"owner": {"reputation": 8084, "user_id": 512728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GZ3bk.jpg?s=128&g=1", "display_name": "Jan Doggen", "link": "https://stackoverflow.com/users/512728/jan-doggen"}, "edited": false, "score": 0, "creation_date": 1459342855, "post_id": 36309172, "comment_id": 60242467, "body": "Why don&#39;t just trim() in Delphi <b>code</b> when the data is on its way from DBase to Excel?"}, {"owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "reply_to_user": {"reputation": 8084, "user_id": 512728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GZ3bk.jpg?s=128&g=1", "display_name": "Jan Doggen", "link": "https://stackoverflow.com/users/512728/jan-doggen"}, "edited": false, "score": 0, "creation_date": 1459343931, "post_id": 36309172, "comment_id": 60243374, "body": "Thanks for your answer, Jan. But using CopyFromRecordset method, I only have one _Recordset object.. how could I access the field values?"}, {"owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "reply_to_user": {"reputation": 8084, "user_id": 512728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GZ3bk.jpg?s=128&g=1", "display_name": "Jan Doggen", "link": "https://stackoverflow.com/users/512728/jan-doggen"}, "edited": false, "score": 0, "creation_date": 1459346148, "post_id": 36309172, "comment_id": 60245241, "body": ".. tried to use the &quot;AfterOpen&quot; method and do some aodquery.edit and then Fields[0].asString := trim(Fields[0].asString..  adoquery.post... but no help, can not write values back into the query.. :-\\"}, {"owner": {"reputation": 2564, "user_id": 923584, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Njkzd.jpg?s=128&g=1", "display_name": "Hugh Jones", "link": "https://stackoverflow.com/users/923584/hugh-jones"}, "edited": false, "score": 0, "creation_date": 1459349491, "post_id": 36309172, "comment_id": 60248091, "body": "is it possible to issue an update to VFP to cleanse the data before you read it?"}, {"owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "reply_to_user": {"reputation": 2564, "user_id": 923584, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Njkzd.jpg?s=128&g=1", "display_name": "Hugh Jones", "link": "https://stackoverflow.com/users/923584/hugh-jones"}, "edited": false, "score": 0, "creation_date": 1459355332, "post_id": 36309172, "comment_id": 60252432, "body": "@Hugh - How could this be done? I downloaded the latest Foxpro Client from here <a href=\"http://www.microsoft.com/download/en/details.aspx?id=14839\" rel=\"nofollow noreferrer\">microsoft.com/download/en/details.aspx?id=14839</a> - is there a way to disable padding?  On the other hand: I am just looking for a way to manipulate data either in the local dataset (without writing it back... all found information deals with writing back values using update statements.. I just need to be able to trim strings.. arrrrghhh... ) or in Excel..."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1459361743, "post_id": 36309172, "comment_id": 60256506, "body": "Difficult to know how to help when there&#39;s no code."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1459384016, "post_id": 36309172, "comment_id": 60267384, "body": "1) How are you accessing the VFP data? I&#39;ve never encountered the issue you describe. 2) <i>Trying to trim field values brings error</i>. What <i>error</i>? What <b>specific problem</b> are you having? 3) No, you don&#39;t need to copy the data into a CDS to edit them, but you shouldn&#39;t need to be editing them in the first place. It appears you&#39;re reading the VFP data wrong, but as you&#39;ve provided no information about how you&#39;re doing so it&#39;s difficult to determine what that might be. 4) You don&#39;t have to resize the range, and you don&#39;t have to do it like you are by repeatedly doing so. (continued)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1459384137, "post_id": 36309172, "comment_id": 60267431, "body": "Use a variant array, populate it with your data (trimming it in the Delphi code if needed as doing so), and provide that array to a single cell range in Excel (the top col/row coordinate) and Excel will handle the rest."}, {"owner": {"reputation": 2564, "user_id": 923584, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Njkzd.jpg?s=128&g=1", "display_name": "Hugh Jones", "link": "https://stackoverflow.com/users/923584/hugh-jones"}, "edited": false, "score": 0, "creation_date": 1459413962, "post_id": 36309172, "comment_id": 60279047, "body": "@Heiko - <code>update table set field = trim(field)</code> - or at least something like it - depends what the VFP equivalent of <code>trim()</code> is"}, {"owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1459598471, "post_id": 36309172, "comment_id": 60363856, "body": "Thank you for helping, guys! As I stated, I found my provided solution. There are only few cells (max 300 rows, 5 cols) so importing &quot;manually&quot; is acceptable to me. I was really spending many hours trying to find a workaround: bypassing the VFP padding problem (which is the reason for all that), manipulating data within the dataset of my adoquery, trimming data within excel - but none of this worked. So, just for the record: @Ken 1) I use TADOConnection and TADOQuery. All fields in the recordset are padded to a certain field length, although (@Hugh) data in the original tables are ok."}, {"owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "edited": false, "score": 0, "creation_date": 1459598922, "post_id": 36309172, "comment_id": 60364001, "body": "@ Hugh: I tried your idea of doubling fields and simply use the calculated (trimmed) copy. This also does the job (thanks!), but still I think this is definitely not the &quot;ideal&quot; way.."}], "answers": [{"comments": [{"owner": {"reputation": 2564, "user_id": 923584, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Njkzd.jpg?s=128&g=1", "display_name": "Hugh Jones", "link": "https://stackoverflow.com/users/923584/hugh-jones"}, "edited": false, "score": 0, "creation_date": 1459414141, "post_id": 36320734, "comment_id": 60279174, "body": "another possibility might be to create a calculated field for each field requiring manipulation - you would put your trim statement into the <code>OnCalcFields()</code> method.  This would mean the dataset would then have 2 &#39;versions&#39; of each datum"}], "tags": [], "owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "is_accepted": false, "score": 0, "last_activity_date": 1459377852, "last_edit_date": 1459377852, "creation_date": 1459376266, "answer_id": 36320734, "question_id": 36309172, "link": "https://stackoverflow.com/questions/36309172/delphi-how-to-trim-a-excel-range/36320734#36320734", "title": "Delphi: how to trim a excel range", "body": "<p>Finally I chose this (simple...) solution by copying every cell value manually so I can use Delphi's trim function:</p>\n\n<p>.. some code as above, but now \"data\" is a TADOQuery:</p>\n\n<pre><code> data.First;\n    for RowIndex := 0 to Data.RecordCount - 1 do begin\n      for ColumnIndex := 0 to data.Fields.Count - 1 do begin\n        ovWS.Cells[RowIndex+1, ColumnIndex+1].Value := trim(data.Fields[columnIndex].AsString);\n\n        next ;\n      end;\n    data.Next;\n    next;\n</code></pre>\n\n<p>(... but still wondering if there is a simpler and \"cleaner\" way... besides the fact that padding in Foxpro is horrible!)</p>\n"}], "owner": {"reputation": 13, "user_id": 6134598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42095f4b72bc6b058b6ec72900c773e4?s=128&d=identicon&r=PG&f=1", "display_name": "Heiko", "link": "https://stackoverflow.com/users/6134598/heiko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 995, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1459377852, "creation_date": 1459341628, "last_edit_date": 1531161705, "question_id": 36309172, "link": "https://stackoverflow.com/questions/36309172/delphi-how-to-trim-a-excel-range", "title": "Delphi: how to trim a excel range", "body": "<p>Although I am a great fan of stackoverflow and I found several good solutions, this is my first question.\nI am writing a Delphitool (D6... old but still working!) for making it easier to administrate our students at school.</p>\n\n<p>Delphi reads some (even older...) Visual Foxpro Dbase tables and collects the needed data in a query. This data should be exported to Excel.\n\"Theoretically\" everything is working, but I have several problems:</p>\n\n<ol>\n<li>query fields are padded with lots of leading spaces, this seems\nto be a FoxPro issue (I found this:\n<a href=\"http://www.ml-consult.co.uk/foxst-36.htm\" rel=\"nofollow noreferrer\">http://www.ml-consult.co.uk/foxst-36.htm</a>, don't know how to work\nwith it)</li>\n<li>trimming through sql-commands does not work (whitespace\nis created by foxpro query, the tables are \"clean\")</li>\n<li>tried to get things done in Delphi with the help of \"onGetText\" Method of field\nnames - that helps, but within the dataset the spaces are untouched \n(only their field values in the grid are correct) - also no help\nbecause exporting to delphi uses the query</li>\n<li>so I have to get rid of the whitespaces from Delphi to Excel. I use this:\n<a href=\"https://stackoverflow.com/questions/17058563/exporting-data-from-a-dbgrid-to-excel\">Exporting data from a DBGrid to Excel</a>\nand thought I could execute Excel's trim-funtion to manipulate the\nfields. So my question is: how can I execute vba-code? I found this:\n<a href=\"https://stackoverflow.com/questions/2964769/trim-cells-using-vba-in-excel\">Trim Cells using VBA in Excel</a></li>\n</ol>\n\n<p>Any ideas? Thanks in advance!</p>\n\n<p>PS:\nI also looked for a simple \"replace all spaces but not within words\" way, thought of regexp, but found no way to get this done from within my Delphi code.</p>\n\n<p>As there is not very much text in the excel sheet (100 lines, 4 columns), I could walk through every single cell... but that seems to be not very elegant.\n<a href=\"https://stackoverflow.com/questions/14698745/how-does-trim-work-in-excel-vba\">How does Trim work in Excel VBA?</a>\n<a href=\"https://stackoverflow.com/questions/3785551/how-to-trim-text-in-a-column-with-vba-excel\">How to trim text in a column with VBA - Excel</a></p>\n\n<p>So there's the code for simple replacement of all spaces - unfortunately it also replaces necesserary space between 2 words in a cell:  </p>\n\n<pre><code> ovExcelApp := CreateOleObject('Excel.Application');\n   try\n   ovExcelApp.displayAlerts := false;\n   ovExcelWorkbook := ovExcelApp.WorkBooks.Add;\n   ovWS := ovExcelWorkbook.Worksheets.Item[1]; \n   ovWS.Activate;\n   ovWS.Select;\n   ovWS.Cells.NumberFormat := AnsiChar('@');\n   ovRange := ovWS.Range['A1', 'A1']; //go to first cell\n   ovRange.Resize[Data.RecordCount, Data.Fields.Count];\n   ovRange.CopyFromRecordset(Data, Data.RecordCount, Data.Fields.Count); \n   ovExcelApp.Cells.Replace(\n       What := ' ',\n       Replacement := '', \n       LookAt := 2, \n       SearchOrder := 1, \n       MatchCase := False,\n       SearchFormat := False,\n       ReplaceFormat := False\n       );\n   end;\n   // How could I do a regexp (only replace leading spaces) or do a trim over all cells withing ovWS?\n   ovRange.EntireColumn.AutoFit;\n   ovWS.SaveAs(DestName, 1, '', '', False, False);\n</code></pre>\n\n<p>Trying to trim field values brings an error:</p>\n\n<pre><code>procedure Tf_dbftools.qADO_einzelnAfterOpen(DataSet: TDataSet);\nbegin\n  with qADO_einzeln do begin\n    first;\n    while not eof do begin\n      edit;\n      Fields[0].AsString := trim(fields[0].asstring);\n      Fields[1].AsString := trim(fields[1].asstring);\n      Fields[2].AsString := trim(fields[2].asstring);\n      Fields[3].AsString := trim(fields[3].asstring);\n      next;\n    end;\n    //post -&gt; error\n  end;\nend;\n</code></pre>\n\n<p>I just need to edit the data (from different tables) in the qADO Query resp. dataset to get things correctly exported to Excel. Do I really need to copy the data into a clientDataset to edit them?</p>\n"}, {"tags": ["excel", "vba", "typelib", "tlbinf32"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1459348746, "post_id": 36309155, "comment_id": 60247556, "body": "have you registered it using RegSvr?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1570700330, "post_id": 36309155, "comment_id": 102998962, "body": "There used to be a now deleted answer that read, <i>&quot;If you are running 64-bit, you will not be able to use the &#39;tlbinf32.dll&#39; - you need 32-bit to do so...&quot;</i>."}], "owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2491, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1542832887, "creation_date": 1459341598, "last_edit_date": 1542832887, "question_id": 36309155, "link": "https://stackoverflow.com/questions/36309155/not-able-to-instantiate-object-from-tlbinf32", "title": "Not able to instantiate object from TLBINF32", "body": "<p>I have downloaded tlbinf32.dll and added it as a reference to VBA but it doesn't seem to be working, when I try to create the following object</p>\n\n<pre><code>     Dim oTLI As Object\n\n     Set oTLI = New TLI.TLIApplication\n     Set oTLI = CreateObject(\"TLI.TLIApplication\")\n</code></pre>\n\n<p>I get the following error for both </p>\n\n<p><em>'ActiveX component can't create object'</em></p>\n\n<p>Does anyone know how to fix this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1459346029, "post_id": 36308941, "comment_id": 60245129, "body": "How can you open xL with notepad?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459351200, "post_id": 36308941, "comment_id": 60249402, "body": "All you want to do is rename the file?"}, {"owner": {"reputation": 21, "user_id": 6134630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6a161dfed298b4c52c8defcd24d2c6?s=128&d=identicon&r=PG&f=1", "display_name": "user6134630", "link": "https://stackoverflow.com/users/6134630/user6134630"}, "edited": false, "score": 0, "creation_date": 1459405607, "post_id": 36308941, "comment_id": 60273961, "body": "by using    Shell(&quot;C:\\WINDOWS\\notepad.exe &quot; &amp; ThisWorkbook.path &amp; &quot;\\&quot; &amp; flname, 1)"}], "answers": [{"comments": [{"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "reply_to_user": {"reputation": 21, "user_id": 6134630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6a161dfed298b4c52c8defcd24d2c6?s=128&d=identicon&r=PG&f=1", "display_name": "user6134630", "link": "https://stackoverflow.com/users/6134630/user6134630"}, "edited": false, "score": 0, "creation_date": 1459418761, "post_id": 36315708, "comment_id": 60282641, "body": "In that case, please up vote it and accept as the answer (the help should have info on how to do both)"}], "tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": false, "score": 0, "last_activity_date": 1459358831, "creation_date": 1459358831, "answer_id": 36315708, "question_id": 36308941, "link": "https://stackoverflow.com/questions/36308941/copy-a-csv-file-to-a-txt-file/36315708#36315708", "title": "Copy a .csv file to a .txt file", "body": "<p>Copy the file using the File System Object:</p>\n\n<pre><code>Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nobjFSO.CopyFile ThisWorkbook.path &amp; \"\\\" &amp; \"myfile.csv\", ThisWorkbook.path &amp; \"\\\" &amp; \"myfile_1.txt\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6134630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6a161dfed298b4c52c8defcd24d2c6?s=128&d=identicon&r=PG&f=1", "display_name": "user6134630", "link": "https://stackoverflow.com/users/6134630/user6134630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459362418, "creation_date": 1459341037, "last_edit_date": 1459362418, "question_id": 36308941, "link": "https://stackoverflow.com/questions/36308941/copy-a-csv-file-to-a-txt-file", "title": "Copy a .csv file to a .txt file", "body": "<p>I am running below code but unable to save opened notepad file in same format, code is below</p>\n\n<pre><code>Dim mytxtfile\nDim flname, flname2 As String\nflname = Dir(ThisWorkbook.path &amp; \"\\\" &amp; \"myfile.csv\")\nflname2 = ThisWorkbook.path &amp; \"\\\" &amp; \"myfile_1.txt\"\nmytxtfile = Shell(\"C:\\WINDOWS\\notepad.exe \" &amp; ThisWorkbook.path &amp; \"\\\" &amp; flname, 1)\nAppActivate mytxtfile\nSendKeys \"%(FAX)\", True\nApplication.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 2)\nSendKeys \"%S\", True ' \n</code></pre>\n\n<p>\"Save as\" dialog box opens here, but now I want to give the file name which is in <code>flname2</code> i.e (myfile_1.txt) and then save and close notepad.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 2720251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4115b0ead193eac700cedbb2b018fae1?s=128&d=identicon&r=PG&f=1", "display_name": "user2720251", "link": "https://stackoverflow.com/users/2720251/user2720251"}, "edited": false, "score": 0, "creation_date": 1459403369, "post_id": 36311965, "comment_id": 60272841, "body": "After implementing the above also I am able to see page break till Z column. But i wanted to make the first vertical page break till L column. Please help me on this."}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 41, "user_id": 2720251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4115b0ead193eac700cedbb2b018fae1?s=128&d=identicon&r=PG&f=1", "display_name": "user2720251", "link": "https://stackoverflow.com/users/2720251/user2720251"}, "edited": false, "score": 0, "creation_date": 1459429518, "post_id": 36311965, "comment_id": 60290603, "body": "Does deleting all the columns from M to Z and running the macro do the trick?"}], "tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 0, "last_activity_date": 1459348300, "creation_date": 1459348300, "answer_id": 36311965, "question_id": 36308894, "link": "https://stackoverflow.com/questions/36308894/how-to-adjust-first-page-break-to-some-specific-column-using-macro/36311965#36311965", "title": "How to adjust first page break to some specific column using macro", "body": "<p>This work for me, Basically I am resetting all the pagebreaks before setting it again:</p>\n\n<pre><code>ActiveWindow.View = xlPageBreakPreview\nActiveSheet.ResetAllPageBreaks\nActiveSheet.VPageBreaks(1).DragOff xlToRight, 1\nActiveWindow.View = xlNormalView\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 2720251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4115b0ead193eac700cedbb2b018fae1?s=128&d=identicon&r=PG&f=1", "display_name": "user2720251", "link": "https://stackoverflow.com/users/2720251/user2720251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1459745453, "creation_date": 1459340932, "question_id": 36308894, "link": "https://stackoverflow.com/questions/36308894/how-to-adjust-first-page-break-to-some-specific-column-using-macro", "title": "How to adjust first page break to some specific column using macro", "body": "<p>I have excel sheet which will have 12 columns. By default first vertical page break is till column F. I wanted to extends that first vertical page break till column L by using macro.</p>\n\n<p>Below macro is setting the first vertical page break till Z column. But I want till L column only.</p>\n\n<pre><code>        ActiveWindow.View = xlPageBreakPreview\n        ActiveSheet.VPageBreaks(1).DragOff Direction:=xlToRight,RegionIndex:=1\n        ActiveWindow.View = xlNormalView\n</code></pre>\n\n<p>Please help me on this.</p>\n\n<p>Regards,\nVaithilingam.K </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1459343192, "post_id": 36309364, "comment_id": 60242776, "body": "Yes this is exactly what I wanted thanks so much no idea it was so easy lol"}], "tags": [], "owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1459342135, "creation_date": 1459342135, "answer_id": 36309364, "question_id": 36308853, "link": "https://stackoverflow.com/questions/36308853/replace-text-when-part-of-condition-is-met/36309364#36309364", "title": "Replace text when part of condition is met", "body": "<p>I think what you're asking for is to replace both the word and the time for the string 'Scheduled To Work'?</p>\n\n<p>If that's the case, try adding a wildcard to your sub like so:</p>\n\n<pre><code>ws.Columns(\"D:D\").Select\nSelection.replace What:=\"In*\", Replacement:=\"Scheduled to work\", LookAt:=xlPart _\n    , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 36309364, "answer_count": 1, "score": 0, "last_activity_date": 1459343207, "creation_date": 1459340828, "last_edit_date": 1459343207, "question_id": 36308853, "link": "https://stackoverflow.com/questions/36308853/replace-text-when-part-of-condition-is-met", "title": "Replace text when part of condition is met", "body": "<p>Hey I have an excel sheet that runs some VBA to find a cell that contains certain text and then replaces is with new text. What I want to happen is anytime in the column the program sees the word \"In\" it replaces the cell value with \"Scheduled to work\" the issue I have though is the original cell value is not only \"In\" it also contains a time that is dynamic. Is there a way I can still replace the cells that contain \"If\" and different times? I have the code written below but I do not know how to alter it to cells that contain \"In\" as well as a changing time.</p>\n\n<p>Thanks!</p>\n\n<p>Example of what I want:</p>\n\n<p>Current cell: \"In - 12:30\", \"In - 11:45\", etc.\nFuture cell: \"Scheduled to work\"</p>\n\n<pre><code>ws.Columns(\"D:D\").Select\nSelection.replace What:=\"In\", Replacement:=\"Scheduled to work\", LookAt:=xlPart _\n    , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=Falseenter code here\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "userform"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1459340555, "last_edit_date": 1495542692, "creation_date": 1459340555, "answer_id": 36308761, "question_id": 36308491, "link": "https://stackoverflow.com/questions/36308491/reference-an-array-declared-in-a-different-userform/36308761#36308761", "title": "Reference an array declared in a different userform", "body": "<p>The main problem is that array contents are cleared after the sub is finished.</p>\n\n<p>I was also messing around with this idea and there is a really good thread I started with tons of great information from various awesome people</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35458356/calling-an-array-upon-user-form-terminate-close-vba\">Calling an Array Upon User Form Terminate/Close VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1459341947, "creation_date": 1459341947, "answer_id": 36309303, "question_id": 36308491, "link": "https://stackoverflow.com/questions/36308491/reference-an-array-declared-in-a-different-userform/36309303#36309303", "title": "Reference an array declared in a different userform", "body": "<p>Forms in VBA are Objects, and can be treated like any other Class module.  This means that you can add properties to them.  If you need to pass information back from a form, all you need to do is grab a reference to it, then <code>Hide</code> it instead of <code>Unload</code> it.  Treat it like a dialog and let the calling code handle it's create and destruction (I'm assuming from your code that it is modal).</p>\n\n<p>Something like this:</p>\n\n<p>In the first UserForm:</p>\n\n<pre><code>For i = 0 To 1\n    Dim second As frmGameDataSecondary\n    Set second = New frmGameDataSecondary\n    second.Show\n    'Execution suspends until the second form is dismissed.\n    selectedPlayers(i) = second.Player\n    Unload second\nNext i\n</code></pre>\n\n<p>In the second UserForm:</p>\n\n<pre><code>Private mPlayer As String\n\n'This is where your returned information goes.\nPublic Property Get Player() As String\n    Player = mPlayer\nEnd Property\n\nPrivate Sub cmdDone_Click()\n    mPlayer = lbxPlayer.Value\n    'Control passes back to the caller, but the object still exists.\n    Me.Hide\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1459371056, "creation_date": 1459371056, "answer_id": 36319448, "question_id": 36308491, "link": "https://stackoverflow.com/questions/36308491/reference-an-array-declared-in-a-different-userform/36319448#36319448", "title": "Reference an array declared in a different userform", "body": "<p>You can declare properties inside of <code>parent form</code> which will manipulate the array from outside. The <code>child form</code> needs to have a reference to <code>parent</code> so it can call this properties. HTH</p>\n\n<blockquote>\n  <p>Parent form</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\n' I have not been able to access the primary userform's\n' 'i' and 'selectedPlayers' from the secondary one\nPrivate selectedPlayers As Variant\n\nPublic Function GetMyArrayValue(index) As Variant\n    GetMyArrayValue = selectedPlayers(index)\nEnd Function\n\nPublic Sub SetMyArrayValue(index, newValue)\n    selectedPlayers(index) = newValue\nEnd Sub\n\nPrivate Sub UserForm_Click()\n    Dim i\n\n    i = 0\n    Do While Not i = Int(txtNumberPlayers)\n        With New secondaryUserForm\n            Set .ParentForm = Me\n            .SetIndex = i\n            .Show\n        End With\n        i = i + 1\n    Loop\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    selectedPlayers = Array(\"A\", \"B\", \"C\")\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Child form</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPrivate m_parent As primaryUserForm\nPrivate m_index As Integer\n\nPublic Property Let SetIndex(ByVal vNewValue As Integer)\n    m_index = vNewValue\nEnd Property\n\nPublic Property Set ParentForm(ByVal vNewValue As UserForm)\n    Set m_parent = vNewValue\nEnd Property\n\nPrivate Sub cmdDone_Click()\n    ' frmGameData.selectedPlayers(frmGameData.i) = lbxPlayer.Value\n    m_parent.SetMyArrayValue m_index, \"lbxPlayer.Value\"\n    Unload Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4329502, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WFXb_4y9Wb4/AAAAAAAAAAI/AAAAAAAAAE8/u-O78AckZm4/photo.jpg?sz=128", "display_name": "Fred A. L.", "link": "https://stackoverflow.com/users/4329502/fred-a-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1459371056, "creation_date": 1459339861, "last_edit_date": 1531164843, "question_id": 36308491, "link": "https://stackoverflow.com/questions/36308491/reference-an-array-declared-in-a-different-userform", "title": "Reference an array declared in a different userform", "body": "<p>I'm not an experienced VBA programmer but I've been trying to create an Excel Spreadsheet that is able to manage a basketball team.</p>\n\n<p>In it I've got a primary userform where I have declared an array, 'selectedPlayers'. \nThis primary userform has a for loop that starts up the secondary userform 'i' times. </p>\n\n<p>I have not been able to access the primary userform's 'i' and 'selectedPlayers' from the secondary one. \nI've been able to find a workaround the 'i' by creating a non-visible textbox in the first userform, that I'm able to reference from the second one.</p>\n\n<p>I've tried declaring both of them as public, but yet I'm not able to call upon it from the second userform.</p>\n\n<p>part of the code for the first userform:</p>\n\n<pre><code>i = 0\nDo While Not i = Int(txtNumberPlayers)\n    frmGameDataSecondary.Show\n    i = i + 1\nLoop\n</code></pre>\n\n<p>second userform:</p>\n\n<pre><code>Private Sub cmdDone_Click()\n    frmGameData.selectedPlayers(frmGameData.i) = lbxPlayer.Value\n    Unload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    With Me.lbxPlayer\n\n    For Each LR In LO.ListRows\n        exitSequence = False\n\n        For k = 1 To Int(frmGameData.txtNumberPlayers)\n            If frmGameData.selectedPlayers(k) = blablabla.Value Then\n                exitSequence = True\n            End If\n        Next k\n\n        If !exitSequence Then\n            .AddItem blablabla.Value\n        End If\n\n    Next LR\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1459344316, "post_id": 36308251, "comment_id": 60243699, "body": "your code creates a text file?"}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459369861, "post_id": 36308251, "comment_id": 60261546, "body": "Additional Q: Is this more or less everything you need to do? If so, you could do it with VLookup() without VBA."}, {"owner": {"reputation": 137, "user_id": 5250708, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5240af983dd2e3813e3f04634fe661f7?s=128&d=identicon&r=PG&f=1", "display_name": "love mam", "link": "https://stackoverflow.com/users/5250708/love-mam"}, "edited": false, "score": 0, "creation_date": 1459582002, "post_id": 36308251, "comment_id": 60359546, "body": "I am new bee...I am tried but i dont know how to get vlookup with in the same work sheet without vba"}], "owner": {"reputation": 137, "user_id": 5250708, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5240af983dd2e3813e3f04634fe661f7?s=128&d=identicon&r=PG&f=1", "display_name": "love mam", "link": "https://stackoverflow.com/users/5250708/love-mam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461271304, "creation_date": 1459339269, "last_edit_date": 1531164843, "question_id": 36308251, "link": "https://stackoverflow.com/questions/36308251/get-vlookup-and-check-whether-the-value-is-available-or-not", "title": "Get vlookup and check whether the value is available or not?", "body": "<p>I'm new trying to write vba code using vb. I wrote this code using vba tutorial. Now I have tried to write sample code for output as followed:</p>\n\n<p>Also I am trying to shortcut key for to create macro in vba</p>\n\n<pre><code>Sheet 1\nColumn B\n123456\n\nColumn E\n20/3/2000\n\n\nSheet2\nColumn A\n123456\n\nColumn D\n25/3/2000\n</code></pre>\n\n<p>I am trying to check whether the date is available in sheet2 for \"123456\" or if it is not available in sheet 2. I have to create output for \"123456\".\nOutput should be column like</p>\n\n<pre><code>ColumnA\n123456\nColumnB\n20/3/2000\nColumnC\n2\n</code></pre>\n\n<p>My code is :</p>\n\n<pre><code>Sub Button1_Click()\nDim ColNum As Integer\nDim Line As String\nDim LineValues() As Variant\nDim OutputFileNum As Integer\nDim PathName As String\nDim RowNum As Integer\nDim SheetValues() As Variant\nDim rngNums As Range\nDim cmpny As Range\nDim v As Long\nDim ws As Worksheet\nDim result As Variant\nDim c As Range, nm As Range\n\nPathName = Application.ActiveWorkbook.Path\nOutputFileNum = FreeFile\n\nOpen PathName &amp; \"\\test.csv\" For Output Lock Write As #OutputFileNum\n\nPrint #OutputFileNum, \"test1\" &amp; \",\" &amp; \"test2 (dd/MM/yyyy)\" &amp; \",\" &amp; \"test3\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "edited": false, "score": 0, "creation_date": 1459341900, "post_id": 36308785, "comment_id": 60241737, "body": "Thank you very much for your help. I added the code, but it seems to work only when I click on cell and Change its Color. When it Auto updates new prices it doesnt seem to work."}, {"owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "reply_to_user": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "edited": false, "score": 0, "creation_date": 1459342650, "post_id": 36308785, "comment_id": 60242296, "body": "The worksheet change event only fires when the actual values on the sheet change. I presume that your values are auto updating via a formula of some kind? If you can post some detail on the mechanism by which the price values are updating I can see if there&#39;s another method I can think of to higlight the changes."}, {"owner": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "edited": false, "score": 0, "creation_date": 1459343048, "post_id": 36308785, "comment_id": 60242652, "body": "Yes, there is a formula used which takes values from column Headlines and Returns exact prices. So, formula doesnt Change, only values. It is same if I write formula on E10 column , for example, this =A10. And if i write on a10 , lets say, 1000 and Change it to 1500, nothing will happen on E10. value will Change, but Background Color will not."}, {"owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "reply_to_user": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "edited": false, "score": 0, "creation_date": 1459353396, "post_id": 36308785, "comment_id": 60251174, "body": "Updated my answer with something that may work for you - although not a particularly elegant solution."}, {"owner": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "edited": false, "score": 0, "creation_date": 1459423337, "post_id": 36308785, "comment_id": 60285883, "body": "You are Genius, thank you so much !!! It works. Just one more question, I already have each 2nd row different black and Grey shade Color, so I would like it to remain like that. When value changes, Background changes Color to White (same as now) and after that it Returns to original color. Is it possible or I have to assign each cell a same Color index ? Thanks once again. :)"}, {"owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "reply_to_user": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "edited": false, "score": 0, "creation_date": 1459439473, "post_id": 36308785, "comment_id": 60298147, "body": "Yep, that&#39;s do-able. We simply assign the original ColorIndex value to a variable before we change it and then use the variable to change it back when we&#39;re done. Answer updated."}], "tags": [], "owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1459439402, "last_edit_date": 1459439402, "creation_date": 1459340630, "answer_id": 36308785, "question_id": 36308049, "link": "https://stackoverflow.com/questions/36308049/vba-macro-to-change-color-of-cell-that-changes-value-for-1-second/36308785#36308785", "title": "VBA macro to change color of cell that changes value for 1 second", "body": "<p>Add this into the code of the worksheet you want it to apply to (not in a seperate module) for a 1 second colour change when any cell in column E or F changes:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"E:F\")) Is Nothing Then\n        Target.Interior.ColorIndex = 2\n        Application.Wait (Now + #0:00:01#)\n        Target.Interior.ColorIndex = 46\n    End If\nEnd Sub\n</code></pre>\n\n<p>Or for less than 1 second change, use the version below as <code>application.wait</code> doesn't handle times any finer than 1 second, but <code>timer</code> does.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"E:F\")) Is Nothing Then\n        Dim x As Single\n        x = Timer\n            While Timer - x &lt; 0.5\n                Target.Interior.ColorIndex = 2\n            Wend\n                Target.Interior.ColorIndex = 46\n    End If\nEnd Sub\n</code></pre>\n\n<p>The ColorIndex values are for white and default orange. To change to the particular colors you're looking for, see <a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow\">http://dmcritchie.mvps.org/excel/colors.htm</a></p>\n\n<p>EDIT - New answer below. Original answer above.</p>\n\n<p>Ok, this is a bit of a messy way around it but should achieve what you're looking to do.</p>\n\n<p>Paste this into a module, adjusting the 1 to 10 to cover the number of cells you're watching for changes in:</p>\n\n<pre><code>Public val(1 To 10) As Variant\n</code></pre>\n\n<p>Paste this into your ThisWorkbook code area, adjusting the cell references so every ref you're watching is included in the correct ascending order (Column E lowest to highest, then Column F lowest to highest):</p>\n\n<pre><code>Private Sub Workbook_Open()\n    val(1) = Sheet1.Range(\"E1\").Value\n    val(2) = Sheet1.Range(\"E2\").Value\n    val(3) = Sheet1.Range(\"E3\").Value\n    val(4) = Sheet1.Range(\"E4\").Value\n    val(5) = Sheet1.Range(\"E5\").Value\n    val(6) = Sheet1.Range(\"F1\").Value\n    val(7) = Sheet1.Range(\"F2\").Value\n    val(8) = Sheet1.Range(\"F3\").Value\n    val(9) = Sheet1.Range(\"F4\").Value\n    val(10) = Sheet1.Range(\"F5\").Value\nEnd Sub\n</code></pre>\n\n<p>Finally, paste this into the code area of the sheet with the values you're watching for changes, again adjusting the ranges to fit your watch range:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim x As Single, colIndx As Integer\ni = 1\n\n    For Each cell In Range(\"E1:E5\")\n        If cell.Value &lt;&gt; val(i) Then\n            colIndx = cell.Interior.ColorIndex\n            x = Timer\n            While Timer - x &lt; 0.5\n                cell.Interior.ColorIndex = 2\n            Wend\n            cell.Interior.ColorIndex = colIndx\n            val(i) = cell.Value\n        End If\n        i = i + 1\n    Next cell\n\n    For Each cell In Range(\"F1:F5\")\n        If cell.Value &lt;&gt; val(i) Then\n            colIndx = cell.Interior.ColorIndex\n            x = Timer\n            While Timer - x &lt; 0.5\n                cell.Interior.ColorIndex = 2\n            Wend\n            cell.Interior.ColorIndex = colIndx\n            val(i) = cell.Value\n        End If\n        i = i + 1\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>Finally save and close your workbook and re-open it and hopefully the colours should update along with the values.</p>\n"}], "owner": {"reputation": 3, "user_id": 6134483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20103d08ddc3810e604b4b697e32331?s=128&d=identicon&r=PG&f=1", "display_name": "JustSomeExcelVbathings", "link": "https://stackoverflow.com/users/6134483/justsomeexcelvbathings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4229, "favorite_count": 0, "accepted_answer_id": 36308785, "answer_count": 1, "score": 0, "last_activity_date": 1459439402, "creation_date": 1459338789, "last_edit_date": 1459340089, "question_id": 36308049, "link": "https://stackoverflow.com/questions/36308049/vba-macro-to-change-color-of-cell-that-changes-value-for-1-second", "title": "VBA macro to change color of cell that changes value for 1 second", "body": "<p>I am working on Excel Project and I am dealing with prices that are changing live and are taken from external source in column E and F. </p>\n\n<p>What I want is :</p>\n\n<ol>\n<li>When These cells Change value, I want them to Change its Color from orange to lets say White, or Change cell Background to White</li>\n<li>I want this to happen only for 1 second or less, and to revert back to original cell Color or Background Color</li>\n</ol>\n\n<p>This way I can Keep my eye on prices when they Change.</p>\n\n<p>Is this possible ?</p>\n\n<p>Please help. thanks</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3360, "user_id": 2165382, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GfUXc.png?s=128&g=1", "display_name": "Rafique Mohammed", "link": "https://stackoverflow.com/users/2165382/rafique-mohammed"}, "edited": false, "score": 0, "creation_date": 1459338594, "post_id": 36307800, "comment_id": 60239337, "body": "you have tagged &quot;javascript&quot; so post some code what u have tried"}, {"owner": {"reputation": 1, "user_id": 6085340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-auFXRbQctnQ/AAAAAAAAAAI/AAAAAAAAAHg/62jrKf70hxg/photo.jpg?sz=128", "display_name": "Punit Kapadia", "link": "https://stackoverflow.com/users/6085340/punit-kapadia"}, "reply_to_user": {"reputation": 3360, "user_id": 2165382, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GfUXc.png?s=128&g=1", "display_name": "Rafique Mohammed", "link": "https://stackoverflow.com/users/2165382/rafique-mohammed"}, "edited": false, "score": 0, "creation_date": 1459340980, "post_id": 36307800, "comment_id": 60241019, "body": "<a href=\"https://en.wikibooks.org/wiki/Algorithm_Implementation/Checksums/Verhoeff_Algorithm#JavaScript\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Algorithm_Implementation/Checksums/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 6085340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-auFXRbQctnQ/AAAAAAAAAAI/AAAAAAAAAHg/62jrKf70hxg/photo.jpg?sz=128", "display_name": "Punit Kapadia", "link": "https://stackoverflow.com/users/6085340/punit-kapadia"}, "reply_to_user": {"reputation": 3360, "user_id": 2165382, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GfUXc.png?s=128&g=1", "display_name": "Rafique Mohammed", "link": "https://stackoverflow.com/users/2165382/rafique-mohammed"}, "edited": false, "score": 0, "creation_date": 1459341007, "post_id": 36307800, "comment_id": 60241036, "body": "I found a query here for Javascript.. but do not have much clue on how to use it."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1459342102, "post_id": 36307800, "comment_id": 60241890, "body": "You found the JavaScript version, but there is also a <a href=\"https://en.wikibooks.org/wiki/Algorithm_Implementation/Checksums/Verhoeff_Algorithm#VB_for_Applications\" rel=\"nofollow noreferrer\">VBA version</a> from the same source. Once you copied that code into a VBA module you could use the <code>validateVerhoeff()</code> function in an Access query."}, {"owner": {"reputation": 1, "user_id": 6085340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-auFXRbQctnQ/AAAAAAAAAAI/AAAAAAAAAHg/62jrKf70hxg/photo.jpg?sz=128", "display_name": "Punit Kapadia", "link": "https://stackoverflow.com/users/6085340/punit-kapadia"}, "edited": false, "score": 0, "creation_date": 1459345683, "post_id": 36307800, "comment_id": 60244845, "body": "I used the VBA script given in the link. However, i am getting only random values ie. 0 &amp; -1 . Eg; for 97424234030..the validation checksum is 7 however, the query gives the result as -1.  Is the execution wrong? Can you kindly test this sample number with the given query on the link."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1459348487, "post_id": 36307800, "comment_id": 60247337, "body": "<code>validateVerhoeff()</code> returns a Boolean (0=False, -1=True) indicating whether the supplied string is valid. If you want to generate the checksum digit you need to use <code>generateVerhoeff()</code>. I just tested it and <code>generateVerhoeff(&quot;97424234030&quot;)</code> does indeed return <code>7</code>."}, {"owner": {"reputation": 1, "user_id": 6085340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-auFXRbQctnQ/AAAAAAAAAAI/AAAAAAAAAHg/62jrKf70hxg/photo.jpg?sz=128", "display_name": "Punit Kapadia", "link": "https://stackoverflow.com/users/6085340/punit-kapadia"}, "edited": false, "score": 0, "creation_date": 1459393118, "post_id": 36307800, "comment_id": 60269642, "body": "Actually worked...Thanks a ton..!!"}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 2251364, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c387b641bba38ce5779f088c8f24ebdf?s=128&d=identicon&r=PG", "display_name": "Hritik", "link": "https://stackoverflow.com/users/2251364/hritik"}, "is_accepted": false, "score": 1, "last_activity_date": 1578487954, "creation_date": 1578487954, "answer_id": 59646319, "question_id": 36307800, "link": "https://stackoverflow.com/questions/36307800/uid-validation-verhoeffs-algorithm/59646319#59646319", "title": "UID Validation - Verhoeff&#39;s Algorithm", "body": "<p>As mentioned by <a href=\"https://stackoverflow.com/users/2144390/gord-thompson\">Gord Thempson</a> in the comments, you can find the VBA (and many more implementation on the <a href=\"https://en.wikibooks.org/wiki/Algorithm_Implementation/Checksums/Verhoeff_Algorithm#VB_for_Applications\" rel=\"nofollow noreferrer\">Wikipedia page</a></p>\n\n<p>For the sake of completeness, </p>\n\n<pre><code>''' &lt;summary&gt;\n''' For more information cf. http://en.wikipedia.org/wiki/Verhoeff_algorithm\n''' Dihedral Group: http://mathworld.wolfram.com/DihedralGroup.html\n''' You can use this code in Excel, Access, etc...\n''' &lt;/summary&gt;\n''' &lt;remarks&gt;&lt;/remarks&gt;\n\n'The multiplication table\nDim d(0 To 9) As Variant\n'The permutation table\nDim p(0 To 8) As Variant\n'The inverse table\nDim inv(0 To 9) As Integer\n\nPrivate Sub initVerhoeffConsts()\n    If IsArray(d(0)) Then Exit Sub 'Shortcut if already initiated\n    d(0) = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)\n    d(1) = Array(1, 2, 3, 4, 0, 6, 7, 8, 9, 5)\n    d(2) = Array(2, 3, 4, 0, 1, 7, 8, 9, 5, 6)\n    d(3) = Array(3, 4, 0, 1, 2, 8, 9, 5, 6, 7)\n    d(4) = Array(4, 0, 1, 2, 3, 9, 5, 6, 7, 8)\n    d(5) = Array(5, 9, 8, 7, 6, 0, 4, 3, 2, 1)\n    d(6) = Array(6, 5, 9, 8, 7, 1, 0, 4, 3, 2)\n    d(7) = Array(7, 6, 5, 9, 8, 2, 1, 0, 4, 3)\n    d(8) = Array(8, 7, 6, 5, 9, 3, 2, 1, 0, 4)\n    d(9) = Array(9, 8, 7, 6, 5, 4, 3, 2, 1, 0)\n\n    p(0) = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)\n    p(1) = Array(1, 5, 7, 6, 2, 8, 3, 0, 9, 4)\n    p(2) = Array(5, 8, 0, 3, 7, 9, 6, 1, 4, 2)\n    p(3) = Array(8, 9, 1, 6, 0, 4, 3, 5, 2, 7)\n    p(4) = Array(9, 4, 5, 3, 1, 2, 6, 8, 7, 0)\n    p(5) = Array(4, 2, 8, 6, 5, 7, 3, 9, 0, 1)\n    p(6) = Array(2, 7, 9, 3, 8, 0, 6, 4, 1, 5)\n    p(7) = Array(7, 0, 4, 6, 9, 1, 3, 2, 5, 8)\n\n    inv(0) = 0: inv(1) = 4: inv(2) = 3: inv(3) = 2: inv(4) = 1\n    inv(5) = 5: inv(6) = 6: inv(7) = 7: inv(8) = 8: inv(9) = 9\nEnd Sub\n\n\n''' &lt;summary&gt;\n''' Validates that an entered number is Verhoeff compliant.\n''' &lt;/summary&gt;\n''' &lt;param name=\"num\"&gt;&lt;/param&gt;\n''' &lt;returns&gt;True if Verhoeff compliant, otherwise false&lt;/returns&gt;\n''' &lt;remarks&gt;Make sure the check digit is the last one!&lt;/remarks&gt;\nPublic Function validateVerhoeff(ByVal num As String) As Boolean\n        initVerhoeffConsts\n        Dim c As Integer\n        Dim i As Integer\n        c = 0\n        Dim myArray() As Integer\n        myArray = StringToReversedIntArray(num)\n\n        For i = 0 To UBound(myArray)\n            c = d(c)(p((i Mod 8))(myArray(i)))  'Version corrected by WHG gives error\n        Next i\n\n        validateVerhoeff = (c = 0)\nEnd Function\n\n\n''' &lt;summary&gt;\n''' For a given number generates a Verhoeff digit\n''' &lt;/summary&gt;\n''' &lt;param name=\"num\"&gt;&lt;/param&gt;\n''' &lt;returns&gt;Verhoeff check digit as Integer&lt;/returns&gt;\n''' &lt;remarks&gt;Append this check digit to num&lt;/remarks&gt;\nPublic Function generateVerhoeff(ByVal num As String) As Integer\n    initVerhoeffConsts\n    Dim c As Integer\n    Dim i As Integer    \n    c = 0\n    Dim myArray() As Integer\n    myArray = StringToReversedIntArray(num)\n\n    For i = 0 To UBound(myArray)\n        c = d(c)(p((i + 1) Mod 8)(myArray(i)))   'Version corrected by WHG gives error in compilation\n    Next i\n\n    generateVerhoeff = inv(c) 'str(inv(c))\nEnd Function\n\n\n''' &lt;summary&gt;\n''' Converts a string to a reversed integer array.\n''' &lt;/summary&gt;\n''' &lt;param name=\"str\"&gt;&lt;/param&gt;\n''' &lt;returns&gt;Reversed integer array&lt;/returns&gt;\n''' &lt;remarks&gt;&lt;/remarks&gt;\nPrivate Function StringToReversedIntArray(ByVal str As String) As Integer()\n    Dim lg As Integer\n    lg = Len(str)\n    Dim myArray() As Integer\n    ReDim myArray(0 To lg - 1)\n    Dim i As Integer\n\n    For i = 0 To lg - 1\n        myArray(i) = AscW(Mid$(str, lg - i, 1)) - AscW(\"0\")\n    Next\n    StringToReversedIntArray = myArray\nEnd Function\n\n''' In Excel don't copy this sub _AssertsVerhoeff()as get a compilation error. 4/21/2013\nPublic Sub _AssertsVerhoeff()\n    Debug.Print \"Start Verhoeff's Asserts\"\n    Debug.Assert generateVerhoeff(\"75872\") = 2\n    Debug.Assert validateVerhoeff(\"758722\") = True\n    Debug.Assert generateVerhoeff(\"12345\") = 1\n    Debug.Assert validateVerhoeff(\"123451\") = True\n    Debug.Assert generateVerhoeff(\"142857\") = 0\n    Debug.Assert validateVerhoeff(\"1428570\") = True\n    Debug.Assert generateVerhoeff(\"123456789012\") = 0\n    Debug.Assert validateVerhoeff(\"1234567890120\") = True\n    Debug.Assert generateVerhoeff(\"8473643095483728456789\") = 2\n    Debug.Assert validateVerhoeff(\"84736430954837284567892\") = True\n    Debug.Assert generateVerhoeff(\"12345\") = 1\n    Debug.Assert validateVerhoeff(\"123451\") = True\n    Debug.Assert validateVerhoeff(\"124351\") = False\n    Debug.Assert validateVerhoeff(\"122451\") = False\n    Debug.Assert validateVerhoeff(\"128451\") = False\n    Debug.Assert validateVerhoeff(\"214315\") = False\n    Debug.Print \"End Verhoeff's Asserts\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6085340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-auFXRbQctnQ/AAAAAAAAAAI/AAAAAAAAAHg/62jrKf70hxg/photo.jpg?sz=128", "display_name": "Punit Kapadia", "link": "https://stackoverflow.com/users/6085340/punit-kapadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1432, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582089004, "creation_date": 1459338205, "last_edit_date": 1582089004, "question_id": 36307800, "link": "https://stackoverflow.com/questions/36307800/uid-validation-verhoeffs-algorithm", "title": "UID Validation - Verhoeff&#39;s Algorithm", "body": "<p>I am using MS Access &amp; SQL. </p>\n\n<p>I wish to validate 0.1 Mn UID Numbers (Aadhar Cards) for their authenticity.</p>\n\n<p>The UID is based on Verhoeff's Algorithm.</p>\n\n<p>I did find some queries online. They pertained to C++/Java.</p>\n\n<p>Is there a query which validates 0.1 Mn in MS Access for SQL?</p>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "edited": false, "score": 0, "creation_date": 1459338664, "post_id": 36307625, "comment_id": 60239385, "body": "Why is the data type not set to Date/Time? And is this an MS Access problem?"}, {"owner": {"reputation": 791, "user_id": 5581135, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/840ae9db78140f4fed77d9b2dc1d0db0?s=128&d=identicon&r=PG&f=1", "display_name": "Shanka", "link": "https://stackoverflow.com/users/5581135/shanka"}, "edited": false, "score": 0, "creation_date": 1459338895, "post_id": 36307625, "comment_id": 60239566, "body": "The datatype is determined by the first value under the header.. So in the second instance, DateWorked will be considered as a String because the first value is &#39;Not worked&#39;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "edited": false, "score": 0, "creation_date": 1459339007, "post_id": 36307625, "comment_id": 60239655, "body": "OK. But is this purely an Excel problem? What database are you using?"}, {"owner": {"reputation": 791, "user_id": 5581135, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/840ae9db78140f4fed77d9b2dc1d0db0?s=128&d=identicon&r=PG&f=1", "display_name": "Shanka", "link": "https://stackoverflow.com/users/5581135/shanka"}, "edited": false, "score": 0, "creation_date": 1459341291, "post_id": 36307625, "comment_id": 60241266, "body": "This is all in Excel using VBA. No database."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1459344656, "post_id": 36307625, "comment_id": 60243982, "body": "Have you tried wrapping it up, something like (select YOUR QUERY from (select * from XYZ where dateworked&lt;&gt;&quot;Not Worked&quot;))"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459351025, "post_id": 36307625, "comment_id": 60249265, "body": "What Shanka says about the first row under the column header is actually the way data connections to Excel work: that first row (or first few rows) determines the data type. One way to work around this is to have a &quot;dummy&quot; record in the first row with the correct data type. If you <i>know</i> that first record shouldn&#39;t be processed that shouldn&#39;t be a problem? The other way to approach this is to edit the connection string to use IMEX=1."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459351029, "post_id": 36307625, "comment_id": 60249269, "body": "For reference, see <a href=\"https://www.connectionstrings.com/excel/\" rel=\"nofollow noreferrer\">connectionstrings.com/excel</a>, <a href=\"http://microsoft-ssis.blogspot.ch/2011/06/mixed-data-types-in-excel-column.html\" rel=\"nofollow noreferrer\">microsoft-ssis.blogspot.ch/2011/06/&hellip;</a>, <a href=\"http://blog.concentra.co.uk/2013/05/15/why-ssis-always-gets-excel-data-types-wrong-and-how-to-fix-it/\" rel=\"nofollow noreferrer\">blog.concentra.co.uk/2013/05/15/&hellip;</a>, <a href=\"http://stackoverflow.com/questions/3595131/i-need-a-workaround-for-excel-guessing-data-types-problem\" title=\"i need a workaround for excel guessing data types problem\">stackoverflow.com/questions/3595131/&hellip;</a>"}, {"owner": {"reputation": 791, "user_id": 5581135, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/840ae9db78140f4fed77d9b2dc1d0db0?s=128&d=identicon&r=PG&f=1", "display_name": "Shanka", "link": "https://stackoverflow.com/users/5581135/shanka"}, "edited": false, "score": 0, "creation_date": 1460015924, "post_id": 36307625, "comment_id": 60550872, "body": "Thank you all for the tips and links. I applied the work around of inserting a dummy row with the correct data type as suggested by Cindy."}], "owner": {"reputation": 791, "user_id": 5581135, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/840ae9db78140f4fed77d9b2dc1d0db0?s=128&d=identicon&r=PG&f=1", "display_name": "Shanka", "link": "https://stackoverflow.com/users/5581135/shanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 527, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459337714, "creation_date": 1459337714, "question_id": 36307625, "link": "https://stackoverflow.com/questions/36307625/excel-vba-adodb-datatype-selection", "title": "Excel VBA ADODB DataType selection", "body": "<p>I have a data set in MS Excel 2013 which looks like this:</p>\n\n<pre><code>+------+------------+----------------+\n| Name | DateWorked | HoursCompleted |\n+------+------------+----------------+\n| abc  | 03/01/2016 | 4:53           |\n| abc  | 03/02/2016 | 5:22           |\n| ghi  | 03/03/2016 | 2:10           |\n| jkl  | 03/04/2016 | 5:30           |\n| mno  | 03/05/2016 | 4:20           |\n| pqr  | 03/06/2016 | 0:20           |\n+------+------------+----------------+\n</code></pre>\n\n<p>where <code>Name</code> is string, <code>DateWorked</code> is mm/dd/yyyy, <code>HoursCompleted</code> is h:mm data type/format.</p>\n\n<p>I am using ADODB to get some results out this data, storing it in a ADODB.Recordset and displaying in another sheet.</p>\n\n<p>My code/query looks something like this:</p>\n\n<pre><code>countCommand.CommandText = \"SELECT SUM([HoursCompleted]) FROM [Sheet1$] WHERE [Name] = 'abc' AND [DateWorked] BETWEEN #02/28/2016# AND #03/02/2016#\"\n\nSet countResults = countCommand.Execute\n</code></pre>\n\n<p>Now this works like a charm and gives me a result of <code>10:15</code>.</p>\n\n<p><strong>However if the first value under <code>DateWorked</code> is NOT a <code>Date</code> datatype then I am not getting the result. For example, if my data looks like this:</strong></p>\n\n<pre><code>+------+------------+----------------+\n| Name | DateWorked | HoursCompleted |\n+------+------------+----------------+\n| abc  | Not worked | 0:00           |\n| abc  | 03/02/2016 | 5:22           |\n| ghi  | 03/03/2016 | 2:10           |\n| jkl  | 03/04/2016 | 5:30           |\n| mno  | 03/05/2016 | 4:20           |\n| pqr  | 03/06/2016 | 0:20           |\n+------+------------+----------------+\n</code></pre>\n\n<p>How do I set the datatype for my columns?</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "solver"], "comments": [{"owner": {"reputation": 436, "user_id": 1752816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079adddb5b9ce83b620808d7ba50070d?s=128&d=identicon&r=PG", "display_name": "oortCloud", "link": "https://stackoverflow.com/users/1752816/oortcloud"}, "edited": false, "score": 1, "creation_date": 1459336399, "post_id": 36307000, "comment_id": 60237802, "body": "I recall having the same problem a while ago, and remember there is a way to use solver in VBA. Hopefully this helps: <a href=\"http://peltiertech.com/Excel/SolverVBA.html\" rel=\"nofollow noreferrer\">peltiertech.com/Excel/SolverVBA.html</a>"}, {"owner": {"reputation": 996, "user_id": 5257342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/853e0927481c25d437a7133e4c94bda1?s=128&d=identicon&r=PG", "display_name": "Trajan", "link": "https://stackoverflow.com/users/5257342/trajan"}, "reply_to_user": {"reputation": 436, "user_id": 1752816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079adddb5b9ce83b620808d7ba50070d?s=128&d=identicon&r=PG", "display_name": "oortCloud", "link": "https://stackoverflow.com/users/1752816/oortcloud"}, "edited": false, "score": 0, "creation_date": 1459336636, "post_id": 36307000, "comment_id": 60237965, "body": "I have added the add-in into my Excel,. not sure how to reference it though and the article you linked is an older version of excel"}, {"owner": {"reputation": 996, "user_id": 5257342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/853e0927481c25d437a7133e4c94bda1?s=128&d=identicon&r=PG", "display_name": "Trajan", "link": "https://stackoverflow.com/users/5257342/trajan"}, "reply_to_user": {"reputation": 436, "user_id": 1752816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079adddb5b9ce83b620808d7ba50070d?s=128&d=identicon&r=PG", "display_name": "oortCloud", "link": "https://stackoverflow.com/users/1752816/oortcloud"}, "edited": false, "score": 0, "creation_date": 1468160721, "post_id": 36307000, "comment_id": 64002932, "body": "I struggle to understand why this has been downvoted considering it is a nontrivial problem to solve."}, {"owner": {"reputation": 996, "user_id": 5257342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/853e0927481c25d437a7133e4c94bda1?s=128&d=identicon&r=PG", "display_name": "Trajan", "link": "https://stackoverflow.com/users/5257342/trajan"}, "reply_to_user": {"reputation": 436, "user_id": 1752816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079adddb5b9ce83b620808d7ba50070d?s=128&d=identicon&r=PG", "display_name": "oortCloud", "link": "https://stackoverflow.com/users/1752816/oortcloud"}, "edited": false, "score": 0, "creation_date": 1507405735, "post_id": 36307000, "comment_id": 80199430, "body": "Clearly 265 other people were also interested in this nontrivial problem"}], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 5257342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/853e0927481c25d437a7133e4c94bda1?s=128&d=identicon&r=PG", "display_name": "Trajan", "link": "https://stackoverflow.com/users/5257342/trajan"}, "is_accepted": true, "score": 0, "last_activity_date": 1460159125, "creation_date": 1460159125, "answer_id": 36511040, "question_id": 36307000, "link": "https://stackoverflow.com/questions/36307000/unable-to-record-macros-using-excel-2010-solver/36511040#36511040", "title": "Unable to Record Macros using Excel 2010 Solver", "body": "<p>In Excel 2010:</p>\n\n<p>Open up the Visual Basic window and then click Tools --> References --> then make sure that the SOLVER one is ticked.</p>\n\n<p>Essentially you need to make sure that the Solver library of functions is referenced.</p>\n"}], "owner": {"reputation": 996, "user_id": 5257342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/853e0927481c25d437a7133e4c94bda1?s=128&d=identicon&r=PG", "display_name": "Trajan", "link": "https://stackoverflow.com/users/5257342/trajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 36511040, "answer_count": 1, "score": -1, "last_activity_date": 1460492969, "creation_date": 1459336017, "last_edit_date": 1460492969, "question_id": 36307000, "link": "https://stackoverflow.com/questions/36307000/unable-to-record-macros-using-excel-2010-solver", "title": "Unable to Record Macros using Excel 2010 Solver", "body": "<p>I have been unable to record a macro which should have recorded the Solver in action in Excel 2010. Am I able to do this or am I missing something?</p>\n\n<p>I am able to use Solver manually, if this helps.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 288, "user_id": 1429899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e0186f9aecbca10a97385b3b6a8b9b08?s=128&d=identicon&r=PG", "display_name": "user1429899", "link": "https://stackoverflow.com/users/1429899/user1429899"}, "edited": false, "score": 0, "creation_date": 1459337690, "post_id": 36306874, "comment_id": 60238727, "body": "If you do not know VBA I think it will be better to go to freelance sites and post this as a job and you will get it done very quickly with spending small amount of money. Otherwise please provide what you have tried and where have you stuck."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "edited": false, "score": 0, "creation_date": 1459342104, "post_id": 36308332, "comment_id": 60241892, "body": "Unfortunately I can&#39;t get this method to work. I have created an extra column for this formula in column E, sheet 1, pushing the remaining columns out (F through AA). I have done the same in sheet 2 to avoid data the data overwriting into the wrong cells. When the formula runs, it prompts me to open a file (I assume to have a target to update?) I clicked on the relevant sheet in the workbook but it doesn&#39;t seem to like it, it does the same thing when I try to drag the cell along or down. After that I get an error message from excel telling me to use the insert function option."}, {"owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "reply_to_user": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "edited": false, "score": 0, "creation_date": 1459342748, "post_id": 36308332, "comment_id": 60242373, "body": "Are your sheets named Sheet1 and Sheet2 or something else?"}, {"owner": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "edited": false, "score": 0, "creation_date": 1459342785, "post_id": 36308332, "comment_id": 60242410, "body": "Update -  I had made a mistake when changing the name of &#39;sheet2&#39; for my worksheet, I forgot the commas around the name of the sheet. I also included dollar signs around the Index arrays as they were changing when I was dragging the cell.  Unfortunately though, still not working, there&#39;s no file prompt now but all the cells just read #N/A"}, {"owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "reply_to_user": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "edited": false, "score": 0, "creation_date": 1459354864, "post_id": 36308332, "comment_id": 60252133, "body": "Apologies, that hastily written function most likely won&#39;t work as it&#39;s evaluating each index/match as true/false independently so it will give you some odd results. I&#39;ve updated my answer with a piece of VBA code which should hopefully give you the result you&#39;re after."}, {"owner": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "edited": false, "score": 0, "creation_date": 1459412726, "post_id": 36308332, "comment_id": 60278276, "body": "The VBA works like a dream, and a lot shorter than I thought it would be.  Thank you Harley!"}], "tags": [], "owner": {"reputation": 543, "user_id": 3855578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fb37f4fcdacd8120ce662cfeb91a70ec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley B", "link": "https://stackoverflow.com/users/3855578/harley-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1459354781, "last_edit_date": 1459354781, "creation_date": 1459339445, "answer_id": 36308332, "question_id": 36306874, "link": "https://stackoverflow.com/questions/36306874/overwrite-row-data-in-one-sheet-with-data-from-a-second-sheet-satisfying-4-condi/36308332#36308332", "title": "Overwrite row data in one sheet with data from a second sheet satisfying 4 conditions", "body": "<p>You may be able to do this with a formula rather than using VBA.</p>\n\n<p>Paste this formula into cell E1 of sheet1 if you have no headers:</p>\n\n<pre><code>=IF(AND(A1=INDEX(Sheet2!A:A,MATCH(A1,Sheet2!A:A,FALSE)),B1=INDEX(Sheet2!B:B,MATCH(B1,Sheet2!B:B,FALSE)), C1=INDEX(Sheet2!C:C,MATCH(C1,Sheet2!C:C,FALSE)),D1=INDEX(Sheet2!D:D,MATCH(D1,Sheet2!D:D,FALSE))),INDEX(Sheet2!E:E,MATCH(A1,Sheet2!A:A,FALSE)),\"NO\")\n</code></pre>\n\n<p>Or this one into E2 if you have a header row:</p>\n\n<pre><code>=IF(AND(A2=INDEX(Sheet2!A:A,MATCH(A2,Sheet2!A:A,FALSE)),B2=INDEX(Sheet2!B:B,MATCH(B2,Sheet2!B:B,FALSE)), C2=INDEX(Sheet2!C:C,MATCH(C2,Sheet2!C:C,FALSE)),D2=INDEX(Sheet2!D:D,MATCH(D2,Sheet2!D:D,FALSE))),INDEX(Sheet2!E:E,MATCH(A2,Sheet2!A:A,FALSE)),\"NO\")\n</code></pre>\n\n<p>Then drag that across using the little toggle on the bottom right of the cell as far across sheet1 as you want the columns to come in from your sheet2.</p>\n\n<p>Then highlight the whole row you just created and drag the little toggle at the bottom right as far down the sheet as you have data (or try double clicking the toggle to auto fill down).</p>\n\n<p>I tried this on a small set of data and it seems to work so it should work for your larger data set as long as all possible variations of the 4 columns on sheet1 are available on sheet2 with associated data in the following columns. </p>\n\n<p>If you get a result of \"NO\" in any cell then Excel can't find a row in sheet2 which has the exact combination matching the one on sheet1.</p>\n\n<p>EDIT - UPDATED ANSWER BELOW.</p>\n\n<p>Try this, which is much more likely to work for you.</p>\n\n<pre><code>Sub CopyItOver()\n\nDim sh1 As Worksheet, sh2 As Worksheet\nSet sh1 = Sheets(\"Sheet1\")\nSet sh2 = Sheets(\"Sheet2\")\n\n    For Each c1 In sh1.Range(\"A1\", sh1.Range(\"A1\").End(xlDown))\n        For Each c2 In sh2.Range(\"A1\", sh2.Range(\"A1\").End(xlDown))\n            If c2.Value = c1.Value Then\n                If c2.Offset(0, 1).Value = c1.Offset(0, 1).Value Then\n                    If c2.Offset(0, 2).Value = c1.Offset(0, 2).Value Then\n                        If c2.Offset(0, 3).Value = c1.Offset(0, 3).Value Then\n                            c1.EntireRow.Value = c2.EntireRow.Value\n                        End If\n                    End If\n                End If\n            End If\n        Next c2\n    Next c1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1110, "favorite_count": 0, "accepted_answer_id": 36308332, "answer_count": 1, "score": 0, "last_activity_date": 1459413214, "creation_date": 1459335678, "last_edit_date": 1459413214, "question_id": 36306874, "link": "https://stackoverflow.com/questions/36306874/overwrite-row-data-in-one-sheet-with-data-from-a-second-sheet-satisfying-4-condi", "title": "Overwrite row data in one sheet with data from a second sheet satisfying 4 conditions", "body": "<p>I've looked at several threads and there are some that touch on my problem, however, I've never used VBA and haven't a clue how to change the coding to suit my problem.</p>\n\n<p>I would like to overwrite rows of data on sheet 2 from sheet 1, providing the data in columns A, B, C &amp; D (live data starting row 2) are a match on both sheets 1 &amp; 2.</p>\n\n<p>Essentially sheet 2 is my data store, and sheet 1 is a template of sheet 2. All the possible combinations of data in the first four columns already exist in sheet 2 with the remaining data in the row unknown. So when I get that unknown data, I would like to overwrite that row in sheet 2.</p>\n\n<p>A lot of people have made threads about copying rows over where one specific term is searched for in a column, whereas, I will have many different terms to search for, but as I said, they will need to be a match on both sheets.</p>\n\n<p>Hope I've made sense! Please help!</p>\n"}, {"tags": ["xml", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "is_accepted": false, "score": 1, "last_activity_date": 1459336564, "creation_date": 1459336564, "answer_id": 36307179, "question_id": 36306523, "link": "https://stackoverflow.com/questions/36306523/creating-a-function-excel-vba/36307179#36307179", "title": "Creating a Function - Excel VBA", "body": "<p>Okay I got it to work, I just needed to change this line in the function:</p>\n\n<pre><code>Set xmlElement = xmldoc.DocumentElement\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Set fetchXML = xmldoc.DocumentElement\n</code></pre>\n\n<p>And then change this line in the sub:</p>\n\n<pre><code>fetchXML (coukChannels30DayUrl)\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Set xmlElement = fetchXML(coukChannels30DayUrl)\n</code></pre>\n\n<p>And it's working very nicely, yay for functions.</p>\n"}], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459336564, "creation_date": 1459334760, "last_edit_date": 1459335283, "question_id": 36306523, "link": "https://stackoverflow.com/questions/36306523/creating-a-function-excel-vba", "title": "Creating a Function - Excel VBA", "body": "  \n\n<p>I have some code that makes a HTTP request and fetches an XML from an API before parsing.</p>\n\n<p>The HTTP request part of my code is always the same and the only parameter that changes is the URL I send the request to. I'm wondering if I can therefore convert the request to a Function?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set xmldoc = CreateObject(\"Msxml.DOMDocument\")\nSet httpReq = CreateObject(\"WinHttp.WinHttprequest.5.1\")\nxmldoc.async = False\n\nhttpReq.Open \"GET\", myUrl, False\n\nhttpReq.setRequestHeader \"Content-Type\", \"text/xml\"\n    If Sheet2.proxyStatus = \"ON\" Then\n    httpReq.setProxy 2, Sheet2.proxyServer, \"\"\n    ElseIf Sheet2.proxyStatus = \"OFF\" Then\n    httpReq.setProxy 0, \"\", \"\"\n    End If\nhttpReq.setTimeouts -1, -1, -1, -1\nhttpReq.send request\n\nxmldoc.LoadXML httpReq.responseText\n\nSet xmlElement = xmldoc.DocumentElement\n</code></pre>\n\n<p>After making the request I use some code like this to parse data from the XML:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>TotalSessions = xmlElement.SelectSingleNode(\"//Row[@rowKey='Sessions']/Value[@columnId='SESSIONS']\").Text\n</code></pre>\n\n<p>The code that parses the information can't be included in the function because the nodes that it is looking for and the variables it is assigning are unique and numerous but it needs to be able to read the XML downloaded by the Function obviously.</p>\n\n<p>I have tried creating the Function but I am unsure what type to define it as, so I went with Object:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function fetchXML(url As String) As Object\n\nSet xmldoc = CreateObject(\"Msxml.DOMDocument\")\nSet httpReq = CreateObject(\"WinHttp.WinHttprequest.5.1\")\nxmldoc.async = False\n\nhttpReq.Open \"GET\", url, False\n\nhttpReq.setRequestHeader \"Content-Type\", \"text/xml\"\n    If Sheet2.proxyStatus = \"ON\" Then\n    httpReq.setProxy 2, Sheet2.proxyServer, \"\"\n    ElseIf Sheet2.proxyStatus = \"OFF\" Then\n    httpReq.setProxy 0, \"\", \"\"\n    End If\nhttpReq.setTimeouts -1, -1, -1, -1\nhttpReq.send request\n\nxmldoc.LoadXML httpReq.responseText\n\nSet xmlElement = xmldoc.DocumentElement\n\nEnd Function\n</code></pre>\n\n<p>I have then tried to call the Function and Parse some information:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>fetchXML (coukChannels30DayUrl)\n\ncoukPPCSessionsSS = xmlElement.SelectSingleNode(\"//Row[@rowKey='1#11588418521354:1158842490346']/Value[@columnId='SESSIONS']\").Text\n</code></pre>\n\n<p>But unfortunately it didn't work, am I calling the function wrong? Is it the wrong type? Can I even do this? lol</p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "edited": false, "score": 0, "creation_date": 1459335828, "post_id": 36306433, "comment_id": 60237386, "body": "What have you tried? this is not a place to beg for code/get a whole solution.."}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1459335889, "creation_date": 1459335889, "answer_id": 36306953, "question_id": 36306433, "link": "https://stackoverflow.com/questions/36306433/cell-formula-to-cell-values-for-different-range/36306953#36306953", "title": "Cell formula to cell values for different range", "body": "<p>Its not clear whether your formula is R12=(Q12/P12)/2 or R12=(Q12-P12)/2. So accordingly change your formula as required.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim input1, input2, result As Variant\n    input1 = Application.InputBox(Prompt:=\"Select first cell\", Title:=\"Cell Select\", Type:=8)\n    input2 = Application.InputBox(Prompt:=\"Select second cell\", Title:=\"Cell Select\", Type:=8)\n    result = (input1 - input2) / 2\n    Worksheets(\"Sheet1\").Activate\n    ActiveCell.Value = result\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6130754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a2d5b4802368417f19db6b483586ec?s=128&d=identicon&r=PG&f=1", "display_name": "sabarigiri", "link": "https://stackoverflow.com/users/6130754/sabarigiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459336811, "creation_date": 1459334501, "last_edit_date": 1459336811, "question_id": 36306433, "link": "https://stackoverflow.com/questions/36306433/cell-formula-to-cell-values-for-different-range", "title": "Cell formula to cell values for different range", "body": "<p>I am new to Excel vba.. I need to create a macro for below situation. </p>\n\n<p><code>R12=(Q12/P12)/2 Q12=40 P12=20</code></p>\n\n<p>I need to show the <code>R12</code> cell like <code>(40-20)/2</code>.\nI have a some different spreadsheets. So the input is selected by user by mouse. That all selcted rows must convert to values from formulae. </p>\n\n<p>Please help me</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1459351729, "post_id": 36305455, "comment_id": 60249859, "body": "Are you just trying to access the OOF text?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1459383202, "post_id": 36305455, "comment_id": 60267136, "body": "@DmitryStreblechenko Yeah, including the fields also. Thanks!"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1459399057, "post_id": 36305455, "comment_id": 60271296, "body": "Which fields? OOF text is easy, OOF range requires EWS."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1459402502, "post_id": 36305455, "comment_id": 60272478, "body": "start time and end time ."}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1459474930, "post_id": 36335782, "comment_id": 60314665, "body": "VBA is VB script with a few intrinsic objects exposed to the script by the hosting app."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1459433262, "creation_date": 1459433262, "answer_id": 36335782, "question_id": 36305455, "link": "https://stackoverflow.com/questions/36305455/accessing-automatic-replies-ooo-in-outlook-2013-using-vba/36335782#36335782", "title": "Accessing Automatic replies (OOO) in Outlook 2013 using VBA", "body": "<p>OOF range can only be accessed using EWS (<a href=\"https://msdn.microsoft.com/en-us/library/office/aa493825%28v=exchg.150%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">GetUserOofSettingsRequest</a> verb).</p>\n\n<p>If you are using VB script, <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow\">Redemption</a> might work for you - it exposes the <a href=\"http://www.dimastr.com/redemption/RDOOutOfOfficeAssistant.htm\" rel=\"nofollow\">RDOOutOfOfficeAssistant</a> object. You would need to know the user's credentials unless you are running as the domain user who owns the mailbox.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459433262, "creation_date": 1459331999, "question_id": 36305455, "link": "https://stackoverflow.com/questions/36305455/accessing-automatic-replies-ooo-in-outlook-2013-using-vba", "title": "Accessing Automatic replies (OOO) in Outlook 2013 using VBA", "body": "<p>I've been searching about if it is possible to access the Automatic Replies (OOO) functionality of Outlook 2013 using Excel VBA 2013. For what I have read and found out so far that it's done in Outlook itself. Is there any way that if a button in an excel file, the Automatic reply in window will be opened? Any advice or help where I can start or is this really possible? Thanks!</p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "join", "odbc"], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1459332869, "post_id": 36305707, "comment_id": 60235300, "body": "Hi, I don&#39;t have the capability to do this as it requires an admin password and I won&#39;t be given the privileges to do so"}, {"owner": {"reputation": 153, "user_id": 5730761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hkyPh.jpg?s=128&g=1", "display_name": "SnakeFoot", "link": "https://stackoverflow.com/users/5730761/snakefoot"}, "reply_to_user": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 1, "creation_date": 1459333193, "post_id": 36305707, "comment_id": 60235530, "body": "you don&#39;t need admin privileges to do this. try to create a user ODBC connection to the sql server where  you have the db"}, {"owner": {"reputation": 36290, "user_id": 300836, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/En2qu.jpg?s=128&g=1", "display_name": "Matt Gibson", "link": "https://stackoverflow.com/users/300836/matt-gibson"}, "edited": false, "score": 1, "creation_date": 1459333665, "post_id": 36305707, "comment_id": 60235869, "body": "Indeed. You can do it either way, in fact -- SQL Server <a href=\"http://stackoverflow.com/questions/2583943/query-access-database-from-sql-management-studio-without-using-linked-servers\">can query Access tables</a> -- but linking to the SQL Server table from Access is the way it&#39;s done most usually. You shouldn&#39;t need admin privileges -- if you can see the SQL Server table in some client tool yourself right now, you can probably configure Access to see it, too."}], "tags": [], "owner": {"reputation": 153, "user_id": 5730761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hkyPh.jpg?s=128&g=1", "display_name": "SnakeFoot", "link": "https://stackoverflow.com/users/5730761/snakefoot"}, "is_accepted": false, "score": 1, "last_activity_date": 1459332579, "creation_date": 1459332579, "answer_id": 36305707, "question_id": 36305437, "link": "https://stackoverflow.com/questions/36305437/ms-access-join-access-table-with-sql-server-table/36305707#36305707", "title": "MS Access JOIN Access table with SQL Server table", "body": "<p>Yes it is possible!\nYou have to create a linked table ,see this link for more info: <a href=\"https://support.office.com/en-us/article/Import-or-link-to-SQL-Server-data-a5a3b4eb-57b9-45a0-b732-77bc6089b84e#bm2\" rel=\"nofollow\">sql linked table</a></p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1459337875, "creation_date": 1459337875, "answer_id": 36307697, "question_id": 36305437, "link": "https://stackoverflow.com/questions/36305437/ms-access-join-access-table-with-sql-server-table/36307697#36307697", "title": "MS Access JOIN Access table with SQL Server table", "body": "<p>While the answer is <em>yes</em>, the next word is <em>but</em>, because it can be painfully slow, indeed if you will have multiple joins - because Access has to pull the entire table(s) from SQL Server to perform the join(s).</p>\n\n<p>So be prepared to spend some time tweaking with subqueries and - as the last option - even to upload your Access table to a temp table in SQL Server so this can handle the join (or vice versa).</p>\n"}], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1594460426, "creation_date": 1459331952, "last_edit_date": 1594460426, "question_id": 36305437, "link": "https://stackoverflow.com/questions/36305437/ms-access-join-access-table-with-sql-server-table", "title": "MS Access JOIN Access table with SQL Server table", "body": "<p>I wanted to know if it's possible to join a MS Access table with a SQLtable (in access) and whether the best method to do this is vba? (Unforunately I don't have the capability to link the databases)</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459331115, "post_id": 36304643, "comment_id": 60233962, "body": "I&#39;d start by <b>dim</b>ensioning your variables properly and giving them understandable names. At the moment your working with variants and it&#39;s extremely awkward to read."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459331318, "post_id": 36304643, "comment_id": 60234135, "body": "hi thanx for responding , but i don&#39;t understand what do you mean ?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459331452, "post_id": 36304643, "comment_id": 60234220, "body": "<code>Dim T_ab, D_ab As Object</code> &lt; this creates a <code>Variant</code> and an <code>Object</code> because they aren&#39;t declared properly. Also things like <code>T_ab</code> and <code>D_ab</code> mean nothing to us which makes your code hard to read."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459331482, "post_id": 36304643, "comment_id": 60234242, "body": "this is a link to my file if that would help  <a href=\"http://www.cjoint.com/c/FCEhZSO3Bev\" rel=\"nofollow noreferrer\">cjoint.com/c/FCEhZSO3Bev</a>"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459331685, "post_id": 36304643, "comment_id": 60234398, "body": "T_ab and D_ab are the concatenation between the column &#39;a&#39; and the column  &#39;b&#39; and the same for columns C and D"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "is_accepted": false, "score": 0, "last_activity_date": 1459338638, "creation_date": 1459338638, "answer_id": 36307996, "question_id": 36304643, "link": "https://stackoverflow.com/questions/36304643/code-vba-stops-coping-cell-in-the-first-space/36307996#36307996", "title": "code vba stops coping cell in the first space", "body": "<p>for all who are interested this is the solution for the problem it was easy but i just couldn't see it in the beginning i needed only to add \"\u00a4\"  in  <code>Separ = Split(T_cd(Lig), \"\u00a4\")</code>to complete all the chain   </p>\n"}], "owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459338638, "creation_date": 1459329851, "last_edit_date": 1459330038, "question_id": 36304643, "link": "https://stackoverflow.com/questions/36304643/code-vba-stops-coping-cell-in-the-first-space", "title": "code vba stops coping cell in the first space", "body": "<p>I have a little problem with my code , it works as i want when i was just testing it , but when i put it in the real work i faced a problem that i couldn't solve here is the issue</p>\n\n<p>the code compare 2 columns to other 2 columns and stocks the result in other 3 columns the problem is that when he copies the data from the cell he stops when there is a blank between characters so it copy only the first words for example if i had  ''Air Approval always needed'' he copies only ''Air'' but not the hole chain can you please help me solving this problem and thank you in advance </p>\n\n<pre><code>Sub comparer()\nDim Derlig As Long, Lig As Long, Ref As String\nDim T_ab, D_ab As Object, T_cd, D_cd As Object\nDim T_fgh, Cptr As Long, Separ\nDim start As Single\n\n    start = Timer\n    Application.ScreenUpdating = False\n\n    Range(\"E2:G30000\").Clear\n\n    Set D_ab = CreateObject(\"scripting.dictionary\")\n     Derlig = Columns(\"A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n    T_ab = Range(\"A2:B\" &amp; Derlig)\n    For Lig = 1 To UBound(T_ab)\n        Ref = T_ab(Lig, 1) &amp; \" \" &amp; T_ab(Lig, 2)\n        If Not D_ab.exists(Ref) Then D_ab.Add Ref, \"\"\n    Next\n    T_ab = D_ab.keys\n\n    Set D_cd = CreateObject(\"scripting.dictionary\")\n     Derlig = Columns(\"C\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n    T_cd = Range(\"C2:D\" &amp; Derlig)\n    For Lig = 1 To UBound(T_cd)\n        Ref = T_cd(Lig, 1) &amp; \" \" &amp; T_cd(Lig, 2)\n        If Not D_cd.exists(Ref) Then D_cd.Add Ref, \"\"\n    Next\n    T_cd = D_cd.keys\n\n\n    ReDim T_fgh(3, 0) \n    For Lig = 0 To UBound(T_ab)\n        If Not D_cd.exists(T_ab(Lig)) Then\n            Separ = Split(T_ab(Lig))\n            ReDim Preserve T_fgh(3, Cptr)\n            T_fgh(0, Cptr) = Separ(0)\n            T_fgh(1, Cptr) = Separ(1)\n          Cptr = Cptr + 1\n        End If\n    Next\n\n    For Lig = 0 To UBound(T_cd)\n        If Not D_ab.exists(T_cd(Lig)) Then\n            Separ = Split(T_cd(Lig))\n            ReDim Preserve T_fgh(3, Cptr)\n            T_fgh(0, Cptr) = Separ(0)\n            T_fgh(2, Cptr) = Separ(1)\n          Cptr = Cptr + 1\n        End If\n    Next\n\n    Range(\"F2\").Resize(Cptr, 3) = Application.Transpose(T_fgh)\n    Derlig = Range(\"E2:H100000\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n    Range(\"F2:H\" &amp; Derlig).Borders.Weight = xlThin\n\n    Application.ScreenUpdating = True\n    MsgBox \"comparaison efffectu\u00e9e en \" &amp; Timer - start &amp; \" secondes\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "file", "macros", "rename"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459328587, "post_id": 36303672, "comment_id": 60232134, "body": "Why don&#39;t you open the workbook in your code and set a reference to it that way, much simpler and means the name doesn&#39;t have any effect on the code"}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1459328800, "post_id": 36303672, "comment_id": 60232283, "body": "im quite new to vba and don&#39;t have much idea on how to do your suggestion. can you edit my code based on your suggestion? thank you"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1459329815, "post_id": 36304561, "comment_id": 60232970, "body": "i got xlsm file. it is where my macro is. &quot;Park Sampling Tool.xlsm&quot;. I am just getting random rows from &quot;Raw Data_Park Sampling.xlsx&quot;."}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1459330019, "post_id": 36304561, "comment_id": 60233122, "body": "Also, i tried saving &quot;Raw Data_Park Sampling.xlsx&quot; as &quot;Raw Data_Park Sampling.xlsm&quot; but still no luck. Still not working"}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": -1, "last_activity_date": 1459329614, "creation_date": 1459329614, "answer_id": 36304561, "question_id": 36303672, "link": "https://stackoverflow.com/questions/36303672/vba-macro-suddenly-stopped-working-correctly/36304561#36304561", "title": "VBA/Macro suddenly stopped working correctly", "body": "<p>Macros will not work in xlsx file, save it in xlsm.</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1459389125, "post_id": 36305047, "comment_id": 60268616, "body": "i don&#39;t understand why i need to select rawdata workbook and then select random sample workbook. I am running the code in the workbook that has Random Sample Worksheet where the random rows from rawdata workbook should be pasted"}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1459389639, "post_id": 36305047, "comment_id": 60268762, "body": "I created another workbook but still, nothing was being copied but the header only"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1459330922, "creation_date": 1459330922, "answer_id": 36305047, "question_id": 36303672, "link": "https://stackoverflow.com/questions/36303672/vba-macro-suddenly-stopped-working-correctly/36305047#36305047", "title": "VBA/Macro suddenly stopped working correctly", "body": "<p>Open the workbooks within your code and set the reference that way instead:</p>\n\n<pre><code>Sub MAINx1()\n\nDim rawDataWB       As Excel.Workbook\nDim randomSampleWB  As Excel.Workbook\nDim rawDataWS       As Excel.Worksheet\nDim randomSampleWS  As Excel.Worksheet\nDim rd              As String\nDim rs              As String\n\nMsgBox \"Select the raw data workbook\", vbInformation\nrd = Application.GetOpenFilename(\"Excel Files (*.xlsx), *.xlsx\")\n\nMsgBox \"Select the random sample workbook\", vbInformation\nrs = Application.GetOpenFilename(\"Excel Files (*.xlsx), *.xlsx\")\n\nIf UCase$(rd) &lt;&gt; \"FALSE\" And UCase$(rs) &lt;&gt; \"FALSE\" Then\n    Set rawDataWB = Workbooks.Open(rd)\n    Set randomSampleWB = Workbooks.Open(rs)\nElse\n    Exit Sub\nEnd If\n\nSet rawDataWS = rawDataWB.Sheets(\"Sheet1\")\nSet randomSampleWS = randomSampleWB.Sheets(\"Random Sample\")\n\n'// Delete current random sample\nrandomSampleWS.ClearContents\n\n'// Copy header\nrandomSampleWS.Range(\"A1:L1\").Value = rawDataWS.Range(\"A1:L1\").Value\n\n    Dim map, i As Long, n As Long, c As Long, rand, col\n    Dim keyArr, nRowsArr\n    Dim rng As Range\n\n'// rest of your code here ...\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2356, "favorite_count": 0, "accepted_answer_id": 36305047, "answer_count": 2, "score": 1, "last_activity_date": 1459330922, "creation_date": 1459327047, "question_id": 36303672, "link": "https://stackoverflow.com/questions/36303672/vba-macro-suddenly-stopped-working-correctly", "title": "VBA/Macro suddenly stopped working correctly", "body": "<p>I am having a weird problem. Everything was working properly until i used another raw data file and named it as <code>Raw Data_Park Sampling.xlsx</code>. After running my code, there is no error but nothing was being copied anymore to \"Random Sample\" sheet.</p>\n\n<p>What's weird is that the new raw data file has the same content as the previous one.</p>\n\n<p>I tried to replace the data inside the previous working file and it still worked. I do not know why my code will only work if i use that specific raw data file. Why is that? Even i renamed other file with: <code>Raw Data_Park Sampling.xlsx</code> and have the same content/format it is not working.</p>\n\n<p>I already tried creating another excel file and pasted the codes but still no luck. I really have no idea why this kind of thing is even happening. What is wrong?</p>\n\n<p>Below is my whole code:</p>\n\n<pre><code>Sub MAINx1()\n\n\n'Delete current random sample\n\nSheets(\"Random Sample\").Select\nCells.Select\nRange(\"C14\").Activate\nSelection.Delete Shift:=xlUp\n\n\n'copy header\n\n Windows(\"Raw Data_Park Sampling.xlsx\").Activate\n    Range(\"A1:L1\").Select\n    Selection.Copy\n    Windows(\"Park Sampling Tool.xlsm\").Activate\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n\n\n    Dim rawDataWs As Worksheet, randomSampleWs As Worksheet\n    Dim map, i As Long, n As Long, c As Long, rand, col\n    Dim keyArr, nRowsArr\n    Dim rng As Range\n\n\n    Set rawDataWs = Workbooks(\"Raw Data_Park Sampling.xlsx\").Worksheets(\"Sheet1\")\n    Set randomSampleWs = Workbooks(\"Park Sampling Tool.xlsm\").Worksheets(\"Random Sample\")\n    randomSampleWs.UsedRange.ClearContents\n\n\n     Set rng = rawDataWs.Range(\"A2:A\" &amp; _\n                    rawDataWs.Cells(Rows.Count, 1).End(xlUp).Row)\n\n    Set map = RowMap(rng)\n\n     keyArr = Array(\"AU\", \"FJ\", \"NC\", \"NZ\", \"SG12\", \"ID\", \"PH26\", \"PH24\", \"TH\", \"ZA\", \"JP\", \"MY\", \"PH\", \"SG\", \"VN\") '&lt;== keywords\n\n     nRowsArr = Array(4, 1, 1, 3, 1, 3, 3, 1, 3, 4, 2, 3, 1, 3, 2) '&lt;== # of random rows\n\n\n\n    Debug.Print \"Key\", \"#\", \"Row#\"\n    For i = LBound(keyArr) To UBound(keyArr)\n        If map.exists(keyArr(i)) Then\n\n            Set col = map(keyArr(i))\n            n = nRowsArr(i)\n\n            For c = 1 To n\n                'select a random member of the collection\n                rand = Application.Evaluate(\"RANDBETWEEN(1,\" &amp; col.Count &amp; \")\")\n                Debug.Print keyArr(i), rand, col(rand)\n                rawDataWs.Rows(col(rand)).Copy _\n                     randomSampleWs.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n                col.Remove rand 'remove the \"used\" row\n                If col.Count = 0 Then\n                    If c &lt; n Then Debug.Print \"Not enough rows for \" &amp; keyArr(i)\n                    Exit For\n                End If\n            Next c\n\n        Else\n            Debug.Print \"No rows for \" &amp; keyArr(i)\n        End If\n    Next i\n\n    MsgBox \"Random Sample: Per Day Successfully Generated!\"\n\n\nEnd Sub\n\n'get a map of rows as a dictionary where each value is a collection of row numbers\nFunction RowMap(rng As Range) As Object\n    Dim dict, c As Range, k\n    Set dict = CreateObject(\"scripting.dictionary\")\n    For Each c In rng.Cells\n        k = Trim(c.value)\n        If Len(k) &gt; 0 Then\n            If Not dict.exists(k) Then dict.Add k, New Collection\n            dict(k).Add c.Row\n        End If\n    Next c\n    Set RowMap = dict\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 395, "user_id": 3169049, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9be7e02d44421c30df4611e53fc88574?s=128&d=identicon&r=PG", "display_name": "Moogle", "link": "https://stackoverflow.com/users/3169049/moogle"}, "is_accepted": false, "score": 0, "last_activity_date": 1459328245, "creation_date": 1459328245, "answer_id": 36304091, "question_id": 36303503, "link": "https://stackoverflow.com/questions/36303503/how-to-find-value-from-cell-and-placing-corresponding-value-to-another-cell-usin/36304091#36304091", "title": "How to Find value from cell and placing corresponding value to another cell using VBA?", "body": "<p>The formula you want is:</p>\n\n<pre><code>=RIGHT(A1,LEN(A1)-FIND(\"~\",SUBSTITUTE(A1,\":\",\"~\",LEN(A1)-LEN(SUBSTITUTE(A1,\":\",\"\")))))\n</code></pre>\n\n<p>Obviously change \"A1\" for whatever cell you're referencing.</p>\n\n<p>You can use VBA to insert this formula into the cell that you want to value to appear in.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6060222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40d10d8b65ce840e4f532ec8aae4f94?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime Sacrist&#225;n", "link": "https://stackoverflow.com/users/6060222/jaime-sacrist%c3%a1n"}, "is_accepted": false, "score": 0, "last_activity_date": 1459330246, "creation_date": 1459330246, "answer_id": 36304791, "question_id": 36303503, "link": "https://stackoverflow.com/questions/36303503/how-to-find-value-from-cell-and-placing-corresponding-value-to-another-cell-usin/36304791#36304791", "title": "How to Find value from cell and placing corresponding value to another cell using VBA?", "body": "<p>I am not sure this is what you want but try this:</p>\n\n<pre><code>Sub printErrorCode()\n\nDim errorType, errorCode As Variant 'define two variant variable to store errors and codes\nDim errorPosition As Integer 'define errorPosition which will return the position of the searched string\n\nWith ThisWorkbook.Sheets(\"YourSheetName\") 'In my example I worked with a single sheet so I will avoid specifying the workbook and the sheet in every line\n\nerrorType = .Range(\"ListOfErrorsRange\").Value 'store possible error types\nerrorCode = .Range(\"ListOfErrorCodesRange\").Value 'store associated codes\n\nFor i = LBound(errorType) To UBound(errorType) 'from the first error type to the last\n    errorPosition = InStr(1, .Range(\"YourStringRange\"), errorType(i, 1), vbTextCompare) 'return the position of errorType String in YourRange string if found, or 0 if not found\n    If errorPosition &lt;&gt; 0 Then 'if errorPosition &lt;&gt;0 it found the string\n        .Range(\"YourStringRange\").Offset(0,1).Value = errorCode(i, 1) 'if errorType string found return corresponding errorCode\n        Exit Sub 'exit the routine\n    End If\nNext i\n\nMsgBox \"Error Not Found In List\" 'if errorPosition = 0 for all i, then the Error was not on the list of errors\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1459332617, "last_edit_date": 1459332617, "creation_date": 1459330906, "answer_id": 36305040, "question_id": 36303503, "link": "https://stackoverflow.com/questions/36303503/how-to-find-value-from-cell-and-placing-corresponding-value-to-another-cell-usin/36305040#36305040", "title": "How to Find value from cell and placing corresponding value to another cell using VBA?", "body": "<p>Below is the code you need to paste in module</p>\n\n<pre><code>Public Function getcontent(r As Range) As String\n    str1 = InStr(r.Cells.Value, \"failure type\")\n    If str1 &gt; 0 Then\n        str2 = Mid(r.Cells.Value, str1 + 13, Len(r.Cells.Value))\n        getcontent = str2\n    Else\n        getcontent = \"\"\n    End If\nEnd Function\n</code></pre>\n\n<p>assume the content \"ControlM : servername :jobname : failure type (Ended not OK, longrunning ...)\" in cell A1</p>\n\n<p>in Cell A2, =getcontent(A1)</p>\n\n<p>you will get the failure type content alone.</p>\n\n<p>Hope this is inline with your requirements.</p>\n"}], "owner": {"reputation": 13, "user_id": 6133466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U9LGM90OvB0/AAAAAAAAAAI/AAAAAAAAAJo/xCEF7YWg5f4/photo.jpg?sz=128", "display_name": "Chetan Risbud", "link": "https://stackoverflow.com/users/6133466/chetan-risbud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1459332617, "creation_date": 1459326576, "question_id": 36303503, "link": "https://stackoverflow.com/questions/36303503/how-to-find-value-from-cell-and-placing-corresponding-value-to-another-cell-usin", "title": "How to Find value from cell and placing corresponding value to another cell using VBA?", "body": "<p>I need help to write code for Finding value from cell and placing corresponding value to another cell </p>\n\n<p>Suppose cell A contain data like mention below</p>\n\n<p>ControlM : servername :jobname : failure type (Ended not OK, longrunning ...)</p>\n\n<p>I want to check failure type from cell content and placed certain associated value in another cell.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6133405, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2qhnhFroHU/AAAAAAAAAAI/AAAAAAAAADk/qenZNKgnk_g/photo.jpg?sz=128", "display_name": "Simon Clark", "link": "https://stackoverflow.com/users/6133405/simon-clark"}, "edited": false, "score": 0, "creation_date": 1459328988, "post_id": 36303395, "comment_id": 60232407, "body": "Brilliant, works a treat. Just changed NewSht.Range(&quot;A&quot; &amp; cTab + 1) to NewSht.Range(&quot;A1&quot;) to have it copied to where i needed it."}], "tags": [], "owner": {"reputation": 4203, "user_id": 2119523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkQjy.jpg?s=128&g=1", "display_name": "Netloh", "link": "https://stackoverflow.com/users/2119523/netloh"}, "is_accepted": true, "score": 0, "last_activity_date": 1459326243, "creation_date": 1459326243, "answer_id": 36303395, "question_id": 36302856, "link": "https://stackoverflow.com/questions/36302856/create-a-new-sheet-and-coping-data/36303395#36303395", "title": "Create a new sheet and coping data", "body": "<p>You could modify your code to something like the below, which should copy the rows as you described.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim cTab As Integer\n    Dim BaseSht As Worksheet\n    Dim NewSht As Worksheet\n\n    Set BaseSht = ActiveSheet\n\n    cTab = ActiveCell.Row - 1\n\n    If Selection.Count = 1 Then\n\n        If Not Intersect(Target, Range(\"A2:A201\")) Is Nothing Then\n\n            Dim WS1 As Worksheet\n            On Error Resume Next\n            Set WS1 = Worksheets(cTab &amp; \".\")\n\n            If WS1 Is Nothing Then\n\n                Application.ScreenUpdating = False\n                ActiveCell = cTab &amp; \".\"\n                Sheets(\"Template\").Visible = True\n\n                Sheets(\"Template\").Copy After:=Sheets(Worksheets.Count)\n                ActiveSheet.Name = cTab &amp; \".\"\n                Set NewSht = ActiveSheet\n\n                BaseSht.Select\n\n                'Copy row to new sheet\n                BaseSht.Range(ActiveCell.Address &amp; \":\" &amp; BaseSht.Cells(ActiveCell.Row, Columns.Count).End(xlToLeft).Address).Copy NewSht.Range(\"A\" &amp; cTab + 1)\n\n                'Sheets(\"Template\").Visible = False\n                Application.ScreenUpdating = True\n\n                Else\n\n                Sheets(cTab &amp; \".\").Select\n\n            End If\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6133405, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2qhnhFroHU/AAAAAAAAAAI/AAAAAAAAADk/qenZNKgnk_g/photo.jpg?sz=128", "display_name": "Simon Clark", "link": "https://stackoverflow.com/users/6133405/simon-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 36303395, "answer_count": 1, "score": 0, "last_activity_date": 1459334827, "creation_date": 1459324568, "last_edit_date": 1531161705, "question_id": 36302856, "link": "https://stackoverflow.com/questions/36302856/create-a-new-sheet-and-coping-data", "title": "Create a new sheet and coping data", "body": "<p>I have the below code which will create a new worksheet on selecting A2 which works fine, but what I am also trying to do is to also copy the data in the row 2 and copy this across into the new sheet. Along with this if I click on A3 to create another worksheet, I want to copy the data in row 3 across to that sheet, and so on.</p>\n\n<p>Any ideas??</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange()\n\nDim cTab As Integer\ncTab = ActiveCell.Row - 1\n\n\n    If Selection.Count = 1 Then\n\n        If Not Intersect(Target, Range(\"A2:A201\")) Is Nothing Then\n\n            Dim WS1 As Worksheet\n            On Error Resume Next\n            Set WS1 = Worksheets(cTab &amp; \".\")\n\n            If WS1 Is Nothing Then\n\n                Application.ScreenUpdating = False\n                ActiveCell = cTab &amp; \".\"\n                    Sheets(\"Template\").Visible = True\n                Sheets(\"Template\").Select\n                Sheets(\"Template\").Copy After:=Sheets(Worksheets.Count)\n                ActiveSheet.Name = cTab &amp; \".\"\n                'Sheets(\"Template\").Visible = False\n                Application.ScreenUpdating = True\n\n                Else\n\n                Sheets(cTab &amp; \".\").Select\n\n            End If\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459323024, "post_id": 36302207, "comment_id": 60228731, "body": "pls. try with Dim newRange As Range"}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 3119342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lXlqc.jpg?s=128&g=1", "display_name": "witchchild", "link": "https://stackoverflow.com/users/3119342/witchchild"}, "is_accepted": true, "score": 0, "last_activity_date": 1459330449, "creation_date": 1459330449, "answer_id": 36304857, "question_id": 36302207, "link": "https://stackoverflow.com/questions/36302207/excel-vba-reference-sourcedata-for-creating-pivot-table/36304857#36304857", "title": "Excel VBA Reference SourceData for Creating Pivot Table", "body": "<p>You need to reference the source array differently. I am sure there is a better way than my example below, but this does work</p>\n\n<pre><code>Dim newRange As Range\n\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToRight)).Select\n\nnewRange = Selection\nActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidation, SourceData:= Array(\"R\" &amp; newRange.Row &amp; \"C\" &amp; newRange.Column &amp; \":R\" &amp; newRange.Row + newRange.Rows.Count - 1 &amp; \"C\" &amp; newRange.Column + newRange.Columns.Count - 1), Version:=xlPivotTableVersion14). _\nCreatePivotTable TableDestination:=\"\", TableName:=\"PivotTable3\", DefaultVersion:=xlPivotTableVersion14\nActiveSheet.PivotTableWizard TableDestination:=ActiveSheet.Cells(3, 1)\nActiveSheet.Cells(3, 1).Select\nActiveSheet.PivotTables(\"PivotTable3\").DataPivotField.PivotItems(\"Count of Value\").Position = 1\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Row\").Orientation = xlHidden\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Column\").Orientation = xlHidden\nRange(\"A4\").Select\nSelection.ShowDetail = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12199210, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/11a7832d3dc1c10719e585f99ce111d2?s=128&d=identicon&r=PG", "display_name": "Sadok Fennira", "link": "https://stackoverflow.com/users/12199210/sadok-fennira"}, "is_accepted": false, "score": 0, "last_activity_date": 1570781143, "last_edit_date": 1570781143, "creation_date": 1570774990, "answer_id": 58335337, "question_id": 36302207, "link": "https://stackoverflow.com/questions/36302207/excel-vba-reference-sourcedata-for-creating-pivot-table/58335337#58335337", "title": "Excel VBA Reference SourceData for Creating Pivot Table", "body": "<p>I stumbled on this post as I was looking for a solution to a similar problem\nanyways. to answer to this old post. I might help someone else. </p>\n\n<p>The SourceData can be addressed in two ways. either the one that witchild used:</p>\n\n<pre><code>\"nameofyourworksheet!R1C1:R\" &amp; Nbroftherowsofthesourcedataorarray &amp; \"C17\", Version:=xlPivotTableVersion15).CreatePivotTable _'\n</code></pre>\n\n<p>or, the 2nd way:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"nameofyourworksheet\").Range(\"A1:Q\" &amp; Nbroftherowsofthesourcedataorarray).Address(, , xlR1C1, True), Version:=xlPivotTableVersion15).CreatePivotTable _\n</code></pre>\n\n<p>The code line: .Address(, , xlR1C1, True) means that the range will be converted to the format \"R..C..\" to make it works. I didnt try it but I trust the forum :p</p>\n\n<p>hope I was able to help people searching for a solution to this problem </p>\n"}], "owner": {"reputation": 13, "user_id": 6133263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0bcce7070fe0b11f562e0ad4436656e?s=128&d=identicon&r=PG&f=1", "display_name": "JPNMAN389", "link": "https://stackoverflow.com/users/6133263/jpnman389"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2075, "favorite_count": 0, "accepted_answer_id": 36304857, "answer_count": 2, "score": 1, "last_activity_date": 1570781143, "creation_date": 1459322628, "question_id": 36302207, "link": "https://stackoverflow.com/questions/36302207/excel-vba-reference-sourcedata-for-creating-pivot-table", "title": "Excel VBA Reference SourceData for Creating Pivot Table", "body": "<p>I need help!</p>\n\n<p>In order to convert a table to a list I am using the following VBA formula. It was created by using record macro and the PivotTable Wizard (not the most elegant solution), but it works.</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidation, SourceData:= _\n    Array(\"PasteSheet!R1C1:R300C200\"), Version:=xlPivotTableVersion14). _\n    CreatePivotTable TableDestination:=\"\", TableName:=\"PivotTable3\", _\n    DefaultVersion:=xlPivotTableVersion14\nActiveSheet.PivotTableWizard TableDestination:=ActiveSheet.Cells(3, 1)\nActiveSheet.Cells(3, 1).Select\nActiveSheet.PivotTables(\"PivotTable3\").DataPivotField.PivotItems( _\n    \"Count of Value\").Position = 1\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Row\").Orientation = _\n    xlHidden\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Column\").Orientation = _\n    xlHidden\nRange(\"A4\").Select\nSelection.ShowDetail = True\n</code></pre>\n\n<p>My issue is I want to be able to set the SourceData to reference a stored variable as the source data range will change each time the macro is run, but I can't get it to work and googled everywhere with no result. My best shot was trying the following.</p>\n\n<pre><code>Dim newRange As Variant\n\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToRight)).Select\n\nSet newRange = Selection\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidation, SourceData:= _\n    newRange, Version:=xlPivotTableVersion14). _\n    CreatePivotTable TableDestination:=\"\", TableName:=\"PivotTable3\", _\n    DefaultVersion:=xlPivotTableVersion14\nActiveSheet.PivotTableWizard TableDestination:=ActiveSheet.Cells(3, 1)\nActiveSheet.Cells(3, 1).Select\nActiveSheet.PivotTables(\"PivotTable3\").DataPivotField.PivotItems( _\n    \"Count of Value\").Position = 1\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Row\").Orientation = _\n    xlHidden\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Column\").Orientation = _\n    xlHidden\nRange(\"A4\").Select\nSelection.ShowDetail = True\n</code></pre>\n\n<p>Help would be much appreciated!</p>\n"}, {"tags": ["excel", "autofilter", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5193693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd2352208e3d9ef41b1abaee22b6a9c?s=128&d=identicon&r=PG&f=1", "display_name": "DonAndress", "link": "https://stackoverflow.com/users/5193693/donandress"}, "edited": false, "score": 0, "creation_date": 1459327997, "post_id": 36303525, "comment_id": 60231732, "body": "I would very much appreciate VBA.  Here is what I established that would partially work: <code>If k &gt; 0 Then     kryterium = kryterium &amp; &quot;, &quot; &amp; &quot;&quot;&quot;&quot; &amp; sNameStat &amp; &quot;&quot;&quot;&quot;   Else      kryterium = &quot;&quot;&quot;&quot; &amp; sNameStat &amp; &quot;&quot;&quot;&quot;   End If Debug.Print kryterium  k = k + 1 End If  ary = Split(kryterium, &quot;&quot;&quot;, &quot;&quot;&quot;)</code>  But this only gives me one name. And I don&#39;t know how to Debug.Print what actually is inside the array..."}, {"owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "reply_to_user": {"reputation": 1, "user_id": 5193693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd2352208e3d9ef41b1abaee22b6a9c?s=128&d=identicon&r=PG&f=1", "display_name": "DonAndress", "link": "https://stackoverflow.com/users/5193693/donandress"}, "edited": false, "score": 0, "creation_date": 1459328963, "post_id": 36303525, "comment_id": 60232392, "body": "You have used split to split the string into an array but your criteria is &quot;Criteria1:=Array(ary),&quot;. I think that the &quot;Array&quot; may be confusing things, the &quot;Array&quot; is saying that there is an array of an array. I think just (ary) should work."}, {"owner": {"reputation": 1, "user_id": 5193693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd2352208e3d9ef41b1abaee22b6a9c?s=128&d=identicon&r=PG&f=1", "display_name": "DonAndress", "link": "https://stackoverflow.com/users/5193693/donandress"}, "edited": false, "score": 0, "creation_date": 1459330696, "post_id": 36303525, "comment_id": 60233642, "body": "Actually after tens of tries I&#39;ve found a working code: <code>If k &gt; 0 Then                 kryterium = kryterium &amp; &quot;&quot;&quot;&quot; &amp; &quot;, |&quot; &amp; &quot;&quot;&quot;&quot; &amp; sedziaNameStat             Else                 kryterium = sedziaNameStat             End If                     k = k + 1  ary = Split(kryterium &amp; &quot;&quot;&quot;&quot; &amp; &quot;, |&quot; &amp; &quot;&quot;&quot;&quot;, &quot;&quot;&quot;, |&quot;&quot;&quot;)  ActiveSheet.Range(&quot;$B$1:$B$&quot; &amp; lastSedziaStat).AutoFilter Field:=1, Criteria1:=Array(ary), Operator:=xlFilterValues</code> Conclusion - Array(ary) works fine. Thanks for the effort though."}], "tags": [], "owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "is_accepted": false, "score": -1, "last_activity_date": 1459327254, "last_edit_date": 1459327254, "creation_date": 1459326642, "answer_id": 36303525, "question_id": 36302069, "link": "https://stackoverflow.com/questions/36302069/autofilter-how-to-create-array-out-of-variables/36303525#36303525", "title": "Autofilter - how to create array out of variables", "body": "<p>Do you have to use VBA?\nI would add a couple of extra columns with the names extracted and apply a data filter to those columns.</p>\n\n<p>Surname column: <code>=LEFT(A1,FIND(\",\",A1)-1)</code></p>\n\n<p>Forename column: <code>=MID(A1,LEN(B1)+3,FIND(\"(\",A1)-3-LEN(B1))</code></p>\n"}], "owner": {"reputation": 1, "user_id": 5193693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd2352208e3d9ef41b1abaee22b6a9c?s=128&d=identicon&r=PG&f=1", "display_name": "DonAndress", "link": "https://stackoverflow.com/users/5193693/donandress"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459327254, "creation_date": 1459322145, "last_edit_date": 1531161705, "question_id": 36302069, "link": "https://stackoverflow.com/questions/36302069/autofilter-how-to-create-array-out-of-variables", "title": "Autofilter - how to create array out of variables", "body": "<p>I have column A with some names, each string which resambles name is in one cell (note 2 spaces before brackets):</p>\n\n<pre><code>Doe, John  (New York)\nSmith, Will  (Philadelphia)\nBanks, Carlton  (LA)\n</code></pre>\n\n<p>Then on the other sheet I have column A with a list of multiple names with the same format.\nI'd like to create an array to use it in the autofilter in Excel.</p>\n\n<p>Given that I know how to create a loop to go through all names, could you please help me creating the array in a suitable format?</p>\n\n<p>I tried the below but it doesn't work, filter hides all names.\nWhen I Debug.Print variable kryterium I get exactly the string I need:</p>\n\n<pre><code>If k &gt; 0 Then\n   kryterium = kryterium &amp; \", \" &amp; sNameStat\nElse\n   kryterium = sNameStat\nEnd If\n\nary = Split(kryterium, \", \")\n\nActiveSheet.Range(\"$A$1:$A$49\").AutoFilter Field:=1, Criteria1:=Array(ary), Operator:=xlFilterValues\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1459322440, "post_id": 36302022, "comment_id": 60228358, "body": "The code above works. My guess is that <code>&quot;20160121&quot;</code> is not actually a fixed value, but database field that can contain Null? If that&#39;s so, use <a href=\"https://msdn.microsoft.com/en-us/library/office/aa172237%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">the <code>Nz()</code> function</a>."}, {"owner": {"reputation": 73, "user_id": 3181982, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4a29bcb147f9ab1c4a5990648f0ddf4d?s=128&d=identicon&r=PG", "display_name": "PoorCadaver", "link": "https://stackoverflow.com/users/3181982/poorcadaver"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1459322992, "post_id": 36302022, "comment_id": 60228705, "body": "You&#39;re right, it works, but... Instead of &quot;20160121&quot; I have a variable, var, that I get from a textbox. I can user var in the Left() and cDate() works, but when I use it in the Mid() it doesn&#39;t... Does it make it any clearer?"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1459323180, "post_id": 36302022, "comment_id": 60228837, "body": "No, not really, unfortunately. Set a breakpoint in your code, step through it line by line, make note of the exact line the error occurs and all the variable values at that point in time. This has to be a simple oversight and not a real issue."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1459325485, "creation_date": 1459325485, "answer_id": 36303150, "question_id": 36302022, "link": "https://stackoverflow.com/questions/36302022/incompatible-types-using-cdate-in-access-vba/36303150#36303150", "title": "Incompatible types using CDate() in Access VBA", "body": "<p>You'll have to decide what to do for invalid input values.</p>\n\n<p>One option is to provide a default date of your choice, today's date or here <em>1980-01-01</em>:</p>\n\n<pre><code>Public Function ConvertDate(ByVal TextDate As String) As Date\n\n    Dim RealDate    As Date\n    Dim NullDate    As Date\n\n    NullDate = #1/1/1980#\n\n    TextDate = Format(TextDate, \"@@@@/@@/@@\")\n    If IsDate(TextDate) Then\n        RealDate = CDate(TextDate)\n    Else\n        RealDate = NullDate\n    End If\n\n    ConvertDate = RealDate\n\nEnd Function\n</code></pre>\n\n<p>Will return:</p>\n\n<pre><code>20160121 -&gt; 2016-01-21\n20160141 -&gt; 1980-01-01\n</code></pre>\n\n<p>Or you may change the data type of <code>RealDate</code> to <em>Variant</em> and return <em>Null</em> for invalid dates:</p>\n\n<pre><code>Public Function ConvertDate(ByVal TextDate As String) As Variant\n\n    Dim RealDate    As Variant\n    Dim NullDate    As Variant\n\n    NullDate = Null     \n\n    TextDate = Format(TextDate, \"@@@@/@@/@@\")\n    If IsDate(TextDate) Then\n        RealDate = CDate(TextDate)\n    Else\n        RealDate = NullDate\n    End If\n\n    ConvertDate = RealDate\n\nEnd Function\n</code></pre>\n\n<p>Will return:</p>\n\n<pre><code>20160121 -&gt; 2016-01-21\n20160141 -&gt; Null\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 3181982, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4a29bcb147f9ab1c4a5990648f0ddf4d?s=128&d=identicon&r=PG", "display_name": "PoorCadaver", "link": "https://stackoverflow.com/users/3181982/poorcadaver"}, "is_accepted": true, "score": 0, "last_activity_date": 1459327647, "creation_date": 1459327647, "answer_id": 36303881, "question_id": 36302022, "link": "https://stackoverflow.com/questions/36302022/incompatible-types-using-cdate-in-access-vba/36303881#36303881", "title": "Incompatible types using CDate() in Access VBA", "body": "<p>The error was because I tested with a false date: 12345678 instead. With a correct date it works fine...</p>\n"}], "owner": {"reputation": 73, "user_id": 3181982, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4a29bcb147f9ab1c4a5990648f0ddf4d?s=128&d=identicon&r=PG", "display_name": "PoorCadaver", "link": "https://stackoverflow.com/users/3181982/poorcadaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 36303881, "answer_count": 2, "score": 0, "last_activity_date": 1514529427, "creation_date": 1459321983, "last_edit_date": 1514529427, "question_id": 36302022, "link": "https://stackoverflow.com/questions/36302022/incompatible-types-using-cdate-in-access-vba", "title": "Incompatible types using CDate() in Access VBA", "body": "<p>I'm calculating with dates in MS Access using VBA. This works fine when I have two dates on the same form (ex 2016-01-21) but not when I first need to modify a string into date form like this: 20160121 -> 2016-01-21.</p>\n\n<p>This is what I'm trying to do:</p>\n\n<pre><code>Dim sYear As String, sMonth As String, sDay As String, sDate As String\n\nsYear = Left(\"20160121\", 4)\nsMonth = Mid(\"20160121\", 5, 2)\nsDay = Mid(\"20160121\", 7, 2)\n\nsDate = sYear &amp; \"-\" &amp; sMonth &amp; \"-\" &amp; sDay\n\nMsgBox CDate(sDate)\n</code></pre>\n\n<p>This returns Error 13, Incompatible types.</p>\n\n<p>This works though:</p>\n\n<pre><code>MsgBox CDate(\"2016-01-21\")\n</code></pre>\n\n<p>Why doesn't my way work?</p>\n"}, {"tags": ["excel", "vba", "macros", "runtime-error", "type-mismatch"], "comments": [{"owner": {"reputation": 7015, "user_id": 1321516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8afQR.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1321516/sam"}, "edited": false, "score": 0, "creation_date": 1459322283, "post_id": 36301700, "comment_id": 60228273, "body": "<code>If rngA.Value &gt;= rngD.Value Then</code>"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459322804, "post_id": 36301700, "comment_id": 60228580, "body": "Why don&#39;t you use conditional formatting? Also noting that your code is looking at column A and column D in the same row (which is different ti what you explain in your question)."}, {"owner": {"reputation": 47, "user_id": 6133158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28482cd6b39e2d2c0bd352f70ab0513e?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/6133158/han"}, "edited": false, "score": 0, "creation_date": 1459324356, "post_id": 36301700, "comment_id": 60229549, "body": "Thank you for the asap reply, but I&#39;m not understand about your suggestion....@@"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6133158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28482cd6b39e2d2c0bd352f70ab0513e?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/6133158/han"}, "edited": false, "score": 0, "creation_date": 1459327722, "post_id": 36302151, "comment_id": 60231534, "body": "yeap~! it is working!...but dude...I sill trying to add in the message box, so far I just added in this               MsgBox &quot;Sheet 1 Row &quot; &amp; Range(&quot;A&quot; &amp; i) &amp; &quot; expiring&quot;  The MsgBox is working."}, {"owner": {"reputation": 47, "user_id": 6133158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28482cd6b39e2d2c0bd352f70ab0513e?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/6133158/han"}, "edited": false, "score": 0, "creation_date": 1459386480, "post_id": 36302151, "comment_id": 60267994, "body": "By he way, can i know about the meaning of your codding?  &gt;&gt;&gt;Range(&quot;H1048576&quot;).End(xlUp).Row  &lt;&lt;&lt; what does it means? How about if i wan to start counting at H4 to the end rather than H1? How should i modify he codding? Looking forward for your reply. thx"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 47, "user_id": 6133158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28482cd6b39e2d2c0bd352f70ab0513e?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/6133158/han"}, "edited": false, "score": 0, "creation_date": 1459404938, "post_id": 36302151, "comment_id": 60273613, "body": "@Han, it means to find the last non-empty row from the bottom of the excel sheet of specific column."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1459322436, "creation_date": 1459322436, "answer_id": 36302151, "question_id": 36301700, "link": "https://stackoverflow.com/questions/36301700/excel-2013-compare-dates-on-different-row-using-macro-run-time-error-13-type-m/36302151#36302151", "title": "Excel 2013 compare dates on different row using macro &quot;Run time error 13, Type mismatch&quot;", "body": "<p>Please try this</p>\n\n<pre><code>With Worksheets(\"Sheet2\")\nlastrow = Range(\"A1048576\").End(xlUp).Row\nFor i = 2 To lastrow\n    If Range(\"A\" &amp; i).Value &lt;&gt; \"\" And Range(\"D\" &amp; i).Value &lt;&gt; \"\" Then\n        If Range(\"A\" &amp; i).Value &gt;= Range(\"D\" &amp; i).Value Then\n            Range(\"C\" &amp; i).Value = \"Contract Going to Expire\"\n            Range(\"C\" &amp; i).Interior.Color = 3\n            Range(\"C\" &amp; i).Font.ColorIndex = 2\n            Range(\"C\" &amp; i).Font.Bold = True\n        End If\n    End If\nNext i\n</code></pre>\n\n<p>End With</p>\n"}], "owner": {"reputation": 47, "user_id": 6133158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28482cd6b39e2d2c0bd352f70ab0513e?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/6133158/han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 36302151, "answer_count": 1, "score": 1, "last_activity_date": 1459322436, "creation_date": 1459320885, "last_edit_date": 1459321463, "question_id": 36301700, "link": "https://stackoverflow.com/questions/36301700/excel-2013-compare-dates-on-different-row-using-macro-run-time-error-13-type-m", "title": "Excel 2013 compare dates on different row using macro &quot;Run time error 13, Type mismatch&quot;", "body": "<p>I'm new in vba, currently I'm working and my boss need me to create a excel macro.</p>\n\n<p>The macro function are:</p>\n\n<ul>\n<li>compare data are dates, Start date with End date.</li>\n<li>auto remind user employees contract outdated when open worksheet.</li>\n<li>if employees contract outdated, highlight employees details.</li>\n</ul>\n\n<p>So now I'm stuck until \"Run time error 13, Type mismatch\".</p>\n\n<p>Below are my codding part, mismatch is between >>>  &lt;&lt;&lt;.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nDim rngA As Range\nDim rngD As Range\n\nWith Worksheets(\"Sheet1\")\n\n    For Each rngA In .Range(.Range(\"A1\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n    For Each rngD In .Range(.Range(\"D1\"), .Cells(.Rows.Count, \"D\").End(xlUp))\n\n        &gt;&gt;&gt; If rngA.Value(\"A1:xlUp\") &gt;= rngD.Value(\"D1:xlUp\") Then &lt;&lt;&lt;\n            MsgBox \"Sheet 1 Row \" &amp; rngA.Row &amp; \" expiring\"\n            rngC.Interior.ColorIndex = 3\n            rngC.Font.ColorIndex = 2\n            rngC.Font.Bold = True\n\n        End If\n\n\n    Next rngD\n    Next rngA\n\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "menubar"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1459788441, "post_id": 36301235, "comment_id": 60432634, "body": "When do you use Function ToolBarExists(strName As String) As Boolean?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1460531844, "post_id": 36301235, "comment_id": 60779827, "body": "Hi, that function should check for existing toolbars and i have about 10. it should check by name of the toolbars."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1460575435, "creation_date": 1460575435, "answer_id": 36607758, "question_id": 36301235, "link": "https://stackoverflow.com/questions/36301235/outlook-custom-menu-buttons/36607758#36607758", "title": "Outlook custom menu buttons", "body": "<p>In Outlook 2010. If Visible works for you incorporate it in a similar manner.</p>\n\n<pre><code>Option Explicit\n\nSub TBarExistsbutton1()\n\n    Dim cbControlCount As Long\n    Dim button1Found As Boolean\n    Dim j As Long\n\n    If ToolBarExists(\"Menu Bar\") Then\n\n        cbControlCount = ActiveWindow.CommandBars(\"Menu Bar\").Controls.count\n        Debug.Print \" There are \" &amp; cbControlCount &amp; \" controls in \" &amp; \"Menu Bar\"\n\n        For j = 1 To cbControlCount\n            Debug.Print ActiveWindow.CommandBars(\"Menu Bar\").Controls(j).Caption\n            If ActiveWindow.CommandBars(\"Menu Bar\").Controls(j).Caption = \"button1\" Then\n                button1Found = True\n                Exit For\n            End If\n        Next j\n\n        If button1Found = False Then a123\n\n    Else\n        Debug.Print \"Menu Bar does not exist.\"\n        a123\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1081, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592693838, "creation_date": 1459319172, "last_edit_date": 1592693838, "question_id": 36301235, "link": "https://stackoverflow.com/questions/36301235/outlook-custom-menu-buttons", "title": "Outlook custom menu buttons", "body": "<p>i have 2 menu buttons that i want added in outlook menu after help menu. i made the code to add the buttons but it just adds 2 more buttons every time i reopen outlook even if the 2 menu buttons are there already . Any help is welcomed. </p>\n\n<pre><code>Function ToolBarExists(strName As String) As Boolean\nDim tlbar As commandBar\n    For Each tlbar In ActiveExplorer.CommandBars\n     If tlbar.Name = strName Then\n        ToolBarExists = True\n        Exit For\n    End If\nNext tlbar\nEnd Function\n\nSub TBarExistsbutton1()\n    If ToolBarExists(\"button1\") Then\n        If ActiveExplorer.CommandBars(\"button1\").Visible = True Then\n            ActiveExplorer.CommandBars(\"button1\").Visible = False\n        Else\n            ActiveExplorer.CommandBars(\"button1\").Visible = True\n        End If\n    Else\n        Call a123\n    End If\n\nEnd Sub\nSub TBarExistsbutton2()\n    If ToolBarExists(\"button2\") Then\n        If ActiveExplorer.CommandBars(\"button2\").Visible = True Then\n            ActiveExplorer.CommandBars(\"button2\").Visible = False\n        Else\n            ActiveExplorer.CommandBars(\"button2\").Visible = True\n        End If\n    Else\n        Call a1234\n    End If\n    End Sub\n\nSub a123()\nDim outl As Object\nDim msg As Object\nSet outl = CreateObject(\"Outlook.Application\")\nDim objBar As Office.commandBar\nDim objButton As Office.commandBarButton\nSet objBar = Application.ActiveWindow.CommandBars(\"Menu Bar\")\nSet objButton = objBar.Controls.Add(msoControlButton)\n    With objButton\n    .caption = \"button1\"\n    .onAction = \"macro1\"\n    .faceId = 487\n    .Style = msoButtonIconAndCaption\nEnd With\nEnd Sub\n\nSub a1234()\nDim outl As Object\nDim msg As Object\nSet outl = CreateObject(\"Outlook.Application\")\nDim objBar As Office.commandBar\nDim objButton As Office.commandBarButton\nSet objBar = Application.ActiveWindow.CommandBars(\"Menu Bar\")\nSet objButton = objBar.Controls.Add(msoControlButton)\nWith objButton\n    .caption = \"button2\"\n    .onAction = \"macro2\"\n    .faceId = 487\n    .Style = msoButtonIconAndCaption\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "macros", "vba"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1459319951, "post_id": 36300478, "comment_id": 60227041, "body": "If you have open forms, you can use KeyPress event in forms for calling global key handler"}, {"owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1459320087, "post_id": 36300478, "comment_id": 60227115, "body": "Yes, but I&#39;d like to have the macro called irrespective if and what form is opened."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459330079, "post_id": 36300478, "comment_id": 60233163, "body": "I don&#39;t think you can. There are <code>Application.CreateForm</code> and <code>Application.CreateReport</code>, but nothing alike for macros. <code>CurrentDb.Containers(&quot;Scripts&quot;).Documents</code> gets you all existing macros, but you can&#39;t add through that."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1459333571, "post_id": 36300478, "comment_id": 60235812, "body": "I think you can look at API function RegisterHotKey. At least <a href=\"https://code.msdn.microsoft.com/VBRegisterHotkey-50af3179/sourcecode?fileId=22123&amp;pathId=998247884\" rel=\"nofollow noreferrer\">V6 allows to register</a> hot key for current application. You can register it to hidden form"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1459345159, "creation_date": 1459345159, "answer_id": 36310583, "question_id": 36300478, "link": "https://stackoverflow.com/questions/36300478/is-it-possible-to-create-an-autokeys-macro-with-vba-in-access/36310583#36310583", "title": "Is it possible to create an AutoKeys macro with VBA in Access?", "body": "<p>You could do something like this, create a class called clsCustomForm, containing this code</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate WithEvents frmCustomForm As Form\n\nPublic Function INIT(frmFormToMakeCustom As Form)\n    Set frmCustomForm = frmFormToMakeCustom\n    frmCustomForm.OnKeyDown = \"[Event Procedure]\"\nEnd Function\n\nPrivate Sub frmCustomForm_KeyDown(KeyCode As Integer, Shift As Integer)\n    MsgBox \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>Then in a module, you will need to have a public collection, which you add a class for each form opened and removed when each form closed, I'd suggest a dictionary, with the key as the form name and the item as the class, for example, just testing (limited time) I've used the following code in 1 form, hope this helps, i'll have a bit more time later to show the dictionary if needed.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic CUSTOM_FORM As clsCustomForm\n\nPrivate Sub Form_Load()\n   Set CUSTOM_FORM = New clsCustomForm\n   CUSTOM_FORM.INIT Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1007, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1459345159, "creation_date": 1459316076, "question_id": 36300478, "link": "https://stackoverflow.com/questions/36300478/is-it-possible-to-create-an-autokeys-macro-with-vba-in-access", "title": "Is it possible to create an AutoKeys macro with VBA in Access?", "body": "<p>In an Access application, I'd like to programmatically set up a dynamic key handler to execute a VBA function when this key is pressed.</p>\n\n<p>I was able to manually create a macro that calls the function and another <em>AutoKeys</em> macro that \"calls\" the first macro when a specific key is pressed.</p>\n\n<p>Now, I'd like to be able to create these macros with VBA only. Is this somehow possible?</p>\n\n<p>Of course, if there are other ways to achieve what I want, I am open to suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459317238, "post_id": 36300340, "comment_id": 60225691, "body": "See here <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/vbe.aspx</a> for how to add code programatically in VBA"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459320484, "post_id": 36300340, "comment_id": 60227324, "body": "writing via VBE is fascinating, but I&#39;d avoid it if possibly. if button function is already known at design time, you could code it and assign to each button action property with fully qualified reference (see below) since subs can be called even if residing in different workbooks. you have two ways: either by adding a the &quot;target&quot; sheet (where button resides) a reference to the &quot;base&quot; workbook (where function resides) or by using the <code>Run</code> method (`Application.Run \u201c\u2019BaseMacrosSheet.xlsm\u2019!MacroName\u201d). The former doesn&#39;t require the &quot;base&quot; workbook to be open at runtime while the latter does."}], "answers": [{"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 2, "last_activity_date": 1459322243, "creation_date": 1459322243, "answer_id": 36302100, "question_id": 36300340, "link": "https://stackoverflow.com/questions/36300340/add-function-sub-from-another-function-sub/36302100#36302100", "title": "Add Function\\Sub from another function\\sub", "body": "<p>By default, my approach would be:</p>\n\n<pre><code>Sub first()\n    x = 10\n    if x = 10 Then \n      'Call Another Sub based on the Condition.\n       Call Second()\n    End If\nEnd Sub\n\nSub Second()\n' do stuff\nEnd Sub\n</code></pre>\n\n<p>If you are creating new sheets and adding buttons with code behind them, all of the code, button design, etc. should be done. Any customization would be through parameters.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1459325243, "creation_date": 1459325243, "answer_id": 36303063, "question_id": 36300340, "link": "https://stackoverflow.com/questions/36300340/add-function-sub-from-another-function-sub/36303063#36303063", "title": "Add Function\\Sub from another function\\sub", "body": "<p>This is more about the <em>design</em> of your code. Firstly, you can't put a sub inside another sub, that's just not how it works unfortunately.</p>\n\n<p>What you <em>can</em> do is use <strong>scope</strong> and <strong>conditions</strong> to control the flow of your code and make sure that certain parts are only executed when you want them to be.</p>\n\n<hr>\n\n<p>The easiest, and recommended, method is to just write the other sub anyway but only <em>call</em> it if a certain condition is met.</p>\n\n<pre><code>Public Sub Main_Sub()\n\nDim x As Integer\n\nx = 11 '// Change x to 5 and the other sub won't run\n\nIf x &gt; 10 Then\n    Other_Sub\n    '// Code execution will resume here once 'Other_Sub' has finished\n    MsgBox \"Other Sub complete!\"\nEnd If\n\nEnd Sub\n\nPrivate Sub Other_Sub()\n\n    MsgBox \"You're in the other sub now!\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Another way is to simply exit the sub if your condition isn't met, although this is used more for error handling than conditional execution:</p>\n\n<pre><code>Public Sub Main_Sub()\n\nDim x As Integer\n\nx = 11 '// Change x to 5 and the other sub won't run\n\nIf x &gt; 10 Then\n    Other_Sub\n    '// Code execution will resume here once 'Other_Sub' has finished\n    MsgBox \"Other Sub complete!\"\nElse\n    Exit Sub\nEnd If\n\nMsgBox \"You will only see this message if x was greater than 10!\"\n\nEnd Sub\n\nPrivate Sub Other_Sub()\n\n    MsgBox \"You're in the other sub now!\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>One final method could be using labels, and although it's a viable solution I do advise against it because it severely affects the readability and logic of your code:</p>\n\n<pre><code>Public Sub Main_Sub()\n\nDim x As Integer\n\nx = 11 '// Change x to 5 and the other sub won't run\n\nIf x &lt; 11 Then GoTo Skip_Other_Sub:\n\nOther_Sub\n\nSkip_Other_Sub:\n\nMsgBox \"You will see this regardless of the other sub being run!\"\n\nEnd Sub\n\nPrivate Sub Other_Sub()\n\n    MsgBox \"You're in the other sub now!\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The main point here is that it's better to write <em>all</em> of the code that may or may not be needed and call it conditionally rather than trying to create code \"on the fly\" which is messy at best and requires programmatic access to the VBE which can leave your machine vulnerable if you aren't 100% confident with what you're doing.</p>\n"}], "owner": {"reputation": 391, "user_id": 2194463, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/206d7d3f2b8570783bc0838ba4ad22ea?s=128&d=identicon&r=PG", "display_name": "surendra", "link": "https://stackoverflow.com/users/2194463/surendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459325243, "creation_date": 1459315385, "last_edit_date": 1531164843, "question_id": 36300340, "link": "https://stackoverflow.com/questions/36300340/add-function-sub-from-another-function-sub", "title": "Add Function\\Sub from another function\\sub", "body": "<p>My question may be very foolish. but i would like to know is it possible and how?\nfrom one of the function\\sub can i <strong>create</strong> another sub\\function.</p>\n\n<p>Example:</p>\n\n<pre><code>Sub first()\n    x = 10\n    if x = 10 Then \n      'Add Another Sub based on the Condition in another module.\n       Sub Second()\n       End Sub\n    End If\nEnd Sub\n</code></pre>\n\n<p>My real problem is i am trying add new sheet in a loop based on some condition. if i am able to add sheet, then i need to create some buttons in another sheet, as well as function for those buttons.\nPlease help on this.</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459317457, "post_id": 36299952, "comment_id": 60225803, "body": "What&#39;s the value of <code>datas</code> when it fails? If the sheet name has spaces then add single-quotes around it."}, {"owner": {"reputation": 1, "user_id": 6132707, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216123445072022/picture?type=large", "display_name": "vsrini", "link": "https://stackoverflow.com/users/6132707/vsrini"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459320236, "post_id": 36299952, "comment_id": 60227185, "body": "it&#39;s a a string I use to name the sheet corresponding to my experiment file (e.g. 22MAR_C57B.sfwdat) which doesn&#39;t have any spaces, but I&#39;ll try the single quote thing anyways!  EDIT: didn&#39;t solve the issue, unfortunately. And the debugger is pointing back to the first &quot; series collection&quot;  line as the source of the error"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6132707, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216123445072022/picture?type=large", "display_name": "vsrini", "link": "https://stackoverflow.com/users/6132707/vsrini"}, "edited": false, "score": 0, "creation_date": 1459384726, "post_id": 36302938, "comment_id": 60267574, "body": "thanks for responding! the comma was actually there because I&#39;m only taking information from two cells, not the whole range. Might I have to refer to the two cells entirely separately?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459403512, "post_id": 36302938, "comment_id": 60272901, "body": "While VBA has enough overhead to substitute in the correct operator, the correct string concatenation operator is an ampersand (e.g. <b>&amp;</b>), not a plus (e.g. <b>+</b>)."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459405652, "post_id": 36302938, "comment_id": 60273990, "body": "you&#39;re right. but I just went along with the Op&#39;s style to stress his code substantial modifications only. any how it&#39;s good to point that out."}, {"owner": {"reputation": 1, "user_id": 6132707, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216123445072022/picture?type=large", "display_name": "vsrini", "link": "https://stackoverflow.com/users/6132707/vsrini"}, "edited": false, "score": 0, "creation_date": 1459410508, "post_id": 36302938, "comment_id": 60276897, "body": "@Jeeped switching + to &amp; and that last line of code worked! Thank you so much"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459411287, "post_id": 36302938, "comment_id": 60277410, "body": "you mean that <code>ActiveChart.SeriesCollection(1).Values = &quot;=&quot; &amp; datas &amp; &quot;!$O$75,$O$85&quot;</code> worked? In my &quot;system&quot; it doesn&#39;t. While it does <code>ActiveChart.SeriesCollection(1).Values = &quot;=(&quot; + datas + &quot;!$O$75,&quot; + datas + &quot;!$O$85)&quot;</code> or <code>ActiveChart.SeriesCollection(1).Values = &quot;=(&quot; &amp; datas &amp; &quot;!$O$75,&quot; + datas + &quot;!$O$85)&quot;</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459402335, "last_edit_date": 1459402335, "creation_date": 1459324862, "answer_id": 36302938, "question_id": 36299952, "link": "https://stackoverflow.com/questions/36299952/coding-macro-to-auto-update-chart-data-ranges-keep-getting-runtime-error-1004/36302938#36302938", "title": "Coding macro to auto-update chart data ranges , keep getting Runtime error 1004", "body": "<p><strong>edited</strong> after OP's comments</p>\n\n<pre><code>ActiveChart.SeriesCollection(1).Values = _\n        \"=\" + datas + \"!$O$75,$O$85\"\n</code></pre>\n\n<p>into </p>\n\n<pre><code>ActiveChart.SeriesCollection(1).Values = _\n    \"=(\" + datas + \"!$O$75,\" + datas + \"!$O$85)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6132707, "user_type": "registered", "profile_image": "https://graph.facebook.com/1216123445072022/picture?type=large", "display_name": "vsrini", "link": "https://stackoverflow.com/users/6132707/vsrini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459402335, "creation_date": 1459313504, "last_edit_date": 1459384857, "question_id": 36299952, "link": "https://stackoverflow.com/questions/36299952/coding-macro-to-auto-update-chart-data-ranges-keep-getting-runtime-error-1004", "title": "Coding macro to auto-update chart data ranges , keep getting Runtime error 1004", "body": "<p>I'm new to VBA and trying to code a macro in excel auto-update the data ranges for the charts on the current worsheet to correspond with the active sheet rather than the template I've created, and I'm getting a pretty finnicky run-time error 1004: 'application or object defined error\" I had this macro working earlier with another template, but it has not any more since I changed the ranges to accommodate additional charts on the new template I am using. The line throwing the exception is:</p>\n\n<pre><code>ActiveChart.SeriesCollection(1).XValues = _\n    \"=\" + datas + \"!$F$2:$F$51\" \n</code></pre>\n\n<p>Any suggestions as to how to resolve this?</p>\n\n<pre><code>        Sub app_template_data_update()\n'\n' app_template_data_update Macro\n'\n\n'\n\n    ActiveSheet.Name = ActiveSheet.Range(\"K3\")\n    datas = ActiveSheet.Range(\"K3\")\n    ActiveSheet.ChartObjects(\"Chart 2\").Activate\n    ActiveChart.Axes(xlValue).MajorGridlines.Select\n    ActiveChart.SeriesCollection(1).XValues = _\n        \"=\" + datas + \"!$F$2:$F$51\"\n    ActiveChart.SeriesCollection(1).Values = _\n        \"=\" + datas + \"!$H$2:$H$51\"\n    ActiveChart.SeriesCollection(2).XValues = _\n        \"=\" + datas + \"!$F$52:$F$101\"\n    ActiveChart.SeriesCollection(2).Values = _\n        \"=\" + datas + \"!$H$52:$H$101\"\n\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.Axes(xlValue).MajorGridlines.Select\n    ActiveChart.SeriesCollection(1).XValues = _\n        \"=\" + datas + \"!$F$62:$F$219\"\n    ActiveChart.SeriesCollection(1).Values = _\n        \"=\" + datas + \"!$H$62:$H$219\"\n\n    ActiveSheet.ChartObjects(\"Chart 3\").Activate\n    ActiveChart.Axes(xlValue).MajorGridlines.Select\n    ActiveChart.SeriesCollection(1).XValues = _\n        \"=\" + datas + \"!$K$57:$K$66\"\n    ActiveChart.SeriesCollection(1).Values = _\n        \"=\" + datas + \"!$L$57:$L$66\"\n\n    ActiveSheet.ChartObjects(\"Chart 4\").Activate\n    ActiveChart.PlotArea.Select\n    ActiveChart.SeriesCollection(1).Values = _\n        \"=\" + datas + \"!$O$75,$O$85\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formatting", "cells"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459312496, "post_id": 36299656, "comment_id": 60223779, "body": "Sounds like you would have to modify the cell number format in a Worksheet_Change for each entry; setting the number of decimal place (up to the maximum of 15 significant digits)."}, {"owner": {"reputation": 51, "user_id": 5499063, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a25f79688e9df59225cbd58ac68fd26a?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysStuck", "link": "https://stackoverflow.com/users/5499063/alwaysstuck"}, "edited": false, "score": 0, "creation_date": 1459312961, "post_id": 36299656, "comment_id": 60223938, "body": "Theres several thousands data points so thats why I came here, forgot to mention"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459313253, "post_id": 36299656, "comment_id": 60224044, "body": "So maybe you require a module sub instead of an event macro. Same solution applies."}, {"owner": {"reputation": 51, "user_id": 5499063, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a25f79688e9df59225cbd58ac68fd26a?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysStuck", "link": "https://stackoverflow.com/users/5499063/alwaysstuck"}, "edited": false, "score": 0, "creation_date": 1459313835, "post_id": 36299656, "comment_id": 60224252, "body": "What exactly do you mean by that&gt;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459314156, "post_id": 36299656, "comment_id": 60224387, "body": "I mean that you should start by tapping [alt]+[F11] then typing some code. When you run into trouble, come back to edit your question and include your own effort together with a description of any problems and/or error messages. People coming here asking for code are <b>expected</b> to show their own effort."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459316859, "post_id": 36300602, "comment_id": 60225495, "body": "Good catch! I played with this a bit and couldn&#39;t get it working until I tried <code>0.0##############</code> as a format mask. Of course, the columns need to be wide enough to see all of the digits or <code>########</code> will be displayed."}], "tags": [], "owner": {"reputation": 51, "user_id": 5499063, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a25f79688e9df59225cbd58ac68fd26a?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysStuck", "link": "https://stackoverflow.com/users/5499063/alwaysstuck"}, "is_accepted": false, "score": 2, "last_activity_date": 1459316659, "creation_date": 1459316659, "answer_id": 36300602, "question_id": 36299656, "link": "https://stackoverflow.com/questions/36299656/excel-formatting-to-correct-dp/36300602#36300602", "title": "Excel formatting to correct dp", "body": "<p>Actually you can do it without code, just custom cell format and put 0.,### so it will give at least an integer and any dp if needed. \ne.g. \n   Input         Output\n   12            12\n   4.305         4.305\n   3.2           3.2</p>\n"}], "owner": {"reputation": 51, "user_id": 5499063, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a25f79688e9df59225cbd58ac68fd26a?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysStuck", "link": "https://stackoverflow.com/users/5499063/alwaysstuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1459316659, "creation_date": 1459311748, "question_id": 36299656, "link": "https://stackoverflow.com/questions/36299656/excel-formatting-to-correct-dp", "title": "Excel formatting to correct dp", "body": "<p>I'm looking to format excel cells such that whatever number I put in is the value it displays. i.e. at the moment when typing in 0.69374767047, the value it reads as is 0.69374767. But I also have numbers like; 0.00305 which come out correctly. Is there a way to format the cell so whatever number I put will come out to the correct decimal place and also that there is no 0s on the end of the number, as I need to do things later with that. Any help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1459312538, "creation_date": 1459312538, "answer_id": 36299794, "question_id": 36299470, "link": "https://stackoverflow.com/questions/36299470/adjusting-for-each-variables/36299794#36299794", "title": "Adjusting For Each variables", "body": "<p>When deleting always go backwards to avoid this. For example:</p>\n\n<pre><code>For X = Range(\"A\" &amp; Rows.count).end(xlup).row to 2 step -1\n    If Range(\"A\" &amp; X).Text = \"Delete Me\" then rows(X).delete\nNext\n</code></pre>\n\n<p>We know the first row of the range here: <code>pipelineRange.Row</code> We also know the number of rows in the range here <code>pipelineRange.Rows.Count</code> if we add them together then minus 1 we will get the final row of the range</p>\n\n<p>Something like this perhaps</p>\n\n<pre><code>Sub Something()\nDim X As Long\nFor X = pipelineRange.Row + pipelineRange.Rows.Count - 1 To pipelineRange.Row Step -1\n    For Each cell In Rows(X).Cells\n        If cell.Value = \"EXIT\" Then\n           cell.EntireRow.Copy Destination:=Worksheets(\"EXITS\").Range(\"A\" &amp; Sheets(\"EXITS\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1)\n           Sheets(\"PIPELINE TRACKER\").Activate\n           cell.EntireRow.Delete 'You could change this for rows(X).delete if you like\n        ElseIf cell.Value = 1 Then\n           cell.EntireRow.Copy Destination:=Worksheets(\"COMPLETED\").Range(\"A\" &amp; Sheets(\"COMPLETED\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1)\n           Sheets(\"PIPELINE TRACKER\").Activate\n           cell.EntireRow.Delete 'You could change this for rows(X).delete if you like\n        End If\n    Next\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 2371229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413898460bccc637a67269f826fb36d4?s=128&d=identicon&r=PG", "display_name": "user2371229", "link": "https://stackoverflow.com/users/2371229/user2371229"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 36299794, "answer_count": 1, "score": 0, "last_activity_date": 1459336682, "creation_date": 1459310671, "last_edit_date": 1459336682, "question_id": 36299470, "link": "https://stackoverflow.com/questions/36299470/adjusting-for-each-variables", "title": "Adjusting For Each variables", "body": "<p>I'm having trouble with something I think is fairly basic. Can someone please help?</p>\n\n<p>How can I adjust the \"cell\" value within the For Each loop?  Since I delete a row, my \"cell\" counter gets thrown off and skips a row each time one is removed.</p>\n\n<p>I think I can fix it by adjusting the counter, but need to replace: Set cell = cell - 1</p>\n\n<pre><code>For Each row In pipelineRange.Rows\n  For Each cell In row.Cells\n    If cell.Value = \"EXIT\" Then\n       cell.EntireRow.Copy Destination:=Worksheets(\"EXITS\").Range(\"A\" &amp; Sheets(\"EXITS\").Range(\"B\" &amp; Rows.Count).End(xlUp).row + 1)\n       Sheets(\"PIPELINE TRACKER\").Activate\n       cell.EntireRow.Delete\n       Set cell = cell - 1\n    ElseIf cell.Value = 1 Then\n       cell.EntireRow.Copy Destination:=Worksheets(\"COMPLETED\").Range(\"A\" &amp; Sheets(\"COMPLETED\").Range(\"B\" &amp; Rows.Count).End(xlUp).row + 1)\n       Sheets(\"PIPELINE TRACKER\").Activate\n       cell.EntireRow.Delete\n       Set cell = cell - 1\n    End If\n Next cell\nNext row\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459303213, "post_id": 36297942, "comment_id": 60221083, "body": "Why does this need to be VBA? A formula to the external workbook (even closed) should suffice."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1459303451, "post_id": 36297942, "comment_id": 60221145, "body": "@Jeeped actually i&#39;m doing a generated report, one of my module need 5 criteria  for selection this is the last one"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1459304157, "post_id": 36297942, "comment_id": 60221344, "body": "A lot of the issues with this code occur because you haven&#39;t entered <code>Option Explicit</code> at the top of your module. Try that and the code will bug out in various places because of incorrect object assignment. If you could fix those and re-post the code, we could help you with the rest."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1459304662, "post_id": 36297942, "comment_id": 60221489, "body": "@Ambie tried using <code>Option Explicit</code> no changes. my code is running but once is done nothing happens just my <code>msgbox</code> if the run is complete"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1459305014, "post_id": 36298537, "comment_id": 60221587, "body": "thanks i&#39;m going to try, i actually have a script which i&#39;m using for reference but some logic in not their, on that script the logic is upload the source file then copy data and create a localworkbook for data then close the source file. what i did here is upload the file and in the uploaded update it base on the criteria"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1459305176, "post_id": 36298537, "comment_id": 60221641, "body": "I made some errors where I used wb1 and wb2 instead ws1 and ws2. See edits above."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1459305740, "post_id": 36298537, "comment_id": 60221818, "body": "yap, i noticed it :) question&#39; if i only need one column will it be like this? .Range(&quot;D&quot; &amp; rw).Resize(1) = Selected"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1459306112, "post_id": 36298537, "comment_id": 60221932, "body": "Well, if you only need one column you wouldn&#39;t resize at all but you could say <code>.Resize(1, 1)</code>; that&#39;s just useless code though. You would have to quote the word; e.g. <code>&quot;Selected&quot;</code>."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1459306598, "post_id": 36298537, "comment_id": 60222062, "body": "haha yah it&#39;s just a useless code xD. i just tried it&#39;s now working! thanks @Jeeped your a life saver :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1459305142, "last_edit_date": 1459305142, "creation_date": 1459304667, "answer_id": 36298537, "question_id": 36297942, "link": "https://stackoverflow.com/questions/36297942/vba-match-data-from-another-worksheet-based-on-criteria/36298537#36298537", "title": "VBA - Match Data from another Worksheet based on Criteria", "body": "<p>You cannot open workbooks and assign workbook-type vars to worksheets like that. It also seemed to me that your logic in locating facility names that existed in both workbooks/worksheets was backwards. This opens both workbooks, assigns worksheet-type vars to the first worksheet in each workbook and loops through the entries in the second workbook using the facility there to confirm existence in workbook 1.</p>\n\n<pre><code>Public Sub Selection()\n    Dim lastRow As Long, rw As Long, rngFacility As Range, strRemark As String\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    'TextBox2 and TextBox5 need to be recognized here\n    Set wb1 = Workbooks.Open(TextBox2.Text, ReadOnly:=True)\n    Set ws1 = wb1.Worksheets(1)\n    Set wb2 = Workbooks.Open(TextBox5.Text)\n    Set ws2 = wb2.Worksheets(1)\n\n    lastRow = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set rngFacility = ws1.Range(\"A1:A\" &amp; lastRow)\n    strRemark = \"91%-100% utilization\"\n\n    With ws2\n        lastRow = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        For rw = 2 To lastRow\n            If .Range(\"C\" &amp; rw) = strRemark Then\n                If Not IsError(Application.Match(.Range(\"B\" &amp; rw), rngFacility, 0)) Then\n                    .Range(\"D\" &amp; rw).Resize(1, 2) = _\n                        Array(\"Selected\", \"For Checking\")\n                End If\n            End If\n        Next rw\n    End With\n\n    'wb1.Close savechanges:=False\n    'wb2.Close savechanges:=True\n\nEnd Sub\n</code></pre>\n\n<p>Given the nature of the user-form text boxes and double workbooks, I did not test this from start to finish but it does compile and represents the process I would use to go about this.</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "is_accepted": false, "score": 0, "last_activity_date": 1459482412, "last_edit_date": 1459482412, "creation_date": 1459469248, "answer_id": 36345904, "question_id": 36297942, "link": "https://stackoverflow.com/questions/36297942/vba-match-data-from-another-worksheet-based-on-criteria/36345904#36345904", "title": "VBA - Match Data from another Worksheet based on Criteria", "body": "<p>I just solved this problem using the code i provided.</p>\n\n<pre><code>Public Selection()\n\n       Set Sheet2 = Workbooks.Open(TextBox2.Text).Sheets(1)\n       Set Sheet5 = Workbooks.Open(TextBox5.Text).Sheets(1)\n\n        Dim varFacility As Variant\n        Dim facilityRng As Range\n\n            lngLastRow = Sheet5.Range(\"B\" &amp; Sheet5.Rows.Count).End(xlUp).Row\n            Set facilityRng = Sheet5.Range(\"B1:B\" &amp; lngLastRow)\n\n        For rownum = 2 To Sheet2.Range(\"A\" &amp; Sheet2.Rows.Count).End(xlUp).Row\n            varFacility = Sheet2.Range(\"A\" &amp; rownum).Value\n\n        On Error Resume Next\n            varPosition = Application.WorksheetFunction.Match(varFacility, facilityRng, 0)\n\n            If Err = 0 Then\n\n                If Sheet5.Range(\"C\" &amp; varPosition).Value Like \"91%-100% utilization*\" Then\n                    Sheet2.Range(\"C\" &amp; rownum).Value = \"Selected\"\n                    Sheet2.Range(\"D\" &amp; rownum).Value = \"For Checking\"\n                End If\n            End If\n        On Error GoTo 0\n\n        Next\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 36298537, "answer_count": 2, "score": 1, "last_activity_date": 1459482412, "creation_date": 1459300501, "last_edit_date": 1459308602, "question_id": 36297942, "link": "https://stackoverflow.com/questions/36297942/vba-match-data-from-another-worksheet-based-on-criteria", "title": "VBA - Match Data from another Worksheet based on Criteria", "body": "<p>I have two workbooks, Let's call them <code>Workbook1</code> and <code>Workbook2</code></p>\n\n<p><code>Workbook1</code> : looks like this:(I only put data in Column A)</p>\n\n<pre><code>Facility Name| Column B| Column C |\n   TGG751-M  |         |          |\n   TGG760-M  |         |          |\n   TLY701-M  |         |          |\n</code></pre>\n\n<p><code>Workbook 2</code>: </p>\n\n<pre><code>Technology|  Facility Name |        Remarks        |\n LTE      |   TGG751-M     |  91%-100% utilization |\n LTE      |   TGG760-M     |  91%-100% utilization |\n LTE      |   TLY701-M     |         Red           |\n</code></pre>\n\n<p>I need to match <code>Facility Name</code> in both workbooks and if the <code>Remarks</code> of the matched <code>Facility Name</code> is <code>91%-100% utilization</code> add <code>two columns</code> in <code>WorkBook2</code> and tagged it as <code>Selected</code> and <code>For Checking</code>. </p>\n\n<p>The Output would be like this..</p>\n\n<pre><code> Technology   | Facility Name |        Remarks        | +1 Column | +1 Column\n     LTE      |   TGG751-M    |  91%-100% utilization | Selected  | For Checking\n     LTE      |   TGG760-M    |  91%-100% utilization | Selected  | For Checking\n     LTE      |   TLY701-M    |         Red           |           | \n</code></pre>\n\n<p>My code: </p>\n\n<pre><code>Public Sub Selection()\n\nSet WorkBook1 = Workbooks.Open(TextBox2.Text).Sheets(1)\nSet WorkBook2 = Workbooks.Open(TextBox5.Text).Sheets(1)\n\n        lngLastRow = WorkBook1 .Range(\"A\" &amp; WorkBook1 .Rows.Count).End(xlUp).Row\n\nFor Index = 2 To lngLastRow   \n\n    Dim varFacility As Variant\n    Dim facilityRng As Range\n\n    On Error Resume Next\n\n        lngLastRow = WorkBook1 .Range(\"A\" &amp; WorkBook1 .Rows.Count).End(xlUp).Row\n        Set facilityRng = WorkBook1 .Range(\"A1:A\" &amp; lngLastRow )\n\n        varFacility = WorkBook1 .Range(\"A\" &amp; rownum).Value\n        varPosition = Application.WorksheetFunction.Match(varFacility, facilityRng, 0)\n\n    If Err = 0 Then\n\n        WorkBook1 .Range(\"A\" &amp; rownum).Value = WorkBook2 .Range(\"B\" &amp; varPosition).Value\n\n        If WorkBook2 .Range(\"C\" &amp; rownum).Value Like \"91%-100% utilization*\" Then\n\n           WorkBook2 .Range(\"D\" &amp; rownum).Value = Selected\n           WorkBook2 .Range(\"E\" &amp; rownum).Value = For Checking\n\n    End If\n   End If\n\nEnd Sub\n</code></pre>\n\n<p>How can this be done? Once i run my code its not working but i don't have any error.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6132014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ed016b5a53e6c00e70f5234b7168536?s=128&d=identicon&r=PG&f=1", "display_name": "Andy_NPT", "link": "https://stackoverflow.com/users/6132014/andy-npt"}, "edited": false, "score": 0, "creation_date": 1459296630, "post_id": 36297308, "comment_id": 60219385, "body": "Thank you so much. This answer is perfect."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459298749, "post_id": 36297308, "comment_id": 60219947, "body": "@Andy_NPTdidnt you say you wanted to look at A1:B35? (Hi Ingeborg)."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459300273, "post_id": 36297308, "comment_id": 60220330, "body": "@brettdj, I read it as &quot;monitor column A from row 3 to 35 and change column B&quot;"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1459300634, "post_id": 36297308, "comment_id": 60220424, "body": "Good point, i think you are right.  The target.column part is redundant though as the intersect test has already looked at where the changes range is column a"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1459308345, "post_id": 36297308, "comment_id": 60222548, "body": "Right. I didn&#39;t really look at the details of the code. :P I&#39;ll amend."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459309304, "post_id": 36297308, "comment_id": 60222814, "body": "Always safer to work with the intersect range rather than Target - if only part of Target is inside the intended area (i.e. When multi-cell update occurs) you still end up working on the whole range..."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1459308412, "last_edit_date": 1459308412, "creation_date": 1459296319, "answer_id": 36297308, "question_id": 36297236, "link": "https://stackoverflow.com/questions/36297236/clear-the-cell-of-column-b-if-cell-a-is-empty-range/36297308#36297308", "title": "Clear the cell of column B if cell A is empty - RANGE", "body": "<p>You need to test if the active cell (target) falls in the range A6:A35. Like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nIf not intersect(target, range(\"A6:A35\")) is nothing then\n   If Target.Validation.Type = 3 Then\n      Application.EnableEvents = False\n      Target.Offset(0, 1).ClearContents\n      Application.EnableEvents = True\n   End If\nEnd if\nexitHandler:\n\nEnd Sub\n</code></pre>\n\n<p>You should also indent your code so it is more readable. It will help with loops and IF statements.</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1459317512, "last_edit_date": 1459317512, "creation_date": 1459296583, "answer_id": 36297360, "question_id": 36297236, "link": "https://stackoverflow.com/questions/36297236/clear-the-cell-of-column-b-if-cell-a-is-empty-range/36297360#36297360", "title": "Clear the cell of column B if cell A is empty - RANGE", "body": "<p>something like</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Intersect(Target, Range(\"A6:B35\"))\n\nIf rng1 Is Nothing Then Exit Sub\n\nApplication.EnableEvents = False\nFor Each rng2 In rng1\n    If rng2.Validation.Type = 3 Then rng2.Offset(0, 1).ClearContents\nNext\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6132014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ed016b5a53e6c00e70f5234b7168536?s=128&d=identicon&r=PG&f=1", "display_name": "Andy_NPT", "link": "https://stackoverflow.com/users/6132014/andy-npt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 36297308, "answer_count": 2, "score": 0, "last_activity_date": 1459317512, "creation_date": 1459295881, "last_edit_date": 1531161705, "question_id": 36297236, "link": "https://stackoverflow.com/questions/36297236/clear-the-cell-of-column-b-if-cell-a-is-empty-range", "title": "Clear the cell of column B if cell A is empty - RANGE", "body": "<p>Got a problem and looking for some advice. I've been using the below code for a while now in Excel, it clears the contents of column B if cell A is empty. It works great, but I now need it to work for a specific range (A6:B35). Any ideas?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nIf Target.Column = 1 Then\nIf Target.Validation.Type = 3 Then\nApplication.EnableEvents = False\nTarget.Offset(0, 1).ClearContents\nEnd If\nEnd If\n\nexitHandler:\nApplication.EnableEvents = True\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": false, "score": 1, "last_activity_date": 1459296146, "last_edit_date": 1459296146, "creation_date": 1459295784, "answer_id": 36297222, "question_id": 36297186, "link": "https://stackoverflow.com/questions/36297186/how-to-only-copy-cells-that-have-data-from-one-sheet-to-another-and-not-leave-bl/36297222#36297222", "title": "How to only copy cells that have data from one sheet to another and not leave blanks in between", "body": "<pre><code>    If (Trim$(CStr(.Value)) = \"\") Then \n</code></pre>\n\n<p>If you don't want rows in output area to be skipped,</p>\n\n<ul>\n<li>declare a Long variable to hold destination row number</li>\n<li>initialize it outside the loop to 11</li>\n<li>in the else part, increment the variable and then use it as row number instead of irow + 11</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1459296451, "creation_date": 1459296451, "answer_id": 36297336, "question_id": 36297186, "link": "https://stackoverflow.com/questions/36297186/how-to-only-copy-cells-that-have-data-from-one-sheet-to-another-and-not-leave-bl/36297336#36297336", "title": "How to only copy cells that have data from one sheet to another and not leave blanks in between", "body": "<pre><code>Sub Copy_Values()\n\n    Dim i As Long, d As Long, shtD, shtDL, tmp\n    Dim iMaxRow As Long, iRow As Long\n\n    Set shtD = Worksheets(\"Deficiencies\")\n    Set shtDL = Worksheets(\"Deficiency List\")\n\n    iMaxRow = 1155\n    d = 12\n\n    For iRow = 1 To iMaxRow\n        With shtDL.Cells(iRow, 2)\n            tmp = Trim(.Value)\n            If Len(tmp) &gt; 0 Then\n                shtD.Cells(d, 2).Value = tmp\n                d = d + 1\n            End If\n        End With\n    Next iRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6131881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5649bdddd54e962148d3bf6065f272c?s=128&d=identicon&r=PG&f=1", "display_name": "Rob H.", "link": "https://stackoverflow.com/users/6131881/rob-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459336859, "creation_date": 1459295524, "last_edit_date": 1459336859, "question_id": 36297186, "link": "https://stackoverflow.com/questions/36297186/how-to-only-copy-cells-that-have-data-from-one-sheet-to-another-and-not-leave-bl", "title": "How to only copy cells that have data from one sheet to another and not leave blanks in between", "body": "<p>I have a workbook with 4 worksheets and Sheet4 (titled \"Deficiency List\") is populated in 'column B' with values from other sheets based on different criteria.  The list begins with \"B1\" and goes to \"B1155\".  I would like to only copy the cells that have data in them and not the blanks to Sheet3 (titled \"Deficiencies\") starting at cell \"B12\".  </p>\n\n<p>Example, if there is only data on Sheet4 in cells: B3, B36, B756 and B1005, those would be copied to Sheet3 into cells: B12, B13, B14 and B15.</p>\n\n<p>Here is the code I have to copy the data but it doesn't eliminate the blanks.</p>\n\n<pre><code>Sub Copy_Values()\n\nDim i As Long\nSheets(\"Deficiency List\").Select\niMaxRow = 1155\n\n    For iRow = 1 To iMaxRow\n\n    With Worksheets(\"Deficiency List\").Cells(iRow, 2)\n        ' Check that cell is not empty.\n        If .Value = \"\" Then\n            'Nothing in this cell.\n            'Do nothing.\n        Else\n            ' Copy the cell to the destination\n            Worksheets(\"Deficiencies\").Cells(iRow + 11, 2).Value = .Value\n        End If\n    End With\n\n    Next iRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "call"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459295916, "post_id": 36297148, "comment_id": 60219164, "body": "Best to show the exact code you used."}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459296644, "post_id": 36297148, "comment_id": 60219396, "body": "Did you try Google first?"}, {"owner": {"reputation": 5, "user_id": 5442630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UL7fx.jpg?s=128&g=1", "display_name": "Larry W", "link": "https://stackoverflow.com/users/5442630/larry-w"}, "edited": false, "score": 0, "creation_date": 1459381572, "post_id": 36297148, "comment_id": 60266628, "body": "Inexplicably, when I tried my example on another PC it worked as expected.  --"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": false, "score": 0, "last_activity_date": 1459307880, "creation_date": 1459307880, "answer_id": 36299004, "question_id": 36297148, "link": "https://stackoverflow.com/questions/36297148/workbook-2-macro-calls-workbook-1-macro-fails-with-error-1004/36299004#36299004", "title": "Workbook-2 macro calls Workbook-1 macro fails with error 1004", "body": "<pre><code>   Application.Run \"'test1.xlsm'!macro1\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5442630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UL7fx.jpg?s=128&g=1", "display_name": "Larry W", "link": "https://stackoverflow.com/users/5442630/larry-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1459307880, "creation_date": 1459295379, "question_id": 36297148, "link": "https://stackoverflow.com/questions/36297148/workbook-2-macro-calls-workbook-1-macro-fails-with-error-1004", "title": "Workbook-2 macro calls Workbook-1 macro fails with error 1004", "body": "<p>To demonstrate that it can work, I want to have a macro (tried both Sub and Function) in one workbook (test1.xlsm) that does a simple MsgBox and a macro in a second workbook (test2.xlsm) that calls the first macro (using Application.Run \"test1.xlsm!macro1)\". I have tried putting the macro for both workbooks in ThisWorkbook and in the worksheet View-Code and in the General Alt-F11 Module space. The workbook being called starts out either opened or closed. Regardless, I get error 1004 (macro unavailable or disabled). Numerous web searches proved non-helpful.</p>\n"}, {"tags": ["vba", "ms-access", "module", "wifi", "detect"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459296389, "post_id": 36297043, "comment_id": 60219307, "body": "You can do that with a WMI query from VBA - <code>SELECT * FROM MSNdis_80211_ServiceSetIdentifier WHERE active=true</code>."}, {"owner": {"reputation": 155, "user_id": 4007699, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/93f9766ce5adb803e434905b4fe66da3?s=128&d=identicon&r=PG&f=1", "display_name": "Max Thorley", "link": "https://stackoverflow.com/users/4007699/max-thorley"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459783691, "post_id": 36297043, "comment_id": 60429550, "body": "Apologies for my late reply. just wanted to say thank you! but I&#39;m struggling how to use this in a access query are you able to provide more details? Many thanks"}, {"owner": {"reputation": 419, "user_id": 1140909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RGwua.jpg?s=128&g=1", "display_name": "Alexander Remesch", "link": "https://stackoverflow.com/users/1140909/alexander-remesch"}, "edited": false, "score": 0, "creation_date": 1500642238, "post_id": 36297043, "comment_id": 77442662, "body": "If you just want to have the output of the function GetConnectedSSID() displayed in a field in the Access query thats simple: just write the function name in a field (with parentheses) and then each row will have a field with the connected SSID."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536500052, "post_id": 45218895, "comment_id": 91438331, "body": "This pulls the cached data but doesn&#39;t refresh/update the list."}], "tags": [], "owner": {"reputation": 419, "user_id": 1140909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RGwua.jpg?s=128&g=1", "display_name": "Alexander Remesch", "link": "https://stackoverflow.com/users/1140909/alexander-remesch"}, "is_accepted": false, "score": 3, "last_activity_date": 1500563908, "creation_date": 1500563908, "answer_id": 45218895, "question_id": 36297043, "link": "https://stackoverflow.com/questions/36297043/access-vba-obtain-wireless-network-name-connected/45218895#45218895", "title": "ACCESS VBA - Obtain Wireless Network Name (Connected)", "body": "<p>After some more research, I found the following link: <a href=\"http://www.vbforums.com/showthread.php?547916-List-available-wireless-networks-(using-WMI)-Help-pls\" rel=\"nofollow noreferrer\">http://www.vbforums.com/showthread.php?547916-List-available-wireless-networks-(using-WMI)-Help-pls</a></p>\n\n<p>If you scroll down to post #19 there is a code fragment using Native Wifi API, I adapted to the following code fragment where Function GetConnectedSSID() will return the SSID of the currently connected Wifi network:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const DOT11_SSID_MAX_LENGTH As Long = 32\nPrivate Const WLAN_MAX_PHY_TYPE_NUMBER As Long = 8\nPrivate Const WLAN_AVAILABLE_NETWORK_CONNECTED As Long = 1\nPrivate Const WLAN_AVAILABLE_NETWORK_HAS_PROFILE As Long = 2\n\nPrivate Type GUID\n    data1 As Long\n    data2 As Integer\n    data3 As Integer\n    data4(7) As Byte\nEnd Type\n\nPrivate Type WLAN_INTERFACE_INFO\n    ifGuid As GUID\n    InterfaceDescription(255) As Byte\n    IsState As Long\nEnd Type\n\nPrivate Type DOT11_SSID\n    uSSIDLength As Long\n    ucSSID(DOT11_SSID_MAX_LENGTH - 1) As Byte\nEnd Type\n\nPrivate Type WLAN_AVAILABLE_NETWORK\n    strProfileName(511) As Byte\n    dot11Ssid As DOT11_SSID\n    dot11BssType As Long\n    uNumberOfBssids As Long\n    bNetworkConnectable As Long\n    wlanNotConnectableReason As Long\n    uNumberOfPhyTypes As Long\n    dot11PhyTypes(WLAN_MAX_PHY_TYPE_NUMBER - 1) As Long\n    bMorePhyTypes As Long\n    wlanSignalQuality As Long\n    bSEcurityEnabled As Long\n    dot11DefaultAuthAlgorithm As Long\n    dot11DefaultCipherAlgorithm As Long\n    dwflags As Long\n    dwreserved As Long\nEnd Type\n\nPrivate Type WLAN_INTERFACE_INFO_LIST\n    dwNumberOfItems As Long\n    dwIndex As Long\n    InterfaceInfo As WLAN_INTERFACE_INFO\nEnd Type\n\nPrivate Type WLAN_AVAILABLE_NETWORK_LIST\n    dwNumberOfItems As Long\n    dwIndex As Long\n    Network As WLAN_AVAILABLE_NETWORK\nEnd Type\n\nPrivate Declare Function WlanOpenHandle Lib \"wlanapi.dll\" (ByVal dwClientVersion As Long, _\n                ByVal pdwReserved As Long, _\n                ByRef pdwNegotiaitedVersion As Long, _\n                ByRef phClientHandle As Long) As Long\n\nPrivate Declare Function WlanEnumInterfaces Lib \"wlanapi.dll\" (ByVal hClientHandle As Long, _\n                ByVal pReserved As Long, _\n                ppInterfaceList As Long) As Long\n\nPrivate Declare Function WlanGetAvailableNetworkList Lib \"wlanapi.dll\" (ByVal hClientHandle As Long, _\n                pInterfaceGuid As GUID, _\n                ByVal dwflags As Long, _\n                ByVal pReserved As Long, _\n                ppAvailableNetworkList As Long) As Long\n\nPrivate Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (Destination As Any, _\n                Source As Any, _\n                ByVal Length As Long)\n\nPrivate Declare Sub WlanFreeMemory Lib \"wlanapi.dll\" (ByVal pMemory As Long)\n\nPublic Function GetConectedSSID() As String\n    Dim lngReturn As Long\n    Dim lngHandle As Long\n    Dim lngVersion As Long\n    Dim lngList As Long\n    Dim lngAvailable As Long\n    Dim lngStart As Long\n    Dim intCount As Integer\n    Dim strSSID As String\n    Dim strProfile As String\n    Dim udtList As WLAN_INTERFACE_INFO_LIST\n    Dim udtAvailableList As WLAN_AVAILABLE_NETWORK_LIST\n    Dim udtNetwork As WLAN_AVAILABLE_NETWORK\n    '\n    ' Get a Handle\n    '\n    lngReturn = WlanOpenHandle(2&amp;, 0&amp;, lngVersion, lngHandle)\n    If lngReturn = 0 Then\n        '\n        ' Enumerate the Interfaces\n        ' (Note: this code only looks at the first interface)\n        '\n        lngReturn = WlanEnumInterfaces(ByVal lngHandle, 0&amp;, lngList)\n        CopyMemory udtList, ByVal lngList, Len(udtList)\n        '\n        ' Get the list of available Networks\n        '\n        lngReturn = WlanGetAvailableNetworkList(lngHandle, udtList.InterfaceInfo.ifGuid, 2&amp;, 0&amp;, lngAvailable)\n        CopyMemory udtAvailableList, ByVal lngAvailable, LenB(udtAvailableList)\n        intCount = 0\n        lngStart = lngAvailable + 8\n        Do\n            '\n            ' Populate the Available network structure\n            '\n            CopyMemory udtNetwork, ByVal lngStart, Len(udtNetwork)\n            '\n            ' Display the Data for this Network\n            '\n            strProfile = ByteToString(udtNetwork.strProfileName)\n            strProfile = Left$(strProfile, InStr(strProfile, Chr(0)) - 1)\n            strSSID = ByteToString(udtNetwork.dot11Ssid.ucSSID, udtNetwork.dot11Ssid.uSSIDLength, False)\n            strSSID = Left(strSSID, InStr(strSSID, Chr(0)) - 1)\n            If (udtNetwork.dwflags And WLAN_AVAILABLE_NETWORK_CONNECTED) = WLAN_AVAILABLE_NETWORK_CONNECTED Then\n                'Debug.Print \"Profile \"; strProfile, \"SSID \"; strSSID, \"Connected \"; udtNetwork.dwflags\n                GetConectedSSID = strSSID\n            End If\n            intCount = intCount + 1\n            lngStart = lngStart + Len(udtNetwork)\n            '\n            ' Process all available networks\n            '\n        Loop Until intCount = udtAvailableList.dwNumberOfItems\n        WlanFreeMemory lngAvailable\n        WlanFreeMemory lngList\n    End If\nEnd Function\n\nPrivate Function ByteToString(bytArray() As Byte, Optional lngLen As Long = 0, Optional boConvert As Boolean = True) As String\n    Dim strTemp As String\n    Dim intI As Integer\n    Dim intEnd As Integer\n    If lngLen = 0 Then\n        intEnd = UBound(bytArray)\n    Else\n        intEnd = lngLen\n    End If\n    For intI = 0 To intEnd\n        strTemp = strTemp &amp; Chr(bytArray(intI))\n    Next intI\n    If boConvert = True Then strTemp = StrConv(strTemp, vbFromUnicode)\n    ByteToString = strTemp\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 4007699, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/93f9766ce5adb803e434905b4fe66da3?s=128&d=identicon&r=PG&f=1", "display_name": "Max Thorley", "link": "https://stackoverflow.com/users/4007699/max-thorley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1596092337, "creation_date": 1459294725, "question_id": 36297043, "link": "https://stackoverflow.com/questions/36297043/access-vba-obtain-wireless-network-name-connected", "title": "ACCESS VBA - Obtain Wireless Network Name (Connected)", "body": "<p>Is it possible to detect the users Wifi network (SSID) they are connected to via vba? in Access 2010</p>\n\n<p>Many thanks\nMax </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1459294299, "post_id": 36296970, "comment_id": 60218710, "body": "What type(s) of files ?  Keywords in the content of the files, or the file names ?"}, {"owner": {"reputation": 1, "user_id": 6131882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038cc1da476a75e551f4df338af1a669?s=128&d=identicon&r=PG&f=1", "display_name": "Xcr1000", "link": "https://stackoverflow.com/users/6131882/xcr1000"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459362624, "post_id": 36296970, "comment_id": 60257136, "body": "First thank you for the help. The files are .pdf .doc .txt (could be more type later on) . The Keyword would only be for the file name. Right now I have a Excel sheet that runs the code above and pulls all of the file names then the sheet is setup (with the normal Excel search and match commands) to find witch ones have the Keyword in it. I am trying to do the same thing just with VBA. The folder that I am pulling from had 2000 + files and growing"}], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459317473, "creation_date": 1459317473, "answer_id": 36300812, "question_id": 36296970, "link": "https://stackoverflow.com/questions/36296970/how-to-use-keyword-to-make-a-list-of-file-paths/36300812#36300812", "title": "How to use Keyword to make a list of file paths", "body": "<p>You can use Instr() to check if the keyword is in the filename:</p>\n\n<pre><code>If Len(InStr(1, objFile.Path, \"KEYWORD\", vbTextCompare)) &gt; 0 Then\n</code></pre>\n\n<p>InStr returns the Position of the substring if it is found, if not, it will return 0.\nUse this in the For Each loop.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1459369337, "creation_date": 1459369337, "answer_id": 36318969, "question_id": 36296970, "link": "https://stackoverflow.com/questions/36296970/how-to-use-keyword-to-make-a-list-of-file-paths/36318969#36318969", "title": "How to use Keyword to make a list of file paths", "body": "<pre><code>Sub File_List()\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim i As Integer\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(\"C:\\user\\temp\")\n    i = 1\n\n    For Each objFile In objFolder.Files\n        If LCase(objFile.Name) Like \"*keywordhere*\" Then\n            Cells(i + 1, 1) = objFile.Path\n            Cells(i + 1, 2) = objFile.Name\n            i = i + 1\n        End If\n    Next objFile\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6131882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038cc1da476a75e551f4df338af1a669?s=128&d=identicon&r=PG&f=1", "display_name": "Xcr1000", "link": "https://stackoverflow.com/users/6131882/xcr1000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459369337, "creation_date": 1459294244, "last_edit_date": 1459294312, "question_id": 36296970, "link": "https://stackoverflow.com/questions/36296970/how-to-use-keyword-to-make-a-list-of-file-paths", "title": "How to use Keyword to make a list of file paths", "body": "<p>I am a new to VBA and do not have any formal training but have been able to do a few thing by copy and modify code to what I need. I need some help to modify this one. As it stand now this puts all the file path in the column A for all files that are in the folder. What I am looking to do is just get the files path of the files that contain a keyword. Thank you for any help you can give me.</p>\n\n<pre><code>Sub File_List()\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim i As Integer\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"C:\\user\\temp\")\ni = 1\nFor Each objFile In objFolder.Files\nCells(i + 1, 1) = objFile.path\n    i = i + 1\nNext objFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459293713, "post_id": 36296811, "comment_id": 60218520, "body": "Take out the <code>Exit For</code> statements in <code>FindInFolders</code> and put the results in some sort of collection container instead."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1459301629, "post_id": 36296811, "comment_id": 60220688, "body": "To search &quot;Multiple folders with the name &quot;April&quot; within primary mailbox&quot; then separately &quot;Multiple folders with the name &quot;April&quot; within archives. <a href=\"http://stackoverflow.com/questions/27189429/searching-for-a-folder-in-outlook-folders-multiple-outcomes\" title=\"searching for a folder in outlook folders multiple outcomes\">stackoverflow.com/questions/27189429/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 6131852, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bVHT2OuMVsY/AAAAAAAAAAI/AAAAAAAAADo/uPxb5VMpaYQ/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/6131852/matt"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1459370247, "post_id": 36296811, "comment_id": 60261752, "body": "@niton with the code provided in the link, macro fails with &quot;Object Required&quot; when inside Loopfolders Sub at &lt;code&gt;If Not MyFolder Is Nothing Then Exit For&lt;/code&gt;"}, {"owner": {"reputation": 15, "user_id": 6131852, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bVHT2OuMVsY/AAAAAAAAAAI/AAAAAAAAADo/uPxb5VMpaYQ/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/6131852/matt"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459886870, "post_id": 36296811, "comment_id": 60486776, "body": "@Comintern Which Exit For statements as there are two"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1460491958, "creation_date": 1460491958, "answer_id": 36583160, "question_id": 36296811, "link": "https://stackoverflow.com/questions/36296811/find-a-folder-misplaced-in-outlook/36583160#36583160", "title": "Find a Folder Misplaced in Outlook", "body": "<p>Verify whether the folder has been found before leaving the FindInFolders function.</p>\n\n<pre><code>Sub FindFolderByName()\n\n    Dim Name As String\n    Dim FoundFolder As Folder\n\n    Name = InputBox(\"Find Name:\", \"Search Folder\")\n    If Len(Trim$(Name)) = 0 Then Exit Sub\n\n    ' Session.Folders is too broad\n    ' With Toggle Offline you probably have it narrowed down\n    '  to the folders you are interested in.\n    Set FoundFolder = FindInFolders(Session.Folders, Name)\n\n    ' Alternatives are PickFolder and hardcoding the folder\n    'Set FoundFolder = FindInFolders(Session.GetDefaultFolder(olFolderInbox).Folders, Name)\n\n    If FoundFolder Is Nothing Then\n        ' Move the confirmation inside the function\n        ' so the search does not end prematurely\n         MsgBox \"Not Found\", vbInformation\n    End If\n\n    Set FoundFolder = Nothing\n\n    Debug.Print \"Done.\"\n\nEnd Sub\n\nFunction FindInFolders(TheFolders As Outlook.Folders, Name As String)\n\n    'Dim SubFolder As Outlook.MAPIFolder\n    Dim SubFolder As Folder ' 2007 and subsequent\n\n    'On Error Resume Next\n    ' Only for a specific purpose and followed closely by\n    'On Error GoTo 0\n\n    Set FindInFolders = Nothing\n\n    For Each SubFolder In TheFolders\n        ' Stay online to see\n        '  the many unfamiliar folders in Session.Folders\n         Debug.Print \" - \" &amp; SubFolder\n\n        If LCase(SubFolder.Name) Like LCase(Name) Then\n\n            Set FindInFolders = SubFolder\n            Set ActiveExplorer.CurrentFolder = FindInFolders\n\n            If MsgBox(\"Activate Folder: \" &amp; vbCrLf &amp; FindInFolders.FolderPath, vbQuestion Or vbYesNo) = vbYes Then\n                Exit For\n            End If\n\n        Else\n\n            Set FindInFolders = FindInFolders(SubFolder.Folders, Name)\n            If Not FindInFolders Is Nothing Then Exit For\n\n        End If\n\n    Next\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6131852, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bVHT2OuMVsY/AAAAAAAAAAI/AAAAAAAAADo/uPxb5VMpaYQ/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/6131852/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 36583160, "answer_count": 1, "score": 0, "last_activity_date": 1593518975, "creation_date": 1459293391, "last_edit_date": 1593518975, "question_id": 36296811, "link": "https://stackoverflow.com/questions/36296811/find-a-folder-misplaced-in-outlook", "title": "Find a Folder Misplaced in Outlook", "body": "<p>I am currently working on a VBA code in Outlook to run as a macro that will help find a folder that was moved in error from the main mailbox, secondary mailbox or even archive mailbox (PST). </p>\n\n<p>Currently the code when ran will toggle outlook offline, ask you for the folder name(which can be partial as wildcard search is implemented), returns the first instance found of the name and takes you to the folder and finally restores Outlook to online mode.</p>\n\n<p>I am trying to figure out the process to have it iterate all instances of the search (ex. Multiple folders with the name \"April\" within primary mailbox and archives). I know it may require a do until loop with a counter specified but am unsure how to implement.</p>\n\n<p>Here is the current working code:</p>\n\n<pre><code>Sub ToggleWorkOfflineMode()\nDim OutApp As Object\nSet OutApp = CreateObject(\"Outlook.Application\")\nIf Not OutApp.Session.Offline = True Then\nIf MsgBox(\"Do you want to enable Work Offline Status?\", vbQuestion Or vbYesNo) = vbYes Then\nOutApp.GetNamespace(\"MAPI\").Folders.GetFirst.GetExplorer.CommandBars.FindControl(, 5613).Execute\nElse\nMsgBox \"Status Not Changed.\", vbInformation\nEnd If\nElse\nIf MsgBox(\"Do you Want to disable Work Offline Status?\", vbQuestion Or vbYesNo) = vbNo Then\nMsgBox \"Working offline\", vbInformation\nElse\nOutApp.GetNamespace(\"MAPI\").Folders.GetFirst.GetExplorer.CommandBars.FindControl(, 5613).Execute\nEnd If\nEnd If\nEnd Sub\nSub FindFolderByName()\n    Dim Name As String\n    Dim FoundFolder As Folder\n\n    Name = InputBox(\"Find Name:\", \"Search Folder\")\n    If Len(Trim$(Name)) = 0 Then Exit Sub\n\n    Set FoundFouder = FindInFolders(Application.Session.Folders, Name)\n\n    If Not FoundFouder Is Nothing Then\n        If MsgBox(\"Activate Folder: \" &amp; vbCrLf &amp; FoundFouder.FolderPath, vbQuestion Or vbYesNo) = vbYes Then\n            Set Application.ActiveExplorer.CurrentFolder = FoundFouder\n        End If\n    Else\n        MsgBox \"Not Found\", vbInformation\n    End If\nEnd Sub\nFunction FindInFolders(TheFolders As Outlook.Folders, Name As String)\n    Dim SubFolder As Outlook.MAPIFolder\n\n    On Error Resume Next\n\n    Set FindInFolders = Nothing\n\n    For Each SubFolder In TheFolders\n        If LCase(SubFolder.Name) Like LCase(Name) Then\n            Set FindInFolders = SubFolder\n            Exit For\n        Else\n            Set FindInFolders = FindInFolders(SubFolder.Folders, Name)\n            If Not FindInFolders Is Nothing Then Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1459291524, "post_id": 36296433, "comment_id": 60217781, "body": "Delete this line: <code>ActiveSheet.Shapes.Range(Array(&quot;textEnemy&quot;)).Select</code>? Work with the object directly."}, {"owner": {"reputation": 43, "user_id": 6127620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a902d529950429e6597cb8ed1b7abcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/6127620/ilan"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459299706, "post_id": 36296433, "comment_id": 60220187, "body": "My issue is that it doesn&#39;t seem to work if I try to work with it directly."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6127620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a902d529950429e6597cb8ed1b7abcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/6127620/ilan"}, "edited": false, "score": 0, "creation_date": 1459296486, "post_id": 36296678, "comment_id": 60219334, "body": "Thank you, but I tried this before posting and it doesn&#39;t work. I am getting an &quot;Object doesn&#39;t support this property or method&quot; error with &quot;With .ShapeRange(1).TextFrame2.TextRange.Characters&quot; highlighted."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1459292639, "creation_date": 1459292639, "answer_id": 36296678, "question_id": 36296433, "link": "https://stackoverflow.com/questions/36296433/how-can-i-change-the-text-size-in-excel-using-vba-without-selecting-the-shape/36296678#36296678", "title": "How can I change the text size in Excel using VBA without selecting the shape?", "body": "<p>As @findwindow says:</p>\n\n<pre><code>With ActiveSheet.Shapes.Range(Array(\"textEnemy\"))\n\n    .Visible = True\n\n    With .ShapeRange(1).TextFrame2.TextRange.Characters\n        .Text = msg\n        For i = 1 To 15\n            .Font.Size = i * 10\n            Call WasteTime(50)\n        Next\n    End With\n\n    .Visible = False\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 6127620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a902d529950429e6597cb8ed1b7abcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/6127620/ilan"}, "is_accepted": true, "score": 1, "last_activity_date": 1459313163, "creation_date": 1459313163, "answer_id": 36299897, "question_id": 36296433, "link": "https://stackoverflow.com/questions/36296433/how-can-i-change-the-text-size-in-excel-using-vba-without-selecting-the-shape/36299897#36299897", "title": "How can I change the text size in Excel using VBA without selecting the shape?", "body": "<p>I found a solution. I had to set the textbox as a shape variable, and then adjust it.</p>\n\n<pre><code>Sub Animate(playerCode As Integer)\n    Dim i As Integer\n    Dim msg As String\n    Dim textBox As Shape\n    msg = \"HIT!\"\n\n    Set textBox = ActiveSheet.Shapes(\"textUser\")\n\n    'Animate textbox\n    textBox.Visible = True\n    With textBox.TextFrame2.TextRange.Characters\n        .Text = msg\n        For i = 1 To 15\n            .Font.Size = i * 10\n            Call WasteTime(50)\n        Next\n    End With\n    textBox.Visible = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6127620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a902d529950429e6597cb8ed1b7abcf4?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/6127620/ilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2094, "favorite_count": 0, "accepted_answer_id": 36299897, "answer_count": 2, "score": 1, "last_activity_date": 1459313163, "creation_date": 1459291459, "question_id": 36296433, "link": "https://stackoverflow.com/questions/36296433/how-can-i-change-the-text-size-in-excel-using-vba-without-selecting-the-shape", "title": "How can I change the text size in Excel using VBA without selecting the shape?", "body": "<p>I am trying to change the text size in a textbox in Excel using VBA. I currently have the following code:</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"textEnemy\")).Visible = True\nActiveSheet.Shapes.Range(Array(\"textEnemy\")).Select\nWith Selection.ShapeRange(1).TextFrame2.TextRange.Characters\n    .Text = msg\n    For i = 1 To 15\n        .Font.Size = i * 10\n        Call WasteTime(50)\n    Next\nEnd With\nActiveSheet.Shapes.Range(Array(\"textEnemy\")).Visible = False\n</code></pre>\n\n<p>This code animates the text increasing in size, and then it disappears. The problem is that when I run this code the textbox is selected (there is a box around it). How can I achieve the same goal without selecting the textbox/showing the selection border around it?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1459292108, "post_id": 36296257, "comment_id": 60217992, "body": "Please explain &quot;move fields to values&quot;, it doesn&#39;t really make sense..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459293283, "post_id": 36296257, "comment_id": 60218399, "body": "What do you define as the &quot;active&quot; pivot table ?"}, {"owner": {"reputation": 19, "user_id": 5916440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XVEg21C3E6w/AAAAAAAAAAI/AAAAAAAACik/s8XzSDnSIYU/photo.jpg?sz=128", "display_name": "roncruiser", "link": "https://stackoverflow.com/users/5916440/roncruiser"}, "edited": false, "score": 0, "creation_date": 1459294291, "post_id": 36296257, "comment_id": 60218708, "body": "Essentially, I want to move the same fields for each pivot table over to the values area using VBA.  &quot;Active&quot; meaning the active cell within the pivot table.  In other words, I&#39;ve clicked on a cell within the pivot table I want to use the macro for since there are multiple pivot tables on a single worksheet."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1459294372, "post_id": 36296257, "comment_id": 60218732, "body": "Ah, ok, now I understand. Thanks."}, {"owner": {"reputation": 19, "user_id": 5916440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XVEg21C3E6w/AAAAAAAAAAI/AAAAAAAACik/s8XzSDnSIYU/photo.jpg?sz=128", "display_name": "roncruiser", "link": "https://stackoverflow.com/users/5916440/roncruiser"}, "edited": false, "score": 0, "creation_date": 1459294685, "post_id": 36296257, "comment_id": 60218834, "body": "I&#39;m very new to VBA and learning on the fly.   I believe I know how to move the fields over to the value area, but I do not know how to properly reference the pivot table name within VBA without going in and changing the name manually."}, {"owner": {"reputation": 128, "user_id": 6126320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799da10c476eb27de21b29879aa590f4?s=128&d=identicon&r=PG&f=1", "display_name": "leowyn", "link": "https://stackoverflow.com/users/6126320/leowyn"}, "edited": false, "score": 0, "creation_date": 1459308494, "post_id": 36296257, "comment_id": 60222590, "body": "If all you want to change from one iteration to the next is the pivot table name, try writing it as a Sub, where you pass the pivot table name in as an argument, then use that argument (in place of the pivot table name) in all of the formatting code.  Then just call the sub for each pivot table you want to format."}, {"owner": {"reputation": 394, "user_id": 3399849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392e8c03cbd2e1464e34aed3728e3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nybbe", "link": "https://stackoverflow.com/users/3399849/nybbe"}, "edited": false, "score": 0, "creation_date": 1459316439, "post_id": 36296257, "comment_id": 60225303, "body": "I don&#39;t understand what it is you want to do. You want all the pivot-tables to be synchronized somehow? When you change something in one pivot, it should happen the same in the others (add column, remove a column, change order, change sorting, change filtering Etc..). Looks to me that it will be far easier to gather the data in one sheet adding a column with the &quot;title&quot; you have in column A, and then make one pivot of it all."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5916440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XVEg21C3E6w/AAAAAAAAAAI/AAAAAAAACik/s8XzSDnSIYU/photo.jpg?sz=128", "display_name": "roncruiser", "link": "https://stackoverflow.com/users/5916440/roncruiser"}, "edited": false, "score": 0, "creation_date": 1459364942, "post_id": 36300697, "comment_id": 60258622, "body": "Thanks Tim...  It was enough to get me started indeed!"}, {"owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 0, "creation_date": 1600846028, "post_id": 36300697, "comment_id": 113213180, "body": "Nice solution Tim. May I have just one question? Inside the function you declared an &quot;rv&quot; Variant variable. Does it make anything or is it some leftover?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 1, "creation_date": 1600874492, "post_id": 36300697, "comment_id": 113227801, "body": "@MrZH6 - just a left-over.  I&#39;ve edited to remove it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1600874466, "last_edit_date": 1600874466, "creation_date": 1459316997, "answer_id": 36300697, "question_id": 36296257, "link": "https://stackoverflow.com/questions/36296257/active-pivot-table-name/36300697#36300697", "title": "Active Pivot Table Name", "body": "<p>See <a href=\"http://peltiertech.com/referencing-pivot-table-ranges-in-vba/\" rel=\"nofollow noreferrer\">http://peltiertech.com/referencing-pivot-table-ranges-in-vba/</a>  for a good overview of how to address the various parts of a pivot table.</p>\n<p>This should get you started:</p>\n<pre><code>Sub Tester()\n    \n    Dim pt As PivotTable\n    \n    Set pt = ActivePivotTable\n    \n    If pt Is Nothing Then\n        Debug.Print &quot;No Active pivot table&quot;\n    Else\n        Debug.Print &quot;Active = &quot; &amp; pt.Name\n        'work on pt...\n    End If\n\nEnd Sub\n\n'get the pivot table which contains the current selection\nFunction ActivePivotTable() As PivotTable\n    Dim pt As PivotTable\n    For Each pt In ActiveSheet.PivotTables\n        Debug.Print pt.Name, pt.TableRange2.Address\n        If Not Intersect(Selection, pt.TableRange2) Is Nothing Then\n            Set ActivePivotTable = pt\n            Exit Function\n        End If\n    Next pt\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5916440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XVEg21C3E6w/AAAAAAAAAAI/AAAAAAAACik/s8XzSDnSIYU/photo.jpg?sz=128", "display_name": "roncruiser", "link": "https://stackoverflow.com/users/5916440/roncruiser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4686, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1600874466, "creation_date": 1459290593, "last_edit_date": 1531164843, "question_id": 36296257, "link": "https://stackoverflow.com/questions/36296257/active-pivot-table-name", "title": "Active Pivot Table Name", "body": "<p>I have a worksheet with multiple Pivot Tables.  All the pivot tables are formatted the same way.</p>\n\n<p>How do I move multiple fields to values using VBA for active pivot table in the worksheet?</p>\n\n<p>I tried recording a macro to move the fields to values but end up having to manually change the pivot table name in the VBA code when I want to use the macro for another pivot table.  I'd like to avoid having to go in and change the pivot table name manually.</p>\n\n<p>You can see in the screen capture, I manually drag the \"Value\" in the field list to the \"VALUES\" area for each of the pivot tables.</p>\n\n<p>It's a repetitive task I'd like to automate using VBA but each of the pivot tables have unique names.</p>\n\n<p><a href=\"http://i.stack.imgur.com/dYNxB.jpg\" rel=\"nofollow\">Excel Screen Capture</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1459291030, "post_id": 36296252, "comment_id": 60217591, "body": "Can you protect the sheet? That way the users could only clear contents from unlocked cells (select cells -&gt; right-click and select Format Cells -&gt; Protection -&gt; unchecked &quot;Locked&quot; -&gt; OK and then protect the sheet)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459291435, "post_id": 36296252, "comment_id": 60217749, "body": "Use <code>worksheet_change</code>? If cell is getting deleted, grab the formula, clear cell then put formula back."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459291445, "post_id": 36296252, "comment_id": 60217754, "body": "Possible, but all 3 of these methods would require hooking into the Windows event dispatching for Excel and monitoring the user inputs that would cause the cells to clear.  A ton of work compared to the rubber hose method, but if you want to explore it <a href=\"http://stackoverflow.com/a/11154285/4088852\">this post</a> will get you started toward the relevant APIs."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459291655, "post_id": 36296252, "comment_id": 60217837, "body": "@findwindow - Unfortunately, <code>Worksheet_Change</code> fires <i>after</i> the content is already gone.  AFAIK, the only Worksheet events that allow cancellation are <code>BeforeRightClick</code> and <code>BeforeDoubleClick</code>, and <code>BeforeDoubleClick</code> would fire <i>before</i> the context menu was displayed, so it wouldn&#39;t be a lot of help."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459291724, "post_id": 36296252, "comment_id": 60217868, "body": "@Comintern that&#39;s why there&#39;s <code>application.undo</code> ~_^"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459291962, "post_id": 36296252, "comment_id": 60217939, "body": "@findwindow - Also why there&#39;s the rubber hose."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1459293056, "post_id": 36296252, "comment_id": 60218337, "body": "Use <code>Worksheet_Change</code> to recreate <i>all</i> of the formulas whenever there&#39;s a change which intersects with <i>any</i> of the cells containing a formula"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1459293378, "post_id": 36296252, "comment_id": 60218421, "body": "@barrowc - Easier said than done.  How do you easily figure out what&#39;s missing if entire rows or columns get deleted? For example, if I delete column B:B, the contents that are in the Range that gets passed to <code>Worksheet_Change</code> are what used to be in C:C before the event handler gets it."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1459293767, "post_id": 36296252, "comment_id": 60218537, "body": "@Comintern - fair point but the question seems to be specifically about clearing contents and not about deleting cells. The Protect Sheet options can be used to prevent deletion of cells while still allowing clearing of contents"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1459294063, "post_id": 36296252, "comment_id": 60218626, "body": "Raul, even if you get it to work, that will mean that a macro has to run every time the workshet changes, to check if cells were cleared. (On the Worksheet_change event.) This means your users will have <b>no undo</b>. Undo history will be constantly cleared. this is worse than anything you could do to your users. So, in my opinion, there is no good programmable solution. The solution is upgrading your users, not your table. Teach them a better way to clear only the used cells."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1459294280, "post_id": 36296252, "comment_id": 60218700, "body": "You could use a Table, place your calculations next to the table (make sure they are not part of the table), and teach your users to select table rows instead of full rows before deleting."}, {"owner": {"reputation": 11, "user_id": 6131616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a0f1bb68f45dc76e703d702a34b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Raul", "link": "https://stackoverflow.com/users/6131616/raul"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1459461785, "post_id": 36296252, "comment_id": 60310996, "body": "@tigeravatar - I think I&#39;ve already tried what you are suggesting, but it didn&#39;t work out for my users. See the 1st item in the &quot;Things I&#39;ve tried&quot; section. If I misunderstood your suggestion, please let me know."}, {"owner": {"reputation": 11, "user_id": 6131616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a0f1bb68f45dc76e703d702a34b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Raul", "link": "https://stackoverflow.com/users/6131616/raul"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459461844, "post_id": 36296252, "comment_id": 60311016, "body": "@Comintern - Thanks for the suggestion and the link. I&#39;ll definitely try the rubber hose. :)"}, {"owner": {"reputation": 11, "user_id": 6131616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a0f1bb68f45dc76e703d702a34b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Raul", "link": "https://stackoverflow.com/users/6131616/raul"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1459462013, "post_id": 36296252, "comment_id": 60311077, "body": "@vacip - Thanks for pointing out the no undo issue. It didn&#39;t occur to me. I&#39;m going to give your table suggestion a try."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10437494, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f257cafdbbd93aa4ee2b6a591755edd5?s=128&d=identicon&r=PG", "display_name": "Salim Talal", "link": "https://stackoverflow.com/users/10437494/salim-talal"}, "is_accepted": false, "score": 4, "last_activity_date": 1538323768, "last_edit_date": 1538323768, "creation_date": 1538322887, "answer_id": 52579554, "question_id": 36296252, "link": "https://stackoverflow.com/questions/36296252/excel-vba-to-preserve-formulas-with-clear-contents-events-from-other-users/52579554#52579554", "title": "Excel: VBA to preserve formulas with clear contents events from other users", "body": "<p>Try these constants in your Excel VBA code:</p>\n\n<pre><code>Sheet1.Range(\"B3:E20\").SpecialCells(xlCellTypeConstants).ClearContents\n</code></pre>\n\n<p>No need to protect the cells. This will clear cell contents without erasing formulas .</p>\n"}], "owner": {"reputation": 11, "user_id": 6131616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a0f1bb68f45dc76e703d702a34b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Raul", "link": "https://stackoverflow.com/users/6131616/raul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8265, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1538323768, "creation_date": 1459290563, "last_edit_date": 1459297112, "question_id": 36296252, "link": "https://stackoverflow.com/questions/36296252/excel-vba-to-preserve-formulas-with-clear-contents-events-from-other-users", "title": "Excel: VBA to preserve formulas with clear contents events from other users", "body": "<h2>The problem</h2>\n\n<p>I manage a weighted decision matrix in an Excel file for a team of 15 people. There are 10 columns in the file that contain formulas. The formulas calculate a total weighted score based on the options users select in other cells. </p>\n\n<p>Sometimes a user needs to remove an entry. Common removal methods for my team include selecting an entire row and doing 1 of the following:</p>\n\n<ul>\n<li>Pressing the delete key.</li>\n<li>Right-clicking and selecting \"Clear Contents\".</li>\n<li>Selecting \"Clear Contents\" from the Editing group on the Home tab.</li>\n</ul>\n\n<p>All of these methods also clear the formulas that calculate the weighted scores.</p>\n\n<p>The methods described above are intuitive for most of my team, so I\u2019d like to find a way to let people use these methods without clearing the formulas.</p>\n\n<h2>The dream</h2>\n\n<p>Allow users to clear everything <em>but the formulas</em> when they use any of the methods described above to clear cells.  </p>\n\n<h2>Things I've tried</h2>\n\n<ul>\n<li><p>Locking just the formula cells. This prevents users from clearing the formulas, but they can\u2019t clear contents in the other cells when they select the whole row because the formula cells in that row are locked.</p></li>\n<li><p>The macro below. The macro will clear constants and spare the formulas, but I can't get it to trigger automatically when a \"clear contents\" event happens. Expecting all the members of my team to run this macro instead of using their regular method for clearing contents is a fool's errand I fear.</p>\n\n<pre><code>Sub ClearOnlyValues()\n  Dim Cel As Range\n\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n  For Each Cel In Selection\n    If InStr(Cel.Formula, \"=\") = 0 And Cel.Value &lt;&gt; \"\" Then\n     Cel.ClearContents\n  End If\n  Next Cel\n\n  Application.EnableEvents = True\n  Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre></li>\n<li><p>Google. The only macros I could find all had to be run manually each time you want to clear contents and countless posts demo'ing the Go To Special method of clearing constants. See fool's errand above. If they can't clear cells intuitively, we'll descend into chaos. Cats and dogs living together. It'll be anarchy.</p></li>\n<li><p>Advanced Excel users who are way smarter than me. They're all stumped.  </p></li>\n</ul>\n\n<p>If you're still with me, thanks for taking the time. </p>\n"}, {"tags": ["arrays", "vba", "types"], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "edited": false, "score": 0, "creation_date": 1459290200, "post_id": 36296078, "comment_id": 60217294, "body": "thanks very much, i had this idea but i kinda hoped that there was a solution without any looping ..thanks again, and hopefully i&#39;ll learn new things from you"}], "tags": [], "owner": {"reputation": 7325, "user_id": 29762, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dcd05bd4d19c1aeffec0a380edfaaa5a?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/29762/ryan"}, "is_accepted": true, "score": 2, "last_activity_date": 1459290527, "last_edit_date": 1495542252, "creation_date": 1459289753, "answer_id": 36296078, "question_id": 36295988, "link": "https://stackoverflow.com/questions/36295988/vba-convert-array-type/36296078#36296078", "title": "VBA Convert array Type", "body": "<p>Since you wrote the <code>highlightWordsUsingFind</code> sub, the easiest way is to change the parameter to <code>Variant</code> as already mentioned by <a href=\"https://stackoverflow.com/a/36296084/29762\">GSerg</a>. It might be a good idea to ensure the parameter is actually an array with the <code>IsArray</code> function. <a href=\"http://www.lazerwire.com/2011/10/excel-vba-convert-variant-array-to.html\" rel=\"nofollow noreferrer\">Here</a> are some other conversion examples.</p>\n\n<p>Another option is to create a new Variant array:</p>\n\n<pre><code>Function StringToVariantArray(ByRef arr() As String) As Variant()\n    Dim index As Integer\n    Dim result() As Variant\n    Redim result(LBound(arr) To UBound(arr))\n    For index = LBound(arr) To UBound(arr)\n        result(index) = arr(index)\n    Next\n    StringToVariantArray = result\nEnd Function\n\nSub test_highlighfind()\n    Dim Rng As Range\n    Dim varr() As Variant\n\n    Set Rng = ThisDocument.Range.Paragraphs(6).Range\n    varr = StringToVariantArray(Split(Rng.Text))\n\n    Call highlightWordsUsingFind(varr, ThisDocument, 7)\nEnd Sub    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 3, "last_activity_date": 1459289790, "creation_date": 1459289790, "answer_id": 36296084, "question_id": 36295988, "link": "https://stackoverflow.com/questions/36295988/vba-convert-array-type/36296084#36296084", "title": "VBA Convert array Type", "body": "<p>Remove the parentheses in your declaration.</p>\n\n<pre><code>Sub highlightWordsUsingFind(ByRef arr As Variant, ...)\n</code></pre>\n\n<p>Then you can pass <code>arr()</code> directly. It will be wrapped into a <code>Variant/Array</code> that will refer to the original array (so no copying will happen).</p>\n"}], "owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2446, "favorite_count": 0, "accepted_answer_id": 36296078, "answer_count": 2, "score": -1, "last_activity_date": 1459290527, "creation_date": 1459289267, "question_id": 36295988, "link": "https://stackoverflow.com/questions/36295988/vba-convert-array-type", "title": "VBA Convert array Type", "body": "<p>In VBA, how do I convert An array from one type to another?, in my case i want to convert an array of type \"String\" to type \"variant\" because i have a function parameter that needs an array of that type. </p>\n\n<hr>\n\n<p>here is an example code,</p>\n\n<pre><code>Sub test_highlighfind()\n\n    Dim Rng As Range: Set Rng = ThisDocument.Range.Paragraphs(6).Range\n\n    Dim arr() As String: arr = Split(Rng.Text)\n\n    Call highlightWordsUsingFind(arr, ThisDocument, 7)\n\nEnd Sub\n\nSub highlightWordsUsingFind(ByRef arr() As Variant, ByRef doc As Document, _\n                            Optional ByVal HighlightColor As Integer = 6)\n\n    Dim i As Long, SearchRange As Range\n\n    Set SearchRange = doc.Range\n\n    With SearchRange.Find\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = True\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        .Forward = True\n        .Wrap = wdFindContinue\n        .ClearFormatting\n\n        For i = LBound(arr) To UBound(arr)\n            .Text = arr(i)\n            .Execute    'Execute// Runs the find operation. Returns True if the find operation is successful\n            SearchRange.HighlightColorIndex = HighlightColor\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>i know i can change the parameter type to \"string\" <code>ByRef arr() As String</code> but i have other functions that return an array of type \"variant\" and i need the output to the function above </p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 1207, "user_id": 1704282, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/74521b29996d85bfb60333d41efa23ae?s=128&d=identicon&r=PG", "display_name": "pelos", "link": "https://stackoverflow.com/users/1704282/pelos"}, "is_accepted": true, "score": 0, "last_activity_date": 1459536505, "creation_date": 1459536505, "answer_id": 36363721, "question_id": 36295596, "link": "https://stackoverflow.com/questions/36295596/trying-to-create-a-vba-pivot-table-and-i-get-a-mistype-match-using-different-col/36363721#36363721", "title": "Trying to create a vba pivot table and i get a mistype Match using different columns", "body": "<p>well i fixed like this</p>\n\n<pre><code>    Dim range_string As String\n    range_string = \"C1:N\" + used_cells_count_string\n    Dim the_range As Range\n    Set the_range = ThisWorkbook.Sheets(\"Issues\").Range(range_string).CurrentRegion\n\n    Dim objTable As PivotTable\n    Set objTable = ActiveSheet.PivotTableWizard(SourceType:=xlDatabase, SourceData:=the_range, tabledestination:=charts_sheet.Range(\"B2\"), TableName:=\"initial_pivot\", HasAutoFormat:=True)\n</code></pre>\n\n<p>using the PivotTableWizard</p>\n\n<p>and to refresh it i did</p>\n\n<pre><code>    Dim pvtCache As PivotCache\n    Set pvtCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"Issues!$C$1:$M$\" &amp; used_cells_count_string)\n\n    Dim my_pivot As PivotTable\n    Set my_pivot = ThisWorkbook.Sheets(\"Charts\").PivotTables(\"initial_pivot\")\n    my_pivot.ChangePivotCache pvtCache\n    my_pivot.RefreshTable\n</code></pre>\n\n<p>i still believe there is a difference  trying to pass a range  than a string such sheetName!$C$1:$M$10</p>\n"}], "owner": {"reputation": 1207, "user_id": 1704282, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/74521b29996d85bfb60333d41efa23ae?s=128&d=identicon&r=PG", "display_name": "pelos", "link": "https://stackoverflow.com/users/1704282/pelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 36363721, "answer_count": 1, "score": 0, "last_activity_date": 1459536505, "creation_date": 1459287590, "last_edit_date": 1459349672, "question_id": 36295596, "link": "https://stackoverflow.com/questions/36295596/trying-to-create-a-vba-pivot-table-and-i-get-a-mistype-match-using-different-col", "title": "Trying to create a vba pivot table and i get a mistype Match using different columns", "body": "<p>I am trying to create a pivot table in a VBA script in Excel.</p>\n\n<p>The code works and it is able to create a pivot table, but its strange that only work up to certain column. If I do any column from A to J, it will work fine, when I just try to use it and grab the range to column K, it doesn't work and I get the mismatch error.</p>\n\n<p>Reading the documentation:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839430.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff839430.aspx</a>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839430.aspx\" rel=\"nofollow\">enter link description here</a></p>\n\n<p>I saw: </p>\n\n<blockquote>\n  <p>Passing a <strong>Range</strong> object may cause \"type mismatch\" errors unexpectedly.</p>\n</blockquote>\n\n<p>Is there another way to pass the range of cells that I want to use?</p>\n\n<pre><code>Dim pvtCache As PivotCache\nDim pvt As PivotTable\n\nOn Error GoTo errTrap\n    Set pvtCache = ThisWorkbook.PivotCaches.Create(xlDatabase, ThisWorkbook.Sheets(\"Issues\").Range(\"D1:J20\"))\n 'this one doesnt work\n    'Set pvtCache = ThisWorkbook.PivotCaches.Create(xlDatabase, ThisWorkbook.Sheets(\"Issues\").Range(\"D1:K20\"))\n\nerrTrap:\n    Debug.Print err.description\n\nSet pvt = pvtCache.CreatePivotTable(TableDestination:=charts_sheet.Range(\"B2\"))\n</code></pre>\n\n<p>The <code>K</code> column has strings same as the rest of the other columns, thanks guys.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1459286420, "post_id": 36295281, "comment_id": 60215668, "body": "Other pages I have viewed seem to be using an extremely different and more robust amount of code compared to the simple task I believe I am trying to accomplish. Perhaps there is a <code>like</code> of some sort such that is used in <code>if</code> statements I could use?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1459286590, "post_id": 36295281, "comment_id": 60215754, "body": "Instead of <code>What:=&quot;testname&quot;</code> try <code>What:=&quot;*testname*&quot;</code>"}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1459286777, "post_id": 36295281, "comment_id": 60215839, "body": "@BruceWayne I could have sworn I have tried that and variations of that for the past 30 minutes and it did not work. Worked first try once you said that...I must have missed something in my original tests."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459286807, "post_id": 36295281, "comment_id": 60215852, "body": "You can post it as an answer or I can go ahead and delete this seemingly pointless question now haha. Up to you."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1459287440, "last_edit_date": 1459287440, "creation_date": 1459287002, "answer_id": 36295449, "question_id": 36295281, "link": "https://stackoverflow.com/questions/36295281/vba-replace-everything-in-sheet-using-wildcards/36295449#36295449", "title": "vba Replace everything in sheet using wildcards", "body": "<p>If you're trying to find \"testName\" <em>anywhere</em> in a cell, then add the <code>*</code> wildcard to both sides:</p>\n\n<pre><code>Worksheets(1).Columns(\"B\").Replace What:=\"*testName*\", Replacement:=\"realName\", SearchOrder:=xlByColumns, MatchCase:=false\n</code></pre>\n\n<p>And of course you could also use <code>=\"testName*\"</code> or <code>=\"*testName\"</code> to match cells that start, or end (respectively) with \"testName\".</p>\n"}], "owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 36295449, "answer_count": 1, "score": 0, "last_activity_date": 1459287440, "creation_date": 1459286354, "question_id": 36295281, "link": "https://stackoverflow.com/questions/36295281/vba-replace-everything-in-sheet-using-wildcards", "title": "vba Replace everything in sheet using wildcards", "body": "<p>Good afternoon:</p>\n\n<p>Me again ;). Ran into another issue trying to replace all items in a column. I cannot seem to get wildcards to work with how I am invoking my replace statement. Perhaps someone can show me the error in my ways? Thank you. </p>\n\n<p>Code:</p>\n\n<pre><code>Worksheets(1).Columns(\"B\").Replace _ \nWhat:=\"testName\", Replacement:=\"realName\", _ \nSearchOrder:=xlByColumns, MatchCase:=false\n</code></pre>\n\n<p>Now this works perfect as long as my data looks like:</p>\n\n<pre><code>testname\ntestName\ntestNaMe\n</code></pre>\n\n<p>BUT if my data looks like:</p>\n\n<pre><code>teestName\nTTestname\nteesstname\n</code></pre>\n\n<p>This obviously fails. Is there a way to use wildcards with how I am implementing my search, so that I can just search for \"name\"?  * character doesn't seem to be working as I would think it should(bash user mostly). Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 1, "creation_date": 1459285306, "post_id": 36294989, "comment_id": 60215138, "body": "Your &#39;if&#39; statement is incorrect. Try if Len(convertNumber) &gt; 0 and isNumber(convertNumber) then ... Also remove the &#39;:&#39; after your else statement."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1459285566, "post_id": 36294989, "comment_id": 60215262, "body": "What if you declared <code>coukTotalBingBrandSessions</code> as <code>Double</code>? (In addition to what @KrisB pointed out)"}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459285666, "post_id": 36294989, "comment_id": 60215313, "body": "@BruceWayne it&#39;s defined As Long"}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "reply_to_user": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1459285725, "post_id": 36294989, "comment_id": 60215340, "body": "@Kris B I tried your suggestion but it told me isNumber is not defined as a function and also it wouldn&#39;t let me remove the &quot;:&quot; it just keeps putting it back in so I changed the function to this:"}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "edited": false, "score": 0, "creation_date": 1459285767, "post_id": 36294989, "comment_id": 60215357, "body": "Function convertStringToNumber(convertNumber As String) As Long  If convertNumber &gt; &quot;&quot; Then convertStringToNumber = CLng(convertNumber) Else &#39;Do nothing End If  End Function"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1459285774, "post_id": 36294989, "comment_id": 60215361, "body": "it should be <code>IsNumeric</code> not <code>IsNumber</code>"}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "edited": false, "score": 0, "creation_date": 1459285793, "post_id": 36294989, "comment_id": 60215373, "body": "And now getting the overflow error on a different line of code, it does that same thing just with different variables and has a longer character length:"}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "edited": false, "score": 0, "creation_date": 1459285821, "post_id": 36294989, "comment_id": 60215385, "body": "Error on this line now: coukTotalYahooBrandOrders = (convertStringToNumber(coukYahooBrandOrders) + ((convertStringToNumber(coukYahooBrandOrders) / (convertStringToNumber(coukYahooBrandOrders) + convertStringToNumber(coukYahooNonBrandOrders))) * convertStringToNumber(coukYahooTNPOrders)))"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 1, "creation_date": 1459285894, "post_id": 36294989, "comment_id": 60215419, "body": "Is it possible that you&#39;re dividing by 0?"}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "edited": false, "score": 0, "creation_date": 1459285921, "post_id": 36294989, "comment_id": 60215429, "body": "Yes... that is possible..."}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "edited": false, "score": 0, "creation_date": 1459286074, "post_id": 36294989, "comment_id": 60215498, "body": "Any suggestions on how to handle that? can I implement an IFERROR formula within VBA like I would to handle dividing by 0 on the worksheet?"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1459286078, "post_id": 36294989, "comment_id": 60215500, "body": "For clarity, your function should be &#39;if (len(convertNum) &gt; 0 and isNumeric(convertNum)) then convertStringToNumber = CLng(convertNum) else convertStringToNumber = 0 end if"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 1, "creation_date": 1459286142, "post_id": 36294989, "comment_id": 60215537, "body": "Yeah, don&#39;t divide by 0, I don&#39;t know what else to say.... what do you want your function to do in the case of a divide by 0 operation? You could make a special divide function to handle it and say return 0 or something if you detect the denominator is 0."}, {"owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "edited": false, "score": 0, "creation_date": 1459286816, "post_id": 36294989, "comment_id": 60215857, "body": "If the result of the calculation (not the function) is an error, e.g. DIV/0 then I would like the variable coukTotalBingBrandSessions to equal 0. If I was just working with formulas in the worksheet I would wrap IFERROR around them and set the second parameter to 0. Unfortunately it is completely unavoidable that some of the variables equal 0 from time to time. The module pulls down daily data from an API in XML format and parses it, hence the need for the function because it parses it as strings. The data changes on a daily basis so sometimes zero&#39;s occur and I need to code to handle it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1459291911, "post_id": 36294989, "comment_id": 60217917, "body": "If you have the possibility of dividing by zero, calculate the divisor <i>first</i>, then check to see if it&#39;s zero before performing the division."}], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "is_accepted": false, "score": 0, "last_activity_date": 1459325748, "creation_date": 1459325748, "answer_id": 36303235, "question_id": 36294989, "link": "https://stackoverflow.com/questions/36294989/overflow-error-excel-vba/36303235#36303235", "title": "Overflow Error - Excel VBA", "body": "<p>I wrapped the calculations in an</p>\n\n<pre><code>On Error Resume Next\nOn Error GoTo 0\n</code></pre>\n\n<p>And the code would run but I don't think it's the best way to deal with it, given it wasn't suggested.</p>\n\n<p>@Comintern Doing some further work has revealed that I need to break the calculations down into their separate parts anyway so should then be able to easily implement your suggestion of checking the value of the divisor first.</p>\n\n<p>I'll report back if I get stuck ;)</p>\n\n<p>Cheers guys</p>\n"}], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459325748, "creation_date": 1459285186, "question_id": 36294989, "link": "https://stackoverflow.com/questions/36294989/overflow-error-excel-vba", "title": "Overflow Error - Excel VBA", "body": "<p>I'm getting an Overflow error on the following line of code:</p>\n\n<pre><code>coukTotalBingBrandSessions = (convertStringToNumber(coukBingBrandSessions) + ((convertStringToNumber(coukBingBrandSessions) / (convertStringToNumber(coukBingBrandSessions) + convertStringToNumber(coukBingNonBrandSessions))) * convertStringToNumber(coukBingTNPSessions)))\n</code></pre>\n\n<p>I've done a bit of searching and most of the answers seem to relate to variable type. But I've checked through the variables and unless I'm totally blind (happy to admit) I can't see any inconsistencies that would interfere with the function.</p>\n\n<p>convertStringToNumber is a function:</p>\n\n<pre><code>Function convertStringToNumber(convertNumber As String) As Long\n\nIf convertNumber &gt; \"\" Then\nconvertStringToNumber = 0\nElse: convertStringToNumber = CLng(convertNumber)\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>And I have the following variables defined:</p>\n\n<pre><code>Dim coukBingBrandSessions As String\nDim coukBingNonBrandSessions As String\nDim coukBingTNPSessions As String\nDim coukGoogleBrandSessions As String\nDim coukGoogleNonBrandSessions As String\nDim coukGoogleTNPSessions As String\nDim coukPpcBrandSessions As String\nDim coukPpcNonBrandSessions As String\nDim coukBingBrandOrders As String\nDim coukBingNonBrandOrders As String\nDim coukBingTNPOrders As String\nDim coukGoogleBrandOrders As String\nDim coukGoogleNonBrandOrders As String\nDim coukGoogleTNPOrders As String\nDim coukPpcBrandOrders As String\nDim coukPpcNonBrandOrders As String\nDim coukOtherBrandSessions As String\nDim coukOtherNonBrandSessions As String\nDim coukOtherTNPSessions As String\nDim coukYahooBrandSessions As String\nDim coukYahooNonBrandSessions As String\nDim coukYahooTNPSessions As String\nDim coukOtherBrandOrders As String\nDim coukOtherNonBrandOrders As String\nDim coukOtherTNPOrders As String\nDim coukYahooBrandOrders As String\nDim coukYahooNonBrandOrders As String\nDim coukYahooTNPOrders As String\n\nDim coukSEOBrandSessions As Long\nDim coukSEONonBrandSessions As Long\n\nDim coukSEOBrandOrders As Long\nDim coukSEONonBrandOrders As Long\n\nDim coukTotalBingBrandSessions As Long\nDim coukTotalGoogleBrandSessions As Long\nDim coukTotalOtherBrandSessions As Long\nDim coukTotalYahooBrandSessions As Long\n\nDim coukTotalBingBrandOrders As Long\nDim coukTotalGoogleBrandOrders As Long\nDim coukTotalOtherBrandOrders As Long\nDim coukTotalYahooBrandOrders As Long\n\nDim coukTotalBingNonBrandSessions As Long\nDim coukTotalGoogleNonBrandSessions As Long\nDim coukTotalOtherNonBrandSessions As Long\nDim coukTotalYahooNonBrandSessions As Long\n\nDim coukTotalBingNonBrandOrders As Long\nDim coukTotalGoogleNonBrandOrders As Long\nDim coukTotalOtherNonBrandOrders As Long\nDim coukTotalYahooNonBrandOrders As Long\n</code></pre>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "share"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1459289545, "post_id": 36294801, "comment_id": 60217066, "body": "Why not use a database? Even Access can do all that you describe. Excel sharing is a sea of pain and misfortune."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "edited": false, "score": 0, "creation_date": 1459290967, "post_id": 36294801, "comment_id": 60217569, "body": "I am pretty sure you can leave the workbook open on a shared drive and then distribute workbooks that call the macro in the shared drive."}], "answers": [{"tags": [], "owner": {"reputation": 2318, "user_id": 1840861, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vpYSr.jpg?s=128&g=1", "display_name": "Praveen Vinny", "link": "https://stackoverflow.com/users/1840861/praveen-vinny"}, "is_accepted": false, "score": 1, "last_activity_date": 1459291173, "creation_date": 1459291173, "answer_id": 36296371, "question_id": 36294801, "link": "https://stackoverflow.com/questions/36294801/sharing-macro-enabled-workbook/36296371#36296371", "title": "Sharing Macro enabled workbook", "body": "<p>Here are a few solutions that can probably help you:</p>\n\n<p><strong>Google Spreadsheet</strong></p>\n\n<ul>\n<li>You can use a spread sheet to store the details and can share it with\nusers using Google drive.</li>\n<li>Multiple users can edit it and read the document at the same time.</li>\n<li>You can read more of this in the link: <a href=\"https://support.google.com/docs/answer/2494822?hl=en&amp;rd=1\" rel=\"nofollow\">https://support.google.com/docs/answer/2494822?hl=en&amp;rd=1</a></li>\n</ul>\n\n<p><strong>Microsoft Access Database</strong></p>\n\n<ul>\n<li>You can store the details into an access database.</li>\n<li>You can make use of a programming language such as C#.NET or Java to perform data access and query manipulations to serve your purpose.</li>\n<li>Ensure that all the users are accessing the same application and that the application is collected to the same database.</li>\n<li>You can read more of this in the link: <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=175:connecting-to-microsoft-access-database-from-excel-vba-using-dao-object-model&amp;catid=79&amp;Itemid=475\" rel=\"nofollow\">http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=175:connecting-to-microsoft-access-database-from-excel-vba-using-dao-object-model&amp;catid=79&amp;Itemid=475</a></li>\n</ul>\n\n<p><strong>Manipulate Excel Data using VBA query and procedures</strong></p>\n\n<ul>\n<li>You can use the access queries and procedures with VBA which can serve your requirement.</li>\n<li>Please have a look at <a href=\"http://exceldesignsolutions.com/create-modify-and-run-and-access-query-with-vba/\" rel=\"nofollow\">http://exceldesignsolutions.com/create-modify-and-run-and-access-query-with-vba/</a> if you are interested in following this method.</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 6109636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3d48016451380d767d6c90260c2314?s=128&d=identicon&r=PG&f=1", "display_name": "pgw215", "link": "https://stackoverflow.com/users/6109636/pgw215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2653, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459292998, "creation_date": 1459284473, "last_edit_date": 1459292998, "question_id": 36294801, "link": "https://stackoverflow.com/questions/36294801/sharing-macro-enabled-workbook", "title": "Sharing Macro enabled workbook", "body": "<p>I created a workbook that I will have employee's enter certain bits of information via user form.  Multiple employees will be using this and I want them to be able to access it simultaneously.  Based on what I have seen online it does not seem that you can share a macro enabled workbook that allows for simultaneous use.  I tested this theory and sure enough the macro failed and I was unable to view/edit it since I had turned on sharing.</p>\n\n<p>Has anyone had experience with this and found a way to work around it?  Our facility does not have a sharepoint drive currently that allows me to bypass these shared macro settings.  Thanks for your time</p>\n"}, {"tags": ["vba", "hyperlink", "macros", "ms-word"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1459284578, "post_id": 36294069, "comment_id": 60214758, "body": "to match just the tag set .MatchWholeWord = True in your find - use the Macro recorder for things like that.  Also if the text is always &quot;not correct&quot; then back out that many characters and see if you match Not Correct."}, {"owner": {"reputation": 3, "user_id": 6131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b478ace89cc7302385bfbfcaeb0e39de?s=128&d=identicon&r=PG&f=1", "display_name": "Tornadospoon", "link": "https://stackoverflow.com/users/6131047/tornadospoon"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1459285906, "post_id": 36294069, "comment_id": 60215423, "body": "Will .MatchWholeWord = True work if the text string includes more than only the tag? for example, would that function allow me to find the tag &quot;AB324&quot; by searching only for &quot;AB&quot;?  And I apologize for not clarifying: the &#39;(not correct)&#39; and &#39;(correct)&#39; in that example were me pointing out where the macro properly linked text versus improperly. that text will not be part of the document."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1459287102, "post_id": 36294069, "comment_id": 60215985, "body": "No it wouldn&#39;t but you can remove that and tell it to matchcase which would.   And it wouldn&#39;t pick up Ab but would pick up your examples"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b478ace89cc7302385bfbfcaeb0e39de?s=128&d=identicon&r=PG&f=1", "display_name": "Tornadospoon", "link": "https://stackoverflow.com/users/6131047/tornadospoon"}, "edited": false, "score": 0, "creation_date": 1459437117, "post_id": 36300415, "comment_id": 60296454, "body": "Thank you! I&#39;ll look into that solution as soon as I have a free moment!"}, {"owner": {"reputation": 3, "user_id": 6131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b478ace89cc7302385bfbfcaeb0e39de?s=128&d=identicon&r=PG&f=1", "display_name": "Tornadospoon", "link": "https://stackoverflow.com/users/6131047/tornadospoon"}, "edited": false, "score": 0, "creation_date": 1459440279, "post_id": 36300415, "comment_id": 60298751, "body": "thank you so much! I folded that into my macro and it works like a dream! You have no idea how much time your suggestion will be saving me in the future!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1459315780, "creation_date": 1459315780, "answer_id": 36300415, "question_id": 36294069, "link": "https://stackoverflow.com/questions/36294069/word-macro-to-mass-hyperlink-variable-length-strings/36300415#36300415", "title": "Word Macro to Mass Hyperlink variable length strings", "body": "<p>If you want to match a fixed tag followed by a variable number of digits:</p>\n\n<pre><code>Sub Tester()\n    TagMatches ActiveDocument, \"AB\"\nEnd Sub\n\n\nSub TagMatches(doc As Document, tag As String)\n    Dim rng\n\n    Set rng = doc.Range\n\n    With rng.Find\n        .Text = tag &amp; \"[0-9]{1,}\"\n        .Forward = True\n        .MatchWildcards = True\n        Do While .Execute\n            Debug.Print rng.Text\n        Loop\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>See:  <a href=\"http://word.mvps.org/faqs/general/usingwildcards.htm\" rel=\"nofollow\">http://word.mvps.org/faqs/general/usingwildcards.htm</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b478ace89cc7302385bfbfcaeb0e39de?s=128&d=identicon&r=PG&f=1", "display_name": "Tornadospoon", "link": "https://stackoverflow.com/users/6131047/tornadospoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "accepted_answer_id": 36300415, "answer_count": 1, "score": 0, "last_activity_date": 1459315780, "creation_date": 1459281745, "question_id": 36294069, "link": "https://stackoverflow.com/questions/36294069/word-macro-to-mass-hyperlink-variable-length-strings", "title": "Word Macro to Mass Hyperlink variable length strings", "body": "<p>I've been looking through the forums for a while now trying to find an answer to my problem, and either I'm dense or it hasn't been answered, so here I am.</p>\n\n<p>Long story short, my job involves writing up word documents that list building deficits and provides hyperlinks to images of said deficits. The visible hyperlink text always follows the same format: '[site abbreviation][(image number)].JPG'. For example, if we are looking at 'Administrative Building', our images will be named 'AB(1).JPG', 'AB(2).JPG', etc, often into the mid-hundreds or thousands. In the word document, they are referenced as 'AB1', 'AB2' etc.</p>\n\n<p>Currently, I have a macro that allows me to automatically create a hyperlink once I've selected the text, but I am trying to create a macro that will look through a document (or better yet, a highlighted selection) and assign hyperlinks to any text that starts with the site's abbreviation all at once.</p>\n\n<p>My current attempt at a mass-hyperlinking macro is frustratingly close, but has one major error: while it will correctly hyperlink the first image name it finds, all subsequent images are linked with the next two characters included in the link. For example, if a sentence were to say \"This is not correct (AB33), but this is correct (AB34)', my macro will hyperlink the text 'AB34' (which is correct) and 'AB33) ' (which is incorrect).</p>\n\n<p>This is the macro I've been working with thus far (note that the text between the lines of 'XXXX...' are basic instructions for my coworkers to change the link destination as needed)</p>\n\n<pre><code>Option Explicit\n\n\n    Sub Mass_Hyperlink_v_1_1()\n'incomplete: selects incorrect text after first link\n\nDim fileName As String\nDim filePath As String\nDim rng As Range\nDim tag As String\nDim FileType As String\nDim folder As String\nDim space As String\nDim start As String\nDim report_type As String\nDim temp As String\n\n'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n'Do not touch anything above this line\n\n    'Answer the following for the current document. Leave all quotations.\n\n    report_type = \"CL\"          'CL = Checklist\n                                'SR = Site Report\n\n    folder = \"Doors\"          'The name of the folder you are linking images from\n                                'Must match folder exactly\n\n    tag = \"FS\"                  'Put file prefix here (ex. if link says \"AB123\", put \"AB\")\n\n    space = \"No\"               'Does the image file have a space in it? (ex. if file name is \"AB (23)\", put \"yes\")\n\n    FileType = \".JPG\"           'make sure filetype extensions match\n\n'Do not touch anything below this line\n'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n\nIf space = \"Yes\" Then\n    start = \"%20(\"\n    Else: start = \"(\"\nEnd If\n\nIf report_type = \"CL\" Then\n    folder = \"..\\Images\\\" &amp; folder\n    Else: folder = folder\nEnd If\n\nIf report_type = \"SR\" Then\n    folder = \"Images\\\" &amp; folder\n    Else: folder = folder\nEnd If\n\nSet rng = ActiveDocument.Range\n\nWith rng.find\n.MatchWildcards = True\n    Do While .Execute(findText:=tag, Forward:=False) = True\n        rng.MoveStartUntil (tag)\n        rng.Select\n        Selection.Extend\n        Selection.MoveRight Unit:=wdWord, Count:=1, Extend:=wdExtend\n\n\n        'I believe the issue is created here\n\n        Selection.start = Selection.start + Len(tag)\n\n        ActiveDocument.Range(Selection.start - Len(tag), Selection.start).Delete\n\n    fileName = Selection.Text\n\n    filePath = folder &amp; \"\\\" &amp; tag &amp; start &amp; fileName &amp; \")\" &amp; FileType\n\n    ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, address:= _\n        filePath, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:= _\n        tag &amp; Selection.Text\n\n    rng.Collapse wdCollapseStart\n\n\n    Loop\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>If I've explained this terribly wrong or not provided enough information, please let me know and I'll try to be more clear. And if there is a helpful resource that I'm simply too dense to have found, please let me know! thank you!</p>\n\n<p>edit: if anyone knows how to only select words that start with the tag as opposed to words with the tag text in them, I'd be incredibly appreciative as well!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4589, "user_id": 2263572, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bea7d4a6d62f5730775d5702cb0c6357?s=128&d=identicon&r=PG", "display_name": "user2263572", "link": "https://stackoverflow.com/users/2263572/user2263572"}, "edited": false, "score": 0, "creation_date": 1459281725, "post_id": 36293963, "comment_id": 60213220, "body": "It depends how automated you want to make this.  Can you manually paste the separate data sheets into the same workbook into separate worksheets?  If so, then I would suggest doing that, and then you can have 1 worksheet that is dedicated to reporting the numbers for all years/schools.  This would be able to be done with a simple vlookup once you have all the data pasted in correctly.  Also, if the formate every year is the same, you can paste everything into one tab and use excels pivot table functionality to show data across years."}, {"owner": {"reputation": 147, "user_id": 3761096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051058ff9a24806e77b33b5fc88a9d24?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3761096/ross"}, "edited": false, "score": 0, "creation_date": 1459281888, "post_id": 36293963, "comment_id": 60213316, "body": "Try adding a column A with the year for the data.  You can keep one running sheet with all the data and you can filter and pivot as needed."}, {"owner": {"reputation": 3, "user_id": 6131245, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209777513103686/picture?type=large", "display_name": "Billy R", "link": "https://stackoverflow.com/users/6131245/billy-r"}, "reply_to_user": {"reputation": 4589, "user_id": 2263572, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bea7d4a6d62f5730775d5702cb0c6357?s=128&d=identicon&r=PG", "display_name": "user2263572", "link": "https://stackoverflow.com/users/2263572/user2263572"}, "edited": false, "score": 0, "creation_date": 1459282744, "post_id": 36293963, "comment_id": 60213788, "body": "@user2263572 Between the three responses I&#39;ve got exactly what I need, thanks so much for your help!"}, {"owner": {"reputation": 3, "user_id": 6131245, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209777513103686/picture?type=large", "display_name": "Billy R", "link": "https://stackoverflow.com/users/6131245/billy-r"}, "reply_to_user": {"reputation": 147, "user_id": 3761096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051058ff9a24806e77b33b5fc88a9d24?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3761096/ross"}, "edited": false, "score": 1, "creation_date": 1459282777, "post_id": 36293963, "comment_id": 60213809, "body": "@Ross Adding the year column was the obvious thing I hadn&#39;t thought of, and now I&#39;ve got it. Thanks so much man!"}], "answers": [{"tags": [], "owner": {"reputation": 699, "user_id": 1188594, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/020ebedc4b0d943f4533c8dea5e56604?s=128&d=identicon&r=PG", "display_name": "Stephen Lloyd", "link": "https://stackoverflow.com/users/1188594/stephen-lloyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1459282466, "creation_date": 1459282466, "answer_id": 36294272, "question_id": 36293963, "link": "https://stackoverflow.com/questions/36293963/combining-excel-worksheets/36294272#36294272", "title": "Combining Excel worksheets", "body": "<p>Since you have Excel 2016, you have more options than ever.</p>\n\n<p>You might use PowerQuery to get data from other workbooks or tables in the same workbok.  Add a year column (sheetname in my case to simulate) to each file or table or whatever.</p>\n\n<p><a href=\"https://i.stack.imgur.com/APf8R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/APf8R.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could then append the queries to each other</p>\n\n<p><a href=\"https://i.stack.imgur.com/nMfx9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nMfx9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Resulting in a list with the year (or in my case sheetname) added in.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pbxzO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbxzO.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could pivot the resulting data</p>\n\n<p><a href=\"https://i.stack.imgur.com/HS5vm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HS5vm.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then chart</p>\n\n<p><a href=\"https://i.stack.imgur.com/YWL8N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YWL8N.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/jzVhA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jzVhA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 6131245, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209777513103686/picture?type=large", "display_name": "Billy R", "link": "https://stackoverflow.com/users/6131245/billy-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 36294272, "answer_count": 1, "score": 0, "last_activity_date": 1492457848, "creation_date": 1459281396, "last_edit_date": 1492457848, "question_id": 36293963, "link": "https://stackoverflow.com/questions/36293963/combining-excel-worksheets", "title": "Combining Excel worksheets", "body": "<p>Variations on this question have been asked before, but they either don't address my scenario or the answers go over my head.</p>\n\n<p>I'm working on a project using NYC's School Quality Reports. Each year, they put out school-level data that looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/rYFDk.jpg\" alt=\"image\"></p>\n\n<p>The hitch is that, every year, some schools close and others open. I want each school's data for multiple years in the same spreadsheet, so I can do side-by-side comparisons. I don't want to sum or combine the variables/columns from each year; I just want them to be next to each other.</p>\n\n<p>I'm using Excel 2016.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 5860809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8NU5O.jpg?s=128&g=1", "display_name": "Sathish Kumar", "link": "https://stackoverflow.com/users/5860809/sathish-kumar"}, "edited": false, "score": 0, "creation_date": 1459280794, "post_id": 36293755, "comment_id": 60212679, "body": "Right below the Select tag, there is a call to the javascript.  \t\t&lt;script language=&quot;javascript&quot; &gt; \t\tif(typeof(TwisterNonJs) == &#39;undefined&#39;) \t\t{ \t\twindow.TwisterNonJs = {}; \t\tTwisterNonJs.handleDropDown = []; \t\t} \t\tTwisterNonJs.handleDropDown[0] = function(){ \t\tvar twisterUpdateButton = &quot;submit.twisterUpdateButton_0&quot; \t\tdocument.getElementById(&quot;dummySubmitButton&quot;).setAttribute(&zwnj;&#8203;&quot;name&quot;,twisterUpdate&zwnj;&#8203;Button); \t\tdocument.forms[&#39;twister&#39;].submit(); \t\t}; \t\tdocument.getElementById(&quot;selected_size&quot;).onchange = function(){ \t\tTwisterNonJs.handleDropDown[0](); \t\t}; \t\t&lt;/script&gt;"}, {"owner": {"reputation": 490, "user_id": 4682948, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-wqtA8NbrmOk/AAAAAAAAAAI/AAAAAAAAAZE/5ulntG-osww/photo.jpg?sz=128", "display_name": "Roshan Bhumbra", "link": "https://stackoverflow.com/users/4682948/roshan-bhumbra"}, "edited": false, "score": 0, "creation_date": 1459280995, "post_id": 36293755, "comment_id": 60212805, "body": "IE is bad, try using <a href=\"https://www.google.com/chrome/\" rel=\"nofollow noreferrer\">chrome</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5860809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8NU5O.jpg?s=128&g=1", "display_name": "Sathish Kumar", "link": "https://stackoverflow.com/users/5860809/sathish-kumar"}, "edited": false, "score": 0, "creation_date": 1459480395, "post_id": 36296210, "comment_id": 60316064, "body": "Thanks for the suggestion. However the change didn&#39;t work. Meanwhile, I tried using SENDKEYS and it worked.  1. htmlele.click 2. Application.SendKeys &quot;{DOWN}&quot;           3. Application.SendKeys &quot;~&quot;  This did the work for me. Now, I&#39;m wondering whatg would happen if i change the control from IE to another application when the macro is running."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1459511940, "last_edit_date": 1459511940, "creation_date": 1459290395, "answer_id": 36296210, "question_id": 36293755, "link": "https://stackoverflow.com/questions/36293755/apply-the-value-of-a-dropdown-on-a-website-in-internet-explorer/36296210#36296210", "title": "Apply the value of a dropdown on a website in Internet Explorer", "body": "<p>Try something like this, I'm very paranoid about readystate after every interaction with website, sometimes even this is not enough and you need to execute your code only after some loading window disappears. You must also remember that IE has big trouble with dropdowns and often requires double clicking dropdown value to choose it.</p>\n\n<pre><code>'requires Microsoft HTML Object Library, Microsoft Internet Controls reference\n\nDim htmlele As ihtmlelement\nDim colele As IHTMLElementCollection\nDim ie As Object\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\n'navigating and other code\n\nDo Until ie.ReadyState = READYSTATE_COMPLETE And ie.Busy = False\n    DoEvents\nLoop\n\nset htmlele = ie.document.getElementByID(\"selected_size\")\nhtmlele.click\n\nDo Until ie.ReadyState = READYSTATE_COMPLETE And ie.Busy = False\n    DoEvents\nLoop\n\nSet colele = ie.document.getElementsByTagName(\"option\")\nFor Each htmlele In colele\n    If htmlele.className = \"dropdownAvailable\" Then\n        htmlele.click\n        Do Until ie.ReadyState = READYSTATE_COMPLETE And ie.Busy = False\n          DoEvents\n        Loop\n        'the code       \n    End If\nNext htmlele\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 349, "user_id": 4700357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5859e671edbc989c9a156e12e8d5a7?s=128&d=identicon&r=PG&f=1", "display_name": "siggi_pop", "link": "https://stackoverflow.com/users/4700357/siggi-pop"}, "is_accepted": false, "score": 0, "last_activity_date": 1542400520, "creation_date": 1542400520, "answer_id": 53345019, "question_id": 36293755, "link": "https://stackoverflow.com/questions/36293755/apply-the-value-of-a-dropdown-on-a-website-in-internet-explorer/53345019#53345019", "title": "Apply the value of a dropdown on a website in Internet Explorer", "body": "<p>I always try to avoid using the sendKey function when automating DOM. There is always unforeseen delays in the UI, and the right element must be active as well as the IE window has to be the currently active OS window. This means that you can't easily debug your code.\nInstead you should try to select the option element and set the attribute to selected. kinda like so</p>\n\n<pre><code>Set list = ie.document.querySelectorAll(\".dropdownAvailable option\")\nFor Each option in list \n if option.innerText = yourMatchStr Then\n  call option.setAttribute(\"selected\", \"selected\")\n  Exit For\n end if \nnext option\n</code></pre>\n\n<p>Now the option item is selected, but sometimes the selection is not visible in the view. sometimes that doesn't mean anything the change is registered when the page is reloaded or when user presses other buttons on the page</p>\n"}], "owner": {"reputation": 13, "user_id": 5860809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8NU5O.jpg?s=128&g=1", "display_name": "Sathish Kumar", "link": "https://stackoverflow.com/users/5860809/sathish-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1332, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556582610, "creation_date": 1459280757, "last_edit_date": 1556582610, "question_id": 36293755, "link": "https://stackoverflow.com/questions/36293755/apply-the-value-of-a-dropdown-on-a-website-in-internet-explorer", "title": "Apply the value of a dropdown on a website in Internet Explorer", "body": "<p>I want to apply the value of a dropdown on a website.</p>\n\n<p>There is a button tag in the source HTML code. After clicking the button (button.click), I select the dropdown value for all tag having class as \"dropdownAvailable\" from the Option tag.</p>\n\n<p>Although the value of the dropdown seems to change, the page doesn't change accordingly.</p>\n\n<p>The HTML code for the Select tag is like below. </p>\n\n<pre><code>    &lt;select name=\"dropdown_selected_size\" autocomplete=\"off\" data-a-touch-header=\"Size\" id=\"selected_size\" class=\"a-native-dropdown\"&gt;\n        &lt;option id=\"native_size_-1\" data-a-id=\"size_-1\" selected&gt;Select&lt;/option&gt;\n        &lt;option class=\"dropdownAvailable\" id=\"native_size_0\" data-a-id=\"size_0\" data-a-html-content=\"40.5\"&gt;40.5&lt;/option&gt;\n        &lt;option class=\"dropdownUnavailable\" id=\"native_size_1\" data-a-id=\"size_1\" data-a-html-content=\"40.5\"&gt;40.5&lt;/option&gt;\n        &lt;option class=\"dropdownAvailable\" id=\"native_size_2\" data-a-id=\"size_2\" data-a-html-content=\"41\"&gt;41&lt;/option&gt;\n        &lt;option class=\"dropdownUnavailable\" id=\"native_size_3\" data-a-id=\"size_3\" data-a-html-content=\"41\"&gt;41&lt;/option&gt;\n        &lt;option class=\"dropdownAvailable\" id=\"native_size_4\" data-a-id=\"size_4\" data-a-html-content=\"42\"&gt;42&lt;/option&gt;\n    &lt;/select&gt;\n</code></pre>\n\n<p>I have tried all of the below options for the dropdown to be selected.</p>\n\n<ol>\n<li>ie.document.getElementById(\"selected_size\").onchange</li>\n<li>ie.document.getElementById(\"selected_size\").FireEvent (\"onchange\")</li>\n<li>ie.document.getElementById(\"selected_size\").getElementsByTagName(\"option\")(n).Click</li>\n<li>ie.document.getElementById(\"selected_size\").Click</li>\n<li>Application.SendKeys \"{TAB}\"</li>\n<li>Application.SendKeys \"{ENTER}\"</li>\n<li>Application.SendKeys \"~\"</li>\n</ol>\n\n<p>I'm using IE Version 11 and MS Excel 2013.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459280235, "post_id": 36293561, "comment_id": 60212320, "body": "is workbook <code>L3 PSR.xls</code> open when this is run?"}, {"owner": {"reputation": 23, "user_id": 5136547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59d0fc3a6a664ca4b3c8089182952c06?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Bradley", "link": "https://stackoverflow.com/users/5136547/alexander-bradley"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459280317, "post_id": 36293561, "comment_id": 60212383, "body": "Yes, it is opened in a previous macro"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 3, "creation_date": 1459280563, "post_id": 36293561, "comment_id": 60212544, "body": "I&#39;m guessing somewhere you have an object variable which references the active <code>Excel.Application</code> instance which has the workbook opened.  Qualify <code>Workbooks</code> with that object variable ... <code>Set WKS = objExcel.Workbooks(</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1459280741, "post_id": 36293561, "comment_id": 60212654, "body": "Later, if you encounter a similar problem at <code>lastrow = Range(</code>, change that to <code>lastrow = WKS.Range(</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1459280751, "post_id": 36293561, "comment_id": 60212656, "body": "also good practice to qualify the first <code>Range</code> in the <code>lastrow = </code> line... <code>lastrow = WKS.Range(&quot;I&quot; &amp; WKS.Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 23, "user_id": 5136547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59d0fc3a6a664ca4b3c8089182952c06?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Bradley", "link": "https://stackoverflow.com/users/5136547/alexander-bradley"}, "edited": false, "score": 0, "creation_date": 1459281015, "post_id": 36293561, "comment_id": 60212824, "body": "Ok - that makes sense HansUp. Here&#39;s my followup question: In the previous module, I assigned the excel.application instance like this: <code>set XL = new Excel.Application.</code> So how the heck do I call that excel instance? I can&#39;t just say <code>set XL = new Excel.Application</code> again as that will create a new application."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1459281393, "post_id": 36293561, "comment_id": 60213034, "body": "Aha!  I wondered how you were sharing that object variable! In the current procedure, I guess you could use <code>GetObject()</code> to latch on to the Excel application.  Check the help topic for details."}, {"owner": {"reputation": 23, "user_id": 5136547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59d0fc3a6a664ca4b3c8089182952c06?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Bradley", "link": "https://stackoverflow.com/users/5136547/alexander-bradley"}, "edited": false, "score": 1, "creation_date": 1459282322, "post_id": 36293561, "comment_id": 60213586, "body": "Hey HansUp - much thanks! Problem solved - it runs correctly 100% of the time. I used <code>Set XL = GetObject(&quot;C:\\Users\\****\\Desktop\\L3 PSR.xls&quot;).Application</code> to find the instance in question, and threw that in the front of the WKS variable assignment. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1459282663, "creation_date": 1459282663, "answer_id": 36294326, "question_id": 36293561, "link": "https://stackoverflow.com/questions/36293561/error-9-vba-subscript-out-of-range-appears-every-other-run/36294326#36294326", "title": "Error 9 VBA - Subscript out of Range appears every other run", "body": "<p>You have a couple of options depending on how your code is constructed:</p>\n\n<p>1) Make <code>XL</code> a public variable:</p>\n\n<pre><code>Public XL As Excel.Application '// Declare at top of module, outside of any subs/functions\n</code></pre>\n\n<p>2) Pass Excel to the other sub:</p>\n\n<pre><code>Set XL = New Excel.Application\n'// ... more code\n\nMy_Other_Sub XL '// Call sub and pass Excel object\n\n'// Some more code\n\nEnd Sub\n\nPublic Sub My_Other_Sub(ByRef XL As Excel.Application)\n    Set ws = XL.Workbooks(1).Sheets(1)\n    '// Other code\nEnd Sub\n</code></pre>\n\n<p>3) Use the <code>GetObject()</code> method if Excel is already open.</p>\n\n<pre><code>Set XL = GetObject(, \"Excel.Application\")\n\nIf Not XL Is Nothing Then\n    Set ws = XL.Workbooks(1).Sheets(1)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5136547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59d0fc3a6a664ca4b3c8089182952c06?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Bradley", "link": "https://stackoverflow.com/users/5136547/alexander-bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459282663, "creation_date": 1459280095, "question_id": 36293561, "link": "https://stackoverflow.com/questions/36293561/error-9-vba-subscript-out-of-range-appears-every-other-run", "title": "Error 9 VBA - Subscript out of Range appears every other run", "body": "<p>The code below, located in my access database, runs fine half of the time. The other half it gives me: \"error 9 subscript out of range,\" and it highlights the \"Set WKS = Workbooks(...\" line as the problem. I know that the problem is with it being unsure which workbook it is referencing. However I don't know what to do to make it clearer.</p>\n\n<pre><code>Sub fixborderss()\nDim WKS As Excel.Worksheet\nDim lastrow As Long\n\n\nSet WKS = Workbooks(\"L3 PSR.xls\").Worksheets(\"L-3 Project Status Report\")\n\nlastrow = Range(\"I\" &amp; WKS.Rows.Count).End(xlUp).Row\n\nWKS.Range(\"A8:V\" &amp; lastrow).Borders(xlEdgeTop).Color = RGB(191, 191, 191)\nWKS.Range(\"A8:V\" &amp; lastrow).Borders(xlEdgeBottom).Color = RGB(191, 191, 191)\nWKS.Range(\"A8:V\" &amp; lastrow).Borders.LineStyle = xlContinuous\n\nEnd Sub\n</code></pre>\n"}]